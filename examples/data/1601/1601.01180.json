[{"file": "1601.01180.tex", "nexttext": "\nwhere $\\theta_i$, $i=1, \\ldots, n$, denotes the underlying true area-specific relative risk \\cite{bernardinelli-etal-1995}.\n\nThe maximum likelihood estimator of $\\theta_i$ is given by $\\hat{\\theta}_i =\ny_i/E_i$ and corresponds to the standardised mortality ratio (SMR) if the\ncounts represent deaths. Mapping the SMRs directly can, however, be\nmisleading. Areas with extreme SMR values often have small expected\nnumbers, so that sampling variability is more pronounced. This is\nreflected in large values for $\\text{Var}(\\hat{\\theta}_i) =\n\\theta_i/E_i$, see Bernardinelli et\nal. \\cite{bernadinelli-etal-1997} or Wakefield \\cite{wakefield-2007} for more\ndetails.\n\nDue to these potential instabilities, methods have been proposed to\nsmooth the raw estimates over space. Bayesian hierarchical models are\ncommonly used in this context, where the latent model involves random\neffects that borrow strength over neighbouring regions and such\nachieve local smoothness \\cite{bernadinelli-etal-1997}. We refer to\nLawson \\cite{lawson-book} and Banerjee et al. \\cite{banerjee-book} for a\ndetailed description of the class of Bayesian hierarchical models.\n\nA general model formulation is to assume that the log risk $\\eta_i =\n\\log(\\theta_i)$ has the decomposition:\n\n", "itemtype": "equation", "pos": 9622, "prevtext": "\n\\begin{center}\n{\\LARGE{\\bf An intuitive Bayesian spatial model for disease mapping that accounts for scaling\n}}\n\\end{center}\n\\vskip 2mm\n\\begin{center}\nAndrea Riebler \\footnote{(\\baselineskip=10pt to whom correspondence should be addressed) Department of Mathematical Sciences, Norwegian University of Science and Technology, Norway,\nandrea.riebler@math.ntnu.no},\nSigrunn H.~S{\\o}rbye \\footnote{\\baselineskip=10pt Department of Mathematics and Statistics, UiT The Arctic University of Norway, Norway.},\n\\setcounter{footnote}{2}\nDaniel Simpson\n\\footnote{\\baselineskip=10pt Department of Mathematical Sciences,\n  University of Bath, United Kingdom.},\nH{\\aa}vard Rue$^1$,\n\\end{center}\n\n\n\n\n\n{\\large{\\bf Abstract}}\\\\\n{\\small\nIn recent years, disease mapping studies have become a routine\napplication within geographical epidemiology and are typically\nanalysed within a Bayesian hierarchical model formulation. A variety\nof model formulations for the latent level have been proposed but all come with\ninherent issues. In the classical BYM (Besag, York and Molli{\\'e})\nmodel, the spatially structured component cannot be seen independently\nfrom the unstructured component.  This makes prior definitions for\nthe hyperparameters of the two random effects challenging. There are\nalternative model formulations that address this confounding, however,\nthe issue on how to choose interpretable hyperpriors \nis still unsolved. Here, we discuss a recently proposed parameterisation of the BYM model that leads to\nimproved parameter control as the hyperparameters can be seen\nindependently from each other. Furthermore, the need for a\nscaled spatial component is addressed,  which facilitates assignment of interpretable \nhyperpriors and make these transferable between \nspatial applications with different graph structures. The hyperparameters themselves are used to define flexible extensions of simple base\nmodels. Consequently, penalised complexity (PC) priors for these parameters can be derived based on the\ninformation-theoretic distance from the flexible model to the base model, giving priors with clear interpretation. We provide implementation details\nfor the new model formulation which preserve sparsity properties, and we\ninvestigate systematically the model performance and compare it to existing \nparameterisations. Through a simulation study, we show\nthat the new model performs well, both showing good learning abilities and good shrinkage behaviour.  In terms of model choice criteria, the proposed model \nperforms at least equally well as existing\nparameterisations, but only the \nnew formulation offers parameters that are interpretable and\nhyperpriors that have a clear meaning.}\n\n\\baselineskip=12pt\n\n\n\n\n\n\n\n\\baselineskip=12pt\n\\par\\vspace{0.5cm}\\noindent\n{\\bf KEY WORDS:}\ndisease mapping, Bayesian hierarchical model, INLA, Leroux model,\n  penalised complexity prior, scaling\n\n\n\\section{Introduction}\n\nOver the recent years, there has been much interest in spatial modeling and mapping of\ndisease or mortality rates. Due to inherent sampling\nvariability it is not recommended to inspect crude rates directly, but\nborrow strength over neighbouring regions to get more reliable\nregion-specific estimates. The state of the art is to\nuse Bayesian hierarchical models, where the risk surface is modelled using a set of spatial random\neffects, in addition to potentially available covariate\ninformation \\cite{lawson-book}. The random effects shall\ncapture unobserved heterogeneity or spatial correlation that cannot be\nexplained by the available covariates \\cite{lee-etal-2011}. However, there\nhas been much confusion on the design of the spatial random effects. Besag et\nal.\\cite{besag-etal-1991} proposed an intrinsic autoregressive model, often referred to as  \nthe CAR prior or Besag model,  where the spatial effect of a particular region depends \non the effects of all neighbouring regions. They also proposed the commonly\nknown BYM model, where an additional unstructured spatial random effect is\nincluded to account for independent region-specific noise. \n Consequently, various model\nmodifications and alternative approaches have been proposed, see for\nexample Leroux et al. \n\\cite{leroux-etal-2000}, Stern and Cressie \\cite{stern-cressie-2000}\nand Dean et al. \\cite{dean-etal-2001} The appropriateness and behaviour\nof different latent spatial models have been compared in a full\nBayesian context \\citep{best-etal-2005,wakefield-2007,macnab-2010,lee-etal-2011},\nan empirical\nBayes setting \\cite{lee-durban} or using penalized quasi likelihood\n\\cite{leroux-etal-2000}. It is accepted that the Besag model may lead\nto misleading results in the case where there is no spatial correlation\nin the data \\citep{leroux-etal-2000,wakefield-2007}. For this\npurpose, most alternative models propose to account for unstructured\nvariability in space.\n\nBy including both structured and unstructured components in the model,\npotential confounding must be addressed\n\\cite{bernardinelli-etal-1995}, as otherwise it is not clear how to\nsplit the variability over the effects. This problem has motivated development of reparameterised models, in which the precision\nparameters of the two components are replaced by a common precision parameter and a mixing parameter, which distribute the\nvariability between the structured and unstructured components \\citep{leroux-etal-2000,dean-etal-2001}.\n\nHowever, existing approaches do have two issues. First, the spatially\nstructured component is not scaled. This implies that the precision\nparameter does not represent the marginal precision but is confounded\nwith the mixing parameter. Thus, the effect of any prior assigned to the precision\nparameter depends on the graph structure of the application. \nThis has the additional effect that a given prior is not transferable\nbetween different applications if the underlying graph changes\n\\cite{sorbye-rue-2014}. Second, the choice of hyperpriors for the\nrandom effects is not straightforward.  Approaches to design epidemiologically sensible hyperpriors include, among others, Bernardinelli et al. \\cite{bernardinelli-etal-1995} and Wakefield\n\\cite{wakefield-2007}. \n\nRecently, Simpson et al. \\citep{simpson-etal-2015} proposed a new  BYM\nparameterisation that accounts for scaling and provides an intuitive way to\ndefine priors by taking the model structure into account. This new\nmodel provides a new way to look at the BYM model. The primary goal is not to\noptimize model choice criteria, such as DIC values, but to provide\na sensible model formulation where all parameters have a clear meaning.\nThe model structure is similar to the Dean\nmodel\\cite{dean-etal-2001}, with the crucial modification that\nthe precision parameter is mapped to the marginal standard deviation. This makes\nthe parameters of the model interpretable and facilitates assignment of\nmeaningful hyperpriors. The framework of\npenalised complexity (PC) priors is applied to formulate prior\ndistributions for the hyperparameters.  The spatial model is thereby seen as a \nflexible extension of  two simpler base models that it will shrink towards, if not indicated otherwise by the data\n\\cite{simpson-etal-2015}. The upper level base model assumes a\nconstant risk surface, while the lower level model assumes a varying\nrisk surface over space without spatial autocorrelation. In this paper\nwe investigate systematically the model behaviour under different\nsimulation scenarios. Furthermore, we compare this new model\nformulation to commonly used model formulations in disease mapping. We point out\ndifferences, focusing on parameter interpretability and\nprior distribution assignment. For completeness we also compare\ncommonly used model choice criteria.\n\nWe have chosen to implement all models using integrated nested\nLaplace approximations (INLA) \\cite{rue-etal-2009}, available to the\napplied user via the R-package {\\tt INLA} (see \\url{www.r-inla.org}). INLA\nis straightforward to use for full Bayesian inference in\ndisease mapping and avoids any Markov chain Monte Carlos techniques\n\\citep{schrodle-held-2011,schrodle-held-2011b}.\n\nThe plan for the paper is as follows. Section~\\ref{sec:diseaseMapping}\ngives an introduction to disease mapping and motivates the use of Bayesian\nhierarchical models. Commonly used spatial models for the latent level\nare reviewed in Section~\\ref{sec:spatialModels}, before the need of scaling\nand consequently the new modified spatial model is\npresented. Section~\\ref{sec:pcprior} uses the PC-prior framework to\ndesign sensible hyperpriors for the precision and mixing parameter. In\nSection~\\ref{sec:application},  we investigate the properties and\nbehaviour of the new \nmodel in a simulation study, including comparisons to commonly\nused models. This section also contains an application to insulin-dependent\ndiabetes mellitus data in Sardinia. Discussion and concluding\nremarks  are given in Section~\\ref{sec:discussion}.\n\n\n\n\\section{Disease Mapping}\\label{sec:diseaseMapping}\n\nDisease mapping has a long history in epidemiology and one major\ngoal is to investigate the geographical distribution of disease\nburden \\cite{wakefield-2007}. In the following, we assume that our region\nof interest is divided into $n$ non-overlapping areas. Let $E_{i}$\ndenote the number of persons at risk in area $i$ ($i=1, \\ldots,\nn$). These expected numbers are commonly calculated based on the size\nand demographic characteristics of the population living in area $i$\n\\cite{lee-etal-2011}. Further, let\n$y_{i}$ denote the number of cases or deaths in region $i$. When the\ndisease is non-contagious and rare, it is usually reasonable to assume that\n\n", "index": 1, "text": "\\begin{gather*}\n   y_i \\mid \\theta_i \\sim \\text{Poisson}(E_i \\theta_i),\n\\end{gather*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle y_{i}\\mid\\theta_{i}\\sim\\text{Poisson}(E_{i}\\theta_{i}),\" display=\"block\"><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>\u2223</mo><msub><mi>\u03b8</mi><mi>i</mi></msub><mo>\u223c</mo><mtext>Poisson</mtext><mrow><mo stretchy=\"false\">(</mo><msub><mi>E</mi><mi>i</mi></msub><msub><mi>\u03b8</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01180.tex", "nexttext": "\nHere, $\\mu$ denotes the overall risk level, $\\mathbf{z}^\\top_i =\n(z_{i1}, \\ldots, z_{ip})^\\top$ a set of $p$ covariates with\ncorresponding regression parameters $\\beta=(\\beta_1, \\ldots,\n\\beta_p)^\\top$, and $b_i$ a random effect. For $\\mu$ and\n$\\mathbf{\\beta}$ we assign weekly informative Gaussian distributions\nwith mean zero and variance 100. The random effects $\\mathbf{b} =\n  (b_1, \\ldots,b_n)^\\top$ are used to account for extra-Poisson\n  variation or spatial correlation due to latent or unmeasured\n  risk factors. In the following, we will review four models\nthat are commonly used for~$\\mathbf{b}$.\n\n\\section{Modelling the spatial dependency structure}\\label{sec:spatialModels}\n\nIn general, it seems reasonable to assume that areas that are close in space show\nmore similar disease burden than areas that are not close. To\ndefine what\n``close'' means we need to set up a neighbourhood structure.  A common\nassumption is to regard areas $i$ and $j$ as neighbours if they\nshare a common border, denoted here as $i \\sim j$.\nThis seems reasonable if the regions are equally sized and arranged\nin a regular pattern \\cite{wakefield-2007}. We further denote the\nset of neighbours of region $i$  by $\\delta i$ and its size by\n$n_{\\delta i}$.\n\n\\subsection{Review of common models}\\label{sec:review}\n\\subsubsection{The Besag model}\\label{sec:besag}\nOne of the  most popular approaches to model spatial correlation is an\nintrinsic Gaussian Markov random field (GMRF) model\n\\cite{besag-etal-1991}, here referred to as the Besag model.\nThe conditional distribution for $b_i$ is\n\n", "itemtype": "equation", "pos": 10959, "prevtext": "\nwhere $\\theta_i$, $i=1, \\ldots, n$, denotes the underlying true area-specific relative risk \\cite{bernardinelli-etal-1995}.\n\nThe maximum likelihood estimator of $\\theta_i$ is given by $\\hat{\\theta}_i =\ny_i/E_i$ and corresponds to the standardised mortality ratio (SMR) if the\ncounts represent deaths. Mapping the SMRs directly can, however, be\nmisleading. Areas with extreme SMR values often have small expected\nnumbers, so that sampling variability is more pronounced. This is\nreflected in large values for $\\text{Var}(\\hat{\\theta}_i) =\n\\theta_i/E_i$, see Bernardinelli et\nal. \\cite{bernadinelli-etal-1997} or Wakefield \\cite{wakefield-2007} for more\ndetails.\n\nDue to these potential instabilities, methods have been proposed to\nsmooth the raw estimates over space. Bayesian hierarchical models are\ncommonly used in this context, where the latent model involves random\neffects that borrow strength over neighbouring regions and such\nachieve local smoothness \\cite{bernadinelli-etal-1997}. We refer to\nLawson \\cite{lawson-book} and Banerjee et al. \\cite{banerjee-book} for a\ndetailed description of the class of Bayesian hierarchical models.\n\nA general model formulation is to assume that the log risk $\\eta_i =\n\\log(\\theta_i)$ has the decomposition:\n\n", "index": 3, "text": "\\begin{gather*}\n  \\eta_i = \\mu + \\mathbf{z}_i^\\top \\mathbf{\\beta} + b_i.\n\\end{gather*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\eta_{i}=\\mu+\\mathbf{z}_{i}^{\\top}\\mathbf{\\beta}+b_{i}.\" display=\"block\"><mrow><mrow><msub><mi>\u03b7</mi><mi>i</mi></msub><mo>=</mo><mrow><mi>\u03bc</mi><mo>+</mo><mrow><msubsup><mi>\ud835\udc33</mi><mi>i</mi><mo>\u22a4</mo></msubsup><mo>\u2062</mo><mi>\u03b2</mi></mrow><mo>+</mo><msub><mi>b</mi><mi>i</mi></msub></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01180.tex", "nexttext": "\nwhere $\\tau_b$ is a precision parameter and $\\mathbf{b}_{-i} = (b_1,\n\\ldots, b_{i-1}, b_{i+1}, \\ldots, b_n)^\\top$. The\nmean of $b_i$ equals  the mean of the effects\nover all neighbours, and the  precision is proportional to the number of\nneighbours. The joint distribution for $\\mathbf{b}$ is\n\n", "itemtype": "equation", "pos": 12619, "prevtext": "\nHere, $\\mu$ denotes the overall risk level, $\\mathbf{z}^\\top_i =\n(z_{i1}, \\ldots, z_{ip})^\\top$ a set of $p$ covariates with\ncorresponding regression parameters $\\beta=(\\beta_1, \\ldots,\n\\beta_p)^\\top$, and $b_i$ a random effect. For $\\mu$ and\n$\\mathbf{\\beta}$ we assign weekly informative Gaussian distributions\nwith mean zero and variance 100. The random effects $\\mathbf{b} =\n  (b_1, \\ldots,b_n)^\\top$ are used to account for extra-Poisson\n  variation or spatial correlation due to latent or unmeasured\n  risk factors. In the following, we will review four models\nthat are commonly used for~$\\mathbf{b}$.\n\n\\section{Modelling the spatial dependency structure}\\label{sec:spatialModels}\n\nIn general, it seems reasonable to assume that areas that are close in space show\nmore similar disease burden than areas that are not close. To\ndefine what\n``close'' means we need to set up a neighbourhood structure.  A common\nassumption is to regard areas $i$ and $j$ as neighbours if they\nshare a common border, denoted here as $i \\sim j$.\nThis seems reasonable if the regions are equally sized and arranged\nin a regular pattern \\cite{wakefield-2007}. We further denote the\nset of neighbours of region $i$  by $\\delta i$ and its size by\n$n_{\\delta i}$.\n\n\\subsection{Review of common models}\\label{sec:review}\n\\subsubsection{The Besag model}\\label{sec:besag}\nOne of the  most popular approaches to model spatial correlation is an\nintrinsic Gaussian Markov random field (GMRF) model\n\\cite{besag-etal-1991}, here referred to as the Besag model.\nThe conditional distribution for $b_i$ is\n\n", "index": 5, "text": "\\begin{gather}\n   b_i \\mid \\mathbf{b}_{-i}, \\tau_b \\sim\n   \\mathcal{N}\\left(\\frac{1}{n_{\\delta i}} \\sum_{j \\in \\delta i} b_j,\n       \\frac{1}{n_{\\delta i} \\tau_b}\\right), \\label{eq:besag}\n\\end{gather}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle b_{i}\\mid\\mathbf{b}_{-i},\\tau_{b}\\sim\\mathcal{N}\\left(\\frac{1}{n%&#10;_{\\delta i}}\\sum_{j\\in\\delta i}b_{j},\\frac{1}{n_{\\delta i}\\tau_{b}}\\right),\" display=\"block\"><mrow><msub><mi>b</mi><mi>i</mi></msub><mo>\u2223</mo><msub><mi>\ud835\udc1b</mi><mrow><mo>-</mo><mi>i</mi></mrow></msub><mo>,</mo><msub><mi>\u03c4</mi><mi>b</mi></msub><mo>\u223c</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca9</mi><mrow><mo>(</mo><mfrac><mn>1</mn><msub><mi>n</mi><mrow><mi>\u03b4</mi><mo>\u2062</mo><mi>i</mi></mrow></msub></mfrac><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>j</mi><mo>\u2208</mo><mrow><mi>\u03b4</mi><mo>\u2062</mo><mi>i</mi></mrow></mrow></munder><msub><mi>b</mi><mi>j</mi></msub><mo>,</mo><mfrac><mn>1</mn><mrow><msub><mi>n</mi><mrow><mi>\u03b4</mi><mo>\u2062</mo><mi>i</mi></mrow></msub><mo>\u2062</mo><msub><mi>\u03c4</mi><mi>b</mi></msub></mrow></mfrac><mo>)</mo></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01180.tex", "nexttext": "\nwhere the precision matrix $\\mathbf{Q}$ has the entries\n\n", "itemtype": "equation", "pos": 13113, "prevtext": "\nwhere $\\tau_b$ is a precision parameter and $\\mathbf{b}_{-i} = (b_1,\n\\ldots, b_{i-1}, b_{i+1}, \\ldots, b_n)^\\top$. The\nmean of $b_i$ equals  the mean of the effects\nover all neighbours, and the  precision is proportional to the number of\nneighbours. The joint distribution for $\\mathbf{b}$ is\n\n", "index": 7, "text": "\\begin{align*}\n  \\pi(\\mathbf{b}\\mid \\tau_b) &\\propto \\exp \\left(-\n    \\frac{\\tau_b}{2} \\sum_{i \\sim j} (b_i -b_j)^2 \\right)\n\n \\propto \\exp \\left(-\n    \\frac{\\tau_b}{2} \\mathbf{b}^\\top \\mathbf{Q} \\mathbf{b} \\right),\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\pi(\\mathbf{b}\\mid\\tau_{b})\" display=\"inline\"><mrow><mi>\u03c0</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc1b</mi><mo>\u2223</mo><msub><mi>\u03c4</mi><mi>b</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\propto\\exp\\left(-\\frac{\\tau_{b}}{2}\\sum_{i\\sim j}(b_{i}-b_{j})^{%&#10;2}\\right)\\par&#10;\\propto\\exp\\left(-\\frac{\\tau_{b}}{2}\\mathbf{b}^{\\top}\\mathbf{Q}%&#10;\\mathbf{b}\\right),\" display=\"inline\"><mrow><mrow><mi/><mo>\u221d</mo><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo>(</mo><mrow><mo>-</mo><mrow><mstyle displaystyle=\"true\"><mfrac><msub><mi>\u03c4</mi><mi>b</mi></msub><mn>2</mn></mfrac></mstyle><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>\u223c</mo><mi>j</mi></mrow></munder></mstyle><msup><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>b</mi><mi>i</mi></msub><mo>-</mo><msub><mi>b</mi><mi>j</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></mrow></mrow></mrow><mo>)</mo></mrow></mrow><mo>\u221d</mo><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo>(</mo><mrow><mo>-</mo><mrow><mstyle displaystyle=\"true\"><mfrac><msub><mi>\u03c4</mi><mi>b</mi></msub><mn>2</mn></mfrac></mstyle><mo>\u2062</mo><msup><mi>\ud835\udc1b</mi><mo>\u22a4</mo></msup><mo>\u2062</mo><mi>\ud835\udc10\ud835\udc1b</mi></mrow></mrow><mo>)</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01180.tex", "nexttext": "\nThe model is intrinsic in the sense that $\\mathbf{Q}$ is singular,\ni.e. it has a non-empty null-space  $\\mathbf{V}$, see Rue and Held (Section 3) for\ndetails \\cite{gmrfbook}.  For any map, $\\mathbf{1}$, denoting a vector of length $n$ with only\nones, is an eigenvector of $\\mathbf{Q}$ with eigenvalue $0$. \nHence the density is invariant to the addition of a constant.  If the spatial map has islands the\ndefinition of the null-space is more complex and depends on how\nislands are defined, i.e. whether they form a new unconnected graph or\nare linked to the main land, see Section 5.2.1 in Hodges \\citep{hodges-2013}.\nThe rank deficiency of the Besag model is equal to the number of\nconnected subgraphs. The rank deficiency is equal to one if all\nregions are connected. Hence, the density for the Besag model is \n\n", "itemtype": "equation", "pos": 13397, "prevtext": "\nwhere the precision matrix $\\mathbf{Q}$ has the entries\n\n", "index": 9, "text": "\\begin{gather}\n  Q_{ij} =  \\begin{cases}\n    n_{\\delta i} & i = j,\\\\\n    -1 & i \\sim j, \\\\\n    0 & \\mbox{else.}\n\\end{cases}\\label{eq:besagQ}\n\\end{gather}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle Q_{ij}=\\begin{cases}n_{\\delta i}&amp;i=j,\\\\&#10;-1&amp;i\\sim j,\\\\&#10;0&amp;\\mbox{else.}\\end{cases}\" display=\"block\"><mrow><msub><mi>Q</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>=</mo><mrow><mo>{</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><msub><mi>n</mi><mrow><mi>\u03b4</mi><mo>\u2062</mo><mi>i</mi></mrow></msub></mtd><mtd columnalign=\"left\"><mrow><mrow><mi>i</mi><mo>=</mo><mi>j</mi></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mrow><mo>-</mo><mn>1</mn></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mi>i</mi><mo>\u223c</mo><mi>j</mi></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mn>0</mn></mtd><mtd columnalign=\"left\"><mtext>else.</mtext></mtd></mtr></mtable></mrow></mrow></math>", "type": "latex"}, {"file": "1601.01180.tex", "nexttext": "\nwhere $I$ denotes the number of connected subgraphs and $K$ is a\nconstant \\citep{hodges-2013}.\nTo prevent confounding with the intercept, sum-to-zero constraints are\nimposed on each connected subgraph. \n\n\n\n\n\\subsubsection{The BYM model}\n\nThe Besag model only assumes a spatially structured component and\ncannot take the limiting form that allows for no spatially structured\nvariability.\nHence, unstructured random error or pure overdispersion within area $i$, will be modelled as spatial correlation, giving misleading\nparameter estimates \\cite{breslow-etal-1998}.\n\nTo address this issue, the Besag-York-Molli{\\'e} (BYM) model  \\cite{besag-etal-1991}\ndecomposes the regional spatial effect $\\mathbf{b}$ into a sum of an unstructured\nand a structured spatial component, so that $\\mathbf{b} = \\mathbf{v} + \\mathbf{u}$.\nHere, $\\mathbf{v} \\sim \\mathcal{N}(\\mathbf{0}, \\tau_v^{-1}\\mathbf{I})$\naccounts for pure overdispersion, while  $\\mathbf{u} \\sim \\mathcal{N}(\\mathbf{0},\n\\tau_u^{-1}\\mathbf{Q}^{-})$ is the Besag model (Section\n\\ref{sec:besag}), whereby $\\mathbf{Q}^{-}$ denotes the generalised inverse\nof $\\mathbf{Q}$. The resulting covariance matrix of\n$\\mathbf{b}$ is\n\n", "itemtype": "equation", "pos": 14364, "prevtext": "\nThe model is intrinsic in the sense that $\\mathbf{Q}$ is singular,\ni.e. it has a non-empty null-space  $\\mathbf{V}$, see Rue and Held (Section 3) for\ndetails \\cite{gmrfbook}.  For any map, $\\mathbf{1}$, denoting a vector of length $n$ with only\nones, is an eigenvector of $\\mathbf{Q}$ with eigenvalue $0$. \nHence the density is invariant to the addition of a constant.  If the spatial map has islands the\ndefinition of the null-space is more complex and depends on how\nislands are defined, i.e. whether they form a new unconnected graph or\nare linked to the main land, see Section 5.2.1 in Hodges \\citep{hodges-2013}.\nThe rank deficiency of the Besag model is equal to the number of\nconnected subgraphs. The rank deficiency is equal to one if all\nregions are connected. Hence, the density for the Besag model is \n\n", "index": 11, "text": "\\begin{equation*}\n  \\pi(\\mathbf{b}\\mid \\tau_b) = K \\tau_b^{(n-I)/2}\\exp \\left(-\n    \\frac{\\tau_b}{2} \\mathbf{b}^\\top \\mathbf{Q} \\mathbf{b} \\right),\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m1\" class=\"ltx_Math\" alttext=\"\\pi(\\mathbf{b}\\mid\\tau_{b})=K\\tau_{b}^{(n-I)/2}\\exp\\left(-\\frac{\\tau_{b}}{2}%&#10;\\mathbf{b}^{\\top}\\mathbf{Q}\\mathbf{b}\\right),\" display=\"block\"><mrow><mi>\u03c0</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc1b</mi><mo>\u2223</mo><msub><mi>\u03c4</mi><mi>b</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>=</mo><mi>K</mi><msubsup><mi>\u03c4</mi><mi>b</mi><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>n</mi><mo>-</mo><mi>I</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>/</mo><mn>2</mn></mrow></msubsup><mi>exp</mi><mrow><mo>(</mo><mo>-</mo><mfrac><msub><mi>\u03c4</mi><mi>b</mi></msub><mn>2</mn></mfrac><msup><mi>\ud835\udc1b</mi><mo>\u22a4</mo></msup><mi>\ud835\udc10\ud835\udc1b</mi><mo>)</mo></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01180.tex", "nexttext": "\n\n\\subsubsection{The Leroux model}\n\nIn the BYM model, the  structured and unstructured\ncomponents cannot be seen independently from each other, and are thus\nnot identifiable\n\\cite{macnab-2010}. An additional challenge, which makes the choice of\nhyperpriors more difficult, is that $\\tau_v$ and\n$\\tau_u$ do not represent variability on the same level. While $\\tau_v^{-1}$ can be\ninterpreted as the marginal variance of the unstructured random effects,\n$\\tau_u^{-1}$ controls the variability of the structured component\n$u_i$, conditional on the effects in its neighbouring areas \\cite{bernardinelli-etal-1995,\n  wakefield-2007}.\nLeroux et al. \\cite{leroux-etal-2000} proposed an alternative model\nformulation to make the compromise between unstructured and structured\nvariation more explicit. Here, $\\mathbf{b}$ is assumed to follow a\nnormal distribution with mean zero and covariance matrix\n\n", "itemtype": "equation", "pos": 15697, "prevtext": "\nwhere $I$ denotes the number of connected subgraphs and $K$ is a\nconstant \\citep{hodges-2013}.\nTo prevent confounding with the intercept, sum-to-zero constraints are\nimposed on each connected subgraph. \n\n\n\n\n\\subsubsection{The BYM model}\n\nThe Besag model only assumes a spatially structured component and\ncannot take the limiting form that allows for no spatially structured\nvariability.\nHence, unstructured random error or pure overdispersion within area $i$, will be modelled as spatial correlation, giving misleading\nparameter estimates \\cite{breslow-etal-1998}.\n\nTo address this issue, the Besag-York-Molli{\\'e} (BYM) model  \\cite{besag-etal-1991}\ndecomposes the regional spatial effect $\\mathbf{b}$ into a sum of an unstructured\nand a structured spatial component, so that $\\mathbf{b} = \\mathbf{v} + \\mathbf{u}$.\nHere, $\\mathbf{v} \\sim \\mathcal{N}(\\mathbf{0}, \\tau_v^{-1}\\mathbf{I})$\naccounts for pure overdispersion, while  $\\mathbf{u} \\sim \\mathcal{N}(\\mathbf{0},\n\\tau_u^{-1}\\mathbf{Q}^{-})$ is the Besag model (Section\n\\ref{sec:besag}), whereby $\\mathbf{Q}^{-}$ denotes the generalised inverse\nof $\\mathbf{Q}$. The resulting covariance matrix of\n$\\mathbf{b}$ is\n\n", "index": 13, "text": "\\begin{gather*}\n  \\text{Var}(\\mathbf{b}\\mid \\tau_u,\\tau_v) =\\tau_v^{-1}\\mathbf{I} + \\tau_u^{-1} \\mathbf{Q}^{-}.\n\\end{gather*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\text{Var}(\\mathbf{b}\\mid\\tau_{u},\\tau_{v})=\\tau_{v}^{-1}\\mathbf{%&#10;I}+\\tau_{u}^{-1}\\mathbf{Q}^{-}.\" display=\"block\"><mrow><mtext>Var</mtext><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc1b</mi><mo>\u2223</mo><msub><mi>\u03c4</mi><mi>u</mi></msub><mo>,</mo><msub><mi>\u03c4</mi><mi>v</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>=</mo><msubsup><mi>\u03c4</mi><mi>v</mi><mrow><mo>-</mo><mn>1</mn></mrow></msubsup><mi>\ud835\udc08</mi><mo>+</mo><msubsup><mi>\u03c4</mi><mi>u</mi><mrow><mo>-</mo><mn>1</mn></mrow></msubsup><msup><mi>\ud835\udc10</mi><mo>-</mo></msup><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01180.tex", "nexttext": "\nwhere $\\phi\\in [0,1]$ denotes a mixing parameter. The model reduces to pure overdispersion if $\\phi = 0$, and to the Besag\nmodel when $\\phi =1$ \\cite{lee-durban,macnab-2010}. The conditional expectation of $b_i$, given all other\nrandom effects, results as a weighted average of the zero-mean unstructured model and the mean value of the Besag model \\eqref{eq:besag}.\nThe conditional variance is the weighted average of $1/\\tau_b$ and\n$1/(\\tau_b \\cdot n_{\\delta i})$.\n\n\\subsubsection{The Dean model}\n\nDean et al. \\cite{dean-etal-2001} proposed a reparameterisation of the\nBYM model where\n\n", "itemtype": "equation", "pos": 16713, "prevtext": "\n\n\\subsubsection{The Leroux model}\n\nIn the BYM model, the  structured and unstructured\ncomponents cannot be seen independently from each other, and are thus\nnot identifiable\n\\cite{macnab-2010}. An additional challenge, which makes the choice of\nhyperpriors more difficult, is that $\\tau_v$ and\n$\\tau_u$ do not represent variability on the same level. While $\\tau_v^{-1}$ can be\ninterpreted as the marginal variance of the unstructured random effects,\n$\\tau_u^{-1}$ controls the variability of the structured component\n$u_i$, conditional on the effects in its neighbouring areas \\cite{bernardinelli-etal-1995,\n  wakefield-2007}.\nLeroux et al. \\cite{leroux-etal-2000} proposed an alternative model\nformulation to make the compromise between unstructured and structured\nvariation more explicit. Here, $\\mathbf{b}$ is assumed to follow a\nnormal distribution with mean zero and covariance matrix\n\n", "index": 15, "text": "\\begin{gather}\n  \\text{Var}(\\mathbf{b}\\mid \\tau_b, \\phi) = \\tau_b^{-1}\\left((1-\\phi) \\: \\mathbf{I} + \\phi \\mathbf{Q}\\right)^{-1}, \\label{eq:leroux}\n\\end{gather}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\text{Var}(\\mathbf{b}\\mid\\tau_{b},\\phi)=\\tau_{b}^{-1}\\left((1-%&#10;\\phi)\\&gt;\\mathbf{I}+\\phi\\mathbf{Q}\\right)^{-1},\" display=\"block\"><mrow><mtext>Var</mtext><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc1b</mi><mo>\u2223</mo><msub><mi>\u03c4</mi><mi>b</mi></msub><mo>,</mo><mi>\u03d5</mi><mo stretchy=\"false\">)</mo></mrow><mo>=</mo><msubsup><mi>\u03c4</mi><mi>b</mi><mrow><mo>-</mo><mn>1</mn></mrow></msubsup><msup><mrow><mo>(</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo>-</mo><mi>\u03d5</mi><mo rspace=\"4.7pt\" stretchy=\"false\">)</mo></mrow><mi>\ud835\udc08</mi><mo>+</mo><mi>\u03d5</mi><mi>\ud835\udc10</mi><mo>)</mo></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01180.tex", "nexttext": "\nhaving covariance matrix\n\n", "itemtype": "equation", "pos": 17461, "prevtext": "\nwhere $\\phi\\in [0,1]$ denotes a mixing parameter. The model reduces to pure overdispersion if $\\phi = 0$, and to the Besag\nmodel when $\\phi =1$ \\cite{lee-durban,macnab-2010}. The conditional expectation of $b_i$, given all other\nrandom effects, results as a weighted average of the zero-mean unstructured model and the mean value of the Besag model \\eqref{eq:besag}.\nThe conditional variance is the weighted average of $1/\\tau_b$ and\n$1/(\\tau_b \\cdot n_{\\delta i})$.\n\n\\subsubsection{The Dean model}\n\nDean et al. \\cite{dean-etal-2001} proposed a reparameterisation of the\nBYM model where\n\n", "index": 17, "text": "\\begin{gather}\n  \\mathbf{b} = \\frac{1}{\\sqrt{\\tau_b}} \\left(\\sqrt{1-\\phi} \\:\\mathbf{v} +\n    \\sqrt{\\phi} \\:\\mathbf{u}\\right) \\label{eq:dean},\n\\end{gather}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\mathbf{b}=\\frac{1}{\\sqrt{\\tau_{b}}}\\left(\\sqrt{1-\\phi}\\&gt;\\mathbf{%&#10;v}+\\sqrt{\\phi}\\&gt;\\mathbf{u}\\right),\" display=\"block\"><mrow><mrow><mi>\ud835\udc1b</mi><mo>=</mo><mrow><mfrac><mn>1</mn><msqrt><msub><mi>\u03c4</mi><mi>b</mi></msub></msqrt></mfrac><mo>\u2062</mo><mrow><mo>(</mo><mrow><mrow><mpadded width=\"+2.2pt\"><msqrt><mrow><mn>1</mn><mo>-</mo><mi>\u03d5</mi></mrow></msqrt></mpadded><mo>\u2062</mo><mi>\ud835\udc2f</mi></mrow><mo>+</mo><mrow><mpadded width=\"+2.2pt\"><msqrt><mi>\u03d5</mi></msqrt></mpadded><mo>\u2062</mo><mi>\ud835\udc2e</mi></mrow></mrow><mo>)</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01180.tex", "nexttext": "\nEquation \\eqref{eq:dean} is a reparameterisation of the original BYM\nmodel,\nwhere $\\tau_u^{-1} =\\tau_b^{-1} \\phi$ and $\\tau_v^{-1} = \\tau_b^{-1}\n (1-\\phi)$ \\cite{macnab-2010}.\nThe additive decomposition of the variance is then on the log\nrelative risk scale. This is in contrast to the Leroux model  \\eqref{eq:leroux}, where\nthe precision matrix of $\\mathbf{b}$ resulted as a weighted average of the\nprecision matrices of the unstructured and structured spatial\ncomponents. As a consequence, the additive\ndecomposition of variance in the Leroux model happens on the log relative risk scale,\nconditional on $b_j$, $j \\in \\delta i$ \\cite{leroux-etal-2000}.\n\n\n\\subsection{Why do we need scaling?}\\label{sec:scaling}\n\nOne issue inherent to all the models described in\nSection~\\ref{sec:review}, is that the spatially structured component is\nnot scaled. However, as discussed in S{\\o}rbye and\nRue\\cite{sorbye-rue-2014}, scaling is crucial to facilitate hyperprior\nassignment and guarantee that hyperpriors used in\none application have the same interpretation in another application.\n\nThe Besag model is an intrinsic GMRF  and penalises local deviation from its null\nspace, which is a constant level in the case of one connected component \\cite{gmrfbook}. \nThe\nhyperprior will control this local deviation and, as such,  influence\nthe smoothness of the estimated spatial effects. If the estimated field is too\nsmooth, the precision is large and potential spatial variation might be\nblurred. On the other hand,  if the precision is too small the model might overfit due to large local variability \\citep{sorbye-rue-2014}.\n\nIn the following we consider only the structured effect $\\mathbf{b}$\nas introduced in the Besag model in Section \\ref{sec:besag}.  In general, the marginal variances\n$\\tau_b^{-1}[\\mathbf{Q}^{-}]_{ii}$ depend on the graph\nstructure reflected by the structure matrix $\\mathbf{Q}$ \\cite{sorbye-rue-2014}.\nThis can be illustrated by calculating a generalized variance, computed as\nthe geometric mean (or some other\ntypical value) of the marginal variances\n \\begin{eqnarray}\n  \\sigma_{\\text{GV}}^2(\\mathbf{u}) &= &  \\exp \\left(\\frac{1}{n}\\sum_{i=1}^n\n    \\log\\left(\\frac{1}{\\tau_b} [\\mathbf{Q}^{-}]_{ii}\\right) \\right)\n    = \\frac{1}{\\tau_b} \\exp \\left(\\frac{1}{n}\\sum_{i=1}^n\n    \\log([\\mathbf{Q}^{-}]_{ii}) \\right). \\label{eq:cv}\n\\end{eqnarray}\n\nThe generalized variance  for two different graph structures are typically not equal, even when the graphs have the same number of regions.\n\n\n\nAs an example, Figure~\\ref{fig:germany} shows\ntwo administrative regions of Germany, Mittelfranken and  Arnsberg,\nthat are both fully connected. Assume that we fit models to these two regions separately, including\na spatially structured effect in the models. As both regions have 12\ndistricts, we may be tempted to use identical  priors for the precision\n$\\tau_b$ in these two cases.  However, the prior will penalise the local deviation from\na constant level, differently. Specifically, if $\\tau_b = 1$ in \\eqref{eq:cv}, it follows that\n$\\sigma_{\\text{GV}}^2(\\mathbf{b}) \\approx 0.29$ for Mittelfranken and\n$\\sigma_{\\text{GV}}^2(\\mathbf{b}) \\approx 0.40$ for Arnsberg.\nIf we fit a similar model to all the $544$ districts in Germany, we obtain\n$\\sigma_{\\text{GV}}^2(\\mathbf{b}) \\approx 0.56$.\nThese  differences, reflecting a characteristic level for the marginal\nvariances, might be even more striking for other applications. We find\nthat the value of the generalised variance is larger for more complex\nneighbourhood structures, for example for the map of the 3111 counties\nin the continental United States we obtain\n$\\sigma_{\\text{GV}}^2(\\mathbf{b}) \\approx 4.78$.\n In order to\nunify the interpretation of a chosen prior for $\\tau_b$ and make it  transferable\nbetween applications, the structured effect needs to be scaled so that\n$\\sigma_{\\text{GV}}^2(\\mathbf{b}) = 1/\\tau_b$. This implies that $\\tau_b$\nrepresents the precision of the (marginal) deviation from a constant\nlevel, independently of the underlying graph.\n\nThis issue of scaling applies to all IGMRFs \\cite{sorbye-rue-2014}. In practice, the scaling might be costly, as it involves inversion of a singular\nmatrix. The generalised inverse can be used, but the relative tolerance\nthreshold to detect zero singular values will be crucial. Knowing the\nrank deficiency $r$ of the matrix, the $r$ smallest eigenvalues could\nbe removed. IGMRFs have much in common with GMRFs conditional on\nlinear constraints, see~\\citep[Section 3.2]{gmrfbook}. Hence, if we know\nthe null space $\\mathbf{V}$ of $\\mathbf{Q}$,  we can use\nsparse matrix algebra to  compute $[\\mathbf{Q}^{-}]_{ii}$.\n The marginal variances can be computed based on\n$\\mathbf{b} \\mid \\mathbf{V}^\\top \\mathbf{b} = \\mathbf{0}$. First, $\\mathbf{Q}$ is\nmade regular by adding a small term $\\epsilon$ to the diagonal and then\n $\\text{Diag}(\\text{Var}(\\mathbf{b} \\mid \\mathbf{V}^\\top \\mathbf{b}=\\mathbf{0}))$ is computed according to \\citep[Section 3.2, Equation 3.17]{gmrfbook}. In this way,  we take advantage of the sparse matrix structure of\n   $\\mathbf{Q}$. Extracting the variance components, we compute\n   $\\sigma_{\\text{GV}}^2$ and use this as a factor to scale\n   $\\mathbf{Q}$. \nThe R-package {\\tt INLA}, available from \\url{www.r-inla.org}, offers\na function {\\tt inla.scale.model} which takes as argument \nany singular precision matrix $\\mathbf{Q}$ and  the linear constraints\nspanning the null-space of $\\mathbf{Q}$. The scaled precision matrix,\nwhere the geometric mean of the marginal variances is equal to one, is\nreturned. \nFor the  Besag model on a connected graph we have\n$\\mathbf{V} =   \\mathbf{1}$, \n\n\nso that we can scale the matrix in {\\texttt R} using\n\\begin{Sinput}\nR> Q = inla.scale.model(Q,\n     constr=list(A=matrix(1, nrow=1, ncol=n), e=0))\n\\end{Sinput}\n\n\\begin{figure}\n\\centering\n\\includegraphics[width=0.5\\textwidth]{germany}\n\\caption{Map of Germany separated in $544$ districts. Marked in gray\n  are the administrative districts Arnsberg in the federal state\n  Nordrhein-Westfalen  and Mittelfranken  in Bayern. Both areas\n  consist of 12 districts.\\label{fig:germany} }\n\\end{figure}\n\nWe would like to note that scaling is also crucial if the goal is\nhypothesis testing involving an IGMRF, as for example in Dean et al.~\\cite{dean-etal-2001}, as otherwise the\ncritical region would be naturally dependent on the scale of the\nrandom effect. This also applies outside a Bayesian setting.\n\n\\subsection{A modified BYM model accounting for scaling}\n\nSimpson et al. \\cite{simpson-etal-2015} propose a modification of the Dean model which\naddresses both  the identifiability and scaling issue of the BYM model. The model uses a scaled structured\ncomponent $\\mathbf{u}_\\star$, where $\\mathbf{Q_\\star}$ is the\nprecision matrix of the Besag model, scaled according to Section \\ref{sec:scaling}. This gives a modified version of the random effect\n\n", "itemtype": "equation", "pos": 17641, "prevtext": "\nhaving covariance matrix\n\n", "index": 19, "text": "\\begin{gather}\n  \\text{Var}(\\mathbf{b}\\mid \\tau_b, \\phi) = \\tau_b^{-1}\\left((1-\\phi) \\: \\mathbf{I} + \\phi \\mathbf{Q}^{-}\\right)\\label{eq:varbym2}.\n\\end{gather}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\text{Var}(\\mathbf{b}\\mid\\tau_{b},\\phi)=\\tau_{b}^{-1}\\left((1-%&#10;\\phi)\\&gt;\\mathbf{I}+\\phi\\mathbf{Q}^{-}\\right).\" display=\"block\"><mrow><mtext>Var</mtext><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc1b</mi><mo>\u2223</mo><msub><mi>\u03c4</mi><mi>b</mi></msub><mo>,</mo><mi>\u03d5</mi><mo stretchy=\"false\">)</mo></mrow><mo>=</mo><msubsup><mi>\u03c4</mi><mi>b</mi><mrow><mo>-</mo><mn>1</mn></mrow></msubsup><mrow><mo>(</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo>-</mo><mi>\u03d5</mi><mo rspace=\"4.7pt\" stretchy=\"false\">)</mo></mrow><mi>\ud835\udc08</mi><mo>+</mo><mi>\u03d5</mi><msup><mi>\ud835\udc10</mi><mo>-</mo></msup><mo>)</mo></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01180.tex", "nexttext": "\nhaving covariance matrix\n\n", "itemtype": "equation", "pos": 24685, "prevtext": "\nEquation \\eqref{eq:dean} is a reparameterisation of the original BYM\nmodel,\nwhere $\\tau_u^{-1} =\\tau_b^{-1} \\phi$ and $\\tau_v^{-1} = \\tau_b^{-1}\n (1-\\phi)$ \\cite{macnab-2010}.\nThe additive decomposition of the variance is then on the log\nrelative risk scale. This is in contrast to the Leroux model  \\eqref{eq:leroux}, where\nthe precision matrix of $\\mathbf{b}$ resulted as a weighted average of the\nprecision matrices of the unstructured and structured spatial\ncomponents. As a consequence, the additive\ndecomposition of variance in the Leroux model happens on the log relative risk scale,\nconditional on $b_j$, $j \\in \\delta i$ \\cite{leroux-etal-2000}.\n\n\n\\subsection{Why do we need scaling?}\\label{sec:scaling}\n\nOne issue inherent to all the models described in\nSection~\\ref{sec:review}, is that the spatially structured component is\nnot scaled. However, as discussed in S{\\o}rbye and\nRue\\cite{sorbye-rue-2014}, scaling is crucial to facilitate hyperprior\nassignment and guarantee that hyperpriors used in\none application have the same interpretation in another application.\n\nThe Besag model is an intrinsic GMRF  and penalises local deviation from its null\nspace, which is a constant level in the case of one connected component \\cite{gmrfbook}. \nThe\nhyperprior will control this local deviation and, as such,  influence\nthe smoothness of the estimated spatial effects. If the estimated field is too\nsmooth, the precision is large and potential spatial variation might be\nblurred. On the other hand,  if the precision is too small the model might overfit due to large local variability \\citep{sorbye-rue-2014}.\n\nIn the following we consider only the structured effect $\\mathbf{b}$\nas introduced in the Besag model in Section \\ref{sec:besag}.  In general, the marginal variances\n$\\tau_b^{-1}[\\mathbf{Q}^{-}]_{ii}$ depend on the graph\nstructure reflected by the structure matrix $\\mathbf{Q}$ \\cite{sorbye-rue-2014}.\nThis can be illustrated by calculating a generalized variance, computed as\nthe geometric mean (or some other\ntypical value) of the marginal variances\n \\begin{eqnarray}\n  \\sigma_{\\text{GV}}^2(\\mathbf{u}) &= &  \\exp \\left(\\frac{1}{n}\\sum_{i=1}^n\n    \\log\\left(\\frac{1}{\\tau_b} [\\mathbf{Q}^{-}]_{ii}\\right) \\right)\n    = \\frac{1}{\\tau_b} \\exp \\left(\\frac{1}{n}\\sum_{i=1}^n\n    \\log([\\mathbf{Q}^{-}]_{ii}) \\right). \\label{eq:cv}\n\\end{eqnarray}\n\nThe generalized variance  for two different graph structures are typically not equal, even when the graphs have the same number of regions.\n\n\n\nAs an example, Figure~\\ref{fig:germany} shows\ntwo administrative regions of Germany, Mittelfranken and  Arnsberg,\nthat are both fully connected. Assume that we fit models to these two regions separately, including\na spatially structured effect in the models. As both regions have 12\ndistricts, we may be tempted to use identical  priors for the precision\n$\\tau_b$ in these two cases.  However, the prior will penalise the local deviation from\na constant level, differently. Specifically, if $\\tau_b = 1$ in \\eqref{eq:cv}, it follows that\n$\\sigma_{\\text{GV}}^2(\\mathbf{b}) \\approx 0.29$ for Mittelfranken and\n$\\sigma_{\\text{GV}}^2(\\mathbf{b}) \\approx 0.40$ for Arnsberg.\nIf we fit a similar model to all the $544$ districts in Germany, we obtain\n$\\sigma_{\\text{GV}}^2(\\mathbf{b}) \\approx 0.56$.\nThese  differences, reflecting a characteristic level for the marginal\nvariances, might be even more striking for other applications. We find\nthat the value of the generalised variance is larger for more complex\nneighbourhood structures, for example for the map of the 3111 counties\nin the continental United States we obtain\n$\\sigma_{\\text{GV}}^2(\\mathbf{b}) \\approx 4.78$.\n In order to\nunify the interpretation of a chosen prior for $\\tau_b$ and make it  transferable\nbetween applications, the structured effect needs to be scaled so that\n$\\sigma_{\\text{GV}}^2(\\mathbf{b}) = 1/\\tau_b$. This implies that $\\tau_b$\nrepresents the precision of the (marginal) deviation from a constant\nlevel, independently of the underlying graph.\n\nThis issue of scaling applies to all IGMRFs \\cite{sorbye-rue-2014}. In practice, the scaling might be costly, as it involves inversion of a singular\nmatrix. The generalised inverse can be used, but the relative tolerance\nthreshold to detect zero singular values will be crucial. Knowing the\nrank deficiency $r$ of the matrix, the $r$ smallest eigenvalues could\nbe removed. IGMRFs have much in common with GMRFs conditional on\nlinear constraints, see~\\citep[Section 3.2]{gmrfbook}. Hence, if we know\nthe null space $\\mathbf{V}$ of $\\mathbf{Q}$,  we can use\nsparse matrix algebra to  compute $[\\mathbf{Q}^{-}]_{ii}$.\n The marginal variances can be computed based on\n$\\mathbf{b} \\mid \\mathbf{V}^\\top \\mathbf{b} = \\mathbf{0}$. First, $\\mathbf{Q}$ is\nmade regular by adding a small term $\\epsilon$ to the diagonal and then\n $\\text{Diag}(\\text{Var}(\\mathbf{b} \\mid \\mathbf{V}^\\top \\mathbf{b}=\\mathbf{0}))$ is computed according to \\citep[Section 3.2, Equation 3.17]{gmrfbook}. In this way,  we take advantage of the sparse matrix structure of\n   $\\mathbf{Q}$. Extracting the variance components, we compute\n   $\\sigma_{\\text{GV}}^2$ and use this as a factor to scale\n   $\\mathbf{Q}$. \nThe R-package {\\tt INLA}, available from \\url{www.r-inla.org}, offers\na function {\\tt inla.scale.model} which takes as argument \nany singular precision matrix $\\mathbf{Q}$ and  the linear constraints\nspanning the null-space of $\\mathbf{Q}$. The scaled precision matrix,\nwhere the geometric mean of the marginal variances is equal to one, is\nreturned. \nFor the  Besag model on a connected graph we have\n$\\mathbf{V} =   \\mathbf{1}$, \n\n\nso that we can scale the matrix in {\\texttt R} using\n\\begin{Sinput}\nR> Q = inla.scale.model(Q,\n     constr=list(A=matrix(1, nrow=1, ncol=n), e=0))\n\\end{Sinput}\n\n\\begin{figure}\n\\centering\n\\includegraphics[width=0.5\\textwidth]{germany}\n\\caption{Map of Germany separated in $544$ districts. Marked in gray\n  are the administrative districts Arnsberg in the federal state\n  Nordrhein-Westfalen  and Mittelfranken  in Bayern. Both areas\n  consist of 12 districts.\\label{fig:germany} }\n\\end{figure}\n\nWe would like to note that scaling is also crucial if the goal is\nhypothesis testing involving an IGMRF, as for example in Dean et al.~\\cite{dean-etal-2001}, as otherwise the\ncritical region would be naturally dependent on the scale of the\nrandom effect. This also applies outside a Bayesian setting.\n\n\\subsection{A modified BYM model accounting for scaling}\n\nSimpson et al. \\cite{simpson-etal-2015} propose a modification of the Dean model which\naddresses both  the identifiability and scaling issue of the BYM model. The model uses a scaled structured\ncomponent $\\mathbf{u}_\\star$, where $\\mathbf{Q_\\star}$ is the\nprecision matrix of the Besag model, scaled according to Section \\ref{sec:scaling}. This gives a modified version of the random effect\n\n", "index": 21, "text": "\\begin{gather}\n  \\mathbf{b} = \\frac{1}{\\sqrt{\\tau_b}} \\left(\\sqrt{1-\\phi} \\:\\mathbf{v} +\n    \\sqrt{\\phi} \\:\\mathbf{u}_\\star\\right) \\label{eq:bym2},\n\\end{gather}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\mathbf{b}=\\frac{1}{\\sqrt{\\tau_{b}}}\\left(\\sqrt{1-\\phi}\\&gt;\\mathbf{%&#10;v}+\\sqrt{\\phi}\\&gt;\\mathbf{u}_{\\star}\\right),\" display=\"block\"><mrow><mrow><mi>\ud835\udc1b</mi><mo>=</mo><mrow><mfrac><mn>1</mn><msqrt><msub><mi>\u03c4</mi><mi>b</mi></msub></msqrt></mfrac><mo>\u2062</mo><mrow><mo>(</mo><mrow><mrow><mpadded width=\"+2.2pt\"><msqrt><mrow><mn>1</mn><mo>-</mo><mi>\u03d5</mi></mrow></msqrt></mpadded><mo>\u2062</mo><mi>\ud835\udc2f</mi></mrow><mo>+</mo><mrow><mpadded width=\"+2.2pt\"><msqrt><mi>\u03d5</mi></msqrt></mpadded><mo>\u2062</mo><msub><mi>\ud835\udc2e</mi><mo>\u22c6</mo></msub></mrow></mrow><mo>)</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01180.tex", "nexttext": "\n\nBreslow et al. \\cite{breslow-etal-1998} criticised the BYM model for\nobscuring the conditional mean and conditional variance. Using the new\nparameterisation,  $ \\text{Var}(\\mathbf{b}\\mid \\tau_b, \\phi)$ has a clear and intuitive interpretation, and interpretations in terms of the conditional distribution of $b_i$ given $b_j$, $j \\in \\delta i$, are avoided.\n\nSimilarly to the Leroux and the Dean model, \\eqref{eq:bym2}\nemphasises\nthe compromise between pure\noverdispersion and spatially structured correlation, where $0 \\leq\n\\phi \\leq 1$ measures the proportion of the marginal variance\nexplained by the structured effect. The model\nreduces to pure overdispersion for $\\phi = 0$  and to the Besag model,\ni.e.~only spatially structured risk, when $\\phi = 1$. \nMore importantly, using the standardised $\\mathbf{Q}_\\star^{-}$ the marginal variances \nwill be approximately equal to  $(1-\\phi)/\\tau_b + \\phi/\\tau_b$. Approximation\nholds since $\\mathbf{Q}^-$ by construction does not  give the\nsame marginal variances for all regions, so that the standardisation\nonly holds on the overall level of the generalised variance $\\sigma^2_{\\text{GV}}$. With the \nscaled structured effect $\\mathbf{u}^\\star$, the random effect\n$\\mathbf{b}$ is also scaled and the prior imposed on $\\tau_b$ has the\nsame interpretation, being transferred between graphs. Furthermore,\nthe hyperparameters $\\tau_b$ and $\\phi$ are now interpretable and no\nlonger confounded. It should be noted that in contrast to the Dean\nmodel, the Leroux model cannot be scaled since by construction the\nscaling would depend on the value of $\\phi$.\n\n\\subsection{Parameterisation preserving sparsity}\n\nA challenge of the new model formulation in\n\\eqref{eq:bym2} and \\eqref{eq:varbym2} is that the covariance matrix\ninvolves the generalised inverse $\\mathbf{Q}_\\star^{-}$. The\nprecision matrix, defined as the inverse of \\eqref{eq:varbym2}, is then no\nlonger sparse. Sparsity properties are important to gain computational efficiency,  both implementing the model in the\nINLA framework \\cite{rue-etal-2009},  or using block updating in Markov chain Monte Carlo methods. To keep the sparsity of the precision matrix,  we propose an augmented\nparameterisation.\n\nRecall that $\\mathbf{u}_\\star \\sim\n\\mathcal{N}(\\mathbf{0}, \\mathbf{Q}_\\star^{-})$, where $\\mathbf{Q}_\\star$\nis scaled, and $\\mathbf{v} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{I})$ in  \\eqref{eq:bym2}. Let\n$\\mathbf{w} = \\begin{pmatrix}\n  \\mathbf{w}_1^\\top &\n  \\mathbf{w}_2^\\top\n\\end{pmatrix}^\\top$, where $\\mathbf{w}_2 = \\mathbf{u}_\\star$ and\n$\\mathbf{w}_1 = \\mathbf{b}$.  Thus,\n\n", "itemtype": "equation", "pos": 24871, "prevtext": "\nhaving covariance matrix\n\n", "index": 23, "text": "\\begin{gather}\n  \\text{Var}(\\mathbf{b}\\mid \\tau_b, \\phi) = \\tau_b^{-1}\\left((1-\\phi) \\: \\mathbf{I} + \\phi \\mathbf{Q}_\\star^{-}\\right)\\label{eq:varbym2}.\n\\end{gather}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\text{Var}(\\mathbf{b}\\mid\\tau_{b},\\phi)=\\tau_{b}^{-1}\\left((1-%&#10;\\phi)\\&gt;\\mathbf{I}+\\phi\\mathbf{Q}_{\\star}^{-}\\right).\" display=\"block\"><mrow><mtext>Var</mtext><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc1b</mi><mo>\u2223</mo><msub><mi>\u03c4</mi><mi>b</mi></msub><mo>,</mo><mi>\u03d5</mi><mo stretchy=\"false\">)</mo></mrow><mo>=</mo><msubsup><mi>\u03c4</mi><mi>b</mi><mrow><mo>-</mo><mn>1</mn></mrow></msubsup><mrow><mo>(</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo>-</mo><mi>\u03d5</mi><mo rspace=\"4.7pt\" stretchy=\"false\">)</mo></mrow><mi>\ud835\udc08</mi><mo>+</mo><mi>\u03d5</mi><msubsup><mi>\ud835\udc10</mi><mo>\u22c6</mo><mo>-</mo></msubsup><mo>)</mo></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01180.tex", "nexttext": "\nAs $\\pi(\\mathbf{w}) = \\pi(\\mathbf{w}_1 \\mid \\mathbf{w}_2) \\pi(\n\\mathbf{w}_2)$, it follows that $\\mathbf{w}$ is normally distributed\nwith mean $\\mathbf{0}$ and precision matrix\n\n", "itemtype": "equation", "pos": 27622, "prevtext": "\n\nBreslow et al. \\cite{breslow-etal-1998} criticised the BYM model for\nobscuring the conditional mean and conditional variance. Using the new\nparameterisation,  $ \\text{Var}(\\mathbf{b}\\mid \\tau_b, \\phi)$ has a clear and intuitive interpretation, and interpretations in terms of the conditional distribution of $b_i$ given $b_j$, $j \\in \\delta i$, are avoided.\n\nSimilarly to the Leroux and the Dean model, \\eqref{eq:bym2}\nemphasises\nthe compromise between pure\noverdispersion and spatially structured correlation, where $0 \\leq\n\\phi \\leq 1$ measures the proportion of the marginal variance\nexplained by the structured effect. The model\nreduces to pure overdispersion for $\\phi = 0$  and to the Besag model,\ni.e.~only spatially structured risk, when $\\phi = 1$. \nMore importantly, using the standardised $\\mathbf{Q}_\\star^{-}$ the marginal variances \nwill be approximately equal to  $(1-\\phi)/\\tau_b + \\phi/\\tau_b$. Approximation\nholds since $\\mathbf{Q}^-$ by construction does not  give the\nsame marginal variances for all regions, so that the standardisation\nonly holds on the overall level of the generalised variance $\\sigma^2_{\\text{GV}}$. With the \nscaled structured effect $\\mathbf{u}^\\star$, the random effect\n$\\mathbf{b}$ is also scaled and the prior imposed on $\\tau_b$ has the\nsame interpretation, being transferred between graphs. Furthermore,\nthe hyperparameters $\\tau_b$ and $\\phi$ are now interpretable and no\nlonger confounded. It should be noted that in contrast to the Dean\nmodel, the Leroux model cannot be scaled since by construction the\nscaling would depend on the value of $\\phi$.\n\n\\subsection{Parameterisation preserving sparsity}\n\nA challenge of the new model formulation in\n\\eqref{eq:bym2} and \\eqref{eq:varbym2} is that the covariance matrix\ninvolves the generalised inverse $\\mathbf{Q}_\\star^{-}$. The\nprecision matrix, defined as the inverse of \\eqref{eq:varbym2}, is then no\nlonger sparse. Sparsity properties are important to gain computational efficiency,  both implementing the model in the\nINLA framework \\cite{rue-etal-2009},  or using block updating in Markov chain Monte Carlo methods. To keep the sparsity of the precision matrix,  we propose an augmented\nparameterisation.\n\nRecall that $\\mathbf{u}_\\star \\sim\n\\mathcal{N}(\\mathbf{0}, \\mathbf{Q}_\\star^{-})$, where $\\mathbf{Q}_\\star$\nis scaled, and $\\mathbf{v} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{I})$ in  \\eqref{eq:bym2}. Let\n$\\mathbf{w} = \\begin{pmatrix}\n  \\mathbf{w}_1^\\top &\n  \\mathbf{w}_2^\\top\n\\end{pmatrix}^\\top$, where $\\mathbf{w}_2 = \\mathbf{u}_\\star$ and\n$\\mathbf{w}_1 = \\mathbf{b}$.  Thus,\n\n", "index": 25, "text": "\\begin{gather*}\n \\mathbf{w}_1 \\mid \\mathbf{w}_2  \\sim\n \\mathcal{N}\\left(\\sqrt{\\frac{\\phi}{\\tau_b}} \\mathbf{w}_2,\n   \\frac{1-\\phi}{\\tau_b} \\mathbf{I}\\right).\n\\end{gather*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex6.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\mathbf{w}_{1}\\mid\\mathbf{w}_{2}\\sim\\mathcal{N}\\left(\\sqrt{\\frac{%&#10;\\phi}{\\tau_{b}}}\\mathbf{w}_{2},\\frac{1-\\phi}{\\tau_{b}}\\mathbf{I}\\right).\" display=\"block\"><mrow><msub><mi>\ud835\udc30</mi><mn>1</mn></msub><mo>\u2223</mo><msub><mi>\ud835\udc30</mi><mn>2</mn></msub><mo>\u223c</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca9</mi><mrow><mo>(</mo><msqrt><mfrac><mi>\u03d5</mi><msub><mi>\u03c4</mi><mi>b</mi></msub></mfrac></msqrt><msub><mi>\ud835\udc30</mi><mn>2</mn></msub><mo>,</mo><mfrac><mrow><mn>1</mn><mo>-</mo><mi>\u03d5</mi></mrow><msub><mi>\u03c4</mi><mi>b</mi></msub></mfrac><mi>\ud835\udc08</mi><mo>)</mo></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01180.tex", "nexttext": "\nThe marginal of $\\mathbf{w}_1$ then has the correct distribution.\nWorking with this parameterisation,  sparsity is warranted and the\nstructured component is given directly by $\\mathbf{w}_2$, i.e. the second half of the\nvector $\\mathbf{w}$.\n\n\\section{Hyperprior choice: Penalised-complexity priors}\\label{sec:pcprior}\n\n\nIn applying the original BYM model formulation, priors are usually\nspecified separately for $\\tau_u$ and $\\tau_v$ and the prior choices are\nfrequently rather ad-hoc \\cite{bernardinelli-etal-1995}. A reasonable alternative,\n\nis to express prior beliefs in terms of the total variability of the model\n\\cite{wakefield-2007}, which also facilitates clear interpretation of the hyperparameters.\n\nHere, we follow Simpson et al. \\cite{simpson-etal-2015} and apply the \nframework of penalised complexity (PC) priors, which\nallows us to distribute the total variance to the components of the modified\nBYM model. The construction of PC priors is  based on four\nprinciples: 1. {\\em Occam's razor} --- simpler models should be\npreferred until there is enough support for a more complex\nmodel. 2. {\\em Measure of complexity}  --- The Kullback-Leibler\ndistance (KLD) is used to measure increased complexity. 3. {\\em\n  Constant-rate penalisation} --- The deviation from the simpler model\nis penalised using a constant decay rate. 4. {\\em User-defined\n  scaling}  --- The user has an idea of a sensible size of the parameter (or\nany transformed variation) of interest. \nFor ease of readability, we provide the main ideas and results using\nthe  PC framework, and refer to Simpson et\nal. \\cite{simpson-etal-2015} Section~6, Appendices~A.2 and A.3 for further mathematical details.\n\nHyperpriors are formulated in two levels. First, a prior for\n$\\tau_b$ is defined, which will control the marginal variance contribution of the weighted sum\nof $\\mathbf{v}$ and $\\mathbf{u}_\\star$. Second, the marginal variance is distributed to the components  $\\mathbf{v}$ and\n$\\mathbf{u}_\\star$ by defining a suitable prior for the mixing\nparameter $\\phi$. Note that testing for the risk decomposition,\nas proposed in MacNab \\cite{macnab-2010}, is implicated using the\nPC-prior framework at this level. The PC prior will\nautomatically shrink towards $\\phi=0$, which refers to no spatial\nsmoothing. The  modified BYM\nmodel is then seen as a flexible extension of two dependent base models, which it will shrink to if not differently\nsupported by the data.\n\n\n\\subsection{Controlling the spatial variance contribution} \\label{sec:pc-prec}\nThe simplest model, referred to as a first-level base model, is to have a constant\nrelative risk over all areas, i.e. no spatial variation or\nequivalently infinite precision.\nAll $n$ regions have the same disease burden.\nFollowing the principles of the PC prior framework, we penalise\nmodel complexity in terms of a measure of information-theoretic deviation from the flexible model to the base model,  which is a function of the  Kullback-Leibler divergence\n\n", "itemtype": "equation", "pos": 27969, "prevtext": "\nAs $\\pi(\\mathbf{w}) = \\pi(\\mathbf{w}_1 \\mid \\mathbf{w}_2) \\pi(\n\\mathbf{w}_2)$, it follows that $\\mathbf{w}$ is normally distributed\nwith mean $\\mathbf{0}$ and precision matrix\n\n", "index": 27, "text": "\\begin{gather*}\n\\begin{pmatrix}\n \\frac{\\tau_b}{1-\\phi} \\mathbf{I} & - \\frac{\\sqrt{\\phi\n     \\tau_b}}{1-\\phi} \\mathbf{I}\\\\\n- \\frac{\\sqrt{\\phi\n     \\tau_b}}{1-\\phi} \\mathbf{I} & \\mathbf{Q}_\\star + \\frac{\\phi}{1-\\phi}\\mathbf{I}\n\\end{pmatrix}.\n\\end{gather*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex7.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\begin{pmatrix}\\frac{\\tau_{b}}{1-\\phi}\\mathbf{I}&amp;-\\frac{\\sqrt{%&#10;\\phi\\tau_{b}}}{1-\\phi}\\mathbf{I}\\\\&#10;-\\frac{\\sqrt{\\phi\\tau_{b}}}{1-\\phi}\\mathbf{I}&amp;\\mathbf{Q}_{\\star}+\\frac{\\phi}{1%&#10;-\\phi}\\mathbf{I}\\end{pmatrix}.\" display=\"block\"><mrow><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><mstyle displaystyle=\"false\"><mfrac><msub><mi>\u03c4</mi><mi>b</mi></msub><mrow><mn>1</mn><mo>-</mo><mi>\u03d5</mi></mrow></mfrac></mstyle><mo>\u2062</mo><mi>\ud835\udc08</mi></mrow></mtd><mtd columnalign=\"center\"><mrow><mo>-</mo><mrow><mstyle displaystyle=\"false\"><mfrac><msqrt><mrow><mi>\u03d5</mi><mo>\u2062</mo><msub><mi>\u03c4</mi><mi>b</mi></msub></mrow></msqrt><mrow><mn>1</mn><mo>-</mo><mi>\u03d5</mi></mrow></mfrac></mstyle><mo>\u2062</mo><mi>\ud835\udc08</mi></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><mo>-</mo><mrow><mstyle displaystyle=\"false\"><mfrac><msqrt><mrow><mi>\u03d5</mi><mo>\u2062</mo><msub><mi>\u03c4</mi><mi>b</mi></msub></mrow></msqrt><mrow><mn>1</mn><mo>-</mo><mi>\u03d5</mi></mrow></mfrac></mstyle><mo>\u2062</mo><mi>\ud835\udc08</mi></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udc10</mi><mo>\u22c6</mo></msub><mo>+</mo><mrow><mstyle displaystyle=\"false\"><mfrac><mi>\u03d5</mi><mrow><mn>1</mn><mo>-</mo><mi>\u03d5</mi></mrow></mfrac></mstyle><mo>\u2062</mo><mi>\ud835\udc08</mi></mrow></mrow></mtd></mtr></mtable><mo>)</mo></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01180.tex", "nexttext": "\nKLD  measures the information lost using the\nbase model to approximate the more flexible model. To facilitate interpretation, this divergence is transformed to a unidirectional measure of distance defined by \n\n", "itemtype": "equation", "pos": 31202, "prevtext": "\nThe marginal of $\\mathbf{w}_1$ then has the correct distribution.\nWorking with this parameterisation,  sparsity is warranted and the\nstructured component is given directly by $\\mathbf{w}_2$, i.e. the second half of the\nvector $\\mathbf{w}$.\n\n\\section{Hyperprior choice: Penalised-complexity priors}\\label{sec:pcprior}\n\n\nIn applying the original BYM model formulation, priors are usually\nspecified separately for $\\tau_u$ and $\\tau_v$ and the prior choices are\nfrequently rather ad-hoc \\cite{bernardinelli-etal-1995}. A reasonable alternative,\n\nis to express prior beliefs in terms of the total variability of the model\n\\cite{wakefield-2007}, which also facilitates clear interpretation of the hyperparameters.\n\nHere, we follow Simpson et al. \\cite{simpson-etal-2015} and apply the \nframework of penalised complexity (PC) priors, which\nallows us to distribute the total variance to the components of the modified\nBYM model. The construction of PC priors is  based on four\nprinciples: 1. {\\em Occam's razor} --- simpler models should be\npreferred until there is enough support for a more complex\nmodel. 2. {\\em Measure of complexity}  --- The Kullback-Leibler\ndistance (KLD) is used to measure increased complexity. 3. {\\em\n  Constant-rate penalisation} --- The deviation from the simpler model\nis penalised using a constant decay rate. 4. {\\em User-defined\n  scaling}  --- The user has an idea of a sensible size of the parameter (or\nany transformed variation) of interest. \nFor ease of readability, we provide the main ideas and results using\nthe  PC framework, and refer to Simpson et\nal. \\cite{simpson-etal-2015} Section~6, Appendices~A.2 and A.3 for further mathematical details.\n\nHyperpriors are formulated in two levels. First, a prior for\n$\\tau_b$ is defined, which will control the marginal variance contribution of the weighted sum\nof $\\mathbf{v}$ and $\\mathbf{u}_\\star$. Second, the marginal variance is distributed to the components  $\\mathbf{v}$ and\n$\\mathbf{u}_\\star$ by defining a suitable prior for the mixing\nparameter $\\phi$. Note that testing for the risk decomposition,\nas proposed in MacNab \\cite{macnab-2010}, is implicated using the\nPC-prior framework at this level. The PC prior will\nautomatically shrink towards $\\phi=0$, which refers to no spatial\nsmoothing. The  modified BYM\nmodel is then seen as a flexible extension of two dependent base models, which it will shrink to if not differently\nsupported by the data.\n\n\n\\subsection{Controlling the spatial variance contribution} \\label{sec:pc-prec}\nThe simplest model, referred to as a first-level base model, is to have a constant\nrelative risk over all areas, i.e. no spatial variation or\nequivalently infinite precision.\nAll $n$ regions have the same disease burden.\nFollowing the principles of the PC prior framework, we penalise\nmodel complexity in terms of a measure of information-theoretic deviation from the flexible model to the base model,  which is a function of the  Kullback-Leibler divergence\n\n", "index": 29, "text": "\\begin{gather}\n\\text{KLD}(\\tau_b)= \\text{KLD}(\\mathcal{N}(0,\n\\mathbf{\\Sigma}_{\\text{flex}}(\\tau_b))  \\mid \\mathcal{N}(0,\n\\mathbf{\\Sigma}_{\\text{base}})). \\label{eq:KLD}\n\\end{gather}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\text{KLD}(\\tau_{b})=\\text{KLD}(\\mathcal{N}(0,\\mathbf{\\Sigma}_{%&#10;\\text{flex}}(\\tau_{b}))\\mid\\mathcal{N}(0,\\mathbf{\\Sigma}_{\\text{base}})).\" display=\"block\"><mrow><mtext>KLD</mtext><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c4</mi><mi>b</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>=</mo><mtext>KLD</mtext><mrow><mo stretchy=\"false\">(</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca9</mi><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><msub><mi>\ud835\udeba</mi><mtext>flex</mtext></msub><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c4</mi><mi>b</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2223</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca9</mi><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><msub><mi>\ud835\udeba</mi><mtext>base</mtext></msub><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">)</mo></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01180.tex", "nexttext": "\nIn our case, $\\mathbf{\\Sigma}_{\\text{flex}}(\\tau_b)=\n\\text{Var}(\\mathbf{b}\\mid \\tau_b, \\phi)$ as defined in (\\ref{eq:varbym2}),\nwhile the covariance matrix of the base model is\n$\\mathbf{\\Sigma}_{\\text{base}}=\\mathbf{0}$, reflecting infinite\nprecision. Details regarding the computation of \\eqref{eq:KLD} are\npresented in Simpson et al. \\cite{simpson-etal-2015} and for completeness\nprovided in~\\ref{app:pc}.  On the distance scale the meaning of a prior is much more\nclear.  The prior should have mode at zero, i.e. at the base model, and decreasing density\nwith increasing distance. There are different priors that fulfill\nthese properties, but differ in the way they decrease with increasing\ndistance. Since we are not in a variable selection setting, we follow\nthe recommendation of Simpson et al. \\cite{simpson-etal-2015} and use\nthe exponential \ndistribution, which supports constant-rate penalisation.  Applying the ordinary change\nof variable transformation, a type-2 Gumbel distribution\\citep{simpson-etal-2015}\n\n", "itemtype": "equation", "pos": 31593, "prevtext": "\nKLD  measures the information lost using the\nbase model to approximate the more flexible model. To facilitate interpretation, this divergence is transformed to a unidirectional measure of distance defined by \n\n", "index": 31, "text": "\\begin{equation*}\nd(\\tau_b) = \\sqrt{2\\text{KLD}(\\tau_b)}.\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex8.m1\" class=\"ltx_Math\" alttext=\"d(\\tau_{b})=\\sqrt{2\\text{KLD}(\\tau_{b})}.\" display=\"block\"><mrow><mrow><mrow><mi>d</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c4</mi><mi>b</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><msqrt><mrow><mn>2</mn><mo>\u2062</mo><mtext>KLD</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c4</mi><mi>b</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></msqrt></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01180.tex", "nexttext": "\nis obtained as prior for $\\tau_b$.\n\nThe given prior corresponds to an exponential prior with rate $\\theta$\nfor the standard deviation $1/\\sqrt{\\tau_b}$. Hence, to infer $\\theta$\nwe can use the probability statement $\\text{Prob}((1/\\sqrt{\\tau_b}) >\nU) = \\alpha$, which gives $\\theta = - \\log(\\alpha)/U$. It is not\nobvious how to interpret $1/\\sqrt{\\tau_b}$ epidemiologically. However,\nin the BYM2 model, $\\tau_b$ represents the marginal precision, and as\nsuch, can be related to the total residual relative risk for which an\nintuitive interpretation is available \\cite{wakefield-2007}. For\nexample, an assumed probability of $0.99$ of having residual relative\nrisks  smaller than 2, corresponds approximately to\n$\\text{Prob}((1/\\sqrt{\\tau_b}) > 1) = 0.01$. Figure~\\ref{fig:prior}\n(left panel) shows the resulting prior compared to two gamma\ndistributions,  which will be used in the simulation study in\nSection~\\ref{sec:application}. Please note that the use of gamma priors is questionable as the base model, i.e.\ndistance equal to zero, has no density mass and can therefore never be\nobtained. We refer to Simpson et al.\\cite{simpson-etal-2015} for further discussions about overfitting of priors.\n\\begin{figure}\n\\centering\n\\includegraphics[width=0.9\\textwidth]{priors}\n\\caption{Left panel: PC prior for $\\tau_b$ (solid) with parameters\n  $U=1$ and $\\alpha = 0.01$, and two gamma priors where for both the\n  shape parameter is equal to one and the rate parameter is either\n  0.01 (dashed, light-gray) or 0.02 (dashed, dark-gray). Right panel:\n   PC prior for the mixing parameter $\\phi$ with $U = 0.5$ and $\\alpha =\n  2/3$ (solid), and a uniform prior on (0,1) (dashed). }\\label{fig:prior}\n\\end{figure}\n\n\n\n\n\n\\subsection{Distributing the spatial variance  contribution}\nAssume now that the relative risk has spatial variation. This implies that \nthe disease burden over the regions is not constant. Conditioned on a fixed marginal variance, the\nsecond-level base model is defined as having only unstructured spatial noise and no spatial\ndependency, i.e. $\\phi=0$. By increasing the value of $\\phi$, spatial dependency is gradually blended into the model and the model component explaining most of the variance shifts from\n$\\mathbf{v}$ to $\\mathbf{u}_\\star$\\cite{simpson-etal-2015}.\n\nTo derive the PC prior for $\\phi$, we first compute the KLD of the base model from\nthe flexible model, see~Appendix~\\ref{app-mixing}. The covariance matrices for the base and flexible models are\n$\\mathbf{\\Sigma}_{\\text{base}} =  \\mathbf{I}$ and\n$\\mathbf{\\Sigma}_{\\text{flex}}(\\phi) =  (1-\\phi) \\: \\mathbf{I} +\n\\phi\\mathbf{Q}_\\star^{-}$, respectively. \nAnalogously as for $\\tau_b$, we assign an exponential prior with parameter $\\lambda$ to\nthe distance scale $d(\\phi) = \\sqrt{2\\mbox{KLD}(\\phi)}$. For simplicity, this prior is\ntransformed to give a prior on $\\text{logit}(\\phi)$, as $\\phi$ is\ndefined on a bounded interval. Reasonable values of  $\\lambda$ can be\ninferred in a similar way as in Section~\\ref{sec:pc-prec}, using a\nprobability statement $\\text{Prob}(\\phi < U) = \\alpha$. In this way\nit is straightforward to specify both strong or weak prior\ninformation. \nThe parameter $\\phi$ has a more direct  interpretation  than\nthe precision parameter $\\tau_b$, representing a fraction of the total variance which can be attributed to spatial dependency structure. A reasonable formulation might\nbe  $\\text{Prob}(\\phi < 0.5) = 2/3$, which gives more density mass to\nvalues of $\\phi$ smaller than $0.5$. This can be seen as a\nconservative choice, assuming that the unstructured random effect\naccounts for more of the variability than the spatially  structured\neffect.\n\nIn contrast to the precision parameter $\\tau_b$, the resulting PC prior for $\\phi$\nis not available in closed form.\nWithin INLA, the function {\\tt INLA:::inla.pc.bym.phi} can be used\nto compute the prior for $\\phi$ (on logit-scale) for a specific\nBesag neighbourhood matrix~$\\mathbf{Q}$.\nThe scaling of the graph is implemented by default.\nThus, the prior can be obtained in tabulated form and also\nincorporated in other software packages than INLA.\nFigure~\\ref{fig:prior} (right panel)  shows the prior for $\\phi$ with  $U = 0.5$ and $\\alpha=2/3$,\ngenerated in {\\tt R} using\n\\begin{Sinput}\nR> log.prior = INLA:::inla.pc.bym.phi(Q = Q, rankdef = 1,\nR>    u = 0.5, alpha = 2/3)\nR> phis = 1/(1+exp(-seq(-10, 10, len=10000)))\nR> plot(phis, exp(log.prior(phis)), type=\"l\",\nR>     lwd = 2,  bty = \"l\", ylim = c(0,10),\nR>     xlab = expression(phi), ylab = \"Density\")\n\\end{Sinput}\nFor comparison, the figure also displays the commonly used uniform prior for $\\phi$.\n\n\n\n\\section{Applications}\\label{sec:application}\n\n\\subsection{Does the modified BYM model shrink to the respective base models?}\n\nVarious types of cancer data, observed in the $544$ districts of\nGermany (Figure~\\ref{fig:germany}), have been widely analysed in\nthe literature, both to study the epidemiology\n\\cite{natario-knorrHeld-2003} and to test\nmethodological developments \\cite{knorr-rue-2002}. Simpson et\nal. \\cite{simpson-etal-2015} re-analyse a larynx cancer dataset, assigning the PC priors shown in\nFigure~\\ref{fig:prior} to the hyperparameters. The modified BYM model\n(\\ref{eq:bym2}), here referred to as the BYM2 model, is clearly seen to\nlearn from the data, leading to a posterior marginal concentrated\naround 1 for~$\\phi$. \n\n\\subsubsection{Results}\\label{sec:results}\nHere, we perform a simulation study to investigate whether the BYM2\nmodel shrinks towards the two different base models described in\nSection~\\ref{sec:pcprior}. Furthermore, we assess the behaviour under \na perfectly structured risk surface. The simulations are based on the\nneighbourhood structure of $366$ districts of Sardinia, for which\na real case study will be analysed in Section~\\ref{sec:sardinia}. \nTwo hundred datasets were simulated under\nnine different scenarios, using three different types of risk surfaces\nand three different disease prevalences. The model we simulate\nfrom assumes that the log relative risk is given as\n$\\log(\\theta_i) = \\mu + \\frac{1}{\\sqrt{\\tau_b}} b_i$, $i=1, \\ldots, 366$, where $\\mathbf{b}$\nis a zero-mean normal distributed random effect controlled by the\nprecision parameter $\\tau_b$. In the simulations, we assume either \na constant risk over all regions, i.e. $1/\\sqrt{\\tau_b}=0$,  an\nindependent area-specific risk setting with $1/\\sqrt{\\tau_b}=0.5$ and\n$\\mathbf{b} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{I})$,  or a spatially\nstructured area-specific risk setting with $1/\\sqrt{\\tau_b}=0.5$ and\n$\\mathbf{b} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{Q}_\\star^{-})$.\n  We alter the expected number of cases $E_{i}$ to analyse whether\n  the model performance changes when applied to diseases with\n  different underlying disease prevalence. We set all $E_{i}$ equal\n  to either $15$, $60$ or $200$ and analyse all datasets using the\n  {\\tt INLA} package in~{\\tt R}.\n\n\n\nTable~\\ref{tab:simBYM2} shows the posterior mean estimates for the\nintercept and the two hyperparameters, also including the average standard deviations of the\nestimates in parentheses. \n\\begin{table}\n\\small\\sf\\centering\n\\caption{Mean values of the intercept and hyperparameters,\n for the BYM2 model for varying disease\n  prevalence, using either a constant, spatially-varying unstructured\n  risk surfaces or spatially-varying structured risk surfaces. PC\n  priors are used for the weighting parameter $\\phi$ and for the\n  precision parameter $\\tau_b$. Standard deviations are\n  provided in parentheses.  Results are based on $200$ simulations\nfor each setting, where the true  parameter values are provided in the table.} \\label{tab:simBYM2}\n\\begin{tabular}{lccc}\n  \\toprule\n  & $\\mu$  & $1/\\sqrt{\\tau}$ & $\\phi$ \\\\\n  \\midrule\n  \\multicolumn{4}{l}{Constant risk ($1/\\sqrt{\\tau_b} = 0$, $\\phi=0$):} \\[.2cm]\nE = 15 & -3.78E-04 (0.01) & 0.02 (0.02) & 0.26 (0.05) \\\\ \n  E = 60 & -9.15E-04 (0.01) & 0.01 (0.01) & 0.26 (0.05) \\\\ \n  E = 200 & -4.36E-04 (0.004) & 0.01 (0.01) & 0.26 (0.04) \\\\ \n  \\multicolumn{4}{l}{Area-specific independent risk ($1/\\sqrt{\\tau_b}\n    = 0.5$, $\\phi = 0$):}  \\[.2cm]\nE = 15 & 1.62E-03 (0.03) & 0.50 (0.02) & 0.05 (0.03) \\\\ \n  E = 60 & -1.94E-03 (0.03) & 0.51 (0.03) & 0.04 (0.02) \\\\ \n  E = 200 & 1.21E-03 (0.03) & 0.50 (0.02) & 0.04 (0.02) \\\\ \n  \\multicolumn{4}{l}{Area-specific correlated risk ($1/\\sqrt{\\tau_b}\n    = 0.5$, $\\phi = 1$):}  \\[.2cm]\nE = 15 & 2.14E-03 (0.01) & 0.47 (0.04) & 0.90 (0.06) \\\\ \n  E = 60 & 9.11E-06 (0.01) & 0.49 (0.05) & 0.93 (0.04) \\\\ \n  E = 200 & 4.70E-05 (0.004) & 0.49 (0.07) & 0.93 (0.04) \\\\ \n   \\bottomrule\n \\end{tabular}\n\\end{table}\n\nThe constant risk surface scenario corresponds to the first-level base\nmodel described in Section~\\ref{sec:pcprior}. The resulting estimates are reasonable for all parameters. Specifically, the standard\ndeviation $1/\\sqrt{\\tau_b}$ is close to zero, and decreases with higher prevalence.\nAs these datasets give no information about the mixing parameter, the prior will dominate the posterior estimates of $\\phi$.\nThe assumption of independent, area-specific spatial variation of the risk surface, corresponds to the second-level base model in Section~\\ref{sec:pcprior}.  Again, the posterior mean parameter estimates are seen to be close to the true values. In particular, the model is seen to shrink towards the base model as the estimated mixing\nparameters are very close to zero, distributing all of the spatial variation to the\nunstructured component. In the case of a spatially structure surface\nrisk,  the intercept and $1/\\sqrt{\\tau_b}$ are well estimated.\nThe mixing parameter $\\phi$ is estimated slightly lower when\n$E_{i}=15$ compared to $E_{i}=60$ and $E_{i}=200$, where the estimates\nare closer to $1$. This illustrates the learning ability of the model\nto support a more complex model if indicated by the data. \n\nWe repeated the simulation study using a uniform prior for the mixing\nparameter $\\phi$. The obtained results are comparable, see\nTable~\\ref{tab:simBYM2_unif} in~\\ref{app:figtab}. Differences\noccur in the case of a simulated constant risk surface where the estimates\nof the mixing parameter are  now close to\n$0.5$, as the estimate is dominated by the new prior. \nIn the case of a spatially unstructured or structured risk, the\nobtained  parameter estimates are seen to be robust to the\nprior choice for the mixing parameter. \n\n\n\\subsubsection{Comparison to other spatial latent models}\nThe main benefit of the BYM2 model is that it allows for\nan intuitive parameter interpretation and facilitates prior\nassignment. Performance in terms of model choice criteria is regarded\nsecondary and will be assessed in this section. To compare the BYM2\nmodel with existing approaches, we fit the spatial\nlatent models presented in Section~\\ref{sec:review} to the simulated data. We\nalso include a model having only an unstructured spatial component,\nreferred to as the iid-model. For the BYM2 model we use either a PC\nprior with $U=0.5$ and $\\alpha=2/3$, denoted as BYM2 (PC), or a\nuniform prior, denoted as BYM2 (unif), for the mixing parameter.\n\nTable~\\ref{tab:simAll} illustrates the resulting posterior parameter estimates,\nassuming a constant risk surface and $E=60$. The table also reports three model choice criteria for this scenario: The\nroot-mean squared error (RMSE), computed as the average of\n$\\sqrt{\\tfrac{1}{366} \\sum_{i=1}^{366}(y_i/E_i - \\hat{\\theta}_i)^2}$ over all 200\nsimulations with $\\hat{\\theta}_i$ denoting the posterior mean fitted risk, the average deviance information criterion (DIC)\n\\cite{spiegelhalter-etal-2002}, and the average proper logarithmic scoring rule\n(LS) \\cite{gneiting-raftery-2007}. For all three criteria, lower\nvalues imply better model properties. Note that the parameter estimates of\nthe BYM model are not included here as it is not parameterised in\nterms of one precision and one mixing parameter. However, we will\nconsider it in terms of model choice, see Figure~\\ref{fig:cpo} -- \\ref{fig:dic}.\n\nThe estimated parameter values in Table~\\ref{tab:simAll} have to be\ninterpreted with great care. \nEven though the different models look comparable and the parameters have the same name, their interpretations are not equivalent. A first issue is that\nwe use different priors for the hyperparameters. Specifically, we assume that  $\\phi \\sim\n\\text{Unif}(0,1)$ for the Leroux and Dean model, as this represents a popular\nnon-informative prior choice in the literature\n\\citep{wakefield-2007,macnab-2010,ugarte-etal-2014}. Further, we assume a \n$\\Gamma(\\text{shape}=1, \\text{rate}=0.01)$ distribution for the precision\nparameter in the iid-model. For the spatially structured term, we took the graph structure of\nSardinia into account and use a $\\Gamma(\\text{shape}=1, \\text{rate}=0.02)$\n\\cite{bernardinelli-etal-1995} prior. However, also the different\nparameterisation of the Leroux and Dean model imply that the parameters\nare not comparable.  It is only when $\\phi=0$ or $\\phi =1$, these models\nreduce to the same model (assuming the same prior for the\nprecision parameter).\n\nThe second issue is that none of the models are properly scaled, except the BYM2 model.  Specifically, the \nprecision parameter in the Leroux and Dean model does not represent\nthe marginal precision.  It is still confounded with $\\phi$ and hence not\ncomparable to the BYM2 model. The only parameter estimates that are\ncomparable are those from the iid-model and the BYM2 model. The Besag\nmodel can be scaled, and so can the  Dean model leading to\nthe parameterisation of the BYM2 model. However, the Leroux model cannot be\nscaled as any scaling would depend on the mixing parameter\n$\\phi$. Hence,  the precision parameter cannot be interpreted as\nmarginal precision as it depends on the\nunderlying graph structure and is in addition confounded with the mixing\nparameter. \n\nEven though the parameters of the models have different interpretations and priors are chosen differently, the\nmodel choice criteria give quite similar average values, for all the\nmodels and only the DIC values seem to slightly favour the two BYM2\nmodels. This means that the BYM2 performs at least as well as the other\nmodels and changing the prior for the mixing parameters leads to the\nsame results. This is also confirmed inspecting the\nlogarithmic scores and  DIC values over all simulations, in terms of boxplots, see\nFigures~\\ref{fig:cpo} and \\ref{fig:dic} in~\\ref{app:figtab}, respectively. Results for these\ntwo model choice criteria coincide well and indicate that the\nBesag model performs worse than the other models when simulating an\nindependent area-specific risk surface, where the iid-model is\nnaturally but only marginally favoured. In contrast, the iid model performs\nworse when simulating a spatially-structured surface, where the Besag\nmodel is marginally favoured for low values of $E_{i}$. The other\nmodels perform almost identically in both of these simulation\nsettings. Simulating a constant-risk surface, all models behave similarly\nfor $E_{i}=15$. For increasing numbers of expected cases, the BYM2\nmodel seems to be slightly beneficial. The figures only include\nthe boxplots obtained by the BYM2 model using a PC prior for $\\phi$,\nas results using a uniform prior are visually identical.\n\n\\begin{table}\n\\small\\sf\\centering\n\\caption{Mean values of the intercept and hyperparameters,\n  root mean square error (RMSE) for the fitted risk, DIC and logarithmic score (LS) when using\n  different spatial latent models. Standard deviations are\n  provided in parentheses.  Results are based on $200$ simulations\nwhere the true values are $\\mu = 0$, $1/\\sqrt{\\tau} = 0$, $\\phi = 0$,\n$E=60$. Be aware that parameter estimates might not be directly\ncomparable between models.} \\label{tab:simAll}\n\\begin{tabular}{lccccccc}\n  \\toprule\n  & $\\mu$  & $1/\\sqrt{\\tau}$ & $\\phi$ & RMSE & DIC & LS  \\\\\n  \\midrule\n  iid-model & -1.65E-03 (0.01) & 0.05 (0.004) & 0.00 (-) & 0.11 & 2545 & 3.47 \\\\ \n  Besag & -1.26E-03 (0.01) & 0.07 (0.004) & 1.00 (-) & 0.12 & 2545 & 3.48 \\\\ \n  Leroux & -1.51E-03 (0.01) & 0.07 (0.01) & 0.56 (0.08) & 0.11 & 2545 & 3.48 \\\\ \n  Dean & -1.69E-03 (0.01) & 0.06 (0.004) & 0.60 (0.12) & 0.11 & 2547 & 3.48 \\\\ \n  BYM2 (unif) & -8.39E-04 (0.01) & 0.01 (0.01) & 0.46 (0.05) & 0.12 & 2540 & 3.47 \\\\ \n  BYM2 (PC)  & -9.15E-04 (0.01) & 0.01 (0.01) & 0.26 (0.05) & 0.12 & 2540 & 3.47 \\\\ \n   \\bottomrule\n\\end{tabular}\n\\end{table}\n\n\n\n\\subsection{Analysis of insulin-dependent diabetes mellitus in Sardinia}\\label{sec:sardinia}\n\nWe re-analyse insulin-dependent diabetes mellitus (IDDM) counts in\nSardinia, see Bernardinelli et al.~\\citep{bernadinelli-etal-1997} and\nKnorr-Held and Rue \\cite{knorr-rue-2002} for previous analyses. This dataset\nhas low counts. Only $619$ cases were registered for $n=366$ districts\nin the period $1989$--$1992$, for the population aged $0$--$29$ years\nand there are no covariates. Spatial smoothing is essential to reduce\nthe large variance in the estimates, and to get a realistic picture of\nthe underlying risk surface. Held \\cite{held-2004} has demonstrated that a\nconstant risk is well supported by the posterior distribution, \nand based on this we would expect shrinkage towards the first-level base model.\n\nWe use $U = 0.5$ and $\\alpha=2/3$ for the prior of $\\phi$. For\n$\\tau_b$ we use $U=0.2/0.31$ and $\\alpha=0.1$ which corresponds to a\nmarginal standard deviation of $0.2$. The R-code to fit the BYM2 model\nusing the INLA-package is explained in~\\ref{app:rcode}.\nThe posterior estimates are shown in Table~\\ref{tab:sardiniaEst}\n(first quarter). We\nsee that the precision estimate is rather high supporting a constant log\nrelative risk as a zero log relative risk is well within all the\nposterior credible intervals for $\\{\\eta_i\\}$. The\nposterior marginal is mostly uniform giving essentially no information on which\ncomponent is describing the variance. Figure~\\ref{fig:sardiniaRR}\nshows the posterior mean for the relative risk over all $366$ regions.\n\n\\begin{figure}\n\\centering\n\\includegraphics[width=.7\\textwidth]{sardiniaEstimate}\n\\caption{Posterior mean of the relative risk for IDDM counts in\n  Sardinia using the BYM2 model.}\\label{fig:sardiniaRR}\n\\end{figure}\n\n\n\\begin{table}\n\\small\\sf\\centering\n\\caption{Posterior quantities for the intercept and hyperparameters\n  under three different PC priors or a uniform prior for the mixing parameter $\\phi$ for IDDM\n  counts in Sardinia.}\\label{tab:sardiniaEst}\n\\begin{tabular}{rrrrrrr}\n  \\toprule\n & Mean & SD & $2.5\\%$ quant. & Median & $97.5$ quant. & Mode \\\\ \n  \\midrule  \n&\\multicolumn{4}{l}{Prior for $\\phi$: $U=0.5$, $\\alpha=2/3$} & \\[.2cm]\n$\\mu$ & 0.01 & 0.05 & -0.09 & 0.01 & 0.10 & 0.01 \\\\ \n $\\tau_b$ & 262.79 & 751.60 & 10.14 & 45.36 & 2549.91 & 17.40 \\\\ \n$\\phi$ & 0.48 & 0.31 & 0.01 & 0.48 & 0.98 & 1.00 \\[.2cm]\n   &\\multicolumn{4}{l}{Prior for $\\phi$: $U=0.5$, $\\alpha=0.5$} & \\[.2cm] \n $\\mu$ & 0.01 & 0.05 & -0.09 & 0.01 & 0.10 & 0.01 \\\\ \n $\\tau_b$ & 233.51 & 686.28 & 10.00 & 42.78 & 2241.48 & 17.37 \\\\ \n$\\phi$ & 0.54 & 0.31 & 0.02 & 0.57 & 0.99 & 1.00 \\[.2cm]\n   &\\multicolumn{4}{l}{Prior for $\\phi$: $U=0.5$, $\\alpha=0.1$} & \\[.2cm]  \n $\\mu$ & 0.01 & 0.05 & -0.08 & 0.01 & 0.11 & 0.01 \\\\ \n $\\tau_b$ & 201.56 & 616.57 & 9.83 & 40.11 & 1880.89 & 17.27 \\\\ \n$\\phi$ & 0.63 & 0.29 & 0.03 & 0.69 & 1.00 & 1.00 \\[.2cm]\n   &\\multicolumn{4}{l}{Prior for $\\phi$: Unif$(0,1)$} & \\[.2cm]  \n $\\mu$ & 0.01 & 0.05 & -0.08 & 0.01 & 0.11 & 0.01 \\\\ \n $\\tau_b$ & 189.46 & 591.67 & 9.77 & 39.07 & 1734.34 & 17.21 \\\\ \n$\\phi$ & 0.64 & 0.26 & 0.08 & 0.69 & 0.99 & 1.00 \\\\ \n   \\bottomrule\n\\end{tabular}\n\\end{table}\n\nMacNab et al. \\cite{macnab-etal-2004} noted considerable sensitivity\nregarding the prior choice for $\\phi$ in the Leroux model. For the\nSardinia data, we\nempirically check sensitivity by changing the parameters of the\nPC-prior for $\\phi$ to $U=0.5$ and $\\alpha=0.5$, $U=0.5$ and\n$\\alpha=0.1$. That means a priori\nwe expect that either $50\\%$ or $90\\%$ of the variation is explained by the spatially\nstructured component, respectively. As a fourth alternative we consider\na uniform prior for $\\phi$. The rest of Table~\\ref{tab:sardiniaEst}\nshows the obtained posterior quantities. The estimates for the intercept\nstay unchanged. We see a slight change in the posterior estimates for \n$\\tau_b$ and $\\phi$,\nwhereby the posterior marginal of $\\phi$ still supports almost the whole\nrange for all priors. The posterior precision slightly decreases,\nwhereby the $2.5\\%$ quantile and the median stay fairly constant. The upper quantile \nand therefore the mean change more clearly. As in MacNab et\nal.~\\cite{macnab-etal-2004}, the effect on the posterior risk estimates\nis negligible (Figure~\\ref{fig:sardiniaRes}).\n\n\\begin{figure}\n\\centering\n\\includegraphics[width=.95\\textwidth]{compareRR-rev}\n\\caption{Comparison of the posterior mean of the relative risk under\n  four different prior distributions for the mixing parameter $\\phi$ for IDDM\n  counts in Sardinia.}\\label{fig:sardiniaRes}\n\\end{figure}\n\n\n\\section{Discussion}\\label{sec:discussion}\n\nThroughout this paper we have stressed the importance of scaling in\nBayesian disease mapping. Without proper scaling, hyperparameters have\nno clear meaning and may be falsely interpreted. To be more specific,\nthe precision parameter of the commonly used Leroux and Dean models\ntends to be falsely interpreted as marginal precision controlling the\ndeviation from a constant disease risk over space. However, the parameter depends on the\nunderlying graph structure and is confounded with the mixing\nparameter if the structured spatial component is not appropriately scaled. In addition, it is not clear how to choose a prior\ndistribution for this parameter. First, due to the lack of scaling, a fixed hyperprior\nfor the precision parameter gives different amount of smoothing if the graph on which given disease counts are observed is changed. Second,\ncommonly used hyperprior distributions induce\noverfitting\\cite{simpson-etal-2015} and will not allow to \nreduce to simpler models such as a constant risk surface or\nuncorrelated noise over space. \n\nSimpson et al. \\cite{simpson-etal-2015} proposed a new modification of the commonly known\nBYM model, termed BYM2 model,  which addresses the aforementioned issues, and applied it\nto one case study.  The BYM2 model\nconsists of one precision parameter and one mixing parameter. The\nprecision parameter represents the marginal precision and controls the\nvariability explained by a spatial effect. The mixing parameter\ndistributes existing variability between an unstructured and\nstructured component. Importantly, the structured component is scaled\n\\cite{sorbye-rue-2014}, which facilitates prior\nassignment. Penalised complexity \npriors, i.e.~principle-based priors, are used to favour simpler models until a more complex model is supported. \nFurthermore, these priors allow epidemiologically intuitive specification of\nhyperparameters based on the relative risks. \n\n\nIn this paper we have systematically assessed the behaviour of the BYM2 model formulation. \nBy means of a simulation study based on the neighbourhood structure of\n$366$ regions in Sardinia, we have shown that the model is able to\nshrink towards both a constant risk surface or a spatially\nunstructured risk for different disease prevalences. This shows that\nthe model does not overfit. When the disease risk is spatially\nstructured, the model shows good learning abilities. In contrast to\nother model formulations, the\nposterior estimates of all hyperparameters can be directly and  intuitively interpreted.\nIn terms of\nmodel comparison, we have found that the BYM2 model  is\nslightly favored compared to the\nLeroux and Dean model in terms\nof DIC and logarithmic score in the case of a constant risk. In the\ncase of an unstructured risk the used model choice characteristics are\nalmost indistinguishable. We think that the practical benefits in terms\nof interpretability and prior assignment makes the BYM2 model\nadvantageous compared to existing models and we recommend its usage\nalso since its model criteria performance is at least as good as for existing methods.  \n\nAll models were\nimplemented using INLA \\cite{rue-etal-2009}, which provides efficient\nBayesian inference without the need of MCMC sampling. This facilitated\nthe simulation study considerably and allowed us to investigate different\nsimulation settings. The user-friendly implementation is illustrated\nby the R-code in~\\ref{app:rcode}. \n\nMacNab et al.\\cite{macnab-etal-2004} noted sensitivity in choosing a prior\ndistribution for the mixing parameter. Here, we investigated this issue\nempirically in both the simulation study and an application to insulin-dependent\ndiabetes mellitus in Sardinia. However, more effort needs to be placed\ninto a detailed prior sensitivity analysis following the theoretical\nframework of  Roos et al. \\cite{roos-etal-2014}.\n\nThe BYM2 model can be naturally combined with covariate\ninformation, see Simpson et al\\cite{simpson-etal-2015} for an\napplication, or integrated into a space-time context. However, it will require further work to distribute the variance not only within\nthe spatial components but over all model parameters in the linear\npredictor. It should be noted that the BYM2 model is not only\ninteresting within disease mapping but also within other fields, such as\ngenetics, where genes can be regarded as regions and the neighbourhood\nstructure represents which genes are linked. \n\n\\bibliography{literature.bib}\n\\bibliographystyle{SageV}\n\n\n\\clearpage\n\n\\newcommand{\\Appendix}{\\appendix \\def\\thesection{Appendix~\\Alph{section}} \\def\\thesubsection{\\Alph{section}.\\arabic{subsection}} }\n\n\\begin{appendix}\n\\Appendix \n\n\\section{Supplementary tables and figures}\\label{app:figtab}\n\n\n\\begin{table}[ht]\n\\small\\sf\\centering\n\\caption{Mean values of the intercept and hyperparameters,\n for the BYM2 model for varying disease\n  prevalence, using either a constant, spatially-varying unstructured\n  risk surfaces or spatially-varying structured risk surfaces.  A uniform\n  prior is used for the weighting parameter $\\phi$ while a PC-prior is\n  used for $\\tau_b$. Standard deviations are\n  provided in parentheses.  Results are based on $200$ simulations\nfor each setting, where the true  parameter values are provided in the table.} \\label{tab:simBYM2_unif}\n\n\\begin{tabular}{lccc}\n  \\toprule\n  & $\\mu$  & $1/\\sqrt{\\tau}$ & $\\phi$ \\\\\n  \\midrule\n  \\multicolumn{4}{l}{Constant risk ($1/\\sqrt{\\tau_b} = 0$, $\\phi=0$):} \\[.2cm]\nE = 15 & -7.50E-05 (0.01) & 0.02 (0.02) & 0.46 (0.05) \\\\ \n  E = 60 & -8.39E-04 (0.01) & 0.01 (0.01) & 0.46 (0.05) \\\\ \n  E = 200 & -4.15E-04 (0.004) & 0.01 (0.004) & 0.46 (0.04) \\[0.2cm]\n  \\multicolumn{4}{l}{Area-specific independent risk ($1/\\sqrt{\\tau_b}\n    = 0.5$, $\\phi = 0$):}  \\[.2cm]\nE = 15 & 1.69E-03 (0.03) & 0.50 (0.03) & 0.07 (0.04) \\\\ \n  E = 60 & -1.91E-03 (0.03) & 0.50 (0.02) & 0.06 (0.03) \\\\ \n  E = 200 & 1.21E-03 (0.03) & 0.51 (0.03) & 0.06 (0.03) \\[0.2cm]\n  \\multicolumn{4}{l}{Area-specific correlated risk ($1/\\sqrt{\\tau_b}\n    = 0.5$, $\\phi = 1$):}  \\[.2cm]\n\n\n\nE = 15 & 2.15E-03 (0.01) & 0.47 (0.03) & 0.90 (0.05) \\\\ \n  E = 60 & 1.32E-05 (0.01) & 0.49 (0.06) & 0.93 (0.04) \\\\ \n  E = 200 & 4.83E-05 (0.004) & 0.49 (0.07) & 0.93 (0.03) \\\\ \n   \\bottomrule\n \\end{tabular}\n\\end{table}\n\n\n\n\\begin{figure}[h]\n\\centering\n\\includegraphics[width=.95\\textwidth]{cpo_scores_33}\n\\caption{Boxplot of logarithmic scores for all six models for nine different simulation\n  settings.  For each setting 200 simulations were\n  generated. The left column shows results when simulating a constant\n  risk, the middle column those for an iid risk surface and the right\n  column those for a spatially structured risk surface. The rows\n  represent varying disease prevalence with $E=\\{15,60,200\\}$. Please\n  note that the y-axis range width is only kept constant\n  column-wise. For ease of visibility, the boxplots of the iid-model\n  for $E=15$ and $E=60$ in  the right column are slightly trimmed from\n  the top.\n}\\label{fig:cpo}\n\\end{figure}\n\n\\begin{figure}\n\\centering\n\\includegraphics[width=.95\\textwidth]{dic_scores_33}\n\\caption{Boxplot of DIC values for all six models for nine different simulation\n  settings.  For each setting 200 simulations were\n  generated. The left column shows results when simulating a constant\n  risk, the middle column those for an iid risk surface and the right\n  column those for a spatially structured risk surface. The rows\n  represent varying disease prevalence with $E=\\{15,60,200\\}$. Please\n  note that the y-axis range width is only kept constant column-wise. \nFor ease of visibility, the boxplot of the iid-model\n  for $E=15$  in  the right column is slightly trimmed from\n  the top.\n}\\label{fig:dic}\n\\end{figure}\n\n\\begin{table}\n\\small\\sf\\centering\n\\caption{Root mean square error (RMSE), DIC and logarithmic score\n  (LC) when using different models for analysing IDDM counts in\n  Sardinia. Four different priors for the mixing parameter $\\phi$ are\n  compared: PC 1 - $U=0.5, \\alpha=2/3$, PC 2 -  $U=0.5, \\alpha=0.5$, \n  PC 3 - $U=0.5, \\alpha=0.1$, uniform on $(0,1)$.}\\label{tab:mc-sardinia}\n\\begin{tabular}{rrrr}\n  \\toprule\n Model & RMSE & DIC & LS \\\\ \n  \\midrule\niid-model & 1.35 & 838 & 1.15 \\\\ \n  Besag & 1.35 & 831 & 1.14 \\\\ \n  BYM & 1.34 & 832 & 1.14 \\\\ \n  Leroux & 1.34 & 835 & 1.14 \\\\ \n  Dean & 1.34 & 834 & 1.14 \\\\ \n  BYM2 (PC1) & 1.33 & 834 & 1.14 \\\\ \n  BYM2 (PC2) & 1.34 & 833 & 1.14 \\\\ \n  BYM2 (PC3) & 1.34 & 833 & 1.14 \\\\ \n  BYM2 (Unif) & 1.34 & 833 & 1.14 \\\\ \n\n    \\bottomrule\n\\end{tabular}\n\\end{table}\n\n\\clearpage\n\n\\section{INLA R-code to implement the BYM2 model} \\label{app:rcode}\n\nIn the following, we illustrate how the BYM2 model can be implemented\nwithin the R-package {\\tt INLA}. \n\n\\small\n\\begin{lstlisting}\n# load the R-package\nlibrary(INLA)\n\n# provide the path to the file storing the neighbourhood structure\ng = \"sardinia.graph\"\n# read the data\nsardinia = read.table(\"sardinia.dat\", col.names=c(\"y\", \"E\", \"SMR\"))\n\n# show the first lines\nhead(sardinia)\n#   y          E       SMR\n#1  1  0.5986411 1.6704500\n#2  0  0.6055964 0.0000000\n#3 10 13.3658700 0.7481743\n#4  0  0.2346664 0.0000000\n\n# get the number of regions\nn = nrow(sardinia)\n# define a region index with values 1, 2, ..., n\nsardinia$region = 1:n\n\n# specify the latent structure using a formula object\nformula = y ~ 1 + f(region,\n                    model = \"bym2\",\n                    graph=g,\n                    scale.model = TRUE,\n                    constr = TRUE,\n                    hyper=list(\n                      phi = list(\n                        prior = \"pc\",\n                        param = c(0.5, 2/3),\n                        initial = -3),\n                      prec = list(\n                        prior = \"pc.prec\",\n                        param = c(0.2/0.31, 0.01),\n                        initial = 5)))\n\n# call the inla function\nresult = inla(formula, data = sardinia, family = \"poisson\", E=E,\n         control.predictor = list(compute=TRUE))\n# get improved estimates for the hyperparameters\nresult = inla.hyperpar(r, dz = 0.2, diff.logdens=20)\n\\end{lstlisting}\n\n\nFirst we have to load the INLA package which can be installed by\ntyping \n\\begin{lstlisting}\ninstall.packages(\"INLA\", repos=\"http://www.math.ntnu.no/inla/R/testing\")\n\\end{lstlisting}\nin the R-terminal. In this paper we used the INLA version\n0.0-1445883880. In order to define the model incorporating a spatially\nstructured component we need to provide the neighbourhood structure\nfor the regions we analyse. In INLA this is done by providing the\npath to the file which stores this information. The graph file for\nSardinia is named {\\tt sardinia.graph} and has the following structure:\n\\begin{verbatim}\n366\n0 5 13 61 69 73 81\n1 5 8 16 40 46 94\n2 4 47 59 63 77\n3 3 11 17 43\n4 5 24 41 51 56 67\n...\n363 5 292 307 324 344 346\n364 5 291 310 317 329 345\n365 3 289 303 308\n\\end{verbatim}\n\nThe first line provides the number of regions, here $366$. The following\n$366$ lines, corresponds to each of the regions, where the first entry always\nspecifies a unique region index. The second entry specifies the\nnumber of neighbouring regions, and then the corresponding region\nindices for those neighbours are listed. INLA transforms this\ninformation into the neighbourhood matrix $\\mathbf{Q}$ with entries as \nspecified in \\eqref{eq:besagQ}. \n\nLines 23--36 specify\nthe model structure in terms of a formula object. Here, we have an\nintercept and a latent Gaussian model given by  \\eqref{eq:bym2}. The\n{\\tt f(.)} function is used to specify a random effect in {\\tt\n  INLA}. The first argument is always the variable name to which it applies,\nhere region. We specify the use of the BYM2 model in line 24. Then, we\nprovide the graph and specify that we want to scale the model in line\n26. This will scale the graph as described in Section\n\\ref{sec:scaling}. To avoid confounding with the intercept a\nsum-to-zero constraint is specified in line 27. The next lines specify\nthe hyperprior for the two hyperparameters in form of a list of length\ntwo. The first list entry specifies the prior for the mixing parameter\n$\\phi$, named {\\tt phi} in the INLA implementation, the second entry for the precision parameter \n$\\tau_b$, named {\\tt prec}. Each entry is itself a list. Using the\nargument {\\tt prior} we specify the prior we would like to use. The\nparameters are set in the argument {\\tt param}. They coincide with the\nvalues used in Section~\\ref{sec:sardinia}. Using the argument {\\tt\n  initial} a starting value for the numerical optimisation of the INLA\nalgorithm can be provided. This has to be given on the log scale for\nthe precision and the logit scale for $\\phi$, as these are the scales INLA\nworks on internally.\n\nAfter defining the model, we call the {\\tt inla} function providing the\n{\\tt formula}, the data and the likelihood. Further, we specify the\nexpected number of counts and specify that we not only would like to\nget posterior estimates for the components of $\\eta_i$ but also\n$\\eta_i$ and $\\theta_i$ (line 40). Improved hyperparameter estimates\ncan be obtained by calling {\\tt inla.hyperpar} afterwards. Here, {\\tt\n  dz} and {\\tt diff.logdens} refer to options in the numerical\nintegration algorithm, see help page. \n\nResults can be inspected using {\\tt summary(result)} or {\\tt\n  plot(result)}. Posterior marginals for the fixed effects and hyperparameters can be\nconsequently accessed via {\\tt result\\$summary.fixed} or {\\tt\n  result\\$summary.hyperpar}, respectively.\n\n\\section{PC prior derivation}\\label{app:pc}\n\n\\subsection{Precision parameter $\\tau_b$}\\label{app:pc-prec}\nIn deriving the PC prior for $\\tau_b$, we start by assuming a large fixed precision $\\tau_0$\nfor the base model, where $\\tau_0 \\gg \\tau_b$. \n\n\n\n The resulting $n-1$-dimensional stochastic part of the Kullback-Leibler divergence is\n\n", "itemtype": "equation", "pos": 32687, "prevtext": "\nIn our case, $\\mathbf{\\Sigma}_{\\text{flex}}(\\tau_b)=\n\\text{Var}(\\mathbf{b}\\mid \\tau_b, \\phi)$ as defined in (\\ref{eq:varbym2}),\nwhile the covariance matrix of the base model is\n$\\mathbf{\\Sigma}_{\\text{base}}=\\mathbf{0}$, reflecting infinite\nprecision. Details regarding the computation of \\eqref{eq:KLD} are\npresented in Simpson et al. \\cite{simpson-etal-2015} and for completeness\nprovided in~\\ref{app:pc}.  On the distance scale the meaning of a prior is much more\nclear.  The prior should have mode at zero, i.e. at the base model, and decreasing density\nwith increasing distance. There are different priors that fulfill\nthese properties, but differ in the way they decrease with increasing\ndistance. Since we are not in a variable selection setting, we follow\nthe recommendation of Simpson et al. \\cite{simpson-etal-2015} and use\nthe exponential \ndistribution, which supports constant-rate penalisation.  Applying the ordinary change\nof variable transformation, a type-2 Gumbel distribution\\citep{simpson-etal-2015}\n\n", "index": 33, "text": "\\begin{gather*}\n  \\pi(\\tau_b) = \\frac{\\theta}{2} \\tau_b^{-3/2} \\exp\\left(-\\theta\n    \\tau_b^{-1/2}\\right)\n\\end{gather*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex9.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\pi(\\tau_{b})=\\frac{\\theta}{2}\\tau_{b}^{-3/2}\\exp\\left(-\\theta%&#10;\\tau_{b}^{-1/2}\\right)\" display=\"block\"><mrow><mrow><mi>\u03c0</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c4</mi><mi>b</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mi>\u03b8</mi><mn>2</mn></mfrac><mo>\u2062</mo><msubsup><mi>\u03c4</mi><mi>b</mi><mrow><mo>-</mo><mrow><mn>3</mn><mo>/</mo><mn>2</mn></mrow></mrow></msubsup><mo>\u2062</mo><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo>(</mo><mrow><mo>-</mo><mrow><mi>\u03b8</mi><mo>\u2062</mo><msubsup><mi>\u03c4</mi><mi>b</mi><mrow><mo>-</mo><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow></mrow></msubsup></mrow></mrow><mo>)</mo></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.01180.tex", "nexttext": "\nwhich implies\n$d(\\tau_b) \\rightarrow \\sqrt{(n-1)\\tau_0/\\tau_b}$. \n\nThe next step is to assign a prior to the distance $d(\\tau_b)$ and transform this  by a change of variables. \nWe use the exponential prior with decay rate $\\lambda$, which\nsupports the constant-rate penalisation and apply the ordinary change of variable transformation\n\n", "itemtype": "equation", "pos": 67532, "prevtext": "\nis obtained as prior for $\\tau_b$.\n\nThe given prior corresponds to an exponential prior with rate $\\theta$\nfor the standard deviation $1/\\sqrt{\\tau_b}$. Hence, to infer $\\theta$\nwe can use the probability statement $\\text{Prob}((1/\\sqrt{\\tau_b}) >\nU) = \\alpha$, which gives $\\theta = - \\log(\\alpha)/U$. It is not\nobvious how to interpret $1/\\sqrt{\\tau_b}$ epidemiologically. However,\nin the BYM2 model, $\\tau_b$ represents the marginal precision, and as\nsuch, can be related to the total residual relative risk for which an\nintuitive interpretation is available \\cite{wakefield-2007}. For\nexample, an assumed probability of $0.99$ of having residual relative\nrisks  smaller than 2, corresponds approximately to\n$\\text{Prob}((1/\\sqrt{\\tau_b}) > 1) = 0.01$. Figure~\\ref{fig:prior}\n(left panel) shows the resulting prior compared to two gamma\ndistributions,  which will be used in the simulation study in\nSection~\\ref{sec:application}. Please note that the use of gamma priors is questionable as the base model, i.e.\ndistance equal to zero, has no density mass and can therefore never be\nobtained. We refer to Simpson et al.\\cite{simpson-etal-2015} for further discussions about overfitting of priors.\n\\begin{figure}\n\\centering\n\\includegraphics[width=0.9\\textwidth]{priors}\n\\caption{Left panel: PC prior for $\\tau_b$ (solid) with parameters\n  $U=1$ and $\\alpha = 0.01$, and two gamma priors where for both the\n  shape parameter is equal to one and the rate parameter is either\n  0.01 (dashed, light-gray) or 0.02 (dashed, dark-gray). Right panel:\n   PC prior for the mixing parameter $\\phi$ with $U = 0.5$ and $\\alpha =\n  2/3$ (solid), and a uniform prior on (0,1) (dashed). }\\label{fig:prior}\n\\end{figure}\n\n\n\n\n\n\\subsection{Distributing the spatial variance  contribution}\nAssume now that the relative risk has spatial variation. This implies that \nthe disease burden over the regions is not constant. Conditioned on a fixed marginal variance, the\nsecond-level base model is defined as having only unstructured spatial noise and no spatial\ndependency, i.e. $\\phi=0$. By increasing the value of $\\phi$, spatial dependency is gradually blended into the model and the model component explaining most of the variance shifts from\n$\\mathbf{v}$ to $\\mathbf{u}_\\star$\\cite{simpson-etal-2015}.\n\nTo derive the PC prior for $\\phi$, we first compute the KLD of the base model from\nthe flexible model, see~Appendix~\\ref{app-mixing}. The covariance matrices for the base and flexible models are\n$\\mathbf{\\Sigma}_{\\text{base}} =  \\mathbf{I}$ and\n$\\mathbf{\\Sigma}_{\\text{flex}}(\\phi) =  (1-\\phi) \\: \\mathbf{I} +\n\\phi\\mathbf{Q}_\\star^{-}$, respectively. \nAnalogously as for $\\tau_b$, we assign an exponential prior with parameter $\\lambda$ to\nthe distance scale $d(\\phi) = \\sqrt{2\\mbox{KLD}(\\phi)}$. For simplicity, this prior is\ntransformed to give a prior on $\\text{logit}(\\phi)$, as $\\phi$ is\ndefined on a bounded interval. Reasonable values of  $\\lambda$ can be\ninferred in a similar way as in Section~\\ref{sec:pc-prec}, using a\nprobability statement $\\text{Prob}(\\phi < U) = \\alpha$. In this way\nit is straightforward to specify both strong or weak prior\ninformation. \nThe parameter $\\phi$ has a more direct  interpretation  than\nthe precision parameter $\\tau_b$, representing a fraction of the total variance which can be attributed to spatial dependency structure. A reasonable formulation might\nbe  $\\text{Prob}(\\phi < 0.5) = 2/3$, which gives more density mass to\nvalues of $\\phi$ smaller than $0.5$. This can be seen as a\nconservative choice, assuming that the unstructured random effect\naccounts for more of the variability than the spatially  structured\neffect.\n\nIn contrast to the precision parameter $\\tau_b$, the resulting PC prior for $\\phi$\nis not available in closed form.\nWithin INLA, the function {\\tt INLA:::inla.pc.bym.phi} can be used\nto compute the prior for $\\phi$ (on logit-scale) for a specific\nBesag neighbourhood matrix~$\\mathbf{Q}$.\nThe scaling of the graph is implemented by default.\nThus, the prior can be obtained in tabulated form and also\nincorporated in other software packages than INLA.\nFigure~\\ref{fig:prior} (right panel)  shows the prior for $\\phi$ with  $U = 0.5$ and $\\alpha=2/3$,\ngenerated in {\\tt R} using\n\\begin{Sinput}\nR> log.prior = INLA:::inla.pc.bym.phi(Q = Q, rankdef = 1,\nR>    u = 0.5, alpha = 2/3)\nR> phis = 1/(1+exp(-seq(-10, 10, len=10000)))\nR> plot(phis, exp(log.prior(phis)), type=\"l\",\nR>     lwd = 2,  bty = \"l\", ylim = c(0,10),\nR>     xlab = expression(phi), ylab = \"Density\")\n\\end{Sinput}\nFor comparison, the figure also displays the commonly used uniform prior for $\\phi$.\n\n\n\n\\section{Applications}\\label{sec:application}\n\n\\subsection{Does the modified BYM model shrink to the respective base models?}\n\nVarious types of cancer data, observed in the $544$ districts of\nGermany (Figure~\\ref{fig:germany}), have been widely analysed in\nthe literature, both to study the epidemiology\n\\cite{natario-knorrHeld-2003} and to test\nmethodological developments \\cite{knorr-rue-2002}. Simpson et\nal. \\cite{simpson-etal-2015} re-analyse a larynx cancer dataset, assigning the PC priors shown in\nFigure~\\ref{fig:prior} to the hyperparameters. The modified BYM model\n(\\ref{eq:bym2}), here referred to as the BYM2 model, is clearly seen to\nlearn from the data, leading to a posterior marginal concentrated\naround 1 for~$\\phi$. \n\n\\subsubsection{Results}\\label{sec:results}\nHere, we perform a simulation study to investigate whether the BYM2\nmodel shrinks towards the two different base models described in\nSection~\\ref{sec:pcprior}. Furthermore, we assess the behaviour under \na perfectly structured risk surface. The simulations are based on the\nneighbourhood structure of $366$ districts of Sardinia, for which\na real case study will be analysed in Section~\\ref{sec:sardinia}. \nTwo hundred datasets were simulated under\nnine different scenarios, using three different types of risk surfaces\nand three different disease prevalences. The model we simulate\nfrom assumes that the log relative risk is given as\n$\\log(\\theta_i) = \\mu + \\frac{1}{\\sqrt{\\tau_b}} b_i$, $i=1, \\ldots, 366$, where $\\mathbf{b}$\nis a zero-mean normal distributed random effect controlled by the\nprecision parameter $\\tau_b$. In the simulations, we assume either \na constant risk over all regions, i.e. $1/\\sqrt{\\tau_b}=0$,  an\nindependent area-specific risk setting with $1/\\sqrt{\\tau_b}=0.5$ and\n$\\mathbf{b} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{I})$,  or a spatially\nstructured area-specific risk setting with $1/\\sqrt{\\tau_b}=0.5$ and\n$\\mathbf{b} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{Q}_\\star^{-})$.\n  We alter the expected number of cases $E_{i}$ to analyse whether\n  the model performance changes when applied to diseases with\n  different underlying disease prevalence. We set all $E_{i}$ equal\n  to either $15$, $60$ or $200$ and analyse all datasets using the\n  {\\tt INLA} package in~{\\tt R}.\n\n\n\nTable~\\ref{tab:simBYM2} shows the posterior mean estimates for the\nintercept and the two hyperparameters, also including the average standard deviations of the\nestimates in parentheses. \n\\begin{table}\n\\small\\sf\\centering\n\\caption{Mean values of the intercept and hyperparameters,\n for the BYM2 model for varying disease\n  prevalence, using either a constant, spatially-varying unstructured\n  risk surfaces or spatially-varying structured risk surfaces. PC\n  priors are used for the weighting parameter $\\phi$ and for the\n  precision parameter $\\tau_b$. Standard deviations are\n  provided in parentheses.  Results are based on $200$ simulations\nfor each setting, where the true  parameter values are provided in the table.} \\label{tab:simBYM2}\n\\begin{tabular}{lccc}\n  \\toprule\n  & $\\mu$  & $1/\\sqrt{\\tau}$ & $\\phi$ \\\\\n  \\midrule\n  \\multicolumn{4}{l}{Constant risk ($1/\\sqrt{\\tau_b} = 0$, $\\phi=0$):} \\[.2cm]\nE = 15 & -3.78E-04 (0.01) & 0.02 (0.02) & 0.26 (0.05) \\\\ \n  E = 60 & -9.15E-04 (0.01) & 0.01 (0.01) & 0.26 (0.05) \\\\ \n  E = 200 & -4.36E-04 (0.004) & 0.01 (0.01) & 0.26 (0.04) \\\\ \n  \\multicolumn{4}{l}{Area-specific independent risk ($1/\\sqrt{\\tau_b}\n    = 0.5$, $\\phi = 0$):}  \\[.2cm]\nE = 15 & 1.62E-03 (0.03) & 0.50 (0.02) & 0.05 (0.03) \\\\ \n  E = 60 & -1.94E-03 (0.03) & 0.51 (0.03) & 0.04 (0.02) \\\\ \n  E = 200 & 1.21E-03 (0.03) & 0.50 (0.02) & 0.04 (0.02) \\\\ \n  \\multicolumn{4}{l}{Area-specific correlated risk ($1/\\sqrt{\\tau_b}\n    = 0.5$, $\\phi = 1$):}  \\[.2cm]\nE = 15 & 2.14E-03 (0.01) & 0.47 (0.04) & 0.90 (0.06) \\\\ \n  E = 60 & 9.11E-06 (0.01) & 0.49 (0.05) & 0.93 (0.04) \\\\ \n  E = 200 & 4.70E-05 (0.004) & 0.49 (0.07) & 0.93 (0.04) \\\\ \n   \\bottomrule\n \\end{tabular}\n\\end{table}\n\nThe constant risk surface scenario corresponds to the first-level base\nmodel described in Section~\\ref{sec:pcprior}. The resulting estimates are reasonable for all parameters. Specifically, the standard\ndeviation $1/\\sqrt{\\tau_b}$ is close to zero, and decreases with higher prevalence.\nAs these datasets give no information about the mixing parameter, the prior will dominate the posterior estimates of $\\phi$.\nThe assumption of independent, area-specific spatial variation of the risk surface, corresponds to the second-level base model in Section~\\ref{sec:pcprior}.  Again, the posterior mean parameter estimates are seen to be close to the true values. In particular, the model is seen to shrink towards the base model as the estimated mixing\nparameters are very close to zero, distributing all of the spatial variation to the\nunstructured component. In the case of a spatially structure surface\nrisk,  the intercept and $1/\\sqrt{\\tau_b}$ are well estimated.\nThe mixing parameter $\\phi$ is estimated slightly lower when\n$E_{i}=15$ compared to $E_{i}=60$ and $E_{i}=200$, where the estimates\nare closer to $1$. This illustrates the learning ability of the model\nto support a more complex model if indicated by the data. \n\nWe repeated the simulation study using a uniform prior for the mixing\nparameter $\\phi$. The obtained results are comparable, see\nTable~\\ref{tab:simBYM2_unif} in~\\ref{app:figtab}. Differences\noccur in the case of a simulated constant risk surface where the estimates\nof the mixing parameter are  now close to\n$0.5$, as the estimate is dominated by the new prior. \nIn the case of a spatially unstructured or structured risk, the\nobtained  parameter estimates are seen to be robust to the\nprior choice for the mixing parameter. \n\n\n\\subsubsection{Comparison to other spatial latent models}\nThe main benefit of the BYM2 model is that it allows for\nan intuitive parameter interpretation and facilitates prior\nassignment. Performance in terms of model choice criteria is regarded\nsecondary and will be assessed in this section. To compare the BYM2\nmodel with existing approaches, we fit the spatial\nlatent models presented in Section~\\ref{sec:review} to the simulated data. We\nalso include a model having only an unstructured spatial component,\nreferred to as the iid-model. For the BYM2 model we use either a PC\nprior with $U=0.5$ and $\\alpha=2/3$, denoted as BYM2 (PC), or a\nuniform prior, denoted as BYM2 (unif), for the mixing parameter.\n\nTable~\\ref{tab:simAll} illustrates the resulting posterior parameter estimates,\nassuming a constant risk surface and $E=60$. The table also reports three model choice criteria for this scenario: The\nroot-mean squared error (RMSE), computed as the average of\n$\\sqrt{\\tfrac{1}{366} \\sum_{i=1}^{366}(y_i/E_i - \\hat{\\theta}_i)^2}$ over all 200\nsimulations with $\\hat{\\theta}_i$ denoting the posterior mean fitted risk, the average deviance information criterion (DIC)\n\\cite{spiegelhalter-etal-2002}, and the average proper logarithmic scoring rule\n(LS) \\cite{gneiting-raftery-2007}. For all three criteria, lower\nvalues imply better model properties. Note that the parameter estimates of\nthe BYM model are not included here as it is not parameterised in\nterms of one precision and one mixing parameter. However, we will\nconsider it in terms of model choice, see Figure~\\ref{fig:cpo} -- \\ref{fig:dic}.\n\nThe estimated parameter values in Table~\\ref{tab:simAll} have to be\ninterpreted with great care. \nEven though the different models look comparable and the parameters have the same name, their interpretations are not equivalent. A first issue is that\nwe use different priors for the hyperparameters. Specifically, we assume that  $\\phi \\sim\n\\text{Unif}(0,1)$ for the Leroux and Dean model, as this represents a popular\nnon-informative prior choice in the literature\n\\citep{wakefield-2007,macnab-2010,ugarte-etal-2014}. Further, we assume a \n$\\Gamma(\\text{shape}=1, \\text{rate}=0.01)$ distribution for the precision\nparameter in the iid-model. For the spatially structured term, we took the graph structure of\nSardinia into account and use a $\\Gamma(\\text{shape}=1, \\text{rate}=0.02)$\n\\cite{bernardinelli-etal-1995} prior. However, also the different\nparameterisation of the Leroux and Dean model imply that the parameters\nare not comparable.  It is only when $\\phi=0$ or $\\phi =1$, these models\nreduce to the same model (assuming the same prior for the\nprecision parameter).\n\nThe second issue is that none of the models are properly scaled, except the BYM2 model.  Specifically, the \nprecision parameter in the Leroux and Dean model does not represent\nthe marginal precision.  It is still confounded with $\\phi$ and hence not\ncomparable to the BYM2 model. The only parameter estimates that are\ncomparable are those from the iid-model and the BYM2 model. The Besag\nmodel can be scaled, and so can the  Dean model leading to\nthe parameterisation of the BYM2 model. However, the Leroux model cannot be\nscaled as any scaling would depend on the mixing parameter\n$\\phi$. Hence,  the precision parameter cannot be interpreted as\nmarginal precision as it depends on the\nunderlying graph structure and is in addition confounded with the mixing\nparameter. \n\nEven though the parameters of the models have different interpretations and priors are chosen differently, the\nmodel choice criteria give quite similar average values, for all the\nmodels and only the DIC values seem to slightly favour the two BYM2\nmodels. This means that the BYM2 performs at least as well as the other\nmodels and changing the prior for the mixing parameters leads to the\nsame results. This is also confirmed inspecting the\nlogarithmic scores and  DIC values over all simulations, in terms of boxplots, see\nFigures~\\ref{fig:cpo} and \\ref{fig:dic} in~\\ref{app:figtab}, respectively. Results for these\ntwo model choice criteria coincide well and indicate that the\nBesag model performs worse than the other models when simulating an\nindependent area-specific risk surface, where the iid-model is\nnaturally but only marginally favoured. In contrast, the iid model performs\nworse when simulating a spatially-structured surface, where the Besag\nmodel is marginally favoured for low values of $E_{i}$. The other\nmodels perform almost identically in both of these simulation\nsettings. Simulating a constant-risk surface, all models behave similarly\nfor $E_{i}=15$. For increasing numbers of expected cases, the BYM2\nmodel seems to be slightly beneficial. The figures only include\nthe boxplots obtained by the BYM2 model using a PC prior for $\\phi$,\nas results using a uniform prior are visually identical.\n\n\\begin{table}\n\\small\\sf\\centering\n\\caption{Mean values of the intercept and hyperparameters,\n  root mean square error (RMSE) for the fitted risk, DIC and logarithmic score (LS) when using\n  different spatial latent models. Standard deviations are\n  provided in parentheses.  Results are based on $200$ simulations\nwhere the true values are $\\mu = 0$, $1/\\sqrt{\\tau} = 0$, $\\phi = 0$,\n$E=60$. Be aware that parameter estimates might not be directly\ncomparable between models.} \\label{tab:simAll}\n\\begin{tabular}{lccccccc}\n  \\toprule\n  & $\\mu$  & $1/\\sqrt{\\tau}$ & $\\phi$ & RMSE & DIC & LS  \\\\\n  \\midrule\n  iid-model & -1.65E-03 (0.01) & 0.05 (0.004) & 0.00 (-) & 0.11 & 2545 & 3.47 \\\\ \n  Besag & -1.26E-03 (0.01) & 0.07 (0.004) & 1.00 (-) & 0.12 & 2545 & 3.48 \\\\ \n  Leroux & -1.51E-03 (0.01) & 0.07 (0.01) & 0.56 (0.08) & 0.11 & 2545 & 3.48 \\\\ \n  Dean & -1.69E-03 (0.01) & 0.06 (0.004) & 0.60 (0.12) & 0.11 & 2547 & 3.48 \\\\ \n  BYM2 (unif) & -8.39E-04 (0.01) & 0.01 (0.01) & 0.46 (0.05) & 0.12 & 2540 & 3.47 \\\\ \n  BYM2 (PC)  & -9.15E-04 (0.01) & 0.01 (0.01) & 0.26 (0.05) & 0.12 & 2540 & 3.47 \\\\ \n   \\bottomrule\n\\end{tabular}\n\\end{table}\n\n\n\n\\subsection{Analysis of insulin-dependent diabetes mellitus in Sardinia}\\label{sec:sardinia}\n\nWe re-analyse insulin-dependent diabetes mellitus (IDDM) counts in\nSardinia, see Bernardinelli et al.~\\citep{bernadinelli-etal-1997} and\nKnorr-Held and Rue \\cite{knorr-rue-2002} for previous analyses. This dataset\nhas low counts. Only $619$ cases were registered for $n=366$ districts\nin the period $1989$--$1992$, for the population aged $0$--$29$ years\nand there are no covariates. Spatial smoothing is essential to reduce\nthe large variance in the estimates, and to get a realistic picture of\nthe underlying risk surface. Held \\cite{held-2004} has demonstrated that a\nconstant risk is well supported by the posterior distribution, \nand based on this we would expect shrinkage towards the first-level base model.\n\nWe use $U = 0.5$ and $\\alpha=2/3$ for the prior of $\\phi$. For\n$\\tau_b$ we use $U=0.2/0.31$ and $\\alpha=0.1$ which corresponds to a\nmarginal standard deviation of $0.2$. The R-code to fit the BYM2 model\nusing the INLA-package is explained in~\\ref{app:rcode}.\nThe posterior estimates are shown in Table~\\ref{tab:sardiniaEst}\n(first quarter). We\nsee that the precision estimate is rather high supporting a constant log\nrelative risk as a zero log relative risk is well within all the\nposterior credible intervals for $\\{\\eta_i\\}$. The\nposterior marginal is mostly uniform giving essentially no information on which\ncomponent is describing the variance. Figure~\\ref{fig:sardiniaRR}\nshows the posterior mean for the relative risk over all $366$ regions.\n\n\\begin{figure}\n\\centering\n\\includegraphics[width=.7\\textwidth]{sardiniaEstimate}\n\\caption{Posterior mean of the relative risk for IDDM counts in\n  Sardinia using the BYM2 model.}\\label{fig:sardiniaRR}\n\\end{figure}\n\n\n\\begin{table}\n\\small\\sf\\centering\n\\caption{Posterior quantities for the intercept and hyperparameters\n  under three different PC priors or a uniform prior for the mixing parameter $\\phi$ for IDDM\n  counts in Sardinia.}\\label{tab:sardiniaEst}\n\\begin{tabular}{rrrrrrr}\n  \\toprule\n & Mean & SD & $2.5\\%$ quant. & Median & $97.5$ quant. & Mode \\\\ \n  \\midrule  \n&\\multicolumn{4}{l}{Prior for $\\phi$: $U=0.5$, $\\alpha=2/3$} & \\[.2cm]\n$\\mu$ & 0.01 & 0.05 & -0.09 & 0.01 & 0.10 & 0.01 \\\\ \n $\\tau_b$ & 262.79 & 751.60 & 10.14 & 45.36 & 2549.91 & 17.40 \\\\ \n$\\phi$ & 0.48 & 0.31 & 0.01 & 0.48 & 0.98 & 1.00 \\[.2cm]\n   &\\multicolumn{4}{l}{Prior for $\\phi$: $U=0.5$, $\\alpha=0.5$} & \\[.2cm] \n $\\mu$ & 0.01 & 0.05 & -0.09 & 0.01 & 0.10 & 0.01 \\\\ \n $\\tau_b$ & 233.51 & 686.28 & 10.00 & 42.78 & 2241.48 & 17.37 \\\\ \n$\\phi$ & 0.54 & 0.31 & 0.02 & 0.57 & 0.99 & 1.00 \\[.2cm]\n   &\\multicolumn{4}{l}{Prior for $\\phi$: $U=0.5$, $\\alpha=0.1$} & \\[.2cm]  \n $\\mu$ & 0.01 & 0.05 & -0.08 & 0.01 & 0.11 & 0.01 \\\\ \n $\\tau_b$ & 201.56 & 616.57 & 9.83 & 40.11 & 1880.89 & 17.27 \\\\ \n$\\phi$ & 0.63 & 0.29 & 0.03 & 0.69 & 1.00 & 1.00 \\[.2cm]\n   &\\multicolumn{4}{l}{Prior for $\\phi$: Unif$(0,1)$} & \\[.2cm]  \n $\\mu$ & 0.01 & 0.05 & -0.08 & 0.01 & 0.11 & 0.01 \\\\ \n $\\tau_b$ & 189.46 & 591.67 & 9.77 & 39.07 & 1734.34 & 17.21 \\\\ \n$\\phi$ & 0.64 & 0.26 & 0.08 & 0.69 & 0.99 & 1.00 \\\\ \n   \\bottomrule\n\\end{tabular}\n\\end{table}\n\nMacNab et al. \\cite{macnab-etal-2004} noted considerable sensitivity\nregarding the prior choice for $\\phi$ in the Leroux model. For the\nSardinia data, we\nempirically check sensitivity by changing the parameters of the\nPC-prior for $\\phi$ to $U=0.5$ and $\\alpha=0.5$, $U=0.5$ and\n$\\alpha=0.1$. That means a priori\nwe expect that either $50\\%$ or $90\\%$ of the variation is explained by the spatially\nstructured component, respectively. As a fourth alternative we consider\na uniform prior for $\\phi$. The rest of Table~\\ref{tab:sardiniaEst}\nshows the obtained posterior quantities. The estimates for the intercept\nstay unchanged. We see a slight change in the posterior estimates for \n$\\tau_b$ and $\\phi$,\nwhereby the posterior marginal of $\\phi$ still supports almost the whole\nrange for all priors. The posterior precision slightly decreases,\nwhereby the $2.5\\%$ quantile and the median stay fairly constant. The upper quantile \nand therefore the mean change more clearly. As in MacNab et\nal.~\\cite{macnab-etal-2004}, the effect on the posterior risk estimates\nis negligible (Figure~\\ref{fig:sardiniaRes}).\n\n\\begin{figure}\n\\centering\n\\includegraphics[width=.95\\textwidth]{compareRR-rev}\n\\caption{Comparison of the posterior mean of the relative risk under\n  four different prior distributions for the mixing parameter $\\phi$ for IDDM\n  counts in Sardinia.}\\label{fig:sardiniaRes}\n\\end{figure}\n\n\n\\section{Discussion}\\label{sec:discussion}\n\nThroughout this paper we have stressed the importance of scaling in\nBayesian disease mapping. Without proper scaling, hyperparameters have\nno clear meaning and may be falsely interpreted. To be more specific,\nthe precision parameter of the commonly used Leroux and Dean models\ntends to be falsely interpreted as marginal precision controlling the\ndeviation from a constant disease risk over space. However, the parameter depends on the\nunderlying graph structure and is confounded with the mixing\nparameter if the structured spatial component is not appropriately scaled. In addition, it is not clear how to choose a prior\ndistribution for this parameter. First, due to the lack of scaling, a fixed hyperprior\nfor the precision parameter gives different amount of smoothing if the graph on which given disease counts are observed is changed. Second,\ncommonly used hyperprior distributions induce\noverfitting\\cite{simpson-etal-2015} and will not allow to \nreduce to simpler models such as a constant risk surface or\nuncorrelated noise over space. \n\nSimpson et al. \\cite{simpson-etal-2015} proposed a new modification of the commonly known\nBYM model, termed BYM2 model,  which addresses the aforementioned issues, and applied it\nto one case study.  The BYM2 model\nconsists of one precision parameter and one mixing parameter. The\nprecision parameter represents the marginal precision and controls the\nvariability explained by a spatial effect. The mixing parameter\ndistributes existing variability between an unstructured and\nstructured component. Importantly, the structured component is scaled\n\\cite{sorbye-rue-2014}, which facilitates prior\nassignment. Penalised complexity \npriors, i.e.~principle-based priors, are used to favour simpler models until a more complex model is supported. \nFurthermore, these priors allow epidemiologically intuitive specification of\nhyperparameters based on the relative risks. \n\n\nIn this paper we have systematically assessed the behaviour of the BYM2 model formulation. \nBy means of a simulation study based on the neighbourhood structure of\n$366$ regions in Sardinia, we have shown that the model is able to\nshrink towards both a constant risk surface or a spatially\nunstructured risk for different disease prevalences. This shows that\nthe model does not overfit. When the disease risk is spatially\nstructured, the model shows good learning abilities. In contrast to\nother model formulations, the\nposterior estimates of all hyperparameters can be directly and  intuitively interpreted.\nIn terms of\nmodel comparison, we have found that the BYM2 model  is\nslightly favored compared to the\nLeroux and Dean model in terms\nof DIC and logarithmic score in the case of a constant risk. In the\ncase of an unstructured risk the used model choice characteristics are\nalmost indistinguishable. We think that the practical benefits in terms\nof interpretability and prior assignment makes the BYM2 model\nadvantageous compared to existing models and we recommend its usage\nalso since its model criteria performance is at least as good as for existing methods.  \n\nAll models were\nimplemented using INLA \\cite{rue-etal-2009}, which provides efficient\nBayesian inference without the need of MCMC sampling. This facilitated\nthe simulation study considerably and allowed us to investigate different\nsimulation settings. The user-friendly implementation is illustrated\nby the R-code in~\\ref{app:rcode}. \n\nMacNab et al.\\cite{macnab-etal-2004} noted sensitivity in choosing a prior\ndistribution for the mixing parameter. Here, we investigated this issue\nempirically in both the simulation study and an application to insulin-dependent\ndiabetes mellitus in Sardinia. However, more effort needs to be placed\ninto a detailed prior sensitivity analysis following the theoretical\nframework of  Roos et al. \\cite{roos-etal-2014}.\n\nThe BYM2 model can be naturally combined with covariate\ninformation, see Simpson et al\\cite{simpson-etal-2015} for an\napplication, or integrated into a space-time context. However, it will require further work to distribute the variance not only within\nthe spatial components but over all model parameters in the linear\npredictor. It should be noted that the BYM2 model is not only\ninteresting within disease mapping but also within other fields, such as\ngenetics, where genes can be regarded as regions and the neighbourhood\nstructure represents which genes are linked. \n\n\\bibliography{literature.bib}\n\\bibliographystyle{SageV}\n\n\n\\clearpage\n\n\\newcommand{\\Appendix}{\\appendix \\def\\thesection{Appendix~\\Alph{section}} \\def\\thesubsection{\\Alph{section}.\\arabic{subsection}} }\n\n\\begin{appendix}\n\\Appendix \n\n\\section{Supplementary tables and figures}\\label{app:figtab}\n\n\n\\begin{table}[ht]\n\\small\\sf\\centering\n\\caption{Mean values of the intercept and hyperparameters,\n for the BYM2 model for varying disease\n  prevalence, using either a constant, spatially-varying unstructured\n  risk surfaces or spatially-varying structured risk surfaces.  A uniform\n  prior is used for the weighting parameter $\\phi$ while a PC-prior is\n  used for $\\tau_b$. Standard deviations are\n  provided in parentheses.  Results are based on $200$ simulations\nfor each setting, where the true  parameter values are provided in the table.} \\label{tab:simBYM2_unif}\n\n\\begin{tabular}{lccc}\n  \\toprule\n  & $\\mu$  & $1/\\sqrt{\\tau}$ & $\\phi$ \\\\\n  \\midrule\n  \\multicolumn{4}{l}{Constant risk ($1/\\sqrt{\\tau_b} = 0$, $\\phi=0$):} \\[.2cm]\nE = 15 & -7.50E-05 (0.01) & 0.02 (0.02) & 0.46 (0.05) \\\\ \n  E = 60 & -8.39E-04 (0.01) & 0.01 (0.01) & 0.46 (0.05) \\\\ \n  E = 200 & -4.15E-04 (0.004) & 0.01 (0.004) & 0.46 (0.04) \\[0.2cm]\n  \\multicolumn{4}{l}{Area-specific independent risk ($1/\\sqrt{\\tau_b}\n    = 0.5$, $\\phi = 0$):}  \\[.2cm]\nE = 15 & 1.69E-03 (0.03) & 0.50 (0.03) & 0.07 (0.04) \\\\ \n  E = 60 & -1.91E-03 (0.03) & 0.50 (0.02) & 0.06 (0.03) \\\\ \n  E = 200 & 1.21E-03 (0.03) & 0.51 (0.03) & 0.06 (0.03) \\[0.2cm]\n  \\multicolumn{4}{l}{Area-specific correlated risk ($1/\\sqrt{\\tau_b}\n    = 0.5$, $\\phi = 1$):}  \\[.2cm]\n\n\n\nE = 15 & 2.15E-03 (0.01) & 0.47 (0.03) & 0.90 (0.05) \\\\ \n  E = 60 & 1.32E-05 (0.01) & 0.49 (0.06) & 0.93 (0.04) \\\\ \n  E = 200 & 4.83E-05 (0.004) & 0.49 (0.07) & 0.93 (0.03) \\\\ \n   \\bottomrule\n \\end{tabular}\n\\end{table}\n\n\n\n\\begin{figure}[h]\n\\centering\n\\includegraphics[width=.95\\textwidth]{cpo_scores_33}\n\\caption{Boxplot of logarithmic scores for all six models for nine different simulation\n  settings.  For each setting 200 simulations were\n  generated. The left column shows results when simulating a constant\n  risk, the middle column those for an iid risk surface and the right\n  column those for a spatially structured risk surface. The rows\n  represent varying disease prevalence with $E=\\{15,60,200\\}$. Please\n  note that the y-axis range width is only kept constant\n  column-wise. For ease of visibility, the boxplots of the iid-model\n  for $E=15$ and $E=60$ in  the right column are slightly trimmed from\n  the top.\n}\\label{fig:cpo}\n\\end{figure}\n\n\\begin{figure}\n\\centering\n\\includegraphics[width=.95\\textwidth]{dic_scores_33}\n\\caption{Boxplot of DIC values for all six models for nine different simulation\n  settings.  For each setting 200 simulations were\n  generated. The left column shows results when simulating a constant\n  risk, the middle column those for an iid risk surface and the right\n  column those for a spatially structured risk surface. The rows\n  represent varying disease prevalence with $E=\\{15,60,200\\}$. Please\n  note that the y-axis range width is only kept constant column-wise. \nFor ease of visibility, the boxplot of the iid-model\n  for $E=15$  in  the right column is slightly trimmed from\n  the top.\n}\\label{fig:dic}\n\\end{figure}\n\n\\begin{table}\n\\small\\sf\\centering\n\\caption{Root mean square error (RMSE), DIC and logarithmic score\n  (LC) when using different models for analysing IDDM counts in\n  Sardinia. Four different priors for the mixing parameter $\\phi$ are\n  compared: PC 1 - $U=0.5, \\alpha=2/3$, PC 2 -  $U=0.5, \\alpha=0.5$, \n  PC 3 - $U=0.5, \\alpha=0.1$, uniform on $(0,1)$.}\\label{tab:mc-sardinia}\n\\begin{tabular}{rrrr}\n  \\toprule\n Model & RMSE & DIC & LS \\\\ \n  \\midrule\niid-model & 1.35 & 838 & 1.15 \\\\ \n  Besag & 1.35 & 831 & 1.14 \\\\ \n  BYM & 1.34 & 832 & 1.14 \\\\ \n  Leroux & 1.34 & 835 & 1.14 \\\\ \n  Dean & 1.34 & 834 & 1.14 \\\\ \n  BYM2 (PC1) & 1.33 & 834 & 1.14 \\\\ \n  BYM2 (PC2) & 1.34 & 833 & 1.14 \\\\ \n  BYM2 (PC3) & 1.34 & 833 & 1.14 \\\\ \n  BYM2 (Unif) & 1.34 & 833 & 1.14 \\\\ \n\n    \\bottomrule\n\\end{tabular}\n\\end{table}\n\n\\clearpage\n\n\\section{INLA R-code to implement the BYM2 model} \\label{app:rcode}\n\nIn the following, we illustrate how the BYM2 model can be implemented\nwithin the R-package {\\tt INLA}. \n\n\\small\n\\begin{lstlisting}\n# load the R-package\nlibrary(INLA)\n\n# provide the path to the file storing the neighbourhood structure\ng = \"sardinia.graph\"\n# read the data\nsardinia = read.table(\"sardinia.dat\", col.names=c(\"y\", \"E\", \"SMR\"))\n\n# show the first lines\nhead(sardinia)\n#   y          E       SMR\n#1  1  0.5986411 1.6704500\n#2  0  0.6055964 0.0000000\n#3 10 13.3658700 0.7481743\n#4  0  0.2346664 0.0000000\n\n# get the number of regions\nn = nrow(sardinia)\n# define a region index with values 1, 2, ..., n\nsardinia$region = 1:n\n\n# specify the latent structure using a formula object\nformula = y ~ 1 + f(region,\n                    model = \"bym2\",\n                    graph=g,\n                    scale.model = TRUE,\n                    constr = TRUE,\n                    hyper=list(\n                      phi = list(\n                        prior = \"pc\",\n                        param = c(0.5, 2/3),\n                        initial = -3),\n                      prec = list(\n                        prior = \"pc.prec\",\n                        param = c(0.2/0.31, 0.01),\n                        initial = 5)))\n\n# call the inla function\nresult = inla(formula, data = sardinia, family = \"poisson\", E=E,\n         control.predictor = list(compute=TRUE))\n# get improved estimates for the hyperparameters\nresult = inla.hyperpar(r, dz = 0.2, diff.logdens=20)\n\\end{lstlisting}\n\n\nFirst we have to load the INLA package which can be installed by\ntyping \n\\begin{lstlisting}\ninstall.packages(\"INLA\", repos=\"http://www.math.ntnu.no/inla/R/testing\")\n\\end{lstlisting}\nin the R-terminal. In this paper we used the INLA version\n0.0-1445883880. In order to define the model incorporating a spatially\nstructured component we need to provide the neighbourhood structure\nfor the regions we analyse. In INLA this is done by providing the\npath to the file which stores this information. The graph file for\nSardinia is named {\\tt sardinia.graph} and has the following structure:\n\\begin{verbatim}\n366\n0 5 13 61 69 73 81\n1 5 8 16 40 46 94\n2 4 47 59 63 77\n3 3 11 17 43\n4 5 24 41 51 56 67\n...\n363 5 292 307 324 344 346\n364 5 291 310 317 329 345\n365 3 289 303 308\n\\end{verbatim}\n\nThe first line provides the number of regions, here $366$. The following\n$366$ lines, corresponds to each of the regions, where the first entry always\nspecifies a unique region index. The second entry specifies the\nnumber of neighbouring regions, and then the corresponding region\nindices for those neighbours are listed. INLA transforms this\ninformation into the neighbourhood matrix $\\mathbf{Q}$ with entries as \nspecified in \\eqref{eq:besagQ}. \n\nLines 23--36 specify\nthe model structure in terms of a formula object. Here, we have an\nintercept and a latent Gaussian model given by  \\eqref{eq:bym2}. The\n{\\tt f(.)} function is used to specify a random effect in {\\tt\n  INLA}. The first argument is always the variable name to which it applies,\nhere region. We specify the use of the BYM2 model in line 24. Then, we\nprovide the graph and specify that we want to scale the model in line\n26. This will scale the graph as described in Section\n\\ref{sec:scaling}. To avoid confounding with the intercept a\nsum-to-zero constraint is specified in line 27. The next lines specify\nthe hyperprior for the two hyperparameters in form of a list of length\ntwo. The first list entry specifies the prior for the mixing parameter\n$\\phi$, named {\\tt phi} in the INLA implementation, the second entry for the precision parameter \n$\\tau_b$, named {\\tt prec}. Each entry is itself a list. Using the\nargument {\\tt prior} we specify the prior we would like to use. The\nparameters are set in the argument {\\tt param}. They coincide with the\nvalues used in Section~\\ref{sec:sardinia}. Using the argument {\\tt\n  initial} a starting value for the numerical optimisation of the INLA\nalgorithm can be provided. This has to be given on the log scale for\nthe precision and the logit scale for $\\phi$, as these are the scales INLA\nworks on internally.\n\nAfter defining the model, we call the {\\tt inla} function providing the\n{\\tt formula}, the data and the likelihood. Further, we specify the\nexpected number of counts and specify that we not only would like to\nget posterior estimates for the components of $\\eta_i$ but also\n$\\eta_i$ and $\\theta_i$ (line 40). Improved hyperparameter estimates\ncan be obtained by calling {\\tt inla.hyperpar} afterwards. Here, {\\tt\n  dz} and {\\tt diff.logdens} refer to options in the numerical\nintegration algorithm, see help page. \n\nResults can be inspected using {\\tt summary(result)} or {\\tt\n  plot(result)}. Posterior marginals for the fixed effects and hyperparameters can be\nconsequently accessed via {\\tt result\\$summary.fixed} or {\\tt\n  result\\$summary.hyperpar}, respectively.\n\n\\section{PC prior derivation}\\label{app:pc}\n\n\\subsection{Precision parameter $\\tau_b$}\\label{app:pc-prec}\nIn deriving the PC prior for $\\tau_b$, we start by assuming a large fixed precision $\\tau_0$\nfor the base model, where $\\tau_0 \\gg \\tau_b$. \n\n\n\n The resulting $n-1$-dimensional stochastic part of the Kullback-Leibler divergence is\n\n", "index": 35, "text": "\\begin{gather}\n\\text{KLD}(\\tau_b) = \\frac{n-1}{2}\\frac{\\tau_0}{\\tau_b}\n\\left\n(1+\\frac{\\tau_b}{\\tau_0} \\log \\left[\\frac{\\tau_b}{\\tau_0}\\right] -\n\\frac{\\tau_b}{\\tau_0}\\right)\n\\rightarrow \\frac{n-1}{2}\\frac{\\tau_0}{\\tau_b}, \n\\end{gather}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\text{KLD}(\\tau_{b})=\\frac{n-1}{2}\\frac{\\tau_{0}}{\\tau_{b}}\\left(%&#10;1+\\frac{\\tau_{b}}{\\tau_{0}}\\log\\left[\\frac{\\tau_{b}}{\\tau_{0}}\\right]-\\frac{%&#10;\\tau_{b}}{\\tau_{0}}\\right)\\rightarrow\\frac{n-1}{2}\\frac{\\tau_{0}}{\\tau_{b}},\" display=\"block\"><mrow><mrow><mrow><mtext>KLD</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c4</mi><mi>b</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow><mn>2</mn></mfrac><mo>\u2062</mo><mfrac><msub><mi>\u03c4</mi><mn>0</mn></msub><msub><mi>\u03c4</mi><mi>b</mi></msub></mfrac><mo>\u2062</mo><mrow><mo>(</mo><mrow><mrow><mn>1</mn><mo>+</mo><mrow><mfrac><msub><mi>\u03c4</mi><mi>b</mi></msub><msub><mi>\u03c4</mi><mn>0</mn></msub></mfrac><mo>\u2062</mo><mrow><mi>log</mi><mo>\u2061</mo><mrow><mo>[</mo><mfrac><msub><mi>\u03c4</mi><mi>b</mi></msub><msub><mi>\u03c4</mi><mn>0</mn></msub></mfrac><mo>]</mo></mrow></mrow></mrow></mrow><mo>-</mo><mfrac><msub><mi>\u03c4</mi><mi>b</mi></msub><msub><mi>\u03c4</mi><mn>0</mn></msub></mfrac></mrow><mo>)</mo></mrow></mrow><mo>\u2192</mo><mrow><mfrac><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow><mn>2</mn></mfrac><mo>\u2062</mo><mfrac><msub><mi>\u03c4</mi><mn>0</mn></msub><msub><mi>\u03c4</mi><mi>b</mi></msub></mfrac></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01180.tex", "nexttext": "\nFormulating this expression out and setting $\\theta = \\lambda\\sqrt{(n-1)\\tau_0}$,  where $\\lambda$ is\nchosen so that $\\theta$ is kept constant in the limit $\\tau_0\n\\rightarrow \\infty$, we obtain a \ntype-2 Gumbel distribution\\citep{simpson-etal-2015}\n\n", "itemtype": "equation", "pos": 68103, "prevtext": "\nwhich implies\n$d(\\tau_b) \\rightarrow \\sqrt{(n-1)\\tau_0/\\tau_b}$. \n\nThe next step is to assign a prior to the distance $d(\\tau_b)$ and transform this  by a change of variables. \nWe use the exponential prior with decay rate $\\lambda$, which\nsupports the constant-rate penalisation and apply the ordinary change of variable transformation\n\n", "index": 37, "text": "\\begin{gather*}\n  \\pi(\\tau_b) = \\lambda \\exp(-\\lambda d(\\tau_b)) \\left|\n    \\frac{\\partial d(\\tau_b)}{\\partial \\tau_b}\\right|. \n\\end{gather*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex10.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\pi(\\tau_{b})=\\lambda\\exp(-\\lambda d(\\tau_{b}))\\left|\\frac{%&#10;\\partial d(\\tau_{b})}{\\partial\\tau_{b}}\\right|.\" display=\"block\"><mrow><mrow><mrow><mi>\u03c0</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c4</mi><mi>b</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mi>\u03bb</mi><mo>\u2062</mo><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mrow><mi>\u03bb</mi><mo>\u2062</mo><mi>d</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c4</mi><mi>b</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2062</mo><mrow><mo>|</mo><mfrac><mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>d</mi></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c4</mi><mi>b</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><msub><mi>\u03c4</mi><mi>b</mi></msub></mrow></mfrac><mo>|</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01180.tex", "nexttext": "\nas prior for $\\tau_b$.\n\n\\subsection{Mixing parameter $\\phi$}\\label{app-mixing}\nTo derive the PC prior for $\\phi$, we assume that  $\\mathbf{Q}_\\star \\geq 0$\n\n\nand define the covariance matrices for the base and flexible models as\n$\\mathbf{\\Sigma}_{\\text{base}} =  \\mathbf{I}$ and\n$\\mathbf{\\Sigma}_{\\text{flex}}(\\phi) =  (1-\\phi) \\: \\mathbf{I} + \\phi\\mathbf{Q}_\\star^{-}$, respectively. The  resulting Kullback-Leibler divergence is\n\n", "itemtype": "equation", "pos": 68495, "prevtext": "\nFormulating this expression out and setting $\\theta = \\lambda\\sqrt{(n-1)\\tau_0}$,  where $\\lambda$ is\nchosen so that $\\theta$ is kept constant in the limit $\\tau_0\n\\rightarrow \\infty$, we obtain a \ntype-2 Gumbel distribution\\citep{simpson-etal-2015}\n\n", "index": 39, "text": "\\begin{gather*}\n  \\pi(\\tau_b) = \\frac{\\theta}{2} \\tau_b^{-3/2} \\exp\\left(-\\theta\n    \\tau_b^{-1/2}\\right).\n\\end{gather*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex11.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\pi(\\tau_{b})=\\frac{\\theta}{2}\\tau_{b}^{-3/2}\\exp\\left(-\\theta%&#10;\\tau_{b}^{-1/2}\\right).\" display=\"block\"><mrow><mrow><mrow><mi>\u03c0</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c4</mi><mi>b</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mi>\u03b8</mi><mn>2</mn></mfrac><mo>\u2062</mo><msubsup><mi>\u03c4</mi><mi>b</mi><mrow><mo>-</mo><mrow><mn>3</mn><mo>/</mo><mn>2</mn></mrow></mrow></msubsup><mo>\u2062</mo><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo>(</mo><mrow><mo>-</mo><mrow><mi>\u03b8</mi><mo>\u2062</mo><msubsup><mi>\u03c4</mi><mi>b</mi><mrow><mo>-</mo><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow></mrow></msubsup></mrow></mrow><mo>)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01180.tex", "nexttext": "\nThe computation of the trace is quick when $\\mathbf{Q}_\\star$ is\nsparse \\cite{erisman-tinney}. The determinant can be computed as $|(1-\\phi) \\mathbf{I} + \\phi\\mathbf{Q}_\\star^{-1} | =\n\\prod_{i=1}^n(1-\\phi + \\phi\\tilde{\\gamma}_i)$,\n where $\\{\\gamma_i\\}$ denote the eigenvalues of  $\\mathbf{Q}_\\star$, and $\\tilde{\\gamma}_i\n= 1/\\gamma_i$  \\cite{simpson-etal-2015}. As the given precision matrix\n$\\mathbf{Q}_\\star$ is singular with rank deficiency 1, one of the\neigenvalues is zero. This implies that  $\\tilde{\\gamma}_i\n= 1/\\gamma_i$ if $\\gamma_i > 0$,  or else $\\tilde{\\gamma}_i = 0$. We\ncan avoid calculating eigenvalues if the dimension is high, see\nAppendix A3 of Simpson et al. \\cite{simpson-etal-2015} for details.\n\\end{appendix}\n\n\n", "itemtype": "equation", "pos": 69047, "prevtext": "\nas prior for $\\tau_b$.\n\n\\subsection{Mixing parameter $\\phi$}\\label{app-mixing}\nTo derive the PC prior for $\\phi$, we assume that  $\\mathbf{Q}_\\star \\geq 0$\n\n\nand define the covariance matrices for the base and flexible models as\n$\\mathbf{\\Sigma}_{\\text{base}} =  \\mathbf{I}$ and\n$\\mathbf{\\Sigma}_{\\text{flex}}(\\phi) =  (1-\\phi) \\: \\mathbf{I} + \\phi\\mathbf{Q}_\\star^{-}$, respectively. The  resulting Kullback-Leibler divergence is\n\n", "index": 41, "text": "\\begin{align*}\n  \\text{KLD}(\\mathcal{N}(0,\\mathbf{\\Sigma}_{\\text{flex}}(\\phi)) \\mid\n  \\mathcal{N}(0, \\mathbf{\\Sigma}_{\\text{base}})) &=\n                                                   \\frac{1}{2}(\\text{trace}(\\mathbf{\\Sigma}_{\\text{flex}}(\\phi))\n  - n - \\log|\\mathbf{\\Sigma}_{\\text{flex}}(\\phi)|)\\\\\n&= n\\phi \\left(\\frac{1}{n}\\text{trace}( \\mathbf{Q}_\\star^{-1}) - \\log\n  |(1-\\phi) \\mathbf{I} + \\phi\\mathbf{Q}_\\star^{-1} |\\right).\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex12.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\text{KLD}(\\mathcal{N}(0,\\mathbf{\\Sigma}_{\\text{flex}}(\\phi))\\mid%&#10;\\mathcal{N}(0,\\mathbf{\\Sigma}_{\\text{base}}))\" display=\"inline\"><mrow><mtext>KLD</mtext><mrow><mo stretchy=\"false\">(</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca9</mi><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><msub><mi>\ud835\udeba</mi><mtext>flex</mtext></msub><mrow><mo stretchy=\"false\">(</mo><mi>\u03d5</mi><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2223</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca9</mi><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><msub><mi>\ud835\udeba</mi><mtext>base</mtext></msub><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex12.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\frac{1}{2}(\\text{trace}(\\mathbf{\\Sigma}_{\\text{flex}}(\\phi))-n-%&#10;\\log|\\mathbf{\\Sigma}_{\\text{flex}}(\\phi)|)\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mtext>trace</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udeba</mi><mtext>flex</mtext></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03d5</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mi>n</mi><mo>-</mo><mrow><mi>log</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">|</mo><mrow><msub><mi>\ud835\udeba</mi><mtext>flex</mtext></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03d5</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">|</mo></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex13.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=n\\phi\\left(\\frac{1}{n}\\text{trace}(\\mathbf{Q}_{\\star}^{-1})-\\log%&#10;|(1-\\phi)\\mathbf{I}+\\phi\\mathbf{Q}_{\\star}^{-1}|\\right).\" display=\"inline\"><mrow><mrow><mi/><mo>=</mo><mrow><mi>n</mi><mo>\u2062</mo><mi>\u03d5</mi><mo>\u2062</mo><mrow><mo>(</mo><mrow><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><mi>n</mi></mfrac></mstyle><mo>\u2062</mo><mtext>trace</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msubsup><mi>\ud835\udc10</mi><mo>\u22c6</mo><mrow><mo>-</mo><mn>1</mn></mrow></msubsup><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mi>log</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">|</mo><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>-</mo><mi>\u03d5</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>\ud835\udc08</mi></mrow><mo>+</mo><mrow><mi>\u03d5</mi><mo>\u2062</mo><msubsup><mi>\ud835\udc10</mi><mo>\u22c6</mo><mrow><mo>-</mo><mn>1</mn></mrow></msubsup></mrow></mrow><mo stretchy=\"false\">|</mo></mrow></mrow></mrow><mo>)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}]