[{"file": "1601.05799.tex", "nexttext": "\nwhere the free energy is $F(\\rho)= {\\mathop{\\mathsf{tr}}\\nolimits} H\\rho-T S(\\rho)$, the entropy is $S(\\rho)=-\\sum_sP(s)\\log P(s)$, with $P(s)$ the probability that the system\nhas energy level ${|{s}\\rangle}$, $H$ is the Hamiltonian of the system, and $ \\langle w \\rangle$ is the average work done by the system when it transitions from $\\rho$ to $\\rho'$. The free energy\nis a scalar, and can be thought of as an average quantity. Here, we will see that by thinking of the free energy as an operator or random variable, one can derive a much stronger classical version of the second law which is an equality\n\n", "itemtype": "equation", "pos": 2586, "prevtext": "\n\n\\title{The second law of quantum thermodynamics as an equality}\n\n\\author{\\'{A}lvaro M. Alhambra}\n\n\\affiliation{Department of Physics and Astronomy, University College London, Gower Street, London WC1E 6BT, United Kingdom}\n\\author{Lluis Masanes}\n\\affiliation{Department of Physics and Astronomy, University College London, Gower Street, London WC1E 6BT, United Kingdom}\n\\author{Jonathan Oppenheim}\n\n\\affiliation{Department of Physics and Astronomy, University College London, Gower Street, London WC1E 6BT, United Kingdom}\n\n\\author{Christopher Perry}\n\n\\affiliation{Department of Physics and Astronomy, University College London, Gower Street, London WC1E 6BT, United Kingdom}\n\\affiliation{Department of Mathematical Sciences, University of Copenhagen, Universitetsparken 5, 2100 Copenhagen, Denmark}\n\n\n\\begin{abstract}\nWe investigate the connection between resent results in quantum thermodynamics and fluctuation relations. We adopt a fully quantum mechanical and information theoretic description of thermodynamics and\ninclude a work system whose energy is allowed to fluctuate. We derive a generalisation of Gibbs-stochasticity, a condition found in the approach to thermodynamics inspired by quantum information theory. \nWe show that this generalisation gives a necessary and sufficient condition for a thermodynamical transition to happen in the case of fluctuation work. The condition serves as a parent equation which\ncan be used to derive a number of results. These include writing the second law of thermodynamics as an equality featuring a fine-grained notion of the free energy.\nWe also obtain a generalisation of the Jarzynski fluctuation theorem which holds for arbitrary initial states. \nWe further show that each of these three relations can be seen as\nthe quasi-classical limit of three fully quantum identities. This allows us to consider the free energy as an operator, and \nallows one to obtain more general and fully quantum fluctuation relations from the information theoretic approach to quantum thermodynamics.\n\\end{abstract}\n\\maketitle\n\n\\section{Introduction}\nThe second law of thermodynamics governs what state transformations are possible regardless of the details of the interactions. As such, it is arguably the law of physics with the broadest applicability, relevant for\nsituations as varied as subatomic collisions, star formation, biological processes, steam engines, molecular motors and cosmology.  For a system which could be placed in contact with a thermal reservoir at temperature $T$, the second law can be expressed as\nan inequality of the form\n\n", "index": 1, "text": "\\begin{equation}\n  \\langle w \\rangle  \\le F(\\rho)-F(\\rho')\n  \\nonumber\n \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"\\langle w\\rangle\\leq F(\\rho)-F(\\rho^{\\prime})\" display=\"block\"><mrow><mrow><mo stretchy=\"false\">\u27e8</mo><mi>w</mi><mo stretchy=\"false\">\u27e9</mo></mrow><mo>\u2264</mo><mrow><mrow><mi>F</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c1</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mi>F</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\u03c1</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nin terms of a fine-grained free energy\n\n", "itemtype": "equation", "pos": 3281, "prevtext": "\nwhere the free energy is $F(\\rho)= {\\mathop{\\mathsf{tr}}\\nolimits} H\\rho-T S(\\rho)$, the entropy is $S(\\rho)=-\\sum_sP(s)\\log P(s)$, with $P(s)$ the probability that the system\nhas energy level ${|{s}\\rangle}$, $H$ is the Hamiltonian of the system, and $ \\langle w \\rangle$ is the average work done by the system when it transitions from $\\rho$ to $\\rho'$. The free energy\nis a scalar, and can be thought of as an average quantity. Here, we will see that by thinking of the free energy as an operator or random variable, one can derive a much stronger classical version of the second law which is an equality\n\n", "index": 3, "text": "\\begin{align}\n  \\left\\langle {\\mathrm{e}}^{\\beta \\left(f_{s'} -f_s +w \\right)} \\right\\rangle = 1\n\\nonumber\n\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\left\\langle{\\mathrm{e}}^{\\beta\\left(f_{s^{\\prime}}-f_{s}+w\\right%&#10;)}\\right\\rangle=1\\par&#10;\" display=\"inline\"><mrow><mrow><mo>\u27e8</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mi>\u03b2</mi><mo>\u2062</mo><mrow><mo>(</mo><mrow><mrow><msub><mi>f</mi><msup><mi>s</mi><mo>\u2032</mo></msup></msub><mo>-</mo><msub><mi>f</mi><mi>s</mi></msub></mrow><mo>+</mo><mi>w</mi></mrow><mo>)</mo></mrow></mrow></msup><mo>\u27e9</mo></mrow><mo>=</mo><mn>1</mn></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nthat can be considered as a random variable occurring with probability $P(s)$ and whose average value is the ordinary scalar free energy $F= \\langle f_s \\rangle$. Here, initial energy levels are given by  $E_s={\\mathop{\\mathsf{tr}}\\nolimits} {|{s}\\rangle\\langle{s}|} H$, \n\nwhile the energy levels $E_{s'}$ correspond to the final Hamiltonian $H'$.\nAlthough the term $-T \\log P(s)$ is not defined for $P(s)=0$, all its moments are. As we will discuss, if we Taylor expand the exponential in the above equality version of the second law, we obtain not only the standard inequality version of the second law, but in addition, an infinite set of higher order inequalities. These can be thought of as corrections to the standard ineqality.\n\n\nThis equality version of the second law is valid for transitions between any two states as long as the initial state is diagonal in the energy eigenbasis, and when work is considered as the change in energy of some work system or {\\it weight}. As such, although it is a greatly strengthened form of the second law, it is of a more classical nature, reminiscent of the fluctuation theorems of Jarzynski~\\cite{jarzynski1997nonequilibrium} and Crooks~\\cite{crooks1999entropy} where it is required that a measurement is performed on the initial and final state.  We are however, not only able to get a more general classical version of the Jarzynski fluctuation theorem, valid for any initial state, but we are also able to derive two fully quantum identities which reduce in the classical limit to these classical generalisations of the Jarzynski equation and the second law.\n\nWhat's more, even our classical fluctuation theorems are derived from a fully quantum mechanical point of view, and are thus valid for any quantum process. Previous derivations, assumed a particular form of Markovian classical trajectories\n(e.g. assuming a Langevin equation or in the context of classical stochastic thermodynamics) \\cite{crooks1999entropy,seifert2012stochastic,seifert2005entropy,chernyak2006path,hatano2001steady}. \n A quantum mechanical derivation of the standard\nJarzinski equation has been done in numerous works \\cite{tasaki2000jarzynski,campisi2009fluctuation,talkner2009fluctuation,campisi2011colloquium,albash2013fluctuation,rastegin2014jarzynski},\nbut in these one is usually limited to initial thermal states, and also must resort to energy measurements on the system in order to define work.\nA deriviation of fluctuation theorems for arbitrary initial and final states was undertaken in \\cite{manzano2015nonequilibrium}, for a family of maps which \ngo slightly beyond the classical case.\n\nHere, we adopt a fully general and quantum mechanical treatment and derive a fully quantum identity, which reduces to the generalised fluctuation relation\n\n", "itemtype": "equation", "pos": 3440, "prevtext": "\nin terms of a fine-grained free energy\n\n", "index": 5, "text": "\\begin{align}\nf_s=E_s+T \\log P(s)\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle f_{s}=E_{s}+T\\log P(s)\" display=\"inline\"><mrow><msub><mi>f</mi><mi>s</mi></msub><mo>=</mo><mrow><msub><mi>E</mi><mi>s</mi></msub><mo>+</mo><mrow><mi>T</mi><mo>\u2062</mo><mrow><mi>log</mi><mo>\u2061</mo><mi>P</mi></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nwhen the initial state is diagonal in the energy eigenbasis. We call such states, i.e. those that satisfy $[\\rho_S,H_S]=0$, {\\it quasi-classical states}, \nand the above fluctuation relation \n\nis valid for arbitrary initial and final states of this form and for any quantum thermodynamical process.\nWhen the initial state is thermal, we further have ${\\mathrm{e}}^{-\\beta f_s}  = Z$ for all $s$ which gives Jarzynski's equation in its usual form\n\n", "itemtype": "equation", "pos": 6270, "prevtext": "\nthat can be considered as a random variable occurring with probability $P(s)$ and whose average value is the ordinary scalar free energy $F= \\langle f_s \\rangle$. Here, initial energy levels are given by  $E_s={\\mathop{\\mathsf{tr}}\\nolimits} {|{s}\\rangle\\langle{s}|} H$, \n\nwhile the energy levels $E_{s'}$ correspond to the final Hamiltonian $H'$.\nAlthough the term $-T \\log P(s)$ is not defined for $P(s)=0$, all its moments are. As we will discuss, if we Taylor expand the exponential in the above equality version of the second law, we obtain not only the standard inequality version of the second law, but in addition, an infinite set of higher order inequalities. These can be thought of as corrections to the standard ineqality.\n\n\nThis equality version of the second law is valid for transitions between any two states as long as the initial state is diagonal in the energy eigenbasis, and when work is considered as the change in energy of some work system or {\\it weight}. As such, although it is a greatly strengthened form of the second law, it is of a more classical nature, reminiscent of the fluctuation theorems of Jarzynski~\\cite{jarzynski1997nonequilibrium} and Crooks~\\cite{crooks1999entropy} where it is required that a measurement is performed on the initial and final state.  We are however, not only able to get a more general classical version of the Jarzynski fluctuation theorem, valid for any initial state, but we are also able to derive two fully quantum identities which reduce in the classical limit to these classical generalisations of the Jarzynski equation and the second law.\n\nWhat's more, even our classical fluctuation theorems are derived from a fully quantum mechanical point of view, and are thus valid for any quantum process. Previous derivations, assumed a particular form of Markovian classical trajectories\n(e.g. assuming a Langevin equation or in the context of classical stochastic thermodynamics) \\cite{crooks1999entropy,seifert2012stochastic,seifert2005entropy,chernyak2006path,hatano2001steady}. \n A quantum mechanical derivation of the standard\nJarzinski equation has been done in numerous works \\cite{tasaki2000jarzynski,campisi2009fluctuation,talkner2009fluctuation,campisi2011colloquium,albash2013fluctuation,rastegin2014jarzynski},\nbut in these one is usually limited to initial thermal states, and also must resort to energy measurements on the system in order to define work.\nA deriviation of fluctuation theorems for arbitrary initial and final states was undertaken in \\cite{manzano2015nonequilibrium}, for a family of maps which \ngo slightly beyond the classical case.\n\nHere, we adopt a fully general and quantum mechanical treatment and derive a fully quantum identity, which reduces to the generalised fluctuation relation\n\n", "index": 7, "text": "\\begin{equation}\n  \\left\\langle \n  {\\mathrm{e}}^{\\beta( w -f_s)} \\right\\rangle\n  = Z' \n  \\ .\n\\nonumber\n\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"\\left\\langle{\\mathrm{e}}^{\\beta(w-f_{s})}\\right\\rangle=Z^{\\prime}\\ .\\par&#10;\" display=\"block\"><mrow><mrow><mrow><mo>\u27e8</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mi>\u03b2</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>w</mi><mo>-</mo><msub><mi>f</mi><mi>s</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msup><mo>\u27e9</mo></mrow><mo>=</mo><mpadded width=\"+5pt\"><msup><mi>Z</mi><mo>\u2032</mo></msup></mpadded></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\n\nOur two quantum identities, which reduce to the equality version of the second law and the generalisation of the Jarzynski equation valid for arbitrary initial quasi-classical states, \ncan be considered as two independent children of a third, more powerful\nquantum identity \n\n", "itemtype": "equation", "pos": 6834, "prevtext": "\nwhen the initial state is diagonal in the energy eigenbasis. We call such states, i.e. those that satisfy $[\\rho_S,H_S]=0$, {\\it quasi-classical states}, \nand the above fluctuation relation \n\nis valid for arbitrary initial and final states of this form and for any quantum thermodynamical process.\nWhen the initial state is thermal, we further have ${\\mathrm{e}}^{-\\beta f_s}  = Z$ for all $s$ which gives Jarzynski's equation in its usual form\n\n", "index": 9, "text": "\\begin{equation}\n  \\left\\langle \n  {\\mathrm{e}}^{\\beta w} \\right\\rangle\n  = \\frac {Z'} Z\n  \\ .\n\\nonumber\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m1\" class=\"ltx_Math\" alttext=\"\\left\\langle{\\mathrm{e}}^{\\beta w}\\right\\rangle=\\frac{Z^{\\prime}}{Z}\\ .\" display=\"block\"><mrow><mrow><mrow><mo>\u27e8</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mi>\u03b2</mi><mo>\u2062</mo><mi>w</mi></mrow></msup><mo>\u27e9</mo></mrow><mo>=</mo><mpadded width=\"+5pt\"><mfrac><msup><mi>Z</mi><mo>\u2032</mo></msup><mi>Z</mi></mfrac></mpadded></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nwhere $\\rho_W$ is the initial state of the weight system, ${\\mathbb{1}}_{S}$ is the identity on the system $S$ of interest, $\\Gamma_{SW}$  is the completely positive trace preserving map\nacting on the joint state\nof system and weight which gives its evolution, and we define, as in \\cite{aberg2016fully} (but with opposite sign convention),\n$\n  \\mathcal J_{H} (\\rho) = \n  e^{\\frac \\beta 2 H}  \n  \\rho\\,\n  e^{\\frac \\beta 2 H}  \n$.\nThis parent identity can easily be used to derive\na fully quantum, general Jarzynski Equation for arbitrary states\n\n(Result~\\ref{re:qje} in Section \\ref{sec:quantumidentities}).\n\n\n\n\n\n\n\n\n\n\nWhen the input is quasi-classical, it reduces to our generalised Jarzynski Equation for arbitrary initial quasi-classical states.\n\nLikewise, the parent identity gives a fully quantum version of the second law equality, Result~\\ref{re:qsl} in Section \\ref{sec:quantumidentities},\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nwhich reduces to the equality version of the second law\n\nwhen the initial state is quasi-classical.\n\nNow it is natural to ask what the parent identity, Equation \\eqref{eq:gibbs-stoch-q}, reduces to for quasi-classical states. We will show that it gives the necessary and sufficient condition for thermal processes \n\n", "itemtype": "equation", "pos": 7230, "prevtext": "\n\nOur two quantum identities, which reduce to the equality version of the second law and the generalisation of the Jarzynski equation valid for arbitrary initial quasi-classical states, \ncan be considered as two independent children of a third, more powerful\nquantum identity \n\n", "index": 11, "text": "\\begin{equation}\n  \\label{eq:gibbs-stoch-q}\n  {\\rm tr}_{W}\\! \\left[\n  \\left(\\mathcal J_{H'_S +H_W} {} \n  \\Gamma_{SW} {} \\mathcal J^{-1}_{H_S +H_W}\n  \\right) ({\\mathbb{1}}_S \\otimes \\rho_{W})\n  \\right]\n  = {\\mathbb{1}}_{S}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"{\\rm tr}_{W}\\!\\left[\\left(\\mathcal{J}_{H^{\\prime}_{S}+H_{W}}{}\\Gamma_{SW}{}%&#10;\\mathcal{J}^{-1}_{H_{S}+H_{W}}\\right)({\\mathbb{1}}_{S}\\otimes\\rho_{W})\\right]=%&#10;{\\mathbb{1}}_{S}\" display=\"block\"><mrow><mrow><mpadded width=\"-1.7pt\"><msub><mi>tr</mi><mi>W</mi></msub></mpadded><mo>\u2062</mo><mrow><mo>[</mo><mrow><mrow><mo>(</mo><mrow><msub><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca5</mi><mrow><msubsup><mi>H</mi><mi>S</mi><mo>\u2032</mo></msubsup><mo>+</mo><msub><mi>H</mi><mi>W</mi></msub></mrow></msub><mo>\u2062</mo><msub><mi mathvariant=\"normal\">\u0393</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>W</mi></mrow></msub><mo>\u2062</mo><msubsup><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca5</mi><mrow><msub><mi>H</mi><mi>S</mi></msub><mo>+</mo><msub><mi>H</mi><mi>W</mi></msub></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msubsup></mrow><mo>)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mn>\ud835\udfd9</mn><mi>S</mi></msub><mo>\u2297</mo><msub><mi>\u03c1</mi><mi>W</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>]</mo></mrow></mrow><mo>=</mo><msub><mn>\ud835\udfd9</mn><mi>S</mi></msub></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nfor all $s'$, where  $P(s',w|s)$ is the conditional probability of the final state having energy levels $E_{s'}$, and work $w$ being done by the system, given that the initial state had energy level $E_s$. \nThis turns out to be the generalisation of an important equation from the {\\it resource theoretic} approach to quantum \nthermodynamics which finds its origin in ideas \nfrom quantum information theory \\cite{janzing2000thermodynamic,uniqueinfo,dahlsten2011inadequacy,del2011thermodynamic,brandao2011resource,horodecki2013fundamental,aaberg2013truly,brandao2013second,faist2015minimal,skrzypczyk2014work,egloff2015measure, aberg2014catalytic,lostaglio2015description,cwiklinski2015limitations,lostaglio2014quantum, korzekwa2015extraction,halpern2014beyond,woods2015maximum,ng2015limits,halpern2015introducing,wilming2014weak, lostaglio2015stochastic, narasimhachar2015low,YungerHalpern15,gallego2015defining,perry2015sufficient,TeamBanff,goold2015role,Vinjanampathy2015arXiv_review}). \n\nAn overarching idea behind this approach is to precisely define what possible interactions are allowed between a system, a heat bath, and a work storage device, while systematically accounting for all possible resources used in the process. This leads to a definition of thermodynamics known as\nThermal Operations (TO) \\cite{Streater_dynamics,janzing2000thermodynamic, horodecki2013fundamental}. This, and its catalytic version~\\cite{brandao2013second}, represent the most an experimenter can possibly do when manipulating a system without access to a reservoir of coherence (although one can easily include a coherence reservoir as an ancilla as in \\cite{brandao2011resource,aberg2014catalytic, korzekwa2015extraction}). It is thus the appropriate class of operations  \nfor deriving limitations such as a second law. However, they can be realised by very coarse grained control of the system, and thus also represent achievable thermodynamical operations \\cite{perry2015sufficient}. They also include the allowed\nclass of operations considered in fluctuation theorems. Thermal Operations are thus broad enough to encompass commonly considered definitions of thermodynamics (see \\cite{brandao2011resource} for a discussion on this point).\n\nEquation \\eqref{eq:gibbs-stoch-qc} turns out to completely characterise thermodynamics in the case fluctuating work.\nIt is a generalisation of a characterisation of Thermal Operations\nin the case where there is no work storage system i.e. Equation \\eqref{eq:gibbs-stoch-qc} with $w=0$ is the Gibbs-stochastic condition derived in \\cite{janzing2000thermodynamic,Streater_dynamics}. We will show that Equation \\eqref{eq:gibbs-stoch-qc}\nprovides a necessary and sufficient condition for thermodynamical transitions between states which are diagonal in the energy eigenbasis, and as a result is a necessary and sufficient condition for work fluctuations.\nUsing a generalisation of a theorem of Hardy, Littlewood, and Polya \\cite{ruch1978mixing}, the condition of Gibbs-stochasticity was shown in \\cite{renes2014work}\nto be equivalent to the set of thermodynamical second laws which have recently been proven to be necessary and sufficient condition for quantum thermodynamical state transformations~\\cite{horodecki2013fundamental} (c.f. \\cite{ruch1978mixing}), \nthe so-called thermo-majorization criteria~\\cite{ruch1976principle,horodecki2013fundamental}. The latter are conditions on the initial probabilities $P(s)$ and final probabilities $P(s')$ under which one state can be transformed into another. \n\nPreviously, in the resource theory approach, the work storage system had to be taken to be part of the system of interest~\\cite{horodecki2013fundamental}.\nUsing this technique, one can compute the amount of deterministic\nor minimal work required to make a state transformation~\\cite{horodecki2013fundamental} using thermo-majorization. One can also consider\n\\emph{fluctuating} or \\emph{probabilistic} work from the resource theoretic perspective, but thus far, only average work\nhas been computed \\cite{brandao2011resource,skrzypczyk2014work}.\nUnresolved, thus far, has been the question of how the information theoretic paradigm fits in with the fluctuation theorem approach. Some further insights have been obtained in attempting to link\nthe information theoretic approach with the fluctuation theorem approach~\\cite{salek2015fluctuations,halpern2015introducing}, however, how the two paradigms fit together has been an open question.\n\nHere, we see that one can incorporate fluctuating work explicitly in the resource theoretic approach through Equations \\eqref{eq:gibbs-stoch-q} and \\eqref{eq:gibbs-stoch-qc}. These serve to bring the field of fluctuation theorems fully\ninto the domain of the information and resource theoretic approach. This is possible because the class of operations which are allowed in the\nfluctuation theorem paradigm lies within Thermal Operations.  The latter approach is also able to incorporate not only fluctuations of work, but also of states~\\cite{alhambra2015probability,renes2015relative}, \nand we here aim to extend its use to further physically motivated situations.\n\nFinally, it is interesting to compare the power of the relations presented here, with the Jarzynski and Crooks' relations. We do this for one of the simplest\nexamples, the process of Landauer erasure~\\cite{Landauer}, where a bit in an unknown state is erased to the $0$ state. Since the initial state is thermal, one can apply the Jarzynski equality in its standard form.\nHowever, even in this simple case, we find that the new equalities proven here give more information than the\nstandard Jarzynski and Crooks, in part because one has an independent equality for each possible final energy state.\n\nOne finds a number of additional insights. Namely, (i) that one needs very large work fluctuations that are exponentially large in the probability that the erasure fails -- the more perfect we demand our erasure to be, the larger the work fluctuations; (ii) it is impossible to even probabilistically extract work in an erasure process; and (iii) that the optimal average work cost of $kT\\log{2}$ is only achieved when the work fluctuations go to zero. While these are known for the case when protocols are restricted to thermodynamically reversible ones, we know of no proof that they hold for more general protocols. This simple application is discussed in the Conclusion.\n\n\n\n\nThe remainder of the paper is structured as follows: in Section \\ref{sec:generalized} we define what we consider to be thermodynamics -- namely the set of Thermal Operations in the presence of fluctuating work. This involves three simple conditions on the type of operations which can be performed and we \nfind some general constraints they need to obey.\nIn Section \\ref{sec:quantumidentities} we introduce the three fully quantum thermodynamic identities and prove them. In Section \\ref{sec:classical}\nwe show that in the case of states which are diagonal in their energy eigenbasis, these quantum identities each reduce to the\nequality version of the second law, a generalisation of the Jarzynski equation, and the generalisation of the\nGibbs-stochastic condition to the case of fluctuating work.\nIn Section \\ref{sec:cq-identities} we show that in the case of the initial state being diagonal in the energy basis and the final state being arbitrary,\nthe quantum identities reduce to constraints on the expectation values of certain operators with a clear physical interpretation.\n\n\\noindent\n{\\bf Note added:} While this research was nearing completion, \\cite{aberg2016fully} appeared on the arXiv. There, a fully quantum Crooks-type identity was derived. This gives a constraint on the quantum state of the \nweight depending on both the\nevolution and the time-reversed evolution. As our constraints are on both the system and weight, the two results appear to complement each other without overlap. In version 2 of this paper, we relate the two results by proving\na quantum analog of the Crooks relation, of similar form to that in  \\cite{aberg2016fully} but applying not just to the weight, but to the system and weight. This is done in Section \\ref{sec:crooks}.\n\n\n\\section{Thermal operations with fluctuating work}\\label{sec:generalized}\n\n\nFirst, let us characterise the type of process/operation that we consider, and show that they are suitably general and implementable to encompass what is commonly considered to be thermodynamics. Our setting consists of a system with Hamiltonian $H_S$, a bath with Hamiltonian $H_B$ initially in the thermal state $\\rho_B = \\frac 1 {Z_B} {\\mathrm{e}}^{-\\beta H_B}$, and an ideal weight with Hamiltonian $H_W=  \\int_\\mathbb{R} dx\\, x {|{x}\\rangle}\\! {\\langle{x}|}$, where the orthonormal basis $\\{|x\\rangle, \\forall\\, x\\in \\mathbb R\\}$ represents the position of the weight. The operations we consider will allow for the Hamiltonian to change\nas we shall see in Subsection \\ref{ss:toH}.\nAny joint transformation of system, bath and weight is represented by a Completely Positive Trace Preserving (CPTP) map $\\Gamma_{SBW}$. \n\nWe only consider maps $\\Gamma_{SBW}$ satisfying the following conditions:\n\\begin{description}\n  \\item[Unitary on all systems]\n  It has an (CPTP) inverse $\\Gamma_{SBW}^{-1}$, which implies unitarity $\\Gamma_{SBW} (\\rho_{SBW}) = U\\rho_{SBW} U^\\dagger$.\n  \n  \\item[Energy conservation] \n  The unitary commutes with the total Hamiltonian: $[U,H_S +H_B +H_W] =0$.\n\n  \\item[Independence of the ``position\" of the weight] The unitary commutes with the translations on the weight: $[U, \\Delta_W]=0$.\n  \n\\end{description}\nThe generator of the translations in the weight $\\Delta_W$ is canonically conjugated to the position of the weight $H_W$, that is $[\\Delta_W, H_W] = i$.\n\nThis last condition implies that the reduced map on system and bath $\\Gamma_{SB}$ is a mixture of unitaries (Result~1 in~\\cite{masanes2014derivation}). Hence the transformation can never decrease the entropy of system and bath, which \nguarantees that the weight is not used as a source of non-equilibrium. \n\nIt is important to mention that these constraints allow for processes that exploit the coherence of the weight, as in~\\cite{skrzypczyk2014work, masanes2014derivation}.\n\nBoth unitarity and energy conservation are fundamental laws of nature, so imposing them is a necessary assumption. Any process which\nappears to violate energy conservation in the above sense is in fact energy conserving, one is merely tracing out or ignoring a system which is taking or giving up energy.\nConversely, an operation which appears to violate energy conservation can be made energy conserving by considering its action on the weight or any other ancilla. \nFor example, turning on an interaction Hamiltonian between system, bath and weight can be done via a coherent ancilla as demonstrated in \\cite{brandao2011resource}.  One can generate other couplings between the three systems via\nthe unitary $U$.\nImposing energy conservation on the systems considered, thus ensures that all sources of energy are properly accounted for. We require that the total process is unitary on the systems, weight and bath, as is the case in nature, although\nthe operation on system and weight alone will usually not be.\n\n\nThe last condition implies that the reduced map on system and bath $\\Gamma_{SB}$ is a mixture of unitaries (Result~1 in~\\cite{masanes2014derivation}). Hence the transformation can never decrease the entropy of system and bath, which \nguarantees that the weight is not used as a source of non-equilibrium which would be a form of cheating. \nIndependence of the position of the weight can be thought of as a definition of work~\\cite{skrzypczyk2014work} and is used in both the information theoretic and fluctuation theorem approaches. In the latter case, the assumption is implicit, since the amount of work is taken to be the difference in energy between the initial and final system/bath. In other words, work\nis taken to be a change in energy of either the work system (explicit), or change in energy of the system-bath (implicitly). Conservation of energy ensures that the implicit and explicit paradigms are equivalent. \nWork then is the change in energy of the work system, and does not depend on how much energy is currently stored there, hence the unitary must commute with its translations.\n\nFinally, we note that we could allow the use of an ancilla which must be returned in its original state, so called {\\it Catalytic Thermal Operations} \\cite{brandao2013second}, however, we do not consider this here\nas we show that in the case of fluctuating work, it is no more powerful than ordinary Thermal Operations with respect to the quantities we are interested in.\n\n\n\\subsection{Thermal operations with non-constant Hamiltonian}\n\\label{ss:toH}\n\n\nThermal operations are general enough to include the case where the initial Hamiltonian of the system $H_S$ is different than the final one $H'_S$. This is done by including an additional qubit $X$ which plays the role of a switch (as in~\\cite{horodecki2013fundamental}).\nNow the total Hamiltonian is\n\n", "itemtype": "equation", "pos": 8696, "prevtext": "\nwhere $\\rho_W$ is the initial state of the weight system, ${\\mathbb{1}}_{S}$ is the identity on the system $S$ of interest, $\\Gamma_{SW}$  is the completely positive trace preserving map\nacting on the joint state\nof system and weight which gives its evolution, and we define, as in \\cite{aberg2016fully} (but with opposite sign convention),\n$\n  \\mathcal J_{H} (\\rho) = \n  e^{\\frac \\beta 2 H}  \n  \\rho\\,\n  e^{\\frac \\beta 2 H}  \n$.\nThis parent identity can easily be used to derive\na fully quantum, general Jarzynski Equation for arbitrary states\n\n(Result~\\ref{re:qje} in Section \\ref{sec:quantumidentities}).\n\n\n\n\n\n\n\n\n\n\nWhen the input is quasi-classical, it reduces to our generalised Jarzynski Equation for arbitrary initial quasi-classical states.\n\nLikewise, the parent identity gives a fully quantum version of the second law equality, Result~\\ref{re:qsl} in Section \\ref{sec:quantumidentities},\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nwhich reduces to the equality version of the second law\n\nwhen the initial state is quasi-classical.\n\nNow it is natural to ask what the parent identity, Equation \\eqref{eq:gibbs-stoch-q}, reduces to for quasi-classical states. We will show that it gives the necessary and sufficient condition for thermal processes \n\n", "index": 13, "text": "\\begin{equation}\n  \\label {eq:gibbs-stoch-qc}\n  \\sum_{s, w} P(s',w|s)\\, \n  {\\mathrm{e}}^{\\beta (E_{s'}-E_s +w)}\n  =  1\\ ,\n\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"\\sum_{s,w}P(s^{\\prime},w|s)\\,{\\mathrm{e}}^{\\beta(E_{s^{\\prime}}-E_{s}+w)}=1\\ ,\\par&#10;\" display=\"block\"><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>s</mi><mo>,</mo><mi>w</mi></mrow></munder><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>\u2032</mo></msup><mo>,</mo><mi>w</mi><mo stretchy=\"false\">|</mo><mi>s</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><msup><mi mathvariant=\"normal\">e</mi><mrow><mi>\u03b2</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><msub><mi>E</mi><msup><mi>s</mi><mo>\u2032</mo></msup></msub><mo>-</mo><msub><mi>E</mi><mi>s</mi></msub></mrow><mo>+</mo><mi>w</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msup><mo>=</mo><mpadded width=\"+5pt\"><mn>1</mn></mpadded><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nand energy conservation reads \n$[V,H] =0$, where $V$ is the global unitary when we include the switch.\nWe impose that the initial state of switch is ${|{0}\\rangle}_X$ and the global unitary $V$ performs the switching\n\n", "itemtype": "equation", "pos": 21933, "prevtext": "\nfor all $s'$, where  $P(s',w|s)$ is the conditional probability of the final state having energy levels $E_{s'}$, and work $w$ being done by the system, given that the initial state had energy level $E_s$. \nThis turns out to be the generalisation of an important equation from the {\\it resource theoretic} approach to quantum \nthermodynamics which finds its origin in ideas \nfrom quantum information theory \\cite{janzing2000thermodynamic,uniqueinfo,dahlsten2011inadequacy,del2011thermodynamic,brandao2011resource,horodecki2013fundamental,aaberg2013truly,brandao2013second,faist2015minimal,skrzypczyk2014work,egloff2015measure, aberg2014catalytic,lostaglio2015description,cwiklinski2015limitations,lostaglio2014quantum, korzekwa2015extraction,halpern2014beyond,woods2015maximum,ng2015limits,halpern2015introducing,wilming2014weak, lostaglio2015stochastic, narasimhachar2015low,YungerHalpern15,gallego2015defining,perry2015sufficient,TeamBanff,goold2015role,Vinjanampathy2015arXiv_review}). \n\nAn overarching idea behind this approach is to precisely define what possible interactions are allowed between a system, a heat bath, and a work storage device, while systematically accounting for all possible resources used in the process. This leads to a definition of thermodynamics known as\nThermal Operations (TO) \\cite{Streater_dynamics,janzing2000thermodynamic, horodecki2013fundamental}. This, and its catalytic version~\\cite{brandao2013second}, represent the most an experimenter can possibly do when manipulating a system without access to a reservoir of coherence (although one can easily include a coherence reservoir as an ancilla as in \\cite{brandao2011resource,aberg2014catalytic, korzekwa2015extraction}). It is thus the appropriate class of operations  \nfor deriving limitations such as a second law. However, they can be realised by very coarse grained control of the system, and thus also represent achievable thermodynamical operations \\cite{perry2015sufficient}. They also include the allowed\nclass of operations considered in fluctuation theorems. Thermal Operations are thus broad enough to encompass commonly considered definitions of thermodynamics (see \\cite{brandao2011resource} for a discussion on this point).\n\nEquation \\eqref{eq:gibbs-stoch-qc} turns out to completely characterise thermodynamics in the case fluctuating work.\nIt is a generalisation of a characterisation of Thermal Operations\nin the case where there is no work storage system i.e. Equation \\eqref{eq:gibbs-stoch-qc} with $w=0$ is the Gibbs-stochastic condition derived in \\cite{janzing2000thermodynamic,Streater_dynamics}. We will show that Equation \\eqref{eq:gibbs-stoch-qc}\nprovides a necessary and sufficient condition for thermodynamical transitions between states which are diagonal in the energy eigenbasis, and as a result is a necessary and sufficient condition for work fluctuations.\nUsing a generalisation of a theorem of Hardy, Littlewood, and Polya \\cite{ruch1978mixing}, the condition of Gibbs-stochasticity was shown in \\cite{renes2014work}\nto be equivalent to the set of thermodynamical second laws which have recently been proven to be necessary and sufficient condition for quantum thermodynamical state transformations~\\cite{horodecki2013fundamental} (c.f. \\cite{ruch1978mixing}), \nthe so-called thermo-majorization criteria~\\cite{ruch1976principle,horodecki2013fundamental}. The latter are conditions on the initial probabilities $P(s)$ and final probabilities $P(s')$ under which one state can be transformed into another. \n\nPreviously, in the resource theory approach, the work storage system had to be taken to be part of the system of interest~\\cite{horodecki2013fundamental}.\nUsing this technique, one can compute the amount of deterministic\nor minimal work required to make a state transformation~\\cite{horodecki2013fundamental} using thermo-majorization. One can also consider\n\\emph{fluctuating} or \\emph{probabilistic} work from the resource theoretic perspective, but thus far, only average work\nhas been computed \\cite{brandao2011resource,skrzypczyk2014work}.\nUnresolved, thus far, has been the question of how the information theoretic paradigm fits in with the fluctuation theorem approach. Some further insights have been obtained in attempting to link\nthe information theoretic approach with the fluctuation theorem approach~\\cite{salek2015fluctuations,halpern2015introducing}, however, how the two paradigms fit together has been an open question.\n\nHere, we see that one can incorporate fluctuating work explicitly in the resource theoretic approach through Equations \\eqref{eq:gibbs-stoch-q} and \\eqref{eq:gibbs-stoch-qc}. These serve to bring the field of fluctuation theorems fully\ninto the domain of the information and resource theoretic approach. This is possible because the class of operations which are allowed in the\nfluctuation theorem paradigm lies within Thermal Operations.  The latter approach is also able to incorporate not only fluctuations of work, but also of states~\\cite{alhambra2015probability,renes2015relative}, \nand we here aim to extend its use to further physically motivated situations.\n\nFinally, it is interesting to compare the power of the relations presented here, with the Jarzynski and Crooks' relations. We do this for one of the simplest\nexamples, the process of Landauer erasure~\\cite{Landauer}, where a bit in an unknown state is erased to the $0$ state. Since the initial state is thermal, one can apply the Jarzynski equality in its standard form.\nHowever, even in this simple case, we find that the new equalities proven here give more information than the\nstandard Jarzynski and Crooks, in part because one has an independent equality for each possible final energy state.\n\nOne finds a number of additional insights. Namely, (i) that one needs very large work fluctuations that are exponentially large in the probability that the erasure fails -- the more perfect we demand our erasure to be, the larger the work fluctuations; (ii) it is impossible to even probabilistically extract work in an erasure process; and (iii) that the optimal average work cost of $kT\\log{2}$ is only achieved when the work fluctuations go to zero. While these are known for the case when protocols are restricted to thermodynamically reversible ones, we know of no proof that they hold for more general protocols. This simple application is discussed in the Conclusion.\n\n\n\n\nThe remainder of the paper is structured as follows: in Section \\ref{sec:generalized} we define what we consider to be thermodynamics -- namely the set of Thermal Operations in the presence of fluctuating work. This involves three simple conditions on the type of operations which can be performed and we \nfind some general constraints they need to obey.\nIn Section \\ref{sec:quantumidentities} we introduce the three fully quantum thermodynamic identities and prove them. In Section \\ref{sec:classical}\nwe show that in the case of states which are diagonal in their energy eigenbasis, these quantum identities each reduce to the\nequality version of the second law, a generalisation of the Jarzynski equation, and the generalisation of the\nGibbs-stochastic condition to the case of fluctuating work.\nIn Section \\ref{sec:cq-identities} we show that in the case of the initial state being diagonal in the energy basis and the final state being arbitrary,\nthe quantum identities reduce to constraints on the expectation values of certain operators with a clear physical interpretation.\n\n\\noindent\n{\\bf Note added:} While this research was nearing completion, \\cite{aberg2016fully} appeared on the arXiv. There, a fully quantum Crooks-type identity was derived. This gives a constraint on the quantum state of the \nweight depending on both the\nevolution and the time-reversed evolution. As our constraints are on both the system and weight, the two results appear to complement each other without overlap. In version 2 of this paper, we relate the two results by proving\na quantum analog of the Crooks relation, of similar form to that in  \\cite{aberg2016fully} but applying not just to the weight, but to the system and weight. This is done in Section \\ref{sec:crooks}.\n\n\n\\section{Thermal operations with fluctuating work}\\label{sec:generalized}\n\n\nFirst, let us characterise the type of process/operation that we consider, and show that they are suitably general and implementable to encompass what is commonly considered to be thermodynamics. Our setting consists of a system with Hamiltonian $H_S$, a bath with Hamiltonian $H_B$ initially in the thermal state $\\rho_B = \\frac 1 {Z_B} {\\mathrm{e}}^{-\\beta H_B}$, and an ideal weight with Hamiltonian $H_W=  \\int_\\mathbb{R} dx\\, x {|{x}\\rangle}\\! {\\langle{x}|}$, where the orthonormal basis $\\{|x\\rangle, \\forall\\, x\\in \\mathbb R\\}$ represents the position of the weight. The operations we consider will allow for the Hamiltonian to change\nas we shall see in Subsection \\ref{ss:toH}.\nAny joint transformation of system, bath and weight is represented by a Completely Positive Trace Preserving (CPTP) map $\\Gamma_{SBW}$. \n\nWe only consider maps $\\Gamma_{SBW}$ satisfying the following conditions:\n\\begin{description}\n  \\item[Unitary on all systems]\n  It has an (CPTP) inverse $\\Gamma_{SBW}^{-1}$, which implies unitarity $\\Gamma_{SBW} (\\rho_{SBW}) = U\\rho_{SBW} U^\\dagger$.\n  \n  \\item[Energy conservation] \n  The unitary commutes with the total Hamiltonian: $[U,H_S +H_B +H_W] =0$.\n\n  \\item[Independence of the ``position\" of the weight] The unitary commutes with the translations on the weight: $[U, \\Delta_W]=0$.\n  \n\\end{description}\nThe generator of the translations in the weight $\\Delta_W$ is canonically conjugated to the position of the weight $H_W$, that is $[\\Delta_W, H_W] = i$.\n\nThis last condition implies that the reduced map on system and bath $\\Gamma_{SB}$ is a mixture of unitaries (Result~1 in~\\cite{masanes2014derivation}). Hence the transformation can never decrease the entropy of system and bath, which \nguarantees that the weight is not used as a source of non-equilibrium. \n\nIt is important to mention that these constraints allow for processes that exploit the coherence of the weight, as in~\\cite{skrzypczyk2014work, masanes2014derivation}.\n\nBoth unitarity and energy conservation are fundamental laws of nature, so imposing them is a necessary assumption. Any process which\nappears to violate energy conservation in the above sense is in fact energy conserving, one is merely tracing out or ignoring a system which is taking or giving up energy.\nConversely, an operation which appears to violate energy conservation can be made energy conserving by considering its action on the weight or any other ancilla. \nFor example, turning on an interaction Hamiltonian between system, bath and weight can be done via a coherent ancilla as demonstrated in \\cite{brandao2011resource}.  One can generate other couplings between the three systems via\nthe unitary $U$.\nImposing energy conservation on the systems considered, thus ensures that all sources of energy are properly accounted for. We require that the total process is unitary on the systems, weight and bath, as is the case in nature, although\nthe operation on system and weight alone will usually not be.\n\n\nThe last condition implies that the reduced map on system and bath $\\Gamma_{SB}$ is a mixture of unitaries (Result~1 in~\\cite{masanes2014derivation}). Hence the transformation can never decrease the entropy of system and bath, which \nguarantees that the weight is not used as a source of non-equilibrium which would be a form of cheating. \nIndependence of the position of the weight can be thought of as a definition of work~\\cite{skrzypczyk2014work} and is used in both the information theoretic and fluctuation theorem approaches. In the latter case, the assumption is implicit, since the amount of work is taken to be the difference in energy between the initial and final system/bath. In other words, work\nis taken to be a change in energy of either the work system (explicit), or change in energy of the system-bath (implicitly). Conservation of energy ensures that the implicit and explicit paradigms are equivalent. \nWork then is the change in energy of the work system, and does not depend on how much energy is currently stored there, hence the unitary must commute with its translations.\n\nFinally, we note that we could allow the use of an ancilla which must be returned in its original state, so called {\\it Catalytic Thermal Operations} \\cite{brandao2013second}, however, we do not consider this here\nas we show that in the case of fluctuating work, it is no more powerful than ordinary Thermal Operations with respect to the quantities we are interested in.\n\n\n\\subsection{Thermal operations with non-constant Hamiltonian}\n\\label{ss:toH}\n\n\nThermal operations are general enough to include the case where the initial Hamiltonian of the system $H_S$ is different than the final one $H'_S$. This is done by including an additional qubit $X$ which plays the role of a switch (as in~\\cite{horodecki2013fundamental}).\nNow the total Hamiltonian is\n\n", "index": 15, "text": "\\begin{equation}\n  H = H_S\\otimes {|{0}\\rangle}_X\n  {\\langle{0}|} + H'_S \\otimes {|{1}\\rangle}_X\n  {\\langle{1}|} +H_B +H_W\n\\ ,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"H=H_{S}\\otimes{|{0}\\rangle}_{X}{\\langle{0}|}+H^{\\prime}_{S}\\otimes{|{1}\\rangle%&#10;}_{X}{\\langle{1}|}+H_{B}+H_{W}\\ ,\" display=\"block\"><mrow><mrow><mi>H</mi><mo>=</mo><mrow><mrow><mrow><msub><mi>H</mi><mi>S</mi></msub><mo>\u2297</mo><msub><mrow><mo fence=\"true\" stretchy=\"false\">|</mo><mn>0</mn><mo stretchy=\"false\">\u27e9</mo></mrow><mi>X</mi></msub></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">\u27e8</mo><mn>0</mn><mo fence=\"true\" stretchy=\"false\">|</mo></mrow></mrow><mo>+</mo><mrow><mrow><msubsup><mi>H</mi><mi>S</mi><mo>\u2032</mo></msubsup><mo>\u2297</mo><msub><mrow><mo fence=\"true\" stretchy=\"false\">|</mo><mn>1</mn><mo stretchy=\"false\">\u27e9</mo></mrow><mi>X</mi></msub></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">\u27e8</mo><mn>1</mn><mo fence=\"true\" stretchy=\"false\">|</mo></mrow></mrow><mo>+</mo><msub><mi>H</mi><mi>B</mi></msub><mo>+</mo><mpadded width=\"+5pt\"><msub><mi>H</mi><mi>W</mi></msub></mpadded></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nfor any $\\rho_{SBW}$.\nThis implies\n\n", "itemtype": "equation", "pos": 22292, "prevtext": "\nand energy conservation reads \n$[V,H] =0$, where $V$ is the global unitary when we include the switch.\nWe impose that the initial state of switch is ${|{0}\\rangle}_X$ and the global unitary $V$ performs the switching\n\n", "index": 17, "text": "\\begin{equation}\n  \\label{SS}\nV \\left( \n\\rho_{SBW} \\otimes {|{0}\\rangle}_X {\\langle{0}|}\\right)  V^\\dagger = \\rho'_{SBW} \\otimes {|{1}\\rangle}_X {\\langle{1}|} \n\\ ,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"V\\left(\\rho_{SBW}\\otimes{|{0}\\rangle}_{X}{\\langle{0}|}\\right)V^{\\dagger}=\\rho^%&#10;{\\prime}_{SBW}\\otimes{|{1}\\rangle}_{X}{\\langle{1}|}\\ ,\" display=\"block\"><mrow><mrow><mrow><mi>V</mi><mo>\u2062</mo><mrow><mo>(</mo><mrow><mrow><msub><mi>\u03c1</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>B</mi><mo>\u2062</mo><mi>W</mi></mrow></msub><mo>\u2297</mo><msub><mrow><mo fence=\"true\" stretchy=\"false\">|</mo><mn>0</mn><mo stretchy=\"false\">\u27e9</mo></mrow><mi>X</mi></msub></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">\u27e8</mo><mn>0</mn><mo fence=\"true\" stretchy=\"false\">|</mo></mrow></mrow><mo>)</mo></mrow><mo>\u2062</mo><msup><mi>V</mi><mo>\u2020</mo></msup></mrow><mo>=</mo><mrow><mrow><msubsup><mi>\u03c1</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>B</mi><mo>\u2062</mo><mi>W</mi></mrow><mo>\u2032</mo></msubsup><mo>\u2297</mo><msub><mrow><mo fence=\"true\" stretchy=\"false\">|</mo><mn>1</mn><mo stretchy=\"false\">\u27e9</mo></mrow><mi>X</mi></msub></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">\u27e8</mo><mn>1</mn><mo fence=\"true\" rspace=\"7.5pt\" stretchy=\"false\">|</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nwhere $U$ and $\\tilde U$ are unitaries on system, bath and weight. Condition $[V,H] =0$ implies\n\n", "itemtype": "equation", "pos": 22506, "prevtext": "\nfor any $\\rho_{SBW}$.\nThis implies\n\n", "index": 19, "text": "\\begin{equation}\n  V=  U\n  \\otimes{|{1}\\rangle}_X {\\langle{0}|} +\n  \\tilde U\n  \\otimes{|{0}\\rangle}_X {\\langle{1}|}\n  \\ ,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"V=U\\otimes{|{1}\\rangle}_{X}{\\langle{0}|}+\\tilde{U}\\otimes{|{0}\\rangle}_{X}{%&#10;\\langle{1}|}\\ ,\" display=\"block\"><mrow><mrow><mi>V</mi><mo>=</mo><mrow><mrow><mrow><mi>U</mi><mo>\u2297</mo><msub><mrow><mo fence=\"true\" stretchy=\"false\">|</mo><mn>1</mn><mo stretchy=\"false\">\u27e9</mo></mrow><mi>X</mi></msub></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">\u27e8</mo><mn>0</mn><mo fence=\"true\" stretchy=\"false\">|</mo></mrow></mrow><mo>+</mo><mrow><mrow><mover accent=\"true\"><mi>U</mi><mo stretchy=\"false\">~</mo></mover><mo>\u2297</mo><msub><mrow><mo fence=\"true\" stretchy=\"false\">|</mo><mn>0</mn><mo stretchy=\"false\">\u27e9</mo></mrow><mi>X</mi></msub></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">\u27e8</mo><mn>1</mn><mo fence=\"true\" rspace=\"7.5pt\" stretchy=\"false\">|</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nTherefore, the reduced map on system, bath and weight can be written as\n\n", "itemtype": "equation", "pos": 22739, "prevtext": "\nwhere $U$ and $\\tilde U$ are unitaries on system, bath and weight. Condition $[V,H] =0$ implies\n\n", "index": 21, "text": "\\begin{equation}\n  \\label{EC}\n  U (H_S+H_B+H_W) =\n  (H'_S+H_B+H_W) U\n  \\ .\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"U(H_{S}+H_{B}+H_{W})=(H^{\\prime}_{S}+H_{B}+H_{W})U\\ .\" display=\"block\"><mrow><mrow><mrow><mi>U</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>H</mi><mi>S</mi></msub><mo>+</mo><msub><mi>H</mi><mi>B</mi></msub><mo>+</mo><msub><mi>H</mi><mi>W</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msubsup><mi>H</mi><mi>S</mi><mo>\u2032</mo></msubsup><mo>+</mo><msub><mi>H</mi><mi>B</mi></msub><mo>+</mo><msub><mi>H</mi><mi>W</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mpadded width=\"+5pt\"><mi>U</mi></mpadded></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nwhere the unitary $U$ does not necessarily commute with $H_S+H_B+H_W$ nor $H'_S+H_B+H_W$ but satisfies~\\eqref{EC}.\n\n\n\n\\section{Identities for quantum thermal operations}\n\\label{sec:quantumidentities}\n\nIn this section we derive some fully quantum equalities for thermal operations with fluctuating work. In the next section we provide the physical meaning of these equalities. \nThus far, from the information theoretic perspective, some quantum constraints on state transformations are known\ni.e. constraints on transformations of the coherences over energy \nlevels~\\cite{brandao2013second,aberg2014catalytic,lostaglio2015description,cwiklinski2015limitations,lostaglio2014quantum,korzekwa2015extraction}, but none of these constraints apply in the case of fluctuating work.\nOn the other hand, in the fluctuation theorem approach, no quantum relations are known -- one always assumes that the initial and final states are measured in the energy eigenbasis, thus one is only considering transitions between quasi-classical states.\n\n\n\nIn what follows we are mostly interested in the joint dynamics of system and weight, which is described by the CPTP map\n\n", "itemtype": "equation", "pos": 22901, "prevtext": "\nTherefore, the reduced map on system, bath and weight can be written as\n\n", "index": 23, "text": "\\begin{equation}\n  \\label{rmm}\n  \\Gamma_{SBW} (\\rho_{SBW}) =\n  U \\rho_{SBW} \n  U^\\dagger\\ ,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m1\" class=\"ltx_Math\" alttext=\"\\Gamma_{SBW}(\\rho_{SBW})=U\\rho_{SBW}U^{\\dagger}\\ ,\" display=\"block\"><mrow><mrow><mrow><msub><mi mathvariant=\"normal\">\u0393</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>B</mi><mo>\u2062</mo><mi>W</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c1</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>B</mi><mo>\u2062</mo><mi>W</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mi>U</mi><mo>\u2062</mo><msub><mi>\u03c1</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>B</mi><mo>\u2062</mo><mi>W</mi></mrow></msub><mo>\u2062</mo><mpadded width=\"+5pt\"><msup><mi>U</mi><mo>\u2020</mo></msup></mpadded></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nIt is convenient to define the CP (but not TP) map\n\n", "itemtype": "equation", "pos": 24160, "prevtext": "\nwhere the unitary $U$ does not necessarily commute with $H_S+H_B+H_W$ nor $H'_S+H_B+H_W$ but satisfies~\\eqref{EC}.\n\n\n\n\\section{Identities for quantum thermal operations}\n\\label{sec:quantumidentities}\n\nIn this section we derive some fully quantum equalities for thermal operations with fluctuating work. In the next section we provide the physical meaning of these equalities. \nThus far, from the information theoretic perspective, some quantum constraints on state transformations are known\ni.e. constraints on transformations of the coherences over energy \nlevels~\\cite{brandao2013second,aberg2014catalytic,lostaglio2015description,cwiklinski2015limitations,lostaglio2014quantum,korzekwa2015extraction}, but none of these constraints apply in the case of fluctuating work.\nOn the other hand, in the fluctuation theorem approach, no quantum relations are known -- one always assumes that the initial and final states are measured in the energy eigenbasis, thus one is only considering transitions between quasi-classical states.\n\n\n\nIn what follows we are mostly interested in the joint dynamics of system and weight, which is described by the CPTP map\n\n", "index": 25, "text": "\\begin{equation}\n  \\label{def Gamma SW}\n  \\Gamma_{SW} (\\rho_{SW}) =\n  {\\rm tr}_{B} \\!\n  \\left[U\n  \\left( \\rho_{SW} \\otimes \\frac {e^{-\\beta H_B}} {Z_B} \n  \\right) U^\\dagger \\right] .\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m1\" class=\"ltx_Math\" alttext=\"\\Gamma_{SW}(\\rho_{SW})={\\rm tr}_{B}\\!\\left[U\\left(\\rho_{SW}\\otimes\\frac{e^{-%&#10;\\beta H_{B}}}{Z_{B}}\\right)U^{\\dagger}\\right].\" display=\"block\"><mrow><mrow><mrow><msub><mi mathvariant=\"normal\">\u0393</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>W</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c1</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>W</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mpadded width=\"-1.7pt\"><msub><mi>tr</mi><mi>B</mi></msub></mpadded><mo>\u2062</mo><mrow><mo>[</mo><mrow><mi>U</mi><mo>\u2062</mo><mrow><mo>(</mo><mrow><msub><mi>\u03c1</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>W</mi></mrow></msub><mo>\u2297</mo><mfrac><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi>\u03b2</mi><mo>\u2062</mo><msub><mi>H</mi><mi>B</mi></msub></mrow></mrow></msup><msub><mi>Z</mi><mi>B</mi></msub></mfrac></mrow><mo>)</mo></mrow><mo>\u2062</mo><msup><mi>U</mi><mo>\u2020</mo></msup></mrow><mo>]</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nwhose inverse is\n\n", "itemtype": "equation", "pos": 24409, "prevtext": "\nIt is convenient to define the CP (but not TP) map\n\n", "index": 27, "text": "\\begin{equation}\n  \\mathcal J_{H} (\\rho) = \n  e^{\\frac \\beta 2 H}  \n  \\rho\\,\n  e^{\\frac \\beta 2 H}  \n  \\ ,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E10.m1\" class=\"ltx_Math\" alttext=\"\\mathcal{J}_{H}(\\rho)=e^{\\frac{\\beta}{2}H}\\rho\\,e^{\\frac{\\beta}{2}H}\\ ,\" display=\"block\"><mrow><mrow><mrow><msub><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca5</mi><mi>H</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c1</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><msup><mi>e</mi><mrow><mfrac><mi>\u03b2</mi><mn>2</mn></mfrac><mo>\u2062</mo><mi>H</mi></mrow></msup><mo>\u2062</mo><mpadded width=\"+1.7pt\"><mi>\u03c1</mi></mpadded><mo>\u2062</mo><mpadded width=\"+5pt\"><msup><mi>e</mi><mrow><mfrac><mi>\u03b2</mi><mn>2</mn></mfrac><mo>\u2062</mo><mi>H</mi></mrow></msup></mpadded></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nUsing~\\eqref{EC} and~\\eqref{rmm} we obtain\n\\begin{eqnarray}\n  \\nonumber &&\n  \\left(\\mathcal J_{H'_S +H_W} \n  {} \\Gamma_{SW} {} \n  \\mathcal J^{-1}_{H_S +H_W}\n  \\right) ({\\mathbb{1}}_{SW}) \n  \\\\ \\nonumber &=& \n  \\mathcal J_{H'_S +H_W}\\! \\left(\n  {\\rm tr}_{B}\\! \\left[ \n  U\n  \\frac {{\\mathrm{e}}^{-\\beta(H_S+H_B+H_W)}} {Z_B} \n  U^\\dagger\n  \\right]\\right) \n  \\\\ \\nonumber &=& \n  \\mathcal J_{H'_S +H_W}\\! \\left(\n  {\\rm tr}_{B}\\! \\left[ \n  \\frac {{\\mathrm{e}}^{-\\beta(H'_S+H_B+H_W)}} {Z_B} \n  \\right]\\right) \n  \\\\ \\label{eee9} &=& \n  \\mathcal J_{H'_S +H_W}\\! \\left(\n  {\\mathrm{e}}^{-\\beta(H'_S+H_W)}\\right) \n  = \n  {\\mathbb{1}}_{SW}\\ .\n\\end{eqnarray}\nAs mentioned above, it was proven in~\\cite{masanes2014derivation} that condition $[U, \\Delta_W]=0$ implies\n${\\rm tr}_{W}\\! \\left( U{\\mathbb{1}}_{SB} \\otimes \\rho_W U^\\dagger \\right) ={\\mathbb{1}}_{SB}$ for any state $\\rho_W$.\nProceeding similarly as in~\\eqref{eee9} we obtain\n\\begin{eqnarray}\n  \\nonumber &&\n  {\\rm tr}_W\\!\n  \\left(\\mathcal J_{H'_S +H_W} \n  {} \\Gamma_{SW} {} \n  \\mathcal J^{-1}_{H_S +H_W}\n  \\right) ({\\mathbb{1}}_{S} \\otimes \\rho_W) \n  \\\\ \\nonumber &=& \n  {\\rm tr}_W\n  \\mathcal J_{H'_S +H_W}\\! \\left(\n  \\frac 1 {Z_B}\n  {\\rm tr}_B\\! \\left[ \n  U \\mathcal J^{-1} _{H_S+H_B+H_W}\n  ({\\mathbb{1}}_{SB} \\otimes \\rho_W)U^\\dagger\n  \\right]\\right) \n  \\\\ \\nonumber &=& \n  {\\rm tr}_W\n  \\mathcal J_{H'_S +H_W}\\! \\left(\n  \\frac 1 {Z_B}\n  {\\rm tr}_B\\! \\left[ \n  \\mathcal J^{-1} _{H'_S+H_B+H_W}\n  (U{\\mathbb{1}}_{SB} \\otimes \\rho_W U^\\dagger)\n  \\right]\\right) \n  \\\\ \\nonumber &=& \n  {\\rm tr}_{BW}\\! \\left(   \n  \\frac {{\\mathrm{e}}^{-\\beta H_B}} {Z_B} \n  U \n  ({\\mathbb{1}}_{SB} \\otimes \\rho_W)U^\\dagger\n  \\right) \n  \\\\ \\label{eee10} &=& \n  {\\rm tr}_{B}\\! \\left(   \n  \\frac {{\\mathrm{e}}^{-\\beta H_B}} {Z_B} \n  \\, {\\mathbb{1}}_{SB}\\right) \n  = \n  {\\mathbb{1}}_{S}\\ .\n\\end{eqnarray}\nWe thus have:\n\\begin{result}[Quantum Gibbs stochasticity]\n  \\label{R1}\nIf $\\Gamma_{SW}$ is a thermal operation then \n\n", "itemtype": "equation", "pos": 24548, "prevtext": "\nwhose inverse is\n\n", "index": 29, "text": "\\begin{equation}\n  \\mathcal J^{-1}_{H} (\\rho) = \n  e^{-\\frac \\beta 2 H}  \n  \\rho\\,\n  e^{-\\frac \\beta 2 H}  \n  \\ .\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E11.m1\" class=\"ltx_Math\" alttext=\"\\mathcal{J}^{-1}_{H}(\\rho)=e^{-\\frac{\\beta}{2}H}\\rho\\,e^{-\\frac{\\beta}{2}H}\\ .\" display=\"block\"><mrow><mrow><mrow><msubsup><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca5</mi><mi>H</mi><mrow><mo>-</mo><mn>1</mn></mrow></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c1</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><msup><mi>e</mi><mrow><mo>-</mo><mrow><mfrac><mi>\u03b2</mi><mn>2</mn></mfrac><mo>\u2062</mo><mi>H</mi></mrow></mrow></msup><mo>\u2062</mo><mpadded width=\"+1.7pt\"><mi>\u03c1</mi></mpadded><mo>\u2062</mo><mpadded width=\"+5pt\"><msup><mi>e</mi><mrow><mo>-</mo><mrow><mfrac><mi>\u03b2</mi><mn>2</mn></mfrac><mo>\u2062</mo><mi>H</mi></mrow></mrow></msup></mpadded></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nfor any initial state of the weight $\\rho_W$.\n\\end{result}\nThis is a quantum generalization of the Gibbs-stochasticity condition presented in~\\cite{janzing2000thermodynamic,Streater_dynamics}.\nThe result generalises that in \\cite{janzing2000thermodynamic,Streater_dynamics} not only because it includes work, but also because it is fully quantum.\nThe details of the quasi-classical generalization to the case of fluctuating work are provided in Section \\ref{sec:classical}.\n\n \nNext we use the identities $\\mathcal J^{-1}_{T\\ln \\rho} (\\rho) ={\\mathbb{1}}$ and ${\\rm tr} \\mathcal J_{T\\ln \\rho} ({\\mathbb{1}}) = 1$, which hold for any full-rank state $\\rho$.\nIn the case where the initial state $\\rho_S$ is not full rank, we can take the limit of a full-rank state.\nNow, applying $\\mathcal J_{T\\ln\\rho'_S}$ and taking the trace to the two sides of Result ~(\\ref{R1}) we obtain. \n\n\\begin{result}[Quantum Second Law Eq]\n\\label{re:qsl}\nIf $\\Gamma_{SW}$ is a thermal operation then, for every pair of initial states $\\rho_S, \\rho_W$, we have\n\\begin{eqnarray}\n  \\nonumber\n  {\\rm tr}_{SW}\\!\\! \\left[\\left(\n  \\mathcal J_\n  {T\\ln\\rho'_S} {} \n  \\mathcal J_\n  {H'_S  +H_W} {} \n  \\Gamma_{SW} {} \\mathcal J^{-1}_{H_S +H_W}\n  {} \\mathcal J^{-1}_{T\\ln \\rho_S}\n  \\right) \\! \n  \\left( \\rho_S \\otimes \\rho_{W} \\right)\n  \\right]\n  \\\\\n\n  = 1 \\hspace{78mm}\n\\nonumber\n\\end{eqnarray}\nwhere \n\n", "itemtype": "equation", "pos": 26620, "prevtext": "\nUsing~\\eqref{EC} and~\\eqref{rmm} we obtain\n\\begin{eqnarray}\n  \\nonumber &&\n  \\left(\\mathcal J_{H'_S +H_W} \n  {} \\Gamma_{SW} {} \n  \\mathcal J^{-1}_{H_S +H_W}\n  \\right) ({\\mathbb{1}}_{SW}) \n  \\\\ \\nonumber &=& \n  \\mathcal J_{H'_S +H_W}\\! \\left(\n  {\\rm tr}_{B}\\! \\left[ \n  U\n  \\frac {{\\mathrm{e}}^{-\\beta(H_S+H_B+H_W)}} {Z_B} \n  U^\\dagger\n  \\right]\\right) \n  \\\\ \\nonumber &=& \n  \\mathcal J_{H'_S +H_W}\\! \\left(\n  {\\rm tr}_{B}\\! \\left[ \n  \\frac {{\\mathrm{e}}^{-\\beta(H'_S+H_B+H_W)}} {Z_B} \n  \\right]\\right) \n  \\\\ \\label{eee9} &=& \n  \\mathcal J_{H'_S +H_W}\\! \\left(\n  {\\mathrm{e}}^{-\\beta(H'_S+H_W)}\\right) \n  = \n  {\\mathbb{1}}_{SW}\\ .\n\\end{eqnarray}\nAs mentioned above, it was proven in~\\cite{masanes2014derivation} that condition $[U, \\Delta_W]=0$ implies\n${\\rm tr}_{W}\\! \\left( U{\\mathbb{1}}_{SB} \\otimes \\rho_W U^\\dagger \\right) ={\\mathbb{1}}_{SB}$ for any state $\\rho_W$.\nProceeding similarly as in~\\eqref{eee9} we obtain\n\\begin{eqnarray}\n  \\nonumber &&\n  {\\rm tr}_W\\!\n  \\left(\\mathcal J_{H'_S +H_W} \n  {} \\Gamma_{SW} {} \n  \\mathcal J^{-1}_{H_S +H_W}\n  \\right) ({\\mathbb{1}}_{S} \\otimes \\rho_W) \n  \\\\ \\nonumber &=& \n  {\\rm tr}_W\n  \\mathcal J_{H'_S +H_W}\\! \\left(\n  \\frac 1 {Z_B}\n  {\\rm tr}_B\\! \\left[ \n  U \\mathcal J^{-1} _{H_S+H_B+H_W}\n  ({\\mathbb{1}}_{SB} \\otimes \\rho_W)U^\\dagger\n  \\right]\\right) \n  \\\\ \\nonumber &=& \n  {\\rm tr}_W\n  \\mathcal J_{H'_S +H_W}\\! \\left(\n  \\frac 1 {Z_B}\n  {\\rm tr}_B\\! \\left[ \n  \\mathcal J^{-1} _{H'_S+H_B+H_W}\n  (U{\\mathbb{1}}_{SB} \\otimes \\rho_W U^\\dagger)\n  \\right]\\right) \n  \\\\ \\nonumber &=& \n  {\\rm tr}_{BW}\\! \\left(   \n  \\frac {{\\mathrm{e}}^{-\\beta H_B}} {Z_B} \n  U \n  ({\\mathbb{1}}_{SB} \\otimes \\rho_W)U^\\dagger\n  \\right) \n  \\\\ \\label{eee10} &=& \n  {\\rm tr}_{B}\\! \\left(   \n  \\frac {{\\mathrm{e}}^{-\\beta H_B}} {Z_B} \n  \\, {\\mathbb{1}}_{SB}\\right) \n  = \n  {\\mathbb{1}}_{S}\\ .\n\\end{eqnarray}\nWe thus have:\n\\begin{result}[Quantum Gibbs stochasticity]\n  \\label{R1}\nIf $\\Gamma_{SW}$ is a thermal operation then \n\n", "index": 31, "text": "\\begin{equation}\n  {\\rm tr}_{W}\\! \\left[\n  \\left(\\mathcal J_{H'_S +H_W} {} \n  \\Gamma_{SW} {} \\mathcal J^{-1}_{H_S +H_W}\n  \\right) ({\\mathbb{1}}_S \\otimes \\rho_{W})\n  \\right]\n  = {\\mathbb{1}}_{S}\n\\nonumber\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m1\" class=\"ltx_Math\" alttext=\"{\\rm tr}_{W}\\!\\left[\\left(\\mathcal{J}_{H^{\\prime}_{S}+H_{W}}{}\\Gamma_{SW}{}%&#10;\\mathcal{J}^{-1}_{H_{S}+H_{W}}\\right)({\\mathbb{1}}_{S}\\otimes\\rho_{W})\\right]=%&#10;{\\mathbb{1}}_{S}\" display=\"block\"><mrow><mrow><mpadded width=\"-1.7pt\"><msub><mi>tr</mi><mi>W</mi></msub></mpadded><mo>\u2062</mo><mrow><mo>[</mo><mrow><mrow><mo>(</mo><mrow><msub><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca5</mi><mrow><msubsup><mi>H</mi><mi>S</mi><mo>\u2032</mo></msubsup><mo>+</mo><msub><mi>H</mi><mi>W</mi></msub></mrow></msub><mo>\u2062</mo><msub><mi mathvariant=\"normal\">\u0393</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>W</mi></mrow></msub><mo>\u2062</mo><msubsup><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca5</mi><mrow><msub><mi>H</mi><mi>S</mi></msub><mo>+</mo><msub><mi>H</mi><mi>W</mi></msub></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msubsup></mrow><mo>)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mn>\ud835\udfd9</mn><mi>S</mi></msub><mo>\u2297</mo><msub><mi>\u03c1</mi><mi>W</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>]</mo></mrow></mrow><mo>=</mo><msub><mn>\ud835\udfd9</mn><mi>S</mi></msub></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nis the final state of the system.\n\\end{result}\n\n \nThe above result is a quantum generalization of the second law equality, which we will describe in Section \\ref{sec:classical}.\n\nNow, applying $\\mathcal J^{-1}_{H'_S}$ and taking the trace to the two sides of Result~(\\ref{R1}) we obtain a quantum generalization of the Jarzynski inequality for general initial states.\n\n\\begin{result}[Quantum Jarzynski Eq]\n\\label{re:qje}\nIf $\\Gamma_{SW}$ is a thermal operation then\n\n", "itemtype": "equation", "pos": 28206, "prevtext": "\nfor any initial state of the weight $\\rho_W$.\n\\end{result}\nThis is a quantum generalization of the Gibbs-stochasticity condition presented in~\\cite{janzing2000thermodynamic,Streater_dynamics}.\nThe result generalises that in \\cite{janzing2000thermodynamic,Streater_dynamics} not only because it includes work, but also because it is fully quantum.\nThe details of the quasi-classical generalization to the case of fluctuating work are provided in Section \\ref{sec:classical}.\n\n \nNext we use the identities $\\mathcal J^{-1}_{T\\ln \\rho} (\\rho) ={\\mathbb{1}}$ and ${\\rm tr} \\mathcal J_{T\\ln \\rho} ({\\mathbb{1}}) = 1$, which hold for any full-rank state $\\rho$.\nIn the case where the initial state $\\rho_S$ is not full rank, we can take the limit of a full-rank state.\nNow, applying $\\mathcal J_{T\\ln\\rho'_S}$ and taking the trace to the two sides of Result ~(\\ref{R1}) we obtain. \n\n\\begin{result}[Quantum Second Law Eq]\n\\label{re:qsl}\nIf $\\Gamma_{SW}$ is a thermal operation then, for every pair of initial states $\\rho_S, \\rho_W$, we have\n\\begin{eqnarray}\n  \\nonumber\n  {\\rm tr}_{SW}\\!\\! \\left[\\left(\n  \\mathcal J_\n  {T\\ln\\rho'_S} {} \n  \\mathcal J_\n  {H'_S  +H_W} {} \n  \\Gamma_{SW} {} \\mathcal J^{-1}_{H_S +H_W}\n  {} \\mathcal J^{-1}_{T\\ln \\rho_S}\n  \\right) \\! \n  \\left( \\rho_S \\otimes \\rho_{W} \\right)\n  \\right]\n  \\\\\n\n  = 1 \\hspace{78mm}\n\\nonumber\n\\end{eqnarray}\nwhere \n\n", "index": 33, "text": "\\begin{equation}\n  \\label {fs}\n  \\rho'_S = {\\rm tr}_W\\!\n  \\left[ \\Gamma_{SW}\n  (\\rho_S\\otimes \\rho_W)\n  \\right]\\ ,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E12.m1\" class=\"ltx_Math\" alttext=\"\\rho^{\\prime}_{S}={\\rm tr}_{W}\\!\\left[\\Gamma_{SW}(\\rho_{S}\\otimes\\rho_{W})%&#10;\\right]\\ ,\" display=\"block\"><mrow><mrow><msubsup><mi>\u03c1</mi><mi>S</mi><mo>\u2032</mo></msubsup><mo>=</mo><mrow><mpadded width=\"-1.7pt\"><msub><mi>tr</mi><mi>W</mi></msub></mpadded><mo>\u2062</mo><mrow><mo>[</mo><mrow><msub><mi mathvariant=\"normal\">\u0393</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>W</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\u03c1</mi><mi>S</mi></msub><mo>\u2297</mo><msub><mi>\u03c1</mi><mi>W</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo rspace=\"7.5pt\">]</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nfor every pair of initial states $\\rho_S, \\rho_W$.\n\\end{result}\n\n\\section{Identities for classical thermal operations}\n\\label{sec:classical}\n\nWe will now go from the fully quantum identities, to ones which are applicable for quasi-classical states (i.e. those considered in fluctuation theorems).\nWe thus consider the case where there is an eigenbasis $|s\\rangle$ for $H_S$ and an eigenbasis $|s'\\rangle$ for $H'_S$ such that\n\n", "itemtype": "equation", "pos": 28802, "prevtext": "\nis the final state of the system.\n\\end{result}\n\n \nThe above result is a quantum generalization of the second law equality, which we will describe in Section \\ref{sec:classical}.\n\nNow, applying $\\mathcal J^{-1}_{H'_S}$ and taking the trace to the two sides of Result~(\\ref{R1}) we obtain a quantum generalization of the Jarzynski inequality for general initial states.\n\n\\begin{result}[Quantum Jarzynski Eq]\n\\label{re:qje}\nIf $\\Gamma_{SW}$ is a thermal operation then\n\n", "index": 35, "text": "\\begin{equation}\n  {\\rm tr}_{SW}\\! \\left[\\left(\n  \\mathcal J_{H_W} {} \n  \\Gamma_{SW} {} \\mathcal J^{-1}_{H_S +H_W}\n  {} \\mathcal J^{-1}_{T\\ln \\rho_S}\n  \\right) \n  \\left( \\rho_S \\otimes \\rho_{W} \\right)\n  \\right]\n  = Z'_{S}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E13.m1\" class=\"ltx_Math\" alttext=\"{\\rm tr}_{SW}\\!\\left[\\left(\\mathcal{J}_{H_{W}}{}\\Gamma_{SW}{}\\mathcal{J}^{-1}_%&#10;{H_{S}+H_{W}}{}\\mathcal{J}^{-1}_{T\\ln\\rho_{S}}\\right)\\left(\\rho_{S}\\otimes\\rho%&#10;_{W}\\right)\\right]=Z^{\\prime}_{S}\" display=\"block\"><mrow><mrow><mpadded width=\"-1.7pt\"><msub><mi>tr</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>W</mi></mrow></msub></mpadded><mo>\u2062</mo><mrow><mo>[</mo><mrow><mrow><mo>(</mo><mrow><msub><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca5</mi><msub><mi>H</mi><mi>W</mi></msub></msub><mo>\u2062</mo><msub><mi mathvariant=\"normal\">\u0393</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>W</mi></mrow></msub><mo>\u2062</mo><msubsup><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca5</mi><mrow><msub><mi>H</mi><mi>S</mi></msub><mo>+</mo><msub><mi>H</mi><mi>W</mi></msub></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msubsup><mo>\u2062</mo><msubsup><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca5</mi><mrow><mi>T</mi><mo>\u2062</mo><mrow><mi>ln</mi><mo>\u2061</mo><msub><mi>\u03c1</mi><mi>S</mi></msub></mrow></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msubsup></mrow><mo>)</mo></mrow><mo>\u2062</mo><mrow><mo>(</mo><mrow><msub><mi>\u03c1</mi><mi>S</mi></msub><mo>\u2297</mo><msub><mi>\u03c1</mi><mi>W</mi></msub></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow></mrow><mo>=</mo><msubsup><mi>Z</mi><mi>S</mi><mo>\u2032</mo></msubsup></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nwhere $|w\\rangle$ is the eigenbasis of $H_W$.\nNote that, when $H_S$ or $H'_S$ are degenerate, they could have other eigenbases not satisfying the above.  We say that $\\Gamma_{SW}$ is a process which acts on quasi-classical states.\n\nAlso, the ``independence of the position of the weight\" allows us to choose its initial state to be $|0\\rangle$ without loss of generality.\n\nIf we denote by $E_s$ and $E_{s'}$ the eigenvalues corresponding to $|s\\rangle$ and $|s'\\rangle$, then we can write $\\mathcal J_{H_S} (|s\\rangle\\! \\langle s|) = {\\mathrm{e}}^{\\beta E_s} |s\\rangle\\! \\langle s|$ and $\\mathcal J_{H'_S} (|s'\\rangle\\! \\langle s'|) = {\\mathrm{e}}^{\\beta E_{s'}} |s'\\rangle\\! \\langle s'|$.\n\nWhen~\\eqref{cl} holds we can represent the thermal operation $\\Gamma_{SW}$ with the stochastic matrix\n\n", "itemtype": "equation", "pos": 29466, "prevtext": "\nfor every pair of initial states $\\rho_S, \\rho_W$.\n\\end{result}\n\n\\section{Identities for classical thermal operations}\n\\label{sec:classical}\n\nWe will now go from the fully quantum identities, to ones which are applicable for quasi-classical states (i.e. those considered in fluctuation theorems).\nWe thus consider the case where there is an eigenbasis $|s\\rangle$ for $H_S$ and an eigenbasis $|s'\\rangle$ for $H'_S$ such that\n\n", "index": 37, "text": "\\begin{equation}\n  \\label{cl}\n  \\Gamma_{SW} \n  (|s\\rangle\\! \\langle s| \\otimes |0\\rangle\\! \\langle 0|)\n  =\n  \\sum_{s',w} P(s',w)\n  |s'\\rangle\\! \\langle s'|\n  \\otimes |w\\rangle\\! \\langle w|\\ ,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14.m1\" class=\"ltx_Math\" alttext=\"\\Gamma_{SW}(|s\\rangle\\!\\langle s|\\otimes|0\\rangle\\!\\langle 0|)=\\sum_{s^{\\prime%&#10;},w}P(s^{\\prime},w)|s^{\\prime}\\rangle\\!\\langle s^{\\prime}|\\otimes|w\\rangle\\!%&#10;\\langle w|\\ ,\" display=\"block\"><mrow><mrow><mrow><msub><mi mathvariant=\"normal\">\u0393</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>W</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mo fence=\"true\" stretchy=\"false\">|</mo><mi>s</mi><mo rspace=\"0.8pt\" stretchy=\"false\">\u27e9</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">\u27e8</mo><mi>s</mi><mo fence=\"true\" stretchy=\"false\">|</mo><mo>\u2297</mo><mo fence=\"true\" stretchy=\"false\">|</mo><mn>0</mn><mo rspace=\"0.8pt\" stretchy=\"false\">\u27e9</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">\u27e8</mo><mn>0</mn><mo fence=\"true\" stretchy=\"false\">|</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><msup><mi>s</mi><mo>\u2032</mo></msup><mo>,</mo><mi>w</mi></mrow></munder><mrow><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>\u2032</mo></msup><mo>,</mo><mi>w</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo fence=\"true\" stretchy=\"false\">|</mo><msup><mi>s</mi><mo>\u2032</mo></msup><mo rspace=\"0.8pt\" stretchy=\"false\">\u27e9</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">\u27e8</mo><msup><mi>s</mi><mo>\u2032</mo></msup><mo fence=\"true\" stretchy=\"false\">|</mo><mo>\u2297</mo><mo fence=\"true\" stretchy=\"false\">|</mo><mi>w</mi><mo rspace=\"0.8pt\" stretchy=\"false\">\u27e9</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">\u27e8</mo><mi>w</mi><mo fence=\"true\" rspace=\"7.5pt\" stretchy=\"false\">|</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nIn such a case we have\n\n\\begin{result}[Classical Gibbs stochasticity] $P(s',w|s)$ is a thermal operation mapping quasi-classical states to quasi-classical states if and only if\n\\label{re:CGS}\n\n", "itemtype": "equation", "pos": 30466, "prevtext": "\nwhere $|w\\rangle$ is the eigenbasis of $H_W$.\nNote that, when $H_S$ or $H'_S$ are degenerate, they could have other eigenbases not satisfying the above.  We say that $\\Gamma_{SW}$ is a process which acts on quasi-classical states.\n\nAlso, the ``independence of the position of the weight\" allows us to choose its initial state to be $|0\\rangle$ without loss of generality.\n\nIf we denote by $E_s$ and $E_{s'}$ the eigenvalues corresponding to $|s\\rangle$ and $|s'\\rangle$, then we can write $\\mathcal J_{H_S} (|s\\rangle\\! \\langle s|) = {\\mathrm{e}}^{\\beta E_s} |s\\rangle\\! \\langle s|$ and $\\mathcal J_{H'_S} (|s'\\rangle\\! \\langle s'|) = {\\mathrm{e}}^{\\beta E_{s'}} |s'\\rangle\\! \\langle s'|$.\n\nWhen~\\eqref{cl} holds we can represent the thermal operation $\\Gamma_{SW}$ with the stochastic matrix\n\n", "index": 39, "text": "\\begin{equation}\n  P(s',w|s) = \n  {\\rm tr}\\! \\left[  \n  |s'\\rangle\\! \\langle s'| \\otimes |w\\rangle\\! \\langle w|\\, \n  \\Gamma_{SW} \n  (|s\\rangle\\! \\langle s| \\otimes |0\\rangle\\! \\langle 0|)\n  \\right]\n  \\ .\n\\label{eq:classicalTO}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E15.m1\" class=\"ltx_Math\" alttext=\"P(s^{\\prime},w|s)={\\rm tr}\\!\\left[|s^{\\prime}\\rangle\\!\\langle s^{\\prime}|%&#10;\\otimes|w\\rangle\\!\\langle w|\\,\\Gamma_{SW}(|s\\rangle\\!\\langle s|\\otimes|0%&#10;\\rangle\\!\\langle 0|)\\right]\\ .\" display=\"block\"><mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>\u2032</mo></msup><mo>,</mo><mi>w</mi><mo stretchy=\"false\">|</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><mo>=</mo><mpadded width=\"-1.7pt\"><mi>tr</mi></mpadded><mrow><mo>[</mo><mo stretchy=\"false\">|</mo><msup><mi>s</mi><mo>\u2032</mo></msup><mo rspace=\"0.8pt\" stretchy=\"false\">\u27e9</mo></mrow><mrow><mo stretchy=\"false\">\u27e8</mo><msup><mi>s</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">|</mo><mo>\u2297</mo><mo stretchy=\"false\">|</mo><mi>w</mi><mo rspace=\"0.8pt\" stretchy=\"false\">\u27e9</mo></mrow><mrow><mo stretchy=\"false\">\u27e8</mo><mi>w</mi><mo rspace=\"4.2pt\" stretchy=\"false\">|</mo><msub><mi mathvariant=\"normal\">\u0393</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>W</mi></mrow></msub><mrow><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">|</mo><mi>s</mi><mo rspace=\"0.8pt\" stretchy=\"false\">\u27e9</mo></mrow><mrow><mo stretchy=\"false\">\u27e8</mo><mi>s</mi><mo stretchy=\"false\">|</mo><mo>\u2297</mo><mo stretchy=\"false\">|</mo><mn>0</mn><mo rspace=\"0.8pt\" stretchy=\"false\">\u27e9</mo></mrow><mrow><mo stretchy=\"false\">\u27e8</mo><mn>0</mn><mo stretchy=\"false\">|</mo><mo stretchy=\"false\">)</mo></mrow><mo rspace=\"7.5pt\">]</mo></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nfor all $s'$.\n\\end{result}\n\nThe above is a generalization of Gibbs-stochasticity~\\cite{janzing2000thermodynamic,Streater_dynamics} to the case where thermodynamical work is included. \nThe proof of the {\\it only if} direction follows simply by writing \nResult~\\ref{R1} in terms of the matrix of Equation \\eqref{eq:classicalTO}. The {\\it if} direction is proven as follows:\n Let us consider a bath with infinite volume in a thermal state at inverse temperature $\\beta$. Without loss of generality, the energy origin of the bath can be chosen such that $\\langle \\mathcal E \\rangle_\\beta =0$. This and the fact that its heat capacity is infinite (due to the infinite volume) implies that the density of states $\\Omega (\\mathcal E)$ is proportional to $e^{\\beta \\mathcal E}$.\n\nDue to energy conservation and invariance on the position of the weight, the joint map of system, bath and weight is characterised by the map of system and bath $\\pi: (s,b) \\to (s',b')$. \nNext, we construct the map $\\pi$ from the given $P(s',w|s)$ in the following way. When the system makes the transition $s\\to s'$, a fraction \n$P(s',w= {\\cal E-E'} +E_s -E_{s'}|s)$ of the bath states with energy $\\mathcal E$ are mapped to bath states with energy $\\mathcal E'$, for all values of $\\mathcal E$. \nUsing the fact that the number of states with energy $\\mathcal E$ is $\\Omega(\\mathcal E) = A\\, e^{\\beta \\mathcal E}$ with $A$ constant, we can show that $\\pi$ is a permutation.\n\nThe number of (final) states in the set $\\{(s',b'): \\mathcal E_{b'} =\\mathcal E'\\}$ is $\\Omega (\\mathcal E')$. And the number of (initial) states $(s,b)$ that are mapped to this set is\n\\begin{eqnarray*}\n  &&\n  \\sum_{s,\\mathcal E} \n  P(s',w= {\\cal E-E'} +E_s -E_{s'}|s)\\, \n  \\Omega(\\mathcal E)\n  \\\\ &=&\n  \\sum_{s,w} \n  P(s',w|s)\\, \n  A\\,\n  e^{\\beta (\\mathcal E_{s'} -E_s +w +\\mathcal E')}\n  \\\\ &=&\n  \\Omega (\\mathcal E')\\ ,\n\\end{eqnarray*}\nwhere in the last line we have used~\\eqref{eqR4}.\nTherefore, it is possible to construct a permutation with the mentioned requirements.\n\\qed\n\nNote that Result~\\ref{re:CGS} gives a necessary and sufficient condition than Thermal Operations with a fluctuating weight must satisfy, while Result~\\ref{R1} is a necessary condition. \nThis follows by considering a Gibbs preserving operation on the system and ${\\mathbb{1}}_W$ on the weight. This clearly satisfies Result~\\ref{R1}, yet \nsince Gibbs preserving operations are a larger class of operations that Thermal Operations~\\cite{faist2015gibbs}, it need not be a Thermal Operation.\n\n\nIn a similar fashion we can write the classical case of Result~\\ref{re:qsl} as\n\n", "itemtype": "equation", "pos": 30900, "prevtext": "\nIn such a case we have\n\n\\begin{result}[Classical Gibbs stochasticity] $P(s',w|s)$ is a thermal operation mapping quasi-classical states to quasi-classical states if and only if\n\\label{re:CGS}\n\n", "index": 41, "text": "\\begin{equation}\n  \\label{eqR4}\n  \\sum_{s,w} P(s',w|s)\\,  \n  {\\mathrm{e}}^{\\beta (E_{s'}-E_s +w)} = 1\n\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E16.m1\" class=\"ltx_Math\" alttext=\"\\sum_{s,w}P(s^{\\prime},w|s)\\,{\\mathrm{e}}^{\\beta(E_{s^{\\prime}}-E_{s}+w)}=1\\par&#10;\" display=\"block\"><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>s</mi><mo>,</mo><mi>w</mi></mrow></munder><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>\u2032</mo></msup><mo>,</mo><mi>w</mi><mo stretchy=\"false\">|</mo><mi>s</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><msup><mi mathvariant=\"normal\">e</mi><mrow><mi>\u03b2</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><msub><mi>E</mi><msup><mi>s</mi><mo>\u2032</mo></msup></msub><mo>-</mo><msub><mi>E</mi><mi>s</mi></msub></mrow><mo>+</mo><mi>w</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msup><mo>=</mo><mn>1</mn></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nwhere we define the fine-grained free energies\n\\begin{eqnarray}\n  f_s &=& E_s +\\frac{1}{\\beta}\\ln P(s)\\ ,\n  \\\\\n  f_{s'} &=& E_{s'} +\\frac{1}{\\beta}\\ln P(s')\\ .\n\\end{eqnarray}\nIn a more compact form\n\\begin{result}[Classical Second Law Eq]\n\\label{R5}\nA process on quasi-classical states that is fundamentally unitary, conserves energy and is independent of the position of the weight satisfies\n\n", "itemtype": "equation", "pos": 33616, "prevtext": "\nfor all $s'$.\n\\end{result}\n\nThe above is a generalization of Gibbs-stochasticity~\\cite{janzing2000thermodynamic,Streater_dynamics} to the case where thermodynamical work is included. \nThe proof of the {\\it only if} direction follows simply by writing \nResult~\\ref{R1} in terms of the matrix of Equation \\eqref{eq:classicalTO}. The {\\it if} direction is proven as follows:\n Let us consider a bath with infinite volume in a thermal state at inverse temperature $\\beta$. Without loss of generality, the energy origin of the bath can be chosen such that $\\langle \\mathcal E \\rangle_\\beta =0$. This and the fact that its heat capacity is infinite (due to the infinite volume) implies that the density of states $\\Omega (\\mathcal E)$ is proportional to $e^{\\beta \\mathcal E}$.\n\nDue to energy conservation and invariance on the position of the weight, the joint map of system, bath and weight is characterised by the map of system and bath $\\pi: (s,b) \\to (s',b')$. \nNext, we construct the map $\\pi$ from the given $P(s',w|s)$ in the following way. When the system makes the transition $s\\to s'$, a fraction \n$P(s',w= {\\cal E-E'} +E_s -E_{s'}|s)$ of the bath states with energy $\\mathcal E$ are mapped to bath states with energy $\\mathcal E'$, for all values of $\\mathcal E$. \nUsing the fact that the number of states with energy $\\mathcal E$ is $\\Omega(\\mathcal E) = A\\, e^{\\beta \\mathcal E}$ with $A$ constant, we can show that $\\pi$ is a permutation.\n\nThe number of (final) states in the set $\\{(s',b'): \\mathcal E_{b'} =\\mathcal E'\\}$ is $\\Omega (\\mathcal E')$. And the number of (initial) states $(s,b)$ that are mapped to this set is\n\\begin{eqnarray*}\n  &&\n  \\sum_{s,\\mathcal E} \n  P(s',w= {\\cal E-E'} +E_s -E_{s'}|s)\\, \n  \\Omega(\\mathcal E)\n  \\\\ &=&\n  \\sum_{s,w} \n  P(s',w|s)\\, \n  A\\,\n  e^{\\beta (\\mathcal E_{s'} -E_s +w +\\mathcal E')}\n  \\\\ &=&\n  \\Omega (\\mathcal E')\\ ,\n\\end{eqnarray*}\nwhere in the last line we have used~\\eqref{eqR4}.\nTherefore, it is possible to construct a permutation with the mentioned requirements.\n\\qed\n\nNote that Result~\\ref{re:CGS} gives a necessary and sufficient condition than Thermal Operations with a fluctuating weight must satisfy, while Result~\\ref{R1} is a necessary condition. \nThis follows by considering a Gibbs preserving operation on the system and ${\\mathbb{1}}_W$ on the weight. This clearly satisfies Result~\\ref{R1}, yet \nsince Gibbs preserving operations are a larger class of operations that Thermal Operations~\\cite{faist2015gibbs}, it need not be a Thermal Operation.\n\n\nIn a similar fashion we can write the classical case of Result~\\ref{re:qsl} as\n\n", "index": 43, "text": "\\begin{equation}\n  \\sum_{s',s,w} P(s',w|s)\\,  \n  {\\mathrm{e}}^{\\beta (f_{s'}-f_s +w)} P(s) \n  = 1\\ ,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E17.m1\" class=\"ltx_Math\" alttext=\"\\sum_{s^{\\prime},s,w}P(s^{\\prime},w|s)\\,{\\mathrm{e}}^{\\beta(f_{s^{\\prime}}-f_{%&#10;s}+w)}P(s)=1\\ ,\" display=\"block\"><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><msup><mi>s</mi><mo>\u2032</mo></msup><mo>,</mo><mi>s</mi><mo>,</mo><mi>w</mi></mrow></munder><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>\u2032</mo></msup><mo>,</mo><mi>w</mi><mo stretchy=\"false\">|</mo><mi>s</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><msup><mi mathvariant=\"normal\">e</mi><mrow><mi>\u03b2</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><msub><mi>f</mi><msup><mi>s</mi><mo>\u2032</mo></msup></msub><mo>-</mo><msub><mi>f</mi><mi>s</mi></msub></mrow><mo>+</mo><mi>w</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msup><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><mo>=</mo><mpadded width=\"+5pt\"><mn>1</mn></mpadded><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\n\\end{result}\nThis result follows simply by using Eq. \\eqref{eq:classicalTO} in Result~\\ref{re:qsl}.\n\nDue to the convexity of the exponential,  this equality implies the standard second law\n\n", "itemtype": "equation", "pos": 34124, "prevtext": "\nwhere we define the fine-grained free energies\n\\begin{eqnarray}\n  f_s &=& E_s +\\frac{1}{\\beta}\\ln P(s)\\ ,\n  \\\\\n  f_{s'} &=& E_{s'} +\\frac{1}{\\beta}\\ln P(s')\\ .\n\\end{eqnarray}\nIn a more compact form\n\\begin{result}[Classical Second Law Eq]\n\\label{R5}\nA process on quasi-classical states that is fundamentally unitary, conserves energy and is independent of the position of the weight satisfies\n\n", "index": 45, "text": "\\begin{equation}\n  \\label{2le3}\n  \\left\\langle\n  {\\mathrm{e}}^{\\beta(f_{s'}-f_s +w)}\n  \\right\\rangle =1\\ .\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E18.m1\" class=\"ltx_Math\" alttext=\"\\left\\langle{\\mathrm{e}}^{\\beta(f_{s^{\\prime}}-f_{s}+w)}\\right\\rangle=1\\ .\" display=\"block\"><mrow><mrow><mrow><mo>\u27e8</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mi>\u03b2</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><msub><mi>f</mi><msup><mi>s</mi><mo>\u2032</mo></msup></msub><mo>-</mo><msub><mi>f</mi><mi>s</mi></msub></mrow><mo>+</mo><mi>w</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msup><mo>\u27e9</mo></mrow><mo>=</mo><mpadded width=\"+5pt\"><mn>1</mn></mpadded></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nBut equality~\\eqref{2le3} is stronger, since it implies the following infinite list of inequalities\n\n", "itemtype": "equation", "pos": 34435, "prevtext": "\n\\end{result}\nThis result follows simply by using Eq. \\eqref{eq:classicalTO} in Result~\\ref{re:qsl}.\n\nDue to the convexity of the exponential,  this equality implies the standard second law\n\n", "index": 47, "text": "\\begin{equation}\n  \\label{2le4}\n  \\langle f_{s'}-f_s +w \\rangle\n  \\leq 0\\ .\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E19.m1\" class=\"ltx_Math\" alttext=\"\\langle f_{s^{\\prime}}-f_{s}+w\\rangle\\leq 0\\ .\" display=\"block\"><mrow><mrow><mrow><mo stretchy=\"false\">\u27e8</mo><mrow><mrow><msub><mi>f</mi><msup><mi>s</mi><mo>\u2032</mo></msup></msub><mo>-</mo><msub><mi>f</mi><mi>s</mi></msub></mrow><mo>+</mo><mi>w</mi></mrow><mo stretchy=\"false\">\u27e9</mo></mrow><mo>\u2264</mo><mpadded width=\"+5pt\"><mn>0</mn></mpadded></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nwhere $N$ can be any odd number. \n\nNote that~\\eqref{2le4} is the $N=1$ case. One can think of Equation \\eqref{eq:infbounds} as providing higher order corrections to the standard second law inequality. \nAll the other inequalities have information about the joint fluctuations of $f_s, f_{s'}$ and $w$.\nTo prove~\\eqref{eq:infbounds} we just note that the residue of the Taylor expansion of the exponential function to any odd order is always negative.\n\nNext we proceed as in Result~\\ref{R5}, and obtain the classical version of Result~\\ref{re:qje} by once again substituting Equation \\eqref{eq:classicalTO} into it.\n\\begin{result}[Classical Jarzynski Eq]\n\\label{R6}\nA process on quasi-classical states that is fundamentally unitary, conserves energy and is independent of the position of the weight satisfies\n\n", "itemtype": "equation", "pos": 34626, "prevtext": "\nBut equality~\\eqref{2le3} is stronger, since it implies the following infinite list of inequalities\n\n", "index": 49, "text": "\\begin{equation}\\label{eq:infbounds}\n  \\sum_{k=1}^N\n  \\frac {\\beta^k} {k!} \n  \\left\\langle \\left(f_{s'} -f_s + w \\right)^k \\right\\rangle \n  \\leq 0\\ ,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E20.m1\" class=\"ltx_Math\" alttext=\"\\sum_{k=1}^{N}\\frac{\\beta^{k}}{k!}\\left\\langle\\left(f_{s^{\\prime}}-f_{s}+w%&#10;\\right)^{k}\\right\\rangle\\leq 0\\ ,\" display=\"block\"><mrow><mrow><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow><mfrac><msup><mi>\u03b2</mi><mi>k</mi></msup><mrow><mi>k</mi><mo lspace=\"0pt\" rspace=\"3.5pt\">!</mo></mrow></mfrac><mo>\u2062</mo><mrow><mo>\u27e8</mo><msup><mrow><mo>(</mo><mrow><mrow><msub><mi>f</mi><msup><mi>s</mi><mo>\u2032</mo></msup></msub><mo>-</mo><msub><mi>f</mi><mi>s</mi></msub></mrow><mo>+</mo><mi>w</mi></mrow><mo>)</mo></mrow><mi>k</mi></msup><mo>\u27e9</mo></mrow></mrow></mrow><mo>\u2264</mo><mpadded width=\"+5pt\"><mn>0</mn></mpadded></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\n\\end{result}\nNote that this version of the Jarzynski equation is valid for any initial state of the system, encoded in the fine-grained free energy $f_s$. For the particular case where the initial state is thermal, we have ${\\mathrm{e}}^{-\\beta f_s} = Z_S$ for all $s$, which implies the standard Jarzynski Equality\n\n", "itemtype": "equation", "pos": 35598, "prevtext": "\nwhere $N$ can be any odd number. \n\nNote that~\\eqref{2le4} is the $N=1$ case. One can think of Equation \\eqref{eq:infbounds} as providing higher order corrections to the standard second law inequality. \nAll the other inequalities have information about the joint fluctuations of $f_s, f_{s'}$ and $w$.\nTo prove~\\eqref{eq:infbounds} we just note that the residue of the Taylor expansion of the exponential function to any odd order is always negative.\n\nNext we proceed as in Result~\\ref{R5}, and obtain the classical version of Result~\\ref{re:qje} by once again substituting Equation \\eqref{eq:classicalTO} into it.\n\\begin{result}[Classical Jarzynski Eq]\n\\label{R6}\nA process on quasi-classical states that is fundamentally unitary, conserves energy and is independent of the position of the weight satisfies\n\n", "index": 51, "text": "\\begin{equation}\\label{classJarz}\n  \\left\\langle\n  {\\mathrm{e}}^{\\beta(w-f_s)}\n  \\right\\rangle \n  = Z'_S\\ .\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E21.m1\" class=\"ltx_Math\" alttext=\"\\left\\langle{\\mathrm{e}}^{\\beta(w-f_{s})}\\right\\rangle=Z^{\\prime}_{S}\\ .\" display=\"block\"><mrow><mrow><mrow><mo>\u27e8</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mi>\u03b2</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>w</mi><mo>-</mo><msub><mi>f</mi><mi>s</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msup><mo>\u27e9</mo></mrow><mo>=</mo><mpadded width=\"+5pt\"><msubsup><mi>Z</mi><mi>S</mi><mo>\u2032</mo></msubsup></mpadded></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\n\n\n\n\\section{Classical-quantum identities}\n\\label{sec:cq-identities}\n\nIn classical physics there is no problem in writing joint expectations of observables for the initial and final states of an evolution. For example, this is done in Results \\ref{re:CGS}-\\ref{R6}.\nIn general, quantum theory does not allow for this, because a measurement on the initial state will disturb it, and then no longer will it be the initial state.\n\nHowever, in the case were the measurement is non-disturbing on the initial state, the joint expectation is well-defined, independently of the measurement on the final state.\n\nIn what follows we analyze this case, by imposing that both the system and weight are quasi-classical \n\n\n\n\n\n\n\n\nWe do not put any constraint onto the final state, but define its dephased version\n\n", "itemtype": "equation", "pos": 36037, "prevtext": "\n\\end{result}\nNote that this version of the Jarzynski equation is valid for any initial state of the system, encoded in the fine-grained free energy $f_s$. For the particular case where the initial state is thermal, we have ${\\mathrm{e}}^{-\\beta f_s} = Z_S$ for all $s$, which implies the standard Jarzynski Equality\n\n", "index": 53, "text": "\\begin{equation}\n  \\left\\langle\n  {\\mathrm{e}}^{\\beta w}\n  \\right\\rangle \n  = \\frac {Z'_S} {Z_S}\\ .\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E22.m1\" class=\"ltx_Math\" alttext=\"\\left\\langle{\\mathrm{e}}^{\\beta w}\\right\\rangle=\\frac{Z^{\\prime}_{S}}{Z_{S}}\\ .\" display=\"block\"><mrow><mrow><mrow><mo>\u27e8</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mi>\u03b2</mi><mo>\u2062</mo><mi>w</mi></mrow></msup><mo>\u27e9</mo></mrow><mo>=</mo><mpadded width=\"+5pt\"><mfrac><msubsup><mi>Z</mi><mi>S</mi><mo>\u2032</mo></msubsup><msub><mi>Z</mi><mi>S</mi></msub></mfrac></mpadded></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nThe dephasing CPTP map projects $\\rho'_S$ onto the subspace of Hermitian matrices that commute with $H'_S$.\n\nIf $\\rho_S = \\sum_s P(s) |s\\rangle\\! \\langle s|$ is the spectral decomposition of the initial state, and $|x\\rangle$ is an eigenstate of $H_W$, then\n\\begin{eqnarray}\n  \\nonumber &&\n  (\\mathcal J^{-1}_{H_S +H_W} \n  {} \n  \\mathcal J^{-1}_{T\\ln \\rho_S}) \n  (|s\\rangle\\! \\langle s| \\otimes \n  |x\\rangle\\! \\langle x|)\n  \\\\ &=&\n  {\\mathrm{e}}^{-\\beta(E_s+T\\ln P(s) +x)}\n  (|s\\rangle\\! \\langle s| \\otimes \n  |x\\rangle\\! \\langle x|)\\ .\n\\end{eqnarray}\nThe following definitions of the {\\it free energy operator} are used below\n\\begin{eqnarray}\n  F_S &=& H_S + T\\ln\\Delta[\\rho_S]\\ ,\n  \\\\\n  F'_S &=& H'_S + \n  T\\ln\\Delta' [\\rho'_S]\\ .\n\\end{eqnarray}\nIf in the derivation of Result~\\ref{re:qsl} we multiply by $\\mathcal J_{T\\ln\\Delta\\rho'_S}$ instead of $\\mathcal J_{T\\ln\\rho'_S}$ we obtain\n\n", "itemtype": "equation", "pos": 36948, "prevtext": "\n\n\n\n\\section{Classical-quantum identities}\n\\label{sec:cq-identities}\n\nIn classical physics there is no problem in writing joint expectations of observables for the initial and final states of an evolution. For example, this is done in Results \\ref{re:CGS}-\\ref{R6}.\nIn general, quantum theory does not allow for this, because a measurement on the initial state will disturb it, and then no longer will it be the initial state.\n\nHowever, in the case were the measurement is non-disturbing on the initial state, the joint expectation is well-defined, independently of the measurement on the final state.\n\nIn what follows we analyze this case, by imposing that both the system and weight are quasi-classical \n\n\n\n\n\n\n\n\nWe do not put any constraint onto the final state, but define its dephased version\n\n", "index": 55, "text": "\\begin{equation}\n  \\Delta'[\\rho'_S] =\n  \\int dt\\, {\\mathrm{e}}^{-iH'_S t}\n  \\rho_S\\, {\\mathrm{e}}^{iH'_S t}\\ .\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E23.m1\" class=\"ltx_Math\" alttext=\"\\Delta^{\\prime}[\\rho^{\\prime}_{S}]=\\int dt\\,{\\mathrm{e}}^{-iH^{\\prime}_{S}t}%&#10;\\rho_{S}\\,{\\mathrm{e}}^{iH^{\\prime}_{S}t}\\ .\" display=\"block\"><mrow><mrow><mrow><msup><mi mathvariant=\"normal\">\u0394</mi><mo>\u2032</mo></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><msubsup><mi>\u03c1</mi><mi>S</mi><mo>\u2032</mo></msubsup><mo stretchy=\"false\">]</mo></mrow></mrow><mo>=</mo><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mrow><mo>\ud835\udc51</mo><mpadded width=\"+1.7pt\"><mi>t</mi></mpadded></mrow><mo>\u2062</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mo>-</mo><mrow><mi>i</mi><mo>\u2062</mo><msubsup><mi>H</mi><mi>S</mi><mo>\u2032</mo></msubsup><mo>\u2062</mo><mi>t</mi></mrow></mrow></msup><mo>\u2062</mo><mpadded width=\"+1.7pt\"><msub><mi>\u03c1</mi><mi>S</mi></msub></mpadded><mo>\u2062</mo><mpadded width=\"+5pt\"><msup><mi mathvariant=\"normal\">e</mi><mrow><mi>i</mi><mo>\u2062</mo><msubsup><mi>H</mi><mi>S</mi><mo>\u2032</mo></msubsup><mo>\u2062</mo><mi>t</mi></mrow></msup></mpadded></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nwhere we have used that $\\Delta[\\rho_S] = \\rho_S$.\n\nAgain, independence from the position of the weight allows us to choose $\\rho_W = |0\\rangle\\! \\langle 0|$. \n\nThis allows us to write the above equality as\n\n", "itemtype": "equation", "pos": 37962, "prevtext": "\nThe dephasing CPTP map projects $\\rho'_S$ onto the subspace of Hermitian matrices that commute with $H'_S$.\n\nIf $\\rho_S = \\sum_s P(s) |s\\rangle\\! \\langle s|$ is the spectral decomposition of the initial state, and $|x\\rangle$ is an eigenstate of $H_W$, then\n\\begin{eqnarray}\n  \\nonumber &&\n  (\\mathcal J^{-1}_{H_S +H_W} \n  {} \n  \\mathcal J^{-1}_{T\\ln \\rho_S}) \n  (|s\\rangle\\! \\langle s| \\otimes \n  |x\\rangle\\! \\langle x|)\n  \\\\ &=&\n  {\\mathrm{e}}^{-\\beta(E_s+T\\ln P(s) +x)}\n  (|s\\rangle\\! \\langle s| \\otimes \n  |x\\rangle\\! \\langle x|)\\ .\n\\end{eqnarray}\nThe following definitions of the {\\it free energy operator} are used below\n\\begin{eqnarray}\n  F_S &=& H_S + T\\ln\\Delta[\\rho_S]\\ ,\n  \\\\\n  F'_S &=& H'_S + \n  T\\ln\\Delta' [\\rho'_S]\\ .\n\\end{eqnarray}\nIf in the derivation of Result~\\ref{re:qsl} we multiply by $\\mathcal J_{T\\ln\\Delta\\rho'_S}$ instead of $\\mathcal J_{T\\ln\\rho'_S}$ we obtain\n\n", "index": 57, "text": "\\begin{equation}\n  \\nonumber\n  {\\rm tr}_{SW}\\!\\! \\left[\\left(\n  \\mathcal J_\n  {F'_S  +H_W} {} \n  \\Gamma_{SW} {} \\mathcal J^{-1}_{F_S +H_W}\n  \\right) \\! \n  \\left( \\rho_S \\otimes \\rho_{W} \\right)\n  \\right]\n  = 1\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex6.m1\" class=\"ltx_Math\" alttext=\"{\\rm tr}_{SW}\\!\\!\\left[\\left(\\mathcal{J}_{F^{\\prime}_{S}+H_{W}}{}\\Gamma_{SW}{}%&#10;\\mathcal{J}^{-1}_{F_{S}+H_{W}}\\right)\\!\\left(\\rho_{S}\\otimes\\rho_{W}\\right)%&#10;\\right]=1\" display=\"block\"><mrow><mrow><mpadded width=\"-3.4pt\"><msub><mi>tr</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>W</mi></mrow></msub></mpadded><mo>\u2062</mo><mrow><mo>[</mo><mrow><mrow><mo>(</mo><mrow><msub><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca5</mi><mrow><msubsup><mi>F</mi><mi>S</mi><mo>\u2032</mo></msubsup><mo>+</mo><msub><mi>H</mi><mi>W</mi></msub></mrow></msub><mo>\u2062</mo><msub><mi mathvariant=\"normal\">\u0393</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>W</mi></mrow></msub><mo>\u2062</mo><msubsup><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca5</mi><mrow><msub><mi>F</mi><mi>S</mi></msub><mo>+</mo><msub><mi>H</mi><mi>W</mi></msub></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msubsup></mrow><mo rspace=\"0.8pt\">)</mo></mrow><mo>\u2062</mo><mrow><mo>(</mo><mrow><msub><mi>\u03c1</mi><mi>S</mi></msub><mo>\u2297</mo><msub><mi>\u03c1</mi><mi>W</mi></msub></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow></mrow><mo>=</mo><mn>1</mn></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nor equivalently\n\n\\begin{result}[Classical-Quantum Second Law Eq]\n\\label{R7}\nConsider a process that is microscopically reversible, conserves energy and is independent of the position of the weight. If the initial states of system and weight commute with the corresponding Hamiltonians then\n\n", "itemtype": "equation", "pos": 38394, "prevtext": "\nwhere we have used that $\\Delta[\\rho_S] = \\rho_S$.\n\nAgain, independence from the position of the weight allows us to choose $\\rho_W = |0\\rangle\\! \\langle 0|$. \n\nThis allows us to write the above equality as\n\n", "index": 59, "text": "\\begin{equation*}\n  \\sum_{s} {\\mathrm{e}}^{-\\beta f_s} P(s)\\,\n  {\\rm tr}_{SW}\\!\\! \\left[\n  {\\mathrm{e}}^{\\beta (F'_S + H_W)}\\,\n  \\Gamma_{SW} \\! \n  \\left(|s\\rangle\\! \\langle s| \\!\\otimes\\! \n  |0\\rangle\\! \\langle 0|\n  \\right)\n  \\right]\n  =1\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex7.m1\" class=\"ltx_Math\" alttext=\"\\sum_{s}{\\mathrm{e}}^{-\\beta f_{s}}P(s)\\,{\\rm tr}_{SW}\\!\\!\\left[{\\mathrm{e}}^{%&#10;\\beta(F^{\\prime}_{S}+H_{W})}\\,\\Gamma_{SW}\\!\\left(|s\\rangle\\!\\langle s|\\!%&#10;\\otimes\\!|0\\rangle\\!\\langle 0|\\right)\\right]=1\" display=\"block\"><mrow><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mi>s</mi></munder><mrow><msup><mi mathvariant=\"normal\">e</mi><mrow><mo>-</mo><mrow><mi>\u03b2</mi><mo>\u2062</mo><msub><mi>f</mi><mi>s</mi></msub></mrow></mrow></msup><mo>\u2062</mo><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mpadded width=\"-3.4pt\"><msub><mi>tr</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>W</mi></mrow></msub></mpadded><mo>\u2062</mo><mrow><mo>[</mo><mrow><mpadded width=\"+1.7pt\"><msup><mi mathvariant=\"normal\">e</mi><mrow><mi>\u03b2</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msubsup><mi>F</mi><mi>S</mi><mo>\u2032</mo></msubsup><mo>+</mo><msub><mi>H</mi><mi>W</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msup></mpadded><mo>\u2062</mo><mpadded width=\"-1.7pt\"><msub><mi mathvariant=\"normal\">\u0393</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>W</mi></mrow></msub></mpadded><mo>\u2062</mo><mrow><mo>(</mo><mrow><mrow><mo fence=\"true\" stretchy=\"false\">|</mo><mi>s</mi><mo rspace=\"0.8pt\" stretchy=\"false\">\u27e9</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">\u27e8</mo><mi>s</mi><mo fence=\"true\" rspace=\"0.8pt\" stretchy=\"false\">|</mo><mo rspace=\"0.8pt\">\u2297</mo><mo fence=\"true\" stretchy=\"false\">|</mo><mn>0</mn><mo rspace=\"0.8pt\" stretchy=\"false\">\u27e9</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">\u27e8</mo><mn>0</mn><mo fence=\"true\" stretchy=\"false\">|</mo></mrow></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow></mrow></mrow><mo>=</mo><mn>1</mn></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\n\\end{result}\n\nIn the same way we have:\n\\begin{result}[Classical-Quantum Jarzynski Eq]\n\\label{R8}\n\n", "itemtype": "equation", "pos": 38939, "prevtext": "\nor equivalently\n\n\\begin{result}[Classical-Quantum Second Law Eq]\n\\label{R7}\nConsider a process that is microscopically reversible, conserves energy and is independent of the position of the weight. If the initial states of system and weight commute with the corresponding Hamiltonians then\n\n", "index": 61, "text": "\\begin{equation}\n  \\left\\langle\n  {\\mathrm{e}}^{\\beta F'_S}\n  {\\mathrm{e}}^{\\beta W} \n  {\\mathrm{e}}^{-\\beta F_S}\n  \\right\\rangle\n  =1\\ .  \n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E24.m1\" class=\"ltx_Math\" alttext=\"\\left\\langle{\\mathrm{e}}^{\\beta F^{\\prime}_{S}}{\\mathrm{e}}^{\\beta W}{\\mathrm{%&#10;e}}^{-\\beta F_{S}}\\right\\rangle=1\\ .\" display=\"block\"><mrow><mrow><mrow><mo>\u27e8</mo><mrow><msup><mi mathvariant=\"normal\">e</mi><mrow><mi>\u03b2</mi><mo>\u2062</mo><msubsup><mi>F</mi><mi>S</mi><mo>\u2032</mo></msubsup></mrow></msup><mo>\u2062</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mi>\u03b2</mi><mo>\u2062</mo><mi>W</mi></mrow></msup><mo>\u2062</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mo>-</mo><mrow><mi>\u03b2</mi><mo>\u2062</mo><msub><mi>F</mi><mi>S</mi></msub></mrow></mrow></msup></mrow><mo>\u27e9</mo></mrow><mo>=</mo><mpadded width=\"+5pt\"><mn>1</mn></mpadded></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\n\\end{result}\n\n\n\\section{A Quantum Crooks relation}\n\\label{sec:crooks}\n\nHere we use our techniques to prove a fully quantum version of the Crooks relation, which is related to that proven in \\cite{aberg2016fully} but on the weight and system.\nWe also derive a classical version, directly from our generalised Gibbs-stochasity relation, without the need to assume micro-reversibility.\n\nLike in~\\eqref{def Gamma SW}, we can also define the CPTP map associated to the inverse unitary \n\n", "itemtype": "equation", "pos": 39191, "prevtext": "\n\\end{result}\n\nIn the same way we have:\n\\begin{result}[Classical-Quantum Jarzynski Eq]\n\\label{R8}\n\n", "index": 63, "text": "\\begin{equation}\n  \\left\\langle\n  {\\mathrm{e}}^{\\beta (W -F_S)}\n  \\right\\rangle\n  = Z'_S\\ .  \n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E25.m1\" class=\"ltx_Math\" alttext=\"\\left\\langle{\\mathrm{e}}^{\\beta(W-F_{S})}\\right\\rangle=Z^{\\prime}_{S}\\ .\" display=\"block\"><mrow><mrow><mrow><mo>\u27e8</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mi>\u03b2</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>W</mi><mo>-</mo><msub><mi>F</mi><mi>S</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msup><mo>\u27e9</mo></mrow><mo>=</mo><mpadded width=\"+5pt\"><msubsup><mi>Z</mi><mi>S</mi><mo>\u2032</mo></msubsup></mpadded></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nLike any CP map, this can be written in Kraus form\n\n", "itemtype": "equation", "pos": 39781, "prevtext": "\n\\end{result}\n\n\n\\section{A Quantum Crooks relation}\n\\label{sec:crooks}\n\nHere we use our techniques to prove a fully quantum version of the Crooks relation, which is related to that proven in \\cite{aberg2016fully} but on the weight and system.\nWe also derive a classical version, directly from our generalised Gibbs-stochasity relation, without the need to assume micro-reversibility.\n\nLike in~\\eqref{def Gamma SW}, we can also define the CPTP map associated to the inverse unitary \n\n", "index": 65, "text": "\\begin{equation}\n  \\label{def Theta SW}\n  \\Theta_{SW} (\\rho_{SW}) =\n  {\\rm tr}_{B} \\!\n  \\left[U^\\dagger\n  \\left( \\rho_{SW} \\otimes \\frac {e^{-\\beta H_B}} {Z_B} \n  \\right) U \\right] .\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E26.m1\" class=\"ltx_Math\" alttext=\"\\Theta_{SW}(\\rho_{SW})={\\rm tr}_{B}\\!\\left[U^{\\dagger}\\left(\\rho_{SW}\\otimes%&#10;\\frac{e^{-\\beta H_{B}}}{Z_{B}}\\right)U\\right].\" display=\"block\"><mrow><mrow><mrow><msub><mi mathvariant=\"normal\">\u0398</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>W</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c1</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>W</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mpadded width=\"-1.7pt\"><msub><mi>tr</mi><mi>B</mi></msub></mpadded><mo>\u2062</mo><mrow><mo>[</mo><mrow><msup><mi>U</mi><mo>\u2020</mo></msup><mo>\u2062</mo><mrow><mo>(</mo><mrow><msub><mi>\u03c1</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>W</mi></mrow></msub><mo>\u2297</mo><mfrac><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi>\u03b2</mi><mo>\u2062</mo><msub><mi>H</mi><mi>B</mi></msub></mrow></mrow></msup><msub><mi>Z</mi><mi>B</mi></msub></mfrac></mrow><mo>)</mo></mrow><mo>\u2062</mo><mi>U</mi></mrow><mo>]</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nThe dual of a map is defined as\n\n", "itemtype": "equation", "pos": 40030, "prevtext": "\nLike any CP map, this can be written in Kraus form\n\n", "index": 67, "text": "\\begin{equation}\n  \\Theta_{SW} (\\rho_{SW}) =\n  \\sum_k A_k \\rho_{SW} A_k^\\dagger\\ .\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E27.m1\" class=\"ltx_Math\" alttext=\"\\Theta_{SW}(\\rho_{SW})=\\sum_{k}A_{k}\\rho_{SW}A_{k}^{\\dagger}\\ .\" display=\"block\"><mrow><mrow><mrow><msub><mi mathvariant=\"normal\">\u0398</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>W</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c1</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>W</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mi>k</mi></munder><mrow><msub><mi>A</mi><mi>k</mi></msub><mo>\u2062</mo><msub><mi>\u03c1</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>W</mi></mrow></msub><mo>\u2062</mo><mpadded width=\"+5pt\"><msubsup><mi>A</mi><mi>k</mi><mo>\u2020</mo></msubsup></mpadded></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nA bit of algebra shows that\n\n", "itemtype": "equation", "pos": 40160, "prevtext": "\nThe dual of a map is defined as\n\n", "index": 69, "text": "\\begin{equation}\n  \\Theta_{SW}^* (\\rho_{SW}) =\n  \\sum_k A_k^\\dagger \\rho_{SW} A_k\\ .\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E28.m1\" class=\"ltx_Math\" alttext=\"\\Theta_{SW}^{*}(\\rho_{SW})=\\sum_{k}A_{k}^{\\dagger}\\rho_{SW}A_{k}\\ .\" display=\"block\"><mrow><mrow><mrow><msubsup><mi mathvariant=\"normal\">\u0398</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>W</mi></mrow><mo>*</mo></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c1</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>W</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mi>k</mi></munder><mrow><msubsup><mi>A</mi><mi>k</mi><mo>\u2020</mo></msubsup><mo>\u2062</mo><msub><mi>\u03c1</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>W</mi></mrow></msub><mo>\u2062</mo><mpadded width=\"+5pt\"><msub><mi>A</mi><mi>k</mi></msub></mpadded></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nfrom which it follows\n\\begin{result}\nThe forward and backward maps, respectively $\\Gamma_{SW}$ and $\\Theta_{SW}$, are related via\n\n", "itemtype": "equation", "pos": 40288, "prevtext": "\nA bit of algebra shows that\n\n", "index": 71, "text": "\\begin{equation}\n\n  \\Theta_{SW}^* (\\rho_{SW}) =\n  {\\rm tr}_{B} \\!\n  \\left[\\frac {e^{-\\beta H_B}} {Z_B} U\n  \\left( \\rho_{SW} \\otimes {\\mathbb{1}}_B\n  \\right) U^\\dagger \\right] ,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E29.m1\" class=\"ltx_Math\" alttext=\"\\par&#10;\\Theta_{SW}^{*}(\\rho_{SW})={\\rm tr}_{B}\\!\\left[\\frac{e^{-\\beta H_{B}}}{Z_%&#10;{B}}U\\left(\\rho_{SW}\\otimes{\\mathbb{1}}_{B}\\right)U^{\\dagger}\\right],\" display=\"block\"><mrow><mrow><mrow><msubsup><mi mathvariant=\"normal\">\u0398</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>W</mi></mrow><mo>*</mo></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c1</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>W</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mpadded width=\"-1.7pt\"><msub><mi>tr</mi><mi>B</mi></msub></mpadded><mo>\u2062</mo><mrow><mo>[</mo><mrow><mfrac><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi>\u03b2</mi><mo>\u2062</mo><msub><mi>H</mi><mi>B</mi></msub></mrow></mrow></msup><msub><mi>Z</mi><mi>B</mi></msub></mfrac><mo>\u2062</mo><mi>U</mi><mo>\u2062</mo><mrow><mo>(</mo><mrow><msub><mi>\u03c1</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>W</mi></mrow></msub><mo>\u2297</mo><msub><mn>\ud835\udfd9</mn><mi>B</mi></msub></mrow><mo>)</mo></mrow><mo>\u2062</mo><msup><mi>U</mi><mo>\u2020</mo></msup></mrow><mo>]</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\n\\end{result}\n\nNote that using the classical version of generalised Gibbs-stochasity,\nResult~\\ref{re:CGS}, we \ncan define the map\n\n", "itemtype": "equation", "pos": 40610, "prevtext": "\nfrom which it follows\n\\begin{result}\nThe forward and backward maps, respectively $\\Gamma_{SW}$ and $\\Theta_{SW}$, are related via\n\n", "index": 73, "text": "\\begin{equation}\n  \\mathcal J_{H'_S+H_W} \\Gamma_{SW}\n  \\mathcal J_{H_S+H_W}^{-1/2}\n  =\n  \\Theta_{SW}^*\\ .\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E30.m1\" class=\"ltx_Math\" alttext=\"\\mathcal{J}_{H^{\\prime}_{S}+H_{W}}\\Gamma_{SW}\\mathcal{J}_{H_{S}+H_{W}}^{-1/2}=%&#10;\\Theta_{SW}^{*}\\ .\" display=\"block\"><mrow><mrow><mrow><msub><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca5</mi><mrow><msubsup><mi>H</mi><mi>S</mi><mo>\u2032</mo></msubsup><mo>+</mo><msub><mi>H</mi><mi>W</mi></msub></mrow></msub><mo>\u2062</mo><msub><mi mathvariant=\"normal\">\u0393</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>W</mi></mrow></msub><mo>\u2062</mo><msubsup><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca5</mi><mrow><msub><mi>H</mi><mi>S</mi></msub><mo>+</mo><msub><mi>H</mi><mi>W</mi></msub></mrow><mrow><mo>-</mo><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow></mrow></msubsup></mrow><mo>=</mo><mpadded width=\"+5pt\"><msubsup><mi mathvariant=\"normal\">\u0398</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>W</mi></mrow><mo>*</mo></msubsup></mpadded></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nOne can check that constraint~\\eqref{eqR4} applied to $P(s',w|s)$ is equivalent to the normalization of $P_{\\rm back} (s,w|s')$, and the normalization of $P(s',w|s)$ is equivalent to constraint~\\eqref{eqR4} applied to $P_{\\rm back} (s,w|s')$.  \nThis constraint implies that $P_{\\rm back} (s,w|s')$ is a thermal operations, hence, there is a global unitary generating this transformation. It can also be seen that one can use the unitary that is the inverse of the one that generates $P(s',w|s)$ (although other unitaries might also generate the same dynamics on system and weight).   \n$P_{\\rm back}(s,w|s')$ is thus the microscopic reverse of  $P(s',w|s)$. Indeed, defining the work obtained when going from one energy level to another, when the initial state is thermal \n$p_{\\rm forward}(w,s',s)=P(s',w|s)e^{-\\beta E_s}/Z$ and   \n$p_{\\rm back}(w,s',s)=P_{\\rm back}(s',w|s)e^{-\\beta E_s}/Z$ we obtain a Crooks relation\n\n", "itemtype": "equation", "pos": 40860, "prevtext": "\n\\end{result}\n\nNote that using the classical version of generalised Gibbs-stochasity,\nResult~\\ref{re:CGS}, we \ncan define the map\n\n", "index": 75, "text": "\\begin{equation}\n  P_{\\rm back} (s,w|s') = \n  P(s',-w|s)\\,\n  {\\mathrm{e}}^{\\beta (E_{s'} -E_s -w)}\n  \\ .\n\\label{eq:back}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E31.m1\" class=\"ltx_Math\" alttext=\"P_{\\rm back}(s,w|s^{\\prime})=P(s^{\\prime},-w|s)\\,{\\mathrm{e}}^{\\beta(E_{s^{%&#10;\\prime}}-E_{s}-w)}\\ .\" display=\"block\"><mrow><msub><mi>P</mi><mi>back</mi></msub><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>w</mi><mo stretchy=\"false\">|</mo><msup><mi>s</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo>=</mo><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>\u2032</mo></msup><mo>,</mo><mo>-</mo><mi>w</mi><mo stretchy=\"false\">|</mo><mi>s</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mpadded width=\"+5pt\"><msup><mi mathvariant=\"normal\">e</mi><mrow><mi>\u03b2</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>E</mi><msup><mi>s</mi><mo>\u2032</mo></msup></msub><mo>-</mo><msub><mi>E</mi><mi>s</mi></msub><mo>-</mo><mi>w</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msup></mpadded><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nwithout needing to assume microreversiblity. One can sum Equation \\eqref{eq:ccrooks} over $s$ and/or $s'$, with the right hand side not changing, to obtain the more standard Crooks relation\n\n", "itemtype": "equation", "pos": 41915, "prevtext": "\nOne can check that constraint~\\eqref{eqR4} applied to $P(s',w|s)$ is equivalent to the normalization of $P_{\\rm back} (s,w|s')$, and the normalization of $P(s',w|s)$ is equivalent to constraint~\\eqref{eqR4} applied to $P_{\\rm back} (s,w|s')$.  \nThis constraint implies that $P_{\\rm back} (s,w|s')$ is a thermal operations, hence, there is a global unitary generating this transformation. It can also be seen that one can use the unitary that is the inverse of the one that generates $P(s',w|s)$ (although other unitaries might also generate the same dynamics on system and weight).   \n$P_{\\rm back}(s,w|s')$ is thus the microscopic reverse of  $P(s',w|s)$. Indeed, defining the work obtained when going from one energy level to another, when the initial state is thermal \n$p_{\\rm forward}(w,s',s)=P(s',w|s)e^{-\\beta E_s}/Z$ and   \n$p_{\\rm back}(w,s',s)=P_{\\rm back}(s',w|s)e^{-\\beta E_s}/Z$ we obtain a Crooks relation\n\n", "index": 77, "text": "\\begin{align}\n\\frac{p_{\\rm forward}(w,s,s')}{p_{\\rm back}(w,s,s')}=e^{-\\beta (w -\\Delta F)}\n\\label{eq:ccrooks}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E32.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\frac{p_{\\rm forward}(w,s,s^{\\prime})}{p_{\\rm back}(w,s,s^{\\prime%&#10;})}=e^{-\\beta(w-\\Delta F)}\" display=\"inline\"><mrow><mstyle displaystyle=\"true\"><mfrac><mrow><msub><mi>p</mi><mi>forward</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>w</mi><mo>,</mo><mi>s</mi><mo>,</mo><msup><mi>s</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msub><mi>p</mi><mi>back</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>w</mi><mo>,</mo><mi>s</mi><mo>,</mo><msup><mi>s</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mstyle><mo>=</mo><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi>\u03b2</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>w</mi><mo>-</mo><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><mi>F</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></msup></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nbut  Equation \\eqref{eq:ccrooks} is clearly stronger.\n\n\n\\section{Conclusion}\nIn this paper we considered thermodynamical operations between a system, a thermal bath and a weight from which one can extract work in a probabilistic way. From a small set of physically motivated assumptions one can show that these operations obey an identity on arbitrary states from which a number of new, or more general equalities can easily be found. The equalities are both of a fully quantum and of a classical nature. One of these, the second law as an equality, is of a much stronger form\nthan the standard second law.\nFor example, the saturation of the second-law inequality\n\n", "itemtype": "equation", "pos": 42228, "prevtext": "\nwithout needing to assume microreversiblity. One can sum Equation \\eqref{eq:ccrooks} over $s$ and/or $s'$, with the right hand side not changing, to obtain the more standard Crooks relation\n\n", "index": 79, "text": "\\begin{align}\n\\frac{p_{\\rm forward}(w)}{p_{\\rm back}(w)}=e^{-\\beta (w -\\Delta F)}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E33.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\frac{p_{\\rm forward}(w)}{p_{\\rm back}(w)}=e^{-\\beta(w-\\Delta F)}\" display=\"inline\"><mrow><mstyle displaystyle=\"true\"><mfrac><mrow><msub><mi>p</mi><mi>forward</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>w</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msub><mi>p</mi><mi>back</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>w</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mstyle><mo>=</mo><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi>\u03b2</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>w</mi><mo>-</mo><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><mi>F</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></msup></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nimplies\n\n", "itemtype": "equation", "pos": 42986, "prevtext": "\nbut  Equation \\eqref{eq:ccrooks} is clearly stronger.\n\n\n\\section{Conclusion}\nIn this paper we considered thermodynamical operations between a system, a thermal bath and a weight from which one can extract work in a probabilistic way. From a small set of physically motivated assumptions one can show that these operations obey an identity on arbitrary states from which a number of new, or more general equalities can easily be found. The equalities are both of a fully quantum and of a classical nature. One of these, the second law as an equality, is of a much stronger form\nthan the standard second law.\nFor example, the saturation of the second-law inequality\n\n", "index": 81, "text": "\\begin{equation}\\label{eq:saturation}\n  \\left\\langle f_{s'} -f_s + w \\right\\rangle = 0\\ ,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E34.m1\" class=\"ltx_Math\" alttext=\"\\left\\langle f_{s^{\\prime}}-f_{s}+w\\right\\rangle=0\\ ,\" display=\"block\"><mrow><mrow><mrow><mo>\u27e8</mo><mrow><mrow><msub><mi>f</mi><msup><mi>s</mi><mo>\u2032</mo></msup></msub><mo>-</mo><msub><mi>f</mi><mi>s</mi></msub></mrow><mo>+</mo><mi>w</mi></mrow><mo>\u27e9</mo></mrow><mo>=</mo><mpadded width=\"+5pt\"><mn>0</mn></mpadded></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nThis regime is called \\emph{thermodynamically reversible}, \nand provides the optimal consumption or extraction of work when we take its average $\\langle w \\rangle$ as the figure of merit.\n\n\n\nOutside of the thermodynamically reversible regime, violations of\n\n", "itemtype": "equation", "pos": 43099, "prevtext": "\nimplies\n\n", "index": 83, "text": "\\begin{equation} \\label{eq:thermrev}\n  w = f_s -f_{s'}\\ \n  \\mbox{ for all } s,s'.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E35.m1\" class=\"ltx_Math\" alttext=\"w=f_{s}-f_{s^{\\prime}}\\ \\mbox{ for all }s,s^{\\prime}.\" display=\"block\"><mrow><mrow><mi>w</mi><mo>=</mo><mrow><mrow><msub><mi>f</mi><mi>s</mi></msub><mo>-</mo><mrow><mpadded width=\"+5pt\"><msub><mi>f</mi><msup><mi>s</mi><mo>\u2032</mo></msup></msub></mpadded><mo>\u2062</mo><mtext>\u00a0for all\u00a0</mtext><mo>\u2062</mo><mi>s</mi></mrow></mrow><mo>,</mo><msup><mi>s</mi><mo>\u2032</mo></msup></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nfor individual realizations of the process $(s,s',w)$ can happen. Defining the \\emph{excess} random variable $v = f_{s'} -f_s + w $, allows to write equality~\\eqref{2le3} as\n\n", "itemtype": "equation", "pos": 43453, "prevtext": "\nThis regime is called \\emph{thermodynamically reversible}, \nand provides the optimal consumption or extraction of work when we take its average $\\langle w \\rangle$ as the figure of merit.\n\n\n\nOutside of the thermodynamically reversible regime, violations of\n\n", "index": 85, "text": "\\begin{equation}\n  f_{s'} -f_s + w \n  \\leq 0\\ ,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E36.m1\" class=\"ltx_Math\" alttext=\"f_{s^{\\prime}}-f_{s}+w\\leq 0\\ ,\" display=\"block\"><mrow><mrow><mrow><mrow><msub><mi>f</mi><msup><mi>s</mi><mo>\u2032</mo></msup></msub><mo>-</mo><msub><mi>f</mi><mi>s</mi></msub></mrow><mo>+</mo><mi>w</mi></mrow><mo>\u2264</mo><mpadded width=\"+5pt\"><mn>0</mn></mpadded></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nRecalling that the exponential function gives more weight to the positive fluctuations as compared with the negative ones, we conclude that, outside of the thermodynamically  reversible regime, the negative fluctuations of $v$ must be larger and/or more frequent than the positive ones. In other words: \\emph{the violation of the second law is more rare than its satisfaction}. This asymmetry is also articulated by the infinite list of bounds for the moments of $v$ given in Eq. \\eqref{eq:infbounds}.\n\n\nNote that the Gibbs-stochasity condition gives more information than the Jarzynski equation or second law equality as the number of constraints it imposses is given by the dimension of the final system. In fact, each condition can \nbe thought of as a separate second law equality -- a situation which parallels the fact that one has many second laws for individual systems \\cite{horodecki2013fundamental,brandao2013second}. This is related to the fact that\nin the case with no weight, Gibbs-stochasity is related to these additional second laws (e.g. thermo-majorisation) \\cite{renes2014work}.\nAs a concrete and simple example of these conditions, let us take the case of Landauer erasure \\cite{Landauer}.  We consider a qubit with $H_S=0$ and initially in the maximally mixed state and we want\nto map it to the ${|{0}\\rangle}$ state.  Recalling that positive work represents a yield, while negative work is a cost, we consider a process such that $-w_0$ is the work cost  when erasing ${|{0}\\rangle}\\rightarrow {|{0}\\rangle}$, \nand $-w_1$ the work cost if the transition ${|{1}\\rangle}\\rightarrow {|{0}\\rangle}$ occurs. \nWe allow for an imperfect process and imagine\nthat this erasure process happens with probability $1-\\epsilon$, while with probability $\\epsilon$ we have an error  ${|{0}\\rangle}\\rightarrow {|{1}\\rangle}$ with work yield $\\bar{w}_0$ or  \n${|{1}\\rangle}\\rightarrow {|{1}\\rangle}$ with work yield $\\bar{w}_1$. We call such a process {\\it deterministic}, because $w$ is determined by the particular transition.\n\n\nThen the Generalised Gibbs-stochastic condition, Equation~(\\ref{eq:gibbs-stoch-qc}) gives two conditions\n\n", "itemtype": "equation", "pos": 43690, "prevtext": "\nfor individual realizations of the process $(s,s',w)$ can happen. Defining the \\emph{excess} random variable $v = f_{s'} -f_s + w $, allows to write equality~\\eqref{2le3} as\n\n", "index": 87, "text": "\\begin{equation}\n  \\label{2le2}\n  \\left\\langle {\\mathrm{e}}^{\\beta v} \\right\\rangle = 1\\ .\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E37.m1\" class=\"ltx_Math\" alttext=\"\\left\\langle{\\mathrm{e}}^{\\beta v}\\right\\rangle=1\\ .\" display=\"block\"><mrow><mrow><mrow><mo>\u27e8</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mi>\u03b2</mi><mo>\u2062</mo><mi>v</mi></mrow></msup><mo>\u27e9</mo></mrow><mo>=</mo><mpadded width=\"+5pt\"><mn>1</mn></mpadded></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05799.tex", "nexttext": "\nWe immediately see that to obtain perfect erasure $\\epsilon\\rightarrow 0$, when the erasure fails there must be work fluctuations which scales like $-kT\\log \\epsilon$. Such a work gain happens rarely, but precludes\nperfect erasure, and is related to the third law proven in \\cite{masanes2014derivation} and is discussed in detail in \\cite{RM2016fluct}. In the limit of perfect erasure\nwe illustrate the work fluctuations in Fig. \\ref{fig:1bitCGS}. \n\n\n\\begin{figure}\n\\centering\n\\includegraphics[width=1\\columnwidth]{CGSPlots}\n\\caption{ As a simple example of the second law equality, one can think of single qubit erasure. In the limit of perfect erasure, the 2nd law equality reads in this case $e^{\\beta w_0}+e^{\\beta w_1}=1$, and the average work spent is $\\langle w \\rangle =\\frac{1}{2}(w_0+w_1)$. In the figure, we show the tradeoff between $w_0$ and $\\langle w \\rangle $. The optimal work value for erasure is the usual Landauer cost at $w_0=w_1=-kT \\log{2}$. Near-perfect erasure requires the work cost to fluctuate arbitrarily.\n } \\label{fig:1bitCGS}\n\\end{figure}\n\nWe easily see that the minimal average work cost of erasure $kT\\log 2$ is obtained when the work fluctuations are minimal. We also see that no work, not even probabilistically, can be obtained in such a deterministic process.\nSince  Equation \\eqref{eq:gibbs-stoch-qc} is not only necessary but also sufficient, we can achieve these work distributions just through the very simple operations described in~\\cite{perry2015sufficient}. \nOne sees that the identities proven here can lead to new insights in thermodynamics, particularly with respect to work fluctuations and their quantum aspects.\n\n \\noindent\n{\\bf Acknowledgements:} We would like to thank Gavin Crooks for interesting comments on v1 of this paper.  We are grateful to the EPSRC and Royal Society for support.\n\n\\bibliographystyle{apsrev4-1}\n\\bibliography{References,common/refthermo,common/work,common/refjono2,common/rmp12,common/refgrav2,common/thermo_IC,common/NoncommutingRefsv2}\n\n\n", "itemtype": "equation", "pos": 45936, "prevtext": "\nRecalling that the exponential function gives more weight to the positive fluctuations as compared with the negative ones, we conclude that, outside of the thermodynamically  reversible regime, the negative fluctuations of $v$ must be larger and/or more frequent than the positive ones. In other words: \\emph{the violation of the second law is more rare than its satisfaction}. This asymmetry is also articulated by the infinite list of bounds for the moments of $v$ given in Eq. \\eqref{eq:infbounds}.\n\n\nNote that the Gibbs-stochasity condition gives more information than the Jarzynski equation or second law equality as the number of constraints it imposses is given by the dimension of the final system. In fact, each condition can \nbe thought of as a separate second law equality -- a situation which parallels the fact that one has many second laws for individual systems \\cite{horodecki2013fundamental,brandao2013second}. This is related to the fact that\nin the case with no weight, Gibbs-stochasity is related to these additional second laws (e.g. thermo-majorisation) \\cite{renes2014work}.\nAs a concrete and simple example of these conditions, let us take the case of Landauer erasure \\cite{Landauer}.  We consider a qubit with $H_S=0$ and initially in the maximally mixed state and we want\nto map it to the ${|{0}\\rangle}$ state.  Recalling that positive work represents a yield, while negative work is a cost, we consider a process such that $-w_0$ is the work cost  when erasing ${|{0}\\rangle}\\rightarrow {|{0}\\rangle}$, \nand $-w_1$ the work cost if the transition ${|{1}\\rangle}\\rightarrow {|{0}\\rangle}$ occurs. \nWe allow for an imperfect process and imagine\nthat this erasure process happens with probability $1-\\epsilon$, while with probability $\\epsilon$ we have an error  ${|{0}\\rangle}\\rightarrow {|{1}\\rangle}$ with work yield $\\bar{w}_0$ or  \n${|{1}\\rangle}\\rightarrow {|{1}\\rangle}$ with work yield $\\bar{w}_1$. We call such a process {\\it deterministic}, because $w$ is determined by the particular transition.\n\n\nThen the Generalised Gibbs-stochastic condition, Equation~(\\ref{eq:gibbs-stoch-qc}) gives two conditions\n\n", "index": 89, "text": "\\begin{align}\ne^{\\beta w_o}+e^{\\beta w_1}&=1/(1-\\epsilon)\n\\\\\ne^{\\beta \\bar{w}_o}+e^{\\beta \\bar{w}_1}&=1/\\epsilon\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E38.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle e^{\\beta w_{o}}+e^{\\beta w_{1}}\" display=\"inline\"><mrow><msup><mi>e</mi><mrow><mi>\u03b2</mi><mo>\u2062</mo><msub><mi>w</mi><mi>o</mi></msub></mrow></msup><mo>+</mo><msup><mi>e</mi><mrow><mi>\u03b2</mi><mo>\u2062</mo><msub><mi>w</mi><mn>1</mn></msub></mrow></msup></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E38.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=1/(1-\\epsilon)\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mn>1</mn><mo>/</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>-</mo><mi>\u03f5</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E39.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle e^{\\beta\\bar{w}_{o}}+e^{\\beta\\bar{w}_{1}}\" display=\"inline\"><mrow><msup><mi>e</mi><mrow><mi>\u03b2</mi><mo>\u2062</mo><msub><mover accent=\"true\"><mi>w</mi><mo stretchy=\"false\">\u00af</mo></mover><mi>o</mi></msub></mrow></msup><mo>+</mo><msup><mi>e</mi><mrow><mi>\u03b2</mi><mo>\u2062</mo><msub><mover accent=\"true\"><mi>w</mi><mo stretchy=\"false\">\u00af</mo></mover><mn>1</mn></msub></mrow></msup></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E39.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=1/\\epsilon\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mn>1</mn><mo>/</mo><mi>\u03f5</mi></mrow></mrow></math>", "type": "latex"}]