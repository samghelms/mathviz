[{"file": "1601.05448.tex", "nexttext": "\n\n\n", "itemtype": "equation", "pos": 3843, "prevtext": "\n\\maketitle\n\n\n\n\\section{Motivation and objectives}\n\\label{sec:intro}\n\nVariable density flows are ubiquitous in a variety of natural and industrial systems. Multi-phase flows in natural and industrial processes, astrophysical flows, and flows involved in combustion processes are such examples. For an ideal gas subject to low-Mach approximation, variations in temperature can lead to a non-uniform density field. In this work, we consider radiatively heated particle-laden turbulent flows. We have developed a parallel C++/MPI-based simulation code for variable-density particle-laden turbulent flows (which can be downloaded from \\url{https://hadip@bitbucket.org/hadip/soleilmpi}). The code is modular, abstracted, and can be easily extended or modified.\n\nWe were able to reproduce well-known phenomena such as particle preferential concentration \\citep{eaton1994preferential}, preferential sweeping \\citep{wang1993settling}, turbulence modification due to momentum two-way coupling \\citep{squires1990particle, elghobashi1993two}, as well as canonical problems such as the Taylor-Green vortices and the decay of homogeneous isotropic turbulence.\n\nThis code is also able to simulate variable-density flows. Therefore, we were able to study the effect of radiation on the system. We reproduced one of our previous results, using a different code assuming constant density and Boussinesq approximation, on radiation-induced turbulence \\citep{zamansky2014radiation}. We also reproduced the results of the homogeneous buoyancy-driven turbulence \\citep{batchelor1992homogeneous}, where the Boussinesq approximation is relaxed. Moreover, using the Lagrangian-Eulerian capabilities of the code, many new physics have been studied by different researchers. These include spectral analysis of the energy transfer between different phases \\citep{pouransari2014spectral}, subgrid-scale modeling of particle-laden flows \\citep{urzaycharacteristic}, settling of heated inertial particles in turbulent flows \\citep{frankel2014settling}, and comparisons between Lagrangian and Eulerian methods for particle simulation subject to radiation \\citep{vie2015particle}.\n\nThis code is developed to simulate a particle-laden turbulent flow subject to radiation. Each of these three elements can be removed from the calculation. In the simplest case, the code can be used as a homogeneous isotropic turbulence (HIT) simulator. We implemented two different geometrical configurations as explained in section \\ref{sec:bound}.\n\nParticles are simulated using a point-particle Lagrangian framework. Particles are two-way coupled with fluid momentum and energy equations using linear interpolation and projection. The fluid is represented through a uniform Eulerian staggered grid. Spatial discretization is second-order accurate, and time integration has a fourth-order accuracy. The fluid is assumed to be optically transparent. However, particles can be heated with an external radiation source. Hot particles can conductively heat their surrounding fluid. Therefore, the fluid density field is variable. This leads to a variable coefficient Poisson equation for hydrodynamic pressure of the flow. We have developed a novel parallel linear solver for the variable density Poisson equation that arises in the calculation. Governing equations and numerical methods are explained in sections \\ref{sec:model} and \\ref{sec:numerics}, respectively.\n\n\n\n\\section{Physical model}\n\\label{sec:model}\nIn this section we provide a set of equations for the background flow and particles that are solved in the code. The primary variables for the flow are density ($\\rho$), momentum ($\\rho {u_f}_i$), and temperature ($T_f$), and those for particles are location ($x_p$), velocity (${u_p}_i$), and temperature ($T_p$).\n\nMass and momentum conservation equations for gas are as follows\n\n\n", "index": 1, "text": "\\begin{equation} \\label{eqn:COM}\n\\frac{\\partial \\rho}{\\partial t}+\\frac{\\partial}{\\partial x_j}(\\rho {u_f}_j)=0,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"\\frac{\\partial\\rho}{\\partial t}+\\frac{\\partial}{\\partial x_{j}}(\\rho{u_{f}}_{j%&#10;})=0,\" display=\"block\"><mrow><mrow><mrow><mfrac><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>\u03c1</mi></mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>t</mi></mrow></mfrac><mo>+</mo><mrow><mfrac><mo>\u2202</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03c1</mi><mo>\u2062</mo><mmultiscripts><mi>u</mi><mi>f</mi><none/><mi>j</mi><none/></mmultiscripts></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>=</mo><mn>0</mn></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05448.tex", "nexttext": "\nThe last term in Eq. (\\ref{eqn:NS}) represents the momentum transfer from the particles to the fluid.\nThe operator $\\mathcal{P}$ projects data from particle location to the fluid grid(per unit volume). $\\mathcal{I}$ represents interpolation from the Eulerian grid to a particle location. In the current version of the code, both $\\mathcal{P}$ and $\\mathcal{I}$ are implemented using a linear approximation.\nThe term $A \\rho {u_f}_i$ corresponds to the linear forcing \\citep{rosales2005linear}. $g_i$ in $g_i (\\rho - \\rho_0)$ is the gravitational acceleration in the $i^{\\mbox{th}}$ direction after subtracting the static pressure. Last three terms in Eq. (\\ref{eqn:NS}) can be switched on/off for different calculations. $\\tau_p$ is the particle inertial relaxation time.\n\nConservation of energy for the gas phase is described by the following equation\n\n\n", "itemtype": "equation", "pos": 3972, "prevtext": "\n\n\n", "index": 3, "text": "\\begin{multline} \\label{eqn:NS}\n\\frac{\\partial} {\\partial t}(\\rho {u_f}_i)+\\frac{\\partial}{\\partial x_j}(\\rho {u_f}_i {u_f}_j)=-\\frac{\\partial p}{\\partial x_i}+\\mu\\frac{\\partial}{\\partial x_j}\\left(\\frac{\\partial {u_f}_i}{\\partial x_j} +\\frac{\\partial {u_f}_j}{\\partial x_i} -\\frac{2}{3}\\frac{\\partial {u_f}_k}{\\partial x_k}\\delta_{ij}\\right) \\\\\n+ A \\rho {u_f}_i + g_i (\\rho - \\rho_0) + {\\cal{P}}\\left( \\frac{{u_p}_i- {\\cal{I}}({u_f}_i) } { \\tau_p } \\right).\n\\end{multline}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\frac{\\partial}{\\partial t}(\\rho{u_{f}}_{i})+\\frac{\\partial}{%&#10;\\partial x_{j}}(\\rho{u_{f}}_{i}{u_{f}}_{j})=-\\frac{\\partial p}{\\partial x_{i}}%&#10;+\\mu\\frac{\\partial}{\\partial x_{j}}\\left(\\frac{\\partial{u_{f}}_{i}}{\\partial x%&#10;_{j}}+\\frac{\\partial{u_{f}}_{j}}{\\partial x_{i}}-\\frac{2}{3}\\frac{\\partial{u_{%&#10;f}}_{k}}{\\partial x_{k}}\\delta_{ij}\\right)\\\\&#10;\\displaystyle+A\\rho{u_{f}}_{i}+g_{i}(\\rho-\\rho_{0})+{\\cal{P}}\\left(\\frac{{u_{p%&#10;}}_{i}-{\\cal{I}}({u_{f}}_{i})}{\\tau_{p}}\\right).\" display=\"block\"><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><mrow><mrow><mfrac><mo>\u2202</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>t</mi></mrow></mfrac><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03c1</mi><mo>\u2062</mo><mmultiscripts><mi>u</mi><mi>f</mi><none/><mi>i</mi><none/></mmultiscripts></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mfrac><mo>\u2202</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03c1</mi><mo>\u2062</mo><mmultiscripts><mi>u</mi><mi>f</mi><none/><mi>i</mi><none/></mmultiscripts><mo>\u2062</mo><mmultiscripts><mi>u</mi><mi>f</mi><none/><mi>j</mi><none/></mmultiscripts></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>=</mo><mrow><mrow><mo>-</mo><mfrac><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>p</mi></mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mrow><mo>+</mo><mrow><mi>\u03bc</mi><mo>\u2062</mo><mfrac><mo>\u2202</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>\u2062</mo><mrow><mo>(</mo><mrow><mrow><mfrac><mrow><mo>\u2202</mo><mo>\u2061</mo><mmultiscripts><mi>u</mi><mi>f</mi><none/><mi>i</mi><none/></mmultiscripts></mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mo>\u2202</mo><mo>\u2061</mo><mmultiscripts><mi>u</mi><mi>f</mi><none/><mi>j</mi><none/></mmultiscripts></mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mrow><mo>-</mo><mrow><mfrac><mn>2</mn><mn>3</mn></mfrac><mo>\u2062</mo><mfrac><mrow><mo>\u2202</mo><mo>\u2061</mo><mmultiscripts><mi>u</mi><mi>f</mi><none/><mi>k</mi><none/></mmultiscripts></mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><msub><mi>x</mi><mi>k</mi></msub></mrow></mfrac><mo>\u2062</mo><msub><mi>\u03b4</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub></mrow></mrow><mo>)</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mrow><mrow><mrow><mo>+</mo><mrow><mi>A</mi><mo>\u2062</mo><mi>\u03c1</mi><mo>\u2062</mo><mmultiscripts><mi>u</mi><mi>f</mi><none/><mi>i</mi><none/></mmultiscripts></mrow></mrow><mo>+</mo><mrow><msub><mi>g</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03c1</mi><mo>-</mo><msub><mi>\u03c1</mi><mn>0</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcab</mi><mo>\u2062</mo><mrow><mo>(</mo><mfrac><mrow><mmultiscripts><mi>u</mi><mi>p</mi><none/><mi>i</mi><none/></mmultiscripts><mo>-</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\u2110</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mmultiscripts><mi>u</mi><mi>f</mi><none/><mi>i</mi><none/></mmultiscripts><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><msub><mi>\u03c4</mi><mi>p</mi></msub></mfrac><mo>)</mo></mrow></mrow></mrow><mo>.</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.05448.tex", "nexttext": "\nThe last term in Eq. (\\ref{eqn:GEE}) represents the heat transfer from particles to the fluid. $D_p$ is the particle diameter, and $k$ is the gas thermal conductivity coefficient.\n\nThe thermodynamics of the system is governed by the ideal gas equation of state $\\rho R T_f =P_0$, where $P_0$ is the thermodynamic pressure.\nSpatial pressure variation in the equation of state is neglected. This is justified by the low-Mach assumption.\n\nA point-particle Lagrangian framework is used for particles; therefore, particle location is governed by the following equation\n\n\n", "itemtype": "equation", "pos": 5300, "prevtext": "\nThe last term in Eq. (\\ref{eqn:NS}) represents the momentum transfer from the particles to the fluid.\nThe operator $\\mathcal{P}$ projects data from particle location to the fluid grid(per unit volume). $\\mathcal{I}$ represents interpolation from the Eulerian grid to a particle location. In the current version of the code, both $\\mathcal{P}$ and $\\mathcal{I}$ are implemented using a linear approximation.\nThe term $A \\rho {u_f}_i$ corresponds to the linear forcing \\citep{rosales2005linear}. $g_i$ in $g_i (\\rho - \\rho_0)$ is the gravitational acceleration in the $i^{\\mbox{th}}$ direction after subtracting the static pressure. Last three terms in Eq. (\\ref{eqn:NS}) can be switched on/off for different calculations. $\\tau_p$ is the particle inertial relaxation time.\n\nConservation of energy for the gas phase is described by the following equation\n\n\n", "index": 5, "text": "\\begin{equation} \\label{eqn:GEE}\n\\frac{\\partial}{\\partial t} (\\rho C_v T_f)+\\frac{\\partial}{\\partial x_j}(\\rho C_p T_f {u_f}_j)=k \\frac{\\partial^2 T_f}{\\partial x_j \\partial x_j}+{\\cal{P}}\\left(2\\pi D_p k \\left(T_p- {\\cal{I}}(T_f)\\right)\\right).\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"\\frac{\\partial}{\\partial t}(\\rho C_{v}T_{f})+\\frac{\\partial}{\\partial x_{j}}(%&#10;\\rho C_{p}T_{f}{u_{f}}_{j})=k\\frac{\\partial^{2}T_{f}}{\\partial x_{j}\\partial x%&#10;_{j}}+{\\cal{P}}\\left(2\\pi D_{p}k\\left(T_{p}-{\\cal{I}}(T_{f})\\right)\\right).\" display=\"block\"><mrow><mrow><mrow><mrow><mfrac><mo>\u2202</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>t</mi></mrow></mfrac><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03c1</mi><mo>\u2062</mo><msub><mi>C</mi><mi>v</mi></msub><mo>\u2062</mo><msub><mi>T</mi><mi>f</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mfrac><mo>\u2202</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03c1</mi><mo>\u2062</mo><msub><mi>C</mi><mi>p</mi></msub><mo>\u2062</mo><msub><mi>T</mi><mi>f</mi></msub><mo>\u2062</mo><mmultiscripts><mi>u</mi><mi>f</mi><none/><mi>j</mi><none/></mmultiscripts></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>=</mo><mrow><mrow><mi>k</mi><mo>\u2062</mo><mfrac><mrow><msup><mo>\u2202</mo><mn>2</mn></msup><mo>\u2061</mo><msub><mi>T</mi><mi>f</mi></msub></mrow><mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><msub><mi>x</mi><mi>j</mi></msub></mrow><mo>\u2062</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><msub><mi>x</mi><mi>j</mi></msub></mrow></mrow></mfrac></mrow><mo>+</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcab</mi><mo>\u2062</mo><mrow><mo>(</mo><mrow><mn>2</mn><mo>\u2062</mo><mi>\u03c0</mi><mo>\u2062</mo><msub><mi>D</mi><mi>p</mi></msub><mo>\u2062</mo><mi>k</mi><mo>\u2062</mo><mrow><mo>(</mo><mrow><msub><mi>T</mi><mi>p</mi></msub><mo>-</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\u2110</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>T</mi><mi>f</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05448.tex", "nexttext": "\nSpherical particles with a small particle Reynolds number based on the slip velocity in a dilute mixture are considered.\nAssuming a large density ratio $\\rho_p/\\rho_f\\gg1$ and particle diameter smaller than the Kolmogorov length scale, the Stokes drag is the most important force on the particles \\citep{maxey1983equation}. Hence, the dynamics of the particles is governed by the following equation\n\n\n", "itemtype": "equation", "pos": 6126, "prevtext": "\nThe last term in Eq. (\\ref{eqn:GEE}) represents the heat transfer from particles to the fluid. $D_p$ is the particle diameter, and $k$ is the gas thermal conductivity coefficient.\n\nThe thermodynamics of the system is governed by the ideal gas equation of state $\\rho R T_f =P_0$, where $P_0$ is the thermodynamic pressure.\nSpatial pressure variation in the equation of state is neglected. This is justified by the low-Mach assumption.\n\nA point-particle Lagrangian framework is used for particles; therefore, particle location is governed by the following equation\n\n\n", "index": 7, "text": "\\begin{equation} \\label{eqn:KIN}\n\\frac{d {x_p}_i}{dt} = {u_p}_i.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"\\frac{d{x_{p}}_{i}}{dt}={u_{p}}_{i}.\" display=\"block\"><mrow><mrow><mfrac><mrow><mi>d</mi><mo>\u2062</mo><mmultiscripts><mi>x</mi><mi>p</mi><none/><mi>i</mi><none/></mmultiscripts></mrow><mrow><mi>d</mi><mo>\u2062</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mmultiscripts><mi>u</mi><mi>p</mi><none/><mi>i</mi><none/></mmultiscripts></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05448.tex", "nexttext": "\n\nThe following equation describes the conservation of energy for each particle;\n\n\n", "itemtype": "equation", "pos": 6606, "prevtext": "\nSpherical particles with a small particle Reynolds number based on the slip velocity in a dilute mixture are considered.\nAssuming a large density ratio $\\rho_p/\\rho_f\\gg1$ and particle diameter smaller than the Kolmogorov length scale, the Stokes drag is the most important force on the particles \\citep{maxey1983equation}. Hence, the dynamics of the particles is governed by the following equation\n\n\n", "index": 9, "text": "\\begin{equation} \\label{eqn:DYN}\n\\frac{d {u_p}_i}{dt}=-\\frac{{u_p}_i- {\\cal{I}}({u_f}_i) } { \\tau_p }.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"\\frac{d{u_{p}}_{i}}{dt}=-\\frac{{u_{p}}_{i}-{\\cal{I}}({u_{f}}_{i})}{\\tau_{p}}.\" display=\"block\"><mrow><mrow><mfrac><mrow><mi>d</mi><mo>\u2062</mo><mmultiscripts><mi>u</mi><mi>p</mi><none/><mi>i</mi><none/></mmultiscripts></mrow><mrow><mi>d</mi><mo>\u2062</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mrow><mo>-</mo><mfrac><mrow><mmultiscripts><mi>u</mi><mi>p</mi><none/><mi>i</mi><none/></mmultiscripts><mo>-</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\u2110</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mmultiscripts><mi>u</mi><mi>f</mi><none/><mi>i</mi><none/></mmultiscripts><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><msub><mi>\u03c4</mi><mi>p</mi></msub></mfrac></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05448.tex", "nexttext": "\nIn the above equation, $m_p = \\rho_p \\pi D_p^3 /6$ and ${C_v}_p$ are, respectively, particle mass and heat capacity. The first term in the right-hand side of Eq. (\\ref{eqn:PEE}) is the heat absorption by a particle with emissivity $\\epsilon_p$ in an optically thin medium with uniform radiation intensity $I$. The second term represents heat transfer to the fluid.\n\n\n\n\\section{Numerics} \\label{sec:numerics}\n\\subsection{Spatial discretization} \\label{sec:disc}\nWe have used a uniform three-dimensional staggered grid for the fluid in this code. A sketch of a two-dimensional uniform staggered grid is shown in Figure \\ref{fig:SCHEMATIC}.\n\\begin{figure}\n\t\\centering\n  \\includegraphics[width=0.6\\textwidth]{stag.eps}\n  \\caption{An illustration of a 2D uniform staggered grid, with momentum stored on cell faces, and scalar quantities at cell centers.}\n\\label{fig:SCHEMATIC}\n\\end{figure}\nOur discretization preserves the total mass, momentum, and kinetic energy. Therefore, for an inviscid flow, we enforce to conserve the total kinetic energy, as shown in Figure \\ref{fig:cons}. The details of the energy conservative numerical method used in the code are explained in appendix \\ref{sec:appB}.\n\n\\begin{figure}\n\\centerline{\\includegraphics[width = 0.9 \\textwidth]{TKE_inviscid.eps}}\n\\caption{\\label{fig:cons}Conservation of the total kinetic energy for an inviscid calculation. Note that energy is being transferred from different components of the velocity, while the total kinetic energy is preserved.}\n\\end{figure}\n\n\\subsection{Boundary and initial conditions} \\label{sec:bound}\nThis code supports two different configurations: 1) Triply periodic, which is a box with periodic boundary conditions (BC) in all directions. 2) Inflow-outflow, which is a duct with periodic BC in the $y-z$ plane, and convective BC in the $x$ direction\n\n", "itemtype": "equation", "pos": 6805, "prevtext": "\n\nThe following equation describes the conservation of energy for each particle;\n\n\n", "index": 11, "text": "\\begin{equation} \\label{eqn:PEE}\n\\frac{d}{dt} (m_p {C_v}_p T_p) = \\frac{1}{4}\\pi D_p^2 I \\epsilon_p - 2\\pi D_p k (T_p - {\\cal{I}}(T_f)).\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"\\frac{d}{dt}(m_{p}{C_{v}}_{p}T_{p})=\\frac{1}{4}\\pi D_{p}^{2}I\\epsilon_{p}-2\\pi&#10;D%&#10;_{p}k(T_{p}-{\\cal{I}}(T_{f})).\" display=\"block\"><mrow><mrow><mrow><mfrac><mi>d</mi><mrow><mi>d</mi><mo>\u2062</mo><mi>t</mi></mrow></mfrac><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>m</mi><mi>p</mi></msub><mo>\u2062</mo><mmultiscripts><mi>C</mi><mi>v</mi><none/><mi>p</mi><none/></mmultiscripts><mo>\u2062</mo><msub><mi>T</mi><mi>p</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mfrac><mn>1</mn><mn>4</mn></mfrac><mo>\u2062</mo><mi>\u03c0</mi><mo>\u2062</mo><msubsup><mi>D</mi><mi>p</mi><mn>2</mn></msubsup><mo>\u2062</mo><mi>I</mi><mo>\u2062</mo><msub><mi>\u03f5</mi><mi>p</mi></msub></mrow><mo>-</mo><mrow><mn>2</mn><mo>\u2062</mo><mi>\u03c0</mi><mo>\u2062</mo><msub><mi>D</mi><mi>p</mi></msub><mo>\u2062</mo><mi>k</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>T</mi><mi>p</mi></msub><mo>-</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\u2110</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>T</mi><mi>f</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05448.tex", "nexttext": "\n\nThe inflow comes from an HIT simulation, sustained with linear forcing, which is running simultaneously with the duct simulation. At each time-step, the last slice of the HIT simulation is being copied to the first slice of the inflow-outflow simulation. The computational domain is shown in Figure \\ref{fig:DOMAIN}.\n\\begin{figure}\n\\centerline{\\includegraphics[width = 0.9 \\textwidth]{domain.eps}}\n\\caption{\\label{fig:DOMAIN}Inflow-outflow computational domain. Left: the triply periodic box used as a turbulence generator for the inflow-outflow domain (right). Particle concentration is shown on the sides of the box, and the bottom side of the inflow-outflow domain. Gas density contours are shown on the rear side of the inflow-outflow domain.}\n\\end{figure}\n\nThe code accepts various initial conditions for particles and flow. In particular, we have provided a script to generate initial turbulence using a Passot-Pouquet spectrum \\citep{passot1987numerical}.\n\n\\subsection{Time advancement} \\label{sec:time}\nThe time integration is performed using a fourth-order Runge Kutta (RK4) scheme for both particles and the flow. We first solve for momentum without considering the pressure gradient term. Using the divergence implied by the energy equation (note that the flow filed is not divergence free when radiation is on), we solve the variable coefficient Poisson equation and correct the fluid momentum field. The energy equation involves an energy transfer term between particles and fluid. Therefore, in order to accurately calculate the divergence condition for the fluid pressure, we need to have energy transfer from particles at the next substep before solving the Poisson equation. In other words, at each step the right-hand side of the particle energy equation is calculated at the next substep. However, the right-hand sides of all other equations are evaluated at the current substep. Details of the numerical scheme are explained in appendix \\ref{sec:appA}.\n\n\\subsection{Poisson equation} \\label{sec:Poisson}\nSolving for a variable density flow requires solving a variable coefficient Poisson equation for the hydrodynamic pressure as follows\n\n", "itemtype": "equation", "pos": 8789, "prevtext": "\nIn the above equation, $m_p = \\rho_p \\pi D_p^3 /6$ and ${C_v}_p$ are, respectively, particle mass and heat capacity. The first term in the right-hand side of Eq. (\\ref{eqn:PEE}) is the heat absorption by a particle with emissivity $\\epsilon_p$ in an optically thin medium with uniform radiation intensity $I$. The second term represents heat transfer to the fluid.\n\n\n\n\\section{Numerics} \\label{sec:numerics}\n\\subsection{Spatial discretization} \\label{sec:disc}\nWe have used a uniform three-dimensional staggered grid for the fluid in this code. A sketch of a two-dimensional uniform staggered grid is shown in Figure \\ref{fig:SCHEMATIC}.\n\\begin{figure}\n\t\\centering\n  \\includegraphics[width=0.6\\textwidth]{stag.eps}\n  \\caption{An illustration of a 2D uniform staggered grid, with momentum stored on cell faces, and scalar quantities at cell centers.}\n\\label{fig:SCHEMATIC}\n\\end{figure}\nOur discretization preserves the total mass, momentum, and kinetic energy. Therefore, for an inviscid flow, we enforce to conserve the total kinetic energy, as shown in Figure \\ref{fig:cons}. The details of the energy conservative numerical method used in the code are explained in appendix \\ref{sec:appB}.\n\n\\begin{figure}\n\\centerline{\\includegraphics[width = 0.9 \\textwidth]{TKE_inviscid.eps}}\n\\caption{\\label{fig:cons}Conservation of the total kinetic energy for an inviscid calculation. Note that energy is being transferred from different components of the velocity, while the total kinetic energy is preserved.}\n\\end{figure}\n\n\\subsection{Boundary and initial conditions} \\label{sec:bound}\nThis code supports two different configurations: 1) Triply periodic, which is a box with periodic boundary conditions (BC) in all directions. 2) Inflow-outflow, which is a duct with periodic BC in the $y-z$ plane, and convective BC in the $x$ direction\n\n", "index": 13, "text": "\\begin{equation}\n\\label{eqn:convBC}\n\\frac{\\partial}{\\partial t} (.)+U_x \\frac{\\partial}{\\partial x} (.)=0.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"\\frac{\\partial}{\\partial t}(.)+U_{x}\\frac{\\partial}{\\partial x}(.)=0.\" display=\"block\"><mrow><mfrac><mo>\u2202</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>t</mi></mrow></mfrac><mrow><mo stretchy=\"false\">(</mo><mo>.</mo><mo stretchy=\"false\">)</mo></mrow><mo>+</mo><msub><mi>U</mi><mi>x</mi></msub><mfrac><mo>\u2202</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>x</mi></mrow></mfrac><mrow><mo stretchy=\"false\">(</mo><mo>.</mo><mo stretchy=\"false\">)</mo></mrow><mo>=</mo><mn>0</mn><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05448.tex", "nexttext": "\nwhere $f$ is determined using the energy equation. Consider $p = p_g + \\delta p$, where $p_g$ is our estimated value from the previous step. Then the above equation can be re-written as\n\n", "itemtype": "equation", "pos": 11070, "prevtext": "\n\nThe inflow comes from an HIT simulation, sustained with linear forcing, which is running simultaneously with the duct simulation. At each time-step, the last slice of the HIT simulation is being copied to the first slice of the inflow-outflow simulation. The computational domain is shown in Figure \\ref{fig:DOMAIN}.\n\\begin{figure}\n\\centerline{\\includegraphics[width = 0.9 \\textwidth]{domain.eps}}\n\\caption{\\label{fig:DOMAIN}Inflow-outflow computational domain. Left: the triply periodic box used as a turbulence generator for the inflow-outflow domain (right). Particle concentration is shown on the sides of the box, and the bottom side of the inflow-outflow domain. Gas density contours are shown on the rear side of the inflow-outflow domain.}\n\\end{figure}\n\nThe code accepts various initial conditions for particles and flow. In particular, we have provided a script to generate initial turbulence using a Passot-Pouquet spectrum \\citep{passot1987numerical}.\n\n\\subsection{Time advancement} \\label{sec:time}\nThe time integration is performed using a fourth-order Runge Kutta (RK4) scheme for both particles and the flow. We first solve for momentum without considering the pressure gradient term. Using the divergence implied by the energy equation (note that the flow filed is not divergence free when radiation is on), we solve the variable coefficient Poisson equation and correct the fluid momentum field. The energy equation involves an energy transfer term between particles and fluid. Therefore, in order to accurately calculate the divergence condition for the fluid pressure, we need to have energy transfer from particles at the next substep before solving the Poisson equation. In other words, at each step the right-hand side of the particle energy equation is calculated at the next substep. However, the right-hand sides of all other equations are evaluated at the current substep. Details of the numerical scheme are explained in appendix \\ref{sec:appA}.\n\n\\subsection{Poisson equation} \\label{sec:Poisson}\nSolving for a variable density flow requires solving a variable coefficient Poisson equation for the hydrodynamic pressure as follows\n\n", "index": 15, "text": "\\begin{equation}\n\\nabla. \\left( \\frac{1}{\\rho} \\nabla p \\right)= f,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m1\" class=\"ltx_Math\" alttext=\"\\nabla.\\left(\\frac{1}{\\rho}\\nabla p\\right)=f,\" display=\"block\"><mrow><mrow><mo>\u2207</mo><mo>.</mo><mrow><mrow><mo>(</mo><mrow><mfrac><mn>1</mn><mi>\u03c1</mi></mfrac><mo>\u2062</mo><mrow><mo>\u2207</mo><mo>\u2061</mo><mi>p</mi></mrow></mrow><mo>)</mo></mrow><mo>=</mo><mi>f</mi></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05448.tex", "nexttext": "\nAll terms in the right-hand side of the above equation are known except for the last one. We ignore the last term and iterate to update $p_g \\leftarrow p_g + \\delta p$, until convergence. The convergence rate depends on the variation in the density field. Eq. (\\ref{eqn:Pois}) represents a constant coefficient Poisson equation (after ignoring the last term) that is solved using a parallel Fourier transform in periodic directions \\citep{plimpton1997particle} and a parallel tri-diagonal solver in the non-periodic direction.\n\n\n\n\\section{Software description} \\label{sec:soft}\n\\subsection{Software Architecture}\nIn this section we briefly describe the significance and abilities of each class:\n\n\\verb!params!: This class reads all input parameters from a file. After some initial calculations (before the simulation begins), all physical parameters can be accessed through this class.\n\n\\verb!tensor0!: Stores a local 3D grid (i.e., for one process). Simple arithmetic, spatial discretization, interpolation, etc., are implemented in this class. Similarly, the class \\verb!tensor1!  stores a local grid of 3D vectors. In other words, \\verb!tensor1! encompasses three instances of \\verb!tensor0!.\n\n\\verb!gridsize!: stores and provides the logical information (e.g., size in each direction) for a local grid.\n\n\\verb!proc!: has logical information (e.g., rank, neighbors, etc.) for each process.\n\n\\verb!communicator!: takes care of updating halo cells for the grid by communicating between processors. All other parallel algorithms are implemented within this class.\n\n\\verb!poisson!: solves the variable coefficient Poisson equation.\n\n\\verb!particle!: holds information of $N_p$ particles. Also, all particle-related algorithms are implemented in this class.\n\n\\verb!grid!: represents the full grid, including all scalar and vector quantities for the flow.\n\nTime integration loops are implemented in \\verb!simulation.cpp!. Note that with RK4, every quantity $Q$ has four instances: $Q$ (value at time-step $n$), $Q_{int}$ (value at substep $k$), $Q_{new}$ (value at substep $k+1$), and $Q_{np1}$ (value at time-step $n+1$).\n\n\\subsection{Software Functionalities}\n\\label{sec:func}\nUsing different classes defined in the code, one can easily compute various calculus operations (differentiations, interpolations, etc.) in parallel, without working directly with any MPI-related command. Even though all parallel implementations are under the hood, they can be modified within the \\verb!communicator! class. The code is parallelized in three directions. The number of processes in each direction is determined in the \\verb!proc! class.\n\nFlow and particle statistics can be computed at a desired frequency and stored as binary files (using parallel I/O). Numerical techniques are implemented completely modular; therefore, modifying the code to employ new numerics needs minimal effort (e.g., going from second-order to a fourth-order stencil).\n\nAfter starting each simulation, a summary of information is stored in a file named \\verb!info.txt!. Simulation can be stopped, and all data be saved before the designated time by changing a flag in the file \\verb!touch.check!.\n\n\n\n\\section{Verifications}\n\\subsection{Decay of Taylor-Green vortices}\nWe have verified the carrier-flow implementation using the Taylor-Green vortices, an analytical solution to the Navier-Stokes equations. Having set the initial condition of the triply periodic box simulation as\n\n", "itemtype": "equation", "pos": 11339, "prevtext": "\nwhere $f$ is determined using the energy equation. Consider $p = p_g + \\delta p$, where $p_g$ is our estimated value from the previous step. Then the above equation can be re-written as\n\n", "index": 17, "text": "\\begin{equation} \\label{eqn:Pois}\n\\nabla^2 \\delta p = \\rho f - \\rho \\left( \\nabla \\frac{1}{\\rho} \\right) \\cdot \\left( \\nabla p_g \\right) - \\nabla^2 p_g - \\rho \\left( \\nabla \\frac{1}{\\rho} \\right) \\cdot \\left( \\nabla \\delta p \\right).\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m1\" class=\"ltx_Math\" alttext=\"\\nabla^{2}\\delta p=\\rho f-\\rho\\left(\\nabla\\frac{1}{\\rho}\\right)\\cdot\\left(%&#10;\\nabla p_{g}\\right)-\\nabla^{2}p_{g}-\\rho\\left(\\nabla\\frac{1}{\\rho}\\right)\\cdot%&#10;\\left(\\nabla\\delta p\\right).\" display=\"block\"><mrow><mrow><mrow><msup><mo>\u2207</mo><mn>2</mn></msup><mo>\u2061</mo><mrow><mi>\u03b4</mi><mo>\u2062</mo><mi>p</mi></mrow></mrow><mo>=</mo><mrow><mrow><mi>\u03c1</mi><mo>\u2062</mo><mi>f</mi></mrow><mo>-</mo><mrow><mrow><mi>\u03c1</mi><mo>\u2062</mo><mrow><mo>(</mo><mrow><mo>\u2207</mo><mo>\u2061</mo><mfrac><mn>1</mn><mi>\u03c1</mi></mfrac></mrow><mo>)</mo></mrow></mrow><mo>\u22c5</mo><mrow><mo>(</mo><mrow><mo>\u2207</mo><mo>\u2061</mo><msub><mi>p</mi><mi>g</mi></msub></mrow><mo>)</mo></mrow></mrow><mo>-</mo><mrow><msup><mo>\u2207</mo><mn>2</mn></msup><mo>\u2061</mo><msub><mi>p</mi><mi>g</mi></msub></mrow><mo>-</mo><mrow><mrow><mi>\u03c1</mi><mo>\u2062</mo><mrow><mo>(</mo><mrow><mo>\u2207</mo><mo>\u2061</mo><mfrac><mn>1</mn><mi>\u03c1</mi></mfrac></mrow><mo>)</mo></mrow></mrow><mo>\u22c5</mo><mrow><mo>(</mo><mrow><mo>\u2207</mo><mo>\u2061</mo><mrow><mi>\u03b4</mi><mo>\u2062</mo><mi>p</mi></mrow></mrow><mo>)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05448.tex", "nexttext": "\nthe velocity field will maintain its two-dimensional shape as shown in Figure \\ref{fig:PRScatter}.\n\\begin{figure}\\centering\n\\centering\n\\includegraphics[width = 0.8 \\textwidth] {iso.eps}\n\\caption{\\label{fig:PRScatter}$v$ contours and iso-surface (left); $w$ contours and iso surface (right). }\n\\end{figure}\n\\\\\nWe can also look at the decay rate of the Taylor-Green vortices in time. Starting with the initial velocity field given by the above equations, we expect an exponential decay rate for the turbulent kinetic energy $\\sim e^{(2A-4\\nu)t}$. Note that $A$ is the linear forcing coefficient as in Eq. \\ref{eqn:NS}, which is only applied to the box simulation. A slice that enters the duct at time $t_0$ has turbulent kinetic energy (TKE) $\\sim e^{(2A-4\\nu)t_0}$. However, since there is no linear forcing in the duct, the decay rate of this slice scales like $e^{-4\\nu t}$. In order to follow this decay we should consider the convective velocity in $x$ direction, $U_x$ (which is $U_x=10$ in this case). It means that at time $t_0+\\Delta t$ the slice location is moved by $U_x \\Delta t$. In other words, a slice located at position $x$ has decayed from its enterance value for $\\Delta t=x/U_x$ time units. Thus, by looking at one snapshot at an arbitrary time, $t$, we expect the following distribution for the TKE\n\n", "itemtype": "equation", "pos": 15035, "prevtext": "\nAll terms in the right-hand side of the above equation are known except for the last one. We ignore the last term and iterate to update $p_g \\leftarrow p_g + \\delta p$, until convergence. The convergence rate depends on the variation in the density field. Eq. (\\ref{eqn:Pois}) represents a constant coefficient Poisson equation (after ignoring the last term) that is solved using a parallel Fourier transform in periodic directions \\citep{plimpton1997particle} and a parallel tri-diagonal solver in the non-periodic direction.\n\n\n\n\\section{Software description} \\label{sec:soft}\n\\subsection{Software Architecture}\nIn this section we briefly describe the significance and abilities of each class:\n\n\\verb!params!: This class reads all input parameters from a file. After some initial calculations (before the simulation begins), all physical parameters can be accessed through this class.\n\n\\verb!tensor0!: Stores a local 3D grid (i.e., for one process). Simple arithmetic, spatial discretization, interpolation, etc., are implemented in this class. Similarly, the class \\verb!tensor1!  stores a local grid of 3D vectors. In other words, \\verb!tensor1! encompasses three instances of \\verb!tensor0!.\n\n\\verb!gridsize!: stores and provides the logical information (e.g., size in each direction) for a local grid.\n\n\\verb!proc!: has logical information (e.g., rank, neighbors, etc.) for each process.\n\n\\verb!communicator!: takes care of updating halo cells for the grid by communicating between processors. All other parallel algorithms are implemented within this class.\n\n\\verb!poisson!: solves the variable coefficient Poisson equation.\n\n\\verb!particle!: holds information of $N_p$ particles. Also, all particle-related algorithms are implemented in this class.\n\n\\verb!grid!: represents the full grid, including all scalar and vector quantities for the flow.\n\nTime integration loops are implemented in \\verb!simulation.cpp!. Note that with RK4, every quantity $Q$ has four instances: $Q$ (value at time-step $n$), $Q_{int}$ (value at substep $k$), $Q_{new}$ (value at substep $k+1$), and $Q_{np1}$ (value at time-step $n+1$).\n\n\\subsection{Software Functionalities}\n\\label{sec:func}\nUsing different classes defined in the code, one can easily compute various calculus operations (differentiations, interpolations, etc.) in parallel, without working directly with any MPI-related command. Even though all parallel implementations are under the hood, they can be modified within the \\verb!communicator! class. The code is parallelized in three directions. The number of processes in each direction is determined in the \\verb!proc! class.\n\nFlow and particle statistics can be computed at a desired frequency and stored as binary files (using parallel I/O). Numerical techniques are implemented completely modular; therefore, modifying the code to employ new numerics needs minimal effort (e.g., going from second-order to a fourth-order stencil).\n\nAfter starting each simulation, a summary of information is stored in a file named \\verb!info.txt!. Simulation can be stopped, and all data be saved before the designated time by changing a flag in the file \\verb!touch.check!.\n\n\n\n\\section{Verifications}\n\\subsection{Decay of Taylor-Green vortices}\nWe have verified the carrier-flow implementation using the Taylor-Green vortices, an analytical solution to the Navier-Stokes equations. Having set the initial condition of the triply periodic box simulation as\n\n", "index": 19, "text": "\\begin{equation}\n\\begin{split}\nu(x,y,z)&=U_x,\\\\\nv(x,y,z)&=\\sin(y) \\cos(z),\\\\\nw(x,y,z)&=-\\cos(y) \\sin(z),\n\\end{split}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E10.m1\" class=\"ltx_Math\" alttext=\"\\begin{split}\\displaystyle u(x,y,z)&amp;\\displaystyle=U_{x},\\\\&#10;\\displaystyle v(x,y,z)&amp;\\displaystyle=\\sin(y)\\cos(z),\\\\&#10;\\displaystyle w(x,y,z)&amp;\\displaystyle=-\\cos(y)\\sin(z),\\end{split}\" display=\"block\"><mtable columnspacing=\"0pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"right\"><mrow><mi>u</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mi/><mo>=</mo><msub><mi>U</mi><mi>x</mi></msub></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mrow><mi>v</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mi/><mo>=</mo><mrow><mrow><mi>sin</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2062</mo><mrow><mi>cos</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mrow><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mi/><mo>=</mo><mrow><mo>-</mo><mrow><mrow><mi>cos</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2062</mo><mrow><mi>sin</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.05448.tex", "nexttext": "\nIn the above expression, $e^{-4\\nu \\frac{x}{U_x}}$ is the decay that occurs in the duct, and $e^{(2A-4\\nu)(t-\\frac{x}{U_x})}$ is the TKE at the time at which this slice is copied from the box.\nHence, $\\mbox{TKE} \\sim e^{\\frac{2A}{U_x}x} = e^{.12x}$ (here, A=.6 is used). The decay of TKE is shown in Figure \\ref{fig:TGdecay}, and the $v$-component of the velocity iso-surface is illustrated in Figure \\ref{fig:Viso}. At the very end of the domain, due to a first-order accurate convective BC, there is a source of error, as is clear from Figure \\ref{fig:TGdecay}.\n\n\\begin{figure}\\centering\n\\centering\n\\includegraphics[width = 0.9 \\textwidth]{decay.eps}\n\\caption{Decay of the TKE in x-direction (left). Linear fitting on the semi-log plane (right).}\n\\label{fig:TGdecay}\n\\end{figure}\n\\begin{figure}\\centering\n\\centering\n\\includegraphics[width = 0.45 \\textwidth]{e1.eps}\n\\caption{$v$ contours and iso-surface}\n\\label{fig:Viso}\n\\end{figure}\n\n\\subsection{Buoyancy driven turbulence}\nAnother sample problem, against which we tested the code is the homogeneous buoyancy-generated turbulence flow \\citep{batchelor1992homogeneous}. In the original paper, the Boussinesq approximation is used, which is less accurate than a variable density calculation. The flow starts at rest, while the initial density field is non-homogeneous, and is drawn from an artificial spectrum. When gravity is present, the inhomogeneity of the density field results in the generation of turbulence. The turbulence decays eventually. These results are shown in Figure \\ref{fig:TKEBatch}. The results are matched with those presented by \\citep{batchelor1992homogeneous} for smaller Reynolds numbers. For large Reynolds numbers (corresponding to larger variations in the gas density field) the results are slightly different. This can be explained by inaccuracy of the Boussinesq approximation when density variation is relatively large.\n\\begin{figure}\\centering\n\\centering\n\\includegraphics[width = 0.45 \\textwidth]{TKE.eps}\n\\caption{Generation of homogeneous buoyancy-driven turbulence. Non-dimensionalization is similar to that of the original paper by \\cite{batchelor1992homogeneous}.}\n\\label{fig:TKEBatch}\n\\end{figure}\n\n\\subsection{Capturing particle preferential concentration}\nIn a particle-laden turbulence, the spatial distribution of the dispersed phase deviates from the homogeneous distribution \\citep{eaton1994preferential}. This is due to the interaction of particles with turbulent eddies.\nParticle Stokes number (ratio of the particle relaxation time to the turbulent Kolmogorov timescale) is the relevant non-dimensional number that determines the inhomogeneity of particles.\nThe highest preferential concentration is expected to appear for the Stokes number of order unity. In Figure \\ref{fig:snapshot_me}, snapshots of particle distribution for different Stokes numbers are shown, confirming maximum preferential concentration at Stokes number 1. A quantitative analysis of particle preferential concentration is provided in \\citep{pouransari2015}.\n\n\\begin{figure}\\centering\n\\includegraphics[width=0.65\\textwidth]{pref.eps}\n\\caption{2D slices of the three-dimensional particle-laden turbulence simulation for Kolmogorov-based Stokes number = $0.0625,~0.25,~0.5,~1,~4$, and $8$, respectively, from top left to bottom right. The slice thickness is $1/128$ of the length of the box.}\n\\label{fig:snapshot_me} \n\\end{figure}\n\n\\subsection{Effect of domain partitioning}\nWe used various domain decompositions (for parallelization), and with the same initial condition, measured the difference between solution (momentum, density, particle location/velocity, etc.) after 10 time-steps. We found that solutions are equal up to machine precision. Some of the domain decompositions that we used are shown in Figure \\ref{fig:decompos}.\n\\begin{figure}\\centering\n\\centering\n\\includegraphics[width = 0.5 \\textwidth]{decom.eps}\n\\caption{Different domain decompositions for parallelization.}\n\\label{fig:decompos}\n\\end{figure}\n\n\n\n\\section{Conclusions}\n\\label{sec:conclusion}\nIn this paper, we introduced a variable-density particle-laden turbulent flow simulation code. The code is fourth-order accurate in time, and second-order accurate in space. It is fully parallel using MPI. Particles are modeled as Lagrangian points, while fluid is represented using a uniform staggered Eulerian grid. This code has demonstrated the expected results for various canonical problems, and has been used to discover physics in a variety of new fields involving particles, flow, and radiation.\n\n\n\n\\section*{Acknowledgments}\nThis work was supported by the United States Department of Energy under the Predictive Science Academic Alliance Program 2 (PSAAP2) at Stanford University.\n\n\n\n\\appendix\n\\section{} \\label{sec:appA}\nIn this section, we explain the details of the numerics used to solve for a variable-density flow with low-Mach number assumption.\n\nConsider $C_{RK4}^{post} = [\\frac{1}{6},\\frac{1}{3},\\frac{1}{3},\\frac{1}{6}]$ and $C_{RK4}^{pre} = [\\frac{1}{2},\\frac{1}{2},1]$ as constant coefficients used to implement the RK4 time integration. Also, assume $k=0,1,2,3$ corresponds to the RK4 four substeps. Assume $Q$ is some quantity of interest (e.g., density). At each RK4 substep $Q_{new}$ is obtained from $Q^{(n)}$ and $Q_{int}$. $Q^{(n)}$ is the value of $Q$ at time-step $n$, $Q_{int}$ is the value at the previous RK4 substep, and $Q_{new}$ is the new value of $Q$ after the RK4 substep. For the first RK4 substep we initiate $Q_{int}=Q^{(n)}$.\nNote that we are solving for conservative fields $\\rho$ and $\\rho u_i$ (here, we dropped the fluid subscript for simplicity). In the following, the time integration steps are explained.\n\nWe start by solving for the flow density\n\n", "itemtype": "equation", "pos": 16485, "prevtext": "\nthe velocity field will maintain its two-dimensional shape as shown in Figure \\ref{fig:PRScatter}.\n\\begin{figure}\\centering\n\\centering\n\\includegraphics[width = 0.8 \\textwidth] {iso.eps}\n\\caption{\\label{fig:PRScatter}$v$ contours and iso-surface (left); $w$ contours and iso surface (right). }\n\\end{figure}\n\\\\\nWe can also look at the decay rate of the Taylor-Green vortices in time. Starting with the initial velocity field given by the above equations, we expect an exponential decay rate for the turbulent kinetic energy $\\sim e^{(2A-4\\nu)t}$. Note that $A$ is the linear forcing coefficient as in Eq. \\ref{eqn:NS}, which is only applied to the box simulation. A slice that enters the duct at time $t_0$ has turbulent kinetic energy (TKE) $\\sim e^{(2A-4\\nu)t_0}$. However, since there is no linear forcing in the duct, the decay rate of this slice scales like $e^{-4\\nu t}$. In order to follow this decay we should consider the convective velocity in $x$ direction, $U_x$ (which is $U_x=10$ in this case). It means that at time $t_0+\\Delta t$ the slice location is moved by $U_x \\Delta t$. In other words, a slice located at position $x$ has decayed from its enterance value for $\\Delta t=x/U_x$ time units. Thus, by looking at one snapshot at an arbitrary time, $t$, we expect the following distribution for the TKE\n\n", "index": 21, "text": "$$\n\\mbox{TKE} \\sim e^{-4\\nu \\frac{x}{U_x}} \\cdot e^{(2A-4\\nu)t_0} = e^{-4\\nu \\frac{x}{U_x}} \\cdot e^{(2A-4\\nu)(t-\\frac{x}{U_x})}.\n$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"\\mbox{TKE}\\sim e^{-4\\nu\\frac{x}{U_{x}}}\\cdot e^{(2A-4\\nu)t_{0}}=e^{-4\\nu\\frac{%&#10;x}{U_{x}}}\\cdot e^{(2A-4\\nu)(t-\\frac{x}{U_{x}})}.\" display=\"block\"><mrow><mrow><mtext>TKE</mtext><mo>\u223c</mo><mrow><msup><mi>e</mi><mrow><mo>-</mo><mrow><mn>4</mn><mo>\u2062</mo><mi>\u03bd</mi><mo>\u2062</mo><mfrac><mi>x</mi><msub><mi>U</mi><mi>x</mi></msub></mfrac></mrow></mrow></msup><mo>\u22c5</mo><msup><mi>e</mi><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>A</mi></mrow><mo>-</mo><mrow><mn>4</mn><mo>\u2062</mo><mi>\u03bd</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>t</mi><mn>0</mn></msub></mrow></msup></mrow><mo>=</mo><mrow><msup><mi>e</mi><mrow><mo>-</mo><mrow><mn>4</mn><mo>\u2062</mo><mi>\u03bd</mi><mo>\u2062</mo><mfrac><mi>x</mi><msub><mi>U</mi><mi>x</mi></msub></mfrac></mrow></mrow></msup><mo>\u22c5</mo><msup><mi>e</mi><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>A</mi></mrow><mo>-</mo><mrow><mn>4</mn><mo>\u2062</mo><mi>\u03bd</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>t</mi><mo>-</mo><mfrac><mi>x</mi><msub><mi>U</mi><mi>x</mi></msub></mfrac></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msup></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05448.tex", "nexttext": "\nNext, solve for momentum without pressure\n\n", "itemtype": "equation", "pos": 22357, "prevtext": "\nIn the above expression, $e^{-4\\nu \\frac{x}{U_x}}$ is the decay that occurs in the duct, and $e^{(2A-4\\nu)(t-\\frac{x}{U_x})}$ is the TKE at the time at which this slice is copied from the box.\nHence, $\\mbox{TKE} \\sim e^{\\frac{2A}{U_x}x} = e^{.12x}$ (here, A=.6 is used). The decay of TKE is shown in Figure \\ref{fig:TGdecay}, and the $v$-component of the velocity iso-surface is illustrated in Figure \\ref{fig:Viso}. At the very end of the domain, due to a first-order accurate convective BC, there is a source of error, as is clear from Figure \\ref{fig:TGdecay}.\n\n\\begin{figure}\\centering\n\\centering\n\\includegraphics[width = 0.9 \\textwidth]{decay.eps}\n\\caption{Decay of the TKE in x-direction (left). Linear fitting on the semi-log plane (right).}\n\\label{fig:TGdecay}\n\\end{figure}\n\\begin{figure}\\centering\n\\centering\n\\includegraphics[width = 0.45 \\textwidth]{e1.eps}\n\\caption{$v$ contours and iso-surface}\n\\label{fig:Viso}\n\\end{figure}\n\n\\subsection{Buoyancy driven turbulence}\nAnother sample problem, against which we tested the code is the homogeneous buoyancy-generated turbulence flow \\citep{batchelor1992homogeneous}. In the original paper, the Boussinesq approximation is used, which is less accurate than a variable density calculation. The flow starts at rest, while the initial density field is non-homogeneous, and is drawn from an artificial spectrum. When gravity is present, the inhomogeneity of the density field results in the generation of turbulence. The turbulence decays eventually. These results are shown in Figure \\ref{fig:TKEBatch}. The results are matched with those presented by \\citep{batchelor1992homogeneous} for smaller Reynolds numbers. For large Reynolds numbers (corresponding to larger variations in the gas density field) the results are slightly different. This can be explained by inaccuracy of the Boussinesq approximation when density variation is relatively large.\n\\begin{figure}\\centering\n\\centering\n\\includegraphics[width = 0.45 \\textwidth]{TKE.eps}\n\\caption{Generation of homogeneous buoyancy-driven turbulence. Non-dimensionalization is similar to that of the original paper by \\cite{batchelor1992homogeneous}.}\n\\label{fig:TKEBatch}\n\\end{figure}\n\n\\subsection{Capturing particle preferential concentration}\nIn a particle-laden turbulence, the spatial distribution of the dispersed phase deviates from the homogeneous distribution \\citep{eaton1994preferential}. This is due to the interaction of particles with turbulent eddies.\nParticle Stokes number (ratio of the particle relaxation time to the turbulent Kolmogorov timescale) is the relevant non-dimensional number that determines the inhomogeneity of particles.\nThe highest preferential concentration is expected to appear for the Stokes number of order unity. In Figure \\ref{fig:snapshot_me}, snapshots of particle distribution for different Stokes numbers are shown, confirming maximum preferential concentration at Stokes number 1. A quantitative analysis of particle preferential concentration is provided in \\citep{pouransari2015}.\n\n\\begin{figure}\\centering\n\\includegraphics[width=0.65\\textwidth]{pref.eps}\n\\caption{2D slices of the three-dimensional particle-laden turbulence simulation for Kolmogorov-based Stokes number = $0.0625,~0.25,~0.5,~1,~4$, and $8$, respectively, from top left to bottom right. The slice thickness is $1/128$ of the length of the box.}\n\\label{fig:snapshot_me} \n\\end{figure}\n\n\\subsection{Effect of domain partitioning}\nWe used various domain decompositions (for parallelization), and with the same initial condition, measured the difference between solution (momentum, density, particle location/velocity, etc.) after 10 time-steps. We found that solutions are equal up to machine precision. Some of the domain decompositions that we used are shown in Figure \\ref{fig:decompos}.\n\\begin{figure}\\centering\n\\centering\n\\includegraphics[width = 0.5 \\textwidth]{decom.eps}\n\\caption{Different domain decompositions for parallelization.}\n\\label{fig:decompos}\n\\end{figure}\n\n\n\n\\section{Conclusions}\n\\label{sec:conclusion}\nIn this paper, we introduced a variable-density particle-laden turbulent flow simulation code. The code is fourth-order accurate in time, and second-order accurate in space. It is fully parallel using MPI. Particles are modeled as Lagrangian points, while fluid is represented using a uniform staggered Eulerian grid. This code has demonstrated the expected results for various canonical problems, and has been used to discover physics in a variety of new fields involving particles, flow, and radiation.\n\n\n\n\\section*{Acknowledgments}\nThis work was supported by the United States Department of Energy under the Predictive Science Academic Alliance Program 2 (PSAAP2) at Stanford University.\n\n\n\n\\appendix\n\\section{} \\label{sec:appA}\nIn this section, we explain the details of the numerics used to solve for a variable-density flow with low-Mach number assumption.\n\nConsider $C_{RK4}^{post} = [\\frac{1}{6},\\frac{1}{3},\\frac{1}{3},\\frac{1}{6}]$ and $C_{RK4}^{pre} = [\\frac{1}{2},\\frac{1}{2},1]$ as constant coefficients used to implement the RK4 time integration. Also, assume $k=0,1,2,3$ corresponds to the RK4 four substeps. Assume $Q$ is some quantity of interest (e.g., density). At each RK4 substep $Q_{new}$ is obtained from $Q^{(n)}$ and $Q_{int}$. $Q^{(n)}$ is the value of $Q$ at time-step $n$, $Q_{int}$ is the value at the previous RK4 substep, and $Q_{new}$ is the new value of $Q$ after the RK4 substep. For the first RK4 substep we initiate $Q_{int}=Q^{(n)}$.\nNote that we are solving for conservative fields $\\rho$ and $\\rho u_i$ (here, we dropped the fluid subscript for simplicity). In the following, the time integration steps are explained.\n\nWe start by solving for the flow density\n\n", "index": 23, "text": "\\begin{equation}\n\\rho_{new}=\\rho^{(n)}-C_{RK4}^{pre}[k] \\cdot \\Delta t \\cdot  \\frac{\\partial}{\\partial x_j} (\\rho u_j)_{int}.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E11.m1\" class=\"ltx_Math\" alttext=\"\\rho_{new}=\\rho^{(n)}-C_{RK4}^{pre}[k]\\cdot\\Delta t\\cdot\\frac{\\partial}{%&#10;\\partial x_{j}}(\\rho u_{j})_{int}.\" display=\"block\"><mrow><mrow><msub><mi>\u03c1</mi><mrow><mi>n</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>w</mi></mrow></msub><mo>=</mo><mrow><msup><mi>\u03c1</mi><mrow><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>-</mo><mrow><mrow><mrow><mrow><mrow><msubsup><mi>C</mi><mrow><mi>R</mi><mo>\u2062</mo><mi>K</mi><mo>\u2062</mo><mn>4</mn></mrow><mrow><mi>p</mi><mo>\u2062</mo><mi>r</mi><mo>\u2062</mo><mi>e</mi></mrow></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>k</mi><mo stretchy=\"false\">]</mo></mrow></mrow><mo>\u22c5</mo><mi mathvariant=\"normal\">\u0394</mi></mrow><mo>\u2062</mo><mi>t</mi></mrow><mo>\u22c5</mo><mfrac><mo>\u2202</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac></mrow><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03c1</mi><mo>\u2062</mo><msub><mi>u</mi><mi>j</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mi>i</mi><mo>\u2062</mo><mi>n</mi><mo>\u2062</mo><mi>t</mi></mrow></msub></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05448.tex", "nexttext": "\n\n", "itemtype": "equation", "pos": 22540, "prevtext": "\nNext, solve for momentum without pressure\n\n", "index": 25, "text": "\\begin{equation}  \\label{eqn:mom}\n(\\rho u_i)_{new} = \\widetilde{(\\rho u_i)}_{new} - C_{RK4}^{pre}[k] \\cdot \\Delta t \\cdot \\left( \\frac{\\partial p}{\\partial x_i} \\right)_{int},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E12.m1\" class=\"ltx_Math\" alttext=\"(\\rho u_{i})_{new}=\\widetilde{(\\rho u_{i})}_{new}-C_{RK4}^{pre}[k]\\cdot\\Delta t%&#10;\\cdot\\left(\\frac{\\partial p}{\\partial x_{i}}\\right)_{int},\" display=\"block\"><mrow><mrow><msub><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03c1</mi><mo>\u2062</mo><msub><mi>u</mi><mi>i</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mi>n</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>w</mi></mrow></msub><mo>=</mo><mrow><msub><mover accent=\"true\"><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03c1</mi><mo>\u2062</mo><msub><mi>u</mi><mi>i</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>~</mo></mover><mrow><mi>n</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>w</mi></mrow></msub><mo>-</mo><mrow><mrow><mrow><mrow><msubsup><mi>C</mi><mrow><mi>R</mi><mo>\u2062</mo><mi>K</mi><mo>\u2062</mo><mn>4</mn></mrow><mrow><mi>p</mi><mo>\u2062</mo><mi>r</mi><mo>\u2062</mo><mi>e</mi></mrow></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>k</mi><mo stretchy=\"false\">]</mo></mrow></mrow><mo>\u22c5</mo><mi mathvariant=\"normal\">\u0394</mi></mrow><mo>\u2062</mo><mi>t</mi></mrow><mo>\u22c5</mo><msub><mrow><mo>(</mo><mfrac><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>p</mi></mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>)</mo></mrow><mrow><mi>i</mi><mo>\u2062</mo><mi>n</mi><mo>\u2062</mo><mi>t</mi></mrow></msub></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05448.tex", "nexttext": "\nwhere\n\n", "itemtype": "equation", "pos": 22731, "prevtext": "\n\n", "index": 27, "text": "\\begin{equation}\n\\widetilde{(\\rho u_i)}_{new}=(\\rho u_i)^{(n)}+C_{RK4}^{pre}[k] \\cdot \\Delta t \\cdot \\widetilde{\\text{RHS}}_{int}^{mom},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E13.m1\" class=\"ltx_Math\" alttext=\"\\widetilde{(\\rho u_{i})}_{new}=(\\rho u_{i})^{(n)}+C_{RK4}^{pre}[k]\\cdot\\Delta t%&#10;\\cdot\\widetilde{\\text{RHS}}_{int}^{mom},\" display=\"block\"><mrow><mrow><msub><mover accent=\"true\"><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03c1</mi><mo>\u2062</mo><msub><mi>u</mi><mi>i</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>~</mo></mover><mrow><mi>n</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>w</mi></mrow></msub><mo>=</mo><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03c1</mi><mo>\u2062</mo><msub><mi>u</mi><mi>i</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>+</mo><mrow><mrow><mrow><mrow><msubsup><mi>C</mi><mrow><mi>R</mi><mo>\u2062</mo><mi>K</mi><mo>\u2062</mo><mn>4</mn></mrow><mrow><mi>p</mi><mo>\u2062</mo><mi>r</mi><mo>\u2062</mo><mi>e</mi></mrow></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>k</mi><mo stretchy=\"false\">]</mo></mrow></mrow><mo>\u22c5</mo><mi mathvariant=\"normal\">\u0394</mi></mrow><mo>\u2062</mo><mi>t</mi></mrow><mo>\u22c5</mo><msubsup><mover accent=\"true\"><mtext>RHS</mtext><mo>~</mo></mover><mrow><mi>i</mi><mo>\u2062</mo><mi>n</mi><mo>\u2062</mo><mi>t</mi></mrow><mrow><mi>m</mi><mo>\u2062</mo><mi>o</mi><mo>\u2062</mo><mi>m</mi></mrow></msubsup></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05448.tex", "nexttext": "\nHere, $\\widetilde{(.)}$ refers to the value of some quantity without considering the pressure gradient.\n\nWe then compute divergence of the velocity at the next substep\\\\\n\n", "itemtype": "equation", "pos": 22889, "prevtext": "\nwhere\n\n", "index": 29, "text": "\\begin{multline}\n\\widetilde{\\text{RHS}}^{mom}=\\frac{\\partial}{\\partial x_j}\\left(\\mu(\\frac{\\partial u_i}{\\partial x_j}+\\frac{\\partial u_j}{\\partial x_i}-\\frac{2}{3}\\frac{\\partial u_k}{\\partial x_k}\\delta_{ij})\\right)+A \\rho u_i\\\\+(\\rho-\\rho_0) g_i - \\frac{\\partial}{\\partial x_j}(\\rho u_i u_j) + {\\cal{P}}\\left( \\frac{{u_p}_i- {\\cal{I}}({u_f}_i) } { \\tau_p } \\right).\n\\end{multline}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\widetilde{\\text{RHS}}^{mom}=\\frac{\\partial}{\\partial x_{j}}\\left%&#10;(\\mu(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{j}}{\\partial x_{i%&#10;}}-\\frac{2}{3}\\frac{\\partial u_{k}}{\\partial x_{k}}\\delta_{ij})\\right)+A\\rho u%&#10;_{i}\\\\&#10;\\displaystyle+(\\rho-\\rho_{0})g_{i}-\\frac{\\partial}{\\partial x_{j}}(\\rho u_{i}u%&#10;_{j})+{\\cal{P}}\\left(\\frac{{u_{p}}_{i}-{\\cal{I}}({u_{f}}_{i})}{\\tau_{p}}\\right).\" display=\"block\"><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><msup><mover accent=\"true\"><mtext>RHS</mtext><mo>~</mo></mover><mrow><mi>m</mi><mo>\u2062</mo><mi>o</mi><mo>\u2062</mo><mi>m</mi></mrow></msup><mo>=</mo><mrow><mrow><mfrac><mo>\u2202</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>\u2062</mo><mrow><mo>(</mo><mrow><mi>\u03bc</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mfrac><mrow><mo>\u2202</mo><mo>\u2061</mo><msub><mi>u</mi><mi>i</mi></msub></mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mo>\u2202</mo><mo>\u2061</mo><msub><mi>u</mi><mi>j</mi></msub></mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mrow><mo>-</mo><mrow><mfrac><mn>2</mn><mn>3</mn></mfrac><mo>\u2062</mo><mfrac><mrow><mo>\u2202</mo><mo>\u2061</mo><msub><mi>u</mi><mi>k</mi></msub></mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><msub><mi>x</mi><mi>k</mi></msub></mrow></mfrac><mo>\u2062</mo><msub><mi>\u03b4</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>)</mo></mrow></mrow><mo>+</mo><mrow><mi>A</mi><mo>\u2062</mo><mi>\u03c1</mi><mo>\u2062</mo><msub><mi>u</mi><mi>i</mi></msub></mrow></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mrow><mrow><mrow><mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03c1</mi><mo>-</mo><msub><mi>\u03c1</mi><mn>0</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>g</mi><mi>i</mi></msub></mrow></mrow><mo>-</mo><mrow><mfrac><mo>\u2202</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03c1</mi><mo>\u2062</mo><msub><mi>u</mi><mi>i</mi></msub><mo>\u2062</mo><msub><mi>u</mi><mi>j</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcab</mi><mo>\u2062</mo><mrow><mo>(</mo><mfrac><mrow><mmultiscripts><mi>u</mi><mi>p</mi><none/><mi>i</mi><none/></mmultiscripts><mo>-</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\u2110</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mmultiscripts><mi>u</mi><mi>f</mi><none/><mi>i</mi><none/></mmultiscripts><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><msub><mi>\u03c4</mi><mi>p</mi></msub></mfrac><mo>)</mo></mrow></mrow></mrow><mo>.</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.05448.tex", "nexttext": " \nwhere $\\alpha = {\\cal{P}}\\left(2\\pi D_p k (T_p- {\\cal{I}}(T_f))\\right)$ is the energy transferred from the particles to the gas per unit time per unit volume. Note that in the above equation ${P_0}_{new}$ and $\\left( \\frac{d P_0}{dt} \\right)_{new}$ are not known. The last term, $\\frac{C_v}{C_p} \\frac{1}{{P_0}_{new}} \\left( \\frac{d P_0}{dt} \\right)_{new}=\\chi$, is a scalar (only function of time) and will be determined later to satisfy the consistency of the Poisson equation. In order to compute ${P_0}_{new}$, we can obtain the time-evolution equation for $P_0$, which is assumed to be only a function of space with a low-Mach number assumption. To do this, one can integrate the energy equation in space, after which all divergence terms vanish due to periodicity. Hence,\n\n", "itemtype": "equation", "pos": -1, "prevtext": "\nHere, $\\widetilde{(.)}$ refers to the value of some quantity without considering the pressure gradient.\n\nWe then compute divergence of the velocity at the next substep\\\\\n\n", "index": 31, "text": "\\begin{equation} \\label{eqn:divUnew}\n\\nabla . \\vec{u}_{new} = \\frac{k }{C_p} \\nabla^2 (\\frac{1}{\\rho_{new}}) + \\frac{\\alpha R}{C_p} \\frac{1}{{P_0}_{new}} - \\frac{C_v}{C_p} \\frac{1}{{P_0}_{new}} \\left( \\frac{d P_0}{dt} \\right)_{new},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E15.m1\" class=\"ltx_Math\" alttext=\"\\nabla.\\vec{u}_{new}=\\frac{k}{C_{p}}\\nabla^{2}(\\frac{1}{\\rho_{new}})+\\frac{%&#10;\\alpha R}{C_{p}}\\frac{1}{{P_{0}}_{new}}-\\frac{C_{v}}{C_{p}}\\frac{1}{{P_{0}}_{%&#10;new}}\\left(\\frac{dP_{0}}{dt}\\right)_{new},\" display=\"block\"><mrow><mrow><mo>\u2207</mo><mo>.</mo><mrow><msub><mover accent=\"true\"><mi>u</mi><mo stretchy=\"false\">\u2192</mo></mover><mrow><mi>n</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>w</mi></mrow></msub><mo>=</mo><mrow><mrow><mrow><mfrac><mi>k</mi><msub><mi>C</mi><mi>p</mi></msub></mfrac><mo>\u2062</mo><mrow><msup><mo>\u2207</mo><mn>2</mn></msup><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mfrac><mn>1</mn><msub><mi>\u03c1</mi><mrow><mi>n</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>w</mi></mrow></msub></mfrac><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><mrow><mfrac><mrow><mi>\u03b1</mi><mo>\u2062</mo><mi>R</mi></mrow><msub><mi>C</mi><mi>p</mi></msub></mfrac><mo>\u2062</mo><mfrac><mn>1</mn><mmultiscripts><mi>P</mi><mn>0</mn><none/><mrow><mi>n</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>w</mi></mrow><none/></mmultiscripts></mfrac></mrow></mrow><mo>-</mo><mrow><mfrac><msub><mi>C</mi><mi>v</mi></msub><msub><mi>C</mi><mi>p</mi></msub></mfrac><mo>\u2062</mo><mfrac><mn>1</mn><mmultiscripts><mi>P</mi><mn>0</mn><none/><mrow><mi>n</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>w</mi></mrow><none/></mmultiscripts></mfrac><mo>\u2062</mo><msub><mrow><mo>(</mo><mfrac><mrow><mi>d</mi><mo>\u2062</mo><msub><mi>P</mi><mn>0</mn></msub></mrow><mrow><mi>d</mi><mo>\u2062</mo><mi>t</mi></mrow></mfrac><mo>)</mo></mrow><mrow><mi>n</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>w</mi></mrow></msub></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05448.tex", "nexttext": "\nNote that for the inflow-outflow case $P_0$ is constant in time and space.\nThe right-hand side of the above equation is a constant number (in time and space). The time evolution-equation for $P_0$ using RK4 is\n\n", "itemtype": "equation", "pos": 24469, "prevtext": " \nwhere $\\alpha = {\\cal{P}}\\left(2\\pi D_p k (T_p- {\\cal{I}}(T_f))\\right)$ is the energy transferred from the particles to the gas per unit time per unit volume. Note that in the above equation ${P_0}_{new}$ and $\\left( \\frac{d P_0}{dt} \\right)_{new}$ are not known. The last term, $\\frac{C_v}{C_p} \\frac{1}{{P_0}_{new}} \\left( \\frac{d P_0}{dt} \\right)_{new}=\\chi$, is a scalar (only function of time) and will be determined later to satisfy the consistency of the Poisson equation. In order to compute ${P_0}_{new}$, we can obtain the time-evolution equation for $P_0$, which is assumed to be only a function of space with a low-Mach number assumption. To do this, one can integrate the energy equation in space, after which all divergence terms vanish due to periodicity. Hence,\n\n", "index": 33, "text": "\\begin{equation} \\label{eqn:dP0dt}\n\\frac{d P_0}{dt}=\\frac{\\alpha R \\bar{c}}{C_v}.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E16.m1\" class=\"ltx_Math\" alttext=\"\\frac{dP_{0}}{dt}=\\frac{\\alpha R\\bar{c}}{C_{v}}.\" display=\"block\"><mrow><mrow><mfrac><mrow><mi>d</mi><mo>\u2062</mo><msub><mi>P</mi><mn>0</mn></msub></mrow><mrow><mi>d</mi><mo>\u2062</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>\u03b1</mi><mo>\u2062</mo><mi>R</mi><mo>\u2062</mo><mover accent=\"true\"><mi>c</mi><mo stretchy=\"false\">\u00af</mo></mover></mrow><msub><mi>C</mi><mi>v</mi></msub></mfrac></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05448.tex", "nexttext": "\nAs explained earlier, we keep $\\chi$ as an unknown to be determined later in order to make the Poisson equation well-posed. \\footnote{Theoretically, the values resulting from Eq. (\\ref{eqn:dP0dt}) should be consistent with the Poisson equation. However, we make this adjustment in order to overcome the ill-posedness resulting from the numerical errors.}\nRewrite Eq. (\\ref{eqn:divUnew}) as below:\n\\begin {equation}\n\\label{eqn:divNewGen}\n\\nabla . \\vec{u}_{new} = \\text{RHS}^{div}_{new}- \\chi,\n\\end {equation}\nwhere in the above equation:\n\n", "itemtype": "equation", "pos": 24776, "prevtext": "\nNote that for the inflow-outflow case $P_0$ is constant in time and space.\nThe right-hand side of the above equation is a constant number (in time and space). The time evolution-equation for $P_0$ using RK4 is\n\n", "index": 35, "text": "\\begin{equation}\n{P_0}_{new}={P_0}^{n}+C_{RK4}^{pre}[k] \\cdot \\Delta t \\cdot \\frac{\\langle \\alpha \\rangle R}{C_v}.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E17.m1\" class=\"ltx_Math\" alttext=\"{P_{0}}_{new}={P_{0}}^{n}+C_{RK4}^{pre}[k]\\cdot\\Delta t\\cdot\\frac{\\langle%&#10;\\alpha\\rangle R}{C_{v}}.\" display=\"block\"><mrow><mrow><mmultiscripts><mi>P</mi><mn>0</mn><none/><mrow><mi>n</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>w</mi></mrow><none/></mmultiscripts><mo>=</mo><mrow><mmultiscripts><mi>P</mi><mn>0</mn><none/><none/><mi>n</mi></mmultiscripts><mo>+</mo><mrow><mrow><mrow><mrow><msubsup><mi>C</mi><mrow><mi>R</mi><mo>\u2062</mo><mi>K</mi><mo>\u2062</mo><mn>4</mn></mrow><mrow><mi>p</mi><mo>\u2062</mo><mi>r</mi><mo>\u2062</mo><mi>e</mi></mrow></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>k</mi><mo stretchy=\"false\">]</mo></mrow></mrow><mo>\u22c5</mo><mi mathvariant=\"normal\">\u0394</mi></mrow><mo>\u2062</mo><mi>t</mi></mrow><mo>\u22c5</mo><mfrac><mrow><mrow><mo stretchy=\"false\">\u27e8</mo><mi>\u03b1</mi><mo stretchy=\"false\">\u27e9</mo></mrow><mo>\u2062</mo><mi>R</mi></mrow><msub><mi>C</mi><mi>v</mi></msub></mfrac></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05448.tex", "nexttext": "\nDivide Eq. (\\ref{eqn:mom}) by $\\rho_{new}$ and take divergence\n\\begin {equation}\n\\label{eqn:divnew}\n\\nabla . \\vec{u}_{new} = \\nabla . \\left( \\frac{\\widetilde{(\\rho u_i)}_{new}}{\\rho_{new}} \\right)-C_{RK4}^{pre}[k] \\cdot \\Delta t \\cdot \\nabla . ( \\frac{1}{\\rho_{new}} \\nabla p).\n\\end{equation}\nNow, we can substitute $\\nabla . \\vec{u}_{new}$ from Eq. (\\ref{eqn:divnew}) in Eq. (\\ref{eqn:divNewGen})\n\n", "itemtype": "equation", "pos": 25443, "prevtext": "\nAs explained earlier, we keep $\\chi$ as an unknown to be determined later in order to make the Poisson equation well-posed. \\footnote{Theoretically, the values resulting from Eq. (\\ref{eqn:dP0dt}) should be consistent with the Poisson equation. However, we make this adjustment in order to overcome the ill-posedness resulting from the numerical errors.}\nRewrite Eq. (\\ref{eqn:divUnew}) as below:\n\\begin {equation}\n\\label{eqn:divNewGen}\n\\nabla . \\vec{u}_{new} = \\text{RHS}^{div}_{new}- \\chi,\n\\end {equation}\nwhere in the above equation:\n\n", "index": 37, "text": "$$\n\\text{RHS}^{div}_{new}= \\frac{k }{C_p} \\nabla^2 (\\frac{1}{\\rho_{new}}) + \\frac{\\alpha R}{C_p} \\frac{1}{{P_0}_{new}} \\mbox{ , and } \\chi \\mbox{ is a number need to be determined.}\n$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"\\text{RHS}^{div}_{new}=\\frac{k}{C_{p}}\\nabla^{2}(\\frac{1}{\\rho_{new}})+\\frac{%&#10;\\alpha R}{C_{p}}\\frac{1}{{P_{0}}_{new}}\\mbox{ , and }\\chi\\mbox{ is a number %&#10;need to be determined.}\" display=\"block\"><mrow><msubsup><mtext>RHS</mtext><mrow><mi>n</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>w</mi></mrow><mrow><mi>d</mi><mo>\u2062</mo><mi>i</mi><mo>\u2062</mo><mi>v</mi></mrow></msubsup><mo>=</mo><mrow><mrow><mfrac><mi>k</mi><msub><mi>C</mi><mi>p</mi></msub></mfrac><mo>\u2062</mo><mrow><msup><mo>\u2207</mo><mn>2</mn></msup><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mfrac><mn>1</mn><msub><mi>\u03c1</mi><mrow><mi>n</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>w</mi></mrow></msub></mfrac><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><mrow><mfrac><mrow><mi>\u03b1</mi><mo>\u2062</mo><mi>R</mi></mrow><msub><mi>C</mi><mi>p</mi></msub></mfrac><mo>\u2062</mo><mfrac><mn>1</mn><mmultiscripts><mi>P</mi><mn>0</mn><none/><mrow><mi>n</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>w</mi></mrow><none/></mmultiscripts></mfrac><mo>\u2062</mo><mtext>\u00a0, and\u00a0</mtext><mo>\u2062</mo><mi>\u03c7</mi><mo>\u2062</mo><mtext>\u00a0is a number need to be determined.</mtext></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.05448.tex", "nexttext": "\n\n", "itemtype": "equation", "pos": 26026, "prevtext": "\nDivide Eq. (\\ref{eqn:mom}) by $\\rho_{new}$ and take divergence\n\\begin {equation}\n\\label{eqn:divnew}\n\\nabla . \\vec{u}_{new} = \\nabla . \\left( \\frac{\\widetilde{(\\rho u_i)}_{new}}{\\rho_{new}} \\right)-C_{RK4}^{pre}[k] \\cdot \\Delta t \\cdot \\nabla . ( \\frac{1}{\\rho_{new}} \\nabla p).\n\\end{equation}\nNow, we can substitute $\\nabla . \\vec{u}_{new}$ from Eq. (\\ref{eqn:divnew}) in Eq. (\\ref{eqn:divNewGen})\n\n", "index": 39, "text": "\\begin{equation}\n\\text{RHS}^{div}_{new}- \\chi=\\nabla . \\left( \\frac{\\widetilde{(\\rho u_i)}_{new}}{\\rho_{new}} \\right)-C_{RK4}^{pre}[k] \\cdot \\Delta t \\cdot \\nabla . ( \\frac{1}{\\rho_{new}} \\nabla p)\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E18.m1\" class=\"ltx_Math\" alttext=\"\\text{RHS}^{div}_{new}-\\chi=\\nabla.\\left(\\frac{\\widetilde{(\\rho u_{i})}_{new}}%&#10;{\\rho_{new}}\\right)-C_{RK4}^{pre}[k]\\cdot\\Delta t\\cdot\\nabla.(\\frac{1}{\\rho_{%&#10;new}}\\nabla p)\" display=\"block\"><mrow><mrow><mrow><msubsup><mtext>RHS</mtext><mrow><mi>n</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>w</mi></mrow><mrow><mi>d</mi><mo>\u2062</mo><mi>i</mi><mo>\u2062</mo><mi>v</mi></mrow></msubsup><mo>-</mo><mi>\u03c7</mi></mrow><mo>=</mo><mo>\u2207</mo></mrow><mo>.</mo><mrow><mrow><mo>(</mo><mfrac><msub><mover accent=\"true\"><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03c1</mi><mo>\u2062</mo><msub><mi>u</mi><mi>i</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>~</mo></mover><mrow><mi>n</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>w</mi></mrow></msub><msub><mi>\u03c1</mi><mrow><mi>n</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>w</mi></mrow></msub></mfrac><mo>)</mo></mrow><mo>-</mo><mrow><mrow><mrow><mrow><msubsup><mi>C</mi><mrow><mi>R</mi><mo>\u2062</mo><mi>K</mi><mo>\u2062</mo><mn>4</mn></mrow><mrow><mi>p</mi><mo>\u2062</mo><mi>r</mi><mo>\u2062</mo><mi>e</mi></mrow></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>k</mi><mo stretchy=\"false\">]</mo></mrow></mrow><mo>\u22c5</mo><mi mathvariant=\"normal\">\u0394</mi></mrow><mo>\u2062</mo><mi>t</mi></mrow><mo>\u22c5</mo><mo>\u2207</mo></mrow></mrow><mo>.</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mfrac><mn>1</mn><msub><mi>\u03c1</mi><mrow><mi>n</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>w</mi></mrow></msub></mfrac><mo>\u2062</mo><mrow><mo>\u2207</mo><mo>\u2061</mo><mi>p</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></math>", "type": "latex"}, {"file": "1601.05448.tex", "nexttext": "\nThis is a variable coefficient Poisson equation. When we take spatial integral of the above equation, for a fully periodic domain, the left hand side term vanishes. Therefore,\n\n", "itemtype": "equation", "pos": 26239, "prevtext": "\n\n", "index": 41, "text": "\\begin{equation}\n\\Rightarrow \\nabla . ( \\frac{1}{\\rho_{new}} \\nabla p) = \\frac{1}{C_{RK4}^{pre}[k] \\cdot \\Delta t} \\left\\{ \\nabla . \\left( \\frac{\\widetilde{(\\rho u_i)}_{new}}{\\rho_{new}} \\right)-\\text{RHS}^{div}_{new}+ \\chi\\right\\} = \\text{RHS}_{new}^{Pois} + \\chi'.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E19.m1\" class=\"ltx_Math\" alttext=\"\\Rightarrow\\nabla.(\\frac{1}{\\rho_{new}}\\nabla p)=\\frac{1}{C_{RK4}^{pre}[k]%&#10;\\cdot\\Delta t}\\left\\{\\nabla.\\left(\\frac{\\widetilde{(\\rho u_{i})}_{new}}{\\rho_{%&#10;new}}\\right)-\\text{RHS}^{div}_{new}+\\chi\\right\\}=\\text{RHS}_{new}^{Pois}+\\chi^%&#10;{\\prime}.\" display=\"block\"><mrow><mo>\u21d2</mo><mo>\u2207</mo><mo>.</mo><mrow><mo stretchy=\"false\">(</mo><mfrac><mn>1</mn><msub><mi>\u03c1</mi><mrow><mi>n</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>w</mi></mrow></msub></mfrac><mo>\u2207</mo><mi>p</mi><mo stretchy=\"false\">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mrow><mrow><msubsup><mi>C</mi><mrow><mi>R</mi><mo>\u2062</mo><mi>K</mi><mo>\u2062</mo><mn>4</mn></mrow><mrow><mi>p</mi><mo>\u2062</mo><mi>r</mi><mo>\u2062</mo><mi>e</mi></mrow></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>k</mi><mo stretchy=\"false\">]</mo></mrow></mrow><mo>\u22c5</mo><mi mathvariant=\"normal\">\u0394</mi></mrow><mo>\u2062</mo><mi>t</mi></mrow></mfrac><mrow><mo>{</mo><mo>\u2207</mo><mo>.</mo><mrow><mo>(</mo><mfrac><msub><mover accent=\"true\"><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03c1</mi><mo>\u2062</mo><msub><mi>u</mi><mi>i</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>~</mo></mover><mrow><mi>n</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>w</mi></mrow></msub><msub><mi>\u03c1</mi><mrow><mi>n</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>w</mi></mrow></msub></mfrac><mo>)</mo></mrow><mo>-</mo><msubsup><mtext>RHS</mtext><mrow><mi>n</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>w</mi></mrow><mrow><mi>d</mi><mo>\u2062</mo><mi>i</mi><mo>\u2062</mo><mi>v</mi></mrow></msubsup><mo>+</mo><mi>\u03c7</mi><mo>}</mo></mrow><mo>=</mo><msubsup><mtext>RHS</mtext><mrow><mi>n</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>w</mi></mrow><mrow><mi>P</mi><mo>\u2062</mo><mi>o</mi><mo>\u2062</mo><mi>i</mi><mo>\u2062</mo><mi>s</mi></mrow></msubsup><mo>+</mo><msup><mi>\u03c7</mi><mo>\u2032</mo></msup><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05448.tex", "nexttext": "\nAfter solving the variable coefficient Poisson equation, we update the momentum based on Eq. (\\ref{eqn:mom}). Note that during the RK4 loop, for a quantity $Q$ with the time evolution equation $\\frac{\\partial Q}{\\partial t}=\\text{RHS}_Q$, we construct $Q^{(n+1)}$ as\n\n", "itemtype": "equation", "pos": 26697, "prevtext": "\nThis is a variable coefficient Poisson equation. When we take spatial integral of the above equation, for a fully periodic domain, the left hand side term vanishes. Therefore,\n\n", "index": 43, "text": "\\begin{equation}\n\\chi'=\\frac{\\chi}{C_{RK4}^{pre}[k] \\cdot \\Delta t}= \\frac{-\\int \\text{RHS}_{new}^{Pois} dv}{\\int dv} \\rightarrow \\chi = -C_{RK4}^{pre}[k] \\cdot \\Delta t \\cdot \\langle{\\text{RHS}_{new}^{Pois}}\\rangle.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E20.m1\" class=\"ltx_Math\" alttext=\"\\chi^{\\prime}=\\frac{\\chi}{C_{RK4}^{pre}[k]\\cdot\\Delta t}=\\frac{-\\int\\text{RHS}%&#10;_{new}^{Pois}dv}{\\int dv}\\rightarrow\\chi=-C_{RK4}^{pre}[k]\\cdot\\Delta t\\cdot%&#10;\\langle{\\text{RHS}_{new}^{Pois}}\\rangle.\" display=\"block\"><mrow><mrow><msup><mi>\u03c7</mi><mo>\u2032</mo></msup><mo>=</mo><mfrac><mi>\u03c7</mi><mrow><mrow><mrow><msubsup><mi>C</mi><mrow><mi>R</mi><mo>\u2062</mo><mi>K</mi><mo>\u2062</mo><mn>4</mn></mrow><mrow><mi>p</mi><mo>\u2062</mo><mi>r</mi><mo>\u2062</mo><mi>e</mi></mrow></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>k</mi><mo stretchy=\"false\">]</mo></mrow></mrow><mo>\u22c5</mo><mi mathvariant=\"normal\">\u0394</mi></mrow><mo>\u2062</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mo>-</mo><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><msubsup><mtext>RHS</mtext><mrow><mi>n</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>w</mi></mrow><mrow><mi>P</mi><mo>\u2062</mo><mi>o</mi><mo>\u2062</mo><mi>i</mi><mo>\u2062</mo><mi>s</mi></mrow></msubsup><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>v</mi></mrow></mrow></mrow></mrow><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mo>\ud835\udc51</mo><mi>v</mi></mrow></mrow></mfrac><mo>\u2192</mo><mi>\u03c7</mi><mo>=</mo><mrow><mo>-</mo><mrow><mrow><mrow><mrow><msubsup><mi>C</mi><mrow><mi>R</mi><mo>\u2062</mo><mi>K</mi><mo>\u2062</mo><mn>4</mn></mrow><mrow><mi>p</mi><mo>\u2062</mo><mi>r</mi><mo>\u2062</mo><mi>e</mi></mrow></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>k</mi><mo stretchy=\"false\">]</mo></mrow></mrow><mo>\u22c5</mo><mi mathvariant=\"normal\">\u0394</mi></mrow><mo>\u2062</mo><mi>t</mi></mrow><mo>\u22c5</mo><mrow><mo stretchy=\"false\">\u27e8</mo><msubsup><mtext>RHS</mtext><mrow><mi>n</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>w</mi></mrow><mrow><mi>P</mi><mo>\u2062</mo><mi>o</mi><mo>\u2062</mo><mi>i</mi><mo>\u2062</mo><mi>s</mi></mrow></msubsup><mo stretchy=\"false\">\u27e9</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05448.tex", "nexttext": "\nwhere $Q^{(n+1)}$ is set to be $Q^{(n)}$ before entering the RK4 loop.\n\n\n\n\\section{} \\label{sec:appB}\nUsing a uniform staggered grid, our discretization is kinetic energy conservative. We are solving for momentum components, namely $g_x, g_y$, and $g_z$ (e.g., $g_x = \\rho u$). Here, we briefly explain the second-order energy conservative discretization. We use the notation used in Figure \\ref{fig:cons} (without losing generality of the 3D case).\nFor example, consider the following terms for the $x-$momentum equation $\\frac{\\partial}{\\partial x} (\\frac{g_x g_x}{\\rho}) + \\frac{\\partial}{\\partial y} (\\frac{g_x g_y}{\\rho}) + \\frac{\\partial}{\\partial z} (\\frac{g_x g_z}{\\rho})$, where $g_x$, $g_y$, and $g_z$ are momentum in the $x$, $y$, and $z$ directions, respectively. Note that we want all three terms to be computed on the faces (where $x-$momentum variables are stored). \n\n", "itemtype": "equation", "pos": 27196, "prevtext": "\nAfter solving the variable coefficient Poisson equation, we update the momentum based on Eq. (\\ref{eqn:mom}). Note that during the RK4 loop, for a quantity $Q$ with the time evolution equation $\\frac{\\partial Q}{\\partial t}=\\text{RHS}_Q$, we construct $Q^{(n+1)}$ as\n\n", "index": 45, "text": "\\begin{equation}\nQ^{(n+1)}=Q^{(n+1)} + C_{RK4}^{post}[k] \\cdot \\Delta t \\cdot \\text{RHS}_Q [k],\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E21.m1\" class=\"ltx_Math\" alttext=\"Q^{(n+1)}=Q^{(n+1)}+C_{RK4}^{post}[k]\\cdot\\Delta t\\cdot\\text{RHS}_{Q}[k],\" display=\"block\"><mrow><mrow><msup><mi>Q</mi><mrow><mo stretchy=\"false\">(</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></msup><mo>=</mo><mrow><msup><mi>Q</mi><mrow><mo stretchy=\"false\">(</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></msup><mo>+</mo><mrow><mrow><mrow><mrow><mrow><msubsup><mi>C</mi><mrow><mi>R</mi><mo>\u2062</mo><mi>K</mi><mo>\u2062</mo><mn>4</mn></mrow><mrow><mi>p</mi><mo>\u2062</mo><mi>o</mi><mo>\u2062</mo><mi>s</mi><mo>\u2062</mo><mi>t</mi></mrow></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>k</mi><mo stretchy=\"false\">]</mo></mrow></mrow><mo>\u22c5</mo><mi mathvariant=\"normal\">\u0394</mi></mrow><mo>\u2062</mo><mi>t</mi></mrow><mo>\u22c5</mo><msub><mtext>RHS</mtext><mi>Q</mi></msub></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>k</mi><mo stretchy=\"false\">]</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05448.tex", "nexttext": "\n\n", "itemtype": "equation", "pos": 28189, "prevtext": "\nwhere $Q^{(n+1)}$ is set to be $Q^{(n)}$ before entering the RK4 loop.\n\n\n\n\\section{} \\label{sec:appB}\nUsing a uniform staggered grid, our discretization is kinetic energy conservative. We are solving for momentum components, namely $g_x, g_y$, and $g_z$ (e.g., $g_x = \\rho u$). Here, we briefly explain the second-order energy conservative discretization. We use the notation used in Figure \\ref{fig:cons} (without losing generality of the 3D case).\nFor example, consider the following terms for the $x-$momentum equation $\\frac{\\partial}{\\partial x} (\\frac{g_x g_x}{\\rho}) + \\frac{\\partial}{\\partial y} (\\frac{g_x g_y}{\\rho}) + \\frac{\\partial}{\\partial z} (\\frac{g_x g_z}{\\rho})$, where $g_x$, $g_y$, and $g_z$ are momentum in the $x$, $y$, and $z$ directions, respectively. Note that we want all three terms to be computed on the faces (where $x-$momentum variables are stored). \n\n", "index": 47, "text": "\\begin{equation}\n\\begin{split}\n\\Delta x \\cdot \\frac{\\partial}{\\partial x} (\\frac{g_x g_x}{\\rho})_{(I,J)} = \\frac{(\\frac{{g_x}_{(I+1,J)}+{g_x}_{(I,J)}}{2})(\\frac{{g_x}_{(I+1,J)}+{g_x}_{(I,J)}}{2})}{\\rho_{(i,j)}} - \\\\ \\frac{(\\frac{{g_x}_{(I,J)}+{g_x}_{(I-1,J)}}{2})(\\frac{{g_x}_{(I,J)}+{g_x}_{(I-1,J)}}{2})}{\\rho_{(i-1,j)}},\n\\end{split}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E22.m1\" class=\"ltx_Math\" alttext=\"\\begin{split}\\displaystyle\\Delta x\\cdot\\frac{\\partial}{\\partial x}(\\frac{g_{x}%&#10;g_{x}}{\\rho})_{(I,J)}=\\frac{(\\frac{{g_{x}}_{(I+1,J)}+{g_{x}}_{(I,J)}}{2})(%&#10;\\frac{{g_{x}}_{(I+1,J)}+{g_{x}}_{(I,J)}}{2})}{\\rho_{(i,j)}}-\\\\&#10;\\displaystyle\\frac{(\\frac{{g_{x}}_{(I,J)}+{g_{x}}_{(I-1,J)}}{2})(\\frac{{g_{x}}%&#10;_{(I,J)}+{g_{x}}_{(I-1,J)}}{2})}{\\rho_{(i-1,j)}},\\end{split}\" display=\"block\"><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"right\"><mrow><mrow><mrow><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><mi>x</mi></mrow><mo>\u22c5</mo><mfrac><mo>\u2202</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>x</mi></mrow></mfrac></mrow><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">(</mo><mfrac><mrow><msub><mi>g</mi><mi>x</mi></msub><mo>\u2062</mo><msub><mi>g</mi><mi>x</mi></msub></mrow><mi>\u03c1</mi></mfrac><mo stretchy=\"false\">)</mo></mrow><mrow><mo stretchy=\"false\">(</mo><mi>I</mi><mo>,</mo><mi>J</mi><mo stretchy=\"false\">)</mo></mrow></msub></mrow><mo>=</mo><mrow><mfrac><mrow><mrow><mo stretchy=\"false\">(</mo><mfrac><mrow><mmultiscripts><mi>g</mi><mi>x</mi><none/><mrow><mo stretchy=\"false\">(</mo><mrow><mi>I</mi><mo>+</mo><mn>1</mn></mrow><mo>,</mo><mi>J</mi><mo stretchy=\"false\">)</mo></mrow><none/></mmultiscripts><mo>+</mo><mmultiscripts><mi>g</mi><mi>x</mi><none/><mrow><mo stretchy=\"false\">(</mo><mi>I</mi><mo>,</mo><mi>J</mi><mo stretchy=\"false\">)</mo></mrow><none/></mmultiscripts></mrow><mn>2</mn></mfrac><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mfrac><mrow><mmultiscripts><mi>g</mi><mi>x</mi><none/><mrow><mo stretchy=\"false\">(</mo><mrow><mi>I</mi><mo>+</mo><mn>1</mn></mrow><mo>,</mo><mi>J</mi><mo stretchy=\"false\">)</mo></mrow><none/></mmultiscripts><mo>+</mo><mmultiscripts><mi>g</mi><mi>x</mi><none/><mrow><mo stretchy=\"false\">(</mo><mi>I</mi><mo>,</mo><mi>J</mi><mo stretchy=\"false\">)</mo></mrow><none/></mmultiscripts></mrow><mn>2</mn></mfrac><mo stretchy=\"false\">)</mo></mrow></mrow><msub><mi>\u03c1</mi><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=\"false\">)</mo></mrow></msub></mfrac><mo>-</mo></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mrow><mfrac><mrow><mrow><mo stretchy=\"false\">(</mo><mfrac><mrow><mmultiscripts><mi>g</mi><mi>x</mi><none/><mrow><mo stretchy=\"false\">(</mo><mi>I</mi><mo>,</mo><mi>J</mi><mo stretchy=\"false\">)</mo></mrow><none/></mmultiscripts><mo>+</mo><mmultiscripts><mi>g</mi><mi>x</mi><none/><mrow><mo stretchy=\"false\">(</mo><mrow><mi>I</mi><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mi>J</mi><mo stretchy=\"false\">)</mo></mrow><none/></mmultiscripts></mrow><mn>2</mn></mfrac><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mfrac><mrow><mmultiscripts><mi>g</mi><mi>x</mi><none/><mrow><mo stretchy=\"false\">(</mo><mi>I</mi><mo>,</mo><mi>J</mi><mo stretchy=\"false\">)</mo></mrow><none/></mmultiscripts><mo>+</mo><mmultiscripts><mi>g</mi><mi>x</mi><none/><mrow><mo stretchy=\"false\">(</mo><mrow><mi>I</mi><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mi>J</mi><mo stretchy=\"false\">)</mo></mrow><none/></mmultiscripts></mrow><mn>2</mn></mfrac><mo stretchy=\"false\">)</mo></mrow></mrow><msub><mi>\u03c1</mi><mrow><mo stretchy=\"false\">(</mo><mrow><mi>i</mi><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mi>j</mi><mo stretchy=\"false\">)</mo></mrow></msub></mfrac><mo>,</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.05448.tex", "nexttext": "\nIn 3D, all other terms are computed similarly: first, they are interpolated, and then finite difference is applied.\n\n\n\n\n\\bibliographystyle{ctr}\n\n\\begin{thebibliography}{15}\n\\expandafter\\ifx\\csname natexlab\\endcsname\\relax\\def\\natexlab#1{#1}\\fi\n\n\\bibitem[Batchelor {\\em et~al.\\/}(1992)Batchelor, Canuto \\&\n  Chasnov]{batchelor1992homogeneous}\n{\\sc Batchelor, G., Canuto, V. \\& Chasnov, J.~R.} 1992 Homogeneous\n  buoyancy-generated turbulence. {\\em J. Fluid Mech.\\/} {\\bf 235},\n  349--378.\n\n\\bibitem[Eaton \\& Fessler(1994)]{eaton1994preferential}\n{\\sc Eaton, J.~K. \\& Fessler, J.} 1994 Preferential concentration of particles\n  by turbulence. {\\em Int. J. Multiphase Flow\\/} {\\bf 20},\n  169--209.\n\n\\bibitem[Elghobashi \\& Truesdell(1993)]{elghobashi1993two}\n{\\sc Elghobashi, S. \\& Truesdell, G.} 1993 On the two-way interaction between\n  homogeneous turbulence and dispersed solid particles. i: Turbulence\n  modification. {\\em Phys. Fluids A: Fluid Dynamics (1989-1993)\\/} {\\bf\n  5}~(7), 1790--1801.\n\n\\bibitem[Frankel {\\em et~al.\\/}(2014)Frankel, Pouransari, Coletti \\&\n  Mani]{frankel2014settling}\n{\\sc Frankel, A., Pouransari, H., Coletti, F. \\& Mani, A.} 2014 Settling of\n  heated inertial particles through homogeneous turbulence. {\\em Proceedings\n  of the Summer Program\\/}, pp.~15--25.\n\n\\bibitem[Maxey \\& Riley(1983)]{maxey1983equation}\n{\\sc Maxey, M.~R. \\& Riley, J.~J.} 1983 Equation of motion for a small rigid\n  sphere in a nonuniform flow. {\\em Phys. Fluids (1958-1988)\\/} {\\bf\n  26}~(4), 883--889.\n\n\\bibitem[Passot \\& Pouquet(1987)]{passot1987numerical}\n{\\sc Passot, T. \\& Pouquet, A.} 1987 Numerical simulation of compressible\n  homogeneous flows in the turbulent regime. {\\em J. Fluid Mech.\\/}\n  {\\bf 181}, 441--466.\n\n\\bibitem[Plimpton {\\em et~al.\\/}(1997)Plimpton, Pollock \\&\n  Stevens]{plimpton1997particle}\n{\\sc Plimpton, S., Pollock, R. \\& Stevens, M.} 1997 Particle-mesh Ewald and\n  rRESPA for parallel molecular dynamics simulations. In {\\em PPSC\\/}.\n  Citeseer.\n\n\\bibitem[Pouransari {\\em et~al.\\/}(2014)Pouransari, Kolla, Chen \\&\n  Mani]{pouransari2014spectral}\n{\\sc Pouransari, H., Kolla, H., Chen, J. \\& Mani, A.} 2014 Spectral analysis of\n  energy transfer in variable density, radiatively heated particle-laden flows.\n  {\\em Proceedings of the Summer Program, Center for Turbulence Research,\n  Stanford University\\/}, pp.~27--36.\n\n\\bibitem[Rosales \\& Meneveau(2005)]{rosales2005linear}\n{\\sc Rosales, C. \\& Meneveau, C.} 2005 Linear forcing in numerical simulations\n  of isotropic turbulence: Physical space implementations and convergence\n  properties. {\\em Phys. Fluids (1994-present)\\/} {\\bf 17}~(9), 095106.\n\n\\bibitem[Squires \\& Eaton(1990)]{squires1990particle}\n{\\sc Squires, K.~D. \\& Eaton, J.~K.} 1990 Particle response and turbulence\n  modification in isotropic turbulence. {\\em Phys. Fluids A: Fluid\n  Dynamics (1989-1993)\\/} {\\bf 2}~(7), 1191--1203.\n\n\\bibitem[Urzay {\\em et~al.\\/}(2014)Urzay, Bassenne, Park \\&\n  Moin]{urzaycharacteristic}\n{\\sc Urzay, J., Bassenne, M., Park, G. \\& Moin, P.} 2014 Characteristic regimes\n  of subgrid-scale coupling in LES of particle-laden turbulent flows. {\\em Annual Research Briefs, Center for\nTurbulence Research, Stanford University\\/}, pp.~3--13.\n\n\\bibitem[Vi{\\'e} {\\em et~al.\\/}(2015)Vi{\\'e}, Pouransari, Zamansky \\&\n  Mani]{vie2015particle}\n{\\sc Vi{\\'e}, A., Pouransari, H., Zamansky, R. \\& Mani, A.} 2015 Particle-laden\n  flows forced by the disperse phase: comparison between Lagrangian and\n  eulerian simulations. {\\em Int. J. Multiphase Flow\\/}.\n\n\\bibitem[Wang \\& Maxey(1993)]{wang1993settling}\n{\\sc Wang, L.-P. \\& Maxey, M.~R.} 1993 Settling velocity and concentration\n  distribution of heavy particles in homogeneous isotropic turbulence. {\\em\n  J. Fluid Mech.\\/} {\\bf 256}, 27--68.\n\n\\bibitem[Zamansky {\\em et~al.\\/}(2014)Zamansky, Coletti, Massot \\&\n  Mani]{zamansky2014radiation}\n{\\sc Zamansky, R., Coletti, F., Massot, M. \\& Mani, A.} 2014 Radiation induces\n  turbulence in particle-laden fluids. {\\em Phys. Fluids (1994-present)\\/}\n  {\\bf 26}~(7), 071701.\n\n\\bibitem[Pouransari \\& Mani(2015)]{pouransari2015}\n{\\sc Pouransari, H. \\& Mani, A.} 2015 On the effects of preferential concentration on heat transfer in particle-based solar receivers.\n  \n\\end{thebibliography}\n\n\n\n\n\n\n\n", "itemtype": "equation", "pos": 28539, "prevtext": "\n\n", "index": 49, "text": "\\begin{equation}\n\\begin{split}\n\\Delta y \\cdot \\frac{\\partial}{\\partial y} (\\frac{g_x g_y}{\\rho})_{(I,J)} = \\frac{({g_x}_{(I,J+1)}+{g_x}_{(I,J)})({g_y}_{(i',j'+1)}+{g_y}_{(i'-1,j'+1)})}{\\rho_{(i,j)}+\\rho_{(i-1,j)}+\\rho_{(i-1,j+1)}+\\rho_{(i,j+1)}} - \\\\ \\frac{({g_x}_{(I,J-1)}+{g_x}_{(I,J)})({g_y}_{(i',j')}+{g_y}_{(i'-1,j')})}{\\rho_{(i,j)}+\\rho_{(i-1,j)}+\\rho_{(i-1,j-1)}+\\rho_{(i,j-1)}}.\n\\end{split}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E23.m1\" class=\"ltx_Math\" alttext=\"\\begin{split}\\displaystyle\\Delta y\\cdot\\frac{\\partial}{\\partial y}(\\frac{g_{x}%&#10;g_{y}}{\\rho})_{(I,J)}=\\frac{({g_{x}}_{(I,J+1)}+{g_{x}}_{(I,J)})({g_{y}}_{(i^{%&#10;\\prime},j^{\\prime}+1)}+{g_{y}}_{(i^{\\prime}-1,j^{\\prime}+1)})}{\\rho_{(i,j)}+%&#10;\\rho_{(i-1,j)}+\\rho_{(i-1,j+1)}+\\rho_{(i,j+1)}}-\\\\&#10;\\displaystyle\\frac{({g_{x}}_{(I,J-1)}+{g_{x}}_{(I,J)})({g_{y}}_{(i^{\\prime},j^%&#10;{\\prime})}+{g_{y}}_{(i^{\\prime}-1,j^{\\prime})})}{\\rho_{(i,j)}+\\rho_{(i-1,j)}+%&#10;\\rho_{(i-1,j-1)}+\\rho_{(i,j-1)}}.\\end{split}\" display=\"block\"><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"right\"><mrow><mrow><mrow><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><mi>y</mi></mrow><mo>\u22c5</mo><mfrac><mo>\u2202</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>y</mi></mrow></mfrac></mrow><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">(</mo><mfrac><mrow><msub><mi>g</mi><mi>x</mi></msub><mo>\u2062</mo><msub><mi>g</mi><mi>y</mi></msub></mrow><mi>\u03c1</mi></mfrac><mo stretchy=\"false\">)</mo></mrow><mrow><mo stretchy=\"false\">(</mo><mi>I</mi><mo>,</mo><mi>J</mi><mo stretchy=\"false\">)</mo></mrow></msub></mrow><mo>=</mo><mrow><mfrac><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mmultiscripts><mi>g</mi><mi>x</mi><none/><mrow><mo stretchy=\"false\">(</mo><mi>I</mi><mo>,</mo><mrow><mi>J</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><none/></mmultiscripts><mo>+</mo><mmultiscripts><mi>g</mi><mi>x</mi><none/><mrow><mo stretchy=\"false\">(</mo><mi>I</mi><mo>,</mo><mi>J</mi><mo stretchy=\"false\">)</mo></mrow><none/></mmultiscripts></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mmultiscripts><mi>g</mi><mi>y</mi><none/><mrow><mo stretchy=\"false\">(</mo><msup><mi>i</mi><mo>\u2032</mo></msup><mo>,</mo><mrow><msup><mi>j</mi><mo>\u2032</mo></msup><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><none/></mmultiscripts><mo>+</mo><mmultiscripts><mi>g</mi><mi>y</mi><none/><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mi>i</mi><mo>\u2032</mo></msup><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mrow><msup><mi>j</mi><mo>\u2032</mo></msup><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><none/></mmultiscripts></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msub><mi>\u03c1</mi><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=\"false\">)</mo></mrow></msub><mo>+</mo><msub><mi>\u03c1</mi><mrow><mo stretchy=\"false\">(</mo><mrow><mi>i</mi><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mi>j</mi><mo stretchy=\"false\">)</mo></mrow></msub><mo>+</mo><msub><mi>\u03c1</mi><mrow><mo stretchy=\"false\">(</mo><mrow><mi>i</mi><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></msub><mo>+</mo><msub><mi>\u03c1</mi><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo>,</mo><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></msub></mrow></mfrac><mo>-</mo></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mrow><mfrac><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mmultiscripts><mi>g</mi><mi>x</mi><none/><mrow><mo stretchy=\"false\">(</mo><mi>I</mi><mo>,</mo><mrow><mi>J</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><none/></mmultiscripts><mo>+</mo><mmultiscripts><mi>g</mi><mi>x</mi><none/><mrow><mo stretchy=\"false\">(</mo><mi>I</mi><mo>,</mo><mi>J</mi><mo stretchy=\"false\">)</mo></mrow><none/></mmultiscripts></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mmultiscripts><mi>g</mi><mi>y</mi><none/><mrow><mo stretchy=\"false\">(</mo><msup><mi>i</mi><mo>\u2032</mo></msup><mo>,</mo><msup><mi>j</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><none/></mmultiscripts><mo>+</mo><mmultiscripts><mi>g</mi><mi>y</mi><none/><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mi>i</mi><mo>\u2032</mo></msup><mo>-</mo><mn>1</mn></mrow><mo>,</mo><msup><mi>j</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><none/></mmultiscripts></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msub><mi>\u03c1</mi><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=\"false\">)</mo></mrow></msub><mo>+</mo><msub><mi>\u03c1</mi><mrow><mo stretchy=\"false\">(</mo><mrow><mi>i</mi><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mi>j</mi><mo stretchy=\"false\">)</mo></mrow></msub><mo>+</mo><msub><mi>\u03c1</mi><mrow><mo stretchy=\"false\">(</mo><mrow><mi>i</mi><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mrow><mi>j</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></msub><mo>+</mo><msub><mi>\u03c1</mi><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo>,</mo><mrow><mi>j</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></msub></mrow></mfrac><mo>.</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}]