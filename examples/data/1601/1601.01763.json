[{"file": "1601.01763.tex", "nexttext": "\nfor some suitable $K$.\n\n\nThe most obvious connection to the lognormal sum problem is $g=f$, but we shall look\nalso at other possibilities, to take $g$ as the density of $\\log S$ and transform back to get the approximation $\\widehat{f}(x)=$\n$\\widehat{g}(\\log x)/x$ or to use an exponential tilting.\nThe choice of $\\nu$ is a crucial step, and\nthree candidates for $\\nu$ are investigated: the normal, the gamma, and the lognormal distributions.\n\nThe form of the $Q_k$ is classical for the normal distribution where it is the Hermite polynomials and for the gamma where  it is the Laguerre polynomials,\nbut for the lognormal distributions it does not appear to be in the literature and we give here  the functional expression\n(Theorem~\\ref{LogNormalOrthogonalPolynomialProposition}). The Fenton--Wilkinson method may be seen\nas the $K=2$ case of $f_\\nu$ being lognormal of the general scheme, and this choice of $f_\\nu$  may be the most obvious one.\nHowever, we show that in the lognormal case the orthonormal polynomials are not dense in $L_2(f_\\nu)$. This result is closely related\nto the lognormal distribution not being determined by its moments\n\\cite{Heyde63,Berg1984} and indicates that a lognormal $f_\\nu$ is potentially dangerous.\nFor this reason, the rest of the paper concentrates on  taking the reference distribution as normal (using the logarithmic transformation)\nor gamma  (using exponential tilting).\n\nAfter discussing the details of the orthonormal polynomials expansions in Sections~\\ref{S:OrthPol} and~\\ref{S:LN_Appl},\nwe proceed in Section~\\ref{S:numerical} to show a number of numerical examples. The polynomial expansions\nare compared to existing methods as Fenton--Wilkinson and a more recent approximation in terms of log skew normal\ndistributions \\cite{hcine2015highly}, as well as to exact values obtained by numerical quadrature in cases where this\nis possible or by Monte Carlo density estimation. Section~\\ref{S:numerical} also outlines an extension to  statistical data sets and non-Gaussian copulas. Appendices A.1 contains a technical proof\nand Appendix A.2 some new material on the ${\\mathcal{SLN}}$ Laplace transform.\n\n\n\\section{Orthogonal polynomial representation of probability density functions}\n\\label{S:OrthPol}\n\nLet $X$ be a random variable which has a density $f$\nwith respect to some measure $\\lambda\\ge 0$\n(typically Lebesgue measure on an interval or counting measure\non a subset of $\\mathbb{Z}$).  If $f$ is unknown but the distribution of $X$ is\nexpected to be close to some probability measure $\\nu$ with p.d.f.\\ $f_{\\nu}$,\none may use $f_{\\nu}$ as a first approximation to $f$ and next try\nto improve by invoking suitable correction terms.\n\nIn the setting of this paper $X$ is the sum of lognormal r.v.s and the correction terms are obtained by expansions in terms of orthonormal polynomials.\nBefore going into the details of the lognormal example, let us consider the general case.\n\nAssuming all moments of $\\nu$ to be finite,\nthe standard Gram--Schmidt orthogonalization technique shows the existence\nof a set of polynomials $\\{Q_k\\}_{k\\in{\\mathbb{N}_0}}$ which are orthonormal in\n${\\mathcal{L}}^{2}(\\nu)$ equipped with the usual inner product\n$\\left<g,h\\right>=\\int gh \\dif \\nu$ and the corresponding norm\n$\\|g\\|^2=\\left<g,g\\right>$. That is,\nthe $Q_k$ satisfy\n\n", "itemtype": "equation", "pos": 3859, "prevtext": "\n\n\n\\chapter{Orthonormal polynomial expansions \\\\{ }and lognormal sum densities}\nBy S{\\o}ren Asmussen, Pierre-Olivier Goffard, Patrick J.\\ Laub\n\n\\begin{abstract}\nApproximations for an unknown density $g$ in terms of a reference density $f_\\nu$\nand its associated orthonormal polynomials are discussed. The main application is\nthe approximation of the density $f$ of a sum $S$ of lognormals which may have different\nvariances or be dependent. In this setting, $g$ may be $f$ itself or a transformed\ndensity, in particular that of $\\log S$ or an exponentially tilted density.  Choices\nof reference densities $f_\\nu$ that are considered include normal, gamma and lognormal densities.\nFor the lognormal case, the orthonormal polynomials are found in closed form\nand it is shown that they are not dense in $L_2(f_\\nu)$, a result that is closely related\nto the lognormal distribution not being determined by its moments and provides a warning to the most\nobvious choice of taking $f_\\nu$ as lognormal. Numerical examples are presented\nand comparison are made to  established approaches such as the Fenton--Wilkinson method\nand skew-normal approximations. Also extension to density estimation for statistical data sets and non-Gaussian copulas\nare outlined.\\\\\n\\textit{Keywords:} Lognormal distribution, sums of lognormally distributed random variable, orthogonal polynomial,\ndensity estimation, Stieltjes moment problem, numerical approximation of functions, exponential tilting,\nconditional Monte Carlo, Archimedean copula, Gram--Charlier expansion, Hermite polynomial,\nLaguerre polynomial\n\\end{abstract}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\section{Introduction}\\label{S:Intr}\n\nThe lognormal distribution arises in a wide variety of disciplines such\nas engineering, economics, insurance, finance, and\nacross the sciences \\cite{AitchisonBrown1957,CrowShimizu1988,\nJohnsonKotzBalakrishnan94,LimpertStahelAbbt2001,Dufresne2009}.\nTherefore, it is natural that sums $S$ of $n$ lognormals come up in a\nnumber of contexts. A basic example in finance is the\nBlack--Scholes\nmodel, which assumes that security prices are \nlognormals, and hence the value of a\nportfolio with $n$  securities has the form $S$.\n\n\n\nIn  insurance, individual claim sizes are often taken as independent\nlognormals, so the total claim amount in a certain period is\nagain of form \\cite{ThorinWikstad1977}.\nA further example occurs\nin telecommunications, where\nthe inverse of the signal-to-noise ratio (a measure of performance in\nwireless systems)\ncan be modeled as a sum of i.i.d.\\ lognormals \\citep{Gubner2006}.\n\nThe distribution $S$ is, however, not available\nin explicit form,\nand evaluating it numerically or approximating it is considered to be a challenging problem\nwith a long history.\nThe classical approach is to use an approximation\nwith another lognormal distribution.  This goes back at least to\n\\cite{Fenton1960} and it is nowadays\nknown as the \\emph{Fenton--Wilkinson method} as\naccording to \\cite{Marlow1967} this approximation was already\nused by Wilkinson in 1934.\nHowever, it can be rather inaccurate when the number of summands is rather small, or\nwhen the dispersion\nparameter is too high.\nAlso tail approximations have been extensively discussed, with the\nright tail being a classical example in subexponential theory,\\cite{EKM97}, and the\nstudy of the left tail being more recent, \\cite{AsJeRo14b}, \\cite{GuTa13}.\n\n\nThis paper discusses a different method, to approximate the probability density function (p.d.f.) $f$ via polynomials $\\{Q_k\\}$ which are orthonormal w.r.t.\\ some reference\nmeasure $\\nu$. In the general formulation, one is interested in approximating a target density $g$ using the density $f_\\nu$ of $\\nu$\nas reference and $g$ some other density. One then finds\na series representation of $g/f_\\nu$ of the form $\\sum_{k=0}^\\infty a_k Q_k$,\nand then the approximation of $g$ is\n\n", "index": 1, "text": "\\begin{equation} \\label{orthog_approx}\n\t\\widehat{g}(x)\\ =\\ g_\\nu(x) \\sum_{k=0}^K a_k Q_k(x),\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"\\widehat{g}(x)\\ =\\ g_{\\nu}(x)\\sum_{k=0}^{K}a_{k}Q_{k}(x),\" display=\"block\"><mrow><mrow><mrow><mover accent=\"true\"><mi>g</mi><mo>^</mo></mover><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo rspace=\"7.5pt\" stretchy=\"false\">)</mo></mrow></mrow><mo rspace=\"7.5pt\">=</mo><mrow><msub><mi>g</mi><mi>\u03bd</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mi>K</mi></munderover><mrow><msub><mi>a</mi><mi>k</mi></msub><mo>\u2062</mo><msub><mi>Q</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nwhere $\\delta_{ij}$ denotes the Kronecker symbol.\nIf there exists an $\\alpha>0$ such that\n\n", "itemtype": "equation", "pos": 7276, "prevtext": "\nfor some suitable $K$.\n\n\nThe most obvious connection to the lognormal sum problem is $g=f$, but we shall look\nalso at other possibilities, to take $g$ as the density of $\\log S$ and transform back to get the approximation $\\widehat{f}(x)=$\n$\\widehat{g}(\\log x)/x$ or to use an exponential tilting.\nThe choice of $\\nu$ is a crucial step, and\nthree candidates for $\\nu$ are investigated: the normal, the gamma, and the lognormal distributions.\n\nThe form of the $Q_k$ is classical for the normal distribution where it is the Hermite polynomials and for the gamma where  it is the Laguerre polynomials,\nbut for the lognormal distributions it does not appear to be in the literature and we give here  the functional expression\n(Theorem~\\ref{LogNormalOrthogonalPolynomialProposition}). The Fenton--Wilkinson method may be seen\nas the $K=2$ case of $f_\\nu$ being lognormal of the general scheme, and this choice of $f_\\nu$  may be the most obvious one.\nHowever, we show that in the lognormal case the orthonormal polynomials are not dense in $L_2(f_\\nu)$. This result is closely related\nto the lognormal distribution not being determined by its moments\n\\cite{Heyde63,Berg1984} and indicates that a lognormal $f_\\nu$ is potentially dangerous.\nFor this reason, the rest of the paper concentrates on  taking the reference distribution as normal (using the logarithmic transformation)\nor gamma  (using exponential tilting).\n\nAfter discussing the details of the orthonormal polynomials expansions in Sections~\\ref{S:OrthPol} and~\\ref{S:LN_Appl},\nwe proceed in Section~\\ref{S:numerical} to show a number of numerical examples. The polynomial expansions\nare compared to existing methods as Fenton--Wilkinson and a more recent approximation in terms of log skew normal\ndistributions \\cite{hcine2015highly}, as well as to exact values obtained by numerical quadrature in cases where this\nis possible or by Monte Carlo density estimation. Section~\\ref{S:numerical} also outlines an extension to  statistical data sets and non-Gaussian copulas. Appendices A.1 contains a technical proof\nand Appendix A.2 some new material on the ${\\mathcal{SLN}}$ Laplace transform.\n\n\n\\section{Orthogonal polynomial representation of probability density functions}\n\\label{S:OrthPol}\n\nLet $X$ be a random variable which has a density $f$\nwith respect to some measure $\\lambda\\ge 0$\n(typically Lebesgue measure on an interval or counting measure\non a subset of $\\mathbb{Z}$).  If $f$ is unknown but the distribution of $X$ is\nexpected to be close to some probability measure $\\nu$ with p.d.f.\\ $f_{\\nu}$,\none may use $f_{\\nu}$ as a first approximation to $f$ and next try\nto improve by invoking suitable correction terms.\n\nIn the setting of this paper $X$ is the sum of lognormal r.v.s and the correction terms are obtained by expansions in terms of orthonormal polynomials.\nBefore going into the details of the lognormal example, let us consider the general case.\n\nAssuming all moments of $\\nu$ to be finite,\nthe standard Gram--Schmidt orthogonalization technique shows the existence\nof a set of polynomials $\\{Q_k\\}_{k\\in{\\mathbb{N}_0}}$ which are orthonormal in\n${\\mathcal{L}}^{2}(\\nu)$ equipped with the usual inner product\n$\\left<g,h\\right>=\\int gh \\dif \\nu$ and the corresponding norm\n$\\|g\\|^2=\\left<g,g\\right>$. That is,\nthe $Q_k$ satisfy\n\n", "index": 3, "text": "\\begin{equation}\\label{OrthogonalityCondition}\n\\left<Q_i,Q_j\\right>=\\int Q_i(x)Q_j(x) \\dif \\nu(x)=\\delta_{ij} \\,, \\quad i, j \\in{\\mathbb{N}_0},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"\\left&lt;Q_{i},Q_{j}\\right&gt;=\\int Q_{i}(x)Q_{j}(x)\\dif\\nu(x)=\\delta_{ij}\\,,\\quad i%&#10;,j\\in{\\mathbb{N}_{0}},\" display=\"block\"><mrow><mrow><mrow><mrow><mo>\u27e8</mo><msub><mi>Q</mi><mi>i</mi></msub><mo>,</mo><msub><mi>Q</mi><mi>j</mi></msub><mo>\u27e9</mo></mrow><mo>=</mo><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><msub><mi>Q</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>Q</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\dif</mtext></merror><mo>\u2062</mo><mi>\u03bd</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>=</mo><mpadded width=\"+1.7pt\"><msub><mi>\u03b4</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub></mpadded></mrow><mo rspace=\"12.5pt\">,</mo><mrow><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow><mo>\u2208</mo><msub><mi>\u2115</mi><mn>0</mn></msub></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nthe set  $\\{Q_k\\}_{k\\in{\\mathbb{N}_0}}$ is complete in ${\\mathcal{L}}^{2}(\\nu)$, cf.\\ Chapter $7$ of the book by Nagy \\cite{Na65}. The implication is that if $f/f_\\nu$ is in ${\\mathcal{L}}^{2}(\\nu)$, that is, if\n\n", "itemtype": "equation", "pos": 7525, "prevtext": "\nwhere $\\delta_{ij}$ denotes the Kronecker symbol.\nIf there exists an $\\alpha>0$ such that\n\n", "index": 5, "text": "\\begin{equation}\\label{DefinedMGFCondition}\n\\int {\\mathrm{e}}^{\\alpha|x|} \\dif \\nu(x) < \\infty\\,,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"\\int{\\mathrm{e}}^{\\alpha|x|}\\dif\\nu(x)&lt;\\infty\\,,\" display=\"block\"><mrow><mrow><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><msup><mi mathvariant=\"normal\">e</mi><mrow><mi>\u03b1</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mi>x</mi><mo stretchy=\"false\">|</mo></mrow></mrow></msup><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\dif</mtext></merror><mo>\u2062</mo><mi>\u03bd</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>&lt;</mo><mpadded width=\"+1.7pt\"><mi mathvariant=\"normal\">\u221e</mi></mpadded></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nwe may expand $f/f_\\nu$ as $\\sum_{k=0}^\\infty a_k Q_k$ where\n\n", "itemtype": "equation", "pos": 7850, "prevtext": "\nthe set  $\\{Q_k\\}_{k\\in{\\mathbb{N}_0}}$ is complete in ${\\mathcal{L}}^{2}(\\nu)$, cf.\\ Chapter $7$ of the book by Nagy \\cite{Na65}. The implication is that if $f/f_\\nu$ is in ${\\mathcal{L}}^{2}(\\nu)$, that is, if\n\n", "index": 7, "text": "\\begin{equation}\\label{L2Condition1}\n\\int \\frac{f(x)^2}{f_\\nu(x)^2}\\dif \\nu(x)\\ =\\ \\int \\frac{f(x)^2}{f_\\nu(x)}\\dif \\lambda(x)\\ <\\ \\infty\\,,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"\\int\\frac{f(x)^{2}}{f_{\\nu}(x)^{2}}\\dif\\nu(x)\\ =\\ \\int\\frac{f(x)^{2}}{f_{\\nu}(%&#10;x)}\\dif\\lambda(x)\\ &lt;\\ \\infty\\,,\" display=\"block\"><mrow><mrow><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mfrac><mrow><mi>f</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></mrow><mrow><msub><mi>f</mi><mi>\u03bd</mi></msub><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></mrow></mfrac><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\dif</mtext></merror><mo>\u2062</mo><mi>\u03bd</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo rspace=\"7.5pt\" stretchy=\"false\">)</mo></mrow></mrow></mrow><mo rspace=\"7.5pt\">=</mo><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mfrac><mrow><mi>f</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></mrow><mrow><msub><mi>f</mi><mi>\u03bd</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\dif</mtext></merror><mo>\u2062</mo><mi>\u03bb</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo rspace=\"7.5pt\" stretchy=\"false\">)</mo></mrow></mrow></mrow><mo rspace=\"7.5pt\">&lt;</mo><mpadded width=\"+1.7pt\"><mi mathvariant=\"normal\">\u221e</mi></mpadded></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nThis suggests that we use \\eqref{orthog_approx} as an approximation of $f$ in situations where the p.d.f.\\ of $X$ is unknown but the moments are accessible.\n\n\\begin{remark}\\label{Rem:27.10a}\nIf the first $m$ moments of $X$ and $\\nu$ coincide, one has $a_k=0$ for $k=1$, \\ldots, $m$.\nWhen choosing $\\nu$, a possible guideline is therefore to match as many moments as possible.\n\\hfill $\\Diamond$\n\\end{remark}\n\nDue to the Parseval relationship $\\sum_{k=0}^\\infty a_k^2=\\|f/f_\\nu\\|^2$, the coefficients of the polynomial expansion, $\\{a_k\\}_{k\\in{\\mathbb{N}_0}}$, tend toward $0$ as $k \\to \\infty$. The accuracy of the approximation \\eqref{orthog_approx}, for a given order of truncation $K$, depends upon how swiftly the coefficients decay; note that the ${\\mathcal{L}}^{2}$ loss of the approximation of $f/f_\\nu$ is $\\sum_{K+1}^{\\infty}a_k^2$.\n\nNote also that the orthogonal polynomials can be specified recursively\n(see Thm.~3.2.1 of \\cite{Sz39}) which allows a reduction of the computing time required for the coefficients' evaluation\nand makes it feasible to consider rather large $K$.\n\n\n\n\\subsection{Normal reference distribution}\\label{SS:NormalNu}\nA common choice as a reference distribution is the normal $\\mathcal{N}(\\mu,\\sigma^{2})$. The associated orthonormal polynomial are given by\n\n", "itemtype": "equation", "pos": 8067, "prevtext": "\nwe may expand $f/f_\\nu$ as $\\sum_{k=0}^\\infty a_k Q_k$ where\n\n", "index": 9, "text": "\\begin{align}\\label{28.10a}a_k\\ &=\n\\left<f/f_\\nu,Q_k\\right>\\ =\\ \\int f Q_k\\,\\dif\\lambda\\ =\\ {\\mathbb{E}}\\left[Q_k(X)\\right]\\,.\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle a_{k}\" display=\"inline\"><msub><mi>a</mi><mi>k</mi></msub></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\left&lt;f/f_{\\nu},Q_{k}\\right&gt;\\ =\\ \\int fQ_{k}\\,\\dif\\lambda\\ =\\ {%&#10;\\mathbb{E}}\\left[Q_{k}(X)\\right]\\,.\" display=\"inline\"><mrow><mrow><mi/><mo>=</mo><mrow><mo>\u27e8</mo><mrow><mi>f</mi><mo>/</mo><msub><mi>f</mi><mi>\u03bd</mi></msub></mrow><mo>,</mo><msub><mi>Q</mi><mi>k</mi></msub><mo rspace=\"7.5pt\">\u27e9</mo></mrow><mo rspace=\"7.5pt\">=</mo><mstyle displaystyle=\"true\"><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mi>f</mi><mo>\u2062</mo><mpadded width=\"+1.7pt\"><msub><mi>Q</mi><mi>k</mi></msub></mpadded><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\dif</mtext></merror><mo>\u2062</mo><mpadded width=\"+5pt\"><mi>\u03bb</mi></mpadded></mrow></mrow></mstyle><mo rspace=\"7.5pt\">=</mo><mrow><mi>\ud835\udd3c</mi><mo>\u2062</mo><mrow><mo>[</mo><mrow><msub><mi>Q</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo rspace=\"4.2pt\">]</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nwhere $\\left\\{H_{k}\\right\\}_{k\\in{\\mathbb{N}_0}}$ are the Hermite polynomials, defined in \\cite{Sz39} for instance.\nIf $f$ is continuous, a sufficient (and close to necessary) condition for $f/f_\\nu\\in{\\mathcal{L}}^2(\\nu)$ is\n\n", "itemtype": "equation", "pos": 9498, "prevtext": "\nThis suggests that we use \\eqref{orthog_approx} as an approximation of $f$ in situations where the p.d.f.\\ of $X$ is unknown but the moments are accessible.\n\n\\begin{remark}\\label{Rem:27.10a}\nIf the first $m$ moments of $X$ and $\\nu$ coincide, one has $a_k=0$ for $k=1$, \\ldots, $m$.\nWhen choosing $\\nu$, a possible guideline is therefore to match as many moments as possible.\n\\hfill $\\Diamond$\n\\end{remark}\n\nDue to the Parseval relationship $\\sum_{k=0}^\\infty a_k^2=\\|f/f_\\nu\\|^2$, the coefficients of the polynomial expansion, $\\{a_k\\}_{k\\in{\\mathbb{N}_0}}$, tend toward $0$ as $k \\to \\infty$. The accuracy of the approximation \\eqref{orthog_approx}, for a given order of truncation $K$, depends upon how swiftly the coefficients decay; note that the ${\\mathcal{L}}^{2}$ loss of the approximation of $f/f_\\nu$ is $\\sum_{K+1}^{\\infty}a_k^2$.\n\nNote also that the orthogonal polynomials can be specified recursively\n(see Thm.~3.2.1 of \\cite{Sz39}) which allows a reduction of the computing time required for the coefficients' evaluation\nand makes it feasible to consider rather large $K$.\n\n\n\n\\subsection{Normal reference distribution}\\label{SS:NormalNu}\nA common choice as a reference distribution is the normal $\\mathcal{N}(\\mu,\\sigma^{2})$. The associated orthonormal polynomial are given by\n\n", "index": 11, "text": "\\begin{equation}\\label{eq:NormalDistributionOrthogonalPolynomial}\nQ_{k}(x)=\\frac{1}{k!2^{k/2}}H_{k}\\left(\\frac{x-\\mu}{\\sigma\\sqrt{2}}\\right),\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"Q_{k}(x)=\\frac{1}{k!2^{k/2}}H_{k}\\left(\\frac{x-\\mu}{\\sigma\\sqrt{2}}\\right),\" display=\"block\"><mrow><mrow><mrow><msub><mi>Q</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><mrow><mrow><mi>k</mi><mo lspace=\"0pt\" rspace=\"3.5pt\">!</mo></mrow><mo>\u2062</mo><msup><mn>2</mn><mrow><mi>k</mi><mo>/</mo><mn>2</mn></mrow></msup></mrow></mfrac><mo>\u2062</mo><msub><mi>H</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo>(</mo><mfrac><mrow><mi>x</mi><mo>-</mo><mi>\u03bc</mi></mrow><mrow><mi>\u03c3</mi><mo>\u2062</mo><msqrt><mn>2</mn></msqrt></mrow></mfrac><mo>)</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nIndeed, we can  write the integral in \\eqref{L2Condition1} as $I_1+I_2+I_3$, the integrals over\n$(-\\infty,-A)$, $[-A,A]$, resp.\\ $(A,\\infty)$. Note that $I_2<\\infty$  follows since the integrand\nis finite by continuity, whereas the finiteness of $I_1,I_3$ is ensured by the integrands\nbeing ${\\mathcal{O}}({\\mathrm{e}}^{-bx^2})$ where $b=2a-1/2\\sigma^2>0$. Similar arguments apply to\nconditions \\eqref{SA7.11b} and \\eqref{SA7.11c} below.\n\\begin{remark}\nThe expansion formed by a standard normal baseline distribution and Hermite polynomials is known in the literature as Gram--Charlier expansion of type A, and the application to a standardised sum is the Edgeworth expansion, cf.\\ \\cite{Cr99}, \\cite{Barndorff1989asymptotic}. \\hfill $\\Diamond$\n\\end{remark}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\subsection{Gamma reference distribution}\\label{SS:GammaNu}\nIf $X$ has support $(0,\\infty)$, it is natural to look for a $\\nu$ with the same property.\nOne of the most apparent possibilities is the\ngamma distribution, denoted Gamma$(r,m)$ where $r$ is the shape parameter\nand $m$ the scale parameter.\nThe p.d.f.\\ is\n\n", "itemtype": "equation", "pos": 9881, "prevtext": "\nwhere $\\left\\{H_{k}\\right\\}_{k\\in{\\mathbb{N}_0}}$ are the Hermite polynomials, defined in \\cite{Sz39} for instance.\nIf $f$ is continuous, a sufficient (and close to necessary) condition for $f/f_\\nu\\in{\\mathcal{L}}^2(\\nu)$ is\n\n", "index": 13, "text": "\\begin{equation}\\label{SA7.11a}\nf(x)\\ =\\ {\\mathcal{O}}\\big({\\mathrm{e}}^{-ax^2}\\big)\\quad\\text{as }x\\to\\pm\\infty\\quad\\text{with } a>\\big(4\\sigma^2\\big)^{-1}\\,.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"f(x)\\ =\\ {\\mathcal{O}}\\big{(}{\\mathrm{e}}^{-ax^{2}}\\big{)}\\quad\\text{as }x\\to%&#10;\\pm\\infty\\quad\\text{with }a&gt;\\big{(}4\\sigma^{2}\\big{)}^{-1}\\,.\" display=\"block\"><mrow><mrow><mrow><mrow><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo rspace=\"7.5pt\" stretchy=\"false\">)</mo></mrow></mrow><mo rspace=\"7.5pt\">=</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcaa</mi><mo>\u2062</mo><mrow><mo maxsize=\"120%\" minsize=\"120%\">(</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mo>-</mo><mrow><mi>a</mi><mo>\u2062</mo><msup><mi>x</mi><mn>2</mn></msup></mrow></mrow></msup><mo maxsize=\"120%\" minsize=\"120%\">)</mo></mrow></mrow></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003</mo><mrow><mrow><mrow><mtext>as\u00a0</mtext><mo>\u2062</mo><mi>x</mi></mrow><mo>\u2192</mo><mrow><mo>\u00b1</mo><mi mathvariant=\"normal\">\u221e</mi></mrow></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003</mo><mrow><mrow><mtext>with\u00a0</mtext><mo>\u2062</mo><mi>a</mi></mrow><mo>&gt;</mo><mpadded width=\"+1.7pt\"><msup><mrow><mo maxsize=\"120%\" minsize=\"120%\">(</mo><mrow><mn>4</mn><mo>\u2062</mo><msup><mi>\u03c3</mi><mn>2</mn></msup></mrow><mo maxsize=\"120%\" minsize=\"120%\">)</mo></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup></mpadded></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nThe associated polynomials are given by\n\n", "itemtype": "equation", "pos": 11145, "prevtext": "\nIndeed, we can  write the integral in \\eqref{L2Condition1} as $I_1+I_2+I_3$, the integrals over\n$(-\\infty,-A)$, $[-A,A]$, resp.\\ $(A,\\infty)$. Note that $I_2<\\infty$  follows since the integrand\nis finite by continuity, whereas the finiteness of $I_1,I_3$ is ensured by the integrands\nbeing ${\\mathcal{O}}({\\mathrm{e}}^{-bx^2})$ where $b=2a-1/2\\sigma^2>0$. Similar arguments apply to\nconditions \\eqref{SA7.11b} and \\eqref{SA7.11c} below.\n\\begin{remark}\nThe expansion formed by a standard normal baseline distribution and Hermite polynomials is known in the literature as Gram--Charlier expansion of type A, and the application to a standardised sum is the Edgeworth expansion, cf.\\ \\cite{Cr99}, \\cite{Barndorff1989asymptotic}. \\hfill $\\Diamond$\n\\end{remark}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\subsection{Gamma reference distribution}\\label{SS:GammaNu}\nIf $X$ has support $(0,\\infty)$, it is natural to look for a $\\nu$ with the same property.\nOne of the most apparent possibilities is the\ngamma distribution, denoted Gamma$(r,m)$ where $r$ is the shape parameter\nand $m$ the scale parameter.\nThe p.d.f.\\ is\n\n", "index": 15, "text": "\\begin{equation} \\label{GammaPDF}\nf_{\\nu}(x)=\\frac{x^{r-1} {\\mathrm{e}}^{-x/m}}{m^{r}\\Gamma(r)},\\hspace{0.2cm}x\\in {\\mathbb{R}}_+ \\,.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m1\" class=\"ltx_Math\" alttext=\"f_{\\nu}(x)=\\frac{x^{r-1}{\\mathrm{e}}^{-x/m}}{m^{r}\\Gamma(r)},\\hskip 5.690551%&#10;ptx\\in{\\mathbb{R}}_{+}\\,.\" display=\"block\"><mrow><mrow><mrow><mrow><msub><mi>f</mi><mi>\u03bd</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mfrac><mrow><msup><mi>x</mi><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mo>-</mo><mrow><mi>x</mi><mo>/</mo><mi>m</mi></mrow></mrow></msup></mrow><mrow><msup><mi>m</mi><mi>r</mi></msup><mo>\u2062</mo><mi mathvariant=\"normal\">\u0393</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mrow><mo rspace=\"8.2pt\">,</mo><mrow><mi>x</mi><mo>\u2208</mo><mpadded width=\"+1.7pt\"><msub><mi>\u211d</mi><mo>+</mo></msub></mpadded></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\n\n\n\nwhere $\\{L^{r-1}_{n}\\}_{n\\in{\\mathbb{N}_0}}$ denote the \\emph{generalised Laguerre polynomials}, see \\cite{Sz39}; in Mathematica these are accessible via the \\texttt{LaguerreL} function.\n\n\n\n\n\n\n\nSimilarly to \\eqref{SA7.11a}, one has the following condition for $f/f_\\nu\\in{\\mathcal{L}}^2(\\nu)$:\n\n", "itemtype": "equation", "pos": 11334, "prevtext": "\nThe associated polynomials are given by\n\n", "index": 17, "text": "\\begin{equation} \\label{OrthogonalPolynomialGammaDistribution}\nQ_{n}(x)=(-1)^{n}\\left[\\frac{\\Gamma(n+r)}{\\Gamma(n+1)\\Gamma(r)}\\right]^{-1/2}L_{n}^{r-1}(x/m),\\hspace{0.2cm} n\\in{\\mathbb{N}_0},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m1\" class=\"ltx_Math\" alttext=\"Q_{n}(x)=(-1)^{n}\\left[\\frac{\\Gamma(n+r)}{\\Gamma(n+1)\\Gamma(r)}\\right]^{-1/2}L%&#10;_{n}^{r-1}(x/m),\\hskip 5.690551ptn\\in{\\mathbb{N}_{0}},\" display=\"block\"><mrow><mrow><mrow><mrow><msub><mi>Q</mi><mi>n</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mi>n</mi></msup><mo>\u2062</mo><msup><mrow><mo>[</mo><mfrac><mrow><mi mathvariant=\"normal\">\u0393</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>n</mi><mo>+</mo><mi>r</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mi mathvariant=\"normal\">\u0393</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi mathvariant=\"normal\">\u0393</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac><mo>]</mo></mrow><mrow><mo>-</mo><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow></mrow></msup><mo>\u2062</mo><msubsup><mi>L</mi><mi>n</mi><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>x</mi><mo>/</mo><mi>m</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo rspace=\"8.2pt\">,</mo><mrow><mi>n</mi><mo>\u2208</mo><msub><mi>\u2115</mi><mn>0</mn></msub></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\n\n\n\n\n\n\n\n\n\n\n\\subsection{Lognormal reference distribution}\\label{SS:LogNNu}\nThe lognormal distribution ${\\mathcal{LN}}(\\mu, \\sigma^2)$ is the distribution of ${\\mathrm{e}}^Y$ where $Y \\sim {\\mathcal{N}}(\\mu, \\sigma^2)$. It has support on ${\\mathbb{R}}_+$. The polynomials orthogonal to the ${\\mathcal{LN}}(\\mu, \\sigma^2)$ are given in the following proposition, to be proved in the Appendix:\n\n\\begin{theorem}\\label{LogNormalOrthogonalPolynomialProposition}\nThe polynomials orthonormal with respect to the lognormal distribution are given by\n\n", "itemtype": "equation", "pos": 11838, "prevtext": "\n\n\n\nwhere $\\{L^{r-1}_{n}\\}_{n\\in{\\mathbb{N}_0}}$ denote the \\emph{generalised Laguerre polynomials}, see \\cite{Sz39}; in Mathematica these are accessible via the \\texttt{LaguerreL} function.\n\n\n\n\n\n\n\nSimilarly to \\eqref{SA7.11a}, one has the following condition for $f/f_\\nu\\in{\\mathcal{L}}^2(\\nu)$:\n\n", "index": 19, "text": "\\begin{gather}\\begin{split}\\label{SA7.11b}\nf(x)\\ &=\\ {\\mathcal{O}}\\big({\\mathrm{e}}^{-\\delta x}\\big)\\quad\\text{as }x\\to\\infty\\quad\\text{with } \\delta>1/2m\\,, \\text{ and }\\\\\nf(x)\\ &=\\ {\\mathcal{O}}\\big(x^\\beta\\big)\\quad\\text{as }x\\to 0\\quad\\text{with }\\beta>r/2-1\\,.\n\\end{split}\\end{gather}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E10.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\begin{split}\\displaystyle f(x)&amp;\\displaystyle=\\ {\\mathcal{O}}\\big%&#10;{(}{\\mathrm{e}}^{-\\delta x}\\big{)}\\quad\\text{as }x\\to\\infty\\quad\\text{with }%&#10;\\delta&gt;1/2m\\,,\\text{ and }\\\\&#10;\\displaystyle f(x)&amp;\\displaystyle=\\ {\\mathcal{O}}\\big{(}x^{\\beta}\\big{)}\\quad%&#10;\\text{as }x\\to 0\\quad\\text{with }\\beta&gt;r/2-1\\,.\\end{split}\" display=\"block\"><mtable columnspacing=\"0pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"right\"><mrow><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mi/><mo rspace=\"7.5pt\">=</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcaa</mi><mo>\u2062</mo><mrow><mo maxsize=\"120%\" minsize=\"120%\">(</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mo>-</mo><mrow><mi>\u03b4</mi><mo>\u2062</mo><mi>x</mi></mrow></mrow></msup><mo maxsize=\"120%\" minsize=\"120%\">)</mo></mrow></mrow></mrow><mo separator=\"true\">\u2003</mo><mrow><mrow><mrow><mtext>as\u00a0</mtext><mo>\u2062</mo><mi>x</mi></mrow><mo>\u2192</mo><mi mathvariant=\"normal\">\u221e</mi></mrow><mo separator=\"true\">\u2003</mo><mrow><mrow><mtext>with\u00a0</mtext><mo>\u2062</mo><mi>\u03b4</mi></mrow><mo>&gt;</mo><mrow><mrow><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow><mo>\u2062</mo><mpadded width=\"+1.7pt\"><mi>m</mi></mpadded></mrow><mo>,</mo><mtext>\u00a0and\u00a0</mtext></mrow></mrow></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mrow><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mrow><mi/><mo rspace=\"7.5pt\">=</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcaa</mi><mo>\u2062</mo><mrow><mo maxsize=\"120%\" minsize=\"120%\">(</mo><msup><mi>x</mi><mi>\u03b2</mi></msup><mo maxsize=\"120%\" minsize=\"120%\">)</mo></mrow></mrow></mrow><mo separator=\"true\">\u2003</mo><mrow><mrow><mrow><mtext>as\u00a0</mtext><mo>\u2062</mo><mi>x</mi></mrow><mo>\u2192</mo><mn>0</mn></mrow><mo separator=\"true\">\u2003</mo><mrow><mrow><mtext>with\u00a0</mtext><mo>\u2062</mo><mi>\u03b2</mi></mrow><mo>&gt;</mo><mrow><mrow><mi>r</mi><mo>/</mo><mn>2</mn></mrow><mo>-</mo><mpadded width=\"+1.7pt\"><mn>1</mn></mpadded></mrow></mrow></mrow></mrow><mo>.</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nfor $k\\in{\\mathbb{N}_0}$ where\n\n", "itemtype": "equation", "pos": 12666, "prevtext": "\n\n\n\n\n\n\n\n\n\n\n\\subsection{Lognormal reference distribution}\\label{SS:LogNNu}\nThe lognormal distribution ${\\mathcal{LN}}(\\mu, \\sigma^2)$ is the distribution of ${\\mathrm{e}}^Y$ where $Y \\sim {\\mathcal{N}}(\\mu, \\sigma^2)$. It has support on ${\\mathbb{R}}_+$. The polynomials orthogonal to the ${\\mathcal{LN}}(\\mu, \\sigma^2)$ are given in the following proposition, to be proved in the Appendix:\n\n\\begin{theorem}\\label{LogNormalOrthogonalPolynomialProposition}\nThe polynomials orthonormal with respect to the lognormal distribution are given by\n\n", "index": 21, "text": "\\begin{equation}\\label{eq:OrthonormalPolynomialLogNormalExpression}\nQ_{k}(x)=\\frac{{\\mathrm{e}}^{-\\frac{k^{2}\\sigma^{2}}{2}}}{\\sqrt{\\left[{\\mathrm{e}}^{-\\sigma^{2}},{\\mathrm{e}}^{-\\sigma^{2}}\\right]_{k}}}\\sum_{i=0}^{k}(-1)^{k+i}{\\mathrm{e}}^{-i\\mu-\\frac{i^{2}\\sigma^{2}}{2}}e_{k-i}\\left(1,\\ldots,{\\mathrm{e}}^{(k-1)\\sigma^{2}}\\right)x^{i},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E11.m1\" class=\"ltx_Math\" alttext=\"Q_{k}(x)=\\frac{{\\mathrm{e}}^{-\\frac{k^{2}\\sigma^{2}}{2}}}{\\sqrt{\\left[{\\mathrm%&#10;{e}}^{-\\sigma^{2}},{\\mathrm{e}}^{-\\sigma^{2}}\\right]_{k}}}\\sum_{i=0}^{k}(-1)^{%&#10;k+i}{\\mathrm{e}}^{-i\\mu-\\frac{i^{2}\\sigma^{2}}{2}}e_{k-i}\\left(1,\\ldots,{%&#10;\\mathrm{e}}^{(k-1)\\sigma^{2}}\\right)x^{i},\" display=\"block\"><mrow><mrow><mrow><msub><mi>Q</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><msup><mi mathvariant=\"normal\">e</mi><mrow><mo>-</mo><mfrac><mrow><msup><mi>k</mi><mn>2</mn></msup><mo>\u2062</mo><msup><mi>\u03c3</mi><mn>2</mn></msup></mrow><mn>2</mn></mfrac></mrow></msup><msqrt><msub><mrow><mo>[</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mo>-</mo><msup><mi>\u03c3</mi><mn>2</mn></msup></mrow></msup><mo>,</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mo>-</mo><msup><mi>\u03c3</mi><mn>2</mn></msup></mrow></msup><mo>]</mo></mrow><mi>k</mi></msub></msqrt></mfrac><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>k</mi></munderover><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mi>k</mi><mo>+</mo><mi>i</mi></mrow></msup><mo>\u2062</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mrow><mo>-</mo><mrow><mi>i</mi><mo>\u2062</mo><mi>\u03bc</mi></mrow></mrow><mo>-</mo><mfrac><mrow><msup><mi>i</mi><mn>2</mn></msup><mo>\u2062</mo><msup><mi>\u03c3</mi><mn>2</mn></msup></mrow><mn>2</mn></mfrac></mrow></msup><mo>\u2062</mo><msub><mi>e</mi><mrow><mi>k</mi><mo>-</mo><mi>i</mi></mrow></msub><mo>\u2062</mo><mrow><mo>(</mo><mn>1</mn><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>k</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msup><mi>\u03c3</mi><mn>2</mn></msup></mrow></msup><mo>)</mo></mrow><mo>\u2062</mo><msup><mi>x</mi><mi>i</mi></msup></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nare the elementary symmetric polynomials and $\\left[x,q\\right]_{n}=\\prod_{i=0}^{n-1}\\left(1-xq^{i}\\right)$ is the Q-Pochhammer symbol.\n\\end{theorem}\n\n\n\n\n\\begin{remark}\\label{Rem:27.10b}\nThe result of Theorem~\\ref{LogNormalOrthogonalPolynomialProposition}\ndoes not appear to be in the literature; the closest reference\nseems to be a 1923 paper by Wigert~\\cite{Wi23} who considers\nthe distribution with p.d.f.\\\n\n$\\ell{\\mathrm{e}}^{-\\ell^{2}\\ln^{2}(x)}/\\sqrt{{\\uppi}}$\n(later called the Stieltjes--Wigert distribution).\n\\hfill $\\Diamond$ \\end{remark}\n\nThe equivalent of condition \\eqref{SA7.11a} for $f/f_\\nu\\in{\\mathcal{L}}^2(\\nu)$ now becomes\n\n", "itemtype": "equation", "pos": 13052, "prevtext": "\nfor $k\\in{\\mathbb{N}_0}$ where\n\n", "index": 23, "text": "\\begin{equation}\\label{eq:ElementarySymmetricPolynomial}\ne_{i}\\left(X_{1},\\ldots,X_{k}\\right)=\n\\begin{cases}\n\\sum_{1\\leq j_{1}<\\ldots<j_{i}\\leq k}X_{j_{1}}\\ldots X_{j_{i}}, &\\mbox{for } i\\leq k, \\\\\n0,& \\mbox{for } i>k,\n\\end{cases}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E12.m1\" class=\"ltx_Math\" alttext=\"e_{i}\\left(X_{1},\\ldots,X_{k}\\right)=\\begin{cases}\\sum_{1\\leq j_{1}&lt;\\ldots&lt;j_{%&#10;i}\\leq k}X_{j_{1}}\\ldots X_{j_{i}},&amp;\\mbox{for }i\\leq k,\\\\&#10;0,&amp;\\mbox{for }i&gt;k,\\end{cases}\" display=\"block\"><mrow><mrow><msub><mi>e</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo>(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><msub><mi>X</mi><mi>k</mi></msub><mo>)</mo></mrow></mrow><mo>=</mo><mrow><mo>{</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><mrow><mstyle displaystyle=\"false\"><msub><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><mn>1</mn><mo>\u2264</mo><msub><mi>j</mi><mn>1</mn></msub><mo>&lt;</mo><mi mathvariant=\"normal\">\u2026</mi><mo>&lt;</mo><msub><mi>j</mi><mi>i</mi></msub><mo>\u2264</mo><mi>k</mi></mrow></msub></mstyle><mrow><msub><mi>X</mi><msub><mi>j</mi><mn>1</mn></msub></msub><mo>\u2062</mo><mi mathvariant=\"normal\">\u2026</mi><mo>\u2062</mo><msub><mi>X</mi><msub><mi>j</mi><mi>i</mi></msub></msub></mrow></mrow><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mrow><mtext>for\u00a0</mtext><mo>\u2062</mo><mi>i</mi></mrow><mo>\u2264</mo><mi>k</mi></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mrow><mn>0</mn><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mrow><mtext>for\u00a0</mtext><mo>\u2062</mo><mi>i</mi></mrow><mo>&gt;</mo><mi>k</mi></mrow><mo>,</mo></mrow></mtd></mtr></mtable></mrow></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nwhich is rather mild. However,\na key difficulty in taking the reference distribution as lognormal is the following\nresult related to the fact that the lognormal and the Stieltjes-Wigert distributions are not characterised by their moments, see \\cite{Heyde63,Berg1984,Ch79,Ch03}. Hence, the orthogonal polynomials associated with the lognormal p.d.f.\\ and the Stieltjes-Wigert p.d.f.\\ are also the orthogonal polynomials for some other distribution.\n\\begin{proposition} \\label{prop:ln_incomplete} The set of orthonormal polynomials in\nTheorem~\\ref{LogNormalOrthogonalPolynomialProposition} is incomplete\nin ${\\mathcal{L}}^2(\\nu)$. That is, {\\rm span}$\\{Q_k\\}_{k \\in {\\mathbb{N}_0}}$ is a proper subset of ${\\mathcal{L}}^2(\\nu)$.\n\\end{proposition}\n\\begin{proof} Let $Y$ be a r.v.\\ whose distribution is the given lognormal $\\nu$\nand $X$ a r.v.\\ with a distribution different from $Y$\nbut with the same moments. According to \\cite[pp.\\ 201--202]{Berg1984} such an $X$ can be\nchosen such that $f_X/f_\\nu$ is bounded and hence in ${\\mathcal{L}}^2(\\nu)$. The projection of\n$f/f_\\nu$  onto ${\\rm span}\\{Q_k\\}$ is then\n\n", "itemtype": "equation", "pos": 13940, "prevtext": "\nare the elementary symmetric polynomials and $\\left[x,q\\right]_{n}=\\prod_{i=0}^{n-1}\\left(1-xq^{i}\\right)$ is the Q-Pochhammer symbol.\n\\end{theorem}\n\n\n\n\n\\begin{remark}\\label{Rem:27.10b}\nThe result of Theorem~\\ref{LogNormalOrthogonalPolynomialProposition}\ndoes not appear to be in the literature; the closest reference\nseems to be a 1923 paper by Wigert~\\cite{Wi23} who considers\nthe distribution with p.d.f.\\\n\n$\\ell{\\mathrm{e}}^{-\\ell^{2}\\ln^{2}(x)}/\\sqrt{{\\uppi}}$\n(later called the Stieltjes--Wigert distribution).\n\\hfill $\\Diamond$ \\end{remark}\n\nThe equivalent of condition \\eqref{SA7.11a} for $f/f_\\nu\\in{\\mathcal{L}}^2(\\nu)$ now becomes\n\n", "index": 25, "text": "\\begin{align}\\label{SA7.11c}\nf(x)\\ &=\\ {\\mathcal{O}}\\big({\\mathrm{e}}^{-b \\log^2x}\\big)\\quad\\text{for }x\\to 0 \\text{ and } \\infty \\quad\\text{with } b> \\big(4\\sigma^2\\big)^{-1}\\,,\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E13.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle f(x)\" display=\"inline\"><mrow><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E13.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\ {\\mathcal{O}}\\big{(}{\\mathrm{e}}^{-b\\log^{2}x}\\big{)}\\quad%&#10;\\text{for }x\\to 0\\text{ and }\\infty\\quad\\text{with }b&gt;\\big{(}4\\sigma^{2}\\big{)%&#10;}^{-1}\\,,\" display=\"inline\"><mrow><mrow><mrow><mi/><mo rspace=\"7.5pt\">=</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcaa</mi><mo>\u2062</mo><mrow><mo maxsize=\"120%\" minsize=\"120%\">(</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mo>-</mo><mrow><mi>b</mi><mo>\u2062</mo><mrow><msup><mi>log</mi><mn>2</mn></msup><mo>\u2061</mo><mi>x</mi></mrow></mrow></mrow></msup><mo maxsize=\"120%\" minsize=\"120%\">)</mo></mrow></mrow></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003</mo><mrow><mrow><mrow><mtext>for\u00a0</mtext><mo>\u2062</mo><mi>x</mi></mrow><mo>\u2192</mo><mrow><mn>0</mn><mo>\u2062</mo><mtext>\u00a0and\u00a0</mtext><mo>\u2062</mo><mi mathvariant=\"normal\">\u221e</mi></mrow></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003</mo><mrow><mrow><mtext>with\u00a0</mtext><mo>\u2062</mo><mi>b</mi></mrow><mo>&gt;</mo><mpadded width=\"+1.7pt\"><msup><mrow><mo maxsize=\"120%\" minsize=\"120%\">(</mo><mrow><mn>4</mn><mo>\u2062</mo><msup><mi>\u03c3</mi><mn>2</mn></msup></mrow><mo maxsize=\"120%\" minsize=\"120%\">)</mo></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup></mpadded></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nwhere the first step used \\eqref{28.10a} and the second that the moments are the same.\nThis implies $f/f_\\nu\\in{\\mathcal{L}}^2(\\nu)\\setminus{\\rm span}\\{Q_k\\}$ and the assertion.\n\\end{proof}\n\n\n\n\\subsection{Convergence of the estimators  w.r.t.\\ $K$ }\n\nOrthogonal polynomial approximations generally become more accurate as the order of the approximation $K$ increases. Figure~\\ref{fig:converg} shows a specific orthogonal polynomial approximation, $\\widehat{f}_{{\\mathcal{N}}}$ (to be described in Section~\\ref{SS:LNNormalNu}), converging to the true ${\\mathcal{SLN}}$ density $f$ for increasing $K$. In this example, we take the ${\\mathcal{SLN}}$ distribution with $\\mu=(0,0,0)^{\\top}$, $\\Sigma_{ii} = 0.1$, and $\\rho = -0.1$.\n\n\\begin{figure}\n\\centering\n\\includegraphics[width=\\textwidth]{convergence.pdf}\n\\caption{Examples of orthogonal polynomial approximations using a ${\\mathcal{N}}(1.13,0.23^2)$ reference converging to the target $f$ with increasing $K$.}\n\\label{fig:converg}\n\\end{figure}\n\nProposition~\\ref{prop:ln_incomplete} implies that orthogonal polynomial approximations with a lognormal reference distribution cannot be relied upon to converge to the desired target density but may have a different limit (the orthogonal projection described there). The next plot, Figure~\\ref{fig:bad_converge}, illustrates this phenomenon. The approximation appears to converge, but not to the target density.\nOur theoretical discussion suggests that this incorrect limit density has the same moments as the target lognormal distribution,\nand this was verified numerically for the first few moments,\n\n\n\\begin{figure}\n\\centering\n\\includegraphics[width=\\textwidth]{invalid_convergence.pdf}\n\n\\caption{Example of orthogonal polynomial approximations of $f$ using a ${\\mathcal{LN}}(0, 1.22^2)$ reference not converging to the ${\\mathcal{LN}}(0, 1.50^2)$ target.}\n\\label{fig:bad_converge}\n\\end{figure}\n\nLastly, it must be noted that we cannot in practice take $K$ arbitrarily large, due to numerical errors incurred in calculating the $\\{a_k\\}$ coefficients. Obviously this can be overcome by using infinite precision operations, however this swiftly becomes prohibitively slow. Software tools like \\texttt{Mathematica} allow for arbitrarily large but finite precision, which gives on the flexibility to choose a desired accuracy/speed trade-off. We use this technology and select $K \\le 40$.\n\n\n\\section{Application to  lognormal sums}\\label{S:LN_Appl}\nWe now turn to our main case of interest where $X=S$ is a lognormal sum. Specifically,\n\n", "itemtype": "equation", "pos": 15242, "prevtext": "\nwhich is rather mild. However,\na key difficulty in taking the reference distribution as lognormal is the following\nresult related to the fact that the lognormal and the Stieltjes-Wigert distributions are not characterised by their moments, see \\cite{Heyde63,Berg1984,Ch79,Ch03}. Hence, the orthogonal polynomials associated with the lognormal p.d.f.\\ and the Stieltjes-Wigert p.d.f.\\ are also the orthogonal polynomials for some other distribution.\n\\begin{proposition} \\label{prop:ln_incomplete} The set of orthonormal polynomials in\nTheorem~\\ref{LogNormalOrthogonalPolynomialProposition} is incomplete\nin ${\\mathcal{L}}^2(\\nu)$. That is, {\\rm span}$\\{Q_k\\}_{k \\in {\\mathbb{N}_0}}$ is a proper subset of ${\\mathcal{L}}^2(\\nu)$.\n\\end{proposition}\n\\begin{proof} Let $Y$ be a r.v.\\ whose distribution is the given lognormal $\\nu$\nand $X$ a r.v.\\ with a distribution different from $Y$\nbut with the same moments. According to \\cite[pp.\\ 201--202]{Berg1984} such an $X$ can be\nchosen such that $f_X/f_\\nu$ is bounded and hence in ${\\mathcal{L}}^2(\\nu)$. The projection of\n$f/f_\\nu$  onto ${\\rm span}\\{Q_k\\}$ is then\n\n", "index": 27, "text": "\\begin{align*}\\sum_{k=0}^\\infty \\left<f/f_\\nu,Q_k\\right>Q_k\\ &=\\\n\\sum_{k=0}^\\infty {\\mathbb{E}}\\left[Q_k(X)\\right]Q_k\\ =\\ \\sum_{k=0}^\\infty {\\mathbb{E}}\\left[Q_k(Y)\\right]Q_k\\\\\n&=\\ Q_0\\ =\\ 1\\,\\neq f/f_\\nu,\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\sum_{k=0}^{\\infty}\\left&lt;f/f_{\\nu},Q_{k}\\right&gt;Q_{k}\" display=\"inline\"><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mi mathvariant=\"normal\">\u221e</mi></munderover></mstyle><mrow><mrow><mo>\u27e8</mo><mrow><mi>f</mi><mo>/</mo><msub><mi>f</mi><mi>\u03bd</mi></msub></mrow><mo>,</mo><msub><mi>Q</mi><mi>k</mi></msub><mo>\u27e9</mo></mrow><mo>\u2062</mo><msub><mi>Q</mi><mi>k</mi></msub></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\ \\sum_{k=0}^{\\infty}{\\mathbb{E}}\\left[Q_{k}(X)\\right]Q_{k}\\ =\\ %&#10;\\sum_{k=0}^{\\infty}{\\mathbb{E}}\\left[Q_{k}(Y)\\right]Q_{k}\" display=\"inline\"><mrow><mi/><mo rspace=\"7.5pt\">=</mo><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mi mathvariant=\"normal\">\u221e</mi></munderover></mstyle><mrow><mi>\ud835\udd3c</mi><mo>\u2062</mo><mrow><mo>[</mo><mrow><msub><mi>Q</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>]</mo></mrow><mo>\u2062</mo><mpadded width=\"+5pt\"><msub><mi>Q</mi><mi>k</mi></msub></mpadded></mrow></mrow><mo rspace=\"7.5pt\">=</mo><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mi mathvariant=\"normal\">\u221e</mi></munderover></mstyle><mrow><mi>\ud835\udd3c</mi><mo>\u2062</mo><mrow><mo>[</mo><mrow><msub><mi>Q</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>]</mo></mrow><mo>\u2062</mo><msub><mi>Q</mi><mi>k</mi></msub></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\ Q_{0}\\ =\\ 1\\,\\neq f/f_{\\nu},\" display=\"inline\"><mrow><mrow><mi/><mo rspace=\"7.5pt\">=</mo><mpadded width=\"+5pt\"><msub><mi>Q</mi><mn>0</mn></msub></mpadded><mo>=</mo><mpadded width=\"+1.7pt\"><mn>\u20051</mn></mpadded><mo>\u2260</mo><mrow><mi>f</mi><mo>/</mo><msub><mi>f</mi><mi>\u03bd</mi></msub></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nwhere the vector ${\\bm{X}}=\\left(X_{1},\\ldots,X_{n}\\right)$ is governed by a multivariate normal distribution ${\\mathcal{N}}\\left({\\bm{\\mu}}, {\\bm{\\Sigma}}\\right)$, where ${\\bm{\\mu}}=(\\mu_{1},\\ldots,\\mu_{n})^{\\top}$ is the mean vector and ${\\bm{\\Sigma}}=\\left(\\sigma_{ij}\\right)$ the covariance matrix.\nWe write this distribution as ${\\mathcal{SLN}}\\left({\\bm{\\mu}}, {\\bm{\\Sigma}} \\right)$, and hereafter denote its p.d.f.\\ as $f$. We are interested in computing the p.d.f.\\ when the summands exhibit dependency (${\\bm{\\Sigma}}$ is non-diagonal). This is an ambitious goal given that the p.d.f.\\ of the sum of two i.i.d lognormally distributed random variables is already unknown. The validity of the polynomial approximations rely on the ${\\mathcal{L}}^2$ integrability condition~\\eqref{L2Condition1}, which is difficult to check because the p.d.f.\\ of $S$ is not available. We will need asymptotic results describing the left and the right tail of the distribution of $S$, which we collect in the following subsection.\n\n\\subsection{Tail asymptotics of lognormal sums}\\label{SS:LNSumsAsympt}\n\nThe tail asymptotics of $f(x)$ are given in the following lemma, which simply collects the results from Corollary~2 of \\cite{tankov2015tail} and Theorem~1 of \\cite{AsRo08}.\n\n\\begin{lemma} \\label{le:SLNTails}\nWe have\n\\begin{eqnarray}\n\tf(x) &=&  {\\mathcal{O}} ( \\exp\\{-c_1 \\ln(x)^2 \\} ) \\text{ as }x\\to 0 \\text{ and } \\label{SLNLeftTail} \\\\\n\tf(x) &=& {\\mathcal{O}} ( \\exp\\{-c_2 \\ln(x)^2 \\} ) \\text{ as }x\\to \\infty \\label{SLNRightTail}\n\\end{eqnarray}\nwhere\n", "itemtype": "equation", "pos": 17993, "prevtext": "\nwhere the first step used \\eqref{28.10a} and the second that the moments are the same.\nThis implies $f/f_\\nu\\in{\\mathcal{L}}^2(\\nu)\\setminus{\\rm span}\\{Q_k\\}$ and the assertion.\n\\end{proof}\n\n\n\n\\subsection{Convergence of the estimators  w.r.t.\\ $K$ }\n\nOrthogonal polynomial approximations generally become more accurate as the order of the approximation $K$ increases. Figure~\\ref{fig:converg} shows a specific orthogonal polynomial approximation, $\\widehat{f}_{{\\mathcal{N}}}$ (to be described in Section~\\ref{SS:LNNormalNu}), converging to the true ${\\mathcal{SLN}}$ density $f$ for increasing $K$. In this example, we take the ${\\mathcal{SLN}}$ distribution with $\\mu=(0,0,0)^{\\top}$, $\\Sigma_{ii} = 0.1$, and $\\rho = -0.1$.\n\n\\begin{figure}\n\\centering\n\\includegraphics[width=\\textwidth]{convergence.pdf}\n\\caption{Examples of orthogonal polynomial approximations using a ${\\mathcal{N}}(1.13,0.23^2)$ reference converging to the target $f$ with increasing $K$.}\n\\label{fig:converg}\n\\end{figure}\n\nProposition~\\ref{prop:ln_incomplete} implies that orthogonal polynomial approximations with a lognormal reference distribution cannot be relied upon to converge to the desired target density but may have a different limit (the orthogonal projection described there). The next plot, Figure~\\ref{fig:bad_converge}, illustrates this phenomenon. The approximation appears to converge, but not to the target density.\nOur theoretical discussion suggests that this incorrect limit density has the same moments as the target lognormal distribution,\nand this was verified numerically for the first few moments,\n\n\n\\begin{figure}\n\\centering\n\\includegraphics[width=\\textwidth]{invalid_convergence.pdf}\n\n\\caption{Example of orthogonal polynomial approximations of $f$ using a ${\\mathcal{LN}}(0, 1.22^2)$ reference not converging to the ${\\mathcal{LN}}(0, 1.50^2)$ target.}\n\\label{fig:bad_converge}\n\\end{figure}\n\nLastly, it must be noted that we cannot in practice take $K$ arbitrarily large, due to numerical errors incurred in calculating the $\\{a_k\\}$ coefficients. Obviously this can be overcome by using infinite precision operations, however this swiftly becomes prohibitively slow. Software tools like \\texttt{Mathematica} allow for arbitrarily large but finite precision, which gives on the flexibility to choose a desired accuracy/speed trade-off. We use this technology and select $K \\le 40$.\n\n\n\\section{Application to  lognormal sums}\\label{S:LN_Appl}\nWe now turn to our main case of interest where $X=S$ is a lognormal sum. Specifically,\n\n", "index": 29, "text": "\\begin{equation}\\label{7.12a}\nS={\\mathrm{e}}^{X_{1}}+\\ldots+{\\mathrm{e}}^{X_n} \\,,\\quad n \\ge 2\\,,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14.m1\" class=\"ltx_Math\" alttext=\"S={\\mathrm{e}}^{X_{1}}+\\ldots+{\\mathrm{e}}^{X_{n}}\\,,\\quad n\\geq 2\\,,\" display=\"block\"><mrow><mrow><mrow><mi>S</mi><mo>=</mo><mrow><msup><mi mathvariant=\"normal\">e</mi><msub><mi>X</mi><mn>1</mn></msub></msup><mo>+</mo><mi mathvariant=\"normal\">\u2026</mi><mo>+</mo><mpadded width=\"+1.7pt\"><msup><mi mathvariant=\"normal\">e</mi><msub><mi>X</mi><mi>n</mi></msub></msup></mpadded></mrow></mrow><mo rspace=\"12.5pt\">,</mo><mrow><mi>n</mi><mo>\u2265</mo><mpadded width=\"+1.7pt\"><mn>2</mn></mpadded></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nwith the notation that $\\Delta = \\{ \\bm{w} \\,|\\, w_i \\in {\\mathbb{R}}_+, \\sum_{i=1}^n w_i = 1 \\}$.\n\\end{lemma}\n\nWe are also interested in the asymptotic behaviour of $Z = \\ln(S)$ later in the paper. Writing the p.d.f.\\ of $Z$ as $f_Z$ we have $f_Z(z) = {\\mathrm{e}}^{z}f({\\mathrm{e}}^{z})$. Together with L'H\\^opital's rule this gives the following results (extending \\cite{GaXuYe08}):\n\n\\begin{corollary} \\label{co:LogSLNTails}\nWe have\n\n", "itemtype": "equation", "pos": 19655, "prevtext": "\nwhere the vector ${\\bm{X}}=\\left(X_{1},\\ldots,X_{n}\\right)$ is governed by a multivariate normal distribution ${\\mathcal{N}}\\left({\\bm{\\mu}}, {\\bm{\\Sigma}}\\right)$, where ${\\bm{\\mu}}=(\\mu_{1},\\ldots,\\mu_{n})^{\\top}$ is the mean vector and ${\\bm{\\Sigma}}=\\left(\\sigma_{ij}\\right)$ the covariance matrix.\nWe write this distribution as ${\\mathcal{SLN}}\\left({\\bm{\\mu}}, {\\bm{\\Sigma}} \\right)$, and hereafter denote its p.d.f.\\ as $f$. We are interested in computing the p.d.f.\\ when the summands exhibit dependency (${\\bm{\\Sigma}}$ is non-diagonal). This is an ambitious goal given that the p.d.f.\\ of the sum of two i.i.d lognormally distributed random variables is already unknown. The validity of the polynomial approximations rely on the ${\\mathcal{L}}^2$ integrability condition~\\eqref{L2Condition1}, which is difficult to check because the p.d.f.\\ of $S$ is not available. We will need asymptotic results describing the left and the right tail of the distribution of $S$, which we collect in the following subsection.\n\n\\subsection{Tail asymptotics of lognormal sums}\\label{SS:LNSumsAsympt}\n\nThe tail asymptotics of $f(x)$ are given in the following lemma, which simply collects the results from Corollary~2 of \\cite{tankov2015tail} and Theorem~1 of \\cite{AsRo08}.\n\n\\begin{lemma} \\label{le:SLNTails}\nWe have\n\\begin{eqnarray}\n\tf(x) &=&  {\\mathcal{O}} ( \\exp\\{-c_1 \\ln(x)^2 \\} ) \\text{ as }x\\to 0 \\text{ and } \\label{SLNLeftTail} \\\\\n\tf(x) &=& {\\mathcal{O}} ( \\exp\\{-c_2 \\ln(x)^2 \\} ) \\text{ as }x\\to \\infty \\label{SLNRightTail}\n\\end{eqnarray}\nwhere\n", "index": 31, "text": "\n\\[\n\tc_1 = \\big[ 2 \\min_{\\bm{w} \\in \\Delta} \\bm{w}^{\\top} \\bm{\\Sigma}^{-1} \\bm{w} \\big]^{-1} \\, \\text{ and } \\,\\,\\, c_2 = \\big[ 2 \\max_{i=1,\\dots,n} \\sigma_{ii} \\big]^{-1}  \\,,\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"c_{1}=\\big{[}2\\min_{\\bm{w}\\in\\Delta}\\bm{w}^{\\top}\\bm{\\Sigma}^{-1}\\bm{w}\\big{]}%&#10;^{-1}\\,\\text{ and }\\,\\,\\,c_{2}=\\big{[}2\\max_{i=1,\\dots,n}\\sigma_{ii}\\big{]}^{-%&#10;1}\\,,\" display=\"block\"><mrow><mrow><msub><mi>c</mi><mn>1</mn></msub><mo>=</mo><mrow><mpadded width=\"+1.7pt\"><msup><mrow><mo maxsize=\"120%\" minsize=\"120%\">[</mo><mrow><mn>2</mn><mo>\u2062</mo><mrow><munder><mi>min</mi><mrow><mi>\ud835\udc98</mi><mo>\u2208</mo><mi mathvariant=\"normal\">\u0394</mi></mrow></munder><mo>\u2061</mo><mrow><msup><mi>\ud835\udc98</mi><mo>\u22a4</mo></msup><mo>\u2062</mo><msup><mi>\ud835\udeba</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><mi>\ud835\udc98</mi></mrow></mrow></mrow><mo maxsize=\"120%\" minsize=\"120%\">]</mo></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup></mpadded><mo>\u2062</mo><mpadded width=\"+5.1pt\"><mtext>\u00a0and\u00a0</mtext></mpadded><mo>\u2062</mo><msub><mi>c</mi><mn>2</mn></msub></mrow><mo>=</mo><mpadded width=\"+1.7pt\"><msup><mrow><mo maxsize=\"120%\" minsize=\"120%\">[</mo><mrow><mn>2</mn><mo>\u2062</mo><mrow><munder><mi>max</mi><mrow><mi>i</mi><mo>=</mo><mrow><mn>1</mn><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><mi>n</mi></mrow></mrow></munder><mo>\u2061</mo><msub><mi>\u03c3</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>i</mi></mrow></msub></mrow></mrow><mo maxsize=\"120%\" minsize=\"120%\">]</mo></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup></mpadded></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nwhere the constants are as in Lemma~\\ref{le:SLNTails}.\n\\end{corollary}\n\n\n\n\\subsection{Lognormal sums via a normal reference distribution} \\label{SS:LNNormalNu}\n\nConsider transforming $S$ to $Z=\\ln(S)$ and expanding this density with orthogonal polynomials using a normal distribution as reference. That is, our approximation to $f$ using a ${\\mathcal{N}}(\\mu, \\sigma^2)$ reference is\n", "itemtype": "equation", "pos": 20271, "prevtext": "\nwith the notation that $\\Delta = \\{ \\bm{w} \\,|\\, w_i \\in {\\mathbb{R}}_+, \\sum_{i=1}^n w_i = 1 \\}$.\n\\end{lemma}\n\nWe are also interested in the asymptotic behaviour of $Z = \\ln(S)$ later in the paper. Writing the p.d.f.\\ of $Z$ as $f_Z$ we have $f_Z(z) = {\\mathrm{e}}^{z}f({\\mathrm{e}}^{z})$. Together with L'H\\^opital's rule this gives the following results (extending \\cite{GaXuYe08}):\n\n\\begin{corollary} \\label{co:LogSLNTails}\nWe have\n\n", "index": 33, "text": "\\begin{align} \\label{LogSLNLeftTail}\n\tf_Z(z)  \\ &=\\  {\\mathcal{O}}(\\exp \\{-c_1 z^2 \\} ) \\text{\\ as } z\\to -\\infty\n\t \\text{ and } \\\\\n \\label{LogSLNRightTail}\n\tf_Z(z) \\ &=\\ {\\mathcal{O}}(\\exp\\{-c_2 z^2 \\}) \\text{\\ as } z \\to +\\infty\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E15.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle f_{Z}(z)\" display=\"inline\"><mrow><msub><mi>f</mi><mi>Z</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E15.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\ {\\mathcal{O}}(\\exp\\{-c_{1}z^{2}\\})\\text{\\ as }z\\to-\\infty\\text%&#10;{ and }\" display=\"inline\"><mrow><mi/><mo rspace=\"7.5pt\">=</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcaa</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mo>-</mo><mrow><msub><mi>c</mi><mn>1</mn></msub><mo>\u2062</mo><msup><mi>z</mi><mn>2</mn></msup></mrow></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mtext>\u00a0as\u00a0</mtext><mo>\u2062</mo><mi>z</mi></mrow><mo>\u2192</mo><mrow><mo>-</mo><mrow><mi mathvariant=\"normal\">\u221e</mi><mo>\u2062</mo><mtext>\u00a0and</mtext></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E16.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle f_{Z}(z)\" display=\"inline\"><mrow><msub><mi>f</mi><mi>Z</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E16.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\ {\\mathcal{O}}(\\exp\\{-c_{2}z^{2}\\})\\text{\\ as }z\\to+\\infty\" display=\"inline\"><mrow><mi/><mo rspace=\"7.5pt\">=</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcaa</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mo>-</mo><mrow><msub><mi>c</mi><mn>2</mn></msub><mo>\u2062</mo><msup><mi>z</mi><mn>2</mn></msup></mrow></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mtext>\u00a0as\u00a0</mtext><mo>\u2062</mo><mi>z</mi></mrow><mo>\u2192</mo><mrow><mo>+</mo><mi mathvariant=\"normal\">\u221e</mi></mrow></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nwith $\\phi(\\cdot)$ being the standard normal p.d.f. The following result tells us when the integrability condition $f_{Z}/f_\\nu \\in\\mathcal{L}^{2}(\\nu)$ is satisfied.\nIt follows immediately by combining \\eqref{SA7.11a} and Corollary~\\ref{co:LogSLNTails}\n\n\\begin{proposition}\\label{eq:IntegrabilityConditionNormalHermiteExpansion}\nConsider $Z=\\ln(S)$ where $S$ is $\\mathcal{SLN}(\\boldsymbol{\\mu},{\\bm{\\Sigma}})$ distributed. Let $\\nu$ be the probability measure associated to the normal distribution $\\mathcal{N}(\\mu,\\sigma^2)$. We have $f_Z / f_\\nu \\in\\mathcal{L}^{2}(\\nu)$ if\n\n", "itemtype": "equation", "pos": 20897, "prevtext": "\nwhere the constants are as in Lemma~\\ref{le:SLNTails}.\n\\end{corollary}\n\n\n\n\\subsection{Lognormal sums via a normal reference distribution} \\label{SS:LNNormalNu}\n\nConsider transforming $S$ to $Z=\\ln(S)$ and expanding this density with orthogonal polynomials using a normal distribution as reference. That is, our approximation to $f$ using a ${\\mathcal{N}}(\\mu, \\sigma^2)$ reference is\n", "index": 35, "text": "\n\\[ \\widehat{f}_{{\\mathcal{N}}} = \\frac{1}{\\sigma x} \\widehat{f}_{Z}\\left(\\frac{\\ln x - \\mu}{\\sigma} \\right) \\quad\\text{where}\\quad \\widehat{f}_{Z}(z) = \\phi(z) \\sum_{i=1}^K a_i \\, Q_i(z) \\,, \\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m1\" class=\"ltx_Math\" alttext=\"\\widehat{f}_{{\\mathcal{N}}}=\\frac{1}{\\sigma x}\\widehat{f}_{Z}\\left(\\frac{\\ln x%&#10;-\\mu}{\\sigma}\\right)\\quad\\text{where}\\quad\\widehat{f}_{Z}(z)=\\phi(z)\\sum_{i=1}%&#10;^{K}a_{i}\\,Q_{i}(z)\\,,\" display=\"block\"><mrow><mrow><mrow><msub><mover accent=\"true\"><mi>f</mi><mo>^</mo></mover><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca9</mi></msub><mo>=</mo><mrow><mrow><mfrac><mn>1</mn><mrow><mi>\u03c3</mi><mo>\u2062</mo><mi>x</mi></mrow></mfrac><mo>\u2062</mo><msub><mover accent=\"true\"><mi>f</mi><mo>^</mo></mover><mi>Z</mi></msub><mo>\u2062</mo><mrow><mo>(</mo><mfrac><mrow><mrow><mi>ln</mi><mo>\u2061</mo><mi>x</mi></mrow><mo>-</mo><mi>\u03bc</mi></mrow><mi>\u03c3</mi></mfrac><mo>)</mo></mrow></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003</mo><mtext>where</mtext></mrow></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003</mo><mrow><mrow><msub><mover accent=\"true\"><mi>f</mi><mo>^</mo></mover><mi>Z</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mi>\u03d5</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mrow><mpadded width=\"+1.7pt\"><msub><mi>a</mi><mi>i</mi></msub></mpadded><mo>\u2062</mo><msub><mi>Q</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>z</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\n\\end{proposition}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nComputing the $\\{ \\hat{a}_k \\}_{k \\in {\\mathbb{N}_0}}$ coefficients can be done using Crude Monte Carlo (CMC), as in\n", "itemtype": "equation", "pos": 21669, "prevtext": "\nwith $\\phi(\\cdot)$ being the standard normal p.d.f. The following result tells us when the integrability condition $f_{Z}/f_\\nu \\in\\mathcal{L}^{2}(\\nu)$ is satisfied.\nIt follows immediately by combining \\eqref{SA7.11a} and Corollary~\\ref{co:LogSLNTails}\n\n\\begin{proposition}\\label{eq:IntegrabilityConditionNormalHermiteExpansion}\nConsider $Z=\\ln(S)$ where $S$ is $\\mathcal{SLN}(\\boldsymbol{\\mu},{\\bm{\\Sigma}})$ distributed. Let $\\nu$ be the probability measure associated to the normal distribution $\\mathcal{N}(\\mu,\\sigma^2)$. We have $f_Z / f_\\nu \\in\\mathcal{L}^{2}(\\nu)$ if\n\n", "index": 37, "text": "\\begin{equation} \\label{normal_int_cond_1}\n\t2 \\sigma^2 > (2 c_2)^{-1} = \\max_{i=1,\\dots,n} \\Sigma_{ii} \\,.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E17.m1\" class=\"ltx_Math\" alttext=\"2\\sigma^{2}&gt;(2c_{2})^{-1}=\\max_{i=1,\\dots,n}\\Sigma_{ii}\\,.\" display=\"block\"><mrow><mrow><mrow><mn>2</mn><mo>\u2062</mo><msup><mi>\u03c3</mi><mn>2</mn></msup></mrow><mo>&gt;</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>c</mi><mn>2</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>=</mo><mrow><munder><mi>max</mi><mrow><mi>i</mi><mo>=</mo><mrow><mn>1</mn><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><mi>n</mi></mrow></mrow></munder><mo>\u2061</mo><mpadded width=\"+1.7pt\"><msub><mi mathvariant=\"normal\">\u03a3</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>i</mi></mrow></msub></mpadded></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nfor $k = 0, \\dots, K$. We can use the same $S_1$, \\dots, $S_R$ for all $\\widehat{a}_k$ together with a smoothing technique called \\emph{common random numbers} \\cite{asmussen2007stochastic,glasserman2003monte}. Note that a non-trivial amount of computational time is typically spent just constructing the Hermite polynomials. Incorporating the Hermite polynomial's recurrence relation in our calculations achieved a roughly $40\\times$ speed-up compared with using Mathematica's \\texttt{HermiteH}.\n\n\n\\subsection{Lognormal sums via a gamma reference distribution} \\label{SS:LNGammaNu}\n\nWhen $\\nu$ is Gamma$(r,m)$, it makes little sense to expand $f$ in terms of $\\{Q_{k}\\}_{k\\in{\\mathbb{N}_0}}$ and $f_\\nu$ as the integrability condition \\eqref{SA7.11b} fails, $f/f_\\nu \\not\\in{\\mathcal{L}}^{2}(\\nu)$. The workaround consists in using orthogonal polynomials to expand the \\emph{exponentially tilted} distribution, denoted ${\\mathcal{SLN}}_\\theta({\\bm{\\mu}}, {\\bm{\\Sigma}})$. This distribution's p.d.f.\\ is\n\n", "itemtype": "equation", "pos": 21990, "prevtext": "\n\\end{proposition}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nComputing the $\\{ \\hat{a}_k \\}_{k \\in {\\mathbb{N}_0}}$ coefficients can be done using Crude Monte Carlo (CMC), as in\n", "index": 39, "text": "\n\\[ \\widehat{a}_k = \\frac1R \\sum_{r=1}^R Q_n(S_r) \\,, \\quad S_1, \\dots, S_R {\\overset{\\mathrm{i.i.d.}}{\\sim}} {\\mathcal{SLN}}({\\bm{\\mu}}, {\\bm{\\Sigma}}) \\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m1\" class=\"ltx_Math\" alttext=\"\\widehat{a}_{k}=\\frac{1}{R}\\sum_{r=1}^{R}Q_{n}(S_{r})\\,,\\quad S_{1},\\dots,S_{R%&#10;}{\\overset{\\mathrm{i.i.d.}}{\\sim}}{\\mathcal{SLN}}({\\bm{\\mu}},{\\bm{\\Sigma}})\" display=\"block\"><mrow><msub><mover accent=\"true\"><mi>a</mi><mo>^</mo></mover><mi>k</mi></msub><mo>=</mo><mrow><mrow><mfrac><mn>1</mn><mi>R</mi></mfrac><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><mi>R</mi></munderover><mrow><msub><mi>Q</mi><mi>n</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>S</mi><mi>r</mi></msub><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo rspace=\"12.5pt\">,</mo><msub><mi>S</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><mrow><msub><mi>S</mi><mi>R</mi></msub><mo>\u2062</mo><mover accent=\"true\"><mo>\u223c</mo><mrow><mi mathvariant=\"normal\">i</mi><mo>.</mo><mi mathvariant=\"normal\">i</mi><mo>.</mo><mi mathvariant=\"normal\">d</mi><mo>.</mo></mrow></mover><mo>\u2062</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcae</mi><mo>\u2062</mo><mi class=\"ltx_font_mathcaligraphic\">\u2112</mi><mo>\u2062</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca9</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf41</mi><mo>,</mo><mi>\ud835\udeba</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nwhere ${\\mathscr{L}}(\\theta)={\\mathbb{E}}[{\\mathrm{e}}^{-\\theta S}]$ is the Laplace transform of $S$. Asmussen et al.\\ \\cite{AsJeRo14b} investigated the use of $f_\\theta(x)$ in approximating the survival function of $S$, and developed asymptotic forms and Monte Carlo estimators of this density.\n\\begin{remark}\nThe use of gamma distribution and Laguerre polynomials links our approach to a well established technique called the \\emph{Laguerre method}. The expansion is an orthogonal projection onto the basis of Laguerre functions constructed by multiplying Laguerre polynomials and the square root of the exponential distribution with parameter $1$. The method is described in \\cite{AbChWh95}. Note also that the damping procedure employed when integrability problems arise is quite similar to considering the exponentially tilted distribution instead of the real one. The use of the gamma distribution as reference is applied to actuarial science in \\cite{GoLoPo15a,GoLoPo15b}.\n$\\hfill \\Diamond$\n\\end{remark}\nUsing \\eqref{SA7.11b}, we immediately obtain the following result which\nsheds light on how to tune the parameters of the reference gamma distribution so the integrability condition $f_\\theta / f_\\nu \\in{\\mathcal{L}}^2(\\nu)$ is satisfied.\n\\begin{proposition}\\label{pr:IntegrabiltyConditionWRTGammaDistribution}\nConsider the r.v.\\ $S_\\theta$ distributed by the exponentially-tilted $\\mathcal{SLN}_\\theta(\\boldsymbol{\\mu},{\\bm{\\Sigma}})$ distribution. Let $\\nu$ be the probability measure associated with the Gamma$(r,m)$ distribution. We have $f_\\theta/f_\\nu \\in{\\mathcal{L}}^2(\\nu)$ if\n$m>1/2\\theta$.\n\\end{proposition}\n\nHereafter we assume that the parameters $r$ and $m$ of $f_\\nu \\sim \\mathrm{Gamma}(r,m)$ are chosen to satisfy Proposition~\\ref{pr:IntegrabiltyConditionWRTGammaDistribution}'s conditions.\n\n\nOur approximation---based upon rearranging \\eqref{ExponentiallyTiltedPDF}---is of the form\n\n", "itemtype": "equation", "pos": 23149, "prevtext": "\nfor $k = 0, \\dots, K$. We can use the same $S_1$, \\dots, $S_R$ for all $\\widehat{a}_k$ together with a smoothing technique called \\emph{common random numbers} \\cite{asmussen2007stochastic,glasserman2003monte}. Note that a non-trivial amount of computational time is typically spent just constructing the Hermite polynomials. Incorporating the Hermite polynomial's recurrence relation in our calculations achieved a roughly $40\\times$ speed-up compared with using Mathematica's \\texttt{HermiteH}.\n\n\n\\subsection{Lognormal sums via a gamma reference distribution} \\label{SS:LNGammaNu}\n\nWhen $\\nu$ is Gamma$(r,m)$, it makes little sense to expand $f$ in terms of $\\{Q_{k}\\}_{k\\in{\\mathbb{N}_0}}$ and $f_\\nu$ as the integrability condition \\eqref{SA7.11b} fails, $f/f_\\nu \\not\\in{\\mathcal{L}}^{2}(\\nu)$. The workaround consists in using orthogonal polynomials to expand the \\emph{exponentially tilted} distribution, denoted ${\\mathcal{SLN}}_\\theta({\\bm{\\mu}}, {\\bm{\\Sigma}})$. This distribution's p.d.f.\\ is\n\n", "index": 41, "text": "\\begin{equation}\\label{ExponentiallyTiltedPDF}\nf_\\theta(x) = \\frac{{\\mathrm{e}}^{-\\theta x}f(x)}{{\\mathscr{L}}(\\theta)} \\,,\\quad \\theta \\ge 0,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E18.m1\" class=\"ltx_Math\" alttext=\"f_{\\theta}(x)=\\frac{{\\mathrm{e}}^{-\\theta x}f(x)}{{\\mathscr{L}}(\\theta)}\\,,%&#10;\\quad\\theta\\geq 0,\" display=\"block\"><mrow><mrow><mrow><mrow><msub><mi>f</mi><mi>\u03b8</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mpadded width=\"+1.7pt\"><mfrac><mrow><msup><mi mathvariant=\"normal\">e</mi><mrow><mo>-</mo><mrow><mi>\u03b8</mi><mo>\u2062</mo><mi>x</mi></mrow></mrow></msup><mo>\u2062</mo><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mi class=\"ltx_font_mathscript\">\u2112</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mpadded></mrow><mo rspace=\"12.5pt\">,</mo><mrow><mi>\u03b8</mi><mo>\u2265</mo><mn>0</mn></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nThe coefficients $a_k = {\\mathbb{E}} [Q_k(S_\\theta)]$ can be estimated in (at least) three different ways: (i) using CMC, (ii) using Monte Carlo with a change of measure so $\\theta \\to 0$, or (iii) by directly computing the moments ${\\mathbb{E}}[S_\\theta^k]$. The first method is nontrivial, as simulating from $f_\\theta$ likely requires using acceptance-rejection (as in \\cite{AsJeRo14b}). Options (ii) and (iii) use\n\n", "itemtype": "equation", "pos": 25217, "prevtext": "\nwhere ${\\mathscr{L}}(\\theta)={\\mathbb{E}}[{\\mathrm{e}}^{-\\theta S}]$ is the Laplace transform of $S$. Asmussen et al.\\ \\cite{AsJeRo14b} investigated the use of $f_\\theta(x)$ in approximating the survival function of $S$, and developed asymptotic forms and Monte Carlo estimators of this density.\n\\begin{remark}\nThe use of gamma distribution and Laguerre polynomials links our approach to a well established technique called the \\emph{Laguerre method}. The expansion is an orthogonal projection onto the basis of Laguerre functions constructed by multiplying Laguerre polynomials and the square root of the exponential distribution with parameter $1$. The method is described in \\cite{AbChWh95}. Note also that the damping procedure employed when integrability problems arise is quite similar to considering the exponentially tilted distribution instead of the real one. The use of the gamma distribution as reference is applied to actuarial science in \\cite{GoLoPo15a,GoLoPo15b}.\n$\\hfill \\Diamond$\n\\end{remark}\nUsing \\eqref{SA7.11b}, we immediately obtain the following result which\nsheds light on how to tune the parameters of the reference gamma distribution so the integrability condition $f_\\theta / f_\\nu \\in{\\mathcal{L}}^2(\\nu)$ is satisfied.\n\\begin{proposition}\\label{pr:IntegrabiltyConditionWRTGammaDistribution}\nConsider the r.v.\\ $S_\\theta$ distributed by the exponentially-tilted $\\mathcal{SLN}_\\theta(\\boldsymbol{\\mu},{\\bm{\\Sigma}})$ distribution. Let $\\nu$ be the probability measure associated with the Gamma$(r,m)$ distribution. We have $f_\\theta/f_\\nu \\in{\\mathcal{L}}^2(\\nu)$ if\n$m>1/2\\theta$.\n\\end{proposition}\n\nHereafter we assume that the parameters $r$ and $m$ of $f_\\nu \\sim \\mathrm{Gamma}(r,m)$ are chosen to satisfy Proposition~\\ref{pr:IntegrabiltyConditionWRTGammaDistribution}'s conditions.\n\n\nOur approximation---based upon rearranging \\eqref{ExponentiallyTiltedPDF}---is of the form\n\n", "index": 43, "text": "\\begin{equation}\\label{fGammaApprox}\n \\widehat{f}(x) = {\\mathrm{e}}^{\\theta x} {\\mathscr{L}}(\\theta) \\widehat{f}_\\theta(x) = {\\mathrm{e}}^{\\theta x} {\\mathscr{L}}(\\theta) \\sum_{k=0}^K a_k Q_k(x) f_\\nu(x) \\,.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E19.m1\" class=\"ltx_Math\" alttext=\"\\widehat{f}(x)={\\mathrm{e}}^{\\theta x}{\\mathscr{L}}(\\theta)\\widehat{f}_{\\theta%&#10;}(x)={\\mathrm{e}}^{\\theta x}{\\mathscr{L}}(\\theta)\\sum_{k=0}^{K}a_{k}Q_{k}(x)f_%&#10;{\\nu}(x)\\,.\" display=\"block\"><mrow><mrow><mrow><mover accent=\"true\"><mi>f</mi><mo>^</mo></mover><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><msup><mi mathvariant=\"normal\">e</mi><mrow><mi>\u03b8</mi><mo>\u2062</mo><mi>x</mi></mrow></msup><mo>\u2062</mo><mi class=\"ltx_font_mathscript\">\u2112</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mover accent=\"true\"><mi>f</mi><mo>^</mo></mover><mi>\u03b8</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><msup><mi mathvariant=\"normal\">e</mi><mrow><mi>\u03b8</mi><mo>\u2062</mo><mi>x</mi></mrow></msup><mo>\u2062</mo><mi class=\"ltx_font_mathscript\">\u2112</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mi>K</mi></munderover><mrow><msub><mi>a</mi><mi>k</mi></msub><mo>\u2062</mo><msub><mi>Q</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>f</mi><mi>\u03bd</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nwhere $\\{q_{ki}\\}$ are the coefficients in $Q_k$, and\n", "itemtype": "equation", "pos": 25858, "prevtext": "\nThe coefficients $a_k = {\\mathbb{E}} [Q_k(S_\\theta)]$ can be estimated in (at least) three different ways: (i) using CMC, (ii) using Monte Carlo with a change of measure so $\\theta \\to 0$, or (iii) by directly computing the moments ${\\mathbb{E}}[S_\\theta^k]$. The first method is nontrivial, as simulating from $f_\\theta$ likely requires using acceptance-rejection (as in \\cite{AsJeRo14b}). Options (ii) and (iii) use\n\n", "index": 45, "text": "\\begin{equation} \\label{eq:expand_coeffs}\n\ta_k = {\\mathbb{E}} [Q_k(S_\\theta)] =: q_{k0} + q_{k1} {\\mathbb{E}}[S_\\theta] + \\dots + q_{kk} {\\mathbb{E}}[S_\\theta^k]\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E20.m1\" class=\"ltx_Math\" alttext=\"a_{k}={\\mathbb{E}}[Q_{k}(S_{\\theta})]=:q_{k0}+q_{k1}{\\mathbb{E}}[S_{\\theta}]+%&#10;\\dots+q_{kk}{\\mathbb{E}}[S_{\\theta}^{k}]\" display=\"block\"><mrow><msub><mi>a</mi><mi>k</mi></msub><mo>=</mo><mi>\ud835\udd3c</mi><mrow><mo stretchy=\"false\">[</mo><msub><mi>Q</mi><mi>k</mi></msub><mrow><mo stretchy=\"false\">(</mo><msub><mi>S</mi><mi>\u03b8</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">]</mo></mrow><mo>=</mo><mo>:</mo><msub><mi>q</mi><mrow><mi>k</mi><mo>\u2062</mo><mn>0</mn></mrow></msub><mo>+</mo><msub><mi>q</mi><mrow><mi>k</mi><mo>\u2062</mo><mn>1</mn></mrow></msub><mi>\ud835\udd3c</mi><mrow><mo stretchy=\"false\">[</mo><msub><mi>S</mi><mi>\u03b8</mi></msub><mo stretchy=\"false\">]</mo></mrow><mo>+</mo><mi mathvariant=\"normal\">\u2026</mi><mo>+</mo><msub><mi>q</mi><mrow><mi>k</mi><mo>\u2062</mo><mi>k</mi></mrow></msub><mi>\ud835\udd3c</mi><mrow><mo stretchy=\"false\">[</mo><msubsup><mi>S</mi><mi>\u03b8</mi><mi>k</mi></msubsup><mo stretchy=\"false\">]</mo></mrow></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nThe ${\\mathscr{L}}_i(\\theta)$ notation was selected to highlight the link between ${\\mathbb{E}}[S_n^i {\\mathrm{e}}^{-\\theta S_n}]$ and the $i$th derivative of ${\\mathscr{L}}(\\theta)$.\n\nAll three methods require access to the Laplace transform, and method (iii) requires ${\\mathscr{L}}_i(\\theta)$, however none of ${\\mathscr{L}}(\\theta)$ or ${\\mathscr{L}}_i(\\theta)$ are available in closed form. Our approach to circumvent these problems is presented in the Appendix.\n\n\n\n\\section{Numerical illustrations}\\label{S:numerical}\n\nWe take several approximations $\\widehat{f}$ and compare them against the benchmark of numerical integration.\nOne form of $f$ particularly useful for numerical integration, in terms of the ${\\mathcal{LN}}({\\bm{\\mu}}, {\\bm{\\Sigma}})$ density $f_{\\mathcal{LN}}$, is as a surface integral,\n$ f(s) = n^{-\\frac12} \\int_{\\Delta_n^s} f_{\\mathcal{LN}}({\\bm{x}}) \\dif {\\bm{x}} $,\nwhere $\\Delta_n^s = \\{ {\\bm{x}} \\in {\\mathbb{R}}_+^n : ||{\\bm{x}}||_1 = s \\}$. Mathematica integrates this within a reasonable time for $n=2$ to $4$ using \\texttt{NIntegrate} and \\texttt{ParametricRegion}). For $n > 4$ we qualitatively assess the performance of the estimators by plotting them.\n\nThe quantitative error measure used is the ${\\mathcal{L}}^2$ norm of $(\\widehat{f}-f)$ restricted to $(0, {\\mathbb{E}}[S])$. We focus on this region as\nat one hand it is the hardest to approximate (indeed, Lemma~\\ref{le:SLNTails} shows that just a single lognormal is a theoretically justified approximation of the ${\\mathcal{SLN}}$ right tail) and that at the other of high relevance in applications, see for example the introduction of \\cite {AsJeRo14b} and the references therein.\n\n\n\\subsection{The estimators}\nWe will compare the following approximations:\n\\begin{itemize}\n\\item the Fenton-Wilkinson approximation $\\widehat{f}_{\\mathrm{FW}}$, cf.\\ \\cite{Fe60}, consists in approximating the distribution of $S$ by a single lognormal\nwith the same first and second moment;\n\\item the log skew normal approximation $\\widehat{f}_{\\mathrm{Sk}}$,\ncf.\\ \\cite{hcine2015highly}\\footnote{Note that in \\cite{hcine2015highly}, the formula for ${\\varepsilon}_{\\mathrm{opt}}$ contains an typographic error.}, is a refinement of Fenton--Wilkinson by using a log  skew normal as approximation and fitting the left tail in addition to the first and second moment;\n\n\\item the conditional Monte Carlo approximation $\\widehat{f}_{\\mathrm{Cond}}$ , cf.\\ Example~4.3 on p.\\ 146 of \\cite{asmussen2007stochastic}, uses the representation $f(x)=$\n${\\mathbb{E}}\\bigl[\\mathbb{P}(S\\in\\dif x\\,|\\,Y)\\bigr]$ for some suitable $Y$ (here chosen as one of the\nnormal r.v.s $X_i$ occurring in \\eqref{7.12a}) and simulates the conditional expectation;\n\n\\item $\\widehat{f}_{{\\mathcal{N}}}$ is the approximation described in Section~\\ref{SS:LNNormalNu} using a logarithmic transformation\nand the Hermite polynomials with a normal reference distribution;\n\\item $\\widehat{f}_{\\,\\Gamma}$ is the approximation described in Section~\\ref{SS:LNGammaNu} using exponential tilting and the Laguerre polynomials with a gamma reference distribution.\n\\end{itemize}\n\nThese approximations are all estimators of functions (i.e., not pointwise estimators, such as in \\cite{La15}) and they do not take excessive computational effort to construct. The first two, $\\widehat{f}_{\\mathrm{FW}}$ and $\\widehat{f}_{\\mathrm{Sk}}$, only need ${\\bm{\\mu}}$ and ${\\bm{\\Sigma}}$ and do not have any Monte Carlo element. Similarly, the estimator $\\widehat{f}_{\\,\\Gamma}$ when utilising the Gauss--Hermite quadrature described in \\eqref{eq:gauss-hermite-quad}\nin the Appendix does not use Monte Carlo. For the remaining approximations we utilise the \\emph{common random numbers} technique, meaning that the same $R=10^5$ i.i.d.\\ ${\\mathcal{SLN}}({\\bm{\\mu}}, {\\bm{\\Sigma}})$ samples ${\\bm{S}} = (S_1, \\dots, S_R)^{\\top}$ are given to each algorithm. Lastly, all the estimators except $\\widehat{f}_{\\,\\Gamma}$ satisfy $\\int \\widehat{f}(x) \\dif x = 1$. One problem with the orthogonal polynomial estimators is that they can take negative values; this can easily be fixed, but we do not make that adjustment here.\n\n\n\n\n\n\nFor $\\widehat{f}_{{\\mathcal{N}}}$, we take $\\mu = {\\mathbb{E}}[Z]$ and $\\sigma^2 = {\\mathbb{V}\\mathrm{ar}}[Z]$, calculated using numerical integration.\nThe $\\widehat{f}_{\\,\\Gamma}$ case is more difficult. Equation \\eqref{fGammaApprox} shows that we must impose $\\theta m < 1$ to ensure that $\\widehat{f}_{\\,\\Gamma}(x)\\to 0$ as $x\\to \\infty$.\nExploring different parameter selections showed that fixing $\\theta = 1$ worked reasonably well. Moment matching $f_\\theta$ to $f_\\nu$ leads to the selection of $m$ and $r$. The moments of $f_\\theta$,\n$ \\widehat{{\\mathbb{E}} f_\\theta} = \\widehat{{\\mathscr{L}}}_1(\\theta) / \\widehat{{\\mathscr{L}}}_0(\\theta)$  and\n \n $\\widehat{{\\mathbb{V}\\mathrm{ar}} f_\\theta} = \\widehat{{\\mathscr{L}}}_2(\\theta) / \\widehat{{\\mathscr{L}}}_0(\\theta) - \\widehat{{\\mathbb{E}} f_\\theta}^2  $\ncan be approximated using the Gauss--Hermite quadrature of \\eqref{eq:gauss-hermite-quad}; for this we use $H = 64$, 32, 16 for $n=2$, 3, 4 respectively (and CMC for $n > 4$).\n\nWith these regimes, parameter selection for the reference distributions is automatic, and the only choice the user must make is in selecting $K$. In these tests we examined various $K$ from 1 to 40, and show the best approximations found. The source code for these tests is available online at \\cite{Code}, and we invite readers to experiment the effect of modifying $K$ and $\\theta$ and the parameters of the reference distributions.\n\n\n\n\n\n\\subsection{Results}\n\nFor each test case with $n \\le 4$ we plot the $\\widehat{f}(x)$ and $f(x)$ together and then $(\\widehat{f}(x)-f(x))$ over $x \\in (0, 2{\\mathbb{E}}[S])$. A table then shows the ${\\mathcal{L}}^2$ errors over $(0, {\\mathbb{E}}[S])$.\n\\setlength\\extrarowheight{3pt}\n\n\\begin{figure}[H]\n\\centering\n\\includegraphics[width=\\textwidth]{d1.pdf}\n\n\\vspace{4mm}\n\n\\begin{tabular}{c|c|c|c|c|c|}\n\\cline{2-6}\n                         & $\\widehat{f}_{\\mathrm{FW}}$  & $\\widehat{f}_{\\mathrm{Sk}}$ & $\\widehat{f}_{\\mathrm{Cond}}$ & $\\widehat{f}_{{\\mathcal{N}}}$  & $\\widehat{f}_{\\,\\Gamma}$ \\\\ \\hline\n\\multicolumn{1}{|c|}{${\\mathcal{L}}^2$} & $8.01 {\\mkern-2mu\\times\\mkern-2mu} 10^{-2}$ & $4.00 {\\mkern-2mu\\times\\mkern-2mu} 10^{-2}$ & $1.56 {\\mkern-2mu\\times\\mkern-2mu} 10^{-3}$ & $1.94 {\\mkern-2mu\\times\\mkern-2mu} 10^{-3}$ & $2.28 {\\mkern-2mu\\times\\mkern-2mu} 10^{-3}$ \\\\  \\hline\n\\end{tabular}\n\\caption*{Test 1: ${\\bm{\\mu}} = (0, 0)$, ${\\mathrm{diag}}({\\bm{\\Sigma}}) = (0.5, 1)$, $\\rho = -0.2$. Reference distributions used are ${\\mathcal{N}}(0.88,0.71^2)$ and Gamma($2.43,0.51$) with $K =$ 32, 16 resp.}\n\\end{figure}\n\n\n\n\n\n\n\n\n\\begin{figure}[H]\n\\centering\n\\includegraphics[width=\\textwidth]{d2.pdf}\n\n\\vspace{4mm}\n\n\\begin{tabular}{c|c|c|c|c|c|}\n\\cline{2-6}\n                         & $\\widehat{f}_{\\mathrm{FW}}$  & $\\widehat{f}_{\\mathrm{Sk}}$ & $\\widehat{f}_{\\mathrm{Cond}}$ & $\\widehat{f}_{{\\mathcal{N}}}$  & $\\widehat{f}_{\\,\\Gamma}$ \\\\ \\hline\n\\multicolumn{1}{|c|}{${\\mathcal{L}}^2$} & $1.02 {\\mkern-2mu\\times\\mkern-2mu} 10^{-2}$ & $3.49 {\\mkern-2mu\\times\\mkern-2mu} 10^{-3}$ & $1.78 {\\mkern-2mu\\times\\mkern-2mu} 10^{-3}$ & $7.86 {\\mkern-2mu\\times\\mkern-2mu} 10^{-4}$ & $7.24 {\\mkern-2mu\\times\\mkern-2mu} 10^{-4}$ \\\\ \\hline\n\\end{tabular}\n\\caption*{Test 2: ${\\bm{\\mu}} = (-0.5, 0.5)$, ${\\mathrm{diag}}({\\bm{\\Sigma}})= (1,1)$, $\\rho = 0.5$. Reference distributions used are ${\\mathcal{N}}(0.91,0.90^2)$ and Gamma($2.35,0.51$) with $K =$ 32, 16 resp.}\n\\end{figure}\n\n\n\n\n\n\n\n\\begin{figure}[H]\n\\centering\n\\includegraphics[width=\\textwidth]{d3.pdf}\n\n\\vspace{4mm}\n\n\\begin{tabular}{c|c|c|c|c|c|}\n\\cline{2-6}\n                         & $\\widehat{f}_{\\mathrm{FW}}$  & $\\widehat{f}_{\\mathrm{Sk}}$ & $\\widehat{f}_{\\mathrm{Cond}}$ & $\\widehat{f}_{{\\mathcal{N}}}$  & $\\widehat{f}_{\\,\\Gamma}$ \\\\ \\hline\n\\multicolumn{1}{|c|}{${\\mathcal{L}}^2$} & $9.48 {\\mkern-2mu\\times\\mkern-2mu} 10^{-3}$ & $3.71 {\\mkern-2mu\\times\\mkern-2mu} 10^{-3}$ & $1.60 {\\mkern-2mu\\times\\mkern-2mu} 10^{-3}$ & $1.18 {\\mkern-2mu\\times\\mkern-2mu} 10^{-3}$ & $3.53 {\\mkern-2mu\\times\\mkern-2mu} 10^{-4}$ \\\\ \\hline\n\\end{tabular}\n\\caption*{Test 3: $n=3$, $\\mu_i = 0$, $\\Sigma_{ii} = 1$, $\\rho = 0.25$. Reference distributions used are ${\\mathcal{N}}(1.32,0.74^2)$ and Gamma($3,0.57$) with $K =$ 7, 25 resp.}\n\\end{figure}\n\n\n\n\n\n\n\n\\begin{figure}[H]\n\\centering\n\\includegraphics[width=\\textwidth]{d4.pdf}\n\n\\vspace{4mm}\n\n\\begin{tabular}{c|c|c|c|c|c|}\n\\cline{2-6}\n                         & $\\widehat{f}_{\\mathrm{FW}}$  & $\\widehat{f}_{\\mathrm{Sk}}$ & $\\widehat{f}_{\\mathrm{Cond}}$ & $\\widehat{f}_{{\\mathcal{N}}}$  & $\\widehat{f}_{\\,\\Gamma}$ \\\\ \\hline\n\\multicolumn{1}{|c|}{${\\mathcal{L}}^2$} & $1.82 {\\mkern-2mu\\times\\mkern-2mu} 10^{-2}$ & $6.60 {\\mkern-2mu\\times\\mkern-2mu} 10^{-3}$ & $1.90 {\\mkern-2mu\\times\\mkern-2mu} 10^{-3}$ & $1.80 {\\mkern-2mu\\times\\mkern-2mu} 10^{-3}$ & $1.77 {\\mkern-2mu\\times\\mkern-2mu} 10^{-4}$ \\\\ \\hline\n\\end{tabular}\n\\caption*{Test 4: $n=4$, $\\mu_i = 0$, $\\Sigma_{ii}=1$, $\\rho = 0.1$. Reference distributions used are ${\\mathcal{N}}(1.32,0.74^2)$ and Gamma($3.37,0.51$) with $K =$ 18, 18 resp.}\n\\end{figure}\n\n\n\n\n\n\n\nThe following test case shows the density approximations for a large $n$.\n\n\n\n\\begin{figure}[H]\n\\centering\n\\includegraphics[width=\\textwidth]{d5.pdf}\n\\caption*{Test 5: Sum of 10 i.i.d.\\ ${\\mathcal{LN}}(0,0.1)$ r.v.s. Reference distributions used are ${\\mathcal{N}}(2.35,0.23^2)$ and Gamma($12.61,0.25$) with $K =$ 18, 35 resp.}\n\\end{figure}\n\n\n\n\n\n\n\nFinally, we fit $\\widehat{f}_{{\\mathcal{N}}}$ and $\\widehat{f}_{\\,\\Gamma}$ to simulated data ($10^5$ replications) for the sum of lognormals with a non-Gaussian dependence structure. Specifically, we take the sum of $n = 3$ standard lognormal r.v.s with a \\emph{Clayton copula}, defined by its distribution function\n", "itemtype": "equation", "pos": 26088, "prevtext": "\nwhere $\\{q_{ki}\\}$ are the coefficients in $Q_k$, and\n", "index": 47, "text": "\n\\[\n{\\mathbb{E}}[S_\\theta^i] = \\frac{{\\mathbb{E}}[S^i {\\mathrm{e}}^{-\\theta S}]}{{\\mathscr{L}}(\\theta)} =: \\frac{{\\mathscr{L}}_i(\\theta)}{{\\mathscr{L}}(\\theta)} \\,.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex6.m1\" class=\"ltx_Math\" alttext=\"{\\mathbb{E}}[S_{\\theta}^{i}]=\\frac{{\\mathbb{E}}[S^{i}{\\mathrm{e}}^{-\\theta S}]%&#10;}{{\\mathscr{L}}(\\theta)}=:\\frac{{\\mathscr{L}}_{i}(\\theta)}{{\\mathscr{L}}(%&#10;\\theta)}\\,.\" display=\"block\"><mrow><mi>\ud835\udd3c</mi><mrow><mo stretchy=\"false\">[</mo><msubsup><mi>S</mi><mi>\u03b8</mi><mi>i</mi></msubsup><mo stretchy=\"false\">]</mo></mrow><mo>=</mo><mfrac><mrow><mi>\ud835\udd3c</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><msup><mi>S</mi><mi>i</mi></msup><mo>\u2062</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mo>-</mo><mrow><mi>\u03b8</mi><mo>\u2062</mo><mi>S</mi></mrow></mrow></msup></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mrow><mi class=\"ltx_font_mathscript\">\u2112</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac><mo>=</mo><mo>:</mo><mpadded width=\"+1.7pt\"><mfrac><mrow><msub><mi class=\"ltx_font_mathscript\">\u2112</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mi class=\"ltx_font_mathscript\">\u2112</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mpadded><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nThe Kendall's tau correlation of the $C^{\\text{Cl}}_\\theta$ copula is $\\tau = \\theta / (\\theta + 2)$ \\cite{mcneil2015quantitative}.\n\n\\begin{figure}\n\\centering\n\\includegraphics[width=\\textwidth]{copula.pdf}\n\\caption*{Test 6: Sum of 3 ${\\mathcal{LN}}(0,1)$ r.v.s with $C^{\\text{Cl}}_{10}(\\cdot)$ copula (i.e., $\\tau = \\frac56$). Reference distributions used are ${\\mathcal{N}}(1.46,0.71^2)$ and Gamma($8.78,0.25$) with $K = 40$. The ${\\mathcal{L}}^2$ errors of $\\widehat{f}_{{\\mathcal{N}}}$ and $\\widehat{f}_{\\,\\Gamma}$ are $2.45 \\times 10^{-3}$ and $2.04 \\times 10^{-3}$ respectively.}\n\\end{figure}\n\n\n\n\n\n\n\n\n\n\n\n\n\nOur overall conclusion of the numerical examples is that no single method can\nbe considered as universally superior. Of the methods in the literature,\nthe log skew normal approximations is generally better than Fenton-Wilkinson,\nwhich is unsurprising given it is an extension introducing one more parameter.\nThe estimators, $\\widehat{f}_{{\\mathcal{N}}}$ and $\\widehat{f}_{\\,\\Gamma}$, based on orthogonal polynomial approximation techniques, are very flexible. They also display as least as good and sometimes better p.d.f.\\ estimates over the interval $(0, {\\mathbb{E}}[S])$ and their periodic error indicates that they would supply even more accurate c.d.f.\\ estimates. One should note, however, that their\nperformance relies on the tuning of parameters and that somewhat\ngreater effort is involved in their computation (though this is mitigated through the availability\nof the software in \\cite{Code}).\n\nAn interesting feature of $\\widehat{f}_{{\\mathcal{N}}}$ and $\\widehat{f}_{\\,\\Gamma}$ is that\nthe Frank copula example indicates some robustness to the dependence structure used.\nIn view of the current interest in financial applications of non-Gaussian dependence this\nseems a promising line for future research.\n\n\\subsection*{Acknowledgements}\n{\\small We are grateful to Jakob Schach M\\o ller for helpful discussions on orthonormal expansions.}\n\n\\begin{appendix}\n\n\\setcounter{proposition}{0}\n\\setcounter{remark}{0}\n\n\\section*{A.1 Proof of Proposition \\ref{LogNormalOrthogonalPolynomialProposition}} \\label{app:prop_proof}\n\\begin{proof}\nThe polynomials orthogonal with respect to the lognormal distribution will be derived using the general formula\n\n", "itemtype": "equation", "pos": 36075, "prevtext": "\nThe ${\\mathscr{L}}_i(\\theta)$ notation was selected to highlight the link between ${\\mathbb{E}}[S_n^i {\\mathrm{e}}^{-\\theta S_n}]$ and the $i$th derivative of ${\\mathscr{L}}(\\theta)$.\n\nAll three methods require access to the Laplace transform, and method (iii) requires ${\\mathscr{L}}_i(\\theta)$, however none of ${\\mathscr{L}}(\\theta)$ or ${\\mathscr{L}}_i(\\theta)$ are available in closed form. Our approach to circumvent these problems is presented in the Appendix.\n\n\n\n\\section{Numerical illustrations}\\label{S:numerical}\n\nWe take several approximations $\\widehat{f}$ and compare them against the benchmark of numerical integration.\nOne form of $f$ particularly useful for numerical integration, in terms of the ${\\mathcal{LN}}({\\bm{\\mu}}, {\\bm{\\Sigma}})$ density $f_{\\mathcal{LN}}$, is as a surface integral,\n$ f(s) = n^{-\\frac12} \\int_{\\Delta_n^s} f_{\\mathcal{LN}}({\\bm{x}}) \\dif {\\bm{x}} $,\nwhere $\\Delta_n^s = \\{ {\\bm{x}} \\in {\\mathbb{R}}_+^n : ||{\\bm{x}}||_1 = s \\}$. Mathematica integrates this within a reasonable time for $n=2$ to $4$ using \\texttt{NIntegrate} and \\texttt{ParametricRegion}). For $n > 4$ we qualitatively assess the performance of the estimators by plotting them.\n\nThe quantitative error measure used is the ${\\mathcal{L}}^2$ norm of $(\\widehat{f}-f)$ restricted to $(0, {\\mathbb{E}}[S])$. We focus on this region as\nat one hand it is the hardest to approximate (indeed, Lemma~\\ref{le:SLNTails} shows that just a single lognormal is a theoretically justified approximation of the ${\\mathcal{SLN}}$ right tail) and that at the other of high relevance in applications, see for example the introduction of \\cite {AsJeRo14b} and the references therein.\n\n\n\\subsection{The estimators}\nWe will compare the following approximations:\n\\begin{itemize}\n\\item the Fenton-Wilkinson approximation $\\widehat{f}_{\\mathrm{FW}}$, cf.\\ \\cite{Fe60}, consists in approximating the distribution of $S$ by a single lognormal\nwith the same first and second moment;\n\\item the log skew normal approximation $\\widehat{f}_{\\mathrm{Sk}}$,\ncf.\\ \\cite{hcine2015highly}\\footnote{Note that in \\cite{hcine2015highly}, the formula for ${\\varepsilon}_{\\mathrm{opt}}$ contains an typographic error.}, is a refinement of Fenton--Wilkinson by using a log  skew normal as approximation and fitting the left tail in addition to the first and second moment;\n\n\\item the conditional Monte Carlo approximation $\\widehat{f}_{\\mathrm{Cond}}$ , cf.\\ Example~4.3 on p.\\ 146 of \\cite{asmussen2007stochastic}, uses the representation $f(x)=$\n${\\mathbb{E}}\\bigl[\\mathbb{P}(S\\in\\dif x\\,|\\,Y)\\bigr]$ for some suitable $Y$ (here chosen as one of the\nnormal r.v.s $X_i$ occurring in \\eqref{7.12a}) and simulates the conditional expectation;\n\n\\item $\\widehat{f}_{{\\mathcal{N}}}$ is the approximation described in Section~\\ref{SS:LNNormalNu} using a logarithmic transformation\nand the Hermite polynomials with a normal reference distribution;\n\\item $\\widehat{f}_{\\,\\Gamma}$ is the approximation described in Section~\\ref{SS:LNGammaNu} using exponential tilting and the Laguerre polynomials with a gamma reference distribution.\n\\end{itemize}\n\nThese approximations are all estimators of functions (i.e., not pointwise estimators, such as in \\cite{La15}) and they do not take excessive computational effort to construct. The first two, $\\widehat{f}_{\\mathrm{FW}}$ and $\\widehat{f}_{\\mathrm{Sk}}$, only need ${\\bm{\\mu}}$ and ${\\bm{\\Sigma}}$ and do not have any Monte Carlo element. Similarly, the estimator $\\widehat{f}_{\\,\\Gamma}$ when utilising the Gauss--Hermite quadrature described in \\eqref{eq:gauss-hermite-quad}\nin the Appendix does not use Monte Carlo. For the remaining approximations we utilise the \\emph{common random numbers} technique, meaning that the same $R=10^5$ i.i.d.\\ ${\\mathcal{SLN}}({\\bm{\\mu}}, {\\bm{\\Sigma}})$ samples ${\\bm{S}} = (S_1, \\dots, S_R)^{\\top}$ are given to each algorithm. Lastly, all the estimators except $\\widehat{f}_{\\,\\Gamma}$ satisfy $\\int \\widehat{f}(x) \\dif x = 1$. One problem with the orthogonal polynomial estimators is that they can take negative values; this can easily be fixed, but we do not make that adjustment here.\n\n\n\n\n\n\nFor $\\widehat{f}_{{\\mathcal{N}}}$, we take $\\mu = {\\mathbb{E}}[Z]$ and $\\sigma^2 = {\\mathbb{V}\\mathrm{ar}}[Z]$, calculated using numerical integration.\nThe $\\widehat{f}_{\\,\\Gamma}$ case is more difficult. Equation \\eqref{fGammaApprox} shows that we must impose $\\theta m < 1$ to ensure that $\\widehat{f}_{\\,\\Gamma}(x)\\to 0$ as $x\\to \\infty$.\nExploring different parameter selections showed that fixing $\\theta = 1$ worked reasonably well. Moment matching $f_\\theta$ to $f_\\nu$ leads to the selection of $m$ and $r$. The moments of $f_\\theta$,\n$ \\widehat{{\\mathbb{E}} f_\\theta} = \\widehat{{\\mathscr{L}}}_1(\\theta) / \\widehat{{\\mathscr{L}}}_0(\\theta)$  and\n \n $\\widehat{{\\mathbb{V}\\mathrm{ar}} f_\\theta} = \\widehat{{\\mathscr{L}}}_2(\\theta) / \\widehat{{\\mathscr{L}}}_0(\\theta) - \\widehat{{\\mathbb{E}} f_\\theta}^2  $\ncan be approximated using the Gauss--Hermite quadrature of \\eqref{eq:gauss-hermite-quad}; for this we use $H = 64$, 32, 16 for $n=2$, 3, 4 respectively (and CMC for $n > 4$).\n\nWith these regimes, parameter selection for the reference distributions is automatic, and the only choice the user must make is in selecting $K$. In these tests we examined various $K$ from 1 to 40, and show the best approximations found. The source code for these tests is available online at \\cite{Code}, and we invite readers to experiment the effect of modifying $K$ and $\\theta$ and the parameters of the reference distributions.\n\n\n\n\n\n\\subsection{Results}\n\nFor each test case with $n \\le 4$ we plot the $\\widehat{f}(x)$ and $f(x)$ together and then $(\\widehat{f}(x)-f(x))$ over $x \\in (0, 2{\\mathbb{E}}[S])$. A table then shows the ${\\mathcal{L}}^2$ errors over $(0, {\\mathbb{E}}[S])$.\n\\setlength\\extrarowheight{3pt}\n\n\\begin{figure}[H]\n\\centering\n\\includegraphics[width=\\textwidth]{d1.pdf}\n\n\\vspace{4mm}\n\n\\begin{tabular}{c|c|c|c|c|c|}\n\\cline{2-6}\n                         & $\\widehat{f}_{\\mathrm{FW}}$  & $\\widehat{f}_{\\mathrm{Sk}}$ & $\\widehat{f}_{\\mathrm{Cond}}$ & $\\widehat{f}_{{\\mathcal{N}}}$  & $\\widehat{f}_{\\,\\Gamma}$ \\\\ \\hline\n\\multicolumn{1}{|c|}{${\\mathcal{L}}^2$} & $8.01 {\\mkern-2mu\\times\\mkern-2mu} 10^{-2}$ & $4.00 {\\mkern-2mu\\times\\mkern-2mu} 10^{-2}$ & $1.56 {\\mkern-2mu\\times\\mkern-2mu} 10^{-3}$ & $1.94 {\\mkern-2mu\\times\\mkern-2mu} 10^{-3}$ & $2.28 {\\mkern-2mu\\times\\mkern-2mu} 10^{-3}$ \\\\  \\hline\n\\end{tabular}\n\\caption*{Test 1: ${\\bm{\\mu}} = (0, 0)$, ${\\mathrm{diag}}({\\bm{\\Sigma}}) = (0.5, 1)$, $\\rho = -0.2$. Reference distributions used are ${\\mathcal{N}}(0.88,0.71^2)$ and Gamma($2.43,0.51$) with $K =$ 32, 16 resp.}\n\\end{figure}\n\n\n\n\n\n\n\n\n\\begin{figure}[H]\n\\centering\n\\includegraphics[width=\\textwidth]{d2.pdf}\n\n\\vspace{4mm}\n\n\\begin{tabular}{c|c|c|c|c|c|}\n\\cline{2-6}\n                         & $\\widehat{f}_{\\mathrm{FW}}$  & $\\widehat{f}_{\\mathrm{Sk}}$ & $\\widehat{f}_{\\mathrm{Cond}}$ & $\\widehat{f}_{{\\mathcal{N}}}$  & $\\widehat{f}_{\\,\\Gamma}$ \\\\ \\hline\n\\multicolumn{1}{|c|}{${\\mathcal{L}}^2$} & $1.02 {\\mkern-2mu\\times\\mkern-2mu} 10^{-2}$ & $3.49 {\\mkern-2mu\\times\\mkern-2mu} 10^{-3}$ & $1.78 {\\mkern-2mu\\times\\mkern-2mu} 10^{-3}$ & $7.86 {\\mkern-2mu\\times\\mkern-2mu} 10^{-4}$ & $7.24 {\\mkern-2mu\\times\\mkern-2mu} 10^{-4}$ \\\\ \\hline\n\\end{tabular}\n\\caption*{Test 2: ${\\bm{\\mu}} = (-0.5, 0.5)$, ${\\mathrm{diag}}({\\bm{\\Sigma}})= (1,1)$, $\\rho = 0.5$. Reference distributions used are ${\\mathcal{N}}(0.91,0.90^2)$ and Gamma($2.35,0.51$) with $K =$ 32, 16 resp.}\n\\end{figure}\n\n\n\n\n\n\n\n\\begin{figure}[H]\n\\centering\n\\includegraphics[width=\\textwidth]{d3.pdf}\n\n\\vspace{4mm}\n\n\\begin{tabular}{c|c|c|c|c|c|}\n\\cline{2-6}\n                         & $\\widehat{f}_{\\mathrm{FW}}$  & $\\widehat{f}_{\\mathrm{Sk}}$ & $\\widehat{f}_{\\mathrm{Cond}}$ & $\\widehat{f}_{{\\mathcal{N}}}$  & $\\widehat{f}_{\\,\\Gamma}$ \\\\ \\hline\n\\multicolumn{1}{|c|}{${\\mathcal{L}}^2$} & $9.48 {\\mkern-2mu\\times\\mkern-2mu} 10^{-3}$ & $3.71 {\\mkern-2mu\\times\\mkern-2mu} 10^{-3}$ & $1.60 {\\mkern-2mu\\times\\mkern-2mu} 10^{-3}$ & $1.18 {\\mkern-2mu\\times\\mkern-2mu} 10^{-3}$ & $3.53 {\\mkern-2mu\\times\\mkern-2mu} 10^{-4}$ \\\\ \\hline\n\\end{tabular}\n\\caption*{Test 3: $n=3$, $\\mu_i = 0$, $\\Sigma_{ii} = 1$, $\\rho = 0.25$. Reference distributions used are ${\\mathcal{N}}(1.32,0.74^2)$ and Gamma($3,0.57$) with $K =$ 7, 25 resp.}\n\\end{figure}\n\n\n\n\n\n\n\n\\begin{figure}[H]\n\\centering\n\\includegraphics[width=\\textwidth]{d4.pdf}\n\n\\vspace{4mm}\n\n\\begin{tabular}{c|c|c|c|c|c|}\n\\cline{2-6}\n                         & $\\widehat{f}_{\\mathrm{FW}}$  & $\\widehat{f}_{\\mathrm{Sk}}$ & $\\widehat{f}_{\\mathrm{Cond}}$ & $\\widehat{f}_{{\\mathcal{N}}}$  & $\\widehat{f}_{\\,\\Gamma}$ \\\\ \\hline\n\\multicolumn{1}{|c|}{${\\mathcal{L}}^2$} & $1.82 {\\mkern-2mu\\times\\mkern-2mu} 10^{-2}$ & $6.60 {\\mkern-2mu\\times\\mkern-2mu} 10^{-3}$ & $1.90 {\\mkern-2mu\\times\\mkern-2mu} 10^{-3}$ & $1.80 {\\mkern-2mu\\times\\mkern-2mu} 10^{-3}$ & $1.77 {\\mkern-2mu\\times\\mkern-2mu} 10^{-4}$ \\\\ \\hline\n\\end{tabular}\n\\caption*{Test 4: $n=4$, $\\mu_i = 0$, $\\Sigma_{ii}=1$, $\\rho = 0.1$. Reference distributions used are ${\\mathcal{N}}(1.32,0.74^2)$ and Gamma($3.37,0.51$) with $K =$ 18, 18 resp.}\n\\end{figure}\n\n\n\n\n\n\n\nThe following test case shows the density approximations for a large $n$.\n\n\n\n\\begin{figure}[H]\n\\centering\n\\includegraphics[width=\\textwidth]{d5.pdf}\n\\caption*{Test 5: Sum of 10 i.i.d.\\ ${\\mathcal{LN}}(0,0.1)$ r.v.s. Reference distributions used are ${\\mathcal{N}}(2.35,0.23^2)$ and Gamma($12.61,0.25$) with $K =$ 18, 35 resp.}\n\\end{figure}\n\n\n\n\n\n\n\nFinally, we fit $\\widehat{f}_{{\\mathcal{N}}}$ and $\\widehat{f}_{\\,\\Gamma}$ to simulated data ($10^5$ replications) for the sum of lognormals with a non-Gaussian dependence structure. Specifically, we take the sum of $n = 3$ standard lognormal r.v.s with a \\emph{Clayton copula}, defined by its distribution function\n", "index": 49, "text": "\n\\[\nC^{\\text{Cl}}_\\theta(u_1, \\dots, u_n) = \\Big( 1 - n + \\sum_{i=1}^n u_i^{-\\theta} \\Big)^{-1/\\theta}, \\qquad \\text{ for } \\theta > 0 \\,.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex7.m1\" class=\"ltx_Math\" alttext=\"C^{\\text{Cl}}_{\\theta}(u_{1},\\dots,u_{n})=\\Big{(}1-n+\\sum_{i=1}^{n}u_{i}^{-%&#10;\\theta}\\Big{)}^{-1/\\theta},\\qquad\\text{ for }\\theta&gt;0\\,.\" display=\"block\"><mrow><mrow><mrow><mrow><msubsup><mi>C</mi><mi>\u03b8</mi><mtext>Cl</mtext></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>u</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><msub><mi>u</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><msup><mrow><mo maxsize=\"160%\" minsize=\"160%\">(</mo><mrow><mrow><mn>1</mn><mo>-</mo><mi>n</mi></mrow><mo>+</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msubsup><mi>u</mi><mi>i</mi><mrow><mo>-</mo><mi>\u03b8</mi></mrow></msubsup></mrow></mrow><mo maxsize=\"160%\" minsize=\"160%\">)</mo></mrow><mrow><mo>-</mo><mrow><mn>1</mn><mo>/</mo><mi>\u03b8</mi></mrow></mrow></msup></mrow><mo rspace=\"22.5pt\">,</mo><mrow><mrow><mtext>\u00a0for\u00a0</mtext><mo>\u2062</mo><mi>\u03b8</mi></mrow><mo>&gt;</mo><mpadded width=\"+1.7pt\"><mn>0</mn></mpadded></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nwhere $\\{s_{n}\\}_{n\\in{\\mathbb{N}_0}}$ denotes the moment sequence of the lognormal distribution and  $D_{n,n}=\\left|\\left\\{s_{k,l}\\right\\}_{0\\leq k,l \\leq n}\\right|$ is a Hankel determinant. The moments of the lognormal distribution are given by $s_{n}=p^{n}q^{n^{2}}$, where $p={\\mathrm{e}}^{\\mu}$ and $q={\\mathrm{e}}^{\\frac{\\sigma^{2}}{2}}$. Consider\n\n", "itemtype": "equation", "pos": 38482, "prevtext": "\nThe Kendall's tau correlation of the $C^{\\text{Cl}}_\\theta$ copula is $\\tau = \\theta / (\\theta + 2)$ \\cite{mcneil2015quantitative}.\n\n\\begin{figure}\n\\centering\n\\includegraphics[width=\\textwidth]{copula.pdf}\n\\caption*{Test 6: Sum of 3 ${\\mathcal{LN}}(0,1)$ r.v.s with $C^{\\text{Cl}}_{10}(\\cdot)$ copula (i.e., $\\tau = \\frac56$). Reference distributions used are ${\\mathcal{N}}(1.46,0.71^2)$ and Gamma($8.78,0.25$) with $K = 40$. The ${\\mathcal{L}}^2$ errors of $\\widehat{f}_{{\\mathcal{N}}}$ and $\\widehat{f}_{\\,\\Gamma}$ are $2.45 \\times 10^{-3}$ and $2.04 \\times 10^{-3}$ respectively.}\n\\end{figure}\n\n\n\n\n\n\n\n\n\n\n\n\n\nOur overall conclusion of the numerical examples is that no single method can\nbe considered as universally superior. Of the methods in the literature,\nthe log skew normal approximations is generally better than Fenton-Wilkinson,\nwhich is unsurprising given it is an extension introducing one more parameter.\nThe estimators, $\\widehat{f}_{{\\mathcal{N}}}$ and $\\widehat{f}_{\\,\\Gamma}$, based on orthogonal polynomial approximation techniques, are very flexible. They also display as least as good and sometimes better p.d.f.\\ estimates over the interval $(0, {\\mathbb{E}}[S])$ and their periodic error indicates that they would supply even more accurate c.d.f.\\ estimates. One should note, however, that their\nperformance relies on the tuning of parameters and that somewhat\ngreater effort is involved in their computation (though this is mitigated through the availability\nof the software in \\cite{Code}).\n\nAn interesting feature of $\\widehat{f}_{{\\mathcal{N}}}$ and $\\widehat{f}_{\\,\\Gamma}$ is that\nthe Frank copula example indicates some robustness to the dependence structure used.\nIn view of the current interest in financial applications of non-Gaussian dependence this\nseems a promising line for future research.\n\n\\subsection*{Acknowledgements}\n{\\small We are grateful to Jakob Schach M\\o ller for helpful discussions on orthonormal expansions.}\n\n\\begin{appendix}\n\n\\setcounter{proposition}{0}\n\\setcounter{remark}{0}\n\n\\section*{A.1 Proof of Proposition \\ref{LogNormalOrthogonalPolynomialProposition}} \\label{app:prop_proof}\n\\begin{proof}\nThe polynomials orthogonal with respect to the lognormal distribution will be derived using the general formula\n\n", "index": 51, "text": "\\begin{equation}\\label{eq:OrthogonalPolynomialGeneralExpression}\nQ_{n}(x)=\\frac{1}{\\sqrt{D_{n-1,n-1}D_{n,n}}}\\displaystyle\n\\left| \\begin{array}{cccc}\ns_{0}&s_{1}&\\cdots&s_{n} \\\\\ns_{1}&s_{2}&\\cdots&s_{n+1}  \\\\\n\\vdots&\\vdots&&\\vdots\\\\\ns_{n-1}&s_{n}&\\cdots&s_{2n-1}\\\\\n1&x&\\cdots&x^{n}\n\\end{array}\n\\right|,\\hspace{0.1cm}n\\geq1,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E21.m1\" class=\"ltx_Math\" alttext=\"Q_{n}(x)=\\frac{1}{\\sqrt{D_{n-1,n-1}D_{n,n}}}\\displaystyle\\left|\\begin{array}[]%&#10;{cccc}s_{0}&amp;s_{1}&amp;\\cdots&amp;s_{n}\\\\&#10;s_{1}&amp;s_{2}&amp;\\cdots&amp;s_{n+1}\\\\&#10;\\vdots&amp;\\vdots&amp;&amp;\\vdots\\\\&#10;s_{n-1}&amp;s_{n}&amp;\\cdots&amp;s_{2n-1}\\\\&#10;1&amp;x&amp;\\cdots&amp;x^{n}\\end{array}\\right|,\\hskip 2.845276ptn\\geq 1,\" display=\"block\"><mrow><mrow><mrow><mrow><msub><mi>Q</mi><mi>n</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><msqrt><mrow><msub><mi>D</mi><mrow><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></mrow></msub><mo>\u2062</mo><msub><mi>D</mi><mrow><mi>n</mi><mo>,</mo><mi>n</mi></mrow></msub></mrow></msqrt></mfrac><mo>\u2062</mo><mrow><mo>|</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><msub><mi>s</mi><mn>0</mn></msub></mtd><mtd columnalign=\"center\"><msub><mi>s</mi><mn>1</mn></msub></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><msub><mi>s</mi><mi>n</mi></msub></mtd></mtr><mtr><mtd columnalign=\"center\"><msub><mi>s</mi><mn>1</mn></msub></mtd><mtd columnalign=\"center\"><msub><mi>s</mi><mn>2</mn></msub></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><msub><mi>s</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd></mtr><mtr><mtd columnalign=\"center\"><msub><mi>s</mi><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></msub></mtd><mtd columnalign=\"center\"><msub><mi>s</mi><mi>n</mi></msub></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><msub><mi>s</mi><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>n</mi></mrow><mo>-</mo><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd columnalign=\"center\"><mn>1</mn></mtd><mtd columnalign=\"center\"><mi>x</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><msup><mi>x</mi><mi>n</mi></msup></mtd></mtr></mtable><mo>|</mo></mrow></mrow></mrow><mo rspace=\"5.3pt\">,</mo><mrow><mi>n</mi><mo>\u2265</mo><mn>1</mn></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nand denote by $R_{k}$ the $k$th row and by $C_{\\ell}$ the $\\ell$th column. We apply the elementary operations $R_{k+1}\\rightarrow p^{-k}q^{-k^{2}}R_{k+1}$, and $C_{\\ell+1}\\rightarrow p^{-\\ell}q^{-\\ell^{2}}C_{\\ell+1}$ for $k,\\ell=0,\\ldots,n$ to get a Vandermonde type determinant. Thus we have\n\n", "itemtype": "equation", "pos": 39175, "prevtext": "\nwhere $\\{s_{n}\\}_{n\\in{\\mathbb{N}_0}}$ denotes the moment sequence of the lognormal distribution and  $D_{n,n}=\\left|\\left\\{s_{k,l}\\right\\}_{0\\leq k,l \\leq n}\\right|$ is a Hankel determinant. The moments of the lognormal distribution are given by $s_{n}=p^{n}q^{n^{2}}$, where $p={\\mathrm{e}}^{\\mu}$ and $q={\\mathrm{e}}^{\\frac{\\sigma^{2}}{2}}$. Consider\n\n", "index": 53, "text": "\\begin{equation}\\label{eq:Dn1}\nD_{n,n}=\\displaystyle\n\\left| \\begin{array}{cccc}\n1&pq&\\cdots&p^{n}q^{n^{2}} \\\\\npq&p^{2}q^{4}&&p^{n+1}q^{(n+1)^{2}}\\\\\n\\vdots&\\vdots&&\\vdots\\\\\np^{n-1}q^{(n-1)^{2}}&p^{n}q^{n^{2}}&\\cdots&p^{2n-1}q^{(2n-1)^{2}}\\\\\np^{n}q^{n^{2}}&p^{n+1}q^{(n+1)^{2}}&\\cdots&p^{2n}q^{(2n)^{2}}\n\\end{array}\n\\right|,\\hspace{0.1cm}n\\geq1,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E22.m1\" class=\"ltx_Math\" alttext=\"D_{n,n}=\\displaystyle\\left|\\begin{array}[]{cccc}1&amp;pq&amp;\\cdots&amp;p^{n}q^{n^{2}}\\\\&#10;pq&amp;p^{2}q^{4}&amp;&amp;p^{n+1}q^{(n+1)^{2}}\\\\&#10;\\vdots&amp;\\vdots&amp;&amp;\\vdots\\\\&#10;p^{n-1}q^{(n-1)^{2}}&amp;p^{n}q^{n^{2}}&amp;\\cdots&amp;p^{2n-1}q^{(2n-1)^{2}}\\\\&#10;p^{n}q^{n^{2}}&amp;p^{n+1}q^{(n+1)^{2}}&amp;\\cdots&amp;p^{2n}q^{(2n)^{2}}\\end{array}\\right%&#10;|,\\hskip 2.845276ptn\\geq 1,\" display=\"block\"><mrow><mrow><mrow><msub><mi>D</mi><mrow><mi>n</mi><mo>,</mo><mi>n</mi></mrow></msub><mo>=</mo><mrow><mo>|</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mn>1</mn></mtd><mtd columnalign=\"center\"><mrow><mi>p</mi><mo>\u2062</mo><mi>q</mi></mrow></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mrow><msup><mi>p</mi><mi>n</mi></msup><mo>\u2062</mo><msup><mi>q</mi><msup><mi>n</mi><mn>2</mn></msup></msup></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><mi>p</mi><mo>\u2062</mo><mi>q</mi></mrow></mtd><mtd columnalign=\"center\"><mrow><msup><mi>p</mi><mn>2</mn></msup><mo>\u2062</mo><msup><mi>q</mi><mn>4</mn></msup></mrow></mtd><mtd/><mtd columnalign=\"center\"><mrow><msup><mi>p</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><msup><mi>q</mi><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></msup></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><msup><mi>p</mi><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><msup><mi>q</mi><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></msup></mrow></mtd><mtd columnalign=\"center\"><mrow><msup><mi>p</mi><mi>n</mi></msup><mo>\u2062</mo><msup><mi>q</mi><msup><mi>n</mi><mn>2</mn></msup></msup></mrow></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mrow><msup><mi>p</mi><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>n</mi></mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><msup><mi>q</mi><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>n</mi></mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></msup></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><msup><mi>p</mi><mi>n</mi></msup><mo>\u2062</mo><msup><mi>q</mi><msup><mi>n</mi><mn>2</mn></msup></msup></mrow></mtd><mtd columnalign=\"center\"><mrow><msup><mi>p</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><msup><mi>q</mi><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></msup></mrow></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mrow><msup><mi>p</mi><mrow><mn>2</mn><mo>\u2062</mo><mi>n</mi></mrow></msup><mo>\u2062</mo><msup><mi>q</mi><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mn>2</mn><mo>\u2062</mo><mi>n</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></msup></mrow></mtd></mtr></mtable><mo>|</mo></mrow></mrow><mo rspace=\"5.3pt\">,</mo><mrow><mi>n</mi><mo>\u2265</mo><mn>1</mn></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nWe expand the determinant in \\eqref{eq:OrthogonalPolynomialGeneralExpression} with respect to the last row to get\n\n", "itemtype": "equation", "pos": 39827, "prevtext": "\nand denote by $R_{k}$ the $k$th row and by $C_{\\ell}$ the $\\ell$th column. We apply the elementary operations $R_{k+1}\\rightarrow p^{-k}q^{-k^{2}}R_{k+1}$, and $C_{\\ell+1}\\rightarrow p^{-\\ell}q^{-\\ell^{2}}C_{\\ell+1}$ for $k,\\ell=0,\\ldots,n$ to get a Vandermonde type determinant. Thus we have\n\n", "index": 55, "text": "\\begin{equation}\\label{eq:Dn2}\nD_{n,n}={\\mathrm{e}}^{n(n+1)\\mu}{\\mathrm{e}}^{\\frac{n(n+1)(2n+1)}{3}\\sigma^{2}}\\prod_{k=0}^{n-1}\n\\left[{\\mathrm{e}}^{-\\sigma^{2}};{\\mathrm{e}}^{-\\sigma^{2}}\\right]_{k}\\\\\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E23.m1\" class=\"ltx_Math\" alttext=\"D_{n,n}={\\mathrm{e}}^{n(n+1)\\mu}{\\mathrm{e}}^{\\frac{n(n+1)(2n+1)}{3}\\sigma^{2}%&#10;}\\prod_{k=0}^{n-1}\\left[{\\mathrm{e}}^{-\\sigma^{2}};{\\mathrm{e}}^{-\\sigma^{2}}%&#10;\\right]_{k}\\\\&#10;\" display=\"block\"><mrow><msub><mi>D</mi><mrow><mi>n</mi><mo>,</mo><mi>n</mi></mrow></msub><mo>=</mo><mrow><msup><mi mathvariant=\"normal\">e</mi><mrow><mi>n</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>\u03bc</mi></mrow></msup><mo>\u2062</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mfrac><mrow><mi>n</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>n</mi></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mn>3</mn></mfrac><mo>\u2062</mo><msup><mi>\u03c3</mi><mn>2</mn></msup></mrow></msup><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u220f</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></munderover><msub><mrow><mo>[</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mo>-</mo><msup><mi>\u03c3</mi><mn>2</mn></msup></mrow></msup><mo>;</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mo>-</mo><msup><mi>\u03c3</mi><mn>2</mn></msup></mrow></msup><mo>]</mo></mrow><mi>k</mi></msub></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nwhere $D_{n-1,n}^{-k}$ is $D_{n,n}$ with the last row and the $(k+1)$th column deleted. We perform on  $D_{n-1,n}^{-k}$ the following operations: $R_{j+1}\\rightarrow p^{-j}q^{-j^{2}}R_{j+1}$, for $j=0,\\ldots,n-1$, $C_{j+1}\\rightarrow p^{-j}q^{-j^{2}}C_{j+1}$, for $j=0,\\ldots,k-1$, and finally $C_{j}\\rightarrow p^{-j}q^{-j^{2}}C_{j}$, for $j=k+1,\\ldots,n$. We obtain\n\n", "itemtype": "equation", "pos": 40157, "prevtext": "\nWe expand the determinant in \\eqref{eq:OrthogonalPolynomialGeneralExpression} with respect to the last row to get\n\n", "index": 57, "text": "\\begin{equation}\\label{eq:PolynomialExpression1}\nQ_{n}(x)=\\frac{1}{\\sqrt{D_{n-1,n-1}D_{n,n}}}\\sum_{k=0}^{n}(-1)^{n+k}x^{k}D_{n-1,n}^{-k},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E24.m1\" class=\"ltx_Math\" alttext=\"Q_{n}(x)=\\frac{1}{\\sqrt{D_{n-1,n-1}D_{n,n}}}\\sum_{k=0}^{n}(-1)^{n+k}x^{k}D_{n-%&#10;1,n}^{-k},\" display=\"block\"><mrow><mrow><mrow><msub><mi>Q</mi><mi>n</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><msqrt><mrow><msub><mi>D</mi><mrow><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></mrow></msub><mo>\u2062</mo><msub><mi>D</mi><mrow><mi>n</mi><mo>,</mo><mi>n</mi></mrow></msub></mrow></msqrt></mfrac><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></munderover><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mi>n</mi><mo>+</mo><mi>k</mi></mrow></msup><mo>\u2062</mo><msup><mi>x</mi><mi>k</mi></msup><mo>\u2062</mo><msubsup><mi>D</mi><mrow><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mi>n</mi></mrow><mrow><mo>-</mo><mi>k</mi></mrow></msubsup></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nwhere $\\alpha_{k}=q^{2k}$, for $k=0,\\ldots,n-1$. Expanding the polynomial $B(X)=\\prod_{i=0}^{n-1}(x-\\alpha_{i})$, we get\n\n", "itemtype": "equation", "pos": 40678, "prevtext": "\nwhere $D_{n-1,n}^{-k}$ is $D_{n,n}$ with the last row and the $(k+1)$th column deleted. We perform on  $D_{n-1,n}^{-k}$ the following operations: $R_{j+1}\\rightarrow p^{-j}q^{-j^{2}}R_{j+1}$, for $j=0,\\ldots,n-1$, $C_{j+1}\\rightarrow p^{-j}q^{-j^{2}}C_{j+1}$, for $j=0,\\ldots,k-1$, and finally $C_{j}\\rightarrow p^{-j}q^{-j^{2}}C_{j}$, for $j=k+1,\\ldots,n$. We obtain\n\n", "index": 59, "text": "\\begin{equation*}\nD_{n-1,n}^{-k}=p^{n^{2}-k}q^{\\frac{2n^{3}+n}{3}-k^{2}}\\left| \\begin{array}{ccccccc}\n1&\\alpha_{0}&\\cdots&\\alpha_{0}^{k-1}&\\alpha_{0}^{k+1}&\\cdots&\\alpha_{0}^{n} \\\\\n1&\\alpha_{1}&\\cdots&\\alpha_{1}^{k-1}&\\alpha_{1}^{k+1}&\\cdots&\\alpha_{1}^{n+1}  \\\\\n\\vdots&\\vdots&&\\vdots&\\vdots&&\\vdots\\\\\n1&\\alpha_{n-1}&\\cdots&\\cdots&\\cdots&\\cdots&\\alpha_{n-1}^{n}\n\\end{array}\n\\right|,\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex8.m1\" class=\"ltx_Math\" alttext=\"D_{n-1,n}^{-k}=p^{n^{2}-k}q^{\\frac{2n^{3}+n}{3}-k^{2}}\\left|\\begin{array}[]{%&#10;ccccccc}1&amp;\\alpha_{0}&amp;\\cdots&amp;\\alpha_{0}^{k-1}&amp;\\alpha_{0}^{k+1}&amp;\\cdots&amp;\\alpha_{0%&#10;}^{n}\\\\&#10;1&amp;\\alpha_{1}&amp;\\cdots&amp;\\alpha_{1}^{k-1}&amp;\\alpha_{1}^{k+1}&amp;\\cdots&amp;\\alpha_{1}^{n+1}%&#10;\\\\&#10;\\vdots&amp;\\vdots&amp;&amp;\\vdots&amp;\\vdots&amp;&amp;\\vdots\\\\&#10;1&amp;\\alpha_{n-1}&amp;\\cdots&amp;\\cdots&amp;\\cdots&amp;\\cdots&amp;\\alpha_{n-1}^{n}\\end{array}\\right|,\" display=\"block\"><mrow><mrow><msubsup><mi>D</mi><mrow><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mi>n</mi></mrow><mrow><mo>-</mo><mi>k</mi></mrow></msubsup><mo>=</mo><mrow><msup><mi>p</mi><mrow><msup><mi>n</mi><mn>2</mn></msup><mo>-</mo><mi>k</mi></mrow></msup><mo>\u2062</mo><msup><mi>q</mi><mrow><mfrac><mrow><mrow><mn>2</mn><mo>\u2062</mo><msup><mi>n</mi><mn>3</mn></msup></mrow><mo>+</mo><mi>n</mi></mrow><mn>3</mn></mfrac><mo>-</mo><msup><mi>k</mi><mn>2</mn></msup></mrow></msup><mo>\u2062</mo><mrow><mo>|</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mn>1</mn></mtd><mtd columnalign=\"center\"><msub><mi>\u03b1</mi><mn>0</mn></msub></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><msubsup><mi>\u03b1</mi><mn>0</mn><mrow><mi>k</mi><mo>-</mo><mn>1</mn></mrow></msubsup></mtd><mtd columnalign=\"center\"><msubsup><mi>\u03b1</mi><mn>0</mn><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><msubsup><mi>\u03b1</mi><mn>0</mn><mi>n</mi></msubsup></mtd></mtr><mtr><mtd columnalign=\"center\"><mn>1</mn></mtd><mtd columnalign=\"center\"><msub><mi>\u03b1</mi><mn>1</mn></msub></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><msubsup><mi>\u03b1</mi><mn>1</mn><mrow><mi>k</mi><mo>-</mo><mn>1</mn></mrow></msubsup></mtd><mtd columnalign=\"center\"><msubsup><mi>\u03b1</mi><mn>1</mn><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><msubsup><mi>\u03b1</mi><mn>1</mn><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mtd></mtr><mtr><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd></mtr><mtr><mtd columnalign=\"center\"><mn>1</mn></mtd><mtd columnalign=\"center\"><msub><mi>\u03b1</mi><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></msub></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><msubsup><mi>\u03b1</mi><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow><mi>n</mi></msubsup></mtd></mtr></mtable><mo>|</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nwhere $\\beta_{k}=(-1)^{n-k}e_{n-k}\\left(\\alpha_{0},\\ldots,\\alpha_{n-1}\\right)$, and $e_{k}\\left(X_{1},\\ldots,X_{n}\\right)$ denotes the elementary symmetric polynomial, defined previously in  \\eqref{eq:ElementarySymmetricPolynomial}. We apply the elementary operation $C_{n}\\rightarrow C_{n}+\\sum_{j=0}^{k-1}a_{j}C_{j+1}+\\sum_{j=k+1}^{n-1}a_{j}C_{j}$, followed by $n-k$ cyclic permutations to get\n\n", "itemtype": "equation", "pos": 41198, "prevtext": "\nwhere $\\alpha_{k}=q^{2k}$, for $k=0,\\ldots,n-1$. Expanding the polynomial $B(X)=\\prod_{i=0}^{n-1}(x-\\alpha_{i})$, we get\n\n", "index": 61, "text": "\\begin{equation*}\nB(x)=x^{n}+\\beta_{n-1}x^{n-1}+\\ldots+\\beta_{0},\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex9.m1\" class=\"ltx_Math\" alttext=\"B(x)=x^{n}+\\beta_{n-1}x^{n-1}+\\ldots+\\beta_{0},\" display=\"block\"><mrow><mrow><mrow><mi>B</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><msup><mi>x</mi><mi>n</mi></msup><mo>+</mo><mrow><msub><mi>\u03b2</mi><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><msup><mi>x</mi><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow><mo>+</mo><mi mathvariant=\"normal\">\u2026</mi><mo>+</mo><msub><mi>\u03b2</mi><mn>0</mn></msub></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nInserting \\eqref{eq:Dn2} and \\eqref{eq:MinorDnn} into \\eqref{eq:PolynomialExpression1} leads to \\eqref{eq:OrthonormalPolynomialLogNormalExpression}.\n\\end{proof}\n\n\\section*{A.2 Computing the coefficients of the expansion $\\{a_{k}\\}_{k\\in{\\mathbb{N}_0}}$\nin the gamma case} \\label{app:proof}\n\nWe extend here the techniques developed in \\cite{La15} to construct an approximation\nfor ${\\mathscr{L}}_i(\\theta)$. We note that ${\\mathscr{L}}_i(\\theta) \\propto \\int_{{\\mathbb{R}}^n} \\exp\\{ -h_{\\theta,i}({\\bm{x}}) \\} \\dif {\\bm{x}} $ where\n", "itemtype": "equation", "pos": 41676, "prevtext": "\nwhere $\\beta_{k}=(-1)^{n-k}e_{n-k}\\left(\\alpha_{0},\\ldots,\\alpha_{n-1}\\right)$, and $e_{k}\\left(X_{1},\\ldots,X_{n}\\right)$ denotes the elementary symmetric polynomial, defined previously in  \\eqref{eq:ElementarySymmetricPolynomial}. We apply the elementary operation $C_{n}\\rightarrow C_{n}+\\sum_{j=0}^{k-1}a_{j}C_{j+1}+\\sum_{j=k+1}^{n-1}a_{j}C_{j}$, followed by $n-k$ cyclic permutations to get\n\n", "index": 63, "text": "\\begin{equation}\\label{eq:MinorDnn}\nD_{n-1,n}^{-k}=p^{n-k}q^{n^{2}-k^{2}}e_{n-k}\\left(1,\\ldots,q^{2(n-1)}\\right)D_{n-1,n-1}.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E25.m1\" class=\"ltx_Math\" alttext=\"D_{n-1,n}^{-k}=p^{n-k}q^{n^{2}-k^{2}}e_{n-k}\\left(1,\\ldots,q^{2(n-1)}\\right)D_%&#10;{n-1,n-1}.\" display=\"block\"><mrow><mrow><msubsup><mi>D</mi><mrow><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mi>n</mi></mrow><mrow><mo>-</mo><mi>k</mi></mrow></msubsup><mo>=</mo><mrow><msup><mi>p</mi><mrow><mi>n</mi><mo>-</mo><mi>k</mi></mrow></msup><mo>\u2062</mo><msup><mi>q</mi><mrow><msup><mi>n</mi><mn>2</mn></msup><mo>-</mo><msup><mi>k</mi><mn>2</mn></msup></mrow></msup><mo>\u2062</mo><msub><mi>e</mi><mrow><mi>n</mi><mo>-</mo><mi>k</mi></mrow></msub><mo>\u2062</mo><mrow><mo>(</mo><mn>1</mn><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><msup><mi>q</mi><mrow><mn>2</mn><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msup><mo>)</mo></mrow><mo>\u2062</mo><msub><mi>D</mi><mrow><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></mrow></msub></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nThis uses the notation ${\\bm{\\mathrm{e}}}^{{\\bm{x}}} = ({\\mathrm{e}}^{x_1}, \\dots, {\\mathrm{e}}^{x_n})^\\top$. Next, define ${\\bm{x}}^*$ as the minimiser of $h_{\\theta,i}$ (calculated numerically), and consider a second order Taylor expansion of $h_{\\theta,i}$ about ${\\bm{x}}^*$. Denote $\\widetilde{{\\mathscr{L}}}_i(\\theta)$ as the approximation where $h_{\\theta,i}$ is replaced by this Taylor expansion in ${\\mathscr{L}}_i(\\theta)$. Simplifying yields\n\n", "itemtype": "equation", "pos": 42346, "prevtext": "\nInserting \\eqref{eq:Dn2} and \\eqref{eq:MinorDnn} into \\eqref{eq:PolynomialExpression1} leads to \\eqref{eq:OrthonormalPolynomialLogNormalExpression}.\n\\end{proof}\n\n\\section*{A.2 Computing the coefficients of the expansion $\\{a_{k}\\}_{k\\in{\\mathbb{N}_0}}$\nin the gamma case} \\label{app:proof}\n\nWe extend here the techniques developed in \\cite{La15} to construct an approximation\nfor ${\\mathscr{L}}_i(\\theta)$. We note that ${\\mathscr{L}}_i(\\theta) \\propto \\int_{{\\mathbb{R}}^n} \\exp\\{ -h_{\\theta,i}({\\bm{x}}) \\} \\dif {\\bm{x}} $ where\n", "index": 65, "text": "\n\\[ h_{\\theta,i}({\\bm{x}}) = - i \\ln({\\bm{1}}^{\\top} {\\bm{\\mathrm{e}}}^{{\\bm{\\mu}} + {\\bm{x}}}) + \\theta {\\bm{1}}^{\\top} {\\bm{\\mathrm{e}}}^{{\\bm{\\mu}} + {\\bm{x}}} + \\frac12 {\\bm{x}}^{\\top} {\\bm{\\Sigma}}^{-1} {\\bm{x}} \\,, \\quad i \\in {\\mathbb{N}_0} \\,. \\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex10.m1\" class=\"ltx_Math\" alttext=\"h_{\\theta,i}({\\bm{x}})=-i\\ln({\\bm{1}}^{\\top}{\\bm{\\mathrm{e}}}^{{\\bm{\\mu}}+{\\bm%&#10;{x}}})+\\theta{\\bm{1}}^{\\top}{\\bm{\\mathrm{e}}}^{{\\bm{\\mu}}+{\\bm{x}}}+\\frac{1}{2%&#10;}{\\bm{x}}^{\\top}{\\bm{\\Sigma}}^{-1}{\\bm{x}}\\,,\\quad i\\in{\\mathbb{N}_{0}}\\,.\" display=\"block\"><mrow><mrow><mrow><mrow><msub><mi>h</mi><mrow><mi>\u03b8</mi><mo>,</mo><mi>i</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc99</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mo>-</mo><mrow><mi>i</mi><mo>\u2062</mo><mrow><mi>ln</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mn>\ud835\udfcf</mn><mo>\u22a4</mo></msup><mo>\u2062</mo><msup><mi>\ud835\udc1e</mi><mrow><mi>\ud835\udf41</mi><mo>+</mo><mi>\ud835\udc99</mi></mrow></msup></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>+</mo><mrow><mi>\u03b8</mi><mo>\u2062</mo><msup><mn>\ud835\udfcf</mn><mo>\u22a4</mo></msup><mo>\u2062</mo><msup><mi>\ud835\udc1e</mi><mrow><mi>\ud835\udf41</mi><mo>+</mo><mi>\ud835\udc99</mi></mrow></msup></mrow><mo>+</mo><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>\u2062</mo><msup><mi>\ud835\udc99</mi><mo>\u22a4</mo></msup><mo>\u2062</mo><msup><mi>\ud835\udeba</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><mpadded width=\"+1.7pt\"><mi>\ud835\udc99</mi></mpadded></mrow></mrow></mrow><mo rspace=\"12.5pt\">,</mo><mrow><mi>i</mi><mo>\u2208</mo><mpadded width=\"+1.7pt\"><msub><mi>\u2115</mi><mn>0</mn></msub></mpadded></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nwhere ${\\bm{H}}$, the Hessian of $h_{\\theta,i}$ evaluated at ${\\bm{x}}^*$, is\n", "itemtype": "equation", "pos": 43054, "prevtext": "\nThis uses the notation ${\\bm{\\mathrm{e}}}^{{\\bm{x}}} = ({\\mathrm{e}}^{x_1}, \\dots, {\\mathrm{e}}^{x_n})^\\top$. Next, define ${\\bm{x}}^*$ as the minimiser of $h_{\\theta,i}$ (calculated numerically), and consider a second order Taylor expansion of $h_{\\theta,i}$ about ${\\bm{x}}^*$. Denote $\\widetilde{{\\mathscr{L}}}_i(\\theta)$ as the approximation where $h_{\\theta,i}$ is replaced by this Taylor expansion in ${\\mathscr{L}}_i(\\theta)$. Simplifying yields\n\n", "index": 67, "text": "\\begin{equation} \\label{firstTerm}\n\t\\widetilde{{\\mathscr{L}}}_i(\\theta) = \\frac{\\exp\\{-h_{\\theta,i}({\\bm{x}}^*)\\}}{\\sqrt{|{\\bm{\\Sigma}} {\\bm{H}}|}}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E26.m1\" class=\"ltx_Math\" alttext=\"\\widetilde{{\\mathscr{L}}}_{i}(\\theta)=\\frac{\\exp\\{-h_{\\theta,i}({\\bm{x}}^{*})%&#10;\\}}{\\sqrt{|{\\bm{\\Sigma}}{\\bm{H}}|}}\" display=\"block\"><mrow><mrow><msub><mover accent=\"true\"><mi class=\"ltx_font_mathscript\">\u2112</mi><mo>~</mo></mover><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mfrac><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mo>-</mo><mrow><msub><mi>h</mi><mrow><mi>\u03b8</mi><mo>,</mo><mi>i</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc99</mi><mo>*</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><msqrt><mrow><mo stretchy=\"false\">|</mo><mrow><mi>\ud835\udeba</mi><mo>\u2062</mo><mi>\ud835\udc6f</mi></mrow><mo stretchy=\"false\">|</mo></mrow></msqrt></mfrac></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\n\nAs $\\theta \\to \\infty$ we have $\\widetilde{{\\mathscr{L}}}_i(\\theta) \\to {\\mathscr{L}}_i(\\theta)$. We can rewrite ${\\mathscr{L}}_i(\\theta) = \\widetilde{{\\mathscr{L}}}_i(\\theta) I_i(\\theta)$ and estimate $I_i(\\theta)$, as in \\cite{La15}.\n\n\\begin{proposition} \\label{prop:laplace_derivatives}\nThe moments of the exponentially-tilted distribution ${\\mathcal{SLN}}_\\theta({\\bm{\\mu}}, {\\bm{\\Sigma}})$, denoted ${\\mathscr{L}}_i(\\theta)$, can be written as ${\\mathscr{L}}_i(\\theta) = \\widetilde{{\\mathscr{L}}}_i(\\theta) I_i(\\theta)$ where $\\widetilde{{\\mathscr{L}}}_i(\\theta)$ is in \\eqref{firstTerm} and\n\n", "itemtype": "equation", "pos": 43294, "prevtext": "\nwhere ${\\bm{H}}$, the Hessian of $h_{\\theta,i}$ evaluated at ${\\bm{x}}^*$, is\n", "index": 69, "text": "\n\\[ {\\bm{H}} = i\\frac{{\\bm{\\mathrm{e}}}^{{\\bm{\\mu}} + {\\bm{x}}^*} ({\\bm{\\mathrm{e}}}^{{\\bm{\\mu}} + {\\bm{x}}^*})^{\\top}}{({\\bm{1}}^{\\top} {\\bm{\\mathrm{e}}}^{{\\bm{\\mu}} + {\\bm{x}}^*})^2} + {\\bm{\\Sigma}}^{-1} - {\\mathrm{diag}}({\\bm{\\Sigma}}^{-1} {\\bm{x}}^*) \\,. \\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex11.m1\" class=\"ltx_Math\" alttext=\"{\\bm{H}}=i\\frac{{\\bm{\\mathrm{e}}}^{{\\bm{\\mu}}+{\\bm{x}}^{*}}({\\bm{\\mathrm{e}}}^%&#10;{{\\bm{\\mu}}+{\\bm{x}}^{*}})^{\\top}}{({\\bm{1}}^{\\top}{\\bm{\\mathrm{e}}}^{{\\bm{\\mu%&#10;}}+{\\bm{x}}^{*}})^{2}}+{\\bm{\\Sigma}}^{-1}-{\\mathrm{diag}}({\\bm{\\Sigma}}^{-1}{%&#10;\\bm{x}}^{*})\\,.\" display=\"block\"><mrow><mrow><mi>\ud835\udc6f</mi><mo>=</mo><mrow><mrow><mrow><mi>i</mi><mo>\u2062</mo><mfrac><mrow><msup><mi>\ud835\udc1e</mi><mrow><mi>\ud835\udf41</mi><mo>+</mo><msup><mi>\ud835\udc99</mi><mo>*</mo></msup></mrow></msup><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc1e</mi><mrow><mi>\ud835\udf41</mi><mo>+</mo><msup><mi>\ud835\udc99</mi><mo>*</mo></msup></mrow></msup><mo stretchy=\"false\">)</mo></mrow><mo>\u22a4</mo></msup></mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mn>\ud835\udfcf</mn><mo>\u22a4</mo></msup><mo>\u2062</mo><msup><mi>\ud835\udc1e</mi><mrow><mi>\ud835\udf41</mi><mo>+</mo><msup><mi>\ud835\udc99</mi><mo>*</mo></msup></mrow></msup></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></mfrac></mrow><mo>+</mo><msup><mi>\ud835\udeba</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mrow><mo>-</mo><mrow><mi>diag</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mi>\ud835\udeba</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><msup><mi>\ud835\udc99</mi><mo>*</mo></msup></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nwhere $Z \\sim {\\mathcal{N}}({\\bm{0}}, {\\bm{I}})$, and\n", "itemtype": "equation", "pos": 44154, "prevtext": "\n\nAs $\\theta \\to \\infty$ we have $\\widetilde{{\\mathscr{L}}}_i(\\theta) \\to {\\mathscr{L}}_i(\\theta)$. We can rewrite ${\\mathscr{L}}_i(\\theta) = \\widetilde{{\\mathscr{L}}}_i(\\theta) I_i(\\theta)$ and estimate $I_i(\\theta)$, as in \\cite{La15}.\n\n\\begin{proposition} \\label{prop:laplace_derivatives}\nThe moments of the exponentially-tilted distribution ${\\mathcal{SLN}}_\\theta({\\bm{\\mu}}, {\\bm{\\Sigma}})$, denoted ${\\mathscr{L}}_i(\\theta)$, can be written as ${\\mathscr{L}}_i(\\theta) = \\widetilde{{\\mathscr{L}}}_i(\\theta) I_i(\\theta)$ where $\\widetilde{{\\mathscr{L}}}_i(\\theta)$ is in \\eqref{firstTerm} and\n\n", "index": 71, "text": "\\begin{align*}\n\tI_i(\\theta) &= \\sqrt{|{\\bm{\\Sigma}} {\\bm{H}}|} \\, v({\\bm{0}})^{-1} \\, {\\mathbb{E}}[v({\\bm{\\Sigma}}^{\\frac12} Z)]\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex12.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle I_{i}(\\theta)\" display=\"inline\"><mrow><msub><mi>I</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex12.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\sqrt{|{\\bm{\\Sigma}}{\\bm{H}}|}\\,v({\\bm{0}})^{-1}\\,{\\mathbb{E}}[v%&#10;({\\bm{\\Sigma}}^{\\frac{1}{2}}Z)]\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mpadded width=\"+1.7pt\"><msqrt><mrow><mo stretchy=\"false\">|</mo><mrow><mi>\ud835\udeba</mi><mo>\u2062</mo><mi>\ud835\udc6f</mi></mrow><mo stretchy=\"false\">|</mo></mrow></msqrt></mpadded><mo>\u2062</mo><mi>v</mi><mo>\u2062</mo><mpadded width=\"+1.7pt\"><msup><mrow><mo stretchy=\"false\">(</mo><mn/><mo stretchy=\"false\">)</mo></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup></mpadded><mo>\u2062</mo><mi>\ud835\udd3c</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mi>v</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mi>\ud835\udeba</mi><mfrac><mn>1</mn><mn>2</mn></mfrac></msup><mo>\u2062</mo><mi>Z</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\n\\end{proposition}\n\\begin{proof}\nWe begin by substituting ${\\bm{x}} = {\\bm{x}}^* + {\\bm{H}}^{-\\frac12} {\\bm{y}}$ into ${\\mathscr{L}}_i(\\theta)$, then multiply by $\\exp\\{ \\pm \\text{ some constants}\\,\\}$:\n\n", "itemtype": "equation", "pos": 44349, "prevtext": "\nwhere $Z \\sim {\\mathcal{N}}({\\bm{0}}, {\\bm{I}})$, and\n", "index": 73, "text": "\n\\[ v({\\bm{z}}) = \\exp\\{ i \\ln({\\bm{1}}^{\\top} {\\bm{\\mathrm{e}}}^{{\\bm{\\mu}} + {\\bm{x}}^* + {\\bm{z}}}) - \\theta {\\bm{1}}^{\\top} {\\bm{\\mathrm{e}}}^{{\\bm{\\mu}} + {\\bm{x}}^* + {\\bm{z}}} - ({\\bm{x}}^*)^{\\top} {\\bm{\\Sigma}}^{-1} {\\bm{z}} \\} \\,. \\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex13.m1\" class=\"ltx_Math\" alttext=\"v({\\bm{z}})=\\exp\\{i\\ln({\\bm{1}}^{\\top}{\\bm{\\mathrm{e}}}^{{\\bm{\\mu}}+{\\bm{x}}^{%&#10;*}+{\\bm{z}}})-\\theta{\\bm{1}}^{\\top}{\\bm{\\mathrm{e}}}^{{\\bm{\\mu}}+{\\bm{x}}^{*}+%&#10;{\\bm{z}}}-({\\bm{x}}^{*})^{\\top}{\\bm{\\Sigma}}^{-1}{\\bm{z}}\\}\\,.\" display=\"block\"><mrow><mrow><mrow><mi>v</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc9b</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mrow><mi>i</mi><mo>\u2062</mo><mrow><mi>ln</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mn>\ud835\udfcf</mn><mo>\u22a4</mo></msup><mo>\u2062</mo><msup><mi>\ud835\udc1e</mi><mrow><mi>\ud835\udf41</mi><mo>+</mo><msup><mi>\ud835\udc99</mi><mo>*</mo></msup><mo>+</mo><mi>\ud835\udc9b</mi></mrow></msup></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>-</mo><mrow><mi>\u03b8</mi><mo>\u2062</mo><msup><mn>\ud835\udfcf</mn><mo>\u22a4</mo></msup><mo>\u2062</mo><msup><mi>\ud835\udc1e</mi><mrow><mi>\ud835\udf41</mi><mo>+</mo><msup><mi>\ud835\udc99</mi><mo>*</mo></msup><mo>+</mo><mi>\ud835\udc9b</mi></mrow></msup></mrow><mo>-</mo><mrow><msup><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc99</mi><mo>*</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo>\u22a4</mo></msup><mo>\u2062</mo><msup><mi>\ud835\udeba</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><mi>\ud835\udc9b</mi></mrow></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">}</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nThat is, ${\\mathscr{L}}_i(\\theta) = \\widetilde{{\\mathscr{L}}}_i(\\theta) I_i(\\theta)$. In $I_i(\\theta)$, take the change of variable ${\\bm{y}} = ({\\bm{\\Sigma}}{\\bm{H}})^{\\frac12} {\\bm{z}}$, and the result follows.\n\n\n\n\n\n\n\n\\end{proof}\n\n\n\\begin{remark}\nThe form of $I_i(\\theta)$ naturally suggests evaluation using \\emph{Gauss--Hermite} quadrature:\n\n", "itemtype": "equation", "pos": 44794, "prevtext": "\n\\end{proposition}\n\\begin{proof}\nWe begin by substituting ${\\bm{x}} = {\\bm{x}}^* + {\\bm{H}}^{-\\frac12} {\\bm{y}}$ into ${\\mathscr{L}}_i(\\theta)$, then multiply by $\\exp\\{ \\pm \\text{ some constants}\\,\\}$:\n\n", "index": 75, "text": "\\begin{align*}\n\t{\\mathscr{L}}_i(\\theta) &= \\int_{{\\mathbb{R}}^n} \\frac{ (2{\\uppi})^{-\\frac{n}{2}} }{\\sqrt{|{\\bm{\\Sigma}}|}} \\exp\\{ i \\log({\\bm{1}}^{\\top} {\\bm{\\mathrm{e}}}^{{\\bm{\\mu}} + {\\bm{x}}}) - \\theta {\\bm{1}}^{\\top} {\\bm{\\mathrm{e}}}^{{\\bm{\\mu}} + {\\bm{x}}} - \\frac12 {\\bm{x}}^{\\top} {\\bm{\\Sigma}}^{-1} {\\bm{x}} \\}  \\dif {\\bm{x}} \\\\\n\t&= \\int_{{\\mathbb{R}}^n} \\frac{ (2{\\uppi})^{-\\frac{n}{2}} }{\\sqrt{|{\\bm{\\Sigma}} {\\bm{H}}|}} \\exp\\{ i \\log({\\bm{1}}^{\\top} {\\bm{\\mathrm{e}}}^{{\\bm{\\mu}} + {\\bm{x}}^* + {\\bm{H}}^{-\\frac12} {\\bm{y}}}) - \\theta {\\bm{1}}^{\\top} {\\bm{\\mathrm{e}}}^{{\\bm{\\mu}} + {\\bm{x}}^* + {\\bm{H}}^{-\\frac12} {\\bm{y}}} \\\\\n\t&\\qquad - \\frac12 ({\\bm{x}}^* + {\\bm{H}}^{-\\frac12} {\\bm{y}})^{\\top} {\\bm{\\Sigma}}^{-1} ({\\bm{x}}^* + {\\bm{H}}^{-\\frac12} {\\bm{y}}) \\}  \\dif {\\bm{y}} \\\\\n\t&= \\widetilde{{\\mathscr{L}}}_i(\\theta) \\exp\\{ -i \\log({\\bm{1}}^{\\top} {\\bm{\\mathrm{e}}}^{{\\bm{\\mu}} + {\\bm{x}}^*}) + \\theta {\\bm{1}}^{\\top} {\\bm{\\mathrm{e}}}^{{\\bm{\\mu}} + {\\bm{x}}^*} \\} \\\\\n\t&\\qquad \\times \\int_{{\\mathbb{R}}^n} (2{\\uppi})^{-\\frac{n}{2}} \\exp\\{ i \\log({\\bm{1}}^{\\top} {\\bm{\\mathrm{e}}}^{{\\bm{\\mu}} + {\\bm{x}}^* + {\\bm{H}}^{-\\frac12} {\\bm{y}}}) - \\theta {\\bm{1}}^{\\top} {\\bm{\\mathrm{e}}}^{{\\bm{\\mu}} + {\\bm{x}}^* + {\\bm{H}}^{-\\frac12} {\\bm{y}}} \\\\\n\t&\\qquad\\qquad -({\\bm{x}}^*)^{\\top} {\\bm{\\Sigma}}^{-1} {\\bm{H}}^{-\\frac12} {\\bm{y}} - \\frac12 {\\bm{y}}^{\\top} ({\\bm{\\Sigma}} {\\bm{H}})^{-1} {\\bm{y}} \\}  \\dif {\\bm{y}} \\,.\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex14.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle{\\mathscr{L}}_{i}(\\theta)\" display=\"inline\"><mrow><msub><mi class=\"ltx_font_mathscript\">\u2112</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex14.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\int_{{\\mathbb{R}}^{n}}\\frac{(2{\\uppi})^{-\\frac{n}{2}}}{\\sqrt{|{%&#10;\\bm{\\Sigma}}|}}\\exp\\{i\\log({\\bm{1}}^{\\top}{\\bm{\\mathrm{e}}}^{{\\bm{\\mu}}+{\\bm{x%&#10;}}})-\\theta{\\bm{1}}^{\\top}{\\bm{\\mathrm{e}}}^{{\\bm{\\mu}}+{\\bm{x}}}-\\frac{1}{2}{%&#10;\\bm{x}}^{\\top}{\\bm{\\Sigma}}^{-1}{\\bm{x}}\\}\\dif{\\bm{x}}\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mstyle displaystyle=\"true\"><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><msup><mi>\u211d</mi><mi>n</mi></msup></msub></mstyle><mrow><mstyle displaystyle=\"true\"><mfrac><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mn>2</mn><mo>\u2062</mo><mi mathvariant=\"normal\">\u03c0</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mo>-</mo><mfrac><mi>n</mi><mn>2</mn></mfrac></mrow></msup><msqrt><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udeba</mi><mo stretchy=\"false\">|</mo></mrow></msqrt></mfrac></mstyle><mo>\u2062</mo><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mrow><mi>i</mi><mo>\u2062</mo><mrow><mi>log</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mn>\ud835\udfcf</mn><mo>\u22a4</mo></msup><mo>\u2062</mo><msup><mi>\ud835\udc1e</mi><mrow><mi>\ud835\udf41</mi><mo>+</mo><mi>\ud835\udc99</mi></mrow></msup></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>-</mo><mrow><mi>\u03b8</mi><mo>\u2062</mo><msup><mn>\ud835\udfcf</mn><mo>\u22a4</mo></msup><mo>\u2062</mo><msup><mi>\ud835\udc1e</mi><mrow><mi>\ud835\udf41</mi><mo>+</mo><mi>\ud835\udc99</mi></mrow></msup></mrow><mo>-</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle><mo>\u2062</mo><msup><mi>\ud835\udc99</mi><mo>\u22a4</mo></msup><mo>\u2062</mo><msup><mi>\ud835\udeba</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><mi>\ud835\udc99</mi></mrow></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\dif</mtext></merror><mo>\u2062</mo><mi>\ud835\udc99</mi></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex15.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\int_{{\\mathbb{R}}^{n}}\\frac{(2{\\uppi})^{-\\frac{n}{2}}}{\\sqrt{|{%&#10;\\bm{\\Sigma}}{\\bm{H}}|}}\\exp\\{i\\log({\\bm{1}}^{\\top}{\\bm{\\mathrm{e}}}^{{\\bm{\\mu}%&#10;}+{\\bm{x}}^{*}+{\\bm{H}}^{-\\frac{1}{2}}{\\bm{y}}})-\\theta{\\bm{1}}^{\\top}{\\bm{%&#10;\\mathrm{e}}}^{{\\bm{\\mu}}+{\\bm{x}}^{*}+{\\bm{H}}^{-\\frac{1}{2}}{\\bm{y}}}\" display=\"inline\"><mrow><mo>=</mo><mstyle displaystyle=\"true\"><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><msup><mi>\u211d</mi><mi>n</mi></msup></msub></mstyle><mstyle displaystyle=\"true\"><mfrac><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mn>2</mn><mo>\u2062</mo><mi mathvariant=\"normal\">\u03c0</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mo>-</mo><mfrac><mi>n</mi><mn>2</mn></mfrac></mrow></msup><msqrt><mrow><mo stretchy=\"false\">|</mo><mrow><mi>\ud835\udeba</mi><mo>\u2062</mo><mi>\ud835\udc6f</mi></mrow><mo stretchy=\"false\">|</mo></mrow></msqrt></mfrac></mstyle><mi>exp</mi><mrow><mo stretchy=\"false\">{</mo><mi>i</mi><mi>log</mi><mrow><mo stretchy=\"false\">(</mo><msup><mn>\ud835\udfcf</mn><mo>\u22a4</mo></msup><msup><mi>\ud835\udc1e</mi><mrow><mi>\ud835\udf41</mi><mo>+</mo><msup><mi>\ud835\udc99</mi><mo>*</mo></msup><mo>+</mo><mrow><msup><mi>\ud835\udc6f</mi><mrow><mo>-</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></msup><mo>\u2062</mo><mi>\ud835\udc9a</mi></mrow></mrow></msup><mo stretchy=\"false\">)</mo></mrow><mo>-</mo><mi>\u03b8</mi><msup><mn>\ud835\udfcf</mn><mo>\u22a4</mo></msup><msup><mi>\ud835\udc1e</mi><mrow><mi>\ud835\udf41</mi><mo>+</mo><msup><mi>\ud835\udc99</mi><mo>*</mo></msup><mo>+</mo><mrow><msup><mi>\ud835\udc6f</mi><mrow><mo>-</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></msup><mo>\u2062</mo><mi>\ud835\udc9a</mi></mrow></mrow></msup></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex16.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\qquad-\\frac{1}{2}({\\bm{x}}^{*}+{\\bm{H}}^{-\\frac{1}{2}}{\\bm{y}})^%&#10;{\\top}{\\bm{\\Sigma}}^{-1}({\\bm{x}}^{*}+{\\bm{H}}^{-\\frac{1}{2}}{\\bm{y}})\\}\\dif{%&#10;\\bm{y}}\" display=\"inline\"><mrow><mi>\u2003\u2003</mi><mo>-</mo><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle><msup><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc99</mi><mo>*</mo></msup><mo>+</mo><msup><mi>\ud835\udc6f</mi><mrow><mo>-</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></msup><mi>\ud835\udc9a</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u22a4</mo></msup><msup><mi>\ud835\udeba</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc99</mi><mo>*</mo></msup><mo>+</mo><msup><mi>\ud835\udc6f</mi><mrow><mo>-</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></msup><mi>\ud835\udc9a</mi><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">}</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\dif</mtext></merror><mi>\ud835\udc9a</mi></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex17.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\widetilde{{\\mathscr{L}}}_{i}(\\theta)\\exp\\{-i\\log({\\bm{1}}^{\\top%&#10;}{\\bm{\\mathrm{e}}}^{{\\bm{\\mu}}+{\\bm{x}}^{*}})+\\theta{\\bm{1}}^{\\top}{\\bm{%&#10;\\mathrm{e}}}^{{\\bm{\\mu}}+{\\bm{x}}^{*}}\\}\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><msub><mover accent=\"true\"><mi class=\"ltx_font_mathscript\">\u2112</mi><mo>~</mo></mover><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mrow><mo>-</mo><mrow><mi>i</mi><mo>\u2062</mo><mrow><mi>log</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mn>\ud835\udfcf</mn><mo>\u22a4</mo></msup><mo>\u2062</mo><msup><mi>\ud835\udc1e</mi><mrow><mi>\ud835\udf41</mi><mo>+</mo><msup><mi>\ud835\udc99</mi><mo>*</mo></msup></mrow></msup></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>+</mo><mrow><mi>\u03b8</mi><mo>\u2062</mo><msup><mn>\ud835\udfcf</mn><mo>\u22a4</mo></msup><mo>\u2062</mo><msup><mi>\ud835\udc1e</mi><mrow><mi>\ud835\udf41</mi><mo>+</mo><msup><mi>\ud835\udc99</mi><mo>*</mo></msup></mrow></msup></mrow></mrow><mo stretchy=\"false\">}</mo></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex18.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\qquad\\times\\int_{{\\mathbb{R}}^{n}}(2{\\uppi})^{-\\frac{n}{2}}\\exp%&#10;\\{i\\log({\\bm{1}}^{\\top}{\\bm{\\mathrm{e}}}^{{\\bm{\\mu}}+{\\bm{x}}^{*}+{\\bm{H}}^{-%&#10;\\frac{1}{2}}{\\bm{y}}})-\\theta{\\bm{1}}^{\\top}{\\bm{\\mathrm{e}}}^{{\\bm{\\mu}}+{\\bm%&#10;{x}}^{*}+{\\bm{H}}^{-\\frac{1}{2}}{\\bm{y}}}\" display=\"inline\"><mrow><mi>\u2003\u2003</mi><mo>\u00d7</mo><mstyle displaystyle=\"true\"><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><msup><mi>\u211d</mi><mi>n</mi></msup></msub></mstyle><msup><mrow><mo stretchy=\"false\">(</mo><mn>2</mn><mi mathvariant=\"normal\">\u03c0</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mo>-</mo><mfrac><mi>n</mi><mn>2</mn></mfrac></mrow></msup><mi>exp</mi><mrow><mo stretchy=\"false\">{</mo><mi>i</mi><mi>log</mi><mrow><mo stretchy=\"false\">(</mo><msup><mn>\ud835\udfcf</mn><mo>\u22a4</mo></msup><msup><mi>\ud835\udc1e</mi><mrow><mi>\ud835\udf41</mi><mo>+</mo><msup><mi>\ud835\udc99</mi><mo>*</mo></msup><mo>+</mo><mrow><msup><mi>\ud835\udc6f</mi><mrow><mo>-</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></msup><mo>\u2062</mo><mi>\ud835\udc9a</mi></mrow></mrow></msup><mo stretchy=\"false\">)</mo></mrow><mo>-</mo><mi>\u03b8</mi><msup><mn>\ud835\udfcf</mn><mo>\u22a4</mo></msup><msup><mi>\ud835\udc1e</mi><mrow><mi>\ud835\udf41</mi><mo>+</mo><msup><mi>\ud835\udc99</mi><mo>*</mo></msup><mo>+</mo><mrow><msup><mi>\ud835\udc6f</mi><mrow><mo>-</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></msup><mo>\u2062</mo><mi>\ud835\udc9a</mi></mrow></mrow></msup></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex19.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\qquad\\qquad-({\\bm{x}}^{*})^{\\top}{\\bm{\\Sigma}}^{-1}{\\bm{H}}^{-%&#10;\\frac{1}{2}}{\\bm{y}}-\\frac{1}{2}{\\bm{y}}^{\\top}({\\bm{\\Sigma}}{\\bm{H}})^{-1}{%&#10;\\bm{y}}\\}\\dif{\\bm{y}}\\,.\" display=\"inline\"><mrow><mi>\u2003\u2003</mi><mo mathvariant=\"italic\" separator=\"true\">\u2003\u2003</mo><mo>-</mo><msup><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc99</mi><mo>*</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo>\u22a4</mo></msup><msup><mi>\ud835\udeba</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><msup><mi>\ud835\udc6f</mi><mrow><mo>-</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></msup><mi>\ud835\udc9a</mi><mo>-</mo><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle><msup><mi>\ud835\udc9a</mi><mo>\u22a4</mo></msup><msup><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udeba</mi><mi>\ud835\udc6f</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup><mi>\ud835\udc9a</mi><mo stretchy=\"false\">}</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\dif</mtext></merror><mpadded width=\"+1.7pt\"><mi>\ud835\udc9a</mi></mpadded><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01763.tex", "nexttext": "\nwhere ${\\bm{z}} = (z_{i_1}, \\dots, z_{i_n})^\\top$, the set of weights and nodes $\\{(w_i, z_i) : 1 \\le i \\le H\\}$ is specified by the Gauss--Hermite quadrature algorithm, and $H \\ge 1$ is the order of the approximation. This approximation is accurate, especially so when the $i$ in ${\\mathscr{L}}_i$ becomes large. Even for ${\\mathscr{L}}$ ($= {\\mathscr{L}}_0$) this method appears to outperform the quasi-Monte Carlo scheme outlined in \\cite{La15}. $\\hfill \\Diamond$\n\\end{remark}\n\nThus, with $\\widehat{{\\mathscr{L}}}_i(\\theta)$ given in \\eqref{eq:gauss-hermite-quad}, we can now estimate the coefficients. The three methods correspond to\n\\begin{enumerate}\n\\item $\\widehat{a}_k = R^{-1} \\sum_{r=1}^R Q_k(S_r)$, for $S_1$, \\dots, $S_R {\\overset{\\mathrm{i.i.d.}}{\\sim}} f_\\theta(x)$,\n\\item $\\widehat{a}_k = \\sum_{j=0}^k q_{kj} \\, \\widehat{{\\mathbb{E}}[S_\\theta^j]} = q_{k0} + (R \\, \\widehat{{\\mathscr{L}}}(\\theta))^{-1} \\sum_{j=1}^k q_{kj} \\sum_{r=1}^R S_r^j {\\mathrm{e}}^{-\\theta S_r}$, from \\eqref{eq:expand_coeffs}, where $S_1$, \\dots, $S_R {\\overset{\\mathrm{i.i.d.}}{\\sim}} f(x)$,\n\\item $\\widehat{a}_k = q_{k0} + \\widehat{{\\mathscr{L}}}(\\theta)^{-1} \\sum_{j=1}^k q_{kj} \\, \\widehat{{\\mathscr{L}}}_j(\\theta)$.\n\\end{enumerate}\nIn the numerical illustrations, we switched between using methods (2) and (3) for large and small $n$ respectively. Algorithms for efficient simulation from $f_\\theta$ is work in progress.\n\n\n\n\n\n\\end{appendix}\n\n\\bibliography{main}\n\\bibliographystyle{ws-book-van}\n\n\n", "itemtype": "equation", "pos": 46583, "prevtext": "\nThat is, ${\\mathscr{L}}_i(\\theta) = \\widetilde{{\\mathscr{L}}}_i(\\theta) I_i(\\theta)$. In $I_i(\\theta)$, take the change of variable ${\\bm{y}} = ({\\bm{\\Sigma}}{\\bm{H}})^{\\frac12} {\\bm{z}}$, and the result follows.\n\n\n\n\n\n\n\n\\end{proof}\n\n\n\\begin{remark}\nThe form of $I_i(\\theta)$ naturally suggests evaluation using \\emph{Gauss--Hermite} quadrature:\n\n", "index": 77, "text": "\\begin{equation} \\label{eq:gauss-hermite-quad}\n\t\\widehat{{\\mathscr{L}}}_i(\\theta) = \\frac{\\exp\\{-h_{\\theta,i}({\\bm{x}}^*)\\}}{v({\\bm{0}}) \\,{\\uppi}^{\\,n/2}} \\sum_{i_1=1}^H \\cdots \\sum_{i_n=1}^H v({\\bm{\\Sigma}}^{\\frac12} {\\bm{z}})  \\prod_{j=1}^n w_{i_j}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E27.m1\" class=\"ltx_Math\" alttext=\"\\widehat{{\\mathscr{L}}}_{i}(\\theta)=\\frac{\\exp\\{-h_{\\theta,i}({\\bm{x}}^{*})\\}}%&#10;{v({\\bm{0}})\\,{\\uppi}^{\\,n/2}}\\sum_{i_{1}=1}^{H}\\cdots\\sum_{i_{n}=1}^{H}v({\\bm%&#10;{\\Sigma}}^{\\frac{1}{2}}{\\bm{z}})\\prod_{j=1}^{n}w_{i_{j}}\" display=\"block\"><mrow><mrow><msub><mover accent=\"true\"><mi class=\"ltx_font_mathscript\">\u2112</mi><mo>^</mo></mover><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mo>-</mo><mrow><msub><mi>h</mi><mrow><mi>\u03b8</mi><mo>,</mo><mi>i</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc99</mi><mo>*</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><mrow><mi>v</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn/><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msup><mi mathvariant=\"normal\">\u03c0</mi><mrow><mpadded lspace=\"1.7pt\" width=\"+1.7pt\"><mi>n</mi></mpadded><mo>/</mo><mn>2</mn></mrow></msup></mrow></mfrac><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><msub><mi>i</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn></mrow><mi>H</mi></munderover><mrow><mi mathvariant=\"normal\">\u22ef</mi><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><msub><mi>i</mi><mi>n</mi></msub><mo>=</mo><mn>1</mn></mrow><mi>H</mi></munderover><mrow><mi>v</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mi>\ud835\udeba</mi><mfrac><mn>1</mn><mn>2</mn></mfrac></msup><mo>\u2062</mo><mi>\ud835\udc9b</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u220f</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><msub><mi>i</mi><mi>j</mi></msub></msub></mrow></mrow></mrow></mrow></mrow></mrow></mrow></math>", "type": "latex"}]