[{"file": "1601.03112.tex", "nexttext": "\nupon varying $\\varepsilon$. A system is said to have {\\em{linear response}} if the derivative\n\n", "itemtype": "equation", "pos": 11375, "prevtext": "\n\\begin{frontmatter}\n\n\n\n\\title{On spurious detection of linear response and misuse of the fluctuation-dissipation theorem in finite time series}\n\n\\author[USyd]{Georg A. Gottwald}\n\\ead{georg.gottwald@sydney.edu.au}\n\n\\author[USyd]{John P. Wormell}\n\\ead{jpwormell@gmail.com}\n\n\\author[USyd,MPI]{Jeroen Wouters}\n\n\\ead{jeroen.wouters@uni-hamburg.de}\n\n\\address[USyd]\n{School of Mathematics and Statistics, University of Sydney, NSW 2006, Australia}\n\n\\address[MPI]\n{Universit\\\"at Hamburg Geowissenschaften, Meteorologisches Institut, Bundesstr. 55, 20146 Hamburg, Germany}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\begin{abstract}  \nUsing a sensitive statistical test we determine whether or not one can detect the breakdown of linear response given observations of deterministic dynamical systems. A goodness-of-fit statistics is developed for a linear statistical model of the observations, based on results on central limit theorems for deterministic dynamical systems, and used to detect linear response breakdown. We apply the method to discrete maps which do not obey linear response and show that the successful detection of breakdown depends on the length of the time series, the magnitude of the perturbation and on the choice of the observable.\\\\ \nWe find that in order to reliably reject the assumption of linear response for typical observables sufficiently large data sets are needed. Even for simple systems such as the logistic map, one needs of the order of $10^6$ observations to reliably detect the breakdown; if less observations are available one may be falsely led to conclude that linear response theory is valid. The amount of data required is larger the smaller the applied perturbation. For judiciously chosen observables the necessary amount of data can be drastically reduced, but requires detailed {\\em{a priori}} knowledge about the invariant measure which is typically not available for complex dynamical systems.\\\\ \nFurthermore we explore the use of the fluctuation-dissipation theorem (FDT) in cases with limited data length or coarse-graining of observations. The FDT, if applied naively to a system without linear response, is shown to be very sensitive to the details of the sampling method, resulting in erroneous predictions of the response.\n\n\n\n\n\n\n\n\n\n\\end{abstract}\n\n\\begin{keyword}\nlinear response theory; fluctuation-dissipation theorem; climate science\n\\end{keyword}\n\\end{frontmatter}\n\n\n\n\\section{Introduction}\n\\label{sec-intro}\nAn important question in the study of probabilistic properties of dynamical systems is how to determine the response of a system if subjected to a small perturbation. For example, in climate science we would like to know how the global mean temperature changes upon increasing ${\\rm{CO}}_2$ levels. This problem was solved in statistical physics in the context of thermostatted Hamiltonian systems, establishing the framework of linear response theory \\cite{Kubo66,Balescu1,Zwanzig,MarconiEtAl08}. In essence, linear response theory employs a Taylor expansion of the perturbed invariant measure around the unperturbed equilibrium measure; this then allows to calculate averages of observables in the perturbed system entirely from knowledge of the statistics of the unperturbed system.\\\\\n\nThe study of linear response involves two issues: proving differentiability of the response and finding an expression for the derivative of the response. To establish linear response, the invariant measure needs to be differentiable with respect to the parameter describing the magnitude of the perturbation. For the existence of an analytical formula for the response in terms of the equilibrium fluctuations of the unperturbed system, which is the statement of the celebrated fluctuation-dissipation theorem (FDT), the invariant measure needs additionally to be differentiable with respect to the phase space variables.\\\\\n\nApplying this framework to deterministic dynamical systems, in particular to forced dissipative systems whose dynamics evolves on an attractor of zero Lebesgue measure in the full space, has been a challenge. In a series of papers, Ruelle showed that the response is linear for the class of uniformly hyperbolic Axiom A systems, i.e. the invariant measure is differentiable with respect to the magnitude of the perturbation \\cite{Ruelle97,Ruelle98,Ruelle09a,Ruelle09b}.\n\nDue to the singular nature of the invariant measure of forced dissipative systems the fluctuation-dissipation theorem, however, cannot hold. Heuristically this failure can be understood by realizing that typical perturbations will have a non-zero projection along the stable manifold, generally transverse to the attractor, whereas the invariant measure is supported entirely on the attractor. Therefore one cannot estimate the response by solely considering correlations of the unperturbed system. A linear response formula can still be expressed, but involves the full linear tangent dynamics and must take into account the evolution of exponentially attenuated perturbations along stable directions rather than just the unperturbed fluctuations along the unstable manifolds as in the FDT.\\\\\n\nThe hope that linear response theory can be extended to more general chaotic dynamical systems has been dampened by numerical results on the tent map \\cite{Ershov93} and rigorous analysis by Baladi and co-workers \\cite{BaladiSmania08,BaladiSmania10,Baladi14,BaladiEtAl15}. In particular, it was shown that the logistic map does not obey linear response. This is due to the non-smooth changes of the invariant measure when perturbing from a chaotic parameter value to a periodic one or vice versa. Even worse, even when restricting to the Cantor set of chaotic parameter values the measure is not differentiable in the sense of Whitney. On the other hand, there are numerical simulations suggesting that linear response might exist for some examples of non-uniformly hyperbolic systems \\cite{Reick02,CessacSepulchre07,LucariniSarno11} including the Lorenz '63 system which involves homoclinic tangencies. Furthermore, the lack of structural stability, which was believed to be an obstruction to linear response theory in the climate system \\cite{McWilliams07}, does not preclude the existence of linear response as was rigorously shown in \\cite{Dolgopyat04}. On the other hand, the belief that the summability of the correlation function was a sufficient condition for the existence of linear response, has recently been rigorously disproved \\cite{Korepanov15,BaladiTodd15}.\\\\\n\n\nNotwithstanding the lack of rigorous mathematical proofs for its validity for general forced dissipative non-equilibrium systems, linear response theory has been taken up in the climate sciences to predict the response of the climate, as was first proposed by Leith \\cite{Leith75}. \n\n\n\n\n\n\nLinear response theory and the fluctuation-dissipation theorem has since been used with some success by several groups. It has been applied to various toy models related to atmospheric chaos \\cite{MajdaEtAl10,LucariniSarno11,AbramovMajda07,AbramovMajda08,CooperHaynes11,CooperEtAl13}, barotropic models \\cite{Bell80,GritsunDymnikov99,AbramovMajda09}, quasi-geostrophic models \\cite{DymnikovGritsun01}, atmospheric models \\cite{NorthEtAl93,CionniEtAl04,GritsunEtAl02,GritsunBranstator07,GritsunEtAl08,RingPlumb08,Gritsun10} and coupled climate models \\cite{LangenAlexeev05,KirkDavidoff09,FuchsEtAl14,RagoneEtAl15}.\n\n\nThese successes lead scientists to believe that high-dimensional complex systems may very well obey linear response. The standard argument is that complex systems involve a multitude of interacting processes on several temporal and spatial scales and behave effectively stochastically with a smooth invariant measure \\cite{MajdaEtAl10}. This point of view seems at least reasonable for observables of the slow dynamics of complex multi-scale systems which in the limit of infinite time-scale separation are asymptotically stochastic \\cite{MelbourneStuart11,GottwaldMelbourne13c,KellyMelbourne14}. In the case of stochastic dynamical systems linear response theory can indeed be justified \\cite{Haenggi78,HairerMajda10}. However, several instances are now known where atmospheric and oceanic dynamics exhibits a rough dependence on parameters \\cite{ChekrounEtAl14}, and where, even if linear response theory is observed, the fluctuation-dissipation theorem is not valid \\cite{CooperHaynes13}.\\\\\n\n\n\nOn a more fundamental level, however, it is by no means clear that high-dimensional complex systems do obey linear response theory. In this paper we do not attempt to answer this question. Rather, we consider the following practical issue: systems which do not obey linear response theory are observed with {\\em{finite}} time series. In such cases we seek to show that the breakdown might not be detectable, and the system's observed behavior may appear consistent with linear response theory. Moreover, the choice of the observable is crucial for the detectability of the breakdown of linear response in finite time series. In particular, we will show that global observables are less able to detect the non-smoothness of the invariant measure whereas local observables which hone in on the roughness of the invariant measure  will make the non-smoothness apparent for smaller amounts of data. Finally, the perturbation size also impacts on the detectability of breakdown, with smaller perturbations requiring more data for successful breakdown detection. \\\\\n\nThis work is motivated by the contradiction between the apparent success of linear response theory in the climate sciences and rigorous mathematical results proving the non-existence of linear response theory for a large class of dynamical systems.\\\\\n\nThe paper is organized as follows. In Section~\\ref{sec-lrt} we briefly review linear response theory and the fluctuation-dissipation theorem. In Section~\\ref{sec-eq} we propose a goodness of fit test to probe for the validity of linear response in time series. In Section~\\ref{sec-break} we discuss the logistic map, demonstrate the mechanism leading to the breakdown of linear response for this one-dimensional map and show how this breakdown might not be apparent with time series of insufficient length. We show the effect of finite data size as well as how the choice of the observable can either mask or emphasize the non-smoothness of the invariant measure. In Section~\\ref{sec-fdt} we show further that an application of the FDT in situations where linear response does not exist, cannot provide any reliable statistical information, not even in an averaged sense. We conclude with a summary in Section~\\ref{sec-summary}.\n\n\n\\section{Linear response theory}\n\\label{sec-lrt}\nWe consider here a family of dynamical systems $f_\\varepsilon:M \\to M$ on some space $M$. We  assume that the map $f_\\varepsilon$ depends smoothly on the parameter $\\varepsilon$ and that for each $\\varepsilon$ the dynamical systems admits a unique invariant physical measure $\\mu_\\varepsilon$, e.g. absolutely continuous measures or Sinai-Ruelle-Bowen measures (SRB). An ergodic measure is called physical if for a set of initial conditions of nonzero Lebesgue measure the temporal average of a typical observable converges to the spatial averages over this measure. Considering an observable $A:M\\to{\\mathbb{R}}$, we are interested in the change of the average of the observable \n\n", "index": 1, "text": "\\begin{align*}\n\\langle A\\rangle_\\varepsilon = \\int_M A\\, d\\mu_\\varepsilon\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\langle A\\rangle_{\\varepsilon}=\\int_{M}A\\,d\\mu_{\\varepsilon}\" display=\"inline\"><mrow><msub><mrow><mo stretchy=\"false\">\u27e8</mo><mi>A</mi><mo stretchy=\"false\">\u27e9</mo></mrow><mi>\u03b5</mi></msub><mo>=</mo><mrow><mstyle displaystyle=\"true\"><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mi>M</mi></msub></mstyle><mrow><mpadded width=\"+1.7pt\"><mi>A</mi></mpadded><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><msub><mi>\u03bc</mi><mi>\u03b5</mi></msub></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nexists. It is obvious that a sufficient condition for linear response is that the invariant measure $\\mu_\\varepsilon$ is differentiable with respect to $\\varepsilon$. If the limit does not exist, we say there is a breakdown of linear response. We assume that the observable captures sufficient dynamic information about the dynamical system; for example, an odd observable on a system symmetric about $0$ would be identically zero regardless of whether the system had a linear response or not.\\\\\n\nOne may further ask whether, if linear response exists, a computable analytical expression for the linear response \n\n", "itemtype": "equation", "pos": 11556, "prevtext": "\nupon varying $\\varepsilon$. A system is said to have {\\em{linear response}} if the derivative\n\n", "index": 3, "text": "\\begin{align*}\n\\langle A\\rangle^\\prime_{\\varepsilon_0}:= \\frac{\\partial}{\\partial\\varepsilon} \\langle A\\rangle_\\varepsilon |_{\\varepsilon_0}\n\n\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\langle A\\rangle^{\\prime}_{\\varepsilon_{0}}:=\\frac{\\partial}{%&#10;\\partial\\varepsilon}\\langle A\\rangle_{\\varepsilon}|_{\\varepsilon_{0}}\\par&#10;\\par&#10;\" display=\"inline\"><mrow><msubsup><mrow><mo stretchy=\"false\">\u27e8</mo><mi>A</mi><mo stretchy=\"false\">\u27e9</mo></mrow><msub><mi>\u03b5</mi><mn>0</mn></msub><mo>\u2032</mo></msubsup><mo>:=</mo><msub><mrow><mrow><mstyle displaystyle=\"true\"><mfrac><mo>\u2202</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>\u03b5</mi></mrow></mfrac></mstyle><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">\u27e8</mo><mi>A</mi><mo stretchy=\"false\">\u27e9</mo></mrow><mi>\u03b5</mi></msub></mrow><mo fence=\"true\" stretchy=\"false\">|</mo></mrow><msub><mi>\u03b5</mi><mn>0</mn></msub></msub></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\ncan be found for small values of $\\delta \\varepsilon=\\varepsilon-\\varepsilon_0$. To write down an expression of the linear response, we introduce a vector field $X$ as $X\\circ f_{\\varepsilon_0} :=\\partial_{\\varepsilon} f_\\varepsilon |_{\\varepsilon=\\varepsilon_0}$. Note that the introduction of the vector field $X$ is the standard way of formulating perturbations in statistical physics as $f_\\varepsilon = f_{\\varepsilon_0}+\\delta\\varepsilon X(f_{\\varepsilon_0})$. The linear response $\\langle A\\rangle^\\prime_{\\varepsilon_0}$ can then be formally expressed as\n\n", "itemtype": "equation", "pos": 12325, "prevtext": "\nexists. It is obvious that a sufficient condition for linear response is that the invariant measure $\\mu_\\varepsilon$ is differentiable with respect to $\\varepsilon$. If the limit does not exist, we say there is a breakdown of linear response. We assume that the observable captures sufficient dynamic information about the dynamical system; for example, an odd observable on a system symmetric about $0$ would be identically zero regardless of whether the system had a linear response or not.\\\\\n\nOne may further ask whether, if linear response exists, a computable analytical expression for the linear response \n\n", "index": 5, "text": "\\begin{align}\n\\langle A\\rangle_\\varepsilon \\approx \\langle A\\rangle_{\\varepsilon_0} + \\langle A\\rangle^\\prime_{\\varepsilon_0}\\,\\delta \\varepsilon\n\\label{e.linresp}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\langle A\\rangle_{\\varepsilon}\\approx\\langle A\\rangle_{%&#10;\\varepsilon_{0}}+\\langle A\\rangle^{\\prime}_{\\varepsilon_{0}}\\,\\delta\\varepsilon\" display=\"inline\"><mrow><msub><mrow><mo stretchy=\"false\">\u27e8</mo><mi>A</mi><mo stretchy=\"false\">\u27e9</mo></mrow><mi>\u03b5</mi></msub><mo>\u2248</mo><mrow><msub><mrow><mo stretchy=\"false\">\u27e8</mo><mi>A</mi><mo stretchy=\"false\">\u27e9</mo></mrow><msub><mi>\u03b5</mi><mn>0</mn></msub></msub><mo>+</mo><mrow><mpadded width=\"+1.7pt\"><msubsup><mrow><mo stretchy=\"false\">\u27e8</mo><mi>A</mi><mo stretchy=\"false\">\u27e9</mo></mrow><msub><mi>\u03b5</mi><mn>0</mn></msub><mo>\u2032</mo></msubsup></mpadded><mo>\u2062</mo><mi>\u03b4</mi><mo>\u2062</mo><mi>\u03b5</mi></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nfor $x\\in M$. Provided the unperturbed invariant measure $\\mu_{\\varepsilon_0}$ has a density $\\rho_{\\varepsilon_0} (x)$ that is differentiable with respect to $x\\in M$ and non-vanishing, one can perform partial integration in (\\ref{e.fdt0}) to rewrite the linear response in terms of an integral of a correlation function. This form of the linear response formula is known as the fluctuation-dissipation theorem \\cite{Ruelle97,Ruelle98,MarconiEtAl08} and reads as\n\n", "itemtype": "equation", "pos": 13064, "prevtext": "\ncan be found for small values of $\\delta \\varepsilon=\\varepsilon-\\varepsilon_0$. To write down an expression of the linear response, we introduce a vector field $X$ as $X\\circ f_{\\varepsilon_0} :=\\partial_{\\varepsilon} f_\\varepsilon |_{\\varepsilon=\\varepsilon_0}$. Note that the introduction of the vector field $X$ is the standard way of formulating perturbations in statistical physics as $f_\\varepsilon = f_{\\varepsilon_0}+\\delta\\varepsilon X(f_{\\varepsilon_0})$. The linear response $\\langle A\\rangle^\\prime_{\\varepsilon_0}$ can then be formally expressed as\n\n", "index": 7, "text": "\\begin{align}\n\\label{e.fdt0}\n\\frac{\\partial}{\\partial\\varepsilon} \\langle A\\rangle_\\varepsilon |_{\\varepsilon_0}\n= \\sum_{n = 0}^{\\infty} \\langle X (x) \\nabla (A \\circ\n  f_{\\varepsilon_0}^n) (x)\\rangle_{\\varepsilon_0} ,\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\frac{\\partial}{\\partial\\varepsilon}\\langle A\\rangle_{\\varepsilon%&#10;}|_{\\varepsilon_{0}}=\\sum_{n=0}^{\\infty}\\langle X(x)\\nabla(A\\circ f_{%&#10;\\varepsilon_{0}}^{n})(x)\\rangle_{\\varepsilon_{0}},\" display=\"inline\"><mrow><mrow><msub><mrow><mrow><mstyle displaystyle=\"true\"><mfrac><mo>\u2202</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>\u03b5</mi></mrow></mfrac></mstyle><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">\u27e8</mo><mi>A</mi><mo stretchy=\"false\">\u27e9</mo></mrow><mi>\u03b5</mi></msub></mrow><mo fence=\"true\" stretchy=\"false\">|</mo></mrow><msub><mi>\u03b5</mi><mn>0</mn></msub></msub><mo>=</mo><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi mathvariant=\"normal\">\u221e</mi></munderover></mstyle><msub><mrow><mo stretchy=\"false\">\u27e8</mo><mrow><mi>X</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mrow><mo>\u2207</mo><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>A</mi><mo>\u2218</mo><msubsup><mi>f</mi><msub><mi>\u03b5</mi><mn>0</mn></msub><mi>n</mi></msubsup></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">\u27e9</mo></mrow><msub><mi>\u03b5</mi><mn>0</mn></msub></msub></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nIn the form (\\ref{e.fdt}) the response formula is easier to apply to a numerical integration or to experimental data than the original response formula (\\ref{e.fdt0}), as it can be estimated directly from a long integration. The assumption that the invariant measure is differentiable is, however, a strong limitation, as it fails for dissipative systems with singular measures with support on an attractor as well as for absolutely continuous maps involving singularities such as the logistic map (see Section~\\ref{sec-break}).\\\\\n\nIntroducing the notation of a divergence operator with respect to a density $\\rho$\n\n", "itemtype": "equation", "pos": 13759, "prevtext": "\nfor $x\\in M$. Provided the unperturbed invariant measure $\\mu_{\\varepsilon_0}$ has a density $\\rho_{\\varepsilon_0} (x)$ that is differentiable with respect to $x\\in M$ and non-vanishing, one can perform partial integration in (\\ref{e.fdt0}) to rewrite the linear response in terms of an integral of a correlation function. This form of the linear response formula is known as the fluctuation-dissipation theorem \\cite{Ruelle97,Ruelle98,MarconiEtAl08} and reads as\n\n", "index": 9, "text": "\\begin{align}\n\\label{e.fdt}\n\\frac{\\partial}{\\partial\\varepsilon} \\langle A\\rangle_\\varepsilon |_{\\varepsilon_0}\n= -\\sum_{n = 0}^{\\infty}\n  \\left\\langle \\left( \\frac{\\nabla (\\rho_{\\varepsilon_0} (x) X\n  (x))}{\\rho_{\\varepsilon_0} (x)} \\right) A \\circ f^n_{\\varepsilon_0} (x)\n  \\right\\rangle_{\\varepsilon_0}\\; .\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\frac{\\partial}{\\partial\\varepsilon}\\langle A\\rangle_{\\varepsilon%&#10;}|_{\\varepsilon_{0}}=-\\sum_{n=0}^{\\infty}\\left\\langle\\left(\\frac{\\nabla(\\rho_{%&#10;\\varepsilon_{0}}(x)X(x))}{\\rho_{\\varepsilon_{0}}(x)}\\right)A\\circ f^{n}_{%&#10;\\varepsilon_{0}}(x)\\right\\rangle_{\\varepsilon_{0}}\\;.\" display=\"inline\"><mrow><mrow><msub><mrow><mrow><mstyle displaystyle=\"true\"><mfrac><mo>\u2202</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>\u03b5</mi></mrow></mfrac></mstyle><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">\u27e8</mo><mi>A</mi><mo stretchy=\"false\">\u27e9</mo></mrow><mi>\u03b5</mi></msub></mrow><mo fence=\"true\" stretchy=\"false\">|</mo></mrow><msub><mi>\u03b5</mi><mn>0</mn></msub></msub><mo>=</mo><mrow><mo>-</mo><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi mathvariant=\"normal\">\u221e</mi></munderover></mstyle><mpadded width=\"+2.8pt\"><msub><mrow><mo>\u27e8</mo><mrow><mrow><mrow><mrow><mo>(</mo><mstyle displaystyle=\"true\"><mfrac><mrow><mo>\u2207</mo><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\u03c1</mi><msub><mi>\u03b5</mi><mn>0</mn></msub></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>X</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msub><mi>\u03c1</mi><msub><mi>\u03b5</mi><mn>0</mn></msub></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mstyle><mo>)</mo></mrow><mo>\u2062</mo><mi>A</mi></mrow><mo>\u2218</mo><msubsup><mi>f</mi><msub><mi>\u03b5</mi><mn>0</mn></msub><mi>n</mi></msubsup></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u27e9</mo></mrow><msub><mi>\u03b5</mi><mn>0</mn></msub></msub></mpadded></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nthe response formula (\\ref{e.fdt}) can be concisely written as\n\n", "itemtype": "equation", "pos": 14696, "prevtext": "\nIn the form (\\ref{e.fdt}) the response formula is easier to apply to a numerical integration or to experimental data than the original response formula (\\ref{e.fdt0}), as it can be estimated directly from a long integration. The assumption that the invariant measure is differentiable is, however, a strong limitation, as it fails for dissipative systems with singular measures with support on an attractor as well as for absolutely continuous maps involving singularities such as the logistic map (see Section~\\ref{sec-break}).\\\\\n\nIntroducing the notation of a divergence operator with respect to a density $\\rho$\n\n", "index": 11, "text": "\\begin{align*} \n{\\operatorname{div}}_\\rho{B}\\,(x) = \\frac{{\\operatorname{div}}{(\\rho B)}(x)}{\\rho(x)}, \n\\label{e.divrho} \n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle{\\operatorname{div}}_{\\rho}{B}\\,(x)=\\frac{{\\operatorname{div}}{(%&#10;\\rho B)}(x)}{\\rho(x)},\" display=\"inline\"><mrow><mrow><mrow><mrow><msub><mo>div</mo><mi>\u03c1</mi></msub><mo>\u2061</mo><mpadded width=\"+1.7pt\"><mi>B</mi></mpadded></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mstyle displaystyle=\"true\"><mfrac><mrow><mrow><mo>div</mo><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03c1</mi><mo>\u2062</mo><mi>B</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mi>\u03c1</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mstyle></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nwith the correlation function $C_n$ between two observables $A$ and $B$ defined as\n\n", "itemtype": "equation", "pos": 14894, "prevtext": "\nthe response formula (\\ref{e.fdt}) can be concisely written as\n\n", "index": 13, "text": "\\begin{align}\n\\frac{\\partial}{\\partial\\varepsilon} \\langle A\\rangle_\\varepsilon|_{\\varepsilon_0} = - \\sum_{n=0}^{\\infty} C_n({\\operatorname{div}}_{\\rho_{\\varepsilon_0}}{X},A)\\, ,\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\frac{\\partial}{\\partial\\varepsilon}\\langle A\\rangle_{\\varepsilon%&#10;}|_{\\varepsilon_{0}}=-\\sum_{n=0}^{\\infty}C_{n}({\\operatorname{div}}_{\\rho_{%&#10;\\varepsilon_{0}}}{X},A)\\,,\" display=\"inline\"><mrow><mrow><msub><mrow><mrow><mstyle displaystyle=\"true\"><mfrac><mo>\u2202</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>\u03b5</mi></mrow></mfrac></mstyle><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">\u27e8</mo><mi>A</mi><mo stretchy=\"false\">\u27e9</mo></mrow><mi>\u03b5</mi></msub></mrow><mo fence=\"true\" stretchy=\"false\">|</mo></mrow><msub><mi>\u03b5</mi><mn>0</mn></msub></msub><mo>=</mo><mrow><mo>-</mo><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi mathvariant=\"normal\">\u221e</mi></munderover></mstyle><mrow><msub><mi>C</mi><mi>n</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mo>div</mo><msub><mi>\u03c1</mi><msub><mi>\u03b5</mi><mn>0</mn></msub></msub></msub><mo>\u2061</mo><mi>X</mi></mrow><mo>,</mo><mi>A</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nFor sufficiently fast decay of correlations one can estimate (\\ref{e.fdt}) from a time series $x_{i = 1,\\dotsc,N}$ of finite length $N$ via\n\n", "itemtype": "equation", "pos": 15168, "prevtext": "\nwith the correlation function $C_n$ between two observables $A$ and $B$ defined as\n\n", "index": 15, "text": "\\begin{align*}\nC_n(A,B) = \\left\\langle {{A \\hphantom{;}B\\circ f^n}} \\right\\rangle_{\\varepsilon_{0}} -\\, \\left\\langle {A} \\right\\rangle_{\\varepsilon_{0}} \\left\\langle {B} \\right\\rangle_{\\varepsilon_{0}} .\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle C_{n}(A,B)=\\left\\langle{{A\\hphantom{;}B\\circ f^{n}}}\\right%&#10;\\rangle_{\\varepsilon_{0}}-\\,\\left\\langle{A}\\right\\rangle_{\\varepsilon_{0}}%&#10;\\left\\langle{B}\\right\\rangle_{\\varepsilon_{0}}.\" display=\"inline\"><mrow><mrow><mrow><msub><mi>C</mi><mi>n</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>A</mi><mo>,</mo><mi>B</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><msub><mrow><mo>\u27e8</mo><mrow><mrow><mi>A</mi><mo>\u2062</mo><mi>B</mi></mrow><mo>\u2218</mo><msup><mi>f</mi><mi>n</mi></msup></mrow><mo>\u27e9</mo></mrow><msub><mi>\u03b5</mi><mn>0</mn></msub></msub><mo rspace=\"4.2pt\">-</mo><mrow><msub><mrow><mo>\u27e8</mo><mi>A</mi><mo>\u27e9</mo></mrow><msub><mi>\u03b5</mi><mn>0</mn></msub></msub><mo>\u2062</mo><msub><mrow><mo>\u27e8</mo><mi>B</mi><mo>\u27e9</mo></mrow><msub><mi>\u03b5</mi><mn>0</mn></msub></msub></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nwith $1\\ll n_{\\rm{max}}\\ll N$. This expression allows for the estimation of the first-order response to a perturbation using a times series of the unperturbed system, provided the unperturbed density $\\rho_{\\varepsilon_0}$ can be estimated form the time series as well. In the climate sciences $\\rho_{\\varepsilon_0}$ is mostly approximated either via a quasi-Gaussian approximation \\cite{GritsunBranstator07,GritsunEtAl08} or by kernel smoothing \\cite{CooperHaynes11}.\\\\\n\nBefore exploring examples where linear response does not exist, we show in Figure~\\ref{fig:spdresp} an example of linear response for the doubling map $f_\\varepsilon(x)={\\rm{mod}}(2 x + \\varepsilon \\sin(2 \\pi x),1)$ which for $\\varepsilon=0$ admits the Lebesgue measure as its invariant measure. Here the fluctuation-dissipation formula (\\ref{e.finitedatafdt}) accurately reproduces the actual response.\n\n\\begin{figure}[htbp]\n\\centering\n\n\\includegraphics[width=0.7\\linewidth]{figures/figure01.eps}\n\\caption{\\footnotesize{Response of the doubling map to the perturbation $X(x) = \\varepsilon\\, \\sin 2\\pi x$ for an observable $A(x) = \\cos 2\\pi x$. The continuous line represents the actual response, the dashed line depicts the result of the fluctuation-dissipation theorem (\\ref{e.finitedatafdt}). Note that for small values of the perturbation $\\varepsilon$ the two curves are indistinguishable.}}\n\\label{fig:spdresp}\n\\end{figure}\n\n\n\n\\section{Testing for linear response in finite time series}\n\\label{sec-eq}\nGiven a family of chaotic maps $f_\\varepsilon$ that may or may not obey linear response, we test for linear response at some reference state with parameter $\\varepsilon=\\varepsilon_0$ by examining the linear dependency of the response\n\n", "itemtype": "equation", "pos": 15525, "prevtext": "\nFor sufficiently fast decay of correlations one can estimate (\\ref{e.fdt}) from a time series $x_{i = 1,\\dotsc,N}$ of finite length $N$ via\n\n", "index": 17, "text": "\\begin{align}\n\\frac{\\partial}{\\partial\\varepsilon} \\langle A\\rangle_\\varepsilon |_{\\varepsilon_0}  \\approx -\\sum_{n=0}^{n_{\\rm{max}}} \\frac{1}{N-n} \\sum_{i=1}^{N-n} \\left({\\operatorname{div}}_{\\rho_{\\varepsilon_0}}{X}\\right)(x_i) A(x_{i+n}) \n\\label{e.finitedatafdt} \n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\frac{\\partial}{\\partial\\varepsilon}\\langle A\\rangle_{\\varepsilon%&#10;}|_{\\varepsilon_{0}}\\approx-\\sum_{n=0}^{n_{\\rm{max}}}\\frac{1}{N-n}\\sum_{i=1}^{%&#10;N-n}\\left({\\operatorname{div}}_{\\rho_{\\varepsilon_{0}}}{X}\\right)(x_{i})A(x_{i%&#10;+n})\" display=\"inline\"><mrow><msub><mrow><mrow><mstyle displaystyle=\"true\"><mfrac><mo>\u2202</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>\u03b5</mi></mrow></mfrac></mstyle><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">\u27e8</mo><mi>A</mi><mo stretchy=\"false\">\u27e9</mo></mrow><mi>\u03b5</mi></msub></mrow><mo fence=\"true\" stretchy=\"false\">|</mo></mrow><msub><mi>\u03b5</mi><mn>0</mn></msub></msub><mo>\u2248</mo><mrow><mo>-</mo><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><msub><mi>n</mi><mi>max</mi></msub></munderover></mstyle><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><mrow><mi>N</mi><mo>-</mo><mi>n</mi></mrow></mfrac></mstyle><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>N</mi><mo>-</mo><mi>n</mi></mrow></munderover></mstyle><mrow><mrow><mo>(</mo><mrow><msub><mo>div</mo><msub><mi>\u03c1</mi><msub><mi>\u03b5</mi><mn>0</mn></msub></msub></msub><mo>\u2061</mo><mi>X</mi></mrow><mo>)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mi>n</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nfor $M > 2$ different values of the perturbation parameter $\\varepsilon_1,\\dotsc,\\varepsilon_M$, by sampling $N_1,\\dotsc,N_M$ consecutive values from the equilibrium dynamics of $f{_{\\varepsilon_{{1}}}},\\dotsc,f{_{\\varepsilon_{{M}}}}$, respectively. Explicitly, for each $i=1,\\dotsc, M$, we have time series $x^i_n=f{_{\\varepsilon_{{i}}}}(x^i_{n-1})$ for $n= 1, \\dotsc, N_M$. The initial conditions $x^i_0$ are distributed according to the physical measure associated with $f{_{\\varepsilon_{{i}}}}$.\\\\ We consider bounded and continuous observables and assume that for each member of the family $f_{\\varepsilon_i}$ the autocorrelation $C_j(A,A)$ decays sufficiently rapidly, and that the lengths of the time series $N_i$ are large compared to typical decay times of the autocorrelation function; in practice we choose $N_i \\gg \\tau_{A,\\varepsilon_i}$, where $\\tau_{A,\\varepsilon_i}$ is the $1/e$-folding time of $A$ under the dynamics $f_{\\varepsilon_i}$. We further set, for simplicity, $N_i=N$ for all $i$.\\\\\n\nFor a large class of chaotic dynamical systems, the sample averages of the observations\n\n", "itemtype": "equation", "pos": 17519, "prevtext": "\nwith $1\\ll n_{\\rm{max}}\\ll N$. This expression allows for the estimation of the first-order response to a perturbation using a times series of the unperturbed system, provided the unperturbed density $\\rho_{\\varepsilon_0}$ can be estimated form the time series as well. In the climate sciences $\\rho_{\\varepsilon_0}$ is mostly approximated either via a quasi-Gaussian approximation \\cite{GritsunBranstator07,GritsunEtAl08} or by kernel smoothing \\cite{CooperHaynes11}.\\\\\n\nBefore exploring examples where linear response does not exist, we show in Figure~\\ref{fig:spdresp} an example of linear response for the doubling map $f_\\varepsilon(x)={\\rm{mod}}(2 x + \\varepsilon \\sin(2 \\pi x),1)$ which for $\\varepsilon=0$ admits the Lebesgue measure as its invariant measure. Here the fluctuation-dissipation formula (\\ref{e.finitedatafdt}) accurately reproduces the actual response.\n\n\\begin{figure}[htbp]\n\\centering\n\n\\includegraphics[width=0.7\\linewidth]{figures/figure01.eps}\n\\caption{\\footnotesize{Response of the doubling map to the perturbation $X(x) = \\varepsilon\\, \\sin 2\\pi x$ for an observable $A(x) = \\cos 2\\pi x$. The continuous line represents the actual response, the dashed line depicts the result of the fluctuation-dissipation theorem (\\ref{e.finitedatafdt}). Note that for small values of the perturbation $\\varepsilon$ the two curves are indistinguishable.}}\n\\label{fig:spdresp}\n\\end{figure}\n\n\n\n\\section{Testing for linear response in finite time series}\n\\label{sec-eq}\nGiven a family of chaotic maps $f_\\varepsilon$ that may or may not obey linear response, we test for linear response at some reference state with parameter $\\varepsilon=\\varepsilon_0$ by examining the linear dependency of the response\n\n", "index": 19, "text": "\\begin{align}\n\\delta A = \\langle A\\rangle_\\varepsilon - \\langle A\\rangle_{\\varepsilon_0}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\delta A=\\langle A\\rangle_{\\varepsilon}-\\langle A\\rangle_{%&#10;\\varepsilon_{0}}\" display=\"inline\"><mrow><mrow><mi>\u03b4</mi><mo>\u2062</mo><mi>A</mi></mrow><mo>=</mo><mrow><msub><mrow><mo stretchy=\"false\">\u27e8</mo><mi>A</mi><mo stretchy=\"false\">\u27e9</mo></mrow><mi>\u03b5</mi></msub><mo>-</mo><msub><mrow><mo stretchy=\"false\">\u27e8</mo><mi>A</mi><mo stretchy=\"false\">\u27e9</mo></mrow><msub><mi>\u03b5</mi><mn>0</mn></msub></msub></mrow></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nobey the central limit theorem and are distributed asymptotically as $\\mathcal{N}\\left(\\left\\langle {A} \\right\\rangle_{\\varepsilon_{{i}}}, \\sigma_i^2/N_i\\right)$ \\cite{melbournelectures,ColletEckmann07}.\nThe variances $\\sigma_i^2$ are given by the Green-Kubo formula in terms of lag-correlations of $f{_{\\varepsilon_{{i}}}}$ as\n\n", "itemtype": "equation", "pos": 18720, "prevtext": "\nfor $M > 2$ different values of the perturbation parameter $\\varepsilon_1,\\dotsc,\\varepsilon_M$, by sampling $N_1,\\dotsc,N_M$ consecutive values from the equilibrium dynamics of $f{_{\\varepsilon_{{1}}}},\\dotsc,f{_{\\varepsilon_{{M}}}}$, respectively. Explicitly, for each $i=1,\\dotsc, M$, we have time series $x^i_n=f{_{\\varepsilon_{{i}}}}(x^i_{n-1})$ for $n= 1, \\dotsc, N_M$. The initial conditions $x^i_0$ are distributed according to the physical measure associated with $f{_{\\varepsilon_{{i}}}}$.\\\\ We consider bounded and continuous observables and assume that for each member of the family $f_{\\varepsilon_i}$ the autocorrelation $C_j(A,A)$ decays sufficiently rapidly, and that the lengths of the time series $N_i$ are large compared to typical decay times of the autocorrelation function; in practice we choose $N_i \\gg \\tau_{A,\\varepsilon_i}$, where $\\tau_{A,\\varepsilon_i}$ is the $1/e$-folding time of $A$ under the dynamics $f_{\\varepsilon_i}$. We further set, for simplicity, $N_i=N$ for all $i$.\\\\\n\nFor a large class of chaotic dynamical systems, the sample averages of the observations\n\n", "index": 21, "text": "\\begin{align}\n\\bar{A}_i=\\frac{1}{N_i}\\sum_{n=1}^{N_i}A(x^i_n)\n\\label{e.Aavgs}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\bar{A}_{i}=\\frac{1}{N_{i}}\\sum_{n=1}^{N_{i}}A(x^{i}_{n})\" display=\"inline\"><mrow><msub><mover accent=\"true\"><mi>A</mi><mo stretchy=\"false\">\u00af</mo></mover><mi>i</mi></msub><mo>=</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><msub><mi>N</mi><mi>i</mi></msub></mfrac></mstyle><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mi>i</mi></msub></munderover></mstyle><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msubsup><mi>x</mi><mi>n</mi><mi>i</mi></msubsup><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\n\nThe central limit theorem implies\n\n", "itemtype": "equation", "pos": 19138, "prevtext": "\nobey the central limit theorem and are distributed asymptotically as $\\mathcal{N}\\left(\\left\\langle {A} \\right\\rangle_{\\varepsilon_{{i}}}, \\sigma_i^2/N_i\\right)$ \\cite{melbournelectures,ColletEckmann07}.\nThe variances $\\sigma_i^2$ are given by the Green-Kubo formula in terms of lag-correlations of $f{_{\\varepsilon_{{i}}}}$ as\n\n", "index": 23, "text": "\\begin{align} \n\\sigma_i^2 = C_0(A,A) + 2 \\sum_{j=1}^{\\infty} C_j(A,A)\\; . \n\\label{e.covar}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\sigma_{i}^{2}=C_{0}(A,A)+2\\sum_{j=1}^{\\infty}C_{j}(A,A)\\;.\" display=\"inline\"><mrow><mrow><msubsup><mi>\u03c3</mi><mi>i</mi><mn>2</mn></msubsup><mo>=</mo><mrow><mrow><msub><mi>C</mi><mn>0</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>A</mi><mo>,</mo><mi>A</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mn>2</mn><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi mathvariant=\"normal\">\u221e</mi></munderover></mstyle><mrow><msub><mi>C</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>A</mi><mo>,</mo><mi>A</mi><mo rspace=\"5.3pt\" stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nfor $i = 1,\\dotsc,M$ and {\\em{iid}} noise $\\xi_i \\sim N(0,I)$. If the dynamical system indeed has linear response and provided the perturbations $\\delta \\varepsilon_i=\\varepsilon_i-\\varepsilon_0$ are sufficiently small, the following statistical model holds for $\\bar{A}_i$\n\n", "itemtype": "equation", "pos": 19276, "prevtext": "\n\nThe central limit theorem implies\n\n", "index": 25, "text": "\\begin{align}\n\\bar{A}_i = \\langle A\\rangle_{\\varepsilon_i}  + \\frac{\\sigma_i}{\\sqrt{N}} \\xi_i \\; ,\n\\label{e.clt}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\bar{A}_{i}=\\langle A\\rangle_{\\varepsilon_{i}}+\\frac{\\sigma_{i}}{%&#10;\\sqrt{N}}\\xi_{i}\\;,\" display=\"inline\"><mrow><mrow><msub><mover accent=\"true\"><mi>A</mi><mo stretchy=\"false\">\u00af</mo></mover><mi>i</mi></msub><mo>=</mo><mrow><msub><mrow><mo stretchy=\"false\">\u27e8</mo><mi>A</mi><mo stretchy=\"false\">\u27e9</mo></mrow><msub><mi>\u03b5</mi><mi>i</mi></msub></msub><mo>+</mo><mrow><mstyle displaystyle=\"true\"><mfrac><msub><mi>\u03c3</mi><mi>i</mi></msub><msqrt><mi>N</mi></msqrt></mfrac></mstyle><mo>\u2062</mo><mpadded width=\"+2.8pt\"><msub><mi>\u03be</mi><mi>i</mi></msub></mpadded></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nwith $\\alpha_0=\\langle A\\rangle_{\\varepsilon_0}$ and $\\alpha_1= \\langle A\\rangle_{\\varepsilon_0}^\\prime$ for some unperturbed reference state with $\\varepsilon=\\varepsilon_0$. Note that the $\\xi_i$ are independent as the samples from each perturbed system are independent. \n\nTo determine the parameters $\\alpha_0$ and $\\alpha_1$ of the model (\\ref{e.linmod}) from time series we apply a weighted least squares fit to obtain\n\n", "itemtype": "equation", "pos": 19675, "prevtext": "\nfor $i = 1,\\dotsc,M$ and {\\em{iid}} noise $\\xi_i \\sim N(0,I)$. If the dynamical system indeed has linear response and provided the perturbations $\\delta \\varepsilon_i=\\varepsilon_i-\\varepsilon_0$ are sufficiently small, the following statistical model holds for $\\bar{A}_i$\n\n", "index": 27, "text": "\\begin{align}\n\\bar{A}_i  = \\alpha_0 + \\alpha_1 \\, \\delta\\varepsilon_i + \\frac{\\sigma_i}{\\sqrt{N}} \\xi_i \\, ,\n\\label{e.linmod}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E10.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\bar{A}_{i}=\\alpha_{0}+\\alpha_{1}\\,\\delta\\varepsilon_{i}+\\frac{%&#10;\\sigma_{i}}{\\sqrt{N}}\\xi_{i}\\,,\" display=\"inline\"><mrow><mrow><msub><mover accent=\"true\"><mi>A</mi><mo stretchy=\"false\">\u00af</mo></mover><mi>i</mi></msub><mo>=</mo><mrow><msub><mi>\u03b1</mi><mn>0</mn></msub><mo>+</mo><mrow><mpadded width=\"+1.7pt\"><msub><mi>\u03b1</mi><mn>1</mn></msub></mpadded><mo>\u2062</mo><mi>\u03b4</mi><mo>\u2062</mo><msub><mi>\u03b5</mi><mi>i</mi></msub></mrow><mo>+</mo><mrow><mstyle displaystyle=\"true\"><mfrac><msub><mi>\u03c3</mi><mi>i</mi></msub><msqrt><mi>N</mi></msqrt></mfrac></mstyle><mo>\u2062</mo><mpadded width=\"+1.7pt\"><msub><mi>\u03be</mi><mi>i</mi></msub></mpadded></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nwith the design matrix\n\n", "itemtype": "equation", "pos": 20237, "prevtext": "\nwith $\\alpha_0=\\langle A\\rangle_{\\varepsilon_0}$ and $\\alpha_1= \\langle A\\rangle_{\\varepsilon_0}^\\prime$ for some unperturbed reference state with $\\varepsilon=\\varepsilon_0$. Note that the $\\xi_i$ are independent as the samples from each perturbed system are independent. \n\nTo determine the parameters $\\alpha_0$ and $\\alpha_1$ of the model (\\ref{e.linmod}) from time series we apply a weighted least squares fit to obtain\n\n", "index": 29, "text": "\\begin{align*}\n  \\left(\\begin{array}{c}\n    \\hat \\alpha_0\\\\\n    \\hat \\alpha_1\n  \\end{array}\\right) = (D^T D)^{- 1} D^T Y\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\left(\\begin{array}[]{c}\\hat{\\alpha}_{0}\\\\&#10;\\hat{\\alpha}_{1}\\end{array}\\right)=(D^{T}D)^{-1}D^{T}Y\" display=\"inline\"><mrow><mrow><mo>(</mo><mtable rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><msub><mover accent=\"true\"><mi>\u03b1</mi><mo stretchy=\"false\">^</mo></mover><mn>0</mn></msub></mtd></mtr><mtr><mtd columnalign=\"center\"><msub><mover accent=\"true\"><mi>\u03b1</mi><mo stretchy=\"false\">^</mo></mover><mn>1</mn></msub></mtd></mtr></mtable><mo>)</mo></mrow><mo>=</mo><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mi>D</mi><mi>T</mi></msup><mo>\u2062</mo><mi>D</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><msup><mi>D</mi><mi>T</mi></msup><mo>\u2062</mo><mi>Y</mi></mrow></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nand the vector of scaled observations\n\n", "itemtype": "equation", "pos": 20394, "prevtext": "\nwith the design matrix\n\n", "index": 31, "text": "\\begin{align*}\n  D = \\left(\\begin{array}{cc}\n    1 / \\sigma_1 & \\delta \\varepsilon_1 / \\sigma_1\\\\\n    \\vdots & \\vdots\\\\\n    1 / \\sigma_M & \\delta \\varepsilon_M / \\sigma_M\n  \\end{array}\\right)\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex6.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle D=\\left(\\begin{array}[]{cc}1/\\sigma_{1}&amp;\\delta\\varepsilon_{1}/%&#10;\\sigma_{1}\\\\&#10;\\vdots&amp;\\vdots\\\\&#10;1/\\sigma_{M}&amp;\\delta\\varepsilon_{M}/\\sigma_{M}\\end{array}\\right)\" display=\"inline\"><mrow><mi>D</mi><mo>=</mo><mrow><mo>(</mo><mtable columnspacing=\"5pt\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><mn>1</mn><mo>/</mo><msub><mi>\u03c3</mi><mn>1</mn></msub></mrow></mtd><mtd columnalign=\"center\"><mrow><mrow><mi>\u03b4</mi><mo>\u2062</mo><msub><mi>\u03b5</mi><mn>1</mn></msub></mrow><mo>/</mo><msub><mi>\u03c3</mi><mn>1</mn></msub></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><mn>1</mn><mo>/</mo><msub><mi>\u03c3</mi><mi>M</mi></msub></mrow></mtd><mtd columnalign=\"center\"><mrow><mrow><mi>\u03b4</mi><mo>\u2062</mo><msub><mi>\u03b5</mi><mi>M</mi></msub></mrow><mo>/</mo><msub><mi>\u03c3</mi><mi>M</mi></msub></mrow></mtd></mtr></mtable><mo>)</mo></mrow></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nHigher-order responses can naturally be incorporated by adding a quadratic term $\\alpha_2\\,\\delta\\varepsilon_i^2$ to (\\ref{e.linmod}) and employing higher-order regression allowing, in principle, for a larger range of perturbations (in case linear response exists).\\\\\n\nTo test whether the observations could have been drawn from the linear model (\\ref{e.linmod}) with normally distributed errors $\\xi_i$ with mean zero and variance $1$, we choose a Pearson $\\chi^2$-test to test the goodness-of-fit test with  statistics\n\n", "itemtype": "equation", "pos": 20637, "prevtext": "\nand the vector of scaled observations\n\n", "index": 33, "text": "\\begin{align*}\n  Y = \\left(\\begin{array}{c}\n   \\bar{A}_1 / \\sigma_1\\\\\n    \\vdots\\\\\n   \\bar{A}_M / \\sigma_M\n  \\end{array}\\right)\\, .\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex7.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle Y=\\left(\\begin{array}[]{c}\\bar{A}_{1}/\\sigma_{1}\\\\&#10;\\vdots\\\\&#10;\\bar{A}_{M}/\\sigma_{M}\\end{array}\\right)\\,.\" display=\"inline\"><mrow><mrow><mi>Y</mi><mo>=</mo><mrow><mo>(</mo><mtable rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><msub><mover accent=\"true\"><mi>A</mi><mo stretchy=\"false\">\u00af</mo></mover><mn>1</mn></msub><mo>/</mo><msub><mi>\u03c3</mi><mn>1</mn></msub></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><msub><mover accent=\"true\"><mi>A</mi><mo stretchy=\"false\">\u00af</mo></mover><mi>M</mi></msub><mo>/</mo><msub><mi>\u03c3</mi><mi>M</mi></msub></mrow></mtd></mtr></mtable><mo rspace=\"4.2pt\">)</mo></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nwhere the idempotent hat matrix \n\n", "itemtype": "equation", "pos": 21303, "prevtext": "\nHigher-order responses can naturally be incorporated by adding a quadratic term $\\alpha_2\\,\\delta\\varepsilon_i^2$ to (\\ref{e.linmod}) and employing higher-order regression allowing, in principle, for a larger range of perturbations (in case linear response exists).\\\\\n\nTo test whether the observations could have been drawn from the linear model (\\ref{e.linmod}) with normally distributed errors $\\xi_i$ with mean zero and variance $1$, we choose a Pearson $\\chi^2$-test to test the goodness-of-fit test with  statistics\n\n", "index": 35, "text": "\\begin{align}\n\\chi^2 \n&= N\\, \\sum_{i=1}^M \\left(Y_i - \\frac{1}{\\sigma_i}\\left(\\hat \\alpha_0+\\hat \\alpha_1\\varepsilon_i\\right)\\right)^2 \n\\nonumber\n\\\\\n&= N\\, Y^T(I-H)Y,\n\\label{e.chisq}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex8.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\chi^{2}\" display=\"inline\"><msup><mi>\u03c7</mi><mn>2</mn></msup></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex8.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=N\\,\\sum_{i=1}^{M}\\left(Y_{i}-\\frac{1}{\\sigma_{i}}\\left(\\hat{%&#10;\\alpha}_{0}+\\hat{\\alpha}_{1}\\varepsilon_{i}\\right)\\right)^{2}\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mpadded width=\"+1.7pt\"><mi>N</mi></mpadded><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></munderover></mstyle><msup><mrow><mo>(</mo><mrow><msub><mi>Y</mi><mi>i</mi></msub><mo>-</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><msub><mi>\u03c3</mi><mi>i</mi></msub></mfrac></mstyle><mo>\u2062</mo><mrow><mo>(</mo><mrow><msub><mover accent=\"true\"><mi>\u03b1</mi><mo stretchy=\"false\">^</mo></mover><mn>0</mn></msub><mo>+</mo><mrow><msub><mover accent=\"true\"><mi>\u03b1</mi><mo stretchy=\"false\">^</mo></mover><mn>1</mn></msub><mo>\u2062</mo><msub><mi>\u03b5</mi><mi>i</mi></msub></mrow></mrow><mo>)</mo></mrow></mrow></mrow><mo>)</mo></mrow><mn>2</mn></msup></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E11.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=N\\,Y^{T}(I-H)Y,\" display=\"inline\"><mrow><mrow><mi/><mo>=</mo><mrow><mpadded width=\"+1.7pt\"><mi>N</mi></mpadded><mo>\u2062</mo><msup><mi>Y</mi><mi>T</mi></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>I</mi><mo>-</mo><mi>H</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>Y</mi></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": " \nmaps scaled observations $Y$ to their linear fits, i.e. $HY = D(\\hat \\alpha_0\\;\\;\\hat \\alpha_1)^T$ \\cite{BoxHunterHunter}.\\\\\nIf the response of the underlying dynamical system is linear, $\\chi^2$ has a $\\chi^2$-distribution with $M-2$ degrees of freedom and expectation value ${\\mathbb{E}} \\chi^2_{M-2} = M-2$. \n\nWe therefore introduce as a measure for the breakdown of linear response the difference between the $\\chi^2$ test statistic for the scaled observations $Y_i= \\bar{A}_i / \\sigma_i$ and the expectation of the test statistic under the null hypothesis of linear response\n\n", "itemtype": "equation", "pos": -1, "prevtext": "\nwhere the idempotent hat matrix \n\n", "index": 37, "text": "\\begin{align*}\nH = D (D^T D)^{-1} D^T\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex9.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle H=D(D^{T}D)^{-1}D^{T}\" display=\"inline\"><mrow><mi>H</mi><mo>=</mo><mrow><mi>D</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mi>D</mi><mi>T</mi></msup><mo>\u2062</mo><mi>D</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><msup><mi>D</mi><mi>T</mi></msup></mrow></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nDefining $W$ as the vector with components $W_i=\\langle A\\rangle_{\\varepsilon_i}/\\sigma_i$ we can use the central limit theorem (\\ref{e.clt}), which holds independent of the existence of linear response, to obtain the following expressions for the mean and variance of the breakdown parameter. The mean is calculated as\n\n", "itemtype": "equation", "pos": 22163, "prevtext": " \nmaps scaled observations $Y$ to their linear fits, i.e. $HY = D(\\hat \\alpha_0\\;\\;\\hat \\alpha_1)^T$ \\cite{BoxHunterHunter}.\\\\\nIf the response of the underlying dynamical system is linear, $\\chi^2$ has a $\\chi^2$-distribution with $M-2$ degrees of freedom and expectation value ${\\mathbb{E}} \\chi^2_{M-2} = M-2$. \n\nWe therefore introduce as a measure for the breakdown of linear response the difference between the $\\chi^2$ test statistic for the scaled observations $Y_i= \\bar{A}_i / \\sigma_i$ and the expectation of the test statistic under the null hypothesis of linear response\n\n", "index": 39, "text": "\\begin{align} \n{\\mathfrak{q}}= \\frac{1}{N}\\left( \\chi^2 -{\\mathbb{E}} \\chi^2_{M-2} \\right).\n\\label{e.Echi2_0}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E12.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle{\\mathfrak{q}}=\\frac{1}{N}\\left(\\chi^{2}-{\\mathbb{E}}\\chi^{2}_{M-%&#10;2}\\right).\" display=\"inline\"><mrow><mrow><mi>\ud835\udd2e</mi><mo>=</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><mi>N</mi></mfrac></mstyle><mo>\u2062</mo><mrow><mo>(</mo><mrow><msup><mi>\u03c7</mi><mn>2</mn></msup><mo>-</mo><mrow><mi>\ud835\udd3c</mi><mo>\u2062</mo><msubsup><mi>\u03c7</mi><mrow><mi>M</mi><mo>-</mo><mn>2</mn></mrow><mn>2</mn></msubsup></mrow></mrow><mo>)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nwhere we used that $H$ is idempotent. Hence ${\\mathfrak{q}}$ is a random variable whose expected value measures the difference between the actual response $\\langle A\\rangle_{\\varepsilon_i}$ and an assumed linear response $\\alpha_0+\\alpha_1\\varepsilon_i$ as calculated via least square regression. We have ${\\mathbb{E}} {\\mathfrak{q}}\\ge 0$ with equality only for $W = HW$, i.e. if the actual response is linear. The variance of the breakdown parameter ${\\mathfrak{q}}$ is calculated as\n\n", "itemtype": "equation", "pos": 22605, "prevtext": "\nDefining $W$ as the vector with components $W_i=\\langle A\\rangle_{\\varepsilon_i}/\\sigma_i$ we can use the central limit theorem (\\ref{e.clt}), which holds independent of the existence of linear response, to obtain the following expressions for the mean and variance of the breakdown parameter. The mean is calculated as\n\n", "index": 41, "text": "\\begin{align} \n{\\mathbb{E}} {\\mathfrak{q}}&= \\frac{1}{N}\\left({\\mathbb{E}}\\chi^2 -{\\mathbb{E}} \\chi^2_{M-2}\\right)\n\\nonumber\n\\\\ \n&=  {\\mathbb{E}}\\bigg((W + \\frac{1}{\\sqrt{N}}{\\xi})^T(I-H)(W + \\frac{1}{\\sqrt{N}}{\\xi}) - \\frac{1}{N}{\\mathbb{E}} \\chi^2_{M-2}\\bigg)\n\\nonumber\n\\\\\n&= \\|W-HW\\|^2,\n\\label{e.Echi2}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex10.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle{\\mathbb{E}}{\\mathfrak{q}}\" display=\"inline\"><mrow><mi>\ud835\udd3c</mi><mo>\u2062</mo><mi>\ud835\udd2e</mi></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex10.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\frac{1}{N}\\left({\\mathbb{E}}\\chi^{2}-{\\mathbb{E}}\\chi^{2}_{M-2}\\right)\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><mi>N</mi></mfrac></mstyle><mo>\u2062</mo><mrow><mo>(</mo><mrow><mrow><mi>\ud835\udd3c</mi><mo>\u2062</mo><msup><mi>\u03c7</mi><mn>2</mn></msup></mrow><mo>-</mo><mrow><mi>\ud835\udd3c</mi><mo>\u2062</mo><msubsup><mi>\u03c7</mi><mrow><mi>M</mi><mo>-</mo><mn>2</mn></mrow><mn>2</mn></msubsup></mrow></mrow><mo>)</mo></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex11.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle={\\mathbb{E}}\\bigg{(}(W+\\frac{1}{\\sqrt{N}}{\\xi})^{T}(I-H)(W+\\frac%&#10;{1}{\\sqrt{N}}{\\xi})-\\frac{1}{N}{\\mathbb{E}}\\chi^{2}_{M-2}\\bigg{)}\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mi>\ud835\udd3c</mi><mo>\u2062</mo><mrow><mo maxsize=\"210%\" minsize=\"210%\">(</mo><mrow><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>W</mi><mo>+</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><msqrt><mi>N</mi></msqrt></mfrac></mstyle><mo>\u2062</mo><mi>\u03be</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mi>T</mi></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>I</mi><mo>-</mo><mi>H</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>W</mi><mo>+</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><msqrt><mi>N</mi></msqrt></mfrac></mstyle><mo>\u2062</mo><mi>\u03be</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><mi>N</mi></mfrac></mstyle><mo>\u2062</mo><mi>\ud835\udd3c</mi><mo>\u2062</mo><msubsup><mi>\u03c7</mi><mrow><mi>M</mi><mo>-</mo><mn>2</mn></mrow><mn>2</mn></msubsup></mrow></mrow><mo maxsize=\"210%\" minsize=\"210%\">)</mo></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E13.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\|W-HW\\|^{2},\" display=\"inline\"><mrow><mrow><mi/><mo>=</mo><msup><mrow><mo>\u2225</mo><mrow><mi>W</mi><mo>-</mo><mrow><mi>H</mi><mo>\u2062</mo><mi>W</mi></mrow></mrow><mo>\u2225</mo></mrow><mn>2</mn></msup></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nThis shows that ${\\mathfrak{q}}$ is a consistent estimator for the mismatch ${\\mathbb{E}}{\\mathfrak{q}} = \\|W-HW\\|^2$ since ${\\mathbb{V}}{\\mathfrak{q}}\\to 0$ for $N\\to \\infty$. In the numerical experiments in Section~\\ref{sec-finite} we will consider Monte-Carlo estimates of the mismatch over realizations ${\\mathfrak{q}}_j$ differing in their initial condition and set\n\n", "itemtype": "equation", "pos": 23409, "prevtext": "\nwhere we used that $H$ is idempotent. Hence ${\\mathfrak{q}}$ is a random variable whose expected value measures the difference between the actual response $\\langle A\\rangle_{\\varepsilon_i}$ and an assumed linear response $\\alpha_0+\\alpha_1\\varepsilon_i$ as calculated via least square regression. We have ${\\mathbb{E}} {\\mathfrak{q}}\\ge 0$ with equality only for $W = HW$, i.e. if the actual response is linear. The variance of the breakdown parameter ${\\mathfrak{q}}$ is calculated as\n\n", "index": 43, "text": "\\begin{align*} \n\n\n{\\mathbb{V}} {\\mathfrak{q}} &= {\\mathbb{E}} \\bigg((W + \\frac{1}{\\sqrt{N}}{\\xi})^T(I-H)(W + \\frac{1}{\\sqrt{N}}{\\xi}) -\\frac{M-2}{N} - {\\mathbb{E}} {\\mathfrak{q}} \\bigg)^2\\\\\n&= \\frac{1}{N} {\\mathbb{E}}\\left( {\\xi}^T (I-H) (2W + \\frac{1}{\\sqrt{N}}{\\xi})  - \\frac{M-2}{\\sqrt{N}}  \\right)^2.\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex12.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\par&#10;\\par&#10;{\\mathbb{V}}{\\mathfrak{q}}\" display=\"inline\"><mrow><mi>\ud835\udd4d</mi><mo>\u2062</mo><mi>\ud835\udd2e</mi></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex12.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle={\\mathbb{E}}\\bigg{(}(W+\\frac{1}{\\sqrt{N}}{\\xi})^{T}(I-H)(W+\\frac%&#10;{1}{\\sqrt{N}}{\\xi})-\\frac{M-2}{N}-{\\mathbb{E}}{\\mathfrak{q}}\\bigg{)}^{2}\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mi>\ud835\udd3c</mi><mo>\u2062</mo><msup><mrow><mo maxsize=\"210%\" minsize=\"210%\">(</mo><mrow><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>W</mi><mo>+</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><msqrt><mi>N</mi></msqrt></mfrac></mstyle><mo>\u2062</mo><mi>\u03be</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mi>T</mi></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>I</mi><mo>-</mo><mi>H</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>W</mi><mo>+</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><msqrt><mi>N</mi></msqrt></mfrac></mstyle><mo>\u2062</mo><mi>\u03be</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mstyle displaystyle=\"true\"><mfrac><mrow><mi>M</mi><mo>-</mo><mn>2</mn></mrow><mi>N</mi></mfrac></mstyle><mo>-</mo><mrow><mi>\ud835\udd3c</mi><mo>\u2062</mo><mi>\ud835\udd2e</mi></mrow></mrow><mo maxsize=\"210%\" minsize=\"210%\">)</mo></mrow><mn>2</mn></msup></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex13.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\frac{1}{N}{\\mathbb{E}}\\left({\\xi}^{T}(I-H)(2W+\\frac{1}{\\sqrt{N}%&#10;}{\\xi})-\\frac{M-2}{\\sqrt{N}}\\right)^{2}.\" display=\"inline\"><mrow><mrow><mi/><mo>=</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><mi>N</mi></mfrac></mstyle><mo>\u2062</mo><mi>\ud835\udd3c</mi><mo>\u2062</mo><msup><mrow><mo>(</mo><mrow><mrow><msup><mi>\u03be</mi><mi>T</mi></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>I</mi><mo>-</mo><mi>H</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>W</mi></mrow><mo>+</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><msqrt><mi>N</mi></msqrt></mfrac></mstyle><mo>\u2062</mo><mi>\u03be</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mstyle displaystyle=\"true\"><mfrac><mrow><mi>M</mi><mo>-</mo><mn>2</mn></mrow><msqrt><mi>N</mi></msqrt></mfrac></mstyle></mrow><mo>)</mo></mrow><mn>2</mn></msup></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\n\nNow, consider a dynamical system which does not obey linear response, i.e. ${\\mathbb{E}}{\\mathfrak{q}}\\neq 0$. Using Chebyshev's inequality we have that for all $b < N{\\mathbb{E}}{\\mathfrak{q}}$,\n\n", "itemtype": "equation", "pos": 24098, "prevtext": "\nThis shows that ${\\mathfrak{q}}$ is a consistent estimator for the mismatch ${\\mathbb{E}}{\\mathfrak{q}} = \\|W-HW\\|^2$ since ${\\mathbb{V}}{\\mathfrak{q}}\\to 0$ for $N\\to \\infty$. In the numerical experiments in Section~\\ref{sec-finite} we will consider Monte-Carlo estimates of the mismatch over realizations ${\\mathfrak{q}}_j$ differing in their initial condition and set\n\n", "index": 45, "text": "\\begin{align}\n\\hat{\\mathfrak{q}}=\\frac{1}{K} \\sum_{j=1}^K{\\mathfrak{q}}_j\\, .\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\hat{\\mathfrak{q}}=\\frac{1}{K}\\sum_{j=1}^{K}{\\mathfrak{q}}_{j}\\,.\" display=\"inline\"><mrow><mrow><mover accent=\"true\"><mi>\ud835\udd2e</mi><mo stretchy=\"false\">^</mo></mover><mo>=</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><mi>K</mi></mfrac></mstyle><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover></mstyle><mpadded width=\"+1.7pt\"><msub><mi>\ud835\udd2e</mi><mi>j</mi></msub></mpadded></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nSince, as we have shown above, ${\\mathbb{V}} {\\mathfrak{q}}\\to 0$ as $N\\to\\infty$ we conclude that $N {\\mathfrak{q}} \\to \\infty$ in probability as $N\\to\\infty$. Hence, if $F$ is the cumulative distribution function of the $\\chi^2_{M-2}$ distribution, the $p$-value obtained using the $\\chi^2$- test\n\n", "itemtype": "equation", "pos": 24385, "prevtext": "\n\nNow, consider a dynamical system which does not obey linear response, i.e. ${\\mathbb{E}}{\\mathfrak{q}}\\neq 0$. Using Chebyshev's inequality we have that for all $b < N{\\mathbb{E}}{\\mathfrak{q}}$,\n\n", "index": 47, "text": "\\begin{align*}\nP(N{\\mathfrak{q}} < b) &\\leq P(|{\\mathfrak{q}}-{\\mathbb{E}}{\\mathfrak{q}}| > {\\mathbb{E}}{\\mathfrak{q}} - b/N)\\\\\n&\\leq \\frac{{\\mathbb{V}}({\\mathfrak{q}})}{({\\mathbb{E}}{\\mathfrak{q}} - b/N)^2}\\; .\n\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex14.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle P(N{\\mathfrak{q}}&lt;b)\" display=\"inline\"><mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mi>N</mi><mi>\ud835\udd2e</mi><mo>&lt;</mo><mi>b</mi><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex14.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\leq P(|{\\mathfrak{q}}-{\\mathbb{E}}{\\mathfrak{q}}|&gt;{\\mathbb{E}}{%&#10;\\mathfrak{q}}-b/N)\" display=\"inline\"><mrow><mo>\u2264</mo><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">|</mo><mi>\ud835\udd2e</mi><mo>-</mo><mi>\ud835\udd3c</mi><mi>\ud835\udd2e</mi><mo stretchy=\"false\">|</mo><mo>&gt;</mo><mi>\ud835\udd3c</mi><mi>\ud835\udd2e</mi><mo>-</mo><mi>b</mi><mo>/</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex15.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\leq\\frac{{\\mathbb{V}}({\\mathfrak{q}})}{({\\mathbb{E}}{\\mathfrak{q%&#10;}}-b/N)^{2}}\\;.\\par&#10;\" display=\"inline\"><mrow><mrow><mi/><mo>\u2264</mo><mpadded width=\"+2.8pt\"><mstyle displaystyle=\"true\"><mfrac><mrow><mi>\ud835\udd4d</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udd2e</mi><mo stretchy=\"false\">)</mo></mrow></mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mi>\ud835\udd3c</mi><mo>\u2062</mo><mi>\ud835\udd2e</mi></mrow><mo>-</mo><mrow><mi>b</mi><mo>/</mo><mi>N</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></mfrac></mstyle></mpadded></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nconverges quickly in probability to zero as $N\\to\\infty$ \\cite{BoxHunterHunter}. In practical terms this means that the probability of falsely accepting the null hypothesis of linear response at any significance level can be made arbitrarily small if $N$ is large enough.\n\n\n\n\n\n\n\nFor a specified significance level $\\alpha$ we can now define\n\n", "itemtype": "equation", "pos": 24910, "prevtext": "\nSince, as we have shown above, ${\\mathbb{V}} {\\mathfrak{q}}\\to 0$ as $N\\to\\infty$ we conclude that $N {\\mathfrak{q}} \\to \\infty$ in probability as $N\\to\\infty$. Hence, if $F$ is the cumulative distribution function of the $\\chi^2_{M-2}$ distribution, the $p$-value obtained using the $\\chi^2$- test\n\n", "index": 49, "text": "\\begin{align}\np  = 1 - F(\\chi^2) = 1- F(M-2 +N{\\mathfrak{q}})\n\\label{e.p}\n\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E15.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle p=1-F(\\chi^{2})=1-F(M-2+N{\\mathfrak{q}})\\par&#10;\" display=\"inline\"><mrow><mi>p</mi><mo>=</mo><mrow><mn>1</mn><mo>-</mo><mrow><mi>F</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\u03c7</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>=</mo><mrow><mn>1</mn><mo>-</mo><mrow><mi>F</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mi>M</mi><mo>-</mo><mn>2</mn></mrow><mo>+</mo><mrow><mi>N</mi><mo>\u2062</mo><mi>\ud835\udd2e</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nThis defines a threshold value for the observed random variable $\\hat{\\mathfrak{q}}$ such that if $\\hat {\\mathfrak{q}} >{\\mathfrak{q}}_\\alpha$ the null hypothesis of linear response is rejected with significance level $\\alpha$ (i.e. with probability $1-\\alpha$); conversely, if $\\hat {\\mathfrak{q}} <{\\mathfrak{q}}_\\alpha$ the null hypothesis of linear response is accepted with significance level $\\alpha$ (i.e. with probability $1-\\alpha$).\n\nThe detectability of breakdown of linear response is linked to the amount of available data. As $N\\to \\infty$, a breakdown will always become detectable at any specified significance level $\\alpha$. Conversely, if the mismatch ${\\mathbb{E}}{\\mathfrak{q}}$ between the true response of the dynamical system and the linear response is too small and there is an insufficient amount of data available, the actual response will be swamped by the sampling noise, and one will not be able to detect the breakdown of linear response with a reasonable significance level.\n\nIn Section~\\ref{sec-finite} we will use our goodness-of-fit test to study the detectability of breakdown of linear response in time series of finite length.\n\n\n\n\n\n\n\n\\section{Breakdown of linear response theory}\n\\label{sec-break}\nA standard dynamical system for which linear response fails \\cite{Baladi14} is the logistic map $f:[0,1]\\to[0,1]$ given by\n\n", "itemtype": "equation", "pos": 25338, "prevtext": "\nconverges quickly in probability to zero as $N\\to\\infty$ \\cite{BoxHunterHunter}. In practical terms this means that the probability of falsely accepting the null hypothesis of linear response at any significance level can be made arbitrarily small if $N$ is large enough.\n\n\n\n\n\n\n\nFor a specified significance level $\\alpha$ we can now define\n\n", "index": 51, "text": "\\begin{align}\n\\label{e.qalpha}\n{\\mathfrak{q}}_\\alpha = \\frac{1}{N} \\left(F^{-1}(1-\\alpha)-(M-2)\\right)\\, .\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E16.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle{\\mathfrak{q}}_{\\alpha}=\\frac{1}{N}\\left(F^{-1}(1-\\alpha)-(M-2)%&#10;\\right)\\,.\" display=\"inline\"><mrow><mrow><msub><mi>\ud835\udd2e</mi><mi>\u03b1</mi></msub><mo>=</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><mi>N</mi></mfrac></mstyle><mo>\u2062</mo><mrow><mo>(</mo><mrow><mrow><msup><mi>F</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>-</mo><mi>\u03b1</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>M</mi><mo>-</mo><mn>2</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo rspace=\"4.2pt\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nfor $a\\in[0,4]$. This family of maps is particularly well-understood~\\cite{Lyubich02,AvilaMoreira05}: we can decompose the parameter interval according to $[0,4]=\\mathcal{P}\\cup\\mathcal{C}\\cup\\mathcal{N}$ where $\\mathcal{N}$ has Lebesgue measure zero and the asymptotic dynamics consists of a periodic attractor for $a$ in the open and dense set $\\mathcal{P}$ and a strongly chaotic attractor for $a$ in the set $\\mathcal{C}$ of positive measure. For $a\\in \\mathcal{C}$ the logistic map admits a unique absolutely continuous invariant measure (a.c.i.m.) \\cite{Jakobson81,Benedicks85} and moreover satisfies the Collet-Eckmann condition~\\cite{ColletEckmann83}, i.e. there exists $d>0$, $\\lambda>1$ such that \n", "itemtype": "equation", "pos": 26816, "prevtext": "\nThis defines a threshold value for the observed random variable $\\hat{\\mathfrak{q}}$ such that if $\\hat {\\mathfrak{q}} >{\\mathfrak{q}}_\\alpha$ the null hypothesis of linear response is rejected with significance level $\\alpha$ (i.e. with probability $1-\\alpha$); conversely, if $\\hat {\\mathfrak{q}} <{\\mathfrak{q}}_\\alpha$ the null hypothesis of linear response is accepted with significance level $\\alpha$ (i.e. with probability $1-\\alpha$).\n\nThe detectability of breakdown of linear response is linked to the amount of available data. As $N\\to \\infty$, a breakdown will always become detectable at any specified significance level $\\alpha$. Conversely, if the mismatch ${\\mathbb{E}}{\\mathfrak{q}}$ between the true response of the dynamical system and the linear response is too small and there is an insufficient amount of data available, the actual response will be swamped by the sampling noise, and one will not be able to detect the breakdown of linear response with a reasonable significance level.\n\nIn Section~\\ref{sec-finite} we will use our goodness-of-fit test to study the detectability of breakdown of linear response in time series of finite length.\n\n\n\n\n\n\n\n\\section{Breakdown of linear response theory}\n\\label{sec-break}\nA standard dynamical system for which linear response fails \\cite{Baladi14} is the logistic map $f:[0,1]\\to[0,1]$ given by\n\n", "index": 53, "text": "\\begin{align}\nf(x)=ax(1-x)\\,\n\\label{e.log}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E17.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle f(x)=ax(1-x)\" display=\"inline\"><mrow><mrow><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mi>a</mi><mo>\u2062</mo><mi>x</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>-</mo><mi>x</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nThen the Lyapunov exponent is positive, the attractor $\\Lambda$ consists of finitely many intervals $\\Lambda_1,\\dots,\\Lambda_q$ permuted cyclically by $f$, and $f^q|\\Lambda_i$ has exponential decay of correlations for H\\\"older observables for each $i=1,\\dots,q$~\\cite{KellerNowicki92,Young02}.\\\\\n\n\n\nThe logistic map is not uniformly expanding and has a critical point at $x=c=1/2$ with $f'(c) = 0$. The critical point gives rise to a complicated and rough absolutely continuous invariant measure, because $f$ and its iterates $f^n$ compress the phase space around $x=1/2$ non-uniformly (see Figure~\\ref{fig.l-copm}). We summarize here the analysis given in \\cite{Ruelle09b}. Near the critical point $c$ we approximate $y=f(x) \\approx c_1+\\tfrac12 f^{\\prime\\prime}(c)(x-c)^2$  with $c_n=f^n c$ and hence $x-c=\\pm \\sqrt{2(c_1-y)/f^{\\prime\\prime}(c)}+O(b-y)$. This implies that an initial smooth density $\\rho_0(x)$ including the critical point $x=c$ in its support will evolve under the dynamics into a spike with a square-root singularity at $x=c_1$. Propagating the density for a further time step this spike will transport this peak to $x=c_2$ and create a second, new spike at $x=c_1$, and so forth. The expanding action of the logistic map away from the critical point leads to a broadening of the spikes, and thereby consecutive spikes will have smaller amplitudes preserving the normalization of the initial density $\\rho_0(x)$. This is illustrated in Figure~\\ref{fig.logprop} and can be formalized to find an explicit formula for the unique a.c.i.m. in terms of its density \n\n", "itemtype": "equation", "pos": 27578, "prevtext": "\nfor $a\\in[0,4]$. This family of maps is particularly well-understood~\\cite{Lyubich02,AvilaMoreira05}: we can decompose the parameter interval according to $[0,4]=\\mathcal{P}\\cup\\mathcal{C}\\cup\\mathcal{N}$ where $\\mathcal{N}$ has Lebesgue measure zero and the asymptotic dynamics consists of a periodic attractor for $a$ in the open and dense set $\\mathcal{P}$ and a strongly chaotic attractor for $a$ in the set $\\mathcal{C}$ of positive measure. For $a\\in \\mathcal{C}$ the logistic map admits a unique absolutely continuous invariant measure (a.c.i.m.) \\cite{Jakobson81,Benedicks85} and moreover satisfies the Collet-Eckmann condition~\\cite{ColletEckmann83}, i.e. there exists $d>0$, $\\lambda>1$ such that \n", "index": 55, "text": "\n\\[\n|Df^n(f({\\textstyle\\frac12}))| \\ge d\\lambda^n\\enspace\\text{for all $n\\ge1$}.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex16.m1\" class=\"ltx_Math\" alttext=\"|Df^{n}(f({\\textstyle\\frac{1}{2}}))|\\geq d\\lambda^{n}\\@math@espace\\text{for %&#10;all $n\\geq 1$}.\" display=\"block\"><mrow><mrow><mrow><mo stretchy=\"false\">|</mo><mrow><mi>D</mi><mo>\u2062</mo><msup><mi>f</mi><mi>n</mi></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mstyle displaystyle=\"false\"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">|</mo></mrow><mo>\u2265</mo><mrow><mi>d</mi><mo>\u2062</mo><msup><mi>\u03bb</mi><mi>n</mi></msup><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\@math@espace</mtext></merror><mo>\u2062</mo><mrow><mtext>for all\u00a0</mtext><mrow><mi>n</mi><mo>\u2265</mo><mn>1</mn></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nHere $\\phi(x)$ represents a continuous background density with $\\phi(c_1)=\\phi(c_2)=0$. The countably infinite family of spikes  $\\eta_n$ are found to be\n\n", "itemtype": "equation", "pos": 29243, "prevtext": "\nThen the Lyapunov exponent is positive, the attractor $\\Lambda$ consists of finitely many intervals $\\Lambda_1,\\dots,\\Lambda_q$ permuted cyclically by $f$, and $f^q|\\Lambda_i$ has exponential decay of correlations for H\\\"older observables for each $i=1,\\dots,q$~\\cite{KellerNowicki92,Young02}.\\\\\n\n\n\nThe logistic map is not uniformly expanding and has a critical point at $x=c=1/2$ with $f'(c) = 0$. The critical point gives rise to a complicated and rough absolutely continuous invariant measure, because $f$ and its iterates $f^n$ compress the phase space around $x=1/2$ non-uniformly (see Figure~\\ref{fig.l-copm}). We summarize here the analysis given in \\cite{Ruelle09b}. Near the critical point $c$ we approximate $y=f(x) \\approx c_1+\\tfrac12 f^{\\prime\\prime}(c)(x-c)^2$  with $c_n=f^n c$ and hence $x-c=\\pm \\sqrt{2(c_1-y)/f^{\\prime\\prime}(c)}+O(b-y)$. This implies that an initial smooth density $\\rho_0(x)$ including the critical point $x=c$ in its support will evolve under the dynamics into a spike with a square-root singularity at $x=c_1$. Propagating the density for a further time step this spike will transport this peak to $x=c_2$ and create a second, new spike at $x=c_1$, and so forth. The expanding action of the logistic map away from the critical point leads to a broadening of the spikes, and thereby consecutive spikes will have smaller amplitudes preserving the normalization of the initial density $\\rho_0(x)$. This is illustrated in Figure~\\ref{fig.logprop} and can be formalized to find an explicit formula for the unique a.c.i.m. in terms of its density \n\n", "index": 57, "text": "\\begin{align}\n\\rho(x) = \\phi(x) + \\sum_{n=1}^{\\infty} \\eta_n(x). \n\\label{e.loga.c.i.m.}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E18.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\rho(x)=\\phi(x)+\\sum_{n=1}^{\\infty}\\eta_{n}(x).\" display=\"inline\"><mrow><mrow><mrow><mi>\u03c1</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>\u03d5</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi mathvariant=\"normal\">\u221e</mi></munderover></mstyle><mrow><msub><mi>\u03b7</mi><mi>n</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nwith magnitude \n\n", "itemtype": "equation", "pos": 29497, "prevtext": "\nHere $\\phi(x)$ represents a continuous background density with $\\phi(c_1)=\\phi(c_2)=0$. The countably infinite family of spikes  $\\eta_n$ are found to be\n\n", "index": 59, "text": "\\begin{align}\n\\eta_n(x) \\sim \\Upsilon_n \\frac{1}{\\sqrt{x-f^n c}},\n\\label{e.spike}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E19.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\eta_{n}(x)\\sim\\Upsilon_{n}\\frac{1}{\\sqrt{x-f^{n}c}},\" display=\"inline\"><mrow><mrow><mrow><msub><mi>\u03b7</mi><mi>n</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u223c</mo><mrow><msub><mi mathvariant=\"normal\">\u03a5</mi><mi>n</mi></msub><mo>\u2062</mo><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><msqrt><mrow><mi>x</mi><mo>-</mo><mrow><msup><mi>f</mi><mi>n</mi></msup><mo>\u2062</mo><mi>c</mi></mrow></mrow></msqrt></mfrac></mstyle></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nFor large $n$ the product in \\eqref{e.spikem} is asymptotically $\\alpha^n$, where $1<\\alpha<2$ denotes the Lyapunov multiplier, hence the magnitude $\\Upsilon_n$ of the spikes decays as $\\alpha^{-n/2}$. This implies that the widths of the spikes (defined as the distance from the singularity at $x=f^nc$ where the amplitudes drops to some chosen threshold) scale like $\\alpha^{-n}$.\n\nWe will now study the effect of parameter perturbations $a=a_0(1+\\varepsilon)$ onto the logistic map (\\ref{e.log}) and its a.c.i.m. $\\rho(x)dx$.  We may ask how fast the spikes move upon increasing ${\\varepsilon}$. Expanding the displacement length $\\ell_{\\varepsilon} = \\left| f_\\varepsilon^{n+1}(c) - f_0^{n+1}(c) \\right|$ around ${\\varepsilon}=0$ yields that the speed $v_n = \\ell_{\\varepsilon} / {\\varepsilon}$ is proportional to $\\partial_\\varepsilon f_\\varepsilon^{n+1}(c)= \\prod_{i=1}^nf^\\prime(c_i) + O(\\varepsilon)$ and hence is proportional  to $\\alpha^n$ for large $n$. Hence the smaller spikes move faster than the larger spikes corresponding to small values of $n$. This is illustrated in Figure~\\ref{fig.lcpet} where we overlay the invariant densities corresponding to a small perturbation with $\\varepsilon= 6.05\\times 10^{-4}$. The family of perturbed invariant measures can then be formally written in terms of their associated densities as\n\n", "itemtype": "equation", "pos": 29607, "prevtext": "\nwith magnitude \n\n", "index": 61, "text": "\\begin{align}\n \\Upsilon_n =  \\rho(c)\\left|\\frac{1}{2} f^{\\prime\\prime}(c)\\prod_{i=1}^n f^\\prime(c_i)\\right|^{-\\frac{1}{2}}.\n\\label{e.spikem}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E20.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\Upsilon_{n}=\\rho(c)\\left|\\frac{1}{2}f^{\\prime\\prime}(c)\\prod_{i=%&#10;1}^{n}f^{\\prime}(c_{i})\\right|^{-\\frac{1}{2}}.\" display=\"inline\"><mrow><mrow><msub><mi mathvariant=\"normal\">\u03a5</mi><mi>n</mi></msub><mo>=</mo><mrow><mi>\u03c1</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>c</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msup><mrow><mo>|</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle><mo>\u2062</mo><msup><mi>f</mi><mi>\u2032\u2032</mi></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>c</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u220f</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover></mstyle><mrow><msup><mi>f</mi><mo>\u2032</mo></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>|</mo></mrow><mrow><mo>-</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></msup></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nwhere the spikes are given as in (\\ref{e.spike})-(\\ref{e.spikem}) with $f$ replaced by $f_{\\varepsilon}$, and the magnitude of the perturbed spikes also decay as $\\Upsilon_n^{({\\varepsilon})}\\sim\\alpha^{-n/2}$. Differentiation of $\\rho_{\\varepsilon}(x)$ with respect to ${\\varepsilon}$ produces an exponentially growing term $\\alpha^{n/2}$ inside the sum which prevents the differentiability of the a.c.i.m., and hence causes the breakdown of linear response. A different way to see the non-differentiability of the invariant measure is to consider the linear response of an indicator function with support $[0,c_n]$. Without loss of generality we assume that the spike has support to the right of $c_n$ and moves to the left upon perturbation (if this is not the case, take ${\\varepsilon} \\rightarrow -{\\varepsilon}$ to change the direction). Upon applying a perturbation  $\\varepsilon$ the spike will enter the support of the observable and the probability mass moving into the interval is proportional to \n\n", "itemtype": "equation", "pos": 31101, "prevtext": "\nFor large $n$ the product in \\eqref{e.spikem} is asymptotically $\\alpha^n$, where $1<\\alpha<2$ denotes the Lyapunov multiplier, hence the magnitude $\\Upsilon_n$ of the spikes decays as $\\alpha^{-n/2}$. This implies that the widths of the spikes (defined as the distance from the singularity at $x=f^nc$ where the amplitudes drops to some chosen threshold) scale like $\\alpha^{-n}$.\n\nWe will now study the effect of parameter perturbations $a=a_0(1+\\varepsilon)$ onto the logistic map (\\ref{e.log}) and its a.c.i.m. $\\rho(x)dx$.  We may ask how fast the spikes move upon increasing ${\\varepsilon}$. Expanding the displacement length $\\ell_{\\varepsilon} = \\left| f_\\varepsilon^{n+1}(c) - f_0^{n+1}(c) \\right|$ around ${\\varepsilon}=0$ yields that the speed $v_n = \\ell_{\\varepsilon} / {\\varepsilon}$ is proportional to $\\partial_\\varepsilon f_\\varepsilon^{n+1}(c)= \\prod_{i=1}^nf^\\prime(c_i) + O(\\varepsilon)$ and hence is proportional  to $\\alpha^n$ for large $n$. Hence the smaller spikes move faster than the larger spikes corresponding to small values of $n$. This is illustrated in Figure~\\ref{fig.lcpet} where we overlay the invariant densities corresponding to a small perturbation with $\\varepsilon= 6.05\\times 10^{-4}$. The family of perturbed invariant measures can then be formally written in terms of their associated densities as\n\n", "index": 63, "text": "\\begin{align*}\n\\rho_{{\\varepsilon}}(x) = \\phi_{\\varepsilon}(x) + \\sum_{n=1}^{\\infty} \\eta^{({\\varepsilon})}_n(x + \\varepsilon \\alpha^n), \n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex17.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\rho_{{\\varepsilon}}(x)=\\phi_{\\varepsilon}(x)+\\sum_{n=1}^{\\infty}%&#10;\\eta^{({\\varepsilon})}_{n}(x+\\varepsilon\\alpha^{n}),\" display=\"inline\"><mrow><mrow><mrow><msub><mi>\u03c1</mi><mi>\u03b5</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msub><mi>\u03d5</mi><mi>\u03b5</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi mathvariant=\"normal\">\u221e</mi></munderover></mstyle><mrow><msubsup><mi>\u03b7</mi><mi>n</mi><mrow><mo stretchy=\"false\">(</mo><mi>\u03b5</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>x</mi><mo>+</mo><mrow><mi>\u03b5</mi><mo>\u2062</mo><msup><mi>\u03b1</mi><mi>n</mi></msup></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nand therefore $\\delta\\rho_{\\rm{spike}}/{\\varepsilon}\\sim1/\\sqrt{{\\varepsilon}}$. Since spikes are dense on the support of the a.c.i.m., the non-smoothness extends to the whole a.c.i.m. The non-differentiability of the a.c.i.m. is clearly seen in Figure~\\ref{fig.logresp} where we show the observable $\\langle A\\rangle_{\\varepsilon}$ as a function of ${\\varepsilon}$. The results shown are obtained here employing spectral methods \\cite{Boyd01,Trefethen13} rather than using a long but finite time series. This has the advantage of high accuracy, although these methods are not practically feasible when analyzing high-dimensional complex systems or when information on the system is only provided through finite observations.\n\n\n\\begin{figure}[htbp]\n\\centering\n\n\\includegraphics[width=0.7\\linewidth]{figures/figure02.eps}\n\\caption{\\footnotesize{The a.c.i.m. of the logistic map (\\ref{e.log}) with $a = 3.8$ (black lines), and a cobweb diagram (online orange) relating the spikes of the a.c.i.m. to the first $17$ iterates of the forward orbit of the critical point.}}\n\\label{fig.l-copm}\n\\end{figure}\n\n\n\n\\begin{figure}[htbp]\n\\centering\n\n\\includegraphics[width=0.9\\linewidth]{figures/figure03.eps}\n\\caption{\\footnotesize{The repeated action of the logistic map (\\ref{e.log}) with $a = 3.8$ on a continuous density (blue), with a.c.i.m. (light blue). The  dashed lines (online orange) show the image of the critical point after $n$ iterations of the logistic map. The continuous lines (online green) show the image of a few points within the support of the initial density at $n=0$ upon subsequent iteration of the map.}}\n\\label{fig.logprop}\n\\end{figure}\n\n\n\n\\begin{figure}[htbp]\n\\centering\n\n\\includegraphics[width=0.7\\linewidth]{figures/figure04.eps}\n\\caption{\\footnotesize{Overlaying two a.c.i.m.s of the logistic map with $a=3.8$ (maroon) and $a=3.8+6.05\\times 10^{-4}$ (light blue). The displacement of a smaller spike with $n=17$ is illustrated by the two ovals, and that of a large spike with $n=3$ with a dashed box.}}\n\\label{fig.lcpet}\n\\end{figure}\n\n\n\n\\begin{figure}[htbp]\n\\centering\n\n\\includegraphics[width=0.7\\linewidth]{figures/figure05.eps}\n\\caption{\\footnotesize{Observable $\\langle A\\rangle_{\\varepsilon}$ as a function of the perturbation ${\\varepsilon}$ for the logistic map (\\ref{e.log}) with $a=3.8(1+\\varepsilon)$ and observable $A(x) = x$. Gaps in the curve correspond to periodic windows.}}\n\\label{fig.logresp}\n\\end{figure}\n\n\n\n\n\\section{Resolving breakdown of linear response in finite time series}\n\\label{sec-finite}\nThe rigorous theory by Baladi and co-workers \\cite{BaladiSmania08,BaladiSmania10,Baladi14,BaladiEtAl15} shows that certain dynamical systems such as the logistic map do not obey a linear response. In this section we will investigate how the finitude of data may prevent the breakdown to be detectable and one may falsely be lead to believe that linear response was valid.  \n\nAs seen in Section~\\ref{sec-break} the non-smoothness of the invariant measure is caused by the rapid displacement of spikes upon perturbation. The smaller and narrower the spike, the faster it moves. This points to an issue of resolution: the faster spikes carry less mass and therefore require a certain amount of data to be reliably resolved; the slower spikes carry more mass but their smaller displacement upon perturbation requires sufficient data to be resolved. This means that a sufficiently large amount of data is needed for the breakdown parameter $\\mathfrak{q}$ to accurately estimate the mismatch ${\\mathbb{E}}{\\mathfrak{q}}$, and to determine whether a system obeys linear response or not. This issue of resolving the mismatch ${\\mathbb{E}}{\\mathfrak{q}}$ is an additional finite size issue to the one discussed in Section~\\ref{sec-eq} whereby $N$ needs to be sufficiently large to assure that the observed $p$-value is properly estimated (cf. (\\ref{e.p})).\n\n\n\nThroughout the paper we simulate the logistic map (\\ref{e.log}) with $a=a_0(1+{\\varepsilon})$ and $a_0= 3.8$. In the notation of Section~\\ref{sec-lrt} we set $\\varepsilon_0=0$ from now on. We chose $M=20$ equidistant values ${\\varepsilon}_i = \\frac{2i-M+1}{2}d{\\varepsilon}$ with $i=0,\\ldots,M-1$ for some $d{\\varepsilon}>0$ to determine the breakdown parameter ${\\mathfrak{q}}$. Note that the breakdown parameter cannot be determined at an exact perturbation size ${\\varepsilon}$ but we determine the validity of a linear approximation over a range of perturbation sizes parametrized by $d{\\varepsilon}$ (for fixed $M=20$). We restrict the set of perturbations ${\\varepsilon}_i$ to include only those which belong to the chaotic Cantor set. \n\nThe variances $\\sigma_i^2$ (\\ref{e.covar}) are estimated as a Monte-Carlo estimate from the observed response via (\\ref{e.clt}) using the central limit theorem with $200$ realizations for each $i=1,\\cdots,M$.  \n\n\n\n\n\n\\subsection{Effect of finite data length $N$}\n\nFigure~\\ref{fig.qN} shows how the breakdown parameter $\\mathfrak{q}$ behaves with increasing data length $N$ for given perturbation size $d{\\varepsilon}=10^{-6}$. For each value of $N$ the breakdown parameter is calculated for the above mentioned range of $M=20$ perturbation sizes ${\\varepsilon}_i$. Shown is the Monte-Carlo estimate $\\hat{\\mathfrak{q}}$ of the expectation value of the breakdown parameter ${\\mathbb{E}}\\mathfrak{q}$ over $K=200$ realizations, differing in the initial condition of the logistic map as well as the threshold value ${\\mathfrak{q}}_\\alpha$ corresponding to a significance level $\\alpha=0.05$. We show error bars obtained from the ensemble statistics indicating the two-sided $90\\%$ prediction interval for ${\\mathfrak{q}}$.  \nWe see clearly the saturation of the breakdown parameter with increasing data length $N$ towards the deterministic limit ${\\mathbb{E}}{\\mathfrak{q}}$ which eventually leads to detection of the breakdown above a significance level of $p=0.05$. \n\nThe breakdown can, however, only be detected reliably with a statistical significance level larger than $0.05$ for long time series with $N>600,000$. The corollary of this is that when analyzing single time series of length $N<600,000$ at several values of the perturbation size ${\\varepsilon}$ the error bars lie below ${\\mathfrak{q}}_\\alpha$ and the dynamics may be falsely classified as obeying linear response.\\\\ For comparison we have included in Figure~\\ref{fig.qN} a plot showing the breakdown parameter as a function of $N$ for the doubling map which does obey linear response with ${\\mathbb{E}}{\\mathfrak{q}} \\to 0$ for ${\\varepsilon}\\to 0$. Here the observed breakdown parameter $\\hat{\\mathfrak{q}}$ decreases with $N$ according to the law of large numbers and the sample statistics is consistent with the two-sided $90\\%$ prediction interval for the whole range of $N$. Since the expectation of the breakdown parameter ${\\mathbb{E}}{\\mathfrak{q}}$ approaches zero for vanishing perturbation size, the estimator of ${\\mathbb{E}}{\\mathfrak{q}}$ is discontinuous as a function of $N$ due to sampling errors.\n\nA concrete example of how statistical noise may impede the detection of linear response breakdown from observations is shown in Figure~\\ref{fig.Aeps} for an observable $A(x)=x$. Shown is the observed sample average $\\bar{A}$~\\eqref{e.Aavgs} as a function of the perturbation size. The error bars are calculated from the standard deviation as calculated for the single available time series, which is the situation for scientists analyzing observations. For insufficient data length $N=10^5$ a linear response is consistent within the available statistical significance levels (top of  Figure~\\ref{fig.Aeps}). Only for significantly larger time series with data length $N=10^6$, does the breakdown become detectable in a statistically significant way (bottom of  Figure~\\ref{fig.Aeps}).\n\n\n\\begin{figure}[htbp]\n\\centering\n\\includegraphics[width=0.7\\linewidth]{figures/figureB2.eps}\\\\\n\\includegraphics[width=0.7\\linewidth]{figures/figureC8.eps}\n\\caption{\\footnotesize{Breakdown parameter $\\hat{{\\mathfrak{q}}}$ (solid line) as a function of the data size $N$, estimated using $d{\\varepsilon} = 10^{-6}$. Top: logistic map (\\ref{e.log}) with fixed range of perturbations $a=3.8(1+\\varepsilon)$ and observable $A(x) = x$. Bottom: doubling map with perturbation $X(x) = \\varepsilon\\, \\sin 2\\pi x$ and observable $A(x) = \\cos 2\\pi x$.\\\\ The error bars show the two-sided $90\\%$ prediction interval for ${\\mathfrak{q}}$ as estimated from $K=200$ realizations differing in the initial conditions. The dashed line shows ${\\mathfrak{q}}_\\alpha$ for $\\alpha=0.05$.}}\n\\label{fig.qN}\n\\end{figure}\n\n\n\n\\begin{figure}[htbp]\n\\centering\n\\includegraphics[width=0.7\\linewidth]{figures/figureB4.eps}\\\\\n\\includegraphics[width=0.7\\linewidth]{figures/figureB5.eps}\n\\caption{\\footnotesize{The observed sample average $\\bar{A}$ as a function of the perturbation size ${\\varepsilon}$ for an observable $A(x) = x$ and a linear fit (solid line). Top: for data length $N=10^5$ where $\\hat{{\\mathfrak{q}}}=5.03 \\times 10^{-5}$ and the breakdown is not detectable ($p=0.148$). Bottom: for data length $N=10^6$ where $\\hat{{\\mathfrak{q}}}=5.32 \\times 10^{-5}$ and the breakdown is detectable ($p=1.31 \\times 10^{-8}$).}}\n\n\\label{fig.Aeps}\n\\end{figure}\n\n\n\n\\subsection{Effect of the perturbation size ${\\varepsilon}$}\n\nThe critical length of the data $N_b$ above which breakdown of linear response can be detected in a statistically significant way depends on the perturbation size ${\\varepsilon}$. \n\nIn particular,  $\\chi^2$ is an increasing function of ${\\varepsilon}$ for sufficiently large values of ${\\varepsilon}$, cf. (\\ref{e.chisq}).\n\nThis implies that to be able to identify a deviation from linear response at a specified perturbation size ${\\varepsilon}$ with a significance level $p$ the perturbation size needs to be sufficiently large. This is illustrated in Figure~\\ref{fig.qeps} where we show the Monte-Carlo estimate $\\hat{\\mathfrak{q}}$ of the expectation value of the breakdown parameter as a function of the perturbation size (parametrized by the perturbation interval $d {\\varepsilon}$) for fixed data length $N=10^6$. For perturbation sizes $d{\\varepsilon}<8\\times 10^{-7}$ the observations are consistent with linear response theory and only for $d{\\varepsilon}>8\\times 10^{-7}$ can the actual breakdown be detected in a statistically significant way. For comparison we have again included in Figure~\\ref{fig.qeps} a plot showing the breakdown parameter as a function of $d{\\varepsilon}$ for the doubling map where linear response assures ${\\mathbb{E}}{\\mathfrak{q}} \\to 0$ for ${\\varepsilon}\\to 0$. Here linear response is consistent with the observations for the whole range of perturbation sizes considered. \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure~\\ref{fig.Neps} illustrates that the smaller the applied perturbation the larger the data length has to be to detect breakdown. Shown is the critical data length $N_b$ above which breakdown can be detected for a given perturbation size. The critical data length $N_b$ was determined to be the value of $N$ such that $\\hat{{\\mathfrak{q}}} = {\\mathfrak{q}}_\\alpha$ for $\\alpha = 0.05$. A linear fit suggests $N_b \\sim {\\varepsilon}^{-\\gamma}$, where $\\gamma$ was estimated in Figure \\ref{fig.Neps} to be $0.91$.\n\n\n\n\n\\begin{figure}[htbp]\n\\centering\n\\includegraphics[width=0.7\\linewidth]{figures/figureB1.eps}\\\\\n\\includegraphics[width=0.7\\linewidth]{figures/figureC6.eps}\n\\caption{\\footnotesize{Breakdown parameter $\\hat{{\\mathfrak{q}}}$ (solid line) as a function of the perturbation size $d{\\varepsilon}$ for fixed $N=10^6$.\n\nTop: logistic map (\\ref{e.log}) with $a=3.8(1+\\varepsilon)$ for an observable $A(x)=x$. Bottom: doubling map with perturbation $X(x) = \\varepsilon\\, \\sin 2\\pi x$ for an observable $A(x) = \\cos 2\\pi x$.\\\\ The error bars show the two-sided $90\\%$ prediction interval for ${\\mathfrak{q}}$ as estimated from $K=200$ realizations differing in the initial conditions. The dashed line shows ${\\mathfrak{q}}_\\alpha$ for $\\alpha=0.05$.}}\n\\label{fig.qeps}\n\\end{figure}\n\n\n\n\\begin{figure}[htbp]\n\\centering\n\\includegraphics[width=0.7\\linewidth]{figures/figureB3.eps}\n\\caption{\\footnotesize{The critical data length $N_b$ above which the breakdown of linear response is detectable as a function of the perturbation size ${\\varepsilon}$, parametrized by $d{\\varepsilon}$. The slope of the linear fit is $-0.91$.}}\n\\label{fig.Neps}\n\\end{figure}\n\n\n\n\\subsection{Effect of the observable}\nIn the previous sections we presented results for a global observable $A(x)=x$ which probes the dynamics over the full support of the invariant measure. The breakdown is caused by the spikes in the a.c.i.m. and their rapid displacement under perturbation. It is therefore natural to expect that observables which locally probe the displacement require less data to see the breakdown of linear response. We now consider localized observables\n\n", "itemtype": "equation", "pos": 32261, "prevtext": "\nwhere the spikes are given as in (\\ref{e.spike})-(\\ref{e.spikem}) with $f$ replaced by $f_{\\varepsilon}$, and the magnitude of the perturbed spikes also decay as $\\Upsilon_n^{({\\varepsilon})}\\sim\\alpha^{-n/2}$. Differentiation of $\\rho_{\\varepsilon}(x)$ with respect to ${\\varepsilon}$ produces an exponentially growing term $\\alpha^{n/2}$ inside the sum which prevents the differentiability of the a.c.i.m., and hence causes the breakdown of linear response. A different way to see the non-differentiability of the invariant measure is to consider the linear response of an indicator function with support $[0,c_n]$. Without loss of generality we assume that the spike has support to the right of $c_n$ and moves to the left upon perturbation (if this is not the case, take ${\\varepsilon} \\rightarrow -{\\varepsilon}$ to change the direction). Upon applying a perturbation  $\\varepsilon$ the spike will enter the support of the observable and the probability mass moving into the interval is proportional to \n\n", "index": 65, "text": "\\begin{align*}\n\\delta \\rho_{\\rm{spike}} \\sim \\int_0^{\\alpha^n {\\varepsilon}} \\frac{\\alpha^{-\\frac{n}{2}}}{\\sqrt{x}}dx\\sim \\sqrt{{\\varepsilon}} ,\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex18.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\delta\\rho_{\\rm{spike}}\\sim\\int_{0}^{\\alpha^{n}{\\varepsilon}}%&#10;\\frac{\\alpha^{-\\frac{n}{2}}}{\\sqrt{x}}dx\\sim\\sqrt{{\\varepsilon}},\" display=\"inline\"><mrow><mrow><mrow><mi>\u03b4</mi><mo>\u2062</mo><msub><mi>\u03c1</mi><mi>spike</mi></msub></mrow><mo>\u223c</mo><mrow><mstyle displaystyle=\"true\"><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mrow><msup><mi>\u03b1</mi><mi>n</mi></msup><mo>\u2062</mo><mi>\u03b5</mi></mrow></msubsup></mstyle><mrow><mstyle displaystyle=\"true\"><mfrac><msup><mi>\u03b1</mi><mrow><mo>-</mo><mfrac><mi>n</mi><mn>2</mn></mfrac></mrow></msup><msqrt><mi>x</mi></msqrt></mfrac></mstyle><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>x</mi></mrow></mrow></mrow><mo>\u223c</mo><msqrt><mi>\u03b5</mi></msqrt></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.03112.tex", "nexttext": "\nThis observable allows us to probe the local non-smooth behavior of a spike $\\eta_n$ at location $x_n$ with width $w_n$. Recall the displacement length $\\ell_{\\varepsilon}=v_n{\\varepsilon}$ of the spike upon perturbation with ${\\varepsilon}$ where $v_n\\sim \\alpha^n$ with $\\alpha$ being the average expansion rate. Hence, for $x_s\\approx x_n$ and $w_n \\approx w \\le w^\\star:=\\ell_{\\varepsilon}/2$ the spike $\\eta_n$ can be resolved by the observable and the displacement will be detectable when it leaves the effective support of the observable upon perturbation by ${\\varepsilon}$. An example of such a judiciously chosen Gaussian observable is given in Figure~\\ref{fig.Gauss}. \n\nThe effect of a localized observable on the ability to detect breakdown of linear response is illustrated in Figure~\\ref{fig.Agauss1}. We performed two sets of simulations. In the first we fixed the characteristic scale of the observable $w=w^\\star$ to equal half the displacement length of the $n=11$th spike, $w^\\star\\approx 1.9\\times 10^{-4}$, \n\nand varied the centre $x_s$ of the observable. A clear peak of statistically significant values of the breakdown parameter $\\hat{\\mathfrak{q}}$ above a significance level with $p=0.05$ is obtained for $x_s$ close to the location of the $11$th spike at $x_s^\\star:=x_{11}=0.573$. \n\nNote that the size of the displacement window within which breakdown is detectable corresponds roughly to the displacement width of the spike (cf. Figure~\\ref{fig.Gauss}). In a second set of simulations we centered the Gaussian observable at the location of the $n=11$th spike with $x_s=x_s^\\star$ and varied the observational scale $w$. Again, a pronounced peak of the expected value of the breakdown parameter $\\hat{{\\mathfrak{q}}}$ is seen above the significance level for $w=w^\\star$. The maximum is not obtained exactly at the estimated value of $w^\\star$ due to approximations made when relating $v_n$ for finite $n$ to its asymptotic value $\\alpha^n$.\n\nFigure~\\ref{fig.qNGauss} shows the breakdown parameter $\\hat{{\\mathfrak{q}}}$ as a function of the available data length $N$ for a given perturbation size $d{\\varepsilon}=10^{-6}$ for a Gaussian observable where $x_s=x_s^\\star$ and  $w=w^\\star$ is chosen to focus on the displacement of the $11$th spike. It is revealed that a time series with only $N=30,000$ is needed to reliably detect breakdown of linear response; this should be compared to the required length of $N=600,000$ when an observable $A(x)=x$ is used (cf.  Figure~\\ref{fig.qN}). Similarly, Figure~\\ref{fig.qepsGauss} shows the breakdown parameter $\\hat{\\mathfrak{q}}$ as a function of the perturbation size (here the perturbation interval $d {\\varepsilon}$) for fixed data length $N=10^6$ for a Gaussian observable with finely tuned $w=w^\\star$ and $x_s=x_s^\\star$. Breakdown is reliably detected for perturbation size of $d{\\varepsilon} > 1.2\\times 10^{-7}$; for an observable $A(x)=x$ with $N=10^6$ one needs larger perturbation sizes with $d{\\varepsilon}\\ge 8\\times 10^{-7}$ to detect breakdown (cf. Figure~\\ref{fig.qeps}).\n\nThe preceding discussion indicates that detailed knowledge of the underlying dynamical system (both the location of a spike $x_s^\\star$ and its displacement scale $w^\\star$) is required for the successful detection of the breakdown of linear response given a time series of finite length $N$. In particualr, these finely tuned observables depend on the magnitude of the perturbation ${\\varepsilon}$. Figure~\\ref{fig.Agauss2} illustrates how a lack of this knowledge may indeed mislead us into deducing the validity of linear response. We show the observed sample average $\\bar{A}$~\\eqref{e.Aavgs} for a Gaussian observable as a function of the perturbation size ${\\varepsilon}$ in the case when the characteristic observational scale $w$ and the location $x_s$ are judiciously chosen to probe for a particular spike and in the case when they are not chosen to align with a spike and its displacement length. In the latter the existence of linear response is consistent with the observations and a scientist might be mislead in believing in a linear relationship between the perturbation and the response. If, however, the location and scale of the observable are tuned to match a particular spike and its least rapid displacement of the perturbation sizes under consideration, the breakdown is clearly detectable. This, of course, as we have seen above, requires the length of the time series to be sufficiently large. The saturation of the response for sufficiently large perturbations in the case of a finely tuned localized observable (cf. bottom plot in Figure \\ref{fig.Agauss2}) is an indication that the length of the time series is insufficient to detect the contribution of the other spikes to the non-smoothness of the invariant measure.\n\nIt is pertinent to state that the mere inclusion of a scale $w=w^\\star$ in the observable to probe the non-smooth dynamic behavior of the spikes of the invariant measure is not sufficient to detect breakdown for smaller values of $N$ (for fixed ${\\varepsilon}$) or for smaller perturbation sizes ${\\varepsilon}$ (for fixed $N$). For example, an observable $A(x)=\\cos(2\\pi(x-x_s)/w)$ with wave length $w=w^\\star$ and $x_s=x^\\star$ finely tuned to capture the displacement of the $11$th spike does not exhibit any variation of the expected value of breakdown parameter $\\hat{\\mathfrak{q}}$ as a function of the scale parameter $w$. \n\n\n\n\nFigure~\\ref{fig.Asine} reveals that there is no peak in the breakdown parameter near $w=w^\\star$ for finite $N=5\\times 10^4$. The failure of the ${\\rm{cosine}}$-function to enhance the detectability for breakdown of linear response, despite its wave length matching the characteristic displacement length of a particular spike, is due to the global character of the ${\\rm{cosine}}$-function. Although the non-smooth behavior of the fast and narrow spike is resolved by the observable, this is swamped by the dominant contribution of the observable stemming from other parts of the a.c.i.m., in particular from the smooth background and from the larger slower spikes.\n\n\n\n\\begin{figure}[htbp]\n\\centering\n\n\\includegraphics[width=0.75\\textwidth]{figures/figureC4.eps}\n\\caption{\\footnotesize{Gaussian observable probing the displacement of the $n=11$th spike upon perturbation the logistic map (\\ref{e.log}) from $a=3.8(1-{\\varepsilon})$ to $a=3.8(1 +{\\varepsilon})$ with ${\\varepsilon}=2.5 \\times 10^{-6}$. The dash-dotted line shows the invariant measure at $a=3.8(1-{\\varepsilon})$ and the dashed line shows the invariant measure at $a=3.8(1+{\\varepsilon})$.}}\n\\label{fig.Gauss}\n\\end{figure}\n\n\n\\begin{figure}[htbp]\n\\centering\n\n\n\\includegraphics[width=0.7\\linewidth]{figures/figureB8.eps}\\\\\n\\includegraphics[width=0.7\\linewidth]{figures/figureC1.eps}\n\\caption{\\footnotesize{Breakdown parameter $\\hat{{\\mathfrak{q}}}$ (solid line) for a Gaussian observable, for the logistic map with $a=3.8(1+\\varepsilon_i)$\n\nwith $d{\\varepsilon}=10^{-6}$ and $N=5\\times10^5$. Top: as a function of the location of the center $x_s$ of the observable with $x^\\star_s:=x_{11}$ the location of the $n=11$th spike. Here $w=w^\\star$ is fixed to equal half the displacement length of the $11$th spike. Bottom: as a function of the width ratio $w/w^\\star$ with $x_s = x_s^\\star$ fixed.\\\\ The error bars show the two-sided $90\\%$ prediction interval for ${\\mathfrak{q}}$ as estimated from $K=200$ realizations differing in the initial conditions. The dashed line shows ${\\mathfrak{q}}_\\alpha$ for $\\alpha=0.05$.}}\n\\label{fig.Agauss1}\n\\end{figure}\n\n\n\n\\begin{figure}[htbp]\n\\centering\n\\includegraphics[width=0.7\\linewidth]{figures/figureC7.eps}\n\\caption{\\footnotesize{Breakdown parameter $\\hat{{\\mathfrak{q}}}$ (solid line) as a function of the data size $N$ for the logistic map with fixed range of perturbations $a=3.8(1+\\varepsilon)$ with \n\n$d{\\varepsilon}=10^{-6}$ and Gaussian observable with width $w=w^\\star$ and location $x_s=x_s^\\star$ tuned to capture the displacement of the $n=11$th spike.\\\\ The error bars show the two-sided $90\\%$ prediction interval for ${\\mathfrak{q}}$ as estimated from $K=200$ realizations differing in the initial conditions. The dashed line shows ${\\mathfrak{q}}_\\alpha$ for $\\alpha=0.05$.}}\n\\label{fig.qNGauss}\n\\end{figure}\n\n\n\n\\begin{figure}[htbp]\n\\centering\n\\includegraphics[width=0.7\\linewidth]{figures/figureC5.eps}\n\\caption{\\footnotesize{Breakdown parameter $\\hat{\\mathfrak{q}}$ (solid line) as a function of the perturbation size $d{\\varepsilon}$ for fixed $N=10^6$ \nfor the logistic map (\\ref{e.log}) with $a=3.8(1+\\varepsilon)$ for a Gaussian observable with width $w=w^\\star$ and location $x_s=x_s^\\star$ tuned to capture the displacement of the $n=11$th spike.\\\\ The error bars show the two-sided $90\\%$ prediction interval for ${\\mathfrak{q}}$ as estimated from $K=200$ realizations differing in the initial conditions. The dashed line shows ${\\mathfrak{q}}_\\alpha$ for $\\alpha=0.05$.}}\n\\label{fig.qepsGauss}\n\\end{figure}\n\n\n\n\n\\begin{figure}[htbp]\n\\centering\n\n\n\\includegraphics[width=0.7\\linewidth]{figures/figureB6.eps}\\\\\n\\includegraphics[width=0.7\\linewidth]{figures/figureB7.eps}\n\\caption{\\footnotesize{The observed sample average $\\bar{A}$ as a function of the perturbation size ${\\varepsilon}$ for an observable $A(x) = \\exp((x-x_s)^2/(2 w^2))$ with $N=5\\times 10^4$ where $w=w^\\star$ is half the displacement length of the $n=11$th spike, and a linear fit (solid line). Top: when the location of the observable $x_s$ is not centered at the location of the spike $x_s^\\star$. Bottom: when the location of the observable $x_s$ is centered at the location of the spike $x_s^\\star$.}}\n\\label{fig.Agauss2}\n\\end{figure}\n\n\n\n\\begin{figure}[htbp]\n\\centering\n\n\\includegraphics[width=0.7\\linewidth]{figures/figureC3.eps}\n\\caption{\\footnotesize{Breakdown parameter $\\hat{{\\mathfrak{q}}}$ (solid line) for the logistic map with $a=3.8(1+\\varepsilon)$ with $d{\\varepsilon}=10^{-6}$ as a function of the wavelength $w$ of an observable $A(x)=\\cos(2\\pi(x-x_s^\\star)/w)$ where $x_s^\\star$ and $w^\\star$ denote the location and half the displacement length of the $n=11$th spike.\\\\ The error bars show the two-sided $90\\%$ prediction interval for ${\\mathfrak{q}}$ as estimated from $K=200$ realizations differing in the initial conditions. The dashed line shows ${\\mathfrak{q}}_\\alpha$ for $\\alpha=0.05$.}}\n\\label{fig.Asine}\n\\end{figure}\n\n\n\n\n\\section{The fluctuation-dissipation theorem}\n\\label{sec-fdt}\n\n\nThe methods presented in Section \\ref{sec-finite} are based on performing the perturbation experiment by brute force, i.e. by running a numerical experiment for a range of values of ${\\varepsilon}$. However, one of the aspects of linear response theory that has  attracted a lot of attention from practitioners is the fact that for many systems, if linear response holds, formulae exist (see Eqs. (\\ref{e.fdt0}) and (\\ref{e.fdt})) that express  the linear response in terms of properties of the unperturbed dynamical system, providing the tantalizing prospect of predicting the linear response without having to perform the kind of brute perturbation experiment used in Section \\ref{sec-finite}.\n\nIn that vein, the fluctuation-dissipation theorem has been applied to various atmospheric and climate models. It has been mostly applied in the form of the so-called quasi-Gaussian approximation, where the invariant measure is assumed to be Gaussian, resulting in a response in the form of an integrated auto-covariance function \\cite{Leith75}. This autocovariance function can be estimated from unperturbed model integrations or from measurements. The assumption of Gaussianity is reasonable for many large-scale climatic observables, but it is not valid universally, for example for observables related to bi-stable subsystems such as the Kuroshio Extension or the El Ni\\~no Southern Oscillation. A more general approach was taken in \\cite{CooperHaynes11}, where the invariant measure was not assumed to be Gaussian, but was obtained by smoothing the observed empirical density with a smoothing kernel. Since we are dealing here with highly non-Gaussian densities, we will investigate this approach rather than imposing Gaussianity. \n\nIn this section we consider the situation where one is unaware of the existence or absence of linear response for the system of interest, but only has access to a data set of observations of the unperturbed system. In such a case a practitioner might be lead to estimate the right hand side of \\eqref{e.fdt} from data and hope that the obtained quantity gives an indication of the response over a certain range of ${\\varepsilon}$. When linear response holds this will be the case, however here we investigate whether such an approximation of the response is possible when the response is non-differentiable. \n\n\n\\begin{figure}[htbp]\n\\centering\n\\includegraphics[width=0.7\\linewidth]{figures/figureD1.eps}\n\\caption{\\footnotesize{Expectation value $\\langle A\\rangle$ as a function of the parameter $a$ of the logistic map (\\ref{e.log}) for an observable $A(x) = x$. Gaps in the curve correspond to periodic windows. At two values of $a$ the predictions of the fluctuation dissipation theorem \\eqref{e.fdt} are shown for two different smoothing widths $\\omega_s$ used in a spectral kernel-smoothing. The continuous lines (online green) are for $\\omega_s = 0.005$ and the dashed lines (online blue) are for $\\omega_s = 0.015$.}}\n\\label{fig.nondiffFDT}\n\\end{figure}\n\n\nTo this end we perform a perturbation experiment for the logistic map and compare the actual response to the prediction obtained through \\eqref{e.fdt}. The actual response is obtained through spectral methods \\cite{Boyd01,Trefethen13}, in order to avoid finite sample size effects. We have followed the non-parametric method based on kernel smoothing for estimating the linear response from the FDT as described in \\cite{CooperHaynes11}. The density of the a.c.i.m. $\\rho_0$ is smoothed by convolution with a Gaussian with smoothing width $\\omega_s$. This removes the non-differential character of the spikes and allows the derivative to be taken in Eq. \\eqref{e.fdt}.\n\nThe results of such an estimation of the linear response is shown in  Figure \\ref{fig.nondiffFDT}. The experiment was performed for an observable $A(x)=x$ at two different reference states $a=3.789$ and $a=3.805$ and for two different smoothing widths $\\omega_s=0.015$ and $\\omega_s=0.005$. It is evident that the results are sensitive to both these parameters and that the actual response is not well approximated by the slope as constructed through the FDT. \n\n\n\n\n\n\n\n\n\\section{Summary and conclusion}\n\\label{sec-summary}\nWe have provided a detailed numerical investigation of the manifestation of breakdown of linear response caused by the non-smooth change of the invariant measure with respect to a small perturbation in a finite time series analysis. We presented results for the logistic map for which the breakdown of linear response is analytically well understood \\cite{BaladiSmania08,BaladiSmania10,Baladi14,BaladiEtAl15}.\\\\\n\nThe main messages which can be deduced from our results are that in order to detect breakdown of linear response in time series of finite length, the data length needs to be sufficiently long and furthermore that the detectability of linear response strongly depends on the observable and on the perturbation size. We summarize our key findings:\n\\begin{itemize}\n\\item The amount of data $N$ required to detect a breakdown of linear response for a given perturbation size can be very large. For the logistic map with a given perturbation size of the order of ${\\varepsilon}={\\cal{O}}(10^{-6})$ one needs at least $N=600,000$ for a smooth observable $A(x)=x$. Hence, an apparent linear response seen in a given time series might be spuriously caused by an insufficient quantity of data.\n\\item The smaller the perturbation size the longer the data need to be to detect a breakdown in general.\n\\item The global character of an observable may inhibit the detection of breakdown of linear response. For a given finite data length and given perturbation size, suitably localized observables may be needed to probe linear response. This, however, requires either detailed knowledge of the underlying dynamical system or computationally involved scans of the parameters of the observable such as its scale and its location.\n\\item Predicting response using the fluctuation-dissipation theorem is highly sensitive to the applied smoothing needed to assure differentiability of the density, and to the point in parameter space where the response is calculated, negating its predictive value.\n\\end{itemize}\n\nThese findings can be taken as a word of caution for practitioners interpreting observational or numerical time series. Our results aim to fill the gap between the body of rigorous theoretical work and the applied research done, for example, in climate science and in atmosphere and ocean dynamics.\n\nSince we currently have no means of deciding whether the coupled atmosphere-ocean system or the whole climate system satisfies linear response theory or whether it does not, our work does not {\\em{per se}} question the validity of the many results obtained using linear response theory.\\\\ The {\\em{chaotic hypothesis}} of Gallavotti-Cohen \\cite{GallavottiCohen95a,GallavottiCohen95b} is often invoked to argue that a high-dimensional chaotic physical system can be treated for all practical purposes as if it were Axiom A. It is, however, pertinent to mention, that the chaotic hypothesis only makes a statement about the existence of time averages computed with a probability distribution capturing the statistics of macroscopic observables and satisfying a large deviation law at {\\em{one}} parameter value; it does not make any statement about the smoothness of the underlying probability density with respect to changes in this parameter and about whether the invariant measures of the approximating Axiom A systems at nearby parameter values are approximately linearly related, which is what is required for linear response theory. We adhere, however, to the current general belief that large complex systems with multi-scale dynamics behave as stochastic systems and therefore linear response theory is valid for large-scale observables (provided the dynamics is not close to a critical point). \n\nFor scientists analyzing time series, we propose the following as a practical guide, which could be drawn from our work. In the case when the time series is obtained by costly numerical simulations, prohibiting the usage of very large time series, or by a limited amount of observational data, scientists could perform an ensemble of (parallel) simulations for several moderate data lengths $N$ or of subsamples. If the number of realizations which produce values of the sample mean of the breakdown parameter $\\hat{\\mathfrak{q}}$ exceeding the corresponding threshold value for a specified significance level increases with increasing data length $N$, then this indicates breakdown of linear response as for example seen in Figure~\\ref{fig.qN}. The figure suggests that another indication for a finite value of ${\\mathbb{E}} {\\mathfrak{q}}$ and breakdown of linear response is the case where $\\hat{\\mathfrak{q}}$ either increases or saturates over the available range of $N$. These two criteria, although far from being decisive, may be used as sufficient conditions for breakdown of linear response.\n\n\n\n\n\n\n\\section*{Acknowledgement}\nJ. Wouters' research was funded by the European Community's Seventh Framework Programme (FP7/2007-2013) under grant agreement n\\ensuremath{{}^{\\circ}} PIOF-GA-2013-626210.\n\n\n\\section*{References}\n\n\\bibliographystyle{natbib}\n\n\n\\bibliography{bibliography}\n\n\n", "itemtype": "equation", "pos": 45289, "prevtext": "\nand therefore $\\delta\\rho_{\\rm{spike}}/{\\varepsilon}\\sim1/\\sqrt{{\\varepsilon}}$. Since spikes are dense on the support of the a.c.i.m., the non-smoothness extends to the whole a.c.i.m. The non-differentiability of the a.c.i.m. is clearly seen in Figure~\\ref{fig.logresp} where we show the observable $\\langle A\\rangle_{\\varepsilon}$ as a function of ${\\varepsilon}$. The results shown are obtained here employing spectral methods \\cite{Boyd01,Trefethen13} rather than using a long but finite time series. This has the advantage of high accuracy, although these methods are not practically feasible when analyzing high-dimensional complex systems or when information on the system is only provided through finite observations.\n\n\n\\begin{figure}[htbp]\n\\centering\n\n\\includegraphics[width=0.7\\linewidth]{figures/figure02.eps}\n\\caption{\\footnotesize{The a.c.i.m. of the logistic map (\\ref{e.log}) with $a = 3.8$ (black lines), and a cobweb diagram (online orange) relating the spikes of the a.c.i.m. to the first $17$ iterates of the forward orbit of the critical point.}}\n\\label{fig.l-copm}\n\\end{figure}\n\n\n\n\\begin{figure}[htbp]\n\\centering\n\n\\includegraphics[width=0.9\\linewidth]{figures/figure03.eps}\n\\caption{\\footnotesize{The repeated action of the logistic map (\\ref{e.log}) with $a = 3.8$ on a continuous density (blue), with a.c.i.m. (light blue). The  dashed lines (online orange) show the image of the critical point after $n$ iterations of the logistic map. The continuous lines (online green) show the image of a few points within the support of the initial density at $n=0$ upon subsequent iteration of the map.}}\n\\label{fig.logprop}\n\\end{figure}\n\n\n\n\\begin{figure}[htbp]\n\\centering\n\n\\includegraphics[width=0.7\\linewidth]{figures/figure04.eps}\n\\caption{\\footnotesize{Overlaying two a.c.i.m.s of the logistic map with $a=3.8$ (maroon) and $a=3.8+6.05\\times 10^{-4}$ (light blue). The displacement of a smaller spike with $n=17$ is illustrated by the two ovals, and that of a large spike with $n=3$ with a dashed box.}}\n\\label{fig.lcpet}\n\\end{figure}\n\n\n\n\\begin{figure}[htbp]\n\\centering\n\n\\includegraphics[width=0.7\\linewidth]{figures/figure05.eps}\n\\caption{\\footnotesize{Observable $\\langle A\\rangle_{\\varepsilon}$ as a function of the perturbation ${\\varepsilon}$ for the logistic map (\\ref{e.log}) with $a=3.8(1+\\varepsilon)$ and observable $A(x) = x$. Gaps in the curve correspond to periodic windows.}}\n\\label{fig.logresp}\n\\end{figure}\n\n\n\n\n\\section{Resolving breakdown of linear response in finite time series}\n\\label{sec-finite}\nThe rigorous theory by Baladi and co-workers \\cite{BaladiSmania08,BaladiSmania10,Baladi14,BaladiEtAl15} shows that certain dynamical systems such as the logistic map do not obey a linear response. In this section we will investigate how the finitude of data may prevent the breakdown to be detectable and one may falsely be lead to believe that linear response was valid.  \n\nAs seen in Section~\\ref{sec-break} the non-smoothness of the invariant measure is caused by the rapid displacement of spikes upon perturbation. The smaller and narrower the spike, the faster it moves. This points to an issue of resolution: the faster spikes carry less mass and therefore require a certain amount of data to be reliably resolved; the slower spikes carry more mass but their smaller displacement upon perturbation requires sufficient data to be resolved. This means that a sufficiently large amount of data is needed for the breakdown parameter $\\mathfrak{q}$ to accurately estimate the mismatch ${\\mathbb{E}}{\\mathfrak{q}}$, and to determine whether a system obeys linear response or not. This issue of resolving the mismatch ${\\mathbb{E}}{\\mathfrak{q}}$ is an additional finite size issue to the one discussed in Section~\\ref{sec-eq} whereby $N$ needs to be sufficiently large to assure that the observed $p$-value is properly estimated (cf. (\\ref{e.p})).\n\n\n\nThroughout the paper we simulate the logistic map (\\ref{e.log}) with $a=a_0(1+{\\varepsilon})$ and $a_0= 3.8$. In the notation of Section~\\ref{sec-lrt} we set $\\varepsilon_0=0$ from now on. We chose $M=20$ equidistant values ${\\varepsilon}_i = \\frac{2i-M+1}{2}d{\\varepsilon}$ with $i=0,\\ldots,M-1$ for some $d{\\varepsilon}>0$ to determine the breakdown parameter ${\\mathfrak{q}}$. Note that the breakdown parameter cannot be determined at an exact perturbation size ${\\varepsilon}$ but we determine the validity of a linear approximation over a range of perturbation sizes parametrized by $d{\\varepsilon}$ (for fixed $M=20$). We restrict the set of perturbations ${\\varepsilon}_i$ to include only those which belong to the chaotic Cantor set. \n\nThe variances $\\sigma_i^2$ (\\ref{e.covar}) are estimated as a Monte-Carlo estimate from the observed response via (\\ref{e.clt}) using the central limit theorem with $200$ realizations for each $i=1,\\cdots,M$.  \n\n\n\n\n\n\\subsection{Effect of finite data length $N$}\n\nFigure~\\ref{fig.qN} shows how the breakdown parameter $\\mathfrak{q}$ behaves with increasing data length $N$ for given perturbation size $d{\\varepsilon}=10^{-6}$. For each value of $N$ the breakdown parameter is calculated for the above mentioned range of $M=20$ perturbation sizes ${\\varepsilon}_i$. Shown is the Monte-Carlo estimate $\\hat{\\mathfrak{q}}$ of the expectation value of the breakdown parameter ${\\mathbb{E}}\\mathfrak{q}$ over $K=200$ realizations, differing in the initial condition of the logistic map as well as the threshold value ${\\mathfrak{q}}_\\alpha$ corresponding to a significance level $\\alpha=0.05$. We show error bars obtained from the ensemble statistics indicating the two-sided $90\\%$ prediction interval for ${\\mathfrak{q}}$.  \nWe see clearly the saturation of the breakdown parameter with increasing data length $N$ towards the deterministic limit ${\\mathbb{E}}{\\mathfrak{q}}$ which eventually leads to detection of the breakdown above a significance level of $p=0.05$. \n\nThe breakdown can, however, only be detected reliably with a statistical significance level larger than $0.05$ for long time series with $N>600,000$. The corollary of this is that when analyzing single time series of length $N<600,000$ at several values of the perturbation size ${\\varepsilon}$ the error bars lie below ${\\mathfrak{q}}_\\alpha$ and the dynamics may be falsely classified as obeying linear response.\\\\ For comparison we have included in Figure~\\ref{fig.qN} a plot showing the breakdown parameter as a function of $N$ for the doubling map which does obey linear response with ${\\mathbb{E}}{\\mathfrak{q}} \\to 0$ for ${\\varepsilon}\\to 0$. Here the observed breakdown parameter $\\hat{\\mathfrak{q}}$ decreases with $N$ according to the law of large numbers and the sample statistics is consistent with the two-sided $90\\%$ prediction interval for the whole range of $N$. Since the expectation of the breakdown parameter ${\\mathbb{E}}{\\mathfrak{q}}$ approaches zero for vanishing perturbation size, the estimator of ${\\mathbb{E}}{\\mathfrak{q}}$ is discontinuous as a function of $N$ due to sampling errors.\n\nA concrete example of how statistical noise may impede the detection of linear response breakdown from observations is shown in Figure~\\ref{fig.Aeps} for an observable $A(x)=x$. Shown is the observed sample average $\\bar{A}$~\\eqref{e.Aavgs} as a function of the perturbation size. The error bars are calculated from the standard deviation as calculated for the single available time series, which is the situation for scientists analyzing observations. For insufficient data length $N=10^5$ a linear response is consistent within the available statistical significance levels (top of  Figure~\\ref{fig.Aeps}). Only for significantly larger time series with data length $N=10^6$, does the breakdown become detectable in a statistically significant way (bottom of  Figure~\\ref{fig.Aeps}).\n\n\n\\begin{figure}[htbp]\n\\centering\n\\includegraphics[width=0.7\\linewidth]{figures/figureB2.eps}\\\\\n\\includegraphics[width=0.7\\linewidth]{figures/figureC8.eps}\n\\caption{\\footnotesize{Breakdown parameter $\\hat{{\\mathfrak{q}}}$ (solid line) as a function of the data size $N$, estimated using $d{\\varepsilon} = 10^{-6}$. Top: logistic map (\\ref{e.log}) with fixed range of perturbations $a=3.8(1+\\varepsilon)$ and observable $A(x) = x$. Bottom: doubling map with perturbation $X(x) = \\varepsilon\\, \\sin 2\\pi x$ and observable $A(x) = \\cos 2\\pi x$.\\\\ The error bars show the two-sided $90\\%$ prediction interval for ${\\mathfrak{q}}$ as estimated from $K=200$ realizations differing in the initial conditions. The dashed line shows ${\\mathfrak{q}}_\\alpha$ for $\\alpha=0.05$.}}\n\\label{fig.qN}\n\\end{figure}\n\n\n\n\\begin{figure}[htbp]\n\\centering\n\\includegraphics[width=0.7\\linewidth]{figures/figureB4.eps}\\\\\n\\includegraphics[width=0.7\\linewidth]{figures/figureB5.eps}\n\\caption{\\footnotesize{The observed sample average $\\bar{A}$ as a function of the perturbation size ${\\varepsilon}$ for an observable $A(x) = x$ and a linear fit (solid line). Top: for data length $N=10^5$ where $\\hat{{\\mathfrak{q}}}=5.03 \\times 10^{-5}$ and the breakdown is not detectable ($p=0.148$). Bottom: for data length $N=10^6$ where $\\hat{{\\mathfrak{q}}}=5.32 \\times 10^{-5}$ and the breakdown is detectable ($p=1.31 \\times 10^{-8}$).}}\n\n\\label{fig.Aeps}\n\\end{figure}\n\n\n\n\\subsection{Effect of the perturbation size ${\\varepsilon}$}\n\nThe critical length of the data $N_b$ above which breakdown of linear response can be detected in a statistically significant way depends on the perturbation size ${\\varepsilon}$. \n\nIn particular,  $\\chi^2$ is an increasing function of ${\\varepsilon}$ for sufficiently large values of ${\\varepsilon}$, cf. (\\ref{e.chisq}).\n\nThis implies that to be able to identify a deviation from linear response at a specified perturbation size ${\\varepsilon}$ with a significance level $p$ the perturbation size needs to be sufficiently large. This is illustrated in Figure~\\ref{fig.qeps} where we show the Monte-Carlo estimate $\\hat{\\mathfrak{q}}$ of the expectation value of the breakdown parameter as a function of the perturbation size (parametrized by the perturbation interval $d {\\varepsilon}$) for fixed data length $N=10^6$. For perturbation sizes $d{\\varepsilon}<8\\times 10^{-7}$ the observations are consistent with linear response theory and only for $d{\\varepsilon}>8\\times 10^{-7}$ can the actual breakdown be detected in a statistically significant way. For comparison we have again included in Figure~\\ref{fig.qeps} a plot showing the breakdown parameter as a function of $d{\\varepsilon}$ for the doubling map where linear response assures ${\\mathbb{E}}{\\mathfrak{q}} \\to 0$ for ${\\varepsilon}\\to 0$. Here linear response is consistent with the observations for the whole range of perturbation sizes considered. \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure~\\ref{fig.Neps} illustrates that the smaller the applied perturbation the larger the data length has to be to detect breakdown. Shown is the critical data length $N_b$ above which breakdown can be detected for a given perturbation size. The critical data length $N_b$ was determined to be the value of $N$ such that $\\hat{{\\mathfrak{q}}} = {\\mathfrak{q}}_\\alpha$ for $\\alpha = 0.05$. A linear fit suggests $N_b \\sim {\\varepsilon}^{-\\gamma}$, where $\\gamma$ was estimated in Figure \\ref{fig.Neps} to be $0.91$.\n\n\n\n\n\\begin{figure}[htbp]\n\\centering\n\\includegraphics[width=0.7\\linewidth]{figures/figureB1.eps}\\\\\n\\includegraphics[width=0.7\\linewidth]{figures/figureC6.eps}\n\\caption{\\footnotesize{Breakdown parameter $\\hat{{\\mathfrak{q}}}$ (solid line) as a function of the perturbation size $d{\\varepsilon}$ for fixed $N=10^6$.\n\nTop: logistic map (\\ref{e.log}) with $a=3.8(1+\\varepsilon)$ for an observable $A(x)=x$. Bottom: doubling map with perturbation $X(x) = \\varepsilon\\, \\sin 2\\pi x$ for an observable $A(x) = \\cos 2\\pi x$.\\\\ The error bars show the two-sided $90\\%$ prediction interval for ${\\mathfrak{q}}$ as estimated from $K=200$ realizations differing in the initial conditions. The dashed line shows ${\\mathfrak{q}}_\\alpha$ for $\\alpha=0.05$.}}\n\\label{fig.qeps}\n\\end{figure}\n\n\n\n\\begin{figure}[htbp]\n\\centering\n\\includegraphics[width=0.7\\linewidth]{figures/figureB3.eps}\n\\caption{\\footnotesize{The critical data length $N_b$ above which the breakdown of linear response is detectable as a function of the perturbation size ${\\varepsilon}$, parametrized by $d{\\varepsilon}$. The slope of the linear fit is $-0.91$.}}\n\\label{fig.Neps}\n\\end{figure}\n\n\n\n\\subsection{Effect of the observable}\nIn the previous sections we presented results for a global observable $A(x)=x$ which probes the dynamics over the full support of the invariant measure. The breakdown is caused by the spikes in the a.c.i.m. and their rapid displacement under perturbation. It is therefore natural to expect that observables which locally probe the displacement require less data to see the breakdown of linear response. We now consider localized observables\n\n", "index": 67, "text": "\\begin{align*}\nA(x)= \\exp\\left(-\\frac{(x-x_s)^2}{2 w^2}\\right)\\; .\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex19.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle A(x)=\\exp\\left(-\\frac{(x-x_{s})^{2}}{2w^{2}}\\right)\\;.\" display=\"inline\"><mrow><mrow><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo>(</mo><mrow><mo>-</mo><mstyle displaystyle=\"true\"><mfrac><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>x</mi><mo>-</mo><msub><mi>x</mi><mi>s</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup><mrow><mn>2</mn><mo>\u2062</mo><msup><mi>w</mi><mn>2</mn></msup></mrow></mfrac></mstyle></mrow><mo rspace=\"5.3pt\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}]