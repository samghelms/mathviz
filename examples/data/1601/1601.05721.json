[{"file": "1601.05721.tex", "nexttext": "\nwhere $J>0$ is the exchange coupling constant, $h$ is the bulk magnetic field, and $h_{\\textnormal{S}}$ and $h_{\\textnormal{T}}$ are additional surface magnetic fields.\nThe first term describes interactions between spins, and the bracketed sum over $i$ and $j$ indicates a restriction to nearest-neighbour pairs. The second term represents the coupling of all spins $s_{i}$ with the uniform external bulk magnetic field $h$.\nThe third term is the coupling of spins located at the pore surface (PS; dark grey in Fig.~\\ref{fgr:1}) with the surface magnetic field $h_{\\textnormal{S}}$, while the last term describes the coupling of spins in the top row (TR; light grey in Fig.~\\ref{fgr:1}) of the lattice with an additional surface magnetic field $h_{\\textnormal{T}}$. All spins in PS and TR have three nearest neighbours, except for the two spins located in the bottom corners of the pore which have only two neighbours.  \n\nWe measure the temperature in units of $J/k_{\\textnormal{B}}$ and magnetic fields in units of $J$; here $k_{\\textnormal{B}}$ is the Boltzmann constant. At $h=0$ the 2D Ising model undergoes a continuous transition from the disordered phase to one of the two ordered phases~\\cite{Onsager1944} at a critical temperature $T_{c} = 2.27 J/k_{\\textnormal{B}}$. We set the temperature to be $T= 1.25 J/k_{\\textnormal{B}}$, well below $T_{c}$.\nWe start in the spin-down phase but choose a positive bulk magnetic field $h= J/16$, so that the initial configuration is metastable. The system evolves following a Metropolis single spin-flip Monte Carlo (MC) algorithm with random choice of trial spin. Time is measured in units of MC sweeps. For our choice of $T$ and $h$ the nucleation of the spin-up phase from the spin-down phase is typically not rapid, and brute-force simulations of the system are prohibitively slow. We thus apply rare event sampling methods, umbrella sampling and transition path sampling (TPS), to gain insight into nucleation of the stable phase. \n\nWe set $L=60$ as this turns out to be sufficiently large to avoid artefacts from finite lattice size for our choice of $T$ and $h$. Tuning the surface field $h_{S}$ allows us to set the contact angle $\\theta$ of the nucleating spin-up cluster on a flat surface: one obtains a hydrophilic surface ($\\theta < 90^{\\circ}$) for $h_{S}>0$, and a hydrophobic surface ($\\theta > 90^{\\circ}$) for $h_{S}<0$. The case $h_{S} = 0$, $\\theta = 90^{\\circ}$, which does not favour either spin-up or spin-down, was previously examined in Ref. [\\onlinecite{Page2006}]. The additional surface field $h_{T}$ in the top row of the lattice is set to a high negative value, thus ensuring that the nucleation always occurs at the bottom surface. \n\\begin{figure}[h]\n  \\centering\n  \\includegraphics[width=8.6cm]{figure1}\n  \\caption{A schematic of the pore geometry, with $L$ the lattice size, $d$ the pore depth and $w$ the pore width (distance is measured in number of lattice vertices). Periodic boundary conditions are used in the $x$ direction. The surface field $h_{\\textnormal{S}}$ acts on spins marked with dark grey, while surface field $h_{\\textnormal{T}}$ acts on spins marked with light grey.}\n\\label{fgr:1}\n\\end{figure}\n\n\\section{Nucleation on a flat surface}\\label{flat}\n\n\\subsection{Classical nucleation theory}\n\nAccording to the classical theory of homogeneous nucleation~\\cite{Debenedetti1996,Oxtoby1992,Sear2007} for a 2D system the free energy needed to form a nucleus of $n$ molecules of the stable phase can be written\n\n", "itemtype": "equation", "pos": 6184, "prevtext": "\n\\title{Pore emptying transition during nucleation in hydrophobic nanopores}\n\\author{Milo\\v{s} Kne\\v{z}evi\\'{c}}\n\n\\author{Julia M. Yeomans}\n\\affiliation{The Rudolf Peierls Centre for Theoretical Physics, Oxford OX1 3NP, United Kingdom}\n\\date{\\today}\n\n\\begin{abstract}\nUsing the 2D Ising model we study the generic properties of nucleation in hydrophobic nanopores. To explore the pathways to nucleation of a spin-up phase from a metastable spin-down phase we perform umbrella sampling and transition path sampling simulations. We find that for narrow pores the nucleation occurs on the surface outside the pore. For wide pores the nucleation starts in the pore, and continues outside the filled pore. Intriguingly, we observe a pore emptying transition for a range of intermediate pore widths: a pre-critical nucleus fills the pore, continues to expand outside of the filled pore, but then suddenly gets expelled from the pore before reaching its critical size.\n\\end{abstract}\n\n\n\n\\maketitle\n\n\\section{Introduction}\n\nEfficient design of hydrophobic surfaces is one of the important contemporary challenges in fundamental and engineering sciences~\\cite{Quere2008}. When a liquid droplet is placed on a hydrophobic, rough surface, it is typically found in one of two states: the droplet may be suspended on top of any pores trapping air underneath it, resulting in a Cassie-Baxter state~\\cite{Cassie1944}, or wet the pores resulting in a Wenzel state~\\cite{Wenzel1936}. The different fluid configurations result in different properties: in the superhydrophobic Cassie-Baxter state the drop has a higher contact angle and smaller hysteresis as the substrate-liquid contact is minimised. \n\nIn a condensing environment, liquid condensate originates from nanometric nuclei and usually starts to grow within the pores thus giving rise to a Wenzel state which may alter the physical character of the rough surfaces. Indeed, dew-repellent surfaces found in nature~\\cite{Barthlott1997,Chen2013} often exhibit a nanoscale roughness which obstructs formation of these nanometric nuclei in the cavities. The nanostructural dew repellency in living systems has inspired artificial surfaces that are both superhydrophobic and antidew~\\cite{Chen2007,Miljkovic2012a}. Despite this progress, the antidew mechanism of the nanostructured surfaces remains unclear, hindering the applications of superhydrophobicity in a variety of systems such as effective condensers~\\cite{Miljkovic2012b,Miljkovic2012c,Miljkovic2013,Narhe2004,Varanasi2009,Boreyko2009}, self-cleaning materials~\\cite{Chen2013,Sun2005} and anti-icing substrates~\\cite{Poulikakos2014}. The nanometric scale poses significant challenges in terms of experimental measurements, because it is very difficult to realise a sufficiently good temporal and spatial resolution to track the nucleation dynamics. To try to reveal the nucleation mechanism at these scales one instead resorts to theoretical predictions and computer simulations. To this end, some progress has already been made by Guo \\textit{et al.}~\\cite{Guo2014} who used a constrained lattice density functional theory to study the vapour-liquid nucleation of droplets on nanopillared structures in the lattice-gas model.\n\nOur aim in this paper is to study the generic features of nucleation in hydrophobic pores. To this end we perform Monte Carlo simulations of the nearest-neighbour 2D Ising model to explore the pathways to nucleation of a spin-up phase from a metastable spin-down phase. The connection to the vapour-liquid transition can then be made by the standard mapping~\\cite{Lee1952} of the Ising model to the lattice-gas model. This approach has proved useful in the study of homogeneous nucleation~\\cite{Pan2004,Ryu2010r,Ryu2010}, heterogenous nucleation on impurities~\\cite{Sear2006}, and heterogeneous nucleation in pores with neutral walls~\\cite{Page2006} (which do not favour either the up or down spins).\n\nWe analyse the nucleation pathways for hydrophobic pores, that is pores with walls favouring spin-down states. Depending on the pore size, we find that there are three possible nucleation regimes.\nFor small pore widths, the nucleation takes place on the surface outside the pore (see Fig.~\\ref{fgr:10}). For sufficiently large pore widths the nucleation occurs as a two-step process: a pre-critical nucleus forms in one of the bottom corners of the pore and there is a free energy barrier that must be overcome for the pore to be filled; then there is a second nucleation outside the filled pore characterised by a critical nucleus which forms on top of the filled pore (Fig.~\\ref{fgr:14}). This two-step nucleation regime has already been observed~\\cite{Page2006} for pores with walls which are neutral. Finally, for moderate pore widths, we observe a pre-critical nucleus that starts to grow in the pore, fills the pore and proceeds to grow out of the pore without reaching a critical size. Then at a given moment it is suddenly expelled from the pore (see Fig.~\\ref{fgr:12}) and, after some further growth, forms a critical nucleus that lies on the surface outside the pore as in Fig.~\\ref{fgr:10}. Thus, in this nucleation regime one observes a pore emptying transition of the pre-critical nucleus.\n\nThe article is organised as follows. We first present the model in Section \\ref{model}. Nucleation on a flat hydrophobic surface is studied in Section \\ref{flat} using umbrella sampling and transition path sampling. In Section \\ref{neutral} we briefly examine the case of neutral pores using umbrella sampling to compare with the results of Ref. [\\onlinecite{Page2006}]. We present our results on nucleation from hydrophobic pores in Section \\ref{hydrophobic}. A summary of our findings is given in the final section. \n\n\\section{The model}\\label{model}\n\nWe study nucleation in the simple pore geometry shown in Fig.~\\ref{fgr:1}. The lattice has $N = L \\times L$ spins with periodic boundary conditions in the $x$ direction and closed boundaries in the $y$ direction.\nPortions of the lattice are removed to give pores of depth $d$ and width $w$. Each lattice site $i$ is occupied by an Ising spin $s_i = \\pm 1$.\nThe system is described by the Hamiltonian\n\n", "index": 1, "text": "\\begin{equation}\n\t\\mathcal{H} = - J \\sum_{\\langle i,j \\rangle} s_{i} s_{j} - h \\sum_{i} s_{i} - h_{\\textnormal{S}} \\sum_{i \\in \\: \\textnormal{PS}} s_{i} - h_{\\textnormal{T}} \\sum_{i \\in \\: \\textnormal{TR}} s_{i},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"\\mathcal{H}=-J\\sum_{\\langle i,j\\rangle}s_{i}s_{j}-h\\sum_{i}s_{i}-h_{%&#10;\\textnormal{S}}\\sum_{i\\in\\&gt;\\textnormal{PS}}s_{i}-h_{\\textnormal{T}}\\sum_{i\\in%&#10;\\&gt;\\textnormal{TR}}s_{i},\" display=\"block\"><mrow><mrow><mi class=\"ltx_font_mathcaligraphic\">\u210b</mi><mo>=</mo><mrow><mrow><mo>-</mo><mrow><mi>J</mi><mo>\u2062</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mo stretchy=\"false\">\u27e8</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=\"false\">\u27e9</mo></mrow></munder><mrow><msub><mi>s</mi><mi>i</mi></msub><mo>\u2062</mo><msub><mi>s</mi><mi>j</mi></msub></mrow></mrow></mrow></mrow><mo>-</mo><mrow><mi>h</mi><mo>\u2062</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mi>i</mi></munder><msub><mi>s</mi><mi>i</mi></msub></mrow></mrow><mo>-</mo><mrow><msub><mi>h</mi><mtext>S</mtext></msub><mo>\u2062</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo rspace=\"4.7pt\">\u2208</mo><mtext>PS</mtext></mrow></munder><msub><mi>s</mi><mi>i</mi></msub></mrow></mrow><mo>-</mo><mrow><msub><mi>h</mi><mtext>T</mtext></msub><mo>\u2062</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo rspace=\"4.7pt\">\u2208</mo><mtext>TR</mtext></mrow></munder><msub><mi>s</mi><mi>i</mi></msub></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05721.tex", "nexttext": "\nwhere $\\Delta \\mu <0$ is the difference between the chemical potentials of the stable and metastable phases under bulk conditions, $\\gamma$ is the macroscopic surface tension between the two phases, and $C$ is the circumference of the growing nucleus.\nFor a circular nucleus of radius $r$, $n = \\rho_{n} \\pi r^2$, and $C= 2r \\pi$, where $\\rho_{n}$ is the number density of the nucleating phase. For the Ising model the chemical potential difference is~\\cite{Ryu2010r} $\\vert \\Delta \\mu \\rvert \\approx 2h$, which gives\n\n", "itemtype": "equation", "pos": 9912, "prevtext": "\nwhere $J>0$ is the exchange coupling constant, $h$ is the bulk magnetic field, and $h_{\\textnormal{S}}$ and $h_{\\textnormal{T}}$ are additional surface magnetic fields.\nThe first term describes interactions between spins, and the bracketed sum over $i$ and $j$ indicates a restriction to nearest-neighbour pairs. The second term represents the coupling of all spins $s_{i}$ with the uniform external bulk magnetic field $h$.\nThe third term is the coupling of spins located at the pore surface (PS; dark grey in Fig.~\\ref{fgr:1}) with the surface magnetic field $h_{\\textnormal{S}}$, while the last term describes the coupling of spins in the top row (TR; light grey in Fig.~\\ref{fgr:1}) of the lattice with an additional surface magnetic field $h_{\\textnormal{T}}$. All spins in PS and TR have three nearest neighbours, except for the two spins located in the bottom corners of the pore which have only two neighbours.  \n\nWe measure the temperature in units of $J/k_{\\textnormal{B}}$ and magnetic fields in units of $J$; here $k_{\\textnormal{B}}$ is the Boltzmann constant. At $h=0$ the 2D Ising model undergoes a continuous transition from the disordered phase to one of the two ordered phases~\\cite{Onsager1944} at a critical temperature $T_{c} = 2.27 J/k_{\\textnormal{B}}$. We set the temperature to be $T= 1.25 J/k_{\\textnormal{B}}$, well below $T_{c}$.\nWe start in the spin-down phase but choose a positive bulk magnetic field $h= J/16$, so that the initial configuration is metastable. The system evolves following a Metropolis single spin-flip Monte Carlo (MC) algorithm with random choice of trial spin. Time is measured in units of MC sweeps. For our choice of $T$ and $h$ the nucleation of the spin-up phase from the spin-down phase is typically not rapid, and brute-force simulations of the system are prohibitively slow. We thus apply rare event sampling methods, umbrella sampling and transition path sampling (TPS), to gain insight into nucleation of the stable phase. \n\nWe set $L=60$ as this turns out to be sufficiently large to avoid artefacts from finite lattice size for our choice of $T$ and $h$. Tuning the surface field $h_{S}$ allows us to set the contact angle $\\theta$ of the nucleating spin-up cluster on a flat surface: one obtains a hydrophilic surface ($\\theta < 90^{\\circ}$) for $h_{S}>0$, and a hydrophobic surface ($\\theta > 90^{\\circ}$) for $h_{S}<0$. The case $h_{S} = 0$, $\\theta = 90^{\\circ}$, which does not favour either spin-up or spin-down, was previously examined in Ref. [\\onlinecite{Page2006}]. The additional surface field $h_{T}$ in the top row of the lattice is set to a high negative value, thus ensuring that the nucleation always occurs at the bottom surface. \n\\begin{figure}[h]\n  \\centering\n  \\includegraphics[width=8.6cm]{figure1}\n  \\caption{A schematic of the pore geometry, with $L$ the lattice size, $d$ the pore depth and $w$ the pore width (distance is measured in number of lattice vertices). Periodic boundary conditions are used in the $x$ direction. The surface field $h_{\\textnormal{S}}$ acts on spins marked with dark grey, while surface field $h_{\\textnormal{T}}$ acts on spins marked with light grey.}\n\\label{fgr:1}\n\\end{figure}\n\n\\section{Nucleation on a flat surface}\\label{flat}\n\n\\subsection{Classical nucleation theory}\n\nAccording to the classical theory of homogeneous nucleation~\\cite{Debenedetti1996,Oxtoby1992,Sear2007} for a 2D system the free energy needed to form a nucleus of $n$ molecules of the stable phase can be written\n\n", "index": 3, "text": "\\begin{equation}\n\t\\Delta G = - n \\lvert \\Delta \\mu \\rvert + \\gamma C,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"\\Delta G=-n\\lvert\\Delta\\mu\\rvert+\\gamma C,\" display=\"block\"><mrow><mrow><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><mi>G</mi></mrow><mo>=</mo><mrow><mrow><mo>-</mo><mrow><mi>n</mi><mo>\u2062</mo><mrow><mo fence=\"true\" stretchy=\"false\">|</mo><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><mi>\u03bc</mi></mrow><mo fence=\"true\" stretchy=\"false\">|</mo></mrow></mrow></mrow><mo>+</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><mi>C</mi></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05721.tex", "nexttext": "\nThe surface tension $\\gamma$ is given as a function of temperature $T$ by Onsager's exact expression~\\cite{Onsager1944}. The expression (\\ref{CNT}) holds for a noncircular nucleus as well, provided that the surface tension $\\gamma$ is substituted with an ``effective'' surface tension~\\cite{Shneidman1999}.\nThe free energy of the nucleating cluster depends on the reaction coordinate, the nucleus size $n$. In our study $n$ represents the size of the largest cluster consisting of $+1$ spins. We consider a set of $+1$ spins to form a cluster if each spin in the set is a nearest neighbour of at least one other spin.\n\nThe critical nucleus $n^*$ corresponds to the maximum of the free energy barrier $\\Delta G^*$ separating the metastable and stable states. From (\\ref{CNT}) one finds\n\n", "itemtype": "equation", "pos": 10515, "prevtext": "\nwhere $\\Delta \\mu <0$ is the difference between the chemical potentials of the stable and metastable phases under bulk conditions, $\\gamma$ is the macroscopic surface tension between the two phases, and $C$ is the circumference of the growing nucleus.\nFor a circular nucleus of radius $r$, $n = \\rho_{n} \\pi r^2$, and $C= 2r \\pi$, where $\\rho_{n}$ is the number density of the nucleating phase. For the Ising model the chemical potential difference is~\\cite{Ryu2010r} $\\vert \\Delta \\mu \\rvert \\approx 2h$, which gives\n\n", "index": 5, "text": "\\begin{equation}\n\t\\Delta G = - 2h n + 2 \\left ( \\frac{\\pi n}{\\rho_n}  \\right )^{1/2} \\gamma.\n\\label{CNT}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"\\Delta G=-2hn+2\\left(\\frac{\\pi n}{\\rho_{n}}\\right)^{1/2}\\gamma.\" display=\"block\"><mrow><mrow><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><mi>G</mi></mrow><mo>=</mo><mrow><mrow><mo>-</mo><mrow><mn>2</mn><mo>\u2062</mo><mi>h</mi><mo>\u2062</mo><mi>n</mi></mrow></mrow><mo>+</mo><mrow><mn>2</mn><mo>\u2062</mo><msup><mrow><mo>(</mo><mfrac><mrow><mi>\u03c0</mi><mo>\u2062</mo><mi>n</mi></mrow><msub><mi>\u03c1</mi><mi>n</mi></msub></mfrac><mo>)</mo></mrow><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow></msup><mo>\u2062</mo><mi>\u03b3</mi></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05721.tex", "nexttext": "\nNuclei containing fewer than $n^*$ particles shrink spontaneously due to their large circumference to surface ratios, while nuclei larger than $n^*$ tend to spontaneously grow as the bulk free energy contribution dominates. \n\nExtension of the classical theory to the case of heterogeneous nucleation predicts that the interaction of the nucleus with the surface dramatically reduces the free energy barrier for nucleation~\\cite{Debenedetti1996}, resulting in heterogeneous nucleation being dominant over homogeneous nucleation. For the simplest case of a uniform infinite planar surface the classical theory~\\cite{Turnbull1950} envisages that the barrier to heterogeneous nucleation\n$\\Delta G_{\\textnormal{surface}}^{*}$ differs from the homogeneous one by a function solely of the contact angle, $f(\\theta)$:\n\n", "itemtype": "equation", "pos": 11420, "prevtext": "\nThe surface tension $\\gamma$ is given as a function of temperature $T$ by Onsager's exact expression~\\cite{Onsager1944}. The expression (\\ref{CNT}) holds for a noncircular nucleus as well, provided that the surface tension $\\gamma$ is substituted with an ``effective'' surface tension~\\cite{Shneidman1999}.\nThe free energy of the nucleating cluster depends on the reaction coordinate, the nucleus size $n$. In our study $n$ represents the size of the largest cluster consisting of $+1$ spins. We consider a set of $+1$ spins to form a cluster if each spin in the set is a nearest neighbour of at least one other spin.\n\nThe critical nucleus $n^*$ corresponds to the maximum of the free energy barrier $\\Delta G^*$ separating the metastable and stable states. From (\\ref{CNT}) one finds\n\n", "index": 7, "text": "\\begin{equation}\n\tn^* = \\pi \\left ( \\frac{\\gamma}{2h \\rho_{n}^{1/2}} \\right)^2, \\quad \\Delta G^* = \\frac{\\pi \\gamma^2}{2h \\rho_{n}}.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"n^{*}=\\pi\\left(\\frac{\\gamma}{2h\\rho_{n}^{1/2}}\\right)^{2},\\quad\\Delta G^{*}=%&#10;\\frac{\\pi\\gamma^{2}}{2h\\rho_{n}}.\" display=\"block\"><mrow><mrow><mrow><msup><mi>n</mi><mo>*</mo></msup><mo>=</mo><mrow><mi>\u03c0</mi><mo>\u2062</mo><msup><mrow><mo>(</mo><mfrac><mi>\u03b3</mi><mrow><mn>2</mn><mo>\u2062</mo><mi>h</mi><mo>\u2062</mo><msubsup><mi>\u03c1</mi><mi>n</mi><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow></msubsup></mrow></mfrac><mo>)</mo></mrow><mn>2</mn></msup></mrow></mrow><mo rspace=\"12.5pt\">,</mo><mrow><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msup><mi>G</mi><mo>*</mo></msup></mrow><mo>=</mo><mfrac><mrow><mi>\u03c0</mi><mo>\u2062</mo><msup><mi>\u03b3</mi><mn>2</mn></msup></mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>h</mi><mo>\u2062</mo><msub><mi>\u03c1</mi><mi>n</mi></msub></mrow></mfrac></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05721.tex", "nexttext": "\nwhere $0 \\le f(\\theta) \\le 1$, with limits $f(\\theta = 0^{\\circ}) = 0$ and $f(\\theta = 180^{\\circ}) =1$. In the case of a neutral surface the theory predicts $f(\\theta = 90^{\\circ}) = 1/2$. \n\n\\subsection{Umbrella sampling}\n\\label{umbrella}\n\nWe determine the free energy barrier for nucleation using umbrella sampling~\\cite{Torrie1977,Chandler1987}. We perform the Ising model Monte Carlo simulations in the $(N, h, T)$ ensemble, which corresponds to the $(V, \\mu, T)$ ensemble in the lattice gas model. The probability for the formation of sufficiently large clusters (typically $n>20$ in our simulations) can be approximated by the probability to find one such cluster in the system~\\cite{tenWolde1998,Auer2004}, as the simultaneous occurrence of two large clusters is very unlikely. Thus we choose umbrella sampling windows with bias potentials that constrain the size of the largest cluster in a given system configuration. \n\nTo do this a system configuration $x = \\{ s_i \\}_{i=1, 2, \\dots}$ has, in each umbrella window $k$, a potential energy $U_k (x)$ which differs from the \nHamiltonian by a weighting umbrella bias potential $W_k (x)$,\n\n", "itemtype": "equation", "pos": 12378, "prevtext": "\nNuclei containing fewer than $n^*$ particles shrink spontaneously due to their large circumference to surface ratios, while nuclei larger than $n^*$ tend to spontaneously grow as the bulk free energy contribution dominates. \n\nExtension of the classical theory to the case of heterogeneous nucleation predicts that the interaction of the nucleus with the surface dramatically reduces the free energy barrier for nucleation~\\cite{Debenedetti1996}, resulting in heterogeneous nucleation being dominant over homogeneous nucleation. For the simplest case of a uniform infinite planar surface the classical theory~\\cite{Turnbull1950} envisages that the barrier to heterogeneous nucleation\n$\\Delta G_{\\textnormal{surface}}^{*}$ differs from the homogeneous one by a function solely of the contact angle, $f(\\theta)$:\n\n", "index": 9, "text": "\\begin{equation}\n\t\\Delta G_{\\textnormal{surface}}^{*} = \\Delta G^{*} f(\\theta),\n\\label{hetnuc}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"\\Delta G_{\\textnormal{surface}}^{*}=\\Delta G^{*}f(\\theta),\" display=\"block\"><mrow><mrow><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msubsup><mi>G</mi><mtext>surface</mtext><mo>*</mo></msubsup></mrow><mo>=</mo><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msup><mi>G</mi><mo>*</mo></msup><mo>\u2062</mo><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05721.tex", "nexttext": "\nThis bias potential is chosen to be a harmonic function of the size of the largest $+1$ spin cluster $n(x)$ in the given configuration,\n\n", "itemtype": "equation", "pos": 13632, "prevtext": "\nwhere $0 \\le f(\\theta) \\le 1$, with limits $f(\\theta = 0^{\\circ}) = 0$ and $f(\\theta = 180^{\\circ}) =1$. In the case of a neutral surface the theory predicts $f(\\theta = 90^{\\circ}) = 1/2$. \n\n\\subsection{Umbrella sampling}\n\\label{umbrella}\n\nWe determine the free energy barrier for nucleation using umbrella sampling~\\cite{Torrie1977,Chandler1987}. We perform the Ising model Monte Carlo simulations in the $(N, h, T)$ ensemble, which corresponds to the $(V, \\mu, T)$ ensemble in the lattice gas model. The probability for the formation of sufficiently large clusters (typically $n>20$ in our simulations) can be approximated by the probability to find one such cluster in the system~\\cite{tenWolde1998,Auer2004}, as the simultaneous occurrence of two large clusters is very unlikely. Thus we choose umbrella sampling windows with bias potentials that constrain the size of the largest cluster in a given system configuration. \n\nTo do this a system configuration $x = \\{ s_i \\}_{i=1, 2, \\dots}$ has, in each umbrella window $k$, a potential energy $U_k (x)$ which differs from the \nHamiltonian by a weighting umbrella bias potential $W_k (x)$,\n\n", "index": 11, "text": "\\begin{equation}\n\tU_k (x) = \\mathcal{H}(x) + W_k (x).\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"U_{k}(x)=\\mathcal{H}(x)+W_{k}(x).\" display=\"block\"><mrow><mrow><mrow><msub><mi>U</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi class=\"ltx_font_mathcaligraphic\">\u210b</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><msub><mi>W</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05721.tex", "nexttext": "\nThe harmonic constant $\\kappa$ is set to the same value, $\\kappa = 0.2$, in all windows, and the minimum $n_k$ determines which cluster sizes are sampled preferentially in each umbrella window $k$. Thus the Monte Carlo simulation is split into a number of smaller simulations with overlapping umbrella windows. \n\nTo implement the umbrella sampling we start the system in the first umbrella potential centred about $n_1 = 0$. After equilibrating in the potential $U_1(x)$ for $5\\times 10^4$ time steps, we sample the equilibrated system for $5\\times 10^5$ time steps and record the size of the largest cluster $n$ at each step. We follow Ref. [\\onlinecite{Auer2004}] by performing Metropolis MC moves according to the Hamiltonian $\\mathcal{H}(x)$, and then additionally deciding whether to accept or reject all these moves according to the pure biasing potential $W_k(x)$ after every 5 MC sweeps. The minimum of the bias potential is then incremented and the whole procedure is repeated for the next\numbrella window. The chosen sequence of bias potential minima is $n_k = 0, 5, 10 \\dots$ up to sizes significantly greater than the critical cluster size.\n\nWe use the multi-state Bennet acceptance ratio method of Shirts and Chodera~\\cite{Chodera2008} to estimate the free energies $G_k (T,h)$ corresponding to the potential $U_k$ in the umbrella window $k$. The method allows one to calculate the ensemble average of any observable $A(x)$ with respect to the Hamiltonian $\\mathcal{H}(x)$. We divide the space of cluster sizes $n$ into bins. The probability\nfor the formation of a cluster of size $n$ falling into $i$-th bin is given by the expectation with respect to $\\mathcal{H}(x)$,\n\n", "itemtype": "equation", "pos": 13837, "prevtext": "\nThis bias potential is chosen to be a harmonic function of the size of the largest $+1$ spin cluster $n(x)$ in the given configuration,\n\n", "index": 13, "text": "\\begin{equation}\n\tW_k [n(x)] = \\frac{1}{2} \\kappa [ n(x) - n_k]^2.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"W_{k}[n(x)]=\\frac{1}{2}\\kappa[n(x)-n_{k}]^{2}.\" display=\"block\"><mrow><mrow><mrow><msub><mi>W</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mi>n</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>\u2062</mo><mi>\u03ba</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">[</mo><mrow><mrow><mi>n</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><msub><mi>n</mi><mi>k</mi></msub></mrow><mo stretchy=\"false\">]</mo></mrow><mn>2</mn></msup></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05721.tex", "nexttext": " \nwhere $\\chi_i [n(x)]$ is an indicator function that takes the value of 1 if the size of the largest cluster $n(x)$ in configuration $x$ falls into bin $i$, and is zero otherwise. The free energy $\\Delta G(n)$ for the formation of a cluster of size $n$ can then be computed (up to an irrelevant additive constant) from the probability $p(n)$ that the largest cluster has size $n$:\n\n", "itemtype": "equation", "pos": -1, "prevtext": "\nThe harmonic constant $\\kappa$ is set to the same value, $\\kappa = 0.2$, in all windows, and the minimum $n_k$ determines which cluster sizes are sampled preferentially in each umbrella window $k$. Thus the Monte Carlo simulation is split into a number of smaller simulations with overlapping umbrella windows. \n\nTo implement the umbrella sampling we start the system in the first umbrella potential centred about $n_1 = 0$. After equilibrating in the potential $U_1(x)$ for $5\\times 10^4$ time steps, we sample the equilibrated system for $5\\times 10^5$ time steps and record the size of the largest cluster $n$ at each step. We follow Ref. [\\onlinecite{Auer2004}] by performing Metropolis MC moves according to the Hamiltonian $\\mathcal{H}(x)$, and then additionally deciding whether to accept or reject all these moves according to the pure biasing potential $W_k(x)$ after every 5 MC sweeps. The minimum of the bias potential is then incremented and the whole procedure is repeated for the next\numbrella window. The chosen sequence of bias potential minima is $n_k = 0, 5, 10 \\dots$ up to sizes significantly greater than the critical cluster size.\n\nWe use the multi-state Bennet acceptance ratio method of Shirts and Chodera~\\cite{Chodera2008} to estimate the free energies $G_k (T,h)$ corresponding to the potential $U_k$ in the umbrella window $k$. The method allows one to calculate the ensemble average of any observable $A(x)$ with respect to the Hamiltonian $\\mathcal{H}(x)$. We divide the space of cluster sizes $n$ into bins. The probability\nfor the formation of a cluster of size $n$ falling into $i$-th bin is given by the expectation with respect to $\\mathcal{H}(x)$,\n\n", "index": 15, "text": "\\begin{equation}\n\tp_i= \\langle \\chi_i [n(x)] \\rangle ,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m1\" class=\"ltx_Math\" alttext=\"p_{i}=\\langle\\chi_{i}[n(x)]\\rangle,\" display=\"block\"><mrow><mrow><msub><mi>p</mi><mi>i</mi></msub><mo>=</mo><mrow><mo stretchy=\"false\">\u27e8</mo><mrow><msub><mi>\u03c7</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mi>n</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mo stretchy=\"false\">\u27e9</mo></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05721.tex", "nexttext": "\nWe set the unknown additive constant by requiring that $\\Delta G = 0$ in the first bin.\n\\begin{figure}[h]\n\\centering\n  \\includegraphics[width=8.6cm]{figure2}\n  \\caption{Free energy barriers for homogeneous and heterogeneous nucleation for $T=1.25J/k_{\\textnormal{B}}$ and $h=J/16$. Free energy curves for $h_{\\textnormal{S}} \\le -0.8J$ practically coincide with the homogeneous free energy curve (red).}\n  \\label{fgr:2}\n\\end{figure}\n\nOur umbrella sampling results for homogeneous nucleation and for heterogeneous nucleation on a flat surface are shown in Fig.~\\ref{fgr:2}. In all simulations $T=1.25J/k_{\\textnormal{B}}$ and $h=J/16$. The barrier for homogeneous nucleation is shown in red. Its height is $\\beta \\Delta G_{\\textnormal{bulk}}^{*} = 45.52 \\pm 0.27$ (here $\\beta = 1/ k_{\\textnormal{B}}T$), while the size of the critical nucleus is $n_{\\textnormal{bulk}}^{*} \\approx 515$. Here we do not attempt to fit the homogeneous nucleation free energy curve obtained in simulations to the classical theory. This is because it was shown in Ref. [\\onlinecite{Ryu2010r}] that, for the 2D Ising model, the expression (\\ref{CNT}) should be corrected to include an additional term which accounts for the shape fluctuations of the clusters to obtain a satisfactory match between the simulations and theory. \n\nWe varied the surface field $h_{\\textnormal{S}}$  from the value $h_{\\textnormal{S}} = 0$ to a negative value $h_{\\textnormal{S}} = -J$. The results for a neutral surface $(h_{\\textnormal{S}} = 0)$ are shown in black. The barrier height is $\\beta \\Delta G_{\\textnormal{neutral}}^{*} = 21.55 \\pm 0.14$ and the size of the critical nucleus is $n_{\\textnormal{neutral}}^{*} \\approx 235$.\nThis case corresponds~\\cite{Winter2009} to a contact angle of $90^{\\circ}$ and, according to (\\ref{hetnuc}), $\\Delta G_{\\textnormal{neutral}}^{*} = \\Delta G_{\\textnormal{bulk}}^{*}/2$.\nIn our simulations $\\Delta G_{\\textnormal{bulk}}^{*}/ \\Delta G_{\\textnormal{neutral}}^{*} = 2.1$, which is in surprisingly good agreement with (\\ref{hetnuc}), given its simple nature. As the surface field $h_{\\textnormal{S}}$ is decreased, the barriers for nucleation become higher, until they eventually reach the barrier for homogeneous nucleation for $h_{\\textnormal{S}} \\approx -0.8J$ where the energies for flipping a spin at the surface and in the bulk become equal. Further decrease of the field $h_{\\textnormal{S}}$ does not alter the nucleation barrier, as the nucleation no longer occurs on the surface, but rather occurs in the bulk. In the opposite case, when the surface field is increased above the value $h_{\\textnormal{S}} = 0$, the nucleation barriers become lower than the barrier shown in black in Fig.~\\ref{fgr:2}, and eventually become negligible (not shown in the figure). \n\n\\subsection{Transition path sampling}\n\nWe use transition path sampling (TPS)~\\cite{Dellago2001,Bolhuis2002,Bolhuis2010} to determine the contact angles $\\theta$ corresponding to the surface fields shown in Fig.~\\ref{fgr:2}. TPS also provides an independent check on our estimates for the sizes of the critical nuclei. This method utilises a Monte Carlo walk in the space of reactive trajectories, connecting the metastable spin-down state and the nucleating spin-up state, to sample multiple examples of rare nucleation events. \nWe use the size of the largest $+1$ spin cluster $n(x)$ in the system configuration $x$ as the order parameter, which discriminates between the initial and product states. Further, we define the TPS characteristic functions~\\cite{Dellago2001,Bolhuis2002,Bolhuis2010} $h_{\\downarrow}(x)$ and $h_{\\uparrow}(x)$, which indicate whether a configuration $x$ is in the spin-down and spin-up state, respectively:\n\n", "itemtype": "equation", "pos": 16054, "prevtext": " \nwhere $\\chi_i [n(x)]$ is an indicator function that takes the value of 1 if the size of the largest cluster $n(x)$ in configuration $x$ falls into bin $i$, and is zero otherwise. The free energy $\\Delta G(n)$ for the formation of a cluster of size $n$ can then be computed (up to an irrelevant additive constant) from the probability $p(n)$ that the largest cluster has size $n$:\n\n", "index": 17, "text": "\\begin{equation}\n\t\\Delta G(n) = - k_{\\textnormal{B}} T \\ln [p(n)].\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m1\" class=\"ltx_Math\" alttext=\"\\Delta G(n)=-k_{\\textnormal{B}}T\\ln[p(n)].\" display=\"block\"><mrow><mrow><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><mi>G</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo>-</mo><mrow><msub><mi>k</mi><mtext>B</mtext></msub><mo>\u2062</mo><mi>T</mi><mo>\u2062</mo><mrow><mi>ln</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mi>p</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05721.tex", "nexttext": "\nwhere $n_{\\downarrow}$ and $n_{\\uparrow}$ are the largest cluster size limits chosen to define the spin-down and spin-up states. In our TPS simulations we choose $n_{\\downarrow}=20$ and $n_{\\uparrow} = 600$ or $700$ (see Table \\ref{tbl:1}) such that the initial state and product state basins do not overlap, and are both far enough from the transition state region found in the umbrella sampling simulations described in Section \\ref{umbrella} (Fig.~\\ref{fgr:2}). \\\\\n\nWith our choice of $T$ and $h$ we are in a regime where a nucleation event is very rare, making it extremely difficult to sample even one such event with brute force simulations. Thus we constructed the initial trajectory for TPS by taking an umbrella sampling configuration with $n = n^{*}$ and generating trajectories, with both forward and backward propagation using the underlying dynamics of the system, until a trajectory was found connecting the initial and nucleating states. \n\nTrajectories of 900 time units in length are sampled using the TPS shooting method~\\cite{Bolhuis2010}. This trajectory length turned out to be long enough to harvest a sufficiently large number of transition states (critical clusters).\n\nThe TPS shooting move consists of choosing a random configuration $x_{\\textnormal{r}}$ on the current  trajectory and choosing randomly to evolve the system either forwards or backwards. The new trajectory is then constructed by replacing the relevant part of the current path by the newly generated configurations. The updated trajectory is accepted if it connects the spin-down and spin-up states specified by functions (\\ref{regions}).\nThe initial trajectory, constructed with the help of umbrella sampling data, may be unphysical, so we first equilibrate it with 2500 shooting moves, and then harvest about 60 independent trajectories, one every 50 accepted shooting moves. \n\\begin{figure}[h]\n\\centering\n  \\includegraphics[width=8.6cm]{figure3}\n  \\caption{Committors for the case $h_{\\textnormal{S}}= -0.3$: $p_{\\downarrow}(n)$ -- blue line; $p_{\\uparrow}(n)$ -- red line; and their sum -- black line. Fleeting trajectory lengths are $t_{\\textnormal{s}} = 1800$ MC sweeps.}\n  \\label{fgr:3}\n\\end{figure}\n\nWe use the sampled ensemble of accepted trajectories to calculate the committors~\\cite{Dellago2001,Bolhuis2002,Bolhuis2010} $p_{\\downarrow}(n,t_{\\textnormal{s}})$ and $p_{\\uparrow}(n,t_{\\textnormal{s}})$ for the spin-down and spin-up states, respectively. The committor $p_{\\uparrow (\\downarrow)}(n,t_{\\textnormal{s}})$ is the probability that a system with initial configuration with a nucleus of size $n$ will reside in the spin-up (spin-down) state at time $t_{\\textnormal{s}}$.\nFrom each point of the sampled accepted trajectories we run 50 fleeting trajectories of length $t_{\\textnormal{s}} = 1800$ time units. The spin-down and spin-up committors are then determined as the fraction of fleeting trajectories that end in the spin-down and spin-up regions respectively for each $n$. Our results for $h_{\\textnormal{S}} = -0.3$ are shown in Fig.~\\ref{fgr:3}. The committor graphs are qualitatively similar for all values of $h_{\\textnormal{S}}$.\nIn general, not all fleeting trajectories end in spin-down or spin-up states; some of them might end in the region between these states. However, the fact that $p_{\\downarrow}(n,t_{\\textnormal{s}}) + p_{\\uparrow}(n,t_{\\textnormal{s}}) \\approx 1$ for all $n$ in our simulations shows that the chosen fleeting trajectory length $t_{\\textnormal{s}}$ is long enough to correctly sample the transition states. The transition region is defined as that consisting of states $n^{*}$ that are equally accessible, meaning $p_{\\downarrow}(n^{*}) \\approx p_{\\uparrow}(n^{*})$. The results we obtain for $n^{*}$ are in good agreement with the corresponding umbrella sampling $n^{*}$ values for all surface fields $h_{\\textnormal{S}}$.\n\nA more general procedure would be to determine committors $p_{\\downarrow}(x,t_{\\textnormal{s}})$ and $p_{\\uparrow}(x,t_{\\textnormal{s}})$ for all system configurations $x$. However this would present an extraordinary computational challenge. Fortunately, for our needs it is enough to examine only the configurations $x$ of the ensemble of accepted trajectories connecting the spin-down and spin-up states. \nWe follow the procedure described in Ref. [\\onlinecite{Dellago2001}] to determine members of the transition state ensemble (TSE). TSE consists of states $x$ such that half of the fleeting trajectories initiated from $x$ end in spin-down state, and the other half end in spin-up state.\n\\begin{figure}[h]\n\\centering\n  \\includegraphics[height=5cm]{figure4}\n  \\caption{A typical member of TSE for the case $h_{\\textnormal{S}} = -0.5J$. The lattice size is $60 \\times 60$ and the surface is located at the bottom. The -1 spins are blue, and the +1 spins are red.}\n  \\label{fgr:4}\n\\end{figure}\n\nFor each slice $x$ of all sampled trajectories connecting the spin-down and spin-up states, we first generate 10 fleeting trajectories starting from $x$, and determine $p_{\\uparrow}(x,t_{\\textnormal{s}})$ from the fraction of paths that end in the spin-up state. Since in this approach we are dealing with the same configurations $x$ as in the above committor $p_{\\uparrow (\\downarrow)}(n,t_{\\textnormal{s}})$ analysis, we take the same fleeting trajectory length $t_{\\textnormal{s}}=1800$ time units to ensure $p_{\\uparrow}(x,t_{\\textnormal{s}}) + p_{\\downarrow}(x,t_{\\textnormal{s}}) \\approx 1$.\nThe configuration $x$ is rejected as a member of the TSE if the calculated $p_{\\uparrow}$ falls outside the $95\\%$ confidence interval around $p_{\\uparrow} = 0.5$. Otherwise more fleeting trajectories are generated until either $p_{\\uparrow}$ falls outside this confidence interval, or an upper limit of 50 fleeting trajectories is reached. If former is the case, the configuration is rejected, otherwise it is accepted as a member of the TSE. From the trajectories connecting spin-down and spin-up states harvested with TPS, we typically found between 2000 and 3000 TSE members for each value of the surface field $h_{\\textnormal{S}}$. A typical critical nucleus taken from the TSE has a rough interface and is anisotropic (see Fig.~\\ref{fgr:4}). \n\\begin{table}[h]\n\\small\n  \\caption{Surface fields $h_{\\textnormal{S}}$ and the corresponding choices of limits for the spin-down state $n_{\\downarrow}$ and spin-up state $n_{\\uparrow}$.\n   Also shown is a comparison between the critical cluster sizes $n^*$ obtained with TSE analysis and umbrella sampling (US).}\n  \\label{tbl:example}\n  \\begin{tabular*}{0.5\\textwidth}{@{\\extracolsep{\\fill}} c  c  c  c  c}\n    \\hline\n    $h_{\\textnormal{S}}$ & $n_{\\downarrow}$ & $n_{\\uparrow}$ & TSE $\\, n^{*}$ & US $\\, n^{*}$\\\\\n    \\hline\n    -0.1J & 20 & 600 & 288 & 285\\\\\n    -0.2J & 20 & 600 & 324 & 325\\\\\n    -0.3J & 20 & 600 & 357 & 355\\\\\n    -0.4J & 20 & 700 & 395 & 405\\\\\n    -0.5J & 20 & 700 & 430 & 415\\\\\n    -0.6J & 20 & 700 & 454 & 445\\\\\n    \\hline\n  \\end{tabular*}\n  \\label{tbl:1}\n\\end{table}\n\nFor all  configurations $x$ in the TSE we can calculate the size of largest cluster $n(x)$, and hence determine its distribution. The average value of this distribution is then taken to be the size of the critical cluster $n^{*}$. Table \\ref{tbl:1} shows that the TSE results are in good agreement with the corresponding values of $n^{*}$ obtained using umbrella sampling.\n\n\\subsection{Contact angles}\n\nWe use TPS to estimate the contact angle of a growing nucleus with the surface for different surface fields $h_{\\textnormal{S}}$. In these simulations we set $n_{\\downarrow} = 20$ and $n_{\\uparrow}=1000$ and sample reactive trajectories of 1000 time units in length for surface fields $h_{\\textnormal{S}} \\ge -0.3 J$, and 1200 time units for surface fields $h_{\\textnormal{S}} \\le -0.4J$. We relax the initial trajectory with 25000 shooting moves, and then sample 2500 independent trajectories, one every 100 accepted shooting moves. In this calculation we are able to analyse more sampled trajectories than in the TSE simulations, because the latter require additional shooting of fleeting trajectories which is computationally very costly. \n\\begin{figure}[h]\n\\centering\n  \\includegraphics[height=6.5cm]{figure5}\n  \\caption{The shape of the circular segment can be conveniently characterised by two components of the gyration radius with respect to the coordinate system $xOy$ (with $O$ being the centre of mass). They can be calculated explicitly and expressed in terms of the angle $\\theta$ and say, the radius $R$. Thus, the ratio of the squared components of the gyration radius depends only on $\\theta$ as given by expression (\\ref{gratio}).}\n  \\label{fgr:5}\n\\end{figure}\n\nTo determine the average contact angle $\\theta_n$ of nuclei of size $n$ we proceed as follows. It is expected, on symmetry grounds, that the average cluster has the shape of a circular segment, such as that presented in Fig.~\\ref{fgr:5}. \nThe shape of a cluster of size $n$ can be characterised by the components $R_{\\textnormal{g},x}$ and $R_{\\textnormal{g},y}$ of the gyration radius, $R_{\\textnormal{g}}^2 = R_{\\textnormal{g},x}^2 + R_{\\textnormal{g},y}^2$, with\n\n", "itemtype": "equation", "pos": 19844, "prevtext": "\nWe set the unknown additive constant by requiring that $\\Delta G = 0$ in the first bin.\n\\begin{figure}[h]\n\\centering\n  \\includegraphics[width=8.6cm]{figure2}\n  \\caption{Free energy barriers for homogeneous and heterogeneous nucleation for $T=1.25J/k_{\\textnormal{B}}$ and $h=J/16$. Free energy curves for $h_{\\textnormal{S}} \\le -0.8J$ practically coincide with the homogeneous free energy curve (red).}\n  \\label{fgr:2}\n\\end{figure}\n\nOur umbrella sampling results for homogeneous nucleation and for heterogeneous nucleation on a flat surface are shown in Fig.~\\ref{fgr:2}. In all simulations $T=1.25J/k_{\\textnormal{B}}$ and $h=J/16$. The barrier for homogeneous nucleation is shown in red. Its height is $\\beta \\Delta G_{\\textnormal{bulk}}^{*} = 45.52 \\pm 0.27$ (here $\\beta = 1/ k_{\\textnormal{B}}T$), while the size of the critical nucleus is $n_{\\textnormal{bulk}}^{*} \\approx 515$. Here we do not attempt to fit the homogeneous nucleation free energy curve obtained in simulations to the classical theory. This is because it was shown in Ref. [\\onlinecite{Ryu2010r}] that, for the 2D Ising model, the expression (\\ref{CNT}) should be corrected to include an additional term which accounts for the shape fluctuations of the clusters to obtain a satisfactory match between the simulations and theory. \n\nWe varied the surface field $h_{\\textnormal{S}}$  from the value $h_{\\textnormal{S}} = 0$ to a negative value $h_{\\textnormal{S}} = -J$. The results for a neutral surface $(h_{\\textnormal{S}} = 0)$ are shown in black. The barrier height is $\\beta \\Delta G_{\\textnormal{neutral}}^{*} = 21.55 \\pm 0.14$ and the size of the critical nucleus is $n_{\\textnormal{neutral}}^{*} \\approx 235$.\nThis case corresponds~\\cite{Winter2009} to a contact angle of $90^{\\circ}$ and, according to (\\ref{hetnuc}), $\\Delta G_{\\textnormal{neutral}}^{*} = \\Delta G_{\\textnormal{bulk}}^{*}/2$.\nIn our simulations $\\Delta G_{\\textnormal{bulk}}^{*}/ \\Delta G_{\\textnormal{neutral}}^{*} = 2.1$, which is in surprisingly good agreement with (\\ref{hetnuc}), given its simple nature. As the surface field $h_{\\textnormal{S}}$ is decreased, the barriers for nucleation become higher, until they eventually reach the barrier for homogeneous nucleation for $h_{\\textnormal{S}} \\approx -0.8J$ where the energies for flipping a spin at the surface and in the bulk become equal. Further decrease of the field $h_{\\textnormal{S}}$ does not alter the nucleation barrier, as the nucleation no longer occurs on the surface, but rather occurs in the bulk. In the opposite case, when the surface field is increased above the value $h_{\\textnormal{S}} = 0$, the nucleation barriers become lower than the barrier shown in black in Fig.~\\ref{fgr:2}, and eventually become negligible (not shown in the figure). \n\n\\subsection{Transition path sampling}\n\nWe use transition path sampling (TPS)~\\cite{Dellago2001,Bolhuis2002,Bolhuis2010} to determine the contact angles $\\theta$ corresponding to the surface fields shown in Fig.~\\ref{fgr:2}. TPS also provides an independent check on our estimates for the sizes of the critical nuclei. This method utilises a Monte Carlo walk in the space of reactive trajectories, connecting the metastable spin-down state and the nucleating spin-up state, to sample multiple examples of rare nucleation events. \nWe use the size of the largest $+1$ spin cluster $n(x)$ in the system configuration $x$ as the order parameter, which discriminates between the initial and product states. Further, we define the TPS characteristic functions~\\cite{Dellago2001,Bolhuis2002,Bolhuis2010} $h_{\\downarrow}(x)$ and $h_{\\uparrow}(x)$, which indicate whether a configuration $x$ is in the spin-down and spin-up state, respectively:\n\n", "index": 19, "text": "\\begin{equation}\n\th_{\\downarrow}(x) = \\begin{cases} \n      1, & n(x) < n_{\\downarrow} \\\\\n      0, & n(x) \\ge n_{\\downarrow} \\\\\n   \\end{cases}, \\quad\n         h_{\\uparrow}(x) = \\begin{cases} \n      0, & n(x) \\le n_{\\uparrow} \\\\\n      1, & n(x) > n_{\\uparrow} \\\\\n   \\end{cases},\n   \\label{regions}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E10.m1\" class=\"ltx_Math\" alttext=\"h_{\\downarrow}(x)=\\begin{cases}1,&amp;n(x)&lt;n_{\\downarrow}\\\\&#10;0,&amp;n(x)\\geq n_{\\downarrow}\\\\&#10;\\end{cases},\\quad h_{\\uparrow}(x)=\\begin{cases}0,&amp;n(x)\\leq n_{\\uparrow}\\\\&#10;1,&amp;n(x)&gt;n_{\\uparrow}\\\\&#10;\\end{cases},\" display=\"block\"><mrow><mrow><mrow><mrow><msub><mi>h</mi><mo>\u2193</mo></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo>{</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><mn>1</mn><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mi>n</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>&lt;</mo><msub><mi>n</mi><mo>\u2193</mo></msub></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mrow><mn>0</mn><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mi>n</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2265</mo><msub><mi>n</mi><mo>\u2193</mo></msub></mrow></mtd></mtr></mtable></mrow></mrow><mo rspace=\"12.5pt\">,</mo><mrow><mrow><msub><mi>h</mi><mo>\u2191</mo></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo>{</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><mn>0</mn><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mi>n</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2264</mo><msub><mi>n</mi><mo>\u2191</mo></msub></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mrow><mn>1</mn><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mi>n</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>&gt;</mo><msub><mi>n</mi><mo>\u2191</mo></msub></mrow></mtd></mtr></mtable></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05721.tex", "nexttext": "\nwhere $x_j$ and $y_j$ are the coordinates of $j$-th spin in the cluster $n$, and $x_{\\textnormal{c}}$ and $y_{\\textnormal{c}}$ are the coordinates of its centre of mass. The mean values of these quantities, $\\langle R_{\\textnormal{g},x}^2 \\rangle$ and $\\langle R_{\\textnormal{g},y}^2 \\rangle$, obtained by averaging over many different realisations of clusters of given size $n$, can be approximated with the squared components of the gyration radius of a homogeneous circular segment having a `mass' $n$. Since the ratio of the latter components can be calculated directly, we can write\n\\begin{eqnarray}\n\t\\frac{ \\langle R_{\\textnormal{g},y}^2 \\rangle}{\\langle R_{\\textnormal{g},x}^2 \\rangle} \\left [ 1 - \\frac{2 \\cos \\theta_n \\sin^3{\\theta_n}}{3(\\theta_n - \\cos \\theta_n \\sin \\theta_n)} \\right ] =  \\nonumber \\\\\n\t  1 - \\frac{16 \\sin^6{\\theta_n}}{9(\\theta_n - \\cos \\theta_n \\sin \\theta_n)^2} + \\frac{2 \\cos \\theta_n \\sin^3{\\theta_n}}{\\theta_n - \\cos \\theta_n \\sin \\theta_n},\n\\label{gratio}\n\\end{eqnarray}\nwhere $\\theta_n$ is the average contact angle of clusters of size $n$. \nThis expression allows us to determine $\\theta_n$ as a function of the ratio $\\langle R_{\\textnormal{g},y}^2 \\rangle /  \\langle R_{\\textnormal{g},x}^2 \\rangle$ measured in simulations.\n\\begin{figure}[h]\n\\centering\n  \\includegraphics[width=8.6cm]{figure6}\n  \\caption{Average contact angle $\\theta_n$ as a function of cluster size $n$ for various surface fields $h_{\\textnormal{S}}$.}\n  \\label{fgr:6}\n\\end{figure}\n\nThe change of contact angle with cluster size for various surface fields $h_{\\textnormal{S}}$ is shown in Fig.~\\ref{fgr:6}. While for small cluster sizes the angle changes rapidly, it saturates for larger cluster sizes and converges towards a value which depends on the surface field $h_{\\textnormal{S}}$.\nNote that, for neutral surfaces, $h_{\\textnormal{S}} = 0$, one indeed gets a contact angle of $90^{\\circ}$ as predicted~\\cite{Winter2009}. As the surface field decreases, the contact angle increases, reaching a value of approximately $120^{\\circ}$ for $h_{\\textnormal{S}} = - 0.5J$. For even smaller surface fields $h_{\\textnormal{S}}$, it turns out to be difficult to measure the contact angles, because the sampled reactive trajectories connecting the spin-down and spin-up phase do not always exhibit nucleation on the surface -- a significant number of trajectories follows a homogeneous nucleation pathway in the bulk. \n\n\\section{Nucleation from neutral pores}\\label{neutral}\n\nBefore considering nucleation from hydrophobic pores, it is helpful to briefly examine the case of neutral pores, $h_{\\textnormal{S}} =0$. Nucleation in neutral pores was investigated by Page and Sear~\\cite{Page2006}, who found that it often occurs as a two-step process. The first of two activated processes is nucleation in the pore, followed by nucleation out of the filled pore. The authors calculated\nthe two nucleation rates using a forward flux sampling method~\\cite{Allen2006,Allen2009}. They found that the nucleation rate in a pore increases with decreasing pore width, while the nucleation rate out of the filled pore grows with increasing pore width.\n\nWe keep the same values of $T$ and $h$ as in Section \\ref{flat}, and choose the pore depth $d=30$ (Fig.~\\ref{fgr:1}). \nWe use umbrella sampling to calculate the free energy barriers for nucleation for various pore widths, and compare our results with the findings of Ref.  [\\onlinecite{Page2006}]. An example of the dependence of the free energy profile on the cluster size $n$ for two-step nucleation, obtained for $w=10$, is shown in Fig.~\\ref{fgr:7}. The nucleation always starts in one of the bottom corners of the pore. From a corner a small nucleus grows until it reaches some critical size, which corresponds to the left maximum of $\\Delta G$ in Fig.~\\ref{fgr:7}. The nucleus then proceeds to grow without any free energy cost until the whole pore is filled with +1 spins. Note that there is a minimum in the free energy at $n \\approx 300$ which is equal to $d \\times w$. Once the pore is full, there is a second barrier against nucleation of the spin-up phase outside the pore indicated by the right maximum of $\\Delta G$ in Fig.~\\ref{fgr:7}.\n\\begin{figure}[h]\n\\centering\n  \\includegraphics[width=8.6cm]{figure7}\n  \\caption{Free energy profile as a function of nucleus size $n$ for a neutral pore ($h_{\\textnormal{S}}=0$) of size $d=30$, $w=10$.}\n  \\label{fgr:7}\n\\end{figure}\n\nHowever, the nucleation need not always occur via two steps. Nucleation barrier heights for nucleation in the pore and out of the filled pore for a range of pore widths $w$ are shown in Fig.~\\ref{fgr:8}. The blue curve shows that the nucleation barrier in a pore is negligibly small for small pore widths, but grows and eventually saturates with the increase of $w$. This is because the nucleation always starts in one of the bottom corners and, for small pore widths, the nucleus feels the presence of the other corner, which speeds up the nucleation, whereas for wider pores the corners act independently.\nThis result is in a good qualitative agreement with the findings of Ref. [\\onlinecite{Page2006}], because the increase of barrier heights manifests itself as a decrease of nucleation rates in the pore.\n\nLooking at the barriers for nucleation outside a filled pore (red curve in Fig.~\\ref{fgr:8}), one observes that for small $w$ the barrier height approaches that for nucleation on a flat surface. With the increase of pore width the barrier heights decrease until they eventually become negligibly small. Again, this agrees well with the results of Page and Sear~\\cite{Page2006}, who found that the rates for nucleation out of a filled pore grow with $w$.\nIn addition, these authors found that there is a maximum in the overall nucleation rate from the pore for $w=12$, which is the point where the nucleation rates in the pore and out of the filled pore are approximately equal. In our umbrella sampling simulations the two barriers are found to be the same at $w=11$. The small discrepancy is most likely due to other (subdominant) factors affecting the nucleation rates~\\cite{Debenedetti1996}. \n\\begin{figure}[h]\n\\centering\n  \\includegraphics[width=8.6cm]{figure8}\n  \\caption{Nucleation barrier heights for nucleation in (blue) and out (red) of the neutral pores as a function of $w$; pore depth is $d=30$. The nucleation barrier height for a neutral flat surface is marked with a black point.}\n  \\label{fgr:8}\n\\end{figure}\n\n\\section{Nucleation from hydrophobic pores}\\label{hydrophobic}\n\nHaving verified that our method works well for neutral pores, we move to the case of hydrophobic pores, which have walls with surface fields $h_{\\textnormal{S}}<0$. In what follows, we keep the same values of $T$, $h$ and $d$, and choose $h_{\\textnormal{S}} = -0.5J$, which corresponds to nuclei with a contact angle of $\\theta \\approx 120^{\\circ}$ on a flat surface (see Fig.~\\ref{fgr:6}).\nWe apply umbrella sampling to calculate free energy barriers for nucleation for various pore widths $w$. We find that there are three different dynamical pathways to nucleation, which are realised for three different $w$ intervals. \n\nThe simplest nucleation pathway is found for $w \\le 5$. In this case small pre-critical nuclei grow and shrink both in the pore and on the surface outside the pore, but eventually the critical nucleus is formed on the surface outside the empty pore.\nThis nucleation pathway has already been observed~\\cite{Hedges2012} in simulations of 3D pores.\nAs expected, the free energy barrier for nucleation looks very similar to that on a flat surface: A comparison for $w=5$ is shown in Fig.~\\ref{fgr:9}.\nAlthough the vast majority of critical nuclei are formed on the surface outside the pore (Fig.~\\ref{fgr:10}a), one occasionally finds a nucleus spanning the pore (Fig.~\\ref{fgr:10}b). \n\\begin{figure}[h]\n\\centering\n  \\includegraphics[width=8.6cm]{figure9}\n  \\caption{Free energy barrier for nucleation on a flat surface (black), and in a pore of size $d=30$, $w=5$ (red). In both cases $h_{\\textnormal{S}}= -0.5J$.}\n  \\label{fgr:9}\n\\end{figure}\n\\begin{figure}[h]\n\\centering\n  \\includegraphics[width=7.4cm]{figure10}\n  \\caption{Typical examples of critical nuclei for the pore of size $d=30$, $w=5$: (a) nucleus on the surface outside the pore, (b) nucleus spanning the pore.}\n  \\label{fgr:10}\n\\end{figure}\n\nThe most interesting behaviour emerges in the range of pore widths $6 \\le w \\le 16$. Typical free energy barriers are shown in Fig.~\\ref{fgr:11}. The nucleation mechanism for $w=6$ (blue curve) significantly differs from that encountered for widths $w \\le 5$. A pre-critical nucleus starts to appear in one of the bottom corners of the pore. The nucleus continues to grow and eventually the whole pore is filled with +1 spins. However, on this growth pathway the nucleus does not attain a critical value, which manifests itself as the absence of a maximum in the free energy in the region of cluster sizes between $n=0$ and $n= 30 \\times 6 = 180$. The full pore state, $n= 180$ corresponds to the left dashed vertical line in Fig.~\\ref{fgr:11}. At this point there is a noticeable change in the slope of the free energy curve. The nucleus then starts to grow outside the filled pore and does so until it reaches $n \\approx195$ (marked with the right dashed vertical line). Inspection of the cluster configurations shows that at this point the nucleus is expelled from the pore and ends up spanning the pore (Fig.~\\ref{fgr:10}b); during the ejection the cluster size remains approximately unchanged. Thus the pre-critical nucleus exhibits a pore emptying transition. The pre-critical nucleus then continues to grow outside the pore, following the free energy curve for nucleation on a flat surface, and reaching the maximum of the free energy curve corresponding to its critical size at $n \\approx450$. This dynamical pathway is qualitatively similar for all pore widths $6 \\le w \\le 11$. \n\\begin{figure}[h]\n\\centering\n  \\includegraphics[width=8.6cm]{figure11}\n  \\caption{Free energy barriers for nucleation from hydrophobic pores of depth $d=30$ and widths $w=6$ (blue), $w=12$ (red) and $w=16$ (green). The free energy barrier for nucleation on a flat surface is shown in black.} \n  \\label{fgr:11}\n\\end{figure}\n\nFor $w=12$ (red curve in Fig.~\\ref{fgr:11}) there is a small change in behaviour. The full pore state, corresponding to a change in the rate of increase of the free energy with $n$, is marked by the left dotted vertical line at $n = 360$. For this pore width the free energy maximum $n \\approx 555$ (marked by the right dotted vertical line) coincides with the point where the nucleus is expelled from the pore; typical cluster configurations during the ejection are shown in Fig.~\\ref{fgr:12}. Thus the nucleus attains its critical size immediately after expulsion, and then continues to grow following the free energy barrier for nucleation on a flat surface (black curve in Fig.~\\ref{fgr:11}). \nA qualitatively similar dynamical pathway is also found for larger pore widths up to $w=16$.\n \\begin{figure}[h]\n\\centering\n  \\includegraphics[width=7.4cm]{figure12}\n  \\caption{Snapshots of the pore emptying transition for the pore of size $d=30$, $w=12$. In all snapshots the size of the nucleus is $n^* \\approx 555$.}\n  \\label{fgr:12}\n\\end{figure}\n\nThis regime ends at $w=16$ (green curve in Fig.~\\ref{fgr:11}). For this pore width the point on free energy curve corresponding to the full pore, $n \\approx 480$, becomes a minimum, while at the same time a maximum appears for smaller cluster sizes.\nHowever, the free energy difference between the maximum and minimum is negligibly small (smaller than the typical error bars), and the nucleus again empties the pore during nucleation. \nFor $w=17$ the minimum becomes more pronounced (blue curve in Fig.~\\ref{fgr:13}) and the system crosses over to a new regime, where it follows a two-step nucleation pathway. As before pre-critical nuclei appear in one of the bottom corners of the pore, and then continue to grow. However the nuclei now achieve a critical size for a value of $n$ smaller than the pore size. This critical size corresponds to the left maximum of the blue curve in Fig.~\\ref{fgr:13}. After attaining the critical size, the nuclei grow further without any free energy cost until they fill the pore. The minimum in the free energy curves is located at approximately $n= 30 \\times 17 = 510$, the pore size. Finally, there is a second nucleation barrier for growth outside the filled pore, which corresponds to the right maximum in Fig. \\ref{fgr:13} (blue curve).  Snapshots of the growing cluster for $w=17$ are shown in Fig.~\\ref{fgr:14}.\nThis nucleation process is reminiscent of the two-step nucleation from neutral pores analysed in Section \\ref{neutral}.\n\\begin{figure}[h]\n\\centering\n  \\includegraphics[width=8.6cm]{figure13}\n  \\caption{Free energy barriers for nucleation from hydrophobic pores of depth $d=30$ and widths: $w=17$ (blue), $w=20$ (red) and $w=24$ (green).}\n  \\label{fgr:13}\n\\end{figure}\n\nThe barrier to nucleation within the pore increases with the pore width $w$ and eventually saturates, while the barrier to nucleation outside the filled pore decreases with $w$. The two-step nucleation is observed for pore widths $17 \\le w \\le 23$. At $w=24$ (shown in green in Fig.~\\ref{fgr:13}) the right maximum disappears and the nucleation occurs in one step. There is a critical nucleus smaller than the pore size, after which the cluster continues to grow, both in and out of pore, without any additional free energy cost.\n\n\\section{Summary}\n\nTo summarise, we have used umbrella sampling and transition path sampling Monte Carlo simulations performed on a simple model system, the 2D Ising model, to provide generic picture of nucleation in hydrophobic nanopores.\nWe find three regimes. For narrow pores, the nucleation occurs on the flat surface, almost unaffected by the presence of the pores. For wide pores the pores fill and then act as a seed for nucleation of a critical cluster on the surface.\nFor pores of intermediate widths nucleation commences in the pores but, as the cluster grows across the surface, there is a sudden pore emptying transition before the nucleus has reached its critical size. \n\nOur results suggest that the nanoscale tomography of a surface will be key in controlling its water-repellency. In particular, narrower pores will more readily empty during nucleation to give the Cassie-Baxter configuration, associated with\nfast droplet shedding, and relevant to the enhanced performance of condensers, anti-icing substrates and self-cleaning materials. Extensions to 3D and to more realistic liquid models are needed to help to quantify these effects, but will be\nextremely demanding of computational resources. \n\\begin{figure}[h]\n\\centering\n  \\includegraphics[width=7.4cm]{figure14}\n  \\caption{A two-step nucleation process for the pore of size $d=30$, $w=17$.}\n  \\label{fgr:14}\n\\end{figure}\n\n\\section*{Acknowledgments}\n\nWe are grateful to Richard Sear for helpful discussions. This work was supported through funding from the ERC Advanced Grant 291234 MiCE.\n\n\\begin{thebibliography}{40}\n\\makeatletter\n\\providecommand \\@ifxundefined [1]{\n \\@ifx{#1\\undefined}\n}\n\\providecommand \\@ifnum [1]{\n \\ifnum #1\\expandafter \\@firstoftwo\n \\else \\expandafter \\@secondoftwo\n \\fi\n}\n\\providecommand \\@ifx [1]{\n \\ifx #1\\expandafter \\@firstoftwo\n \\else \\expandafter \\@secondoftwo\n \\fi\n}\n\\providecommand \\natexlab [1]{#1}\n\\providecommand \\enquote  [1]{``#1''}\n\\providecommand \\bibnamefont  [1]{#1}\n\\providecommand \\bibfnamefont [1]{#1}\n\\providecommand \\citenamefont [1]{#1}\n\\providecommand \\href@noop [0]{\\@secondoftwo}\n\\providecommand \\href [0]{\\begingroup \\@sanitize@url \\@href}\n\\providecommand \\@href[1]{\\@@startlink{#1}\\@@href}\n\\providecommand \\@@href[1]{\\endgroup#1\\@@endlink}\n\\providecommand \\@sanitize@url [0]{\\catcode `\\\\12\\catcode `\\$12\\catcode\n  `\\&12\\catcode `\\#12\\catcode `\\^12\\catcode `\\_12\\catcode `\\%12\\relax}\n\\providecommand \\@@startlink[1]{}\n\\providecommand \\@@endlink[0]{}\n\\providecommand \\url  [0]{\\begingroup\\@sanitize@url \\@url }\n\\providecommand \\@url [1]{\\endgroup\\@href {#1}{\\urlprefix }}\n\\providecommand \\urlprefix  [0]{URL }\n\\providecommand \\Eprint [0]{\\href }\n\\providecommand \\doibase [0]{http://dx.doi.org/}\n\\providecommand \\selectlanguage [0]{\\@gobble}\n\\providecommand \\bibinfo  [0]{\\@secondoftwo}\n\\providecommand \\bibfield  [0]{\\@secondoftwo}\n\\providecommand \\translation [1]{[#1]}\n\\providecommand \\BibitemOpen [0]{}\n\\providecommand \\bibitemStop [0]{}\n\\providecommand \\bibitemNoStop [0]{.\\EOS\\space}\n\\providecommand \\EOS [0]{\\spacefactor3000\\relax}\n\\providecommand \\BibitemShut  [1]{\\csname bibitem#1\\endcsname}\n\\let\\auto@bib@innerbib\\@empty\n\n\\bibitem [{\\citenamefont {Qu\\'er\\'e}(2008)}]{Quere2008}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {D.}~\\bibnamefont\n  {Qu\\'er\\'e}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal}\n  {Annual Review of Materials Research}\\ }\\textbf {\\bibinfo {volume} {38}},\\\n  \\bibinfo {pages} {71} (\\bibinfo {year} {2008})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Cassie}\\ and\\ \\citenamefont\n  {Baxter}(1944)}]{Cassie1944}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {A.~B.~D.}\\\n  \\bibnamefont {Cassie}}\\ and\\ \\bibinfo {author} {\\bibfnamefont\n  {S.}~\\bibnamefont {Baxter}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo\n  {journal} {Transactions of Faraday Society}\\ }\\textbf {\\bibinfo {volume}\n  {40}},\\ \\bibinfo {pages} {546} (\\bibinfo {year} {1944})}\\BibitemShut\n  {NoStop}\n\\bibitem [{\\citenamefont {Wenzel}(1936)}]{Wenzel1936}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {R.~N.}\\ \\bibnamefont\n  {Wenzel}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal}\n  {Industrial and Engineering Chemistry}\\ }\\textbf {\\bibinfo {volume} {28}},\\\n  \\bibinfo {pages} {988} (\\bibinfo {year} {1936})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Barthlott}\\ and\\ \\citenamefont\n  {Neinhuis}(1997)}]{Barthlott1997}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {W.}~\\bibnamefont\n  {Barthlott}}\\ and\\ \\bibinfo {author} {\\bibfnamefont {C.}~\\bibnamefont\n  {Neinhuis}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal}\n  {Planta}\\ }\\textbf {\\bibinfo {volume} {202}},\\ \\bibinfo {pages} {1} (\\bibinfo\n  {year} {1997})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Wisdom}\\ \\emph {et~al.}(2013)\\citenamefont {Wisdom},\n  \\citenamefont {Watson}, \\citenamefont {Qu}, \\citenamefont {Liu},\n  \\citenamefont {Watson},\\ and\\ \\citenamefont {Chen}}]{Chen2013}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {K.~M.}\\ \\bibnamefont\n  {Wisdom}}, \\bibinfo {author} {\\bibfnamefont {J.~A.}\\ \\bibnamefont {Watson}},\n  \\bibinfo {author} {\\bibfnamefont {X.}~\\bibnamefont {Qu}}, \\bibinfo {author}\n  {\\bibfnamefont {F.}~\\bibnamefont {Liu}}, \\bibinfo {author} {\\bibfnamefont\n  {G.~S.}\\ \\bibnamefont {Watson}}, \\ and\\ \\bibinfo {author} {\\bibfnamefont\n  {C.~H.}\\ \\bibnamefont {Chen}},\\ }\\href@noop {} {\\bibfield  {journal}\n  {\\bibinfo  {journal} {PNAS}\\ }\\textbf {\\bibinfo {volume} {110}},\\ \\bibinfo\n  {pages} {7992} (\\bibinfo {year} {2013})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Chen}\\ \\emph {et~al.}(2007)\\citenamefont {Chen},\n  \\citenamefont {Cai}, \\citenamefont {Tsai}, \\citenamefont {Chen},\n  \\citenamefont {Xiong}, \\citenamefont {Yu},\\ and\\ \\citenamefont\n  {Ren}}]{Chen2007}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {C.~H.}\\ \\bibnamefont\n  {Chen}}, \\bibinfo {author} {\\bibfnamefont {Q.}~\\bibnamefont {Cai}}, \\bibinfo\n  {author} {\\bibfnamefont {C.}~\\bibnamefont {Tsai}}, \\bibinfo {author}\n  {\\bibfnamefont {C.~L.}\\ \\bibnamefont {Chen}}, \\bibinfo {author}\n  {\\bibfnamefont {G.}~\\bibnamefont {Xiong}}, \\bibinfo {author} {\\bibfnamefont\n  {Y.}~\\bibnamefont {Yu}}, \\ and\\ \\bibinfo {author} {\\bibfnamefont\n  {Z.}~\\bibnamefont {Ren}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo\n  {journal} {Appl. Phys. Lett.}\\ }\\textbf {\\bibinfo {volume} {90}},\\ \\bibinfo\n  {pages} {173108} (\\bibinfo {year} {2007})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Miljkovic}\\ \\emph\n  {et~al.}(2012{\\natexlab{a}})\\citenamefont {Miljkovic}, \\citenamefont\n  {Enright}, \\citenamefont {Nam}, \\citenamefont {Lopez}, \\citenamefont {Dou},\n  \\citenamefont {Sack},\\ and\\ \\citenamefont {Wang}}]{Miljkovic2012a}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {N.}~\\bibnamefont\n  {Miljkovic}}, \\bibinfo {author} {\\bibfnamefont {R.}~\\bibnamefont {Enright}},\n  \\bibinfo {author} {\\bibfnamefont {Y.}~\\bibnamefont {Nam}}, \\bibinfo {author}\n  {\\bibfnamefont {K.}~\\bibnamefont {Lopez}}, \\bibinfo {author} {\\bibfnamefont\n  {N.}~\\bibnamefont {Dou}}, \\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont\n  {Sack}}, \\ and\\ \\bibinfo {author} {\\bibfnamefont {E.~N.}\\ \\bibnamefont\n  {Wang}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {Nano\n  Letters}\\ }\\textbf {\\bibinfo {volume} {13}},\\ \\bibinfo {pages} {179}\n  (\\bibinfo {year} {2012}{\\natexlab{a}})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Miljkovic}\\ \\emph\n  {et~al.}(2012{\\natexlab{b}})\\citenamefont {Miljkovic}, \\citenamefont\n  {Enright},\\ and\\ \\citenamefont {Wang}}]{Miljkovic2012b}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {N.}~\\bibnamefont\n  {Miljkovic}}, \\bibinfo {author} {\\bibfnamefont {R.}~\\bibnamefont {Enright}},\n  \\ and\\ \\bibinfo {author} {\\bibfnamefont {E.~N.}\\ \\bibnamefont {Wang}},\\\n  }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {ACS Nano}\\\n  }\\textbf {\\bibinfo {volume} {6}},\\ \\bibinfo {pages} {1776} (\\bibinfo {year}\n  {2012}{\\natexlab{b}})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Enright}\\ \\emph {et~al.}(2012)\\citenamefont\n  {Enright}, \\citenamefont {Miljkovic}, \\citenamefont {Al-Obeidi},\n  \\citenamefont {Thompson},\\ and\\ \\citenamefont {Wang}}]{Miljkovic2012c}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {R.}~\\bibnamefont\n  {Enright}}, \\bibinfo {author} {\\bibfnamefont {N.}~\\bibnamefont {Miljkovic}},\n  \\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Al-Obeidi}}, \\bibinfo\n  {author} {\\bibfnamefont {C.~V.}\\ \\bibnamefont {Thompson}}, \\ and\\ \\bibinfo\n  {author} {\\bibfnamefont {E.~N.}\\ \\bibnamefont {Wang}},\\ }\\href@noop {}\n  {\\bibfield  {journal} {\\bibinfo  {journal} {Langmuir}\\ }\\textbf {\\bibinfo\n  {volume} {28}},\\ \\bibinfo {pages} {14424} (\\bibinfo {year}\n  {2012})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Miljkovic}\\ and\\ \\citenamefont\n  {Wang}(2013)}]{Miljkovic2013}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {N.}~\\bibnamefont\n  {Miljkovic}}\\ and\\ \\bibinfo {author} {\\bibfnamefont {E.~N.}\\ \\bibnamefont\n  {Wang}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {MRS\n  Bulletin}\\ }\\textbf {\\bibinfo {volume} {38}},\\ \\bibinfo {pages} {397}\n  (\\bibinfo {year} {2013})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Narhe}\\ and\\ \\citenamefont\n  {Beysens}(2004)}]{Narhe2004}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {R.~D.}\\ \\bibnamefont\n  {Narhe}}\\ and\\ \\bibinfo {author} {\\bibfnamefont {D.~A.}\\ \\bibnamefont\n  {Beysens}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {Phys.\n  Rev. Lett.}\\ }\\textbf {\\bibinfo {volume} {93}},\\ \\bibinfo {pages} {076103}\n  (\\bibinfo {year} {2004})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Varanasi}\\ \\emph {et~al.}(2009)\\citenamefont\n  {Varanasi}, \\citenamefont {Hsu}, \\citenamefont {Bathe}, \\citenamefont\n  {Yang},\\ and\\ \\citenamefont {Deng}}]{Varanasi2009}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {K.~K.}\\ \\bibnamefont\n  {Varanasi}}, \\bibinfo {author} {\\bibfnamefont {M.}~\\bibnamefont {Hsu}},\n  \\bibinfo {author} {\\bibfnamefont {N.}~\\bibnamefont {Bathe}}, \\bibinfo\n  {author} {\\bibfnamefont {W.}~\\bibnamefont {Yang}}, \\ and\\ \\bibinfo {author}\n  {\\bibfnamefont {T.}~\\bibnamefont {Deng}},\\ }\\href@noop {} {\\bibfield\n  {journal} {\\bibinfo  {journal} {Appl. Phys. Lett.}\\ }\\textbf {\\bibinfo\n  {volume} {95}},\\ \\bibinfo {pages} {094101} (\\bibinfo {year}\n  {2009})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Boreyko}\\ and\\ \\citenamefont\n  {Chen}(2009)}]{Boreyko2009}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {J.~B.}\\ \\bibnamefont\n  {Boreyko}}\\ and\\ \\bibinfo {author} {\\bibfnamefont {C.~H.}\\ \\bibnamefont\n  {Chen}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {Phys.\n  Rev. Lett.}\\ }\\textbf {\\bibinfo {volume} {103}},\\ \\bibinfo {pages} {184501}\n  (\\bibinfo {year} {2009})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Sun}\\ \\emph {et~al.}(2005)\\citenamefont {Sun},\n  \\citenamefont {Feng}, \\citenamefont {Gao},\\ and\\ \\citenamefont\n  {Jiang}}]{Sun2005}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {T.}~\\bibnamefont\n  {Sun}}, \\bibinfo {author} {\\bibfnamefont {L.}~\\bibnamefont {Feng}}, \\bibinfo\n  {author} {\\bibfnamefont {X.}~\\bibnamefont {Gao}}, \\ and\\ \\bibinfo {author}\n  {\\bibfnamefont {L.}~\\bibnamefont {Jiang}},\\ }\\href@noop {} {\\bibfield\n  {journal} {\\bibinfo  {journal} {Accounts of Chemical Research}\\ }\\textbf\n  {\\bibinfo {volume} {38}},\\ \\bibinfo {pages} {644} (\\bibinfo {year}\n  {2005})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Eberle}\\ \\emph {et~al.}(2014)\\citenamefont {Eberle},\n  \\citenamefont {Tiwari}, \\citenamefont {Maitra},\\ and\\ \\citenamefont\n  {Poulikakos}}]{Poulikakos2014}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {P.}~\\bibnamefont\n  {Eberle}}, \\bibinfo {author} {\\bibfnamefont {M.~K.}\\ \\bibnamefont {Tiwari}},\n  \\bibinfo {author} {\\bibfnamefont {T.}~\\bibnamefont {Maitra}}, \\ and\\ \\bibinfo\n  {author} {\\bibfnamefont {D.}~\\bibnamefont {Poulikakos}},\\ }\\href@noop {}\n  {\\bibfield  {journal} {\\bibinfo  {journal} {Nanoscale}\\ }\\textbf {\\bibinfo\n  {volume} {6}},\\ \\bibinfo {pages} {4874} (\\bibinfo {year} {2014})}\\BibitemShut\n  {NoStop}\n\\bibitem [{\\citenamefont {Guo}\\ \\emph {et~al.}(2014)\\citenamefont {Guo},\n  \\citenamefont {Liu}, \\citenamefont {Jiang},\\ and\\ \\citenamefont\n  {Zhang}}]{Guo2014}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {Q.}~\\bibnamefont\n  {Guo}}, \\bibinfo {author} {\\bibfnamefont {Y.}~\\bibnamefont {Liu}}, \\bibinfo\n  {author} {\\bibfnamefont {G.}~\\bibnamefont {Jiang}}, \\ and\\ \\bibinfo {author}\n  {\\bibfnamefont {X.}~\\bibnamefont {Zhang}},\\ }\\href@noop {} {\\bibfield\n  {journal} {\\bibinfo  {journal} {Soft Matter}\\ }\\textbf {\\bibinfo {volume}\n  {10}},\\ \\bibinfo {pages} {1182} (\\bibinfo {year} {2014})}\\BibitemShut\n  {NoStop}\n\\bibitem [{\\citenamefont {Lee}\\ and\\ \\citenamefont {Yang}(1952)}]{Lee1952}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {T.~D.}\\ \\bibnamefont\n  {Lee}}\\ and\\ \\bibinfo {author} {\\bibfnamefont {C.~N.}\\ \\bibnamefont {Yang}},\\\n  }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {Phys. Rev.}\\\n  }\\textbf {\\bibinfo {volume} {87}},\\ \\bibinfo {pages} {410} (\\bibinfo {year}\n  {1952})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Pan}\\ and\\ \\citenamefont {Chandler}(2004)}]{Pan2004}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {A.~C.}\\ \\bibnamefont\n  {Pan}}\\ and\\ \\bibinfo {author} {\\bibfnamefont {D.}~\\bibnamefont {Chandler}},\\\n  }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {J. Phys. Chem. B}\\\n  }\\textbf {\\bibinfo {volume} {108}},\\ \\bibinfo {pages} {19681} (\\bibinfo\n  {year} {2004})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Ryu}\\ and\\ \\citenamefont\n  {Cai}(2010{\\natexlab{a}})}]{Ryu2010r}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {S.}~\\bibnamefont\n  {Ryu}}\\ and\\ \\bibinfo {author} {\\bibfnamefont {W.}~\\bibnamefont {Cai}},\\\n  }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {Phys. Rev. E}\\\n  }\\textbf {\\bibinfo {volume} {81}},\\ \\bibinfo {pages} {030601(R)} (\\bibinfo\n  {year} {2010}{\\natexlab{a}})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Ryu}\\ and\\ \\citenamefont\n  {Cai}(2010{\\natexlab{b}})}]{Ryu2010}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {S.}~\\bibnamefont\n  {Ryu}}\\ and\\ \\bibinfo {author} {\\bibfnamefont {W.}~\\bibnamefont {Cai}},\\\n  }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {Phys. Rev. E}\\\n  }\\textbf {\\bibinfo {volume} {82}},\\ \\bibinfo {pages} {011603} (\\bibinfo\n  {year} {2010}{\\natexlab{b}})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Sear}(2006)}]{Sear2006}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {R.~P.}\\ \\bibnamefont\n  {Sear}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {J. Phys.\n  Chem. B}\\ }\\textbf {\\bibinfo {volume} {110}},\\ \\bibinfo {pages} {4985}\n  (\\bibinfo {year} {2006})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Page}\\ and\\ \\citenamefont {Sear}(2006)}]{Page2006}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {A.~J.}\\ \\bibnamefont\n  {Page}}\\ and\\ \\bibinfo {author} {\\bibfnamefont {R.~P.}\\ \\bibnamefont\n  {Sear}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {Phys.\n  Rev. Lett.}\\ }\\textbf {\\bibinfo {volume} {97}},\\ \\bibinfo {pages} {065701}\n  (\\bibinfo {year} {2006})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Onsager}(1944)}]{Onsager1944}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {L.}~\\bibnamefont\n  {Onsager}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {Phys.\n  Rev.}\\ }\\textbf {\\bibinfo {volume} {65}},\\ \\bibinfo {pages} {117} (\\bibinfo\n  {year} {1944})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Debenedetti}(1996)}]{Debenedetti1996}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {P.~G.}\\ \\bibnamefont\n  {Debenedetti}},\\ }\\href@noop {} {\\emph {\\bibinfo {title} {{M}etastable\n  {L}iquids}}}\\ (\\bibinfo  {publisher} {Princeton University Press},\\ \\bibinfo\n  {address} {Princetion},\\ \\bibinfo {year} {1996})\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Oxtoby}(1992)}]{Oxtoby1992}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {D.~W.}\\ \\bibnamefont\n  {Oxtoby}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {J.\n  Phys.: Condens. Matter}\\ }\\textbf {\\bibinfo {volume} {4}},\\ \\bibinfo {pages}\n  {7627} (\\bibinfo {year} {1992})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Sear}(2007)}]{Sear2007}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {R.~P.}\\ \\bibnamefont\n  {Sear}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {J.\n  Phys.: Condens. Matter}\\ }\\textbf {\\bibinfo {volume} {19}},\\ \\bibinfo {pages}\n  {033101} (\\bibinfo {year} {2007})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Shneidman}\\ \\emph {et~al.}(1999)\\citenamefont\n  {Shneidman}, \\citenamefont {Jackson},\\ and\\ \\citenamefont\n  {Beatty}}]{Shneidman1999}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {V.~A.}\\ \\bibnamefont\n  {Shneidman}}, \\bibinfo {author} {\\bibfnamefont {K.~A.}\\ \\bibnamefont\n  {Jackson}}, \\ and\\ \\bibinfo {author} {\\bibfnamefont {K.~M.}\\ \\bibnamefont\n  {Beatty}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {J.\n  Chem. Phys.}\\ }\\textbf {\\bibinfo {volume} {111}},\\ \\bibinfo {pages} {6932}\n  (\\bibinfo {year} {1999})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Turnbull}(1950)}]{Turnbull1950}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {D.}~\\bibnamefont\n  {Turnbull}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {J.\n  Chem. Phys.}\\ }\\textbf {\\bibinfo {volume} {18}},\\ \\bibinfo {pages} {198}\n  (\\bibinfo {year} {1950})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Torrie}\\ and\\ \\citenamefont\n  {Valleau}(1977)}]{Torrie1977}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {G.~M.}\\ \\bibnamefont\n  {Torrie}}\\ and\\ \\bibinfo {author} {\\bibfnamefont {J.~P.}\\ \\bibnamefont\n  {Valleau}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal}\n  {Journal of Computational Physics}\\ }\\textbf {\\bibinfo {volume} {23}},\\\n  \\bibinfo {pages} {187} (\\bibinfo {year} {1977})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Chandler}(1987)}]{Chandler1987}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {D.}~\\bibnamefont\n  {Chandler}},\\ }\\href@noop {} {\\emph {\\bibinfo {title} {{I}ntroduction to\n  {M}odern {S}tatistical {M}echanics}}}\\ (\\bibinfo  {publisher} {Oxford\n  University Press},\\ \\bibinfo {address} {New York},\\ \\bibinfo {year}\n  {1987})\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {ten Wolde}\\ and\\ \\citenamefont\n  {Frenkel}(1998)}]{tenWolde1998}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {P.~R.}\\ \\bibnamefont\n  {ten Wolde}}\\ and\\ \\bibinfo {author} {\\bibfnamefont {D.}~\\bibnamefont\n  {Frenkel}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {J.\n  Chem. Phys.}\\ }\\textbf {\\bibinfo {volume} {109}},\\ \\bibinfo {pages} {9901}\n  (\\bibinfo {year} {1998})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Auer}\\ and\\ \\citenamefont\n  {Frenkel}(2003)}]{Auer2004}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {S.}~\\bibnamefont\n  {Auer}}\\ and\\ \\bibinfo {author} {\\bibfnamefont {D.}~\\bibnamefont {Frenkel}},\\\n  }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {J. Chem. Phys.}\\\n  }\\textbf {\\bibinfo {volume} {120}},\\ \\bibinfo {pages} {3015} (\\bibinfo {year}\n  {2003})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Shirts}\\ and\\ \\citenamefont\n  {Chodera}(2008)}]{Chodera2008}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {M.~R.}\\ \\bibnamefont\n  {Shirts}}\\ and\\ \\bibinfo {author} {\\bibfnamefont {J.~D.}\\ \\bibnamefont\n  {Chodera}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {J.\n  Chem. Phys.}\\ }\\textbf {\\bibinfo {volume} {129}},\\ \\bibinfo {pages} {124105}\n  (\\bibinfo {year} {2008})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Winter}\\ \\emph {et~al.}(2009)\\citenamefont {Winter},\n  \\citenamefont {Virnau},\\ and\\ \\citenamefont {Binder}}]{Winter2009}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {D.}~\\bibnamefont\n  {Winter}}, \\bibinfo {author} {\\bibfnamefont {P.}~\\bibnamefont {Virnau}}, \\\n  and\\ \\bibinfo {author} {\\bibfnamefont {K.}~\\bibnamefont {Binder}},\\\n  }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {J. Phys.: Condens.\n  Matter.}\\ }\\textbf {\\bibinfo {volume} {21}},\\ \\bibinfo {pages} {464118}\n  (\\bibinfo {year} {2009})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Dellago}\\ \\emph {et~al.}(2001)\\citenamefont\n  {Dellago}, \\citenamefont {Bolhuis},\\ and\\ \\citenamefont\n  {Geissler}}]{Dellago2001}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {C.}~\\bibnamefont\n  {Dellago}}, \\bibinfo {author} {\\bibfnamefont {P.~G.}\\ \\bibnamefont\n  {Bolhuis}}, \\ and\\ \\bibinfo {author} {\\bibfnamefont {P.~L.}\\ \\bibnamefont\n  {Geissler}},\\ }\\href@noop {} {\\emph {\\bibinfo {title} {Transition path\n  sampling. {I}n {A}dvances in {C}hemical {P}hysics}}}\\ (\\bibinfo  {publisher}\n  {Oxford University Press},\\ \\bibinfo {address} {New York},\\ \\bibinfo {year}\n  {2001})\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Bolhuis}\\ \\emph {et~al.}(2002)\\citenamefont\n  {Bolhuis}, \\citenamefont {Chandler}, \\citenamefont {Dellago},\\ and\\\n  \\citenamefont {Geissler}}]{Bolhuis2002}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {P.~G.}\\ \\bibnamefont\n  {Bolhuis}}, \\bibinfo {author} {\\bibfnamefont {D.}~\\bibnamefont {Chandler}},\n  \\bibinfo {author} {\\bibfnamefont {C.}~\\bibnamefont {Dellago}}, \\ and\\\n  \\bibinfo {author} {\\bibfnamefont {P.~L.}\\ \\bibnamefont {Geissler}},\\\n  }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {Annu. Rev. Phys.\n  Chem.}\\ }\\textbf {\\bibinfo {volume} {53}},\\ \\bibinfo {pages} {291} (\\bibinfo\n  {year} {2002})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Bolhuis}\\ and\\ \\citenamefont\n  {Dellago}(2010)}]{Bolhuis2010}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {P.~G.}\\ \\bibnamefont\n  {Bolhuis}}\\ and\\ \\bibinfo {author} {\\bibfnamefont {C.}~\\bibnamefont\n  {Dellago}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal}\n  {Reviews in Computational Chemistry}\\ }\\textbf {\\bibinfo {volume} {27}},\\\n  \\bibinfo {pages} {111} (\\bibinfo {year} {2010})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Allen}\\ \\emph {et~al.}(2006)\\citenamefont {Allen},\n  \\citenamefont {Frenkel},\\ and\\ \\citenamefont {ten Wolde}}]{Allen2006}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {R.~J.}\\ \\bibnamefont\n  {Allen}}, \\bibinfo {author} {\\bibfnamefont {D.}~\\bibnamefont {Frenkel}}, \\\n  and\\ \\bibinfo {author} {\\bibfnamefont {P.~R.}\\ \\bibnamefont {ten Wolde}},\\\n  }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {J. Chem. Phys.}\\\n  }\\textbf {\\bibinfo {volume} {124}},\\ \\bibinfo {pages} {024102} (\\bibinfo\n  {year} {2006})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Allen}\\ \\emph {et~al.}(2009)\\citenamefont {Allen},\n  \\citenamefont {Valeriani},\\ and\\ \\citenamefont {ten Wolde}}]{Allen2009}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {R.~J.}\\ \\bibnamefont\n  {Allen}}, \\bibinfo {author} {\\bibfnamefont {C.}~\\bibnamefont {Valeriani}}, \\\n  and\\ \\bibinfo {author} {\\bibfnamefont {P.~R.}\\ \\bibnamefont {ten Wolde}},\\\n  }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {J. Phys.: Condens.\n  Matter}\\ }\\textbf {\\bibinfo {volume} {21}},\\ \\bibinfo {pages} {463102}\n  (\\bibinfo {year} {2009})}\\BibitemShut {NoStop}\n\\bibitem [{\\citenamefont {Hedges}\\ and\\ \\citenamefont\n  {Whitelam}(2012)}]{Hedges2012}\n  \\BibitemOpen\n  \\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {L.~O.}\\ \\bibnamefont\n  {Hedges}}\\ and\\ \\bibinfo {author} {\\bibfnamefont {S.}~\\bibnamefont\n  {Whitelam}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {Soft\n  Matter}\\ }\\textbf {\\bibinfo {volume} {8}},\\ \\bibinfo {pages} {8624} (\\bibinfo\n  {year} {2012})}\\BibitemShut {NoStop}\n\\end{thebibliography}\n\n\n", "itemtype": "equation", "pos": 29312, "prevtext": "\nwhere $n_{\\downarrow}$ and $n_{\\uparrow}$ are the largest cluster size limits chosen to define the spin-down and spin-up states. In our TPS simulations we choose $n_{\\downarrow}=20$ and $n_{\\uparrow} = 600$ or $700$ (see Table \\ref{tbl:1}) such that the initial state and product state basins do not overlap, and are both far enough from the transition state region found in the umbrella sampling simulations described in Section \\ref{umbrella} (Fig.~\\ref{fgr:2}). \\\\\n\nWith our choice of $T$ and $h$ we are in a regime where a nucleation event is very rare, making it extremely difficult to sample even one such event with brute force simulations. Thus we constructed the initial trajectory for TPS by taking an umbrella sampling configuration with $n = n^{*}$ and generating trajectories, with both forward and backward propagation using the underlying dynamics of the system, until a trajectory was found connecting the initial and nucleating states. \n\nTrajectories of 900 time units in length are sampled using the TPS shooting method~\\cite{Bolhuis2010}. This trajectory length turned out to be long enough to harvest a sufficiently large number of transition states (critical clusters).\n\nThe TPS shooting move consists of choosing a random configuration $x_{\\textnormal{r}}$ on the current  trajectory and choosing randomly to evolve the system either forwards or backwards. The new trajectory is then constructed by replacing the relevant part of the current path by the newly generated configurations. The updated trajectory is accepted if it connects the spin-down and spin-up states specified by functions (\\ref{regions}).\nThe initial trajectory, constructed with the help of umbrella sampling data, may be unphysical, so we first equilibrate it with 2500 shooting moves, and then harvest about 60 independent trajectories, one every 50 accepted shooting moves. \n\\begin{figure}[h]\n\\centering\n  \\includegraphics[width=8.6cm]{figure3}\n  \\caption{Committors for the case $h_{\\textnormal{S}}= -0.3$: $p_{\\downarrow}(n)$ -- blue line; $p_{\\uparrow}(n)$ -- red line; and their sum -- black line. Fleeting trajectory lengths are $t_{\\textnormal{s}} = 1800$ MC sweeps.}\n  \\label{fgr:3}\n\\end{figure}\n\nWe use the sampled ensemble of accepted trajectories to calculate the committors~\\cite{Dellago2001,Bolhuis2002,Bolhuis2010} $p_{\\downarrow}(n,t_{\\textnormal{s}})$ and $p_{\\uparrow}(n,t_{\\textnormal{s}})$ for the spin-down and spin-up states, respectively. The committor $p_{\\uparrow (\\downarrow)}(n,t_{\\textnormal{s}})$ is the probability that a system with initial configuration with a nucleus of size $n$ will reside in the spin-up (spin-down) state at time $t_{\\textnormal{s}}$.\nFrom each point of the sampled accepted trajectories we run 50 fleeting trajectories of length $t_{\\textnormal{s}} = 1800$ time units. The spin-down and spin-up committors are then determined as the fraction of fleeting trajectories that end in the spin-down and spin-up regions respectively for each $n$. Our results for $h_{\\textnormal{S}} = -0.3$ are shown in Fig.~\\ref{fgr:3}. The committor graphs are qualitatively similar for all values of $h_{\\textnormal{S}}$.\nIn general, not all fleeting trajectories end in spin-down or spin-up states; some of them might end in the region between these states. However, the fact that $p_{\\downarrow}(n,t_{\\textnormal{s}}) + p_{\\uparrow}(n,t_{\\textnormal{s}}) \\approx 1$ for all $n$ in our simulations shows that the chosen fleeting trajectory length $t_{\\textnormal{s}}$ is long enough to correctly sample the transition states. The transition region is defined as that consisting of states $n^{*}$ that are equally accessible, meaning $p_{\\downarrow}(n^{*}) \\approx p_{\\uparrow}(n^{*})$. The results we obtain for $n^{*}$ are in good agreement with the corresponding umbrella sampling $n^{*}$ values for all surface fields $h_{\\textnormal{S}}$.\n\nA more general procedure would be to determine committors $p_{\\downarrow}(x,t_{\\textnormal{s}})$ and $p_{\\uparrow}(x,t_{\\textnormal{s}})$ for all system configurations $x$. However this would present an extraordinary computational challenge. Fortunately, for our needs it is enough to examine only the configurations $x$ of the ensemble of accepted trajectories connecting the spin-down and spin-up states. \nWe follow the procedure described in Ref. [\\onlinecite{Dellago2001}] to determine members of the transition state ensemble (TSE). TSE consists of states $x$ such that half of the fleeting trajectories initiated from $x$ end in spin-down state, and the other half end in spin-up state.\n\\begin{figure}[h]\n\\centering\n  \\includegraphics[height=5cm]{figure4}\n  \\caption{A typical member of TSE for the case $h_{\\textnormal{S}} = -0.5J$. The lattice size is $60 \\times 60$ and the surface is located at the bottom. The -1 spins are blue, and the +1 spins are red.}\n  \\label{fgr:4}\n\\end{figure}\n\nFor each slice $x$ of all sampled trajectories connecting the spin-down and spin-up states, we first generate 10 fleeting trajectories starting from $x$, and determine $p_{\\uparrow}(x,t_{\\textnormal{s}})$ from the fraction of paths that end in the spin-up state. Since in this approach we are dealing with the same configurations $x$ as in the above committor $p_{\\uparrow (\\downarrow)}(n,t_{\\textnormal{s}})$ analysis, we take the same fleeting trajectory length $t_{\\textnormal{s}}=1800$ time units to ensure $p_{\\uparrow}(x,t_{\\textnormal{s}}) + p_{\\downarrow}(x,t_{\\textnormal{s}}) \\approx 1$.\nThe configuration $x$ is rejected as a member of the TSE if the calculated $p_{\\uparrow}$ falls outside the $95\\%$ confidence interval around $p_{\\uparrow} = 0.5$. Otherwise more fleeting trajectories are generated until either $p_{\\uparrow}$ falls outside this confidence interval, or an upper limit of 50 fleeting trajectories is reached. If former is the case, the configuration is rejected, otherwise it is accepted as a member of the TSE. From the trajectories connecting spin-down and spin-up states harvested with TPS, we typically found between 2000 and 3000 TSE members for each value of the surface field $h_{\\textnormal{S}}$. A typical critical nucleus taken from the TSE has a rough interface and is anisotropic (see Fig.~\\ref{fgr:4}). \n\\begin{table}[h]\n\\small\n  \\caption{Surface fields $h_{\\textnormal{S}}$ and the corresponding choices of limits for the spin-down state $n_{\\downarrow}$ and spin-up state $n_{\\uparrow}$.\n   Also shown is a comparison between the critical cluster sizes $n^*$ obtained with TSE analysis and umbrella sampling (US).}\n  \\label{tbl:example}\n  \\begin{tabular*}{0.5\\textwidth}{@{\\extracolsep{\\fill}} c  c  c  c  c}\n    \\hline\n    $h_{\\textnormal{S}}$ & $n_{\\downarrow}$ & $n_{\\uparrow}$ & TSE $\\, n^{*}$ & US $\\, n^{*}$\\\\\n    \\hline\n    -0.1J & 20 & 600 & 288 & 285\\\\\n    -0.2J & 20 & 600 & 324 & 325\\\\\n    -0.3J & 20 & 600 & 357 & 355\\\\\n    -0.4J & 20 & 700 & 395 & 405\\\\\n    -0.5J & 20 & 700 & 430 & 415\\\\\n    -0.6J & 20 & 700 & 454 & 445\\\\\n    \\hline\n  \\end{tabular*}\n  \\label{tbl:1}\n\\end{table}\n\nFor all  configurations $x$ in the TSE we can calculate the size of largest cluster $n(x)$, and hence determine its distribution. The average value of this distribution is then taken to be the size of the critical cluster $n^{*}$. Table \\ref{tbl:1} shows that the TSE results are in good agreement with the corresponding values of $n^{*}$ obtained using umbrella sampling.\n\n\\subsection{Contact angles}\n\nWe use TPS to estimate the contact angle of a growing nucleus with the surface for different surface fields $h_{\\textnormal{S}}$. In these simulations we set $n_{\\downarrow} = 20$ and $n_{\\uparrow}=1000$ and sample reactive trajectories of 1000 time units in length for surface fields $h_{\\textnormal{S}} \\ge -0.3 J$, and 1200 time units for surface fields $h_{\\textnormal{S}} \\le -0.4J$. We relax the initial trajectory with 25000 shooting moves, and then sample 2500 independent trajectories, one every 100 accepted shooting moves. In this calculation we are able to analyse more sampled trajectories than in the TSE simulations, because the latter require additional shooting of fleeting trajectories which is computationally very costly. \n\\begin{figure}[h]\n\\centering\n  \\includegraphics[height=6.5cm]{figure5}\n  \\caption{The shape of the circular segment can be conveniently characterised by two components of the gyration radius with respect to the coordinate system $xOy$ (with $O$ being the centre of mass). They can be calculated explicitly and expressed in terms of the angle $\\theta$ and say, the radius $R$. Thus, the ratio of the squared components of the gyration radius depends only on $\\theta$ as given by expression (\\ref{gratio}).}\n  \\label{fgr:5}\n\\end{figure}\n\nTo determine the average contact angle $\\theta_n$ of nuclei of size $n$ we proceed as follows. It is expected, on symmetry grounds, that the average cluster has the shape of a circular segment, such as that presented in Fig.~\\ref{fgr:5}. \nThe shape of a cluster of size $n$ can be characterised by the components $R_{\\textnormal{g},x}$ and $R_{\\textnormal{g},y}$ of the gyration radius, $R_{\\textnormal{g}}^2 = R_{\\textnormal{g},x}^2 + R_{\\textnormal{g},y}^2$, with\n\n", "index": 21, "text": "\\begin{equation}\nR_{\\textnormal{g},x}^2(n) = \\frac{1}{n} \\sum_j (x_j - x_{\\textnormal{c}})^2, \\quad R_{\\textnormal{g},y}^2(n) = \\frac{1}{n} \\sum_j (y_j - y_{\\textnormal{c}})^2,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E11.m1\" class=\"ltx_Math\" alttext=\"R_{\\textnormal{g},x}^{2}(n)=\\frac{1}{n}\\sum_{j}(x_{j}-x_{\\textnormal{c}})^{2},%&#10;\\quad R_{\\textnormal{g},y}^{2}(n)=\\frac{1}{n}\\sum_{j}(y_{j}-y_{\\textnormal{c}}%&#10;)^{2},\" display=\"block\"><mrow><mrow><mrow><mrow><msubsup><mi>R</mi><mrow><mtext>g</mtext><mo>,</mo><mi>x</mi></mrow><mn>2</mn></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><mi>n</mi></mfrac><mo>\u2062</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mi>j</mi></munder><msup><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>x</mi><mi>j</mi></msub><mo>-</mo><msub><mi>x</mi><mtext>c</mtext></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></mrow></mrow></mrow><mo rspace=\"12.5pt\">,</mo><mrow><mrow><msubsup><mi>R</mi><mrow><mtext>g</mtext><mo>,</mo><mi>y</mi></mrow><mn>2</mn></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><mi>n</mi></mfrac><mo>\u2062</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mi>j</mi></munder><msup><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>y</mi><mi>j</mi></msub><mo>-</mo><msub><mi>y</mi><mtext>c</mtext></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}]