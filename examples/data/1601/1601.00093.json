[{"file": "1601.00093.tex", "nexttext": "\nwhere $\\Phi$ obeys the reduced Poisson equation\n\n", "itemtype": "equation", "pos": 7607, "prevtext": "\n\n\n\n\n\n\n\n\n\n\\title{Inference and classifications of the Lagrangian dark matter sheet in the SDSS}\n\n\n\n\n\n\n\n\n\n\n\n\\author{Florent Leclercq}\n\\email{florent.leclercq@polytechnique.org}\n\n\n\\affiliation{Institute of Cosmology and Gravitation (ICG), University of Portsmouth,\\\\ Dennis Sciama Building, Burnaby Road, Portsmouth PO1 3FX, United Kingdom}\n\\affiliation{Institut d'Astrophysique de Paris (IAP), UMR 7095, CNRS -- UPMC Universit\\'e Paris 6, Sorbonne Universit\\'es, 98bis boulevard Arago, F-75014 Paris, France}\n\\affiliation{Institut Lagrange de Paris (ILP), Sorbonne Universit\\'es,\\\\ 98bis boulevard Arago, F-75014 Paris, France}\n\\affiliation{\\'Ecole polytechnique ParisTech,\\\\ Route de Saclay, F-91128 Palaiseau, France}\n\n\\author{Jens Jasche}\n\n\n\n\\affiliation{Excellence Cluster Universe, Technische Universit\\\"at M\\\"unchen,\\\\ Boltzmannstrasse 2, D-85748 Garching, Germany}\n\n\\author{Guilhem Lavaux}\n\n\n\n\\affiliation{Institut d'Astrophysique de Paris (IAP), UMR 7095, CNRS -- UPMC Universit\\'e Paris 6, Sorbonne Universit\\'es, 98bis boulevard Arago, F-75014 Paris, France}\n\\affiliation{Institut Lagrange de Paris (ILP), Sorbonne Universit\\'es,\\\\ 98bis boulevard Arago, F-75014 Paris, France}\n\n\\author{Benjamin Wandelt}\n\n\n\n\\affiliation{Institut d'Astrophysique de Paris (IAP), UMR 7095, CNRS -- UPMC Universit\\'e Paris 6, Sorbonne Universit\\'es, 98bis boulevard Arago, F-75014 Paris, France}\n\\affiliation{Institut Lagrange de Paris (ILP), Sorbonne Universit\\'es,\\\\ 98bis boulevard Arago, F-75014 Paris, France}\n\\affiliation{Department of Physics, University of Illinois at Urbana-Champaign,\\\\ 1110 West Green Street, Urbana, IL~61801, USA}\n\\affiliation{Department of Astronomy, University of Illinois at Urbana-Champaign,\\\\ 1002 West Green Street, Urbana, IL~61801, USA}\n\n\n\n\n\n\n\n\n\\date{\\today}\n\n\\begin{abstract}\n\\noindent Whereas previous studies have demonstrated that the shape of the cosmic web can be described by studying the Lagrangian displacement field, state-of-the-art analyses have been limited to cosmological simulations. This letter reports on the possibility to perform a Lagrangian description of cosmic web environments in real data from large-scale structure surveys. Building upon recent Bayesian large-scale inference of initial conditions, we present an analysis of the Lagrangian dark matter sheet in the nearby universe as probed by the Sloan Digital Sky Survey. In particular, we consider its stretchings and foldings and we dissect cosmic structures into four distinct components (voids, sheets, filaments, and clusters), using the Lagrangian classifiers {{\\textsc{diva}}} and {{\\textsc{origami}}}. As a result, identified structures explicitly carry physical information about their formation history. The present study carries potential for profound implications in the analysis of the cosmological large-scale structure, as it opens the way for new confrontations of observational data and theoretical models.\n\\end{abstract}\n\n\n\n\n\n\n\n\\maketitle\n\n\n\n\n\n\n\n\n\\section{Introduction}\n\nThe accurate description of large-scale structure formation, from which the cosmic web originates \\citep{Bond1996}, is one of the major goals of modern cosmology. Traditionally, the Lagrangian and Eulerian descriptions of a discretized fluid of collisionless dark matter are comparatively discussed. In the Eulerian picture, quantities are tracked at fixed positions as particles move. In the Lagrangian framework, the motion and evolution of individual fluid elements is followed. Therefore, particles can be thought of not only as mass tracers, but also as elements of a three-dimensional dark matter sheet, which stretches, folds and distorts in a six-dimensional velocity-position phase space.\n\nUsing cosmological simulations, several recent papers have demonstrated the power of working within the dark matter sheet. Tessellations of the initial Lagrangian space allow the identification of stream crossings \\citep{Shandarin2012}, improve density measurements \\citep{Abel2012}, and yield a new approach for simulating the dark matter fluid \\citep{Hahn2013}. In addition, the study of caustics, the two-dimensional edges along which the dark matter sheet folds, brings in valuable insights into structure formation \\citep{Neyrinck2012}. Strong observational motivations exist for a Lagrangian understanding of the cosmic web. These include studying the dependence of galaxy properties on their evolving environment \\citep[e.g.][]{Blanton2005a}, probing the effect of the dynamic large-scale structure on the cosmic microwave background \\citep[e.g.][]{Planck2013ISW}, testing the standard general-relativistic picture of gravitational instability \\citep{Falck2015a}, and identifying the most promising regions to observe a possible dark matter annihilation signal \\citep[e.g.][]{Gao2012}. \n\nUnfortunately, the Lagrangian picture cannot be readily applied to observational data. Difficulties are of two sorts: (i) the need for reconstructions of the dark matter density from galaxies, accounting for typical observational effects such as biases, survey mask and selection functions; and (ii) the need for corresponding initial conditions, which requires the reconstructions to be based on a physical picture of structure formation. For these reasons, most cosmic web analyses have been limited so far to simulations \\citep[see e.g.][for a recent study]{Cautun2014}. \\citet{Jasche2010a} and \\citet{Leclercq2015ST} addressed the first issue. Using real data, they presented Eulerian classifications of cosmic environments in constrained realizations of the large-scale structure. Importantly, they demonstrated capability of propagating observational uncertainties to cosmic web classification. Taking advantage of the inclusion of a physical model within the inference process, \\citet{Leclercq2015ST} also presented the first probabilistic analysis of proto-structures present in the initial density field. However, a complete investigation of the problem, including a probabilistic description of the Lagrangian dark matter sheet has not yet been performed in the literature.\n\nIn this letter, we present a full-scale Bayesian description of the Lagrangian volume covered by galaxies of the Sloan Digital Sky Survey (SDSS) main sample. This chrono-cosmography project builds upon the inference of the past and present cosmic structure in the SDSS \\citep{Jasche2015BORGSDSS}, performed using the {{\\textsc{borg}}} algorithm \\citep{Jasche2013BORG}. We start by describing our tools for analyzing the dark matter sheet, including the Lagrangian classifiers {{\\textsc{diva}}} and {{\\textsc{origami}}} (section \\ref{sec:Description of the Lagrangian sheet}). Building upon the {{\\textsc{borg}}} SDSS analysis, we then infer and classify the Lagrangian dark matter sheet (section \\ref{sec:Inference and classification of the dark matter sheet in the SDSS}). Finally, we show how to translate these results to Eulerian coordinates, in order to describe the redshift-zero cosmic web with Lagrangian classifiers (section \\ref{sec:Translation to Eulerian coordinates}).\n\n\\section{Description of the Lagrangian sheet}\n\\label{sec:Description of the Lagrangian sheet}\n\nIn our earlier analysis of the volume covered by the SDSS main sample galaxies \\citep{Leclercq2015ST}, we adopted the Eulerian cosmic web classifier known as the {{\\textsc{T-web}}} \\citep{Hahn2007a}. In this framework, structures are classified according to the sign of the eigenvalues $\\mu_1(\\vec{x}) \\le \\mu_2(\\vec{x}) \\leq \\mu_3(\\vec{x})$ of the tidal field tensor $\\mathscr{T}$, defined as the Hessian of the rescaled gravitational potential $\\Phi$:\n\n", "index": 1, "text": "\\begin{equation}\n\\mathscr{T}_{ij} \\equiv \\mathrm{H}(\\Phi)_{ij} = \\frac{\\partial^2 \\Phi}{\\partial \\vec{x}_i \\partial \\vec{x}_j},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"\\mathscr{T}_{ij}\\equiv\\mathrm{H}(\\Phi)_{ij}=\\frac{\\partial^{2}\\Phi}{\\partial%&#10;\\vec{x}_{i}\\partial\\vec{x}_{j}},\" display=\"block\"><mrow><mrow><msub><mi class=\"ltx_font_mathscript\">\ud835\udcaf</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2261</mo><mrow><mi mathvariant=\"normal\">H</mi><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">\u03a6</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub></mrow><mo>=</mo><mfrac><mrow><msup><mo>\u2202</mo><mn>2</mn></msup><mo>\u2061</mo><mi mathvariant=\"normal\">\u03a6</mi></mrow><mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><msub><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u2192</mo></mover><mi>i</mi></msub></mrow><mo>\u2062</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><msub><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u2192</mo></mover><mi>j</mi></msub></mrow></mrow></mfrac></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.00093.tex", "nexttext": "\n$\\delta$ being the local density contrast. A void point corresponds to no positive eigenvalue, a sheet to one, a filament to two, and a cluster to three positive eigenvalues.\n\nIn this section, we discuss two alternative methods that can be used for producing Lagrangian classifications of the cosmic web: {{\\textsc{diva}}} and {{\\textsc{origami}}}. They both rely on the displacement field $\\vec{\\Psi}(\\vec{q})$, which maps the initial (Lagrangian) position of particles $\\vec{q}$ to their final (Eulerian) position $\\vec{x}(\\vec{q})$ \\citep[see e.g.][]{Bernardeau2002}:\n\n", "itemtype": "equation", "pos": 7798, "prevtext": "\nwhere $\\Phi$ obeys the reduced Poisson equation\n\n", "index": 3, "text": "\\begin{equation}\n\\Delta \\Phi(\\vec{x}) = \\delta(\\vec{x}),\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"\\Delta\\Phi(\\vec{x})=\\delta(\\vec{x}),\" display=\"block\"><mrow><mrow><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><mi mathvariant=\"normal\">\u03a6</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u2192</mo></mover><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mi>\u03b4</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u2192</mo></mover><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.00093.tex", "nexttext": "\nWe denote by $J(\\vec{q})$ be the Jacobian of the transformation between Lagrangian and Eulerian coordinates, \n\n", "itemtype": "equation", "pos": 8441, "prevtext": "\n$\\delta$ being the local density contrast. A void point corresponds to no positive eigenvalue, a sheet to one, a filament to two, and a cluster to three positive eigenvalues.\n\nIn this section, we discuss two alternative methods that can be used for producing Lagrangian classifications of the cosmic web: {{\\textsc{diva}}} and {{\\textsc{origami}}}. They both rely on the displacement field $\\vec{\\Psi}(\\vec{q})$, which maps the initial (Lagrangian) position of particles $\\vec{q}$ to their final (Eulerian) position $\\vec{x}(\\vec{q})$ \\citep[see e.g.][]{Bernardeau2002}:\n\n", "index": 5, "text": "\\begin{equation}\n\\vec{x}(\\vec{q}) \\equiv \\vec{q} + \\vec{\\Psi}(\\vec{q}).\n\\label{eq:mapping}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"\\vec{x}(\\vec{q})\\equiv\\vec{q}+\\vec{\\Psi}(\\vec{q}).\" display=\"block\"><mrow><mrow><mrow><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u2192</mo></mover><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mi>q</mi><mo stretchy=\"false\">\u2192</mo></mover><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2261</mo><mrow><mover accent=\"true\"><mi>q</mi><mo stretchy=\"false\">\u2192</mo></mover><mo>+</mo><mrow><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a8</mi><mo stretchy=\"false\">\u2192</mo></mover><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mi>q</mi><mo stretchy=\"false\">\u2192</mo></mover><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.00093.tex", "nexttext": "\nwhere the deformation tensor $\\mathscr{D}_{\\ell m}$ can be written as the identity tensor $\\mathscr{I}_{\\ell m} \\equiv \\delta_{\\ell,m}$ plus the shear of the displacement, $\\mathscr{R}_{\\ell m} \\equiv \\partial \\vec{\\Psi}_\\ell /\\partial \\vec{q}_m$.\n\n\\begin{figure*}\n\\begin{center}\n\\includegraphics[width=\\textwidth]{dmsheet_1000.pdf}\n\\caption{One sample of the observed Lagrangian dark matter sheet, constrained by the SDSS main sample: {{\\textsc{diva}}} (left panel) and {{\\textsc{origami}}} (middle panel) classifications of particles, and the divergence of the displacement field $\\psi$ (right panel). In the first two panels, blue, green, yellow and red correspond to void, sheet filament and cluster particles, respectively.\\label{fig:dmsheet_1000}}\n\\end{center}\n\\end{figure*}\n\nIn analogy with the \\citet{Zeldovich1970} ``pancake'' theory, \\citet{Lavaux2010} propose to define cosmic structures using $\\lambda_1(\\vec{q}) \\leq \\lambda_2(\\vec{q}) \\leq \\lambda_3(\\vec{q})$, the eigenvalues of the shear of the displacement field, $\\mathscr{R}$. In the {{\\textsc{diva}}} (DynamIcal Void Analysis) scheme, a particle is defined as belonging to a Lagrangian void, sheet, filament or cluster, if, respectively, zero, one, two or three of the $\\lambda$s are positive.\n\nThe {{\\textsc{diva}}} and {{\\textsc{T-web}}} methods share strong similarity in their formalism. However, a major difference is that the {{\\textsc{T-web}}} operates on \\textit{voxels} of the discretized domain, whereas {{\\textsc{diva}}} operates on \\textit{Lagrangian patches} (numerically approximated by particles). As shown in \\citet[][sections III and IV]{Leclercq2015ST}, the {{\\textsc{T-web}}} can be used to classify both early-time and late-time structures; however the {{\\textsc{T-web}}} classification of early-time structures is performed at the level of voxels of the discretized initial density field, whereas the {{\\textsc{diva}}} classification of Lagrangian structures is performed at the level of particles of the dark matter sheet.\n\nAnother way of classifying these particles is to consider them as vertices of an initially regular grid, distorted by gravity as the large-scale structure forms. Shell-crossing happens when Lagrangian cells collapse or invert. A particle's {{\\textsc{origami}}} (Order-ReversIng Gravity, Apprehended Mangling Indices) morphology is defined by the number of orthogonal axes along which shell-crossing has occurred \\citep{Falck2012}. More precisely, void, sheet, filament, and cluster particles are defined as particles that have been crossed along zero, one, two, and three orthogonal axes, respectively.\n\nIn practice, the computer implementation of {{\\textsc{origami}}} works as follows: a particle $\\ell$ has been crossed along an axis $\\hat{n}$ if there exists a particle $m$ in the same row of the Lagrangian grid, such that $(\\vec{q}_\\ell-\\vec{q}_m)\\cdot\\hat{n}$ and $(\\vec{x}_\\ell-\\vec{x}_m)\\cdot\\hat{n}$ have opposite sign. Such particle-crossing are checked along the three orthogonal axes of the original Cartesian grid, as well as three triplets of orthogonal axes, obtained by rotating the original grid by 45$\\degree$ along one of its axes. For more details, the reader is referred to section 2.1 in \\citet{Falck2012}.\n\n\\section{Lagrangian analysis of the SDSS volume}\n\\label{sec:Inference and classification of the dark matter sheet in the SDSS}\n\nAs mentioned in the introduction, this paper is part of a series following the recent application of the Bayesian inference framework {{\\textsc{borg}}} to the SDSS main sample galaxies \\citep{Jasche2015BORGSDSS}. We further rely on the set of constrained simulations presented in \\citet{Leclercq2015ST}. These realizations are obtained, starting from {{\\textsc{borg}}} initial conditions, by non-linear filtering with {{\\textsc{cola}}} \\citep{Tassev2013}. The initial density field, defined on a $256^3$-voxel grid with side length of $750$~Mpc/$h$, is populated by $512^3$ dark matter particles placed on a regular Lagrangian lattice. Particles are evolved with 2LPT to the redshift of $z=69$ then with 30 {{\\textsc{cola}}} timesteps from $z=69$ to $z=0$.\n\n\\citet{Lavaux2010} and \\citet{Falck2012} discuss the possibility of smoothing the displacement field at different Lagrangian scales, in order to probe the hierarchical cosmic web. While this would be perfectly feasible in our framework, we chose to focus our analysis on the scale naturally defined by our setup, without an additional smoothing step. This choice corresponds to a resolution of $\\sim 1.5$~Mpc/$h$ for the Lagrangian grid ($512^3$ particles in a $750$~Mpc/$h$ cubic box) and $\\sim 3$~Mpc/$h$ for discretized maps (on a $256^3$-voxel grid). \n\nThe displacement field is obtained on the Lagrangian lattice by subtracting the final position of particles from their initial position. We then assign a Lagrangian structure type to each of them, according to the {{\\textsc{diva}}} and {{\\textsc{origami}}} procedures. For {{\\textsc{diva}}}, the components of the shear of the displacement field are evaluated numerically by means of fast Fourier transforms on the Lagrangian grid. In figure \\ref{fig:dmsheet_1000}, we represent the Lagrangian grid of particles in one of our constrained samples.\\footnote{In the plots of this paper, we kept the coordinate system of \\citet{Jasche2015BORGSDSS} and limited the slice to a square of $500$~Mpc/$h$ side for improved clarity.} The first two panels show the {{\\textsc{diva}}} and {{\\textsc{origami}}} morphologies of the dark matter sheet. For comparison, the last panel shows the divergence of the displacement field $\\psi \\equiv \\vec{\\nabla} \\cdot \\vec{\\Psi}$ for the same particles, computed using a fast Fourier transform on the Lagrangian grid. \n\nOur constrained samples exhibit the same behavior as previously observed in simulations. {{\\textsc{diva}}} and {{\\textsc{origami}}} structures correlate well with $\\psi$, which quantifies the angle-average stretching and distortion of the dark matter sheet \\citep{Neyrinck2013}. In particular, {{\\textsc{diva}}} and {{\\textsc{origami}}} clusters nicely correspond to the Lagrangian ``lakes'' where $\\psi \\approx -3$. Note that in this analysis, we are taking advantage of the absence of substantial vorticity on large scales \\citep[see e.g.][]{Bernardeau2002}. Indeed, since the displacement field in Lagrangian perturbation theory is curl-free up to second order (2LPT), and since {{\\textsc{borg}}} relies on 2LPT as a proxy for gravitational dynamics \\citep{Jasche2013BORG}, any vorticity present in our large-scale structure realizations is not constrained by the data. However, as shown by \\citet{Chan2014}, at $z=0$ and up to $k \\approx 1$~Mpc/$h$, the contribution to the power spectrum of $\\vec{\\Psi}$ coming from its curl component remains negligible compared to the non-linear evolution of its scalar part. For the sake of our analysis, it is therefore safe to assume that all the information on $\\vec{\\Psi}$ is contained in its divergence $\\psi$.\n\n\\begin{figure*}\n\\begin{center}\n\\includegraphics[width=\\textwidth]{diva_lambda_jacobian_mean.pdf}\n\\caption{Uncertainty quantification of the observed Lagrangian dark matter sheet. In the three leftmost panels, the posterior mean of the eigenvalues of the displacement shear tensor, $\\lambda_1(\\vec{q}) \\leq \\lambda_2(\\vec{q}) \\leq \\lambda_3(\\vec{q})$, are shown. The right panel shows the mean of the Jacobian $J(\\vec{q})$. Particles are colored according to their Eulerian volume times their parity. The color scale is streched around zero with the function $x \\mapsto \\mathrm{argsinh}(10^3 \\,x)$. \\label{fig:diva_lambda_mean}}\n\\end{center}\n\\end{figure*}\n\nAs in our previous work \\citep{Jasche2015BORGSDSS,Leclercq2015ST,Lavaux2016BORG2MPP}, the variation between constrained samples constitutes a Bayesian quantification of uncertainties (coming in particular from the survey mask and selection effects). This is illustrated in figure \\ref{fig:diva_lambda_mean}, where we show the particle-wise posterior mean of different quantities on the Lagrangian grid. The three leftmost panels are the eigenvalues of the displacement shear tensor, $\\lambda_1(\\vec{q}) \\leq \\lambda_2(\\vec{q}) \\leq \\lambda_3(\\vec{q})$. The right panel shows the Jacobian of the transformation from Lagrangian to Eulerian coordinates, $J(\\vec{q}) = (1+\\lambda_1(\\vec{q}))(1+\\lambda_2(\\vec{q}))(1+\\lambda_3(\\vec{q}))$. For each particle, it is the volume of the associated fluid element times its parity \\citep{White2009,Neyrinck2012}. White/blue particles have the same parity as in the initial conditions, while black/orange particles have swapped parity. Caustics are clearly visible wherever blue and orange regions are juxtaposed, for example in the patches that collapse to form halos and in the shell-crossed walls surrounding voids.\n\n\\begin{figure*}\n\\begin{center}\n{{\\textsc{diva}}}\n\\includegraphics[width=\\textwidth]{diva_pdf_initial.pdf}\n{{\\textsc{origami}}}\n\\includegraphics[width=\\textwidth]{origami_pdf_initial.pdf}\n\\caption{Slices through the posterior probabilities for different structure types (from left to right: void, sheet, filament, and cluster), in the primordial large-scale structure in the Sloan volume ($a=10^{-3}$). These four three-dimensional probabilities sum up to one at each location. Structures are defined on the Lagrangian grid of $512^3$ particles with {{\\textsc{diva}}} (first row) or {{\\textsc{origami}}} (second row). For comparison, the reader is referred to figure 6 in \\citet{Leclercq2015ST}, where the primordial density field, defined on a $256^3$-voxel grid, is classified according to the {{\\textsc{T-web}}} procedure.\\label{fig:pdf_initial}}\n\\end{center}\n\\end{figure*}\n\nUncertainty quantification can also be self-consistently propagated to Lagrangian structure type classification. Let us denote by $\\xi$ one of the Lagrangian classifiers ({{\\textsc{diva}}} or {{\\textsc{origami}}). In a specific realization, $\\xi$ uniquely characterizes the Lagrangian grid, meaning that it provides four particle-wise scalar fields that obey the following conditions for each particle $\\vec{q}_\\ell$:\n\n", "itemtype": "equation", "pos": 8657, "prevtext": "\nWe denote by $J(\\vec{q})$ be the Jacobian of the transformation between Lagrangian and Eulerian coordinates, \n\n", "index": 7, "text": "\\begin{equation}\nJ(\\vec{q}) \\equiv \\det \\left[ \\frac{\\partial \\vec{x}}{\\partial \\vec{q}} \\right] = \\det \\mathscr{D} = \\det ( \\mathscr{I} + \\mathscr{R} ),\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"J(\\vec{q})\\equiv\\det\\left[\\frac{\\partial\\vec{x}}{\\partial\\vec{q}}\\right]=\\det%&#10;\\mathscr{D}=\\det(\\mathscr{I}+\\mathscr{R}),\" display=\"block\"><mrow><mrow><mrow><mi>J</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mi>q</mi><mo stretchy=\"false\">\u2192</mo></mover><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2261</mo><mrow><mo movablelimits=\"false\">det</mo><mo>\u2061</mo><mrow><mo>[</mo><mfrac><mrow><mo>\u2202</mo><mo>\u2061</mo><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u2192</mo></mover></mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><mover accent=\"true\"><mi>q</mi><mo stretchy=\"false\">\u2192</mo></mover></mrow></mfrac><mo>]</mo></mrow></mrow><mo>=</mo><mrow><mo movablelimits=\"false\">det</mo><mo>\u2061</mo><mi class=\"ltx_font_mathscript\">\ud835\udc9f</mi></mrow><mo>=</mo><mrow><mo movablelimits=\"false\">det</mo><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi class=\"ltx_font_mathscript\">\u2110</mi><mo>+</mo><mi class=\"ltx_font_mathscript\">\u211b</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.00093.tex", "nexttext": "\nwhere $\\mathrm{T}_0=$ void, $\\mathrm{T}_1=$ sheet, $\\mathrm{T}_2=$ filament, $\\mathrm{T}_3=$ cluster. By applying $\\xi$ to the complete set of {{\\textsc{borg}}}-{{\\textsc{cola}}} realizations, we can quantify the degree of belief in structure type classification in terms of four particle-wise scalar fields that obey the following conditions for each particle $\\vec{q}_\\ell$:\n\n", "itemtype": "equation", "pos": 18928, "prevtext": "\nwhere the deformation tensor $\\mathscr{D}_{\\ell m}$ can be written as the identity tensor $\\mathscr{I}_{\\ell m} \\equiv \\delta_{\\ell,m}$ plus the shear of the displacement, $\\mathscr{R}_{\\ell m} \\equiv \\partial \\vec{\\Psi}_\\ell /\\partial \\vec{q}_m$.\n\n\\begin{figure*}\n\\begin{center}\n\\includegraphics[width=\\textwidth]{dmsheet_1000.pdf}\n\\caption{One sample of the observed Lagrangian dark matter sheet, constrained by the SDSS main sample: {{\\textsc{diva}}} (left panel) and {{\\textsc{origami}}} (middle panel) classifications of particles, and the divergence of the displacement field $\\psi$ (right panel). In the first two panels, blue, green, yellow and red correspond to void, sheet filament and cluster particles, respectively.\\label{fig:dmsheet_1000}}\n\\end{center}\n\\end{figure*}\n\nIn analogy with the \\citet{Zeldovich1970} ``pancake'' theory, \\citet{Lavaux2010} propose to define cosmic structures using $\\lambda_1(\\vec{q}) \\leq \\lambda_2(\\vec{q}) \\leq \\lambda_3(\\vec{q})$, the eigenvalues of the shear of the displacement field, $\\mathscr{R}$. In the {{\\textsc{diva}}} (DynamIcal Void Analysis) scheme, a particle is defined as belonging to a Lagrangian void, sheet, filament or cluster, if, respectively, zero, one, two or three of the $\\lambda$s are positive.\n\nThe {{\\textsc{diva}}} and {{\\textsc{T-web}}} methods share strong similarity in their formalism. However, a major difference is that the {{\\textsc{T-web}}} operates on \\textit{voxels} of the discretized domain, whereas {{\\textsc{diva}}} operates on \\textit{Lagrangian patches} (numerically approximated by particles). As shown in \\citet[][sections III and IV]{Leclercq2015ST}, the {{\\textsc{T-web}}} can be used to classify both early-time and late-time structures; however the {{\\textsc{T-web}}} classification of early-time structures is performed at the level of voxels of the discretized initial density field, whereas the {{\\textsc{diva}}} classification of Lagrangian structures is performed at the level of particles of the dark matter sheet.\n\nAnother way of classifying these particles is to consider them as vertices of an initially regular grid, distorted by gravity as the large-scale structure forms. Shell-crossing happens when Lagrangian cells collapse or invert. A particle's {{\\textsc{origami}}} (Order-ReversIng Gravity, Apprehended Mangling Indices) morphology is defined by the number of orthogonal axes along which shell-crossing has occurred \\citep{Falck2012}. More precisely, void, sheet, filament, and cluster particles are defined as particles that have been crossed along zero, one, two, and three orthogonal axes, respectively.\n\nIn practice, the computer implementation of {{\\textsc{origami}}} works as follows: a particle $\\ell$ has been crossed along an axis $\\hat{n}$ if there exists a particle $m$ in the same row of the Lagrangian grid, such that $(\\vec{q}_\\ell-\\vec{q}_m)\\cdot\\hat{n}$ and $(\\vec{x}_\\ell-\\vec{x}_m)\\cdot\\hat{n}$ have opposite sign. Such particle-crossing are checked along the three orthogonal axes of the original Cartesian grid, as well as three triplets of orthogonal axes, obtained by rotating the original grid by 45$\\degree$ along one of its axes. For more details, the reader is referred to section 2.1 in \\citet{Falck2012}.\n\n\\section{Lagrangian analysis of the SDSS volume}\n\\label{sec:Inference and classification of the dark matter sheet in the SDSS}\n\nAs mentioned in the introduction, this paper is part of a series following the recent application of the Bayesian inference framework {{\\textsc{borg}}} to the SDSS main sample galaxies \\citep{Jasche2015BORGSDSS}. We further rely on the set of constrained simulations presented in \\citet{Leclercq2015ST}. These realizations are obtained, starting from {{\\textsc{borg}}} initial conditions, by non-linear filtering with {{\\textsc{cola}}} \\citep{Tassev2013}. The initial density field, defined on a $256^3$-voxel grid with side length of $750$~Mpc/$h$, is populated by $512^3$ dark matter particles placed on a regular Lagrangian lattice. Particles are evolved with 2LPT to the redshift of $z=69$ then with 30 {{\\textsc{cola}}} timesteps from $z=69$ to $z=0$.\n\n\\citet{Lavaux2010} and \\citet{Falck2012} discuss the possibility of smoothing the displacement field at different Lagrangian scales, in order to probe the hierarchical cosmic web. While this would be perfectly feasible in our framework, we chose to focus our analysis on the scale naturally defined by our setup, without an additional smoothing step. This choice corresponds to a resolution of $\\sim 1.5$~Mpc/$h$ for the Lagrangian grid ($512^3$ particles in a $750$~Mpc/$h$ cubic box) and $\\sim 3$~Mpc/$h$ for discretized maps (on a $256^3$-voxel grid). \n\nThe displacement field is obtained on the Lagrangian lattice by subtracting the final position of particles from their initial position. We then assign a Lagrangian structure type to each of them, according to the {{\\textsc{diva}}} and {{\\textsc{origami}}} procedures. For {{\\textsc{diva}}}, the components of the shear of the displacement field are evaluated numerically by means of fast Fourier transforms on the Lagrangian grid. In figure \\ref{fig:dmsheet_1000}, we represent the Lagrangian grid of particles in one of our constrained samples.\\footnote{In the plots of this paper, we kept the coordinate system of \\citet{Jasche2015BORGSDSS} and limited the slice to a square of $500$~Mpc/$h$ side for improved clarity.} The first two panels show the {{\\textsc{diva}}} and {{\\textsc{origami}}} morphologies of the dark matter sheet. For comparison, the last panel shows the divergence of the displacement field $\\psi \\equiv \\vec{\\nabla} \\cdot \\vec{\\Psi}$ for the same particles, computed using a fast Fourier transform on the Lagrangian grid. \n\nOur constrained samples exhibit the same behavior as previously observed in simulations. {{\\textsc{diva}}} and {{\\textsc{origami}}} structures correlate well with $\\psi$, which quantifies the angle-average stretching and distortion of the dark matter sheet \\citep{Neyrinck2013}. In particular, {{\\textsc{diva}}} and {{\\textsc{origami}}} clusters nicely correspond to the Lagrangian ``lakes'' where $\\psi \\approx -3$. Note that in this analysis, we are taking advantage of the absence of substantial vorticity on large scales \\citep[see e.g.][]{Bernardeau2002}. Indeed, since the displacement field in Lagrangian perturbation theory is curl-free up to second order (2LPT), and since {{\\textsc{borg}}} relies on 2LPT as a proxy for gravitational dynamics \\citep{Jasche2013BORG}, any vorticity present in our large-scale structure realizations is not constrained by the data. However, as shown by \\citet{Chan2014}, at $z=0$ and up to $k \\approx 1$~Mpc/$h$, the contribution to the power spectrum of $\\vec{\\Psi}$ coming from its curl component remains negligible compared to the non-linear evolution of its scalar part. For the sake of our analysis, it is therefore safe to assume that all the information on $\\vec{\\Psi}$ is contained in its divergence $\\psi$.\n\n\\begin{figure*}\n\\begin{center}\n\\includegraphics[width=\\textwidth]{diva_lambda_jacobian_mean.pdf}\n\\caption{Uncertainty quantification of the observed Lagrangian dark matter sheet. In the three leftmost panels, the posterior mean of the eigenvalues of the displacement shear tensor, $\\lambda_1(\\vec{q}) \\leq \\lambda_2(\\vec{q}) \\leq \\lambda_3(\\vec{q})$, are shown. The right panel shows the mean of the Jacobian $J(\\vec{q})$. Particles are colored according to their Eulerian volume times their parity. The color scale is streched around zero with the function $x \\mapsto \\mathrm{argsinh}(10^3 \\,x)$. \\label{fig:diva_lambda_mean}}\n\\end{center}\n\\end{figure*}\n\nAs in our previous work \\citep{Jasche2015BORGSDSS,Leclercq2015ST,Lavaux2016BORG2MPP}, the variation between constrained samples constitutes a Bayesian quantification of uncertainties (coming in particular from the survey mask and selection effects). This is illustrated in figure \\ref{fig:diva_lambda_mean}, where we show the particle-wise posterior mean of different quantities on the Lagrangian grid. The three leftmost panels are the eigenvalues of the displacement shear tensor, $\\lambda_1(\\vec{q}) \\leq \\lambda_2(\\vec{q}) \\leq \\lambda_3(\\vec{q})$. The right panel shows the Jacobian of the transformation from Lagrangian to Eulerian coordinates, $J(\\vec{q}) = (1+\\lambda_1(\\vec{q}))(1+\\lambda_2(\\vec{q}))(1+\\lambda_3(\\vec{q}))$. For each particle, it is the volume of the associated fluid element times its parity \\citep{White2009,Neyrinck2012}. White/blue particles have the same parity as in the initial conditions, while black/orange particles have swapped parity. Caustics are clearly visible wherever blue and orange regions are juxtaposed, for example in the patches that collapse to form halos and in the shell-crossed walls surrounding voids.\n\n\\begin{figure*}\n\\begin{center}\n{{\\textsc{diva}}}\n\\includegraphics[width=\\textwidth]{diva_pdf_initial.pdf}\n{{\\textsc{origami}}}\n\\includegraphics[width=\\textwidth]{origami_pdf_initial.pdf}\n\\caption{Slices through the posterior probabilities for different structure types (from left to right: void, sheet, filament, and cluster), in the primordial large-scale structure in the Sloan volume ($a=10^{-3}$). These four three-dimensional probabilities sum up to one at each location. Structures are defined on the Lagrangian grid of $512^3$ particles with {{\\textsc{diva}}} (first row) or {{\\textsc{origami}}} (second row). For comparison, the reader is referred to figure 6 in \\citet{Leclercq2015ST}, where the primordial density field, defined on a $256^3$-voxel grid, is classified according to the {{\\textsc{T-web}}} procedure.\\label{fig:pdf_initial}}\n\\end{center}\n\\end{figure*}\n\nUncertainty quantification can also be self-consistently propagated to Lagrangian structure type classification. Let us denote by $\\xi$ one of the Lagrangian classifiers ({{\\textsc{diva}}} or {{\\textsc{origami}}). In a specific realization, $\\xi$ uniquely characterizes the Lagrangian grid, meaning that it provides four particle-wise scalar fields that obey the following conditions for each particle $\\vec{q}_\\ell$:\n\n", "index": 9, "text": "\\begin{equation}\n\\mathrm{T}_i(\\vec{q}_\\ell|\\xi) \\in \\{0,1\\} \\; \\mathrm{for} \\; i \\in \\llbracket 0,3 \\rrbracket \\quad \\mathrm{and} \\quad \\sum_{i=0}^{3} \\mathrm{T}_i(\\vec{q}_\\ell|\\xi) = 1 \n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"\\mathrm{T}_{i}(\\vec{q}_{\\ell}|\\xi)\\in\\{0,1\\}\\;\\mathrm{for}\\;i\\in\\llbracket 0,3%&#10;\\rrbracket\\quad\\mathrm{and}\\quad\\sum_{i=0}^{3}\\mathrm{T}_{i}(\\vec{q}_{\\ell}|%&#10;\\xi)=1\" display=\"block\"><mrow><msub><mi mathvariant=\"normal\">T</mi><mi>i</mi></msub><mrow><mo stretchy=\"false\">(</mo><msub><mover accent=\"true\"><mi>q</mi><mo stretchy=\"false\">\u2192</mo></mover><mi mathvariant=\"normal\">\u2113</mi></msub><mo stretchy=\"false\">|</mo><mi>\u03be</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2208</mo><mrow><mo stretchy=\"false\">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo rspace=\"5.3pt\" stretchy=\"false\">}</mo></mrow><mpadded width=\"+2.8pt\"><mi>for</mi></mpadded><mi>i</mi><mo>\u2208</mo><mrow><mo fence=\"true\">\u27e6</mo><mn>0</mn><mo>,</mo><mn>3</mn><mo fence=\"true\">\u27e7</mo></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003</mo><mi>and</mi><mo mathvariant=\"italic\" separator=\"true\">\u2003</mo><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mn>3</mn></munderover><msub><mi mathvariant=\"normal\">T</mi><mi>i</mi></msub><mrow><mo stretchy=\"false\">(</mo><msub><mover accent=\"true\"><mi>q</mi><mo stretchy=\"false\">\u2192</mo></mover><mi mathvariant=\"normal\">\u2113</mi></msub><mo stretchy=\"false\">|</mo><mi>\u03be</mi><mo stretchy=\"false\">)</mo></mrow><mo>=</mo><mn>1</mn></mrow></math>", "type": "latex"}, {"file": "1601.00093.tex", "nexttext": " \nHere, $\\mathcal{T}_i(\\vec{q}_\\ell|\\xi) \\equiv \\left\\langle \\mathrm{T}_i(\\vec{q}_\\ell|\\xi) \\right\\rangle_{\\mathcal{P}(\\mathrm{T}_i(\\vec{q}_\\ell)|d,\\xi)} = \\mathcal{P}(\\mathrm{T}_i(\\vec{q}_\\ell)|d,\\xi)$ are the posterior probability distribution functions (pdfs) for particle $\\vec{q}_\\ell$ to belong to structure $\\mathrm{T}_i$, as defined by classifier $\\xi$, conditional on the data $d$. These are estimated by counting the relatives frequencies at each individual particle position within the set of $\\xi$-realizations \\citep[see also][]{Jasche2010a,Leclercq2015ST}. Therefore, the cosmic web-type pdf mean on the Lagrangian grid is given by\n\n", "itemtype": "equation", "pos": -1, "prevtext": "\nwhere $\\mathrm{T}_0=$ void, $\\mathrm{T}_1=$ sheet, $\\mathrm{T}_2=$ filament, $\\mathrm{T}_3=$ cluster. By applying $\\xi$ to the complete set of {{\\textsc{borg}}}-{{\\textsc{cola}}} realizations, we can quantify the degree of belief in structure type classification in terms of four particle-wise scalar fields that obey the following conditions for each particle $\\vec{q}_\\ell$:\n\n", "index": 11, "text": "\\begin{equation}\n\\mathcal{T}_i(\\vec{q}_\\ell|\\xi) \\in [0,1] \\; \\mathrm{for} \\; i \\in \\llbracket 0,3 \\rrbracket \\quad \\mathrm{and} \\quad \\sum_{i=0}^{3} \\mathcal{T}_i(\\vec{q}_\\ell|\\xi) = 1 .\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"\\mathcal{T}_{i}(\\vec{q}_{\\ell}|\\xi)\\in[0,1]\\;\\mathrm{for}\\;i\\in\\llbracket 0,3%&#10;\\rrbracket\\quad\\mathrm{and}\\quad\\sum_{i=0}^{3}\\mathcal{T}_{i}(\\vec{q}_{\\ell}|%&#10;\\xi)=1.\" display=\"block\"><mrow><msub><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcaf</mi><mi>i</mi></msub><mrow><mo stretchy=\"false\">(</mo><msub><mover accent=\"true\"><mi>q</mi><mo stretchy=\"false\">\u2192</mo></mover><mi mathvariant=\"normal\">\u2113</mi></msub><mo stretchy=\"false\">|</mo><mi>\u03be</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2208</mo><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo rspace=\"5.3pt\" stretchy=\"false\">]</mo></mrow><mpadded width=\"+2.8pt\"><mi>for</mi></mpadded><mi>i</mi><mo>\u2208</mo><mrow><mo fence=\"true\">\u27e6</mo><mn>0</mn><mo>,</mo><mn>3</mn><mo fence=\"true\">\u27e7</mo></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003</mo><mi>and</mi><mo mathvariant=\"italic\" separator=\"true\">\u2003</mo><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mn>3</mn></munderover><msub><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcaf</mi><mi>i</mi></msub><mrow><mo stretchy=\"false\">(</mo><msub><mover accent=\"true\"><mi>q</mi><mo stretchy=\"false\">\u2192</mo></mover><mi mathvariant=\"normal\">\u2113</mi></msub><mo stretchy=\"false\">|</mo><mi>\u03be</mi><mo stretchy=\"false\">)</mo></mrow><mo>=</mo><mn>1</mn><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.00093.tex", "nexttext": "\nwhere $n$ labels one of the $N$ samples, $\\mathrm{T}^n_j(\\vec{q}_\\ell|\\xi)$ is the result of classifier $\\xi$ on the $n$-th sample at particle position $\\vec{q}_\\ell$ (i.e. a unit four-vector containing zeros except for one component, which indicates the structure type), and $\\delta^{(\\mathrm{K})}$ is a Kronecker symbol.\n\nUsing the above definitions, we obtain probabilistic maps of structures on the Lagrangian grid describing the early Universe in the volume probed by SDSS main sample galaxies. More precisely, for each classifier $\\xi$, we obtain a probability mass function (pmf) at each particle position on the Lagrangian grid, indicating the possibility to encounter a specific structure type (cluster, filament, sheet, void) at that position. These pmfs consist of four numbers in the range $[0,1]$, $\\mathcal{P}(\\mathrm{T}_i(\\vec{q}_\\ell)|d,\\xi)$, that sum up to one for each particle. They are approximated by the mean of each structure pdf (see equation \\ref{eq:pdf_mean}).\n\nIn figure \\ref{fig:pdf_initial}, we show slices through these web-type posterior probabilities. The rows represent the structures inferred using {{\\textsc{diva}}} and {{\\textsc{origami}}}, respectively. For comparison, the reader is referred to figure 6 in \\citet{Leclercq2015ST}, which shows structures inferred in the initial density field using the {{\\textsc{T-web}}}. Note that the {{\\textsc{diva}}} and {{\\textsc{origami}}} results are defined on the Lagrangian grid of $512^3$ particles, whereas the {{\\textsc{T-web}}} result is defined on the $256^3$-voxel grid on which initial density fields are characterized. The plot shows the anticipated behavior, with values close to certainty (i.e. zero or one) in regions covered by data, while the unobserved regions (at high redshift or out of the survey boundary) approach a uniform value corresponding to the prior. It is worth noting that different classifiers can have very different prior probabilities for the same structure types.\n\n\\section{Translation to Eulerian coordinates}\n\\label{sec:Translation to Eulerian coordinates}\n\n\\begin{figure*}\n\\begin{center}\n{{\\textsc{diva}}}\n\\includegraphics[width=\\textwidth]{diva_pdf_final.pdf}\n{{\\textsc{origami}}}\n\\includegraphics[width=\\textwidth]{origami_pdf_final.pdf}\n\\caption{Slice through the posterior probabilities for different structure types (from left to right: void, sheet, filament, and cluster), in the late-time large-scale structure in the Sloan volume ($a=1$).  These four three-dimensional probabilities, defined on a $256^3$-voxel grid, sum up to one on a voxel basis. Structure types are classified using {{\\textsc{diva}}} (first row) or {{\\textsc{origami}}} (second row). For comparison, the reader is referred to figure 3 in \\citet{Leclercq2015ST}, where structures are classified according to the {{\\textsc{T-web}}} procedure.\\label{fig:pdf_final}}\n\\end{center}\n\\end{figure*}\n\nIn the previous section, we have considered classifications on the Lagrangian dark matter sheet. In order to classify structures at redshift zero, it is possible to translate the {{\\textsc{diva}}} and {{\\textsc{origami}}} results into Eulerian coordinates. To do so, we consider particles at their final positions and assign them to a $256^3$-voxel grid using the cloud-in-cell (CiC) scheme. For structure type $\\mathrm{T}_i$, each particle gets a weight of $1$ if its Lagrangian classification is $\\mathrm{T}_i$, and 0 otherwise. In each voxel, we then count the relative frequencies for each mass-weighted structure type. In this fashion, in each realization $n$, we obtain four probabilities, in the range $[0,1]$, for a final Eulerian voxel to belong to each of the structure types. We denote them by $\\mathcal{P}_n(\\mathrm{T}_i(\\vec{x}_k)|d,\\xi)$. In general, we have $\\mathcal{S}_n(\\vec{x}_k) \\equiv \\sum_{i=0}^3 \\mathcal{P}_n(\\mathrm{T}_i(\\vec{x}_k)|d,\\xi) = 1$; this sum is $0$ if and only if, in realization $n$, no particle was assigned to the cell $\\vec{x}_k$ by the CiC scheme (i.e. it is empty as well as its eight neighbors). These voxels are flagged as noisy and discarded.\n\nIt is then possible to go from these per-sample pdfs to a global pdf for the entire analysis, in a similar way as before: we count the relative frequencies of the probabilities at each Eulerian spatial position within the set of samples. With this definition, the web-type posterior mean is given by\n\n", "itemtype": "equation", "pos": 20355, "prevtext": " \nHere, $\\mathcal{T}_i(\\vec{q}_\\ell|\\xi) \\equiv \\left\\langle \\mathrm{T}_i(\\vec{q}_\\ell|\\xi) \\right\\rangle_{\\mathcal{P}(\\mathrm{T}_i(\\vec{q}_\\ell)|d,\\xi)} = \\mathcal{P}(\\mathrm{T}_i(\\vec{q}_\\ell)|d,\\xi)$ are the posterior probability distribution functions (pdfs) for particle $\\vec{q}_\\ell$ to belong to structure $\\mathrm{T}_i$, as defined by classifier $\\xi$, conditional on the data $d$. These are estimated by counting the relatives frequencies at each individual particle position within the set of $\\xi$-realizations \\citep[see also][]{Jasche2010a,Leclercq2015ST}. Therefore, the cosmic web-type pdf mean on the Lagrangian grid is given by\n\n", "index": 13, "text": "\\begin{equation}\n\\left\\langle \\mathcal{P}(\\mathrm{T}_i(\\vec{q}_\\ell)|d,\\xi) \\right\\rangle = \\frac{1}{N}\\sum_{n=1}^{N} \\sum_{j=0}^{3} \\delta^{(\\mathrm{K})}_{\\mathrm{T}_i(\\vec{q}_\\ell)\\mathrm{T}^n_j(\\vec{q}_\\ell|\\xi)} ,\n\\label{eq:pdf_mean}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"\\left\\langle\\mathcal{P}(\\mathrm{T}_{i}(\\vec{q}_{\\ell})|d,\\xi)\\right\\rangle=%&#10;\\frac{1}{N}\\sum_{n=1}^{N}\\sum_{j=0}^{3}\\delta^{(\\mathrm{K})}_{\\mathrm{T}_{i}(%&#10;\\vec{q}_{\\ell})\\mathrm{T}^{n}_{j}(\\vec{q}_{\\ell}|\\xi)},\" display=\"block\"><mrow><mrow><mo>\u27e8</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcab</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"normal\">T</mi><mi>i</mi></msub><mrow><mo stretchy=\"false\">(</mo><msub><mover accent=\"true\"><mi>q</mi><mo stretchy=\"false\">\u2192</mo></mover><mi mathvariant=\"normal\">\u2113</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">|</mo><mi>d</mi><mo>,</mo><mi>\u03be</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u27e9</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mn>3</mn></munderover><msubsup><mi>\u03b4</mi><mrow><msub><mi mathvariant=\"normal\">T</mi><mi>i</mi></msub><mrow><mo stretchy=\"false\">(</mo><msub><mover accent=\"true\"><mi>q</mi><mo stretchy=\"false\">\u2192</mo></mover><mi mathvariant=\"normal\">\u2113</mi></msub><mo stretchy=\"false\">)</mo></mrow><msubsup><mi mathvariant=\"normal\">T</mi><mi>j</mi><mi>n</mi></msubsup><mrow><mo stretchy=\"false\">(</mo><msub><mover accent=\"true\"><mi>q</mi><mo stretchy=\"false\">\u2192</mo></mover><mi mathvariant=\"normal\">\u2113</mi></msub><mo stretchy=\"false\">|</mo><mi>\u03be</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">K</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.00093.tex", "nexttext": "\nwhere $n$ labels one of the $N$ samples, and the normalization $N_{\\vec{x}_k}$ in voxel $\\vec{x}_k$ is\n\n", "itemtype": "equation", "pos": 24985, "prevtext": "\nwhere $n$ labels one of the $N$ samples, $\\mathrm{T}^n_j(\\vec{q}_\\ell|\\xi)$ is the result of classifier $\\xi$ on the $n$-th sample at particle position $\\vec{q}_\\ell$ (i.e. a unit four-vector containing zeros except for one component, which indicates the structure type), and $\\delta^{(\\mathrm{K})}$ is a Kronecker symbol.\n\nUsing the above definitions, we obtain probabilistic maps of structures on the Lagrangian grid describing the early Universe in the volume probed by SDSS main sample galaxies. More precisely, for each classifier $\\xi$, we obtain a probability mass function (pmf) at each particle position on the Lagrangian grid, indicating the possibility to encounter a specific structure type (cluster, filament, sheet, void) at that position. These pmfs consist of four numbers in the range $[0,1]$, $\\mathcal{P}(\\mathrm{T}_i(\\vec{q}_\\ell)|d,\\xi)$, that sum up to one for each particle. They are approximated by the mean of each structure pdf (see equation \\ref{eq:pdf_mean}).\n\nIn figure \\ref{fig:pdf_initial}, we show slices through these web-type posterior probabilities. The rows represent the structures inferred using {{\\textsc{diva}}} and {{\\textsc{origami}}}, respectively. For comparison, the reader is referred to figure 6 in \\citet{Leclercq2015ST}, which shows structures inferred in the initial density field using the {{\\textsc{T-web}}}. Note that the {{\\textsc{diva}}} and {{\\textsc{origami}}} results are defined on the Lagrangian grid of $512^3$ particles, whereas the {{\\textsc{T-web}}} result is defined on the $256^3$-voxel grid on which initial density fields are characterized. The plot shows the anticipated behavior, with values close to certainty (i.e. zero or one) in regions covered by data, while the unobserved regions (at high redshift or out of the survey boundary) approach a uniform value corresponding to the prior. It is worth noting that different classifiers can have very different prior probabilities for the same structure types.\n\n\\section{Translation to Eulerian coordinates}\n\\label{sec:Translation to Eulerian coordinates}\n\n\\begin{figure*}\n\\begin{center}\n{{\\textsc{diva}}}\n\\includegraphics[width=\\textwidth]{diva_pdf_final.pdf}\n{{\\textsc{origami}}}\n\\includegraphics[width=\\textwidth]{origami_pdf_final.pdf}\n\\caption{Slice through the posterior probabilities for different structure types (from left to right: void, sheet, filament, and cluster), in the late-time large-scale structure in the Sloan volume ($a=1$).  These four three-dimensional probabilities, defined on a $256^3$-voxel grid, sum up to one on a voxel basis. Structure types are classified using {{\\textsc{diva}}} (first row) or {{\\textsc{origami}}} (second row). For comparison, the reader is referred to figure 3 in \\citet{Leclercq2015ST}, where structures are classified according to the {{\\textsc{T-web}}} procedure.\\label{fig:pdf_final}}\n\\end{center}\n\\end{figure*}\n\nIn the previous section, we have considered classifications on the Lagrangian dark matter sheet. In order to classify structures at redshift zero, it is possible to translate the {{\\textsc{diva}}} and {{\\textsc{origami}}} results into Eulerian coordinates. To do so, we consider particles at their final positions and assign them to a $256^3$-voxel grid using the cloud-in-cell (CiC) scheme. For structure type $\\mathrm{T}_i$, each particle gets a weight of $1$ if its Lagrangian classification is $\\mathrm{T}_i$, and 0 otherwise. In each voxel, we then count the relative frequencies for each mass-weighted structure type. In this fashion, in each realization $n$, we obtain four probabilities, in the range $[0,1]$, for a final Eulerian voxel to belong to each of the structure types. We denote them by $\\mathcal{P}_n(\\mathrm{T}_i(\\vec{x}_k)|d,\\xi)$. In general, we have $\\mathcal{S}_n(\\vec{x}_k) \\equiv \\sum_{i=0}^3 \\mathcal{P}_n(\\mathrm{T}_i(\\vec{x}_k)|d,\\xi) = 1$; this sum is $0$ if and only if, in realization $n$, no particle was assigned to the cell $\\vec{x}_k$ by the CiC scheme (i.e. it is empty as well as its eight neighbors). These voxels are flagged as noisy and discarded.\n\nIt is then possible to go from these per-sample pdfs to a global pdf for the entire analysis, in a similar way as before: we count the relative frequencies of the probabilities at each Eulerian spatial position within the set of samples. With this definition, the web-type posterior mean is given by\n\n", "index": 15, "text": "\\begin{equation}\n\\left\\langle \\mathcal{P}(\\mathrm{T}_i(\\vec{x}_k)|d,\\xi)\\right\\rangle = \\frac{1}{N_{\\vec{x}_k}} \\sum_{n=1}^N \\mathcal{P}_n(\\mathrm{T}_i(\\vec{x}_k)|d,\\xi),\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m1\" class=\"ltx_Math\" alttext=\"\\left\\langle\\mathcal{P}(\\mathrm{T}_{i}(\\vec{x}_{k})|d,\\xi)\\right\\rangle=\\frac{%&#10;1}{N_{\\vec{x}_{k}}}\\sum_{n=1}^{N}\\mathcal{P}_{n}(\\mathrm{T}_{i}(\\vec{x}_{k})|d%&#10;,\\xi),\" display=\"block\"><mrow><mrow><mo>\u27e8</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcab</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"normal\">T</mi><mi>i</mi></msub><mrow><mo stretchy=\"false\">(</mo><msub><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u2192</mo></mover><mi>k</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">|</mo><mi>d</mi><mo>,</mo><mi>\u03be</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u27e9</mo></mrow><mo>=</mo><mfrac><mn>1</mn><msub><mi>N</mi><msub><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u2192</mo></mover><mi>k</mi></msub></msub></mfrac><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcab</mi><mi>n</mi></msub><mrow><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"normal\">T</mi><mi>i</mi></msub><mrow><mo stretchy=\"false\">(</mo><msub><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u2192</mo></mover><mi>k</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">|</mo><mi>d</mi><mo>,</mo><mi>\u03be</mi><mo stretchy=\"false\">)</mo></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.00093.tex", "nexttext": "\n\nIn figure \\ref{fig:pdf_final}, we show slices through the redshift-zero web-type posterior mean for the four different structures as defined by {{\\textsc{diva}}} and by {{\\textsc{origami}}}. As before, the plot demonstrates that we are able to propagate typical observational uncertainty to structure type classification. At this point, the reader is referred to figure 3 in \\citet{Leclercq2015ST} for our map of the same volume, inferred using the {{\\textsc{T-web}}} definition. The {{\\textsc{T-web}}} and {{\\textsc{diva}}} maps are visually similar, with an overall smoother structure for the voids defined by {{\\textsc{diva}}}, which are sharply separated by walls. {{\\textsc{diva}}} also visually excels in highlighting the filamentary structure of the cosmic web. In contrast, with {{\\textsc{origami}}}, most of the volume is filled by voids and more complex, shell-crossed structures are rarely identified.\n\n\\section{Conclusions}\n\nIn this letter, we presented the first probabilistic maps of the Lagrangian dark matter sheet in a volume covered by the SDSS main galaxy sample. Beyond this specific region, our study demonstrates the possibility of mapping the dark matter sheet in the real Universe. This possibility, so far limited to simulations, is uniquely offered by Bayesian physical inference of the initial conditions from large-scale structure surveys, which allows a self-consistent treatment of the necessary aspects: quantification of observational uncertainties and description of structure formation. We also showed how to translate the result of Lagrangian classifiers into redshift-zero Eulerian maps. With these definitions, identified structures have a direct physical interpretation in terms of the entire history of matter flows toward and inside them.\n\nOur result may have important implications for large-scale structure data analyses, as they allow new confrontations of observational data and theoretical models, and therefore novel tests of the standard paradigm of cosmic web formation and evolution.\n\n\\section*{Statement of contribution}\n\n\\small{FL implemented {{\\textsc{cola}}} and the required cosmic web analysis tools, performed the study, produced the maps and wrote the paper. JJ developed {{\\textsc{borg}}} and lead the SDSS analysis; GL developed {{\\textsc{diva}}}; JJ and GL contributed to the development of computational tools. BW was involved in the conception and design of Bayesian large-scale structure inference and contributed to the interpretation of results. All the authors read and approved the final manuscript.}\n\n\\acknowledgments\n\n\\small{FL would like to thank Oliver Hahn, Will Percival and Rien van de Weygaert for stimulating discussions. We are grateful to Bridget Falck and Mark Neyrinck for making publicly available their {{\\textsc{origami}}} code, which was used in this work. Special thanks go to St\\'ephane Rouberol for his support, in particular for guaranteeing flawless use of all required computational resources.}\n\n\\small{FL acknowledges support from the \\'Ecole polytechnique through an AMX grant and from the European Research Council through grant 614030, Darksurvey. JJ is partially supported by a Feodor Lynen Fellowship by the Alexander von Humboldt foundation. BW acknowledges funding from an ANR Chaire d'Excellence (ANR-10-CEXC-004-01) and the UPMC Chaire Internationale in Theoretical Cosmology. This work has been done within the Labex \\href{http://ilp.upmc.fr/}{Institut Lagrange de Paris} (reference ANR-10-LABX-63) part of the Idex SUPER, and received financial state aid managed by the Agence Nationale de la Recherche, as part of the programme Investissements d'avenir under the reference ANR-11-IDEX-0004-02. This research was supported by the DFG cluster of excellence ``\\href{www.universe-cluster.de}{Origin and Structure of the Universe}''.}\n\n\\section*{References}\n\\vspace{-10pt}\n\\bibliography{../../these/Thesis}\n\n\n", "itemtype": "equation", "pos": 25274, "prevtext": "\nwhere $n$ labels one of the $N$ samples, and the normalization $N_{\\vec{x}_k}$ in voxel $\\vec{x}_k$ is\n\n", "index": 17, "text": "\\begin{equation}\nN_{\\vec{x}_k} = \\sum_{n=1}^N \\delta^{\\mathrm{(K)}}_{\\mathcal{S}_n(\\vec{x}_k) ,1} .\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m1\" class=\"ltx_Math\" alttext=\"N_{\\vec{x}_{k}}=\\sum_{n=1}^{N}\\delta^{\\mathrm{(K)}}_{\\mathcal{S}_{n}(\\vec{x}_{%&#10;k}),1}.\" display=\"block\"><mrow><mrow><msub><mi>N</mi><msub><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u2192</mo></mover><mi>k</mi></msub></msub><mo>=</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msubsup><mi>\u03b4</mi><mrow><mrow><msub><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcae</mi><mi>n</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u2192</mo></mover><mi>k</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>,</mo><mn>1</mn></mrow><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">K</mi><mo stretchy=\"false\">)</mo></mrow></msubsup></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}]