[{"file": "1601.04753.tex", "nexttext": "\nTo account for observation errors\nand, at least informally, model uncertainty we use a $\\sigma = 5$.\nFrom this a likelihood is constructed.\n\nAs mentioned in the previous section the only parameters being inferred are\n$\\theta_0, \\theta_1$ and $\\theta_2$.  Moreover, the initial value $G(0)$ is also\na parameter to be inferred.   These are all positive and as a first choice\nwe select Gamma priors for the parameters $\\theta_0$ and $\\theta_1$.  Since\nwe would like to learn about these two parameters for each patient, we use\nvague Gamma distributions with shape=2 and rate=$\\frac{1}{4}$.\n\nThe rest of the initial values are set to $I(0)=0$ and $L(0)=0$ since\nthe patient is expected to be in homeostasis (equilibrium) and $D(0)=0$ fasting.  $V(0)=V_0$\nis the initial Glucose intake, at the onset of the test. \n\nOn the other hand, we do have information regarding $\\theta_2$, the glucose transfer mean life.  This\ntransfer cannot be arbitrarily fast or slow, given the transit through the digestive\ntract and the fact that the drinkable Glucose solution is basically directly taken into the blood\nrequiring no digestive process.  The Glucose half life in the digestive tract\nhas been estimated to be between 40 and 90 min \\cite{Anderwald2011}.\n\nWe use a gamma distribution with mean at 1/2hr (shape= 10 and rate= 20) and truncated at the extreme (but bounded) values \n$0.16 < \\theta_2 < 2 $. That is, most\nsugar will be transferred ($2\\theta_2$) to the blood stream within in a minimum of  \n20 min and a maximum of 4hr.  In fact, since (\\ref{eqn.minmod.D}) and (\\ref{eqn.minmod.V}) may be regarded\nas a separate system of ODEs (forcing the system of  (\\ref{eqn.minmod.G}), (\\ref{eqn.minmod.I}) and\n(\\ref{eqn.minmod.L}) with the term $\\frac{D}{\\theta_2}$), which in turn may be regarded as a linear nonhomegeneous\nODE, it may be solved analytically for $D$ to obtain\n$D(t) = \\frac{V_0}{\\frac{c}{2\\theta_2}-1}\\left( e^{-\\frac{2t}{c}} - e^{-\\frac{t}{\\theta_2}} \\right)$.  Since $D$ cannot be\nnegative, at $t=0$ it may only increase, therefore $D'(0) > 0$.  From this it is straightforward to see that\nwe most have $\\theta_2 > c/2$.  The support of $\\theta_2$ most start above zero.     \n\nThe basis of Bayesian analysis is the posterior distribution for all\nparameters.  This results in\n\n", "itemtype": "equation", "pos": 6886, "prevtext": "\n\n\n\n\n\\title{A Diabetes minimal model for Oral Glucose Tolerance Tests}\n\n\\author{\nJ. Andr\\'es Christen$^{a}$\\thanks{(corresponding author) Email: \\textit{jac@cimat.mx .}},\nMarcos Capistr\\'an$^a$,\\\\\nAdriana Monroy$^{b}$, Silvestre Alavez$^{c}$, Silvia Quintana Vargas$^{d}$\\\\\nHugo A Flores-Arguedas$^a$ and Nicol\\'as Kuschinski$^a$\\\\\n$^{a}${\\em CIMAT, Guanajuato, Mexico}\\\\\n$^{b}${\\em Hospital General, Mexico City, Mexico}\\\\\n$^{c}${\\em UAM, Lerma, Mexico}\\\\\n$^{d}${\\em DIF/Hospital Alta Especialidad, Guanajuato, Mexico}\\\\\n}\n\n\\date{January 2016}\n\n\\maketitle\n\n\n\\begin{abstract}\nWe present a minimal model for analyzing Oral Glucose Tolerance Test (OGTT) data base on system of\n5 ODEs.  The model has 4 unknown parameters which are inferred using a Bayesian approach.\nPreliminarily results are shown with three real patient data. \n\\end{abstract}\n\n\\section{Introduction}\\label{sec.intro}\n\nFor diagnosis of diabetes, metabolic syndrome and other conditions an Oral Glucose Tolerance Test (OGTT)\nis performed. After a night's sleep, fasting patients have their blood glucose measured and are asked to drink a 75 g sugar concentrate. Blood glucose is then measured at the hour, two hours and sometimes at three hours, depending on\nlocal practices. \n\nA diagnosis tool is needed since there are many scenarios in which blood glucose ranges from low to high to intermediate levels in different patterns and MD's resort only to simple guidelines for diagnosis.\n\nWe develop a minimal model for blood glucose-insulin interaction based on a two compartment model.  A a simple\ntransfer compartment of glucose into the diagestive system and a more complex compartment for blood glucose\nand interactions with Insulin and other glucose substitution mechanisms.\n\nOnce OGTT data is available, we perform a formal statistical analysis using Bayesian\ninference for the unknown parameters\nof each patient and predict their glucose level at 3h after the test.\n\n\n\\section{The model}\n\n\\begin{table}\n\\begin{center}\n\\caption{\\label{tab.variables} Minimal model for analysis of OGTT state variables, parameter definition and units.\nTime is measured in hours (hr) and therefore all derivatives have corresponding units per hr.}\n{\\small\n\\begin{tabular}{| c | c | l | c |} \\hline\n         &  Units                 & Interpretation & Value \\\\ \\hline\n$G$ & $\\frac{mg}{dL}$ & Blood glucose. & State variable\\\\ \\hline\n$I$   & $\\frac{mg}{dL}$ (see text) & Blood Insulin.  & State variable\\\\ \\hline\n$L$ &  $\\frac{mg}{dL}$ (see text) & Blood Glucagon.  & State variable\\\\ \\hline\n$D$ & $\\frac{mg}{dL}$ & Glucose in digestive system.  & State variable\\\\ \\hline\n$V$ & $\\frac{mg}{dL}$ & Glucose in the drinkable solution, & State variable\\\\\n         &                            &  to be transferred to the digestive system.\\\\ \\hline \\hline\n$\\theta_0$ & $hr^{-1}$ & Insulin tissue sensitivity.  & Unknown par.\\\\ \\hline\n$\\theta_1$ & $hr^{-1}$ & Glucagon liver sensitivity.  & Unknown par.\\\\ \\hline\n$\\theta_2$ & $hr$ & Glucose digestive system mean life.  & Unknown par.\\\\ \\hline\n$a$, $b$    & $hr$ & Insulin and Glucagon clearance mean life. & 31 min. \\\\ \\hline \n$c$             & $hr$ & Time that the subject took to drink most of the & 5 min max. \\\\\n                    &         &  glucose solution (transfer time to $D$). \\\\   \\hline\n\\end{tabular}  }\n\\end{center}\n\\end{table}\n\n\n\nOur Diabetes minimal dynamic model is\n\\begin{eqnarray}\n\\label{eqn.minmod.G} \\frac{dG}{dt} & = &    L - I +  \\frac{D}{\\theta_2} \\\\ \n\\label{eqn.minmod.I}   \\frac{dI}{dt}  & = &   \\theta_0 \\left( G - G_b \\right)^+ - \\frac{I}{a} \\\\\n\\label{eqn.minmod.L}  \\frac{dL}{dt} & = &   \\theta_1  \\left( G_b - G \\right)^+ - \\frac{L}{b} \\\\\n\\label{eqn.minmod.D} \\frac{dD}{dt} & = & - \\frac{D}{\\theta_2} + \\frac{2V}{c} \\\\\n\\label{eqn.minmod.V} \\frac{dV}{dt} & = & - \\frac{2V}{c}.\n\\end{eqnarray}\n\nAll state variables and parameters are positive.  Definitions of the state variables, parameters and their units are\ndescribed in Table~\\ref{tab.variables}.\n\nThe heuristics behind this model are as follows and are similar to other minimal models following the same heuristics \\cite[for example, see][]{palumbo:2013}.\n\nWhen glucose goes above the normal threshold ($G_b$), Insulin is produced,\nie. its derivative increases, see (\\ref{eqn.minmod.I}).  This, in turn, acts on blood glucose and decreases its concentration,\ngiven the $-  I$ term in (\\ref{eqn.minmod.G}), and decreases the derivative of $G$.\nThe opposite effect is achieved with the Glucagon derivative in (\\ref{eqn.minmod.L}), increasing blood\nGlucose levels, with the term $L$ in   (\\ref{eqn.minmod.G}), once Glucose is below\nthe threshold $G_b$.\n\n$D(t)$ represents the glucose in the digestive system that will be transferred to\nthe blood stream.  After the oral sugar intake, glucose in this compartment decreases, increasing the\nblood glucose $G(t)$; see (\\ref{eqn.minmod.G}) and (\\ref{eqn.minmod.D}).\n\n $D(t)$ is measured in the same units as\n$G$ ($mg/dL$) and $\\theta_2$ (the rate of glucose transfer form $D$ to $G$) is measured in $hr$\nthat is the glucose compartment transfer mean life.\nThis Glucose transfer mean life has been estimated at 71 min \\cite{Anderwald2011},\n however it may vary greatly, perhaps from 15 to 60 min, depending on the subject's digestive system, bowel\ncharacteristics, gender, etc.\n\nMoreover, there is the process of drinking the glucose solution, which may take up to 5min,\nbut an individual may drink the contents in far less time.  This is modeled by the additional compartment\n $V$, where $c$ is the time where most of the glucose (87\\%) solution has been drunk. \n Ideally the health practictioner would record the total time the patient took to drink the glucose solution.\n Unfortunately this information is not available and therefore we fix $c=5/60 hr$.\n \n The Insulin and Glucagon clearance rates are not estimated.  It is known that the total Insulin clearance time is\napproximately 71 min \\citep{Duckworth1998}; we therefore set the Insulin half life to 36min, that is $a=0.6hr$.\nThere is less knowledge regarding  clearance rates for Glucagon.  We set it equal to the clearance rate\nof Insulin, that is $b=0.6hr$.\n\n\n\\section{Uncertainty Quantification Using Bayesian Inference}\n\nOnce the OGTT data is observed we perform the \\textit{Inverse Analysis} by inferring the\npatient's corresponding model parameters using Bayesian statistics \\citep{Fox2013}. \nWe have observations $d_0, d_1, \\ldots, d_{n-1}$ for the measured Glucose during the OGTT test\nat times $t_0, t_1, \\ldots , t_{n-1}$.  Plasma glucose is measured with relative precision, however\nhigh frequency fluctuations exist (given the pancreatic beta cells' Insulin delivery mechanisms,\n\\cite{IDF:France})\nand, along with model error itself, we expect Glucose readings $d_i$ to fluctuate around\na mean value, modeled here as $G(t_i)$.  We impute an independent Gaussian error\nfor these readings, namely\n\n", "index": 1, "text": "$$\nd_i = G(t_i) + e_i ~~\\text{where}~~e_i \\sim N(0, \\sigma ); i=0,1,\\ldots,n-1 .\n$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"d_{i}=G(t_{i})+e_{i}\\leavevmode\\nobreak\\ \\leavevmode\\nobreak\\ \\text{where}%&#10;\\leavevmode\\nobreak\\ \\leavevmode\\nobreak\\ e_{i}\\sim N(0,\\sigma);i=0,1,\\ldots,n%&#10;-1.\" display=\"block\"><mrow><mrow><mrow><msub><mi>d</mi><mi>i</mi></msub><mo>=</mo><mrow><mrow><mrow><mi>G</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><msub><mi>e</mi><mi>i</mi></msub></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003</mo><mtext>where</mtext></mrow></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003</mo><mrow><mrow><msub><mi>e</mi><mi>i</mi></msub><mo>\u223c</mo><mrow><mi>N</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mi>\u03c3</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>;</mo><mrow><mi>i</mi><mo>=</mo><mrow><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04753.tex", "nexttext": "\nwhere $a_j$ and $b_j$ are the Gamma hyper parameters for the prior of $\\theta_j$,\n$S_1 = S_2 = (0,\\infty)$ and $S_3 = [1/6,2]$.  To obtain Monte Carlo samples from this\n(unnormalized) posterior distribution, an MCMC is performed\nusing the t-walk \\citep{Christen2010}. This is a self-adjusting MCMC algorithm \nand the resulting sampler is efficient in most cases for this low dimensional (3) problem.\nIn the next Section we present some examples of how our model and inference works\non some real OGTT data.\n\n\n\n\\section{Examples and Results}\n\nFigures 1, 3 and 5 show how real OGTT data is adjusted by our model. The red dots are the measured data points,\nand the grey lines are elements of a posterior sample of glucose curves.\n\nFigure 1 is a healthy patient, figure 2 shows the marginal priors of $\\theta_0$, $\\theta_1$ and $\\theta_2$ corresponding to this patient, overlaid with a histogram of the marginal posteriors. Figure 3 is a patient with strange oscillating blood glucose measurements (previous diagnosis technique would classify this patient as ``normal''), and figure 4 shows the corresponding priors and posteriors. Figure 5 is a considered and Impaired Glucose Tolerant patient (IGT, currently considered\nan pre diabetic condition) and figure 6 shows the corresponding posteriors for this patient.\n\nAs can be seen in all three cases, the model has strong descriptive power for the times contained in the measurement interval. It also has reasonable predictive power for times beyond the interval before the patient returns to a fasting glucose level. After that the predictive power tapers off because the uncertainty in $\\theta_1$ is typically very high -- usually matching the uncertainty in the prior for this parameter, except in the case of the oscillating data.\n\n\\begin{figure}\n\\includegraphics[height=8cm, width=12cm]{normal.png}\n\n\\caption{A nice decaying OGTT, belonging to a healthy patient}\n\\end{figure}\n\n\\begin{figure}\n\\begin{tabular}{c c c}\n\\includegraphics[height=3.5cm, width=4.5cm]{normalpost1} &\n\\includegraphics[height=3.5cm, width=4.5cm]{normalpost2} &\n\\includegraphics[height=3.5cm, width=4.5cm]{normalpost3} \\\\\n(a) & (b) & (c) \n\\end{tabular}\n\\caption{Priors and posteriors for the normal patient (used to generate figure 1). In green are the priors of $\\theta_0$(a), $\\theta_1$(b), and $\\theta_2$(c). In blue are histograms of the corresponding posterior samples.}\n\\end{figure}\n\n\\begin{figure}\n\\includegraphics[height=8cm, width=12cm]{oscilating.png}\n\\caption{Data with an oscillating fit. Older diagnostic techniques would have called this patient ``normal''.}\n\\end{figure}\n\n\\begin{figure}\n\\begin{tabular}{c c c}\n\\includegraphics[height=3.5cm, width=4.5cm]{oscilatingpost1} &\n\\includegraphics[height=3.5cm, width=4.5cm]{oscilatingpost2} &\n\\includegraphics[height=3.5cm, width=4.5cm]{oscilatingpost3} \\\\\n(a) & (b) & (c) \n\\end{tabular}\n\\caption{Priors and posteriors for the patient with oscillating data (used to generate figure 3). In green are the priors of $\\theta_0$(a), $\\theta_1$(b), and $\\theta_2$(c). In blue are histograms of the corresponding posterior samples.}\n\\end{figure}\n\n\n\n\\begin{figure}\n\n\\includegraphics[height=8cm, width=12cm]{diabetes.png}\n\n\\caption{A diabetic patient with normal fasting OGTT and an Insulin resistance profile.}\n\\end{figure}\n\n\\begin{figure}\n\\begin{tabular}{c c c}\n\\includegraphics[height=3.5cm, width=4.5cm]{diabetespost1} &\n\\includegraphics[height=3.5cm, width=4.5cm]{diabetespost2} &\n\\includegraphics[height=3.5cm, width=4.5cm]{diabetespost3} \\\\\n(a) & (b) & (c) \n\\end{tabular}\n\\caption{Priors and posteriors for the insulin resistant patient (used to generate figure 5). In green are the priors of $\\theta_0$(a), $\\theta_1$(b), and $\\theta_2$(c). In blue are histograms of the corresponding posterior samples.}\n\\end{figure}\n\n\n\\section{Conclusions}\n\nIn general, the main indicator of the status of a patient is $\\theta_0$. For normal patients, $\\theta_0$ is around 2. Significantly lower values indicate that a patient may have diabetes and higher values may indicate that a patient has some other complication. The data is almost always very informative for $\\theta_0$.  More over, the bayesian inference allows for prediction, and we are able to predict\nGlucose levels beyond the length of the test (shown in figure 1, 3 and 5 up to 3 h).  In particular, for figure 5 the prediction is that\nthe patient will still have a high glucose level (above 120  $\\frac{mg}{dL}$) and yet current diagnosis standards classify her/him\nas IGT (a pre diabetic condition).\n\n$\\theta_1$, on the other hand, depends on measurements found below fasting glucose levels. For healthy patients and also for diabetics, it is uncommon for such data to become available for the duration of the test.\n\n$\\theta_2$ is an important element of inference, and often data provide information for it however, as yet, there is no clear relationship between the value of $\\theta_2$ and a patient diagnosis.\n\nWe intend to provide a tool for proper diagnosis using OGTT. For this very important public health issue, there is a need for a more sophisticated tool than the direct recording of values read during the test.\n\nCovariates (weight, age, etc.) will be used to help in the analysis, creating a hierarchical model embedded into\nthe ODE model, in more population based studies, using ideally a large sample of patients with a range of\nhealth conditions to tune the model parameter value ranges to establish a more comprehensive diagnosis tool\nthan what is currently available. \n\nA more extensive validation of the model, and model parameters, is needed in order to have an effective\ndiagnosis tool.  This will necessarily involve the OGTT tests, and their further analysis using our model,\nin a wide range of healthy individuals and individuals with a various prediabetic and diabetic conditions\nto establish a more comprehensive diagnosis tool than what is currently available. \n\nWe are in the course of such research and our results will be published elsewhere.\n\n\\bibliographystyle{chicago}\n\\bibliography{DiabetesModel}\n\n\n", "itemtype": "equation", "pos": 9251, "prevtext": "\nTo account for observation errors\nand, at least informally, model uncertainty we use a $\\sigma = 5$.\nFrom this a likelihood is constructed.\n\nAs mentioned in the previous section the only parameters being inferred are\n$\\theta_0, \\theta_1$ and $\\theta_2$.  Moreover, the initial value $G(0)$ is also\na parameter to be inferred.   These are all positive and as a first choice\nwe select Gamma priors for the parameters $\\theta_0$ and $\\theta_1$.  Since\nwe would like to learn about these two parameters for each patient, we use\nvague Gamma distributions with shape=2 and rate=$\\frac{1}{4}$.\n\nThe rest of the initial values are set to $I(0)=0$ and $L(0)=0$ since\nthe patient is expected to be in homeostasis (equilibrium) and $D(0)=0$ fasting.  $V(0)=V_0$\nis the initial Glucose intake, at the onset of the test. \n\nOn the other hand, we do have information regarding $\\theta_2$, the glucose transfer mean life.  This\ntransfer cannot be arbitrarily fast or slow, given the transit through the digestive\ntract and the fact that the drinkable Glucose solution is basically directly taken into the blood\nrequiring no digestive process.  The Glucose half life in the digestive tract\nhas been estimated to be between 40 and 90 min \\cite{Anderwald2011}.\n\nWe use a gamma distribution with mean at 1/2hr (shape= 10 and rate= 20) and truncated at the extreme (but bounded) values \n$0.16 < \\theta_2 < 2 $. That is, most\nsugar will be transferred ($2\\theta_2$) to the blood stream within in a minimum of  \n20 min and a maximum of 4hr.  In fact, since (\\ref{eqn.minmod.D}) and (\\ref{eqn.minmod.V}) may be regarded\nas a separate system of ODEs (forcing the system of  (\\ref{eqn.minmod.G}), (\\ref{eqn.minmod.I}) and\n(\\ref{eqn.minmod.L}) with the term $\\frac{D}{\\theta_2}$), which in turn may be regarded as a linear nonhomegeneous\nODE, it may be solved analytically for $D$ to obtain\n$D(t) = \\frac{V_0}{\\frac{c}{2\\theta_2}-1}\\left( e^{-\\frac{2t}{c}} - e^{-\\frac{t}{\\theta_2}} \\right)$.  Since $D$ cannot be\nnegative, at $t=0$ it may only increase, therefore $D'(0) > 0$.  From this it is straightforward to see that\nwe most have $\\theta_2 > c/2$.  The support of $\\theta_2$ most start above zero.     \n\nThe basis of Bayesian analysis is the posterior distribution for all\nparameters.  This results in\n\n", "index": 3, "text": "$$\nf( {\\boldsymbol{\\theta}} | D ) \\propto \\exp\\left\\{ \\frac{1}{2 \\sigma^2} \\sum_{i=0}^{n-1} (d_i - G_{{\\boldsymbol{\\theta}}} (t_i))^2 \\right\\}\n\\prod_{j=0}^2 \\theta_i^{a_j-1} \\exp(-b_j \\theta_j) I_{S_j}(\\theta_j) ,\n$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"f({\\boldsymbol{\\theta}}|D)\\propto\\exp\\left\\{\\frac{1}{2\\sigma^{2}}\\sum_{i=0}^{n%&#10;-1}(d_{i}-G_{{\\boldsymbol{\\theta}}}(t_{i}))^{2}\\right\\}\\prod_{j=0}^{2}\\theta_{%&#10;i}^{a_{j}-1}\\exp(-b_{j}\\theta_{j})I_{S_{j}}(\\theta_{j}),\" display=\"block\"><mrow><mi>f</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf3d</mi><mo stretchy=\"false\">|</mo><mi>D</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u221d</mo><mi>exp</mi><mrow><mo>{</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mo>\u2062</mo><msup><mi>\u03c3</mi><mn>2</mn></msup></mrow></mfrac><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></munderover><msup><mrow><mo stretchy=\"false\">(</mo><msub><mi>d</mi><mi>i</mi></msub><mo>-</mo><msub><mi>G</mi><mi>\ud835\udf3d</mi></msub><mrow><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup><mo>}</mo></mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u220f</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mn>2</mn></munderover><msubsup><mi>\u03b8</mi><mi>i</mi><mrow><msub><mi>a</mi><mi>j</mi></msub><mo>-</mo><mn>1</mn></mrow></msubsup><mi>exp</mi><mrow><mo stretchy=\"false\">(</mo><mo>-</mo><msub><mi>b</mi><mi>j</mi></msub><msub><mi>\u03b8</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo></mrow><msub><mi>I</mi><msub><mi>S</mi><mi>j</mi></msub></msub><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03b8</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>,</mo></mrow></math>", "type": "latex"}]