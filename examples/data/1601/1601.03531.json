[{"file": "1601.03531.tex", "nexttext": "\n\n\\noindent where $x$ is the envelope of the RF signal, with the shape of the distribution defined by the $\\mu$ parameter corresponding to the local concentration of scatterers, and the local backscattered energy represented by the scale parameter $\\omega$ $>$ 0, for $x$ $>$ 0, and $\\Gamma\\left(\\cdot\\right)$ is the Gamma function. If $x$ has a Nakagami distribution $N$ with parameters $\\mu$ and $\\omega$, then $x^2$ has a Gamma distribution $\\Gamma$ with shape $\\mu$ and scale (energy) parameter $\\omega$/$\\mu$. \\\\\n    \\indent The Nakagami distribution can model various backscattering conditions in medical ultrasound. By varying $\\mu$, the envelope statistics range from pre-Rayleigh $\\left(\\mu < 1\\right)$, Rayleigh $\\left(0 < \\mu < 0.5\\right)$, and to post-Rayleigh $\\left(\\mu > 1 \\right)$.  The Nakagami parameters are generally estimated by the $2^{nd}$ and $4^{th}$ order moments, where given $x$ is the ultrasonic backscattered envelope and $E\\left(\\cdot\\right)$ denotes the statistical mean, the two Nakagami parameters can be calculated as:\n\n", "itemtype": "equation", "pos": 18233, "prevtext": "\n\n\\begin{frontmatter}\n\n\n\n\\title{Quantification of Ultrasonic Texture heterogeneity via Volumetric Stochastic Modeling for Tissue Characterization}\n\n\\author[Affil1,Affil2]{Omar S ~Al-Kadi\\corref{cor1}}\n\n\\author[Affil1]{Daniel YF Chung}\n\\author[Affil1]{Robert C Carlisle}\n\\author[Affil1]{Constantin C Coussios}\n\\author[Affil1]{J Alison Noble}\n\n\\address[Affil1]{Institute of Biomedical Engineering, Department of Engineering Science, University of Oxford, Oxford OX3 7DQ United Kingdom}\n\\address[Affil2]{King Abdullah II School for Information Technology, University of Jordan, Amman 11942, Jordan}\n\\cortext[cor1]{Corresponding Author: Omar S. Al-Kadi, E-mail: omar.al-kadi@eng.ox.ac.uk}\n\n\\begin{abstract}\n\nIntensity variations in image texture can provide powerful quantitative information about physical properties of biological tissue. However, tissue patterns can vary according to the utilized imaging system and are intrinsically correlated to the scale of analysis. In the case of ultrasound, the Nakagami distribution is a general model of the ultrasonic backscattering envelope under various scattering conditions and densities where it can be employed for characterizing image texture, but the subtle intra-heterogeneities within a given mass are difficult to capture via this model as it works at a single spatial scale. This paper proposes a locally adaptive 3D multi-resolution Nakagami-based fractal feature descriptor that extends Nakagami-based texture analysis to accommodate subtle speckle spatial frequency tissue intensity variability in volumetric scans. Local textural fractal descriptors -- which are invariant to affine intensity changes -- are extracted from volumetric patches at different spatial resolutions from voxel lattice-based generated shape and scale Nakagami parameters. Using ultrasound radio-frequency datasets we found that after applying an adaptive fractal decomposition label transfer approach on top of the generated Nakagami voxels, tissue characterization results were superior to the state of art. Experimental results on real 3D ultrasonic pre-clinical and clinical datasets suggest that describing tumor intra-heterogeneity via this descriptor may facilitate improved prediction of therapy response and disease characterization.\n\n\\end{abstract}\n\n\\begin{keyword}\ntexture analysis \\sep fractal dimension \\sep tumor characterization \\sep Nakagami modeling \\sep ultrasound imaging.\n\n\n\\end{keyword}\n\n\\end{frontmatter}\n\n\n\n\n\\section{Introduction}\n\n    Analysis of the local characteristic patterns of tissue texture can reveal subtle pathological features deemed important for clinical diagnosis. Spatial variation of textons quantified in terms of image ``surface roughness'' has been shown to reflect tumor functional heterogeneity, and to lead to a better understanding of disease state \\cite{bae13, chl13, dvl12, alk08}.  However, sub-voxel resolution complex and higher order textural features can be difficult to discern by simple observation. These texture signatures may convey significant information about disease progression or regression. However, quantifying these subtle signatures in ultrasound images is challenging.\n\n    Our motivation stems from a clinical need to improve the diagnosis and therapy of liver cancer. Approximately 100,000 patients are diagnosed each year with primary liver cancers in the United States and Europe \\cite{cuk14, acs14}. When this is compared against worldwide statistics, liver cancer is even more common in developing countries \\cite{who12}. Although it the sixth most common cancer in the world \\cite{fry13}, incidence varies across the world, and it is the most cancer type in some developing countries \\cite{prk14}. Surgery is considered the only curative treatment; however, this is not suitable in the majority of cases due to co-morbidity, extent or location of the cancer, with chemotherapy forming the mainstay of treatment in these patients. Chemotherapy can have significant side effects, and may not be effective in all cases. Development of monitoring techniques during the course of chemotherapy may permit dose adjustment in responders to minimize side effects, while alternative treatments could be offered to non-responders. Current monitoring techniques rely on computed tomography and magnetic resonance imaging, with frequency limited by the potential damage from ionizing radiation and cost consideration respectively. Despite the difficulties of using ultrasound for monitoring disease (e.g. operator dependent, poorly reproducible and non-standardize), it is a technique that is known to be rapid, relatively inexpensive, readily available, with no exposure to ionizing radiation, making it ideal for frequent monitoring of liver tumors during a course of treatment.\n    \n    Given the advantages of ultrasound, analyzing tissue speckle from a single resolution perspective is limiting, as substantial information that could assist tumor tissue characterization can be hidden at sub-voxel resolution. This is true for the smaller necrotic or functionally low-activity regions that exhibit a hyperechogenic appearance compared to healthy tissue \\cite{uta11}. We hypothesize that the difference in echogenicity of the tumor speckle texture can be exploited as an indicator of disease responsiveness to treatment \\cite{czr13}. Nevertheless, the functionally low-activity regions within the tumor texture are relatively small, especially in the early sessions of tumor chemotherapy treatment. They also tend to have low intensity contrast compared to the aggressive or functionally active background of the remaining tumor. Identification of subtle changes in these regions based on visual assessment of the intensity alone can be challenging.\n    \n\\indent Our approach is motivated by four observations:\n\\begin{itemize}\n\\item {\\em Tumors are heterogeneous}: most previous work has accounted for functionally active malignant regions rather than the peripheral low activity necrotic regions which may additionally provide key information on disease progression or regression. These subtle variations and deviations within the speckle tissue texture were deemed too chaotic to be characterized in \\cite{lru14}, but are important for understanding disease state; \n\\item {\\em Heterogeneity suggests using a multi-resolution texture analysis}: a carefully designed multi-resolution approach which is visually discriminative and geometrically informative could reveal small speckle changes and is better suited to describe the mixture distribution complexity that underpins a heterogeneity model; \n\\item {\\em Fractal analysis is well-suited to this problem}: conventional energy-based wavelet decompositions are susceptible to local intensity distribution variations; the fractal signatures used in our approach, derived from the wavelet representation sub-bands related to physiological properties of texture surface roughness are not; finally, \n\\item {\\em Analysis should be three-dimensional}: performing a 3D texture analysis based on a volumetric Nakagami modeling could facilitate a more reliable estimate of the Nakagami parameters, where the 3D location of each voxel provides a better localization of speckle distribution mixtures. \n\\end{itemize}\n\nIn this work, a novel multifractal Nakagami-based volumetric feature descriptor that is invariant to local speckle attenuation changes is proposed. A pipeline summarizing the stages of our approach is illustrated in Fig.~\\ref{fig:MNF-pipeline}. It is postulated that fractal tissue characteristics locally derived from 3D textural tumor patterns at several scales and from the RF envelope of the ultrasound backscattered volumes can assist in attaining descriptive features that relate to underlying biological structure. These tissue textural fractal characteristics tend to change in cases of therapeutic response, providing an attractive indicator for disease response to treatment during chemotherapy.   \\\\\n     \\indent This paper is organized as follows. State of the art and challenges associated with characterizing speckle tissue texture heterogeneity are summarized in Sections 2 and 3, followed by a detailed explanation of the proposed 3D multifractal Nakagami-based feature descriptor in Section 4. Sections 5 and 6 present the experimental results and discuss the potential significance of the work. The paper concludes in Section 7. \n\n\\begin{figure}\n\n\\includegraphics [width=\\columnwidth]{fig1}\n\n\\caption{3D multifractal Nakagami feature descriptor algorithm design for ultrasonic tissue characterization introduced in this paper.}\n\\label{fig:MNF-pipeline}\n\\end{figure}\n\n\\section{Related work}    \n    One of the effective statistical techniques used for modeling various backsc\\-attering conditions in medical ultrasound is the Nakagami distribution. This probabilistic distribution is known for its analytical simplicity and effective modeling of dense scatterers, accounting for amplitude and spacing, and can be reduced to a Rayleigh distribution under certain assumptions of scatterer density and number \\cite{skr00}. Shankar \\textit{et al.} first proposed the Nakagami distribution for characterizing conditions ranging from pre- to post-Rayleigh existing in ultrasound images, and later for modeling the radio-frequency (RF) envelope of the ultrasound backscattered signal in characterizing B-mode breast masses \\cite{skr01}. Others have attempted to tackle the issue of accurate estimation of the Nakagami distribution. For instance \\cite{lru11} employed Gamma kernel density estimation to compute a smooth estimate of a distribution within small windows of B-mode ultrasound images, but the mixture of distributions occurring at the boundaries between structures was not accounted for. The impact of morphological parameters and tumor structures on the Nakagami parameters statistics were analyzed in \\cite{lru14}. A limitation observed was that there was a need for a robust algorithm to compute the Nakagami parametric images that better delineate the structures and the context in and around the tumor. Characterizing homogeneous tissues via improving the smoothness of the Nakagami parametric images was shown in \\cite{tsi14}. The technique relies on summing and averaging the Nakagami images formed using sliding windows with varying window sizes related to the transducer pulse length. However, a relatively large window size (required for stabilization) may affect the reliability of the estimated Nakagami parameters, and hence degrade the spatial resolution of the resulting Nakagami image. \n     \n    The Nakagami distribution has been further employed as an image feature in various image analysis contexts. For instance, five contour features and the two Nakagami parameters were used for classification of benign and malignant breast tumors in \\cite{tsi10_tmi}. In a subsequent work malignant tumors were shown to be more pre-Rayleigh distributed than those from benign counterparts \\cite{tsi10_umb}; however, the calculation of the average intensity value in the Nakagami image makes it susceptible to spatial frequency intensity variability. Further, that particular technique was optimized for 2D ultrasound images which may not reliably represent heterogeneous distributions of scatterers (or speckle) encountered within a tumor volume. A Random Forest based solution to learn tissue-specific ultrasonic backscattering and a signal confidence for predicting heterogeneous composition in atherosclerotic plaques was proposed in \\cite{sht14}. That technique was developed for intravascular ultrasound and risk assessment of plaque rupture \\cite{zhu02}. Necrotic core was not considered in that method. Finally, \\cite{bhl09, kln11} describe a Markov random field model combined with Nakagami distribution estimation to differentiate malignant melanoma from normal tissue. However it was found that the estimated scale model parameter was highly sensitive to image quality, and hence subtle variations could go unnoticed. For an overview of ultrasound tissue characterization we refer the reader to \\cite{nbl10}. Previous work on ultrasound texture analysis of tumors has considered both global and local non-uniformity quantification of the tumor texture at only a single analysis scale. Herein we are primarily concerned with tumor intra-heterogeneity (i.e. micro-structures within the tumor speckle texture) which is more challenging.\n    \n\\section{Challenges in ultrasonic speckle texture characterization}\n\nSpeckle is a granular-shape stochastic pattern which appears in an image resulting from the scattering of an RF incident signal on an object~\\cite{sch11}. The spacing and localization of the scatterers in the scanned object structure contribute to the local variation and distribution of the recorded texture pattern. However the characteristic interference patterns, known as speckle, produce an overall reduction in global image contrast~\\cite{nbl10}. As a consequence, the boundaries separating different structures are less well defined, increasing difficulty in delineating regions of interest with a resultant increase in inter-and intra-observer variability for tumor detection. \\\\\n    \\indent A means to mitigate against effects such as the beam-tissue physical interaction and other acquisition factors is to characterize the objects via their speckle textural properties \\cite{dgr03, mdb03, sdg13}. Textons or texels (texture elements) which are the fundamental components of texture that collectively form the observed speckle pattern texture do not directly correspond to the underlying structure; however, the local intensity textural pattern can reflect the local echogenicity of the underlying scatterers \\cite{ads06}, see Fig.~\\ref{fig:ultrasound-simulation}. This is due to the stochastic nature of the speckle pattern. Viewing the structure locally as a collective texton structure can give information about the underlying scatterer behavior. We hypothesize here this may lead to an improvement in internal structure delineation, and hence tumor characterization.\n\t\t\n\t\t\\begin{figure}\n\t\t\\includegraphics[width=\\columnwidth]{fig2}\n\t\t\\caption{Six ultrasound hypoechoic to hyperechoic gray scale target phantoms having 8 mm diameter and 4 cm depth and corresponding simulated B-mode image representing a varying intensity from hypoechoic, -6, -3, +3, +6 dB, and hyperechoic, respectively.}\n\t\t\\label{fig:ultrasound-simulation}\n\t\t\\end{figure}\n\t\t\n\t\t\\begin{figure} [t]\n\t\t\\includegraphics[width=\\columnwidth]{fig3}\n\t\t\\caption{(a) Simulated ultrasound B-mode image following the method in \\cite{bam80} showing different 4 cm depth of 4, 6 and 8 mm diameter gray scale target phantoms ranging from -6, -3, +3 and +6 dB varying intensity, (b) a real ultrasound B-mode volume of interest of a liver tumor with corresponding \\textit{fractal slice map} in (c) -- estimated from the RF envelope of the ultrasound backscattered signal -- indicating the subtle low-activity regions.}\n\t\t\\label{fig:ultrasound-simulation2}\n\t\t\\end{figure}\n\t\t\n\\indent Fig.~\\ref{fig:ultrasound-simulation2} (a) shows a simulated lesion phantom having three different sizes at a fixed depth and with four levels of intensity contrast variability. The small round simulated hyperechoic region (marked with an arrow) resembles the functionally low-activity regions on real B-mode ultrasound images; appearing subtle and challenging to identify. Note that the situation would be even more complicated in real B-mode ultrasound tissue where the functionally active background of the aggressive tumor tissue would not be as uniform as in this example, and the non-aggressive regions do not usually have a constant intensity distribution, see Fig.~\\ref{fig:ultrasound-simulation2} (b). \n\nThe tissue characterization solution, as discussed in the paper, is to use a multi-resolution approach that highlights higher order statistical features of the RF envelope. Such features could go unnoticed in B-mode ultrasound and an experienced observer could struggle to identify subtle interval changes in these important texture features. \\\\\n    \\indent Fractals and wavelet packet analysis provide effective ways to break down statistical complexity to distinguish between different texture regions, where the invariance to affine speckle intensity changes for the former and the high sensitivity to local features for the latter facilitates effective texture discrimination \\cite{alk09}. Furthermore, according to the uncertainty principle, the wavelet packets can achieve an optimal joint spatial-frequency localization, i.e. simultaneously maintain a good boundary accuracy and frequency response~\\cite{rgn05}, and the estimated fractal dimension can give a quantitative assessment of the surface roughness \\cite{alk08, lop09}. Finally, simultaneous macro and micro scale tumor texture analysis provides a more complete characterization of dense and sparse textural regions within a tumor volume of interest. As demonstrated later, this progressive refinement process optimizes characterization by giving a better fit to the underlying tumor speckle texture.\n\n\n\\section{Methodology}\nOur goal is to derive a locally-based feature signature based on volumetric generated Nakagami shape and scale parametric voxel lattices, and subsequently to perform an intensity-invariant texture analysis at various spatial resolutions for tissue characterization. This allows us to perform a more complete characterization of tumor texture at the optimal resolution scales compared to single or mono-resolution approaches \\cite{alk09}. The proposed volumetric dense-to-sparse approach can break-down the speckle complexity and provide a robust estimation of model parameters, while having the advantage of simultaneously localizing both large high-contrast and small low-contrast structures at low and high spatial resolution levels. \n\n\\subsection{Nakagami probabilistic distribution}\n\nThe Nakagami distribution \\textit{N}(\\textit{x}) is an analytically simple distribution that has been proposed as a general model for the ultrasonic backscattered envelope under all scattering conditions and scatterer densities \\cite{skr00}. This distribution has the density function:\n\n\n", "index": 1, "text": "\\begin{equation}\nN(x|\\mu,\\omega)=2\\left(\\frac{\\mu}{\\omega}\\right)^{\\mu}\\frac{1}{\\Gamma\\left(\\mu\\right)} x^{\\left(2\\mu-1\\right)} e^{-\\frac{\\mu}{\\omega}x^{2}} ,  \\quad \\forall x \\in \\Re \\geq 0\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"N(x|\\mu,\\omega)=2\\left(\\frac{\\mu}{\\omega}\\right)^{\\mu}\\frac{1}{\\Gamma\\left(\\mu%&#10;\\right)}x^{\\left(2\\mu-1\\right)}e^{-\\frac{\\mu}{\\omega}x^{2}},\\quad\\forall x\\in%&#10;\\Re\\geq 0\" display=\"block\"><mrow><mi>N</mi><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">|</mo><mi>\u03bc</mi><mo>,</mo><mi>\u03c9</mi><mo stretchy=\"false\">)</mo></mrow><mo>=</mo><mn>2</mn><msup><mrow><mo>(</mo><mfrac><mi>\u03bc</mi><mi>\u03c9</mi></mfrac><mo>)</mo></mrow><mi>\u03bc</mi></msup><mfrac><mn>1</mn><mrow><mi mathvariant=\"normal\">\u0393</mi><mo>\u2062</mo><mrow><mo>(</mo><mi>\u03bc</mi><mo>)</mo></mrow></mrow></mfrac><msup><mi>x</mi><mrow><mo>(</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>\u03bc</mi></mrow><mo>-</mo><mn>1</mn></mrow><mo>)</mo></mrow></msup><msup><mi>e</mi><mrow><mo>-</mo><mrow><mfrac><mi>\u03bc</mi><mi>\u03c9</mi></mfrac><mo>\u2062</mo><msup><mi>x</mi><mn>2</mn></msup></mrow></mrow></msup><mo rspace=\"12.5pt\">,</mo><mo>\u2200</mo><mi>x</mi><mo>\u2208</mo><mi mathvariant=\"normal\">\u211c</mi><mo>\u2265</mo><mn>0</mn></mrow></math>", "type": "latex"}, {"file": "1601.03531.tex", "nexttext": "\n\n\n\n\n\n\n\n\n\t\t\n\\subsection{Volumetric multi-scale Nakagami modeling}\n\nA 3D feature signature that operates locally is defined by having each volume $V$ consisting of $z$ acquired slices $\\left\\{I_i: i = 1,\\ldots, z\\right\\}$ subdivided into voxel lattices $v^{i}$, each having a defined size of $m$ and $n$, where $v = \\left\\{v_{kl}|k,l \\in V\\right\\}$ for $k = 1,\\ldots,m$, $l = 1,\\ldots,n$, such that $\\bigcup_{kl}v_{kl}=V$. For each $v^{i}$ we assume that for a scaling factor $r$ at a specific spatial scale $s$, the scaled voxel intensity lattice values $v^i_{klr}$ of the RF envelope amplitude $A_{klr}$ such that $A_{klr} = \\left(v_{klr}\\right)_{r\\in R_s}$, where the different possible resolution levels $Rs: r = 1,\\ldots,s,\\ldots,j$ reaching to the maximum level $j$ represent a stochastic pattern, and the envelope amplitude of the scales $r$ of $v^i_{klr}$ follows a Nakagami distribution. Given the large number of voxel samples to analyze and the known family of probability distributions, the maximum likelihood estimators would tend to have a higher probability of being close to the quantities to be estimated and more often unbiased as compared to moments-based estimation \\cite{chg01}, therefore the associated shape and scale parameters were estimated via maximum likelihood estimation (MLE) by operating on each voxel lattice region and at different scales. The maximum likelihood estimate $\\hat{\\theta} \\left(v\\right)$ for a density function $f\\left(v^1_{111},\\ldots,v^z_{mnj} | \\theta\\right)$ when $\\theta$ is a vector of parameters for the Nakagami distribution family $\\Theta$, estimates the most probable parameters $\\hat{\\theta}\\left(v\\right) = arg max_\\theta \\: D\\left(\\theta|v^1_{111},\\ldots,v^z_{mnj}\\right)$, where $D\\left(\\theta |v\\right) = f\\left(v|\\theta\\right), \\! \\theta \\in \\Theta$ is the score function. Having generated voxel-based Nakagami parameters, 3D wavelet packet Daubechies analysis \\cite{mlt99} can be applied at multiple scales. Namely:\n\n\n", "itemtype": "equation", "pos": 19492, "prevtext": "\n\n\\noindent where $x$ is the envelope of the RF signal, with the shape of the distribution defined by the $\\mu$ parameter corresponding to the local concentration of scatterers, and the local backscattered energy represented by the scale parameter $\\omega$ $>$ 0, for $x$ $>$ 0, and $\\Gamma\\left(\\cdot\\right)$ is the Gamma function. If $x$ has a Nakagami distribution $N$ with parameters $\\mu$ and $\\omega$, then $x^2$ has a Gamma distribution $\\Gamma$ with shape $\\mu$ and scale (energy) parameter $\\omega$/$\\mu$. \\\\\n    \\indent The Nakagami distribution can model various backscattering conditions in medical ultrasound. By varying $\\mu$, the envelope statistics range from pre-Rayleigh $\\left(\\mu < 1\\right)$, Rayleigh $\\left(0 < \\mu < 0.5\\right)$, and to post-Rayleigh $\\left(\\mu > 1 \\right)$.  The Nakagami parameters are generally estimated by the $2^{nd}$ and $4^{th}$ order moments, where given $x$ is the ultrasonic backscattered envelope and $E\\left(\\cdot\\right)$ denotes the statistical mean, the two Nakagami parameters can be calculated as:\n\n", "index": 3, "text": "\\begin{equation}\n\t\\omega = E\\left(x^{2}\\right) , and \\quad \\mu = \\frac{E\\left(x^{2}\\right)^{2}}{Var\\left(x^{2}\\right)} = \\frac{E\\left(x^{2}\\right)^{2}}{E\\left(x^{4}\\right) - E\\left(x^{2}\\right)^{2} .}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"\\omega=E\\left(x^{2}\\right),and\\quad\\mu=\\frac{E\\left(x^{2}\\right)^{2}}{Var\\left%&#10;(x^{2}\\right)}=\\frac{E\\left(x^{2}\\right)^{2}}{E\\left(x^{4}\\right)-E\\left(x^{2}%&#10;\\right)^{2}.}\" display=\"block\"><mrow><mrow><mi>\u03c9</mi><mo>=</mo><mrow><mrow><mi>E</mi><mo>\u2062</mo><mrow><mo>(</mo><msup><mi>x</mi><mn>2</mn></msup><mo>)</mo></mrow></mrow><mo>,</mo><mrow><mi>a</mi><mo>\u2062</mo><mi>n</mi><mo>\u2062</mo><mi>d</mi></mrow></mrow></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003</mo><mrow><mi>\u03bc</mi><mo>=</mo><mfrac><mrow><mi>E</mi><mo>\u2062</mo><msup><mrow><mo>(</mo><msup><mi>x</mi><mn>2</mn></msup><mo>)</mo></mrow><mn>2</mn></msup></mrow><mrow><mi>V</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>r</mi><mo>\u2062</mo><mrow><mo>(</mo><msup><mi>x</mi><mn>2</mn></msup><mo>)</mo></mrow></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>E</mi><mo>\u2062</mo><msup><mrow><mo>(</mo><msup><mi>x</mi><mn>2</mn></msup><mo>)</mo></mrow><mn>2</mn></msup></mrow><mrow><mi>E</mi><mrow><mo>(</mo><msup><mi>x</mi><mn>4</mn></msup><mo>)</mo></mrow><mo>-</mo><mi>E</mi><msup><mrow><mo>(</mo><msup><mi>x</mi><mn>2</mn></msup><mo>)</mo></mrow><mn>2</mn></msup><mo>.</mo></mrow></mfrac></mrow></mrow></math>", "type": "latex"}, {"file": "1601.03531.tex", "nexttext": "\n\n\n", "itemtype": "equation", "pos": 21688, "prevtext": "\n\n\n\n\n\n\n\n\n\t\t\n\\subsection{Volumetric multi-scale Nakagami modeling}\n\nA 3D feature signature that operates locally is defined by having each volume $V$ consisting of $z$ acquired slices $\\left\\{I_i: i = 1,\\ldots, z\\right\\}$ subdivided into voxel lattices $v^{i}$, each having a defined size of $m$ and $n$, where $v = \\left\\{v_{kl}|k,l \\in V\\right\\}$ for $k = 1,\\ldots,m$, $l = 1,\\ldots,n$, such that $\\bigcup_{kl}v_{kl}=V$. For each $v^{i}$ we assume that for a scaling factor $r$ at a specific spatial scale $s$, the scaled voxel intensity lattice values $v^i_{klr}$ of the RF envelope amplitude $A_{klr}$ such that $A_{klr} = \\left(v_{klr}\\right)_{r\\in R_s}$, where the different possible resolution levels $Rs: r = 1,\\ldots,s,\\ldots,j$ reaching to the maximum level $j$ represent a stochastic pattern, and the envelope amplitude of the scales $r$ of $v^i_{klr}$ follows a Nakagami distribution. Given the large number of voxel samples to analyze and the known family of probability distributions, the maximum likelihood estimators would tend to have a higher probability of being close to the quantities to be estimated and more often unbiased as compared to moments-based estimation \\cite{chg01}, therefore the associated shape and scale parameters were estimated via maximum likelihood estimation (MLE) by operating on each voxel lattice region and at different scales. The maximum likelihood estimate $\\hat{\\theta} \\left(v\\right)$ for a density function $f\\left(v^1_{111},\\ldots,v^z_{mnj} | \\theta\\right)$ when $\\theta$ is a vector of parameters for the Nakagami distribution family $\\Theta$, estimates the most probable parameters $\\hat{\\theta}\\left(v\\right) = arg max_\\theta \\: D\\left(\\theta|v^1_{111},\\ldots,v^z_{mnj}\\right)$, where $D\\left(\\theta |v\\right) = f\\left(v|\\theta\\right), \\! \\theta \\in \\Theta$ is the score function. Having generated voxel-based Nakagami parameters, 3D wavelet packet Daubechies analysis \\cite{mlt99} can be applied at multiple scales. Namely:\n\n\n", "index": 5, "text": "\\begin{equation}\nW_\\varphi \\left(t_0, x, y, z\\right) = \\frac{1}{\\sqrt{mnj}} \\sum^{j-1}_{r=0} \\sum^{n-1}_{l=0} \\sum^{m-1}_{k=0} v_{klr}\\varphi_{klr}\\left(t_0, x, y, z\\right) ,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"W_{\\varphi}\\left(t_{0},x,y,z\\right)=\\frac{1}{\\sqrt{mnj}}\\sum^{j-1}_{r=0}\\sum^{%&#10;n-1}_{l=0}\\sum^{m-1}_{k=0}v_{klr}\\varphi_{klr}\\left(t_{0},x,y,z\\right),\" display=\"block\"><mrow><mrow><mrow><msub><mi>W</mi><mi>\u03c6</mi></msub><mo>\u2062</mo><mrow><mo>(</mo><msub><mi>t</mi><mn>0</mn></msub><mo>,</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo>)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><msqrt><mrow><mi>m</mi><mo>\u2062</mo><mi>n</mi><mo>\u2062</mo><mi>j</mi></mrow></msqrt></mfrac><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>r</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>j</mi><mo>-</mo><mn>1</mn></mrow></munderover><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>l</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></munderover><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow></munderover><mrow><msub><mi>v</mi><mrow><mi>k</mi><mo>\u2062</mo><mi>l</mi><mo>\u2062</mo><mi>r</mi></mrow></msub><mo>\u2062</mo><msub><mi>\u03c6</mi><mrow><mi>k</mi><mo>\u2062</mo><mi>l</mi><mo>\u2062</mo><mi>r</mi></mrow></msub><mo>\u2062</mo><mrow><mo>(</mo><msub><mi>t</mi><mn>0</mn></msub><mo>,</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo>)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.03531.tex", "nexttext": "\n\\\\\n\\noindent where $v_{klr} \\in L^2\\left(\\Re\\right)$ is relative to scaling $\\varphi_{klr}$ and wavelet function $\\psi_{klr}$ and $W_\\varphi\\left(t_0, m, n\\right)$ defines an approximation of $v_{klr}$ at scale $t_0$, and $W^i_\\psi\\left(t, m, n\\right)$ coefficients add horizontal, vertical and diagonal details for scales $t \\geq t_0$. The Daubechies wavelet family can account for self-similarity and signal discontinuities, making it one of the most useful wavelets for characterizing signals exhibiting fractal patterns \\cite{dub90}. In our case an orthogonal 8-tap Daubechies filter was used to obtain the wavelet packets by expanding the basis having the most significant fractal signature rather than energy.\\\\\n    \\indent An octant wavelet transform depends mainly on the scaling $h_0\\left(k\\right)$ and wavelet $h_1\\left(k\\right)$ filters for image decomposition, and one does not need to express the $\\varphi_{klr}$ and $\\psi_{klr}$ in their explicit form. The decomposition process can be viewed as passing the signal through a pair of lowpass $\\left(L\\right)$ and highpass $\\left(H\\right)$ filters, also known as \\textit{quadrature mirror} filters, having impulse responses $\\tilde{h}_0\\left(k\\right)$ and $\\tilde{h}_1\\left(k\\right)$, while holding the size of the transformed image the same as the original image as we are applying an overcomplete wavelet representation; hence giving a better representation of the texture characteristics at each decomposition. The impulse responses of $L$ and $H$ are defined as $\\tilde{h}_0\\left(a\\right) = h_0\\left(-a\\right)$ and $\\tilde{h}_1\\left(a\\right) = h_1\\left(-a\\right)$ for scaling parameter $a$, and $\\tilde{h}_0\\left(b\\right) = h_0\\left(-b\\right)$ and $\\tilde{h}_1\\left(b\\right) = h_1\\left(-b\\right)$ for translation parameter $b$, where $a, b \\in Z$. The decomposition is performed recursively on the output of $\\tilde{h}_0\\left(a\\right)$, $\\tilde{h}_1\\left(a\\right)$ and $\\tilde{h}_0\\left(b\\right)$, $\\tilde{h}_1\\left(b\\right)$. Hence, the 3-D wavelet (or octant wavelet packet) can be expressed by the tensor product of the wavelet basis functions along the horizontal, vertical and depth directions. The corresponding filter coefficients can be recursively decomposed by a factor of eight as illustrated in Fig.~\\ref{fig:voxel-decomposition} and expressed in (5), with subscripts indicating the low and high pass filtering characteristics in the $m$, $n$ and $j$ directions:\n\t\t\\begin{eqnarray} \n\t\th_{LLL}\\left(a,b\\right) = h_0\\left(a\\right) h_0\\left(a\\right) h_0\\left(b\\right) , & h_{LHL}\\left(a,b\\right) = h_0\\left(b\\right)h_1\\left(a\\right)h_0\\left(b\\right) , \\nonumber \\\\\n\t\th_{LLH}\\left(a,b\\right) = h_0\\left(a\\right)h_0\\left(a\\right)h_1\\left(b\\right) , & h_{LHH}\\left(a,b\\right) = h_0\\left(b\\right)h_1\\left(a\\right)h_1\\left(b\\right) , \\nonumber \\\\\n\t\th_{HLL}\\left(a,b\\right) = h_1\\left(b\\right)h_0\\left(a\\right)h_0\\left(b\\right) , & h_{HHL}\\left(a,b\\right) = h_1\\left(a\\right)h_1\\left(a\\right)h_0\\left(b\\right)  ,\\nonumber \\\\\n\t\th_{HLH}\\left(a,b\\right) = h_1\\left(b\\right)h_0\\left(a\\right)h_1\\left(b\\right) , & h_{HHH}\\left(a,b\\right) = h_1\\left(a\\right)h_1\\left(a\\right)h_1\\left(b\\right)  .\n\t\t\\end{eqnarray}\n\t\t\n\t\t\\indent By decomposing the approximation coefficients of the signal as well, the wavelet transform can be extended in the middle and high frequency channels, providing a more complete partitioning of the spatial-frequency domain, which is known as the octant wavelet packet transform \\cite{coi92}. As the textural information about the structural arrangement of surfaces and their relationship to the surrounding neighborhood is spread across the frequency sub-bands, most of the important discriminant features related to the structure terminations and endpoints of surface edges will have a stronger response in higher frequencies \\cite{alk09}. Thereby, this gives an equal opportunity for investigating descriptors of textural features prevailing in the middle and high frequency bands. \n\t\t\n\t\t\\begin{figure}\n\t\t\\begin{center}\n\t\t\\includegraphics[scale = 0.85]{fig5}\n\t\t\\end{center}\n\t\t\\caption{Multiresolution volumetric modeling showing the decomposition up to 3 hierarchical levels by recursive subdivision of volume into octants voxels (left) and corresponding decomposition tree (middle).}\n\t\t\\label{fig:voxel-decomposition}\n\t\t\\end{figure}\n\t\t\n    \\indent From a pattern recognition perspective, the selection of the most suitable wavelet is associated with the understanding of the tissue textural properties and synthesis wavelet. Wavelet analysis using Daubechies wavelet basis functions can achieve a good spatial-frequency localization by having narrow high and wide low frequencies simultaneously. With the increasing number of zero or vanishing moments -- which are half the number of filter taps $N$ -- this can give a sparse representation for a large class of signal types. Also the Daubechies orthogonal wavelet family consists of purposefully designed filters which account for self-similarity and signal discontinuities, making them one of the most useful wavelets for characterizing signals exhibiting fractal patterns. Besides, they are also considered to be sensitive in recognizing fine characteristic structures, and its application of overlapping windows, unlike other wavelets such as the Haar wavelet, facilitates the capture of all high frequency changes easily \\cite{mlt99}. As our work is concerned with the estimation of texture surface roughness from a fractal dimension perspective, the choice of this wavelet is more suitable than other wavelet families \\cite{dub92}. Therefore an orthogonal 8-tap Daubechies filter \\cite{dub90}  in a tree structure decomposition is used to obtain the wavelet packets by expanding the basis having the most significant fractal signature, see Fig.~\\ref{fig:wavelets}. This approach gives flexibility to finely tune the signal to the characteristic intrinsic properties of an image~\\cite{wng08}.\\\\\n\t\t\t\n\t\t\\begin{figure}\n\t\t\\begin{center}\n\t\t\\includegraphics[scale = 0.85]{fig6}\n\t\t\\end{center}\n\t\t\\caption{Normalized Daubechies' orthogonal wavelet showing scaling (father) $\\phi(t)$ and wavelet (mother) $\\psi(t)$ functions with 4 vanishing moments, and corresponding first level Daubechies wavelet decomposition for a liver tumor volume of interest showing from left to right the approximation, horizontal, vertical, and diagonal coefficients, respectively.}\n\t\t\\label{fig:wavelets}\n\t\t\\end{figure}\n\t\t\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\subsection{Multi-fractal textural model}\nFractals can be used in tissue characterization to describe irregular structures that exhibit semi self-similarity at different scales, and can further give an estimation of surface roughness (in our case of the RF envelope surface). There are several fractal models used to estimate the fractal dimension (FD); the FD can be estimated via the fractal Brownian motion (fBm) defined in (6) below, which is a non-stationary model known for its capability for describing random phenomena \\cite{lop09}. Its statistical invariance to dilation, translation and rotation, can mitigate multiplicative speckle scale changes, making it a perfect candidate to be integrated with the Nakagami modeling and multi-resolution decomposition:\n\n\n", "itemtype": "equation", "pos": 21879, "prevtext": "\n\n\n", "index": 7, "text": "\\begin{equation}\nW^i_\\psi \\left(t, x, y, z\\right) = \\frac{1}{\\sqrt{mnj}} \\sum^{j-1}_{r=0} \\sum^{n-1}_{l=0} \\sum^{m-1}_{k=0} v_{klr}\\psi^i_{klr}\\left(t, x, y, z\\right) ,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"W^{i}_{\\psi}\\left(t,x,y,z\\right)=\\frac{1}{\\sqrt{mnj}}\\sum^{j-1}_{r=0}\\sum^{n-1%&#10;}_{l=0}\\sum^{m-1}_{k=0}v_{klr}\\psi^{i}_{klr}\\left(t,x,y,z\\right),\" display=\"block\"><mrow><mrow><mrow><msubsup><mi>W</mi><mi>\u03c8</mi><mi>i</mi></msubsup><mo>\u2062</mo><mrow><mo>(</mo><mi>t</mi><mo>,</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo>)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><msqrt><mrow><mi>m</mi><mo>\u2062</mo><mi>n</mi><mo>\u2062</mo><mi>j</mi></mrow></msqrt></mfrac><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>r</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>j</mi><mo>-</mo><mn>1</mn></mrow></munderover><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>l</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></munderover><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow></munderover><mrow><msub><mi>v</mi><mrow><mi>k</mi><mo>\u2062</mo><mi>l</mi><mo>\u2062</mo><mi>r</mi></mrow></msub><mo>\u2062</mo><msubsup><mi>\u03c8</mi><mrow><mi>k</mi><mo>\u2062</mo><mi>l</mi><mo>\u2062</mo><mi>r</mi></mrow><mi>i</mi></msubsup><mo>\u2062</mo><mrow><mo>(</mo><mi>t</mi><mo>,</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo>)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.03531.tex", "nexttext": "\n\n\\noindent where $E\\left(\\Delta v \\right) = \\left|q_i - p_j\\right|, \\!j = 1,\\ldots, k$ is the mean absolute difference of voxel pairs $\\Delta v$; $\\Delta r = \\sqrt{\\sum^{n}_{i=1}\\left(q_i - p_i\\right)^2}$ where $n$ = 3 for 3-D space, is the voxel pair distances; $H$ is called the Hurst coefficient; and the constant $K$ $>$ 0.\n\n\\subsubsection{Fractal map estimation}\n\nAfter application of the Daubechies 3D wavelet analysis, the roughness of each voxel lattice surface is determined via estimating its corresponding FD. The estimated voxel-by-voxel array of fractal dimensions for each voxel lattice, which we call a {\\em fractal map}, provides a basis for characterizing the tissue and for building a {\\em bag-of-words} of fractal features as a 3D feature descriptor. \\\\ \n   \\indent A multi-dimensional matrix $N_{xyd}$ defined for each of the tumor voxels $v_{klr}$ is derived at different range scales $r$, such that the mean absolute difference of each voxel pair $\\Delta v$ and for each voxel pair distances $\\Delta r$ are estimated. Thereby the first dimension $d$ represents the voxel after it has been scaled once, and the second dimension represents the voxel at scale 2, and so on until the highest scale $j$ is reached.\n\t\n\n", "itemtype": "equation", "pos": 29290, "prevtext": "\n\\\\\n\\noindent where $v_{klr} \\in L^2\\left(\\Re\\right)$ is relative to scaling $\\varphi_{klr}$ and wavelet function $\\psi_{klr}$ and $W_\\varphi\\left(t_0, m, n\\right)$ defines an approximation of $v_{klr}$ at scale $t_0$, and $W^i_\\psi\\left(t, m, n\\right)$ coefficients add horizontal, vertical and diagonal details for scales $t \\geq t_0$. The Daubechies wavelet family can account for self-similarity and signal discontinuities, making it one of the most useful wavelets for characterizing signals exhibiting fractal patterns \\cite{dub90}. In our case an orthogonal 8-tap Daubechies filter was used to obtain the wavelet packets by expanding the basis having the most significant fractal signature rather than energy.\\\\\n    \\indent An octant wavelet transform depends mainly on the scaling $h_0\\left(k\\right)$ and wavelet $h_1\\left(k\\right)$ filters for image decomposition, and one does not need to express the $\\varphi_{klr}$ and $\\psi_{klr}$ in their explicit form. The decomposition process can be viewed as passing the signal through a pair of lowpass $\\left(L\\right)$ and highpass $\\left(H\\right)$ filters, also known as \\textit{quadrature mirror} filters, having impulse responses $\\tilde{h}_0\\left(k\\right)$ and $\\tilde{h}_1\\left(k\\right)$, while holding the size of the transformed image the same as the original image as we are applying an overcomplete wavelet representation; hence giving a better representation of the texture characteristics at each decomposition. The impulse responses of $L$ and $H$ are defined as $\\tilde{h}_0\\left(a\\right) = h_0\\left(-a\\right)$ and $\\tilde{h}_1\\left(a\\right) = h_1\\left(-a\\right)$ for scaling parameter $a$, and $\\tilde{h}_0\\left(b\\right) = h_0\\left(-b\\right)$ and $\\tilde{h}_1\\left(b\\right) = h_1\\left(-b\\right)$ for translation parameter $b$, where $a, b \\in Z$. The decomposition is performed recursively on the output of $\\tilde{h}_0\\left(a\\right)$, $\\tilde{h}_1\\left(a\\right)$ and $\\tilde{h}_0\\left(b\\right)$, $\\tilde{h}_1\\left(b\\right)$. Hence, the 3-D wavelet (or octant wavelet packet) can be expressed by the tensor product of the wavelet basis functions along the horizontal, vertical and depth directions. The corresponding filter coefficients can be recursively decomposed by a factor of eight as illustrated in Fig.~\\ref{fig:voxel-decomposition} and expressed in (5), with subscripts indicating the low and high pass filtering characteristics in the $m$, $n$ and $j$ directions:\n\t\t\\begin{eqnarray} \n\t\th_{LLL}\\left(a,b\\right) = h_0\\left(a\\right) h_0\\left(a\\right) h_0\\left(b\\right) , & h_{LHL}\\left(a,b\\right) = h_0\\left(b\\right)h_1\\left(a\\right)h_0\\left(b\\right) , \\nonumber \\\\\n\t\th_{LLH}\\left(a,b\\right) = h_0\\left(a\\right)h_0\\left(a\\right)h_1\\left(b\\right) , & h_{LHH}\\left(a,b\\right) = h_0\\left(b\\right)h_1\\left(a\\right)h_1\\left(b\\right) , \\nonumber \\\\\n\t\th_{HLL}\\left(a,b\\right) = h_1\\left(b\\right)h_0\\left(a\\right)h_0\\left(b\\right) , & h_{HHL}\\left(a,b\\right) = h_1\\left(a\\right)h_1\\left(a\\right)h_0\\left(b\\right)  ,\\nonumber \\\\\n\t\th_{HLH}\\left(a,b\\right) = h_1\\left(b\\right)h_0\\left(a\\right)h_1\\left(b\\right) , & h_{HHH}\\left(a,b\\right) = h_1\\left(a\\right)h_1\\left(a\\right)h_1\\left(b\\right)  .\n\t\t\\end{eqnarray}\n\t\t\n\t\t\\indent By decomposing the approximation coefficients of the signal as well, the wavelet transform can be extended in the middle and high frequency channels, providing a more complete partitioning of the spatial-frequency domain, which is known as the octant wavelet packet transform \\cite{coi92}. As the textural information about the structural arrangement of surfaces and their relationship to the surrounding neighborhood is spread across the frequency sub-bands, most of the important discriminant features related to the structure terminations and endpoints of surface edges will have a stronger response in higher frequencies \\cite{alk09}. Thereby, this gives an equal opportunity for investigating descriptors of textural features prevailing in the middle and high frequency bands. \n\t\t\n\t\t\\begin{figure}\n\t\t\\begin{center}\n\t\t\\includegraphics[scale = 0.85]{fig5}\n\t\t\\end{center}\n\t\t\\caption{Multiresolution volumetric modeling showing the decomposition up to 3 hierarchical levels by recursive subdivision of volume into octants voxels (left) and corresponding decomposition tree (middle).}\n\t\t\\label{fig:voxel-decomposition}\n\t\t\\end{figure}\n\t\t\n    \\indent From a pattern recognition perspective, the selection of the most suitable wavelet is associated with the understanding of the tissue textural properties and synthesis wavelet. Wavelet analysis using Daubechies wavelet basis functions can achieve a good spatial-frequency localization by having narrow high and wide low frequencies simultaneously. With the increasing number of zero or vanishing moments -- which are half the number of filter taps $N$ -- this can give a sparse representation for a large class of signal types. Also the Daubechies orthogonal wavelet family consists of purposefully designed filters which account for self-similarity and signal discontinuities, making them one of the most useful wavelets for characterizing signals exhibiting fractal patterns. Besides, they are also considered to be sensitive in recognizing fine characteristic structures, and its application of overlapping windows, unlike other wavelets such as the Haar wavelet, facilitates the capture of all high frequency changes easily \\cite{mlt99}. As our work is concerned with the estimation of texture surface roughness from a fractal dimension perspective, the choice of this wavelet is more suitable than other wavelet families \\cite{dub92}. Therefore an orthogonal 8-tap Daubechies filter \\cite{dub90}  in a tree structure decomposition is used to obtain the wavelet packets by expanding the basis having the most significant fractal signature, see Fig.~\\ref{fig:wavelets}. This approach gives flexibility to finely tune the signal to the characteristic intrinsic properties of an image~\\cite{wng08}.\\\\\n\t\t\t\n\t\t\\begin{figure}\n\t\t\\begin{center}\n\t\t\\includegraphics[scale = 0.85]{fig6}\n\t\t\\end{center}\n\t\t\\caption{Normalized Daubechies' orthogonal wavelet showing scaling (father) $\\phi(t)$ and wavelet (mother) $\\psi(t)$ functions with 4 vanishing moments, and corresponding first level Daubechies wavelet decomposition for a liver tumor volume of interest showing from left to right the approximation, horizontal, vertical, and diagonal coefficients, respectively.}\n\t\t\\label{fig:wavelets}\n\t\t\\end{figure}\n\t\t\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\subsection{Multi-fractal textural model}\nFractals can be used in tissue characterization to describe irregular structures that exhibit semi self-similarity at different scales, and can further give an estimation of surface roughness (in our case of the RF envelope surface). There are several fractal models used to estimate the fractal dimension (FD); the FD can be estimated via the fractal Brownian motion (fBm) defined in (6) below, which is a non-stationary model known for its capability for describing random phenomena \\cite{lop09}. Its statistical invariance to dilation, translation and rotation, can mitigate multiplicative speckle scale changes, making it a perfect candidate to be integrated with the Nakagami modeling and multi-resolution decomposition:\n\n\n", "index": 9, "text": "\\begin{equation}\nE\\left(\\Delta v \\right) = K\\Delta r^H\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"E\\left(\\Delta v\\right)=K\\Delta r^{H}\" display=\"block\"><mrow><mrow><mi>E</mi><mo>\u2062</mo><mrow><mo>(</mo><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><mi>v</mi></mrow><mo>)</mo></mrow></mrow><mo>=</mo><mrow><mi>K</mi><mo>\u2062</mo><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msup><mi>r</mi><mi>H</mi></msup></mrow></mrow></math>", "type": "latex"}, {"file": "1601.03531.tex", "nexttext": "\n\n\\noindent where $M$ and $N$ are the size of each ultrasound image slice and $d = 1, \\ldots , j$ is the resolution limits of matrix $N_{xyd}$ which represents the mean absolute intensity difference to center voxels, and $i$ stands for Nakagami shape $\\mu$ and scale $\\omega$ parametric images. Then each element from each array in $N_{xyd}$ is normalized after taking the logarithm and saved in a mean absolute difference row vector $\\Delta \\hat{v}$. That is, the first element in all arrays of $N_{xyd}$ will compose vector $\\Delta \\hat{v}_1$, and all second elements will compose vector $\\Delta \\hat{v}_2$, and so on as shown in (8). This process is illustrated in Fig.~\\ref{fig:multiscale-regions}. \n\n\\begin{figure}\n\\begin{center}\n\\includegraphics[scale = 0.95]{fig7}\n\\end{center}\n\\caption{Overcomplete multi-scale volumetric Nakagami tumor regions; the small $m \\times n \\times i$ voxel lattice centered on the localized voxel $v_{klr}$, where $k$, $l$, and $r$ are the voxel position on the lattice for scale $r$, is convolved with larger voxels up to $j$ resolution levels for estimation of the mean absolute difference of voxel pairs matrix.}\n\\label{fig:multiscale-regions}\n\\end{figure}\n\n\n", "itemtype": "equation", "pos": 30594, "prevtext": "\n\n\\noindent where $E\\left(\\Delta v \\right) = \\left|q_i - p_j\\right|, \\!j = 1,\\ldots, k$ is the mean absolute difference of voxel pairs $\\Delta v$; $\\Delta r = \\sqrt{\\sum^{n}_{i=1}\\left(q_i - p_i\\right)^2}$ where $n$ = 3 for 3-D space, is the voxel pair distances; $H$ is called the Hurst coefficient; and the constant $K$ $>$ 0.\n\n\\subsubsection{Fractal map estimation}\n\nAfter application of the Daubechies 3D wavelet analysis, the roughness of each voxel lattice surface is determined via estimating its corresponding FD. The estimated voxel-by-voxel array of fractal dimensions for each voxel lattice, which we call a {\\em fractal map}, provides a basis for characterizing the tissue and for building a {\\em bag-of-words} of fractal features as a 3D feature descriptor. \\\\ \n   \\indent A multi-dimensional matrix $N_{xyd}$ defined for each of the tumor voxels $v_{klr}$ is derived at different range scales $r$, such that the mean absolute difference of each voxel pair $\\Delta v$ and for each voxel pair distances $\\Delta r$ are estimated. Thereby the first dimension $d$ represents the voxel after it has been scaled once, and the second dimension represents the voxel at scale 2, and so on until the highest scale $j$ is reached.\n\t\n\n", "index": 11, "text": "\\begin{equation}\nN_{xyd} =\t\\left(\\begin{array} {ccccc}\nv^{i}_{11d} & v^{i}_{12d} & \\cdots & \\cdots & v^{i}_{1Nd}\t\t\\\\\nv^{i}_{21d} & v^{i}_{22d} & \\cdots & \\cdots & v^{i}_{2Nd}\t\t\\\\\n\\vdots & \\vdots & \\hspace{-0.05\\textwidth}\\ddots &  & \\vdots\t\t\\\\\n\\vdots & \\vdots &      &\\ddots& \\vdots\t\t\\\\\nv^{i}_{M1d} & v^{i}_{M2d} & \\cdots & \\cdots & v^{i}_{MNd}\t\t\\\\\n\\end{array}\\right)\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"N_{xyd}=\\left(\\begin{array}[]{ccccc}v^{i}_{11d}&amp;v^{i}_{12d}&amp;\\cdots&amp;\\cdots&amp;v^{i%&#10;}_{1Nd}\\\\&#10;v^{i}_{21d}&amp;v^{i}_{22d}&amp;\\cdots&amp;\\cdots&amp;v^{i}_{2Nd}\\\\&#10;\\vdots&amp;\\vdots&amp;\\hskip-21.681pt\\ddots&amp;&amp;\\vdots\\\\&#10;\\vdots&amp;\\vdots&amp;&amp;\\ddots&amp;\\vdots\\\\&#10;v^{i}_{M1d}&amp;v^{i}_{M2d}&amp;\\cdots&amp;\\cdots&amp;v^{i}_{MNd}\\\\&#10;\\end{array}\\right)\" display=\"block\"><mrow><msub><mi>N</mi><mrow><mi>x</mi><mo>\u2062</mo><mi>y</mi><mo>\u2062</mo><mi>d</mi></mrow></msub><mo>=</mo><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><msubsup><mi>v</mi><mrow><mn>11</mn><mo>\u2062</mo><mi>d</mi></mrow><mi>i</mi></msubsup></mtd><mtd columnalign=\"center\"><msubsup><mi>v</mi><mrow><mn>12</mn><mo>\u2062</mo><mi>d</mi></mrow><mi>i</mi></msubsup></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><msubsup><mi>v</mi><mrow><mn>1</mn><mo>\u2062</mo><mi>N</mi><mo>\u2062</mo><mi>d</mi></mrow><mi>i</mi></msubsup></mtd></mtr><mtr><mtd columnalign=\"center\"><msubsup><mi>v</mi><mrow><mn>21</mn><mo>\u2062</mo><mi>d</mi></mrow><mi>i</mi></msubsup></mtd><mtd columnalign=\"center\"><msubsup><mi>v</mi><mrow><mn>22</mn><mo>\u2062</mo><mi>d</mi></mrow><mi>i</mi></msubsup></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><msubsup><mi>v</mi><mrow><mn>2</mn><mo>\u2062</mo><mi>N</mi><mo>\u2062</mo><mi>d</mi></mrow><mi>i</mi></msubsup></mtd></mtr><mtr><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd columnalign=\"center\"><mpadded lspace=\"-21.7pt\" width=\"-21.7pt\"><mi mathvariant=\"normal\">\u22f1</mi></mpadded></mtd><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd></mtr><mtr><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22f1</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd></mtr><mtr><mtd columnalign=\"center\"><msubsup><mi>v</mi><mrow><mi>M</mi><mo>\u2062</mo><mn>1</mn><mo>\u2062</mo><mi>d</mi></mrow><mi>i</mi></msubsup></mtd><mtd columnalign=\"center\"><msubsup><mi>v</mi><mrow><mi>M</mi><mo>\u2062</mo><mn>2</mn><mo>\u2062</mo><mi>d</mi></mrow><mi>i</mi></msubsup></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><msubsup><mi>v</mi><mrow><mi>M</mi><mo>\u2062</mo><mi>N</mi><mo>\u2062</mo><mi>d</mi></mrow><mi>i</mi></msubsup></mtd></mtr></mtable><mo>)</mo></mrow></mrow></math>", "type": "latex"}, {"file": "1601.03531.tex", "nexttext": "\n\nThe slope -- which corresponds to the Hurst coefficient $H$ -- of the least square linear regression line of the log-log plot of $\\Delta \\hat{v}$ versus $\\Delta \\hat{r}$ can be determined by means of sums of squares as in (9).\n\n\n", "itemtype": "equation", "pos": 32172, "prevtext": "\n\n\\noindent where $M$ and $N$ are the size of each ultrasound image slice and $d = 1, \\ldots , j$ is the resolution limits of matrix $N_{xyd}$ which represents the mean absolute intensity difference to center voxels, and $i$ stands for Nakagami shape $\\mu$ and scale $\\omega$ parametric images. Then each element from each array in $N_{xyd}$ is normalized after taking the logarithm and saved in a mean absolute difference row vector $\\Delta \\hat{v}$. That is, the first element in all arrays of $N_{xyd}$ will compose vector $\\Delta \\hat{v}_1$, and all second elements will compose vector $\\Delta \\hat{v}_2$, and so on as shown in (8). This process is illustrated in Fig.~\\ref{fig:multiscale-regions}. \n\n\\begin{figure}\n\\begin{center}\n\\includegraphics[scale = 0.95]{fig7}\n\\end{center}\n\\caption{Overcomplete multi-scale volumetric Nakagami tumor regions; the small $m \\times n \\times i$ voxel lattice centered on the localized voxel $v_{klr}$, where $k$, $l$, and $r$ are the voxel position on the lattice for scale $r$, is convolved with larger voxels up to $j$ resolution levels for estimation of the mean absolute difference of voxel pairs matrix.}\n\\label{fig:multiscale-regions}\n\\end{figure}\n\n\n", "index": 13, "text": "\\begin{equation}\n\\left(\\begin{array} {c}\n\\Delta \\hat{v}_1\t\t\\\\\n\\Delta \\hat{v}_2\t\t\\\\\n\\Delta \\hat{v}_3\t\t\\\\\n\\vdots\t\t\\\\\n\\Delta \\hat{v}_{M \\times N}\t\t\\\\\n\\end{array}\\right) =\tlog\\left(\\begin{array} {ccccc}\n\\frac{\\Delta \\hat{v}^{i}_{111}}{\\left\\|\\Delta \\hat{v}^{i}_{111}\\right\\|} & \\frac{\\Delta \\hat{v}^{i}_{112}}{\\left\\|\\Delta \\hat{v}^{i}_{112}\\right\\|} & \\cdots & \\cdots & \\frac{\\Delta \\hat{v}^{i}_{11j}}{\\left\\|\\Delta \\hat{v}^{i}_{11j}\\right\\|}\t\t\\\\\n\\frac{\\Delta \\hat{v}^{i}_{121}}{\\left\\|\\Delta \\hat{v}^{i}_{121}\\right\\|} & \\frac{\\Delta \\hat{v}^{i}_{122}}{\\left\\|\\Delta \\hat{v}^{i}_{122}\\right\\|} & \\cdots & \\cdots & \\frac{\\Delta \\hat{v}^{i}_{12j}}{\\left\\|\\Delta \\hat{v}^{i}_{12j}\\right\\|}\t\t\\\\\n\\vdots & \\vdots & \\hspace{-0.05\\textwidth}\\ddots &  & \\vdots\t\t\\\\\n\\vdots & \\vdots &      &\\ddots& \\vdots\t\t\\\\\n\\frac{\\Delta \\hat{v}^{i}_{MN1}}{\\left\\|\\Delta \\hat{v}^{i}_{MN1}\\right\\|} & \\frac{\\Delta \\hat{v}^{i}_{MN2}}{\\left\\|\\Delta \\hat{v}^{i}_{MN2}\\right\\|} & \\cdots & \\cdots & \\frac{\\Delta \\hat{v}^{i}_{MNj}}{\\left\\|\\Delta \\hat{v}^{i}_{MNj}\\right\\|}\t\t\\\\\n\\end{array}\\right)\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"\\left(\\begin{array}[]{c}\\Delta\\hat{v}_{1}\\\\&#10;\\Delta\\hat{v}_{2}\\\\&#10;\\Delta\\hat{v}_{3}\\\\&#10;\\vdots\\\\&#10;\\Delta\\hat{v}_{M\\times N}\\\\&#10;\\end{array}\\right)=log\\left(\\begin{array}[]{ccccc}\\frac{\\Delta\\hat{v}^{i}_{111%&#10;}}{\\left\\|\\Delta\\hat{v}^{i}_{111}\\right\\|}&amp;\\frac{\\Delta\\hat{v}^{i}_{112}}{%&#10;\\left\\|\\Delta\\hat{v}^{i}_{112}\\right\\|}&amp;\\cdots&amp;\\cdots&amp;\\frac{\\Delta\\hat{v}^{i}_%&#10;{11j}}{\\left\\|\\Delta\\hat{v}^{i}_{11j}\\right\\|}\\\\&#10;\\frac{\\Delta\\hat{v}^{i}_{121}}{\\left\\|\\Delta\\hat{v}^{i}_{121}\\right\\|}&amp;\\frac{%&#10;\\Delta\\hat{v}^{i}_{122}}{\\left\\|\\Delta\\hat{v}^{i}_{122}\\right\\|}&amp;\\cdots&amp;\\cdots%&#10;&amp;\\frac{\\Delta\\hat{v}^{i}_{12j}}{\\left\\|\\Delta\\hat{v}^{i}_{12j}\\right\\|}\\\\&#10;\\vdots&amp;\\vdots&amp;\\hskip-21.681pt\\ddots&amp;&amp;\\vdots\\\\&#10;\\vdots&amp;\\vdots&amp;&amp;\\ddots&amp;\\vdots\\\\&#10;\\frac{\\Delta\\hat{v}^{i}_{MN1}}{\\left\\|\\Delta\\hat{v}^{i}_{MN1}\\right\\|}&amp;\\frac{%&#10;\\Delta\\hat{v}^{i}_{MN2}}{\\left\\|\\Delta\\hat{v}^{i}_{MN2}\\right\\|}&amp;\\cdots&amp;\\cdots%&#10;&amp;\\frac{\\Delta\\hat{v}^{i}_{MNj}}{\\left\\|\\Delta\\hat{v}^{i}_{MNj}\\right\\|}\\\\&#10;\\end{array}\\right)\" display=\"block\"><mrow><mrow><mo>(</mo><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msub><mover accent=\"true\"><mi>v</mi><mo stretchy=\"false\">^</mo></mover><mn>1</mn></msub></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msub><mover accent=\"true\"><mi>v</mi><mo stretchy=\"false\">^</mo></mover><mn>2</mn></msub></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msub><mover accent=\"true\"><mi>v</mi><mo stretchy=\"false\">^</mo></mover><mn>3</mn></msub></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msub><mover accent=\"true\"><mi>v</mi><mo stretchy=\"false\">^</mo></mover><mrow><mi>M</mi><mo>\u00d7</mo><mi>N</mi></mrow></msub></mrow></mtd></mtr></mtable><mo>)</mo></mrow><mo>=</mo><mrow><mi>l</mi><mo>\u2062</mo><mi>o</mi><mo>\u2062</mo><mi>g</mi><mo>\u2062</mo><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mfrac><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msubsup><mover accent=\"true\"><mi>v</mi><mo stretchy=\"false\">^</mo></mover><mn>111</mn><mi>i</mi></msubsup></mrow><mrow><mo>\u2225</mo><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msubsup><mover accent=\"true\"><mi>v</mi><mo stretchy=\"false\">^</mo></mover><mn>111</mn><mi>i</mi></msubsup></mrow><mo>\u2225</mo></mrow></mfrac></mtd><mtd columnalign=\"center\"><mfrac><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msubsup><mover accent=\"true\"><mi>v</mi><mo stretchy=\"false\">^</mo></mover><mn>112</mn><mi>i</mi></msubsup></mrow><mrow><mo>\u2225</mo><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msubsup><mover accent=\"true\"><mi>v</mi><mo stretchy=\"false\">^</mo></mover><mn>112</mn><mi>i</mi></msubsup></mrow><mo>\u2225</mo></mrow></mfrac></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mfrac><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msubsup><mover accent=\"true\"><mi>v</mi><mo stretchy=\"false\">^</mo></mover><mrow><mn>11</mn><mo>\u2062</mo><mi>j</mi></mrow><mi>i</mi></msubsup></mrow><mrow><mo>\u2225</mo><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msubsup><mover accent=\"true\"><mi>v</mi><mo stretchy=\"false\">^</mo></mover><mrow><mn>11</mn><mo>\u2062</mo><mi>j</mi></mrow><mi>i</mi></msubsup></mrow><mo>\u2225</mo></mrow></mfrac></mtd></mtr><mtr><mtd columnalign=\"center\"><mfrac><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msubsup><mover accent=\"true\"><mi>v</mi><mo stretchy=\"false\">^</mo></mover><mn>121</mn><mi>i</mi></msubsup></mrow><mrow><mo>\u2225</mo><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msubsup><mover accent=\"true\"><mi>v</mi><mo stretchy=\"false\">^</mo></mover><mn>121</mn><mi>i</mi></msubsup></mrow><mo>\u2225</mo></mrow></mfrac></mtd><mtd columnalign=\"center\"><mfrac><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msubsup><mover accent=\"true\"><mi>v</mi><mo stretchy=\"false\">^</mo></mover><mn>122</mn><mi>i</mi></msubsup></mrow><mrow><mo>\u2225</mo><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msubsup><mover accent=\"true\"><mi>v</mi><mo stretchy=\"false\">^</mo></mover><mn>122</mn><mi>i</mi></msubsup></mrow><mo>\u2225</mo></mrow></mfrac></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mfrac><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msubsup><mover accent=\"true\"><mi>v</mi><mo stretchy=\"false\">^</mo></mover><mrow><mn>12</mn><mo>\u2062</mo><mi>j</mi></mrow><mi>i</mi></msubsup></mrow><mrow><mo>\u2225</mo><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msubsup><mover accent=\"true\"><mi>v</mi><mo stretchy=\"false\">^</mo></mover><mrow><mn>12</mn><mo>\u2062</mo><mi>j</mi></mrow><mi>i</mi></msubsup></mrow><mo>\u2225</mo></mrow></mfrac></mtd></mtr><mtr><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd columnalign=\"center\"><mpadded lspace=\"-21.7pt\" width=\"-21.7pt\"><mi mathvariant=\"normal\">\u22f1</mi></mpadded></mtd><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd></mtr><mtr><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22f1</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd></mtr><mtr><mtd columnalign=\"center\"><mfrac><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msubsup><mover accent=\"true\"><mi>v</mi><mo stretchy=\"false\">^</mo></mover><mrow><mi>M</mi><mo>\u2062</mo><mi>N</mi><mo>\u2062</mo><mn>1</mn></mrow><mi>i</mi></msubsup></mrow><mrow><mo>\u2225</mo><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msubsup><mover accent=\"true\"><mi>v</mi><mo stretchy=\"false\">^</mo></mover><mrow><mi>M</mi><mo>\u2062</mo><mi>N</mi><mo>\u2062</mo><mn>1</mn></mrow><mi>i</mi></msubsup></mrow><mo>\u2225</mo></mrow></mfrac></mtd><mtd columnalign=\"center\"><mfrac><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msubsup><mover accent=\"true\"><mi>v</mi><mo stretchy=\"false\">^</mo></mover><mrow><mi>M</mi><mo>\u2062</mo><mi>N</mi><mo>\u2062</mo><mn>2</mn></mrow><mi>i</mi></msubsup></mrow><mrow><mo>\u2225</mo><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msubsup><mover accent=\"true\"><mi>v</mi><mo stretchy=\"false\">^</mo></mover><mrow><mi>M</mi><mo>\u2062</mo><mi>N</mi><mo>\u2062</mo><mn>2</mn></mrow><mi>i</mi></msubsup></mrow><mo>\u2225</mo></mrow></mfrac></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mfrac><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msubsup><mover accent=\"true\"><mi>v</mi><mo stretchy=\"false\">^</mo></mover><mrow><mi>M</mi><mo>\u2062</mo><mi>N</mi><mo>\u2062</mo><mi>j</mi></mrow><mi>i</mi></msubsup></mrow><mrow><mo>\u2225</mo><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msubsup><mover accent=\"true\"><mi>v</mi><mo stretchy=\"false\">^</mo></mover><mrow><mi>M</mi><mo>\u2062</mo><mi>N</mi><mo>\u2062</mo><mi>j</mi></mrow><mi>i</mi></msubsup></mrow><mo>\u2225</mo></mrow></mfrac></mtd></mtr></mtable><mo>)</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.03531.tex", "nexttext": "\n\nFinally, the slope of the linear regression line defines the textural fractal characteristics, which we call the \\textit{fractal map} $\\Im$:\n\n\n", "itemtype": "equation", "pos": 33477, "prevtext": "\n\nThe slope -- which corresponds to the Hurst coefficient $H$ -- of the least square linear regression line of the log-log plot of $\\Delta \\hat{v}$ versus $\\Delta \\hat{r}$ can be determined by means of sums of squares as in (9).\n\n\n", "index": 15, "text": "\\begin{equation}\nS_{rr} = \\sum^{j-1}_{i=1} \\Delta \\hat{r}^2_i - \\frac{\\left(\\sum^{j-1}_{i=1}\\Delta\\hat{r}_i\\right)^2}{j-1} , S_{rv} = \\sum^{j-1}_{i=1}\\sum^{j-1}_{k=1}\\Delta \\hat{r}_i \\hat{v}_k - \\frac{\\left(\\sum^{j-1}_{i=1} \\Delta\\hat{r}_i\\right)\\left(\\sum^{j-1}_{k=1}\\Delta\\hat{v}_k\\right)}{j-1}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m1\" class=\"ltx_Math\" alttext=\"S_{rr}=\\sum^{j-1}_{i=1}\\Delta\\hat{r}^{2}_{i}-\\frac{\\left(\\sum^{j-1}_{i=1}%&#10;\\Delta\\hat{r}_{i}\\right)^{2}}{j-1},S_{rv}=\\sum^{j-1}_{i=1}\\sum^{j-1}_{k=1}%&#10;\\Delta\\hat{r}_{i}\\hat{v}_{k}-\\frac{\\left(\\sum^{j-1}_{i=1}\\Delta\\hat{r}_{i}%&#10;\\right)\\left(\\sum^{j-1}_{k=1}\\Delta\\hat{v}_{k}\\right)}{j-1}\" display=\"block\"><mrow><mrow><msub><mi>S</mi><mrow><mi>r</mi><mo>\u2062</mo><mi>r</mi></mrow></msub><mo>=</mo><mrow><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>j</mi><mo>-</mo><mn>1</mn></mrow></munderover><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msubsup><mover accent=\"true\"><mi>r</mi><mo stretchy=\"false\">^</mo></mover><mi>i</mi><mn>2</mn></msubsup></mrow></mrow><mo>-</mo><mfrac><msup><mrow><mo>(</mo><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>j</mi><mo>-</mo><mn>1</mn></mrow></msubsup><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msub><mover accent=\"true\"><mi>r</mi><mo stretchy=\"false\">^</mo></mover><mi>i</mi></msub></mrow></mrow><mo>)</mo></mrow><mn>2</mn></msup><mrow><mi>j</mi><mo>-</mo><mn>1</mn></mrow></mfrac></mrow></mrow><mo>,</mo><mrow><msub><mi>S</mi><mrow><mi>r</mi><mo>\u2062</mo><mi>v</mi></mrow></msub><mo>=</mo><mrow><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>j</mi><mo>-</mo><mn>1</mn></mrow></munderover><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>j</mi><mo>-</mo><mn>1</mn></mrow></munderover><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msub><mover accent=\"true\"><mi>r</mi><mo stretchy=\"false\">^</mo></mover><mi>i</mi></msub><mo>\u2062</mo><msub><mover accent=\"true\"><mi>v</mi><mo stretchy=\"false\">^</mo></mover><mi>k</mi></msub></mrow></mrow></mrow><mo>-</mo><mfrac><mrow><mrow><mo>(</mo><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>j</mi><mo>-</mo><mn>1</mn></mrow></msubsup><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msub><mover accent=\"true\"><mi>r</mi><mo stretchy=\"false\">^</mo></mover><mi>i</mi></msub></mrow></mrow><mo>)</mo></mrow><mo>\u2062</mo><mrow><mo>(</mo><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>j</mi><mo>-</mo><mn>1</mn></mrow></msubsup><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msub><mover accent=\"true\"><mi>v</mi><mo stretchy=\"false\">^</mo></mover><mi>k</mi></msub></mrow></mrow><mo>)</mo></mrow></mrow><mrow><mi>j</mi><mo>-</mo><mn>1</mn></mrow></mfrac></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.03531.tex", "nexttext": "\n\n\n\\subsubsection{Volume of interest refinement}\n\nIt is important to estimate the Nakagami model parameters with good accuracy, but still have a simple model that is easy to interpret. Estimation from small cuboids of interest can provide poor estimation of the Nakagami parameters \\cite{lru14}. Larger volumes have more data points to fit allowing for averaging of random error, yet this might not be good for tumors with relatively small size. In order to balance the trade off, volume reconstruction was designed to eliminate 2D tumor slices with low information content in order to provide a good characterization of tumor textural patterns. \n\nIn practice, as a tumor grows it tends to adopt a non-uniform shape. This will cause sections in the acquired tumor volume to have a relatively small area compared to the whole tumor, where the texture patterns within these small regions cannot be reliably extracted. Therefore removal of these small regions will not only assist in reducing irrelevant features, computational time and memory, but will also direct the efforts of the developed feature descriptor to focus on characterizing the tumor patterns provided in large volume. The selection of volume slices was performed such that $A_i > \\tilde{A}_m$, where $A_i$ is the tumor area in slice $i = 1, \\ldots, m, \\ldots, z$, and $\\tilde{A}_m$ is the slice $m$ with the median area size.\n\n\n\n\n\n\n\n\n\n    \\indent Another important design decision is the selection of the size of the lattice utilized in Nakagami distribution estimation which is ideally performed automatically. To address this, a varying size voxel lattice was introduced as illustrated in Fig.~\\ref{fig:voxel-lattice} to measure the goodness of fit for the estimated Nakagami model parameters. For error of fit we used the estimated root mean square error (RMSE)  between the MLE-estimated Nakagami values  $x_{mle}$ and the observed voxels values in each voxel lattice $x_v$ starting at size 2, as there would be no meaning if a lattice had a size of 1. The RMSE was thus defined as:\n\t\t\n\t\t\n", "itemtype": "equation", "pos": 33932, "prevtext": "\n\nFinally, the slope of the linear regression line defines the textural fractal characteristics, which we call the \\textit{fractal map} $\\Im$:\n\n\n", "index": 17, "text": "\\begin{equation}\n\\Im = 3 - \\frac{S_{rv}}{S_{rr}} = \\left(\\begin{array} {ccccc}\nH_{11} & H_{12} & \\cdots & \\cdots & H_{1N}\t\t\\\\\nH_{21} & H_{22} & \\cdots & \\cdots & H_{2N}\t\t\\\\\n\\vdots & \\vdots & \\hspace{-0.05\\textwidth}\\ddots &  & \\vdots\t\t\\\\\n\\vdots & \\vdots &      &\\ddots& \\vdots\t\t\\\\\nH_{M1} & H_{M2} & \\cdots & \\cdots & H_{MN}\t\t\\\\\n\\end{array}\\right)\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m1\" class=\"ltx_Math\" alttext=\"\\Im=3-\\frac{S_{rv}}{S_{rr}}=\\left(\\begin{array}[]{ccccc}H_{11}&amp;H_{12}&amp;\\cdots&amp;%&#10;\\cdots&amp;H_{1N}\\\\&#10;H_{21}&amp;H_{22}&amp;\\cdots&amp;\\cdots&amp;H_{2N}\\\\&#10;\\vdots&amp;\\vdots&amp;\\hskip-21.681pt\\ddots&amp;&amp;\\vdots\\\\&#10;\\vdots&amp;\\vdots&amp;&amp;\\ddots&amp;\\vdots\\\\&#10;H_{M1}&amp;H_{M2}&amp;\\cdots&amp;\\cdots&amp;H_{MN}\\\\&#10;\\end{array}\\right)\" display=\"block\"><mrow><mi mathvariant=\"normal\">\u2111</mi><mo>=</mo><mrow><mn>3</mn><mo>-</mo><mfrac><msub><mi>S</mi><mrow><mi>r</mi><mo>\u2062</mo><mi>v</mi></mrow></msub><msub><mi>S</mi><mrow><mi>r</mi><mo>\u2062</mo><mi>r</mi></mrow></msub></mfrac></mrow><mo>=</mo><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><msub><mi>H</mi><mn>11</mn></msub></mtd><mtd columnalign=\"center\"><msub><mi>H</mi><mn>12</mn></msub></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><msub><mi>H</mi><mrow><mn>1</mn><mo>\u2062</mo><mi>N</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign=\"center\"><msub><mi>H</mi><mn>21</mn></msub></mtd><mtd columnalign=\"center\"><msub><mi>H</mi><mn>22</mn></msub></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><msub><mi>H</mi><mrow><mn>2</mn><mo>\u2062</mo><mi>N</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd columnalign=\"center\"><mpadded lspace=\"-21.7pt\" width=\"-21.7pt\"><mi mathvariant=\"normal\">\u22f1</mi></mpadded></mtd><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd></mtr><mtr><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22f1</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd></mtr><mtr><mtd columnalign=\"center\"><msub><mi>H</mi><mrow><mi>M</mi><mo>\u2062</mo><mn>1</mn></mrow></msub></mtd><mtd columnalign=\"center\"><msub><mi>H</mi><mrow><mi>M</mi><mo>\u2062</mo><mn>2</mn></mrow></msub></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><msub><mi>H</mi><mrow><mi>M</mi><mo>\u2062</mo><mi>N</mi></mrow></msub></mtd></mtr></mtable><mo>)</mo></mrow></mrow></math>", "type": "latex"}, {"file": "1601.03531.tex", "nexttext": "\n\\\\\n\\begin{figure}\n\\begin{center}\n\\includegraphics[scale = 1]{fig9}\n\\end{center}\n\\caption{Segmented liver tumor volume of interest; and the annotation squares in the enlarged image show the variation of voxel lattice size used in the experiments.}\n\\label{fig:voxel-lattice}\n\\end{figure}\n\n\\indent Fig.~\\ref{fig:lattice-optimization} is an empirical plot of the goodness of fit of the estimated Nakagami parameters versus voxel lattice size for a typical dataset. Sizes varying from 0.03 mm$^3$ to 6.60 mm$^3$ where used in the experiments. The RMSE oscillates as it reaches its minimum, recording a residual error of 0.68 at a lattice size of 7 voxels before the accuracy starts to decrease for larger sizes. Also in the process of generating the Nakagami parametric images and when the voxel lattice happen to be on the border, all voxels laying outside the volume of interest are eliminated from the calculations in order to discard any bias and to maintain a more credible estimation of the parameters. \n\t\t\n\\begin{figure}\n\\begin{center}\n\\includegraphics[scale = 0.85]{fig10}\n\\end{center}\n\\caption{Goodness of fit for optimizing the voxel lattice size utilized in the Nakagami distribution fitting.}\n\\label{fig:lattice-optimization}\n\\end{figure}\n\n\\subsubsection{Feature selection optimization}\n\nThe ultrasound texture fractal maps representing the FD voxel-based signature for the estimated Nakagami shape and scale parametric images are shown in Fig.~\\ref{fig:voxel-characterization} (e) and (f), respectively. Various wavelet decomposition techniques apply the sub-bands' energy for decomposition which is susceptible to intensity variations in ultrasound images due to speckle; however, the local density function known as the FD, can instead overcome these local variations in voxel intensities as it gives a representation of texture surface roughness, and hence is employed for the multiresolution analysis. The fractal characteristics are estimated for all sub-bands at each level of the wavelet packet decomposition, where the FD is computed on a voxel-by-voxel basis to produce a fractal map $\\Im$ for each sub-band i.e., each voxel in the fractal map has its own localized FD value estimated from its neighborhood as described in the previous section, where the rougher the surface the higher the FD values get, and vice versa. Features at boundaries are computed after assuming that each slice is mirror-like continually extended in both directions.  Specifically, the fractal features $f_{i,j}$ for a specific sub-band $j$ to a certain level of decomposition $i$ represent the average value of the generated $M \\times N$ fractal image map $\\Im$ of a volume of interest $k$ as defined in equation (12).\n\t\t\n\t\t\n", "itemtype": "equation", "pos": 36350, "prevtext": "\n\n\n\\subsubsection{Volume of interest refinement}\n\nIt is important to estimate the Nakagami model parameters with good accuracy, but still have a simple model that is easy to interpret. Estimation from small cuboids of interest can provide poor estimation of the Nakagami parameters \\cite{lru14}. Larger volumes have more data points to fit allowing for averaging of random error, yet this might not be good for tumors with relatively small size. In order to balance the trade off, volume reconstruction was designed to eliminate 2D tumor slices with low information content in order to provide a good characterization of tumor textural patterns. \n\nIn practice, as a tumor grows it tends to adopt a non-uniform shape. This will cause sections in the acquired tumor volume to have a relatively small area compared to the whole tumor, where the texture patterns within these small regions cannot be reliably extracted. Therefore removal of these small regions will not only assist in reducing irrelevant features, computational time and memory, but will also direct the efforts of the developed feature descriptor to focus on characterizing the tumor patterns provided in large volume. The selection of volume slices was performed such that $A_i > \\tilde{A}_m$, where $A_i$ is the tumor area in slice $i = 1, \\ldots, m, \\ldots, z$, and $\\tilde{A}_m$ is the slice $m$ with the median area size.\n\n\n\n\n\n\n\n\n\n    \\indent Another important design decision is the selection of the size of the lattice utilized in Nakagami distribution estimation which is ideally performed automatically. To address this, a varying size voxel lattice was introduced as illustrated in Fig.~\\ref{fig:voxel-lattice} to measure the goodness of fit for the estimated Nakagami model parameters. For error of fit we used the estimated root mean square error (RMSE)  between the MLE-estimated Nakagami values  $x_{mle}$ and the observed voxels values in each voxel lattice $x_v$ starting at size 2, as there would be no meaning if a lattice had a size of 1. The RMSE was thus defined as:\n\t\t\n\t\t\n", "index": 19, "text": "\\begin{equation}\n\t\tRMSE = \\sqrt{\\frac{\\sum_{s=2}^{n}\\left(x_{mle} - x_v\\right)^2}{n} . }\t\t\n\t\t\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E10.m1\" class=\"ltx_Math\" alttext=\"RMSE=\\sqrt{\\frac{\\sum_{s=2}^{n}\\left(x_{mle}-x_{v}\\right)^{2}}{n}.}\" display=\"block\"><mrow><mrow><mi>R</mi><mo>\u2062</mo><mi>M</mi><mo>\u2062</mo><mi>S</mi><mo>\u2062</mo><mi>E</mi></mrow><mo>=</mo><msqrt><mrow><mfrac><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><mi>s</mi><mo>=</mo><mn>2</mn></mrow><mi>n</mi></msubsup><msup><mrow><mo>(</mo><mrow><msub><mi>x</mi><mrow><mi>m</mi><mo>\u2062</mo><mi>l</mi><mo>\u2062</mo><mi>e</mi></mrow></msub><mo>-</mo><msub><mi>x</mi><mi>v</mi></msub></mrow><mo>)</mo></mrow><mn>2</mn></msup></mrow><mi>n</mi></mfrac><mo>.</mo></mrow></msqrt></mrow></math>", "type": "latex"}, {"file": "1601.03531.tex", "nexttext": "\n\t\t\nThis local estimation gives a more reliable estimation compared to a single global value. Finally, the optimized multi-fractal feature vector descriptor consists of all selected sub-band fractal feature signatures $f$ in each volume of interest $k$, expressed as $\\Lambda = \\bigcup_k \\lambda_k$, where $\\lambda_k = \\left\\{f^{1}_{1,1}, \\ldots , f^{k}_{i,j}, \\ldots , f^{z}_{m,n}\\right\\}$. \n\nIn order to save processing time, the dimensionality of the extracted feature vector is reduced by applying a differential threshold which eliminates weak FD signatures. The threshold is defined by the condition $\\bigl(\\forall \\bigl|f^{k}_{i+1,j} -$ $f^{k}_{i+1,j+1} \\bigr|\\in \\Lambda \\bigr) \\leq D_f$ such that the FD signature absolute difference of the previous decomposition level $D_f = \\left|f^{k}_{i,j} - f^{k}_{i,j+1}\\right|$ is satisfied, then the decomposition should terminate. The new 3D Multi-fractal Nakagami Feature descriptor is abbreviated subsequently as MNF, and its estimation summarized in the following pseudo code:\n\n\\begin{algorithm} [!ht]\n  \\caption{Multifractal Nakagami Feature Descriptor Estimation}\n  \\begin{algorithmic}[1]\n    \\REQUIRE Volumetric ultrasound images \\textit{\\textbf{I}}, volume of interests from each volume \\textit{\\textbf{I}}: $I_i = \\left\\{\\left(x_1,y_1,z_1,\\ldots,x_{L_n},y_{L_n},z_{L_n}\t \\right)\\right\\}$, segmented volume of interests: $\\left\\{V_s\\right\\}_{s=1}^{Z}$.\n    \\ENSURE multifractal feature descriptor $\\left\\{\\Lambda_{f}^{(k)}\\right\\}$\n    \\FORALL {Segmented volumes of interest $V_1 \\rightarrow V_Z$} \n\t\t    \\bigskip\n\t\t\t\t\\STATE \\COMMENT{\\textbf{Step 1}} //\\underline{subdivide each volume of interest $V_l$ into voxel lattices $v^i$.}\n\t\t\t\t\\FORALL {Voxel lattices $v_{111}^{1} \\rightarrow v_{mnj}^{z}$}\n        \\STATE Fit with a Nakagami distribution \n\t\t\t\t$N(x|\\mu,\\omega)=2\\left(\\frac{\\mu}{\\omega}\\right)^{\\mu}\\frac{1}{\\Gamma\\left(\\mu\\right)} x^{\\left(2\\mu-1\\right)}$\n\t\t\t\t\\bigskip\n\t\t\t\t\\STATE \\COMMENT {\\textbf{Step 2}} //\\underline{calculate Nakagami shape $\\mu$ and scale $\\omega$ parameters us-}\n\t\t\t\t\\underline{ing maximum likelihood estimation as:}\n\t\t\t\t\\STATEx $\\hat{\\theta}\\left(v\\right) = arg max_\\theta \\: D\\left(\\theta/v^1_{111},\\ldots,v^z_{mnj}\\right)$\n\t\t\t\t\\STATEx where $\\theta$ is a vector of parameters for the Nakagami distribution family $f\\left(v^1_{111},\\ldots,v^z_{mnj}/\\theta\\right)$\n\t\t\t\t\\bigskip\n\t\t\t\t\n\t\t\t\t\\STATE \\COMMENT {\\textbf{Step 3}}//\\underline{construct Nakagami shape $N_\\mu$ and scale $N_\\omega$ parametric}\n\t\t\t\t\\underline{array.}\n\t\t\t\t\\ENDFOR\n\t\t\t\t\t\t\t\t\t\t\n\t\t\\algstore{mnf_alg}\n\t\\end{algorithmic}\n\\end{algorithm}\n\t\t\t\t\t\t\n\\begin{algorithm}\n\t\\ContinuedFloat\n\t\\caption{Multifractal Feature Descriptor Estimation (continued)}\n\t\t\\begin{algorithmic} [1]\n\t\t\t\\algrestore{mnf_alg}\n\t\t\t\t\t\n\t\t\t\\ENDFOR\n\t\t\t\t\\FORALL {voxels $v_{i}$ in $N_{\\mu}$ and $N_{\\omega}$}\n\t\t\t\t\\bigskip\n\t\t\t\t\\STATE \\COMMENT {\\textbf{Step 4}}//\\underline{Perform Daubechies wavelet packet transform}\n\t\t\t\t\\STATEx $W_\\varphi \\left(t_0, x, y, z\\right) = \\left({1}/{\\sqrt{mnj}}\\right) \\sum^{j-1}_{r=0} \\sum^{n-1}_{l=0} \\sum^{m-1}_{k=0} v_{klr}\\varphi_{klr}\\left(t_0, x, y, z\\right)$\n\t\t \\STATEx $W^i_\\psi \\left(t, x, y, z\\right) = \\left({1}/{\\sqrt{mnj}}\\right) \\sum^{j-1}_{r=0} \\sum^{n-1}_{l=0} \\sum^{m-1}_{k=0} v_{klr}\\psi^i_{klr}\\left(t, x, y, z\\right)$\n\t\t\t\t\\bigskip\n\n\t\t\t\t\\STATE \\COMMENT {\\textbf{Step 5}}//\\underline{multifractal estimation and optimization phase}\n\t\t\n\t\t\\FORALL {decomposition levels $i$}\n\t\t\t\t\\FORALL {voxels $v_{mnr}^{i}$ in $W_{\\varphi}$ and $W_{\\psi}^{i}$}\n\t\t\t\t\t\t\\FORALL {voxel pair distances $\\Delta r$ in $W_{\\varphi}$ and $W_{\\psi}^{i}$}\n\t\t\t\t\t\t\\STATE compute mean absolute difference $\\Delta v$ of each voxel pair $q_i$, $p_i$\n\t\t\t\t\t\t\\bigskip\n\t\t\t\t\t\t\\STATE \\COMMENT {\\textbf{Step 6}}//\\underline{construct a multidimensional volume of interest ma-} \n\t\t\t\t\t\t\\underline{-trix $N_{d}\\left(x, y, d\\right)$}\n\t\t\t\t\t\t\\STATE normalize and take the logarithm $\\Delta\\hat{v} = log\\left({\\Delta v_{mnr}^{i}}/{\\left\\|\\Delta v_{mnr}^{i}\\right\\|}\\right)$, \n\t\t\t\t\t\t\\STATEx where $m$, $n$ and $r$ are the size of a voxel $i$ at a certain scale\n\t\t\t\t\t\t\\STATE normalize voxel pairs distances $\\Delta\\hat{r}$ where $\\Delta r = \\sqrt{\\sum^{n}_{i=1}\\left(q_i - p_i\\right)^2}$\n\t\t\t\t\t\t\\STATE perform least square linear regression as \n\t\t\t\t\t\t\\STATEx $S_{rr} = \\sum^{j-1}_{i=1} \\Delta \\hat{r}^2_i - {\\left(\\sum^{j-1}_{i=1}\\Delta\\hat{r}_i\\right)^2}/{(j-1)}$ ,\n\t\t\t\t\t\t\\STATEx $S_{rv} = \\sum^{j-1}_{i=1}\\sum^{j-1}_{k=1}\\Delta \\hat{r}_i \\hat{v}_k - {\\left(\\sum^{j-1}_{i=1} \\Delta\\hat{r}_i\\right)\\left(\\sum^{j-1}_{k=1}\\Delta\\hat{\t\t\t\t\t\t\tv}_k\\right)}/{(j-1)}$\n\t\t\t\t\t\t\\STATE estimate the Hurst coefficient \\textit{\\textbf{H}} matrix which represents the slope $ H = \\left(S_{rv}/S_{rr}\\right)$\n\t\t\t\t\t\t\\STATE estimate the fractal map  $\\Im = 3 - H$\n\t\t\t\t\t\t\\ENDFOR\n\t\t\t\t\\ENDFOR\n\t\t\t\t\\STATE extract mean fractal dimension $f_{i,j}^{k} \\leftarrow \\left(1/MN\\right)\\sum_{r=1}^{MN}\\Im_r$\n\t\t\t\t\\STATEx where $\\lambda_k = \\left\\{f^{1}_{1,1}, \\ldots , f^{k}_{i,j}, \\ldots , f^{z}_{m,n}\\right\\}$\n\t\t\t\t\\STATE construct feature descriptor from all wavelet sub-bands $\\Lambda = \\bigcup_k \\lambda_k$\n\t\t\t\t\\STATE $\\left|f^{k}_{i+1,j} - f^{k}_{i+1,j+1} \\right|$\n\t\t\t\t\\bigskip\n\t\t\t\t\t\t\\REPEAT\n\t\t\t\t\t\t\t\t\t\t\t\t\n    \t\\algstore{mnf_alg2}\n\t\\end{algorithmic}\n\\end{algorithm}\n\t\t\t\t\t\t\n\\begin{algorithm}\n\t\\ContinuedFloat\n\t\\caption{Multifractal Feature Descriptor Estimation (continued)}\n\t\t\\begin{algorithmic} [1]\n\t    \t\\algrestore{mnf_alg2}\n\t\t\t\t\t\t\n\t\t\t\\STATE \\COMMENT {\\textbf{Step 7}}//\\underline{determine fractal absolute difference between decom-} \n\t\t\t\t\t\t\\underline{position level $i$ and subsequent level as:}\n\t\t\t\t\t\t\\STATEx $D_{i}^{k} = \\left|f^{k}_{i,j} - f^{k}_{i,j+1}\\right|$,\n\t\t\t\t\t\t\\STATEx $D_{i+1}^{k} = \\left|f^{k}_{i+1,j} - f^{k}_{i+1,j+1}\\right|$\n\t\t\t\t\t\t\\UNTIL  $D_{i+1}^{k} \\leq D_{i}^{k}$\t\t\t\n\t\t\\ENDFOR\n\t\t\\ENDFOR\n\t\t\\RETURN{} optimized multifractal feature vector: $\\Lambda_{f}^{(k)} \\leftarrow arg max\\left(\\lambda_{k}\\right)$\n  \\end{algorithmic}\n\\end{algorithm}\n\n\\section{Experiments}\n\nThis section describes experiments on pre-clinical and clinical images to illustrate the new MNF algorithm and to compare its characterization performance with previous single scale methods. A tumor was classified as \\textit{non-progressive} if categorized as partial response and \\textit{progressive} if no change or disease demonstrated non-responsiveness. The response evaluation criteria in solid tumors (RECIST) was adopted to categorize the cases into progressive versus non-progressive \\cite{eis09}. The baseline cross-sectional imaging was compared against those performed at the end of treatment according to the RECIST criteria to determine response to treatment for each target tumor.\n\n\\subsection{Data}\n\n\\subsubsection{Pre-clinical Data: Xenograft tumor imaging protocol}\n\nRF ultrasound data was acquired using a diagnostic ultrasound system (z.one, Zonare Medical Systems, Mountain View, CA, USA) with a 10 MHz linear transducer and 50 MHz sampling. The output 2D image size was $20 \\times 54$ mm with a resolution of $289 \\times 648$ pixels. A total of 227 cross-sectional images of hind-leg xenograft tumors from 29 mice (20 progressive or stable disease and 9 non-progressive disease) were obtained with 1mm step-wise movement of the array mounted on a manual positioning device until the whole tumor volume was imaged (Fig.~\\ref{fig:voxel-decomposition}). All studies were ethically approved and performed in line with UK Home Office regulations, and in accordance with personal and project licenses.\n\nThe 2D images were composed together to create a 3D ultrasound volume. In order to ensure that nearby healthy tissue is not included in tumor tissue characterization, two expert radiologists manually segmented each image prior to applying tissue characterization. The Nakagami distribution was fitted to the distributions in each voxel lattice and parametric volumes were generated for each tumor. \n\nThe complete 3D RF ultrasound dataset along with a description of case categorization can be downloaded from the following weblink url: \\url{https://ibme-web.eng.ox.ac.uk/livertumour}. An example of one of the cases presented as an animated GIF for the fractal slice maps and a video of the corresponding fractal volume map can be found with the dataset. \n\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\n\\subsubsection{Clinical Data: Clinical study imaging protocol}\n\nCross-sectional images of liver tumors undergoing chemotherapy treatment obtained as part of an ethically approved prospective study was used to validate our proposed technique.  A total of 394 cross-sectional images (186 from tumors demonstrating partial response categorized as non-progressive, and 208 from tumors demonstrating progressive disease categorized as progressive) were obtained using a diagnostic ultrasound system (z.one, Zonare Medical Systems, Mountain View, CA, USA) with a 4 MHz curvilinear transducer and 11 MHz sampling. Each dataset was acquired prior to commencement of chemotherapy. Response to treatment was determined based on conventional Computed Tomography follow up imaging as part of the patient standard clinical care according to the RECIST criteria \\cite{eis09}. \\\\\n\\indent The transducer beam was initially directed through the target liver tumor in the intercostal imaging plane. Patients were asked to maintain breath hold inspiration, in order to stabilize the tumor target during image acquisition. Using a smooth movement of approximately constant speed, the ultrasound probe was angled whilst maintaining a skin contact position in a cranial to caudal direction to capture sequential 2D cross-sectional images of the target liver tumor. Each output 2D image size was $65 \\times 160$ mm with a resolution of $225 \\times 968$ pixels. Similar to the xenograft tumor dataset, the 2D images were composed together to create a 3D ultrasound volume for each target tumor. The acquisition was repeated in a similar fashion three times at each time point. Manual segmentation of the liver tumor was also performed in a similar fashion prior to image texture analysis.\n\n\\begin{figure} [ht]\n\\includegraphics[width=\\columnwidth]{fig12}\n\\caption{Example of a voxel-based tissue characterization for a non-progressive liver tumor case. The tumor 3D volume is reconstructed in (a), and the B-mode middle slice (b) after transforming using the MNF algorithm is shown in (c-f). The Nakagami shape and scale parametric voxels (c) and (d) and the corresponding multi-resolution fractal slice maps (e) and (f) illustrates how the case responds to chemotherapy treatment -- the blue color regions in (e) and (f) which correspond with the RECIST criteria.}\n\\label{fig:voxel-characterization}\n\\end{figure}\n\n\\begin{figure} [ht]\n\\begin{center}\n\\includegraphics[scale = 1]{fig13}\n\\end{center}\n\\caption{Fractal volume maps: Volumetric rendering of Nakagami parametric scale (first row) and shape (second row) for a progressive and non-progressive liver tumor volume, respectively.}\n\\label{fig:volume-maps}\n\\end{figure}\n\n\t\t\\begin{figure} [ht]\n\\includegraphics[width=\\columnwidth]{fig14}\n\\caption{Pairwise horizontal comparison of texture-based volume rendering of Nakagami scale (a-d) and shape (e-h) multi-fractal volume maps. (a) \\& (b) are an example of a non-progressive case in pre and post-chemotherapy treatment, and the (c) and (d) are for a progressive case in pre and post-chemotherapy treatment, respectively; (e) and (f), and (g) and (h) are the corresponding volumetric Nakagami shape cases. Red color labels indicate low local fractal dimension or low-activity regions which correspond to necrotic regions according to RECIST criteria. In first row, it is noticed that the spread of the red voxels has increased in post-treatment as compared to pre-treatment, and vice versa in the second row.}\n\\label{fig:therapeutic-comparison}\n\\end{figure}\n\n\\begin{figure} [ht]\n\\includegraphics[scale = 0.85]{fig15}\n\\caption{Performance comparison for the MNF method against the filter-based Gabor filter (GF), model-based fractional Brownian motion (fBm) and Gaussian Markov random field (GMRF), and statistical-based gray-level co-occurrence matrix (GLCM), run-length matrix (RLM), and autocovariance function (ACF) texture analysis methods. The blue columns represent the operation of the texture descriptors on volumetric Nakagami parametric volume of interests, while the red columns are results from conventional ultrasonic intensity B-mode volume of interests.}\n\\label{fig:performance-comparison}\n\\end{figure}\n\n\\subsection{Fractal maps}\n\nFig.~\\ref{fig:voxel-characterization} shows the new parametric mapping on an example case. The various scattering conditions related to tissue characteristics within the tumor texture are shown using color mapping, where the various intensity distributions corresponding to the local concentration of scatterers vary from pre-Rician (0 $<$ $\\mu$ $<$ 0.5), generalized Rician ($\\mu$ = 0.5), pre-Rayleigh (0.5 $<$ $\\mu$ $<$ 1), Rayleigh ($\\mu$ = 1), post-Rayleigh ($\\mu$ $>$ 1) as illustrated in Fig.~\\ref{fig:voxel-characterization} (c), and from low (0 $<$ $\\omega$ $<$ 3), mid (3 $\\leq$ $\\omega$ $<$ 7), and high ($\\omega$ $>$ 7) for local backscattered energy as in Fig.~\\ref{fig:voxel-characterization} (d). The MNF \\textit{fractal slice maps} -- which correspond to each slice in the reconstructed volume -- shown in Fig.~\\ref{fig:voxel-characterization} (e) and (f) correspond to the Nakagami shape and scale voxels of the mid-slice, respectively. Regions with different texture properties (smoother or with lower local fractal dimension values) become more apparent compared to the Nakagami parametric voxels. Another interesting point is that the scale fractal map highlights the low activity regions near to the edge of the tumor, while the shape fractal map complements the characterization by highlighting low activity regions belonging to the inner part of the tumor tissue texture. A holistic view of the overall progression or regression of tumor spread can be effectively revealed via the \\textit{fractal volume maps} where low activity regions which correspond to necrotic tissue are labeled by a dark red color as illustrated in Fig.~\\ref{fig:volume-maps}. Also a comparison between a non-progressive and progressive case and for pre and post-chemotherapy treatment is shown in Fig.~\\ref{fig:therapeutic-comparison}.\n\n\\subsection{Statistical analysis}\n\nSince our primary concern is to  demonstrate the texture expressiveness of the new multi-fractal feature descriptor in this subsection we describe experiments conducted to compare the discriminative power of the MNF descriptor with established features for mass classification. To do this we have chosen to use a na\\\"{\\i}ve\u00e2\u0080\u009d Bayesian classifier,  although SVM or random forests might also have been used. \n\nSpecifically, we consider the MNF  $\\Lambda^{(k)}$ estimated over multiple scales in each case $k$ in which there are $\\left\\vert{\\Lambda^{(k)}}\\right\\vert = 8 \\times i$ features per voxel, where $i$ is the number of decomposition levels estimated adaptively (see step 7 in Algorithm 1). This feature vector was fed into a simple na\\\"{\\i}ve\u00e2\u0080\u009d Bayesian classifier (nBC) determine performance of classifying progressive versus non-progressive cases. \n\nFig.~\\ref{fig:performance-comparison} summarizes classification results for the pre-clinical dataset using the proposed MNF features with results from six other classic filter, model and statistical-based texture analysis methods and for B-mode intensity and Nakagami-based volumes of interest. The compared texture analysis methods are: Gabor filter (GF), fractional Brownian motion (fBm), Gaussian Markov random field (GMRF), gray-level co-occurrence matrix (GLCM), run-length matrix (RLM), and autocovariance function (ACF). Details of the extracted features can be found in Table~\\ref{table:Extracted_features}, and a leave-one-out validation approach was employed. MNF-based performance gave the best overall cross-validation accuracy of 98.95\\%. Also the Wilcoxon Signed-Rank test on paired accuracy in Nakagami and intensity-based of each subject for both two-class classification shows that there is a significant difference ($p < 0.05$).\n\n\\begin{table} [!ht]\n\\centering\n\\captionsetup{justification=centering}\n\\caption{Features extracted from the comparative texture analysis methods in Fig.~\\ref{fig:performance-comparison}}\n\\label{table:Extracted_features}\n\\begin{tabular}{p{2cm}p{9cm}}\n\\hline \\hline\nMethod & \\multicolumn{1}{c}{Texture features}  \\\\ \\hline\nGF & Energy of each magnitude response for five radial frequencies $\\left(\\sqrt{2}/2^{6}, \\sqrt{2}/2^{5}, \\sqrt{2}/2^{4}, \\sqrt{2}/2^{3}, \\sqrt{2}/2^{2}\\right)$ with 4 orientations 0$^{\\circ}$,45$^{\\circ}$,90$^{\\circ}$ \\& 135$^{\\circ}$  \\\\\nGMRF & Seven features estimated from a third order Markov neighborhood model  \\\\\nfBm & Mean, variance, lacunarity, skewness and kurtosis derived from the generated FD image \\\\\nGLCM & Contrast, correlation, energy, entropy, homogeneity, dissimilarity, inverse difference momentum, maximum probability statistical features derived in the 0$^{\\circ}$,45$^{\\circ}$,90$^{\\circ}$ \\& 135$^{\\circ}$ directions \\\\\nRLM & Short run emphasis, long run emphasis, gray level non-uniformity, run length non-uniformity and run percentage statistical features derived in the 0$^{\\circ}$,45$^{\\circ}$,90$^{\\circ}$ \\& 135$^{\\circ}$ directions \\\\\nACF & Peaks of the horizontal and vertical margins values and associated exponential fittings of the ACF  \\\\ \\hline \\hline\n\\end{tabular}\n\\end{table}\n\n\\subsection{Clinical application}\n\nIn order to demonstrate the applicability of the MNF algorithm for analysis of data acquired to clinical protocol the new method was applied to a clinical liver tumor dataset. In this case, RF ultrasound data is acquired in a fan-like scanning protocol (cf. the pre-clinical dataset was acquired using a linear transducer) in which a series of 2D images are collected as the transducer is tilted and then reconstructed into a 3D image. \\\\\n\\indent Table~\\ref{table:MNF_classification} summarizes the classification performance for the clinical dataset following the same classifier design as in section 4.3. The results show a good classification accuracy of 92.90\\% using a leave-one-out  cross-validation approach, and a 92.01\\% $\\pm$ 0.50 and 92.60 $\\pm$ 0.30 for 5-fold and 10-fold cross-validation (results are the mean $\\pm$ standard deviation of the performance over 60 runs). The texture descriptor was also compared against the RF backscatter signal using the localized voxel-based Nakagami parameters without generating the fractal volume maps (see Table~\\ref{table:Nakagami_classification}), and by only deriving the fractal maps directly from the intensity (B-mode) images as well (see Table~\\ref{table:B-mode_classification}).\n\t\n\\begin{table} [!ht]\n\\centering\n\\captionsetup{justification=centering}\n\\caption{Detailed Classification Performance for the 3D Clinical RF Ultrasound Liver Tumor Test Set Using the MNF Algorithm}\n\\label{table:MNF_classification}\n\\begin{tabular}{lccc}\n\\hline \\hline\n\\multirow{2}{*}{\\begin{tabular}[c]{@{}l@{}}Classification \\\\ Performance\\end{tabular}} & \\multicolumn{3}{c}{Cross-validation}   \\\\ \\cline{2-4}\n & loo & 5-fold & 10-fold   \\\\ \\hline\nRecall & 0.935 & $0.92 \\pm 0.919$ & $0.921 \\pm 0.931$   \\\\\nFP rate & 0.065 & $0.08 \\pm 0.080$ & $0.069 \\pm 0.079$  \\\\\nAccuracy & 0.929 & $0.92 \\pm 0.005$ & $0.926 \\pm 0.003$  \\\\\nPrecision & 0.941 & $0.93 \\pm 0.911$ & $0.937 \\pm 0.914$  \\\\\nF-measure & 0.928 & $0.92 \\pm 0.005$ & $0.925 \\pm 0.003$  \\\\\nJ-Index & 0.929 & $0.92 \\pm 0.005$ & $0.926 \\pm 0.003$  \\\\\nDice SC & 0.963 & $0.96 \\pm 0.003$ & $0.961 \\pm 0.002$  \\\\\nROC Area & 0.929 & $0.92 \\pm 0.006$ & $0.926 \\pm 0.003$ \\\\ \\hline \\hline\n\\end{tabular}\n\\end{table}\n\n\\begin{table} [!ht]\n\\centering\n\\captionsetup{justification=centering}\n\\caption{Detailed Classification Performance for the 3D Clinical RF Ultrasound Liver Tumor Test Set using only the Nakagami Parameters}\n\\label{table:Nakagami_classification}\n\\begin{tabular}{lccc}\n\\hline \\hline\n\\multirow{2}{*}{\\begin{tabular}[c]{@{}l@{}}Classification \\\\ Performance\\end{tabular}} & \\multicolumn{3}{c}{Cross-validation}   \\\\ \\cline{2-4}\n & loo & 5-fold & 10-fold   \\\\ \\hline\nRecall & 0.715 & $0.73 \\pm 0.492$ & $0.72 \\pm 0.491$   \\\\\nFP rate & 0.514 & $0.51 \\pm 0.272$ & $0.51 \\pm 0.276$  \\\\\nAccuracy & 0.594 & $0.60 \\pm 0.007$ & $0.60 \\pm 0.006$  \\\\\nPrecision & 0.656 & $0.56 \\pm 0.670$ & $0.56 \\pm 0.666$  \\\\\nF-measure & 0.595 & $0.60 \\pm 0.007$ & $0.60 \\pm 0.006$  \\\\\nJ-Index & 0.594 & $0.60 \\pm 0.007$ & $0.60 \\pm 0.006$  \\\\\nDice SC & 0.745 & $0.75 \\pm 0.005$ & $0.75 \\pm 0.005$  \\\\\nROC Area & 0.600 & $0.61 \\pm 0.007$ & $0.61 \\pm 0.006$ \\\\ \\hline \\hline\n\\end{tabular}\n\\end{table}\n\n\\begin{table} [!ht]\n\\centering\n\\captionsetup{justification=centering}\n\\caption{Detailed Classification Performance Using B-Mode Images of the 3D Clinical Ultrasound Liver Tumor Test Set}\n\\label{table:B-mode_classification}\n\\begin{tabular}{lccc}\n\\hline \\hline\n\\multirow{2}{*}{\\begin{tabular}[c]{@{}l@{}}Classification \\\\ Performance\\end{tabular}} & \\multicolumn{3}{c}{Cross-validation}   \\\\ \\cline{2-4}\n & loo & 5-fold & 10-fold   \\\\ \\hline\nRecall & 0.823 & $0.82 \\pm 0.870$ & $0.82 \\pm 0.868$   \\\\\nFP rate & 0.135 & $0.13 \\pm 0.182$ & $0.13 \\pm 0.180$  \\\\\nAccuracy & 0.845 & $0.85 \\pm 0.005$ & $0.85 \\pm 0.004$  \\\\\nPrecision & 0.845 & $0.85 \\pm 0.842$ & $0.85 \\pm 0.844$  \\\\\nF-measure & 0.845 & $0.85 \\pm 0.005$ & $0.85 \\pm 0.004$  \\\\\nJ-Index & 0.845 & $0.85 \\pm 0.005$ & $0.85 \\pm 0.004$  \\\\\nDice SC & 0.916 & $0.92 \\pm 0.003$ & $0.92 \\pm 0.002$  \\\\\nROC Area & 0.844 & $0.84 \\pm 0.005$ & $0.84 \\pm 0.004$ \\\\ \\hline \\hline\n\\end{tabular}\n\\end{table}\n\t\t\n\n\\section{Discussion}\n\nAn outstanding challenge in medical ultrasound image analysis addressed in the paper is to provide an efficient characterization of subtle speckle textural changes or intra-heterogeneity within tumor tissue. The low signal to noise ratio and imaging artifacts frequently present in clinical ultrasound images make extracting such diagnostically useful information hard. In this section we focus on discussing three main contributions of our work and their importance.\n\n{\\em 1) Features of the method which make it novel and how this makes a difference:}  We have proposed a novel and meaningful fractal feature vector representation of ultrasonic signal characterization across spatial scales. This uses a multi-scale analysis where the voxel lattice is optimized to tumor size.  We have also shown that performing the estimation in a volumetric fashion improves classification accuracy.\n\n\\indent The proposed MNF approach  simplifies analysis of the higher order statistics of the speckle texture via investigating different sub-bands at various decomposition levels using wavelets that tend to exhibit fractal characteristics. The tailored spatial-frequency localization provided via the Daubechies wavelet can facilitate the subsequent measurement of (signal) surface roughness while simultaneously filtering out irrelevant speckle features. The resulting fractal features quantify the speckle texture. Unlike conventional sub-band energy decomposition, sub-resolution level probing via the fBm (which satisfies an affine intensity invariance property) is not susceptible to sudden changes in the speckle intensity spatial frequency distribution.\n\n\n{\\em 2) Significance of the MNF descriptor to describe cancer morphology at the image level:} The results in section 4 are very interesting as they suggest that the MNF representation provides a new way to visualise cancer morphology using an ultrasound-based descriptor, and specifically to partition cancerous masses into necrotic and non-necrotic areas which has potential clinical utility. \n\nIn particular, the sparse blue colored clusters -- which correspond to the low fractal dimension values shown in Fig.~\\ref{fig:voxel-characterization} (e) and (f) -- appear to correspond to necrotic regions in the tumor that are beginning to respond to chemotherapy treatment as defined by the RECIST criteria. This can be explained by first noting that tumorous tissue tends to have a \"rougher\" appearance than non-tumorous tissue due to the chaotic way that tumors  build their network of new blood vessels. These angiogenesis networks tend to be leaky and disorganized, unlike blood vessel vasculature in normal tissue. This heterogeneity introduces a degree of randomness in appearance \u00e2\u0080\u0093 or ``roughness''- and gives a higher fractal dimension value compared to necrotic tissue. \n\n    Necrotic regions have different echogenicity characteristics \\cite{sdg13}. In a necrotic region there is no cell growth and hence could be quantified if investigated at the appropriate analysis scale. The fractal volume maps reveal some of the intra-heterogeneity regions that tend to have a different textural characteristics to that of tumor tissue. These observations correspond to the dark red voxels in Fig.~\\ref{fig:volume-maps} and in Fig.~\\ref{fig:therapeutic-comparison} in the post-chemotherapy case. The red voxels in the pre-treated tumors in Fig.~\\ref{fig:therapeutic-comparison} (a) and (c) represent regions with low activity, i.e. non-aggressive, with potential to become aggressive after treatment. We consider these red voxels as suspicious regions within the tumour and not as active as the rest of the malignant tumour tissue. From a pattern recognition perspective, the red voxels are closer in terms of their surface roughness characteristics to necrotic (i.e. low fractal dimension values) rather than aggressive regions (i.e. high fractal dimension values). However, at the pre-treatment stage, the nature of these regions is not yet confirmed since the tumor has not been subjected to chemotherapy treatment. The different shades of red in the pre-treatment figures reflect the varying degree of low activity that exists in the tumor. Subsequently, and after the first session of chemotherapy treatment, we notice that increase in these low activity regions in the non-progressive tumor of Fig.~\\ref{fig:therapeutic-comparison} (b). Since the tumor has responded to treatment, we can now be confident that the aforementioned low activity regions in fact refers to necrotic regions. Conversely, the red voxels seen on the pre-treatment images for the tumor that progressed post chemotherapy nearly disappears on the post-treatment images of Fig.~\\ref{fig:therapeutic-comparison}, thus suggesting that they have now become aggressive resulting in progression of the tumor. \n\n\\indent We also observe that the scale and shape fractal maps tend to complement each other, in the sense of highlighting different aspects of the analyzed speckle texture pattern. This is evident when examining the Nakagami shape and scale parametric voxels of the non-progressive case shown in Fig.~\\ref{fig:voxel-characterization}. Here we observe that a number of necrotic regions -- highlighted in red in Fig.~\\ref{fig:voxel-characterization} (c) and (d) - become more apparent in the corresponding fractal maps of Fig.~\\ref{fig:voxel-characterization} (e) and (f). The scale fractal map highlights low intra-heterogeneity regions on the outer surface and near to the edge of the tumor. The shape fractal map complements this by revealing most of these low intra-heterogeneity regions belonging to the inner part of the tumor.\n\n\n{\\em 3) Expressiveness of MNF as a mass characterization feature:} Results in Fig.~\\ref{fig:performance-comparison} for the pre-clinical cases show that the MNF performed best based on Nakagami-based parametric images reporting an accuracy of 98.95\\%, while the fBm worked well on traditional B-mode intensity images with an accuracy of 83.16\\%. Similarly for the clinical cases, where under all classification performance metrics by comparing Table~\\ref{table:MNF_classification}, ~\\ref{table:Nakagami_classification}, and ~\\ref{table:B-mode_classification}, we can see that the MNF algorithm outperformed both using the Nakagami parameters alone and when texture analysis was applied to the B-mode images as well.\n\nMoreover, we found that using a 2D single slice gave a lower accuracy of 74.74\\%  compared to a volumetric analysis (98.95\\%). Furthermore, combining the texture-based multiresolution fractal features extracted from the Nakagami maps via the MNF algorithm with the features extracted from the conventional B-mode intensity images resulted in 4.1\\% degradation in the overall accuracy, as compared if the MNF method was employed alone. Note that in part due the limited data available in the pilot work, we have not looked at the benefits from a mass classification perspective of combining the MNF descriptor with other ultrasound tissue characterization parameters or image texture features which would be a natural topic to explore in the future. \n\n\\indent Finally, we comment on three limitations of the current research which can be translated into opportunities for future investigation. \nFirstly, we are currently relying on the consensus of two radiologists to provide the gold standard and training data. Although we have shown good results with our current strategy, of possible concern is that the training samples may be mislabelled. This would reduce the accuracy of the results. Future work might look at the significance of this and strategies for mitigation.  \nSecondly, fatty livers may result in attenuation of tissue properties and it would be interesting to investigate how this affects MNF classification accuracy. \nThirdly,  RF characteristics (and hence speckle appearance) tends to differ between ultrasound devices. It would be interesting to investigate whether a training set from one ultrasound scanner can be used for classification of images from a different scanner or results are scanner specific. \n\n\n\\section{Conclusion}\n\nA new approach for assessing tumor heterogeneity via 3D multi-fractal multi-scale Nakagami-based feature modeling has been presented which we believe is the first work to consider intra-heterogeneity quantification of a cancerous mass. We estimated volumetric Nakagami shape and scale parameters from which the novel fractal descriptor is estimated. Future work will investigate the use of the method for both staging liver tumors and in longitudinal analysis as an image-based biomarker of tumor growth and therapeutic response.\n\n\\section*{Acknowledgment}\n\nThis work was support by the Engineering and Physical Sciences Research Council and Wellcome Trust Grant WT 088877/Z/09/Z. The authors would like to thank the anonymous reviewers for their constructive comments and suggestions to improve the quality of the paper.\n\n\\section*{References}\n\n  \n\t\\bibliographystyle{elsarticle-num}\n  \\bibliography{MIA}\n\n\n", "itemtype": "equation", "pos": 39177, "prevtext": "\n\\\\\n\\begin{figure}\n\\begin{center}\n\\includegraphics[scale = 1]{fig9}\n\\end{center}\n\\caption{Segmented liver tumor volume of interest; and the annotation squares in the enlarged image show the variation of voxel lattice size used in the experiments.}\n\\label{fig:voxel-lattice}\n\\end{figure}\n\n\\indent Fig.~\\ref{fig:lattice-optimization} is an empirical plot of the goodness of fit of the estimated Nakagami parameters versus voxel lattice size for a typical dataset. Sizes varying from 0.03 mm$^3$ to 6.60 mm$^3$ where used in the experiments. The RMSE oscillates as it reaches its minimum, recording a residual error of 0.68 at a lattice size of 7 voxels before the accuracy starts to decrease for larger sizes. Also in the process of generating the Nakagami parametric images and when the voxel lattice happen to be on the border, all voxels laying outside the volume of interest are eliminated from the calculations in order to discard any bias and to maintain a more credible estimation of the parameters. \n\t\t\n\\begin{figure}\n\\begin{center}\n\\includegraphics[scale = 0.85]{fig10}\n\\end{center}\n\\caption{Goodness of fit for optimizing the voxel lattice size utilized in the Nakagami distribution fitting.}\n\\label{fig:lattice-optimization}\n\\end{figure}\n\n\\subsubsection{Feature selection optimization}\n\nThe ultrasound texture fractal maps representing the FD voxel-based signature for the estimated Nakagami shape and scale parametric images are shown in Fig.~\\ref{fig:voxel-characterization} (e) and (f), respectively. Various wavelet decomposition techniques apply the sub-bands' energy for decomposition which is susceptible to intensity variations in ultrasound images due to speckle; however, the local density function known as the FD, can instead overcome these local variations in voxel intensities as it gives a representation of texture surface roughness, and hence is employed for the multiresolution analysis. The fractal characteristics are estimated for all sub-bands at each level of the wavelet packet decomposition, where the FD is computed on a voxel-by-voxel basis to produce a fractal map $\\Im$ for each sub-band i.e., each voxel in the fractal map has its own localized FD value estimated from its neighborhood as described in the previous section, where the rougher the surface the higher the FD values get, and vice versa. Features at boundaries are computed after assuming that each slice is mirror-like continually extended in both directions.  Specifically, the fractal features $f_{i,j}$ for a specific sub-band $j$ to a certain level of decomposition $i$ represent the average value of the generated $M \\times N$ fractal image map $\\Im$ of a volume of interest $k$ as defined in equation (12).\n\t\t\n\t\t\n", "index": 21, "text": "\\begin{equation}\n\t\tf_{i,j}^k\n = \\frac{1}{MN}\\sum_{r=1}^{MN}\\Im_r\t\t\n\t\t\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E11.m1\" class=\"ltx_Math\" alttext=\"f_{i,j}^{k}=\\frac{1}{MN}\\sum_{r=1}^{MN}\\Im_{r}\" display=\"block\"><mrow><msubsup><mi>f</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow><mi>k</mi></msubsup><mo>=</mo><mrow><mfrac><mn>1</mn><mrow><mi>M</mi><mo>\u2062</mo><mi>N</mi></mrow></mfrac><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>M</mi><mo>\u2062</mo><mi>N</mi></mrow></munderover><msub><mi mathvariant=\"normal\">\u2111</mi><mi>r</mi></msub></mrow></mrow></mrow></math>", "type": "latex"}]