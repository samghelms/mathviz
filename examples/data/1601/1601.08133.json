[{"file": "1601.08133.tex", "nexttext": "\nwhere $\\bm{Y}(t_j)$ is a sample in $p$ dimensions and\n$W(.)$ is a weight function for which \n$\\sum_{j=1}^{T}{W(t_j)}=1$. \nThis weight function allows to assign a different importance \nto the outlyingness of a curve at different time points. \nOne could for example downweight time points near the \nboundaries if measurements are recorded less precisely at \nthe beginning and the end of the process.   \n\nDefinition~\\eqref{eq:fao} for functional data with a univariate domain can easily be extended to functions with a bivariate domain such as surfaces and images. We then assume that the outcome of the experiment is recorded at a grid of discrete points, e.g.\\ discrete excitation and emission wavelengths. \nTherefore, it is convenient to use two indices $j=1,\\ldots,J$ and $k=1,\\ldots,K$, one for each dimension of the grid, to characterize these points. A surface or image can then be represented by a $J \\times K$ matrix where each cell $(j,k)$ contains the height of the surface or the color intensity at that grid point.\nWe then define the functional adjusted outlyingness of\na multivariate function $X$ with bivariate domain relative \nto a dataset $\\bm{Y}$ of functions recorded at grid points \n$\\{(j,k) ; j=1,\\ldots, J \\mbox { and } k=1,\\ldots, K\\}$ as\n\n", "itemtype": "equation", "pos": 5190, "prevtext": "\n\n\\title{Finding Outliers in Surface Data and Video}\n\n\\author{Mia Hubert, Jakob Raymaekers, Peter J. Rousseeuw,\\\\\n        Pieter Segaert\\footnote{\n        Department of Mathematics, KU Leuven,\n\t\t    Belgium}~\\footnote{\n        email: Mia.Hubert@wis.kuleuven.be}}\n\n\t\t\t\t\t\n\\date{January 29, 2016}\n\n\\maketitle\n\n\\begin{abstract}\nSurface, image and video data can be considered as functional data with a bivariate domain.\nTo detect outlying surfaces or images, a new method is proposed based on the mean and the variability of the degree of outlyingness at each grid point. A rule is constructed to flag the outliers in the resulting functional outlier map. Heatmaps of their outlyingness indicate the regions which are most deviating from the regular surfaces. The method is applied to fluorescence excitation-emission spectra after fitting a PARAFAC model, to MRI image data which are augmented with their gradients, and to video surveillance data. \n\\end{abstract}\n\n{\\bf Keywords:} Adjusted outlyingness, Functional data, \nImage data, Multiway, Robustness.\n\n\\section{Introduction}\n\\label{sec:introduction}\nThe most common type of functional data are curves, typically measured over time. Also spectral data, measured over a range of wavelengths, can be considered as functional data and can be analyzed as such~\\citep{Saeys:Functional}. When several measurements are taken at each time point, we obtain multivariate functional data. Bivariate examples are height and weight curves of children, temperature and dewpoint temperature at several weather stations during several days, or measurements of the\nhuman heart activity at two different places on the body \\citep{Claeskens:MFHD}. Whereas the domain of these data is always univariate, the response can thus be multivariate.\n\nSurface data are an increasingly common data type in several fields of research. In chemistry for example, fluorescence spectroscopy is a well known technique that yields surface data with an excitation and an emission dimension. In geography, surface data is obtained by measuring characteristics such as daily precipitation on a certain area of land. \nAlso digital image and video data are represented by a grid of pixels and typically contain grayscale values or three-dimensional RGB values that define the color intensities. \nAll these advanced data types can thus be seen as multivariate functional data with a bivariate domain. \n\nTo detect outlying surfaces or to flag outlying parts of a surface, it is well known that classical statistical techniques are not trustworthy as the analysis itself may be distorted by the outliers.\nOutlier detection for multivariate functional data with a univariate domain has been studied in depth in \\cite{Hubert:MFOD}. \nIn that paper a taxonomy of outlying curves was proposed, and distribution-free statistical methods were introduced to measure \ntheir degree of outlyingness.  \n\\cite{Hubert:MFOD_Rejoinder} illustrated this on a raw \nexcitation-emission fluorescence dataset, and proposed the \nfunctional outlier map (FOM) as a graphical display to visualize \nthe functions according to their degree and type of outlyingness.  \n\nIn this paper, we build on these methods with a threefold objective.\nFirst, we propose a cutoff to distinguish between the outlying and \nthe regular surfaces, which makes the FOM more informative. \nSecondly, we improve the outlier detection ability for surface data by first modeling the data according to a multiway model and applying the FOM to the residuals instead of the raw data.\nFinally, we illustrate the extension of these techniques \nto multivariate image and video data. \n\nThe next section introduces the methodology behind the FOM as well as our new outlier detection rule. \nIn Section \\ref{sec:surface} we apply the new rule to excitation-emission matrices before and after fitting a \nPARAFAC model to them.\nSection~\\ref{sec:image} demonstrates the performance of our method on MRI image data and introduces the idea of including\ngradients in the analysis.\nIn Section~\\ref{sec:video} we apply the methodology to a \nvideo consisting of 633 color images. \n\n\n\n\n\\section{Methodology}\n\\label{sec:Method}\n\n\\subsection{Functional Adjusted Outlyingness}\n\nThe main concept for measuring the degree of outlyingness \nis the \\textit{adjusted outlyingness} (AO) \nof~\\cite{Brys:RobICA}. \nIts construction is recalled in the Appendix.\nFor univariate data, the AO is a robust version of the \nabsolute $z$-score as it measures an observation's \ndeviation from the median. \nIt allows for skewness in the data by estimating scale\nseparately on either side of the median. \nFor multivariate data, the AO of a point is defined\nas its maximal univariate AO when projecting the data\non many directions.  \n\nTo extend the AO to multivariate functional data, \n\\cite{Hubert:MFOD} defined the \\textit{functional adjusted\noutlyingness} (fAO) of a $p$-dimensional curve $X$ as \nthe (weighted) average of its AO values over all points\nof its domain.\nMore precisely, let\\linebreak \n$\\bm{Y}=\\{Y_1,Y_2,\\ldots,Y_n\\}$ be a \nsample of $p$-dimensional curves, recorded at time \npoints $\\{t_1,\\ldots,t_T\\}$. \nThe fAO of $X$ with respect to $\\bm{Y}$ is then defined as\n\n", "index": 1, "text": "\\begin{equation} \\label{eq:fao}\n  \\text{fAO}(X; \\bm{Y}) = \\sum_{j=1}^{T}{{\\text{AO}}(X(t_j);\n\t\\bm{Y}(t_j)) \\; W(t_j) }\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"\\text{fAO}(X;\\bm{Y})=\\sum_{j=1}^{T}{{\\text{AO}}(X(t_{j});\\bm{Y}(t_{j}))\\;W(t_{%&#10;j})}\" display=\"block\"><mrow><mrow><mtext>fAO</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>X</mi><mo>;</mo><mi>\ud835\udc80</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><mrow><mtext>AO</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>X</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>;</mo><mrow><mi>\ud835\udc80</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo rspace=\"5.3pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>W</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.08133.tex", "nexttext": "\nwith $\\sum_{j=1}^J \\sum_{k=1}^K W_{jk} = 1$.\nFor illustrative purposes we will use a uniform weight\nfunction throughout this paper, i.e. $W_{jk}=1/(JK)$ for \nall $j=1,\\ldots,J$ and $k=1,\\ldots,K$. \nDefinition~\\eqref{eq:fao_surface} can trivially be extended\nto functions with a multivariate domain of dimension $d>2$,\nsuch as three-dimensional images consisting of voxels.\n\nThe fAO can be applied to raw data, but in other applications\nit might be interesting to first fit a parametric model to the data, after which the fAO can be computed on the residuals. \nFor multiway data, PARAFAC is a commonly used method to fit a trilinear model. The concept of applying fAO to the residuals of a PARAFAC model is illustrated on a real data example in Section~\\ref{sec:surface}.\n\nWhen analyzing curves, it is often informative to consider \nthe derivative of the curves as well. \nIn particular, this is helpful when the goal is to detect\ncurves with a deviating shape, see \\cite{Hubert:MFOD} for \nsome examples. \nFor surfaces or images, we can augment the available raw \ndata by including gradients instead.\nThis idea will be illustrated in Section~\\ref{sec:image}.\n\n\\subsection{Functional outlier map}\nThe functional outlier map (FOM) was introduced \nin~\\citep{Hubert:MFOD_Rejoinder} as a graphical tool to\nvisualize the degree of outlyingness of curves. A similar definition can be applied to surfaces or images. \nThe FOM is a scatter plot which displays each function's \nfAO on the horizontal axis and vAO, a measure of the \nvariability of its AO over all points of the domain, on \nthe vertical axis. \nMore precisely, for each $Y_i$ the vAO is defined as\n\n", "itemtype": "equation", "pos": 6583, "prevtext": "\nwhere $\\bm{Y}(t_j)$ is a sample in $p$ dimensions and\n$W(.)$ is a weight function for which \n$\\sum_{j=1}^{T}{W(t_j)}=1$. \nThis weight function allows to assign a different importance \nto the outlyingness of a curve at different time points. \nOne could for example downweight time points near the \nboundaries if measurements are recorded less precisely at \nthe beginning and the end of the process.   \n\nDefinition~\\eqref{eq:fao} for functional data with a univariate domain can easily be extended to functions with a bivariate domain such as surfaces and images. We then assume that the outcome of the experiment is recorded at a grid of discrete points, e.g.\\ discrete excitation and emission wavelengths. \nTherefore, it is convenient to use two indices $j=1,\\ldots,J$ and $k=1,\\ldots,K$, one for each dimension of the grid, to characterize these points. A surface or image can then be represented by a $J \\times K$ matrix where each cell $(j,k)$ contains the height of the surface or the color intensity at that grid point.\nWe then define the functional adjusted outlyingness of\na multivariate function $X$ with bivariate domain relative \nto a dataset $\\bm{Y}$ of functions recorded at grid points \n$\\{(j,k) ; j=1,\\ldots, J \\mbox { and } k=1,\\ldots, K\\}$ as\n\n", "index": 3, "text": "\\begin{equation}\\label{eq:fao_surface}\n\\text{fAO}(X; \\bm{Y}) = \\sum_{j=1}^{J}{\\sum_{k=1}^{K}{{\\text{AO}}(X(j,k);\\bm{Y}(j,k)) \\; W_{jk}}}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"\\text{fAO}(X;\\bm{Y})=\\sum_{j=1}^{J}{\\sum_{k=1}^{K}{{\\text{AO}}(X(j,k);\\bm{Y}(j%&#10;,k))\\;W_{jk}}}\" display=\"block\"><mrow><mrow><mtext>fAO</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>X</mi><mo>;</mo><mi>\ud835\udc80</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></munderover><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mrow><mtext>AO</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>X</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>j</mi><mo>,</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>;</mo><mrow><mi>\ud835\udc80</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>j</mi><mo>,</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo rspace=\"5.3pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>W</mi><mrow><mi>j</mi><mo>\u2062</mo><mi>k</mi></mrow></msub></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.08133.tex", "nexttext": "\nso the FOM is a scatter plot of the points\n\n", "itemtype": "equation", "pos": 8384, "prevtext": "\nwith $\\sum_{j=1}^J \\sum_{k=1}^K W_{jk} = 1$.\nFor illustrative purposes we will use a uniform weight\nfunction throughout this paper, i.e. $W_{jk}=1/(JK)$ for \nall $j=1,\\ldots,J$ and $k=1,\\ldots,K$. \nDefinition~\\eqref{eq:fao_surface} can trivially be extended\nto functions with a multivariate domain of dimension $d>2$,\nsuch as three-dimensional images consisting of voxels.\n\nThe fAO can be applied to raw data, but in other applications\nit might be interesting to first fit a parametric model to the data, after which the fAO can be computed on the residuals. \nFor multiway data, PARAFAC is a commonly used method to fit a trilinear model. The concept of applying fAO to the residuals of a PARAFAC model is illustrated on a real data example in Section~\\ref{sec:surface}.\n\nWhen analyzing curves, it is often informative to consider \nthe derivative of the curves as well. \nIn particular, this is helpful when the goal is to detect\ncurves with a deviating shape, see \\cite{Hubert:MFOD} for \nsome examples. \nFor surfaces or images, we can augment the available raw \ndata by including gradients instead.\nThis idea will be illustrated in Section~\\ref{sec:image}.\n\n\\subsection{Functional outlier map}\nThe functional outlier map (FOM) was introduced \nin~\\citep{Hubert:MFOD_Rejoinder} as a graphical tool to\nvisualize the degree of outlyingness of curves. A similar definition can be applied to surfaces or images. \nThe FOM is a scatter plot which displays each function's \nfAO on the horizontal axis and vAO, a measure of the \nvariability of its AO over all points of the domain, on \nthe vertical axis. \nMore precisely, for each $Y_i$ the vAO is defined as\n\n", "index": 5, "text": "\\begin{equation}\\label{eq:vAO}\n\\text{vAO}(Y_i;\\bm{Y})=\\text{stdev}_{j,k}(\\text{AO}(Y_i(j,k);\\bm{Y}(j,k)))/(1+\\text{fAO}(Y_i;\\bm{Y}))\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"\\text{vAO}(Y_{i};\\bm{Y})=\\text{stdev}_{j,k}(\\text{AO}(Y_{i}(j,k);\\bm{Y}(j,k)))%&#10;/(1+\\text{fAO}(Y_{i};\\bm{Y}))\" display=\"block\"><mrow><mrow><mtext>vAO</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>;</mo><mi>\ud835\udc80</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msub><mtext>stdev</mtext><mrow><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mtext>AO</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>Y</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>j</mi><mo>,</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>;</mo><mrow><mi>\ud835\udc80</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>j</mi><mo>,</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>/</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>+</mo><mrow><mtext>fAO</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>;</mo><mi>\ud835\udc80</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.08133.tex", "nexttext": "\nfor $i=1,\\ldots,n$.\nWe divide by fAO in Equation~\\eqref{eq:vAO} in order to \nmeasure relative instead of absolute variability. \nThis can be understood as follows. \nSuppose that the functions are centered around zero and \nthat $Y_l(j,k)=2 \\; Y_i(j,k)$ for all $j$ and $k$. \nThen $\\text{stdev}_{j,k}(\\text{AO}(Y_l(j,k);\\bm{Y}(j,k)))=2 \\; \\text{stdev}_{j,k}(\\text{AO}(Y_i(j,k);\\bm{Y}(j,k)))$ but their relative variability is the same. \nBecause $\\text{fAO}(Y_l;\\bm{Y})=2\\;\\text{fAO}(Y_i;\\bm{Y})$, dividing by fAO solves this problem.\n\nThe objective of the FOM is to reveal outliers in the data, \nand its interpretation is fairly straightforward. \nWe use the taxonomy of functional outliers presented \nby~\\cite{Hubert:MFOD} to distinguish between different types of \noutliers. \nPoints in the lower left part of the FOM represent regular \nsurfaces which hold a central position in the dataset. \nPoints in the lower right part are surfaces with a high fAO \nbut a low variability of their AO values. \nThis happens for shift outliers, i.e.\\ surfaces which have the \nsame shape as the majority but are shifted on the whole domain. \nPoints in the upper left part have a low fAO but a high vAO. \nTypical examples are isolated outliers, i.e.\\ surfaces which \nonly display outlyingness over a small part of their domain.\nThe points in the upper right part of the FOM have both a high \nfAO and a high vAO. These correspond to surfaces which are \nstrongly outlying on a substantial part of their domain.\n\nIn this paper we add an additional feature to the FOM, namely \na rule to flag the outliers. \nFor this purpose we define a summary measure, the \n\\textit{combined functional outlyingness} (CFO) of a \nsurface $Y_i$ as\n\n", "itemtype": "equation", "pos": 8575, "prevtext": "\nso the FOM is a scatter plot of the points\n\n", "index": 7, "text": "\\begin{equation}\\label{eq:fom}\n\\left(\\;\\text{fAO}(Y_i;\\bm{Y}),\\text{vAO}(Y_i;\\bm{Y})\\;\\right) \n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"\\left(\\;\\text{fAO}(Y_{i};\\bm{Y}),\\text{vAO}(Y_{i};\\bm{Y})\\;\\right)\" display=\"block\"><mrow><mo rspace=\"5.3pt\">(</mo><mrow><mtext>fAO</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>;</mo><mi>\ud835\udc80</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>,</mo><mrow><mtext>vAO</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>;</mo><mi>\ud835\udc80</mi><mo rspace=\"5.3pt\" stretchy=\"false\">)</mo></mrow></mrow><mo>)</mo></mrow></math>", "type": "latex"}, {"file": "1601.08133.tex", "nexttext": "\nwhere $\\text{fAO}_i = \\text{fAO}(Y_i;\\bm{Y})$,  \n${\\mathop{\\mbox{med}}}(\\text{fAO}) = \\text{median}(\\text{fAO}_1,\\ldots,\\text{fAO}_n)$ \nand similarly for\\linebreak vAO. \nNote that the CFO characterizes the points on the FOM through \ntheir Euclidean distance to the origin, after scaling. \nWe expect outliers to have a large CFO. \nIn general, the distribution of the CFO is unknown but \nskewed to the right. \nTo define a cutoff, we first symmetrize the CFO by the logarithmic \ntransformation. \nThen we center and scale the resulting values in a robust way and \ncompare them with a high quantile of the gaussian distribution. \nMore precisely,  let $\\text{LCFO}_i = \\log (0.1 + \\text{CFO}_i)$ \nfor all $i=1,\\ldots,n$. Then we flag function $Y_i$ as an outlier if\n\n", "itemtype": "equation", "pos": 10390, "prevtext": "\nfor $i=1,\\ldots,n$.\nWe divide by fAO in Equation~\\eqref{eq:vAO} in order to \nmeasure relative instead of absolute variability. \nThis can be understood as follows. \nSuppose that the functions are centered around zero and \nthat $Y_l(j,k)=2 \\; Y_i(j,k)$ for all $j$ and $k$. \nThen $\\text{stdev}_{j,k}(\\text{AO}(Y_l(j,k);\\bm{Y}(j,k)))=2 \\; \\text{stdev}_{j,k}(\\text{AO}(Y_i(j,k);\\bm{Y}(j,k)))$ but their relative variability is the same. \nBecause $\\text{fAO}(Y_l;\\bm{Y})=2\\;\\text{fAO}(Y_i;\\bm{Y})$, dividing by fAO solves this problem.\n\nThe objective of the FOM is to reveal outliers in the data, \nand its interpretation is fairly straightforward. \nWe use the taxonomy of functional outliers presented \nby~\\cite{Hubert:MFOD} to distinguish between different types of \noutliers. \nPoints in the lower left part of the FOM represent regular \nsurfaces which hold a central position in the dataset. \nPoints in the lower right part are surfaces with a high fAO \nbut a low variability of their AO values. \nThis happens for shift outliers, i.e.\\ surfaces which have the \nsame shape as the majority but are shifted on the whole domain. \nPoints in the upper left part have a low fAO but a high vAO. \nTypical examples are isolated outliers, i.e.\\ surfaces which \nonly display outlyingness over a small part of their domain.\nThe points in the upper right part of the FOM have both a high \nfAO and a high vAO. These correspond to surfaces which are \nstrongly outlying on a substantial part of their domain.\n\nIn this paper we add an additional feature to the FOM, namely \na rule to flag the outliers. \nFor this purpose we define a summary measure, the \n\\textit{combined functional outlyingness} (CFO) of a \nsurface $Y_i$ as\n\n", "index": 9, "text": "\\begin{equation} \\label{eq:cfo}\n  \\text{CFO}_i=\\text{CFO}(Y_i; \\bm{Y}) = \\sqrt{(\\text{fAO}_i\n\t/{\\mathop{\\mbox{med}}}(\\text{fAO}))^2+(\\text{vAO}_i/{\\mathop{\\mbox{med}}}(\\text{vAO}))^2}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"\\text{CFO}_{i}=\\text{CFO}(Y_{i};\\bm{Y})=\\sqrt{(\\text{fAO}_{i}/{\\mathop{\\mbox{%&#10;med}}}(\\text{fAO}))^{2}+(\\text{vAO}_{i}/{\\mathop{\\mbox{med}}}(\\text{vAO}))^{2}}\" display=\"block\"><mrow><msub><mtext>CFO</mtext><mi>i</mi></msub><mo>=</mo><mrow><mtext>CFO</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>;</mo><mi>\ud835\udc80</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><msqrt><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mtext>fAO</mtext><mi>i</mi></msub><mo>/</mo><mrow><mtext>med</mtext><mrow><mo stretchy=\"false\">(</mo><mtext>fAO</mtext><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mtext>vAO</mtext><mi>i</mi></msub><mo>/</mo><mrow><mtext>med</mtext><mrow><mo stretchy=\"false\">(</mo><mtext>vAO</mtext><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></mrow></msqrt></mrow></math>", "type": "latex"}, {"file": "1601.08133.tex", "nexttext": "\nIn the denominator, MAD denotes the median absolute \ndeviation defined as\\linebreak\n$\\text{MAD}(\\text{LCFO})=1.4826 \\; {\\mathop{\\mbox{med}}}(| \\; \\text{LCFO}-{\\mathop{\\mbox{med}}}(\\text{LCFO})|)$.\n\nIn addition to the FOM, it is often instructive to plot \nthe AO values themselves over their domain. \nFor a function with a bivariate domain, this yields a\ntwo-dimensional heatmap. \nThese plots can reveal particularly outlying regions and provide \nmore insight into why certain surfaces are flagged as outliers \nby the FOM. \nThis will be illustrated in the following sections.\n\n\\section{Surface data}\\label{sec:surface}\n\nThe Dorrit dataset contains excitation-emission landscapes of \n27 mixtures of 4 fluorophores in an aqueous solution and has been studied extensively by \\cite{Engelen:Scatter}, \\cite{Engelen:robParafac}  and \\cite{Hubert:RParafac-SI}. Such landscapes are typically stored in excitation-emission matrices (EEM). These matrices contain measurements of fluorescence intensity for 116 emission spectra ranging from 250 to 482 nm at 18 excitation wavelengths ranging from 230 to 315 nm. \nThis yields 27 samples $Y_i$, each containing measurements \n$Y_i(j,k)$ for $j=1,\\ldots,J=18$ and $k=1,\\ldots,K=116$.\nRaman and Rayleigh scattering, showing up in \nFigure~\\ref{fig:L8}(a) as two diagonal ridges in \nlandscape 8, are a common problem in this type of experiment\nand can severely distort the analysis.\nTo resolve this we used the method of \\cite{Engelen:Scatter} \nwhich automatically identifies the scattering. \nAfter setting the scattering to missing values, we imputed\nthem by interpolating each excitation profile.\nThe result of this process is illustrated in \nFigure~\\ref{fig:L8}(b).\n\n\\begin{figure}[!htb]\n\\centering\n\n\n\n\n\n\\includegraphics[width=1.0\\textwidth]{Fig1.pdf}\n\\caption{(a) Original landscape 8 with scatter and (b) with scatter removed.}\n\t\t\\label{fig:L8}\n\\end{figure}\n\nUsing Definition~\\eqref{eq:fao_surface} with a uniform \nweight function, we obtain the functional outlier map \ndepicted in Figure~\\ref{fig:dorritfom}. \nThe dashed black line is determined by the cutoff \nvalue~\\eqref{eq:cutoff} and shows the boundary between \nthe regular data and the outliers.\nThe outliers, plotted as red squares, are landscapes\n3 and 5.\n\n\\begin{figure}[!htb]\n\\centering\n \\centering\n    \\includegraphics[width=0.6\\textwidth]{Fig2.pdf} \n    \\caption{FOM of the raw Dorrit data.}\n    \\label{fig:dorritfom}\n\\end{figure}\n\nWe can improve our analysis by incorporating more \ninformation, for example by applying parallel factor \nanalysis (PARAFAC) to the data. PARAFAC is known to be a powerful tool for analyzing multiway data and can in particular be used to decompose three-way EEM data into a trilinear model. This trilinear model states that the value of a landscape $Y_i$ at EE-point $(j,k)$ can be written as the product of three corresponding values of the score matrix $A$ and the loading matrices $B$ and $C$, plus an error term:\n\n", "itemtype": "equation", "pos": 11349, "prevtext": "\nwhere $\\text{fAO}_i = \\text{fAO}(Y_i;\\bm{Y})$,  \n${\\mathop{\\mbox{med}}}(\\text{fAO}) = \\text{median}(\\text{fAO}_1,\\ldots,\\text{fAO}_n)$ \nand similarly for\\linebreak vAO. \nNote that the CFO characterizes the points on the FOM through \ntheir Euclidean distance to the origin, after scaling. \nWe expect outliers to have a large CFO. \nIn general, the distribution of the CFO is unknown but \nskewed to the right. \nTo define a cutoff, we first symmetrize the CFO by the logarithmic \ntransformation. \nThen we center and scale the resulting values in a robust way and \ncompare them with a high quantile of the gaussian distribution. \nMore precisely,  let $\\text{LCFO}_i = \\log (0.1 + \\text{CFO}_i)$ \nfor all $i=1,\\ldots,n$. Then we flag function $Y_i$ as an outlier if\n\n", "index": 11, "text": "\\begin{equation} \\label{eq:cutoff}\n  \\frac{\\text{LCFO}_i-{\\mathop{\\mbox{med}}}(\\text{LCFO})}\n\t{\\text{MAD}(\\text{LCFO})} > \\Phi^{-1}(0.995) \\, .\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"\\frac{\\text{LCFO}_{i}-{\\mathop{\\mbox{med}}}(\\text{LCFO})}{\\text{MAD}(\\text{%&#10;LCFO})}&gt;\\Phi^{-1}(0.995)\\,.\" display=\"block\"><mrow><mrow><mfrac><mrow><msub><mtext>LCFO</mtext><mi>i</mi></msub><mo>-</mo><mrow><mtext>med</mtext><mrow><mo stretchy=\"false\">(</mo><mtext>LCFO</mtext><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mrow><mtext>MAD</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mtext>LCFO</mtext><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac><mo>&gt;</mo><mrow><msup><mi mathvariant=\"normal\">\u03a6</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>0.995</mn><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.08133.tex", "nexttext": "\nHere $F$ denotes the number of components which we take as $F=4$, corresponding to the 4 known fluorophores present in the mixtures. \nApplying PARAFAC to the data results in 27 residual \nlandscapes $\\widetilde{Y}_i(j,k)=e_{ijk}$. \nWith the objective of outlier detection in mind, it is important to use a robust PARAFAC algorithm as it is well known that the presence of outliers can severely impact the PARAFAC decomposition. We have used the robust PARAFAC algorithm proposed by \\cite{Engelen:robParafac} in which we set the robustness parameter $h=0.75$. This  parameter indicates that the PARAFAC model is based on the $75\\%$ of surfaces which yield the smallest residuals. \n\nBy computing the fAO on the residuals instead of the original data, the trilinear structure of the dataset is taken into account. \nThe resulting functional outlier map is shown in \nFigure~\\ref{fig:dorritfom_parafac} and flags \nlandscapes 2, 3 and 5.\nThese outliers were also detected \nin~\\cite{Engelen:robParafac}.\nNote that points 3 and 5 lie much further from the boundary \n(the dashed black curve) than in the FOM of \nFigure~\\ref{fig:dorritfom}. \nThis indicates that surfaces 3 and 5 have outlying values but mostly expose an outlying structure. \nLandscape 2 barely contains abnormally low or high values but \nhas large residuals with respect to the PARAFAC model fitted\nto the majority of EEM landscapes. \n\n\\begin{figure}[!htb]\n\\centering\n\\includegraphics[width=0.6\\textwidth]{Fig3.pdf} \n\\caption{FOM of the residuals of the Dorrit data.}\n\\label{fig:dorritfom_parafac}\n\\end{figure}\n\nA heatmap of the AO values over the domain allows us to \ninspect surface 2 in more detail. \nFigure \\ref{fig:AOmap_dorrit}(a) plots the AOs of the \noriginal landscape 2, whereas \nFigure \\ref{fig:AOmap_dorrit}(b) shows the AOs of its \nPARAFAC residuals. \nTo improve visibility, all AO values of 15 or higher \nreceived the darkest color.\nThe left plot indicates that landscape 2 indeed does not \nhave large outlying regions, as the vast majority of its\ncells are light-colored. \nHowever, the right plot shows that its residuals are significantly outlying in the emission spectra between \n275 and 350 nm. \nThis indicates that the shape of landscape 2 differs \nstrongly from the shape predicted by the PARAFAC model. Therefore, this landscape can be classified as a shape \noutlier.\n\n\\begin{figure}[!htb]\n\\centering\n\n\n\n\n\n\\includegraphics[width=1.0\\textwidth]{Fig4.pdf}\n\\caption{Heatmap of the AO values of landscape 2 for \n         (a) the raw values, \n         (b) the residuals after a robust PARAFAC fit.}\n\t\t\\label{fig:AOmap_dorrit}\n\\end{figure}\n\n\n\n\\section{Image data}\\label{sec:image}\n\nThe MRI dataset contains brain imaging data of 416 persons, aged between \n18 and 96 years~\\citep{Marcus:OASIS} and can be freely accessed \nat {\\it www.oasis-brains.org}.\nFor each person, multiple MRI scans are available including 3 to 4 raw MRI \nimages and several processed scans such as an averaged image of the raw \nscans, the atlas-registered gain field-corrected image and a masked version\n of the latter scan resampled to 1mm isotropic pixels. \nMasking sets all non-brain pixels to an intensity value of zero. \nMoreover these images are normalized, meaning that the size of the head is \nexactly the same in each image.  \nThe masked images have 176 by 208 pixels with grayscale values between 0 \nand 255. \nAll together we thus have 416 observed images $Y_i$ containing univariate \nintensity values $Y_i(j,k)$, where $j=1,\\ldots,J=176$ and $k=1,\\ldots,K=208$.\n\nThere is more information in the image than just the raw values. \nWe can incorporate part of the shape information by computing the gradient \nin every pixel of the image. \nThis gradient is composed of the derivatives in the horizontal and the \nvertical direction. \nMore precisely, the gradient in pixel $(j,k)$ is defined as the 2-dimensional \nvector $\\nabla Y_i(j,k) = \\left(\\frac{\\delta Y_i(j,k)}{\\delta j},\n\\frac{\\delta Y_i(j,k)}{\\delta k} \\right)$. \nIn practice we do not have the exact derivatives of the image at the \nrecorded pixels, so we have to rely on numerical approximations. \nWe use forward and backward finite differences to approximate the \nderivatives in the pixels at the boundary of the brain. \nFor the other pixels, we have used central differences.\nIn the horizontal direction these are given by\n\n", "itemtype": "equation", "pos": 14455, "prevtext": "\nIn the denominator, MAD denotes the median absolute \ndeviation defined as\\linebreak\n$\\text{MAD}(\\text{LCFO})=1.4826 \\; {\\mathop{\\mbox{med}}}(| \\; \\text{LCFO}-{\\mathop{\\mbox{med}}}(\\text{LCFO})|)$.\n\nIn addition to the FOM, it is often instructive to plot \nthe AO values themselves over their domain. \nFor a function with a bivariate domain, this yields a\ntwo-dimensional heatmap. \nThese plots can reveal particularly outlying regions and provide \nmore insight into why certain surfaces are flagged as outliers \nby the FOM. \nThis will be illustrated in the following sections.\n\n\\section{Surface data}\\label{sec:surface}\n\nThe Dorrit dataset contains excitation-emission landscapes of \n27 mixtures of 4 fluorophores in an aqueous solution and has been studied extensively by \\cite{Engelen:Scatter}, \\cite{Engelen:robParafac}  and \\cite{Hubert:RParafac-SI}. Such landscapes are typically stored in excitation-emission matrices (EEM). These matrices contain measurements of fluorescence intensity for 116 emission spectra ranging from 250 to 482 nm at 18 excitation wavelengths ranging from 230 to 315 nm. \nThis yields 27 samples $Y_i$, each containing measurements \n$Y_i(j,k)$ for $j=1,\\ldots,J=18$ and $k=1,\\ldots,K=116$.\nRaman and Rayleigh scattering, showing up in \nFigure~\\ref{fig:L8}(a) as two diagonal ridges in \nlandscape 8, are a common problem in this type of experiment\nand can severely distort the analysis.\nTo resolve this we used the method of \\cite{Engelen:Scatter} \nwhich automatically identifies the scattering. \nAfter setting the scattering to missing values, we imputed\nthem by interpolating each excitation profile.\nThe result of this process is illustrated in \nFigure~\\ref{fig:L8}(b).\n\n\\begin{figure}[!htb]\n\\centering\n\n\n\n\n\n\\includegraphics[width=1.0\\textwidth]{Fig1.pdf}\n\\caption{(a) Original landscape 8 with scatter and (b) with scatter removed.}\n\t\t\\label{fig:L8}\n\\end{figure}\n\nUsing Definition~\\eqref{eq:fao_surface} with a uniform \nweight function, we obtain the functional outlier map \ndepicted in Figure~\\ref{fig:dorritfom}. \nThe dashed black line is determined by the cutoff \nvalue~\\eqref{eq:cutoff} and shows the boundary between \nthe regular data and the outliers.\nThe outliers, plotted as red squares, are landscapes\n3 and 5.\n\n\\begin{figure}[!htb]\n\\centering\n \\centering\n    \\includegraphics[width=0.6\\textwidth]{Fig2.pdf} \n    \\caption{FOM of the raw Dorrit data.}\n    \\label{fig:dorritfom}\n\\end{figure}\n\nWe can improve our analysis by incorporating more \ninformation, for example by applying parallel factor \nanalysis (PARAFAC) to the data. PARAFAC is known to be a powerful tool for analyzing multiway data and can in particular be used to decompose three-way EEM data into a trilinear model. This trilinear model states that the value of a landscape $Y_i$ at EE-point $(j,k)$ can be written as the product of three corresponding values of the score matrix $A$ and the loading matrices $B$ and $C$, plus an error term:\n\n", "index": 13, "text": "\\begin{equation}\\label{eq:parafac}\nY_{i}(j,k)=\\sum_{f=1}^{F}{a_{if}b_{jf}c_{kf}}+e_{ijk} \\;.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"Y_{i}(j,k)=\\sum_{f=1}^{F}{a_{if}b_{jf}c_{kf}}+e_{ijk}\\;.\" display=\"block\"><mrow><mrow><mrow><msub><mi>Y</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>j</mi><mo>,</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>f</mi><mo>=</mo><mn>1</mn></mrow><mi>F</mi></munderover><mrow><msub><mi>a</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>f</mi></mrow></msub><mo>\u2062</mo><msub><mi>b</mi><mrow><mi>j</mi><mo>\u2062</mo><mi>f</mi></mrow></msub><mo>\u2062</mo><msub><mi>c</mi><mrow><mi>k</mi><mo>\u2062</mo><mi>f</mi></mrow></msub></mrow></mrow><mo>+</mo><mpadded width=\"+2.8pt\"><msub><mi>e</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi><mo>\u2062</mo><mi>k</mi></mrow></msub></mpadded></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.08133.tex", "nexttext": "\nThe derivatives in the vertical direction are computed analogously.\n\nAdding these derivatives to the data yields a multiway dataset of dimensions \n$416 \\times 176 \\times 208 \\times 3$, so each $Y_i(j,k)$ is trivariate. \nFor each person we thus have three data matrices which represent the original \nMRI image and its derivatives in both directions. \nFigure~\\ref{fig:mridata} represents these three matrices for person 144.\n\\begin{figure}[!htb]\n\\centering\n\n\n\n    \n\n\n\n    \n\n\n\n    \n\n\n\\includegraphics[width=1\\textwidth]{Fig5.pdf}\n\\caption{Original MRI image of person 144 and its derivatives in the \n         horizontal and vertical direction.}\n\\label{fig:mridata}\n\\end{figure}\n\nThe functional adjusted outlyingness of an MRI image $Y_i$ relative to the \nsample $\\bm{Y}$ is given by~\\eqref{eq:fao_surface} :\n\n", "itemtype": "equation", "pos": 18897, "prevtext": "\nHere $F$ denotes the number of components which we take as $F=4$, corresponding to the 4 known fluorophores present in the mixtures. \nApplying PARAFAC to the data results in 27 residual \nlandscapes $\\widetilde{Y}_i(j,k)=e_{ijk}$. \nWith the objective of outlier detection in mind, it is important to use a robust PARAFAC algorithm as it is well known that the presence of outliers can severely impact the PARAFAC decomposition. We have used the robust PARAFAC algorithm proposed by \\cite{Engelen:robParafac} in which we set the robustness parameter $h=0.75$. This  parameter indicates that the PARAFAC model is based on the $75\\%$ of surfaces which yield the smallest residuals. \n\nBy computing the fAO on the residuals instead of the original data, the trilinear structure of the dataset is taken into account. \nThe resulting functional outlier map is shown in \nFigure~\\ref{fig:dorritfom_parafac} and flags \nlandscapes 2, 3 and 5.\nThese outliers were also detected \nin~\\cite{Engelen:robParafac}.\nNote that points 3 and 5 lie much further from the boundary \n(the dashed black curve) than in the FOM of \nFigure~\\ref{fig:dorritfom}. \nThis indicates that surfaces 3 and 5 have outlying values but mostly expose an outlying structure. \nLandscape 2 barely contains abnormally low or high values but \nhas large residuals with respect to the PARAFAC model fitted\nto the majority of EEM landscapes. \n\n\\begin{figure}[!htb]\n\\centering\n\\includegraphics[width=0.6\\textwidth]{Fig3.pdf} \n\\caption{FOM of the residuals of the Dorrit data.}\n\\label{fig:dorritfom_parafac}\n\\end{figure}\n\nA heatmap of the AO values over the domain allows us to \ninspect surface 2 in more detail. \nFigure \\ref{fig:AOmap_dorrit}(a) plots the AOs of the \noriginal landscape 2, whereas \nFigure \\ref{fig:AOmap_dorrit}(b) shows the AOs of its \nPARAFAC residuals. \nTo improve visibility, all AO values of 15 or higher \nreceived the darkest color.\nThe left plot indicates that landscape 2 indeed does not \nhave large outlying regions, as the vast majority of its\ncells are light-colored. \nHowever, the right plot shows that its residuals are significantly outlying in the emission spectra between \n275 and 350 nm. \nThis indicates that the shape of landscape 2 differs \nstrongly from the shape predicted by the PARAFAC model. Therefore, this landscape can be classified as a shape \noutlier.\n\n\\begin{figure}[!htb]\n\\centering\n\n\n\n\n\n\\includegraphics[width=1.0\\textwidth]{Fig4.pdf}\n\\caption{Heatmap of the AO values of landscape 2 for \n         (a) the raw values, \n         (b) the residuals after a robust PARAFAC fit.}\n\t\t\\label{fig:AOmap_dorrit}\n\\end{figure}\n\n\n\n\\section{Image data}\\label{sec:image}\n\nThe MRI dataset contains brain imaging data of 416 persons, aged between \n18 and 96 years~\\citep{Marcus:OASIS} and can be freely accessed \nat {\\it www.oasis-brains.org}.\nFor each person, multiple MRI scans are available including 3 to 4 raw MRI \nimages and several processed scans such as an averaged image of the raw \nscans, the atlas-registered gain field-corrected image and a masked version\n of the latter scan resampled to 1mm isotropic pixels. \nMasking sets all non-brain pixels to an intensity value of zero. \nMoreover these images are normalized, meaning that the size of the head is \nexactly the same in each image.  \nThe masked images have 176 by 208 pixels with grayscale values between 0 \nand 255. \nAll together we thus have 416 observed images $Y_i$ containing univariate \nintensity values $Y_i(j,k)$, where $j=1,\\ldots,J=176$ and $k=1,\\ldots,K=208$.\n\nThere is more information in the image than just the raw values. \nWe can incorporate part of the shape information by computing the gradient \nin every pixel of the image. \nThis gradient is composed of the derivatives in the horizontal and the \nvertical direction. \nMore precisely, the gradient in pixel $(j,k)$ is defined as the 2-dimensional \nvector $\\nabla Y_i(j,k) = \\left(\\frac{\\delta Y_i(j,k)}{\\delta j},\n\\frac{\\delta Y_i(j,k)}{\\delta k} \\right)$. \nIn practice we do not have the exact derivatives of the image at the \nrecorded pixels, so we have to rely on numerical approximations. \nWe use forward and backward finite differences to approximate the \nderivatives in the pixels at the boundary of the brain. \nFor the other pixels, we have used central differences.\nIn the horizontal direction these are given by\n\n", "index": 15, "text": "\\begin{align*}\n\\frac{\\delta Y_i(j,k)}{\\delta j} \\approx &\\frac{-3 \\, Y_i(j,k) + 4 \\, Y_i(j+1,k) - Y_i(j+2,k)}{2} &&(\\text{forward difference})\\\\\n\\frac{\\delta Y_i(j,k)}{\\delta j} \\approx &\\frac{Y_i(j+1,k)-Y_i(j-1,k)}{2}  &&(\\text{central difference})\\\\\n\\frac{\\delta Y_i(j,k)}{\\delta j} \\approx &\\frac{Y_i(j-2,k)-4 \\, Y_i(j-1,k)+3\\,  Y_i(j,k)}{2}  &&(\\text{backward difference}).\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\frac{\\delta Y_{i}(j,k)}{\\delta j}\\approx\" display=\"inline\"><mrow><mstyle displaystyle=\"true\"><mfrac><mrow><mi>\u03b4</mi><mo>\u2062</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>j</mi><mo>,</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mi>\u03b4</mi><mo>\u2062</mo><mi>j</mi></mrow></mfrac></mstyle><mo>\u2248</mo><mi/></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\frac{-3\\,Y_{i}(j,k)+4\\,Y_{i}(j+1,k)-Y_{i}(j+2,k)}{2}\" display=\"inline\"><mstyle displaystyle=\"true\"><mfrac><mrow><mrow><mrow><mo>-</mo><mrow><mpadded width=\"+1.7pt\"><mn>3</mn></mpadded><mo>\u2062</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>j</mi><mo>,</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><mrow><mpadded width=\"+1.7pt\"><mn>4</mn></mpadded><mo>\u2062</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow><mo>,</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>-</mo><mrow><msub><mi>Y</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>j</mi><mo>+</mo><mn>2</mn></mrow><mo>,</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mn>2</mn></mfrac></mstyle></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle(\\text{forward difference})\" display=\"inline\"><mrow><mo stretchy=\"false\">(</mo><mtext>forward difference</mtext><mo stretchy=\"false\">)</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\frac{\\delta Y_{i}(j,k)}{\\delta j}\\approx\" display=\"inline\"><mrow><mstyle displaystyle=\"true\"><mfrac><mrow><mi>\u03b4</mi><mo>\u2062</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>j</mi><mo>,</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mi>\u03b4</mi><mo>\u2062</mo><mi>j</mi></mrow></mfrac></mstyle><mo>\u2248</mo><mi/></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\frac{Y_{i}(j+1,k)-Y_{i}(j-1,k)}{2}\" display=\"inline\"><mstyle displaystyle=\"true\"><mfrac><mrow><mrow><msub><mi>Y</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow><mo>,</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><msub><mi>Y</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>j</mi><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mn>2</mn></mfrac></mstyle></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle(\\text{central difference})\" display=\"inline\"><mrow><mo stretchy=\"false\">(</mo><mtext>central difference</mtext><mo stretchy=\"false\">)</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\frac{\\delta Y_{i}(j,k)}{\\delta j}\\approx\" display=\"inline\"><mrow><mstyle displaystyle=\"true\"><mfrac><mrow><mi>\u03b4</mi><mo>\u2062</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>j</mi><mo>,</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mi>\u03b4</mi><mo>\u2062</mo><mi>j</mi></mrow></mfrac></mstyle><mo>\u2248</mo><mi/></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\frac{Y_{i}(j-2,k)-4\\,Y_{i}(j-1,k)+3\\,Y_{i}(j,k)}{2}\" display=\"inline\"><mstyle displaystyle=\"true\"><mfrac><mrow><mrow><mrow><msub><mi>Y</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>j</mi><mo>-</mo><mn>2</mn></mrow><mo>,</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mpadded width=\"+1.7pt\"><mn>4</mn></mpadded><mo>\u2062</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>j</mi><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><mrow><mpadded width=\"+1.7pt\"><mn>3</mn></mpadded><mo>\u2062</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>j</mi><mo>,</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mn>2</mn></mfrac></mstyle></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle(\\text{backward difference}).\" display=\"inline\"><mrow><mrow><mo stretchy=\"false\">(</mo><mtext>backward difference</mtext><mo stretchy=\"false\">)</mo></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.08133.tex", "nexttext": "\nwhere ${\\text{AO}}(Y_i(j,k);\\bm{Y}(j,k))$ is the adjusted outlyingness of the\ntrivariate pixel $(j,k)$. \nThe resulting FOM is presented in Figure~\\ref{fig:mrifom}.\n\n\\begin{figure}[!htb]\n\\centering\n\\includegraphics[width=0.6\\textwidth]{Fig6.pdf} \n\\caption{FOM of the MRI images dataset.}\n\\label{fig:mrifom}\n\\end{figure}\nThis plot indicates the presence of 8 outliers of several types. \nImage 126 has a remarkably high fAO combined with a relatively low vAO. \nThis suggests a shift outlier, i.e.\\ a function whose values are all\nshifted relative to the majority of the data. \nImages 29 and 92 have a large fAO in combination with a high vAO, \nindicating that they have strongly outlying subdomains. \nImages 108, 188 and 234 have an fAO which is on the high end relative \nto the dataset but which by itself does not make them outlying. \nOnly in combination with their large vAO are they flagged as outliers. \nImages 69 and 211 have a CFO value just slightly above the \ncutoff, meaning they are borderline cases.\n\n\\begin{figure}[!htb]\n\\centering\n\n\n    \n\n\n\n\n\n    \n\n\n\n\n\n\n\n    \n\n\n\n\n\n    \n\n\n\n\n\n\n\n    \n\n\n\n\n\n\n    \n\n\n\n\\includegraphics[width=0.81\\textwidth]{Fig7.pdf}\n\\captionsetup{format=hang}\n\\caption{MRI image (left) and AO heatmap (right) of persons 144 (top), \n         92 (middle) and 126 (bottom).}\n\\label{fig:mrigrid}\n\\end{figure}\n\nA heatmap of the AO values can help to understand the root cause of \nan image's outlyingness.\nIn Figure~\\ref{fig:mrigrid} we compare the MRI images (left) and the \nAO maps (right) of persons 144, 92, and 126. \n(AO values of 8 or higher received the darkest color.)\nImage 144 has the smallest CFO value, and as such can be thought of as\nthe least outlying image in the dataset. \nAs expected, the AO heatmap of image 144 shows very few outlying \npixels.\nFor person 92, the AO heatmap nicely marks the region in which the MRI \nimage deviates most from the majority of the images. \nNote that the boundaries of this region have the highest outlyingness. \nThis is the result of including the derivatives in the analysis, as \nthey emphasize the pixels at which the grayscale intensity changes. \nThe AO heatmap of person 126 does not show any extremely outlying \nregion but a rather high outlyingness over the whole domain, \nwhich explains its large fAO and regular vAO value. \nThe actual MRI image to its left is globally lighter than the \nothers, which confirms that it is a shift outlier.\n\n\n\\section{Video data}\\label{sec:video}\n\nThis dataset consists of 633 images which together form a surveillance \nvideo of a beach, filmed with a static camera~\\citep{Li:ObjectDetection}. \nThe data and the original video can be found\nat {\\it http://perception.i2r.a-star.edu.sg/bk\\_model/bk\\_index.html}. \nThe video first shows a beach with a tree during 8 seconds, shown in the \nleftmost frame of Figure~\\ref{fig:videodata}. \nThen a man enters the screen from the left (second frame), disappears \nbehind the tree (third frame), and then reappears again on the right \nside of the tree and stays on screen until the end of the video. \nThe aim of applying our method to this dataset is to detect the man \nin this video. \nThe images have $160 \\times 128$ pixels and are stored using the RGB \n(Red, Green and Blue) color model, so each image corresponds to three \nmatrices, each of dimensions $160 \\times 128$. \nOverall we have 633 images $Y_i$ containing trivariate $Y_i(j,k)$ \nfor $j=1,\\ldots,J=160$ and $k=1,\\ldots,K=128$. \n\n\\begin{figure}[!htb]\n\\centering\n\n\n\n    \n\n\n\n    \n\n\n\n    \n\n\n\n    \n\n\n\\includegraphics[width=1\\textwidth]{Fig8.pdf}\n\\caption{Frames number 100, 487, 491 and 500 from the video dataset.}\n\\label{fig:videodata}\n\\end{figure}\n\nComputing the fAO according to~\\eqref{eq:fao_surface} yields the FOM \nin Figure~\\ref{fig:videofom}. \nIt is very instructive as the path of the man in the video can be traced \nin it.\nThe first 480 images, which depict the beach and the tree and where only \nthe water surface causes slight variations, are found on the bottom left \nside of the FOM inside the dashed curve that separates the regular \nframes from the outliers.\nAround frame 483 the man enters and as a result the standard deviation \nof the adjusted outlyingness rises slightly. \nThe fAO itself increases more slowly as the fraction of the pixels \ncovered by the man is still low. \nThese frames can thus be classified as isolated outliers. \nTheir CFO barely exceeds the cutoff~\\eqref{eq:cutoff} so on the FOM they \nare still close to the dashed line. \nFrames 484--487 have a very high fAO and vAO. \nIn these images, the man is clearly visible between the left border of \nthe frame and the tree. \nConsequently these images have outlying pixels in a substantial part \nof their domain. \nFrames 488--491 see the man disappear behind the tree. \nIn these frames the fAO goes down as the fraction of outlying\npixels decreases.\nFrom frame 492 onward the man reappears on the right side of the tree \nand stays in the screen until the end, as is reflected in \nthe FOM since these frames contain many outlying pixels.\n\\begin{figure}[!htb]\n\\centering\n\\centering\n\\includegraphics[width=0.6\\textwidth]{Fig9.pdf} \n\\caption{FOM of the video dataset.}\n\\label{fig:videofom}\n\\end{figure}\n\nIn addition to the FOM we can construct AO heatmaps of individual \nframes.  \nFor frames 100, 487, 491 and 500, Figure~\\ref{fig:videosum} shows the \nraw image on the left, the AO heatmap in the middle and the FOM on \nthe right. \nOn the FOM we have drawn a blue circle around the relevant frame to \nindicate its location. \nThis sequence of plots clearly shows that the proposed method works \nvery well for this surveillance video data: not only can the man's \npath be followed on the FOM, it is also clear from the AO heatmaps \nwhere exactly the man is in those frames.    \nWe have created a video in which the raw image, the AO heatmap and\nthe FOM evolve over time alongside each other. \nIt can be downloaded from {\\it http://wis.kuleuven.be/stat/robust/publ}.\n\n\\begin{figure}[!htb]\n\\centering\n\n\n\n    \n\n\n\n    \n\n\n\n    \n\n\n\n\n\n\n\n\n    \n\n\n\n    \n\n\n\n    \n\n\n\n\n\n\n\n\n    \n\n\n\n    \n\n\n\n    \n\n\n\n\n\n\n\n\n    \n\n\n\n    \n\n\n\n    \n\n\n\\includegraphics[width=1.0\\textwidth]{Fig10.pdf}\n\\captionsetup{format=hang}\n\\caption{Frames 100, 487, 491 and 500 from the video dataset \n         (left), the corresponding AO heatmaps (middle), and\n\t\t\t\t the FOM with marker on the position of the \n\t\t\t\t corresponding frame (right).}\n\\label{fig:videosum}\n\\end{figure}\n\n\n\n\n\n\n\n\\section*{Acknowledgment} \n\nMH, JR and PR acknowledge the financial support of grants C16/15/068 \nand\\linebreak STRT/13/006 of the Internal Fund KU Leuven.\n\n\\vskip0.2in\t\n\n\n\\bibliographystyle{apalike} \n\n\n\n\n\n\n\\begin{thebibliography}{}\n\n\\bibitem[Brys et~al., 2005]{Brys:RobICA}\nBrys, G., Hubert, M., and Rousseeuw, P.~J. (2005).\n\\newblock A robustification of {I}ndependent {C}omponent {A}nalysis.\n\\newblock {\\em Journal of Chemometrics}, 19:364--375.\n\n\\bibitem[Brys et~al., 2004]{Brys:RobSkew}\nBrys, G., Hubert, M., and Struyf, A. (2004).\n\\newblock A robust measure of skewness.\n\\newblock {\\em Journal of Computational and Graphical Statistics},\n  13:996--1017.\n\n\\bibitem[Claeskens et~al., 2014]{Claeskens:MFHD}\nClaeskens, G., Hubert, M., Slaets, L., and Vakili, K. (2014).\n\\newblock Multivariate functional halfspace depth.\n\\newblock {\\em Journal of the American Statistical Association},\n  109(505):411--423.\n\n\\bibitem[Engelen et~al., 2007]{Engelen:Scatter}\nEngelen, S., Frosch~M{\\o}ller, S., and Hubert, M. (2007).\n\\newblock Automatically identifying scatter in fluorescence data using robust\n  techniques.\n\\newblock {\\em Chemometrics and Intelligent Laboratory Systems}, 86:35--51.\n\n\\bibitem[Engelen and Hubert, 2011]{Engelen:robParafac}\nEngelen, S. and Hubert, M. (2011).\n\\newblock Detecting outlying samples in a parallel factor analysis model.\n\\newblock {\\em Analytica Chimica Acta}, 705:155--165.\n\n\\bibitem[Hubert et~al., 2015a]{Hubert:MFOD}\nHubert, M., Rousseeuw, P.~J., and Segaert, P. (2015a).\n\\newblock Multivariate functional outlier detection.\n\\newblock {\\em Statistical Methods \\& Applications}, 24:177--202.\n\n\\bibitem[Hubert et~al., 2015b]{Hubert:MFOD_Rejoinder}\nHubert, M., Rousseeuw, P.~J., and Segaert, P. (2015b).\n\\newblock Rejoinder to `{M}ultivariate functional outlier detection'.\n\\newblock {\\em Statistical Methods \\& Applications}, 24(2):269--277.\n\n\\bibitem[Hubert and Van~der Veeken, 2008]{Hubert:OutlierSkewed}\nHubert, M. and Van~der Veeken, S. (2008).\n\\newblock Outlier detection for skewed data.\n\\newblock {\\em Journal of Chemometrics}, 22:235--246.\n\n\\bibitem[Hubert et~al., 2012]{Hubert:RParafac-SI}\nHubert, M., Van~Kerckhoven, J., and Verdonck, T. (2012).\n\\newblock Robust {PARAFAC} for incomplete data.\n\\newblock {\\em Journal of Chemometrics}, 26:290--298.\n\n\\bibitem[Hubert and Vandervieren, 2008]{Hubert:AdjBoxplot}\nHubert, M. and Vandervieren, E. (2008).\n\\newblock An adjusted boxplot for skewed distributions.\n\\newblock {\\em Computational Statistics \\& Data Analysis}, 52(12):5186--5201.\n\n\\bibitem[Li et~al., 2004]{Li:ObjectDetection}\nLi, L., Huang, W., Gu, I. Y.-H., and Tian, Q. (2004).\n\\newblock Statistical modeling of complex backgrounds for foreground object\n  detection.\n\\newblock {\\em IEEE Transactions on Image Processing}, 13:1459--1472.\n\n\\bibitem[Marcus et~al., 2007]{Marcus:OASIS}\nMarcus, D., Wang, T., Parker, J., Csernansky, J., Morris, J., and Buckner, R.\n  (2007).\n\\newblock {O}pen {A}ccess {S}eries of {I}maging {S}tudies ({OASIS}):\n  Cross-sectional {MRI} data in young, middle aged, nondemented, and demented\n  older adults.\n\\newblock {\\em Journal of Cognitive Neuroscience}, 19:1498--1507.\n\n\\bibitem[Saeys et~al., 2008]{Saeys:Functional}\nSaeys, W., de~Ketelaere, B., and Darius, P. (2008).\n\\newblock Potential applications of functional data analysis in chemometrics.\n\\newblock {\\em Journal of Chemometrics}, 22:335--344.\n\n\\end{thebibliography}\n\n\\vskip1cm\n\n\n\\Large\n\\noindent{\\bf Appendix}\\\\ \n\\normalsize\n\n\\vskip0.3cm\n\nThe adjusted outlyingness of multivariate data has been introduced\nby~\\cite{Brys:RobICA} and was studied in detail \nby~\\cite{Hubert:OutlierSkewed}. \nWe first recall the adjusted outlyingness of a point $x$ relative to \na univariate dataset $Y=\\{y_1,\\ldots,y_n\\}$. \nIt can be seen as a robust version of the absolute $z$-score since\nit uses robust measures of location and scale (instead of the usual \nmean and standard deviation). It also accounts for skewness by \ncomputing the scale on each side of the median separately.\n\nAs a robust measure of location we take the median of $Y$. \nThe robust estimates of scale are based on the adjusted \nboxplot~\\citep{Hubert:AdjBoxplot}. \nThis modified boxplot is well-suited for skewed distributions. \nFirst, an interval called the fence is computed. \nFor right-skewed data it is given by\n\n", "itemtype": "equation", "pos": 20093, "prevtext": "\nThe derivatives in the vertical direction are computed analogously.\n\nAdding these derivatives to the data yields a multiway dataset of dimensions \n$416 \\times 176 \\times 208 \\times 3$, so each $Y_i(j,k)$ is trivariate. \nFor each person we thus have three data matrices which represent the original \nMRI image and its derivatives in both directions. \nFigure~\\ref{fig:mridata} represents these three matrices for person 144.\n\\begin{figure}[!htb]\n\\centering\n\n\n\n    \n\n\n\n    \n\n\n\n    \n\n\n\\includegraphics[width=1\\textwidth]{Fig5.pdf}\n\\caption{Original MRI image of person 144 and its derivatives in the \n         horizontal and vertical direction.}\n\\label{fig:mridata}\n\\end{figure}\n\nThe functional adjusted outlyingness of an MRI image $Y_i$ relative to the \nsample $\\bm{Y}$ is given by~\\eqref{eq:fao_surface} :\n\n", "index": 17, "text": "\\begin{equation}\n\\text{fAO}(Y_i; \\bm{Y}) = \\frac{1}{176 \\times 208} \\sum_{j=1}^{176}\n                          \\sum_{k=1}^{208} {\\text{AO}}(Y_i(j,k); \\bm{Y}(j,k)) \\; ,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m1\" class=\"ltx_Math\" alttext=\"\\text{fAO}(Y_{i};\\bm{Y})=\\frac{1}{176\\times 208}\\sum_{j=1}^{176}\\sum_{k=1}^{20%&#10;8}{\\text{AO}}(Y_{i}(j,k);\\bm{Y}(j,k))\\;,\" display=\"block\"><mrow><mrow><mrow><mtext>fAO</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>;</mo><mi>\ud835\udc80</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><mrow><mn>176</mn><mo>\u00d7</mo><mn>208</mn></mrow></mfrac><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mn>176</mn></munderover><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mn>208</mn></munderover><mrow><mtext>AO</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>Y</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>j</mi><mo>,</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>;</mo><mrow><mi>\ud835\udc80</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>j</mi><mo>,</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo rspace=\"5.3pt\" stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.08133.tex", "nexttext": "\nwith $Q_1(Y)$ and $Q_3(Y)$ the first and third quartile of $Y$, \n$\\mbox{IQR}(Y) = Q_3(Y)-Q_1(Y)$ and $\\text{MC}(Y)$ the medcouple, \na robust measure of skewness \\citep{Brys:RobSkew}. \nFor left-skewed data a similar definition holds. \nNote that for perfectly symmetric data the medcouple is zero, and \nthen the fence is identical to that of the standard boxplot.\nThe whiskers of the adjusted boxplot are lines from the box to the \nmost remote data points inside the fence.  \n\nFigure~\\ref{fig:adjBox} shows the adjusted boxplot of a \nright-skewed dataset $Y$. \nThe points $x_1$ and $x_2$ have the same distance $d_1=d_2$ to the \nmedian of $Y$, but $x_1$ lies outside the lower whisker $w_1$ \nwhereas $x_2$ lies inside the upper whisker. \nThe adjusted outlyingness of $x_1 < {\\mathop{\\mbox{med}}}(Y)$ is now defined as \n$d_1/s_1$ with $d_1 = {\\mathop{\\mbox{med}}}(Y)-x_1$ and $s_1={\\mathop{\\mbox{med}}}(Y) - w_1$. \nFor $x_2 > {\\mathop{\\mbox{med}}}(Y)$ the AO is given by $d_2/s_2$ \nwith $d_2=x_2-{\\mathop{\\mbox{med}}}(Y)$ and $s_2 = w_2 - {\\mathop{\\mbox{med}}}(Y)$. \nIn this example ${\\text{AO}}(x_1) > {\\text{AO}}(x_2)$.\\\\\n\n\n\\begin{figure}[!htb]\n\\begin{center}\n\\unitlength=0.75mm \\thicklines\n\\begin{picture}(170,50)\n\\put(5.00,20.00){\\line(0,1){20.00}}\n\\put(5.00,30.00){\\line(1,0){30.00}}\n\\put(35.00,20.00){\\line(1,0){40.00}}\n\\put(35.00,20.00){\\line(0,1){20.00}}\n\\put(35.00,40.00){\\line(1,0){40.00}}\n\\put(75.00,20.00){\\line(0,1){20.00}}\n\\put(75.00,30.00){\\line(1,0){70.00}}\n\\put(145.00,20.00){\\line(0,1){20.00}}\n\\put(50.00,20.00){\\line(0,1){20.00}}\n\\put(0,30.00){\\circle*{2}}\n\\put(5,30.00){\\circle*{2}}\n\\put(100,30){\\circle*{2}}\n\\put(160,30.00){\\circle*{2}}\n\\put(145,30.00){\\circle*{2}}\n\\put(3.00,25.00){\\makebox(0,0)[rr]{$x_1$}}\n\\put(103.00,25.00){\\makebox(0,0)[rr]{$x_2$}}\n\\put(8.00,44.00){\\makebox(0,0)[rr]{$w_1$}}\n\\put(147.00,44.00){\\makebox(0,0)[rr]{$w_2$}}\n\\put(25.00,16.00){\\makebox(0,0)[rr]{$d_1$}}\n\\put(77.00,16.00){\\makebox(0,0)[rr]{$d_2$}}\n\\put(25.00,5.00){\\makebox(0,0)[rr]{$s_1$}}\n\\put(100.00,5.00){\\makebox(0,0)[rr]{$s_2$}}\n\\put(54.00,44.00){\\makebox(0,0)[rr]{${\\mathop{\\mbox{med}}}$}}\n\\put(38.00,44.00){\\makebox(0,0)[rr]{$Q_1$}}\n\\put(77.00,44.00){\\makebox(0,0)[rr]{$Q_3$}}\n\n\\put(10.00,8.00){\\vector(1,0){40}}\n\\put(10.00,8.00){\\vector(-1,0){5}}\n\\put(55.00,8.00){\\vector(1,0){90}}\n\\put(55.00,8.00){\\vector(-1,0){4}}\n\\put(5.00,13.00){\\vector(1,0){45}}\n\\put(5.00,13.00){\\vector(-1,0){5}}\n\\put(55.00,13.00){\\vector(1,0){45}}\n\\put(55.00,13.00){\\vector(-1,0){4}}\n\\end{picture}\n\\end{center}\n\\vspace{-0.5cm}\n\\caption{Adjusted outlyingness based on the adjusted boxplot.}\n\\label{fig:adjBox}\n\\end{figure}\n\nFormally, the univariate adjusted outlyingness AO of a point $x$ \nrelative to a sample $Y$ is given by:\n\n\n", "itemtype": "equation", "pos": 30992, "prevtext": "\nwhere ${\\text{AO}}(Y_i(j,k);\\bm{Y}(j,k))$ is the adjusted outlyingness of the\ntrivariate pixel $(j,k)$. \nThe resulting FOM is presented in Figure~\\ref{fig:mrifom}.\n\n\\begin{figure}[!htb]\n\\centering\n\\includegraphics[width=0.6\\textwidth]{Fig6.pdf} \n\\caption{FOM of the MRI images dataset.}\n\\label{fig:mrifom}\n\\end{figure}\nThis plot indicates the presence of 8 outliers of several types. \nImage 126 has a remarkably high fAO combined with a relatively low vAO. \nThis suggests a shift outlier, i.e.\\ a function whose values are all\nshifted relative to the majority of the data. \nImages 29 and 92 have a large fAO in combination with a high vAO, \nindicating that they have strongly outlying subdomains. \nImages 108, 188 and 234 have an fAO which is on the high end relative \nto the dataset but which by itself does not make them outlying. \nOnly in combination with their large vAO are they flagged as outliers. \nImages 69 and 211 have a CFO value just slightly above the \ncutoff, meaning they are borderline cases.\n\n\\begin{figure}[!htb]\n\\centering\n\n\n    \n\n\n\n\n\n    \n\n\n\n\n\n\n\n    \n\n\n\n\n\n    \n\n\n\n\n\n\n\n    \n\n\n\n\n\n\n    \n\n\n\n\\includegraphics[width=0.81\\textwidth]{Fig7.pdf}\n\\captionsetup{format=hang}\n\\caption{MRI image (left) and AO heatmap (right) of persons 144 (top), \n         92 (middle) and 126 (bottom).}\n\\label{fig:mrigrid}\n\\end{figure}\n\nA heatmap of the AO values can help to understand the root cause of \nan image's outlyingness.\nIn Figure~\\ref{fig:mrigrid} we compare the MRI images (left) and the \nAO maps (right) of persons 144, 92, and 126. \n(AO values of 8 or higher received the darkest color.)\nImage 144 has the smallest CFO value, and as such can be thought of as\nthe least outlying image in the dataset. \nAs expected, the AO heatmap of image 144 shows very few outlying \npixels.\nFor person 92, the AO heatmap nicely marks the region in which the MRI \nimage deviates most from the majority of the images. \nNote that the boundaries of this region have the highest outlyingness. \nThis is the result of including the derivatives in the analysis, as \nthey emphasize the pixels at which the grayscale intensity changes. \nThe AO heatmap of person 126 does not show any extremely outlying \nregion but a rather high outlyingness over the whole domain, \nwhich explains its large fAO and regular vAO value. \nThe actual MRI image to its left is globally lighter than the \nothers, which confirms that it is a shift outlier.\n\n\n\\section{Video data}\\label{sec:video}\n\nThis dataset consists of 633 images which together form a surveillance \nvideo of a beach, filmed with a static camera~\\citep{Li:ObjectDetection}. \nThe data and the original video can be found\nat {\\it http://perception.i2r.a-star.edu.sg/bk\\_model/bk\\_index.html}. \nThe video first shows a beach with a tree during 8 seconds, shown in the \nleftmost frame of Figure~\\ref{fig:videodata}. \nThen a man enters the screen from the left (second frame), disappears \nbehind the tree (third frame), and then reappears again on the right \nside of the tree and stays on screen until the end of the video. \nThe aim of applying our method to this dataset is to detect the man \nin this video. \nThe images have $160 \\times 128$ pixels and are stored using the RGB \n(Red, Green and Blue) color model, so each image corresponds to three \nmatrices, each of dimensions $160 \\times 128$. \nOverall we have 633 images $Y_i$ containing trivariate $Y_i(j,k)$ \nfor $j=1,\\ldots,J=160$ and $k=1,\\ldots,K=128$. \n\n\\begin{figure}[!htb]\n\\centering\n\n\n\n    \n\n\n\n    \n\n\n\n    \n\n\n\n    \n\n\n\\includegraphics[width=1\\textwidth]{Fig8.pdf}\n\\caption{Frames number 100, 487, 491 and 500 from the video dataset.}\n\\label{fig:videodata}\n\\end{figure}\n\nComputing the fAO according to~\\eqref{eq:fao_surface} yields the FOM \nin Figure~\\ref{fig:videofom}. \nIt is very instructive as the path of the man in the video can be traced \nin it.\nThe first 480 images, which depict the beach and the tree and where only \nthe water surface causes slight variations, are found on the bottom left \nside of the FOM inside the dashed curve that separates the regular \nframes from the outliers.\nAround frame 483 the man enters and as a result the standard deviation \nof the adjusted outlyingness rises slightly. \nThe fAO itself increases more slowly as the fraction of the pixels \ncovered by the man is still low. \nThese frames can thus be classified as isolated outliers. \nTheir CFO barely exceeds the cutoff~\\eqref{eq:cutoff} so on the FOM they \nare still close to the dashed line. \nFrames 484--487 have a very high fAO and vAO. \nIn these images, the man is clearly visible between the left border of \nthe frame and the tree. \nConsequently these images have outlying pixels in a substantial part \nof their domain. \nFrames 488--491 see the man disappear behind the tree. \nIn these frames the fAO goes down as the fraction of outlying\npixels decreases.\nFrom frame 492 onward the man reappears on the right side of the tree \nand stays in the screen until the end, as is reflected in \nthe FOM since these frames contain many outlying pixels.\n\\begin{figure}[!htb]\n\\centering\n\\centering\n\\includegraphics[width=0.6\\textwidth]{Fig9.pdf} \n\\caption{FOM of the video dataset.}\n\\label{fig:videofom}\n\\end{figure}\n\nIn addition to the FOM we can construct AO heatmaps of individual \nframes.  \nFor frames 100, 487, 491 and 500, Figure~\\ref{fig:videosum} shows the \nraw image on the left, the AO heatmap in the middle and the FOM on \nthe right. \nOn the FOM we have drawn a blue circle around the relevant frame to \nindicate its location. \nThis sequence of plots clearly shows that the proposed method works \nvery well for this surveillance video data: not only can the man's \npath be followed on the FOM, it is also clear from the AO heatmaps \nwhere exactly the man is in those frames.    \nWe have created a video in which the raw image, the AO heatmap and\nthe FOM evolve over time alongside each other. \nIt can be downloaded from {\\it http://wis.kuleuven.be/stat/robust/publ}.\n\n\\begin{figure}[!htb]\n\\centering\n\n\n\n    \n\n\n\n    \n\n\n\n    \n\n\n\n\n\n\n\n\n    \n\n\n\n    \n\n\n\n    \n\n\n\n\n\n\n\n\n    \n\n\n\n    \n\n\n\n    \n\n\n\n\n\n\n\n\n    \n\n\n\n    \n\n\n\n    \n\n\n\\includegraphics[width=1.0\\textwidth]{Fig10.pdf}\n\\captionsetup{format=hang}\n\\caption{Frames 100, 487, 491 and 500 from the video dataset \n         (left), the corresponding AO heatmaps (middle), and\n\t\t\t\t the FOM with marker on the position of the \n\t\t\t\t corresponding frame (right).}\n\\label{fig:videosum}\n\\end{figure}\n\n\n\n\n\n\n\n\\section*{Acknowledgment} \n\nMH, JR and PR acknowledge the financial support of grants C16/15/068 \nand\\linebreak STRT/13/006 of the Internal Fund KU Leuven.\n\n\\vskip0.2in\t\n\n\n\\bibliographystyle{apalike} \n\n\n\n\n\n\n\\begin{thebibliography}{}\n\n\\bibitem[Brys et~al., 2005]{Brys:RobICA}\nBrys, G., Hubert, M., and Rousseeuw, P.~J. (2005).\n\\newblock A robustification of {I}ndependent {C}omponent {A}nalysis.\n\\newblock {\\em Journal of Chemometrics}, 19:364--375.\n\n\\bibitem[Brys et~al., 2004]{Brys:RobSkew}\nBrys, G., Hubert, M., and Struyf, A. (2004).\n\\newblock A robust measure of skewness.\n\\newblock {\\em Journal of Computational and Graphical Statistics},\n  13:996--1017.\n\n\\bibitem[Claeskens et~al., 2014]{Claeskens:MFHD}\nClaeskens, G., Hubert, M., Slaets, L., and Vakili, K. (2014).\n\\newblock Multivariate functional halfspace depth.\n\\newblock {\\em Journal of the American Statistical Association},\n  109(505):411--423.\n\n\\bibitem[Engelen et~al., 2007]{Engelen:Scatter}\nEngelen, S., Frosch~M{\\o}ller, S., and Hubert, M. (2007).\n\\newblock Automatically identifying scatter in fluorescence data using robust\n  techniques.\n\\newblock {\\em Chemometrics and Intelligent Laboratory Systems}, 86:35--51.\n\n\\bibitem[Engelen and Hubert, 2011]{Engelen:robParafac}\nEngelen, S. and Hubert, M. (2011).\n\\newblock Detecting outlying samples in a parallel factor analysis model.\n\\newblock {\\em Analytica Chimica Acta}, 705:155--165.\n\n\\bibitem[Hubert et~al., 2015a]{Hubert:MFOD}\nHubert, M., Rousseeuw, P.~J., and Segaert, P. (2015a).\n\\newblock Multivariate functional outlier detection.\n\\newblock {\\em Statistical Methods \\& Applications}, 24:177--202.\n\n\\bibitem[Hubert et~al., 2015b]{Hubert:MFOD_Rejoinder}\nHubert, M., Rousseeuw, P.~J., and Segaert, P. (2015b).\n\\newblock Rejoinder to `{M}ultivariate functional outlier detection'.\n\\newblock {\\em Statistical Methods \\& Applications}, 24(2):269--277.\n\n\\bibitem[Hubert and Van~der Veeken, 2008]{Hubert:OutlierSkewed}\nHubert, M. and Van~der Veeken, S. (2008).\n\\newblock Outlier detection for skewed data.\n\\newblock {\\em Journal of Chemometrics}, 22:235--246.\n\n\\bibitem[Hubert et~al., 2012]{Hubert:RParafac-SI}\nHubert, M., Van~Kerckhoven, J., and Verdonck, T. (2012).\n\\newblock Robust {PARAFAC} for incomplete data.\n\\newblock {\\em Journal of Chemometrics}, 26:290--298.\n\n\\bibitem[Hubert and Vandervieren, 2008]{Hubert:AdjBoxplot}\nHubert, M. and Vandervieren, E. (2008).\n\\newblock An adjusted boxplot for skewed distributions.\n\\newblock {\\em Computational Statistics \\& Data Analysis}, 52(12):5186--5201.\n\n\\bibitem[Li et~al., 2004]{Li:ObjectDetection}\nLi, L., Huang, W., Gu, I. Y.-H., and Tian, Q. (2004).\n\\newblock Statistical modeling of complex backgrounds for foreground object\n  detection.\n\\newblock {\\em IEEE Transactions on Image Processing}, 13:1459--1472.\n\n\\bibitem[Marcus et~al., 2007]{Marcus:OASIS}\nMarcus, D., Wang, T., Parker, J., Csernansky, J., Morris, J., and Buckner, R.\n  (2007).\n\\newblock {O}pen {A}ccess {S}eries of {I}maging {S}tudies ({OASIS}):\n  Cross-sectional {MRI} data in young, middle aged, nondemented, and demented\n  older adults.\n\\newblock {\\em Journal of Cognitive Neuroscience}, 19:1498--1507.\n\n\\bibitem[Saeys et~al., 2008]{Saeys:Functional}\nSaeys, W., de~Ketelaere, B., and Darius, P. (2008).\n\\newblock Potential applications of functional data analysis in chemometrics.\n\\newblock {\\em Journal of Chemometrics}, 22:335--344.\n\n\\end{thebibliography}\n\n\\vskip1cm\n\n\n\\Large\n\\noindent{\\bf Appendix}\\\\ \n\\normalsize\n\n\\vskip0.3cm\n\nThe adjusted outlyingness of multivariate data has been introduced\nby~\\cite{Brys:RobICA} and was studied in detail \nby~\\cite{Hubert:OutlierSkewed}. \nWe first recall the adjusted outlyingness of a point $x$ relative to \na univariate dataset $Y=\\{y_1,\\ldots,y_n\\}$. \nIt can be seen as a robust version of the absolute $z$-score since\nit uses robust measures of location and scale (instead of the usual \nmean and standard deviation). It also accounts for skewness by \ncomputing the scale on each side of the median separately.\n\nAs a robust measure of location we take the median of $Y$. \nThe robust estimates of scale are based on the adjusted \nboxplot~\\citep{Hubert:AdjBoxplot}. \nThis modified boxplot is well-suited for skewed distributions. \nFirst, an interval called the fence is computed. \nFor right-skewed data it is given by\n\n", "index": 19, "text": "\\begin{equation*}\n  [Q_1(Y)-1.5 \\, e^{-4\\text{MC}(Y)} \\, \\mbox{IQR}(Y) \\; ,\n   \\; Q_3(Y)+1.5 \\, e^{+3\\text{MC}(Y)} \\, \\mbox{IQR}(Y)]\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m1\" class=\"ltx_Math\" alttext=\"[Q_{1}(Y)-1.5\\,e^{-4\\text{MC}(Y)}\\,\\mbox{IQR}(Y)\\;,\\;Q_{3}(Y)+1.5\\,e^{+3\\text{%&#10;MC}(Y)}\\,\\mbox{IQR}(Y)]\" display=\"block\"><mrow><mo stretchy=\"false\">[</mo><mrow><mrow><msub><mi>Q</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mpadded width=\"+1.7pt\"><mn>1.5</mn></mpadded><mo>\u2062</mo><mpadded width=\"+1.7pt\"><msup><mi>e</mi><mrow><mo>-</mo><mrow><mn>4</mn><mo>\u2062</mo><mtext>MC</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></msup></mpadded><mo>\u2062</mo><mtext>IQR</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>Y</mi><mo rspace=\"5.3pt\" stretchy=\"false\">)</mo></mrow></mrow></mrow><mo rspace=\"5.3pt\">,</mo><mrow><mrow><msub><mi>Q</mi><mn>3</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mpadded width=\"+1.7pt\"><mn>1.5</mn></mpadded><mo>\u2062</mo><mpadded width=\"+1.7pt\"><msup><mi>e</mi><mrow><mo>+</mo><mrow><mn>3</mn><mo>\u2062</mo><mtext>MC</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></msup></mpadded><mo>\u2062</mo><mtext>IQR</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></math>", "type": "latex"}, {"file": "1601.08133.tex", "nexttext": "\n\nTo compute the AO of a $p$-dimensional point $x$ relative to \nan $n \\times p$ data matrix $Y$, the following projection \npursuit procedure is applied.\nThe point $x$ and all data points are projected on a direction $v$,\nand we compute the univariate AO of the projected point $x'v$\nrelative to the projected dataset $Yv$  as in \\eqref{eq:adjOut_univ}. \nThis is repeated for many directions $v$, and the multivariate AO \nis defined as the maximum over all corresponding univariate AO\u00e2\u0080\u0099s:\n\n", "itemtype": "equation", "pos": 33853, "prevtext": "\nwith $Q_1(Y)$ and $Q_3(Y)$ the first and third quartile of $Y$, \n$\\mbox{IQR}(Y) = Q_3(Y)-Q_1(Y)$ and $\\text{MC}(Y)$ the medcouple, \na robust measure of skewness \\citep{Brys:RobSkew}. \nFor left-skewed data a similar definition holds. \nNote that for perfectly symmetric data the medcouple is zero, and \nthen the fence is identical to that of the standard boxplot.\nThe whiskers of the adjusted boxplot are lines from the box to the \nmost remote data points inside the fence.  \n\nFigure~\\ref{fig:adjBox} shows the adjusted boxplot of a \nright-skewed dataset $Y$. \nThe points $x_1$ and $x_2$ have the same distance $d_1=d_2$ to the \nmedian of $Y$, but $x_1$ lies outside the lower whisker $w_1$ \nwhereas $x_2$ lies inside the upper whisker. \nThe adjusted outlyingness of $x_1 < {\\mathop{\\mbox{med}}}(Y)$ is now defined as \n$d_1/s_1$ with $d_1 = {\\mathop{\\mbox{med}}}(Y)-x_1$ and $s_1={\\mathop{\\mbox{med}}}(Y) - w_1$. \nFor $x_2 > {\\mathop{\\mbox{med}}}(Y)$ the AO is given by $d_2/s_2$ \nwith $d_2=x_2-{\\mathop{\\mbox{med}}}(Y)$ and $s_2 = w_2 - {\\mathop{\\mbox{med}}}(Y)$. \nIn this example ${\\text{AO}}(x_1) > {\\text{AO}}(x_2)$.\\\\\n\n\n\\begin{figure}[!htb]\n\\begin{center}\n\\unitlength=0.75mm \\thicklines\n\\begin{picture}(170,50)\n\\put(5.00,20.00){\\line(0,1){20.00}}\n\\put(5.00,30.00){\\line(1,0){30.00}}\n\\put(35.00,20.00){\\line(1,0){40.00}}\n\\put(35.00,20.00){\\line(0,1){20.00}}\n\\put(35.00,40.00){\\line(1,0){40.00}}\n\\put(75.00,20.00){\\line(0,1){20.00}}\n\\put(75.00,30.00){\\line(1,0){70.00}}\n\\put(145.00,20.00){\\line(0,1){20.00}}\n\\put(50.00,20.00){\\line(0,1){20.00}}\n\\put(0,30.00){\\circle*{2}}\n\\put(5,30.00){\\circle*{2}}\n\\put(100,30){\\circle*{2}}\n\\put(160,30.00){\\circle*{2}}\n\\put(145,30.00){\\circle*{2}}\n\\put(3.00,25.00){\\makebox(0,0)[rr]{$x_1$}}\n\\put(103.00,25.00){\\makebox(0,0)[rr]{$x_2$}}\n\\put(8.00,44.00){\\makebox(0,0)[rr]{$w_1$}}\n\\put(147.00,44.00){\\makebox(0,0)[rr]{$w_2$}}\n\\put(25.00,16.00){\\makebox(0,0)[rr]{$d_1$}}\n\\put(77.00,16.00){\\makebox(0,0)[rr]{$d_2$}}\n\\put(25.00,5.00){\\makebox(0,0)[rr]{$s_1$}}\n\\put(100.00,5.00){\\makebox(0,0)[rr]{$s_2$}}\n\\put(54.00,44.00){\\makebox(0,0)[rr]{${\\mathop{\\mbox{med}}}$}}\n\\put(38.00,44.00){\\makebox(0,0)[rr]{$Q_1$}}\n\\put(77.00,44.00){\\makebox(0,0)[rr]{$Q_3$}}\n\n\\put(10.00,8.00){\\vector(1,0){40}}\n\\put(10.00,8.00){\\vector(-1,0){5}}\n\\put(55.00,8.00){\\vector(1,0){90}}\n\\put(55.00,8.00){\\vector(-1,0){4}}\n\\put(5.00,13.00){\\vector(1,0){45}}\n\\put(5.00,13.00){\\vector(-1,0){5}}\n\\put(55.00,13.00){\\vector(1,0){45}}\n\\put(55.00,13.00){\\vector(-1,0){4}}\n\\end{picture}\n\\end{center}\n\\vspace{-0.5cm}\n\\caption{Adjusted outlyingness based on the adjusted boxplot.}\n\\label{fig:adjBox}\n\\end{figure}\n\nFormally, the univariate adjusted outlyingness AO of a point $x$ \nrelative to a sample $Y$ is given by:\n\n\n", "index": 21, "text": "\\begin{equation}\\label{eq:adjOut_univ}\n\\mbox{AO}(x;Y)=\n  \\left\\{\n\t\\begin{array}{ll}\n\t\t\\frac{x-\\text{med}(Y)}{w_2(Y) - \\text{med}(Y)}\n\t\t      & \\;\\; \\mbox{ if } x > {\\mathop{\\mbox{med}}}(Y) \\\\\n\t\t\\frac{\\text{med}(Y) - x}{\\text{med}(Y) -  w_1(Y)}\n\t\t      & \\;\\; \\mbox{ if } x < {\\mathop{\\mbox{med}}}(Y) \\;\\;.\n\t\\end{array} \n  \\right. \n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m1\" class=\"ltx_Math\" alttext=\"\\mbox{AO}(x;Y)=\\left\\{\\begin{array}[]{ll}\\frac{x-\\text{med}(Y)}{w_{2}(Y)-\\text%&#10;{med}(Y)}&amp;\\;\\;\\mbox{ if }x&gt;{\\mathop{\\mbox{med}}}(Y)\\\\&#10;\\frac{\\text{med}(Y)-x}{\\text{med}(Y)-w_{1}(Y)}&amp;\\;\\;\\mbox{ if }x&lt;{\\mathop{\\mbox%&#10;{med}}}(Y)\\;\\;.\\end{array}\\right.\" display=\"block\"><mrow><mrow><mtext>AO</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>;</mo><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo>{</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mfrac><mrow><mi>x</mi><mo>-</mo><mrow><mtext>med</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mrow><mrow><msub><mi>w</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mtext>med</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mfrac></mtd><mtd columnalign=\"left\"><mrow><mrow><mpadded lspace=\"5.6pt\" width=\"+5.6pt\"><mtext>\u00a0if\u00a0</mtext></mpadded><mo>\u2062</mo><mi>x</mi></mrow><mo>&gt;</mo><mrow><mtext>med</mtext><mrow><mo stretchy=\"false\">(</mo><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mfrac><mrow><mrow><mtext>med</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mi>x</mi></mrow><mrow><mrow><mtext>med</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><msub><mi>w</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mfrac></mtd><mtd columnalign=\"left\"><mrow><mrow><mrow><mpadded lspace=\"5.6pt\" width=\"+5.6pt\"><mtext>\u00a0if\u00a0</mtext></mpadded><mo>\u2062</mo><mi>x</mi></mrow><mo>&lt;</mo><mrow><mtext>med</mtext><mrow><mo stretchy=\"false\">(</mo><mi>Y</mi><mo rspace=\"8.1pt\" stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></mtd></mtr></mtable><mi/></mrow></mrow></math>", "type": "latex"}, {"file": "1601.08133.tex", "nexttext": "\n\n\n\n\n\n\n\n\n\n\n\n\n\nThis definition is based on the principle that a multivariate point \nis outlying with respect to a dataset if it is outlying in at least \none direction of the multivariate space. \nNote that this outlying direction does not have to correspond to \none of the coordinate axes. \n\nTo compute the multivariate AO we have to rely on approximate \nalgorithms, as it is impossible to consider the projections on \n{\\it all} directions $v$ in $p$-dimensional space. \n\\cite{Hubert:OutlierSkewed} suggest using $250p$ directions. \nA possible procedure to generate a direction is to randomly\ndraw $p$ data points, compute the hyperplane passing through\nthem, and then to take the direction orthogonal to it.\nThis approach guarantees that the multivariate AO is affine \ninvariant. This means that the AO does not change when we add a\nconstant vector to the data, or multiply the data by a \nnonsingular $p \\times p$ matrix.\n\n\n", "itemtype": "equation", "pos": 34687, "prevtext": "\n\nTo compute the AO of a $p$-dimensional point $x$ relative to \nan $n \\times p$ data matrix $Y$, the following projection \npursuit procedure is applied.\nThe point $x$ and all data points are projected on a direction $v$,\nand we compute the univariate AO of the projected point $x'v$\nrelative to the projected dataset $Yv$  as in \\eqref{eq:adjOut_univ}. \nThis is repeated for many directions $v$, and the multivariate AO \nis defined as the maximum over all corresponding univariate AO\u00e2\u0080\u0099s:\n\n", "index": 23, "text": "\\begin{equation}\\label{eq:adjOut}\n     \\mbox{AO}(x;Y)=\\sup_{||v||=1} \\; \\mbox{AO}(x'v;Yv) \\;\\;.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E10.m1\" class=\"ltx_Math\" alttext=\"\\mbox{AO}(x;Y)=\\sup_{||v||=1}\\;\\mbox{AO}(x^{\\prime}v;Yv)\\;\\;.\" display=\"block\"><mrow><mrow><mrow><mtext>AO</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>;</mo><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mpadded width=\"+2.8pt\"><munder><mo movablelimits=\"false\">sup</mo><mrow><mrow><mo fence=\"true\" maxsize=\"142%\" minsize=\"142%\">||</mo><mi>v</mi><mo fence=\"true\" maxsize=\"142%\" minsize=\"142%\">||</mo></mrow><mo>=</mo><mn>1</mn></mrow></munder></mpadded><mo>\u2061</mo><mrow><mtext>AO</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mi>x</mi><mo>\u2032</mo></msup><mo>\u2062</mo><mi>v</mi></mrow><mo>;</mo><mrow><mi>Y</mi><mo>\u2062</mo><mi>v</mi></mrow><mo rspace=\"8.1pt\" stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}]