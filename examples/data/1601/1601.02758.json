[{"file": "1601.02758.tex", "nexttext": "\nand the gluing map\n\n", "itemtype": "equation", "pos": 15797, "prevtext": "\n\n\\title{A flop formula for Donaldson-Thomas invariants}\n\n\\author[Hua-Zhong Ke]{Hua-Zhong Ke}\n\\maketitle\n\n\\begin{center}\n\\emph{Department of Mathematics, Sun Yat-Sen University, Guangzhou,  510275, China}\n\\emph{kehuazh@mail.sysu.edu.cn}\n\\end{center}\n\n{\\bf Abstract:} Let $X$ and $X'$ be nonsingular projective $3$-folds related by a flop of a disjoint union of $(-2)$-curves. We prove a flop formula relating the Donaldson-Thomas invariants of $X$ to those of $X'$, which implies some simple relations among BPS state counts. As an application, we show that if $X$ satisfies the GW/DT correspondence for primary insertions and descendants of the point class, then so does $X'$. We also propose a conjectural flop formula for general flops.\n\n{\\bf Keywords:} \nDonaldson-Thomas,\nflop,\n$(-2)$-curve,\nBPS state counts,\nGW/DT corrrespondence\n\n\n\n{\\bf MR(2010) Subject Classification:} 14N35\n\n\n\\date{\\today}\n\n\\tableofcontents\n\n\n\n\\section{Introduction}\n\nThe Donaldson-Thomas theory of a nonsingular projective $3$-fold $X$ counts the number of stable sheaves on $X$ \\cite{DT,Th}. In particular, when considering ideal sheaves of curves, the theory gives virtual numbers of embedded curves in $X$. Another curve counting theory on $X$ is the much studied Gromov-Witten theory, which essentially counts stable maps from curves with marked points to $X$. In \\cite{MNOP1,MNOP2}, Maulik, Nekrasov, Okounkov, and Pandharipande proposed a remarkable conjecture that the Gromov-Witten theory of $X$ is equivalent to the Donaldson-Thomas theory of $X$ in a subtle way. This suggests that many phenomenon in one theory have counter parts in the other theory.\n\nThe above mentioned curve counting theories are deformation invariant. A fundamental problem in Gromov-Witten theory is to investigate the transformation of Gromov-Witten invariants under birational surgeries \\cite{Ru}. The first breakthrough is the work of Li and Ruan \\cite{LR}, who showed that, for $3$-folds, the primary Gromov-Witten theories are invariant under general flops. It is also important to study the effect of biraional surgeries on Donaldson-Thomas theory. Hu and Li \\cite{HL} used the degeneration formula to understand the change of Donaldson-Thomas invariants under flops of a disjoint union of $(-1,-1)$ curves which are all numerally equivalent. For general flops between Calabi-Yau $3$-folds, Toda \\cite{T2} used the categorical method to established a flop formula (see also \\cite{Ca}). \n\nIn this paper, we prove a flop formula in Donaldson-Thomas theory for flops of a disjoint union $(-2)$-curves, and derive some interesting relations on BPS state counts. As an application, we give positive evidence for the conjectural GW/DT correspondence. Here an embedded curve in a $3$-fold is a $(-2)$-curve \\cite{Re} if it is a nonsingular rational curve with normal bundle of type $(-1,-1)$ or $(0,-2)$. Our flop formula generalizes the result of Hu and Li \\cite{HL}, since a $(-1,-1)$-curve is a $(-2)$-curve, and we do not assume that the curves are numerically equivalent.\n\n\n\n\nThroughout this paper, let $X$ and $X'$ be nonsingular projective $3$-folds over ${\\mathbb C}$, which are related by a flop $f:X\\dashrightarrow X'$ of some contraction \\cite{Ko}. Then $f$ is a birational map, and it is biregular outside of a subvariety of codimension two in $X$, called the center of $f$. The center of $f$ is a disjoint union of trees of rational curves, and it has a neighborhood with trivial canonial bundle. We have a natural isomorphism of groups\n\\begin{eqnarray*}\n{\\mathcal F}:H_2(X,{\\mathbb Z})\\xrightarrow{\\cong} H_2(X',{\\mathbb Z}),\n\\end{eqnarray*}\ndefined as follows. For any $\\beta\\in H_2(X,{\\mathbb Z})$, we can choose a real $2$-dimensional pseudo-submanifold $\\Sigma$ representing $\\beta$ in $X$, which lies in the complement of the center of $f$. Now ${\\mathcal F}\\beta$ is represented by $f(\\Sigma)$ in $X'$, which lies in the complement of the center of $f^{-1}$. Similarly, by considering Poincar\\'e duals of classes of degree$\\geqslant3$, we also have an isomorphism\n\\begin{eqnarray*}\nH^{\\geqslant 3}(X,{\\mathbb Q})\\rightarrow H^{\\geqslant 3}(X',{\\mathbb Q}),\n\\end{eqnarray*}\nwhich can be extended to an isomorphism of cohomology groups\n\\begin{eqnarray*}\nH^{*}(X,{\\mathbb Q})\\xrightarrow{\\cong} H^{*}(X',{\\mathbb Q}),\n\\end{eqnarray*}\nby requiring this isomorphism to preserve the Poincar\\'e pairing. The isomorphism will also be denoted by ${\\mathcal F}$ by abuse of notation. Let $Cen(f)$ be the subgroup of $H_2(X,{\\mathbb Z})$ generated by the cycles of irreducible curves in the center of $f$. The main result of this paper is the following.\n\n\\begin{proposition}\\label{mainresult}\nLet $f$ be a flop of a disjoint union of $(-2)$-curves. Suppose that $\\gamma_1,\\cdots,\\gamma_m\\in H^{*}(X,{\\mathbb Q})(m\\geqslant 0)$ have supports away from the center of $f$, and $d_1,\\cdots,d_m\\in{\\mathbb Z}_{\\geqslant 0}$. Then we have\n\\begin{eqnarray}\n\\frac{{\\sum\\limits}_{\\beta\\in H_2(X,{\\mathbb Z})}v^\\beta Z'_{DT}(X;q|{\\prod\\limits}_{i=1}^m\\tilde\\tau_{d_i}(\\gamma_i))_\\beta}{{\\sum\\limits}_{\\beta\\in Cen(f)}v^{\\beta} Z'_{DT}(X;q|)_{\\beta}}&=&\\frac{{\\sum\\limits}_{\\beta\\in H_2(X,{\\mathbb Z})}v^\\beta Z'_{DT}(X';q|{\\prod\\limits}_{i=1}^m\\tilde\\tau_{d_i}({\\mathcal F}\\gamma_i))_{{\\mathcal F}\\beta}}{{\\sum\\limits}_{\\beta\\in Cen(f)}v^{\\beta} Z'_{DT}(X';q|)_{{\\mathcal F}\\beta}},\\label{flop}\\\\\nZ'_{DT}(X;q|)_\\beta&=&Z'_{DT}(X';q|)_{-{\\mathcal F}\\beta},\\qquad\\forall\\beta\\in Cen(f).\\label{center}\n\\end{eqnarray}\n\\end{proposition}\n\\begin{remark}\nWe remark that we can choose the support of $\\gamma_i$ away from the center of $f$ if deg$\\gamma_i>2$.\n\\end{remark}\n\nWe sketch the proof of Proposition \\ref{mainresult}, the detail of which will be given in Section 3. By a beautiful result of Reid \\cite{Re}, we can decompose the flop $f$ of $(-2)$-curves into a sequence of blow-ups of $(-2)$-curves followed by a sequence of blow-downs. Since blow-ups can be described in terms of semi-stable degenerations, it follows that we can use the degeneration formula \\cite{LW} and the absolute/relative correspondence \\cite{HLR,MP} to relate invariants of $X$ to those of the blow-up of $X$ (see \\eqref{X}). Therefore, in principle, the Donaldson-Thomas invariants of $X$ can be related to those of $X'$. Due to the denominators in \\eqref{flop}, we need to understand the transformation of the invariants attached to classes in $Cen(f)$ under blow-ups. To this end, we give a detailed analysis of the change of effectiveness of classes in $Cen(f)$ under blow-up (see Lemma \\ref{1stlemma} and \\ref{2ndlemma}).\n\nProposition \\ref{mainresult} relates the Donaldson-Thomas invariants of $X$ to those of $X'$ in a nontrivial way. In \\cite{HHKQ} and \\cite{Ke}, we obtained some blow-up formulae for Gromov-Witten and stable pair theories which contain some extra factors, and we discovered that these formulae imply some interesting relation among BPS state counts. In this paper, we consider the change of BPS state counts of Donaldson-Thomas theory under flops. Proposition \\ref{mainresult} implies the following simple flop formulae for BPS state counts.\n\\begin{corollary}\\label{BPS}\nLet $f$ be a flop of a disjoint union of $(-2)$-curves. Suppose that $\\gamma_1,\\cdots,\\gamma_m\\in H^*(X,{\\mathbb Q})(m\\geqslant0)$, and $g\\in{\\mathbb Z}$. Then we have\n\\begin{eqnarray}\n&&n_{g,\\beta}^X(\\gamma_1,\\cdots,\\gamma_m)=n_{g,{\\mathcal F}\\beta}^{X'}({\\mathcal F}\\gamma^1,\\cdots,{\\mathcal F}\\gamma_m),\\quad\\forall\\beta\\in H_2(X,{\\mathbb Z})\\setminus Cen(f);\\label{BPSflop}\\\\\n&&n_{g,\\beta}^X=n_{g,-{\\mathcal F}\\beta}^{X'},\\quad\\forall\\beta\\in Cen(f)\\setminus\\{0\\}.\\label{BPScenter}\n\\end{eqnarray}\n\\end{corollary}\nThe Donaldson-Thomas theory of X counts embedded curves on X only in a virtual sense. A fundamental problem in the Donaldson-Thomas theory is to understand the hidden enumerative meanings of the invariants. It is conjectured that BPS state counts are enumerative. It is interesting to understand Corollary \\ref{BPS} from the point of view of enumerative geometry. \n\nAs another application, we investigate the conjectural GW/DT correspondence. In the primary case, the correspondence is established for several classes of $3$-folds, including toric $3$-folds \\cite{MOOP}, and Calabi-Yau $3$-folds which are complete intersections in products of projective spaces \\cite{PP,T1}. However, in the descendent case, not much is known. The following result gives further positive evidence to the MNOP conjecture.\n\n\\begin{corollary}\\label{GWDT}\nLet $f$ be a flop of a disjoint union of $(-2)$-curves. Assume that $X$ satisfies the GW/DT correspondence for primary insertions and descendants of the point class. Then so does $X'$.\n\\end{corollary}\n\nWe observe that Toda's flop formulae (Theorem 1.2 in \\cite{T2}) are analogous to Proposition \\ref{mainresult}, and we can check that Corollary \\ref{BPS} and \\ref{GWDT} also hold for general flops between Calabi-Yau $3$-folds. Based on the established flop formulae of \\cite{HL}, \\cite{T2} and ours, we propose the following conjecture.\n\n\\begin{conjecture}\\label{conj}\nThe formulae \\eqref{flop} and \\eqref{center} hold for general flops.\n\\end{conjecture}\n\nWe expect that the degeneration formula will play a role in the proof of the conjecture. Note that an embedded nonsingular rational curve in a $3$-fold is locally floppable only if it has normal bundle of type $(-1,-1),(0,-2)$ or $(1,-3)$ \\cite{La}. However, unlike the case of $(-2)$-curves, it is difficult to describe a general flop of $(1,-3)$-curves in terms of blow-ups and blow-downs (see \\cite{Pi} for some explicit examples).\n\nMost of the results obtained in this paper also hold in the stable pair theory \\cite{PT}, since the behavior of stable pair invariants under degeneration is similar to that of Donaldson-Thomas theory. We also have corresponding corollaries on BPS state counts and GW/P correspondence, and conjectural flop formulae for general flops in the stable pair theory. \n\n\n\nAn outline of this paper is as follows. In Section 2, we review some basic materials on Donaldson-Thomas invariants. In Section 3, we recall Reid's result  to decompose the flop under consideration into a sequence of blow-ups followed by a sequence of blow-downs, and use the degeneration formula to prove Proposition \\ref{mainresult}. In Section 4, we give a working definition of the BPS state counts for Donaldson-Thomas theory and prove Corollary \\ref{BPS}. In Section 5, we review the conjectural GW/DT corespondence and prove Corollary \\ref{GWDT}.\n\n\n\n\n\\section{Preliminaries on Donaldson-Thomas invariants}\nIn this section, we briefly review some basic materials on Donaldson-Thomas invariants and fix notations.  We refer readers to \\cite{DT, LW, MNOP1,MNOP2, Th} for details.\n\nDonaldson-Thomas theory is defined via integration over the moduli space of ideal sheaves of $X$. Here an ideal sheaf is a torsion-free sheaf of rank $1$ with trivial determinant. Each ideal sheaf ${\\mathscr I}$ determines a subscheme $Y\\subset X$ via the exact sequence\n\\begin{eqnarray*}\n0\\rightarrow{\\mathscr I}\\rightarrow{\\mathcal O}_X\\rightarrow{\\mathcal O}_Y\\rightarrow 0.\n\\end{eqnarray*}\nIn this note, we will consider only the case dim$Y\\leqslant1$. The one dimensional components of $Y$ (weighted by their intrinsic multiplicities) determine an element,\n\\begin{eqnarray*}\n[Y]\\in H_2(X,{\\mathbb Z}).\n\\end{eqnarray*}\nFor $n\\in{\\mathbb Z}$ and $\\beta\\in H_2(X,{\\mathbb Z})$, let $I_n(X,\\beta)$ be the moduli space of ideal sheaves ${\\mathscr I}$ satisfying \n\\begin{eqnarray*}\n\\chi({\\mathcal O}_Y)=n,\\quad [Y]=\\beta,\n\\end{eqnarray*}\nwhere $\\chi$ is the holomorphic Euler characteristic. From the deformation theory, $I_n(X,\\beta)$ carries a virtual fundamental class of degree $\\int_\\beta c_1(X)$.\n\nFor $d\\in{\\mathbb Z}_{\\geqslant 0}$ and $\\gamma\\in H^*(X,{\\mathbb Q})$, the descendant insertion $\\tilde\\tau_d(\\gamma)$ is defined as follows. Let \n\\begin{eqnarray*}\n\\pi_X:X\\times I_n(X,\\beta)&\\rightarrow&X,\\\\\n\\pi_I:X\\times I_n(X,\\beta)&\\rightarrow&I_n(X,\\beta)\n\\end{eqnarray*}\nbe tautological projections. Let ${\\mathcal I}$ be the universal sheaf over $X\\times I_n(X,\\beta)$. The operation\n\\begin{eqnarray*}\n(-1)^{d+1}\\pi_{I*}\\bigg(\\pi_X^*(\\gamma)\\cdot\\textrm{ch}_{2+d}({\\mathcal I})\\cap\\pi_I^*(\\cdot)\\bigg):H_*(I_n(X,\\beta),{\\mathbb Q})\\rightarrow H_*(I_n(X,\\beta),{\\mathbb Q})\n\\end{eqnarray*}\nis the action of $\\tilde\\tau_d(\\gamma)$. The Donaldson-Thomas invariants with descendant insertions are defined as the virtual integration\n\\begin{eqnarray*}\n{\\langle}\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\gamma_i){\\rangle}_{n,\\beta}&=&\\int_{[I_n(X,\\beta)]^{vir}}\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\gamma_i),\n\\end{eqnarray*}\nwhere $d_1\\cdots,d_m\\in{\\mathbb Z}_{\\geqslant 0}$, and $\\gamma_1,\\cdots,\\gamma_m\\in H^*(X,{\\mathbb Q})$. Here the integral is the push-forward to a point of the class\n\\begin{eqnarray*}\n\\tilde\\tau_{d_i}(\\gamma_i)\\circ\\cdots\\tilde\\tau_{d_m}(\\gamma_m)([I_n(X,\\beta)]^{vir}).\n\\end{eqnarray*}\nThe partition function of the Donaldson-Thomas invariants is defined by\n\\begin{eqnarray*}\nZ_{DT}\\bigg(X;q|\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\gamma_i)\\bigg)_\\beta=\\sum\\limits_{n\\in{\\mathbb Z}}{\\langle}\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\gamma_i){\\rangle}_{n,\\beta}q^n,\n\\end{eqnarray*}\nand the reduced partition function is obtained by formally removing the degree zero contributions,\n\\begin{eqnarray*}\nZ'_{DT}\\bigg(X;q|\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\gamma_i)\\bigg)_\\beta=\\frac{Z_{DT}\\bigg(X;q|\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\gamma_i)\\bigg)_\\beta}{Z_{DT}\\bigg(X;q|\\bigg)_0}.\n\\end{eqnarray*}\n\n\nLet $S\\subset X$ be a nonsingular divisor. For $n\\in{\\mathbb Z}$ and nonzero $\\beta\\in H_2(X,{\\mathbb Z})$ with $\\int_\\beta[S]\\geqslant 0$, let $I_n(X/S,\\beta)$ be the moduli space of relative ideal sheaves, which carries a virtual fundamental class of degree $\\int_\\beta c_1(X)$. We have the following natural morphism\n\\begin{eqnarray*}\n\\epsilon:I_n(X/S,\\beta)\\rightarrow\\textrm{Hilb}(S,\\int_\\beta[S])\n\\end{eqnarray*}\nThe pull-back of cohomology classes of Hilb$(S,\\int_\\beta[S])$ gives relative insertions. \n\nLet us briefly recall Nakajima basis for the cohomology of Hilbert schemes of points of $S$. Let $\\{\\delta_i\\}$ be a basis of $H^*(S,{\\mathbb Q})$ with dual basis $\\{\\delta^i\\}$. For any cohomology weighted partition $\\eta$ with respect to the basis $\\{\\delta_i\\}$, Nakajima constructed a cohomology class $C_\\eta\\in H^*(\\textrm{Hilb}(S,|\\eta|),{\\mathbb Q})$. The Nakajima basis of  $H^*(\\textrm{Hilb}(S,d),{\\mathbb Q})$ is the set $\\{C_\\eta\\}_{|\\eta|=d}$. We refer readers to \\cite{Na} for more details.\n\nThe partition function of the relative Donaldson-Thomas invariants is defined by\n\\begin{eqnarray*}\nZ_{DT}\\bigg(X/S;q|\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\gamma_i)|\\eta\\bigg)_\\beta=\\sum\\limits_{n\\in{\\mathbb Z}}q^n\\int_{[I_n(X/S,\\beta)]^{vir}}\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\gamma_i)\\cdot\\epsilon^*C_\\eta,\n\\end{eqnarray*}\nand the reduced partition function is obtained by formally removing the degree zero contributions\n\\begin{eqnarray*}\nZ'_{DT}\\bigg(X/S;q|\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\gamma_i)|\\eta\\bigg)_\\beta=\\frac{Z_{DT}\\bigg(X/S;q|\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\gamma_i)|\\eta\\bigg)_\\beta}{Z_{DT}\\bigg(X/S;q||\\bigg)_0}\n\\end{eqnarray*} \n\nLet $\\Delta\\subset{\\mathbb C}$ be the unit disc, and let $\\pi : \\chi \\rightarrow\\Delta$ be a nonsingular $4$-fold over ${\\mathbb D}$, such that $\\chi_t = \\pi^{-1}(t) \\cong X $ for $t\\not= 0$, and $\\chi_0$ is a union of two irreducible nonsingular projective $3$-folds $X_1$\nand $X_2$ intersecting transversally along a nonsingular projective surface $S$. (We can also consider the general case where the central fiber has several irreducible components, but we restrict ourselves to this simple case for simplicity of presentation.)  Consider the natural inclusion maps\n\n", "index": 1, "text": "$$\n  i_t: X=\\chi_t \\longrightarrow \\chi,\\,\\,\\,\\,\\,\\,\\,\\,\n  i_0:\\chi_0\\longrightarrow \\chi,\n$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"i_{t}:X=\\chi_{t}\\longrightarrow\\chi,\\,\\,\\,\\,\\,\\,\\,\\,i_{0}:\\chi_{0}%&#10;\\longrightarrow\\chi,\" display=\"block\"><mrow><msub><mi>i</mi><mi>t</mi></msub><mo>:</mo><mi>X</mi><mo>=</mo><msub><mi>\u03c7</mi><mi>t</mi></msub><mo>\u27f6</mo><mi>\u03c7</mi><mo rspace=\"16.1pt\">,</mo><msub><mi>i</mi><mn>0</mn></msub><mo>:</mo><msub><mi>\u03c7</mi><mn>0</mn></msub><mo>\u27f6</mo><mi>\u03c7</mi><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02758.tex", "nexttext": "\nWe have\n\n", "itemtype": "equation", "pos": 15910, "prevtext": "\nand the gluing map\n\n", "index": 3, "text": "$$\n  g= (j_1,j_2) : X_1\\coprod X_2\\longrightarrow \\chi_0.\n$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"g=(j_{1},j_{2}):X_{1}\\coprod X_{2}\\longrightarrow\\chi_{0}.\" display=\"block\"><mrow><mrow><mrow><mi>g</mi><mo>=</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>j</mi><mn>1</mn></msub><mo>,</mo><msub><mi>j</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>:</mo><mrow><mrow><msub><mi>X</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2210</mo><msub><mi>X</mi><mn>2</mn></msub></mrow></mrow><mo>\u27f6</mo><msub><mi>\u03c7</mi><mn>0</mn></msub></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02758.tex", "nexttext": "\nwhere $i_{0*}$ is an isomorphism since there exists a deformation retract from $\\chi$ to $\\chi_0$(see \\cite{Cl}). Also, since the family $\\chi\\rightarrow{\\mathbb A}^1$ comes from a trivial family, it follows that each $\\gamma\\in H^*(X,{\\mathbb Q}) $ has\nglobal liftings such that the restriction $\\gamma(t)$ on $\\chi_t$ is defined for all $t$.\n\nThe degeneration formula for the Donaldson-Thomas theory expresses the absolute invariants of $X$ via the relative invariants of $(X_1,S)$ and $(X_2,S)$:\n\\begin{eqnarray*}\n&&Z'_{DT}\\bigg(X;q|\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\gamma_i)\\bigg)_\\beta\\\\\n&=&\\sum Z'_{DT}\\bigg(X_1/S;q|\\prod\\limits_{i\\in P_1}\\tilde\\tau_{d_i}(j_1^*\\gamma_i(0))|\\eta\\bigg)_{\\beta_1}\\cdot\\frac{(-1)^{|\\eta|-\\ell(\\eta)}{\\mathfrak z}(\\eta)}{q^{|\\eta|}}\\cdot Z'_{DT}\\bigg(X_2/S;q|\\prod\\limits_{i\\in P_2}\\tilde\\tau_{d_i}(j_2^*\\gamma_i(0))|\\eta^\\vee\\bigg)_{\\beta_2},\n\\end{eqnarray*}\nwhere ${\\mathfrak z}(\\eta)=|\\textrm{Aut}(\\eta)|\\cdot\\prod\\limits_{i=1}^{\\ell(\\eta)}\\eta_i$, $\\eta^\\vee$ is defined by taking the Poincar\\'e duals of the cohomology weights of $\\eta$, and the sum is over cohomology weighted partitions $\\eta$, degree splittings $i_{t*}\\beta=i_{0*}(j_{1*}\\beta_1+j_{2*}\\beta_2)$, and marking partitions $P_1\\coprod P_2=\\{1,\\cdots,m\\}$. In particular, if $(\\eta,\\beta_1,\\beta_2)$ has nontrivial contribution in the degeneration formula, then we have the following dimension constraint:\n\\begin{eqnarray*}\nv\\textrm{dim}_{\\mathbb C} P_n(X_1/S,\\beta_1)+v\\textrm{dim}_{\\mathbb C} P_n(X_2/S,\\beta_2)=v\\textrm{dim}_{\\mathbb C} P_n(X,\\beta)+2|\\eta|.\n\\end{eqnarray*}\n\n\n\n\\section{Proof of main result}\n\nIn this section, we give a detailed proof o Proposition \\ref{mainresult}. We first recall Reid's result to decompose a flop of a disjoint union of  $(-2)$-curves into a sequence of blow-ups followed by a sequence of blow-downs, and then use the degeneration formula to prove our flop formula. We refer readers to \\cite{Re} for explicit local description of the flop of a single $(-2)$-curve, and to \\cite{Ko, KM} for general materials on birational geometry of $3$-folds.\n\nLet $C_{1},\\cdots,C_{l}$ be the irreducible components of the center of $f$. We can contract these curves to obtain a contraction $\\psi:X\\rightarrow\\bar X$, and then these curves generate an extremal face in $NE(X)$. The width of $C_{i}$ in $X$ is defined by Reid as follows \\cite{Re}:\n\\begin{eqnarray*}\nw_{i}&:=&width(C_{i}\\subset X)\\\\\n&:=&\\sup\\{k|\\textrm{ there exists  a scheme }S\\cong C_{i}\\times\\textrm{Spec}({\\mathbb C}[\\epsilon]/\\epsilon^k)\\textrm{ such that }C_{i}\\subset S\\subset X\\}.\n\\end{eqnarray*}\nSince $C_{i}$ is isolated, it follows that $1\\leqslant w_{i}<\\infty$. Note that $\\psi(C_{i})\\in\\bar X$ is a hypersurface singularity given by\n\\begin{eqnarray*}\nx^2+y^2+z^2+t^{2w_{i}}=0.\n\\end{eqnarray*}\nIn particular, $C_{i}$ is a $(-1,-1)$-curve if and only if $w_{i}=1$.\n\nWithout loss of generality, assume that \n\\begin{eqnarray*}\nw_{1}\\geqslant\\cdots\\geqslant w_{l}\\geqslant 1.\n\\end{eqnarray*}\nLet $w=w_{1}$, and for $d=1,\\cdots,w$, set\n\\begin{eqnarray*}\nk_d:=\\sup\\{i|w_{i}\\geqslant d\\}.\n\\end{eqnarray*}\nThen \n\\begin{eqnarray*}\n1\\leqslant k_w\\leqslant\\cdots\\leqslant k_1=l.\n\\end{eqnarray*}\n\n\nWrite $X=X_0$ and $C_i=C_{0,i}$. Then proceeding inductively, we obtain a sequence of blow-ups:\n\\begin{eqnarray*}\nX_w\\xrightarrow{\\phi_{w-1}}X_{w-1}\\xrightarrow{\\phi_{w-2}}\\cdots\\xrightarrow{\\phi_1}X_1\\xrightarrow{\\phi_0}X_0. \n\\end{eqnarray*}\nHere for $d=0,1,\\cdots,w-2$, $\\phi_d$ is the blow-up of $X_{d}$ along the $(-2)$-curves $C_{d,1},\\cdots,C_{d,k_{d+1}}$. Let\n\\begin{eqnarray*}\nE_{d+1,i}:=\\phi_d^{-1}(C_{d,i})\\cong\\left\\{\\begin{array}{cl}{\\mathbb F}_2,&i=1,\\cdots,k_{d+2},\\\\{\\mathbb F}_0,&i=k_{d+1}+1,\\cdots,k_{d+1}.\\end{array}\\right.\n\\end{eqnarray*}\nFor $i=1,\\cdots,k_{d+2}$, $C_{d+1,i}\\subset E_{d+1,i}$ is the unique nonsingular rational curve with negative self intersection number, which is also a $(-2)$-curve in $X_{d+1}$ with\n\\begin{eqnarray*}\nwidth(C_{d+1,i}\\subset X_{d+1})=w_{i}-d-1,\\quad d=1,\\cdots,w-2.\n\\end{eqnarray*}\nMoreover, $\\phi_{w-1}$ is the blow-up of $X_{w-1}$ along the $(-1,-1)$-curves $C_{w-1,1},\\cdots,C_{w-1,k_{w}}$, and\n\\begin{eqnarray*}\nE_{w,i}:=\\phi_{w-1}^{-1}(C_{w-1,i})\\cong{\\mathbb F}_0,\\quad i=1,\\cdots,k_w.\n\\end{eqnarray*}\n\nFor $d=1,\\cdots,w-1$ and $i=1,\\cdots,k_{d+1}$, the strict transform of $E_{d,i}$ under $\\phi_d$, denoted by $\\tilde E_{d,i}$, is isomorphic to $E_{d,i}$. Moreover, $\\tilde E_{d,i}\\cap E_{d+1,i}$ is a nonsingular rational curve, which has negative self intersection number on $\\tilde E_{d,i}$, and self intersection number $2$ on $E_{d+1,i}$. In particular, $\\tilde E_{w-1,i}\\cap E_{w,i}$ is a $(1,1)$-curve on $E_{w,i}\\cong{\\mathbb F}_0$. Note that $\\tilde E_{d,i}$ is not affected by blow-ups $\\phi_{d+1},\\cdots,\\phi_{w-1}$, and can be viewed as an embedded surface in $X_w$. For $d=1,\\cdots,w-1$ and $i=k_{d+1}+1,\\cdots,k_{d}$, $E_{d,i}$ is not affected by blow-ups $\\phi_d,\\cdots,\\phi_{w-1}$, and can be viewed as an embedded surface in $X_w$. \n\n\nWrite $E_{w,i}=E'_{w,i}$. Since each $E'_{w,i}\\cong{\\mathbb F}_0$ has a ruling not contracted by $\\phi_{w-1}$, it follows that we can blow down $X_w$ along these rulings for all $i$ simultaneously to obtain $\\phi'_{w-1}:X_w\\rightarrow X'_{w-1}$. \nProceeding inductively, we also have a sequence of blow-downs:\n\\begin{eqnarray*}\nX_w\\xrightarrow{\\phi'_{w-1}}X'_{w-1}\\xrightarrow{\\phi'_{w-2}}\\cdots\\xrightarrow{\\phi'_1}X'_1\\xrightarrow{\\phi'_0}X'_0. \n\\end{eqnarray*}\nFor $d=0,1,\\cdots,w-2$, let\n\\begin{eqnarray*}\nC'_{w-1-d,i}:=\\phi'_{w-1-d}(E'_{w-d,i}),\\quad i=1,\\cdots,k_{w-d}\n\\end{eqnarray*}\nand \n\\begin{eqnarray*}\nE'_{w-1-d,i}=\\left\\{\\begin{array}{cl}\\phi'_{w-1-d}\\circ\\cdots\\circ\\phi'_{w-1}(\\tilde E_{w-1-d,i})\\cong{\\mathbb F}_2,&i=1,\\cdots,k_{w-d},\\\\\\phi'_{w-1-d}\\circ\\cdots\\circ\\phi'_{w-1}(E_{w-1-d,i})\\cong{\\mathbb F}_0&i=k_{w-d}+1,\\cdots,k_{w-1-d}.\\end{array}\\right.\n\\end{eqnarray*}\nThen $C'_{w-1-d,i}$ is a $(-2)$-curve in $X'_{w-1-d}$ with\n\\begin{eqnarray*}\nwidth(C'_{w-1-d,i}\\subset X'_{w-1-d})=w_i-w+1+d,\n\\end{eqnarray*}\nand $C'_{w-1-d,i}\\subset E'_{w-1-d,i}$ is the unique nonsingular rational curve with negative self intersection number.  Since for $i=1,\\cdots,k_{w-d}$, each $E'_{w-1-d,i}\\cong{\\mathbb P}_{C'_{w-1-d,i}}({\\mathcal O}\\oplus{\\mathcal O}(-2))$ has a fiber ruling, and for $i=k_{w-d}+1,\\cdots,k_{w-1-d}$, each $E_{w-1-d,i}$ has a ruling not contracted by $\\phi_{w-1-d}$, it follows that we can blow down $X'_{w-1-d}$ along these rulings simultaneously to obtain $\\phi'_{w-2-d}:X'_{w-1-d}\\rightarrow X'_{w-2-d}$.\n\nNow for $d=0,1,\\cdots,w-1$, the birational map\n\\begin{eqnarray*}\nf_d:=\\phi'_d\\circ\\cdots\\circ\\phi'_{w-1}\\circ\\phi^{-1}_{w-1}\\circ\\cdots\\circ\\phi^{-1}_d:X_d\\dashrightarrow X'_d\n\\end{eqnarray*} \nis a flop of $(-2)$-curves $C_{d,1},\\cdots,C_{d,k_{d+1}}$, where $C_{d,i}$ is flopped to $C'_{d,i}$. In particular, we have $X'=X'_0$ and $f=f_0$.\n\n\nDegenerate $X$ along $C_1,\\cdots,C_l$ simultaneously, and we have\n\\begin{eqnarray*}\n&&Z'_{DT}\\bigg(X;q|\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\gamma_i)\\bigg)_\\beta\\\\\n&=&\\sum Z'_{DT}\\bigg(X_1/E_1;q|\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\phi_0^*\\gamma_i)|\\eta_1^\\vee,\\cdots,\\eta_l^\\vee\\bigg)_{\\tilde\\beta}{\\prod\\limits}_{i=1}^l\\frac{(-1)^{|\\eta_i|-\\ell(\\eta_i)}{\\mathfrak z}(\\eta_i)}{q^{|\\eta_i|}}Z'_{DT}({\\mathbb P}_i/D_i;q||\\eta_i)_{\\beta_i},\n\\end{eqnarray*}\nwhere we have assumed that the support of $\\gamma_i$ is away from $\\bigcup\\limits_{i=1}^lC_i$, and \n\\begin{eqnarray*}\nE_1&:=&\\bigcup\\limits_{i=1}^lE_{1,i},\\\\\n{\\mathbb P}_i&:=&{\\mathbb P}_{C_i}(N_{C_i}\\oplus{\\mathcal O}_{C_i}),\\quad (N_{C_i}\\textrm{ is the normal bundle of }C_i\\textrm{ in }X)\\\\\nD_i&:=&{\\mathbb P}_{C_i}(N_{C_i}\\oplus\\{0\\}).\n\\end{eqnarray*}\nBy dimension constraint, we find that $\\eta_1=\\cdots=\\eta_l=\\emptyset$. So \n\\begin{eqnarray*}\n\\tilde\\beta\\cdot E_1=\\beta_i\\cdot D_i=0.\n\\end{eqnarray*}\nFor $\\tilde\\beta$, note that $\\phi_0$ induces a natural injection via 'pull-back' of $2$-cycles \n\\begin{eqnarray*}\n\\phi_1^!=PD_{X_1}\\circ\\phi_0^*\\circ PD_X:H_2(X,{\\mathbb Z})\\rightarrow H_2(X_1,{\\mathbb Z}),\n\\end{eqnarray*}\nwhere the image of $\\phi_0^!$ is the subset of $H_2(X_1,{\\mathbb Z})$ consisting of $2$-cycles having intersection number zero with $E_1$, and so we have\n$\\tilde\\beta\\in Im\\phi_0^!$. For $\\beta_i$, note that\n\\begin{eqnarray*}\nH_2({\\mathbb P}_i,{\\mathbb Z})={\\mathbb Z}[C_i]\\oplus{\\mathbb Z} f_i,\n\\end{eqnarray*}\nwhere we have used the identification $C_i\\cong{\\mathbb P}_{C_i}(\\{0\\}\\oplus{\\mathcal O}_{C_i})$, and $f_i$ is the class of a line in the fiber of ${\\mathbb P}_i$. So $\\beta_i\\cdot D_i=0$ implies that $\\beta_i\\in{\\mathbb Z}_{\\geqslant0}[C_i]$, since $\\beta_i$ is effective. Therefore\n\\begin{eqnarray*}\n&&Z'_{DT}\\bigg(X;q|\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\gamma_i)\\bigg)_\\beta\\\\\n&=&{\\sum\\limits}_{\\substack{\\beta'\\in H_2(X,{\\mathbb Z}),n_i\\in{\\mathbb Z}_{\\geqslant 0}\\\\\\beta'+n_1[C_1]+\\cdots n_l[C_l]=\\beta}} Z'_{DT}\\bigg(X_1/E_1;q|\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\phi_0^*\\gamma_i)|\\bigg)_{\\phi_0^!\\beta'}{\\prod\\limits}_{i=1}^lZ'_{DT}({\\mathbb P}_i/D_i;q||)_{n_i[C_i]}.\n\\end{eqnarray*}\nIn particular, since the irreducible curves in the center of $f$ generate an extremal face in $NE(X)$, it follows that for $\\beta\\in Cen(f)$, we have\n\\begin{eqnarray*}\nZ'_{DT}\\bigg(X;q|\\bigg)_{\\beta}={\\sum\\limits}_{\\substack{\\beta'+{\\sum\\limits}_{i=1}^ln_i[C_i]=\\beta\\\\\\beta'\\in Cen(f)}} Z'_{DT}\\bigg(X_1/E_1;q||\\bigg)_{\\phi_0^!\\beta'}{\\prod\\limits}_{i=1}^lZ'_{DT}({\\mathbb P}_i/D_i;q||)_{n_i[C_i]}.\n\\end{eqnarray*}\nTherefore we have obtained the following:\n\\begin{eqnarray}\n{\\sum\\limits}_{\\beta\\in H_2(X,{\\mathbb Z})}v^\\beta Z'_{DT}\\bigg(X;q|\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\gamma_i)\\bigg)_\\beta&=&{\\sum\\limits}_{\\beta\\in H_2(X,{\\mathbb Z})}v^\\beta Z'_{DT}\\bigg(X_1/E_1;q|\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\phi_0^*\\gamma_i)|\\bigg)_{\\phi_0^!\\beta}\\nonumber\\\\\n&&\\qquad\\cdot{\\prod\\limits}_{i=1}^l{\\sum\\limits}_{d\\geqslant 0}v^{d[C_i]}Z'_{DT}({\\mathbb P}_i/D_i;q||)_{d[C_i]},\\nonumber\\\\\n{\\sum\\limits}_{\\beta\\in Cen(f)}v^{\\beta}Z'_{DT}(X;q|)_{\\beta}&=&{\\sum\\limits}_{\\beta\\in Cen(f)}v^{\\beta}Z'_{DT}\\bigg(X_1/E_1;q||\\bigg)_{\\phi_0^!\\beta}\\cdot{\\prod\\limits}_{i=1}^l{\\sum\\limits}_{d\\geqslant 0}v^{d[C_i]}Z'_{DT}({\\mathbb P}_i/D_i;q||)_{d[C_i]},\\label{Xcenter}\n\\end{eqnarray}\nwhich implies that\n\\begin{eqnarray}\n\\frac{{\\sum\\limits}_{\\beta\\in H_2(X,{\\mathbb Z})}v^\\beta Z'_{DT}\\bigg(X;q|\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\gamma_i)\\bigg)_\\beta}{{\\sum\\limits}_{\\beta\\in Cen(f)}v^{\\beta}Z'_{DT}(X;q|)_{\\beta}}&=&\\frac{{\\sum\\limits}_{\\beta\\in H_2(X,{\\mathbb Z})}v^\\beta Z'_{DT}\\bigg(X_1/E_1;q|\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\phi_0^*\\gamma_i)|\\bigg)_{\\phi_0^!\\beta}}{{\\sum\\limits}_{\\beta\\in Cen(f)}v^{\\beta}Z'_{DT}\\bigg(X_1/E_1;q||\\bigg)_{\\phi_0^!\\beta}}.\\label{Xrel}\n\\end{eqnarray}\n\nNow degenerate $X_1$ along $E_{1,1},\\cdots,E_{1,l}$ simultaneously, and we obtain\n\\begin{eqnarray*}\n&&Z'_{DT}\\bigg(X_1;q|\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\phi_0^*\\gamma_i)\\bigg)_{\\phi_1^!\\beta}\\\\\n&=&\\sum Z'_{DT}\\bigg(X_1/E_1;q|\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\phi_0^*\\gamma_i)|\\eta_1^\\vee,\\cdots,\\eta_l^\\vee\\bigg)_{\\tilde\\beta}{\\prod\\limits}_{i=1}^l\\frac{(-1)^{|\\eta_i|-\\ell(\\eta_i)}{\\mathfrak z}(\\eta_i)}{q^{|\\eta_i|}}Z'_{DT}({\\mathbb P}_{1,i}/D_{1,i};q||\\eta_i)_{\\beta_i},\n\\end{eqnarray*}\nwhere\n\\begin{eqnarray*}\n{\\mathbb P}_{1,i}&:=&{\\mathbb P}_{E_{1,i}}(N_{E_{1,i}}\\oplus{\\mathcal O}_{E_{1,i}}),\\quad (N_{E_{1,i}}\\textrm{ is the normal bundle of }E_{1,i}\\textrm{ in }X_1)\\\\\nD_{1,i}&:=&{\\mathbb P}_{E_{1,i}}(N_{E_{1,i}}\\oplus\\{0\\}).\n\\end{eqnarray*}\nBy dimension constraint, we find that $\\eta_1=\\cdots=\\eta_l=\\emptyset$. So we have\n\\begin{eqnarray*}\n&&Z'_{DT}\\bigg(X_1;q|\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\phi_0^*\\gamma_i)\\bigg)_{\\phi_1^!\\beta}\\\\\n&=&{\\sum\\limits}_{\\substack{\\beta'\\in H_2(X,{\\mathbb Z}),\\beta_i\\in H_2({\\mathbb P}_{1,i},{\\mathbb Z})\\\\\\phi_0^!\\beta'+(\\pi_{1,1})_*\\beta_1+\\cdots+(\\pi_{1,l})_*\\beta_l=\\phi_0^!\\beta\\\\\\beta_i\\cdot E_{1,i}=\\beta_i\\cdot D_i=0}} Z'_{DT}\\bigg(X_1/E_1;q|\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\phi_0^*\\gamma_i)|\\bigg)_{\\phi_0^!\\beta'}{\\prod\\limits}_{i=1}^{l}Z'_{DT}({\\mathbb P}_{1,i}/D_{1,i};q||)_{\\beta_i},\n\\end{eqnarray*}\nwhere we have used the identification $E_{1,i}\\cong{\\mathbb P}_{E_{1,i}}(\\{0\\}\\oplus{\\mathcal O}_{E_{1,i}})$, and $\\pi_{1,i}$ is the composition\n\\begin{eqnarray*}\n{\\mathbb P}_{1,i}\\rightarrow E_{1,i}\\hookrightarrow X_1.\n\\end{eqnarray*}\nIn particular, since\n\\begin{eqnarray*}\n\\beta'+(\\phi_0)_*(\\pi_{1,1})_*\\beta_1+\\cdots+(\\phi_0)_*(\\pi_{1,l})_*\\beta_l=\\beta,\n\\end{eqnarray*}\nit follows that for $\\beta\\in Cen(f)$, we have\n\\begin{eqnarray*}\n&&Z'_{DT}\\bigg(X_1;q|\\bigg)_{\\phi_0^!\\beta}\\\\\n&=&{\\sum\\limits}_{\\substack{\\beta'+(\\phi_0)_*(\\pi_{1,1})_*\\beta_1+\\cdots+(\\phi_0)_*(\\pi_{1,l})_*\\beta_l=\\beta\\\\\\beta'\\in Cen(f)\\\\\\beta_i\\cdot E_{1,i}=\\beta_i\\cdot D_{1,i}=0}} Z'_{DT}\\bigg(X_1/E_1;q||\\bigg)_{\\phi_0^!\\beta'}{\\prod\\limits}_{i=1}^lZ'_{DT}({\\mathbb P}_{1,i}/D_{1,i};q||)_{\\beta_i},\n\\end{eqnarray*}\nSo we have obtained\n\\begin{eqnarray}\n{\\sum\\limits}_{\\beta\\in H_2(X,{\\mathbb Z})}v^{\\beta} Z'_{DT}\\bigg(X_1;q|\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\phi_0^*\\gamma_i)\\bigg)_{\\phi_0^!\\beta}&=&{\\sum\\limits}_{\\beta\\in H_2(X,{\\mathbb Z})}v^{\\beta} Z'_{DT}\\bigg(X_1/E_1;q|\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\phi_0^*\\gamma_i)|\\bigg)_{\\phi_0^!\\beta}\\nonumber\\\\\n&&\\qquad\\cdot{\\prod\\limits}_{i=1}^{l}{\\sum\\limits}_{d\\geqslant0}v^{d[C_i]}{\\sum\\limits}_{\\substack{\\beta_i\\in H_2({\\mathbb P}_{1,i},{\\mathbb Z})\\\\\\beta_i\\cdot E_{1,i}=\\beta_i\\cdot D_{1,i}=0\\\\(\\phi_0)_*(\\pi_{1,i})_*\\beta_i=d[C_i]}}Z'_{DT}({\\mathbb P}_{1,i}/D_{1,i};q||)_{\\beta_i},\\nonumber\\\\\n{\\sum\\limits}_{\\beta\\in Cen(f)}v^{\\beta}Z'_{DT}(X_1;q|)_{\\phi_0^!\\beta}&=&{\\sum\\limits}_{\\beta\\in Cen(f)}v^{\\beta}Z'_{DT}\\bigg(X_1/E_1;q||\\bigg)_{\\phi_0^!\\beta}\\label{X_1center}\\\\\n&&\\qquad\\cdot{\\prod\\limits}_{i=1}^{l}{\\sum\\limits}_{d\\geqslant0}v^{d[C_i]}{\\sum\\limits}_{\\substack{\\beta\\in H_2({\\mathbb P}_{1,i},{\\mathbb Z})\\\\\\beta\\cdot E_{1,i}=\\beta\\cdot D_{1,i}=0\\\\(\\phi_0)_*(\\pi_{1,i})_*\\beta=d[C_i]}}Z'_{DT}({\\mathbb P}_{1,i}/D_{1,i};q||)_{\\beta},\\nonumber\n\\end{eqnarray}\nwhich implies that \n\\begin{eqnarray}\n&&\\frac{{\\sum\\limits}_{\\beta\\in H_2(X,{\\mathbb Z})}v^{\\beta} Z'_{DT}\\bigg(X_1;q|\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\phi_0^*\\gamma_i)\\bigg)_{\\phi_0^!\\beta}}{{\\sum\\limits}_{\\beta\\in Cen(f)}v^{\\beta}Z'_{DT}(X_1;q|)_{\\phi_0^!\\beta}}\\nonumber\\\\\n&=&\\frac{{\\sum\\limits}_{\\beta\\in H_2(X,{\\mathbb Z})}v^{\\beta} Z'_{DT}\\bigg(X_1/E_1;q|\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\phi_0^*\\gamma_i)|\\bigg)_{\\phi_0^!\\beta}}{{\\sum\\limits}_{\\beta\\in Cen(f)}v^{\\beta}Z'_{DT}\\bigg(X_1/E_1;q||\\bigg)_{\\phi_0^!\\beta}}.\\label{X_1rel}\n\\end{eqnarray}\nThen from \\eqref{Xrel} and \\eqref{X_1rel}, we have\n\\begin{eqnarray}\n\\frac{{\\sum\\limits}_{\\beta\\in H_2(X,{\\mathbb Z})}v^\\beta Z'_{DT}\\bigg(X;q|\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\gamma_i)\\bigg)_\\beta}{{\\sum\\limits}_{\\beta\\in Cen(f)}v^{\\beta}Z'_{DT}(X;q|)_{\\beta}}&=&\\frac{{\\sum\\limits}_{\\beta\\in H_2(X,{\\mathbb Z})}v^{\\beta} Z'_{DT}\\bigg(X_1;q|\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(\\phi_0^*\\gamma_i)\\bigg)_{\\phi_0^!\\beta}}{{\\sum\\limits}_{\\beta\\in Cen(f)}v^{\\beta}Z'_{DT}(X_1;q|)_{\\phi_0^!\\beta}}.\\label{X}\n\\end{eqnarray}\nUsing the identification ${\\mathcal F}:H_2(X,{\\mathbb Z})\\xrightarrow{\\cong}H_2(X',{\\mathbb Z})$, we also have\n\\begin{eqnarray}\n&&\\frac{{\\sum\\limits}_{\\beta\\in H_2(X,{\\mathbb Z})}v^\\beta Z'_{DT}\\bigg(X';q|\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}({\\mathcal F}\\gamma_i)\\bigg)_{{\\mathcal F}\\beta}}{{\\sum\\limits}_{\\beta\\in Cen(f)}v^{\\beta}Z'_{DT}(X';q|)_{{\\mathcal F}\\beta}}\\nonumber\\\\\n&=&\\frac{{\\sum\\limits}_{\\beta\\in H_2(X,{\\mathbb Z})}v^{\\beta} Z'_{DT}\\bigg(X'_1;q|\\prod\\limits_{i=1}^m\\tilde\\tau_{d_i}(((\\phi'_0)^*{\\mathcal F}\\gamma_i)\\bigg)_{((\\phi'_0)^!{\\mathcal F}\\beta}}{{\\sum\\limits}_{\\beta\\in Cen(f)}v^{\\beta}Z'_{DT}(X'_1;q|)_{(\\phi'_0)^!{\\mathcal F}\\beta}}.\\label{X'}\n\\end{eqnarray}\n\n\nNow we use induction on $w=1,2,3,\\cdots$ to prove \\eqref{flop} in Proposition \\ref{mainresult}. For $w=1$, we have the following observation.\n\\begin{lemma}\\label{1stlemma}\nFor any nonzero $\\beta\\in Cen(f)$, $\\phi_0^!\\beta$ is not effective. \n\\end{lemma}\n\\begin{proof}\nArgue by contradiction, and then $\\beta=(\\phi_0)_*\\phi_0^!\\beta$ is also effective. We can write $\\beta={\\sum\\limits}_{i=1}^la_i[C_i]$ with $a_i\\in{\\mathbb Z}_{\\geqslant 0}$. Note that ${\\mathcal F}[C_i]=-[C'_i]$, and then\n\\begin{eqnarray*}\n(\\phi'_0)_*\\phi_0^!\\beta={\\mathcal F}\\beta=-{\\sum\\limits}_{i=1}^la_i[C'_i].\n\\end{eqnarray*}\nSince ${\\sum\\limits}_{i=1}^la_i[C'_i]$ is effective, it follows that $(\\phi'_0)_*\\phi_0^!\\beta$ is not effective, which implies that $\\phi_0^!\\beta$ is not effective.\n\\end{proof}\nTherefore, \n\\begin{eqnarray*}\n{\\sum\\limits}_{\\beta\\in Cen(f)}v^{\\beta}Z'_{DT}(X_1;q|)_{\\phi_0^!\\beta}=1\\textrm{ and }{\\sum\\limits}_{\\beta'\\in Cen(f^{-1})}v^{\\beta'}Z'_{DT}(X_1;q|)_{\\phi_0^!\\beta'}=1.\n\\end{eqnarray*}\nNote that in \\eqref{X} and \\eqref{X'}, we have\n\\begin{eqnarray*}\n\\phi_0^*\\gamma_i=(\\phi'_0)^*{\\mathcal F}\\gamma_i\\textrm{ and }\\phi_0^!\\beta=(\\phi'_0)^!{\\mathcal F}\\beta.\n\\end{eqnarray*}\nSo in the case $w=1$, \\eqref{flop} follows from \\eqref{X} and \\eqref{X'}.\n\nAssume that the case for $w=W\\geqslant1$ is proved. Then for $w=W+1$, we have\n\\begin{eqnarray*}\n\\frac{{\\sum\\limits}_{\\beta_1\\in H_2(X_1,{\\mathbb Z})}v^{\\beta_1} Z'_{DT}(X_1;q|{\\prod\\limits}_{i=1}^m\\tilde\\tau_{d_i}(\\phi_0^*\\gamma_i))_{\\beta_1}}{{\\sum\\limits}_{\\beta_1\\in Cen(f_1)}v^{\\beta_1} Z'_{DT}(X_1;q|)_{\\beta_1}}&=&\\frac{{\\sum\\limits}_{\\beta_1\\in H_2(X_1,{\\mathbb Z})}v^{\\beta_1} Z'_{DT}(X'_1;q|{\\prod\\limits}_{i=1}^m\\tilde\\tau_{d_i}({\\mathcal F}_1\\phi_0^*\\gamma_i))_{{\\mathcal F}_1\\beta_1}}{{\\sum\\limits}_{\\beta_1\\in Cen(f_1)}v^{\\beta_1} Z'_{DT}(X'_1;q|)_{{\\mathcal F}_1\\beta_1}},\n\\end{eqnarray*}\nwhere ${\\mathcal F}_1$ is the correspondence on (co)homology groups induced by $f_1$. We have the following key observation.\n\n\\begin{lemma}\\label{2ndlemma}\nLet $S=$Span$_{\\mathbb Z}\\{[C_1],\\cdots,[C_{k_2}]\\}$. For any $\\beta\\in Cen(f)\\setminus S$, $\\phi_0^!\\beta$ is not effective.\n\\end{lemma}\n\\begin{proof}\nWithout loss of generality, assume that \n\\begin{eqnarray*}\nS\\cap\\{[C_{k_2+1}],\\cdots,[C_l]\\}=\\{[C_{l'}],\\cdots,[C_l]\\}.\n\\end{eqnarray*}\nArgue by contradiction, and we can write $\\phi_0^!\\beta={\\sum\\limits}_{j=1}^nm_j[V_j]$, where $m_j\\in{\\mathbb Z}_{\\geqslant0}$, and $V_1,\\cdots,V_n$ are mutually distinct irreducible curves in $X_1$. Since \n\\begin{eqnarray*}\n\\beta=(\\phi_0)_*\\phi_0^!\\beta\\in Cen(f)\\setminus S,\n\\end{eqnarray*}\nand $[C_1],\\cdots,[C_l]$ generate an extremal face in $NE(X)$, it follows that, for each $j$, $V_j$ is mapped onto a point or some $C_i$. In the former case, $V_j$ is a fiber of one irreducible component of $E_1$ and then $V_j\\cdot E_1<0$. In the latter case, $V_j$ is contained in $E_{1,i}$ and then $V_j\\cdot E_{1,i}\\leqslant 0$. Moreover, we can find some $V_j$ which is contained in some $E_{1,i}\\cong{\\mathbb F}_0$ for $l'\\leqslant i\\leqslant l$, and then $V_j\\cdot E_{1,i}<0$. In sum, we have $\\phi_0^!\\beta\\cdot E_1<0$, which is absurd.\n\\end{proof}\nSince $Cen(f_1)=\\{\\phi_0^!\\beta:\\beta\\in S\\}$, it follows that \n\\begin{eqnarray*}\n{\\sum\\limits}_{\\beta_1\\in Cen(f_1)}v^{\\beta_1} Z'_{DT}(X_1;q|)_{\\beta_1}={\\sum\\limits}_{\\beta\\in Cen(f)}v^{\\phi_0^!\\beta}Z'_{DT}(X_1;q|)_{\\phi_0^!\\beta}.\n\\end{eqnarray*}\nNow we have\n\\begin{eqnarray*}\n&&{\\sum\\limits}_{\\beta_1\\in Cen(f_1)}v^{{\\mathcal F}_1\\beta_1}Z'_{DT}(X'_1;q|)_{{\\mathcal F}_1\\beta_1}\\\\\n&=&{\\sum\\limits}_{\\beta'_1\\in Cen(f_1^{-1})}v^{\\beta'_1}Z'_{DT}(X'_1;q| )_{\\beta'_1}\\\\\n&=&{\\sum\\limits}_{\\beta'\\in Cen(f^{-1})}v^{(\\phi'_0)^!\\beta'}Z'_{DT}(X'_1;q|)_{(\\phi'_0)^!\\beta'}\\\\\n&=&{\\sum\\limits}_{\\beta\\in Cen(f)}v^{(\\phi'_0)^!{\\mathcal F}\\beta}Z'_{DT}(X'_1;q|)_{(\\phi'_0)^!{\\mathcal F}\\beta}\\\\\n&=&{\\sum\\limits}_{\\beta\\in Cen(f)}v^{{\\mathcal F}_1\\phi_0^!\\beta}Z'_{DT}(X'_1;q|)_{(\\phi'_0)^!{\\mathcal F}\\beta},\n\\end{eqnarray*}\nwhich implies that \n\\begin{eqnarray*}\n\\frac{{\\sum\\limits}_{\\beta_1\\in H_2(X_1,{\\mathbb Z})}v^{\\beta_1} Z'_{DT}(X_1;q|{\\prod\\limits}_{i=1}^m\\tilde\\tau_{d_i}(\\phi_0^*\\gamma_i))_{\\beta_1}}{{\\sum\\limits}_{\\beta\\in Cen(f)}v^{\\phi_0^!\\beta}Z'_{DT}(X_1;q|)_{\\phi_0^!\\beta}}&=&\\frac{{\\sum\\limits}_{\\beta_1\\in H_2(X_1,{\\mathbb Z})}v^{\\beta_1} Z'_{DT}(X'_1;q|{\\prod\\limits}_{i=1}^m\\tilde\\tau_{d_i}({\\mathcal F}_1\\phi_0^*\\gamma_i))_{{\\mathcal F}_1\\beta_1}}{{\\sum\\limits}_{\\beta\\in Cen(f)}v^{\\phi_0^!\\beta}Z'_{DT}(X'_1;q|)_{(\\phi'_0)^!{\\mathcal F}\\beta}}.\n\\end{eqnarray*}\nObserve that we have the following decomposition\n\\begin{eqnarray*}\nH_2(X_1,{\\mathbb Z})=\\phi_0^!H_2(X,{\\mathbb Z})\\oplus{\\mathbb Z} f_{1,1}\\oplus\\cdots\\oplus{\\mathbb Z} f_{1,l},\n\\end{eqnarray*}\nwhere $f_{1,i}$ is the class of a fiber in $E_{1,i}$. So we obtain\n\\begin{eqnarray}\n&&\\frac{{\\sum\\limits}_{\\beta\\in H_2(X,{\\mathbb Z})}v^{\\beta} Z'_{DT}(X_1;q|{\\prod\\limits}_{i=1}^m\\tilde\\tau_{d_i}(\\phi_0^*\\gamma_i))_{\\phi_0^!\\beta}}{{\\sum\\limits}_{\\beta\\in Cen(f)}v^{\\beta}Z'_{DT}(X_1;q|)_{\\phi_0^!\\beta}}\\nonumber\\\\\n&=&\\frac{{\\sum\\limits}_{\\beta\\in H_2(X,{\\mathbb Z})}v^{\\beta} Z'_{DT}(X'_1;q|{\\prod\\limits}_{i=1}^m\\tilde\\tau_{d_i}({\\mathcal F}_1\\phi_0^*\\gamma_i))_{{\\mathcal F}_1\\phi_0^!\\beta}}{{\\sum\\limits}_{\\beta\\in Cen(f)}v^{\\beta}Z'_{DT}(X'_1;q|)_{(\\phi'_0)^!{\\mathcal F}\\beta}}.\\label{X_1X'_1}\n\\end{eqnarray}\nNote that \n\\begin{eqnarray*}\n{\\mathcal F}_1\\phi_0^*\\gamma_i=(\\phi'_0)^!{\\mathcal F}\\gamma_i\\textrm{ and }{\\mathcal F}_1\\phi_0^!\\beta=(\\phi'_0)^!{\\mathcal F}\\beta,\n\\end{eqnarray*}\nand we see that in the case $w=W+1$, \\eqref{flop} follows from \\eqref{X}, \\eqref{X'} and \\eqref{X_1X'_1}.\n\n\nTo prove \\eqref{center}, we have the following observation. Using the identification $-{\\mathcal F}:H_2(X,{\\mathbb Z})\\xrightarrow{\\cong}H_2(X',{\\mathbb Z})$, from \\eqref{Xcenter}, we have\n\\begin{eqnarray}\n{\\sum\\limits}_{\\beta\\in Cen(f)}v^{-\\beta}Z'_{DT}(X';q|)_{{\\mathcal F}\\beta}&=&{\\sum\\limits}_{\\beta\\in Cen(f)}v^{-\\beta}Z'_{DT}\\bigg(X'_1/E'_1;q||\\bigg)_{(\\phi'_0)^!{\\mathcal F}\\beta}\\label{X'center}\\\\\n&&\\cdot{\\prod\\limits}_{i=1}^l{\\sum\\limits}_{d\\geqslant 0}v^{d[C_i]}Z'_{DT}({\\mathbb P}'_i/D'_i;q||)_{d[C'_i]},\\nonumber\n\\end{eqnarray}\nwhere\n\\begin{eqnarray*}\nE'_1&:=&\\bigcup\\limits_{i=1}^lE'_{1,i},\\\\\n{\\mathbb P}'_i&:=&{\\mathbb P}_{C'_i}(N_{C'_i}\\oplus{\\mathcal O}_{C'_i}),\\quad (N_{C'_i}\\textrm{ is the normal bundle of }C'_i\\textrm{ in }X')\\\\\nD'_i&:=&{\\mathbb P}_{C'_i}(N_{C'_i}\\oplus\\{0\\}),\\\\\nC'_i&\\cong&{\\mathbb P}_{C'_i}(\\{0\\}\\oplus{\\mathcal O}_{C'_i}).\n\\end{eqnarray*}\nSo from \\eqref{Xcenter} and \\eqref{X'center}, \\eqref{center} is equivalent to the following:\n\\begin{eqnarray}\n{\\sum\\limits}_{\\beta\\in Cen(f)}v^{\\beta}Z'_{DT}\\bigg(X_1/E_1;q||\\bigg)_{\\phi_0^!\\beta}={\\sum\\limits}_{\\beta\\in Cen(f)}v^{-\\beta}Z'_{DT}\\bigg(X'_1/E'_1;q||\\bigg)_{(\\phi'_0)^!{\\mathcal F}\\beta}\\label{equivalenttocenter}\n\\end{eqnarray}\n\nNow we use induction on $w=1,2,3,\\cdots$ to prove \\eqref{center} (or \\eqref{equivalenttocenter}). For $w=1$, Lemma \\ref{1stlemma} implies that both LHS and RHS of \\eqref{equivalenttocenter} are equal to $1$. Assume that the case for $w=W\\geqslant1$ is proved. Then for $w=W+1$, we have\n\\begin{eqnarray*}\n{\\sum\\limits}_{\\beta_1\\in Cen(f_1)}v^{\\beta_1}Z'_{DT}(X_1;q|)_{\\beta_1}={\\sum\\limits}_{\\beta_1\\in Cen(f_1)}v^{-\\beta_1}Z'_{DT}(X'_1;q|)_{{\\mathcal F}_1\\beta_1},\n\\end{eqnarray*}\nand by Lemma \\ref{2ndlemma}, this gives\n\\begin{eqnarray}\n{\\sum\\limits}_{\\beta\\in Cen(f)}v^{\\beta}Z'_{DT}(X_1;q|)_{\\phi_0^!\\beta}={\\sum\\limits}_{\\beta\\in Cen(f)}v^{-\\beta}Z'_{DT}(X'_1;q|)_{{\\mathcal F}_1\\phi_0^!\\beta},\\label{X_1X'_1center}\n\\end{eqnarray}\nNote that using the identification $-{\\mathcal F}:H_2(X,{\\mathbb Z})\\xrightarrow{\\cong}H_2(X',{\\mathbb Z})$, \\eqref{X_1center} gives\n\\begin{eqnarray}\n{\\sum\\limits}_{\\beta\\in Cen(f)}v^{-\\beta}Z'_{DT}(X'_1;q|)_{(\\phi'_0)^!{\\mathcal F}\\beta}&=&{\\sum\\limits}_{\\beta\\in Cen(f)}v^{-\\beta}Z'_{DT}\\bigg(X'_1/E'_1;q||\\bigg)_{(\\phi'_0)^!{\\mathcal F}\\beta}\\nonumber\\\\\n&&\\qquad\\cdot{\\prod\\limits}_{i=1}^{l}{\\sum\\limits}_{d\\geqslant0}v^{d[C_i]}{\\sum\\limits}_{\\substack{\\beta\\in H_2({\\mathbb P}'_{1,i},{\\mathbb Z})\\\\\\beta\\cdot E'_{1,i}=\\beta\\cdot D'_{1,i}=0\\\\(\\phi'_0)_*(\\pi'_{1,i})_*\\beta=d[C'_i]}}Z'_{DT}({\\mathbb P}'_{1,i}/D'_{1,i};q||)_{\\beta},\\label{X'_1center}\n\\end{eqnarray}\nwhere\n\\begin{eqnarray*}\n{\\mathbb P}'_{1,i}&:=&{\\mathbb P}_{E'_{1,i}}(N_{E'_{1,i}}\\oplus{\\mathcal O}_{E'_{1,i}}),\\quad (N_{E'_{1,i}}\\textrm{ is the normal bundle of }E'_{1,i}\\textrm{ in }X'_1)\\\\\nD'_{1,i}&:=&{\\mathbb P}_{E'_{1,i}}(N_{E'_{1,i}}\\oplus\\{0\\}),\\\\\nE'_{1,i}&\\cong&{\\mathbb P}_{E'_{1,i}}(\\{0\\}\\oplus{\\mathcal O}_{E'_{1,i}}), \n\\end{eqnarray*}\nand $\\pi'_{1,i}$ is the composition ${\\mathbb P}'_{1,i}\\rightarrow E'_{1,i}\\hookrightarrow X'_1$. Note that \n\\begin{eqnarray*}\n{\\mathcal F}_1\\phi_0^!\\beta=(\\phi'_0)^!{\\mathcal F}\\beta,\n\\end{eqnarray*}\nand we see that in the case $w=W+1$, \\eqref{equivalenttocenter} follows from \\eqref{X_1center}, \\eqref{X_1X'_1center} and \\eqref{X'_1center}.\n\n\\section{BPS state counts}\n\n\nBPS state counts were first introduced in the Gromov-Witten theory. In a study of Type IIA string theory via M-theory, Gopakumar and Vafa defined BPS state counts on Calabi-Yau $3$-folds \\cite{GV1,GV2}. Motivated by the Calabi-Yau case together with the degenerate contribution computation, Pandharipande defined BPS state counts for arbitrary $3$-folds \\cite{P1}. We refer interested readers to \\cite{P2} for a precise description of the working definition of BPS state counts of Gromov-Witten theory of $X$. \n\nNow we give a  working definition of BPS state counts of Donaldson-Thomas theory. Let $\\{T_i\\}_{0\\leqslant i\\leqslant N}$ be a basis of $H^{*}(X,{\\mathbb Q})$, and we define the BPS state counts of Donaldson-Thomas theory by the following identity:\n\\begin{eqnarray*}\n&&{\\sum\\limits}_{\\substack{\\beta\\in H_2(X,{\\mathbb Z})\\\\\\int_\\beta c_1(X)=0}}v^\\beta Z'_{DT}(X;q|)_\\beta+{\\sum\\limits}_{\\substack{\\beta\\in H_2(X,{\\mathbb Z})\\\\\\int_\\beta c_1(X)>0}}v^\\beta{\\sum\\limits}_{e_0,\\cdots,e_N\\in{\\mathbb Z}_{\\geqslant 0}}Z'_{DT}(X;q|{\\prod\\limits}_{i=0}^N\\tilde\\tau_0(T_i)^{e_i})_\\beta{\\prod\\limits}_{i=0}^N\\frac{t_i^{e_i}}{e_1!}\\\\\n&=&\\exp\\bigg\\{{\\sum\\limits}_{\\substack{\\beta\\in H_2(X,{\\mathbb Z})\\setminus\\{0\\}\\\\\\int_\\beta c_1(X)=0}}v^\\beta{\\sum\\limits}_{g\\in{\\mathbb Z}}{\\sum\\limits}_{r\\in div(\\beta)}n_{g,\\frac\\beta r}^X\\cdot\\frac{(-1)^{g-1}}{r}\\Big[(-q)^r-2+(-q)^{-r}\\Big]^{g-1}\\\\\n&&\\qquad+{\\sum\\limits}_{\\substack{\\beta\\in H_2(X,{\\mathbb Z})\\\\\\int_\\beta c_1(X)>0}}v^\\beta{\\sum\\limits}_{g\\in{\\mathbb Z}}{\\sum\\limits}_{e_0,\\cdots,e_N\\in{\\mathbb Z}_{\\geqslant 0}}n_{g,\\beta}^X({\\prod\\limits}_{i=0}^NT_i^{e_i}){\\prod\\limits}_{i=0}^N\\frac{t_i^{e_i}}{e_1!}\\cdot(-1)^{g-1}\\Big[(-q)-2+(-q)^{-1}\\Big]^{g-1}(1+q)^{\\int_\\beta c_1(X)}\\bigg\\}.\n\\end{eqnarray*} \nSince by Lemma 3.1 in \\cite{EQ}, the full primary Donaldson-Thomas theory is determined by those invariants with primary insertions (if any) of degree$>2$, it follows that the BPS state counts vanish if insertions of degree$<2$ appear, and they satisfy the divisor equation. \n\nNote that the Donaldson-Thomas theory counts curves only in a virtual sense. However, it is expected that BPS state counts are enumerative. More precisely, assume that $\\gamma_1,\\cdots,\\gamma_m$ are integral, and let $X_i\\subset X$ be a subvariety which is the Poinca\\'e dual of $\\gamma_i$ in general position. Then $n_{g,\\beta}^X(\\gamma_1,\\cdots,\\gamma_m)$ is expected to the number of irreducible embedded curves in $X$ of geometric genus $g$, with homology class $\\beta$ and intersecting with all $X_i$'s.\n\nTo prove Corollary \\ref{BPS}, we only need to consider insertions of degree$>2$. Without loss of generality, let $\\{T_i\\}_{0\\leqslant i\\leqslant L}$ be a basis of $H^{>2}(X,{\\mathbb Q})$. Since $[C_1],\\cdots,[C_l]$ generate an extremal face in $NE(X)$, it follows that\n\\begin{eqnarray}\n&&{\\sum\\limits}_{\\beta\\in Cen(f)}v^\\beta Z'_{DT}(X;q|)_\\beta\\nonumber\\\\\n&=&\\exp\\bigg\\{{\\sum\\limits}_{\\beta\\in Cen(f)}v^\\beta{\\sum\\limits}_{g\\in{\\mathbb Z}}{\\sum\\limits}_{r\\in div(\\beta)}n_{g,\\frac\\beta r}^X\\cdot\\frac{(-1)^{g-1}}{r}\\Big[(-q)^r-2+(-q)^{-r}\\Big]^{g-1}\\bigg\\},\\label{BPSXcenter}\n\\end{eqnarray}\nand then\n\\begin{eqnarray}\n&&\\frac{{\\sum\\limits}_{\\substack{\\beta\\in H_2(X,{\\mathbb Z})\\\\\\int_\\beta c_1(X)=0}}v^\\beta Z'_{DT}(X;q|)_\\beta+{\\sum\\limits}_{\\substack{\\beta\\in H_2(X,{\\mathbb Z})\\\\\\int_\\beta c_1(X)>0}}v^\\beta{\\sum\\limits}_{e_0,\\cdots,e_L\\in{\\mathbb Z}_{\\geqslant 0}}Z'_{DT}(X;q|{\\prod\\limits}_{i=0}^L\\tilde\\tau_0(T_i)^{e_i})_\\beta{\\prod\\limits}_{i=0}^L\\frac{t_i^{e_i}}{e_1!}}{{\\sum\\limits}_{\\beta\\in Cen(f)}v^{\\beta}Z'_{DT}(X;q|)_{\\beta}}\\nonumber\\\\\n&=&\\exp\\bigg\\{{\\sum\\limits}_{\\substack{\\beta\\in H_2(X,{\\mathbb Z})\\setminus Cen(f)\\\\\\int_\\beta c_1(X)=0}}v^\\beta{\\sum\\limits}_{g\\in{\\mathbb Z}}{\\sum\\limits}_{r\\in div(\\beta)}n_{g,\\frac\\beta r}^X\\cdot\\frac{(-1)^{g-1}}{r}\\Big[(-q)^r-2+(-q)^{-r}\\Big]^{g-1}\\nonumber\\\\\n&&\\qquad+{\\sum\\limits}_{\\substack{\\beta\\in H_2(X,{\\mathbb Z})\\\\\\int_\\beta c_1(X)>0}}v^\\beta{\\sum\\limits}_{g\\in{\\mathbb Z}}{\\sum\\limits}_{e_0,\\cdots,e_L\\in{\\mathbb Z}_{\\geqslant 0}}n_{g,\\beta}^X({\\prod\\limits}_{i=0}^LT_i^{e_i}){\\prod\\limits}_{i=0}^L\\frac{t_i^{e_i}}{e_1!}\\nonumber\\\\\n&&\\qquad\\qquad\\cdot(-1)^{g-1}\\Big[(-q)-2+(-q)^{-1}\\Big]^{g-1}(1+q)^{\\int_\\beta c_1(X)}\\bigg\\}.\\label{BPSX}\n\\end{eqnarray}\nUsing the identification ${\\mathcal F}:H_2(X,{\\mathbb Z})\\xrightarrow{\\cong}H_2(X',{\\mathbb Z})$, we also have\n\\begin{eqnarray}\n&&\\frac{{\\sum\\limits}_{\\substack{\\beta\\in H_2(X,{\\mathbb Z})\\\\\\int_{{\\mathcal F}\\beta} c_1(X')=0}}v^\\beta Z'_{DT}(X';q|)_{{\\mathcal F}\\beta}+{\\sum\\limits}_{\\substack{\\beta\\in H_2(X,{\\mathbb Z})\\\\\\int_\\beta c_1(X)>0}}v^\\beta{\\sum\\limits}_{e_0,\\cdots,e_L\\in{\\mathbb Z}_{\\geqslant 0}}Z'_{DT}(X';q|{\\prod\\limits}_{i=0}^L\\tilde\\tau_0({\\mathcal F} T_i)^{e_i})_{{\\mathcal F}\\beta}{\\prod\\limits}_{i=0}^L\\frac{t_i^{e_i}}{e_1!}}{{\\sum\\limits}_{\\beta\\in Cen(f)}v^{\\beta}Z'_{DT}(X';q|)_{{\\mathcal F}\\beta}}\\nonumber\\\\\n&=&\\exp\\bigg\\{{\\sum\\limits}_{\\substack{\\beta\\in H_2(X,{\\mathbb Z})\\setminus Cen(f)\\\\\\int_\\beta c_1(X)=0}}v^\\beta{\\sum\\limits}_{g\\in{\\mathbb Z}}{\\sum\\limits}_{r\\in div(\\beta)}n_{g,\\frac{{\\mathcal F}\\beta}{r}}^{X'}\\cdot\\frac{(-1)^{g-1}}{r}\\Big[(-q)^r-2+(-q)^{-r}\\Big]^{g-1}\\nonumber\\\\\n&&\\qquad+{\\sum\\limits}_{\\substack{\\beta\\in H_2(X,{\\mathbb Z})\\\\\\int_{{\\mathcal F}\\beta} c_1(X')>0}}v^\\beta{\\sum\\limits}_{g\\in{\\mathbb Z}}{\\sum\\limits}_{e_0,\\cdots,e_L\\in{\\mathbb Z}_{\\geqslant 0}}n_{g,{\\mathcal F}\\beta}^{X'}({\\prod\\limits}_{i=0}^L({\\mathcal F} T_i)^{e_i}){\\prod\\limits}_{i=0}^L\\frac{t_i^{e_i}}{e_1!}\\nonumber\\\\\n&&\\qquad\\qquad\\cdot(-1)^{g-1}\\Big[(-q)-2+(-q)^{-1}\\Big]^{g-1}(1+q)^{\\int_{{\\mathcal F}\\beta} c_1(X')}\\bigg\\}.\\label{BPSX'}\n\\end{eqnarray}\nNote that \n\\begin{eqnarray*}\n\\int_\\beta c_1(X)=\\int_{\\phi_{w-1}^!\\cdots\\phi_0^!\\beta}c_1(X_w)=\\int_{(\\phi'_{w-1})^!\\cdots(\\phi'_0)^!{\\mathcal F}\\beta}c_1(X_w)=\\int_{{\\mathcal F}\\beta} c_1(X').\n\\end{eqnarray*}\nSo \\eqref{BPSflop} follows from \\eqref{flop}, \\eqref{BPSX} and \\eqref{BPSX'}. \n\nFor \\eqref{BPScenter}, using the identification $-{\\mathcal F}:H_2(X,{\\mathbb Z})\\xrightarrow{\\cong}H_2(X',{\\mathbb Z})$, we get from \\eqref{BPSXcenter}\n\\begin{eqnarray}\n&&{\\sum\\limits}_{\\beta\\in Cen(f)}v^{-\\beta} Z'_{DT}(X';q|)_{{\\mathcal F}\\beta}\\nonumber\\\\\n&=&\\exp\\bigg\\{{\\sum\\limits}_{\\beta\\in Cen(f)}v^{-\\beta}{\\sum\\limits}_{g\\in{\\mathbb Z}}{\\sum\\limits}_{r\\in div({\\mathcal F}\\beta)}n_{g,\\frac{{\\mathcal F}\\beta}{r}}^X\\cdot\\frac{(-1)^{g-1}}{r}\\Big[(-q)^r-2+(-q)^{-r}\\Big]^{g-1}\\bigg\\},\\label{BPSX'center}\n\\end{eqnarray}\nSo \\eqref{BPScenter} follows from \\eqref{center}, \\eqref{BPSXcenter} and \\eqref{BPSX'center}.\n\n\n\\section{GW/DT correspondence}\n\nIn this section, we give a proof of Corollary \\ref{GWDT}. We first review basic materials in Gromov-Witten theory, and describe the change of Gromov-Witten theory under flops. Then we follow \\cite{MNOP2} to recall the conjectural formulae for the GW/DT correspondence, and use these formulae to prove Corollary \\ref{GWDT}. \n\nLet $\\overline M_{g,m}(X,\\beta)$ be the moduli space of $m$-pointed stable maps from connected, genus $g$ curves to $X$, representing the class $\\beta\\in H_2(X,{\\mathbb Z})$. Let $ev_i:\\overline M_{g,m}(X,\\beta)\\rightarrow X$ be the evaluation map at the $i$-th marked point, and set  \n\\begin{eqnarray*}\n\\psi_i:=c_1(L_i)\\in H^2(\\overline M_{g,m}(X,\\beta),{\\mathbb Q}),\n\\end{eqnarray*}\nwhere $L_i$ is the cotangent line bundle associated to the $i$-th marked point. For $\\gamma_1,\\cdots,\\gamma_m\\in H^*(X,{\\mathbb Q})$ and $d_1,\\cdots,d_m\\in{\\mathbb Z}_{\\geqslant0}(m\\geqslant0)$, define the (connected) correlator by\n\\begin{eqnarray*}\n{\\langle}{\\prod\\limits}_{i=1}^m\\tau_{d_i}(\\gamma_i){\\rangle}_{g,\\beta}^X:=\\int_{[\\overline M_{g,m}(X,\\beta)]^{vir}}{\\prod\\limits}_{i=1}^m\\psi_i^{d_i}ev_i^*(\\gamma_i).\n\\end{eqnarray*}\n\nThe conjectural GW/DT correspondence compares partition functions of disconnected Gromov-Witten invariants with reduced Donaldson-Thomas partition function. Let $\\{T_i\\}_{0\\leqslant i\\leqslant N}$ be a basis of $H^{*}(X,{\\mathbb Q})$, and the disconnected partition functions in Gromov-Witten theory are given by the following identity:\n\\begin{eqnarray*}\n&&1+{\\sum\\limits}_{\\beta\\in H_2(X,{\\mathbb Z})\\setminus\\{0\\}}v^\\beta{\\sum\\limits}_{\\substack{e_{d,i}\\in{\\mathbb Z}_{\\geqslant0}}}Z'_{GW}(X;u|{\\prod\\limits}_{\\substack{d\\geqslant0\\\\0\\leqslant i\\leqslant N}}\\tau_d(T_i)^{e_{d,i}})_\\beta{\\prod\\limits}_{\\substack{d\\geqslant0\\\\0\\leqslant i\\leqslant N}}\\frac{t_{d,i}^{e_{d,i}}}{e_{d,i}!}\\\\\n&=&\\exp\\bigg\\{{\\sum\\limits}_{\\beta\\in H_2(X,{\\mathbb Z})\\setminus\\{0\\}}v^\\beta{\\sum\\limits}_{g\\in{\\mathbb Z}_{\\geqslant 0}}u^{2g-2}{\\sum\\limits}_{\\substack{e_{d,i}\\in{\\mathbb Z}_{\\geqslant 0}}}{\\langle}{\\prod\\limits}_{\\substack{d\\geqslant0\\\\0\\leqslant i\\leqslant N}}\\tau_d(T_i)^{e_{d,i}}{\\rangle}_{g,\\beta}^X{\\prod\\limits}_{\\substack{d\\geqslant0\\\\0\\leqslant i\\leqslant N}}\\frac{t_{d,i}^{e_{d,i}}}{e_{d,i}!}\\bigg\\}.\n\\end{eqnarray*}\n\nFor the change of Gromov-Witten theory under flops, we have the following theorem.\n\\begin{theorem}(Theorem A in \\cite{LR})\nLet $f$ be a general flop. Let $\\gamma_1,\\cdots,\\gamma_m\\in H^*(X,{\\mathbb Q})$ and $d_1,\\cdots,d_m\\in{\\mathbb Z}_{\\geqslant 0}(m\\geqslant 0)$, such that $\\gamma_i$ has support away from the center of $f$. Then \n\\begin{eqnarray}\n&&\\frac{1+{\\sum\\limits}_{\\beta\\in H_2(X,{\\mathbb Z})\\setminus\\{0\\}}v^\\beta Z'_{GW}(X;u|{\\prod\\limits}_{i=1}^m\\tilde\\tau_{d_i}(\\gamma_i))_\\beta}{1+{\\sum\\limits}_{\\beta\\in Cen(f)\\setminus\\{0\\}}v^{\\beta} Z'_{GW}(X;u|)_{\\beta}}\\nonumber\\\\\n&=&\\frac{1+{\\sum\\limits}_{\\beta\\in H_2(X,{\\mathbb Z})\\setminus\\{0\\}}v^\\beta Z'_{GW}(X';u|{\\prod\\limits}_{i=1}^m\\tilde\\tau_{d_i}({\\mathcal F}\\gamma_i))_{{\\mathcal F}\\beta}}{1+{\\sum\\limits}_{\\beta\\in Cen(f)\\setminus\\{0\\}}v^{\\beta} Z'_{GW}(X';u|)_{{\\mathcal F}\\beta}},\\label{GWflop}\\\\\nZ'_{GW}(X;u|)_\\beta&=&Z'_{GW}(X';u|)_{-{\\mathcal F}\\beta},\\qquad\\forall\\beta\\in Cen(f)\\setminus\\{0\\}.\\label{GWcenter}\n\\end{eqnarray}\n\\end{theorem}\n\\begin{remark}\nTheorem A in \\cite{LR} only deals with the case $d_1=\\cdots=d_m=0$, but the generalization is straightforward.\n\\end{remark}\n\n\n\n\n\nNow we give precise formulae for the conjectural GW/DT correspondence. For primary insertions, we have the following conjecture.\n\\begin{conjecture}(Conjecture $2$ in \\cite{MNOP2})\nSuppose that $\\gamma_1,\\cdots,\\gamma_m\\in H^*(X,{\\mathbb Q})(m\\geqslant0)$. Then after the change of variables $q=-e^{\\sqrt{-1}u}$, we have\n\\begin{eqnarray*}\n(-\\sqrt{-1}u)^{\\int_\\beta c_1(X)}Z'_{GW}(X;u|{\\prod\\limits}_{i=1}^m\\tau_0(\\gamma_i))_\\beta&=&(-q)^{-\\frac12\\int_\\beta c_1(X)}Z'_{DT}(X;q|{\\prod\\limits}_{i=1}^m\\tilde\\tau_0(\\gamma_i))_\\beta.\n\\end{eqnarray*}\n\\end{conjecture}\n\n\n\nThe authors of \\cite{MNOP2} conjectured that the descendent Gromov-Witten theory of $X$ is equivalent to the descendent Donaldson-Thomas theory of $X$ in a subtle way. In the general case, they did not find a complete formula for the conjectural correspondence. However, we have the following precise conjecture for the descendants of the point class. \n\n\\begin{conjecture}(Conjecture $4'$ in \\cite{MNOP2})\nLet $P$ be the class of a point in $X$. Suppose that $\\gamma_1,\\cdots,\\gamma_m\\in H^{>0}(X,{\\mathbb Q})(m\\geqslant0)$, and $d_1,\\cdots,d_n\\in{\\mathbb Z}_{\\geqslant 0}(n\\geqslant0)$. Then after the change of variables $q=-e^{\\sqrt{-1}u}$, we have\n\\begin{eqnarray*}\n&&(-\\sqrt{-1}u)^{\\int_\\beta c_1(X)-{\\sum\\limits}_{i=1}^nd_i}Z'_{GW}(X;u|{\\prod\\limits}_{i=1}^m\\tau_0(\\gamma_i){\\prod\\limits}_{i=1}^n\\tau_{d_i}(P))_\\beta\\\\\n&=&(-q)^{-\\frac12\\int_\\beta c_1(X)}Z'_{DT}(X;q|{\\prod\\limits}_{i=1}^m\\tilde\\tau_0(\\gamma_i){\\prod\\limits}_{i=1}^n\\tilde\\tau_{d_i}(P))_\\beta.\n\\end{eqnarray*}\n\\end{conjecture}\n\nTo prove Corollary \\ref{GWDT}, note that by Lemma 3.1 in \\cite{EQ}, we only need to consider insertions whose pullback classes have degree$>2$. Without loss of generality, let $\\{T_i\\}_{0\\leqslant i\\leqslant L}$ be a basis of $H^{*}(X,{\\mathbb Q})$, where $T_0$ is the class of a point. Then the assumption in Corollary \\ref{GWDT} gives\n\\begin{eqnarray*}\n1+{\\sum\\limits}_{\\beta\\in H_2(X,{\\mathbb Z})\\setminus\\{0\\}}v^\\beta(-\\sqrt{-1}u)^{\\int_\\beta c_1(X)}{\\sum\\limits}_{\\substack{e_{0,1},\\cdots,e_{0,L}\\in{\\mathbb Z}_{\\geqslant 0}\\\\e_{d,0}\\in{\\mathbb Z}_{\\geqslant0}}}Z'_{GW}(X;u|{\\prod\\limits}_{i=1}^L\\tau_0(T_i)^{e_{0,i}}{\\prod\\limits}_{d=0}^\\infty\\tau_d(T_0)^{e_{d,0}})_\\beta{\\prod\\limits}_{i=1}^L\\frac{t_{0,i}^{e_{0,i}}}{e_{0,i}!}{\\prod\\limits}_{d=0}^\\infty\\frac{((-\\sqrt{-1}u)^{-1}t_{d,0})^{e_{d,0}}}{e_{d,0}!}\\nonumber\\\\\n={\\sum\\limits}_{\\beta\\in H_2(X,{\\mathbb Z})}v^\\beta(-q)^{-\\frac12\\int_\\beta c_1(X)}{\\sum\\limits}_{\\substack{e_{0,1},\\cdots,e_{0,L}\\in{\\mathbb Z}_{\\geqslant 0}\\\\e_{d,0}\\in{\\mathbb Z}_{\\geqslant 0}}}Z'_{DT}(X;q|{\\prod\\limits}_{i=1}^L\\tilde\\tau_0(T_i)^{e_{0,i}}{\\prod\\limits}_{d=0}^\\infty\\tilde\\tau_d(T_0)^{e_{d,0}})_\\beta{\\prod\\limits}_{i=1}^L\\frac{t_{0,i}^{e_{0,i}}}{e_{0,i}!}{\\prod\\limits}_{d=0}^\\infty\\frac{t_{d,0}^{e_{d,0}}}{e_{d,0}!}.\\label{GWDTX}\n\\end{eqnarray*}\nNote that the map $v^\\beta\\mapsto v^\\beta(-\\sqrt{-1}u)^{\\int_\\beta c_1(X)}$ gives an isomorphism in the Novikov ring of $X$, and then \\eqref{GWflop} implies that\n\\begin{eqnarray*}\n\\frac{1+{\\sum\\limits}_{\\beta\\in H_2(X,{\\mathbb Z})\\setminus\\{0\\}}v^\\beta(-\\sqrt{-1}u)^{\\int_\\beta c_1(X)}{\\sum\\limits}_{\\substack{e_{0,1},\\cdots,e_{0,L}\\in{\\mathbb Z}_{\\geqslant 0}\\\\e_{d,0}\\in{\\mathbb Z}_{\\geqslant0}}}Z'_{GW}(X;u|{\\prod\\limits}_{i=1}^L\\tau_0(T_i)^{e_{0,i}}{\\prod\\limits}_{d=0}^\\infty\\tau_d(T_0)^{e_{d,0}})_\\beta{\\prod\\limits}_{i=1}^L\\frac{t_{0,i}^{e_{0,i}}}{e_{0,i}!}{\\prod\\limits}_{d=0}^\\infty\\frac{((-\\sqrt{-1}u)^{-1}t_{d,0})^{e_{d,0}}}{e_{d,0}!}}{1+{\\sum\\limits}_{\\beta\\in Cen(f)\\setminus\\{0\\}}v^{\\beta}Z'_{GW}(X;u|)_{\\beta}}\\\\\n=\\frac{1+{\\sum\\limits}_{\\beta\\in H_2(X,{\\mathbb Z})\\setminus\\{0\\}}v^\\beta(-\\sqrt{-1}u)^{\\int_\\beta c_1(X)}{\\sum\\limits}_{\\substack{e_{0,1},\\cdots,e_{0,L}\\in{\\mathbb Z}_{\\geqslant 0}\\\\e_{d,0}\\in{\\mathbb Z}_{\\geqslant0}}}Z'_{GW}(X';u|{\\prod\\limits}_{i=1}^L\\tau_0({\\mathcal F} T_i)^{e_{0,i}}{\\prod\\limits}_{d=0}^\\infty\\tau_d({\\mathcal F} T_0)^{e_{d,0}})_{{\\mathcal F}\\beta}{\\prod\\limits}_{i=1}^L\\frac{t_{0,i}^{e_{0,i}}}{e_{0,i}!}{\\prod\\limits}_{d=0}^\\infty\\frac{((-\\sqrt{-1}u)^{-1}t_{d,0})^{e_{d,0}}}{e_{d,0}!}}{1+{\\sum\\limits}_{\\beta\\in Cen(f)\\setminus\\{0\\}}v^{\\beta}Z'_{GW}(X';u|)_{{\\mathcal F}\\beta}}.\n\\end{eqnarray*}\nHere we have used the change of variables $t_{d,0}\\mapsto(-\\sqrt{-1}u)^{-1}t_{d,0}$. Similarly, note that the change of variables $v^\\beta\\mapsto v^\\beta(-q)^{-\\frac12\\int_\\beta c_1(X)}$ gives an isomorphism of the Novikov ring of $X$, and then \\eqref{flop} gives\n\\begin{eqnarray*}\n\\frac{{\\sum\\limits}_{\\beta\\in H_2(X,{\\mathbb Z})}v^\\beta(-q)^{-\\frac12\\int_\\beta c_1(X)}{\\sum\\limits}_{\\substack{e_{0,1},\\cdots,e_{0,L}\\in{\\mathbb Z}_{\\geqslant 0}\\\\e_{d,0}\\in{\\mathbb Z}_{\\geqslant 0}}}Z'_{DT}(X;q|{\\prod\\limits}_{i=1}^L\\tilde\\tau_0(T_i)^{e_{0,i}}{\\prod\\limits}_{d=0}^\\infty\\tilde\\tau_d(T_0)^{e_{d,0}})_\\beta{\\prod\\limits}_{i=1}^L\\frac{t_{0,i}^{e_{0,i}}}{e_{0,i}!}{\\prod\\limits}_{d=0}^\\infty\\frac{t_{d,0}^{e_{d,0}}}{e_{d,0}!}}{{\\sum\\limits}_{\\beta\\in Cen(f)}v^{\\beta}Z'_{DT}(X;q|)_{\\beta}}\\\\\n=\\frac{{\\sum\\limits}_{\\beta\\in H_2(X,{\\mathbb Z})}v^\\beta(-q)^{-\\frac12\\int_\\beta c_1(X)}{\\sum\\limits}_{\\substack{e_{0,1},\\cdots,e_{0,L}\\in{\\mathbb Z}_{\\geqslant 0}\\\\e_{d,0}\\in{\\mathbb Z}_{\\geqslant 0}}}Z'_{DT}(X';q|{\\prod\\limits}_{i=1}^L\\tilde\\tau_0({\\mathcal F} T_i)^{e_{0,i}}{\\prod\\limits}_{d=0}^\\infty\\tilde\\tau_d({\\mathcal F} T_0)^{e_{d,0}})_{{\\mathcal F}\\beta}{\\prod\\limits}_{i=1}^L\\frac{t_{0,i}^{e_{0,i}}}{e_{0,i}!}{\\prod\\limits}_{d=0}^\\infty\\frac{t_{d,0}^{e_{d,0}}}{e_{d,0}!}}{{\\sum\\limits}_{\\beta\\in Cen(f)}v^{\\beta}Z'_{DT}(X';q|)_{{\\mathcal F}\\beta}}.\n\\end{eqnarray*}\nNow from \\eqref{center}, \\eqref{GWcenter} and the assumption in Corollary \\ref{GWDT}, we obtain\n\\begin{eqnarray*}\nZ'_{GW}(X';u|)_{{\\mathcal F}\\beta}=Z'_{GW}(X;u|)_{-\\beta}=Z'_{DT}(X;q|)_{-\\beta}=Z'_{DT}(X';q|)_{{\\mathcal F}\\beta},\\quad\\forall\\beta\\in Cen(f)\\setminus\\{0\\},\n\\end{eqnarray*}\nand then the desired result follows from the above three long equalities.\n\n\n\n\n\n\n\n{\\bf Acknowledgements.} \n\nThe author would like to thank Yongbin Ruan, Jianxun Hu, Wei-Ping Li and Zhenbo Qin for many constructive discussions, and Jian Zhou for warm encouragement. The author would also like to thank Xiaowen Hu for providing him the referernce \\cite{Pi}.\n\n\n\n\n\n\n\n\n\\begin{thebibliography}{999}\n\n\\bibitem[Ca]{Ca}Calabrese, J., Donaldson-Thomas invariants and flops, arxiv: 1111.1670.\n\n\\bibitem[Cl]{Cl}Clemens, C. H., Degeneration of K\\\"ahler manifolds, Duke Math. J., 44 (2)(1977), 215-290.\n\n\n\n\\bibitem[DT]{DT}Donaldson, S., Thomas, R., Gauge theory in higher dimensions, in The Geometric Universe: Science, Geometry, and the Work of Roger Penrose, S. Huggett et. al eds., Oxford Univ. Press, (1998).\n\n\\bibitem[EQ]{EQ}Edidin, D., Qin, Z., The Gromov-Witten and Donaldson-Thomas correspondence for trivial elliptic fibrations, Internat. J. Math. 18(7) (2007), 821-838. \n\n\\bibitem[GV1]{GV1}Gopakumar, R., Vafa, C., M-theory and topological strings I, hep-th/9809187.\n\n\\bibitem[GV2]{GV2}Gopakumar, R., Vafa, C., M-theory and topological strings II, hep-th/9812127.\n\n\\bibitem[HHKQ]{HHKQ}He, W., Hu, J., Ke, H., Qi, X., Blow-up formulae of high genus Gromov-Witten invariants in dimension six. arXiv:1402.4221\n\n\\bibitem[HL]{HL}Hu, J., Li, W.-P., The Donaldson-Thomas invariants under blowups and flops, J. Differential Goem. 90 (3)(2012), 391-411.\n\n\\bibitem[HLR]{HLR}Hu, J., Li, T.-J., Ruan, Y., Birational cobordism invariance of uniruled symplectic manifolds, Invent. Math. 172(2008), 231-275.\n\n\\bibitem[Ke]{Ke}Ke, H.-Z., Stable pair invariants under blow-ups, Math. Z. DOI 10.1007/s00209-015-1568-7.\n\n\\bibitem[Ko]{Ko}Koll\\'ar, J., Flips, flops, minimal models, etc., Surveys in differential geometry (Cambridge, MA, 1990), Lehigh Univ., Bethlehem, PA, (1991), 113-199.\n\n\\bibitem[KM]{KM}Koll\\'ar, J., Mori, S., Birational geometry of algebraic varieties (with the collaboration of C. H. Clemens and A. Corti). Translated from the 1998 Japanese original. Cambridge Tracts in Mathematics, 134. Cambridge University Press, Cambridge, 1998.\n\n\n\\bibitem[La]{La}Laufer, H., On ${\\mathbb C}{\\mathbb P}^1$ as an exceptional set, Recent developments in several complex variables,\nAnn. of Math. Stud. Princeton University Press, 100 (1981), 261-275.\n\n\\bibitem[LR]{LR}Li, A.-M., Ruan, Y., Symplectic surgery and Gromov-Witten invariants of Calabi-Yau 3-folds, Invent. Math. 145 (1)(2001), 151-218.\n\n\\bibitem[LW]{LW}Li, J., Wu, B., Good degeneration of quot-schemes and coherent systems, Comm. Anal. Geom. 23(4) (2015), 841-921. \n\n\\bibitem[MNOP1]{MNOP1}Maulik, D., Nekrasov, N., Okounkov, A., Pandharipande, R., Gromov-Witten theory and Donaldson-Thomas theory I, Compositio Math. 142 (2006), 1263-1285.\n\n\\bibitem[MNOP2]{MNOP2}Maulik, D., Nekrasov, N., Okounkov, A., Pandharipande, R., Gromov-Witten theory and Donaldson-Thomas theory I, Compositio Math. 142 (2006), 1286-1304.\n\n\\bibitem[MOOP]{MOOP}Maulik, D., Oblomkov, A., Okounkov, A., Pandharipande, R., Gromov-Witten/Donaldson-Thomas correspondence for toric 3-folds, Invent. Math. 186(2) (2011), 435-479.\n\n\\bibitem[MP]{MP}Maulik, D., Pandharipande, R., A topological view of Gromov-Witten theory, Topology 45(2006), 887-918.\n\n\n\\bibitem[Na]{Na}Nakajima, H., Lectures on Hilbert schemes of points on surfaces,  University Lecture Series, 18. American Mathematical Society, Providence, RI, 1999.\n\n\\bibitem[P1]{P1}Pandharipande, R., Hodge integrals and degenerate contributions, Commun. Math. Phys. 208(1999), 489-506.\n\n\\bibitem[P2]{P2}Pandharipande, R., Three questions in Gromov-Witten theory. Proceedings of the International Congress of Mathematicians, Vol. II (Beijing, 2002), 503-512, Higher Ed. Press, Beijing, 2002. \n\n\\bibitem[Pi]{Pi}Pinkham, H., Factorization of birational maps in dimension 3, Singularities (P. Orlik, ed.), Proc. Symp. Pure Math., vol. 40, Part 2, American Mathematical Society, Providence, 1983, pp. 343-371.\n\n\\bibitem[PP]{PP}Pandharipande, R., Pixton, A., Gromov-Witten/Pairs correspondence for the quintic $3$-fold, arXiv:1206.5490v1.\n\n\\bibitem[PT]{PT}Pandharipande, R., Thomas, R. P., Curve counting via stable pairs in the derived category, Invent. Math. 178(2) (2009), 407-447.\n\n\\bibitem[Re]{Re}Reid, M., Minimal models of canonical $3$-folds, Algebraic varieties and analytic varieties (Tokyo, 1981), Adv. Stud. Pure Math., 1, North-Holland, Amsterdam, (1983), 131-180.\n\n\\bibitem[Ru]{Ru}Ruan, Y., Surgery, quantum cohomology and birational geometry, Northern California Symplectic Geometry Seminar AMS Translations, Series 2, 196(1999) , 183-198.\n\n\\bibitem[Th]{Th}Thomas, R., A holomorphic Casson invariant for Calabi-Yau 3-folds and bundles on K3 fibrations, JDG 53 (1999), 367-438.\n\n\\bibitem[T1]{T1}Toda, Y., Curve counting theories via stable objects I. DT/PT correspondence, J. Amer. Math. Soc. 23 (4)(2010), 1119\u00c2\u0080-1157.\n\n\\bibitem[T2]{T2}Toda, Y., Curve counting theories via stable objects II: DT/ncDT flop formula, J. Reine Angew. Math. 675 (2013), 1-51. \n\n\n\n\n\\end{thebibliography}\n\n", "itemtype": "equation", "pos": 15979, "prevtext": "\nWe have\n\n", "index": 5, "text": "$$\n  H_2(X,{\\mathbb Z})\\stackrel{i_{t*}}{\\longrightarrow}\n  H_2(\\chi,{\\mathbb Z})\\stackrel{i_{0_*}}{\\longleftarrow}\n  H_2(\\chi_0,{\\mathbb Z})\\stackrel{g_*}{\\longleftarrow} H_2(X_1,{\\mathbb Z})\\oplus\n  H_2(X_2,{\\mathbb Z}),\n$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"H_{2}(X,{\\mathbb{Z}})\\stackrel{i_{t*}}{\\longrightarrow}H_{2}(\\chi,{\\mathbb{Z}}%&#10;)\\stackrel{i_{0_{*}}}{\\longleftarrow}H_{2}(\\chi_{0},{\\mathbb{Z}})\\stackrel{g_{%&#10;*}}{\\longleftarrow}H_{2}(X_{1},{\\mathbb{Z}})\\oplus H_{2}(X_{2},{\\mathbb{Z}}),\" display=\"block\"><mrow><mrow><mrow><msub><mi>H</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>X</mi><mo>,</mo><mi>\u2124</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mover><mo movablelimits=\"false\">\u27f6</mo><msub><mi mathsize=\"142%\">i</mi><mrow><mi mathsize=\"140%\">t</mi><mo>\u2063</mo><mo mathsize=\"140%\" stretchy=\"false\">*</mo></mrow></msub></mover><mrow><msub><mi>H</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c7</mi><mo>,</mo><mi>\u2124</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mover><mo movablelimits=\"false\">\u27f5</mo><msub><mi mathsize=\"142%\">i</mi><msub><mn mathsize=\"140%\">0</mn><mo>*</mo></msub></msub></mover><mrow><msub><mi>H</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c7</mi><mn>0</mn></msub><mo>,</mo><mi>\u2124</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mover><mo movablelimits=\"false\">\u27f5</mo><msub><mi mathsize=\"142%\">g</mi><mo mathsize=\"140%\" stretchy=\"false\">*</mo></msub></mover><mrow><mrow><msub><mi>H</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><mi>\u2124</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2295</mo><mrow><msub><mi>H</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>X</mi><mn>2</mn></msub><mo>,</mo><mi>\u2124</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}]