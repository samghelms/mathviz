[{"file": "1601.04298.tex", "nexttext": "\nAs it is trivial that $F(p,n) =2n-1$ for $n<p$, \nand it is well-known that $F(3,n) = 2^n -1$, \n  formula (\\ref{FrameStewart})   determines $F(p,n)$ for all $p\\geq 3$ and $n\\geq 0$. \n\nThe literature on the topic is enormous, for example   there are 352 references in \\cite{book}.\nVery recently,  a   proof of optimality  for the case $p=4$ appeared in \\cite{Bousch}.\n\nHere we first observe some self similarity properties of the  labeled graphs that are \nisomorphic to Hanoi graphs. \nThe symmetries can rather  naturally be observed from drawings that, to our surprise, \nare used very rarely. In fact, in an attempt to Google search \nfor drawings of Hanoi graphs,  the present author found a similar drawing in only one paper \\cite{Zhang}, which seems to be unpublished students' homework(!).\n \nThe structure of the Hanoi graphs allows to prove a lemma about existence of shortest paths of certain structure that in turn provides a proof  that the Frame-Stewart algorithm is optimal. This solves  the famous Frame-Stewart conjecture.\n \nThe rules of the game are simple.\nThere are $p$ pegs and $n$ disks, that  all differ in size (diameter).\nIn the beginning, all the disks are at one peg, (legally) ordered by size.\nIt is not allowed to put a larger disk onto a smaller one at any time.\nIn one move,  a disk that is on the top at one peg is  put to  the top  at another peg.\nThe task is to reach a state in which  all the disks from original peg  are at  another peg so that the number of moves is minimal.\n\n Only basic notions of graph theory will be used. \nA graph is a pair of sets  $G = (V(G),E(G))$, where $V(G)$ is an arbitrary set of vertices, \nand $E(G)$ is a set of pairs of vertices. \nUsual notation is $e=uv$ meaning that edge $e$ connects vertices $u$ and $v$.\nWe work with labeled graphs, i.e. graphs   with a labeling function that assigns a label to each vertex.\nTwo (unlabeled) graphs  $G$ and $H$ are isomorphic when  there is a bijection (called isomorphism)\n$\\alpha : V(G) \\to V(H)$ such that $u$ and $v$ are connected in $G$ if and only if \n$\\alpha(u)$ and   $\\alpha(v)$ are connected in $H$.\nA walk  is a sequence of vertices and  edges $v_0 e_1 v_1 e_2 v_2 ...e_k v_k$ \nsuch that  $e_i = v_{i-1}v_i$. \nA walk is also determined either by the  sequence of vertices  $v_0  v_1 v_2 ...v_k$ \nor by the sequence of edges  $ e_1  e_2  ...e_k $.\n The length of a walk is the number of edges on it.\nA path is a walk in which all vertices are distinct.     \nThe distance between two vertices is the length of a shortest path.\nA subgraph $H$ of a graph $G$ is isometric subgraph, if the distance between any two vertices in $H$ is equal to the distance  in $G$.\nFor notions not recalled here see, for example \\cite{knjigaTG}.\n\nThe rest of the paper is organized as follows. \nIn the next section, we construct labeled graphs $G^{(p)}_n$  corresponding to the Tower of  Hanoi   game \nwith $p$ pegs and $n$ disks.\nIn Section 3, a lemma about the self similarity of these graphs is proved and some related facts are given.\nSections 4  and 5  provide proof of  existence of shortest paths of certain form \nwhich in turn gives a lower bound on length of the shortest paths between certain vertices.\nThis implies  the main result, a proof of the  Frame-Stewart conjecture for four pegs  that appears in Section 6.\n \n\n\n\n\n\\section{The construction of labeled graphs $G^{(p)}_n$.}\\label{casekpegs}\n\n\n \nBefore giving the general definition, we start with the $p=4$  pegs example.\n\nLabels of  the graphs $G^{(4)}_n$  will be words of length $n$ over the \nfour letter  alphabet  $ {\\cal A}_4= \\{A,B,C, D\\}$.\n\nLet  $G^{(4)}_1$ be the tetrahedron graph (complete graph on 4 vertices), \nand the vertices labeled with $A,B,C,$ and $D$. \n\nGiven $G^{(4)}_n$, we construct $G^{(4)}_{n+1}$ as follows. \nTake four copies of  $G^{(4)}_n$:\nin the first copy, denoted by $AG^{(4)}_n$ replace each label $*$ with label $A*$\n(i.e. add an $A$ at the beginning of each label).\nSimilarly,  in $BG^{(4)}_n$ replace each label $*$ with label $B*$,   \n in $CG^{(4)}_n$ replace each label $*$ with label $C*$,   and \n in $DG^{(4)}_n$ replace each label $*$ with label $D*$. \n\nFinally connect some  pairs of vertices  from different copies of $G^{(4)}_n$ with edges \nby the following rule.\nLet $X,Y \\in {\\cal A}_4$, $X\\not=Y$.\nTwo vertices $u\\in V(XG^{(4)}_n)$ and $v\\in V(YG^{(4)}_n)$\nare connected if and only if the labels of $u$ and $v$  \nwithout the first letter are equal and   are words over ${\\cal A}_4 - \\{X,Y\\}$.\n(i.e. the labels do not contain any $X$ or $Y$).\n\nThe graphs $G_1^{(4)}$ and  $G_2^{(4)}$  are drawn on Fig.  \\ref{G1inG2} and the graph  $G_3^{(4)}$  is on Fig.  \\ref{G3classes}. \n \nIn other words,  from  the definition it follows that two vertices from different copies of $G^{(4)}_n$\nare connected  in $G^{(4)}_{n+1}$\n  exactly when their labels  are equal  (in the last $n$ letters)\nand the labels are words over an alphabet of two letters.\n\n \n\\begin{figure}[ht]\n \\centering\n  \\leavevmode\n  \\includegraphics[height=7cm]{G1andG2.eps} \n \\caption{The graphs $G_1^{(4)}$ and  $G_2^{(4)}$ .} \n \\label{G1inG2}\n\\end{figure}\n  \n \n\n\\noindent  {\\bf Remark. }\nThe graph  $G^{(4)}_n$ is isomorphic to the Hanoi graph of the game with 4 pegs and  $n$ disks.\nJust interpret the labels naturally as: $i$-th letter in the label is the position of the $i$-th disk.\nFor example, the first letter gives the position of the largest disk.\n\nWe now turn to general definition, for arbitrary $p \\geq 3$. \nA generalization to  $G^{(p)}_n$ is straightforward : \n\n\\begin{definition}\n Let $G^{(p)}_1$ be a complete graph with $p$ distinct labels on vertices, say using letters from alphabet ${\\cal A}_p$.\nConstruct  $G^{(p)}_{n+1}$   using $p$ copies of  $G^{(p)}_n$ as above, i.e.\nin each copy of $G^{(p)}_n$    use a different letter as a prefix for labels.\nAs before, connect two vertices $u\\in V(XG^{(p)}_n)$ and $v\\in V(YG^{(p)}_n)$\n  if and only if the labels of $u$ and $v$  \nwithout the first letter are equal and   are words over ${\\cal A}_p- \\{X,Y\\}$\n(i.e. the labels do not contain any $X$ or $Y$).\n\\end{definition}\n\n\n\\noindent  {\\bf Remark. }\nBy construction, the graph  $G^{(p)}_n$  is  the graph of the Tower of  Hanoi game with  $k$ pegs and $n$ disks.\n(As unlabeled graph, it is therefore  isomorphic to the Hanoi graph,  $H_n^p$    in   notation of  \\cite{book}.) \nThe Frame-Stewart conjecture  says that the minimal number of moves  between two perfect states is determined by recursion  (\\ref{FrameStewart}) \nwhich    is equivalent to statement that  this is the  length of a shortest path  in  $G^{(p)}_n$  between two perfect vertices,\nfor example  vertices  with labels $A^n = AA...A$ and $B^n = BB...B$.\n\n\n\n\n\\section{Self Similarity.}\\label{SelfSimilarity}\n\n\n\n\n\\begin{figure}[htb]\n \\centering\n  \\leavevmode\n  \\includegraphics[height=8cm]{Tower4pegs3diskaComplete2.eps} \n \\caption{The graph $G_3^{(4)}$; with the four equivalence classes ($i=1$).}  \n \\label{G3classes}\n\\end{figure}\n \n\n \nIt is well known that the Hanoi graphs are highly symmetric.\nHere we first  emphasize    one of the properties that motivated  the  idea used in the argument given  below.\nSome more properties are listed below for later reference.  \nWe do not give detailed proofs as we believe that these results are not new, and are recalled here  for completeness of presentation.\n\nGiven  $G^{(p)}_n$ and $1\\leq i\\leq  n$  define the  equivalence relation $R_i$ \non the set of vertices  $V(G^{(p)}_n)$ \n as follows:\ntwo vertices are equivalent when their labels coincide in the first $n-i$ letters.\nDefine the  graph   $G^{(p)}_n  / R_i$  on  equivalence classes (as vertices) by connecting two \nequivalence classes if there is an edge   $G^{(p)}_n $  that connects a pair of vertices from the two classes.\nThe definition directly implies:\n\n\\begin{lemma}\n$G^{(p)}_n  /  R_i $ is isomorphic to $G^{(p)}_{n-i}$.\n\\end{lemma}\n\nHaving in mind this structure, we will (for fixed $i$)\nmake a distinction between the  edges within equivalence classes   \nand the edges connecting different classes. \nThe later will be called {\\em bridges} and the edges within equivalence classes will be referred to as {\\em local edges}.\nThus bridges correspond to moves of the largest $n-i$ disks and \nlocal edges to moves of the smallest $i$ disks.\n\n(See Fig.  \\ref{G3classes}  and   Fig.  \\ref{G3edges}, where the bridges  between classes A** and C** in $G_3^{(4)}$ are shown.)\n\n\\begin{figure}[htb]\n \\centering\n  \\leavevmode\n  \\includegraphics[height=8cm]{Tower4pegs3diskaPartial.eps}\n \\caption{The four equivalence classes ($i=1$) of the graph $G_3^{(4)}$ and all edges (bridges)  between two classes.}  \n \\label{G3edges}\n\\end{figure}\n\nBy definition of $R_i$, each equivalence class of $R_i$ induces a subgraph of $G^{(p)}_n$ \nthat is isomorphic to $G^{(p)}_{i}$.\nFurthermore, recall that any bridge connects two vertices (from different equivalence classes) \nwith the same labels (i.e. with labels that match in the last $i$ letters).\n\n\n\n\n\n\n\n\n\nWe state two more properties  for a later reference. \nThe proofs follow directly from the definitions. \nMaybe even more natural argument is to consider the meaning in terms of the game, \nnamely (1) fixing positions of the largest $n-i$ disks clearly results in a game with $i$ disks and \n(2) putting the smallest $i$ disks to one of the pegs forbids the moves to that peg, hence \nexactly $p-1$ pegs are free to move the largest  $n-i$ disks at.\n\n\\begin{lemma} \\label{LemaIsometry}\nLet $W$ be a arbitrary word of $n-i$ letters over alphabet ${\\cal A}_p$. Then \n $WG^{(p)}_{i}$  are isometric subgraphs of  $G^{(p)}_n$.\n\\end{lemma}\n\n\\begin{lemma}  \\label{Lema33}\nThe vertices \n $WG^{(p)}_{i}$ of   $G^{(p)}_n  /  R_i $  \nwhere $W$  is an  arbitrary word of $n-i$ letters over alphabet ${\\cal A}_p - X$\ninduce a subgraph that    is isomorphic to  $G^{(p-1)}_{n-i}$.\n\\end{lemma}\n\nWe conclude the section with a couple of facts that will be useful later. \nAs above, the proofs are not difficult, for example by considering the meaning of the distances in terms of the game.\nIn short, the first claim follows by obvious symmetry (just replace the role of $A$ and $B$). \nThe second claim is obvious because if  we can solve the bigger task, then we also can solve the easier task (and need not move the largest disk). \nDetails are left to the reader.\n\n\n\\begin{fact} \\label{Fact1} \nLet $A$ and $B$ be arbitrary letters from alphabet   ${\\cal A}_p $. \nLet $W$ be a word of $i$ letters over alphabet   ${\\cal A}_p- \\{A,B\\}$.\nThen the distance between vertices with labels $A^i$  and $W$ is  equal to  the distance between vertices with labels $B^i$  and $W$.\nHence, there is no shortest path connecting vertices with labels $A^i$ and $W$ that meets $B^i$  in $G_i^{p}$.\n\\end{fact}\n\n\n\\begin{fact} \\label{Fact2}  \nLet $W$ be a word of $i$ letters over alphabet   ${\\cal A}_p- \\{A\\}$.\nThen there exists   $C\\not= A $\nsuch that   the distance between vertices with labels $C^i$ and $W$ is strictly smaller  than \n the distance between vertices with labels $A^i$ and $W$.\n\\end{fact}\n\n\n\\noindent  {\\bf Remark. }\nIdea of proof of Fact \\ref{Fact2} :\nOn any path  $P$   from $W$ (i.e. vertex   with  label $W$) to $A^i$, \nthe largest disk will be moved to peg $A$, so the path $P$ can be written as $W \\to W^{*} \\to AW^{**} \\to A^i$, \nwhere $W^{*}$ and $ AW^{**} $  are two labels that differ only in the first letter. Let the first letter of  $W^{*}$  be $C$.\nThen there is a path   $P^{*}$  from $W$ to $C^i$,    i.e. $W \\to W^{*}  = CW^{**} \\to C^i$,  and \n $P^{*}$ is shorter than $P$.\n\n\n\n\n\\section{Shortest paths.}\\label{ShortestPaths}\n\n\n \nLet $n\\geq 2$, as the case $n=1$ is   trivial.\nLet ${\\cal A}_p$ be an alphabet of $p$ letters, and $A,B \\in  {\\cal A}_p$.\n\n\nLet $P$ be a shortest   path  from vertex $a$ with label $A^n$  to vertex $b$ with label  $B^n$.\nBelow, in  Proposition   \\ref{LemaExistence}  we will assume \n that on the path $P$ there is a vertex that has a label of the form \n$A^{n-i}X^i$, where $X \\in {\\cal A}_p -\\{A,B\\}$  (i.e. $X$ is not $A$ nor $B$).\nWe call such a vertex {\\em special}. \n\nIt may seem obvious that there is a special vertex on every shortest path from  $a$ and $b$. \nHowever, this is not the case as pointed out by Ciril Petr and Sandi Klav\\v zar.  \nA slightly weaker,  but still sufficient,   statement can be proved\n\n\\begin{lemma}  \\label{lemaspecial}\nLet $p=4$. \nThere is  a shortest path   with at least one  special vertex on every path between vertices   $a$ and $b$  with labels $A^n$   and  $B^n$.\n\\end{lemma}\n\nThe proof  of Lemma   \\label{lemaspecial} is postponed to the next section.  It is based on induction, in which the small cases are, due to large number of them, \nrather tedious task.  \nAlternatively, it can be checked by computer using a straightforward  application of a shortest path algorithm.\nWe believe that the same technique can be used for $p>5$ and conjecture\n\n \n\\begin{conjecture}   \\label{special}\nThere is  a shortest path   with at least one  special vertex on every path between vertices   $a$ and $b$  with labels $A^n$   and  $B^n$.\n\\end{conjecture}\n\n \nNow  we will show that there is a shortest path with certain structure. \nMore precisely,  \n\n\\begin{proposition} \\label{LemaExistence}\nLet $P$ be a shortest  path connecting vertices  $a$ and $b$ with labels  $A^n$   and $B^n$  and let $1\\leq i\\leq n$.\nIf there is a special vertex on $P$ with label of the form  $A^{n-i}X^i$,  where $X \\in {\\cal A}_p -\\{A,B\\}$ \nthen   there is a shortest  path $Q$ from  $a$  to $b$  in $G^{(p)}_n$, \nwhich is a concatenation of three subpaths  $Q_1$,  $Q_2$,  $Q_3$\nsuch that $Q_1$ and $Q_3$ only use local edges and $Q_2$ only uses bridges. \n\\end{proposition}\n\n\n\\proof\nConsider a shortest   path $P$  from  $a$ to $b$ (vertices with labels $A^n$   and $B^n$).\nLet $i  = i(P)$ be maximal with property that there is a special vertex $s = s(i)$ with label  $A^{n-i}X^i$ on the path $P$.\n\nDenote by $P_1$ the first part of $P$, from  $a$ to $s$, \nand observe that because of Lemma \\ref{LemaIsometry} we can, without loss of generality, assume that there are only local edges on $P_1$. \nAs $P$ is a shortest path, $Q_1 =P_1$ must be a shortest  path from  $a$ to $s$ within the subgraph $A^{n-i}G^{(p)}_i$.\n \nOn path $P$ there must be at least one bridge after $P$ meets $s$\nbecause labels \n $A^n$ and $B^n$ differ in the\n first  $n-i \\geq 1$ letters that can only be changed when traversing bridges.\nFirst we show that there is a shortest path  such that the edge used after visiting $s$ is a bridge:\n\n\\begin{claim} \\label{Claim1} \nLet $P$ be a shortest path  from   $a$ to $b$  (with labels  $A^n$  and $B^n$) that meets vertex $s = s(i)$ with label  $A^{n-i}X^i$, $i  = i(P)$.\nThen there is a   path $P^\\prime$ of the same length such that the first edge after visiting $s$ is a bridge.\n\\end{claim}\n\n{\\noindent{\\bf Proof (of the Claim). }}  \nIf $P$ has the property claimed then $P^\\prime  =P$ and we are done.\nNow assume that $P=P_1P_2 f P_3$ where $P_1$ is a shortest path from  $a$  to $s$,\n$P_2$ is a subpath of local edges from $s$ to $w$, $f$ is a bridge, and $P_3$ is the rest of $P$.\n\nWe distinguish two cases.\nFirst, let $w$ be a vertex with label $A^{n-i}W$ where $W$ is a word using letter $X$.\nThis implies that $f$ is a bridge that moves a disk from peg $A$ to a peg that is not peg $X$, \nsay $f$ moves $n-i$-th disk from $A$ to $Y\\not=X$.\nThis implies that  we can replace subpath $P_2 f$ with $f^\\prime P_2^\\prime$, \nwhere  $f^\\prime$ is the edge connecting vertex $s$ (with label $A^{n-i}X^i$) and  vertex $s^\\prime$ that has label  $A^{n-i-1} Y X^i$\nand  $P_2^\\prime$ is a copy of  $P_2$  in the subgraph   $A^{n-i-1} Y G^{(p)}_i$.\n(Formally, the path    $P_2^\\prime$ is constructed from   $P_2$ by replacing  every vertex on $P_2$ (with label   $A^{n-i}*$)\nwith the vertex with label $A^{n-i-1}Y*$.)\n\nNow assume that  $w$ is  a vertex with label $A^{n-i}W$ where $W$ is a word without  letter $X$.\nIn this case  the subpath $P_1 P_2$  (within   $A^{n-i}   G^{(p)}_i$)\nstarts at $a$ (with  label $A^n$),  visits first vertex with label  $A^{n-i}X^i$ and then reaches  $w$. \nHowever, there is a strictly shorter path  from  $a$ to $w$  \nwhich contradicts the assumption that $P$ is a shortest path  (recall Fact \\ref{Fact1}).\n\\qed (Claim)\n\nNow we will prove that there is no need to use local edges between bridges, i.e. that there is a shortest path which, after visiting $s$,\nfirst traverses all bridges, and then traverses only local edges. \nThe next claim  shows that we can always  conveniently  change position of the next displaced bridge. More precisely, \n\n\\begin{claim} \\label{Claim2}   \nLet $P$ be a shortest path of the form $P= P_1 P_2 L f P_3$, \nwhere $P_1$ is a shortest path  from $a$   to $s$,\n$P_2$ is a path of bridges from $s$ to $ t$, \n$L$ is a local path, $f$ is a bridge, and $P_3$ is the rest of $P$.\nThen there is  shortest path $P^\\prime = P_1 P_2 f^\\prime L^\\prime P_3$, \nwhere  $f^\\prime$ is a bridge and $L^\\prime$ is a local path of the same length as $L$.\n\\end{claim}\n\n{\\noindent{\\bf Proof (of the Claim). }}  \nThe local path $L$ is a path from vertex  $t$ to a vertex, say $w$.\nLet the label of $t$ be   $ZX^i$ where $Z$ is a word of length $n-i$ that does  not contain any $X$.\nThen the label of $w$ must be of the form $ZW$.\n\nWe distinguish two cases.\nFirst, assume the word $W$ contains at least one letter $X$. Therefore bridge $f$ that moves one of the large disks may not move  a   disk to peg $X$.\n(More precisely, \nedge $f$ connects $w$ and $u$, and the label of $u$   must be  $Z^\\prime W$, where the words   $Z^\\prime$ and $Z$ differ in one letter at  one position, and \nneither   $Z^\\prime$ nor  $Z$  contain any letter $X$.)\n\nHence we can define $f^\\prime$ to be the bridge that connects $t$ (with label $ZX^i$) and the vertex with label  $Z^\\prime X^i$, denote it $r$.\nFurthermore, let $L^\\prime$ be a copy of $L$ in $Z^\\prime  G^{(p)}_i$ that connects vertices $r$ and $u$. By construction, paths  $f^\\prime L^\\prime$ and $Lf$\nboth connect $t$ and $u$ and are of the same length, as needed.\n\nNow assume that $w$ is a vertex with label $ZW$ where $W$ is a word without letter $X$. In this case, we can construct a shorter path from $a$ to $w$, which contradicts the assumption that $P$ is a shortest path. The argument is as follows.\n\nFirst, observe that, because there is no $X$ in $W$, the first letter of $W$ is $Y\\not= X$.\n(In other words,  the $i$-th smallest disk is on peg $Y$ that is not peg $X$.)\n\nSecond, by symmetry, existence of the path $P_2$  (connecting vertices with labels  $A^{n-i}X^i$  and $ZX^i$) implies the existence of a path $P_2^\\prime$\nof the same length that connects vertices with labels   $A^{n-i}Y^i$  and $ZY^i$.\n(Just replace any occurence  of $Y$  in $P_2$ with $X$  (and vice versa) to get $P_2^\\prime$.)\n\nFurthermore, by symmetry, there is a path $P_1^\\prime$  (of the same length as $P_1$ that connects vertex $a$ and the vertex with label  $A^{n-i}Y^i$.\n\nFinally, recalling Fact \\ref{Fact2}, in $ZG_i^{p}$  there is a path $L^\\prime$ from the vertex with label $ZYY^{i-1}$ to vertex $w$ that is strictly shorter than $L$.\n\nSummarizing, the path  $P_1^\\prime P_2^\\prime L^\\prime$ from $a$ to $w$ is shorter than $ P_1 P_2 L$, contradicting the minimality of $P$.\n\\qed (Claim)\n  \nBy inductive application of the last Claim we prove that any shortest path $P$ can be replaced by a shortest path $Q=  Q_1 Q_2 Q_3$\nwhere $Q_2$ is a path of bridges while $Q_1$ and $Q_3$ are path of local edges. \n\\qed \n\n\n\n\n\n\n\\section{Special vertices - partial proof of Conjecture \\ref{special}.}\n\nIn this section we will prove  Lemma  \\ref{lemaspecial}. \nThe proof is by induction. \nWe emphasize that  the inductive step is  proved  for general $p$ \nwhile  we are only able to prove the base step(s) for each $p$ separately.\n\nWe begin by introducing some more notation. \nIn the graph   $G_{n+1}^{(p)}$,\nwe consider shortest paths from $a$ to the set of vertices on the {\\em border} of  $AG_{n}^{(p)}$, i.e. to vertices  \nfrom which there are edges going out to other subgraphs  $XG_{n}^{(p)}$, $X\\not=A$.\nThe border  $S_n$  is, by definition  of   $G_{n+1}^{(p)}$,  a union of \n$S_n^{AX}$,   where   $S_n^{AX} $ is a set of vertices with labels that do not use letters $A$ and $X$ :\n\n$ \\displaystyle{ S_n  =  \\bigcup_{X\\in {\\cal A} - A}   S_n^{AX} } $.\n\nAs $AG_{n}^{(p)}$ is just a copy of $G_{n}^{(p)}$ we can recursively define $S_{n-1}$ in  $G_{n}^{(p)}$,   \nand because $AG_{n}^{(p)}$ is a subgraph of  $G_{n+1}^{(p)}$, this also gives a definition of $S_{n-1}$ in  $G_{n+1}^{(p)}$.  \nThus we define the sets  $S_i$  in  $G_{n+1}^{(p)}$    for  $i=1,2,\\dots, n$ (see Figure   \\ref{Boundaries}). Obviously, \n\n\\begin{fact} \\label{InductionStep}\n Any shortest path from $a$ to $v \\in S_{n}$   meets $S_{n-1}$.\n\\end{fact}\n\n\\begin{figure}[htb]\n \\centering\n  \\leavevmode\n  \\includegraphics[height=8cm]{BOUNDARiesShadows.eps}\n \\caption{  Subgraph $A^{n-3}G_3^{(4)}$    with  emphasized  vertex sets $ S_2$   in $S_3$.  Edges corresponding to the moves of the 3rd disk are not drawn.}  \n \\label{Boundaries}\n\\end{figure}\n\nAs already mentioned, there are examples, in which there  is a unique shortest path from $a$ to some vertices on the border. \nWe conjecture that this is only possible for small $n$.\n\n\\begin{conjecture}   \\label{SmallConjecture}\nFor any $p \\geq 3$ there is  $n_0 \\geq 2$ such that  for any $v \\in S_{n_0}$  there is \na  shortest path from $a$ to $v$   that   meets  a special vertex. \n\\end{conjecture} \n\nFor $p=4$, the validity of  conjecture can be   proved by regarding  $S_6$ in  the graph $G_7^{(4)}$.\nIn fact the  present  author performed    a  tedious case analysis \"by hand\" using a tool for \ndrawing shortest paths in  Hanoi graphs by Igor Pesek.\n\nAs a curiosity, let us mention that the only vertices on the boundary $S_5$ that have a unique shortest  path to $a$\nare the six vertices  with labels  $A...ACCDCD$, $ A...ADDCDC$, (and, by symmetry,  $A...ACCBCB$, $A...ABBCBC$,  $A...ABBDBD$, $A...ADDBDB$), \ntwo of them  passing the vertex with label $A...AAAAAB$. \nOn $S_6$, there is no vertex with a unique  shortest path to vertex $a$, and in particular, in each case at least one of the paths   avoids vertex   with label $A...AAAAAB$. \n\nWe thus know that\n\n\\begin{fact} \nFor any $v \\in S_6$  in  the graph $G_7^{(4)}$, there is  a shortest path from $a$ to $v$   that   meets  a special vertex.\n\\end{fact} \n\nHence, \nby induction step (Fact  \\ref{InductionStep}),  for any   $v \\in S_{n}$ in  the graph $G_{n+1}^{(4)} $ \nthere is a  shortest path from $a$ to $v$   that meets  a special vertex, for any $n\\geq 7$.\n\nRecall that  any shortest path  between $a$ and $b$  (with labels  $A^n$   and  $B^n$)  in  $G_{n }^{(p)}$\nmeets $S_{n-1}$, more precisely   $S_{n-1}^{AB}$.\nProvided   validity of  Conjecture \\ref{SmallConjecture}   (that is proved above for case $p=4$),\nwe have the existence of a shortest path  between  $a$ and $b$  (with labels   $A^n$   and  $B^n$)   \nthat meets a special vertex. \nFurthermore, for $p=4$ and $n<7$ it is straightforward to construct  shortest  paths that meet a special vertex. \nThis concludes the proof of   Lemma  \\ref{lemaspecial}.\n\n\\medskip\n\\noindent{\\bf Remark.}\nClearly, the cases $p>4$ can be handled along the same lines. The size of graphs however is probably too large to  check without computer assistance.\n \n\n\n\\section{The main result.}\n\n  Proposition   \\ref{LemaExistence}  implies that there is a shortest path  between  vertices  $a$  and  $b$  (with labels  $A^n$   and   $B^n$)  \nin which bridges are all sandwiched together between two local paths.\nHence, it suffices to consider the paths of this form.\n\n\n\\begin{lemma}\\label{LemaDistances}  \nAssume validity of Conjecture \\ref{special}.\nLet $ P$ be a path connecting vertices  with labels $A^n$   and $B^n$,\nand    with  a special vertex on $P$  with label of the form  $A^{n-i}X^i$,  where $X \\in {\\cal A} -\\{A,B\\}$.\n  Assume   $ P$   is a concatenation of three subpaths  $ P_1$,  $ P_2$,  and $ P_3$\nsuch that $P_1$ and $P_3$ only use local edges and $P_2$ only uses bridges. \nThen the length of $ P$ is     $F(p,i) + F(p-1,n-i) + F(p,i)$.\n\\end{lemma}\n\n\\proof\nLet the special vertex $s$ on $P$ be of the form   $A^{n-i}X^i$.\nThen the last $i$ letters  of labels of  all the vertices on $P_2$ are $X^i$, \nwhich implies that $P_2$ never meets the copies $WG_{i}^{(p)}$\nwhere $X$ appears in the word $W$.\nRecall that  by Lemma \\ref{Lema33},  the subgraph  induced on vertices  $WG_{n-i}^{(p)}$\nwhere $W$ is a word of length $n-i$ over alphabet  ${\\cal A}_p - X$  \nis isomorphic to $G_{n-i}^{(p-1)}$.\n\nThe lengths  of   subpaths  $  P_1$,  $  P_2$,  $  P_3$  are thus bounded by  \n$F(p,i)$,  $ F(p-1,n-i)$,   and  $ F(p,i)$, respectively. \nHence the statement of the Lemma follows.\n\\qed \n\n\\begin{theorem}  \\label{main} \nAssume validity of Conjecture \\ref{special}.\nThe distance between   vertices with labels $A^n$   and   $B^n$  in   $G^{(p)}_n$   is \n$  \\min_{1\\leq i \\leq n} \\{ 2F(p,i) + F(p-1,n-i) \\}$.\n\\end{theorem}\n \n\\proof\nConsider a shortest path $P$  between vertices with labels  $A^n$  and  $B^n$.\nThere must be a special vertex on $P$, \nand, by Lemma \\ref{LemaExistence}, a shortest path $Q$  \nfor which the length is given by   Lemma \\ref{LemaDistances}.\nRecall  \\cite{Klavzar,book} that  there are algorithms for which the number of moves is given by Eq. (\\ref{FrameStewart}).\nTherefore  the length  of  a  shortest path $P$ \nis of the from   $2 F(p,i(P)) + F(p-1,n-i(P))$, as claimed.\n\\qed \n\nTheorem \\ref{main}    and Lemma \\ref{lemaspecial}   impliy \n\n\\begin{theorem}   \\label{FS}\nThe strong Frame-Stewart conjecture is true for $p=4$.\n\\end{theorem}\n\nRecall that for any $p$,  validity of    Conjecture \\ref{special} implies the strong  Frame-Stewart conjecture for that $p$.\n\n\n\\begin{acknowledgment}{Acknowledgment.}\nThe author  wishes  to thank Igor Pesek for providing a tool for drawing shortest paths in Hanoi graphs, and  to Sandi Klav\\v{z}ar and Ciril Petr\nfor useful comments  on an earlier version of this paper. The work was in part supported by ARRS.\n\\end{acknowledgment}\n  \n\\begin{thebibliography}{99}     \n  \\bibitem{Bousch} T.  Bousch,   La  quatrieme  tour  de  Hanoi,   \\textit{ Bull.  Belg.  Math.  Soc.  Simon Stevin}   \\textbf{21} (2014)  895-912.\n\n\n\n\\bibitem{FrameStewart1}  J. S. Frame, Problems and Solutions: Advanced Problems: Solutions:  3918, \n \\textit{The American Mathematical Monthly}  \\textbf{48}  (1941) 216-217.\n\n\\bibitem{book}  A. M. Hinz,  S. Klav\\v zar,  U. Milutinovi\\'c,  C. Petr,   \\textit{ The Tower of Hanoi - Myths and Maths},  Springer, Basel, 2013.\n\n\\bibitem{Klavzar} S. Klav\\v{z}ar, U. Milutinovi\\'c,   C. Petr, On the Frame-Stewart algorithm for the multi-peg Tower of Hanoi problem, \n \\textit{Discrete Applied Mathematics}  \\textbf{120}  (2002) 1141-157.\n\n\\bibitem{problem} B. M. Stewart, Problems and Solutions: Advanced Problem 3918, \n \\textit{The American Mathematical Monthly}   \\textbf{46}   (1939) 363.\n\n\\bibitem{FrameStewart2}   B. M. Stewart, Problems and Solutions: Advanced Problems: Solutions:  3918, \n \\textit{The American Mathematical Monthly}  \\textbf{48}   (1941) 217-219.\n\n\\bibitem{Zhang}  A. Zhang, Properties of the Hanoi Graph for 4  Pegs, manuscript, \nhttps://www2.bc.edu/~grigsbyj/Zhang\\_Final.pdf\n\n\n\n\n\n\n\n\\bibitem{knjigaTG} R.Wilson, J.J. Watkins,  \\textit{Graphs: An Introductory Approach--A First Course in Discrete Mathematics}, \nWiley,   1990.\n\n\\end{thebibliography}\n\n\n", "itemtype": "equation", "pos": 1908, "prevtext": "\n\n\\title{Self Similarities of the  Tower of Hanoi Graphs  and  a proof of the Frame-Stewart Conjecture}\n\\markright{ Tower of Hanoi and Frame-Stewart conjecture}\n\n\n{\n\\author{ \nJanez \\v{Z}erovnik  \\\\%\nUniversity of Ljubljana, FME,\nA\\v sker\\v ceva 6 \\\\ \nand \\\\\nIMFM, Jadranska 19,\nSI-1000 Ljubljana, Slovenia\\\\\n{\\tt janez.zerovnik@fs.uni-lj.si;janez.zerovnik@imfm.si} \n}\n\n\\date{\\today}\n\n\\maketitle\n\n\\begin{abstract} \nConsidering the symmetries and self similarity properties of the corresponding labeled graphs,\nit  is shown that the  minimal number of moves in the Tower of Hanoi game with  $p =4$ pegs and  $n \\geq p$ disks\nsatisfies the  recursive formula \n$ F(p,n)   =  \\min_{1\\leq i \\leq n-1} \\{ 2F(p,i) + F(p-1,n-i) \\} $\nwhich proves the strong Frame-Stewart conjecture for the case $p=4$.\nThe method can be generalized to $p>4$.\n\\end{abstract}\n\n\\section{Introduction.}\n\nThe Tower of Hanoi game\nwith $p \\geq 3$ pegs and  $n \\geq 0$   disks is a popular game in which  disks have to be moved from one to another peg,\n obeying the rule that a larger disk can never be put onto a smaller one \\cite{book}.\nThe case $p=4$ is sometimes called  Reve's puzzle. \nIt is usual to study the game by regarding  the graph of possible positions  and legal moves among them.\nThe most prominent open problem is the Frame-Stewart conjecture\nabout  the  minimality  of  a  certain  algorithm  for  the  distance  between  \nso called perfect    states.\n\nThe known solution  to the Problem 3918 \\cite{problem}  \nthat has been reinvented several times (see \\cite{book} for historical facts)\nappears to be a very natural one, \nbut the proof of optimality  in general case  is not known until today.\nThe two solutions proposed by Frame and Stewart  \\cite{FrameStewart1,FrameStewart2}\n are known to be equivalent \\cite{Klavzar}\nand the number of steps needed for $p$ pegs and  $n\\geq p$ disks \nis given by the   recursive formula\n\n", "index": 1, "text": "\\begin{equation}\nF(p,n)   =  \\min_{1\\leq i \\leq n-1} \\{ 2F(p,i) + F(p-1,n-i) \\} .  \\label{FrameStewart}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"F(p,n)=\\min_{1\\leq i\\leq n-1}\\{2F(p,i)+F(p-1,n-i)\\}.\" display=\"block\"><mrow><mrow><mrow><mi>F</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>p</mi><mo>,</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munder><mi>min</mi><mrow><mn>1</mn><mo>\u2264</mo><mi>i</mi><mo>\u2264</mo><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></mrow></munder><mo>\u2061</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>F</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>p</mi><mo>,</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mi>F</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mrow><mi>n</mi><mo>-</mo><mi>i</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">}</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}]