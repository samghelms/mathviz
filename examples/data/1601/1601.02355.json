[{"file": "1601.02355.tex", "nexttext": "\nwhere $\\mu_{H,L}$ \\textcolor{black}{($cm^{-1}$)} is the measured attenuation coefficient of a specific pixel using high ($H$) and low ($L$) energy spectrum, and \\textcolor{black}{the unitless} $x_{1,2}$ \\textcolor{black}{denote} the projection component of the attenuation coefficient along two basis materials 1 and 2, respectively. \\textcolor{black}{After taking mass conservation into account, $x_{1,2}$ can be regarded as volume fractions.} $\\mu_{ij}$ \\textcolor{black}{($cm^{-1}$)} is the linear attenuation coefficient of material $i$ ($i=1$ or 2) under the energy spectrum $j$ ($j=H$ or $L$). The linear attenuation coefficients $\\mu_{ij}$ of the basis materials can be either obtained from the ROIs in the high and low energy images that correspond to the basis materials or from the calibration scan using the basis material phantom.\n\n\\textcolor{black}{In cases DECT raw data acquired using two source-detector pairs that are using different spectra, and fast kVp switching during a single source scan, the high- and low-energy CT scans are geometrically inconsistent (i.e., the paths of high- and low-energy CT measurements are not based on the same path) and some dedicated algorithms are designed to deal with this problem~\\citep{knaup2007,maass2011}}. Compared to projection-domain decomposition methods which may suffer from inconsistent rays issue, image-domain dual-energy decomposition is more convenient in clinical applications as it is performed on reconstructed CT images acquired on commercial CT scanners. In this case, material-specific images can be simply generated using direct matrix inversion, however, direct material decomposition techniques such as matrix inversion \\textcolor{black}{can} yield \\textcolor{black}{amplified} image noise \\textcolor{black}{since the low- and high-energy signals are subtracted while the noise is the summation of the two.} Note that \\textcolor{black}{the amplified} noise is a common issue for both projection and image-domain material decomposition. Many \\textcolor{black}{methods} have been proposed to address the problem~\\citep{maass2009,shen2013,clark2014,dong2014,petrongolo2015}.\n\nThis study aims to significantly improve DECT imaging by establishing a new theoretical framework of image-domain material decomposition with incorporation of  edge-preserving techniques.  We demonstrate the advantages of the proposed approach by digital phantom studies and by  quantification of iodine concentration of a series of myocardial perfusion imaging studies.\n\n\\section{Methods and materials}\n\\vspace{-0.5mm}\n\\subsection{Material decomposition via direct matrix inversion}\n\nSuppose the total number of pixels of one CT image is $N$, for low- and high-energy CT images and material-specific images, equation~(\\ref{equ:decomEquation}) can be rewritten in matrix form,\n\n", "itemtype": "equation", "pos": 5320, "prevtext": "\n\\bibliographystyle{natbib} \n\n\\title[Improved Image-Domain Material Decomposition]{Using Edge-Preserving Algorithm with Non-local Mean for  Significantly Improved Image-Domain Material Decomposition in Dual Energy CT}\n\n\\author{Wei Zhao$^{1}$,~Tianye~Niu$^{2}$,~Lei Xing$^{3}$,Yaoqin Xie$^{4}$,~Guanglei Xiong$^{5}$,~Kimberly Elmore$^{5}$,~Jun Zhu$^{1}$, Luyao Wang$^{1}$,~James K.~Min$^{5}$}\n\\address{$^1$ Department of Biomedical Engineering, Huazhong University of Science and Technology, Hubei, 430074 China}\n\\address{$^2$ Sir Run Run Shaw Hospital, Zhejiang University School of Medicine; Institute of Translational Medicine, Zhejiang University, Hangzhou, Zhejiang, 310016 China}\n\\address{$^{3}$ Stanford University, Department of Radiation Oncology, Stanford, CA 94305 USA}\n\\address{$^{4}$ Shenzhen Institutes of Advanced Technology, Chinese Academy of Sciences, Shenzhen 518055 China}\n\\address{$^{5}$ Dalio Institute of Cardiovascular Imaging New York-Presbyterian Hospital and Weill Cornell Medical College, New York, NY 10021}\n\n\\ead{jkm2001@med.cornell.edu}\n\n\\begin{abstract}\n\n\\textcolor{black}{Increased} noise is a general concern for dual-energy material decomposition. Here, we develop an image-domain material decomposition algorithm for dual-energy CT (DECT) by incorporating an edge-preserving filter into the Local HighlY constrained backPRojection Reconstruction (HYPR-LR) framework. With effective use of the non-local mean, the proposed algorithm, which is referred to as HYPR-NLM, reduces the noise in dual energy decomposition while preserving the accuracy of quantitative measurement and spatial resolution of the material-specific dual energy images. We demonstrate the noise reduction and resolution preservation of the algorithm with iodine concentrate numerical phantom by comparing the HYPR-NLM algorithm to the direct matrix inversion, HYPR-LR and iterative image-domain material decomposition (Iter-DECT). We also show the superior performance of the HYPR-NLM over the existing methods by using two sets of cardiac perfusing imaging data. The DECT material decomposition comparison study shows that all four algorithms yield acceptable quantitative measurements of iodine concentrate. Direct matrix inversion yields the highest noise level, followed by HYPR-LR and Iter-DECT. HYPR-NLM in iterative formulation significantly reduces image noise and the image noise is comparable to or even lower than that generated using Iter-DECT. For the HYPR-NLM method, there are marginal edge effects in the difference image, suggesting the high-frequency details are well preserved. In addition, when the search window size increases from $11\\times11$ to $19\\times19$ , there are no significant change and marginal edge effects in the HYPR-NLM difference images. The reference drawn from the comparison study includes: (1) HYPR-NLM significantly reduces the DECT material decomposition noise while preserving quantitative measurements and high-frequency edge information, and (2) HYPR-NLM is robust with respect to parameter selection. \n\n\\end{abstract}\n\n\n\n\n\n\n\n\n\n\n\n\\maketitle\n\n\n\\section{Introduction}\n\nIn dual-energy CT imaging (DECT), the object is scanned using two energy spectra with different kVp settings, or different prefiltration, or both. Compared to standard CT imaging where only one x-ray spectrum was used to yield an effective linear attenuation coefficient of the object, DECT can take advantage of the energy dependence of the linear attenuation coefficients, yielding energy and material-selective images~\\citep{alvarez1976,kalender1986}. This enables DECT to be used in various clinical applications, including improving tissue or contrast agent segmentation and quantification~\\citep{johnson2007,liu2009,fischer2011,chandarana2011,li2013}, removing beam hardening artifacts~\\citep{wu2009,yu2011,yu2012,scheske2013}, and further providing improved clinical significance for modern CT scanners~\\citep{graser2009,hartman2012,marin2014}.\n\nThe material-selective image is obtained by dual-energy basis material decomposition, which depends on the mass attenuation coefficients of the basis materials as well as dual-energy projection data acquisition. Dual-energy raw data can be acquired in several different ways, such as sequential scans at different kVps, dual x-ray sources at $90^{\\circ}$ on the same gantry~\\citep{johnson2007}, fast kVp switching within a single scan~\\citep{kalender1986,silva2011,matsumoto2011} and consistent ray approach using either layered detectors~\\citep{carmi2005,hao2013} or photon counting detectors~\\citep{wang2009,wang2010,shikhaliev2012}. Depending on the dual-energy data acquisition method, basis material decomposition can be performed either in projection-domain~\\citep{sidky2004,stenner2007,noh2009,brendel2009,maass2011,xing2013} or image-domain~\\citep{maass2009,niu2014,clark2014,li2015,faby2015,petrongolo2015}, or joint-domain~\\citep{sukovic2000,zhang2014,long2014}. In this study, we will focus on image-domain material decomposition.\n\nIn the theory of image-domain material decomposition, the linear attenuation coefficients derived from reconstructed images at low- and high-energy scans can be expressed as a linear combination of the pixel values in the images of the two basis materials~\\citep{kalender1986,szczykutowicz2010,niu2014}:\n\n", "index": 1, "text": "\\begin{equation}\\label{equ:decomEquation}\n{\\mu_{H} \\choose \\mu_{L}} =\n\\begin{pmatrix}\n  \\mu_{1H} & \\mu_{2H}  \\\\\n  \\mu_{1L} & \\mu_{2L}\n \\end{pmatrix}\n {x_{1} \\choose x_{2}},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"{\\mu_{H}\\choose\\mu_{L}}=\\begin{pmatrix}\\mu_{1H}&amp;\\mu_{2H}\\\\&#10;\\mu_{1L}&amp;\\mu_{2L}\\end{pmatrix}{x_{1}\\choose x_{2}},\" display=\"block\"><mrow><mrow><mrow><mo>(</mo><mfrac linethickness=\"0pt\"><msub><mi>\u03bc</mi><mi>H</mi></msub><msub><mi>\u03bc</mi><mi>L</mi></msub></mfrac><mo>)</mo></mrow><mo>=</mo><mrow><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><msub><mi>\u03bc</mi><mrow><mn>1</mn><mo>\u2062</mo><mi>H</mi></mrow></msub></mtd><mtd columnalign=\"center\"><msub><mi>\u03bc</mi><mrow><mn>2</mn><mo>\u2062</mo><mi>H</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign=\"center\"><msub><mi>\u03bc</mi><mrow><mn>1</mn><mo>\u2062</mo><mi>L</mi></mrow></msub></mtd><mtd columnalign=\"center\"><msub><mi>\u03bc</mi><mrow><mn>2</mn><mo>\u2062</mo><mi>L</mi></mrow></msub></mtd></mtr></mtable><mo>)</mo></mrow><mo>\u2062</mo><mrow><mo>(</mo><mfrac linethickness=\"0pt\"><msub><mi>x</mi><mn>1</mn></msub><msub><mi>x</mi><mn>2</mn></msub></mfrac><mo>)</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02355.tex", "nexttext": "\nHere $A$ is a $2N\\times2N$ material decomposition matrix and it can be derived from equation~(\\ref{equ:decomEquation}) as,\n\n", "itemtype": "equation", "pos": 8336, "prevtext": "\nwhere $\\mu_{H,L}$ \\textcolor{black}{($cm^{-1}$)} is the measured attenuation coefficient of a specific pixel using high ($H$) and low ($L$) energy spectrum, and \\textcolor{black}{the unitless} $x_{1,2}$ \\textcolor{black}{denote} the projection component of the attenuation coefficient along two basis materials 1 and 2, respectively. \\textcolor{black}{After taking mass conservation into account, $x_{1,2}$ can be regarded as volume fractions.} $\\mu_{ij}$ \\textcolor{black}{($cm^{-1}$)} is the linear attenuation coefficient of material $i$ ($i=1$ or 2) under the energy spectrum $j$ ($j=H$ or $L$). The linear attenuation coefficients $\\mu_{ij}$ of the basis materials can be either obtained from the ROIs in the high and low energy images that correspond to the basis materials or from the calibration scan using the basis material phantom.\n\n\\textcolor{black}{In cases DECT raw data acquired using two source-detector pairs that are using different spectra, and fast kVp switching during a single source scan, the high- and low-energy CT scans are geometrically inconsistent (i.e., the paths of high- and low-energy CT measurements are not based on the same path) and some dedicated algorithms are designed to deal with this problem~\\citep{knaup2007,maass2011}}. Compared to projection-domain decomposition methods which may suffer from inconsistent rays issue, image-domain dual-energy decomposition is more convenient in clinical applications as it is performed on reconstructed CT images acquired on commercial CT scanners. In this case, material-specific images can be simply generated using direct matrix inversion, however, direct material decomposition techniques such as matrix inversion \\textcolor{black}{can} yield \\textcolor{black}{amplified} image noise \\textcolor{black}{since the low- and high-energy signals are subtracted while the noise is the summation of the two.} Note that \\textcolor{black}{the amplified} noise is a common issue for both projection and image-domain material decomposition. Many \\textcolor{black}{methods} have been proposed to address the problem~\\citep{maass2009,shen2013,clark2014,dong2014,petrongolo2015}.\n\nThis study aims to significantly improve DECT imaging by establishing a new theoretical framework of image-domain material decomposition with incorporation of  edge-preserving techniques.  We demonstrate the advantages of the proposed approach by digital phantom studies and by  quantification of iodine concentration of a series of myocardial perfusion imaging studies.\n\n\\section{Methods and materials}\n\\vspace{-0.5mm}\n\\subsection{Material decomposition via direct matrix inversion}\n\nSuppose the total number of pixels of one CT image is $N$, for low- and high-energy CT images and material-specific images, equation~(\\ref{equ:decomEquation}) can be rewritten in matrix form,\n\n", "index": 3, "text": "\\begin{equation}\\label{equ:MatrixForm}\n\\vec{\\mu}=A\\vec{x}.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"\\vec{\\mu}=A\\vec{x}.\" display=\"block\"><mrow><mrow><mover accent=\"true\"><mi>\u03bc</mi><mo stretchy=\"false\">\u2192</mo></mover><mo>=</mo><mrow><mi>A</mi><mo>\u2062</mo><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u2192</mo></mover></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02355.tex", "nexttext": "\nwith $I$ the $N\\times N$ identity matrix. $\\vec{\\mu}$ and $\\vec{x}$ are column \\textcolor{black}{vectors} with dimension of $2N$ as \\textcolor{black}{they consist} of high- and low-energy CT image, and decomposed material-specific images with column vector form, respectively. Namely,\n\n", "itemtype": "equation", "pos": 8533, "prevtext": "\nHere $A$ is a $2N\\times2N$ material decomposition matrix and it can be derived from equation~(\\ref{equ:decomEquation}) as,\n\n", "index": 5, "text": "\\begin{equation}\\label{equ:matrix}\nA=\n\\begin{pmatrix}\n  \\mu_{1H}I & \\mu_{2H}I  \\\\\n  \\mu_{1L}I & \\mu_{2L}I\n \\end{pmatrix},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"A=\\begin{pmatrix}\\mu_{1H}I&amp;\\mu_{2H}I\\\\&#10;\\mu_{1L}I&amp;\\mu_{2L}I\\end{pmatrix},\" display=\"block\"><mrow><mrow><mi>A</mi><mo>=</mo><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><msub><mi>\u03bc</mi><mrow><mn>1</mn><mo>\u2062</mo><mi>H</mi></mrow></msub><mo>\u2062</mo><mi>I</mi></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\u03bc</mi><mrow><mn>2</mn><mo>\u2062</mo><mi>H</mi></mrow></msub><mo>\u2062</mo><mi>I</mi></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><msub><mi>\u03bc</mi><mrow><mn>1</mn><mo>\u2062</mo><mi>L</mi></mrow></msub><mo>\u2062</mo><mi>I</mi></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\u03bc</mi><mrow><mn>2</mn><mo>\u2062</mo><mi>L</mi></mrow></msub><mo>\u2062</mo><mi>I</mi></mrow></mtd></mtr></mtable><mo>)</mo></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02355.tex", "nexttext": "\nwith $\\vec{\\mu}_H$ and $\\vec{\\mu}_L$ the measured high- and low-energy CT images, respectively, and $\\vec{x}_1$ and $\\vec{x}_2$ the two material-specific images. Note that both $\\vec{\\mu}_{H,L}$ and $\\vec{x}_{1,2}$ are represented as vectors.\nTo obtain material-specific images from high- and low-energy CT images, one can directly use matrix inversion to solve equation~(\\ref{equ:decomEquation}), i.e.\n\n", "itemtype": "equation", "pos": 8955, "prevtext": "\nwith $I$ the $N\\times N$ identity matrix. $\\vec{\\mu}$ and $\\vec{x}$ are column \\textcolor{black}{vectors} with dimension of $2N$ as \\textcolor{black}{they consist} of high- and low-energy CT image, and decomposed material-specific images with column vector form, respectively. Namely,\n\n", "index": 7, "text": "\\begin{equation}\\label{equ:matrix}\n\\vec{\\mu}=\n\\begin{pmatrix}\n  \\vec{\\mu}_H\\\\\n  \\vec{\\mu}_L\n \\end{pmatrix},~~\n  \\vec{x}=\n\\begin{pmatrix}\n  \\vec{x}_1\\\\\n  \\vec{x}_2\n \\end{pmatrix},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"\\vec{\\mu}=\\begin{pmatrix}\\vec{\\mu}_{H}\\\\&#10;\\vec{\\mu}_{L}\\end{pmatrix},~{}~{}\\vec{x}=\\begin{pmatrix}\\vec{x}_{1}\\\\&#10;\\vec{x}_{2}\\end{pmatrix},\" display=\"block\"><mrow><mrow><mrow><mover accent=\"true\"><mi>\u03bc</mi><mo stretchy=\"false\">\u2192</mo></mover><mo>=</mo><mrow><mo>(</mo><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><msub><mover accent=\"true\"><mi>\u03bc</mi><mo stretchy=\"false\">\u2192</mo></mover><mi>H</mi></msub></mtd></mtr><mtr><mtd columnalign=\"center\"><msub><mover accent=\"true\"><mi>\u03bc</mi><mo stretchy=\"false\">\u2192</mo></mover><mi>L</mi></msub></mtd></mtr></mtable><mo>)</mo></mrow></mrow><mo rspace=\"9.1pt\">,</mo><mrow><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u2192</mo></mover><mo>=</mo><mrow><mo>(</mo><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><msub><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u2192</mo></mover><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign=\"center\"><msub><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u2192</mo></mover><mn>2</mn></msub></mtd></mtr></mtable><mo>)</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02355.tex", "nexttext": "\nwhere\n\n", "itemtype": "equation", "pos": 9552, "prevtext": "\nwith $\\vec{\\mu}_H$ and $\\vec{\\mu}_L$ the measured high- and low-energy CT images, respectively, and $\\vec{x}_1$ and $\\vec{x}_2$ the two material-specific images. Note that both $\\vec{\\mu}_{H,L}$ and $\\vec{x}_{1,2}$ are represented as vectors.\nTo obtain material-specific images from high- and low-energy CT images, one can directly use matrix inversion to solve equation~(\\ref{equ:decomEquation}), i.e.\n\n", "index": 9, "text": "\\begin{equation}\\label{equ:dirInverse}\n\\vec{x}=A^{-1}\\vec{\\mu},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"\\vec{x}=A^{-1}\\vec{\\mu},\" display=\"block\"><mrow><mrow><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u2192</mo></mover><mo>=</mo><mrow><msup><mi>A</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><mover accent=\"true\"><mi>\u03bc</mi><mo stretchy=\"false\">\u2192</mo></mover></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02355.tex", "nexttext": "\n with \\textcolor{black}{matrix determinant} $C=(\\mu_{2H}\\mu_{1L}-\\mu_{1H}\\mu_{2L})^{-1}$. However, material decomposition in this manner \\textcolor{black}{can} yields significantly \\textcolor{black}{increased} noise and severely degraded noise-to-signals (NSRs) for the material-specific images. A method taking some measures to reduce the noise and to recover NSRs is highly desirable.\n\n\\subsection{HYPR-NLM}\n\nTo reduce the \\textcolor{black}{amplified} image noise in the decomposed material-specific images while keeping the images as accurate as possible (both quantitative measurement and spatial resolution), we developed an image-domain material images denoising algorithm. The algorithm \\textcolor{black}{was} based on the HYPR-LR (Local HighlY constrained backPRojection Reconstuction) framework~\\citep{mistretta2006,johnson2008,leng2011}, which was first proposed for reconstruction of time-resolved magnetic resonance imaging (MRI) using highly undersampled projection. The HYPR-LR framework has been successfully applied to a broad range of medical imaging applications, such as dynamic MRI~\\citep{johnson2008}, CT angiography~\\citep{supanich2009}, dynamic positron emission tomography~\\citep{christian2010}, spectral CT~\\citep{leng2011} and myocardial perfusion imaging~\\citep{speidel2013}. For noise reduction in spectral CT, the HYPR-LR algorithm \\textcolor{black}{treated} CT images at different energies as four-dimensional CT images, i.e., the energy dimension \\textcolor{black}{was} regarded as time dimension. It \\textcolor{black}{started} with producing a composite image $\\vec{\\mu}_c$ by averaging the energy images \\textcolor{black}{with equal weighting}, i.e. yielding an image with lower image noise level by using the images from different energy bins of photon-counting detector CT, or from high- and low-energy images of dual-energy CT. A weight image \\textcolor{black}{was} then generated by calculating the ratio of two filtered images, which \\textcolor{black}{were} obtained by filtering both the energy images $\\vec{\\mu}_{e}$ and the composite image $\\vec{\\mu}_c$. The final image $\\vec{\\mu}_{he}$ \\textcolor{black}{was} obtained by multiplying the weight image and the composite image. The mathematical form of HYPR-LR algorithm is as follows,\n\n", "itemtype": "equation", "pos": 9637, "prevtext": "\nwhere\n\n", "index": 11, "text": "\\begin{equation}\\label{equ:matrixInA}\nA^{-1}=C\n\\begin{pmatrix}\n  -\\mu_{2L}I & \\mu_{2H}I\\\\\n  \\mu_{1L}I & -\\mu_{1H}I\n \\end{pmatrix}.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"A^{-1}=C\\begin{pmatrix}-\\mu_{2L}I&amp;\\mu_{2H}I\\\\&#10;\\mu_{1L}I&amp;-\\mu_{1H}I\\end{pmatrix}.\" display=\"block\"><mrow><mrow><msup><mi>A</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>=</mo><mrow><mi>C</mi><mo>\u2062</mo><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><mo>-</mo><mrow><msub><mi>\u03bc</mi><mrow><mn>2</mn><mo>\u2062</mo><mi>L</mi></mrow></msub><mo>\u2062</mo><mi>I</mi></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\u03bc</mi><mrow><mn>2</mn><mo>\u2062</mo><mi>H</mi></mrow></msub><mo>\u2062</mo><mi>I</mi></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><msub><mi>\u03bc</mi><mrow><mn>1</mn><mo>\u2062</mo><mi>L</mi></mrow></msub><mo>\u2062</mo><mi>I</mi></mrow></mtd><mtd columnalign=\"center\"><mrow><mo>-</mo><mrow><msub><mi>\u03bc</mi><mrow><mn>1</mn><mo>\u2062</mo><mi>H</mi></mrow></msub><mo>\u2062</mo><mi>I</mi></mrow></mrow></mtd></mtr></mtable><mo>)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02355.tex", "nexttext": "\nwith $\\vec{\\mu}_{e}$ the image with different energy, and $K$ the low-pass filter kernel (usually an uniform kernel). The symbol $\\otimes$ stands for convolution operation. For dual-energy material decomposition, HYPR-LR has been applied to the high- and low-energy CT images to yield noised reduced images, as well as superior material-specific basis images~\\citep{leng2011}.\n\nIn this study, we \\textcolor{black}{demonstrated} the HYPR-LR algorithm can be applied directly to the dual energy material-specific images with composite image $\\vec{\\mu}_c$.\nFor dual-energy high- and low- energy images $\\vec{\\mu}_{H,L}$, the processed \\textcolor{black}{individual energy} images $\\vec{\\mu}_{he,H}$ and $\\vec{\\mu}_{he,L}$ using the HYPR-LR algorithm are calculated as follows,\n\n", "itemtype": "equation", "pos": 12059, "prevtext": "\n with \\textcolor{black}{matrix determinant} $C=(\\mu_{2H}\\mu_{1L}-\\mu_{1H}\\mu_{2L})^{-1}$. However, material decomposition in this manner \\textcolor{black}{can} yields significantly \\textcolor{black}{increased} noise and severely degraded noise-to-signals (NSRs) for the material-specific images. A method taking some measures to reduce the noise and to recover NSRs is highly desirable.\n\n\\subsection{HYPR-NLM}\n\nTo reduce the \\textcolor{black}{amplified} image noise in the decomposed material-specific images while keeping the images as accurate as possible (both quantitative measurement and spatial resolution), we developed an image-domain material images denoising algorithm. The algorithm \\textcolor{black}{was} based on the HYPR-LR (Local HighlY constrained backPRojection Reconstuction) framework~\\citep{mistretta2006,johnson2008,leng2011}, which was first proposed for reconstruction of time-resolved magnetic resonance imaging (MRI) using highly undersampled projection. The HYPR-LR framework has been successfully applied to a broad range of medical imaging applications, such as dynamic MRI~\\citep{johnson2008}, CT angiography~\\citep{supanich2009}, dynamic positron emission tomography~\\citep{christian2010}, spectral CT~\\citep{leng2011} and myocardial perfusion imaging~\\citep{speidel2013}. For noise reduction in spectral CT, the HYPR-LR algorithm \\textcolor{black}{treated} CT images at different energies as four-dimensional CT images, i.e., the energy dimension \\textcolor{black}{was} regarded as time dimension. It \\textcolor{black}{started} with producing a composite image $\\vec{\\mu}_c$ by averaging the energy images \\textcolor{black}{with equal weighting}, i.e. yielding an image with lower image noise level by using the images from different energy bins of photon-counting detector CT, or from high- and low-energy images of dual-energy CT. A weight image \\textcolor{black}{was} then generated by calculating the ratio of two filtered images, which \\textcolor{black}{were} obtained by filtering both the energy images $\\vec{\\mu}_{e}$ and the composite image $\\vec{\\mu}_c$. The final image $\\vec{\\mu}_{he}$ \\textcolor{black}{was} obtained by multiplying the weight image and the composite image. The mathematical form of HYPR-LR algorithm is as follows,\n\n", "index": 13, "text": "\\begin{equation}\\label{equ:HYPR-LR}\n\\vec{\\mu}_{he} = \\frac{\\vec{\\mu}_{e}\\otimes K}{\\vec{\\mu}_c \\otimes K} \\cdot \\vec{\\mu}_c\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"\\vec{\\mu}_{he}=\\frac{\\vec{\\mu}_{e}\\otimes K}{\\vec{\\mu}_{c}\\otimes K}\\cdot\\vec{%&#10;\\mu}_{c}\" display=\"block\"><mrow><msub><mover accent=\"true\"><mi>\u03bc</mi><mo stretchy=\"false\">\u2192</mo></mover><mrow><mi>h</mi><mo>\u2062</mo><mi>e</mi></mrow></msub><mo>=</mo><mrow><mfrac><mrow><msub><mover accent=\"true\"><mi>\u03bc</mi><mo stretchy=\"false\">\u2192</mo></mover><mi>e</mi></msub><mo>\u2297</mo><mi>K</mi></mrow><mrow><msub><mover accent=\"true\"><mi>\u03bc</mi><mo stretchy=\"false\">\u2192</mo></mover><mi>c</mi></msub><mo>\u2297</mo><mi>K</mi></mrow></mfrac><mo>\u22c5</mo><msub><mover accent=\"true\"><mi>\u03bc</mi><mo stretchy=\"false\">\u2192</mo></mover><mi>c</mi></msub></mrow></mrow></math>", "type": "latex"}, {"file": "1601.02355.tex", "nexttext": "\n\n", "itemtype": "equation", "pos": 12971, "prevtext": "\nwith $\\vec{\\mu}_{e}$ the image with different energy, and $K$ the low-pass filter kernel (usually an uniform kernel). The symbol $\\otimes$ stands for convolution operation. For dual-energy material decomposition, HYPR-LR has been applied to the high- and low-energy CT images to yield noised reduced images, as well as superior material-specific basis images~\\citep{leng2011}.\n\nIn this study, we \\textcolor{black}{demonstrated} the HYPR-LR algorithm can be applied directly to the dual energy material-specific images with composite image $\\vec{\\mu}_c$.\nFor dual-energy high- and low- energy images $\\vec{\\mu}_{H,L}$, the processed \\textcolor{black}{individual energy} images $\\vec{\\mu}_{he,H}$ and $\\vec{\\mu}_{he,L}$ using the HYPR-LR algorithm are calculated as follows,\n\n", "index": 15, "text": "\\begin{equation}\\label{equ:HYPR-LRh}\n\\vec{\\mu}_{he,H} = \\frac{\\vec{\\mu}_{H}\\otimes K}{\\vec{\\mu}_c \\otimes K} \\cdot \\vec{\\mu}_c,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m1\" class=\"ltx_Math\" alttext=\"\\vec{\\mu}_{he,H}=\\frac{\\vec{\\mu}_{H}\\otimes K}{\\vec{\\mu}_{c}\\otimes K}\\cdot%&#10;\\vec{\\mu}_{c},\" display=\"block\"><mrow><mrow><msub><mover accent=\"true\"><mi>\u03bc</mi><mo stretchy=\"false\">\u2192</mo></mover><mrow><mrow><mi>h</mi><mo>\u2062</mo><mi>e</mi></mrow><mo>,</mo><mi>H</mi></mrow></msub><mo>=</mo><mrow><mfrac><mrow><msub><mover accent=\"true\"><mi>\u03bc</mi><mo stretchy=\"false\">\u2192</mo></mover><mi>H</mi></msub><mo>\u2297</mo><mi>K</mi></mrow><mrow><msub><mover accent=\"true\"><mi>\u03bc</mi><mo stretchy=\"false\">\u2192</mo></mover><mi>c</mi></msub><mo>\u2297</mo><mi>K</mi></mrow></mfrac><mo>\u22c5</mo><msub><mover accent=\"true\"><mi>\u03bc</mi><mo stretchy=\"false\">\u2192</mo></mover><mi>c</mi></msub></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02355.tex", "nexttext": "\nBased on equation~(\\ref{equ:dirInverse}), the basis material image $\\vec{x}_{h1}$ calculated using $\\vec{\\mu}_{he,H}$ and $\\vec{\\mu}_{he,L}$ is expressed as,\n\\begin{eqnarray}\\label{equ:HYPR-LRb1}\n\\begin{split}\n\\vec{x}_{h1}=& -C\\left(\\mu_{2L}\\vec{\\mu}_{he,H}-\\mu_{2H}\\vec{\\mu}_{he,L}\\right) \\\\\n=&-C \\left( \\mu_{2L} \\frac{\\vec{\\mu}_{H}\\otimes K}{\\vec{\\mu}_c \\otimes K} \\cdot \\vec{\\mu}_c - \\mu_{2H}\\frac{\\vec{\\mu}_{L}\\otimes K}{\\vec{\\mu}_c \\otimes K} \\cdot \\vec{\\mu}_c \\right)\\\\\n=&-C\\left( \\frac{(\\mu_{2L}\\vec{\\mu}_{H}-\\mu_{2H}\\vec{\\mu}_{L}) \\otimes K}{\\vec{\\mu}_c \\otimes K} \\cdot \\vec{\\mu}_c\\right)\\\\\n=&\\frac{\\vec{x}_1 \\otimes K}{\\vec{\\mu}_c \\otimes K} \\cdot \\vec{\\mu}_c.\n\\end{split}\n\\end{eqnarray}\nThe above derivation has used the algebraic properties of convolution, i.e., the distributivity and the associativity of convolution with scalar multiplication. Following the fashion in equation~(\\ref{equ:HYPR-LRb1}), we have the same expression for the other basis material image $\\vec{x}_{h2}$.\n\n\n\nEquation~(\\ref{equ:HYPR-LRb1}) demonstrates the HYPR-LR algorithm can be applied directly to the material-specific image. \nThus we have,\n\n", "itemtype": "equation", "pos": 13114, "prevtext": "\n\n", "index": 17, "text": "\\begin{equation}\\label{equ:HYPR-LRl}\n\\vec{\\mu}_{he,L} = \\frac{\\vec{\\mu}_{L}\\otimes K}{\\vec{\\mu}_c \\otimes K} \\cdot \\vec{\\mu}_c.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m1\" class=\"ltx_Math\" alttext=\"\\vec{\\mu}_{he,L}=\\frac{\\vec{\\mu}_{L}\\otimes K}{\\vec{\\mu}_{c}\\otimes K}\\cdot%&#10;\\vec{\\mu}_{c}.\" display=\"block\"><mrow><mrow><msub><mover accent=\"true\"><mi>\u03bc</mi><mo stretchy=\"false\">\u2192</mo></mover><mrow><mrow><mi>h</mi><mo>\u2062</mo><mi>e</mi></mrow><mo>,</mo><mi>L</mi></mrow></msub><mo>=</mo><mrow><mfrac><mrow><msub><mover accent=\"true\"><mi>\u03bc</mi><mo stretchy=\"false\">\u2192</mo></mover><mi>L</mi></msub><mo>\u2297</mo><mi>K</mi></mrow><mrow><msub><mover accent=\"true\"><mi>\u03bc</mi><mo stretchy=\"false\">\u2192</mo></mover><mi>c</mi></msub><mo>\u2297</mo><mi>K</mi></mrow></mfrac><mo>\u22c5</mo><msub><mover accent=\"true\"><mi>\u03bc</mi><mo stretchy=\"false\">\u2192</mo></mover><mi>c</mi></msub></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02355.tex", "nexttext": "\nHere $\\vec{x}_{b}$ is the material-specific basis image, i.e. $\\vec{x}_{1}$ or $\\vec{x}_{2}$, and $\\vec{x}_{hb}$ is the processed basis image.\n In order to further reduce decomposed images noise without loss of high-frequency edge information, an edge-preserving non-local mean (NLM)~\\citep{buades2005} \\textcolor{black}{was} introduced into the HYPR framework. Edge-preserving techniques \\textcolor{black}{were} usually applied to yield noise reduced, spatial resolution well preserved images~\\citep{chen2008a,wangjin2009,zhu2009,chen2012,chun2014}. In this study, NLM \\textcolor{black}{was} employed to generate the weight image for the HYPR framework and the resulting algorithm \\textcolor{black}{was} referred as HYPR-NLM, hence equation~(\\ref{equ:HYPR-LRb}) \\textcolor{black}{was} rewritten in pixel-wise fashion as,\n\n", "itemtype": "equation", "pos": 14392, "prevtext": "\nBased on equation~(\\ref{equ:dirInverse}), the basis material image $\\vec{x}_{h1}$ calculated using $\\vec{\\mu}_{he,H}$ and $\\vec{\\mu}_{he,L}$ is expressed as,\n\\begin{eqnarray}\\label{equ:HYPR-LRb1}\n\\begin{split}\n\\vec{x}_{h1}=& -C\\left(\\mu_{2L}\\vec{\\mu}_{he,H}-\\mu_{2H}\\vec{\\mu}_{he,L}\\right) \\\\\n=&-C \\left( \\mu_{2L} \\frac{\\vec{\\mu}_{H}\\otimes K}{\\vec{\\mu}_c \\otimes K} \\cdot \\vec{\\mu}_c - \\mu_{2H}\\frac{\\vec{\\mu}_{L}\\otimes K}{\\vec{\\mu}_c \\otimes K} \\cdot \\vec{\\mu}_c \\right)\\\\\n=&-C\\left( \\frac{(\\mu_{2L}\\vec{\\mu}_{H}-\\mu_{2H}\\vec{\\mu}_{L}) \\otimes K}{\\vec{\\mu}_c \\otimes K} \\cdot \\vec{\\mu}_c\\right)\\\\\n=&\\frac{\\vec{x}_1 \\otimes K}{\\vec{\\mu}_c \\otimes K} \\cdot \\vec{\\mu}_c.\n\\end{split}\n\\end{eqnarray}\nThe above derivation has used the algebraic properties of convolution, i.e., the distributivity and the associativity of convolution with scalar multiplication. Following the fashion in equation~(\\ref{equ:HYPR-LRb1}), we have the same expression for the other basis material image $\\vec{x}_{h2}$.\n\n\n\nEquation~(\\ref{equ:HYPR-LRb1}) demonstrates the HYPR-LR algorithm can be applied directly to the material-specific image. \nThus we have,\n\n", "index": 19, "text": "\\begin{equation}\\label{equ:HYPR-LRb}\n\\vec{x}_{hb} = \\frac{\\vec{x}_{b}\\otimes K}{\\vec{\\mu}_c \\otimes K} \\cdot \\vec{\\mu}_c.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E10.m1\" class=\"ltx_Math\" alttext=\"\\vec{x}_{hb}=\\frac{\\vec{x}_{b}\\otimes K}{\\vec{\\mu}_{c}\\otimes K}\\cdot\\vec{\\mu}%&#10;_{c}.\" display=\"block\"><mrow><mrow><msub><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u2192</mo></mover><mrow><mi>h</mi><mo>\u2062</mo><mi>b</mi></mrow></msub><mo>=</mo><mrow><mfrac><mrow><msub><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u2192</mo></mover><mi>b</mi></msub><mo>\u2297</mo><mi>K</mi></mrow><mrow><msub><mover accent=\"true\"><mi>\u03bc</mi><mo stretchy=\"false\">\u2192</mo></mover><mi>c</mi></msub><mo>\u2297</mo><mi>K</mi></mrow></mfrac><mo>\u22c5</mo><msub><mover accent=\"true\"><mi>\u03bc</mi><mo stretchy=\"false\">\u2192</mo></mover><mi>c</mi></msub></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02355.tex", "nexttext": "\nwhere the weight $\\omega(i,j)$ depicts the similarity between the pixels $i$ and $j$, \\textcolor{black}{and it satisfies the constraint conditions $0\\leq \\omega(i,j) \\leq 1$ and $\\underset{j} \\sum \\omega(i,j)=1$ (as demonstrated later)}. The pixel dependent summation domain $\\Omega_i$ denotes a search-window centered at the pixel $i$ and it is usually a square neighborhood with fixed size. Thus each pixel of the filtered image is a weighted summation of a square neighborhood. \\textcolor{black}{For the right hand side of equation~(\\ref{equ:HYPR-NLM}), $\\omega(i,j)$ is applied to the material images in the numerator, and to the composite image in the denominator.}.\n\nThe similarity between pixels $i$ and $j$ can be measured using a weighted Euclidean distance of two square neighborhoods centered at pixels $i$ and $j$, thus the weight $\\omega(i,j)$ is defined as,\n\n", "itemtype": "equation", "pos": 15351, "prevtext": "\nHere $\\vec{x}_{b}$ is the material-specific basis image, i.e. $\\vec{x}_{1}$ or $\\vec{x}_{2}$, and $\\vec{x}_{hb}$ is the processed basis image.\n In order to further reduce decomposed images noise without loss of high-frequency edge information, an edge-preserving non-local mean (NLM)~\\citep{buades2005} \\textcolor{black}{was} introduced into the HYPR framework. Edge-preserving techniques \\textcolor{black}{were} usually applied to yield noise reduced, spatial resolution well preserved images~\\citep{chen2008a,wangjin2009,zhu2009,chen2012,chun2014}. In this study, NLM \\textcolor{black}{was} employed to generate the weight image for the HYPR framework and the resulting algorithm \\textcolor{black}{was} referred as HYPR-NLM, hence equation~(\\ref{equ:HYPR-LRb}) \\textcolor{black}{was} rewritten in pixel-wise fashion as,\n\n", "index": 21, "text": "\\begin{equation}\\label{equ:HYPR-NLM}\nx_{hb}(i) = \\frac{\\underset{j\\in \\Omega_i} \\sum \\omega(i,j)x_{b}(j)}{\\underset{j\\in \\Omega_i} \\sum \\omega(i,j) \\mu_c(j)} \\mu_c(i),\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E11.m1\" class=\"ltx_Math\" alttext=\"x_{hb}(i)=\\frac{\\underset{j\\in\\Omega_{i}}{\\sum}\\omega(i,j)x_{b}(j)}{\\underset{%&#10;j\\in\\Omega_{i}}{\\sum}\\omega(i,j)\\mu_{c}(j)}\\mu_{c}(i),\" display=\"block\"><mrow><mrow><mrow><msub><mi>x</mi><mrow><mi>h</mi><mo>\u2062</mo><mi>b</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mrow><munder accentunder=\"true\"><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><mi>j</mi><mo>\u2208</mo><msub><mi mathvariant=\"normal\">\u03a9</mi><mi>i</mi></msub></mrow></munder><mo>\u2062</mo><mi>\u03c9</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>x</mi><mi>b</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>j</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><munder accentunder=\"true\"><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><mi>j</mi><mo>\u2208</mo><msub><mi mathvariant=\"normal\">\u03a9</mi><mi>i</mi></msub></mrow></munder><mo>\u2062</mo><mi>\u03c9</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>\u03bc</mi><mi>c</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>j</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac><mo>\u2062</mo><msub><mi>\u03bc</mi><mi>c</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02355.tex", "nexttext": "\nwhere $\\Theta_i$ and $\\Theta_j$ are two square neighborhoods centered at pixels $i$ and $j$, respectively. The parameter $d$ controls the decay of the exponential function and it acts as a degree of filtering. The parameter $a$ is the standard deviation (SD) of a Gaussian kernel \\textcolor{black}{which has the same size as the square neighborhood. During numerical implementation, the Gaussian kernel gives weights to the Euclidean distance of the two square neighborhoods}. $Z(i)$ is the normalization constant calculated as,\n\n", "itemtype": "equation", "pos": 16406, "prevtext": "\nwhere the weight $\\omega(i,j)$ depicts the similarity between the pixels $i$ and $j$, \\textcolor{black}{and it satisfies the constraint conditions $0\\leq \\omega(i,j) \\leq 1$ and $\\underset{j} \\sum \\omega(i,j)=1$ (as demonstrated later)}. The pixel dependent summation domain $\\Omega_i$ denotes a search-window centered at the pixel $i$ and it is usually a square neighborhood with fixed size. Thus each pixel of the filtered image is a weighted summation of a square neighborhood. \\textcolor{black}{For the right hand side of equation~(\\ref{equ:HYPR-NLM}), $\\omega(i,j)$ is applied to the material images in the numerator, and to the composite image in the denominator.}.\n\nThe similarity between pixels $i$ and $j$ can be measured using a weighted Euclidean distance of two square neighborhoods centered at pixels $i$ and $j$, thus the weight $\\omega(i,j)$ is defined as,\n\n", "index": 23, "text": "\\begin{equation}\\label{equ:weight}\n\\omega(i,j) = \\frac{1}{Z(i)}exp\\left(-\\frac{\\|\\vec{\\mu}(\\Theta_i)-\\vec{\\mu}(\\Theta_j)\\|^2_{2,a}}{d^2}\\right),\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E12.m1\" class=\"ltx_Math\" alttext=\"\\omega(i,j)=\\frac{1}{Z(i)}exp\\left(-\\frac{\\|\\vec{\\mu}(\\Theta_{i})-\\vec{\\mu}(%&#10;\\Theta_{j})\\|^{2}_{2,a}}{d^{2}}\\right),\" display=\"block\"><mrow><mrow><mrow><mi>\u03c9</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><mrow><mi>Z</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>x</mi><mo>\u2062</mo><mi>p</mi><mo>\u2062</mo><mrow><mo>(</mo><mrow><mo>-</mo><mfrac><msubsup><mrow><mo>\u2225</mo><mrow><mrow><mover accent=\"true\"><mi>\u03bc</mi><mo stretchy=\"false\">\u2192</mo></mover><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"normal\">\u0398</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mover accent=\"true\"><mi>\u03bc</mi><mo stretchy=\"false\">\u2192</mo></mover><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"normal\">\u0398</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>\u2225</mo></mrow><mrow><mn>2</mn><mo>,</mo><mi>a</mi></mrow><mn>2</mn></msubsup><msup><mi>d</mi><mn>2</mn></msup></mfrac></mrow><mo>)</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02355.tex", "nexttext": "\nBased on the above definition, $\\omega(i,j)$ satisfies the constraint conditions.\n\n\n\\subsection{Iterative image-domain material decomposition}\n\n\\textcolor{black}{Since dual-energy material decomposition can yield noise amplified images, for comparison, we also \\textcolor{black}{used} an iterative image domain material decomposition method which significantly \\textcolor{black}{reduced} the noise of the material-specific images with superior performance on image spatial resolution and low-contrast detectability~\\citep{niu2014}. The method \\textcolor{black}{balanced} the data fidelity of the value of the material image and a quadratic penalty using an optimization framework, and the unconstrained optimization problem \\textcolor{black}{was} solved by the nonlinear conjugate gradient method (see the Appendix for details). In this work, we \\textcolor{black}{referred} this method as Iter-DECT.}\n\n\\subsection{Numerical simulation studies}\n\nTo evaluate the proposed HYPR-NLM dual-energy material decomposition algorithm, we first \\textcolor{black}{used} simulated phantom data. For all of the simulation studies, the high- and low-energy CT images \\textcolor{black}{were} first employed to generate the material-specific basis images, which \\textcolor{black}{were} then processed using HYPR-NLM method to yield noise reduced images. These images \\textcolor{black}{were} compared to the images generated using direct matrix inversion, Iter-DECT and HYPR-LR methods and the results \\textcolor{black}{were} quantitatively analyzed.\n\nIn all of the simulations, \\textcolor{black}{a} 2D fan-beam CT geometry \\textcolor{black}{was} performed. The distance from the source to the center of rotation \\textcolor{black}{was} 785 mm and the distance from the source to the detector \\textcolor{black}{was} 1200 mm. A circular scan \\textcolor{black}{was} simulated and a total of 720 projections per rotation were acquired in an angular range of $360^0$. The detector pixel size \\textcolor{black}{was} 0.388 mm and the detector \\textcolor{black}{had} 1024 pixels. The dual-energy spectra \\textcolor{black}{were} 100 kVp and 140 kVp, which were generated using the SpekCalc software~\\citep{poludniowski2009} with 12 mm Al and 0.4 mm Sn + 12 mm Al filtration, respectively.\n\nThe phantom \\textcolor{black}{was} a water cylinder with inserts that \\textcolor{black}{contains} a series of six solutions of varying iodine concentrations (range, 0-20 mg/mL). The diameters of the water cylinder and the inserts \\textcolor{black}{were} 198 mm and 22.5 mm, respectively.\n\n\\textcolor{black}{To be realistic, Poisson noise was considered during the numerical simulations}. \\textcolor{black}{The fan beam CT projection data was created by polychromatic forward projecting the numerical phantom. Specifically, after introducing Poisson noise~\\citep{nuyts2013}, the projection data can be represented as:\n\n", "itemtype": "equation", "pos": 17095, "prevtext": "\nwhere $\\Theta_i$ and $\\Theta_j$ are two square neighborhoods centered at pixels $i$ and $j$, respectively. The parameter $d$ controls the decay of the exponential function and it acts as a degree of filtering. The parameter $a$ is the standard deviation (SD) of a Gaussian kernel \\textcolor{black}{which has the same size as the square neighborhood. During numerical implementation, the Gaussian kernel gives weights to the Euclidean distance of the two square neighborhoods}. $Z(i)$ is the normalization constant calculated as,\n\n", "index": 25, "text": "\\begin{equation}\\label{equ:weight}\nZ(i) = \\underset{j} \\sum exp\\left(-\\frac{\\|\\vec{\\mu}(\\Theta_i)-\\vec{\\mu}(\\Theta_j)\\|^2_{2,a}}{d^2}\\right).\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E13.m1\" class=\"ltx_Math\" alttext=\"Z(i)=\\underset{j}{\\sum}exp\\left(-\\frac{\\|\\vec{\\mu}(\\Theta_{i})-\\vec{\\mu}(%&#10;\\Theta_{j})\\|^{2}_{2,a}}{d^{2}}\\right).\" display=\"block\"><mrow><mrow><mrow><mi>Z</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munder accentunder=\"true\"><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mo>\ud835\udc57</mo></munder><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>x</mi><mo>\u2062</mo><mi>p</mi><mo>\u2062</mo><mrow><mo>(</mo><mrow><mo>-</mo><mfrac><msubsup><mrow><mo>\u2225</mo><mrow><mrow><mover accent=\"true\"><mi>\u03bc</mi><mo stretchy=\"false\">\u2192</mo></mover><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"normal\">\u0398</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mover accent=\"true\"><mi>\u03bc</mi><mo stretchy=\"false\">\u2192</mo></mover><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"normal\">\u0398</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>\u2225</mo></mrow><mrow><mn>2</mn><mo>,</mo><mi>a</mi></mrow><mn>2</mn></msubsup><msup><mi>d</mi><mn>2</mn></msup></mfrac></mrow><mo>)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02355.tex", "nexttext": "\nwith $N$ the total number of photons and was set to $3\\times10^5$ and $1.5\\times10^5$ per ray for the low- and high-energy CT scans, respectively. $\\eta(E)$ \\textcolor{black}{was} the energy dependent response of the detector, which was considered to be proportional to photon energy $E$ for energy-integrating detectors. $E_{max}$ \\textcolor{black}{was} the maximum photon energy of the polychromatic spectrum $\\Omega(E)$. $\\mu(E,s)$ \\textcolor{black}{was} the energy-dependent linear attenuation coefficient and \\textcolor{black}{was} obtained from the National Institute of Standards and Technology (NIST) database. $l$ \\textcolor{black}{was} the propagation path length for each ray and can be calculated using either analytical methods or numerical methods.} The x-ray spectra and the phantom are shown in figure~\\ref{fig:f1}. The linear attenuation coefficients of the iodine concentrate inserts \\textcolor{black}{calculated using the mixture rule, }are show in figure~\\ref{fig:f2}. Note that the $y$ axis is plotted on a logarithmic scale. \\textcolor{black}{First order beam hardening correction (water correction) was performed by simply mapping the polychromatic raysum to the corresponding monochromatic value with the incorporation of the 100 kVp and 140 kVp energy spectra.}\n\nThe calculated iodine concentrations in the phantom using different algorithms were compared with known true iodine concentrations. For comparison, direct matrix inversion without noise was also performed and the results were regarded as absolute truth. Difference image between the \\textcolor{black}{absolute truth} and the images processed using different kinds of algorithms were also generated to emphasize resolution preservation and noise reduction of these algorithms.\n\n\\begin{figure}[t]\n    \\centering\n    \n    \\includegraphics[width=5in]{figures_1.pdf}\n    \n    \\caption{Iodine concentrate phantom and x-ray spectra for numerical simulation of the dual energy material decomposition. (Left) The water phantom consists of six iodine concentrate inserts. (Right) The 100 kVp and 140 kVp energy spectra used in dual energy CT. The 100 kVp spectrum was filtrated with and 12 mm Al, while the 140 kVp spectrum was filtrated with 0.4 mm Sn and 12 mm Al.}\n    \\vspace{-1em}\n    \\label{fig:f1}\n\\end{figure}\n\n\\begin{figure}[t]\n    \\centering\n    \n    \\includegraphics[width=3in]{figures_2_r1.pdf}\n    \n    \\caption{Linear attenuation coefficients of the iodine concentrate inserts.}\n    \\vspace{-1em}\n    \\label{fig:f2}\n\\end{figure}\n\n\\subsubsection{Parameters selection}\n\nSince the parameters in the NLM filter would affect the filtered image, it \\textcolor{black}{was} important to investigate the parameters selection on the final noise reduced material-specific images.\nIn this simulation, the search window size $S\\times S$ \\textcolor{black}{was} set to different values, specifically, from 11 pixels to 19 pixels with a 4 pixels interval. Material-specific images processed using HYPR-LR and HYPR-NLM methods \\textcolor{black}{were} generated and compared.\nDifference images between the noise-free material images and the noisy material images generated using HYPR-LR and HYPR-NLM methods, \\textcolor{black}{were} calculated to depict the preservation of spatial resolution.\n\n\\subsubsection{Iteration formulation}\n\nIn order to further reduce the noise, the proposed method can be implemented in an iterative fashion, i.e., the HYPR-NLM processed material images \\textcolor{black}{were} set as the input images of the next HYPR-NLM iteration. Images processed with different iteration number \\textcolor{black}{were} generated and compared.\n\n\\subsubsection{Effect of dose level}\n\n\\textcolor{black}{To determine its robustness across different noise levels, we also \\textcolor{black}{evaluated} the proposed HYPR-NLM method using various numbers of photons (dose levels). Numerical phantom studies using four pairs of numbers of photons ($H/L=0.5\\times10^{5}/1\\times10^{5}, 1\\times10^{5}/2\\times10^{5}, 1.5\\times10^{5}/3\\times10^{5}$, and $2\\times10^{5}/4\\times10^{5}$) \\textcolor{black}{were} performed and HYPR-NLM method was employed to generate material images. For all of the simulations, the parameters of the HYPR-NLM \\textcolor{black}{were} the same. Quantitative measurements including iodine concentration and noise level \\textcolor{black}{were} evaluated to show the method's performance on various protocols.}\n\n\\subsection{Clinical patient data}\n\nTo evaluate the proposed method, two retrospective clinical patient studies were also performed with a dual-source DECT scanner (Somatom Definition, Siemens Healthcare).\nThe system acquired high- and low-energy data with two x-ray tubes with corresponding detector rings mounted onto a rotating gantry with angular offset of $90^\\circ$. The two tubes (tube 1 and 2) operated independently with regard to tube voltage, tube current as well as tube filtration. Dual-energy data were acquired using the following parameters: tube 1, 140 kVp, 287 mA and tube 2, 100 kVp, 412 mA for patient 1; tube 1, 140 kVp, 345 mA and tube 2, 100 kVp, 500 mA for patient 2. The 140 kV spectrum \\textcolor{black}{was} filtered with a tin filter. Images were reconstructed using the commercial software with the convolution kernel B25f for patient 1 and B26f for patient 2. All of the image slices were reconstructed in 0.75 mm slice thickness. \\textcolor{black}{The matrix size for each slice \\textcolor{black}{was} $512\\times512$, and the pixel size \\textcolor{black}{was} $0.38\\times0.38$ mm$^2$.} Blending images were also generated with a linear combination (with weighting factors of 0.3 and 0.7) of the 100 kV and 140 kV images. \nTo obtain contrast-enhanced CT images, the contrast agent of 300 mg I/mL was injected in an antecubital vein (300 mg I/mL,Ultravist 300, Bayer HealthCare).\n\n\\textcolor{black}{The noise in the raw CT images \\textcolor{black}{was} quantified using region-of-interest (ROI) analysis. Two ROIs \\textcolor{black}{were} selected to calculate noise-to-signal ratio (NSR) of myocardium and ventricle, respectively.} Myocardial perfusion imaging was conducted and iodine concentration map was calculated using direct matrix inversion, HYPR-LR, Iter-DECT and HYPR-NLM. We conducted all of the evaluations on a personal laptop \\textcolor{black}{which featured four Intel Core i7-4700HQ CPUs, and all of the material decomposition algorithms were implemented using MATLAB (The MathWorks, Inc., Natick, MA, United States)}. \n\n\\section{Results}\n\\subsection{Numerical simulations}\n\\begin{figure}\n    \\centering\n    \n    \\includegraphics[width=3.5in]{figures_3.pdf}\n    \\caption{Reconstruction and direct dual-energy decomposition results of the numerical iodine concentrate phantom simulation. The first row shows the 100 kV and 140 kV CT images. Note that the first order beam hardening correction (water correction) has been performed for the CT images of both energies.\n    Dual-energy decomposition without water correction yield cupping artifacts and inhomogeneity for the material images.}\n    \\label{fig:100kV140kVdiff}\n\\end{figure}\n\nImage reconstruction results of the numerical iodine concentrate phantom are shown in figure~\\ref{fig:100kV140kVdiff}. Water and the 20 mg/mL iodine concentrate are chosen as the basis materials for dual-energy material decomposition. Other iodine concentrates are expected to show up in the decomposed image corresponding to the contribution of their mass attenuation coefficients to the mass attenuation coefficient of the chosen basis material. In the first row, the 100 kV and 140 kV images and the difference between these two images are depicted. The 100 kV image shows superior iodine contrast, as expected. Note that the images of both energies have been corrected using the first order beam hardening correction algorithm and there are residual high order beam hardening artifacts (streaks) between high attenuation iodine concentrates, especially for the 100 kV image where the spectrum is much softer.\n\nThe second and the third rows show dual-energy material decomposition results using direct matrix inversion with and without water correction. As can be seen, dual-energy material decomposition yield residual cupping artifacts in the material images without water correction, and the water image and the iodine image are inhomogeneous. The difference images further clearly show the cupping artifacts and inhomogeneity. This is because the image-domain matrix inversion just linearly combine the high- and low-energy images, and \\textcolor{black}{does} not take the nonlinear attenuation process of X-ray projection into account.\n\n\\begin{figure}[t]\n    \\centering\n    \n    \\includegraphics[width=5in]{figures_4_r1.pdf}\n    \n    \\caption{Iodine image noise measured at the six regions of interest for the cylinder phantom using HYPR-NLM method with different search window sizes (a) and different iteration numbers (b). For comparison, noise measured using direct matrix inversion and Iter-DECT are also depicted. }\n    \\label{fig:paraselection}\n    \\vspace{-1.5em}\n\\end{figure}\n\n\\begin{figure}[t]\n    \\centering\n    \\includegraphics[width=4.0in]{figures_5_r1.pdf}\n    \n    \\caption{\\textcolor{black}{Results of the numerical phantom study with respect to different parameters. Iodine images processed using HYPR-LR and HYPR-NLM with different window sizes and iteration number N (a). The difference images are the subtraction of the iodine image generated using direct inversion without noise and the individual processed iodine images. Line profiles (corresponding to the yellow line in the upper-left corner) of the iodine images processed using HYPR-LR (b) and HYPR-NLM (c) with different parameters. For comparison, line profile obtained using direct matrix inversion is also depicted (Original). }}\n    \\label{fig:f5}\n\\end{figure}\n\n\\begin{figure}[t]\n    \\centering\n    \n    \\includegraphics[width=4.0in]{figures_12_r1.pdf}\n    \\caption{\\textcolor{black}{Dual energy decomposed images of the iodine concentrate numerical phantom using HYPR-NLM at different numbers of photons. The difference is the subtraction of the images generated using direct inversion without noise and the HYPR-NLM images. H and L stand for the number of high- and low-energy photons per ray, respectively. The standard deviation (Std) of the ROI reduces as the number of photons increases.}}\n    \\label{fig:dose}\n    \n\\end{figure}\n\nFigure~\\ref{fig:paraselection} shows the noise of the ROIs (labelled in figure~\\ref{fig:f1}(a)) of the iodine images processed using HYPR-NLM method with different parameters. The noise reduction of HYPR-NLM with different search window sizes are depicted in figure~\\ref{fig:paraselection}(a). For comparison, the results of direct matrix inversion and Iter-DECT are also present. For non-iterative HYPR-NLM formulation (i.e. the iteration number N = 1), noise magnitude is significantly reduced using HYPR-NLM method and there is no significant change between HYPR-NLM with different search windows sizes, namely, with search window size from $11\\times 11$ to $19\\times 19$. Thus in the following studies, we use search window size of $11\\times 11$ for computational consideration. The results of noise reduction using iterative HYPR-NLM with different iterations \\textcolor{black}{are} shown in figure~\\ref{fig:paraselection}(b). As can been seen, with two iterations (N = 2), HYPR-NLM provides results that have comparable noise magnitude as the results of Iter-DECT method.\n\nFigure~\\ref{fig:f5}(a) shows the results of the iodine images processed using HYPR-LR and HYPR-NLM with different window sizes. Different from HYPR-LR method, which results in spatial blurring as the uniform kernel size increases from $5\\times 5$ to $11\\times 11$, the edges do not have significant change for the HYPR-NLM with search window sizes from $11\\times 11$ to $19\\times 19$ and iteration numbers from one to two. As indicated in the difference images, there are clear edge effects for the HYPR-LR method, while there are marginal edge effects for the HYPR-NLM method, suggesting the edge of the iodine images are well preserved using the HYPR-NLM method with different search window sizes. \\textcolor{black}{Line profiles of the iodine images processed using HYPR-LR with different window sizes, and HYPR-NLM with different window sizes as well as iteration numbers are illustrated in figure~\\ref{fig:f5}(b) and (c). These profiles clearly demonstrate HYPR-NLM can provide superior images with respect to edge-preservation, and the method is robust against parameters selection. }\n\n\\textcolor{black}{Figure~\\ref{fig:dose} shows the results of dual-energy material decomposition images using HYPR-NLM method at different number of photons and quantitative analysis of the ROIs. Again, the difference image is the subtraction of the image obtained using noise-free direct matrix inversion and the HYPR-NLM image. As can be seen, HYPR-NLM works well for different scenarios. ROIs analyses indicate HYPR-NLM significantly reduces noise while preserving quantitative iodine concentration. The standard deviation of the ROI reduces as the number of photons increases. Note that H and L stand for the number of high- and low-energy photons, respectively.} \n\nMaterial-specific images of the numerical iodine concentrate phantom obtained using direct matrix inversion, HYPR-LR, Iter-DECT and HYPR-NLM algorithms are shown in figure~\\ref{fig:f6}. As can be seen, both HYPR-LR and Iter-DECT yield residual edge effects in the difference images, suggesting there are certain degree of spatial resolution degradation. However, there are marginal edge effects for the results of HYPR-NLM algorithm, showing there is minimal loss of spatial resolution. Iodine concentrations of the ROIs (labeled in figure~\\ref{fig:f1}(a)) measured using different algorithms \\textcolor{black}{are} shown in Table~\\ref{tab:iodineConcentration}. Compared to the true values of the iodine concentrate inserts, the quantitative \\textcolor{black}{measurements} of iodine concentration using the four algorithms \\textcolor{black}{are} well preserved. \n\n\\begin{figure}[t]\n    \\centering\n    \n    \\includegraphics[width=4.0in]{figures_6.pdf}\n    \\caption{Dual-energy decomposed images of the iodine concentrate numerical phantom using direct matrix inversion, HYPR-LR, iterative material decomposition and HYPR-NLM. The difference is the subtraction of the images generated using direct inversion without noise and the four different methods.}\n    \\label{fig:f6}\n    \n\\end{figure}\n\n\\begin{table}\n\\caption{Iodine concentration measured using different image-domain dual-energy material decomposition algorithms and true iodine concentration in phantom.}\n\\label{tab:iodineConcentration}\n\\begin{center}\n\\begin{tabular}{p{0.15\\textwidth}<{\\centering}p{0.15\\textwidth}<{\\centering}\np{0.15\\textwidth}<{\\centering}p{0.15\\textwidth}<{\\centering}p{0.15\\textwidth}<{\\centering}} \n\\toprule\n\\rule[-1ex]{0pt}{3.5ex}   True value (mg/mL) & Direct inversion (mg/mL)& HYPR (mg/mL)& Iter-DECT (mg/mL)& HYPR-NLM (mg/mL)\\\\\n\\hline\n\\rule[-1ex]{0pt}{3.5ex}   0 & 0.10 & 0.10 & 0.12 & 0.10  \\\\\n\\rule[-1ex]{0pt}{3.5ex}   4 & 4.24 & 4.26 & 4.24 & 4.26  \\\\\n\\rule[-1ex]{0pt}{3.5ex}   8 & 8.36 & 8.36 & 8.34 & 8.36  \\\\\n\\rule[-1ex]{0pt}{3.5ex}   12 & 12.26 & 12.24 & 12.22 & 12.24  \\\\\n\\rule[-1ex]{0pt}{3.5ex}   16 & 16.08 & 16.10 & 16.06 & 16.10  \\\\\n\\rule[-1ex]{0pt}{3.5ex}   20 & 19.94 & 19.94 & 19.92 & 19.94  \\\\\n\\bottomrule\n\\end{tabular}\n\n\\end{center}\n\n\\end{table}\n\n\n\n\n\n\\subsection{Patient study}\n\nFigure~\\ref{fig:f7} shows the low-energy (100 kV), high-energy (140 kV) CT images and \\textcolor{black}{their} linear blending images \\textcolor{black}{with weighting factors of 0.3 and 0.7 \\textcolor{black}{for} the myocardial perfusion imaging of patient 1. Two regions-of-interests (ROI) A and B are labelled respectively on myocardium and ventricle to calculate their NSRs. The NSRs of the myocardium for the 100 kV and 140 kV CT images are $34.6\\%$ and $27.9\\%$, respectively. While the NSRs of the ventricle for the 100 kV and 140 kV CT images are $5.3\\%$ and $5\\%$, respectively. For both ROIs, the NSRs of the 100 kV images are higher than the 140 kV images. This may be the reason why the 140 kV image has a higher weighting factor in the blending image. }Water image, and iodine contrast image decomposed using the high- and low-energy images with different algorithms are present in figure~\\ref{fig:f8}. As can be seen, dual-energy material decomposition using direct matrix inversion yields \\textcolor{black}{increased} noise. HYPR-LR reduces the noise level to a certain extent. Iter-DECT significantly reduces the amplified noise. For both of the water and iodine images, HYPR-NLM \\textcolor{black}{shows} superior image quality. Quantitative \\textcolor{black}{measurements} of iodine concentration and noise reduction of the labelled ROIs are depicted in table~\\ref{tab:patientData}. \n\\begin{figure*}[t]\n    \\centering\n    \\includegraphics[width=0.6\\textwidth]{figures_7_r1.pdf}\n    \\caption{Patient 1, 100 kV (left), 140 kV (middle) and blending (right) CT images of myocardial perfusion imaging using dual-source DECT scanner (C = 0 HU, W = 1000 HU). \\textcolor{black}{The two region-of-interests A and B (red circles) are used to calculate signal-to-noise ratio of myocardium and ventricle, respectively.}}\n    \\label{fig:f7}\n\\end{figure*}\n\n\\begin{figure*}[t]\n    \\centering\n    \\includegraphics[width=0.72\\textwidth]{figures_8.pdf}\n    \\caption{Patient 1, dual-energy decomposed images of myocardial perfusion imaging using direct matrix inversion, HYPR-LR, Iter-DECT and HYPR-NLM.}\n    \\label{fig:f8}\n\\end{figure*}\n\nThe images of patient 2, a case with motion artifact presented in figures~\\ref{fig:f9}-\\ref{fig:f10}, provides a challenging situation for dual-energy material decomposition. \\textcolor{black}{This is because myocardial imaging is often compromised by motion blur, leading to DECT artefacts.} The blurring edge labelled in the 100 kV image of figure~\\ref{fig:f9} does not \\textcolor{black}{have a} consistent profile \\textcolor{black}{compared to} the 140 kV image, which shows a sharper edge \\textcolor{black}{here}. This happens for the labelled edge for the 140 kV image as well. Again, the blending image shows the linear combination of the 100 kV and 140 kV CT images.\n\n\\begin{figure*}\n    \\centering\n    \\includegraphics[width=0.6\\textwidth]{figures_9.pdf}\n    \\caption{Patient 2, 100 kV (left), 140 kV (middle) and blending (right) CT images of myocardial perfusion imaging using dual-source DECT scanner (C = 0 HU, W = 1000 HU). }\n    \\label{fig:f9}\n\\end{figure*}\n\n\\textcolor{black}{Water} images and iodine contrast images, as shown in figure~\\ref{fig:f10}, clearly depict the error induced by motion. Still, there are marginal edge effects for HYPR-NLM processed images, suggesting improvements compared to HYPR-LR and Iter-DECT. Dual-energy decomposition using HYPR-NLM leads to more homogeneous results and more significant noise reduction.\n\n\\begin{figure*}[bt]\n    \\centering\n    \n    \\includegraphics[width=0.72\\textwidth]{figures_10.pdf}\n    \\caption{Patient 2, dual-energy decomposed images of myocardial perfusion imaging using direct matrix inversion, HYPR-LR, Iter-DECT and HYPR-NLM. The difference is the subtraction of the direct inversion and the other methods.}\n    \\label{fig:f10}\n\\end{figure*}\n\nTable~\\ref{tab:patientData} shows the mean values and standard deviations of the ROIs measured using direct matrix inversion, HYPR-LR, Iter-DECT and HYPR-NLM algorithms. \\textcolor{black}{Note that the NSR for direct matrix inversion is approximately $30\\%$ for both basis material images and is reduced by factors for approximately 2, 3 and 5 for HYPR-LR, Iter-DECT and HYPR-NLM, respectively.} The computational time for \\textcolor{black}{each slice} per iteration for HYPR-NLM is about 280 s, compared to 300 s for Iter-DECT. There are no significant differences between the mean values measured using the four algorithms, suggesting the quantitative measurements of iodine concentration are acceptable for all four approaches. For noise reduction, direct inversion and HYPR-NLM yield the highest and the lowest noise level, respectively. HYPR-NLM outperforms HYPR-LR in both resolution preservation and noise reduction.\n\n\\begin{table*}\n\n\\caption{The mean values and standard deviations of the ROIs (labeled as \\#1 and \\#2 in figure~\\ref{fig:f8},~\\ref{fig:f10}) of the myocardial data.}\n\\vspace{-1.5mm}\n\\label{tab:patientData}\n\\begin{center}\n\n\n\\begin{tabular}{cccccc}\n\\toprule\n\n &    & Direct inversion & HYPR-LR & Iter-DECT & HYPR-NLM \\\\\n\\hline\n\\multicolumn{1}{ c }{\\multirow{2}{*}{Patient 1} } & Water image & 1.16$\\pm$0.36 & 1.16$\\pm$0.16 & 1.16$\\pm$0.12 & 1.16$\\pm$0.08 \\\\& Iodine image & 0.99$\\pm$0.31 & 0.99$\\pm$0.14 & 0.99$\\pm$0.12 & 0.99$\\pm$0.08 \\\\\n\\hline\n\\multicolumn{1}{ c }{\\multirow{2}{*}{Patient 2} } & Water image  & 1.04$\\pm$0.34 & 1.04$\\pm$0.18 & 1.04$\\pm$0.08 & 1.04$\\pm$0.07\\\\\n&Iodine image & 0.97$\\pm$0.28 & 0.98$\\pm$0.14 & 0.98$\\pm$0.06 & 0.98$\\pm$0.05 \\\\\n\n\n\\bottomrule\n\\end{tabular}\n\\end{center}\n\\end{table*}\n\n\n\n\\section{Discussion and Conclusion}\n\n\\label{sec:discussion}\n\nHYPR-NLM has shown to provide sensible results for noise reduction of image-domain dual-energy material decomposition. For numerical simulation studies, where there exists \\textcolor{black}{certainty} (noiseless material images obtained using direct matrix inversion), HYPR-NLM outperforms both HYPR-LR and Iter-DECT for spatial resolution preservation. For the clinical myocardial perfusion imaging studies, to show the edge preservation of the dual-energy material-decomposition algorithms, material-specific images are subtracted from the noisy images generated using direct inversion to see whether there are any noticeable anatomical features present.\n\n\\textcolor{black}{We have demonstrated that the HYPR framework can be applied directly to the basis material images. The initial basis material images can be generated using matrix inversion because this method performs material decomposition without compromising spatial details, which can be exploited by the HYPR-NLM algorithm to yield both noise reduced and spatial information well preserved material images. To achieve this goal, it is also possible to filter the DECT images before the application of material decomposition, or directly apply a feature preserved noise reduction filter on the material decomposition images~\\citep{cai2015}. In the future, comprehensive comparative studies of these methods will be performed after sufficient experiences and data are accumulated. }\n\nFor the HYPR-LR algorithm, an uniform kernel is employed to convolve with the energy image and the composite image, thus anatomical structures of the local neighborhood are introduced into the processed image. When the window size of the uniform kernel increases, more local features are introduced into the convolution, resulting spatial information degraded material-specific images, as depicted in the first row of figure~\\ref{fig:f5}. To the contrary, for the HYPR-NLM algorithm, the non-local mean is employed in the convolution procedure. The resulting image is a weighted average of all pixels in the original image, where the weight is determined by similarity between two pixels and the similarity is a measurement of the geometrical configuration in a square neighborhood $\\Theta$. Thus pixels with a similar image value in \\textcolor{black}{their neighborhoods} have larger weights and contribute more in the whole image averaging, while local pixels may have smaller weights and consequently contribute less if their geometrical configurations are not similar to the targeting pixel. In this case, since all of the image pixels can contribute to the targeting pixel according to their similarities, few local features are introduced and spatial information is well preserved in the final material image. In addition, the similarity depended weights make HYPR-NLM robust with respect to the size of averaging window (the search window), as indicated in the third row of figure~\\ref{fig:f5}. It has to note instead of using the whole image, we have restricted the search windows in size of $11\\times11, 15\\times15, 19\\times19$ pixels for computational purpose.\n\n\n\\textcolor{black}{For DECT imaging, the low- and high-energy CT images have geometrical self-similarities, which have been widely used in dynamic tomography reconstruction. When the HYPR-LR algorithm is applied to the CT images, the self-similarities are exploited by the composite image which has lower image noise level than the individual CT images. In this sense, the energy dimension is regarded as the time dimension in four-dimensional CT. The noise of HYPR-LR processed image mainly depends on the noise level of the composite image. For the HYPR-NLM method, the noise of the processed image does not follow the rule from two aspects: (1) Different from original HYPR-LR method that is applied to CT images, HYPR-NLM is directly applied to the material images; (2) the weights $\\omega(i,j)$ used to filter the basis material image and composite image are different, while HYPR-LR uses the same kernel for both CT image and composite image. In addition, when it is performed in iterative formulation, the noise level of material image obtained using HYPR-NLM can be further reduced, as clearly demonstrated by the numerical simulation and clinical patient studies.} We have found two consecutive HYPR-NLM calculations could yield satisfactory results. Note that the algorithm is not optimized for time consideration, thus the computational time can be further reduce via algorithm optimization and parallel acceleration.\n\n\nIn summary, the proposed HYPR-NLM algorithm incorporates the edge-preserving non-local mean into the HYPR-LR framework and provides an effective way to suppress the noise magnification in material decomposition which has been a generic problem in DECT. A comparison of the technique with direct matrix inversion, and with published HYPR-LR as well as image-domain material decomposition algorithms suggests that all four algorithms yield acceptable quantitative measurement of iodine concentration. Direct matrix inversion yields the highest noise level, followed by HYPR-LR and Iter-DECT. HYPR-NLM significantly reduces noise while preserving the accuracy of quantitative measurement and spatial information.\n\n\n\\ack\nThis work is supported in part by NIH grants 7R01HL111141 and 1R01-EB016777. This work is also supported by the Natural Science Foundation of China (NSFC Grants No. 81201091 and No. 81171402), the 863 plan of the Ministry of Science and Technology of China (Grant No. 2015AA020917), Fundamental Research Funds for the Central Universities in China, Fund Project for Excellent Abroad Scholar Personnel in Science and Technology and Guangdong innovation team of image-guided Therapy (No. 2011S013).\n\n\n\\appendix\n\\section{Iterative image domain material decomposition}\nFor comparison, an iterative image domain dual-energy material decomposition method which significantly \\textcolor{black}{reduced} the \\textcolor{black}{increased} material decomposition noise, was also introduced. This method \\textcolor{black}{balanced} the data fidelity of image value of direct inversion material decomposition and quadratic error of decomposed images using an optimization framework~\\citep{niu2014}. It \\textcolor{black}{was} referred to as Iter-DECT in this work. The optimization problem is formulated as follows,\n\n", "itemtype": "equation", "pos": 20132, "prevtext": "\nBased on the above definition, $\\omega(i,j)$ satisfies the constraint conditions.\n\n\n\\subsection{Iterative image-domain material decomposition}\n\n\\textcolor{black}{Since dual-energy material decomposition can yield noise amplified images, for comparison, we also \\textcolor{black}{used} an iterative image domain material decomposition method which significantly \\textcolor{black}{reduced} the noise of the material-specific images with superior performance on image spatial resolution and low-contrast detectability~\\citep{niu2014}. The method \\textcolor{black}{balanced} the data fidelity of the value of the material image and a quadratic penalty using an optimization framework, and the unconstrained optimization problem \\textcolor{black}{was} solved by the nonlinear conjugate gradient method (see the Appendix for details). In this work, we \\textcolor{black}{referred} this method as Iter-DECT.}\n\n\\subsection{Numerical simulation studies}\n\nTo evaluate the proposed HYPR-NLM dual-energy material decomposition algorithm, we first \\textcolor{black}{used} simulated phantom data. For all of the simulation studies, the high- and low-energy CT images \\textcolor{black}{were} first employed to generate the material-specific basis images, which \\textcolor{black}{were} then processed using HYPR-NLM method to yield noise reduced images. These images \\textcolor{black}{were} compared to the images generated using direct matrix inversion, Iter-DECT and HYPR-LR methods and the results \\textcolor{black}{were} quantitatively analyzed.\n\nIn all of the simulations, \\textcolor{black}{a} 2D fan-beam CT geometry \\textcolor{black}{was} performed. The distance from the source to the center of rotation \\textcolor{black}{was} 785 mm and the distance from the source to the detector \\textcolor{black}{was} 1200 mm. A circular scan \\textcolor{black}{was} simulated and a total of 720 projections per rotation were acquired in an angular range of $360^0$. The detector pixel size \\textcolor{black}{was} 0.388 mm and the detector \\textcolor{black}{had} 1024 pixels. The dual-energy spectra \\textcolor{black}{were} 100 kVp and 140 kVp, which were generated using the SpekCalc software~\\citep{poludniowski2009} with 12 mm Al and 0.4 mm Sn + 12 mm Al filtration, respectively.\n\nThe phantom \\textcolor{black}{was} a water cylinder with inserts that \\textcolor{black}{contains} a series of six solutions of varying iodine concentrations (range, 0-20 mg/mL). The diameters of the water cylinder and the inserts \\textcolor{black}{were} 198 mm and 22.5 mm, respectively.\n\n\\textcolor{black}{To be realistic, Poisson noise was considered during the numerical simulations}. \\textcolor{black}{The fan beam CT projection data was created by polychromatic forward projecting the numerical phantom. Specifically, after introducing Poisson noise~\\citep{nuyts2013}, the projection data can be represented as:\n\n", "index": 27, "text": "\\begin{equation}\\label{equ:weight}\nI = Poisson \\left\\{N\\int_{0}^{E_{max}}\\mathrm{d}E\\,\\Omega(E) \\, \\eta(E)\\,\\mathrm{exp}\\left[-\\int_{0}^{l}\\mu(E,s)\\mathrm{d}s\\right]\\right\\},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14.m1\" class=\"ltx_Math\" alttext=\"I=Poisson\\left\\{N\\int_{0}^{E_{max}}\\mathrm{d}E\\,\\Omega(E)\\,\\eta(E)\\,\\mathrm{%&#10;exp}\\left[-\\int_{0}^{l}\\mu(E,s)\\mathrm{d}s\\right]\\right\\},\" display=\"block\"><mrow><mrow><mi>I</mi><mo>=</mo><mrow><mi>P</mi><mo>\u2062</mo><mi>o</mi><mo>\u2062</mo><mi>i</mi><mo>\u2062</mo><mi>s</mi><mo>\u2062</mo><mi>s</mi><mo>\u2062</mo><mi>o</mi><mo>\u2062</mo><mi>n</mi><mo>\u2062</mo><mrow><mo>{</mo><mrow><mi>N</mi><mo>\u2062</mo><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><msub><mi>E</mi><mrow><mi>m</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>x</mi></mrow></msub></msubsup><mrow><mrow><mo>d</mo><mpadded width=\"+1.7pt\"><mi>E</mi></mpadded></mrow><mo>\u2062</mo><mi mathvariant=\"normal\">\u03a9</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>E</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>\u03b7</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>E</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>exp</mi><mo>\u2062</mo><mrow><mo>[</mo><mrow><mo>-</mo><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mi>l</mi></msubsup><mrow><mi>\u03bc</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>E</mi><mo>,</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>d</mo><mi>s</mi></mrow></mrow></mrow></mrow><mo>]</mo></mrow></mrow></mrow></mrow><mo>}</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02355.tex", "nexttext": "\nwhere $R$ -- the quadratic penalty term; $\\lambda$ -- the constant to adjust the relative weights between the data fidelity term and the smooth term. The penalty term is defined as follows,\n\\begin{eqnarray}\n\nR(\\vec{x}) = \\frac{1}{2}\\underset{\\mathbf{i}}\\sum \\underset{\\mathbf{k\\in N_i}} \\sum e_{ik} (x_i-x_k)^2,\n\\end{eqnarray}\nwith $N_i$ the set of four nearest neighbors of the $i$th pixel in the image and $e_{ik}$ the edge-detection weight for pixel $i$ and $k$. \n\nNonlinear conjugate gradient (CG) method \\textcolor{black}{was} used to minimize the cost function defined by equation~(\\ref{equ:costfunction}).\nDuring CG iterations, the gradient \\textcolor{black}{was} calculated by the partial derivation of the cost function with respect to $\\vec{x}$,\n\n", "itemtype": "equation", "pos": 47884, "prevtext": "\nwith $N$ the total number of photons and was set to $3\\times10^5$ and $1.5\\times10^5$ per ray for the low- and high-energy CT scans, respectively. $\\eta(E)$ \\textcolor{black}{was} the energy dependent response of the detector, which was considered to be proportional to photon energy $E$ for energy-integrating detectors. $E_{max}$ \\textcolor{black}{was} the maximum photon energy of the polychromatic spectrum $\\Omega(E)$. $\\mu(E,s)$ \\textcolor{black}{was} the energy-dependent linear attenuation coefficient and \\textcolor{black}{was} obtained from the National Institute of Standards and Technology (NIST) database. $l$ \\textcolor{black}{was} the propagation path length for each ray and can be calculated using either analytical methods or numerical methods.} The x-ray spectra and the phantom are shown in figure~\\ref{fig:f1}. The linear attenuation coefficients of the iodine concentrate inserts \\textcolor{black}{calculated using the mixture rule, }are show in figure~\\ref{fig:f2}. Note that the $y$ axis is plotted on a logarithmic scale. \\textcolor{black}{First order beam hardening correction (water correction) was performed by simply mapping the polychromatic raysum to the corresponding monochromatic value with the incorporation of the 100 kVp and 140 kVp energy spectra.}\n\nThe calculated iodine concentrations in the phantom using different algorithms were compared with known true iodine concentrations. For comparison, direct matrix inversion without noise was also performed and the results were regarded as absolute truth. Difference image between the \\textcolor{black}{absolute truth} and the images processed using different kinds of algorithms were also generated to emphasize resolution preservation and noise reduction of these algorithms.\n\n\\begin{figure}[t]\n    \\centering\n    \n    \\includegraphics[width=5in]{figures_1.pdf}\n    \n    \\caption{Iodine concentrate phantom and x-ray spectra for numerical simulation of the dual energy material decomposition. (Left) The water phantom consists of six iodine concentrate inserts. (Right) The 100 kVp and 140 kVp energy spectra used in dual energy CT. The 100 kVp spectrum was filtrated with and 12 mm Al, while the 140 kVp spectrum was filtrated with 0.4 mm Sn and 12 mm Al.}\n    \\vspace{-1em}\n    \\label{fig:f1}\n\\end{figure}\n\n\\begin{figure}[t]\n    \\centering\n    \n    \\includegraphics[width=3in]{figures_2_r1.pdf}\n    \n    \\caption{Linear attenuation coefficients of the iodine concentrate inserts.}\n    \\vspace{-1em}\n    \\label{fig:f2}\n\\end{figure}\n\n\\subsubsection{Parameters selection}\n\nSince the parameters in the NLM filter would affect the filtered image, it \\textcolor{black}{was} important to investigate the parameters selection on the final noise reduced material-specific images.\nIn this simulation, the search window size $S\\times S$ \\textcolor{black}{was} set to different values, specifically, from 11 pixels to 19 pixels with a 4 pixels interval. Material-specific images processed using HYPR-LR and HYPR-NLM methods \\textcolor{black}{were} generated and compared.\nDifference images between the noise-free material images and the noisy material images generated using HYPR-LR and HYPR-NLM methods, \\textcolor{black}{were} calculated to depict the preservation of spatial resolution.\n\n\\subsubsection{Iteration formulation}\n\nIn order to further reduce the noise, the proposed method can be implemented in an iterative fashion, i.e., the HYPR-NLM processed material images \\textcolor{black}{were} set as the input images of the next HYPR-NLM iteration. Images processed with different iteration number \\textcolor{black}{were} generated and compared.\n\n\\subsubsection{Effect of dose level}\n\n\\textcolor{black}{To determine its robustness across different noise levels, we also \\textcolor{black}{evaluated} the proposed HYPR-NLM method using various numbers of photons (dose levels). Numerical phantom studies using four pairs of numbers of photons ($H/L=0.5\\times10^{5}/1\\times10^{5}, 1\\times10^{5}/2\\times10^{5}, 1.5\\times10^{5}/3\\times10^{5}$, and $2\\times10^{5}/4\\times10^{5}$) \\textcolor{black}{were} performed and HYPR-NLM method was employed to generate material images. For all of the simulations, the parameters of the HYPR-NLM \\textcolor{black}{were} the same. Quantitative measurements including iodine concentration and noise level \\textcolor{black}{were} evaluated to show the method's performance on various protocols.}\n\n\\subsection{Clinical patient data}\n\nTo evaluate the proposed method, two retrospective clinical patient studies were also performed with a dual-source DECT scanner (Somatom Definition, Siemens Healthcare).\nThe system acquired high- and low-energy data with two x-ray tubes with corresponding detector rings mounted onto a rotating gantry with angular offset of $90^\\circ$. The two tubes (tube 1 and 2) operated independently with regard to tube voltage, tube current as well as tube filtration. Dual-energy data were acquired using the following parameters: tube 1, 140 kVp, 287 mA and tube 2, 100 kVp, 412 mA for patient 1; tube 1, 140 kVp, 345 mA and tube 2, 100 kVp, 500 mA for patient 2. The 140 kV spectrum \\textcolor{black}{was} filtered with a tin filter. Images were reconstructed using the commercial software with the convolution kernel B25f for patient 1 and B26f for patient 2. All of the image slices were reconstructed in 0.75 mm slice thickness. \\textcolor{black}{The matrix size for each slice \\textcolor{black}{was} $512\\times512$, and the pixel size \\textcolor{black}{was} $0.38\\times0.38$ mm$^2$.} Blending images were also generated with a linear combination (with weighting factors of 0.3 and 0.7) of the 100 kV and 140 kV images. \nTo obtain contrast-enhanced CT images, the contrast agent of 300 mg I/mL was injected in an antecubital vein (300 mg I/mL,Ultravist 300, Bayer HealthCare).\n\n\\textcolor{black}{The noise in the raw CT images \\textcolor{black}{was} quantified using region-of-interest (ROI) analysis. Two ROIs \\textcolor{black}{were} selected to calculate noise-to-signal ratio (NSR) of myocardium and ventricle, respectively.} Myocardial perfusion imaging was conducted and iodine concentration map was calculated using direct matrix inversion, HYPR-LR, Iter-DECT and HYPR-NLM. We conducted all of the evaluations on a personal laptop \\textcolor{black}{which featured four Intel Core i7-4700HQ CPUs, and all of the material decomposition algorithms were implemented using MATLAB (The MathWorks, Inc., Natick, MA, United States)}. \n\n\\section{Results}\n\\subsection{Numerical simulations}\n\\begin{figure}\n    \\centering\n    \n    \\includegraphics[width=3.5in]{figures_3.pdf}\n    \\caption{Reconstruction and direct dual-energy decomposition results of the numerical iodine concentrate phantom simulation. The first row shows the 100 kV and 140 kV CT images. Note that the first order beam hardening correction (water correction) has been performed for the CT images of both energies.\n    Dual-energy decomposition without water correction yield cupping artifacts and inhomogeneity for the material images.}\n    \\label{fig:100kV140kVdiff}\n\\end{figure}\n\nImage reconstruction results of the numerical iodine concentrate phantom are shown in figure~\\ref{fig:100kV140kVdiff}. Water and the 20 mg/mL iodine concentrate are chosen as the basis materials for dual-energy material decomposition. Other iodine concentrates are expected to show up in the decomposed image corresponding to the contribution of their mass attenuation coefficients to the mass attenuation coefficient of the chosen basis material. In the first row, the 100 kV and 140 kV images and the difference between these two images are depicted. The 100 kV image shows superior iodine contrast, as expected. Note that the images of both energies have been corrected using the first order beam hardening correction algorithm and there are residual high order beam hardening artifacts (streaks) between high attenuation iodine concentrates, especially for the 100 kV image where the spectrum is much softer.\n\nThe second and the third rows show dual-energy material decomposition results using direct matrix inversion with and without water correction. As can be seen, dual-energy material decomposition yield residual cupping artifacts in the material images without water correction, and the water image and the iodine image are inhomogeneous. The difference images further clearly show the cupping artifacts and inhomogeneity. This is because the image-domain matrix inversion just linearly combine the high- and low-energy images, and \\textcolor{black}{does} not take the nonlinear attenuation process of X-ray projection into account.\n\n\\begin{figure}[t]\n    \\centering\n    \n    \\includegraphics[width=5in]{figures_4_r1.pdf}\n    \n    \\caption{Iodine image noise measured at the six regions of interest for the cylinder phantom using HYPR-NLM method with different search window sizes (a) and different iteration numbers (b). For comparison, noise measured using direct matrix inversion and Iter-DECT are also depicted. }\n    \\label{fig:paraselection}\n    \\vspace{-1.5em}\n\\end{figure}\n\n\\begin{figure}[t]\n    \\centering\n    \\includegraphics[width=4.0in]{figures_5_r1.pdf}\n    \n    \\caption{\\textcolor{black}{Results of the numerical phantom study with respect to different parameters. Iodine images processed using HYPR-LR and HYPR-NLM with different window sizes and iteration number N (a). The difference images are the subtraction of the iodine image generated using direct inversion without noise and the individual processed iodine images. Line profiles (corresponding to the yellow line in the upper-left corner) of the iodine images processed using HYPR-LR (b) and HYPR-NLM (c) with different parameters. For comparison, line profile obtained using direct matrix inversion is also depicted (Original). }}\n    \\label{fig:f5}\n\\end{figure}\n\n\\begin{figure}[t]\n    \\centering\n    \n    \\includegraphics[width=4.0in]{figures_12_r1.pdf}\n    \\caption{\\textcolor{black}{Dual energy decomposed images of the iodine concentrate numerical phantom using HYPR-NLM at different numbers of photons. The difference is the subtraction of the images generated using direct inversion without noise and the HYPR-NLM images. H and L stand for the number of high- and low-energy photons per ray, respectively. The standard deviation (Std) of the ROI reduces as the number of photons increases.}}\n    \\label{fig:dose}\n    \n\\end{figure}\n\nFigure~\\ref{fig:paraselection} shows the noise of the ROIs (labelled in figure~\\ref{fig:f1}(a)) of the iodine images processed using HYPR-NLM method with different parameters. The noise reduction of HYPR-NLM with different search window sizes are depicted in figure~\\ref{fig:paraselection}(a). For comparison, the results of direct matrix inversion and Iter-DECT are also present. For non-iterative HYPR-NLM formulation (i.e. the iteration number N = 1), noise magnitude is significantly reduced using HYPR-NLM method and there is no significant change between HYPR-NLM with different search windows sizes, namely, with search window size from $11\\times 11$ to $19\\times 19$. Thus in the following studies, we use search window size of $11\\times 11$ for computational consideration. The results of noise reduction using iterative HYPR-NLM with different iterations \\textcolor{black}{are} shown in figure~\\ref{fig:paraselection}(b). As can been seen, with two iterations (N = 2), HYPR-NLM provides results that have comparable noise magnitude as the results of Iter-DECT method.\n\nFigure~\\ref{fig:f5}(a) shows the results of the iodine images processed using HYPR-LR and HYPR-NLM with different window sizes. Different from HYPR-LR method, which results in spatial blurring as the uniform kernel size increases from $5\\times 5$ to $11\\times 11$, the edges do not have significant change for the HYPR-NLM with search window sizes from $11\\times 11$ to $19\\times 19$ and iteration numbers from one to two. As indicated in the difference images, there are clear edge effects for the HYPR-LR method, while there are marginal edge effects for the HYPR-NLM method, suggesting the edge of the iodine images are well preserved using the HYPR-NLM method with different search window sizes. \\textcolor{black}{Line profiles of the iodine images processed using HYPR-LR with different window sizes, and HYPR-NLM with different window sizes as well as iteration numbers are illustrated in figure~\\ref{fig:f5}(b) and (c). These profiles clearly demonstrate HYPR-NLM can provide superior images with respect to edge-preservation, and the method is robust against parameters selection. }\n\n\\textcolor{black}{Figure~\\ref{fig:dose} shows the results of dual-energy material decomposition images using HYPR-NLM method at different number of photons and quantitative analysis of the ROIs. Again, the difference image is the subtraction of the image obtained using noise-free direct matrix inversion and the HYPR-NLM image. As can be seen, HYPR-NLM works well for different scenarios. ROIs analyses indicate HYPR-NLM significantly reduces noise while preserving quantitative iodine concentration. The standard deviation of the ROI reduces as the number of photons increases. Note that H and L stand for the number of high- and low-energy photons, respectively.} \n\nMaterial-specific images of the numerical iodine concentrate phantom obtained using direct matrix inversion, HYPR-LR, Iter-DECT and HYPR-NLM algorithms are shown in figure~\\ref{fig:f6}. As can be seen, both HYPR-LR and Iter-DECT yield residual edge effects in the difference images, suggesting there are certain degree of spatial resolution degradation. However, there are marginal edge effects for the results of HYPR-NLM algorithm, showing there is minimal loss of spatial resolution. Iodine concentrations of the ROIs (labeled in figure~\\ref{fig:f1}(a)) measured using different algorithms \\textcolor{black}{are} shown in Table~\\ref{tab:iodineConcentration}. Compared to the true values of the iodine concentrate inserts, the quantitative \\textcolor{black}{measurements} of iodine concentration using the four algorithms \\textcolor{black}{are} well preserved. \n\n\\begin{figure}[t]\n    \\centering\n    \n    \\includegraphics[width=4.0in]{figures_6.pdf}\n    \\caption{Dual-energy decomposed images of the iodine concentrate numerical phantom using direct matrix inversion, HYPR-LR, iterative material decomposition and HYPR-NLM. The difference is the subtraction of the images generated using direct inversion without noise and the four different methods.}\n    \\label{fig:f6}\n    \n\\end{figure}\n\n\\begin{table}\n\\caption{Iodine concentration measured using different image-domain dual-energy material decomposition algorithms and true iodine concentration in phantom.}\n\\label{tab:iodineConcentration}\n\\begin{center}\n\\begin{tabular}{p{0.15\\textwidth}<{\\centering}p{0.15\\textwidth}<{\\centering}\np{0.15\\textwidth}<{\\centering}p{0.15\\textwidth}<{\\centering}p{0.15\\textwidth}<{\\centering}} \n\\toprule\n\\rule[-1ex]{0pt}{3.5ex}   True value (mg/mL) & Direct inversion (mg/mL)& HYPR (mg/mL)& Iter-DECT (mg/mL)& HYPR-NLM (mg/mL)\\\\\n\\hline\n\\rule[-1ex]{0pt}{3.5ex}   0 & 0.10 & 0.10 & 0.12 & 0.10  \\\\\n\\rule[-1ex]{0pt}{3.5ex}   4 & 4.24 & 4.26 & 4.24 & 4.26  \\\\\n\\rule[-1ex]{0pt}{3.5ex}   8 & 8.36 & 8.36 & 8.34 & 8.36  \\\\\n\\rule[-1ex]{0pt}{3.5ex}   12 & 12.26 & 12.24 & 12.22 & 12.24  \\\\\n\\rule[-1ex]{0pt}{3.5ex}   16 & 16.08 & 16.10 & 16.06 & 16.10  \\\\\n\\rule[-1ex]{0pt}{3.5ex}   20 & 19.94 & 19.94 & 19.92 & 19.94  \\\\\n\\bottomrule\n\\end{tabular}\n\n\\end{center}\n\n\\end{table}\n\n\n\n\n\n\\subsection{Patient study}\n\nFigure~\\ref{fig:f7} shows the low-energy (100 kV), high-energy (140 kV) CT images and \\textcolor{black}{their} linear blending images \\textcolor{black}{with weighting factors of 0.3 and 0.7 \\textcolor{black}{for} the myocardial perfusion imaging of patient 1. Two regions-of-interests (ROI) A and B are labelled respectively on myocardium and ventricle to calculate their NSRs. The NSRs of the myocardium for the 100 kV and 140 kV CT images are $34.6\\%$ and $27.9\\%$, respectively. While the NSRs of the ventricle for the 100 kV and 140 kV CT images are $5.3\\%$ and $5\\%$, respectively. For both ROIs, the NSRs of the 100 kV images are higher than the 140 kV images. This may be the reason why the 140 kV image has a higher weighting factor in the blending image. }Water image, and iodine contrast image decomposed using the high- and low-energy images with different algorithms are present in figure~\\ref{fig:f8}. As can be seen, dual-energy material decomposition using direct matrix inversion yields \\textcolor{black}{increased} noise. HYPR-LR reduces the noise level to a certain extent. Iter-DECT significantly reduces the amplified noise. For both of the water and iodine images, HYPR-NLM \\textcolor{black}{shows} superior image quality. Quantitative \\textcolor{black}{measurements} of iodine concentration and noise reduction of the labelled ROIs are depicted in table~\\ref{tab:patientData}. \n\\begin{figure*}[t]\n    \\centering\n    \\includegraphics[width=0.6\\textwidth]{figures_7_r1.pdf}\n    \\caption{Patient 1, 100 kV (left), 140 kV (middle) and blending (right) CT images of myocardial perfusion imaging using dual-source DECT scanner (C = 0 HU, W = 1000 HU). \\textcolor{black}{The two region-of-interests A and B (red circles) are used to calculate signal-to-noise ratio of myocardium and ventricle, respectively.}}\n    \\label{fig:f7}\n\\end{figure*}\n\n\\begin{figure*}[t]\n    \\centering\n    \\includegraphics[width=0.72\\textwidth]{figures_8.pdf}\n    \\caption{Patient 1, dual-energy decomposed images of myocardial perfusion imaging using direct matrix inversion, HYPR-LR, Iter-DECT and HYPR-NLM.}\n    \\label{fig:f8}\n\\end{figure*}\n\nThe images of patient 2, a case with motion artifact presented in figures~\\ref{fig:f9}-\\ref{fig:f10}, provides a challenging situation for dual-energy material decomposition. \\textcolor{black}{This is because myocardial imaging is often compromised by motion blur, leading to DECT artefacts.} The blurring edge labelled in the 100 kV image of figure~\\ref{fig:f9} does not \\textcolor{black}{have a} consistent profile \\textcolor{black}{compared to} the 140 kV image, which shows a sharper edge \\textcolor{black}{here}. This happens for the labelled edge for the 140 kV image as well. Again, the blending image shows the linear combination of the 100 kV and 140 kV CT images.\n\n\\begin{figure*}\n    \\centering\n    \\includegraphics[width=0.6\\textwidth]{figures_9.pdf}\n    \\caption{Patient 2, 100 kV (left), 140 kV (middle) and blending (right) CT images of myocardial perfusion imaging using dual-source DECT scanner (C = 0 HU, W = 1000 HU). }\n    \\label{fig:f9}\n\\end{figure*}\n\n\\textcolor{black}{Water} images and iodine contrast images, as shown in figure~\\ref{fig:f10}, clearly depict the error induced by motion. Still, there are marginal edge effects for HYPR-NLM processed images, suggesting improvements compared to HYPR-LR and Iter-DECT. Dual-energy decomposition using HYPR-NLM leads to more homogeneous results and more significant noise reduction.\n\n\\begin{figure*}[bt]\n    \\centering\n    \n    \\includegraphics[width=0.72\\textwidth]{figures_10.pdf}\n    \\caption{Patient 2, dual-energy decomposed images of myocardial perfusion imaging using direct matrix inversion, HYPR-LR, Iter-DECT and HYPR-NLM. The difference is the subtraction of the direct inversion and the other methods.}\n    \\label{fig:f10}\n\\end{figure*}\n\nTable~\\ref{tab:patientData} shows the mean values and standard deviations of the ROIs measured using direct matrix inversion, HYPR-LR, Iter-DECT and HYPR-NLM algorithms. \\textcolor{black}{Note that the NSR for direct matrix inversion is approximately $30\\%$ for both basis material images and is reduced by factors for approximately 2, 3 and 5 for HYPR-LR, Iter-DECT and HYPR-NLM, respectively.} The computational time for \\textcolor{black}{each slice} per iteration for HYPR-NLM is about 280 s, compared to 300 s for Iter-DECT. There are no significant differences between the mean values measured using the four algorithms, suggesting the quantitative measurements of iodine concentration are acceptable for all four approaches. For noise reduction, direct inversion and HYPR-NLM yield the highest and the lowest noise level, respectively. HYPR-NLM outperforms HYPR-LR in both resolution preservation and noise reduction.\n\n\\begin{table*}\n\n\\caption{The mean values and standard deviations of the ROIs (labeled as \\#1 and \\#2 in figure~\\ref{fig:f8},~\\ref{fig:f10}) of the myocardial data.}\n\\vspace{-1.5mm}\n\\label{tab:patientData}\n\\begin{center}\n\n\n\\begin{tabular}{cccccc}\n\\toprule\n\n &    & Direct inversion & HYPR-LR & Iter-DECT & HYPR-NLM \\\\\n\\hline\n\\multicolumn{1}{ c }{\\multirow{2}{*}{Patient 1} } & Water image & 1.16$\\pm$0.36 & 1.16$\\pm$0.16 & 1.16$\\pm$0.12 & 1.16$\\pm$0.08 \\\\& Iodine image & 0.99$\\pm$0.31 & 0.99$\\pm$0.14 & 0.99$\\pm$0.12 & 0.99$\\pm$0.08 \\\\\n\\hline\n\\multicolumn{1}{ c }{\\multirow{2}{*}{Patient 2} } & Water image  & 1.04$\\pm$0.34 & 1.04$\\pm$0.18 & 1.04$\\pm$0.08 & 1.04$\\pm$0.07\\\\\n&Iodine image & 0.97$\\pm$0.28 & 0.98$\\pm$0.14 & 0.98$\\pm$0.06 & 0.98$\\pm$0.05 \\\\\n\n\n\\bottomrule\n\\end{tabular}\n\\end{center}\n\\end{table*}\n\n\n\n\\section{Discussion and Conclusion}\n\n\\label{sec:discussion}\n\nHYPR-NLM has shown to provide sensible results for noise reduction of image-domain dual-energy material decomposition. For numerical simulation studies, where there exists \\textcolor{black}{certainty} (noiseless material images obtained using direct matrix inversion), HYPR-NLM outperforms both HYPR-LR and Iter-DECT for spatial resolution preservation. For the clinical myocardial perfusion imaging studies, to show the edge preservation of the dual-energy material-decomposition algorithms, material-specific images are subtracted from the noisy images generated using direct inversion to see whether there are any noticeable anatomical features present.\n\n\\textcolor{black}{We have demonstrated that the HYPR framework can be applied directly to the basis material images. The initial basis material images can be generated using matrix inversion because this method performs material decomposition without compromising spatial details, which can be exploited by the HYPR-NLM algorithm to yield both noise reduced and spatial information well preserved material images. To achieve this goal, it is also possible to filter the DECT images before the application of material decomposition, or directly apply a feature preserved noise reduction filter on the material decomposition images~\\citep{cai2015}. In the future, comprehensive comparative studies of these methods will be performed after sufficient experiences and data are accumulated. }\n\nFor the HYPR-LR algorithm, an uniform kernel is employed to convolve with the energy image and the composite image, thus anatomical structures of the local neighborhood are introduced into the processed image. When the window size of the uniform kernel increases, more local features are introduced into the convolution, resulting spatial information degraded material-specific images, as depicted in the first row of figure~\\ref{fig:f5}. To the contrary, for the HYPR-NLM algorithm, the non-local mean is employed in the convolution procedure. The resulting image is a weighted average of all pixels in the original image, where the weight is determined by similarity between two pixels and the similarity is a measurement of the geometrical configuration in a square neighborhood $\\Theta$. Thus pixels with a similar image value in \\textcolor{black}{their neighborhoods} have larger weights and contribute more in the whole image averaging, while local pixels may have smaller weights and consequently contribute less if their geometrical configurations are not similar to the targeting pixel. In this case, since all of the image pixels can contribute to the targeting pixel according to their similarities, few local features are introduced and spatial information is well preserved in the final material image. In addition, the similarity depended weights make HYPR-NLM robust with respect to the size of averaging window (the search window), as indicated in the third row of figure~\\ref{fig:f5}. It has to note instead of using the whole image, we have restricted the search windows in size of $11\\times11, 15\\times15, 19\\times19$ pixels for computational purpose.\n\n\n\\textcolor{black}{For DECT imaging, the low- and high-energy CT images have geometrical self-similarities, which have been widely used in dynamic tomography reconstruction. When the HYPR-LR algorithm is applied to the CT images, the self-similarities are exploited by the composite image which has lower image noise level than the individual CT images. In this sense, the energy dimension is regarded as the time dimension in four-dimensional CT. The noise of HYPR-LR processed image mainly depends on the noise level of the composite image. For the HYPR-NLM method, the noise of the processed image does not follow the rule from two aspects: (1) Different from original HYPR-LR method that is applied to CT images, HYPR-NLM is directly applied to the material images; (2) the weights $\\omega(i,j)$ used to filter the basis material image and composite image are different, while HYPR-LR uses the same kernel for both CT image and composite image. In addition, when it is performed in iterative formulation, the noise level of material image obtained using HYPR-NLM can be further reduced, as clearly demonstrated by the numerical simulation and clinical patient studies.} We have found two consecutive HYPR-NLM calculations could yield satisfactory results. Note that the algorithm is not optimized for time consideration, thus the computational time can be further reduce via algorithm optimization and parallel acceleration.\n\n\nIn summary, the proposed HYPR-NLM algorithm incorporates the edge-preserving non-local mean into the HYPR-LR framework and provides an effective way to suppress the noise magnification in material decomposition which has been a generic problem in DECT. A comparison of the technique with direct matrix inversion, and with published HYPR-LR as well as image-domain material decomposition algorithms suggests that all four algorithms yield acceptable quantitative measurement of iodine concentration. Direct matrix inversion yields the highest noise level, followed by HYPR-LR and Iter-DECT. HYPR-NLM significantly reduces noise while preserving the accuracy of quantitative measurement and spatial information.\n\n\n\\ack\nThis work is supported in part by NIH grants 7R01HL111141 and 1R01-EB016777. This work is also supported by the Natural Science Foundation of China (NSFC Grants No. 81201091 and No. 81171402), the 863 plan of the Ministry of Science and Technology of China (Grant No. 2015AA020917), Fundamental Research Funds for the Central Universities in China, Fund Project for Excellent Abroad Scholar Personnel in Science and Technology and Guangdong innovation team of image-guided Therapy (No. 2011S013).\n\n\n\\appendix\n\\section{Iterative image domain material decomposition}\nFor comparison, an iterative image domain dual-energy material decomposition method which significantly \\textcolor{black}{reduced} the \\textcolor{black}{increased} material decomposition noise, was also introduced. This method \\textcolor{black}{balanced} the data fidelity of image value of direct inversion material decomposition and quadratic error of decomposed images using an optimization framework~\\citep{niu2014}. It \\textcolor{black}{was} referred to as Iter-DECT in this work. The optimization problem is formulated as follows,\n\n", "index": 29, "text": "\\begin{equation}\\label{equ:costfunction}\nmin_{\\vec{x}} F(\\vec{x})=(A\\vec{x}-\\vec{\\mu})^{T}V^{-1}(A\\vec{x}-\\vec{\\mu}) + \\lambda\\cdot R(\\vec{x}),\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E15.m1\" class=\"ltx_Math\" alttext=\"min_{\\vec{x}}F(\\vec{x})=(A\\vec{x}-\\vec{\\mu})^{T}V^{-1}(A\\vec{x}-\\vec{\\mu})+%&#10;\\lambda\\cdot R(\\vec{x}),\" display=\"block\"><mrow><mrow><mrow><mi>m</mi><mo>\u2062</mo><mi>i</mi><mo>\u2062</mo><msub><mi>n</mi><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u2192</mo></mover></msub><mo>\u2062</mo><mi>F</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u2192</mo></mover><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mi>A</mi><mo>\u2062</mo><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u2192</mo></mover></mrow><mo>-</mo><mover accent=\"true\"><mi>\u03bc</mi><mo stretchy=\"false\">\u2192</mo></mover></mrow><mo stretchy=\"false\">)</mo></mrow><mi>T</mi></msup><mo>\u2062</mo><msup><mi>V</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mi>A</mi><mo>\u2062</mo><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u2192</mo></mover></mrow><mo>-</mo><mover accent=\"true\"><mi>\u03bc</mi><mo stretchy=\"false\">\u2192</mo></mover></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mrow><mi>\u03bb</mi><mo>\u22c5</mo><mi>R</mi></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u2192</mo></mover><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02355.tex", "nexttext": "\nwith $\\nabla R = (\\frac{\\partial R}{\\partial x_1}, \\frac{\\partial R}{\\partial x_2}, \\cdots \\frac{\\partial R}{\\partial x_{2N}})$. \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\begin{thebibliography}{}\n\n\\bibitem[Alvarez and Macovski(1976)Alvarez and Macovski]{alvarez1976}\nAlvarez, R.~E. and Macovski, A. (1976).\n{} Energy-selective reconstructions in x-ray computerised tomography.\n{} {\\em Phys. Med. Biol.\\/}, {\\bf 21}(5), 733.\n\n\\bibitem[Brendel {\\em et~al.}(2009)Brendel, Roessl, Schlomka, and\n  Proksa]{brendel2009}\nBrendel, B., Roessl, E., Schlomka, J.-P., and Proksa, R. (2009).\n{} Empirical projection-based basis-component decomposition method.\n{} {\\em Proc. SPIE\\/}, \\textbf{72583Y}.\n\n\\bibitem[Buades {\\em et~al.}(2005)Buades, Coll, and Morel]{buades2005}\nBuades, A., Coll, B., and Morel, J.-M. (2005).\n{} A non-local algorithm for image denoising.\n{}  {\\em IEEE Computer Vision and Pattern Recognition\\/}~\\textbf{2} 60--65.\n\n\\bibitem[Cai {\\em et~al.}(2015)Cai, Lee, Zhang, Kim, Zalis, and\n  Yoshida]{cai2015}\nCai, W., Lee, J.-G., Zhang, D., Kim, S.~H., Zalis, M., and Yoshida, H. (2015).\n{} Electronic cleansing in fecal-tagging dual-energy CT colonography\n  based on material decomposition and virtual colon tagging.\n{} {\\em  IEEE Trans. Biomed. Eng.\\/}, {\\bf 62}(2),\n  754-765.\n\n\\bibitem[Carmi {\\em et~al.}(2005)Carmi, Naveh, and Altman]{carmi2005}\nCarmi, R., Naveh, G., and Altman, A. (2005).\n{} Material separation with dual-layer CT.\n{}  {\\em IEEE Nuclear Science Symp. Conf. Record\\/}\\textbf{~4} 3-7.\n\n\\bibitem[Chandarana {\\em et~al.}(2011)Chandarana, Megibow, Cohen, Srinivasan,\n  Kim, Leidecker, and Macari]{chandarana2011}\nChandarana, H., Megibow, A.~J., Cohen, B.~A., Srinivasan, R., Kim, D.,\n  Leidecker, C., and Macari, M. (2011).\n{} Iodine quantification with dual-energy CT: phantom study and\n  preliminary experience with renal masses.\n{} {\\em Am. J. Roentgenol.\\/}, {\\bf 196}(6), W693--W700.\n\n\\bibitem[Chen {\\em et~al.}(2008)Chen, Ma, Feng, Luo, Shi, and Chen]{chen2008a}\nChen, Y., Ma, J., Feng, Q., Luo, L., Shi, P., and Chen, W. (2008).\n{} Nonlocal prior bayesian tomographic reconstruction.\n{} {\\em J. Math Imaging Vis.\\/}, {\\bf 30}(2),\n  133--146.\n\n\\bibitem[Chen {\\em et~al.}(2012)Chen, Yang, Hu, Yang, Zhu, Li, Chen, Toumoulin,\n  {\\em et~al.}]{chen2012}\nChen, Y., Yang, Z., Hu, Y., Yang, G., Zhu, Y., Li, Y., Chen, W., Toumoulin, C.,\n  {\\em et~al.} (2012).\n{} Thoracic low-dose CT image processing using an artifact suppressed\n  large-scale nonlocal means.\n{} {\\em Phys. Med. Biol.\\/}, {\\bf 57}(9), 2667.\n\n\\bibitem[Christian {\\em et~al.}(2010)Christian, Vandehey, Floberg, and\n  Mistretta]{christian2010}\nChristian, B.~T., Vandehey, N.~T., Floberg, J.~M., and Mistretta, C.~A. (2010).\n{} Dynamic PET denoising with HYPR processing.\n{} {\\em J. Nucl. Med.\\/}, {\\bf 51}(7), 1147--1154.\n\n\\bibitem[Chun {\\em et~al.}(2014)Chun, Dewaraja, Fessler, {\\em\n  et~al.}]{chun2014}\nChun, S.~Y., Dewaraja, Y.~K., Fessler, J., {\\em et~al.} (2014).\n{} Alternating direction method of multiplier for tomography with\n  nonlocal regularizers.\n{} {\\em  IEEE Trans. Med. Imag.\\/}, {\\bf 33}(10),\n  1960--1968.\n\n\\bibitem[Clark and Badea(2014)Clark and Badea]{clark2014}\nClark, D.~P. and Badea, C.~T. (2014).\n{} Spectral diffusion: an algorithm for robust material decomposition of\n  spectral CT data.\n{} {\\em Phys. Med. Biol.\\/}, {\\bf 59}(21), 6445.\n\n\\bibitem[Dong {\\em et~al.}(2014)Dong, Niu, and Zhu]{dong2014}\nDong, X., Niu, T., and Zhu, L. (2014).\n{} Combined iterative reconstruction and image-domain decomposition for\n  dual energy CT using total-variation regularization.\n{} {\\em Med. Phys.\\/}, {\\bf 41}(5), 051909.\n\n\\bibitem[Faby {\\em et~al.}(2015)Faby, Kuchenbecker, Sawall, Simons, Schlemmer,\n  Lell, and Kachelrie{\\ss}]{faby2015}\nFaby, S., Kuchenbecker, S., Sawall, S., Simons, D., Schlemmer, H.-P., Lell, M.,\n  and Kachelrie{\\ss}, M. (2015).\n{} Performance of today\u00a1\u00afs dual energy CT and future multi energy CT in\n  virtual non-contrast imaging and in iodine quantification: A simulation\n  study.\n{} {\\em Med. Phys.\\/}, {\\bf 42}(7), 4349--4366.\n\n\\bibitem[Fischer {\\em et~al.}(2011)Fischer, Gnannt, Raptis, Reiner, Clavien,\n  Schmidt, Leschka, Alkadhi, and Goetti]{fischer2011}\nFischer, M.~A., Gnannt, R., Raptis, D., Reiner, C.~S., Clavien, P.-A., Schmidt,\n  B., Leschka, S., Alkadhi, H., and Goetti, R. (2011).\n{} Quantification of liver fat in the presence of iron and iodine: an\n  ex-vivo dual-energy CT study.\n{} {\\em Invest. Radiol.\\/}, {\\bf 46}(6), 351--358.\n\n\\bibitem[Graser {\\em et~al.}(2009)Graser, Johnson, Chandarana, and\n  Macari]{graser2009}\nGraser, A., Johnson, T.~R., Chandarana, H., and Macari, M. (2009).\n{} Dual energy CT: preliminary observations and potential clinical\n  applications in the abdomen.\n{} {\\em Eur. Radiol\\/}, {\\bf 19}(1), 13--23.\n\n\\bibitem[Hao {\\em et~al.}(2013)Hao, Kang, Zhang, and Chen]{hao2013}\nHao, J., Kang, K., Zhang, L., and Chen, Z. (2013).\n{} A novel image optimization method for dual-energy computed\n  tomography.\n{} {\\em Nucl. Instrum. Methods Phys. Res. A\\/}, {\\bf\n  722}, 34--42.\n\n\\bibitem[Hartman {\\em et~al.}(2012)Hartman, Kawashima, Takahashi, Silva,\n  Vrtiska, Leng, Fletcher, and McCollough]{hartman2012}\nHartman, R., Kawashima, A., Takahashi, N., Silva, A., Vrtiska, T., Leng, S.,\n  Fletcher, J., and McCollough, C. (2012).\n{} Applications of dual-energy CT in urologic imaging: an update.\n{} {\\em Radiol. Clin. N. Am.\\/}, {\\bf 50}(2), 191--205.\n\n\\bibitem[Johnson {\\em et~al.}(2007)Johnson, Krauss, Sedlmair, Grasruck, Bruder,\n  Morhard, Fink, Weckbach, Lenhard, Schmidt, {\\em et~al.}]{johnson2007}\nJohnson, T.~R., Krauss, B., Sedlmair, M., Grasruck, M., Bruder, H., Morhard,\n  D., Fink, C., Weckbach, S., Lenhard, M., Schmidt, B., {\\em et~al.} (2007).\n{} Material differentiation by dual energy CT: initial experience.\n{} {\\em Eur. Radiol.\\/}, {\\bf 17}(6), 1510--1517.\n\n\\bibitem[Johnson {\\em et~al.}(2008)Johnson, Velikina, Wu, Kecskemeti, Wieben,\n  and Mistretta]{johnson2008}\nJohnson, K.~M., Velikina, J., Wu, Y., Kecskemeti, S., Wieben, O., and\n  Mistretta, C.~A. (2008).\n{} Improved waveform fidelity using local HYPR reconstruction (HYPR-LR).\n{} {\\em Mag. Res. Med.\\/}, {\\bf 59}(3), 456--462.\n\n\\bibitem[Kalender {\\em et~al.}(1986)Kalender, Perman, Vetter, and\n  Klotz]{kalender1986}\nKalender, W.~A., Perman, W., Vetter, J., and Klotz, E. (1986).\n{} Evaluation of a prototype dual-energy computed tomographic apparatus.\n  I. phantom studies.\n{} {\\em Med. Phys.\\/}, {\\bf 13}(3), 334--339.\n\n\\bibitem[Knaup {\\em et~al.}(2007)Knaup, Stenner, and Kachelrie{\\ss}]{knaup2007}\nKnaup, M., Stenner, P., and Kachelrie{\\ss}, M. (2007).\n{} Rawdata-based dual energy CT (DECT) from inconsistent scans.\n{} {\\em IEEE Nuclear Science Symp. Conf. Record\\/}, \\textbf{vol 6}, 4457--4459.\n\n\\bibitem[Leng {\\em et~al.}(2011)Leng, Yu, Wang, Fletcher, Mistretta, and\n  McCollough]{leng2011}\nLeng, S., Yu, L., Wang, J., Fletcher, J.~G., Mistretta, C.~A., and McCollough,\n  C.~H. (2011).\n{} Noise reduction in spectral CT: reducing dose and breaking the\n  trade-off between image noise and energy bin selection.\n{} {\\em Med. Phys.\\/}, {\\bf 38}(9), 4946--4957.\n\n\\bibitem[Li {\\em et~al.}(2013)Li, Shi, Wang, Wang, and Wu]{li2013}\nLi, Y., Shi, G., Wang, S., Wang, S., and Wu, R. (2013).\n{} Iodine quantification with dual-energy CT: phantom study and\n  preliminary experience with vx2 residual tumour in rabbits after\n  radiofrequency ablation.\n{} {\\em Br. J. Radiol.\\/}, {\\bf 86}(1029).\n\n\\bibitem[Li {\\em et~al.}(2015)Li, Leng, Yu, Yu, and McCollough]{li2015}\nLi, Z., Leng, S., Yu, L., Yu, Z., and McCollough, C.~H. (2015).\n{} Image-based material decomposition with a general volume constraint\n  for photon-counting CT.\n{} {\\em Proc SPIE\\/}, \\textbf{94120T}.\n\n\\bibitem[Liu {\\em et~al.}(2009)Liu, Yu, Primak, and McCollough]{liu2009}\nLiu, X., Yu, L., Primak, A.~N., and McCollough, C.~H. (2009).\n{} Quantitative imaging of element composition and mass fraction using\n  dual-energy CT: three-material decomposition.\n{} {\\em Med. Phys.\\/}, {\\bf 36}(5), 1602--1609.\n\n\\bibitem[Long {\\em et~al.}(2014)Long, Fessler, {\\em et~al.}]{long2014}\nLong, Y., Fessler, J., {\\em et~al.} (2014).\n{} Multi-material decomposition using statistical image reconstruction\n  for spectral CT.\n{} {\\em IEEE Trans. Med. Imag.\\/}, {\\bf 33}(8),\n  1614--1626.\n\n\\bibitem[Maa{\\ss} {\\em et~al.}(2009)Maa{\\ss}, Baer, and\n  Kachelrie{\\ss}]{maass2009}\nMaa{\\ss}, C., Baer, M., and Kachelrie{\\ss}, M. (2009).\n{} Image-based dual energy CT using optimized precorrection functions: A\n  practical new approach of material decomposition in image domain.\n{} {\\em Med. Phys.\\/}, {\\bf 36}(8), 3818--3829.\n\n\\bibitem[Maa{\\ss} {\\em et~al.}(2011)Maa{\\ss}, Meyer, and\n  Kachelrie{\\ss}]{maass2011}\nMaa{\\ss}, C., Meyer, E., and Kachelrie{\\ss}, M. (2011).\n{} Exact dual energy material decomposition from inconsistent rays\n  (MDIR).\n{} {\\em Med. Phys.\\/}, {\\bf 38}(2), 691--700.\n\n\\bibitem[Marin {\\em et~al.}(2014)Marin, Boll, Mileto, and Nelson]{marin2014}\nMarin, D., Boll, D.~T., Mileto, A., and Nelson, R.~C. (2014).\n{} State of the art: dual-energy CT of the abdomen.\n{} {\\em Radiology\\/}, {\\bf 271}(2), 327--342.\n\n\\bibitem[Matsumoto {\\em et~al.}(2011)Matsumoto, Jinzaki, Tanami, Ueno, Yamada,\n  and Kuribayashi]{matsumoto2011}\nMatsumoto, K., Jinzaki, M., Tanami, Y., Ueno, A., Yamada, M., and Kuribayashi,\n  S. (2011).\n{} Virtual monochromatic spectral imaging with fast kilovoltage\n  switching: improved image quality as compared with that obtained with\n  conventional 120-kVp CT.\n{} {\\em Radiology\\/}, {\\bf 259}(1), 257--262.\n\n\\bibitem[Mistretta {\\em et~al.}(2006)Mistretta, Wieben, Velikina, Block, Perry,\n  Wu, and Johnson]{mistretta2006}\nMistretta, C., Wieben, O., Velikina, J., Block, W., Perry, J., Wu, Y., and\n  Johnson, K. (2006).\n{} Highly constrained backprojection for time-resolved MRI.\n{} {\\em Mag. Res. Med.\\/}, {\\bf 55}(1), 30--40.\n\n\\bibitem[Niu {\\em et~al.}(2014)Niu, Dong, Petrongolo, and Zhu]{niu2014}\nNiu, T., Dong, X., Petrongolo, M., and Zhu, L. (2014).\n{} Iterative image-domain decomposition for dual-energy CT.\n{} {\\em Med. Phys.\\/}, {\\bf 41}(4), 041901.\n\n\\bibitem[Noh {\\em et~al.}(2009)Noh, Fessler, Kinahan, {\\em et~al.}]{noh2009}\nNoh, J., Fessler, J., Kinahan, P.~E., {\\em et~al.} (2009).\n{} Statistical sinogram restoration in dual-energy CT for pet\n  attenuation correction.\n{} {\\em IEEE Trans. Med. Imag.\\/}, {\\bf 28}(11),\n  1688--1702.\n\n\\bibitem[Nuyts {\\em et~al.}(2013)Nuyts, De~Man, Fessler, Zbijewski, and\n  Beekman]{nuyts2013}\nNuyts, J., De~Man, B., Fessler, J.~A., Zbijewski, W., and Beekman, F.~J.\n  (2013).\n{} Modelling the physics in the iterative reconstruction for\n  transmission computed tomography.\n{} {\\em Phys. Med. Biol.\\/}, {\\bf 58}(12), R63.\n\n\\bibitem[Petrongolo and Zhu(2015)Petrongolo and Zhu]{petrongolo2015}\nPetrongolo, M. and Zhu, L. (2015).\n{} Noise suppression for dual-energy CT through entropy minimization.\n{} {\\em IEEE Trans. Med. Imag.\\/}{\\bf~34}(11) 2286-2297.\n\n\\bibitem[Poludniowski {\\em et~al.}(2009)Poludniowski, Landry, DeBlois, Evans,\n  and Verhaegen]{poludniowski2009}\nPoludniowski, G., Landry, G., DeBlois, F., Evans, P., and Verhaegen, F. (2009).\n{} SpekCalc: a program to calculate photon spectra from tungsten anode\n  x-ray tubes.\n{} {\\em Phys. Med. Biol.\\/}, {\\bf 54}(19), N433.\n\n\\bibitem[Scheske {\\em et~al.}(2013)Scheske, O\u00a1\u00afBrien, Earls, Min, LaBounty,\n  Cury, Lee, So, Hague, Al-Hassan, {\\em et~al.}]{scheske2013}\nScheske, J.~A., O\u00a1\u00afBrien, J.~M., Earls, J.~P., Min, J.~K., LaBounty, T.~M.,\n  Cury, R.~C., Lee, T.-Y., So, A., Hague, C.~J., Al-Hassan, D., {\\em et~al.}\n  (2013).\n{} Coronary artery imaging with single-source rapid kilovolt\n  peak-switching dual-energy CT.\n{} {\\em Radiology\\/}, {\\bf 268}(3), 702--709.\n\n\\bibitem[Shen and Xing(2013)Shen and Xing]{shen2013}\nShen, L. and Xing, Y. (2013).\n{} An edge-preserving total variation denoising method for DECT image.\n{} {\\em  IEEE Nuclear Science Symposium and Medical Imaging Conference\n  \\/}, 1--4.\n\n\\bibitem[Shikhaliev(2012)Shikhaliev]{shikhaliev2012}\nShikhaliev, P.~M. (2012).\n{} Photon counting spectral CT: improved material decomposition with\n  K-edge-filtered x-rays.\n{} {\\em Phys. Med. Biol.\\/}, {\\bf 57}(6), 1595.\n\n\\bibitem[Sidky {\\em et~al.}(2004)Sidky, Zou, and Pan]{sidky2004}\nSidky, E.~Y., Zou, Y., and Pan, X. (2004).\n{} Impact of polychromatic x-ray sources on helical, cone-beam computed\n  tomography and dual-energy methods.\n{} {\\em Phys. Med. Biol.\\/}, {\\bf 49}(11), 2293.\n\n\\bibitem[Silva {\\em et~al.}(2011)Silva, Morse, Hara, Paden, Hongo, and\n  Pavlicek]{silva2011}\nSilva, A.~C., Morse, B.~G., Hara, A.~K., Paden, R.~G., Hongo, N., and Pavlicek,\n  W. (2011).\n{} Dual-energy (spectral) CT: applications in abdominal imaging.\n{} {\\em Radiographics\\/}, {\\bf 31}(4), 1031--1046.\n\n\\bibitem[Speidel {\\em et~al.}(2013)Speidel, Bateman, Tao, Raval, Hacker,\n  Reeder, and Van~Lysel]{speidel2013}\nSpeidel, M.~A., Bateman, C.~L., Tao, Y., Raval, A.~N., Hacker, T.~A., Reeder,\n  S.~B., and Van~Lysel, M.~S. (2013).\n{} Reduction of image noise in low tube current dynamic CT myocardial\n  perfusion imaging using HYPR processing: A time-attenuation curve analysis.\n{} {\\em Med. Phys.\\/}, {\\bf 40}(1), 011904.\n\n\\bibitem[Stenner {\\em et~al.}(2007)Stenner, Berkus, and\n  Kachelrie{\\ss}]{stenner2007}\nStenner, P., Berkus, T., and Kachelrie{\\ss}, M. (2007).\n{} Empirical dual energy calibration (EDEC) for cone-beam computed\n  tomography.\n{} {\\em Med. Phys.\\/}, {\\bf 34}(9), 3630--3641.\n\n\\bibitem[Sukovic and Clinthorne(2000)Sukovic and Clinthorne]{sukovic2000}\nSukovic, P. and Clinthorne, N.~H. (2000).\n{} Penalized weighted least-squares image reconstruction for dual energy\n  x-ray transmission tomography.\n{} {\\em IEEE Trans. Med. Imag.\\/}, {\\bf 19}(11),\n  1075--1081.\n\n\\bibitem[Supanich {\\em et~al.}(2009)Supanich, Tao, Nett, Pulfer, Hsieh, Turski,\n  Mistretta, Rowley, and Chen]{supanich2009}\nSupanich, M., Tao, Y., Nett, B., Pulfer, K., Hsieh, J., Turski, P., Mistretta,\n  C., Rowley, H., and Chen, G.-H. (2009).\n{} Radiation dose reduction in time-resolved CT angiography using highly\n  constrained back projection reconstruction.\n{} {\\em Phys. Med. Biol.\\/}, {\\bf 54}(14), 4575.\n\n\\bibitem[Szczykutowicz and Chen(2010)Szczykutowicz and Chen]{szczykutowicz2010}\nSzczykutowicz, T.~P. and Chen, G.-H. (2010).\n{} Dual energy CT using slow kVp switching acquisition and prior image\n  constrained compressed sensing.\n{} {\\em Phys. Med. Biol.\\/}, {\\bf 55}(21), 6411.\n\n\\bibitem[Wang and Pelc(2009)Wang and Pelc]{wang2009}\nWang, A.~S. and Pelc, N.~J. (2009).\n{} Optimal energy thresholds and weights for separating materials using\n  photon counting x-ray detectors with energy discriminating capabilities.\n{} {\\em Proc SPIE\\/}, \\textbf{725821}.\n\n\\bibitem[Wang and Pelc(2010)Wang and Pelc]{wang2010}\nWang, A.~S. and Pelc, N.~J. (2010).\n{} Impact of photon counting detector spectral response on dual energy\n  techniques.\n{} {\\em Proc SPIE\\/}, \\textbf{76223L}.\n\n\\bibitem[Wang {\\em et~al.}(2009)Wang, Li, and Xing]{wangjin2009}\nWang, J., Li, T., and Xing, L. (2009).\n{} Iterative image reconstruction for CBCT using edge-preserving prior.\n{} {\\em Med. Phys.\\/}, {\\bf 36}(1), 252--260.\n\n\\bibitem[Wu {\\em et~al.}(2009)Wu, Langan, Xu, Benson, Pack, Schmitz, Tkaczyk,\n  Leverentz, and Licato]{wu2009}\nWu, X., Langan, D.~A., Xu, D., Benson, T.~M., Pack, J.~D., Schmitz, A.~M.,\n  Tkaczyk, E.~J., Leverentz, J., and Licato, P. (2009).\n{} Monochromatic CT image representation via fast switching dual kVp.\n{} {\\em Proc SPIE\\/}, \\textbf{7258} 725845.\n\n\\bibitem[Xing {\\em et~al.}(2013)Xing, Li, and Shen]{xing2013}\nXing, Y., Li, Y., and Shen, L. (2013).\n{} A general adaptive decomposition method for multi-energy spectral CT.\n{} {\\em Nuclear Science Symposium and Medical Imaging Conference\n  (NSS/MIC), 2013 IEEE\\/}, pages 1--4. IEEE.\n\n\\bibitem[Yu {\\em et~al.}(2011)Yu, Christner, Leng, Wang, Fletcher, and\n  McCollough]{yu2011}\nYu, L., Christner, J.~A., Leng, S., Wang, J., Fletcher, J.~G., and McCollough,\n  C.~H. (2011).\n{} Virtual monochromatic imaging in dual-source dual-energy CT:\n  radiation dose and image quality.\n{} {\\em Med. Phys.\\/}, {\\bf 38}(12), 6371--6379.\n\n\\bibitem[Yu {\\em et~al.}(2012)Yu, Leng, and McCollough]{yu2012}\nYu, L., Leng, S., and McCollough, C.~H. (2012).\n{} Dual-energy CT-based monochromatic imaging.\n{} {\\em Am. J. Roentgenol.\\/}, {\\bf 199}(5),\n  S9--S15.\n\n\\bibitem[Zhang {\\em et~al.}(2014)Zhang, Thibault, Bouman, Sauer, Hsieh, {\\em\n  et~al.}]{zhang2014}\nZhang, R., Thibault, J.-B., Bouman, C., Sauer, K.~D., Hsieh, J., {\\em et~al.}\n  (2014).\n{} Model-based iterative reconstruction for dual-energy x-ray CT using a\n  joint quadratic likelihood model.\n{} {\\em IEEE Trans. Med. Imag.\\/}, {\\bf 33}(1), 117--134.\n\n\\bibitem[Zhu {\\em et~al.}(2009)Zhu, Wang, and Xing]{zhu2009}\nZhu, L., Wang, J., and Xing, L. (2009).\n{} Noise suppression in scatter correction for cone-beam CT.\n{} {\\em Med. Phys.\\/}, {\\bf 36}(3), 741--752.\n\n\\end{thebibliography}\n\n\n\n\n\n", "itemtype": "equation", "pos": 48799, "prevtext": "\nwhere $R$ -- the quadratic penalty term; $\\lambda$ -- the constant to adjust the relative weights between the data fidelity term and the smooth term. The penalty term is defined as follows,\n\\begin{eqnarray}\n\nR(\\vec{x}) = \\frac{1}{2}\\underset{\\mathbf{i}}\\sum \\underset{\\mathbf{k\\in N_i}} \\sum e_{ik} (x_i-x_k)^2,\n\\end{eqnarray}\nwith $N_i$ the set of four nearest neighbors of the $i$th pixel in the image and $e_{ik}$ the edge-detection weight for pixel $i$ and $k$. \n\nNonlinear conjugate gradient (CG) method \\textcolor{black}{was} used to minimize the cost function defined by equation~(\\ref{equ:costfunction}).\nDuring CG iterations, the gradient \\textcolor{black}{was} calculated by the partial derivation of the cost function with respect to $\\vec{x}$,\n\n", "index": 31, "text": "\\begin{equation}\\label{equ:CG problem}\n\\nabla_{\\vec{x}} F(\\vec{x})= 2 A^{T}V^{-1}(A\\vec{x}-\\vec{\\mu}) + \\lambda\\cdot \\nabla R(\\vec{x}),\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E16.m1\" class=\"ltx_Math\" alttext=\"\\nabla_{\\vec{x}}F(\\vec{x})=2A^{T}V^{-1}(A\\vec{x}-\\vec{\\mu})+\\lambda\\cdot\\nabla&#10;R%&#10;(\\vec{x}),\" display=\"block\"><mrow><mrow><mrow><mrow><msub><mo>\u2207</mo><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u2192</mo></mover></msub><mo>\u2061</mo><mi>F</mi></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u2192</mo></mover><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><msup><mi>A</mi><mi>T</mi></msup><mo>\u2062</mo><msup><mi>V</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mi>A</mi><mo>\u2062</mo><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u2192</mo></mover></mrow><mo>-</mo><mover accent=\"true\"><mi>\u03bc</mi><mo stretchy=\"false\">\u2192</mo></mover></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mrow><mi>\u03bb</mi><mo>\u22c5</mo><mrow><mo>\u2207</mo><mo>\u2061</mo><mi>R</mi></mrow></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u2192</mo></mover><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}]