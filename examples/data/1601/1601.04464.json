[{"file": "1601.04464.tex", "nexttext": "\n\nwhere the data streams of each of the $k$ detectors are combined:\n\n\n", "itemtype": "equation", "pos": 7154, "prevtext": "\n\n\\bibpunct{(}{)}{;}{a}{}{,} \n\n\\title{Optimal CMB map-making in presence of cross-correlated noise} \n\\subtitle{}\n\\author{G. de~Gasperis \\inst{\\ref{inst1},\\ref{inst2}}\n\\and A. Buzzelli \\inst{\\ref{inst1},\\ref{inst2}}\n\\and P. Cabella \\inst{\\ref{inst1},\\ref{inst2}}\n\\and P. de~Bernardis \\inst{\\ref{inst3},\\ref{inst4}}\n\\and N. Vittorio \\inst{\\ref{inst1},\\ref{inst2}}}\n\\institute{Dipartimento di Fisica, Universit\\`a di Roma ``Tor Vergata'', via della Ricerca Scientifica 1, I-00133, Roma, Italy \\label{inst1}\n  \\and Sezione INFN Roma 2, via della Ricerca Scientifica 1, I-00133, Roma, Italy \\label{inst2}\n  \\and Dipartimento di Fisica, Universit\\`a di Roma ``La Sapienza'', piazzale Aldo Moro 5, I-00185, Roma, Italy \\label{inst3}\n  \\and Sezione INFN Roma 1, piazzale Aldo Moro 5, I-00185, Roma, Italy \\label{inst4}}\n\\offprints{giancarlo.degasperis@roma2.infn.it}\n\\date{Received / Accepted}\n\n\n\\abstract\n\n{}\n\n{We present an extension of the ROMA map-making algorithm for the generation of optimal CMB temperature and polarization maps.\nThe new code takes into account a possible cross-correlated noise component among the detectors of a CMB experiment.\nA promising application is the forthcoming LSPE balloon experiment, devoted to the observation of CMB polarization\nat large angular scales.}\n\n{To check the reliability of the code, we tested the extended ROMA algorithm on real and simulated data of the {BOOMERanG}~(2003)\nmission, in order to compare our conclusions with already established results.\nHence, we performed a preliminary forecast of the LSPE/SWIPE instrument.}\n\n{We found that considering the cross-correlation among the detectors results in a more realistic estimate of the\nangular power spectra. In particular, the extended ROMA map-making algorithm provides a strong reduction of the\nspectra error bars. We expect that this improvement will be crucial in constraining the B component of CMB polarization\nat the largest scales.}\n\n{}\n\n\n\n\n\\authorrunning{G. de~Gasperis et~al.}\n\n\\titlerunning{Optimal CMB map-making in presence of cross-correlated noise}\n\n\\keywords{Cosmology: Cosmic microwave background polarization -- Methods: data analysis}\n\n\\maketitle\n\n\\section{Introduction}\\label{intro}\n\nSince its discovery, Cosmic Microwave Background (CMB) has been an invaluable source of cosmological information.\nFrom its temperature and polarization patterns, the cosmological parameters can be constrained with high accuracy\n({BOOMERanG}:~\\citealt{2006ApJ...647..799M}; WMAP:~\\citealt{2013ApJS..208...19H};\n{\\textsc{Planck}}:~\\citealt{2015arXiv150201589P}). The detection of CMB temperature anisotropies has represented a hard experimental\nchallenge because of its very tiny signal level. For CMB polarization, the limitation is even tighter,\nsince its level is $\\approx 10\\%$  of temperature anisotropy.\n\nConstraining the cosmological parameters from observational data is a highly non trivial procedure.\nThe pipeline can be divided into three main steps: the production of optimal CMB maps,\nthe estimation of the angular power spectra from the maps and the constraints on the\ncosmological parameters from the spectra. By ``optimal'' we mean maps with the lowest noise variance\nand with the lowest foreground contamination.\nIn this paper we focus on the former issue, planning the discussion of the latter point in a forthcoming paper.\n\nThe polarization field can be expanded into a gradient component, E-modes, and a curl component,\nB-modes \\citep{1997PhRvL..78.2058K}. While E-modes have been widely observed and analyzed\n\\citep[e.g.\\ {BOOMERanG}:][]{2006ApJ...647..813M}, B-modes are still buried into foreground signal and experimental noise\n\\citep{2015PhRvL.114j1301B}. Nowadays, the detection of B-modes represents one on the most relevant and exciting\nresearch field in cosmology. We know that scalar (density) perturbations produce only E-modes,\nwhile tensor perturbations, i.e.\\ Gravitational Waves (GW), produce both E- and B-modes.\nTherefore, a detection of B-modes would provide a definitive confirmation to the existence of a GW\nprimordial background, as expected in the inflation paradigm \\citep{1999PhR...314....1L}.\n\nDue to the low signal to noise ratio, polarization observations require large multi-detector arrays\n\\citep[see e.g.\\ ][]{2012SPIE.8452E..1DA}. Therefore, CMB data sets have been drastically growing in size\nand the numerical data analysis, that preserves all the relevant cosmological information, is an arduous procedure.\n\nThe importance of an optimal data reduction is crucial in reaching the sensitivity needed for the B-modes analysis.\nAs discussed by \\citet{2008ApJ...681..708P} in the general context of intensity measurement experiments,\nthe increased detector array size rises the problem of cross-talk among the detectors,\nwhich has to be properly taken into account in the map-making  procedure:\nfocal plane temperature and atmospheric fluctuations are expected to produce common-mode noise fluctuations\nin the detectors, which cannot be neglected.\n\nIn this work we present a natural extension of the ROMA map-making code \\citep{2005A&A...436.1159D}\nto produce also optimal CMB polarization maps out of multi-detector CMB observations.\nIn particular, we will discuss how a proper inclusion of the detector noise cross-correlations impacts\nin more realistic estimates of the angular power spectra error bars.\nThis benefit could be crucial for the detection of a primordial B-mode signal.\n\nAmong the next generation of CMB experiments, we focus on the Large Scale Polarization Explorer (LSPE) balloon mission, aimed to\nobserving CMB polarization at large angular scales \\citep{2012SPIE.8452E..3FD, 2012SPIE.8446E..7CB}. For this purpose, LSPE is\nexpected to improve the limit on the ratio of tensor to scalar perturbations amplitudes down to $r=0.03$ and to produce wide maps\nof foreground polarization generated in our Galaxy by synchrotron emission, dominant below $60 \\mathrm{GHz}$,\nand interstellar dust emission, dominant above $90 \\mathrm{GHz}$ \\citep{2012SPIE.8446E..7AA}.\n\nThe paper is organized as follows: in Section \\ref{algebra} we summarize the algebra underlying the map-making procedure;\nin Section \\ref{BOOMERanG} we apply the extended ROMA algorithm for a (re)analysis of the {BOOMERanG}~(2003) data set\nand on simulations; \nin Section \\ref{LSPE} we use a limited number of cross-correlated detectors to perform a preliminary\nforecast of the LSPE/SWIPE experiment. Finally, we draw our conclusions in Section \\ref{Conclusions}.\n\n\n\\section{Formalism and Algebra}\\label{algebra}\n\nNumerous space and balloon borne experiments have been designed to observe the microwave sky.\nEach mission is characterized by its own sky coverage, scanning strategy and instrumental acquisition setup.\nAn experiment observes the sky at a given resolution (i.e.\\ with $N_{p}$ pixels in the sky)\nand collects $N_{d}$ samples in a given temporal sequence, the Time Ordered Data (TOD).\nOnce the data are calibrated and the pointing is perfectly reconstructed, the first step in CMB data analysis\nis the estimation of optimal sky maps from the TOD. The data can be modeled as follows \\citep{2005A&A...436.1159D}:\n\n\n", "index": 1, "text": "\\begin{equation}\n\\mathbf{D} = \\mathbf{A} \\mathbf{S} + \\mathbf{n},\n\\label{1}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"\\mathbf{D}=\\mathbf{A}\\mathbf{S}+\\mathbf{n},\" display=\"block\"><mrow><mrow><mi>\ud835\udc03</mi><mo>=</mo><mrow><mi>\ud835\udc00\ud835\udc12</mi><mo>+</mo><mi>\ud835\udc27</mi></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04464.tex", "nexttext": "\n\nand the generalized $k N_d \\times 3 N_p$ pointing matrix becomes:\n\n\n", "itemtype": "equation", "pos": 7313, "prevtext": "\n\nwhere the data streams of each of the $k$ detectors are combined:\n\n\n", "index": 3, "text": "\\begin{equation}\n \\mathbf{D} \\equiv\n  \\left(\n    \\begin{array}{c}\n      \\mathbf{D}^{(1)} \\\\\n      \\vdots \\\\\n      \\mathbf{D}^{(k)}\n    \\end{array}\n  \\right),\n  \\label{2}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"\\mathbf{D}\\equiv\\left(\\begin{array}[]{c}\\mathbf{D}^{(1)}\\\\&#10;\\vdots\\\\&#10;\\mathbf{D}^{(k)}\\end{array}\\right),\" display=\"block\"><mrow><mrow><mi>\ud835\udc03</mi><mo>\u2261</mo><mrow><mo>(</mo><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><msup><mi>\ud835\udc03</mi><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup></mtd></mtr><mtr><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd></mtr><mtr><mtd columnalign=\"center\"><msup><mi>\ud835\udc03</mi><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup></mtd></mtr></mtable><mo>)</mo></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04464.tex", "nexttext": "\n\nHere the $N_d\\times N_p$ matrix $A^{(j)}_{tp}$ is the pointing matrix of the $j$-th detector,\nwith elements equal to unity if the pixel $p$ is observed at time $t$ and zero otherwise.\nIn Eq.~\\ref{3},  each row of the pointing matrix (that is at fixed $t$) is multiplied either by the\ncosine or the sine of $\\phi_t$, the angle defining the polarimeter orientation at time $t$\nwith respect to a given reference frame.\nSimilarly, the sky signal can be expressed as a $3 N_p$ vector:\n\n\n", "itemtype": "equation", "pos": 7566, "prevtext": "\n\nand the generalized $k N_d \\times 3 N_p$ pointing matrix becomes:\n\n\n", "index": 5, "text": "\\begin{equation}\n  \\mathbf{A} \\equiv\n  \\frac{1}{2} \\left(\n    \\begin{array}{ccccc}\n      A_{tp}^{(1)} &&A_{tp}^{(1)} \\cos 2 \\phi_t^{(1)} && A_{tp}^{(1)} \\sin 2 \\phi_t^{(1)} \\\\\n      \\vdots  && \\vdots && \\vdots \\\\\n       A_{tp}^{(k)} && A_{tp}^{(k)} \\cos 2 \\phi_t^{(k)}&& A_{tp}^{(k)} \\sin 2 \\phi_t^{(k)} \\\\\n    \\end{array}\n  \\right).\n\n\\label{3}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"\\mathbf{A}\\equiv\\frac{1}{2}\\left(\\begin{array}[]{ccccc}A_{tp}^{(1)}&amp;&amp;A_{tp}^{(%&#10;1)}\\cos 2\\phi_{t}^{(1)}&amp;&amp;A_{tp}^{(1)}\\sin 2\\phi_{t}^{(1)}\\\\&#10;\\vdots&amp;&amp;\\vdots&amp;&amp;\\vdots\\\\&#10;A_{tp}^{(k)}&amp;&amp;A_{tp}^{(k)}\\cos 2\\phi_{t}^{(k)}&amp;&amp;A_{tp}^{(k)}\\sin 2\\phi_{t}^{(k%&#10;)}\\\\&#10;\\end{array}\\right).\\par&#10;\" display=\"block\"><mrow><mrow><mi>\ud835\udc00</mi><mo>\u2261</mo><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>\u2062</mo><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><msubsup><mi>A</mi><mrow><mi>t</mi><mo>\u2062</mo><mi>p</mi></mrow><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msubsup></mtd><mtd/><mtd columnalign=\"center\"><mrow><msubsup><mi>A</mi><mrow><mi>t</mi><mo>\u2062</mo><mi>p</mi></mrow><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>\u2062</mo><mrow><mi>cos</mi><mo>\u2061</mo><mrow><mn>2</mn><mo>\u2062</mo><msubsup><mi>\u03d5</mi><mi>t</mi><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msubsup></mrow></mrow></mrow></mtd><mtd/><mtd columnalign=\"center\"><mrow><msubsup><mi>A</mi><mrow><mi>t</mi><mo>\u2062</mo><mi>p</mi></mrow><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>\u2062</mo><mrow><mi>sin</mi><mo>\u2061</mo><mrow><mn>2</mn><mo>\u2062</mo><msubsup><mi>\u03d5</mi><mi>t</mi><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msubsup></mrow></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd></mtr><mtr><mtd columnalign=\"center\"><msubsup><mi>A</mi><mrow><mi>t</mi><mo>\u2062</mo><mi>p</mi></mrow><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msubsup></mtd><mtd/><mtd columnalign=\"center\"><mrow><msubsup><mi>A</mi><mrow><mi>t</mi><mo>\u2062</mo><mi>p</mi></mrow><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>\u2062</mo><mrow><mi>cos</mi><mo>\u2061</mo><mrow><mn>2</mn><mo>\u2062</mo><msubsup><mi>\u03d5</mi><mi>t</mi><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msubsup></mrow></mrow></mrow></mtd><mtd/><mtd columnalign=\"center\"><mrow><msubsup><mi>A</mi><mrow><mi>t</mi><mo>\u2062</mo><mi>p</mi></mrow><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>\u2062</mo><mrow><mi>sin</mi><mo>\u2061</mo><mrow><mn>2</mn><mo>\u2062</mo><msubsup><mi>\u03d5</mi><mi>t</mi><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msubsup></mrow></mrow></mrow></mtd></mtr></mtable><mo>)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04464.tex", "nexttext": "\n\nwhere $\\mathbf{I}$, $ \\mathbf{Q}$ and $ \\mathbf{U}$ are $N_p$ Stokes parameter vectors of the pixelized CMB sky.\nThe noise stream is:\n\n\n", "itemtype": "equation", "pos": 8408, "prevtext": "\n\nHere the $N_d\\times N_p$ matrix $A^{(j)}_{tp}$ is the pointing matrix of the $j$-th detector,\nwith elements equal to unity if the pixel $p$ is observed at time $t$ and zero otherwise.\nIn Eq.~\\ref{3},  each row of the pointing matrix (that is at fixed $t$) is multiplied either by the\ncosine or the sine of $\\phi_t$, the angle defining the polarimeter orientation at time $t$\nwith respect to a given reference frame.\nSimilarly, the sky signal can be expressed as a $3 N_p$ vector:\n\n\n", "index": 7, "text": "\\begin{equation}\n\\mathbf{S} \\equiv \n  \\left(\n    \\begin{array}{c}\n      \\mathbf{I}  \\\\\n      \\mathbf{Q} \\\\\n      \\mathbf{U}\n    \\end{array}\n    \\right),\n\\label{4}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"\\mathbf{S}\\equiv\\left(\\begin{array}[]{c}\\mathbf{I}\\\\&#10;\\mathbf{Q}\\\\&#10;\\mathbf{U}\\end{array}\\right),\" display=\"block\"><mrow><mrow><mi>\ud835\udc12</mi><mo>\u2261</mo><mrow><mo>(</mo><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mi>\ud835\udc08</mi></mtd></mtr><mtr><mtd columnalign=\"center\"><mi>\ud835\udc10</mi></mtd></mtr><mtr><mtd columnalign=\"center\"><mi>\ud835\udc14</mi></mtd></mtr></mtable><mo>)</mo></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04464.tex", "nexttext": "\n\nwhere $\\mathbf{n}^{(j)}$ is the $N_{d}$ element noise vector  of the $j$-th detector, accounting for instrumental noise,\natmospheric and temperature fluctuations, cosmic-ray hits and any other random effect. \n\nAn optimal estimator $\\widetilde{\\mathbf{S}}$ of ${\\mathbf{S}}$ is given by \\citep{2005A&A...436.1159D}:\n\n\n", "itemtype": "equation", "pos": 8722, "prevtext": "\n\nwhere $\\mathbf{I}$, $ \\mathbf{Q}$ and $ \\mathbf{U}$ are $N_p$ Stokes parameter vectors of the pixelized CMB sky.\nThe noise stream is:\n\n\n", "index": 9, "text": "\\begin{equation}\n\\mathbf{n} \\equiv\n  \\left(\n    \\begin{array}{c}\n      \\mathbf{n}^{(1)} \\\\\n      \\vdots \\\\\n      \\mathbf{n}^{(k)}\n    \\end{array}\n\\right).\n\\label{5}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"\\mathbf{n}\\equiv\\left(\\begin{array}[]{c}\\mathbf{n}^{(1)}\\\\&#10;\\vdots\\\\&#10;\\mathbf{n}^{(k)}\\end{array}\\right).\" display=\"block\"><mrow><mrow><mi>\ud835\udc27</mi><mo>\u2261</mo><mrow><mo>(</mo><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><msup><mi>\ud835\udc27</mi><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup></mtd></mtr><mtr><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd></mtr><mtr><mtd columnalign=\"center\"><msup><mi>\ud835\udc27</mi><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup></mtd></mtr></mtable><mo>)</mo></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04464.tex", "nexttext": "\n\nwhere the noise covariance matrix $\\mathbf{N}$ is:\n\n\n", "itemtype": "equation", "pos": 9219, "prevtext": "\n\nwhere $\\mathbf{n}^{(j)}$ is the $N_{d}$ element noise vector  of the $j$-th detector, accounting for instrumental noise,\natmospheric and temperature fluctuations, cosmic-ray hits and any other random effect. \n\nAn optimal estimator $\\widetilde{\\mathbf{S}}$ of ${\\mathbf{S}}$ is given by \\citep{2005A&A...436.1159D}:\n\n\n", "index": 11, "text": "\\begin{equation}\\label{6}\n  \\mathbf{\\widetilde S} = \\left( \\mathbf{A}^T\n\\mathbf{N}^{-1} \\mathbf{A}\\right)^{-1}\n  \\mathbf{A}^T \\mathbf{N}^{-1} \\mathbf{D},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"\\mathbf{\\widetilde{S}}=\\left(\\mathbf{A}^{T}\\mathbf{N}^{-1}\\mathbf{A}\\right)^{-%&#10;1}\\mathbf{A}^{T}\\mathbf{N}^{-1}\\mathbf{D},\" display=\"block\"><mrow><mrow><mover accent=\"true\"><mi>\ud835\udc12</mi><mo>~</mo></mover><mo>=</mo><mrow><msup><mrow><mo>(</mo><mrow><msup><mi>\ud835\udc00</mi><mi>T</mi></msup><mo>\u2062</mo><msup><mi>\ud835\udc0d</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><mi>\ud835\udc00</mi></mrow><mo>)</mo></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><msup><mi>\ud835\udc00</mi><mi>T</mi></msup><mo>\u2062</mo><msup><mi>\ud835\udc0d</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><mi>\ud835\udc03</mi></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04464.tex", "nexttext": "\n\nand $\\left\\langle \\cdot \\right\\rangle$ denotes the expectation value.\nIt is customary to assume a stationary noise, i.e.\\ the statistical properties of the noise do not change over the mission life\ntime. Consider the $j$- and $\\ell$- detectors and the noise elements $n_t^{(j)}$ and  $n_{t^\\prime}^{(\\ell)}$ at time $t$ and\n$t^\\prime$, respectively: we here assume that $\\left\\langle  n_t^{(j)}  n_{t^\\prime}^{(\\ell)}\\right\\rangle $ depends only\non $|t-t^{\\prime}|$, implying that the phase information is not relevant \\citep[see also][]{2006A&A...458..687M}.\nMoreover, we will assume  that the noise  statistical properties are completely described by the noise covariance matrix,\nas for a Gaussian distributed noise, either known \\emph{a priori}  or estimated \\emph{a posteriori}.\nIn the case of no cross-correlation, $\\mathbf{N}$ is block diagonal with respect to the detector index and each block\ncan be inverted independently. On the contrary, in the most general case (i.e.\\ with cross-correlation),\n$\\mathbf{N}$ is expected to have a more complicated structure.\n\nThe stationarity property assumed above implies that $\\mathbf{N}$ is a block-circulant matrix. In this way,\nthe inversion of $\\mathbf{N}$ is much easier, since the Fourier counterpart of a block-circulant matrix is block-diagonal.\nLet us define the multichannel Fourier operator $\\bar{F}$ such that:\n\n\n", "itemtype": "equation", "pos": 9441, "prevtext": "\n\nwhere the noise covariance matrix $\\mathbf{N}$ is:\n\n\n", "index": 13, "text": "\\begin{equation}\n  \\mathbf{N} \\equiv \\left\\langle \\mathbf{n}_t \\mathbf{n}_{t^\\prime}\\right\\rangle=\n  \\left(\n    \\begin{array}{ccc}\n      \\left\\langle   n_t^{(1)}   n_{t^\\prime}^{(1)} \\right\\rangle & \n      \\cdots &\n      \\left\\langle   n_t^{(1)}    n_{t^\\prime}^{(k)} \\right\\rangle \\\\\n      \\vdots & \\ddots & \\vdots  \\\\ \n      \\left\\langle   n_t^{(k)}    n_{t^\\prime}^{(1)} \\right\\rangle &\n      \\cdots &\n      \\left\\langle    n_t^{(k)}    n_{t^\\prime}^{(k)} \\right\\rangle \n    \\end{array}\n  \\right),\n\\label{7}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"\\mathbf{N}\\equiv\\left\\langle\\mathbf{n}_{t}\\mathbf{n}_{t^{\\prime}}\\right\\rangle%&#10;=\\left(\\begin{array}[]{ccc}\\left\\langle n_{t}^{(1)}n_{t^{\\prime}}^{(1)}\\right%&#10;\\rangle&amp;\\cdots&amp;\\left\\langle n_{t}^{(1)}n_{t^{\\prime}}^{(k)}\\right\\rangle\\\\&#10;\\vdots&amp;\\ddots&amp;\\vdots\\\\&#10;\\left\\langle n_{t}^{(k)}n_{t^{\\prime}}^{(1)}\\right\\rangle&amp;\\cdots&amp;\\left\\langle n%&#10;_{t}^{(k)}n_{t^{\\prime}}^{(k)}\\right\\rangle\\end{array}\\right),\" display=\"block\"><mrow><mrow><mi>\ud835\udc0d</mi><mo>\u2261</mo><mrow><mo>\u27e8</mo><mrow><msub><mi>\ud835\udc27</mi><mi>t</mi></msub><mo>\u2062</mo><msub><mi>\ud835\udc27</mi><msup><mi>t</mi><mo>\u2032</mo></msup></msub></mrow><mo>\u27e9</mo></mrow><mo>=</mo><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><mo>\u27e8</mo><mrow><msubsup><mi>n</mi><mi>t</mi><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>\u2062</mo><msubsup><mi>n</mi><msup><mi>t</mi><mo>\u2032</mo></msup><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msubsup></mrow><mo>\u27e9</mo></mrow></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mrow><mo>\u27e8</mo><mrow><msubsup><mi>n</mi><mi>t</mi><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>\u2062</mo><msubsup><mi>n</mi><msup><mi>t</mi><mo>\u2032</mo></msup><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msubsup></mrow><mo>\u27e9</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22f1</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><mo>\u27e8</mo><mrow><msubsup><mi>n</mi><mi>t</mi><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>\u2062</mo><msubsup><mi>n</mi><msup><mi>t</mi><mo>\u2032</mo></msup><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msubsup></mrow><mo>\u27e9</mo></mrow></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mrow><mo>\u27e8</mo><mrow><msubsup><mi>n</mi><mi>t</mi><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>\u2062</mo><msubsup><mi>n</mi><msup><mi>t</mi><mo>\u2032</mo></msup><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msubsup></mrow><mo>\u27e9</mo></mrow></mtd></mtr></mtable><mo>)</mo></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04464.tex", "nexttext": "\n\nwhere:\n\n", "itemtype": "equation", "pos": 11339, "prevtext": "\n\nand $\\left\\langle \\cdot \\right\\rangle$ denotes the expectation value.\nIt is customary to assume a stationary noise, i.e.\\ the statistical properties of the noise do not change over the mission life\ntime. Consider the $j$- and $\\ell$- detectors and the noise elements $n_t^{(j)}$ and  $n_{t^\\prime}^{(\\ell)}$ at time $t$ and\n$t^\\prime$, respectively: we here assume that $\\left\\langle  n_t^{(j)}  n_{t^\\prime}^{(\\ell)}\\right\\rangle $ depends only\non $|t-t^{\\prime}|$, implying that the phase information is not relevant \\citep[see also][]{2006A&A...458..687M}.\nMoreover, we will assume  that the noise  statistical properties are completely described by the noise covariance matrix,\nas for a Gaussian distributed noise, either known \\emph{a priori}  or estimated \\emph{a posteriori}.\nIn the case of no cross-correlation, $\\mathbf{N}$ is block diagonal with respect to the detector index and each block\ncan be inverted independently. On the contrary, in the most general case (i.e.\\ with cross-correlation),\n$\\mathbf{N}$ is expected to have a more complicated structure.\n\nThe stationarity property assumed above implies that $\\mathbf{N}$ is a block-circulant matrix. In this way,\nthe inversion of $\\mathbf{N}$ is much easier, since the Fourier counterpart of a block-circulant matrix is block-diagonal.\nLet us define the multichannel Fourier operator $\\bar{F}$ such that:\n\n\n", "index": 15, "text": "\\begin{equation}\n\\bar{\\mathbf{n}}=\\bar{F}{\\mathbf{n}},\n\\label{8}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m1\" class=\"ltx_Math\" alttext=\"\\bar{\\mathbf{n}}=\\bar{F}{\\mathbf{n}},\" display=\"block\"><mrow><mrow><mover accent=\"true\"><mi>\ud835\udc27</mi><mo stretchy=\"false\">\u00af</mo></mover><mo>=</mo><mrow><mover accent=\"true\"><mi>F</mi><mo stretchy=\"false\">\u00af</mo></mover><mo>\u2062</mo><mi>\ud835\udc27</mi></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04464.tex", "nexttext": "\ncontains end to end the Fourier transforms, $F{\\mathbf{n}}^{(j)}$, of each segment of ${\\mathbf{n}}$.\nThus, in the case of a  number of cross-correlated detectors, the inverse of $\\mathbf{N}$ is given by:\n\n\n", "itemtype": "equation", "pos": 11427, "prevtext": "\n\nwhere:\n\n", "index": 17, "text": "\\begin{equation}\n\\bar{\\mathbf{n}} \\equiv\n  \\left(\n    \\begin{array}{c}\n      F{\\mathbf{n}}^{(1)} \\\\\n      \\vdots \\\\\n      F{\\mathbf{n}}^{(k)}\n    \\end{array}\n\\right),\n\\label{eq:9}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m1\" class=\"ltx_Math\" alttext=\"\\bar{\\mathbf{n}}\\equiv\\left(\\begin{array}[]{c}F{\\mathbf{n}}^{(1)}\\\\&#10;\\vdots\\\\&#10;F{\\mathbf{n}}^{(k)}\\end{array}\\right),\" display=\"block\"><mrow><mrow><mover accent=\"true\"><mi>\ud835\udc27</mi><mo stretchy=\"false\">\u00af</mo></mover><mo>\u2261</mo><mrow><mo>(</mo><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><mi>F</mi><mo>\u2062</mo><msup><mi>\ud835\udc27</mi><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><mi>F</mi><mo>\u2062</mo><msup><mi>\ud835\udc27</mi><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></msup></mrow></mtd></mtr></mtable><mo>)</mo></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04464.tex", "nexttext": "\n\nwhere, under the assumption that the $N_d\\times N_d$ matrix $ \\left\\langle n_t^{(i)} n_{t^\\prime}^{(j)} \\right\\rangle $\nis circulant, $R^{(ij)}$ is a diagonal matrix with elements given by the noise cross-power spectrum\nbetween detectors $i$ and $j$ at frequency $f$:\n\n", "itemtype": "equation", "pos": 11828, "prevtext": "\ncontains end to end the Fourier transforms, $F{\\mathbf{n}}^{(j)}$, of each segment of ${\\mathbf{n}}$.\nThus, in the case of a  number of cross-correlated detectors, the inverse of $\\mathbf{N}$ is given by:\n\n\n", "index": 19, "text": "\\begin{equation}\n{\\mathbf{N}}^{-1}=\\bar{F}^{T}{\\mathbf{R}}^{-1}\\bar{F},\n\\label{eq:10}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E10.m1\" class=\"ltx_Math\" alttext=\"{\\mathbf{N}}^{-1}=\\bar{F}^{T}{\\mathbf{R}}^{-1}\\bar{F},\" display=\"block\"><mrow><mrow><msup><mi>\ud835\udc0d</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>=</mo><mrow><msup><mover accent=\"true\"><mi>F</mi><mo stretchy=\"false\">\u00af</mo></mover><mi>T</mi></msup><mo>\u2062</mo><msup><mi>\ud835\udc11</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><mover accent=\"true\"><mi>F</mi><mo stretchy=\"false\">\u00af</mo></mover></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04464.tex", "nexttext": "\nTo find $ \\mathbf{\\widetilde S}$, we can now solve iteratively the linear system in Eq.~\\ref{6}\nusing a Preconditioned Conjugate Gradient method.\n\nTo achieve a good convergence speed it is of paramount importance to provide a good preconditioner for the matrix\n$\\left( \\mathbf{A}^T\\mathbf{N}^{-1} \\mathbf{A}\\right)$. Our choice is to approximate the matrix $\\mathbf{N}^{-1}$\nwith its diagonal part \\citep[see][for further details]{2014A&A...572A..39S}\nand our preconditioner, $\\mathbf{H}$, will be:\n\n", "itemtype": "equation", "pos": 12198, "prevtext": "\n\nwhere, under the assumption that the $N_d\\times N_d$ matrix $ \\left\\langle n_t^{(i)} n_{t^\\prime}^{(j)} \\right\\rangle $\nis circulant, $R^{(ij)}$ is a diagonal matrix with elements given by the noise cross-power spectrum\nbetween detectors $i$ and $j$ at frequency $f$:\n\n", "index": 21, "text": "\\begin{equation}\n{R^{(ij)}}_{ff^\\prime}=P^{(ij)}(f) \\delta^{f^\\prime}_f,\n\\label{eq:11}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E11.m1\" class=\"ltx_Math\" alttext=\"{R^{(ij)}}_{ff^{\\prime}}=P^{(ij)}(f)\\delta^{f^{\\prime}}_{f},\" display=\"block\"><mrow><mrow><mmultiscripts><mi>R</mi><none/><mrow><mo stretchy=\"false\">(</mo><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mi>f</mi><mo>\u2062</mo><msup><mi>f</mi><mo>\u2032</mo></msup></mrow><none/></mmultiscripts><mo>=</mo><mrow><msup><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow><mo stretchy=\"false\">)</mo></mrow></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msubsup><mi>\u03b4</mi><mi>f</mi><msup><mi>f</mi><mo>\u2032</mo></msup></msubsup></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04464.tex", "nexttext": "\nIt can be shown that, under these approximations, the preconditioning operator $\\mathbf{H}$\nis a $3\\times 3$ block diagonal matrix, each block being the linear operator that solves for the\nthree Stokes parameters of the given pixel for white noise contaminated detectors.\n\nNote that the inverse condition number $\\mathrm{R_{cond}}$ of each block of $\\mathbf{H}$, defined as the ratio of the absolute\nvalues of its smallest and  largest eigenvalue, can be used as a good tracer of the errors in the Stokes parameter estimation due\nto an inadequate polarization angle coverage on the given pixel \\citep[see e.g.\\ ][]{2007A&A...471..361A}. In particular \n$0 \\leq \\mathrm{R_{cond}} \\leq 0.5$, assuming its lower value in the worst case and\n$\\mathrm{R_{cond}} \\to 0.5$ in the limit of uniform angle coverage.\n\n\n\n\\section{{BOOMERanG}~(2003)}\\label{BOOMERanG}\n\nTo test the new algorithm in a real data analysis case we focus now on {BOOMERanG}, a long duration balloon-borne experiment,\nflown in 2003 and devoted mainly to CMB polarization measurement \\citep{2006A&A...458..687M}.\nThis will allow us check the reliability of the algorithm and to compare our conclusions with already established results.\n\nThe {BOOMERanG}\\ observation strategy was designed to cover three regions: the ``deep'' region ($\\sim90$ square degrees) to observe polarization; the ``shallow'' region ($\\sim750$ square degrees) to observe temperature anisotropy;\na portion of the Galactic Plane ($\\sim300$ square degrees) scanned for studying Galactic foreground emission\n\\citep{2007NewAR..51..244P}.\nThe survey was carried out in three wide frequency bands centered at $145$, $245$ and $345\\mathrm{GHz}$,\nwith an angular resolution of about $10\\arcmin$.\nIn this paper, we focus on the deep and shallow region scanned by the $145 \\mathrm{GHz}$ channel.\n\nAs well known, a complete characterization of the Stokes parameters $I$, $Q$ and $U$\nwas achieved through the joint analysis of the data from the eight $145 \\mathrm{GHz}$ detectors.\n\nThe \nmap of the Stokes parameter $I$ is dominated by CMB temperature anisotropy, which is mapped with high signal to noise ratio,\nand the maps of the Stokes parameters $Q$ and $U$ provided a detection of CMB polarization E-modes\n\\citep{2006ApJ...647..813M}. The amplitude of the detected polarization is consistent with the $\\Lambda$-CDM cosmological scenario. \nFor more detail see~\\citet{2006A&A...458..687M}.\n\nIt is known that the noise of a CMB balloon-borne experiment is characterized by a behavior $1/f^{\\alpha}$,\nwith $1\\lesssim \\alpha \\lesssim 2$, at low frequency ($f\\lesssim f_{k}$) and a constant behavior at higher frequency\n($f\\gtrsim f_{k}$). In the past analysis, the data have been heavily filtered for frequencies\nlower than a cut frequency $f_c \\simeq 0.07 \\mathrm{Hz}$ in order to maximize the signal to noise ratio.\nIn fact, below the channel's knee frequency $f_{k}$ $\\sim0.1\\mathrm{Hz}$ there was no significant cosmological signal,\nso that the application of this high pass filter was reasonable.\n\nIn the previous works on the {BOOMERanG}\\ experiment, the cross-correlation among the detectors, found to be less than $10\\%$, was\nneglected in the map-making procedure \\citep{2006A&A...458..687M}.\nTo check the reliability of the extended ROMA code we can now include the cross-correlated noise component\ndirectly estimated from the real data, following the IT-pipeline path described in the {BOOMERanG}\\ literature.\n\nWe generated 100 noise-only, signal-only and signal plus noise Monte Carlo maps, both neglecting and including\nthe estimated cross-correlation in the map-making code and we produced the angular power spectra using the\nMASTER algorithm \\citep{2002ApJ...567....2H}.\n\nIn Fig.~\\ref{TT} and \\ref{EE} we show the fractional difference of the TT and EE power spectra error bars when the maximum\nlikelihood maps are estimated neglecting the noise cross-correlation spectrum or estimated taking in account the full noise\ncorrelation information.\nWhile the analysis shows a moderate improvement in the error bars estimates, especially for the I-Stokes angular power spectrum,\nthe  $16 \\mathrm{mHz}$ high-pass filter present in the amplification chain limits the possibility to quantify the benefits\nobtained when considering the full noise covariance matrix in the estimate of the minimum variance maps.\n\n\\begin{figure}\n\\centering\n\\psfrag{Multipolel}[c][][3]{Multipole $\\ell$}\n\\includegraphics[angle=90,width=\\columnwidth]{fig1}\n\\caption{Fractional difference between the TT spectra error bars, estimated considering and neglecting cross-correlation for the\n{BOOMERanG}~(2003) dataset: the moderate improvement in the error bars estimate at the higher order multipole is due to the high pass\nfilter applied to the original data, while the low-$\\ell$ part is dominated by the cosmic variance.}\n\\label{TT}\n\\end{figure}\n\\begin{figure}\n\\centering\n\\psfrag{Multipolel}[c][][3]{Multipole $\\ell$}\n\\includegraphics[angle=90,width=\\columnwidth]{fig2}\n\\caption{Fractional difference between the EE spectra error bars, estimated considering and neglecting cross-correlation for the\n{BOOMERanG}~(2003) dataset: The moderate improvement in the error bars estimate at the higher order multipole is due to the high pass\nfilter applied to the data.}\n\\label{EE}\n\\end{figure}\n\nAn experiment aimed at the polarization B-modes observation is expected to focus on the low frequency range; thus keeping into\naccount the noise cross-correlation will be particularly crucial in this case.\n\nIn order to verify the improvement due to the inclusion of the cross-correlation among the detectors, we test then the algorithm on\nsimulated data that include also the low frequency $1/f^{\\alpha}$ part of the noise spectrum, where the cross-correlation is found\nto be more relevant. The reason is that the effects of atmospheric fluctuations and temperature drifts, which are seen by the whole\nfocal plane and represent the main source of cross correlated noise, are heavier at these low frequencies.\n\nOur toy model is a {BOOMERanG}~(2003) simulated focal plane in which any low frequency noise modes are due to an external noise source\nseen by all the focal plane's detectors. Moreover each detector pair is characterized by a residual correlated white noise\ncomponent of different amplitude, and finally each detector shows an uncorrelated white noise fraction. These noise properties\nmimic, in shape and amplitude, the ones found in the {BOOMERanG}~(2003) real dataset.\n\nFor this purpose, using the real {BOOMERanG}~(2003) scanning strategy,  bolometers' polarization angles, and flagged data,\nwe simulated eight timelines, each of $N_d \\simeq 5\\times 10^7$ samples, characterized by the following noise spectra:\n\n\n", "itemtype": "equation", "pos": 12799, "prevtext": "\nTo find $ \\mathbf{\\widetilde S}$, we can now solve iteratively the linear system in Eq.~\\ref{6}\nusing a Preconditioned Conjugate Gradient method.\n\nTo achieve a good convergence speed it is of paramount importance to provide a good preconditioner for the matrix\n$\\left( \\mathbf{A}^T\\mathbf{N}^{-1} \\mathbf{A}\\right)$. Our choice is to approximate the matrix $\\mathbf{N}^{-1}$\nwith its diagonal part \\citep[see][for further details]{2014A&A...572A..39S}\nand our preconditioner, $\\mathbf{H}$, will be:\n\n", "index": 23, "text": "\\begin{equation}\n \\mathbf{H} = \\left[\\mathbf{A}^T {\\operatorname{diag}} \\left(\\mathbf{N}^{-1}\\right) \\mathbf{A}\\right]^{-1}.\n \\label{eq:preconditioner}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E12.m1\" class=\"ltx_Math\" alttext=\"\\mathbf{H}=\\left[\\mathbf{A}^{T}{\\operatorname{diag}}\\left(\\mathbf{N}^{-1}%&#10;\\right)\\mathbf{A}\\right]^{-1}.\" display=\"block\"><mrow><mrow><mi>\ud835\udc07</mi><mo>=</mo><msup><mrow><mo>[</mo><mrow><msup><mi>\ud835\udc00</mi><mi>T</mi></msup><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\operatorname</mtext></merror><mo>\u2062</mo><mi>d</mi><mo>\u2062</mo><mi>i</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>g</mi><mo>\u2062</mo><mrow><mo>(</mo><msup><mi>\ud835\udc0d</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>)</mo></mrow><mo>\u2062</mo><mi>\ud835\udc00</mi></mrow><mo>]</mo></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04464.tex", "nexttext": "\n\n", "itemtype": "equation", "pos": 19681, "prevtext": "\nIt can be shown that, under these approximations, the preconditioning operator $\\mathbf{H}$\nis a $3\\times 3$ block diagonal matrix, each block being the linear operator that solves for the\nthree Stokes parameters of the given pixel for white noise contaminated detectors.\n\nNote that the inverse condition number $\\mathrm{R_{cond}}$ of each block of $\\mathbf{H}$, defined as the ratio of the absolute\nvalues of its smallest and  largest eigenvalue, can be used as a good tracer of the errors in the Stokes parameter estimation due\nto an inadequate polarization angle coverage on the given pixel \\citep[see e.g.\\ ][]{2007A&A...471..361A}. In particular \n$0 \\leq \\mathrm{R_{cond}} \\leq 0.5$, assuming its lower value in the worst case and\n$\\mathrm{R_{cond}} \\to 0.5$ in the limit of uniform angle coverage.\n\n\n\n\\section{{BOOMERanG}~(2003)}\\label{BOOMERanG}\n\nTo test the new algorithm in a real data analysis case we focus now on {BOOMERanG}, a long duration balloon-borne experiment,\nflown in 2003 and devoted mainly to CMB polarization measurement \\citep{2006A&A...458..687M}.\nThis will allow us check the reliability of the algorithm and to compare our conclusions with already established results.\n\nThe {BOOMERanG}\\ observation strategy was designed to cover three regions: the ``deep'' region ($\\sim90$ square degrees) to observe polarization; the ``shallow'' region ($\\sim750$ square degrees) to observe temperature anisotropy;\na portion of the Galactic Plane ($\\sim300$ square degrees) scanned for studying Galactic foreground emission\n\\citep{2007NewAR..51..244P}.\nThe survey was carried out in three wide frequency bands centered at $145$, $245$ and $345\\mathrm{GHz}$,\nwith an angular resolution of about $10\\arcmin$.\nIn this paper, we focus on the deep and shallow region scanned by the $145 \\mathrm{GHz}$ channel.\n\nAs well known, a complete characterization of the Stokes parameters $I$, $Q$ and $U$\nwas achieved through the joint analysis of the data from the eight $145 \\mathrm{GHz}$ detectors.\n\nThe \nmap of the Stokes parameter $I$ is dominated by CMB temperature anisotropy, which is mapped with high signal to noise ratio,\nand the maps of the Stokes parameters $Q$ and $U$ provided a detection of CMB polarization E-modes\n\\citep{2006ApJ...647..813M}. The amplitude of the detected polarization is consistent with the $\\Lambda$-CDM cosmological scenario. \nFor more detail see~\\citet{2006A&A...458..687M}.\n\nIt is known that the noise of a CMB balloon-borne experiment is characterized by a behavior $1/f^{\\alpha}$,\nwith $1\\lesssim \\alpha \\lesssim 2$, at low frequency ($f\\lesssim f_{k}$) and a constant behavior at higher frequency\n($f\\gtrsim f_{k}$). In the past analysis, the data have been heavily filtered for frequencies\nlower than a cut frequency $f_c \\simeq 0.07 \\mathrm{Hz}$ in order to maximize the signal to noise ratio.\nIn fact, below the channel's knee frequency $f_{k}$ $\\sim0.1\\mathrm{Hz}$ there was no significant cosmological signal,\nso that the application of this high pass filter was reasonable.\n\nIn the previous works on the {BOOMERanG}\\ experiment, the cross-correlation among the detectors, found to be less than $10\\%$, was\nneglected in the map-making procedure \\citep{2006A&A...458..687M}.\nTo check the reliability of the extended ROMA code we can now include the cross-correlated noise component\ndirectly estimated from the real data, following the IT-pipeline path described in the {BOOMERanG}\\ literature.\n\nWe generated 100 noise-only, signal-only and signal plus noise Monte Carlo maps, both neglecting and including\nthe estimated cross-correlation in the map-making code and we produced the angular power spectra using the\nMASTER algorithm \\citep{2002ApJ...567....2H}.\n\nIn Fig.~\\ref{TT} and \\ref{EE} we show the fractional difference of the TT and EE power spectra error bars when the maximum\nlikelihood maps are estimated neglecting the noise cross-correlation spectrum or estimated taking in account the full noise\ncorrelation information.\nWhile the analysis shows a moderate improvement in the error bars estimates, especially for the I-Stokes angular power spectrum,\nthe  $16 \\mathrm{mHz}$ high-pass filter present in the amplification chain limits the possibility to quantify the benefits\nobtained when considering the full noise covariance matrix in the estimate of the minimum variance maps.\n\n\\begin{figure}\n\\centering\n\\psfrag{Multipolel}[c][][3]{Multipole $\\ell$}\n\\includegraphics[angle=90,width=\\columnwidth]{fig1}\n\\caption{Fractional difference between the TT spectra error bars, estimated considering and neglecting cross-correlation for the\n{BOOMERanG}~(2003) dataset: the moderate improvement in the error bars estimate at the higher order multipole is due to the high pass\nfilter applied to the original data, while the low-$\\ell$ part is dominated by the cosmic variance.}\n\\label{TT}\n\\end{figure}\n\\begin{figure}\n\\centering\n\\psfrag{Multipolel}[c][][3]{Multipole $\\ell$}\n\\includegraphics[angle=90,width=\\columnwidth]{fig2}\n\\caption{Fractional difference between the EE spectra error bars, estimated considering and neglecting cross-correlation for the\n{BOOMERanG}~(2003) dataset: The moderate improvement in the error bars estimate at the higher order multipole is due to the high pass\nfilter applied to the data.}\n\\label{EE}\n\\end{figure}\n\nAn experiment aimed at the polarization B-modes observation is expected to focus on the low frequency range; thus keeping into\naccount the noise cross-correlation will be particularly crucial in this case.\n\nIn order to verify the improvement due to the inclusion of the cross-correlation among the detectors, we test then the algorithm on\nsimulated data that include also the low frequency $1/f^{\\alpha}$ part of the noise spectrum, where the cross-correlation is found\nto be more relevant. The reason is that the effects of atmospheric fluctuations and temperature drifts, which are seen by the whole\nfocal plane and represent the main source of cross correlated noise, are heavier at these low frequencies.\n\nOur toy model is a {BOOMERanG}~(2003) simulated focal plane in which any low frequency noise modes are due to an external noise source\nseen by all the focal plane's detectors. Moreover each detector pair is characterized by a residual correlated white noise\ncomponent of different amplitude, and finally each detector shows an uncorrelated white noise fraction. These noise properties\nmimic, in shape and amplitude, the ones found in the {BOOMERanG}~(2003) real dataset.\n\nFor this purpose, using the real {BOOMERanG}~(2003) scanning strategy,  bolometers' polarization angles, and flagged data,\nwe simulated eight timelines, each of $N_d \\simeq 5\\times 10^7$ samples, characterized by the following noise spectra:\n\n\n", "index": 25, "text": "\\begin{equation}\nP_{ii}(f)\\propto w_{ii}+\\left(\\frac{f_{k}}{f}\\right)^{\\alpha},\\label{11}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E13.m1\" class=\"ltx_Math\" alttext=\"P_{ii}(f)\\propto w_{ii}+\\left(\\frac{f_{k}}{f}\\right)^{\\alpha},\" display=\"block\"><mrow><mrow><mrow><msub><mi>P</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>i</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u221d</mo><mrow><msub><mi>w</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>i</mi></mrow></msub><mo>+</mo><msup><mrow><mo>(</mo><mfrac><msub><mi>f</mi><mi>k</mi></msub><mi>f</mi></mfrac><mo>)</mo></mrow><mi>\u03b1</mi></msup></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04464.tex", "nexttext": "\n\n", "itemtype": "equation", "pos": 19786, "prevtext": "\n\n", "index": 27, "text": "\\begin{equation}\nP_{ij}(f)\\propto w_{ij}+\\left(\\frac{f_{k}}{f}\\right)^{\\alpha}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14.m1\" class=\"ltx_Math\" alttext=\"P_{ij}(f)\\propto w_{ij}+\\left(\\frac{f_{k}}{f}\\right)^{\\alpha}\" display=\"block\"><mrow><mrow><msub><mi>P</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u221d</mo><mrow><msub><mi>w</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>+</mo><msup><mrow><mo>(</mo><mfrac><msub><mi>f</mi><mi>k</mi></msub><mi>f</mi></mfrac><mo>)</mo></mrow><mi>\u03b1</mi></msup></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04464.tex", "nexttext": "\n\nwhere $P_{ii}(f)$ is the noise spectrum of the $i$-th detector, and $P_{ij}(f)$ and $P_{ir}(f)$ are the noise cross-spectra\nof detectors in the same and in different horns, respectively. We assume a low frequency trend $1/f^{\\alpha}$, with\n$\\alpha=2$, common for all the noise spectra, and a constant trend $w_{ii}=10w_{ij}=100w_{ir}$ at high frequency.\nA schematic plot is shown in Fig.~\\ref{noise}.\n\n\\begin{figure}\n\\centering\n\\psfrag{Freq/[Hz]}[c][][3]{Frequency \\hskip 1em [$\\mathrm{Hz}$]}\n\\includegraphics[angle=90,width=\\columnwidth]{fig3}\n\\caption{Noise power spectra assumed in the map-making algorithm for simulations: the auto spectrum in solid black line and the\ncross spectra among the detectors in the same and in different horns in dotted red and dashed blue lines, respectively. In real\ndata, the $1/f^{2}$ part before 0.07 $\\mathrm{Hz}$ was filtered out.}\n\\label{noise}\n\\end{figure}\n\n\n\n\nTo show the effect of the inclusion of the full noise correlation properties in the map making algorithm we generate\neight noise only data streams and we estimated the minimum variance noise-only maps.\nWe expect that including the off diagonal terms in the noise covariance matrix will improve the overall map noise behavior\nwhen compared to the analysis performed considering only the self-correlation terms. \n\n\nIn Fig.~\\ref{QU} we show the differences of the same only-noise map of $Q$ and $U$ between the cases. It can be noticed the\nresidual correlation along the scans: the inclusion of the cross-correlated noise in the map-making code removes partially the\nresidual stripes in the maps due to the noise correlation among detectors.\n\n\\begin{figure}\n\\centering\n\\psfrag{micro}[c][][3]{$\\mu \\mathrm{K}$}\n\\includegraphics[angle=0,width=\\columnwidth]{fig4a}\n\\includegraphics[angle=0,width=\\columnwidth]{fig4b}\n\\caption{Difference of the Stokes parameters Q (top) and U (bottom) between maps evaluated from the same simulated dataset, considering and neglecting cross-correlated noise.\nThe maps are in Celestial coordinates, centered at $\\left(\\mathrm{Ra,Dec} \\right)=\\left( 80\\degree,-45\\degree \\right)$, and $\\sim 30\\times10$ degrees wide (Gnomonic projection). }\n\\label{QU}\n\\end{figure}\n\nThen, we applied the MASTER spectrum estimator to the maps. Assuming the noise to be characterized by the spectrum of\nEqs.~\\ref{11}-\\ref{13} and the cosmological parameters to be the ones estimated by {\\textsc{Planck}}\\\n\\citep{2015arXiv150201589P}, we generated 200 Monte Carlo simulated maps out of of noise-only, signal-only and signal plus noise\nTODs, both neglecting and considering in our algorithm the detectors' cross-correlation, employing the same scanning strategy of\nthe {BOOMERanG}\\ experiment. In particular we fixed the tensor-to-scalar perturbation amplitude ratio to $r=0.09$ and a reionization\nredshift of $z_{\\mathrm{re}}=9.0$\n\nIn Fig.~\\ref{BB_BOOM} we compare the $BB$ power spectra, estimated from the deep region, obtained neglecting and including the\ncross-correlation among the detectors, and we show the fractional difference of the power spectra error bars.\nNote that, as expected, the new algorithm has provided smaller error bars, up to $\\sim20\\%$.\nThe improvement is larger for low multipoles:\nthis is because the cross-correlation is more significant at low frequencies, i.e.\\ at larger angular scales. \n\n\\begin{figure}\n\\centering\n\\psfrag{l(l+1)C_lBB}[c][][3]{$\\ell(\\ell+1) C_{\\ell}^{BB}/(2\\pi) \\hskip 1em [\\mu \\mathrm{K}^{2}]$}\n\\psfrag{Multipolel}[c][][3]{Multipole $\\ell$}\n\\includegraphics[angle=90,width=\\columnwidth]{fig5}\n\\caption{On the top: BB power spectra obtained by simulated data of the {BOOMERanG}\\ experiment. In solid black line the spectrum\nestimated considering cross-correlation; in dashed red line the spectrum estimated neglecting detectors' cross-correlation,\nshifted to the left by $l=10$. On the bottom: the fractional difference of the spectra error bars.}\n\\label{BB_BOOM}\n\\end{figure}\n\nIn conclusion, the {BOOMERanG}\\ experiment has shown to have a not negligible component of cross-correlated noise.\nIn real data analysis, the effect of including cross-correlation is negligible because of a heavy filtering\nof the lower frequencies TODs component. However, in general we expect that the low frequency part cannot,\nor at least not completely, be filtered out, thus a systematic treatment of the detectors'\ncross-correlated noise is necessary. An example is the forthcoming LSPE experiment, that we discuss in next Section.\n\n\n\\section{LSPE}\\label{LSPE}\n\nWe now focus on a setup typical of the next generation of balloon CMB experiment: the LSPE mission.\nDuring its circumpolar Arctic flight, this experiment will observe a large fraction of the northern sky\n(25\\% of the celestial sphere) with angular resolution of about 1.5 degrees FWHM. \n\n\\begin{figure}\n\\centering\n\\includegraphics[angle=90,width=\\columnwidth]{fig6a}\n\\includegraphics[angle=90,width=\\columnwidth]{fig6b}\n\\caption{Sky region which will be scanned by 18 sample detectors, sparsely located in the focal plane of SWIPE-LSPE,\nin ecliptic coordinates (upper panel)\nand the pixel condition number as an estimator of polarization angle coverage per pixel\n(lower panel, see Eq.~\\ref{eq:preconditioner}).\nBoth maps are at HEALPix~\\citep[see][]{2002ApJ...567....2H,2005ApJ...622..759G} $\\mathrm{N_{side}}=128$}\n\\label{LSPEmask}\n\\end{figure}\n\n\\begin{figure}\n\\centering\n\\psfrag{Freq/[Hz]}[c][][3]{Frequency \\hskip 1em [$\\mathrm{Hz}$]}\n\\psfrag{Power/[uK^2/Hz]}[c][][3]{Power \\hskip 1em [$\\mu \\mathrm{K}^{2}/\\mathrm{Hz}$]}\n\\includegraphics[angle=90,width=\\columnwidth]{fig7}\n\\caption{Power vs. frequency for temperature (in dashed black line) and polarization intensity (in solid red line)\nfor the SWIPE scan strategy and HWP steps of $11.25\\degree / \\mathrm{min}$.\nIn our simulations, we focused on two noise knee frequencies: 0.02 and 0.1 $\\mathrm{Hz}$.}\n\\label{IPspectra}\n\\end{figure}\n\nThe payload will host two instruments: an array of bolometric polarimeters, the Short Wavelength Instrument for the Polarization\nExplorer \\citep[SWIPE,][]{2012SPIE.8452E..3FD}, which will map the sky in three frequency bands centered at 140, 220 and 240 \n$\\mathrm{GHz}$, and an array of coherent polarimeters, STRatospheric Italian Polarimeter \\citep[STRIP,][]{2012SPIE.8446E..7CB},\nwhich will survey the same sky region in two frequency bands centered at 43 and 90 $\\mathrm{GHz}$. \n\nThe frequency range chosen for LSPE includes the regions where the ratio between polarized CMB signal and polarized foreground is\nexpected to be optimal. Moreover, the multi-frequency information is necessary to face the problem of the foreground contamination\n\\citep{2012SPIE.8446E..7AA}.\nLSPE will scan the sky by spinning around the local vertical, while keeping the telescope\nelevation constant for long periods, in the range 30 to 55 deg.\nThe azimuth scan speed will be set around 3 rpm, i.e. 18 deg/s.\n\nIn Figs.~\\ref{LSPEmask} we show the sky region that will be scanned by LSPE and its angle coverage estimator\n(see Eq.~\\ref{eq:preconditioner}) for a subset of 9 reflected detectors + 9 transmitted detectors.\nThe maps are pixelized at the HEALPix resolution $\\mathrm{N_{side}}=128$ \n\\citep[$27.5^\\prime$ per pixel, see][]{2002ApJ...567....2H,2005ApJ...622..759G} ) and the subsequent analysis has been performed under the assumption that the number of observation per pixel is greater than $10^3$ and $\\mathrm{R_{cond}} \\geq 10^{-2}$. \n\nThe whole data analysis strategy shown in the previous section for {BOOMERanG}\\ can be applied to the LSPE experiment. \n\nDue to the large  detectors number (110 per frequency channel for SWIPE), the effect of the cross-correlation could be relevant.\nThis means that the extended ROMA algorithm may represent a critical tool for solving this issue. In particular, a significant\nreduction of the error bars in the experimental BB power spectrum may provide an important help in constraining the\npolarization B-mode signal.\n\nIn order to evaluate the effect of including cross-correlation, we applied the extended ROMA code to simulated data based on\nthe scanning strategy, Half Wave Plate stepping (11.25 degrees every minute), and polarimeter angle of SWIPE,\nfor one day of observations\n($N_d = 8.64 \\times 10^6$ samples per detector). We limited our analysis to 18 detectors, arranged in three triples\nin each of the two focal planes of the instrument.\n\nIn Fig.~\\ref{IPspectra} we show the temperature and polarization intensity power as a function of frequency\nfor one bolometer of the SWIPE instrument. \n\nAs for the {BOOMERanG}\\ simulations, we assumed the cosmological parameters estimated by {\\textsc{Planck}}\\ \\citep{2015arXiv150201589P} with the\nsame tensor-to-scalar ratio $r$ and reionization redshift $z_\\mathrm{re}$;\nthe noise was simulated assuming the bolometer to be  photon-noise limited, with a white  plateau of \n$ 15 \\mu \\mathrm{K_{CMB}} \\sqrt{\\mathrm{s}}$, as expected for the multimoded $140\\mathrm{GHz}$ channel.\nMoreover we focus on two $1/f^2$ knee frequencies, 0.02 and $0.1 \\mathrm{Hz}$, the expected best and worst case.\nFinally, for each knee frequency, we consider two different common mode white noise contributions:\n\\begin{enumerate}\n  \\item the cross-correlation is present in both the $1/f^{2}$ and white noise part of the spectrum. \n  In the former, the cross-correlated component is shared by all the detectors;\n  in the latter we assume 10\\% of cross-correlation among each triple and 1\\% among any other detector,\n  with respect to the auto noise spectrum\n  (this situation is the analogue of the one shown in Fig.~\\ref{noise} for {BOOMERanG}\\ simulations);\\label{itm:uno}\n\\item the cross-correlation is limited to the $1/f^{2}$ part of the noise spectrum, with no white noise common mode.\\label{itm:due}\n\\end{enumerate}\n\n\\begin{figure}\n\\centering\n\\psfrag{l(l+1)C_lBB}[c][][3]{$\\ell(\\ell+1) C_{\\ell}^{BB}/(2\\pi) \\hskip 1em [\\mu \\mathrm{K}^{2}]$}\n\\psfrag{Multipolel}[c][][3]{Multipole $\\ell$}\n\\includegraphics[angle=90,width=\\columnwidth]{fig8}\n\\caption{\nFractional difference of the BB power spectra error bars from LSPE simulated data estimated considering and neglecting\nthe bolometers' noise cross-correlation of case~\\ref{itm:uno}. A knee frequency $f_{k}=0.02\\mathrm{Hz}$ is considered.\n}\n\\label{LSPE1_0.02}\n\\end{figure}\n\n\\begin{figure}\n\\centering\n\\psfrag{l(l+1)C_lBB}[c][][3]{$\\ell(\\ell+1) C_{\\ell}^{BB}/(2\\pi) \\hskip 1em [\\mu \\mathrm{K}^{2}]$}\n\\psfrag{Multipolel}[c][][3]{Multipole $\\ell$}\n\\includegraphics[angle=90,width=\\columnwidth]{fig9}\n\\caption{\nFractional difference of the BB power spectra error bars from LSPE simulated data estimated considering and neglecting\nthe bolometers' noise cross-correlation of case~\\ref{itm:uno}. A knee frequency $f_{k}=0.1\\mathrm{Hz}$ is considered.\n}\n\\label{LSPE1_0.1}\n\\end{figure}\n\n\\begin{figure}\n\\centering\n\\psfrag{l(l+1)C_lBB}[c][][3]{$\\ell(\\ell+1) C_{\\ell}^{BB}/(2\\pi) \\hskip 1em [\\mu \\mathrm{K}^{2}]$}\n\\psfrag{Multipolel}[c][][3]{Multipole $\\ell$}\n\\includegraphics[angle=90,width=\\columnwidth]{fig10}\n\\caption{\nFractional difference of the BB power spectra error bars from LSPE simulated data estimated considering and neglecting the bolometers' noise cross-correlation of case~\\ref{itm:due}. A knee frequency $f_{k}=0.02\\mathrm{Hz}$ is considered.\n}\n\\label{LSPE2_0.02}\n\\end{figure}\n\n\\begin{figure}\n\\centering\n\\psfrag{l(l+1)C_lBB}[c][][3]{$\\ell(\\ell+1) C_{\\ell}^{BB}/(2\\pi) \\hskip 1em [\\mu \\mathrm{K}^{2}]$}\n\\psfrag{Multipolel}[c][][3]{Multipole $\\ell$}\n\\includegraphics[angle=90,width=\\columnwidth]{fig11}\n\\caption{\nFractional difference of the BB power spectra error bars from LSPE simulated data estimated considering and neglecting the bolometers' noise cross-correlation of case~\\ref{itm:due}. A knee frequency $f_{k}=0.1\\mathrm{Hz}$ is considered.\n}\n\\label{LSPE2_0.1}\n\\end{figure}\n\nIn the four cases, we produced 50 signal-only, noise-only, and signal plus noise Monte Carlo simulated maps,\nboth taking into account or not the noise cross correlation among detectors.\nThen, we applied the MASTER power spectrum estimator to the maps.\nIt should be taken into account that, at large angular scales, the MASTER spectrum estimator method may not be the most convenient\nchoice. As mentioned by \\citet{2014MNRAS.440..957M}, at low multipoles a quadratic maximum likelihood estimator (QML)\nis preferable \\citep[see][]{1997PhRvD..55.5895T,2001PhRvD..64f3001T}. Nonetheless, the aim of this work is to check reliability\nof an improved map-making code, which can be successfully tested also by using quicker but less accurate angular power spectra\nestimates.\n\nIn Fig.~\\ref{LSPE1_0.02} we show the fractional difference of the BB spectra error bars from angular power spectra estimated\nconsidering and neglecting detectors' noise cross-correlation. The dataset contaminated by noise described according to\ncase~\\ref{itm:uno} and for $f_{k}=0.02\\mathrm{Hz}$. The results for $f_{k}=0.1\\mathrm{Hz}$ are shown in Fig.~\\ref{LSPE1_0.1}.\n\nFor case~\\ref{itm:due}, we got similar results as shown in Fig.~\\ref{LSPE2_0.02} for $f_{k}=0.02\\mathrm{Hz}$ and in\nFig.~\\ref{LSPE2_0.1} for $f_{k}=0.1Hz$. \n\nIt is evident that neglecting cross-correlation affects heavily the power spectra error bars.\nFor a knee frequency $f_{k}=0.02\\mathrm{Hz}$ the inclusion of cross-correlation has the effect of reducing\nthe spectra error bars up to $35-45\\%$. For $f_{k}=0.1\\mathrm{Hz}$ we find an improvement up to $60-65\\%$. \n\nTo reduce the low frequency noise contribution to the large angular scales, it may be also useful to high pass the data stream\nto filter out power at frequencies lower than the measured $f_{k}$. While this option appears to be feasible when the measured\n$f_{k}$ is of the order of $0.02 \\mathrm{Hz}$ since the cosmological signal at lower frequencies is negligible, we found that\n(see Fig.~\\ref{IPspectra}) if $f_{k}$ is of the order of $0.1\\mathrm{Hz}$ any high-pass filter will cut the polarization\nintensity power of $\\simeq 25\\%$ and $I$ Stokes power of $\\simeq 48\\%$, filtering out those signal frequencies that\notherwise would be mapped on the cosmological angular scales of interest ($\\ell \\lesssim 20$, see figs~\\ref{LSPE1_0.02}-\\ref{LSPE2_0.1})\n\nAs a last consideration, we discuss about the cosmic variance problem and its relative contribution to the spectra error bars.\n\nReducing the map noise variance at low-$\\ell$ will help to improve the cosmic variance estimate at these angular scales:\nwe stress that a measure\nsignificantly more sensitive than the cosmic variance limit is important for a correct characterization of foreground signals\nneeded by component separation techniques to disentangle the primordial polarization signal from any unwanted contamination.\n\nTo quantify the cosmic variance contribution to the error bars, we compared the BB spectra estimated taking into account\nthe common mode of case~\\ref{itm:due} and neglecting cross-correlation (with $f_k=0.1\\mathrm{Hz}$), where we consider\n\\emph{only} the instrumental noise contribution, and we evaluated the corresponding fractional difference of the error bars.\nAs expected, in this case the improvement is larger (up to 80\\% for low multipoles):\nthe cosmic variance adds the same contribution to the error bars of both spectra, decreasing thus their relative difference.\n\nFrom the above simulations with the full noise covariance information, we estimated that the instrumental noise contribution\nis 54\\%, 84\\%, 90\\% and 91\\% to the first four error bars (corresponding to the angular scales of interest), respectively.\nAfter $\\ell \\simeq 15$ , the cosmic variance effect is therefore negligible.\n\nFinally, considering cross-correlation in the map-making process could be critical from the computing time point of view.\nTo quantify that, we report the results of computational time as a function of cross-correlated detectors number.\nWe simulated the analysis employing a growing number of detectors up to 18.\nWe considered for each simulation 100 iterations and 8 processors. In Fig.~\\ref{scaling} we show the obtained behavior.\nAs expected, the time to converge raises quadratically.\n\n\n\\begin{figure}\n\\centering\n\\psfrag{N. Detectors}[c][][3]{Number of detectors}\n\\psfrag{time/[s] (100iters, 8procs)}[c][][3]{Time \\hskip 1em [s]}\n\\includegraphics[angle=90,width=\\columnwidth]{fig12}\n\\caption{Scaling of computational time with the number of detectors, assuming 100 iterations and 8 processors.}\n\\label{scaling}\n\\end{figure}\n\n\n\\section{Conclusions}\\label{Conclusions}\n\nCorrelated low frequency noise, due to focal plane temperature fluctuations of atmospheric effect,\namong CMB polarization detectors may reduce, if not properly taken into account,\nthe effective sensitivity of any experiment aimed at detection of large and intermediate angular scale polarization B-Modes,\neither in satellite, balloon-borne \\citep{2012SPIE.8446E..7AA} and ground-based experiments\n\\citep{2012SPIE.8452E..20E, 2014AAS...22340702E}, degrading the signal-to-noise ratio at the lower angular multipoles.\n\nWe presented an extension of the ROMA map-making code which takes into account a possible noise cross-correlation among\ndetectors of a CMB experiment.\nAs case studies, we used real and simulated observational data of the {BOOMERanG}~(2003) mission.\nFor the simulations, considering the cross-correlation has provided power spectra error bars\nsmaller up to $20\\%$ for low multipoles.\nWe focused on the future LSPE balloon-borne experiment, devoted to the observation of CMB polarization at large angular scales.\nWe applied the extended algorithm to simulated data of LSPE/SWIPE and found that the inclusion of cross-correlation\nprovides error bars smaller up to $40-60\\%$, depending on the chosen knee frequency. We point out that this improvement\ncould be crucial in constraining the polarization $B$-modes, whose detection is needed to confirm the existence of a\nstochastic GW background and to characterize the reionization process. We highlight that the data reduction is a very time\nconsuming process. We found that considering the cross-correlation increases the time to convergence,\nwhich raises quadratically with the number of detectors.\n\n\n\n\\begin{acknowledgements} \n    We acknowledge the use of the HEALPix  package \\citep{1999elss.conf...37G,2005ApJ...622..759G}\n    and of the FFTW library \\citep{FFTW05}. We thank Marina Migliaccio for useful suggestions and discussions.\n\\end{acknowledgements}\n\n\\bibliographystyle{aa} \n\n\\bibliography{roma} \n\n\n", "itemtype": "equation", "pos": 19880, "prevtext": "\n\n", "index": 29, "text": "\\begin{equation}\nP_{ir}(f)\\propto w_{ir}+\\left(\\frac{f_{k}}{f}\\right)^{\\alpha},\\label{13}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E15.m1\" class=\"ltx_Math\" alttext=\"P_{ir}(f)\\propto w_{ir}+\\left(\\frac{f_{k}}{f}\\right)^{\\alpha},\" display=\"block\"><mrow><mrow><mrow><msub><mi>P</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>r</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u221d</mo><mrow><msub><mi>w</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>r</mi></mrow></msub><mo>+</mo><msup><mrow><mo>(</mo><mfrac><msub><mi>f</mi><mi>k</mi></msub><mi>f</mi></mfrac><mo>)</mo></mrow><mi>\u03b1</mi></msup></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}]