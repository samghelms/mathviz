[{"file": "1601.01958.tex", "nexttext": "\n\\end{lemma} \n\nFurthermore, it can be observed that for any graph $G$, $tb(G)  \\leq tl(G) \\leq 2 \\cdot tb(G)$ and similarly $pb(G) \\leq pl(G) \\leq 2 \\cdot pb(G)$.\nMoreover, if a graph $G$ admits a $k$-good tree decomposition, then $tb(G) \\leq \\lfloor k/2 \\rfloor + 1$ and $tl(G) \\leq k + 1$.\nBefore we end this section, let us prove the stronger equivalence, $tb(G) = 1$ if and only if $G$ admits a $1$-good tree decomposition. \nThis result will be of importance in the following.\nSince a tree decomposition is $1$-good if and only if each bag contains a spanning star, we will name the $1$-good tree decompositions \\emph{star-decompositions} in the following. \n\n\\begin{definition}\\label{def:star-tree-dec}\nLet $G=(V,E)$ be a connected graph, a {\\it star-decomposition} is a tree decomposition $(T,{\\cal X})$ of $G$ whose each bag induces a subgraph of dominating number one, i.e., for any $t \\in V(T)$, $\\gamma(G[X_t])=1$.\n\\end{definition}\n\nClearly, if a graph admits a star-decomposition, then it has tree-breadth at most one.\nLet us prove that the converse also holds.\n\n\\begin{lemma}\\label{lem:dominator-in-bag}\nFor any graph $G$ with $tb(G) \\leq 1$, every \\emph{reduced} tree decomposition of $G$ of breadth one is a star-decomposition.\nIn particular:\n\\begin{itemize}\n\t\\item any tree decomposition of $G$ of breadth one can be transformed into a star-decomposition in polynomial-time;\n\t\\item similarly, any path decomposition of $G$ of breadth one can be transformed into a $1$-good path decomposition in polynomial-time.\n\\end{itemize}\n\\end{lemma}\n\\begin{proof}\nLet $(T,{\\cal X})$ be any reduced tree decomposition of $G$ of breadth one.\nWe will prove it is a star-decomposition.\nTo prove it, let $X_t \\in {\\cal X}$ be arbitrary and let $v \\in V$ be such that $\\max_{w\\in X_t} dist_G(v,w) = 1$, which exists because $X_t$ has radius one.\nWe now show that $v \\in X_t$.\nIndeed, since the subtree $T_v$ and the subtrees $T_w, w \\in X_t$, pairwise intersect, then it comes by the Helly Property (Lemma~\\ref{lem:helly}) that $T_v \\cap \\left(\\bigcap_{w \\in X_t} T_w\\right) \\neq \\emptyset$ {\\it i.e.}, there is some bag containing $\\{v\\} \\cup X_t$.\nAs a result, we have that $v \\in X_t$ because $(T,{\\cal X})$  is a reduced tree decomposition, hence $\\gamma(G[X_t]) = 1$.\nThe latter implies that $(T,{\\cal X})$ is a star-decomposition because $X_t$ is arbitrary. \n\nNow let $(T,{\\cal X})$ be any tree decomposition of $G$ of breadth one.\nIt can be transformed in polynomial-time into a reduced tree decomposition $(T',{\\cal X}')$ so that ${\\cal X}' \\subseteq {\\cal X}$.\nFurthermore, $(T',{\\cal X}')$ has breadth one because it is the case for $(T,{\\cal X})$, therefore $(T',{\\cal X}')$ is a star-decomposition.\nIn particular, if $(T,{\\cal X})$ is a path decomposition then so is $(T',{\\cal X}')$.\n\\end{proof}\n\n\\begin{corollary}\\label{cor:equiv-tb-star}\nFor any graph $G$, $tb(G) \\leq 1$ if and only if $G$ admits a star-decomposition.\n\\end{corollary}\n\n\\section{Intractability results}\n\\label{sec:np-hard}\n\n\\subsection{Path-length and path-breadth}\n\\label{sec:plpb}\n\nThis section is devoted to the complexity of all path-like invariants that we consider in this paper.\n\n\\begin{theorem}\\label{thm:pl-npc}\nDeciding whether a graph has path-length at most $k$ is NP-complete even if $k=2$.\n\\end{theorem}\n\nIn contrast to Theorem~\\ref{thm:pl-npc}, graphs with path-length one are exactly the interval graphs~\\cite{Dragan2014b}, {\\it i.e.}, they can be recognized in linear-time.\n\n\\begin{theorem}\\label{thm:pb-npc}\nDeciding whether a graph has path-breadth at most $k$ is NP-complete even if $k=1$.\n\\end{theorem}\n\nFrom the complexity result of Theorem~\\ref{thm:pb-npc}, we will also prove the hardness of deciding on the existence of $k$-good path decompositions.  \n\n\\begin{theorem}\\label{thm:k-good-path-npc}\nDeciding whether a graph admits a $k$-good path decomposition is NP-complete even if $k=1$.\n\\end{theorem}\n\n\\begin{proof}\nThe problem is in NP.\n\nBy Lemma~\\ref{lem:dominator-in-bag}, a graph $G$ admits a $1$-good path decomposition if and only if $pb(G) \\leq 1$, therefore it is NP-hard to decide whether a graph admits a $1$-good path decomposition by Theorem~\\ref{thm:pb-npc}.\n\\end{proof}\n\nAll of the NP-hardness proofs in this section will rely upon the same reduction from the Betweenness problem, defined below.\nThe Betweenness problem, sometimes called the Total Ordering problem, is NP-complete~\\cite{Opatrny1979}.\nIn~\\cite{Golumbic1994}, it was used to show that the Interval Sandwich problem is NP-complete.\nWhat we here prove is that the Interval Sandwich problem remains NP-complete even if the second graph is a \\emph{power} of the first one, where the $k^{\\text{th}}$ power $G^k$ of any graph $G$ is obtained from $G$ by adding an edge between every two distinct vertices that are at distance at most $k$ in $G$ for every integer $k \\geq 1$.\nIndeed, a graph $G$ has path-length at most $k$ if and only if there is an Interval Sandwich between $G$ and $G^k$ (we refer to~\\cite{Lokshtanov2010} for the proof of a similar equivalence between tree-length and the Chordal Sandwich problem).\n\n\n\\begin{center}\n    \\fbox{\\begin{minipage}{.95\\linewidth}\\label{prob:betweenness}\n        \\begin{problem}[Betweenness]\\ \n          \\begin{description}\n          \\item[Input:] a set ${\\cal S}$ of $n$ elements, a set ${\\cal T}$ of $m$ ordered triples of elements in ${\\cal S}$.\n          \\item[Question:] Is there a total ordering of ${\\cal S}$ such that for every triple $t =(s_i,s_j,s_k) \\in {\\cal T}$, \\\\either $s_i < s_j < s_k$ or $s_k < s_j < s_i$ ? \n          \\end{description}\n        \\end{problem}     \n      \\end{minipage}}\n  \\end{center}\n\nNow, given an instance $({\\cal S},{\\cal T})$ of the Betweenness problem, we will construct from ${\\cal S}$ and ${\\cal T}$ a graph $G_{{\\cal S},{\\cal T}}$ as defined below.\nWe will then prove that $pl(G_{{\\cal S},{\\cal T}}) \\leq 2$ (resp. $pb(G_{{\\cal S},{\\cal T}}) \\leq 1$) if and only if $({\\cal S},{\\cal T})$ is a yes-instance of the Betweenness problem.\n\n\\begin{definition}\\label{def:plpb-reduction}\nLet ${\\cal S}$ be a set of $n$ elements, let ${\\cal T}$ be a set of $m$ ordered triples of elements in ${\\cal S}$.\nThe graph $G_{{\\cal S},{\\cal T}}$ is constructed as follows:\n\\begin{itemize}\n\\item For every element $s_i \\in {\\cal S}$, $1 \\leq i \\leq n$, there are two adjacent vertices $u_i,v_i$ in $G_{{\\cal S},{\\cal T}}$.\nThe vertices $u_i$ are pairwise adjacent {\\it i.e.}, the set $U = \\{ u_i \\mid 1 \\leq i \\leq n \\}$ is a clique.\n\\item For every triple $t =(s_i,s_j,s_k) \\in {\\cal T}$, let us add in $G_{{\\cal S},{\\cal T}}$ the $v_iv_j$-path $(v_i,a_t,b_t,v_j)$ of length $3$, and the $v_{j}v_{k}$-path $(v_j,c_t,d_t,v_k)$ of length $3$.\n\\item Finally, for every triple $t =(s_i,s_j,s_k) \\in {\\cal T}$ let us make adjacent $a_t,b_t$ with every $u_l$ such that $l \\neq k$, similarly let us make adjacent $c_t,b_t$ with every $u_l$ such that $l \\neq i$. \n\\end{itemize}\n\\end{definition}\n\nIt can be noticed from Definition~\\ref{def:plpb-reduction} that for any $1 \\leq i \\leq n$, the vertex $u_i$ is adjacent to any vertex but those $v_j$ such that $j \\neq i$, those $a_t,b_t$ such that $s_i$ is the last element of triple $t$ and those $c_t,b_t$ such that $s_i$ is the first element of triple $t$. \nWe refer to Figure~\\ref{fig:plpb} for an illustration (see also Figure~\\ref{fig:adj}).\nObserve that $G_{{\\cal S},{\\cal T}}$ has diameter $3$ because the clique $U$ dominates $G_{{\\cal S},{\\cal T}}$, therefore $pl(G_{{\\cal S},{\\cal T}}) \\leq 3$ and we will show that it is hard to distinguish graphs with path-length two from graphs with path-length three.\nSimilarly, the clique $U$ dominates $G_{{\\cal S},{\\cal T}}$ hence $pb(G_{{\\cal S},{\\cal T}}) \\leq 2$, thus we will show that it is hard to distinguish graphs with path-breadth one from graphs with path-breadth two. \n\n\\begin{figure}[h]\n\\begin{minipage}[h]{.46\\linewidth}\n  \\centering\n  \\includegraphics[width=.75\\textwidth]{Fig/reduction-plpb}\n  \\caption{The graph $G_{{\\cal S},{\\cal T}}$ for ${\\cal S}=[|1,5|]$ and ${\\cal T}=\\{ (i,i+1,i+2) \\mid 1 \\leq i \\leq 4\\}$. Each colour corresponds to a given triple of ${\\cal T}$. For ease of reading, the adjacency relations between the vertices $u_i$ and the colored vertices $a_t,b_t,c_t,d_t$ are not drawn. \n\n\n\n\n\n}\n  \\label{fig:plpb}\n\\end{minipage} \\hfill\n\\begin{minipage}[c]{.46\\linewidth}\n      \\centering\n      \\includegraphics[width=0.55\\textwidth]{Fig/reduction-plpb-adj}\n      \\caption{Adjacency relations in $G_{{\\cal S},{\\cal T}}$ for one given triple $t=(s_i,s_j,s_k)$.}\n      \\label{fig:adj}\n\\end{minipage}\n\\end{figure}\n\n\\begin{lemma}\n\\label{lem:betweenness-implies}\nLet ${\\cal S}$ be a set of $n$ elements, let ${\\cal T}$ be a set of $m$ ordered triples of elements in ${\\cal S}$.\nIf $({\\cal S},{\\cal T})$ is a yes-instance of the Betweenness problem then $pb(G_{{\\cal S},{\\cal T}}) \\leq 1$ and $pl(G_{{\\cal S},{\\cal T}}) \\leq 2$, where $G_{{\\cal S},{\\cal T}}$ is the graph that is defined in Definition~\\ref{def:plpb-reduction}.\n\\end{lemma}\n\\begin{proof}\nSince $pl(G_{{\\cal S},{\\cal T}}) \\leq 2 \\cdot pb(G_{{\\cal S},{\\cal T}})$ then we only need to prove that $pb(G_{{\\cal S},{\\cal T}}) \\leq 1$.\nFor convenience, let us reorder the elements of ${\\cal S}$ so that for every triple $(s_i,s_j,s_k) \\in {\\cal T}$ either $i < j < k$ or $k < j < i$.\nIt is possible to do that because by the hypothesis $({\\cal S},{\\cal T})$ is a yes-instance of the Betweenness problem.\nIf furthermore $k < j < i$, let us also replace $(s_i,s_j,s_k)$ with the inverse triple $(s_k,s_j,s_i)$.\nThis way, we have a total ordering of ${\\cal S}$ such that $s_i < s_j < s_k$ for every triple $(s_i,s_j,s_k) \\in {\\cal T}$.\nThen, let us construct a path decomposition $(P,{\\cal X})$ with $n$ bags, denoted $X_1,X_2, \\ldots, X_n$, as follows. \nFor every $1 \\leq i \\leq n$, $U \\subseteq X_i$ and $v_i \\in X_i$.\nFor every $t = (s_i,s_j,s_k) \\in {\\cal T}$, we add both $a_t,b_t$ into the bags $X_l$ with $i \\leq l \\leq j$, similarly we add both $c_t,d_t$ into the bags $X_l$ with $j \\leq l \\leq k$.\nBy construction, the clique $U$ is contained in any bag of $P$ and for every triple $t=(s_i,s_j,s_k) \\in {\\cal T}$ we have $a_t,b_t,v_i \\in X_i$ and $a_t,b_t,c_t,d_t,v_j \\in X_j$ and $c_t,d_t,v_k \\in X_k$, therefore $(P,{\\cal X})$ is indeed a path decomposition of $G_{{\\cal S},{\\cal T}}$.\n\nWe claim that for every $i$, $X_i \\subseteq N[u_i]$, that will prove the lemma.\nIndeed if it were not the case for some $i$ then by Definition~\\ref{def:plpb-reduction} there should exist $t \\in {\\cal T},j,k$ such that: either $t = (s_i,s_j,s_k) \\in {\\cal T}$ and $c_t,d_t \\in X_i$; or $t = (s_k,s_j,s_i) \\in {\\cal T}$ and $a_t,b_t \\in X_i$.\nBut then by construction either $a_t,b_t$ are only contained in the bags $X_l$ for $k \\leq l \\leq j$, or $c_t,d_t$ are only contained in the bags $X_l$ for $j \\leq l \\leq k$, thus contradicting the fact that either $a_t,b_t \\in X_i$ or $c_t,d_t \\in X_i$.\n\\end{proof}\n\n\\begin{lemma}\n\\label{lem:betweenness-implied}\nLet ${\\cal S}$ be a set of $n$ elements, let ${\\cal T}$ be a set of $m$ ordered triples of elements in ${\\cal S}$.\nIf $pb(G_{{\\cal S},{\\cal T}}) \\leq 1$ or $pl(G_{{\\cal S},{\\cal T}}) \\leq 2$ then $({\\cal S},{\\cal T})$ is a yes-instance of the Betweenness problem, where $G_{{\\cal S},{\\cal T}}$ is the graph that is defined in Definition~\\ref{def:plpb-reduction}.\n\\end{lemma}\n\\begin{proof}\nSince $pl(G_{{\\cal S},{\\cal T}}) \\leq 2 \\cdot pb(G_{{\\cal S},{\\cal T}})$ then we only need to consider the case when $pl(G_{{\\cal S},{\\cal T}}) \\leq 2$.\nLet $(P,{\\cal X})$ be a path decomposition of length two, that exists by the hypothesis.\nSince the vertices $v_i$ are pairwise at distance $3$ then the subpaths $P_{v_{i}}$ that are induced by the bags containing vertex $v_i$ are pairwise disjoint.\nTherefore, starting from an arbitrary endpoint of $P$ and considering each vertex $v_i$ in the order that it appears in the path decomposition, this defines a total ordering over ${\\cal S}$.\nLet us reorder the set ${\\cal S}$ so that vertex $v_i$ is the $i^{\\text{th}}$ vertex to appear in the path-decomposition.\nWe claim that for every triple $t = (s_i,s_j,s_k) \\in {\\cal T}$, either $i < j < k$ or $k < j < i$, that will prove the lemma.\n\nBy way of contradiction, let $t = (s_i,s_j,s_k) \\in {\\cal T}$  such that either $j < \\min \\{i,k\\}$ or $j > \\max \\{i,k\\}$.\nBy symmetry, we only need to consider the case when $j < i < k$.\nIn such case by construction the path between $P_{v_j}$ and $P_{v_k}$ in $P$ contains $P_{v_i}$.\nLet $B \\in P_{v_i}$, by the properties of a tree decomposition it is a $v_jv_k$-separator, so it must contain one of $c_t,d_t$.\nHowever, vertex $v_i \\in B$ is at distance $3$ from both vertices $c_t,d_t$, thus contradicting the fact that $(P,{\\cal X})$ has length $2$.\n\\end{proof}\n\nWe are now able to prove Theorems~\\ref{thm:pl-npc} and~\\ref{thm:pb-npc}.\n\n\\begin{proofof}{Theorem~\\ref{thm:pl-npc}}\nTo prove that a graph $G$ satisfies $pl(G) \\leq k$, it suffices to give as a certificate a tree decomposition of $G$ with length at most $k$.\nIndeed, the all-pairs-shortest-paths in $G$ can be computed in polynomial-time.\nTherefore, the problem of deciding whether a graph has path-length at most $k$ is in NP.\nGiven an instance $({\\cal S},{\\cal T})$ of the Betweenness problem, let $G_{{\\cal S},{\\cal T}}$ be as defined in Definition~\\ref{def:plpb-reduction}.\nWe claim that $pl(G_{{\\cal S},{\\cal T}}) \\leq 2$ if and only if the pair $({\\cal S},{\\cal T})$ is a yes-instance of the Betweenness problem.\nThis will prove the NP-hardness because our reduction is polynomial and the Betweenness problem is NP-complete.\nTo prove the claim in one direction, if $({\\cal S},{\\cal T})$ is a yes-instance then by Lemma~\\ref{lem:betweenness-implies} $pl(G_{{\\cal S},{\\cal T}}) \\leq 2 $.\nConversely, if $pl(G_{{\\cal S},{\\cal T}}) \\leq 2$ then $({\\cal S},{\\cal T})$ is a yes-instance by Lemma~\\ref{lem:betweenness-implied}, that proves the claim in the other direction.\n\\end{proofof}\n\n\\begin{proofof}{Theorem~\\ref{thm:pb-npc}}\nTo prove that a graph $G$ satisfies $pb(G) \\leq k$, it suffices to give as a certificate a tree decomposition of $G$ with breadth at most $k$.\nIndeed, the all-pairs-shortest-paths in $G$ can be computed in polynomial-time.\nTherefore, the problem of deciding whether a graph has path-breadth at most $k$ is in NP.\nGiven an instance $({\\cal S},{\\cal T})$ of the Betweenness problem, let $G_{{\\cal S},{\\cal T}}$ be as defined in Definition~\\ref{def:plpb-reduction}.\nWe claim that $pb(G_{{\\cal S},{\\cal T}}) \\leq 1$ if and only if the pair $({\\cal S},{\\cal T})$ is a yes-instance of the Betweenness problem.\nThis will prove the NP-hardness because our reduction is polynomial and the Betweenness problem is NP-complete.\nTo prove the claim in one direction, if $({\\cal S},{\\cal T})$ is a yes-instance then by Lemma~\\ref{lem:betweenness-implies} $pb(G_{{\\cal S},{\\cal T}}) \\leq 1$.\nConversely, if $pb(G_{{\\cal S},{\\cal T}}) \\leq 1$ then $({\\cal S},{\\cal T})$ is a yes-instance by Lemma~\\ref{lem:betweenness-implied}, that proves the claim in the other direction.\n\\end{proofof}\n\nTo conclude this section, we strenghten the above hardness results with two inapproximability results.\nIndeed, it has to be noticed that for any graph parameter $param$, an $\\alpha$-approximation algorithm for $param$ with $\\alpha < 1 + \\frac 1 k$ is enough to separate the graphs $G$ such that $param(G) \\leq k$ from those such that $param(G) \\geq k+1$.\nTherefore, the two following corollaries follow from our polynomial-time reduction.\n\n\\begin{corollary}\n\\label{cor:tl-inapprox}\nFor every $\\varepsilon > 0$, the path-length of a graph cannot be approximated within a factor $\\frac 3 2 - \\varepsilon$ unless P=NP.\n\\end{corollary}\n\n\\begin{proof}\nLet $G_{{\\cal S},{\\cal T}}$ be the graph of the reduction in Theorem~\\ref{thm:pl-npc}.\nBy Definition~\\ref{def:plpb-reduction}, it has diameter at most $3$ and so $pl(G_{{\\cal S},{\\cal T}}) \\leq 3$.\nSince it is NP-hard to decide whether $pl(G_{{\\cal S},{\\cal T}}) \\leq 2$, therefore it does not exist a  $\\left(\\frac 3 2 - \\varepsilon\\right)$-approximation algorithm for path-length unless P=NP.\n\\end{proof}\n\n\\begin{corollary}\n\\label{cor:tb-inapprox}\nFor every $\\varepsilon > 0$, the path-breadth of a graph cannot be approximated within a factor $2 - \\varepsilon$ unless P=NP.\n\\end{corollary}\n\n\\begin{proof}\nLet $G_{{\\cal S},{\\cal T}}$ be the graph of the reduction in Theorem~\\ref{thm:pb-npc}.\nBy Definition~\\ref{def:plpb-reduction}, the set $U$ is a dominating clique and so $pb(G_{{\\cal S},{\\cal T}}) \\leq 2$.\nSince it is NP-hard to decide whether $pb(G_{{\\cal S},{\\cal T}}) \\leq 1$, therefore it does not exist a  $\\left(2 - \\varepsilon\\right)$-approximation algorithm for path-breadth unless P=NP.\n\\end{proof}\n\nSo far, there exists a $2$-approximation algorithm for path-length and a $3$-approximation algorithm for path-breadth~\\cite{Dragan2014b}.\nTherefore, we let open whether there exist $\\frac 3 2$-approximation algorithms for path-length and $2$-approximation algorithms for path-breadth. \n\n\\subsection{Tree-breadth}\n\\label{sec:tb-npc}\n\nWe prove next that computing the tree-breadth is NP-hard.\n\n\\begin{theorem}\\label{thm:tb-npc}\n\tDeciding whether a graph has tree-breadth at most $k$ is NP-complete even if $k=1$.\n\\end{theorem}\n\n\\begin{theorem}\\label{thm:k-good-tree-npc}\n\tDeciding whether a graph admits a $k$-good tree decomposition is NP-complete even if $k=1$.\n\\end{theorem}\n\n\\begin{proof}\n\tThe problem is in NP.\n\t\n\tBy Corollary~\\ref{cor:equiv-tb-star}, a graph $G$ admits a star-decomposition if and only if $tb(G) \\leq 1$, therefore it is NP-hard to decide whether a graph admits a $1$-good path decomposition by Theorem~\\ref{thm:tb-npc}.\n\\end{proof}\n\nIn order to prove Theorem~\\ref{thm:tb-npc}, we will reduce from the Chordal Sandwich problem (defined below).\nIn~\\cite{Lokshtanov2010}, the author also proposed a reduction from the Chordal Sandwich problem in order to prove that computing tree-length is NP-hard.\nHowever, we will need different gadgets than in~\\cite{Lokshtanov2010}, and we will need different arguments to prove correctness of the reduction.\n\n\\begin{center}\n\t\\fbox{\\begin{minipage}{.95\\linewidth}\\label{prob:chordal-sandwich}\n\t\t\t\\begin{problem}[Chordal Sandwich]\\ \n\t\t\t\t\\begin{description}\n\t\t\t\t\t\\item[Input:] graphs $G_1=(V,E_1)$ and $G_2=(V,E_2)$ such that $E_1 \\subseteq E_2$.\n\t\t\t\t\t\\item[Question:] Is there a chordal graph $H=(V,E)$ such that $E_1 \\subseteq E \\subseteq E_2$ ?\n\t\t\t\t\\end{description}\n\t\t\t\\end{problem}     \n\t\t\\end{minipage}}\n\t\\end{center}\n\t\nThe Chordal Sandwich problem is NP-complete even when the $2n = |V|$ vertices induce a perfect matching in $\\bar{G_2}$ (the complementary of $G_2$)~\\cite{Bodlaender1992,Golumbic1995}.\nPerhaps surprisingly, the later constriction on the structure of $\\bar{G_2}$ is a key element in our reduction.\nIndeed, we will need the following technical lemma.\n\n\\begin{lemma}\n\\label{lem:chordal-sandwich}\nLet $G_1 =(V,E_1)$, $G_2=(V,E_2)$ such that $E_1 \\subseteq E_2$ and $\\bar{G_2}$ (the complementary of $G_2$) is a perfect matching.\nSuppose that $\\langle G_1, G_2 \\rangle$ is a yes-instance of the Chordal Sandwich problem.\n\nThen, there exists a reduced tree decomposition $(T,{\\cal X})$ of $G_1$ such that for every forbidden edge $\\{u,v\\} \\notin E_2$: $T_u \\cap T_v = \\emptyset$, $T_u \\cup T_v = T$, furthermore there are two adjacent bags $B_u \\in T_u$ and $B_v \\in T_v$ such that $B_u \\setminus u = B_v \\setminus v$.\n\\end{lemma}\n\n\\begin{proof}\nLet $H=(V,E)$ be any chordal graph such that $E_1 \\subseteq E \\subseteq E_2$ (that exists because $\\langle G_1, G_2 \\rangle$ is a yes-instance of the Chordal Sandwich problem by the hypothesis) and the number $|E|$ of edges is maximized.\nWe will prove that any clique-tree $(T,{\\cal X})$ of $H$ satisfies the above properties (given in the statement of the lemma).\nTo prove it, let $\\{u,v\\} \\notin E_2$ be arbitrary.\nObserve that $T_u \\cap T_v = \\emptyset$ (else, $\\{u,v\\} \\in E$, that would contradict that $E \\subseteq E_2$).\n\nFurthermore, let $B_u \\in T_u$ minimize the distance in $T$ to the subtree $T_v$, let $B$ be the unique bag that is adjacent to $B_u$ on a shortest-path between $B_u$ and $T_v$ in $T$.\nNote that $B \\notin T_u$ by the minimality of $dist_T(B_u,T_v)$, however $B$ may belong to $T_v$.\nRemoving the edge $\\{B_u,B\\}$ in $T$ yields two subtrees $T_1,T_2$ with $T_u \\subseteq T_1$ and $T_v \\subseteq T_2$.\nIn addition, we have that for every $x \\in V \\setminus u$ such that $T_x \\cap T_1 \\neq \\emptyset$, $\\{u,x\\} \\in E_2$ since $x \\neq v$ and $\\bar{G_2}$ is a perfect matching by the hypothesis.\nSimilarly, we have that for every $y \\in V \\setminus v$ such that $T_y \\cap T_2 \\neq \\emptyset$, $\\{v,y\\} \\in E_2$.\nTherefore, by maximality of the number $|E|$ of edges, it follows that $T_1 = T_u$ and $T_2 = T_v$, and so, $T_u \\cup T_v = T$.\nIn particular, $B=B_v \\in T_v$.\n\nFinally, let us prove that $B_u \\setminus u = B_v \\setminus v$.\nIndeed, assume for the sake of contradiction that $B_u \\setminus u \\neq B_v \\setminus v$.\nIn particular, $(B_u \\setminus B_v) \\setminus u \\neq \\emptyset$ or $(B_v \\setminus B_u) \\setminus v \\neq \\emptyset$.\nSuppose w.l.o.g. that $(B_u \\setminus B_v) \\setminus u \\neq \\emptyset$.\nLet $H'=(V,E')$ be obtained from $H$ by adding an edge between vertex $v$ and every vertex of $(B_u \\setminus B_v) \\setminus u$.\nBy construction $|E'| > |E|$.\nFurthermore, $H'$ is chordal since a clique-tree of $H'$ can be obtained from $(T,{\\cal X})$ by adding a new bag $(B_u \\setminus u) \\cup \\{v\\}$ in-between $B_u$ and $B_v$.\nHowever, for every $x \\in (B_u \\setminus B_v) \\setminus u$ we have that $\\{x,v\\} \\in E_2$ since $x \\neq u$ and $\\bar{G_2}$ is a perfect matching by the hypothesis.\nAs a result, $E' \\subseteq E_2$, thus contradicting the maximality of the number $|E|$ of edges in $H$.       \n\\end{proof}\n\n\\begin{proofof}{Theorem~\\ref{thm:tb-npc}}\n\tThe problem is in NP.\n\tTo prove the NP-hardness,let $\\langle G_1, G_2 \\rangle$ be any input of the Chordal Sandwich problem such that  $\\bar{G_2}$ is a perfect matching.\n\tThe graph $G'$ is constructed from $G_1$ as follows.\n\tFirst we add a clique $V'$ of $2n = |V|$ vertices in $G'$.\n\tVertices $v \\in V$ are in one-to-one correspondance with vertices $v' \\in V'$.\n\tThen, for every forbidden edge $\\{u,v\\} \\notin E_2$, vertices $u,v$ are respectively made adjacent to all vertices in $V' \\setminus v'$ and $V' \\setminus u'$.\n\tFinally, we add a distinct copy of the gadget $F_{uv}$ in Figure~\\ref{fig:gadget}, and we make adjacent $s_{uv}$ and $t_{uv}$ to the two vertices $u',v'$ (see also Figure~\\ref{fig:reduction-tb} for an illustration).\n\tWe will prove $tb(G') = 1$ if and only if $\\langle G_1, G_2 \\rangle$ is a yes-instance of the Chordal Sandwich problem.\n\tThis will prove the NP-hardness because our reduction is polynomial and the Chordal Sandwich problem is NP-complete even when the $2n = |V|$ vertices induce a perfect matching in $\\bar{G_2}$ (the complementary of $G_2$)~\\cite{Bodlaender1992,Golumbic1995}.\n\t\n\t\\begin{figure}[h!]\n\t\t\\centering\n\t\t\\includegraphics[width=0.25\\textwidth]{Fig/forbidden-edge.pdf}\n\t\t\\caption{The gadget $F_{uv}$.}\n\t\t\\label{fig:gadget}\n\t\\end{figure}\n\t\n\tIn one direction, assume $tb(G') = 1$, let $(T,{\\cal X})$ be a star-decomposition of $G'$. \n\tLet $H=(V, \\{ \\{u,v\\} \\mid T_u \\cap T_v \\neq \\emptyset\\})$, that is a chordal graph such that $E_1 \\subseteq E(H)$.\n\tTo prove that $\\langle G_1, G_2 \\rangle$ is a yes-instance of the Chordal Sandwich problem, it suffices to prove that $T_u \\cap T_v = \\emptyset$ for every forbidden edge $\\{u,v\\} \\notin E_2$.\n\tMore precisely, we will prove that $T_{s_{uv}} \\cap T_{t_{uv}} \\neq \\emptyset$, for we claim that the latter implies $T_u \\cap T_v = \\emptyset$.\n\tIndeed, assume $T_{s_{uv}} \\cap T_{t_{uv}} \\neq \\emptyset$ and $T_u \\cap T_v \\neq \\emptyset$.\n\tSince $s_{uv}$ and $t_{uv}$ are both adjacent to $u$ and $v$, therefore the four subtrees $T_u,T_v,T_{s_{uv}},T_{t_{uv}}$ pairwise intersect.\n\tBy the Helly property (Lemma~\\ref{lem:helly}) $T_u \\cap T_v \\cap T_{s_{uv}} \\cap T_{t_{uv}} \\neq \\emptyset$, hence there is a bag containing $u,v,s_{uv},t_{uv}$ but then it contradicts the fact that $(T,{\\cal X})$ is a star-decomposition because no vertex dominates the four vertices.\n\tTherefore, $T_{s_{uv}} \\cap T_{t_{uv}} \\neq \\emptyset$ implies $T_u \\cap T_v = \\emptyset$.\n\tLet us prove that $T_{s_{uv}} \\cap T_{t_{uv}} \\neq \\emptyset$.\n\tBy contradiction, assume $T_{s_{uv}} \\cap T_{t_{uv}} = \\emptyset$.\n\tEvery bag $B$ onto the path between $T_{s_{uv}}$ and $T_{t_{uv}}$ must contain $c_{uv},x_{uv}$, furthermore $N[c_{uv}] \\cap N[x_{uv}] = \\{s_{uv}, t_{uv}\\}$.\n\tSince, $(T,{\\cal X})$ is a star-decomposition, the latter implies either $s_{uv} \\in B$ and $B \\subseteq N[s_{uv}]$ or $t_{uv} \\in B$ and $B \\subseteq N[t_{uv}]$.\n\tConsequently, there exist two adjacent bags $B_s \\in T_{s_{uv}},B_t \\in T_{t_{uv}}$ such that $B_s \\subseteq N[s_{uv}]$ and $B_t \\subseteq N[t_{uv}]$.\n\tFurthermore, $B_s \\cap B_t$ is an $s_{uv}t_{uv}$-separator by the properties of a tree decomposition. \n\tIn particular, $B_s \\cap B_t$ must intersect the path $(y_{uv},w_{uv},z_{uv})$ because $y_{uv} \\in N(s_{uv})$ and $z_{uv} \\in N(t_{uv})$. \n\tHowever, $B_s \\subseteq N[s_{uv}], B_t \\subseteq N[t_{uv}]$ but $N[s_{uv}] \\cap N[t_{uv}] \\cap \\{y_{uv},w_{uv},z_{uv}\\} = \\emptyset$, hence $B_s \\cap B_t \\cap \\{y_{uv},w_{uv},z_{uv}\\} = \\emptyset$, that is a contradiction.\n\tAs a result, $T_{s_{uv}} \\cap T_{t_{uv}} \\neq \\emptyset$ and so, $T_u \\cap T_v = \\emptyset$.\n\t\n\t\t\\begin{figure}[h!]\n\t\t\t\\centering\n\t\t\t\\includegraphics[width=0.45\\textwidth]{Fig/reduction-tb.pdf}\n\t\t\t\\caption{The graph $G'$ (simplified view).}\n\t\t\t\\label{fig:reduction-tb}\n\t\t\\end{figure}\n\t\n\tConversely, assume that $\\langle G_1, G_2 \\rangle$ is a yes-instance of the Chordal Sandwich problem.\n\tSince $\\bar{G_2}$ is a perfect matching by the hypothesis, by Lemma~\\ref{lem:chordal-sandwich} there exists a reduced tree decomposition $(T,{\\cal X})$ of $G_1$ such that for every forbidden edge $\\{u,v\\} \\notin E_2$: $T_u \\cap T_v = \\emptyset, T_u \\cup T_v = T$ and there are two adjacent bags $B_u \\in T_u, B_v \\in T_v$ so that $B_u \\setminus u = B_v \\setminus v$.\n\tLet us modify $(T,{\\cal X})$ in order to obtain a star-decomposition of $G'$.\n\t\n\tIn order to achieve the result, we first claim that for every edge $\\{t,t'\\} \\in E(T)$, the bags $X_t,X_{t'}$ differ in exactly one vertex, that is, $|X_t \\setminus X_{t'}| = 1$ and similarly $|X_{t'} \\setminus X_t| = 1$. \n\tIndeed, $X_t \\setminus X_{t'} \\neq \\emptyset$ because $(T,{\\cal X})$ is reduced, so, let $u_{tt'} \\in X_t \\setminus X_{t'}$.\n\tLet $v_{tt'} \\in V$ be the unique vertex satisfying $\\{u_{tt'},v_{tt'}\\} \\notin E_2$, that is well-defined because $\\bar{G_2}$ is a perfect matching by the hypothesis.\n\tNote that $v_{tt'} \\in X_{t'}$ because $u_{tt'} \\notin X_{t'}$ and $T_{u_{tt'}} \\cup T_{v_{tt'}} = T$.\n\tFurthermore, $v_{tt'} \\notin X_{t}$ because $u_{tt'} \\in X_t$ and $T_{u_{tt'}} \\cap T_{v_{tt'}} = \\emptyset$.\n\tBy construction of $(T,{\\cal X})$, there are two adjacent bags $B_{u_{tt'}} \\in T_{u_{tt'}},B_{v_{tt'}} \\in T_{v_{tt'}}$ such that $B_{u_{tt'}} \\setminus u_{tt'} = B_{v_{tt'}} \\setminus v_{tt'}$.\n\tSince $u_{tt'} \\in X_t \\setminus X_{t'}$ and $v_{tt'} \\in X_{t'} \\setminus X_t$, therefore, $X_t = B_{u_{tt'}}$ and $X_{t'} = B_{v_{tt'}}$, and so, $X_t \\setminus X_{t'} = \\{u_{tt'}\\}$ and $X_{t'} \\setminus X_t = \\{v_{tt'}\\}$. \n\tIn the following, we will keep the above notations $u_{tt'},v_{tt'}$ for every edge $\\{t,t'\\} \\in E(T)$ (in particular, $u_{tt'} = v_{t't}$ and $v_{tt'} = u_{t't}$).\n\t\n\tLet us construct the star-decomposition $(T',{\\cal X}')$ of $G'$ as follows.\n\t\\begin{itemize}\n\t\t\\item For every node $t \\in V(T)$, let $S_t = X_t \\cup V' \\cup (\\bigcup_{t' \\in N_T(t)} \\{s_{u_{tt'}v_{tt'}}, t_{u_{tt'}v_{tt'}} \\})$ (in particular, $|S_t| = 2n + |X_t| + 2\\cdot deg_T(t)$).\n\t\tWe will first construct a path decomposition of $G'[S_t]$ whose bags are the sets $Y_{tt'} = X_t \\cup V' \\cup \\{s_{u_{tt'}v_{tt'}}, t_{u_{tt'}v_{tt'}}\\}$ for every edge $\\{t,t'\\} \\in E(T)$ (note that the bags can be linearly ordered in an arbitrary way in the path decomposition).\n\t\tFurthermore, for every edge $\\{t,t'\\} \\in E(T)$, $Y_{tt'} \\subseteq N[u'_{tt'}]$, where $u'_{tt'} \\in V'$ is the corresponding vertex to $u_{tt'} \\in V$ in the clique $V'$ (see Figure~\\ref{fig:reduction-tb-step1} for an illustration).\n\t\tTherefore, the above constructed path decomposition is a $1$-good path decomposition.\n\t\t\n\t\t\t\t\\begin{figure}[h!]\n\t\t\t\t\t\\centering\n\t\t\t\t\t\\includegraphics[width=0.85\\textwidth]{Fig/tb-reduction-step1.pdf}\n\t\t\t\t\t\\caption{The $1$-good path decomposition (right) obtained from the central bag with degree four (left).}\n\t\t\t\t\t\\label{fig:reduction-tb-step1}\n\t\t\t\t\\end{figure}\n\t\t\n\t\t\\item Then, we will connect the $1$-good path decompositions together.\n\t\tMore precisely, let us add an edge between the two bags $Y_{tt'}$ and $Y_{t't}$ for every edge $\\{t,t'\\} \\in E(T)$ (see Figure~\\ref{fig:reduction-tb-step2} for an illustration).\n\t\t\n\t\tIn so doing, we claim that one obtains a star-decomposition of $G'[\\bigcup_{t \\in V(T)} S_t]$.\n\t\tIndeed, it is a tree decomposition since: \n\t\t\\begin{itemize}\n\t\t\t\\item the clique $V'$ is contained in all bags;\n\t\t\t\\item for every $\\{t,t'\\} \\in E(T)$ the two vertices $s_{u_{tt'}v_{tt'}}, t_{u_{tt'}v_{tt'}}$ are only contained in the two adjacent bags $Y_{tt'}$ and $Y_{t't}$, furthermore  $u_{tt'},u'_{tt'},v'_{tt'} \\in Y_{tt'}$ and $v_{tt'},u'_{tt'},v'_{tt'} \\in Y_{t't}$;\n\t\t\t\\item last, each vertex $v \\in V$ is contained in $\\{ Y_{tt'} \\mid v \\in X_t \\text{ and } t' \\in N_T(t)\\}$ which induces a subtree since $(T,{\\cal X})$ is a tree decomposition of $G_1$. \n\t\t\\end{itemize}\n\t\tSince in addition every bag $Y_{tt'}$, with $\\{t,t'\\} \\in E(T)$, is dominated by $u'_{tt'} \\in V'$, this proves the claim that one obtains a star-decomposition.\n\t\t\n\t\t\t\t\\begin{figure}[h!]\n\t\t\t\t\t\\centering\n\t\t\t\t\t\\includegraphics[width=0.55\\textwidth]{Fig/tb-reduction-step2.pdf}\n\t\t\t\t\t\\caption{Connection of the $1$-good path decomposition in Figure~\\ref{fig:reduction-tb-step1} to the neighbouring $1$-good path decompositions.}\n\t\t\t\t\t\\label{fig:reduction-tb-step2}\n\t\t\t\t\\end{figure}\n\t\t\n\t\t\\item In order to complete the construction, let us observe that for every forbidden edge $\\{u,v\\} \\notin E_2$, there is a star-decomposition of $F_{uv} \\setminus \\{u,v\\}$ with three leaf-bags $\\{x_{uv}, s_{uv}, t_{uv}\\}, \\ \\{y_{uv}, s_{uv}, w_{uv}\\}$ and $\\{z_{uv}, s_{uv}, w_{uv}\\}$ and one internal bag of degree three $B_{uv} = \\{c_{uv}, s_{uv}, t_{uv}, w_{uv}\\}$.\n\t\tFor every $\\{t,t'\\} \\in E(T)$, we simply connect the above star-decomposition of $F_{u_{tt'}v_{tt'}} \\setminus \\{u_{tt'},v_{tt'}\\}$ by making the internal bag $B_{u_{tt'}v_{tt'}}$ adjacent to one of $Y_{tt'}$ or $Y_{t't}$ (see Figure~\\ref{fig:reduction-tb-step3} for an illustration). \n\t\\end{itemize}\n\t\n\t\t\t\t\\begin{figure}[h!]\n\t\t\t\t\t\\centering\n\t\t\t\t\t\\includegraphics[width=0.55\\textwidth]{Fig/tb-reduction-step3.pdf}\n\t\t\t\t\t\\caption{The respective star-decompositions of the gadgets $F_{u_iv_i}$ are connected to the other bags.}\n\t\t\t\t\t\\label{fig:reduction-tb-step3}\n\t\t\t\t\\end{figure}\n\t\t\t\t\n\tBy construction, the resulting tree decomposition $(T',{\\cal X}')$ of $G'$ is a star-decomposition, hence $tb(G') = 1$.\t\n\t\t\t\t\n\t\t\t\t\\end{proofof}\n\nRecall that we can use our reduction from Definition~\\ref{def:plpb-reduction} in order to prove that computing path-length and path-breadth is NP-hard.\nBy contrast, our reduction from Theorem~\\ref{thm:tb-npc} cannot be used to prove that tree-length is NP-hard to compute (in fact, the graph $G'$ resulting from the reduction has tree-length two).\n\nFinally, as in the previous Section~\\ref{sec:plpb}, let us strenghten Theorem~\\ref{thm:tb-npc} with an inapproximability result.\n\n\\begin{corollary}\n\t\\label{cor:pb-inapprox}\n\tFor every $\\varepsilon > 0$, the tree-breadth of a graph cannot be approximated within a factor $2 - \\varepsilon$ unless P=NP.\n\\end{corollary}\n\n\\section{General properties of graphs with tree-breadth one}\n\\label{sec:tb}\n\nIn Section~\\ref{sec:tb-npc}, we prove that computing the tree-breadth is NP-hard.\nIn particular, the recognition of graphs with tree-breadth one is NP-complete.\nIn light of this result, we focus on graphs with tree-breadth one (in order to obtain a better understanding of what makes the problem difficult)\n\n\\begin{center}\n    \\fbox{\\begin{minipage}{.95\\linewidth}\\label{prob:tb}\n        \\begin{problem}[1-tree-breadth]\\ \n          \\begin{description}\n          \\item[Input:] a connected graph $G=(V,E)$\n          \\item[Question:] $tb(G) \\leq 1$ ?\n          \\end{description}\n        \\end{problem}     \n      \\end{minipage}}\n  \\end{center}\n\nIn Lemma~\\ref{lem:reduction-tb}, we show that the problem of recognizing graphs with tree-breadth at most one is equivalent to the problem of computing tree-breadth.\nThis further motivates our study of these graphs.\nThen, we will prove necessary conditions for a graph to be of tree-breadth one.\n\\begin{itemize}\n\\item One is that all graphs with a star-decomposition have a \\emph{domination elimination ordering} (see Section~\\ref{sec:order}).\nWe will outline a few implications of this property.\n\\item Second, we will prove in Lemma~\\ref{lem:sep-keep} that if a graph $G$ admits a star-decomposition then so do all the \\emph{blocks} of $G$, where the blocks here denote a particular case of induced subgraphs of $G$ ({\\it e.g.}, see Definition~\\ref{def:min-sep}).\n\\end{itemize} \nFinally, we will obtain from the latter result a polynomial-time algorithm to decide whether a bipartite graph has tree-breadth at most one ({\\it e.g.}, see Section~\\ref{sec:bipartite}).\n\n\\begin{definition}\n\\label{def:reduction-tb}\nLet $G$ be a graph with $n$ vertices, denoted by $v_1,v_2,\\ldots,v_n$, and let $r$ be a positive integer.\nThe graph $G'_r$ is obtained from $G$ by adding a clique with $n$ vertices, denoted by $U = \\{ u_1,u_2,\\ldots,u_n \\}$, so that for every $1 \\leq i \\leq n$, vertex $u_i$ is adjacent to $B_G(v_i,r) = \\{ x \\in V(G) \\mid dist_G(v_i,x) \\leq r \\}$.\n\\end{definition}\n\n\\begin{lemma}\n\\label{lem:reduction-tb}\nFor every graph $G$, for every positive integer $r$, let $G'_r$ be as defined in Definition~\\ref{def:reduction-tb}, $tb(G) \\leq r$ if and only if $tb(G'_r) \\leq 1$.\n\\end{lemma}\n\n\\begin{proof}\nIf $tb(G) \\leq r$ then we claim that starting from any tree decomposition $(T,{\\cal X})$ of $G$ with breadth at most $r$, one obtains a star-decomposition of $G_r'$ by adding the clique $U$ in every bag $X_t, \\ t\\in V(T)$.\nIndeed, in such case for every bag $X_t, \\ t \\in V(T)$, by the hypothesis there is $v_i \\in V(G)$ such that $\\max_{x \\in X_t} dist_G(v_i,x) \\leq r$, whence $X_t \\cup U \\subseteq N_{G'_r}[u_i]$.\nConversely, if $tb(G'_r) \\leq 1$ then we claim that starting from any tree decomposition $(T',{\\cal X}')$ of $G'_r$ with breadth at most one, one obtains a tree decomposition of $G$ with breadth at most $r$ by removing every vertex of the clique $U$ from every bag $X_t', \\ t \\in V(T')$. \nIndeed, in such case for every bag $X_t', \\ t \\in V(T')$, by the hypothesis there is $y \\in V(G'_r)$ such that $X_t' \\subseteq N_{G'_r}[y]$.\nFurthermore, $y \\in \\{ u_i, v_i \\}$ for some $1 \\leq i \\leq n$, and so, since $N_{G'_r}[v_i] \\subseteq N_{G'_r}[u_i]$ by construction, therefore $X_t' \\setminus U \\subseteq N_{G'_r}(u_i) \\setminus U = \\{ x \\in V(G) \\mid dist_G(v_i,x) \\leq r \\}$.\n\\end{proof}\n\n\\subsection{Existence of specific elimination orderings}\n\\label{sec:order}\n\nIndependently from the remaining of the section, let us prove some interesting properties of graphs with tree-breadth one in terms of \\emph{elimination orderings}. \nMore precisely, a \\emph{domination elimination ordering}~\\cite{Dahlhaus1994} of a graph $G$ is a total ordering of its vertex-set, denoted by $v_1,v_2,\\ldots,v_n$, so that for every $1 \\leq i < n$, there is $j > i$ satisfying that $N_G(v_i) \\cap \\{ v_{i+1}, v_{i+2}, \\ldots, v_n \\} \\subseteq N_G[v_j]$.\nThe existence of domination elimination orderings in some graph classes and their algorithmic applications has been studied in~\\cite{Chepoi1998}.  \nLet us prove that graphs with tree-breadth one all admit a domination elimination ordering.\n\n\\begin{lemma}\n\\label{lem:dom-order}\nLet $G$ be such that $tb(G) \\leq 1$, $G$ admits a domination elimination ordering.\n\\end{lemma}\n\n\\begin{proof}\nAssume $G$ has at least two vertices (or else, the lemma is trivial).\nTo prove the lemma, it suffices to prove the existence of $u,v \\in V(G)$ distinct such that $N(v) \\subseteq N[u]$ and $tb(G \\setminus v) \\leq 1$ (then, the lemma follows by induction on the order of the graph).\n\nIf $G$ admits a universal vertex $u$, then one can pick $v \\in V(G) \\setminus u$ arbitrary, $N(v) \\subseteq N[u]$ because $u$ is universal in $G$, furthermore $tb(G \\setminus v) \\leq 1$ because $G \\setminus v$ admits a universal vertex $u$.\n\nElse, $G$ does not admit any universal vertex, let $(T,{\\cal X})$ be a reduced tree decomposition of $G$ of breadth one, that is a star-decomposition by Lemma~\\ref{lem:dominator-in-bag}.\nLet $X_t, \\ t \\in V(T)$ be a leaf.\nSince the tree decomposition is reduced, there must be $v \\in X_t$ satisfying $T_v = \\{ X_t \\}$.\nNow there are two cases.\n\\begin{itemize}\n\\item Suppose there is $u \\in X_t \\setminus v$ such that $X_t \\subseteq N[u]$.\nThen, $N(v) \\subseteq X_t \\subseteq N[u]$, and $tb(G \\setminus v) \\leq 1$ because $G \\setminus v$ can be obtained from $G$ by contracting the edge $\\{u,v\\}$ and tree-breadth is contraction-closed by Lemma~\\ref{lem:contraction-closed}.\n\\item Else, $X_t \\subseteq N[v]$, and for every $x \\in X_t \\setminus v, \\ X_t \\not\\subseteq N[x]$.\nLet $t' \\in V(T)$ be the unique node adjacent to node $t$ in $T$, that exists because $G$ does not admit any universal vertex and so, $T$ has at least two bags. \nLet us assume that for every $x \\in X_t \\setminus v$, $x \\in X_t \\cap X_{t'}$ (for otherwise, $N(x) \\subseteq N[v]$ and $tb(G \\setminus x) \\leq 1$ because $G \\setminus x$ can be obtained from $G$ by contracting the edge $\\{v,x\\}$ to $v$ and tree-breadth is contraction-closed by Lemma~\\ref{lem:contraction-closed}).\nIn particular, let $u \\in X_{t'}$ satisfy $X_{t'} \\subseteq N[u]$.\nThen, $N(v) = X_t \\cap X_{t'} \\subseteq N[u]$, furthermore $tb(G \\setminus v) \\leq 1$ because $(T \\setminus t, {\\cal X} \\setminus X_t)$ is a star-decomposition of $G \\setminus v$.\n\\end{itemize}\\vspace{-15pt}\\end{proof}\n\nNote that for a graph to have tree-breadth one, it must satisfy the necessary condition of Lemma~\\ref{lem:dom-order} and this can be checked in polynomial-time.\nHowever, the existence of some domination elimination ordering is not a sufficient condition for the graph to have tree-breadth one.\nIndeed, every grid has a domination elimination ordering but the \\emph{tree-length} of the $n \\times m$ grid is at least $\\min\\{n,m\\} -1$~\\cite{Dourisboure2007b} (recall that $tl(G) \\leq 2tb(G)$ for any graph $G$).\n\n\n\n\nThe existence of a domination elimination ordering has some interesting consequences about the graph structure.\nLet us recall one such a consequence about the \\emph{cop-number} of the graph.\n\n\\begin{corollary}\n\\label{cor:cop-number}\nFor any graph $G$ with $tb(G) \\leq 1$, $G$ has cop-number $\\leq 2$ and the upper-bound is sharp.\n\\end{corollary}\n\n\\begin{proof}\nBy Lemma~\\ref{lem:dom-order}, $G$ admits a domination elimination ordering.\nTherefore, by~\\cite[Theorem 4]{Clarke2005} $G$ has cop-number $ \\leq 2$. \nOne can prove the sharpness of the upper-bound by setting $G := C_4$, the cycle with four vertices. \n\\end{proof}\n\n\\subsection{Properties of particular decompositions}\n\nIn the following, it will be useful not only to constrain the properties of the star-decomposition whose existence we are interested in, but also to further constrain the properties of the graph $G$ that we take as input.\nLet us first remind basic terminology about graph separators.\n\n\\begin{definition}\n\\label{def:min-sep}\nLet $G=(V,E)$ be connected, a \\emph{separator} of $G$ is any subset $S \\subseteq V$ such that $G \\setminus S$ has at least two connected components.\n\nIn particular, a \\emph{full component} for $S$ is any connected component $C$ of $G \\setminus S$ satisfying $N(C) = S$.\nA \\emph{block} is any induced subgraph $G[C \\cup S]$ with $S$ being a separator and $C$ being a full component for $S$.  \n\nFinally, a \\emph{minimal separator} is a separator with at least two full components. \n\\end{definition}\n\nOur objective is to prove that if a graph $G$ has tree-breadth one then so do all its blocks.\nIn fact, we will prove a slightly more general result:\n\n\\begin{lemma}\\label{lem:sep-keep}\nLet $G=(V,E)$ be a graph, $S \\subseteq V$ be a separator, and $W \\subseteq V \\setminus S$ be the union of some connected components of $G \\setminus S$.\nIf $tb(G) = 1$ and $W$ contains a full component for $S$, then $tb(G[W \\cup S]) = 1$.\nMore precisely if $(T,{\\cal X})$ is a tree decomposition of $G$ of breadth one, then $(T, \\{ X_t \\cap (W \\cup S) \\mid X_t \\in {\\cal X}\\})$ is a tree decomposition of $G[W \\cup S]$ of breadth one.\n\\end{lemma}\n\n\\begin{proof}\nLet $(T,{\\cal X})$ be a tree decomposition of breadth one of $G$.\nLet us remove all vertices in $V \\setminus (W \\cup S)$ from bags in $(T,{\\cal X})$, which yields a tree decomposition $(T',{\\cal X}')$ of the induced subgraph $G[W \\cup S]$.\nTo prove the lemma, we are left to prove that $(T',{\\cal X}')$ has breadth one.\nLet $X_t$ be a bag of $(T',{\\cal X}')$.\nBy construction, $X_t$ is fully contained into some bag of $(T,{\\cal X})$, so it has radius one in $G$.\nLet $v \\in V$ be such that $X_t \\subseteq N_G[v]$.\nIf $v \\in W \\cup S$, then we are done.\nElse, since for all $x \\notin S \\cup W, N(x) \\cap (S \\cup W) \\subseteq S$ (because $S$ is a separator by the hypothesis), we must have that $X_t \\subseteq S$.\nLet $A \\subseteq W$ be a full component for $S$, that exists by the hypothesis, and let $T_A$ be the subtree that is induced by the bags intersecting the component.\nSince we have that the subtree $T_A$ and the subtrees $T_x, x \\in X_t$ pairwise intersect --- because for all $x \\in X_t$, $x \\in S$ and so, $x$ has a neighbour in $A$ ---, then by the Helly property (Lemma~\\ref{lem:helly}) $T_A \\cap \\left(\\bigcap_{x \\in X_t} T_x\\right) \\neq \\emptyset$ {\\it i.e.}, there exists a bag in $(T,{\\cal X})$ containing $X_t$ and intersecting $A$.\nMoreover, any vertex dominating this bag must be either in $S$ or in $A$, so in particular there exists $u \\in A \\cup S$ dominating $X_t$, which proves the lemma.\n\\end{proof}\n\nLemma~\\ref{lem:sep-keep} implies that, under simple assumptions, a graph of tree-breadth one can be disconnected using any (minimal) separator, and the components must still induce subgraphs with tree-breadth one.\nThe converse does not hold in general, yet there are interesting cases when it does.\n\n\\begin{lemma}\\label{lem:cliqueSep}\nLet $G=(V,E)$ be a graph, $S \\subseteq V$ be a clique-minimal-separator and $A$ be a full component for $S$.\nThen, $tb(G) = 1$ if and only if both $tb(G[A \\cup S]) = 1$ and $tb(G[V \\setminus A]) = 1$.\n\\end{lemma}\n\n\\begin{proof}\nBy the hypothesis $V \\setminus (A \\cup S)$ contains a full component because $S$ is a minimal separator.\nTherefore, if $G$ has tree-breadth one, then so do $G[A \\cup S]$ and $G[V \\setminus A]$ by Lemma~\\ref{lem:sep-keep}.\nConversely, suppose that we have both $tb(G[A \\cup S]) = 1$ and $tb(G[V \\setminus A]) = 1$.\nLet $(T^1,{\\cal X}^1)$ be a tree decomposition of $G[A \\cup S]$ with breadth one, let $(T^2,{\\cal X}^2)$ be a tree decomposition of $G[V \\setminus A]$ with breadth one.\nThen for every $i \\in \\{1,2\\}$ we have that since $S$ is a clique the subtrees $T^i_s, \\ s \\in S$, pairwise intersect, so by the Helly Property (Lemma~\\ref{lem:helly}) $\\bigcap_{s \\in S}T^i_s \\neq \\emptyset$ {\\it i.e.}, $S$ is fully contained into some bag of $(T^1,{\\cal X}^1)$ and it is fully contained into some bag of $(T^2,{\\cal X}^2)$.\nMoreover, $(A \\cup S) \\cap (V \\setminus A) = S$, therefore a tree decomposition of $G$ with breadth one can be obtained by adding an edge between some bag of $(T^1,{\\cal X}^1)$ containing $S$ and some bag of $(T^2,{\\cal X}^2)$ containing $S$.\n\\end{proof}\n\nRecall that computing the clique-minimal-decomposition of a graph $G$ can be done in ${\\cal O}(nm)$-time, where $m$ denotes the number of edges~\\cite{Berry2010}.\nBy doing so, one replaces a graph $G$ with the maximal subgraphs of $G$ that have no clique-separator, \\textit{a.k.a.} \\emph{atoms}.\nTherefore, we will assume in the remaining of the proofs that there is no clique-separator in the graphs that we will study, we will call them {\\it prime graphs}.\n\n\n\n\\subsection{Application to bipartite graphs}\n\\label{sec:bipartite}\n\nIn this section, we describe an ${\\cal O}(nm)$-time algorithm so as to decide whether a prime bipartite graph has tree-breadth one.\nThis combined with Lemma~\\ref{lem:cliqueSep} proves that it can be decided in polynomial-time whether a bipartite graph has tree-breadth one.\n\nWe will first describe a more general problem and how to solve it in polynomial-time.\n\n\\paragraph{Tree decompositions with constrained set of bags.}\nOur algorithm for bipartite graphs makes use of the correspondance between tree decompositions and triangulations of a graph.\nIndeed, recall that any reduced tree decomposition $(T,{\\cal X})$ of a graph $G$ is a clique-tree for some chordal supergraph $H$ of $G$ whose maximal cliques are the bags of ${\\cal X}$.\nConversely, for any chordal supergraph $H$ of $G$, every clique-tree of $H$ is a tree decomposition of $G$ whose bags are the maximal cliques of $H$~\\cite{Gavril1974}.\nTherefore as shown below, the following subproblem can be solved in polynomial-time:\n\n\\begin{center}\n    \\fbox{\\begin{minipage}{.95\\linewidth}\\label{pb:td-bags-given}\n        \\begin{problem}\\ \n          \\begin{description}\n          \\item[Input:] a graph $G$, a family ${\\cal X}$ of subsets of $V(G)$.\n          \\item[Question:] Does there exist a tree $T$ such that $(T,{\\cal X})$ is a tree decomposition of $G$ ?\n          \\end{description}\n        \\end{problem}     \n      \\end{minipage}}\n  \\end{center}\n\nLet us assume w.l.o.g. that no subset of ${\\cal X}$ is properly contained into another one.\nTo solve Problem~\\ref{pb:td-bags-given}, it suffices to make every subset $X \\in {\\cal X}$ a clique in $G$, then to verify whether the resulting supergraph $H$ of $G$ is a chordal graph whose maximal cliques are exactly the sets in ${\\cal X}$. \nSince chordal graphs can be recognized in linear-time, and so can be enumerated their maximal cliques~\\cite{Gavril1972}, therefore Problem~\\ref{pb:td-bags-given} can be solved in polynomial-time.\n\n\\paragraph{The algorithm for bipartite graphs.}\nNow, given a bipartite graph $G$, we aim to exhibit a family ${\\cal X}$ so that $tb(G) = 1$ if and only if there is a star-decomposition of $G$ whose bags are ${\\cal X}$.\nBy doing so, we will reduce the recognition of bipartite graph with tree-breadth at most one to the more general Problem~\\ref{pb:td-bags-given}.\n\n\\begin{lemma}\n\\label{lem:bipartite-tb}\nLet $G = (V_0 \\cup V_1, E)$ be a prime bipartite graph with tree-breadth one.\nThere is $(T,{\\cal X})$ a star-decomposition of $G$ such that either ${\\cal X} = \\{ N[v_0] \\mid v_0 \\in V_0 \\}$, or ${\\cal X} = \\{ N[v_1] \\mid v_1 \\in V_1 \\}$.\n\\end{lemma}\n\n\\begin{proof}\nLet $(T,{\\cal X})$ be a star-decomposition of $G$, that exists by Lemma~\\ref{lem:dominator-in-bag}, minimizing the number $|{\\cal X}|$ of bags.\nSuppose there is some $v_0 \\in V_0$, there is $t \\in V(T)$ such that $X_t \\subseteq N_G[v_0]$ (the case when there is some $v_1 \\in V_1$, there is $t \\in V(T)$ such that $X_t \\subseteq N_G[v_1]$ is symmetrical to this one).\nWe claim that for every $t' \\in V(T)$, there exists $v_0' \\in V_0$ satisfying $X_{t'} \\subseteq N_G[v_0']$.\nBy contradiction, let $v_0 \\in V_0, v_1 \\in V_1$, let $t,t'\\in V(T)$ be such that $X_t \\subseteq N_G[v_0], X_{t'} \\subseteq N_G[v_1]$.\nBy connectivity of the tree $T$ we may assume w.l.o.g. that $\\{t,t'\\} \\in E(T)$.\nMoreover, $N_G(v_0) \\cap N_G(v_1) = \\emptyset$ because $G$ is bipartite.\nTherefore, $X_t \\cap X_{t'} \\subseteq \\{ v_0, v_1 \\}$, and in particular if $X_t \\cap X_{t'} = \\{ v_0, v_1 \\}$ then $v_0,v_1$ are adjacent in $G$.\nHowever, by the properties of a tree decomposition this implies that $X_t \\cap X_{t'}$ is a clique-separator (either an edge or a single vertex), thus contradicting the fact that $G$ is prime.\n\nNow, let $v_0 \\in V_0$ be arbitrary.\nWe claim that there is a unique bag $X_t, \\ t \\in V(T)$, containing $v_0$.\nIndeed, any such bag $X_t$ must satisfy $X_t \\subseteq N_G[v_0]$, whence the subtree $T_{v_0}$ can be contracted into a single bag $\\bigcup_{t \\in T_{v_0}} X_t$ without violating the property for the tree decomposition to be a star-decomposition.\nAs a result, the unicity of the bag $X_t$ follows from the minimality of $|{\\cal X}|$.\nFinally, since $X_t$ is unique and $X_t \\subseteq N_G[v_0]$, therefore $X_t = N_G[v_0]$ and so, ${\\cal X} = \\{ N[v_0] \\mid v_0 \\in V_0 \\}$.\n\\end{proof}\n\nWe can easily deduce from Lemma~\\ref{lem:bipartite-tb} the following algorithm for deciding whether a prime bipartite graph $G$ has tree-breadth one.\nLet $(V_0,V_1)$ be the (unique) bipartition of the vertex-set of $G$ into two stable sets.\nLet ${\\cal X}_0 = \\{ N[v_0] \\mid v_0 \\in V_0 \\}$, let ${\\cal X}_1 = \\{ N[v_1] \\mid v_1 \\in V_1 \\}$.\nBy Lemma~\\ref{lem:bipartite-tb}, $tb(G) = 1$ if and only if one of $(G,{\\cal X}_0), (G,{\\cal X}_1)$ is a yes-instance of Problem~\\ref{pb:td-bags-given}.\n\n\\section{Algorithm for planar graphs}\n\\label{sec:planar}\n\nWe are now ready to present our main result.\nIn this section, we describe a quadratic-time algorithm for deciding whether a prime planar graph has tree-breadth one. \nOverall, we claim that it gives us a quadratic-time algorithm for deciding whether a general planar graph has tree-breadth one.\nIndeed, the clique-decomposition of a planar graph takes ${\\cal O}(n^2)$-time to be computed, furthermore the disjoint union of the atoms has ${\\cal O}(n+m)$ vertices~\\cite{Berry2010}, that is ${\\cal O}(n)$ for planar graphs.\n\n\\medskip\nRoughly, we will construct a star-decomposition of the graph by increments.\nThe main principle of the recursive algorithm is to find a particular vertex, called {\\it leaf-vertex}.\nInformally, it extracts a new bag of the star-decomposition from some ball around the leaf-vertex.\nThen, depending on the case, either the leaf-vertex vertex is removed or some edge is added or contracted.\nIn both cases, the resulting graph remains prime and planar and has tree-breadth one if and only if the initial one has tree-breadth one. \n\n\nWe prove that each inductive step takes a linear time. Moreover, we prove that there are at most a linear number of recursive iterations (Lemma~\\ref{lem:ub-steps}). \n\n\\medskip\nThere are three kinds of leaf-vertices ({\\it e.g.}, see Figure~\\ref{fig:leaf-vertex}). \n\\begin{definition}\\label{def:leafVertex}\nLet $G=(V,E)$ be a graph. A vertex $v$ is a \\emph{leaf-vertex} if one of the following conditions hold.\n\\begin{description}\n\\item[Type 1.]  $N(v)$ induces an $a_vb_v$-path for some $a_v,b_v \\in V \\setminus \\{v\\}$, denoted by $\\Pi_v$, of length at least $3$ and there exists $d_v \\in V \\setminus \\{v\\}$ such that $N(v) \\subseteq N(d_v)$, i.e., $d_v$ dominates $\\Pi_v$. \n\\item [Type 2.] $N(v)$ induces a path, denoted by $\\Pi_v=(a_v,b_v,c_v)$,  of length $2$. \n\\item[Type 3.] $N(v)$ consists of two non adjacent vertices $a_v$ and $c_v$, and there exists $b_v \\in (N(a_v) \\cap N(c_v)) \\setminus \\{v\\}$. \n\\end{description} \n\\end{definition}\n\n\\begin{figure}[h!]\n \\centering\n \\includegraphics[width=0.75\\textwidth]{Fig/leafVertices.pdf}\n \\caption{The three kinds of leaf-vertices.}\n \\label{fig:leaf-vertex}\n\\end{figure}\n\n\n\nWe are now ready to describe the algorithm. \n\n\\subsection{Algorithm \\texttt{Leaf-BottomUp}}\n\nLet $G=(V,E)$ be prime planar graph.\nAssume $G$ has at least $7$ vertices (else, it is easy to conclude).\n\n\\begin{enumerate}[label = Step \\arabic*, itemsep=15pt]\n\t\n\\item\\label{step:find-leaf-vertex}\nThe first step is to find a leaf-vertex in $G$.\nIn Section~\\ref{sec:complexity-leaf-vertex}, we describe how to decide whether $G$ has a leaf-vertex in linear-time. \n\n\n\n\t\\begin{itemize}[itemsep=10pt]\n\t\t\n\t\t\\item if $G$ has no leaf-vertex, then, by Theorem~\\ref{th:noP3}, no minimal separator of $G$ induces a path of length $2$. \n\t\tTherefore, by Lemma~\\ref{lem:2bags}, $tb(G)=1$ only if $G$ has a star-decomposition with at most $2$ bags.\n\t\tIn that case, Algorithm \\texttt{Leaf-BottomUp} checks whether it exists a star-decomposition with at most $2$ bags, which can be done in quadratic time (see Lemma~\\ref{lem:complexity-2bags}).\n\t\tIf it exists, then $tb(G)=1$.\n\t\tOtherwise, $tb(G)>1$. \n\t\t\n\t\t\\item otherwise, let $v$ be a leaf-vertex of $G$ and go to~\\ref{step:type-1} if $v$ is of Type $1$ and go to~\\ref{step:type-2-3} otherwise.\n\t\t\n\t\\end{itemize}\n\n\\item\\label{step:type-1}{\\bf Case $v$ is of Type $1$.}\nLet $\\Pi_v$ and $d_v$ be defined as in Definition~\\ref{def:leafVertex}.\nIf $V = N[v] \\cup \\{d_v\\}$ then trivially $tb(G) = 1$. \nElse by Theorem~\\ref{th:Type1}, $G'$ is prime and planar, where $G'$ is the graph obtained from $G \\setminus v$ by contracting the internal nodes of $\\Pi_v$ to a single edge, and $tb(G)=1$ if and only if $tb(G')=1$. In that case, Algorithm \\texttt{Leaf-BottomUp} is recursively applied on $G'$. \n\n\\item\\label{step:type-2-3}{\\bf Case $v$ is of Type $2$ or $3$.}\nLet $a_v,b_v,c_v$ be defined as in Definition~\\ref{def:leafVertex}.\n\nIn that case, Algorithm \\texttt{Leaf-BottomUp} checks whether $G \\setminus v$ is prime.\nBy Theorem~\\ref{th:GminusVprime?}, for any clique minimal separator $S$ of $G \\setminus v$ (if any), there exists $u_v \\in V \\setminus \\{ a_v, b_v, c_v, v \\}$ such that $S=\\{b_v,u_v\\}$.  \nTherefore, this can be checked in linear time (by checking with a Depth-First-Search whether there is a cut-vertex of $G \\setminus \\{ a_v, b_v, c_v, v \\}$ in the neighbors of $b_v$).\nIf $G \\setminus v$ is prime then go to~\\ref{step:prime-case}, else go to~\\ref{step:new-clique-sep}.\n\n\t\\begin{enumerate}[label=\\labelenumi.\\arabic*, itemsep=10pt]\n\t\t\n\t\t\\item\\label{step:prime-case}{\\bf Case $v$ is of Type $2$ or $3$ and $G \\setminus v$ is prime.}\n\t\tThere are $4$ cases that can be determined in linear-time.\n\t\t\n\t\t\t\\begin{enumerate}[label=(\\alph*), itemsep=5pt]\n\t\t\t\t\n\t\t\t\t\\item\\label{step:many-neighbours}{\\bf Case $|N(a_v) \\cap N(c_v)| \\geq 3$ in $G \\setminus v$, or there exists a minimal separator $S\\subseteq (N(a_v) \\cap N(c_v)) \\cup \\{a_v,c_v\\}$ in $G \\setminus v$ and $\\{a_v,c_v\\} \\subseteq S$.}\n\t\t\t\t\n\t\t\t\tBy Theorem~\\ref{th:primeEasy}, $tb(G)=1$ if and only if $tb(G \\setminus v)=1$.\n\t\t\t\tSince, moreover, $G \\setminus v$ is planar and prime, then Algorithm \\texttt{Leaf-BottomUp} is recursively applied on $G \\setminus v$.  \n\t\t\t\t\n\t\t\t\t\\item\\label{step:few-neighbours}{\\bf Case: $|N(a_v) \\cap N(c_v)| < 3$ in $G \\setminus v$ and there is no minimal separator $S\\subseteq (N(a_v) \\cap N(c_v)) \\cup \\{a_v,c_v\\}$ in $G \\setminus v$ such that $\\{a_v,c_v\\} \\subseteq S$.}\n\t\t\t\t\n\t\t\t\t\\smallskip\n\t\t\t\t\n\t\t\t\t\t\\begin{enumerate}[label=\\roman*]\n\t\t\t\t\t\t\n\t\t\t\t\t\t\\item\\label{step:one-neighbour}{\\bf Subcase: $|N(a_v) \\cap N(c_v)| =1$ in $G \\setminus v$}.\n\t\t\t\t\t\tIn that subcase, $N(a_v) \\cap N(c_v)=\\{v,b_v\\}$ and, by Theorem~\\ref{thm:force-clique}, $tb(G)=1$ if and only if $G=C_4$, a cycle with four vertices.\n\t\t\t\t\t\tNote that here it implies that $tb(G) > 1$ because $G$ has at least $7$ vertices.\n\t\t\t\t\t\t\n\t\t\t\t\t\t\\item\\label{step:two-neighbours}{\\bf Subcase: $|N(a_v) \\cap N(c_v)| =2$ in $G \\setminus v$}.\n\t\t\t\t\t\tIn that subcase, let $N(a_v) \\cap N(c_v)=\\{v,b_v,u_v\\}$.\n\t\t\t\t\t\tBy Theorem~\\ref{th:primeDifficult}, since $G$ has more than $5$ vertices, the graph $G'$ obtained from $G$ by adding edges $\\{v,u_v\\}$ and $\\{b_v,v\\}$ is planar and prime, and moreover $tb(G) = 1$ if and only if $tb(G') = 1$. In that case, Algorithm \\texttt{Leaf-BottomUp} is recursively applied on $G'$.\n\t\t\t\t\t\t\n\t\t\t\t\t\\end{enumerate}\n\t\t\t\t\n\t\t\t\\end{enumerate}\n\t\t\n\t\t\\item\\label{step:new-clique-sep}{\\bf Case $v$ is of Type $2$ or $3$ and $G \\setminus v$ has a clique separator.}\n\t\tAs mentioned in~\\ref{step:type-2-3}, in that case, there exists $u_v \\in V \\setminus \\{ a_v, b_v, c_v, v\\}$ such that $S=\\{b_v,u_v\\}$ is a minimal clique separator of $G \\setminus v$. \n\t\tMoreover, by Theorem~\\ref{th:GminusVprime?}, $G \\setminus \\{ a_v, b_v, c_v, v\\}$ is connected.\n\t\t\n\t\t\\smallskip\n\t\t\n\t\tBy Theorem~\\ref{th:addEdgebv}, $tb(G)=1$ if and only if $tb(G')=1$ where $G'$ is obtained from $G$ by adding the edge $\\{v,b_v\\}$ (if it were not already there). \n\t\tMoreover, $G'$ is prime and planar. \n\t\tHence, we may assume that $\\{v,b_v\\} \\in E$ (if not Algorithm \\texttt{Leaf-BottomUp} adds it).\n\t\t\n\t\t\\smallskip\n\t\t\n\t\tFurthermore by Theorem~\\ref{th:GminusVprime?}, since $G$ has more than $5$ vertices, $u_v \\notin N(a_v) \\cap N(c_v)$. \n\t\tIn the latter case, let us assume w.l.o.g. that $u_v \\notin N(a_v)$, that is either $u_v \\notin N(a_v) \\cup N(c_v)$ or $u_v \\in N(c_v) \\setminus N(a_v)$. \n\t\tThere are several cases to be considered.\n\t\t\n\t\t\t\\begin{enumerate}[label=(\\alph*), itemsep=5pt]\n\t\t\t\t\n\t\t\t\t\\item\\label{step:no-separation}{\\bf Case  $u_v \\notin N(a_v) \\cup N(c_v)$, \\\\ or $(N(u_v) \\cap N(a_v)) \\cup \\{v,c_v\\}$ does not separate $u_v$ and $a_v$ in $G$.}\n\t\t\t\t\n\t\t\t\t\\smallskip\n\t\t\t\t\n\t\t\t\tBy Theorem~\\ref{th:contractva}, $G/ va_v$ is prime and planar, and $tb(G)=1$ if and only if $tb(G/va_v)=1$. \n\t\t\t\tIn that case, Algorithm \\texttt{Leaf-BottomUp} is recursively applied on $G/va_v$, the graph obtained from $G$ by contracting the edge $\\{v,a_v\\}$. \n\t\t\t\t\n\t\t\t\t\\item\\label{step:separation}{\\bf Case $u_v \\in N(c_v) \\setminus N(a_v)$, \\\\ and $(N(u_v) \\cap N(a_v)) \\cup \\{v,c_v\\}$ separates $u_v$ and $a_v$ in $G$.} \n\t\t\t\t\n\t\t\t\t\\smallskip\n\t\t\t\t\n\t\t\t\tIn that case, recall that $G$ has at least $7$ vertices. \n\t\t\t\tAgain, Algorithm \\texttt{Leaf-BottomUp} distinguishes several subcases.\n\t\t\t\t\n\t\t\t\t\t\\begin{enumerate}[label=\\roman*]\n\t\t\t\t\t\t\n\t\t\t\t\t\t\\item\\label{step:contraction-case}{\\bf Subcase $N(b_v)=\\{v,a_v,c_v,u_v\\}$.}\n\t\t\t\t\t\tIn that subcase, by Theorem~\\ref{claim:connect-vertex-b}, we can find in linear-time a vertex $x \\in (N(a_v) \\cap N(u_v)) \\setminus \\{b_v\\}$ such that $G'$ is planar, where $G'$ is obtained from $G$ by adding the edge $\\{b_v,x\\}$. \n\t\t\t\t\t\tMoreover, by Theorem~\\ref{lem:clique-case-2}, $G' / b_vx$ (obtained by contracting $\\{b_v,x\\}$) is prime and $tb(G)=1$ if and only if $tb(G' / b_vx)=1$. \n\t\t\t\t\t\tIn that case, Algorithm \\texttt{Leaf-BottomUp} is recursively applied on $G' / b_vx$.\n\t\t\t\t\t\t\n\t\t\t\t\t\t\\item\\label{step:diamond-case}{\\bf Subcase $\\{v,a_v,c_v,u_v\\} \\subset N(b_v)$ and $N(b_v)\\cap N(a_v) \\cap N(u_v)\\neq \\emptyset$.}\n\t\t\t\t\t\tIn that subcase, $|N(b_v)\\cap N(a_v) \\cap N(u_v)|=1$ by Lemma~\\ref{claim:sep-b} and let $x$ be this common neighbor. \n\t\t\t\t\t\tBy Theorem~\\ref{lem:clique-case-2}, $G/ b_vx$ (obtained by contracting $\\{b_v,x\\}$) is prime and $tb(G)=1$ if and only if $tb(G/ b_vx)=1$. \n\t\t\t\t\t\tIn that case, Algorithm \\texttt{Leaf-BottomUp} is recursively applied on $G/ b_vx$.\n\t\t\t\t\t\t\n\t\t\t\t\t\t\\item\\label{step:no-diamond-case}{\\bf Subcase $\\{v,a_v,c_v,u_v\\} \\subset N(b)$ and $N(b_v)\\cap N(a_v) \\cap N(u_v)= \\emptyset$.}\n\t\t\t\t\t\tIn that subcase, by Theorem~\\ref{lem:final-case-1}, there must be a unique $x \\in (N(a_v) \\cap N(u_v)) \\setminus \\{b_v\\}$ such that $N(b_v) \\cap N(x)$ is a $b_vx$-separator of $G$ and $|N(b_v) \\cap N(x)| \\geq 3$ (or else, $tb(G) > 1$). \n\t\t\t\t\t\t \n\t\t\t\t\t\t\n\t\t\t\t\t\t\t\\begin{itemize}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\\item {\\bf Suppose there is a leaf-vertex $\\ell \\in N(b_v) \\cap N(x)$.}\n\t\t\t\t\t\t\t\tBy Lemma~\\ref{claim:final-case-2}, $\\ell$ is of Type 1 or $G \\setminus \\ell$ is prime.\n\t\t\t\t\t\t\t\tIn that case, go to~\\ref{step:type-1} if $\\ell$ is of Type $1$, and go to~\\ref{step:prime-case} if $\\ell$ has Type $2$ or $3$ (in both cases, $\\ell$ takes the role of $v$).\n\t\t\t\t\t\t\t\tNote that we never go back to~\\ref{step:new-clique-sep} in such case, so the algorithm cannot loop. \n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\\item Otherwise, by Theorem~\\ref{lem:final-case-3}, there exist $y,z \\in N(b_v) \\cap N(x)$ two non-adjacent vertices, such that $G'$ is prime and planar, and $tb(G)=1$ if and only if $tb(G')=1$, where $G'$ is obtained from $G$ by adding the edge $\\{x,y\\}$. \n\t\t\t\t\t\t\t\tIn that case, Algorithm \\texttt{Leaf-BottomUp} is recursively applied on $G'$.\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\\end{itemize}\n\t\t\t\t\t\t\n\t\t\t\t\t\\end{enumerate}\n\t\t\t\t\n\t\t\t\\end{enumerate}\n\t\t\n\t\\end{enumerate} \n\t\n\\end{enumerate}\n\n\\subsection{Properties of prime planar graphs with tree-breadth one}\n\n\\subsubsection{General lemmas}\n\nWe will first investigate on general properties of prime planar graphs.\nIn particular, the following properties do not depend on the existence of a star-decomposition, therefore we do not use tree decompositions in our proofs.\nHowever, note that we refer to Definition~\\ref{def:leafVertex} in Theorem~\\ref{th:GminusVprime?}.\nFor clarity, we will separate the properties that hold for every {\\it biconnected} planar graph from those that only hold for prime planar graphs.\n\n\\paragraph{Properties of biconnected planar graphs.}\nIn order to obtain these properties, we will mostly rely on the notion of \\emph{intermediate graphs}, defined below. \n\n\\begin{definition}~\\cite[Definition 6]{Bouchitte2003}\n\\label{def:intermediate-graph}\nLet $G=(V,E)$ be a planar graph.\nWe fix a plane embedding of $G$.\nLet $F$ be the set of faces of this embedding.\nThe \\emph{intermediate graph} $G_I = (V \\cup F, E_I)$ has vertex-set $V \\cup F$,\nfurthermore $E \\subseteq E_I$ and we add an edge in $G_I$ between an original vertex $v \\in V$ and a face-vertex $f \\in F$ whenever the corresponding vertex and face are incident in $G$ (see Figure~\\ref{fig:intermediate-graph}).\n\\end{definition}\n\n\\begin{figure}[h!]\n \\centering\n \\includegraphics[width=0.5\\textwidth]{Fig/intermediate-graph.pdf}\n \\caption{A plane embedding of some planar graph (left) and the corresponding intermediate graph (right). Face-vertices are coloured in red.}\n \\label{fig:intermediate-graph}\n\\end{figure}\n\nNote that an intermediate graph is planar.\nFurthermore, since a plane embedding can be constructed in linear-time~\\cite{Hopcroft1974}, therefore so can be an intermediate graph.\nThis is important for the quadratic-time complexity of Algorithm \\texttt{Leaf-BottomUp}.\nTo prove the correctness of Algorithm \\texttt{Leaf-BottomUp} in the following, we will rely upon the following property of intermediate graphs.\n\n\\begin{lemma}~\\cite[Proposition 9]{Bouchitte2003}\n\\label{lem:prop-todinca}\nLet $S$ be a minimal separator of some biconnected planar graph $G=(V,E)$ and let $C$ be a full component of $G \\setminus S$.\nWe fix a plane embedding of $G$.\nThen $S$ corresponds to a cycle $v_S(C)$ of $G_I$, of length $2|S|$ and with $V \\cap v_S(C) = S$, and such that $G_I \\setminus v_S(C)$ has at least two connected components.\nMoreover, the original vertices of one of these components are exactly the vertices of $C$. \n\\end{lemma}\n\nIn the following, we will rely upon two properties which both follow from Lemma~\\ref{lem:prop-todinca}.\nThe first one is the following structural property of minimal separators of planar graphs.\n\n\\begin{corollary}\n\\label{cor:sep-planar}\nLet $S$ be a minimal separator of a biconnected planar graph $G=(V,E)$.\nThen, $S$ either induces a cycle or a forest of paths.\n\\end{corollary}\n\n\\begin{proof}\nLet us fix a plane embedding of $G$, let $G_I$ be the corresponding intermediate graph.\t\nThen, let $C_S$ be a smallest cycle of $G_I$ such that $V \\cap C_S = S$, that exists by Lemma~\\ref{lem:prop-todinca}.\nTo prove the corollary, it suffices to prove that $C_S$ is an induced cycle of $G_I$.\nBy contradiction, assume the existence of a chord $xy$ of $C_S$.\nNote that $x \\in S$ or $y \\in S$ because face-vertices are pairwise non-adjacent in $G_I$.\nTherefore assume w.l.o.g. that $x \\in S$. \nLet us divide $C_S$ in two cycles $C_1,C_2$ such that $C_1 \\cap C_2 = \\{x,y\\}$.\nBy the minimality of $C_S$, $S$ intersects both $C_1 \\setminus C_2$ and $C_2 \\setminus C_1$.\nTherefore, let $z_1,z_2 \\in S$ such that $z_1 \\in C_1 \\setminus C_2$ and $z_2 \\in C_2 \\setminus C_1$.\nFinally, let $A,B$ be two full components of $G \\setminus S$.\nObserve that $(A \\cup B) \\cap (C_1 \\cup C_2) = \\emptyset$ because $V \\cap C_S = S$.\nLet us contract $C_1,C_2$ in order to obtain the two triangles $(z_1,x,y)$ and $(z_2,x,y)$.\nIn such case, there is a $K_{3,3}$-minor of $G_I$ with $\\{A,B,y\\}$ and $\\{x,z_1,z_2\\}$ being the respective sides of the bipartition, thus contradicting the fact that $G_I$ is planar.\nTherefore, $C_S$ is an induced cycle of $G_I$ and so, $S$ induces a subgraph of a cycle in $G$, that is either a cycle or a forest of path.\n\\end{proof}\n\n\n\n\nOn the algorithmic side, one can also deduce from Lemma~\\ref{lem:prop-todinca} the following corollary.\n\n\\begin{corollary}\n\\label{cor:make-sep-cyc}\nLet $G$ be a biconnected planar graph, let $S$ be a minimal separator of $G$.\nThere is a planar supergraph $G_S$ of $G$ with same vertex-set so that $S$ either induces an edge (if $|S|=2$) or a cycle of $G_S$, and it can be constructed in linear-time.\n\\end{corollary}\n\n\\begin{figure}[h!]\n \\centering\n \\includegraphics[width=0.75\\textwidth]{Fig/sep-cyc-construction.pdf}\n \\caption{Addition of edges in a planar graph $G$ so as to make a minimal separator of $G$ induce a cycle.}\n \\label{fig:make-sep-cyc}\n\\end{figure}\n\n\\begin{proof}\nLet us fix a plane embedding of $G$, let $G_I$ be the corresponding intermediate graph.\nFor every face-vertex $f$ of $G_I$, let us consider $S_f = S \\cap N_{G_I}(f)$.\nWe first claim that $|S_f| \\leq 2$.\nIndeed, let $A,B$ be two full components of $G \\setminus S$, let us contract them to any two vertices $a \\in A,b \\in B$.\nThen, there is a $K_{3,|S_f|}$-minor of $G_I$ with $\\{a,b,f\\}$ and $S_f$ being the respective parts of the bipartition.\nSince $G_I$ is planar by construction, therefore, $|S_f| \\leq 2$.\n\n\nNow, the graph $G_S$ is constructed from $G$ as follows (we refer to Figure~\\ref{fig:make-sep-cyc} for an illustration of the proof).\nFor every face-vertex $f$ of $G_I$, if $S_f = (x,y)$ then we add the edge $\\{x,y\\}$ in $G_S$.\nNote that $G_S$ is a minor of $G_I$ and so, it is a planar graph.\nMoreover, by Lemma~\\ref{lem:prop-todinca} there is a cycle of $G_I$ whose original vertices are exactly $S$ and so, $S$ induces a connected subgraph of $G_S$.\nIn particular if $|S|=2$, then it must be an edge.\nElse, $|S| > 2$ and the connected subgraph $G_S[S]$ contains a cycle by construction.\nSince $S$ is a minimal separator of $G_S$ by construction and $G_S[S]$ is not acyclic, it follows from Corollary~\\ref{cor:sep-planar} that $S$ induces a cycle of $G_S$.\n\\end{proof}\n\nWe will often make use of the routine of Corollary~\\ref{cor:make-sep-cyc} in order to prove the quadratic-time complexity of Algorithm \\texttt{Leaf-BottomUp}.\n\n\\paragraph{Properties of prime planar graphs.}\nUnlike the above Corollaries~\\ref{cor:sep-planar} and~\\ref{cor:make-sep-cyc} (which hold for every biconnected planar graph), the following results only hold for prime planar graphs.\nWe will make use of the following structural properties of prime planar graphs in order to prove the correctness of Algorithm \\texttt{Leaf-BottomUp}.\n\n\\begin{lemma}\\label{lem:P3exists}\nLet $G=(V,E)$ be a prime graph that is $K_{3,3}$-minor-free. \nLet $v \\in V$, for every minimal separator $S \\subseteq N_G(v)$ of the subgraph $G \\setminus v$, $S$ consists of two non-adjacent vertices.\n\\end{lemma}\n\\begin{proof}\nLet $S \\subseteq N_G(v)$ be a minimal separator of $G \\setminus v$.\nThere must exist two full components $A$ and $B$ of $S$ in $G \\setminus (S \\cup \\{v\\})$. \nLet us remove all nodes of the components of $G \\setminus (S \\cup \\{v\\})$ but the ones in $A$ or $B$. \nThen, let us contract $A$ (resp., $B$) in a single vertex $a$ (resp., $b$). We get a $K_{3,|S|}$ as a minor of $G$ where $\\{a,b,v\\}$ is one part of the bipartition, and so $|S|\\leq 2$. \nFinally, since $S \\cup \\{v\\}$ is also a separator of $G$, then $|S| \\geq 2$ because otherwise $S \\cup \\{v\\}$ would be an edge-separator.\nTherefore, $|S| = 2$ and it is a stable set because otherwise there would be a clique-separator of size $3$ in $G$.\n\\end{proof}\n\n\\begin{lemma}\\label{lem:unique-neighbour}\nLet $G$ be a prime planar graph, let the path $\\Pi=(a,b,c)$ be a separator of $G$, and let $C$ be a component of $G \\setminus \\Pi$.\nThen, there is at most one common neighbour of $a,b$ in $C$.\n\\end{lemma}\n\n\\begin{proof}\nFirst note that $\\Pi$ is induced or else it would be a clique-separator of $G$.\t\nFurthermore, $a,c \\in N(C')$ for every component $C'$ of $G \\setminus (\\Pi \\cup C)$ or else $N(C')$ would be a clique-separator of $G$ (either a vertex-separator or an edge-separator).\nIn particular, it is always possible to make vertices $a,c$ adjacent by contracting an arbitrary component of $G \\setminus (\\Pi \\cup C)$.\n\t\n\\begin{figure}[h!]\n\t\\centering\n\t\\includegraphics[width=0.15\\textwidth]{Fig/disjoint-path-k5.pdf}\n\t\\caption{Case where the paths $Q$ and $Q'$ are internally vertex-disjoint paths.}\n\t\\label{fig:disjoint-path-k5}\n\\end{figure}\t\n\t\nBy contradiction, let $u,u' \\in N(a) \\cap N(b) \\cap C$ be distinct.\nWe claim that there exists a $uc$-path $Q$ in $C \\cup \\{c\\}$ that does not contain $u'$, because else the triangle $a,b,u'$ would separate $u$ from $\\Pi$, that contradicts the fact that $G$ is prime.\nBy symmetry, there also exists a $u'c$-path $Q'$ in $C \\cup \\{c\\}$ that does not contain $u$.\nThere are two cases.\n\n\\begin{itemize}\n\\item $Q$ and $Q'$ are internally vertex-disjoint paths (see Figure~\\ref{fig:disjoint-path-k5} for an illustration).\nLet us contract $Q \\setminus c, Q' \\setminus c$ to the vertices $u,u'$, let us contract an arbitrary component of $G \\setminus (\\Pi \\cup C)$ in order to make vertices $a,c$ adjacent, then let us contract a path from $Q$ to $Q'$ in $C$ (that exists, because $C$ is connected by the hypothesis) in order to make vertices $u,u'$ adjacent.\nThen one obtains from $a,b,c,u,u'$ a $K_5$-minor, which contradicts the fact that $G$ is planar.\n\n\\begin{figure}[h!]\n\t\\centering\n\t\\includegraphics[width=0.175\\textwidth]{Fig/not-disjoint-path-k33.pdf}\n\t\\caption{Case where the paths $Q$ and $Q'$ intersect.}\n\t\\label{fig:notdisjoint-path-k33}\n\\end{figure}\n\n\\item $Q$ and $Q'$ intersect (see Figure~\\ref{fig:notdisjoint-path-k33} for an illustration).\nLet $y \\in (Q \\cap Q') \\setminus c$ be such that the $uy$-subpath of $Q$ does not intersect $Q'$. \nLet $R$ be the $yc$-subpath of $Q'$.\nWe may assume w.l.o.g. that $R \\subseteq Q \\cap Q'$ for the remaining of the proof, whence $Q \\cap Q' = R$.\nLet us contract $Q \\setminus R, Q' \\setminus R, R \\setminus c$ in order to make vertices $u,u',c$ adjacent to vertex $y$, then let us contract an arbitrary component of $G \\setminus (P \\cup C)$ in order to make vertices $a,c$ adjacent.\nOne obtains from $a,b,c,u,u',y$ a $K_{3,3}$-minor with $\\{a,b,y\\}$ being one side of the bipartition, that contradicts the fact that $G$ is planar.\n\\end{itemize}\n\\end{proof}\n\n\\begin{lemma}\\label{lem:common-neighbour}\nLet $G$ be a prime planar graph, let the path $\\Pi=(a,b,c)$ be a separator of $G$, and let $C$ be a component of $G \\setminus \\Pi$.\nSuppose there is some vertex $v \\in C$ that is a common neighbour of $a,b,c$.\nThen, either $C$ is reduced to $v$, or $(a,v,c)$ is a separator of $G$.\nFurthermore, in the latter case, the path $(a,v,c)$ separates vertex $b$ from $C \\setminus v$.\n\\end{lemma}\n\n\\begin{proof}\nLet us assume that $C \\setminus v \\neq \\emptyset$.\nLet $D$ be a connected component of $G[C\\setminus v]$.\nNote that $v \\in N(D)$ because $C$ is a connected component of $G \\setminus \\Pi$ by the hypothesis.\nTo prove the lemma, it suffices to prove that $b \\notin N(D)$.\nBy contradiction, suppose that $b \\in N(D)$ (see Figure~\\ref{fig:common-neighbour-to-path} for an illustration).\nSince $v,b,a$ and $v,b,c$ are pairwise adjacent and $G$ has no clique-separator by the hypothesis, then necessarily $N(D) = \\{a,b,c,v\\}$.\n\n\\begin{figure}[h!]\n\t\\centering\n\t\\includegraphics[width=0.2\\textwidth]{Fig/common-neighbour-to-path.pdf}\n\t\\caption{Existence of a component $D \\subseteq C \\setminus v$ that is adjacent to $b$.}\n\t\\label{fig:common-neighbour-to-path}\n\\end{figure}\n\nLet us contract the component $D$ to a single vertex $x$.\nThen, let $C'$ be any component of $G \\setminus (\\Pi \\cup C)$.\nWe have that $a,c \\in N(C')$ or else $N(C')$ would be a clique-separator of $G$ (either a vertex-separator or an edge-separator).\nSo, let us contract the component $C'$ onto vertex $a$ in order to make $a$ and $c$ adjacent.\nOne obtains from $a,b,c,v,x$ a $K_5$-minor, which contradicts the fact that $G$ is planar.\n\\end{proof}\n\nWe recall that the gist of Algorithm \\texttt{Leaf-BottomUp} is (informally) to try to remove a leaf-vertex $v$ from $G$ then to apply recursively the algorithm on $G \\setminus v$.\nBecause the algorithm is strongly dependent on the fact that $G$ is prime, it is important to characterize the cases when $G \\setminus v$ is also prime. \nIndeed, new clique-decompositions are needed when $G \\setminus v$ is not prime, which may provoke a combinatorial explosion of the number of subgraphs to be considered.\nTherefore, before we conclude this section, let us characterize whenever there may be clique-separators in $G \\setminus v$ with $v$ being a leaf-vertex.\nThis will first require the following lemma.\n\n\\begin{lemma}\\label{lem:separatorInCompo}\nLet $G=(V,E)$ be a graph and let the path $\\Pi=(a,b,c)$ be a separator of $G$. \nLet $C$ be the union of some components of $G \\setminus \\Pi$ and let $S$ be a separator of $G[C \\cup \\Pi]$. \nThen, $S$ is a separator in $G$ or $S$ separates $a$ and $c$ in $G[C \\cup \\Pi]$.\n\nMoreover, in the latter case, $G[C \\cup \\Pi] \\setminus S$ has exactly two components $C_a$ and $C_c$ containing $a$ and $c$ respectively.\n\\end{lemma}\n\n\\begin{proof}\nThere are two cases.\n\\begin{itemize}\n\\item Suppose there exists a component $D$ of $G[C\\cup \\Pi]\t\\setminus S$ such that $N_G(D) \\subseteq C \\cup \\Pi$.\nSince $D \\cap S = \\emptyset$, $S \\neq V \\setminus D$ and $N_G(D) \\subseteq S$ therefore $S$ is a separator of $G$ with $D$ being a component of $G \\setminus S$.\n\\item Else, every component $D$ of $G[C\\cup \\Pi]\t\\setminus S$ has a neighbour in $V \\setminus (C \\cup \\Pi)$.\nThe latter implies that $D \\cap \\Pi \\neq \\emptyset$ for every component $D$ of $G[C\\cup \\Pi]\t\\setminus S$ because $C$ is a union of components of $G \\setminus \\Pi$ by the hypothesis.\nIn particular, since there exist at least two components of $G[C\\cup \\Pi]\t\\setminus S$ then there must be one containing an endpoint of $\\Pi$.\nW.l.o.g. assume there is a component $C_a$ of $G[C\\cup \\Pi]\t\\setminus S$ such that $a \\in C_a$.\nLet $C_c$ be any component of $G[C\\cup \\Pi]\t\\setminus (S \\cup C_a)$.\nWe have that $C_c \\cap N[C_a] = \\emptyset$ because $S$ separates $C_a$ and $C_c$ in $G[C \\cup \\Pi]$.\nTherefore, $a,b \\notin C_c$ and so, $c \\in C_c$ because $C_c \\cap \\Pi \\neq \\emptyset$.\nThis finally proves that $G[C \\cup \\Pi] \\setminus S$ has exactly two components $C_a$ and $C_c$ containing $a$ and $c$ respectively. \n\\end{itemize}\t\t\n\n\n\n\n\n\n\n\n\n\n\\end{proof}\n\n\\begin{theorem}\\label{th:GminusVprime?}\nLet $G = (V,E)$ be a prime planar graph, let $v$ be a leaf-vertex of Type either 2 or 3 and let $\\Pi_v = (a_v,b_v,c_v)$ be as defined in Definition~\\ref{def:leafVertex}.\nSuppose that there exists a minimal separator $S$ in $G \\setminus v$ that is a clique.\nThen, $S = \\{u_v,b_v\\}, u_v \\notin \\Pi_v$ and the following hold:\n\\begin{itemize}\n\\item $V \\setminus (\\Pi_v \\cup \\{v\\})$ is a full component of $G \\setminus \\Pi_v$.\n\\item If $u_v \\in N(a_v)$ (resp. $u_v \\in N(c_v)$), then $a_v$ (resp. $c_v$) is simplicial in $G \\setminus v$ with neighbours $\\{u_v,b_v\\}$;\n\\item Furthermore $u_v \\notin N(a_v) \\cap N(c_v)$ unless $V = \\Pi_v \\cup \\{u_v,v\\}$;\n\\end{itemize}\n\\end{theorem}\n\n\\begin{figure}[h!]\n \\centering\n \\includegraphics[width=0.75\\textwidth]{Fig/planar-clique.pdf}\n \\caption{Existence of a clique-separator in $G \\setminus v$.}\n \\label{fig:clique-reappear}\n\\end{figure}\n\n\\begin{proof}\nNote that the subgraph $G \\setminus v$ is planar and $S$ is a minimal separator of $G \\setminus v$ by the hypothesis, therefore by Corollary~\\ref{cor:sep-planar} either $S$ induces a cycle or a forest of path.\nSince in addition $S$ is a clique by the hypothesis, it follows that $S$ either induces a singleton, an edge or a triangle.\nSince $S$ is a clique and $G$ is prime, $S$ is not a separator of $G$, so by Lemma~\\ref{lem:separatorInCompo} with $C = V \\setminus (\\Pi_v \\cup \\{v\\})$, $S$ is an $a_vc_v$-separator of $G \\setminus v$.\nThis both implies that $b_v \\in S$ and $S' := S \\cup \\{v\\}$ is a minimal $a_vc_v$-separator of $G$.\nIn particular, $S$ being a strict subset of some minimal separator of $G$ it cannot induce a cycle (by Corollary~\\ref{cor:sep-planar}), hence it must induce either a singleton or an edge.\nFurthermore, still by Lemma~\\ref{lem:separatorInCompo} with $C = V \\setminus (\\Pi_v \\cup \\{v\\})$ there exist exactly two components $C_a,C_c$ of $G \\setminus (S \\cup \\{v\\})$, with $a_v \\in C_a, c_v \\in C_c$.\nAs a result, $S \\setminus b_v \\neq \\emptyset$, or else $\\{a_v,b_v\\},\\{b_v,c_v\\}$ would be edge-separators of $G$, thus contradicting the hypothesis.\nLet $S = \\{u_v,b_v\\}, u_v \\notin \\Pi_v \\cup \\{v\\}$.\nIf $u_v \\in N(a_v)$, then $C_a \\setminus a_v = \\emptyset$ (and so, $a_v$ is simplicial in $G \\setminus v$), for otherwise $(a_v,u_v,b_v)$ would be a clique-separator of $G$.\nSimilarly, if $u_v \\in N(c_v)$ then $C_c \\setminus c_v = \\emptyset$ (and so, $c_v$ is simplicial in $G \\setminus v$).\nIn particular if $u_v \\in N(a_v) \\cap N(c_v)$ then $\\Pi_v \\cup \\{u_v,v\\} = V$.\nLast, as there exists an $a_vc_v$-path in every component $C'$ of $G \\setminus (\\Pi_v \\cup \\{v\\})$ because $G$ has no clique-separator by the hypothesis, therefore $u_v \\in C'$.\nThis implies that $V \\setminus (\\Pi_v \\cup \\{v\\})$ is a full component of $G \\setminus \\Pi_v$.\n\\end{proof}\n\n\\subsubsection{Constrained star-decompositions}\n\nIn the following, it will be useful to impose additional structure on the star-decompositions.\nIn order to do that, we will prove properties on some pairs of vertices in the graph.\nNamely, we will prove that when $x,y \\in V$ satisfy a few technical conditions, then it can be assumed that $T_x \\cup T_y$ is a subtree of the star-decomposition $(T,{\\cal X})$.\n\n\\begin{lemma}\\label{lem:strong-pair}\nLet $G$ be a connected graph with $tb(G) = 1$, let $x,y \\in V(G)$ be non-adjacent (and $x \\neq y$).\n\nSuppose the pair $(x,y)$ satisfies that for every $xy$-separator $S$ of $G$, if there is $z \\notin \\{x,y\\}$ that dominates $S$ then $z \\in N_G(x) \\cap N_G(y)$.\n\nThen, there is a star-decomposition $(T,{\\cal X})$ of $G$ with $B_x,B_y \\in {\\cal X}$, $x \\in B_x, y \\in B_y$ and either $B_x = B_y$ or $B_x,B_y$ are adjacent in $T$.\nMoreover, in the latter case, $B_x \\subseteq N[x], B_y \\subseteq N[y]$.\n\\end{lemma}\n\n\\begin{proof}\nConsider a star-decomposition $(T,{\\cal X})$ of $G$, that exists by Lemma~\\ref{lem:dominator-in-bag}. \nIf $x$ and $y$ are not in a same bag, let $B_x$ and $B_y$ be the bags containing respectively $x$ and $y$ and as close as possible in $T$. \nBy the properties of a tree decomposition, $N(x) \\cap N(y) \\subseteq B_x \\cap B_y$. \nHence, for any bag $B$ between $B_x$ and $B_y$ in $T$, $N(x) \\cap N(y) \\subseteq B$.\n\n\\begin{itemize}\n\\item\n {\\bf Case 1:} If $B_x$ and $B_y$ are not adjacent in $T$, let $B$ be any bag in the path between $B_x$ and $B_y$ in $T$.\n By the properties of a tree decomposition, $B$ is an $xy$-separator.\n Moreover, let $z \\in B$ dominate the bag, by the hypothesis $z \\in N(x) \\cap N(y)$ because $x,y \\notin B$.\n As a result, adding $x$ and $y$ in each bag $B$ between $B_x$ and $B_y$ achieves a star-decomposition of $G$ that has a bag containing both $x,y$.\n\n\\medskip\n\\noindent \n \\item \n{\\bf Case 2:} Now, let us assume that $B_x$ and $B_y$ are adjacent in $T$. \nNote that, if $B_x \\subseteq N[z]$ for some $z \\in N(x) \\cap N(y)$ (resp., if $B_y \\subseteq N[z]$ for some $z \\in N(x) \\cap N(y)$) the result holds. \nIndeed, adding $y$ in $B_x$ (resp., $x$ in $B_y$) achieves a star-decomposition of $G$ that has a bag containing both $x,y$.\n\nSo, let us consider the case when none of the two bags $B_x, B_y$ is dominated by a vertex of $N(x) \\cap N(y)$.\nThen, $B_x \\setminus x$ and $B_y \\setminus y$ are $xy$-separators by the properties of a tree decomposition.\nLet $z_x \\in B_x, z_y \\in B_y$ satisfy $B_x \\subseteq N[z_x]$ and $B_y \\subseteq N[z_y]$.\nBy the hypothesis, $z_x \\in \\{x\\} \\cup (N(x) \\cap N(y))$ and $z_y \\in \\{y\\} \\cup (N(x) \\cap N(y))$.\nThus it follows that $z_x = x$ and $z_y = y$ (or else, we are back to Case 1).\nNote that $B_x \\cap B_y = N(x) \\cap N(y)$ in such a case.\n\\end{itemize}\n\\end{proof}\n\nWe will mostly use the following two weaker versions of Lemma~\\ref{lem:strong-pair} in our proofs.\n\n\\begin{corollary}\n\\label{cor:strong-sep}\nLet $G$ be a connected graph with $tb(G) = 1$, let $x,y \\in V(G)$ be non-adjacent (and $x \\neq y$).\n\nSuppose there exists a minimal separator $S\\subseteq (N(x) \\cap N(y)) \\cup \\{x,y\\}$ in $G$ and $\\{x,y\\} \\subseteq S$.\n\nThen, there is a star-decomposition $(T,{\\cal X})$ of $G$ with $B_x,B_y \\in {\\cal X}$, $x \\in B_x, y \\in B_y$ and either $B_x = B_y$ or $B_x,B_y$ are adjacent in $T$.\nMoreover, in the latter case, $B_x \\subseteq N[x], B_y \\subseteq N[y]$.\n\\end{corollary}\n\n\\begin{proof}\nWe claim that for every $xy$-separator $S'$ of $G$, if there is $z \\notin \\{x,y\\}$ such that $S' \\subseteq N[z]$ then $z \\in N(x) \\cap N(y)$.\nObserve that if the claim holds, then the corollary follows from Lemma~\\ref{lem:strong-pair}.\nTo prove the claim, let $S \\subseteq (N(x) \\cap N(y)) \\cup \\{x,y\\}$ be a separator of $G$ and $\\{x,y\\} \\subseteq S$, that exists by the hypothesis.\nNote that for any full component $C$ of $G \\setminus S$, the $xy$-separator $S'$ must contain some vertex in $C$.\nSince there are at least two full components of $G \\setminus S$, then $z \\in S \\setminus (x,y) \\subseteq N(x) \\cap N(y)$, that finally proves the claim.\n\\end{proof}\n\nSo far, the two above results in this section (Lemma~\\ref{lem:strong-pair} and Corollary~\\ref{cor:strong-sep}) apply to \\emph{general} graphs with tree-breadth one.\nHowever, we will need the fact that the graph is planar for the following corollary. \n\n\\begin{corollary}\n\\label{cor:strong-three}\nLet $G$ be a connected graph with $tb(G) = 1$, let $x,y \\in V(G)$ be non-adjacent (and $x \\neq y$).\n\nSuppose $G$ is $K_{3,3}$-minor-free and $|N_G(x) \\cap N_G(y)| \\geq 3$.\n\nThen, there is a star-decomposition $(T,{\\cal X})$ of $G$ with $B_x,B_y \\in {\\cal X}$, $x \\in B_x, y \\in B_y$ and either $B_x = B_y$ or $B_x,B_y$ are adjacent in $T$.\nMoreover, in the latter case, $B_x \\subseteq N[x], B_y \\subseteq N[y]$.\n\\end{corollary}\n\n\\begin{proof}\nWe claim that for every $xy$-separator $S$ of $G$, if there is $z \\notin \\{x,y\\}$ such that $S \\subseteq N[z]$ then $z \\in N(x) \\cap N(y)$.\nObserve that if the claim holds, then the corollary follows from Lemma~\\ref{lem:strong-pair}.\nTo prove the claim, first recall that $|N(x) \\cap N(y)| \\geq 3$.\nSince vertex $z$ dominates $S$ and $S$ is an $xy$-separator, therefore, $z$ dominates $N(x) \\cap N(y)$ because $N(x) \\cap N(y) \\subseteq S$. \nIn such case, $z \\in N(x) \\cap N(y)$, or else, $G$ admits a $K_{3,|N(x) \\cap N(y)|}$-minor with $\\{x,y,z\\}$ and $N(x) \\cap N(y)$ being the respective of the bipartition, which contradicts the hypothesis.\n\\end{proof}\n\nBefore we conclude this section, let us emphasize a useful consequence of Corollary~\\ref{cor:strong-sep} regarding minimal $2$-separators.\n\n\\begin{lemma}\\label{lem:2-separator}\nLet $G=(V,E)$ with $tb(G) = 1$, let $x,y \\in V$ be non-adjacent such that $S = \\{x,y\\}$ is a minimal separator of $G$ ($x \\neq y$).\nFor every full component $C$ of $G \\setminus S$, we have that $N(x) \\cap N(y) \\cap C \\neq \\emptyset$.\n\\end{lemma}\n\n\\begin{proof}\nLet $(T,{\\cal X})$ be a star-decomposition of $G$, that exists by Lemma~\\ref{lem:dominator-in-bag}, minimizing the distance in $T$ between the subtrees $T_x$ and $T_y$ (respectively induced by the bags containing $x$ and $y$).\nThere are two cases.\n\\begin{itemize}\n\\item First, suppose that $T_x \\cap T_y \\neq \\emptyset$.\nFor any full component $C$ of $G \\setminus S$, let $T_C$ be the subtree that is induced by all bags intersecting $C$.\nBecause $C$ is a full component, there must be an edge between $x$ and a vertex of $C$, and this edge is in a bag of $T_x \\cap T_C$.\nSimilarly, there must be an edge between $y$ and a vertex of $C$, and this edge is in a bag of $T_y \\cap T_C$.\nAs a result, the subtrees $T_x,T_y,T_C$ are pairwise intersecting, and so by the Helly property (Lemma~\\ref{lem:helly}) $T_x \\cap T_y \\cap T_C \\neq \\emptyset$ {\\it i.e.}, there exists a bag $X_t$ which contains $S$ and it intersects $C$.\nLet $z \\in X_t$ dominate the bag.\nNote that $z \\in C \\cup S$ because it has to dominate some vertices in $C$ and so, it cannot be in $V \\setminus (C \\cup S)$.\nFurthermore, recall that $x,y$ are non-adjacent by the hypothesis.\nTherefore, $z \\in C \\cap N(x) \\cap N(y)$, and the result holds for any full component $C$ of $G \\setminus S$.\n\\item Else, since $S = \\{x,y\\}$ is a minimal separator and we assume $(T,{\\cal X})$ to minimize the distance in $T$ between $T_x$ and $T_y$, by Corollary~\\ref{cor:strong-sep} there are two adjacent bags $B_x,B_y$ such that $x \\in B_x \\setminus B_y$ dominates $B_x$, $y \\in B_y \\setminus B_x$ dominates $B_y$.\nSince $B_x \\cap B_y$ is an $xy$-separator by the properties of a tree-decomposition, then $B_x \\cap B_y \\cap C \\neq \\emptyset$ for every full component $C$ of $G  \\setminus S$, that is $N(x) \\cap N(y) \\cap C \\neq \\emptyset$.\n\\end{itemize}\\end{proof}\n\n\\subsubsection{Bounded Treewidth}\n\nIndependently from Algorithm \\texttt{Leaf-BottomUp}, let us introduce in this section another property of (not necessarily prime) planar graphs with tree-breadth one.\nMore precisely, we prove these graphs have bounded treewidth.\nTo prove this property, we will use the same terminology as for the previous subsections. \n\n\\begin{lemma}\n\\label{lem:tw-planar-tb-1}\nLet $G$ be planar with $tb(G) \\leq 1$.\nThen, $tw(G) \\leq 4$ and the upper-bound is sharp.\n\\end{lemma}\n\n\\begin{figure}[h!]\n \\centering\n \\includegraphics[width=0.25\\textwidth]{Fig/tb-1-tw-4.pdf}\n \\caption{A planar graph $G$ with $tb(G) = 1$ and $tw(G) = 4$.}\n \\label{fig:tb-1-tw-4}\n\\end{figure}\n\n\\begin{proof}\nThe treewidth of $G$ is the maximum treewidth of its atoms~\\cite{Bodlaender2005}, so, let us assume $G$ to be a prime planar graph.\nLet $(T,{\\cal X})$ be any star-decomposition of $G$, the graph $H = (V,\\{ \\{u,v\\} \\mid T_u \\cap T_v \\neq \\emptyset  \\})$ is chordal.\nFurthermore, if $H'$ is a chordal graph with same vertex-set $V$ and such that $E(G) \\subseteq E(H') \\subseteq E(H)$ then any clique-tree of $H'$ is still a star-decomposition of $G$.\nTherefore, we will assume w.l.o.g. that $H$ is a minimal triangulation of $G$ and $(T,{\\cal X})$ is a clique-tree of $H$ (in particular, $(T,{\\cal X})$ is reduced). \nAdditional properties of $(T,{\\cal X})$ will be deduced from the latter assumption about $H$ by using the results from~\\cite{Bouchitte2002}.\nLet us now prove the lemma by induction on $|V(G)|$ (the base-case of the graph with a single vertex is trivial).\n\\begin{itemize}\n\\item If $|{\\cal X}| = 1$, then $G$ has some universal vertex $u$.\nFurthermore, since $G$ is planar therefore, $G \\setminus u$ is outerplanar~\\cite{Syslo1979}.\nConsequently, $tw(G \\setminus u) \\leq 2$~\\cite{Bodlaender1998}, so, $tw(G) \\leq 3$.\n\\item Suppose $|{\\cal X}| = 2$. \nLet ${\\cal X} = \\{B,B'\\}$.\nSince $(T,{\\cal X})$ is assumed to be a clique-tree of some minimal triangulation $H$ of $G$, therefore, $B \\cap B'$ is a minimal separator~\\cite{Bouchitte2002}.\nLet us remind that by Corollary~\\ref{cor:make-sep-cyc} there is a planar supergraph $G'$ of $G$ with same vertex-set so that $B \\cap B'$ induces either an edge or a cycle of $G'$.\nFurthermore $(T,{\\cal X})$ is also a star-decomposition of $G'$, so, $tb(G') \\leq 1$.\nIn addition, $tw(G) \\leq tw(G')$.\nRecall that we can further assume $G'$ to be prime (or else, we apply the induction hypothesis on the atoms of $G'$), hence $B  \\cap B'$ induces a cycle of $G'$ of length at least four.\nLet $B \\Delta B' = (B \\setminus B') \\cup (B' \\setminus B)$.\n\nSince $H$ is assumed to be a minimal triangulation and $B,B'$ are leaves of a clique-tree of $H$, therefore, $B \\setminus B'$ is a (nonempty) dominating clique of the subgraph $G[B]$, and similarly $B' \\setminus B$ is a (nonempty) dominating clique of the subgraph $G[B']$~\\cite{Bouchitte2002}.\nThus, every vertex $u \\in B \\Delta B'$ satisfies $B \\cap B' \\in N(u)$.\nSince $|B \\cap B'| \\geq 4$ because $B \\cap B'$ induces a cycle of $G'$ of length at least four, therefore, $|B \\Delta B'| \\leq 2$ or else there would be a $K_{3,3}$-minor of $G'$ with any three vertices of $B \\cap B'$ being one part of the bipartition.\n\nAs a result, since $B \\cap B'$ induces a cycle, $tw(G) \\leq tw(G') \\leq 2 + |B \\Delta B'| = 4$.\n\\item Finally, suppose $|{\\cal X}| \\geq 3$. \nLet $t \\in V(T)$ be an internal node, by the properties of a tree decomposition the bag $X_t$ is a separator of $G$.\nLet $b \\in X_t$ satisfy $X_t \\subseteq N_G[b]$.\nSince $G$ is prime and so, biconnected, therefore $X_t \\setminus b$ is a separator of $G \\setminus b$.\nIn such case, let us remind by Lemma~\\ref{lem:P3exists} that there exist $a,c \\in X_t \\setminus b$ non-adjacent such that $\\{a,c\\}$ is a minimal separator of $G \\setminus b$.\nIn particular, the path $\\Pi = (a,b,c)$ is a separator of $G$.\nLet $C_1, C_2, \\ldots, C_l$ be the components of $G \\setminus \\Pi$.\nFor every $1 \\leq i \\leq l$, let $G_i$ be obtained from $G[C_i \\cup \\Pi]$ by making the two endpoints $a,c$ of $\\Pi$ adjacent.\nNote that $G_i$ can be obtained from $G$ by edge-contractions (because $G$ is prime and so, $a,c \\in N(C_j)$ for every $1 \\leq j \\leq l$), therefore, $tb(G_i) \\leq 1$ because tree-breadth is stable under edge-contractions (Lemma~\\ref{lem:contraction-closed}).\nIn addition, $tw(G) \\leq \\max_i tw(G_i)$ because $\\Pi$ induces a triangle in every graph $G_i$ by construction.\nAs a result, for every $1 \\leq i \\leq l$, since $|V(G_i)| < |V(G)|$ by construction, therefore $tw(G_i) \\leq 4$ by the induction hypothesis, whence $tw(G) \\leq 4$.\n\\end{itemize}\nLet $G$ be constructed from the cycle $(u,v,x,y)$ of length four by adding two vertices $a,b$ such that $N_G(a) = N_G(b) = \\{u,x,v,y\\}$ (see Figure~\\ref{fig:tb-1-tw-4} for an illustration).\nSince there exists a star-decomposition of $G$ with two bags (respectively dominated by $a,b$), $tb(G) \\leq 1$.\nMoreover, $G$ is $4$-regular by construction, therefore $tw(G) \\geq 4$~\\cite{Bodlaender2005}.\nThis proves the sharpness of the upper-bound. \n\\end{proof}\n\nNote that since it is well-known that many difficult problems can be solved on bounded-treewidth graphs in linear-time, therefore, it may be the case that the recognition of planar graphs with tree-breadth at most one can be simplified by using Lemma~\\ref{lem:tw-planar-tb-1}.\nHowever, we were unable to find a way to use it in our proofs (actually, the star-decomposition that can be computed using our algorithm may have unbounded width --- because of leaf-vertices of Type 1).\n\n\\subsection{Correctness of Algorithm \\texttt{Leaf-BottomUp} }\n\n\\subsubsection{Existence of a $P_3$-separator}\n\nAs a first step to prove correctness of Algorithm \\texttt{Leaf-BottomUp}, let us prove correctness of~\\ref{step:find-leaf-vertex}.\nThat is, we will prove that for every planar graph $G$ with $tb(G) = 1$, $G$ contains a leaf-vertex or $G$ admits a star-decomposition with at most two bags. \n\nTo prove this step, we will prove additional properties of the minimal separators of prime planar graphs with tree-breadth one.\nIn the following, let ${\\cal P}_3(G)$ be the set of (not necessarily minimal) separators of $G$ that induce paths of length $2$ (we will call them $P_3$-separators since they have three vertices).\nWe will distinguish the case when ${\\cal P}_3(G) \\neq \\emptyset$ from the case when ${\\cal P}_3(G) = \\emptyset$.\n\n\\begin{theorem}\\label{th:noP3}\nLet $G$ be a prime planar graph with $tb(G) = 1$. If ${\\cal P}_3(G) \\neq \\emptyset$, then $G$ has a leaf-vertex.\n\\end{theorem}\n\n\\begin{proof}\nLet $\\Pi =(a,b,c) \\in {\\cal P}_3(G)$ minimize the size of a smallest component of $G \\setminus \\Pi$.\nWe recall that $\\{a,c\\} \\notin E(G)$ because $G$ is assumed to be prime by the hypothesis (the latter fact will be used in the following).\nLet $C$ be any component of $G \\setminus \\Pi$ of minimum size.\nOur aim is to prove the existence of some leaf-vertex $v \\in C$ (the latter dominating the component $C$), that will prove Theorem~\\ref{th:noP3}.\n\n\\begin{claim}\n\\label{claim:path-min-pty}\nThere do not exist $\\Pi' \\subseteq \\Pi \\cup C, \\ C' \\subset C$ such that $\\Pi' \\in {\\cal P}_3(G)$ and $C'$ is a component of $G \\setminus \\Pi'$.\t\n\\end{claim}\n\n\\begin{proofclaim}\nThe claim follows from the minimality of $C$.\t\n\\end{proofclaim}\n\nWe will often use Claim~\\ref{claim:path-min-pty} in the remaining of the proof.\n\nLet $(T,{\\cal X})$ be a star-decomposition of $G$, that exists by Lemma~\\ref{lem:dominator-in-bag}.\nIn particular, let $T_a,T_c$ be the subtrees that are respectively induced by the bags containing $a$ or $c$.\nAssume w.l.o.g. that $(T,{\\cal X})$ minimizes the distance in $T$ between the subtrees $T_a$ and $T_c$.\nWe will distinguish the case $T_a \\cap T_c \\neq \\emptyset$ from the case $T_a \\cap T_c = \\emptyset$.\n\n\\paragraph{Case $T_a \\cap T_c \\neq \\emptyset$.}\nIn such case, the subtrees $T_a,T_b,T_c$ are pairwise intersecting and so, by the Helly property (Lemma~\\ref{lem:helly}) $T_a \\cap T_b \\cap T_c \\neq \\emptyset$.\nLet us remove all vertices in $V \\setminus (\\Pi \\cup C)$ from bags in $(T,{\\cal X})$.\nLet us call $(T,{\\cal X}^C)$ the resulting tree decomposition of $G[\\Pi \\cup C]$.\n\n\\begin{claim}\n\\label{claim:induced-star-dec}\n$(T,{\\cal X}^C)$ has breadth one.\n\\end{claim}\n\n\\begin{proofclaim}\nThere are two cases to be considered.\n\\begin{itemize}\n\t\\item If $b$ has some neighbour in $C$, then $C$ must be a full component of $G \\setminus \\Pi$, or else one of $\\{a,b\\},\\{b,c\\}$ should be a clique-separator thus contradicting the fact that $G$ is prime by the hypothesis.\n\tIn such case, the claim follows from Lemma~\\ref{lem:sep-keep}.\n\t\\item Else, $b$ has no neighbour in $C$, and let $D$ be the connected component of $b$ in $G \\setminus (a,c)$.\n\tLet $H$ be obtained from $G$ by contracting $D$ to $b$.\n\tBy Lemma~\\ref{lem:contraction-closed}, $tb(H) = 1$.\n\tLet $(T,{\\cal X}^H)$ be the tree decomposition of breadth one of $H$ where for every $t \\in V(T), \\ X^H_t = X_t$ if $X_t \\cap D = \\emptyset, \\ X^H_t = (X_t \\setminus D) \\cup \\{b\\}$ else.\n\tMoreover, since $b$ has no neighbour in $C$, $D \\cap N_G[C] = \\emptyset$ and so, $H[C \\cup \\Pi] = G[C \\cup \\Pi]$ by construction.\n\tFinally, since $\\{b\\}$ is a full component of $H \\setminus (a,c)$, therefore, by Lemma~\\ref{lem:sep-keep} applied to $H$, the tree decomposition $(T,{\\cal X}^C)$ is indeed a tree decomposition of breadth one of $G[C \\cup \\Pi]$.\n\\end{itemize}\n\\end{proofclaim}\n\n\nLet $(T',{\\cal X}')$ be any reduced tree decomposition obtained from  $(T,{\\cal X}^C)$.\nWe point out that $T'_a \\cap T'_b \\cap T'_c \\neq \\emptyset$ by construction (because $T_a \\cap T_b \\cap T_c \\neq \\emptyset$). \nFurthermore, since by Claim~\\ref{claim:induced-star-dec}  $(T,{\\cal X}^C)$ has breadth one, therefore $(T',{\\cal X}')$ is a star-decomposition of $G[C \\cup \\Pi]$ by Lemma~\\ref{lem:dominator-in-bag}.\n\nWe will prove that $C$ contains a leaf-vertex by contradiction. \nInformally, we will show, using the properties of the star-decomposition $(T',{\\cal X}')$, that if it is not the case that $C$ contains a leaf-vertex, then ${\\cal P}_3(G[C \\cup \\Pi]) \\cap {\\cal P}_3(G) \\neq \\emptyset$ and the latter contradicts Claim~\\ref{claim:path-min-pty}.\n\n\\medskip\n\\noindent\nIn order to prove this, first note that $a$ has at least one neighbour in $C$ because $G$ is prime by the hypothesis (indeed, $(b,c)$ cannot be an edge-separator of $G$).\nWe now distinguish between several subcases.\n\\begin{itemize}\n\\item {\\bf Case 1.} There is $u \\in C$ such that $u \\in N(a) \\cap N(b) \\cap N(c)$ ({\\it e.g.}, see Figure~\\ref{fig:fig:leaf-1}).\nBy Lemma~\\ref{lem:common-neighbour}, either $C$ is reduced to $u$ or there exist $\\Pi' = (a,u,c) \\in {\\cal P}_3(G), \\ C' \\subseteq C \\setminus u$ and $C'$ is a component of $G \\setminus \\Pi'$.\nThe latter case contradicts Claim~\\ref{claim:path-min-pty}, therefore, $C$ is reduced to $u$ and so $u$ is a leaf-vertex of Type 2.\n\n\\begin{figure}[h!]\n \\centering\n \\includegraphics[width=0.125\\textwidth]{Fig/leaf-exists-2.pdf}\n \\caption{Case 1}\n \\label{fig:fig:leaf-1}\n\\end{figure}\n\nThus, from now on let us assume that no such vertex $u$ exists.\n\n\\item {\\bf Case 2.} By contradiction, assume $N(a) \\cap C \\subseteq N(b) \\cap C$.\nBy Lemma~\\ref{lem:unique-neighbour}, $| N(a) \\cap N(b) \\cap C | \\leq 1$, so, $|N(a) \\cap C| = 1$. \nLet $u \\in N(a) \\cap N(b) \\cap C$ be the unique neighbour of vertex $a$ in $C$ (see Figure~\\ref{fig:fig:leaf-2}).\nSince in such case we can assume that $u \\notin N(c)$ (for otherwise, we are back to Case 1), and vertex $c$ has some neighbour in $C$ because $G$ is prime (and so, $(a,b)$ cannot be an edge-separator of $G$), therefore, $C$ is not reduced to vertex $u$.\nThen, $\\Pi' = (u,b,c) \\in \\mathcal{P}_3(G)$ because it separates $a$ from $C \\setminus u$, and so there is at least one component of $G \\setminus \\Pi'$ that is strictly contained into $C$ by construction.\nThis contradicts Claim~\\ref{claim:path-min-pty}, so, Case 2 cannot occur.\n\n\\begin{figure}[h!]\n \\centering\n \\includegraphics[width=0.15\\textwidth]{Fig/leaf-exists-1.pdf}\n \\caption{Case 2}\n \\label{fig:fig:leaf-2}\n\\end{figure}\n\n\\item {\\bf Case 3.} There is $u \\in C$ satisfying $u \\in N(a) \\setminus N(b)$.\nBy the properties of a tree decomposition, there is some bag $B' \\in T'_a \\cap T'_u$.\nLet $v \\in B'$ dominate the bag $B'$.\nBy construction, $v \\neq b$ because $u \\in B' \\setminus N(b)$, similarly $v \\neq c$ because $a \\in B' \\setminus N(c)$.\nWe will also prove later that $v \\neq a$.\nMoreover, $\\Pi \\setminus N[v] \\neq \\emptyset$ (or else, we are back to Case 1), hence $\\Pi \\setminus B' \\neq \\emptyset$.\nSo let $B$ be the bag adjacent to $B'$ onto the unique path in $T'$ from $B'$ to $T'_a \\cap T'_b \\cap T'_c$ (we remind that the latter subtree is nonempty by construction).\nBy the properties of the tree decomposition $(T',{\\cal X}')$, $B \\cap B'$ is a separator of $G[C \\cup \\Pi]$.\nFurthermore, $a \\in B \\cap B'$.\nMore generally $\\Pi \\cap B' \\subseteq B \\cap B'$ by construction, therefore $B \\cap B'$ is also a separator of $G$ by Lemma~\\ref{lem:separatorInCompo}.\nLet $w \\in B$ dominate this bag. \nObserve that $w \\neq c$ because $a \\in B \\cap B'$.\n\nWe will prove that $v \\in C$  and $v$ is a leaf-vertex.\nIn order to prove these two results, we will need to prove that $C \\cup \\Pi$ is fully contained into the two adjacent bags $B,B'$ (Claim~\\ref{claim:subgraph-two-bags}).\nThe latter will require intermediate claims.\n\n\\begin{claim}\n\\label{claim:c-is-in-intersection}\n$c \\in B \\cap B'$.\n\\end{claim}\n\n\\begin{proofclaim}\nAssume for the sake of contradiction that $c \\notin B \\cap B'$ (see Figure~\\ref{fig:fig:leaf-3}).\nThen, $c \\notin B'$ because $\\Pi \\cap B' \\subseteq B \\cap B'$ by construction.\nWe will prove that the latter contradicts Claim~\\ref{claim:path-min-pty}.\n\nIndeed, first observe that $G \\setminus w$ is connected because $G$ is prime and so, biconnected, by the hypothesis.\nIn addition $(B \\cap B') \\setminus w$ is a (not necessarily minimal) separator of $G \\setminus w$ because it separates $B' \\setminus B$ from $c$.\nLet $S \\subseteq (B \\cap B') \\setminus w$ be a minimal separator of $G \\setminus w$.\nBy Lemma~\\ref{lem:P3exists}, there exist $x,y \\in (B \\cap B') \\setminus w$ non-adjacent such that $S = \\{x,y\\}$, and so, $\\Pi'=(x,w,y) \\in \\mathcal{P}_3(G)$.\nNote that $\\Pi' \\neq \\Pi$, because we assume that $c \\notin B \\cap B'$ and so $c \\notin \\{x,y\\}$. \nMoreover, since $(T',{\\cal X}')$ is a star-decomposition of $G[C\\cup \\Pi]$ by construction we have that $\\Pi' \\subseteq \\Pi \\cup C$, therefore $x \\in C$ or $y \\in C$, because $c \\notin \\{x,y\\}$ and $a,b$ are adjacent whereas $x,y$ are non-adjacent.\nW.l.o.g. let $x \\in C$.\n\n\\begin{figure}[h!]\n\t\\centering\n\t\\includegraphics[width=0.25\\textwidth]{Fig/leaf-exists-3.pdf}\n\t\\caption{Case $c \\notin B \\cap B'$}\n\t\\label{fig:fig:leaf-3}\n\\end{figure}\n\n\\begin{subclaim}\n\t\\label{claim:new-path-separator}\n\t$\\Pi'$ is not an $ac$-separator.\n\\end{subclaim}\n\n\\begin{proofsubclaim}\t\nWe refer to Figure~\\ref{fig:fig:leaf-3prime} for an illustration of the proof.\t\nLet $C'$ be any component of $G \\setminus (\\Pi \\cup C)$.\nObserve that $C'$ is fully contained into some component $D$ of $G \\setminus \\Pi'$, because $\\Pi' \\subseteq \\Pi \\cup C$.\nIn addition, $a,c \\in N(C')$ because $G$ is prime by the hypothesis (and so, neither $a$ nor $b$ nor $c$ nor $(a,b)$ nor $(b,c)$ can be a separator of $G$).\nIn particular, since we assume $c \\notin B \\cap B'$ and so, $c \\notin \\Pi'$, therefore, $c \\in D$.\nAs a result, either $a \\in \\Pi'$ or $a,c \\in D$, that finally proves the subclaim. \n\\end{proofsubclaim}\n\n\\begin{figure}[h!]\n\t\\centering\n\t\\includegraphics[width=0.2\\textwidth]{Fig/fig-claim3-thm-leaf.pdf}\n\t\\caption{$\\Pi'$ is not an $ac$-separator.}\n\t\\label{fig:fig:leaf-3prime}\n\\end{figure}\n\nLet $D$ be the component of $G \\setminus \\Pi'$ such that $c \\in D$, that exists because we assume $c \\notin B \\cap B'$ and so, $c \\notin \\Pi'$.\nSince $b,c$ are adjacent and $\\Pi'$ is not an $ac$-separator by Claim~\\ref{claim:new-path-separator}, therefore, $\\Pi \\subseteq \\Pi' \\cup D$.\n\nMoreover, let us show that Claim~\\ref{claim:new-path-separator} implies the existence of some $D' \\subset C$ being a component of $G \\setminus \\Pi'$, thus contradicting Claim~\\ref{claim:path-min-pty}.\nIndeed, let $D'$ be any component of $G \\setminus (\\Pi' \\cup D)$.\nSince $G$ is prime by the hypothesis, $x$ has some neighbour in $D'$ and so, $D' \\cap C \\neq \\emptyset$ because $x \\in C$ and $\\Pi \\cap D' = \\emptyset$ by construction.\nBut then, $D' \\subseteq C \\setminus x$, for the existence of some $z \\in D' \\setminus C$ would imply that $D' \\cap \\Pi \\neq \\emptyset$.\n\nTo sum up, we conclude that it must be the case that $c \\in B \\cap B'$.\n\\end{proofclaim}\n\n\nWe will use Claim~\\ref{claim:c-is-in-intersection} to prove that $v \\in C$, as follows:\n\n\\begin{claim}\n\\label{claim:v-in-c}\n$v \\in C$.\nFurthermore, the two vertices $b,v$ are non-adjacent.\n\\end{claim}\n\n\\begin{proofclaim}\nRecall that $v \\in C \\cup \\Pi$ because $(T',{\\cal X}')$ is a star-decomposition of $G[C \\cup \\Pi]$ by construction.\t\nSo we will only need to prove that $v \\notin \\Pi$.\nFirst, since $a \\in B \\cap B'$ by construction and  $c \\in B \\cap B'$ by Claim~\\ref{claim:c-is-in-intersection}, therefore, $a,c \\in B' \\subseteq N[v]$.\nThe latter implies that $v \\notin \\{a,c\\}$ because $a,c \\in N[v]$ whereas $a,c$ are non-adjacent.\nFurthermore, this implies $b \\notin N[v]$ because we assume that $\\Pi \\not\\subseteq N[v]$ (for otherwise, we are back to Case 1).\nAs a result, $v \\notin \\Pi$, whence $v \\in C$. \n\\end{proofclaim}\n\n\nThen, we will need the following technical claim in order to prove that $w=b$ (Claim~\\ref{claim:w-equals-b}).\n\n\\begin{claim}\n\\label{claim:subgraph-prime}\n$G[C \\cup \\Pi]$ is prime.\n\\end{claim}\n\n\\begin{proofclaim}\nSuppose by contradiction there exists a clique-separator $S$ of $G[C \\cup \\Pi]$.\nThen, $S$ could not be a separator of $G$ because $G$ is prime by the hypothesis.\nBy Lemma~\\ref{lem:separatorInCompo}, the latter implies that $S$ is an $ac$-separator of $G[C \\cup \\Pi]$.\nTherefore, the two vertices $b,v \\in N(a) \\cap N(c)$ must be in $S$, and so, since $b,v$ are non-adjacent by Claim~\\ref{claim:v-in-c}, the latter contradicts the fact that $S$ is a clique.\n\\end{proofclaim} \n\n\\begin{claim}\n\\label{claim:w-equals-b}\n$w = b$.\n\\end{claim}\n\n\\begin{proofclaim}\nAssume for the sake of contradiction $w \\neq b$ (see Figure~\\ref{fig:fig:leaf-4}).\nWe will prove that it contradicts Claim~\\ref{claim:path-min-pty}.\n\nIndeed, the graph $G[C \\cup \\Pi] \\setminus w$ is connected because $G[C \\cup \\Pi]$ is prime by Claim~\\ref{claim:subgraph-prime} and so, biconnected.\nIn addition, $(B \\cap B') \\setminus w$ is a (not necessarily minimal) separator of $G[C \\cup \\Pi] \\setminus w$ because it separates $b$ from $B' \\setminus B$ (recall that $b,v$ are non-adjacent by Claim~\\ref{claim:c-is-in-intersection}, and so, $b \\notin B' \\subseteq N[v]$). \nLet $S \\subseteq (B \\cap B') \\setminus w$ be a minimal separator of $G[C \\cup \\Pi] \\setminus w$. \nBy Lemma~\\ref{lem:P3exists}, there exist $x,y \\in (B \\cap B') \\setminus w$ non-adjacent such that $S = \\{x,y\\}$, and so, $\\Pi'=(x,w,y) \\in \\mathcal{P}_3(G[C \\cup \\Pi])$.\nFurthermore, $b \\notin \\Pi' \\subseteq (B \\cap B') \\cup \\{w\\} \\subseteq N[v] \\cup \\{w\\}$ and so, $\\Pi'$ cannot be an $ac$-separator of $G[C \\cup \\Pi]$, whence by Lemma~\\ref{lem:separatorInCompo} $\\Pi'$ is a separator of $G$, and so, $\\Pi' \\in \\mathcal{P}_3(G)$.\n\n\\begin{figure}[h!]\n\t\\centering\n\t\\includegraphics[width=0.25\\textwidth]{Fig/leaf-exists-4.pdf}\n\t\\caption{Case $c \\in B \\cap B'$ and $w \\neq b$.}\n\t\\label{fig:fig:leaf-4}\n\\end{figure}\n\nLet $D \\subseteq C \\cup \\Pi$ be the component of $G[C \\cup \\Pi] \\setminus \\Pi'$ containing vertex $b$.\nNote that $\\Pi \\subseteq D \\cup \\Pi'$ because $\\Pi'$ is not an $ac$-separator of $G[C \\cup \\Pi]$.\nLet $D'$ be any component of $G[C \\cup \\Pi] \\setminus (\\Pi' \\cup D)$, that exists because $\\Pi' \\in \\mathcal{P}_3(G[C \\cup \\Pi])$.\nSince $N(D') \\subseteq C \\cup \\Pi$ by construction, $D' \\cap \\Pi = \\emptyset$ by construction and $D'$ is a component of $G[C \\cup \\Pi] \\setminus \\Pi'$, therefore, $D'$ is also a component of $G \\setminus \\Pi'$.\nThe latter contradicts Claim~\\ref{claim:path-min-pty} because $D' \\subset C$.\n\\end{proofclaim}\n\nLet $S = \\{v,b\\} \\cup (B \\cap B')$.\nWe are now able to prove that $S = C \\cup \\Pi$ (Claim~\\ref{claim:subgraph-two-bags}).\nThat is, $C \\cup \\Pi$ is fully contained in the two adjacent bags $B,B'$ (respectively dominated by $b,v$).\n\n\\begin{claim}\n\\label{claim:subgraph-two-bags}\n$S = C \\cup \\Pi$.\n\\end{claim}\n\n\\begin{proofclaim}\nAssume by contradiction $S \\neq C \\cup \\Pi$, let $D$ be a component of $G[C \\cup \\Pi] \\setminus S$ (see Figure~\\ref{fig:fig:leaf-5}).\nNote that $D \\subset C$ because $\\Pi \\subset S$ by construction.\nFurthermore, $v,b \\notin B \\cap B'$ because $w = b$ by Claim~\\ref{claim:w-equals-b} and $b \\notin N(v)$ by Claim~\\ref{claim:c-is-in-intersection}, so, $B \\cap B'$ is a (minimal) $vb$-separator of $G[C \\cup \\Pi]$.\nThe latter implies $v \\notin N(D)$ or $b \\notin N(D)$ because $D$ induces a connected subgraph, $D \\cap B \\cap B' = \\emptyset$ by construction, and $B \\cap B'$ is a $bv$-separator of $G[C \\cup \\Pi]$. \nAs a result, there exists $z \\in \\{v,b\\}$ such that $N(D) \\setminus z \\subseteq B \\cap B'$.\n\n\\begin{figure}[h!]\n\t\\centering\n\t\\includegraphics[width=0.25\\textwidth]{Fig/leaf-exists-5.pdf}\n\t\\caption{Case $z=v$.}\n\t\\label{fig:fig:leaf-5}\n\\end{figure}\n\nMoreover let $\\{z,z'\\} = \\{v,b\\}$.\n$G[C \\cup \\Pi] \\setminus z$ is connected because $G|C\\cup\\Pi]$ is prime by Claim~\\ref{claim:subgraph-prime}, and so, biconnected.\nIn addition, $N(D) \\setminus z$ is a minimal separator of $G[C \\cup \\Pi] \\setminus z$ because it separates $D$ from $z'$ and $N(D) \\setminus z \\subseteq B \\cap B' \\subseteq N(z')$ by construction.\nBy Lemma~\\ref{lem:P3exists}, one obtains the existence of two non-adjacent vertices $x,y \\in B \\cap B'$ such that $N(D) \\setminus z = \\{x,y\\}$, whence $N(D) \\subseteq \\{x,y,z\\}$.\nThen, by construction $\\Pi' = (x,z,y) \\in \\mathcal{P}_3(G)$ with $D \\subset C$ being a component of $G \\setminus \\Pi'$, that contradicts Claim~\\ref{claim:path-min-pty}.\n\\end{proofclaim}\n\nBy Claim~\\ref{claim:subgraph-two-bags}, $C \\cup \\Pi = S$ (see Figure~\\ref{fig:fig:leaf-6}).\nNote that it implies that $C \\subseteq N[v]$ because $C \\setminus v = (B \\cap B') \\setminus (a,c)$.\nIn order to conclude that $v$ is a leaf-vertex, we will finally prove in Claim~\\ref{claim:intersection-is-a-path} that either $B \\cap B' = \\{a,c\\}$ or $B \\cap B'$ induces a path.\n\n\\begin{figure}[h!]\n\t\\centering\n\t\\includegraphics[width=0.15\\textwidth]{Fig/leaf-exists-6.pdf}\n\t\\caption{Case $c \\in B \\cap B'$, $w = b$ and $C \\cup \\Pi = \\{v,b\\} \\cup (B \\cap B')$.}\n\t\\label{fig:fig:leaf-6}\n\\end{figure} \n \n\\begin{claim}\n\\label{claim:intersection-is-a-path}\nIf $B \\cap B' \\neq \\{a,c\\}$, then $G[B \\cap B']$ is a path.\n\\end{claim} \n \n\\begin{proofclaim}\nRecall that $b,v \\notin B \\cap B'$ because $w = b$ by Claim~\\ref{claim:w-equals-b} and $b \\notin N(v)$ by Claim~\\ref{claim:c-is-in-intersection}.\t\nHence by the properties of a tree decomposition, $B \\cap B'$ is a $bv$-separator of $G[C \\cup \\Pi]$.\t\nSince  $v \\in C$ by Claim~\\ref{claim:v-in-c}, $a \\in B \\cap B'$ by construction and $c \\in B \\cap B'$ by Claim~\\ref{claim:c-is-in-intersection}, therefore $B \\cap B'$ is also a $vb$-separator of $G$.\nIn particular, $B \\cap B'$ is a minimal $bv$-separator of $G$ because $B \\cap B' \\subseteq N(v) \\cap N(w) = N(v) \\cap N(b)$ (indeed, recall that $w=b$ by Claim~\\ref{claim:w-equals-b}).\nBy Corollary~\\ref{cor:sep-planar}, $B \\cap B'$ either induces a cycle or it induces a forest of paths. \n\n\\begin{subclaim}\n\\label{subclaim:not-a-cycle}\n$B \\cap B'$ does not induce a cycle.\n\\end{subclaim}\n\n\\begin{proofsubclaim}\nBy contradiction, let $B \\cap B'$ induce a cycle.\nRecall that $B \\cap B'$ contains the pair of non-adjacent vertices $a,c$ (because $a \\in B \\cap B'$ by construction and $c \\in B \\cap B'$ by Claim~\\ref{claim:c-is-in-intersection}).\nTherefore, one can contract $B \\cap B'$ until one obtains an induced quadrangle $(a,x,c,y)$.\nLet us contract an arbitrary component of $G \\setminus (\\Pi \\cup C)$ so as to obtain a vertex $z$.\nNote that $a,c \\in N(z)$ because $G$ is prime by the hypothesis (indeed, neither $a$ nor $b$ nor $c$ nor $(a,b)$ nor $(a,c)$ can be a separator of $G$).\nThen, let us contract the edge $\\{a,z\\}$ to $a$.\nBy doing so, one obtains a $K_{3,3}$-minor with $\\{ a, b, v \\}$ being one part of the bipartition and $\\{x,y,c\\}$ being the other part.\nThis contradicts the fact that $G$ is planar by the hypothesis, therefore $B \\cap B'$ does not induce a cycle.\t\n\\end{proofsubclaim}\n\nIt follows from Claim~\\ref{subclaim:not-a-cycle} that $B \\cap B'$ induces a forest of paths.\nSuppose for the sake of contradiction that $B \\cap B'$ induces a forest of at least two paths.\nLet $x \\notin \\{a,c\\}$ be the endpoint of some path in the forest, that exists because we assume that $B \\neq \\{a,c\\}$.\nObserve that $|N(x)| \\geq 2$ because $b,v \\in N(x)$, and $|N(x)| = |N(x) \\cap (C \\cup \\Pi)| \\leq 3$ because $x$ is the endpoint of some path of $B \\cap B'$ and $x \\in C$.\nFurthermore, $N(x) \\setminus (b,v) \\subseteq B \\cap B' \\subseteq N(b) \\cap N(v)$, and so, if $|N(x)|=3$ then $N(x)$ induces a path. \nLet $\\Pi' = N(x)$ if $|N(x)| = 3$, else $\\Pi' = (b,a,v)$.\nBy construction, $\\Pi' \\subseteq \\Pi \\cup C$ is a separator of $G$ with $\\{x\\} \\subset C$ being a component of $G \\setminus \\Pi'$, thus contradicting Claim~\\ref{claim:path-min-pty}.\nConsequently, $B \\cap B'$ induces a path.\n\\end{proofclaim} \n \nBy Claim~\\ref{claim:intersection-is-a-path}, either $B\\cap B' = \\{a,c\\}$ or $B \\cap B'$ induces a path.\nFurthermore, $B \\cap B' = N(v)$ because $v \\in C$ (Claim~\\ref{claim:v-in-c}) and $C \\cup \\Pi = \\{v,b\\} \\cup (B \\cap B')$ (Claim~\\ref{claim:subgraph-two-bags}). \nIn particular, if $B \\cap B' = \\{a,c\\}$ then $v$ is a leaf-vertex of Type 3.\nElse, $B \\cap B'$ induces a path and the latter implies that $|B \\cap B'| \\geq 4$ or else the path $B \\cap B'$ would be a separator of $G$ with $\\{v\\}$ being a component of $G \\setminus (B \\cap B')$, thus contradicting Claim~\\ref{claim:path-min-pty}. \nAs a result, since we also have that $B \\cap B' \\subseteq N(b)$ and $b,v$ are non-adjacent by Claim~\\ref{claim:v-in-c}, therefore, $v$ is a leaf-vertex of Type 1.\n\\end{itemize}\n\n\\paragraph{Case $T_a \\cap T_c = \\emptyset$.}\nSince $\\Pi$ is a separator of $G$ and $G$ is prime by the hypothesis, one of $\\Pi$ or $\\Pi \\setminus b$ must be a minimal separator of $G$.\nTherefore, since $(T,{\\cal X})$ is assumed to minimize the distance in $T$ between $T_a$ and $T_c$, by Corollary~\\ref{cor:strong-sep} there exist two bags $B_a,B_c$ that are adjacent in $T$ and such that $a \\in B_a \\setminus B_c$ and $c \\in B_c \\setminus B_a$.\nFurthermore, $a$ dominates $B_a$ while $c$ dominates $B_c$.\nNote that $B_a \\cap B_c = N(a) \\cap N(c)$, so, $b \\in B_a \\cap B_c$.\nIn particular, by the properties of a tree decomposition this implies that $S = N(a) \\cap N(c)$ is a minimal $ac$-separator of $G$.\n\nWe will prove that $C$ is reduced to a vertex (Claim~\\ref{claim:component-is-singleton}), the latter being a leaf-vertex.\n\n\\begin{claim}\n\\label{claim:c-is-in-sep}\n$C \\subseteq S$.\n\\end{claim}\n \n\\begin{proofclaim}\nAssume for the sake of contradiction that $C \\not\\subseteq B \\cap B'$.\nBy the properties of a tree decomposition it comes that some vertex $y \\in C$ is separated from $a$ or $c$ by the set $S = B \\cap B' = N(a) \\cap N(c)$.\nSay w.l.o.g. that $S$ is an $yc$-separator.\n\nLet $C' \\subset C$ be the connected component containing $y$ in $G \\setminus (S \\cup \\{a\\})$.\nSince we have that $G \\setminus a$ is connected because $G$ is prime by the hypothesis (and so, biconnected), that $c \\notin C'$ and $N(C') \\setminus a \\subseteq S \\cap (C \\cup \\Pi) \\subseteq N(c) \\cap (C \\cup \\Pi)$, then it comes that $N(C') \\setminus a$ is a minimal $yc$-separator of $G \\setminus a$.\nSo, by Lemma~\\ref{lem:P3exists} there exist $x',y' \\in S$ such that $N(C') \\setminus a = \\{x',y'\\}$.\nTherefore, $\\Pi' = (x',a,y') \\in {\\cal P}_3(G)$ and $C' \\subset C$ is a component of $G \\setminus \\Pi'$, that contradicts Claim~\\ref{claim:path-min-pty}.\n\\end{proofclaim} \n\nBy Claim~\\ref{claim:c-is-in-sep}, $C \\subseteq S$ (see Figure~\\ref{fig:fig:leaf-7} for an illustration).\nSince $S$ is an $ac$-separator and for any component $C'$ of $G \\setminus (\\Pi \\cup C)$, $a,c \\in N(C')$ because $G$ is prime, therefore $S \\cap C' \\neq \\emptyset$.\nOne thus obtains the following chain of strict subset containment relations $C \\subset C \\cup \\{b\\} \\subset S$.\nFurthermore, by Corollary~\\ref{cor:sep-planar}, $S$ either induces a cycle or a forest of paths, so, $C$ being a strict connected subset of $S$, it must induce a path.\nIn particular, $C \\cup \\{b\\}$ also being a strict subset of $S$, either it induces a path or it is the union of the path induced by $C$ with the isolated vertex $b$. \n\n\\begin{figure}[h!]\n\t\\centering\n\t\\includegraphics[width=0.35\\textwidth]{Fig/leaf-vertices-simple-cases-at-end.pdf}\n\t\\caption{Case $T_a \\cap T_c = \\emptyset$.}\n\t\\label{fig:fig:leaf-7}\n\\end{figure} \n\n\\begin{claim}\n\t\\label{claim:component-is-singleton}\n\t$|C|=1$.\n\\end{claim}\n\n\\begin{proofclaim}\n\tAssume for the sake of contradiction that $|C| \\geq 2$.\n\tSince $C$ induces a path, let us pick an endpoint $v \\in C$ that is not adjacent to vertex $b$ (recall that $C \\cup \\{b\\}$ being a strict subset of $S$, it does not induce a cycle).\n\tIn such a case, $N(v)$ induces a path $\\Pi' \\in {\\cal P}_3(G)$, with $a,c \\in \\Pi'$ and $\\{v\\} \\subset C$ is a component of $G \\setminus \\Pi'$, thus contradicting Claim~\\ref{claim:path-min-pty}.\n\\end{proofclaim}\n\nBy Claim~\\ref{claim:component-is-singleton}, $C$ is reduced to a vertex $v$, that is either a leaf-vertex of Type 2 (if $v \\in N(b)$) or of Type 3 (if $v \\notin N(b)$).\n\\end{proof}\n\nNote that in some cases, there may only exist leaf-vertices of only one Type ({\\it i.e.}, see respectively Figure~\\ref{fig:type-1-only},~\\ref{fig:type-2-only} and~\\ref{fig:type-3-only} for Types 1,2 and 3).\nTherefore, there is none of the three Types of leaf-vertices that can be avoided in our algorithm.\n\n\\begin{figure}[h]\n\t\\begin{minipage}[h]{.30\\linewidth}\n\t\t\\centering\n\t\t\\includegraphics[width=0.75\\textwidth]{Fig/type-1-only.pdf}\n\t\t\\caption{A planar graph $G$ with $tb(G) = 1$ and all of its four leaf-vertices $v_1,v_2,v_3,v_4$ of Type 1.}\n\t\t\\label{fig:type-1-only}\n\t\\end{minipage} \\hfill\n\t\\begin{minipage}[c]{.30\\linewidth}\n\t\t\\centering\n\t\t\\includegraphics[width=0.75\\textwidth]{Fig/type-2-only.pdf}\n\t\t\\caption{A planar graph $G$ with $tb(G) = 1$ and all of its four leaf-vertices $v_1,v_2,v_3,v_4$ of Type 2.}\n\t\t\\label{fig:type-2-only}\n\t\\end{minipage} \\hfill\n\t\\begin{minipage}[h]{.30\\linewidth}\n\t\t\\centering\n\t\t\\includegraphics[width=0.75\\textwidth]{Fig/type-3-only.pdf}\n\t\t\\caption{A planar graph $G$ with $tb(G) = 1$ and all of its four leaf-vertices $v_1,v_2,v_3,v_4$ of Type 3.}\n\t\t\\label{fig:type-3-only}\t\n\t\\end{minipage}\n\\end{figure}\n\nExamples of planar graphs $G$ with $tb(G) = 1$ and ${\\cal P}_3(G) = \\emptyset$ include $C_4$, the cycle with four vertices.\nTo prove correctness of~\\ref{step:find-leaf-vertex}, it now suffices to prove that all these graphs (with ${\\cal P}_3(G) = \\emptyset$) admit a star-decomposition with at most two bags.\n\n\\begin{lemma}\\label{lem:2bags}\nFor any prime planar graph $G$, if $tb(G)=1$ and ${\\cal P}_3(G) = \\emptyset$, then $G$ admits a star-decomposition with at most $2$ bags.\n\\end{lemma}\n\n\\begin{proof}\nBy contradiction, let $(T,{\\cal X})$ be a star-decomposition of $G$ with at least three bags.\nLet $t \\in V(T)$ be an internal node, by the properties of a tree decomposition the bag $X_t$ is a separator of $G$.\nLet $u \\in X_t$ satisfy $X_t \\subseteq N_G[u]$.\nSince $G$ is biconnected, therefore $X_t \\setminus u$ is a separator of $G \\setminus u$.\nBy Lemma~\\ref{lem:P3exists}, there exist $x,y \\in X_t \\setminus u$ non-adjacent such that $\\{x,y\\}$ is a minimal separator of $G \\setminus u$.\nIn such case, $(x,u,y) \\in {\\cal P}_3(G)$, which contradicts the fact that ${\\cal P}_3(G) = \\emptyset$. \n\\end{proof}\n\n\\subsubsection{Case of leaf-vertex $v$ of Type $1$}\n\n\\begin{lemma}\\label{lem:ends-separate}\nLet $G$ be a prime planar graph and $v$ be a leaf-vertex of Type $1$. Let $\\Pi_v$ be the path induced by $N(v)$ and let $a_v,c_v$ be the ends of $\\Pi_v$. \nSuppose $V(G) \\neq N[v] \\cup \\{d_v\\}$.\n\nThen $\\Pi'=(a_v,d_v,c_v) \\in {\\cal P}_3(G)$ and $N[v] \\setminus \\{a_v,c_v\\}$ is a component of $G\\setminus \\Pi'$.\n\\end{lemma}\n\n\\begin{proof}\nLet $C$ be a component of $G \\setminus (N[v] \\cup \\{d_v\\})$, that exists by the hypothesis.\nBy construction, $v \\notin N[C]$, so, $N(C) \\subseteq N(v) \\cup \\{d_v\\}$ separates $v$ from $C$.\nFurthermore, since $G$ is prime by the hypothesis, there exist $x,y \\in N(C)$ non-adjacent.\nNote that $d_v \\notin \\{x,y\\}$ because $N(v) \\subseteq N(d_v)$ by the hypothesis, hence $x,y \\in N(v)$.\n\nWe claim that $\\{x,y\\} = \\{a_v,c_v\\}$.\nBy contradiction, suppose $x \\notin \\{a_v,c_v\\}$.\nLet us write $\\Pi_v = (P,x,Q,y,R)$ with $P,Q$ non-empty subpaths of $\\Pi_v$ and $R$ a (possibly empty) subpath of $\\Pi_v$.\nIn such a case, the connected subsets $S_1 := \\{v\\} \\cup P, \\ S_2 := \\{d_v\\}, \\ S_3 := \\{x\\}, \\ S_4 := Q$ and $S_5 := \\{y\\} \\cup C$ induce a $K_5$-minor of $G$, that contradicts the hypothesis that $G$ is planar. \nTherefore, the claim is proved, that is, $\\{x,y\\} = \\{a_v,c_v\\}$.\n\nTo prove the lemma, it now suffices to prove that $N(C) \\cap N(v) = \\{a_v,c_v\\}$ for in such a case the result will hold for any component $C'$ of $G \\setminus (N[v] \\cup \\{d_v\\})$.\nBy contradiction, let $x' \\in (N(C) \\cap N(v)) \\setminus (a_v,c_v)$.\nSince $|N(v)| \\geq 4$ because $v$ is a leaf-vertex of Type 1 by the hypothesis, therefore, $x'$ and $a_v$ are non-adjacent or $x'$ and $c_v$ are non-adjacent.\nLet $y' \\in \\{a_v,c_v\\}$ be non-adjacent to $x'$.\nSince $x',y' \\in N(C) \\cap N(v)$ are non-adjacent, therefore, by the same proof as for the above claim $\\{x',y'\\} = \\{a_v,c_v\\}$, that would contradict the assumption that $x' \\notin \\{a_v,c_v\\}$.\nAs a result, $N(C) \\subseteq (a_v,d_v,c_v)$ and so, since the result holds for any component $C'$ of $G \\setminus (N[v] \\cup \\{d_v\\})$, $\\Pi' = (a_v,d_v,c_v) \\in {\\cal P}_3(G)$ with $N[v] \\setminus \\{a_v,c_v\\}$ being a full component of $G\\setminus \\Pi'$.\n\\end{proof}\n\n\\begin{theorem}\\label{th:Type1}\nLet $G$ be a prime planar graph and $v$ be a leaf-vertex of Type $1$. Let $\\Pi_v$ be the path induced by $N(v)$ and let $a_v,c_v$ be the ends of $\\Pi_v$.\nSuppose $V(G) \\neq N[v] \\cup \\{d_v\\}$.\n \nThen, the graph $G'$, obtained from $G \\setminus v$ by contracting the internal vertices of $\\Pi_v$ to a single edge, is prime and planar, and $tb(G)=1$ if and only if $tb(G')=1$.\n\\end{theorem}\n\n\\begin{figure}[h!]\n \\centering\n \\includegraphics[width=0.5\\textwidth]{Fig/planar-type1.pdf}\n \\caption{Contraction of the internal vertices of $\\Pi_v$ to a single edge and removal of $v$.}\n \\label{fig:planar-type1}\n\\end{figure}\n\n\\begin{proof}\nFor the remaining of the proof, let $\\Pi'_v = (a_v,x,y,c_v)$ be the path resulting from the contraction of the internal vertices of $\\Pi_v$ to the edge $\\{x,y\\}$ in $G'$.\nBy Lemma~\\ref{lem:ends-separate} $(a_v,d_v,c_v) \\in {\\cal P}_3(G)$ with $(N[v] \\setminus (a_v,c_v))$ being a full component of $G \\setminus (a_v,d_v,c_v)$.\nConsequently, $N_{G'}(x) = \\{a_v,d_v,y\\}$ and $N_{G'}(y) = \\{c_v,d_v,x\\}$.\n\n\nThe graph $G'$ is a minor of $G$, that is a planar graph by the hypothesis, so, $G'$ is also planar.\nIn order to prove that $G'$ is prime, by contradiction, let $S$ be a minimal clique-separator of $G'$.\nThere are two cases to be considered.\n\\begin{itemize}\n\\item Suppose $x \\in S$ or $y \\in S$.\nIn such case, $S \\subseteq (a_v,x,d_v)$, or $S \\subseteq (x,d_v,y)$, or $S \\subseteq (y,d_v,c_v)$.\nBy Lemma~\\ref{lem:ends-separate} $(a_v,d_v,c_v) \\in {\\cal P}_3(G)$ with$(N[v] \\setminus (a_v,c_v))$ being a full component of $G \\setminus (a_v,d_v,c_v)$, and so, for every component $C$ of $G' \\setminus (\\Pi'_v \\cup \\{d_v\\}) = G \\setminus (N[v] \\cup \\{d_v\\})$ $a_v,c_v \\in N(C)$ because $G$ is prime by the hypothesis.\nIn such case, since $a_v \\notin S$ or $c_v \\notin S$, therefore, $G' \\setminus S$ is connected, that contradicts the assumption that $S$ is a clique-separator of $G'$.\n\\item Else, $x,y \\notin S$.\nSince $a_v \\notin S$ or $c_v \\notin S$ because $a_v$ and $c_v$ are non-adjacent in $G'$, therefore, $S$ must be a separator of $G' \\setminus (x,y)$ or else $G' \\setminus S$ would be connected because $\\Pi'_v$ induces a path of $G'$ (thus contradicting the assumption that $S$ is a separator of $G'$).\nIn such a case, since by Lemma~\\ref{lem:ends-separate} $(a_v,d_v,c_v) \\in {\\cal P}_3(G)$ with$(N[v] \\setminus (a_v,c_v))$ being a full component of $G \\setminus (a_v,d_v,c_v)$, since $S$ is a separator of $G' \\setminus (x,y) = G  \\setminus (N[v] \\setminus (a_v,c_v))$ and since $S$ is not a separator of $G$ because $G$ is prime by the hypothesis, therefore, by Lemma~\\ref{lem:separatorInCompo} there are exactly two components $C_a,C_c$ in $G' \\setminus (S \\cup \\{x,y\\})$ with $a_v \\in C_a$ and $c_v \\in C_c$.\nHowever, $\\Pi_v'$ is an $a_vc_v$-path of $G' \\setminus S$, thus contradicting the assumption that $S$ is a separator of $G'$. \n\\end{itemize}\nAs a result, $G'$ is a prime planar graph.\n\n\\medskip\n\\noindent\nFinally, let us prove $tb(G) = 1$ if and only if $tb(G') = 1$.\n\n\\begin{itemize}\n\n\\item If $tb(G) = 1$ then $tb(G \\setminus v) = 1$ because $N(v) \\subseteq N(d_v)$ by the hypothesis, and so, $tb(G') = 1$ because $G'$ is obtained from $G \\setminus v$ by edge-contractions and tree-breadth is contraction-closed (Lemma~\\ref{lem:contraction-closed}).\n\n\\item Conversely, let us prove that $tb(G) = 1$ if $tb(G') = 1$.\nTo prove this, let $(T',{\\cal X}')$ be a reduced star-decomposition of $G'$, that exists by Lemma~\\ref{lem:dominator-in-bag}, minimizing the distance in $T'$ between the two subtrees $T'_{a_v}$ and $T'_{c_v}$.\nIn order to prove $tb(G) = 1$, it suffices to show how to construct a star-decomposition of $G$ from $(T',{\\cal X}')$.\n\nWe will prove as an intermediate claim that $T'_{a_v} \\cap T'_{c_v} \\neq \\emptyset$.\nBy contradiction, suppose $T'_{a_v} \\cap T'_{c_v} = \\emptyset$.\nSince by Lemma~\\ref{lem:ends-separate} $(a_v,d_v,c_v) \\in {\\cal P}_3(G)$ with $(N[v] \\setminus (a_v,c_v))$ being a full component of $G \\setminus (a_v,d_v,c_v)$, therefore, $(a_v,d_v,c_v) \\in {\\cal P}_3(G')$ with $\\{x,y\\}$ being a full component of $G' \\setminus (a_v,d_v,c_v)$.\nSince we proved that $G'$ is prime, it follows that one of $(a_v,c_v)$ or $(a_v,d_v,c_v)$ is a minimal separator of $G'$.\nIn such a situation, since $(T',{\\cal X}')$ is assumed to minimize the distance in $T'$ between $T'_{a_v}$ and $T'_{c_v}$, therefore, by Corollary~\\ref{cor:strong-sep} there are two adjacent bags $B'_{a_v}, \\ B'_{c_v}$ such that $a_v \\in B'_{a_v} \\setminus B'_{c_v}$ and $c_v \\in B'_{c_v} \\setminus B'_{a_v}$ respectively dominate $B'_{a_v}$ and $B'_{c_v}$ in $G'$.\nHowever by the properties of a tree decomposition this implies that $B'_{a_v} \\cap B'_{c_v} = N(a_v) \\cap N(c_v)$ is an $a_vc_v$-separator of $G'$, thus contradicting the existence of the $a_vc_v$-path $\\Pi'_v$.\nTherefore, the claim is proved and $T'_{a_v} \\cap T'_{c_v} \\neq \\emptyset$. \n\nRecall that $T'_{a_v} \\cap T'_{d_v} \\neq \\emptyset$ and similarly $T'_{c_v} \\cap T'_{d_v} \\neq \\emptyset$ by the properties of a tree decomposition.\nHence, the subtrees $T'_{a_v},T'_{c_v}, T'_{d_v}$ are pairwise intersecting, and so, by the Helly property (Lemma~\\ref{lem:helly}), $T'_{a_v} \\cap T'_{d_v} \\cap T'_{c_v} \\neq \\emptyset$.\nLet us now proceed as follows so as to obtain a star-decomposition of $G$.\nLet us remove $x,y$ from all bags in ${\\cal X}'$, that keeps the property for $(T',{\\cal X}')$ to be a star-decomposition because $x$ and $y$ are dominated by $d_v$ in $G'$.\nThen, let us add two new bags $B_1 = N[v], \\ B_2 = N(v) \\cup \\{d_v\\}$, and finally let us make $B_1,B_2$ pairwise adjacent and let us make $B_2$ adjacent to some bag of $T'_{a_v} \\cap T'_{d_v} \\cap T'_{c_v}$.\nBy construction, the resulting tree decomposition is indeed a star-decomposition of $G$, whence $tb(G) = 1$. \n\\end{itemize}\\end{proof}\n\n\\subsubsection{Proof of~\\ref{step:prime-case}~\\ref{step:many-neighbours}}\n\\label{sec-step4-a}\n\nIn the following three subsections (~\\ref{sec-step4-a},~\\ref{sec:step-4-b-i} and~\\ref{sec:step-4-b-ii}) we will prove correctness of the algorithm for the case of a leaf-vertex $v$ of Type $2$ or $3$ and $G \\setminus v$ is prime (~\\ref{step:prime-case}).\nOur proofs in these subsections will mostly rely on Lemma~\\ref{lem:strong-pair}.\n\nLet us first show how we can use Lemma~\\ref{lem:strong-pair} in order to prove correctness of~\\ref{step:prime-case}~\\ref{step:many-neighbours}.\nNote that since we are in the case when $G \\setminus v$ is prime, we needn't prove it in the following Theorem~\\ref{th:primeEasy}.\n\n\\begin{theorem}\\label{th:primeEasy}\nLet $G = (V,E)$ be a prime planar graph, let $v$ be a leaf-vertex of Type 2 or 3, and let $\\Pi_v = (a_v,b_v,c_v)$ be as in Definition~\\ref{def:leafVertex}.\n\nSuppose that $|N(a_v) \\cap N(c_v)| \\geq 3$ in $G \\setminus v$, or there exists a minimal separator $S\\subseteq (N(a_v) \\cap N(c_v)) \\cup \\{a_v,c_v\\}$ in $G \\setminus v$ and $\\{a_v,c_v\\} \\subseteq S$.\n\nThen, $tb(G) = 1$ if and only if $tb(G \\setminus v) = 1$. \n\\end{theorem}\n\n\\begin{proof}\nFirst we prove that $tb(G) = 1$ implies that $tb(G \\setminus v) = 1$, that is the easy part of the result.\nLet $(T,{\\cal X})$ be a tree decomposition of $G$ of breadth one, let $(T,{\\cal X}')$ be such that for every node $t \\in V(T)$, $X_t' = X_t \\setminus v$.\nObserve that $(T,{\\cal X}')$ is a tree decomposition of $G \\setminus v$.\nFurthermore, we claim that it has breadth one, indeed, for every $t \\in V(T)$ such that $X_t \\subseteq N_G[v]$, $X_t' \\subseteq N_G[b_v]$ because $N_G(v) \\subseteq N_G[b_v]$.\nAs a result, $tb(G \\setminus v ) = 1$. \n\n\\smallskip\nConversely, we prove that $tb(G \\setminus v) = 1$ implies that  $tb(G) = 1$.\n\n\n\n\n\n\n\n\n\nLet $(T',{\\cal X}')$ be a star-decomposition of $G \\setminus v$ minimizing the distance in $T'$ between the subtrees $T'_{a_v}$ and $T'_{c_v}$.\nThere are two cases.\nIf $T'_{a_v} \\cap T'_{c_v} \\neq \\emptyset$, then the subtrees $T'_{a_v},T'_{b_v},T'_{c_v}$ are pairwise intersecting, hence by the Helly property (Lemma~\\ref{lem:helly}) $T'_{a_v} \\cap T'_{b_v} \\cap T'_{c_v} \\neq \\emptyset$, and so it suffices to make adjacent to any bag of $T'_{a_v} \\cap T'_{b_v} \\cap T'_{c_v}$ the new bag $N_G[v] \\subseteq \\{a_v,b_v,c_v,v\\}$ so as to obtain a star-decomposition of $G$.\nElse $T'_{a_v} \\cap T'_{c_v} = \\emptyset$ and so, by Corollary~\\ref{cor:strong-three} if $|N(a_v) \\cap N(c_v)| \\geq 3$ in $G \\setminus v$ or by Corollary~\\ref{cor:strong-sep} else, there are two adjacent bags $B'_{a_v},B'_{c_v}$ such that $a_v \\in B'_{a_v} \\setminus B'_{c_v}, b_v  \\in B'_{a_v} \\cap B'_{c_v} \\subseteq N(a_v) \\cap N(c_v)$ and $c_v \\in B'_{c_v} \\setminus B'_{a_v}$.\nFurthermore, $a_v$ dominates $B'_{a_v}$ while $c_v$ dominates $B'_{c_v}$.\nOne obtains a star-decomposition of $G$ simply by adding vertex $v$ into bags $B'_{a_v}$ and $B'_{c_v}$.\n\\end{proof}\n\n\\subsubsection{Proof of~\\ref{step:prime-case}~\\ref{step:few-neighbours}~\\ref{step:one-neighbour}}\n\\label{sec:step-4-b-i}\n\nThe proof of this step is more involved than the proof of previous~\\ref{step:prime-case}~\\ref{step:many-neighbours}.\nWe will need the following intermediate lemma.\n\n\\begin{lemma}\\label{lem:disconnection}\nLet $G=(V,E)$ be a prime graph with $tb(G) = 1$, let $v$ be a leaf-vertex of Type 2 or 3 and let $\\Pi_v=(a_v,b_v,c_v)$ be as in Definition~\\ref{def:leafVertex}.\nSuppose that $N(a_v) \\cap N(c_v) = \\{v,b_v\\}$ and $V \\neq \\Pi_v \\cup \\{v\\}$.\nThen, $N_G[b_v] \\setminus (a_v,c_v,v)$ is an $a_vc_v$-separator of $G \\setminus v$.\n\\end{lemma}\n\n\\begin{proof}\nLet $(T,{\\cal X})$ be a star-decomposition of $G$, that exists by Lemma~\\ref{lem:dominator-in-bag}, minimizing the distance in $T$ between the subtrees $T_{a_v}$ and $T_{c_v}$.\nWe claim that $T_{a_v} \\cap T_{c_v} \\neq \\emptyset$, {\\it i.e.}, $a_v,c_v$ are in a same bag of the decomposition.\nBy contradiction, let $T_{a_v} \\cap T_{c_v} = \\emptyset$.\nSince $G$ is prime and $\\Pi_v$ is a separator of $G$, therefore, one of $\\Pi_v$ or $\\Pi_v \\setminus b_v$ is a minimal separator of $G$.\nSince $(T,{\\cal X})$ minimizes the distance in $T$ between $T_{a_v}$ and $T_{c_v}$, therefore, by Corollary~\\ref{cor:strong-sep} there exist two adjacent bags $B_{a_v},B_{c_v}$ such that $a_v \\in B_{a_v} \\setminus B_{c_v}$ and $c_v \\in B_{c_v} \\setminus B_{a_v}$.\nFurthermore, vertices $a_v$ and $c_v$ respectively dominate the bags $B_{a_v}$ and $B_{c_v}$.\nThis implies $B_{a_v} \\cap B_{c_v} = N_G(a_v) \\cap N_G(c_v)$ and so, $N_G(a_v) \\cap N_G(c_v)$ is a minimal $a_vc_v$-separator of $G$ by the properties of the tree decomposition.\nHowever, let $C$ be any component of $G \\setminus (\\Pi_v \\cup \\{v\\})$, that exists because $V \\neq \\Pi_v \\cup \\{v\\}$ by the hypothesis.\nSince $G$ is prime, therefore, $a_v,c_v \\in N(C)$ (or else, one of the cliques $a_v$ or $b_v$ or $c_v$ or $(a_v,b_v)$ or $(b_v,c_v)$ would be a clique-separator of $G$, thus contradicting the assumption that $G$ is prime).\nThen, the $a_vc_v$-separator $N_G(a_v) \\cap N_G(c_v)$ must contain some vertex of $C$, which contradicts the fact that $N_G(a_v) \\cap N_G(c_v) = \\{v,b_v\\}$ by the hypothesis. \nAs a result, we proved that $T_{a_v} \\cap T_{c_v} \\neq \\emptyset$.\n\nLet $H$ be the chordal supergraph of $G$ such that $(T,{\\cal X})$ is a clique-tree of $H$.\nEquivalently, every two vertices $x,y \\in V$ are adjacent in $H$ if and only if they are in a same bag of ${\\cal X}$.\nIn particular, $a_v,c_v$ are adjacent in $H$.\nLet $S := N_H(a_v) \\cap N_H(c_v)$.\nWe claim that $S$ is an $a_vc_v$-separator of $G$.\nBy contradiction, if it is not an $a_vc_v$-separator of $G$, then there exists an $a_vc_v$-path $P_{a_vc_v}$ of $G$ which does not intersect $S$.\nFurthermore, $P_{a_vc_v}$ is a path of $H$ because $H$ is a supergraph of $G$, and it has length at least two because $a_v,c_v$ are non-adjacent in $G$.\nSo, let $Q_{a_vc_v}$ be taken of minimum length amongst all $a_vc_v$-paths of length at least two in $H$ that do not intersect $S$ (the existence of such a path follows from the existence of $P_{a_vc_v}$).\nObserve that $Q_{a_vc_v}$ may be not a path in $G$.\nBy minimality of $Q_{a_vc_v}$, the vertices of $Q_{a_vc_v}$ induce a cycle of $H$ because $a_v,c_v$ are adjacent in $H$.\nTherefore, the vertices of $Q_{a_vc_v}$ induce a triangle because $H$ is chordal.\nHowever, this contradicts the fact that $Q_{a_vc_v}$ does not intersect $S = N_H(a_v) \\cap N_H(c_v)$, so, the claim is proved.\n\nFinally, let us prove that $S \\setminus v \\subseteq N_G[b_v] \\setminus (a_v,c_v,v)$, that will conclude the proof that $N_G[b_v] \\setminus (a_v,c_v,v)$ is an $a_vc_v$-separator of $G \\setminus v$.\nFor every vertex $x \\in S \\setminus v$, $x \\in N_H(a_v) \\cap N_H(c_v)$, therefore, $T_{a_v} \\cap T_x \\neq \\emptyset$ and $T_{c_v} \\cap T_x \\neq \\emptyset$ by construction of $H$.\nSince the subtrees $T_{a_v},T_{c_v},T_x$ are pairwise intersecting, by the Helly property (Lemma~\\ref{lem:helly}) $T_{a_v} \\cap T_{c_v} \\cap T_x \\neq \\emptyset$, or equivalently there is some bag $B \\in T_{a_v} \\cap T_{c_v} \\cap T_x$.\nLet $z \\in B$ dominate the bag.\nClearly, $x \\in N_G[z]$.\nFurthermore, $z \\in N_G(a_v) \\cap N_G(c_v)$ because $a_v,c_v$ are non-adjacent in $G$.\nAs a result, either $z = b_v$ or $z=v$.\nSince $x \\neq v$ and $N_G(v) \\subseteq N_G[b_v]$, we have that $x \\in N_G[b_v]$ in both cases.\n\\end{proof}\n\n\\begin{theorem}\\label{thm:force-clique}\nLet $G = (V,E)$ be a prime planar graph with $tb(G) = 1$, $v$ be a leaf-vertex of Type 2 or 3, and let $\\Pi_v = (a_v,b_v,c_v)$ be as in Definition~\\ref{def:leafVertex}.\nSuppose $N(a_v) \\cap N(c_v) = \\{b_v,v\\}$, and $G \\setminus v$ is prime, and there is no minimal separator $S\\subseteq (N(a_v) \\cap N(c_v)) \\cup \\{a_v,c_v\\}$ in $G \\setminus v$ such that $\\{a_v,c_v\\} \\subseteq S$.\nThen, $G = C_4$, a cycle with four vertices.\n\\end{theorem}\n\n\\begin{proof}\nBy contradiction, assume $G \\neq C_4$.\nSince $G$ is prime by the hypothesis, $G$ has at least five vertices (the single other graph with four vertices and a leaf-vertex of Type 2 or 3 is the diamond, which is not prime).\nEquivalently, $V \\neq \\Pi_v \\cup \\{v\\}$.\nBy Lemma~\\ref{lem:disconnection}, this implies that $N[b_v] \\setminus (a_v,c_v,v)$ is an $a_vc_v$-separator of $G \\setminus v$.\nSince $G \\setminus v$ is prime by the hypothesis, and so, biconnected, therefore, $G \\setminus (b_v,v)$ is connected, and so, $N(b_v) \\setminus (a_v,c_v,v) \\neq \\emptyset$ is an $a_vc_v$-separator of $G \\setminus (b_v,v)$.\nIn particular, $a_v,b_v,c_v \\in N(V \\setminus (\\Pi_v \\cup \\{v\\}))$. \n\nMoreover, we claim that $V \\setminus (\\Pi_v \\cup \\{v\\})$ induces a connected subgraph (note that the latter implies that $V \\setminus (\\Pi_v \\cup \\{v\\})$ is a full component of $G \\setminus \\Pi_v$).\nBy contradiction, let $C_1,C_2$ be distinct components of $V \\setminus (\\Pi_v \\cup \\{v\\})$.\nSince $G$ is prime, $a_v,c_v \\in N_G(C_1) \\cap N_G(C_2)$ (or else, one of the cliques $a_v$ or $b_v$ or $c_v$ or $(a_v,b_v)$ or $(b_v,c_v)$ would be a clique-separator of $G$, thus contradicting the assumption that $G$ is prime).\nTherefore, $b_v \\in N_G(C_1) \\cap N_G(C_2)$ because $N[b_v] \\setminus (a_v,c_v,v)$ is an $a_vc_v$-separator of $G \\setminus v$.\nIt follows that $\\Pi_v$ is a minimal separator of $G \\setminus v$, that contradicts the hypothesis that there is no minimal separator $S\\subseteq (N(a_v) \\cap N(c_v)) \\cup \\{a_v,c_v\\}$ in $G \\setminus v$ and $\\{a_v,c_v\\} \\subseteq S$.\nConsequently, $V \\setminus (\\Pi_v \\cup \\{v\\})$ induces a connected subgraph.\n\nLet $S' \\subseteq N(b_v) \\setminus (a_v,c_v,v)$ be a minimal $a_vc_v$-separator of $G \\setminus (b_v,v)$.\nBy Lemma~\\ref{lem:P3exists}, there exist $x,y \\in N(b_v) \\setminus (a_v,c_v,v)$ non-adjacent such that $S' = \\{x,y\\}$.\nFinally, let $\\Pi'=(x,b_v,y)$ and let $A,C$ be the respective components of $a_v,c_v$ in $G \\setminus (\\Pi' \\cup \\{v\\})$.\nNote that $x,y \\in N(A) \\cap N(C)$ because $G \\setminus v$ is prime by the hypothesis (indeed, neither $x$ nor $b_v$ nor $y$ nor $(b_v,x)$ nor $(b_v,y)$ can be a separator of $G \\setminus v$).\nLet $P$ be an $xy$-path of $V \\setminus (\\Pi_v \\cup \\{v\\})$, that exists because $V \\setminus (\\Pi_v \\cup \\{v\\})$ is connected.\nAlso, let $A' \\subseteq A$ and $C' \\subseteq C$ be the respective components of $a_v,c_v$ in $G \\setminus (P \\cup \\Pi' \\cup \\{v\\})$.\nNote that the subpath $P \\setminus (x,y)$ lies onto a unique component of $G \\setminus (\\Pi' \\cup \\{v\\})$ because it does not intersect $\\Pi_v \\cup \\{v\\}$ by construction, so, $A' = A$ or $C' = C$.\nBy symmetry, assume that $C' = C$.\nThere are two cases to consider.\n\n\\begin{itemize}\n\\item Assume $A' = A$ (see Figure~\\ref{fig:c4-case-1} for an illustration).\nLet us contract the internal vertices of $P$ so as to make vertices $x,y$ adjacent.\nThen, let us contract the components $A,C$ to the two vertices $a_v,c_v$, respectively.\nFinally, let us contract $v$ to either $a_v$ or $c_v$.\nBy construction, the five vertices $a_v,b_v,c_v,x,y$ now induce a $K_5$, that contradicts the fact that $G$ is planar by the hypothesis.\n\n\\begin{figure}[h!]\n \\centering\n \\includegraphics[width=0.45\\textwidth]{Fig/c4-case-1.pdf}\n \\caption{Case $A'=A$ (left). A $K_5$-minor is drawn (right), with edges resulting from contractions labeled in red.}\n \\label{fig:c4-case-1}\n\\end{figure}\n\n\\item Else, $A' \\neq A$. Equivalently, $P \\subseteq A \\cup \\{x,y\\}$ (see Figure~\\ref{fig:c4-case-2} for an illustration).\nSince $A$ is connected, $N(A') \\cap ( P \\setminus (x,y) ) \\neq \\emptyset$.\nLet $z \\in N(A') \\cap P$.\nLet us contract the internal vertices of $P$ to vertex $z$.\nThen, let us contract the components $A'$ and $C' = C$ to the two vertices $a_v,c_v$, respectively.\nFinally let us contract $v$ to either $a_v$ or $c_v$.\nBy construction, there is a $K_{3,3}$-minor whose sides of the bipartition are $\\{a_v,x,y\\}$ and $\\{b_v,c_v,z\\}$, respectively, that contradicts the fact that $G$ is planar by the hypothesis.\n\n\\begin{figure}[h!]\n \\centering\n \\includegraphics[width=0.55\\textwidth]{Fig/c4-case-2.pdf}\n \\caption{Case $A'\\neq A$ (left). A $K_{3,3}$-minor is drawn (right), with each side of the bipartition being coloured differently. Edges resulting from contractions are labeled in red.}\n \\label{fig:c4-case-2}\n\\end{figure}\n\n\\end{itemize}\n\nSince both cases contradict the hypothesis that $G$ is planar, therefore, $G = C_4$.\n\\end{proof}\n\n\\subsubsection{Proof of~\\ref{step:prime-case}~\\ref{step:few-neighbours}~\\ref{step:two-neighbours}}\n\\label{sec:step-4-b-ii}\n\n\\begin{theorem}\\label{th:primeDifficult}\nLet $G = (V,E)$ be a prime planar graph, let $v$ be a leaf-vertex of Type 2 or 3, and let $\\Pi_v = (a_v,b_v,c_v)$ be as in Definition~\\ref{def:leafVertex}. \n\nSuppose that all of the following statements hold:\n\\begin{itemize}\n\\item $N(a_v) \\cap N(c_v) = \\{v,b_v,u_v\\}$ with $u_v \\notin \\{v\\} \\cup \\Pi_v$;\n\\item $V \\neq \\{a_v,b_v,c_v,u_v,v\\}$;\n\n\n\n\n\\item there is no minimal separator $S\\subseteq (N(a_v) \\cap N(c_v)) \\cup \\{a_v,c_v\\}$ in $G \\setminus v$ and $\\{a_v,c_v\\} \\subseteq S$.\n\\end{itemize}\n\nLet $G'$ be the graph obtained from $G$ by adding edges $\\{v,u_v\\}$ and $\\{b_v,v\\}$, then $tb(G) = 1$ if and only if $tb(G') = 1$.\nMoreover, $G'$ is planar and prime.\n\\end{theorem}\n\n\\begin{figure}[h!]\n \\centering\n \\includegraphics[width=0.25\\textwidth]{Fig/one-neighbour.pdf}\n \\caption{Case of a leaf-vertex $v$ of Type $3$ with $G \\setminus v$ is prime and $N(a_v) \\cap N(c_v) = \\{ u_v, b_v, v \\}$. Red edges are those added by Algorithm \\texttt{Leaf-BottomUp}.}\n \\label{fig:unique-neighbour}\n\\end{figure}\n\n\\begin{proof}\nWe will first prove that $G \\setminus v$ is prime.\nBy contradiction, let $S'$ be a minimal clique-separator of $G \\setminus v$.\nBy Theorem~\\ref{th:GminusVprime?}, there is $w_v \\neq v$ such that $S' = \\{b_v,w_v\\}$, and by Lemma~\\ref{lem:separatorInCompo}, $S'$ must be an $a_vc_v$-separator of $G \\setminus v$.\nThen, it follows that $w_v = u_v \\in N(a_v) \\cap N(c_v)$, whence $V = \\{a_v,b_v,c_v,u_v,v\\}$ by Theorem~\\ref{th:GminusVprime?}, that contradicts the hypothesis. \nTherefore, $G \\setminus v$ is prime.\n\n\\medskip\nLet us prove that $tb(G) = 1$ implies that $tb(G') = 1$.\nLet $(T,{\\cal X})$ be a star-decomposition of $G$, which exists by Lemma~\\ref{lem:dominator-in-bag}, minimizing the distance in $T$ between the subtrees $T_{a_v}$ and $T_{c_v}$.\nSince $N_G(v) \\subseteq N_G[b_v]$ then removing $v$ from all bags leaves a tree decomposition of $G \\setminus v$ of breadth one.\nUp to reducing the tree decomposition, let $(T',{\\cal X}')$ be any reduced tree decomposition of $G \\setminus v$ that is obtained from $(T,{\\cal X})$ by first removing $v$ from the bags.\nNote that $(T',{\\cal X}')$ is a star-decomposition of $G \\setminus v$ by Lemma~\\ref{lem:dominator-in-bag}.\nNow, there are two cases.\n\\begin{itemize}\n\n\\item Suppose $T'_{a_v} \\cap T'_{c_v} \\neq \\emptyset$.\nWe will need to prove in this case that the two subtrees $T'_{a_v} \\cap T'_{b_v} \\cap T'_{c_v}$ and $T'_{a_v} \\cap T'_{u_v} \\cap T'_{c_v}$ are nonempty and disjoint.\n\n\\begin{claim}\n\t\\label{claim:bv-non-adjacent}\n\t$b_v,u_v$ are non-adjacent in $G$.\n\\end{claim}\n\n\\begin{proofclaim}\n\tBy contradiction, if it were the case that $b_v,u_v$ are adjacent, then by Lemma~\\ref{lem:common-neighbour}, either $u_v$ is an isolated vertex of $G \\setminus (\\Pi_v \\cup \\{v\\})$ --- in which case, $\\Pi_v \\in {\\cal P}_3(G \\setminus v)$ because we assume $V \\neq \\{a_v,b_v,c_v,u_v,v\\}$ by the hypothesis ---, or $(a_v,u_v,b_v) \\in {\\cal P}_3(G \\setminus v)$.\n\tSince $G \\setminus v$ is prime, it follows that one of $\\Pi_v$ or $\\Pi_v \\setminus b_v$ must be a minimal separator of $G \\setminus v$, similarly one of $(a_v,u_v,c_v)$ or $(a_v,c_v)$ must be a minimal separator of $G \\setminus v$.\n\tTherefore, both cases contradict the hypothesis that there is no minimal separator $S\\subseteq (N(a_v) \\cap N(c_v)) \\cup \\{a_v,c_v\\}$ in $G \\setminus v$ and $\\{a_v,c_v\\} \\subseteq S$, which proves that $b_v,u_v$ are non-adjacent.\n\\end{proofclaim}\n\nRecall that we are in the case when $T'_{a_v} \\cap T'_{c_v} \\neq \\emptyset$. \nThe subtrees $T'_{a_v},T'_{c_v},T'_{u_v}$ are pairwise intersecting, similarly the subtrees $T'_{a_v},T'_{c_v},T'_{b_v}$ are pairwise intersecting.\nTherefore, by the Helly property (Lemma~\\ref{lem:helly}) $T'_{a_v} \\cap T'_{b_v} \\cap T'_{c_v} \\neq \\emptyset$ and $T'_{a_v} \\cap T'_{u_v} \\cap T'_{c_v} \\neq \\emptyset$.\nFurthermore, $T_{a_v} \\cap T_{b_v} \\cap T_{c_v} \\cap T_{u_v} = \\emptyset$, because since $b_v,u_v$ are non-adjacent by Claim~\\ref{claim:bv-non-adjacent} no vertex dominates all of $\\{a_v,b_v,c_v,u_v\\}$ in $G$, and so, $T'_{a_v} \\cap T'_{b_v} \\cap T'_{c_v} \\cap T'_{u_v} = \\emptyset$.\n\n\\begin{claim}\n\\label{claim:subtrees-adjacent}\nThe subtrees $T'_{a_v} \\cap T'_{b_v} \\cap T'_{c_v}$ and $T'_{a_v} \\cap T'_{u_v} \\cap T'_{c_v}$ are adjacent in $T'$.\n\\end{claim}\n\n\\begin{proofclaim}\nBy contradiction, let $B$ be an internal bag onto the path between both subtrees in $T'$, let $z \\in B$ dominate the bag.\nNote that $a_v,c_v \\in B$ by the properties of the tree decomposition, $z \\notin \\{a_v,c_v\\}$ because $a_v,c_v$ are non-adjacent, and so, $z \\in N(a_v) \\cap N(c_v) \\setminus v = \\{ u_v, b_v\\}$.\nThis contradicts the fact that $B \\notin T'_{a_v} \\cap T'_{b_v} \\cap T'_{c_v}$ and $B \\notin T'_{a_v} \\cap T'_{u_v} \\cap T'_{c_v}$, therefore, the subtrees $T'_{a_v} \\cap T'_{b_v} \\cap T'_{c_v}$ and $T'_{a_v} \\cap T'_{u_v} \\cap T'_{c_v}$ are adjacent in $T'$.\n\\end{proofclaim}\n\nFinally, let $B \\in T'_{a_v} \\cap T'_{b_v} \\cap T'_{c_v}, B' \\in T'_{a_v} \\cap T'_{u_v} \\cap T'_{c_v}$ be adjacent, that exist by Claim~\\ref{claim:subtrees-adjacent}.\nObserve that $b_v$ dominates $B$, $u_v$ dominates $B'$.\nTo obtain a star-decomposition of $G'$ from $(T',{\\cal X}')$, it now suffices to add vertex $v$ in $B$ and $B'$, whence $tb(G') = 1$.\n\n\\item Else, $T'_{a_v} \\cap T'_{c_v} = \\emptyset$.\nThis implies $T_{a_v} \\cap T_{c_v} = \\emptyset$.\n\n\nSince the tree decomposition $(T,{\\cal X})$ minimizes the distance in $T$ between $T_{a_v}$ and $T_{c_v}$, $G$ is planar and $|N(a_v) \\cap N(c_v)| \\geq 3$, therefore by Corollary~\\ref{cor:strong-three}, the subtrees $T_{a_v}$ and $T_{c_v}$ are adjacent in $T$, whence the subtrees $T'_{a_v},T'_{c_v}$ are also adjacent in $T'$.\nIn particular, by Corollary~\\ref{cor:strong-three} there exist two adjacent bags $B'_{a_v},B'_{c_v} \\in {\\cal X}'$ such that $a_v \\in B'_{a_v} \\setminus B'_{c_v}, B'_{a_v} \\cap B'_{c_v} = N_G(a_v) \\cap N_G(c_v) \\setminus v = \\{u_v,b_v\\}, c_v \\in B'_{c_v} \\setminus B'_{a_v}$.\nFurthermore, $a_v$ dominates $B'_{a_v}$ while $c_v$ dominates $B'_{c_v}$.\nTherefore, in order to obtain a star-decomposition of $G'$ from $(T',{\\cal X}')$, it now suffices to add vertex $v$ in $B'_{a_v}$ and $B'_{c_v}$ -- that yields exactly $(T,{\\cal X})$ --, whence $tb(G') = 1$.\n\\end{itemize}\n\n\\medskip\nBefore we can prove the equivalence, {\\it i.e.}, $tb(G) = 1$ if and only if $tb(G') = 1$, we need to prove first that $G'$ is prime and planar.\n\n\\begin{claim}\n\\label{claim:gprime-prime}\n$G'$ is prime.\n\\end{claim}\n\n\\begin{proofclaim}\nLet $S'$ be a clique-separator of $G'$.\nNote that $v \\in S'$ by construction of $G'$.\nTherefore, $S' \\setminus v$ is a clique-separator of $G \\setminus v$, that contradicts the fact that $G \\setminus v$ is prime.\nConsequently, $G'$ is prime.\n\\end{proofclaim}\n\n\\begin{claim}\n\\label{claim:gprime-planar}\n$G'$ is planar.\n\\end{claim}\n\n\\begin{proofclaim}\nLet us fix a plane embedding of $G$.\nBy Jordan Theorem, the cycle induced by $(a_v,b_v,c_v,u_v)$ separates the plane into two regions.\nLet $G_1,G_2$ be respectively the subgraphs of $G$ that are induced by all the vertices in each region.\t\n\n\\begin{figure}[h!]\n\t\\centering\n\t\\includegraphics[width=0.25\\textwidth]{Fig/planar-one-neighbour.pdf}\n\t\\caption{Proof that the graph $G'$ of Theorem~\\ref{th:primeDifficult} is planar.}\n\t\\label{fig:planar-one-neighbour}\n\\end{figure}\n\nWe claim that either $V \\setminus (a_v,b_v,c_v,u_v,v) \\subseteq V(G_1)$, or $V \\setminus (a_v,b_v,c_v,u_v,v) \\subseteq V(G_2)$.\nNote that it will prove that $G'$ is planar, because then drawing vertex $v$ onto the region that does not contain the set $V \\setminus (a_v,b_v,c_v,u_v,v)$ yields a planar embedding of $G'$.\nBy contradiction, let $C_1 \\subseteq V(G_1), C_2 \\subseteq V(G_2)$ be connected components of $V \\setminus (a_v,b_v,c_v,u_v,v)$.\nLet $\\Pi'_v = (a_v,u_v,c_v)$.\nIf one of $\\Pi_v$ or $\\Pi'_v$ belongs to ${\\cal P}_3(G \\setminus v)$, then, there exists a minimal separator $S\\subseteq (N(a_v) \\cap N(c_v)) \\cup \\{a_v,c_v\\}$ in $G \\setminus v$ and since $G \\setminus v$ is prime, $\\{a_v,c_v\\} \\subseteq S$.\nThis would contradict the hypothesis, so, $\\Pi_v,\\Pi'_v \\notin \\mathcal{P}_3(G \\setminus v)$. \nAs a result, since $(a_v,b_v,c_v,u_v) = \\Pi_v \\cup \\Pi'_v$ separates $C_1$ from $C_2$, therefore, $u_v,b_v \\in N(C_1) \\cap N(C_2)$ (or else, $\\Pi_v \\in {\\cal P}_3(G \\setminus v)$ or $\\Pi'_v \\in {\\cal P}_3(G \\setminus v)$).\nLet us remove all other components of $V \\setminus (a_v,b_v,c_v,u_v,v)$ but $C_1$ and $C_2$, and let us remove all edges between $\\{a_v,c_v\\}$ and $C_1 \\cup C_2$ if any (see Figure~\\ref{fig:planar-one-neighbour}).\nFinally, let us contract $C_1,C_2$ to the two vertices $x_1,x_2$.\nThe cycle induced by $(u_v,x_1,b_v,x_2)$ separates the plane into two regions with $a_v,c_v$ being into different regions by construction.\nVertex $v$ must belong to one of the regions, but then it is a contradiction because $v \\in N(a_v) \\cap N(c_v)$ by the hypothesis.\n\\end{proofclaim}\n\nTo conclude the proof, let us prove that conversely, $tb(G') = 1$ implies that $tb(G) = 1$.\nLet $(T',{\\cal X}')$ be a star-decomposition of $G'$ minimizing the distance in $T'$ between the subtrees $T'_{a_v}$ and $T'_{c_v}$.\nAs an intermediate step, we claim that if removing vertex $v$ from all bags of ${\\cal X}'$ leaves a tree decomposition of $G \\setminus v$ of breadth one, then it implies that $tb(G) = 1$.\nTo prove the claim, there are two cases to be considered.\n\\begin{itemize}\n\\item If $T'_{a_v} \\cap T'_{c_v} \\neq \\emptyset$, then the subtrees $T'_{a_v}, T'_{b_v}, T'_{c_v}$ are pairwise intersecting, hence by the Helly property (Lemma~\\ref{lem:helly}) $T'_{a_v} \\cap T'_{b_v} \\cap T'_{c_v} \\neq \\emptyset$.\nEquivalently there is bag containing $\\Pi_v$, and so it suffices to remove $v$ from all bags and then to make any bag containing $\\Pi_v$ adjacent to the new bag $N_G[v]$ in order to obtain a tree decomposition of $G$ of breadth one.\n\n\\item Else, $T'_{a_v} \\cap T'_{c_v} = \\emptyset$.\nSince $(T',{\\cal X}')$ minimizes the distance in $T'$ between the subtrees $T'_{a_v}$ and $T'_{c_v}$, $G'$ is planar by Claim~\\ref{claim:gprime-planar} and $a_v,c_v$ have three common neighbours in $G'$, therefore, by Corollary~\\ref{cor:strong-three} there must exist two adjacents bags $B'_{a_v},B'_{c_v}$ such that $a_v \\in B'_{a_v} \\setminus B'_{c_v}, B'_{a_v} \\cap B'_{c_v} = N(a_v) \\cap N(c_v)$ and $c_v \\in B'_{c_v} \\setminus B'_{a_v}$.\nFurthermore, vertex $a_v$ dominates the bag $B'_{a_v}$, while vertex $c_v$ dominates the bag $B'_{c_v}$.\nAs a result, removing vertex $v$ from all bags but $B'_{a_v},B'_{c_v}$ leads to a tree decomposition of $G$ of breadth one.\n\\end{itemize}\n\n\\medskip\n\\noindent\nConsequently, we are left to modify the tree decomposition $(T',{\\cal X}')$ so as to ensure that none of the bags is only dominated by vertex $v$ in $G'$, for if it is the case then removing $v$ from all bags does leave a tree decomposition of $G \\setminus v$ of breadth one.\nWe will call the latter property the \\emph{removal property}.\nObserve that if it is the case that $(T',{\\cal X}')$ does not satisfy the removal property, then there must be a bag $B$ fully containing $N_{G'}(v)$ because any strict subset of $N_{G'}(v)$ is dominated by some vertex of $G \\setminus v$.\nIn particular, $B = N_{G'}[v]$ because only vertex $v$ dominates $N_{G'}(v)$ in $G'$, and so we can further assume that $T'_v = \\{B\\}$ without violating the property for $(T',{\\cal X}')$ to be a tree decomposition of $G'$ of breadth one.\nTherefore in the following, assume that $(T',{\\cal X}')$ is a reduced star-decomposition of $G'$ and $T'_v = \\{B\\}$, that is always possible to achieve by Lemma~\\ref{lem:dominator-in-bag} and above remarks.\n\nSince $V \\neq \\{a_v,b_v,c_v,u_v,v\\} = N_{G'}[v]$ by the hypothesis, therefore, ${\\cal X}' \\setminus B \\neq \\emptyset$.\nLet $B'$ be adjacent to $B$ in $T'$. \nNote that $B \\cap B' \\neq \\{a_v,b_v,c_v,u_v\\}$ because no other vertex than $v$ dominates the subset $\\{a_v,b_v,c_v,u_v\\}$ in $G'$.\nBy the properties of a tree decomposition, $B \\cap B'$ is a separator of $G'$.\nConsequently, $B \\cap B'$ is not a clique because $G'$ is prime by Claim~\\ref{claim:gprime-prime}.\nFurthermore, since $B \\cap B' \\neq \\{a_v,b_v,c_v,u_v\\}$ it holds that $B \\setminus (B' \\cup \\{v\\}) \\neq \\emptyset$, consequently $B \\cap B'$ is also a separator of $G \\setminus v$.\nSince $G \\setminus v$ is prime, $B \\cap B'$ cannot be any of $(a_v,c_v)$, $\\Pi_v$ or $\\Pi'_v$ because by the hypothesis there is no minimal separator $S\\subseteq (N(a_v) \\cap N(c_v)) \\cup \\{a_v,c_v\\}$ in $G \\setminus v$ and $\\{a_v,c_v\\} \\subseteq S$. \nIt follows that $B \\cap B' \\subseteq \\{a_v,b_v,u_v\\}$ or $B \\cap B' \\subseteq \\{b_v,c_v,u_v\\}$.\nLet us substitute the bag $B$ with the two adjacent bags $B_1 = \\{a_v,u_v,b_v,v\\}, B_2 = \\{b_v,c_v,u_v,v\\}$, then we make adjacent all bags $B''$ that were formerly adjacent to $B$ to some bag amongst $B_1,B_2$ containing $B \\cap B''$.\nNote that $B_1 \\subseteq N[a_v]$ and that $B_2 \\subseteq N[c_v]$.\nTherefore, the resulting tree decomposition is a tree decomposition of $G$ of breadth one such that $v$ dominates no bag.\n\\end{proof}\n\n\\subsubsection{Case of leaf-vertex $v$ of Type $2$ or $3$ and $G \\setminus v$ not prime}\n\nThe remaining subsections will be devoted to the proof of correctness of~\\ref{step:new-clique-sep}.\nIn particular, this subsection is devoted to the proof that when $G \\setminus v$ is not prime one can only consider the case when the leaf-vertex $v$ is of Type 2, {\\it i.e.}, $v$ and $b_v$ are adjacent in $G$.\nNote that when $v$ is of Type 3, then in general one cannot add an edge between $v$ and $b_v$ without violating the property for the graph $G$ to be planar, as shown in Figure~\\ref{fig:planar-unique-neighbour}.\nWe will now prove that whenever we are in the conditions of~\\ref{step:new-clique-sep}, it is always possible to do so while preserving the planarity of the graph $G$ and the property to be of tree-breadth one.\n\n\\begin{figure}[h!]\n \\centering\n \\includegraphics[width=0.35\\textwidth]{Fig/no-type2-from-type3.pdf}\n \\caption{A planar graph $G$ with $tb(G) = 1$ (left), and a leaf-vertex $v$ of Type 3 so that adding an edge between $v$ and $b_v$ violates the property for the graph to be planar (right). In the latter case, one side of the bipartition of the $K_{3,3}$-minor is coloured red.}\n \\label{fig:planar-unique-neighbour}\n\\end{figure}\n\n\\begin{theorem}\\label{th:addEdgebv}\nLet $G$ be a prime planar graph. Let $v$ be a leaf-vertex of Type $3$ such that $G \\setminus v$ is not prime. Finally, let $\\Pi_v=(a_v,b_v,c_v)$ be as in Definition~\\ref{def:leafVertex}. Let $G'$ be obtained from $G$ by adding the edge $\\{v,b_v\\}$.\n\nThen, $G'$ is prime and planar, and $tb(G)=1$ if and only if $tb(G')=1$.\n\\end{theorem}\n\n\\begin{proof}\nFirst, we prove that $G'$ is prime and planar.\n\\begin{itemize}\n\n\\item In order to prove that $G'$ is prime, by contradiction let $S$ be a clique-separator of $G'$.\nSince $G'$ is a supergraph of $G$, therefore $S$ is a separator of $G$ but it does not induce a clique in $G$.\nHence, $S$ contains the edge $\\{v,b_v\\}$, and so either $S \\subseteq \\{a_v,b_v,v\\}$ or $S \\subseteq \\{b_v,c_v,v\\}$.\nLet $C = V \\setminus (\\Pi_v \\cup \\{v\\})$, by Theorem~\\ref{th:GminusVprime?}, $C$ is a full component of $G \\setminus \\Pi_v$ because $G \\setminus v$ is not prime.\nIn particular, $C$ is connected and $a_v,c_v \\in N(C)$, that contradicts the fact that $G' \\setminus S$ is unconnected.\n\n\\item Then in order to prove that $G'$ is planar, let us fix a plane embedding of $G$.\nThe cycle induced by $(a_v,b_v,c_v,v)$ separates the plane into two regions.\nTo prove that $G'$ is planar, we claim that it suffices to prove that all vertices in $C = V \\setminus (\\Pi_v \\cup \\{v\\})$ are in the same region, for then drawing the edge $\\{b_v,v\\}$ in the other region leads to a plane embedding of $G'$.\nBy contradiction, let $x,y \\in C$ be in different regions.\nBy~\\cite[Proposition 8]{Bouchitte2003}, the cycle $(a_v,b_v,c_v,v)$ is an $xy$-separator of $G$, that contradicts the fact that $C$ is connected.\n\n\\end{itemize}\n\n\\medskip\n\\noindent\nLet us now prove that $tb(G) = 1$ implies that $tb(G') = 1$.\nLet $(T,{\\cal X})$ be a star-decomposition of $G$, that exists by Lemma~\\ref{lem:dominator-in-bag}, minimizing the distance in $T$ between the subtrees $T_{a_v}$ and $T_{c_v}$.\nLet us remove vertex $v$ from all bags, that leads to a tree decomposition $(T, {\\cal X}_{-v})$ of $G \\setminus v$ of breadth one because $N_G(v) \\subseteq N_G(b_v)$. \nThen, let $(T',{\\cal X}')$ be any reduced tree decomposition that is obtained from $(T,{\\cal X}_{-v})$, that is a star-decomposition of $G \\setminus v$ by Lemma~\\ref{lem:dominator-in-bag}. \nNow, there are two cases.\nIf $T'_{a_v} \\cap T'_{c_v} \\neq \\emptyset$, then the subtrees $T'_{a_v},T'_{b_v},T'_{c_v}$ are pairwise intersecting and so, by the Helly property (Lemma~\\ref{lem:helly}) $T'_{a_v} \\cap T'_{b_v} \\cap T'_{c_v} \\neq \\emptyset$.\nHence one obtains a star-decomposition of $G'$ simply by making some bag of $T'_{a_v} \\cap T'_{b_v} \\cap T'_{c_v}$ adjacent to the new bag $N_{G'}[v] = \\{a_v,b_v,c_v,v\\}$.\nElse, $T'_{a_v} \\cap T'_{c_v} = \\emptyset$, so, $T_{a_v} \\cap T_{c_v} = \\emptyset$.\nSince $\\Pi_v \\in {\\cal P}_3(G)$ and $G$ is prime by the hypothesis, therefore, one of $\\Pi_v$ or $\\Pi_v \\setminus b_v$ must be a minimal separator of $G$.\nAs a result, since $(T,{\\cal X})$ is assumed to minimize the distance in $T$ between the subtrees $T_{a_v}$ and $T_{c_v}$, by Corollary~\\ref{cor:strong-sep} there exist two adjacent bags $B_{a_v}, B_{c_v} \\in {\\cal X}$ so that $a_v \\in B_{a_v} \\setminus B_{c_v}$ and $c_v \\in B_{c_v} \\setminus B_{a_v}$ respectively dominate the bags $B_{a_v}$ and $B_{c_v}$.\nIn such case, $B_{a_v} \\cap B_{c_v} = N_G(a_v) \\cap N_G(c_v)$ and so, since $b_v,v \\in B_{a_v} \\cap B_{c_v}$, $(T,{\\cal X})$ is also a star-decomposition of $G'$.\nSo, in conclusion, $tb(G') = 1$ in both cases.\n\nConversely, let us prove that $tb(G') = 1$ implies that $tb(G) = 1$.\nLet $(T',{\\cal X}')$ be a star-decomposition of $G'$, that exists by Lemma~\\ref{lem:dominator-in-bag}, minimizing the distance in $T'$ between the subtrees $T'_{a_v}$ and $T'_{c_v}$.\nLet us remove vertex $v$ from all bags, that leads to a tree decomposition $(T', {\\cal X}'_{-v})$ of $G' \\setminus v = G \\setminus v$ of breadth one because $N_{G'}[v] \\subseteq N_{G'}[b_v]$. \nThen, let $(T,{\\cal X})$ be any reduced tree decomposition that is obtained from $(T',{\\cal X}'_{-v})$, that is a star-decomposition of $G \\setminus v$ by Lemma~\\ref{lem:dominator-in-bag}. \nThere are two cases.\nIf $T_{a_v} \\cap T_{c_v} \\neq \\emptyset$, then one obtains a star-decomposition of $G$ simply by making some bag of $T_{a_v} \\cap T_{c_v}$ adjacent to the new bag $N_G[v] = \\{a_v,c_v,v\\}$.\nElse, $T_{a_v} \\cap T_{c_v} = \\emptyset$, so, $T'_{a_v} \\cap T'_{c_v} = \\emptyset$.\nSince $\\Pi_v \\in {\\cal P}_3(G')$ and $G'$ is also prime, therefore, one of $\\Pi_v$ or $\\Pi_v \\setminus b_v$ must be a minimal separator of $G'$.\nAs a result, since $(T',{\\cal X}')$ is assumed to minimize the distance in $T'$ between the subtrees $T'_{a_v}$ and $T'_{c_v}$, by Corollary~\\ref{cor:strong-sep} there exist two adjacent bags $B'_{a_v}, B'_{c_v} \\in {\\cal X}'$ so that $a_v \\in B'_{a_v} \\setminus B'_{c_v}$ and $c_v \\in B'_{c_v} \\setminus B'_{a_v}$ respectively dominate the bags $B'_{a_v}$ and $B'_{c_v}$.\nIn such case, one obtains a star-decomposition of $G$ by adding $v$ in the two bags $B'_{a_v},B'_{c_v}$.\nSo, in conclusion, $tb(G) = 1$ in both cases.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\end{proof}\n\n\\subsubsection{Proof of~\\ref{step:new-clique-sep}~\\ref{step:no-separation}}\n\n\\begin{theorem}\\label{th:contractva}\nLet $G$ be a prime planar graph, let $v$ be a leaf-vertex of Type 2, $\\Pi_v = (a_v,b_v,c_v)$ be as in Definition~\\ref{def:leafVertex}, and let $u_v \\notin \\Pi_v \\cup \\{v\\}$ be such that $(b_v,u_v)$ is an edge-separator of $G \\setminus v$.  \n\nSuppose $a_v$ and $u_v$ are non-adjacent, and either $c_v$ and $u_v$ are non-adjacent or the subset $N_G(a_v) \\cap N_G(u_v)$ is \\underline{not} an $a_vu_v$-separator in the subgraph $G \\setminus (c_v,v)$.\n\n\nThen, $G/ va_v$ (obtained by contracting $\\{v,a_v\\}$) is planar and prime and $tb(G) = 1$ if and only if $tb(G/ va_v) = 1$.\n\\end{theorem}\n\n\\begin{figure}[h!]\n \\centering\n \\includegraphics[width=0.5\\textwidth]{Fig/planar-clique-contraction.pdf}\n \\caption{Cases when Theorem~\\ref{th:contractva} applies and the edge $\\{v,a_v\\}$ can be contracted to $a_v$.}\n \\label{fig:planar-clique-contraction}\n\\end{figure}\n\n\\begin{proof}\nThe graph $G/va_v$ is a contraction of the planar graph $G$, therefore it is planar.\nLet us prove that $G/va_v$ is prime.\nBy contradiction, let $S$ be a minimal clique-separator of $G/va_v$.\nSince $G/va_v$ is a supergraph of $G \\setminus v$, $S$ is also a separator of $G \\setminus v$.\nFurthermore, it is not an $a_vc_v$-separator because $a_v,c_v$ are adjacent in $G/va_v$, therefore, by Lemma~\\ref{lem:separatorInCompo} $S$ is a separator of $G$.\nSince $G$ is prime by the hypothesis, $S$ does not induce a clique of $G$, whence $a_v,c_v \\in S$.\nHowever, since $(b_v,u_v)$ is not a separator of $G$ because $G$ is prime by the hypothesis, therefore by Lemma~\\ref{lem:separatorInCompo} $(u_v,b_v)$ is an $a_vc_v$-separator of $G \\setminus v$.\nSo, $N_G(a_v) \\cap N_G(c_v) \\subseteq \\{v,b_v,u_v  \\}$, that implies $N_G(a_v) \\cap N_G(c_v) = \\{v,b_v\\}$ because $a_v$ and $u_v$ are non-adjacent by the hypothesis. \nIn such a case $S \\subseteq \\Pi_v$, but then $V \\setminus (\\Pi_v \\cup \\{v\\})$ cannot be a full component of $G \\setminus \\Pi_v$, thus contradicting Theorem~\\ref{th:GminusVprime?}.\nAs a result, the graph $G/ va_v$ is planar and prime.\n\n\\medskip\n\\noindent\nIf $tb(G) = 1$ then $tb(G/va_v) = 1$ because tree-breadth is contraction-closed by Lemma~\\ref{lem:contraction-closed}.\nConversely, let us prove that $tb(G/va_v) = 1$ implies $tb(G) = 1$.\nTo show this, let $(T,{\\cal X})$ be a star-decomposition of $G/va_v$, that exists by Lemma~\\ref{lem:dominator-in-bag}, minimizing the number of bags $|{\\cal X}|$ (in particular, $(T,{\\cal X})$ is a reduced tree decomposition).\nAssume moreover $(T,{\\cal X})$ to minimize the number of bags that are not contained into the closed neighbourhood of some vertex in $G$ w.r.t. this property.\nNote that there is a bag of $(T,{\\cal X})$ containing $\\Pi_v$, because since it is a clique of $G/va_v$ the subtrees $T_{a_v},T_{b_v},T_{c_v}$ are pairwise intersecting and so, by the Helly property (Lemma~\\ref{lem:helly}), $T_{a_v} \\cap T_{b_v} \\cap T_{c_v} \\neq \\emptyset$.\nSo, we can add in $(T,{\\cal X})$ a new bag $N_G[v]$, and by making this bag adjacent to any bag of $T_{a_v} \\cap T_{b_v}\\cap T_{c_v}$ one obtains a tree decomposition of $G$ (not necessarily a star-decomposition). \nConsequently, we claim that to prove that $tb(G) = 1$, it suffices to prove that $(T,{\\cal X})$ is a star-decomposition of $G \\setminus v$, for then the above construction leads to a star-decomposition of $G$.\n\nBy contradiction, suppose it is not the case that $(T,{\\cal X})$ is a star-decomposition of $G\\setminus v$.\nSince $G/va_v$ and $G\\setminus v$ only differ in the edge $\\{a_v,c_v\\}$, there must be a bag $B$ of $T_{a_v} \\cap T_{c_v}$ that is only dominated by some of $a_v,c_v$.\nWe make the stronger claim that the bag $B$ has a unique dominator, that is either $a_v$ or $c_v$.\nSince $B$ is only dominated by some of $a_v,c_v$, then in order to prove the claim by contradiction we only need to consider the case when $B \\subseteq N_{G/va_v}[a_v] \\cap N_{G/va_v}[c_v]$.\nRecall that $N_{G/va_v}[a_v] \\cap N_{G/va_v}[c_v] = \\{a_v,b_v,c_v\\}$ by the above remarks (because $(u_v,b_v)$ is an $a_vc_v$-separator of $G \\setminus v$), therefore either $B = \\{a_v,b_v,c_v\\}$ or $B = \\{a_v,c_v\\}$.\nIn the first case ($B = \\{a_v,b_v,c_v\\}$) we have that $B \\subseteq N[b_v]$, thus contradicting the fact that $B$ is only dominated by some of $a_v,c_v$.\nHowever in the second case ($B = \\{a_v,c_v\\}$) the bag $B$ is strictly contained in any bag of the nonempty subtree $T_{a_v} \\cap T_{b_v} \\cap T_{c_v}$, thus contradicting the fact that $(T,{\\cal X})$ is a reduced tree decomposition by minimality of $|{\\cal X}|$. \nTherefore, the claim is proved and so, the bag $B$ has a unique dominator, that is either $a_v$ or $c_v$.\nNote that if $B \\subseteq N_{G/va_v}[c_v]$ then we may further assume that $c_v,u_v$ are nonadjacent, or else by Theorem~\\ref{th:GminusVprime?} $N_{G/va_v}[c_v] = \\{a_v,b_v,c_v,u_v\\}  \\subseteq N[b_v]$ and so, $B \\subseteq N[b_v]$, that would contradict the claim that $B$ is only dominated by some of $a_v,c_v$.\nIn addition, since $a_v$ and $c_v$ play symmetrical roles in the case when $u_v,c_v$ are nonadjacent, let us assume w.l.o.g. that vertex $a_v$ is the sole dominator of the bag $B$.\n\nIn such a case, $N_{G/va_v}(a_v) \\cap N_{G/va_v}(c_v) = \\{b_v\\}$ because $(u_v,b_v)$ is an $a_vc_v$-separator of $G \\setminus v$, so, since $N(c_v) \\setminus (\\Pi_v \\cup \\{v\\}) \\neq \\emptyset$ because $G$ is prime by the hypothesis, the existence of a bag $B'$ containing vertex $c_v$ and adjacent to $B$ follows. \nBy the properties of a tree decomposition, $B \\cap B'$ is a separator of $G/va_v$\nNow, let $C_a$ be the component of vertex $a_v$ in $G \\setminus (b_v,u_v,v)$.\nObserve that $c_v \\notin C_a$ because $(u_v,b_v)$ is an $a_vc_v$-separator of $G \\setminus v$.\nSince $B \\cap B' \\subseteq N_{G/va_v}[a_v] \\subseteq C_a \\cup \\Pi_v$, therefore, $B \\cap B' \\cap C_a \\neq \\emptyset$ or else $B \\cap B'$ would be a clique-separator in $G/va_v$ (impossible since it is a prime graph). \nThere are several cases to be considered depending on the dominators of bag $B'$.\n\n\\begin{itemize}\n\\item If $a_v$ dominates $B'$ then $B,B'$ can be merged into one, thus contradicting the minimality of $|{\\cal X}|$;\n\\item Else, $B'$ must be dominated by one of $b_v$ or $u_v$ because $B \\cap B' \\cap C_a \\neq \\emptyset$, $c_v \\in (B \\cap B') \\setminus C_a$ and $(b_v,u_v)$ separates $c_v$ from $C_a$.\nIn fact, we claim that it cannot be dominated by vertex $u_v$.\nBy contradiction, suppose that it is the case.\nSince $a_v$ and $u_v$ are non-adjacent, therefore, $a_v \\in B \\setminus B'$ and $u_v \\in B' \\setminus B$.\nSo, it follows by the properties of a tree decomposition that $B \\cap B'$ is an $a_vu_v$-separator of $G/va_v$.\nHowever, $B \\cap B' \\subseteq N(a_v) \\cap N(u_v)$, that contradicts the hypothesis that $N_G(a_v) \\cap N_G(u_v)$ is not an $a_vu_v$-separator in the subgraph $G \\setminus (c_v,v)$.\n\nTherefore, $b_v \\in B'$ dominate the bag.\nObserve that if it were the case that there are at least two bags that are both adjacent to $B$ and dominated by $b_v$, then they could all be merged into one without violating the property for $(T,{\\cal X})$ to be a star-decomposition.\nAs a result, by minimality of $|{\\cal X}|$, $B'$ is the unique bag that is both adjacent to $B$ and dominated by $b_v$, whence it is also the unique bag adjacent to $B$ containing vertex $c_v$. \nLet us substitute the two bags $B,B'$ with $B \\setminus c_v, B' \\cup \\{a_v\\}$.\nSince $N_{G/va_v}(a_v) \\cap N_{G/va_v}(c_v) = \\{b_v\\}$, it is still a star-decomposition of $G / va_v$ with equal number of bags $|{\\cal X}|$.\nFurthermore, there is one less bag that is not contained in the closed neighbourhood of some vertex in $G$, thus contradicting the minimality of $(T,{\\cal X})$.\n\\end{itemize}\n\\end{proof}\n\n\\subsubsection{Proof of~\\ref{step:new-clique-sep}~\\ref{step:separation}~\\ref{step:contraction-case} and~\\ref{step:new-clique-sep}~\\ref{step:separation}~\\ref{step:diamond-case}}\n\nIn order to deal with all remaining cases, it will require us to further study the neighbourhood of vertex $b_v$ in the graph.\nObserve that in the following Theorem~\\ref{claim:connect-vertex-b} we needn't prove that the resulting graph $G'$ is prime because it will be proved in Theorem~\\ref{lem:clique-case-2}.\n\n\\begin{theorem}\\label{claim:connect-vertex-b}\nLet $G$ be a prime planar graph, let $v$ be a leaf-vertex of Type 2, $\\Pi_v = (a_v,b_v,c_v)$ be as in Definition~\\ref{def:leafVertex}, and let $u_v \\notin \\Pi_v \\cup \\{v\\}$ be such that $(b_v,u_v)$ is an edge-separator of $G \\setminus v$.   \n\nSuppose $u_v \\in N(c_v) \\setminus N(a_v)$, $N(a_v) \\cap N(u_v)$ is an $a_vu_v$-separator of $G \\setminus (c_v,v)$, and $N(b_v) = \\{a_v,c_v,u_v,v\\}$.\n\nThen, there exists $x \\in (N(a_v) \\cap N(u_v)) \\setminus b_v$ such that the graph $G'$, obtained from $G$ by adding the edge $\\{b_v,x\\}$, is planar and satisfies $tb(G') = 1$ if $tb(G) = 1$.\nMoreover, the vertex $x$ can be found in linear-time.\n\\end{theorem}\n\n\\begin{figure}[h!]\n \\centering\n \\includegraphics[width=0.45\\textwidth]{Fig/planar-clique-removeb.pdf}\n \\caption{Cases when one of Theorem~\\ref{claim:connect-vertex-b} or Theorem~\\ref{lem:clique-case-2} applies and vertex $b_v$ can be eventually contracted to another vertex.}\n \\label{fig:planar-clique-contraction}\n\\end{figure}\n\n\\begin{proof}\nFirst, we claim that $(a_v,u_v)$ is a minimal $2$-separator of $G$.\nIndeed, by the hypothesis $c_v$ and $u_v$ are adjacent, therefore, by Theorem~\\ref{th:GminusVprime?} $N_G(c_v) = \\{b_v,u_v,v\\}$.\nIn addition, $N(b_v) = \\{a_v,c_v,u_v,v\\}$ by the hypothesis.\nLast, since $G$ is prime by the hypothesis, therefore, $N(a_v) \\setminus (\\Pi_v \\cup \\{v\\}) \\neq \\emptyset$, and so, since $a_v$ and $u_v$ are non-adjacent by the hypothesis, $V(G) \\setminus (a_v,b_v,c_v,u_v,v) \\neq \\emptyset$.\nAs a result, $(a_v,u_v)$ is a minimal $2$-separator of $G$ with $\\{b_v,c_v,v\\}$ being a full component of $G \\setminus (a_v,u_v)$.\n\n\nSince $N(a_v) \\cap N(u_v)$ is an $a_vu_v$-separator of $G \\setminus (c_v,v)$ by the hypothesis, therefore, $N(a_v) \\cap N(u_v) \\setminus b_v \\neq \\emptyset$, for it has to contain a vertex from every component of $G \\setminus (a_v,b_v,c_v,u_v,v)$.\nFor now, let $x \\in N(a_v) \\cap N(u_v) \\setminus b_v$ be arbitrary.\nLet us prove that $tb(G) = 1$ implies that $tb(G') = 1$ where $G'$ is obtained by adding an edge between $b_v$ and $x$ (for now, $G'$ may not be planar, depending on the choice for $x$).\nTo prove this, let $(T,{\\cal X})$ be a star-decomposition of $G$, that exists by Lemma~\\ref{lem:dominator-in-bag}, minimizing the distance in $T$ between the subtrees $T_{a_v}$ and $T_{u_v}$.\nWe claim that $T_{a_v} \\cap T_{u_v} \\neq \\emptyset$.\nBy contradiction, if  $T_{a_v} \\cap T_{u_v} = \\emptyset$, then by Corollary~\\ref{cor:strong-sep}, there are two bags $B_{a_v},B_{u_v}$ that are adjacent in $T$ and such that $a_v \\in B_{a_v} \\setminus B_{u_v}, u_v \\in B_{u_v} \\setminus B_{a_v}$ respectively dominate $B_{a_v},B_{u_v}$.\nHowever, this implies by the properties of a tree decomposition that $B_{a_v} \\cap B_{u_v} \\subseteq N(a_v) \\cap N(u_v)$ is an $a_vu_v$-separator of $G$.\nSince the $a_vu_v$-path $(a_v,v,c_v,u_v)$ does not intersect $N(a_v) \\cap N(u_v)$, that is clearly a contradiction, and so, $T_{a_v} \\cap T_{u_v} \\neq \\emptyset$.  \n\nFurthermore, since there is a full component of $G \\setminus (a_v,u_v)$ in the subgraph $G \\setminus (b_v,c_v,v)$, therefore, by Lemma~\\ref{lem:sep-keep} the removal of vertices $b_v,c_v,v$ from all bags in ${\\cal X}$ leads to a tree decomposition $(T,{\\cal X}^-)$ of breadth one of $G \\setminus (b_v,c_v,v)$. \nLet $(T',{\\cal X}')$ be a reduced star-decomposition obtained from $(T,{\\cal X}^-)$, thar exists by Lemma~\\ref{lem:dominator-in-bag}.\nSince the subtrees $T'_{a_v},T'_x,T'_{u_v}$ are pairwise intersecting (because $x \\in N(a_v) \\cap N(u_v)$ and $T_{a_v} \\cap T_{u_v} \\neq \\emptyset$), therefore by the Helly property (Lemma~\\ref{lem:helly}) $T'_{a_v} \\cap T'_x \\cap T'_{u_v} \\neq \\emptyset$.\nLet $B \\in T'_{a_v} \\cap T'_x \\cap T'_{u_v}$.\nTo obtain a star-decomposition of $G'$, it now suffices to make the bag $B$ adjacent to the new bag $N_{G'}[b_v] = \\{a_v,b_v,c_v,u_v,v,x\\}$.\n\n\\medskip\n\\noindent\nThe above result holds for any choice of vertex  $x \\in (N_G(a_v) \\cap N_G(u_v)) \\setminus b_v$.\nLet us finally prove that one such a vertex $x$ exists so that $G'$ is planar.\nIndeed, since $N(a_v) \\cap N(u_v)$ is an $a_vu_v$-separator of $G \\setminus (c_v,v)$ by the hypothesis, therefore, $S := (N(a_v) \\cap N(u_v)) \\cup \\{v\\}$ is an $a_vu_v$-separator of $G$, and in particular it is a minimal $a_vu_v$-separator (because for every vertex $s \\in S$, there is an $a_vu_v$-path that intersects $S$ only in $s$).\nBy Corollary~\\ref{cor:make-sep-cyc}, it can be computed in linear-time a planar supergraph $G_S$ of $G$ so that $S$ induces a cycle of $G_S$. \nThen, let $N_{G_S}(b_v) \\cap S = \\{x,v\\}$, by construction the graph $G'$ is planar for such a choice of vertex $x$.\n\\end{proof}\n\n\nIn Theorem~\\ref{claim:connect-vertex-b}, we show conditions so that vertex $b_v$ can be made adjacent to some other vertex of $N_G(a_v) \\cap N_G(u_v)$.\nLemma~\\ref{claim:sep-b} completes the picture by proving that if it is the case that $N_G(a_v) \\cap N_G(u_v) \\cap N_G(b_v) \\neq \\emptyset$, then $|N_G(a_v) \\cap N_G(u_v) \\cap N_G(b_v)|=1$ and vertex $b_v$ has exactly five neighbours. \n\n\\begin{lemma}\\label{claim:sep-b}\nLet $G$ be a prime planar graph, let $v$ be a leaf-vertex of Type 2, $\\Pi_v = (a_v,b_v,c_v)$ be as in Definition~\\ref{def:leafVertex}, and let $u_v \\notin \\Pi_v \\cup \\{v\\}$ be such that $(b_v,u_v)$ is an edge-separator of $G \\setminus v$. \n\nSuppose $u_v \\in N_G(c_v) \\setminus N_G(a_v)$ and there exists $x \\in N_G(a_v) \\cap N_G(u_v) \\cap N_G(b_v)$.\n\nThen, $N_G(b_v) = \\{a_v,c_v,u_v,v,x\\}$. \n\\end{lemma}\n\n\\begin{figure}[h!]\n\t\\centering\n\t\\includegraphics[width=0.15\\textwidth]{Fig/single-neighbour-b.pdf}\n\t\\caption{Case when $N_G(b_v) \\neq \\{a_v,c_v,u_v,v,x\\}$.}\n\t\\label{fig:single-neighbour-b}\n\\end{figure}\n\n\\begin{proof}\nBy contradiction, let $C$ be a component of $G \\setminus (a_v,b_v,c_v,u_v,v,x)$ such that $b_v \\in N(C)$ (see Figure~\\ref{fig:single-neighbour-b} for an illustration).\nBy Theorem~\\ref{th:GminusVprime?} $N_G(c_v) = \\{b_v,u_v,v\\}$, therefore, $c_v,v \\notin N(C)$.\nIt follows that $N(C)$ is a separator of $G$.\nIn particular, $N(C) \\subseteq \\{a_v,b_v,u_v,x\\}$, so, $a_v,u_v \\in N(C)$ or else $N(C)$ should be a clique-separator of the prime graph $G$.\nAs a result, there is a $K_{3,3}$-minor with $\\{a_v,b_v,u_v\\}$ and $\\{C,x,\\{c_v,v\\}\\}$ being the two sides of the bipartition.\nIt contradicts the fact that $G$ is planar by the hypothesis.\n\\end{proof}\n\n\\begin{theorem}\\label{lem:clique-case-2}\nLet $G$ be a prime planar graph, let $v$ be a leaf-vertex of Type 2, $\\Pi_v = (a_v,b_v,c_v)$ be as in Definition~\\ref{def:leafVertex}, and let $u_v \\notin \\Pi_v \\cup \\{v\\}$ be such that $(b_v,u_v)$ is an edge-separator of $G \\setminus v$. \n\nSuppose $u_v \\in N(c_v) \\setminus N(a_v)$, $N(a_v) \\cap N(u_v)$ is an $a_vu_v$-separator of $G \\setminus (c_v,v)$, and either $N(b_v) = \\{a_v,c_v,u_v,v\\}$ or $N(b_v) \\cap N(a_v) \\cap N(u_v) \\neq \\emptyset$.\n\nThen, there is $x \\in N(a_v) \\cap N(u_v)$ such that one of the following must hold:\n\\begin{itemize}\n\\item $V(G)= \\{a_v,b_v,c_v,u_v,v,x\\}$, and $G$ admits a star-decomposition with two bags $N_G[b_v],N_G[x]$;\n\\item or $\\Pi'=(a_v,x,u_v) \\in {\\cal P}_3(G)$, and let $G'$ be obtained from $G$ by adding the edge $\\{b_v,x\\}$ (if it is not already present) then contracting this edge.\nThe graph $G'$ is planar and prime, furthermore $tb(G) = 1$ if and only if $tb(G') = 1$.\n\\end{itemize}\nMoreover, vertex $x$ can be computed in linear-time.\n\\end{theorem}\n\n\\begin{proof}\nThere are two cases.\nIf $N_G(b_v) = \\{a_v,c_v,u_v,v\\}$, then let $x$ be set as in the statement of Theorem~\\ref{claim:connect-vertex-b}.\nElse, let $x$ be the unique vertex of $N(b_v) \\cap N(a_v) \\cap N(u_v)$, that is well-defined by Lemma~\\ref{claim:sep-b}.\nNote that in both cases, vertex $x$ can be computed in linear-time.\nIn addition, $N(b_v) \\subseteq \\{a_v,c_v,u_v,v,x\\}$ (the latter property following from Lemma~\\ref{claim:sep-b} when $b_v$ and $x$ are adjacent, and being trivial else).\nSuppose for the proof that $V(G) \\neq \\{a_v,b_v,c_v,u_v,v,x\\}$ (else, Theorem~\\ref{lem:clique-case-2} is trivial).\nWe claim that $\\{b_v,c_v,v\\}$ is a component of $G \\setminus \\Pi'$.\nIndeed, $N(b_v) \\subseteq \\Pi' \\cup \\{c_v,v\\}$ by the hypothesis, and by Theorem~\\ref{th:GminusVprime?} $N_G(c_v) = \\{b_v,u_v,v\\}$.\nSince $V(G) \\neq \\{a_v,b_v,c_v,u_v,v,x\\}$, then it indeed follows that $\\Pi' \\in {\\cal P}_3(G)$, with $\\{b_v,c_v,v\\}$ being a component of $G \\setminus \\Pi'$.\n\nLet us prove that $G'$ is prime and planar.\nBy Theorem~\\ref{claim:connect-vertex-b}, adding an edge between $b_v$ and $x$ if it is not already present does not violate the property for the graph $G$ to be planar.\nTherefore, $G'$ is planar because it is obtained by an edge-contraction from some planar graph.\nTo prove that $G'$ is prime, by contradiction suppose the existence of a minimal clique-separator $S'$ of $G'$.\n\nLet us denote by $x'$ the vertex resulting from the contraction of the edge $\\{b_v,x\\}$.\nLet $S := S'$ if $x' \\notin S'$, $S := (S' \\setminus x') \\cup \\{b_v,x\\}$ else.\nBy construction, $S$ is a separator of $G$.\nIn particular, $S$ is not a clique because $G$ is prime by the hypothesis.\nTherefore, $S \\neq S'$, whence $x' \\in S'$ or equivalently, $x,b_v \\in S$.\nWe now claim that $c_v \\in S \\cap S'$ or $v \\in S \\cap S'$ (possibly, $v,c_v \\in S \\cap S')$.\nThere are two cases.\n\n\\begin{itemize}\n\\item Suppose that $S \\setminus b_v$ is a separator of $G$.\nThen, $S \\setminus b_v$ is not a clique because $G$ is prime by the hypothesis.\nSince $S \\setminus (b_v,x) = S' \\setminus x'$ is a clique, there must be some vertex of $S \\setminus (b_v,x) = S \\cap S'$ that is adjacent to $x'$ in $G'$ but non-adjacent to $x$ in $G$.\nConsequently, $v \\in S \\cap S'$ or $c_v \\in S \\cap S'$.\n\\item Else, $S \\setminus b_v$ is not a separator of $G$.\nRecall that by construction, $S$ is a separator of $G$.\nIn particular, there must be two neighbours of $b_v$ in $G$ that are separated by $S$ in $G$.\nSince $N_G(b_v) \\setminus x$ induces the path $(a_v,v,c_v,u_v)$, it follows that $S$ must contain an internal node of the path, whence $c_v \\in S \\cap S'$ or $v \\in S \\cap S'$.\n\\end{itemize}\nHowever, in such case $S'$ must be contained in one of $(a_v,x',v), \\ (v,x',c_v)$ or $(c_v,x',u_v)$, for it is a clique of $G'$.\nIn particular, let $z \\in \\{a_v,u_v\\} \\setminus S'$.\nSince $z$ has a neighbour in every component $C'$ of $G \\setminus \\Pi'$, $\\{z\\} \\cup C'$ is not disconnected by $S'$ in $G'$. \nFurthermore, let us contract $C'$ to $z$ so as to make $a_v$ and $u_v$ adjacent, $S'$ intersects the resulting cycle $(a_v,u_v,c_v,v)$ either in an edge (different from $\\{a_v,u_v\\}$) or a single vertex because it is a clique of $G'$, therefore, $(a_v,u_v,c_v,v) \\setminus S'$ is not disconnected by $S'$.\nAltogether, this contradicts the fact that $S'$ is a separator of $G'$, and so, $G'$ is prime.\n\n\\medskip\n\\noindent\nFinally, let us prove that $tb(G') = 1$ if and only if $tb(G) = 1$.\nIf $tb(G) = 1$, then let us assume $b_v$ and $x$ to be adjacent (if they are not, then Theorem~\\ref{claim:connect-vertex-b} ensures we can add the edge without violating the property for the graph to be of tree-breadth one).\nThen, $tb(G') = 1$ because it is obtained by an edge-contraction from some graph with tree-breadth one and that tree-breadth is contraction-closed by Lemma~\\ref{lem:contraction-closed}.\n\nConversely, let us prove that $tb(G') = 1$ implies that $tb(G) = 1$.\nTo prove this, let $(T,{\\cal X})$ be a star-decomposition of $G'$, that exists by Lemma~\\ref{lem:dominator-in-bag}, minimizing the distance in $T$ between the subtrees $T_{a_v}$ and $T_{u_v}$.\nWe claim that $T_{a_v} \\cap T_{u_v} \\neq \\emptyset$.\nBy contradiction, suppose $T_{a_v} \\cap T_{u_v} = \\emptyset$.\nRecall that $(a_v,x',u_v) \\in {\\cal P}_3(G')$ (because $\\Pi' \\in {\\cal P}_3(G)$)  and $G'$ is prime, therefore one of $(a_v,x',u_v)$ or $(a_v,u_v)$ is a minimal separator of $G'$.\nSince we assume the distance in $T$ between $T_{a_v}$ and $T_{u_v}$ to be minimized, by Corollary~\\ref{cor:strong-sep}, there are two bags $B_{a_v},B_{u_v}$ that are adjacent in $T$ so that $a_v \\in B_{a_v} \\setminus B_{u_v}, u_v \\in B_{u_v} \\setminus B_{a_v}$ respectively dominate $B_{a_v},B_{u_v}$.\nHowever, by the properties of a tree decomposition $B_{a_v} \\cap B_{u_v} \\subseteq N(a_v) \\cap N(u_v)$ is an $a_vu_v$-separator of $G'$, that is impossible due to the existence of the path $(a_v,v,c_v,u_v)$ in $G'$ that does not intersect $N(a_v) \\cap N(u_v)$.\nTherefore, $T_{a_v} \\cap T_{u_v} \\neq \\emptyset$. \nHence the subtrees $T_{a_v},T_{x'},T_{u_v}$ are pairwise intersecting and so, by the Helly Property (Lemma~\\ref{lem:helly}), $T_{a_v} \\cap T_{x'} \\cap T_{u_v} \\neq \\emptyset$.\nFurthermore, $N_{G'}[c_v] \\cup N_{G'}[v] \\subseteq N_{G'}[x']$ by construction. \nSo, let us construct a tree decomposition of $G$ of breadth one as follows.\nFirst, let us remove $c_v$ and $v$ from all bags in ${\\cal X}$.\nSince $N_{G'}[c_v] \\cup N_{G'}[v] \\subseteq N_{G'}[x']$, one obtains a tree decomposition of $G' \\setminus (c_v,v)$ of breadth one.\nThen let us replace $x'$ with $x$ in all bags.\nNote that in so doing, one obtains a tree decomposition of $G \\setminus (b_v,c_v,v)$ of breadth one.\nFinally, let us make adjacent the new bag $N_G[b_v]$ with any bag of $T_{a_v} \\cap T_{x} \\cap T_{u_v}$.\nThe result is indeed a tree decomposition of $G'$ because $N_G[b_v] \\subseteq \\{a_v,b_v,c_v,u_v,v,x\\}$ and $N_G[c_v] \\cup N_G[v] \\subseteq N_G[b_v]$.  \n\\end{proof}\n\n\\subsubsection{Proof of~\\ref{step:new-clique-sep}~\\ref{step:separation}~\\ref{step:no-diamond-case}}\n\n\\begin{theorem}\\label{lem:final-case-1}\nLet $G$ be a prime planar graph, let $v$ be a leaf-vertex of Type 2, $\\Pi_v = (a_v,b_v,c_v)$ be as in Definition~\\ref{def:leafVertex}, and let $u_v \\notin \\Pi_v \\cup \\{v\\}$ be such that $(b_v,u_v)$ is an edge-separator of $G \\setminus v$. \n\nSuppose $u_v \\in N(c_v) \\setminus N(a_v)$, $N(a_v) \\cap N(u_v)$ is an $a_vu_v$-separator in the subgraph $G \\setminus (c_v,v)$, $N(b_v) \\neq \\{a_v,c_v,u_v,v\\}$ and $N(a_v) \\cap N(b_v) \\cap N(u_v) = \\emptyset$.\n\nThen it can be computed in linear-time (a unique) $x \\in N(a_v) \\cap N(u_v)$ such that if $tb(G) = 1$, $N(b_v) \\cap N(x)$ is a $b_vx$-separator and $|N(b_v) \\cap N(x)| \\geq 3$.\n\\end{theorem}\n\n\\begin{proof}\nLet $W = (N(a_v) \\cap N(u_v)) \\cup \\{a_v,c_v,u_v,v\\}$.\nBy the hypothesis, $N(b_v) \\neq \\{a_v,c_v,u_v,v\\}$ and $N(a_v) \\cap N(b_v) \\cap N(u_v) = \\emptyset$, therefore, it exists a component $C_0$ of $G \\setminus W$ such that $b_v \\in N(C_0)$.\nWe claim that there is $x \\in N(a_v) \\cap N(u_v) \\cap N(C_0)$ satisfying that $N(C_0) \\subseteq (a_v,b_v,x)$ or $N(C_0) \\subseteq (u_v,b_v,x)$.\nIndeed, first observe that $v,c_v \\notin N(C_0)$ because by Theorem~\\ref{th:GminusVprime?} $N_G(c_v) = \\{b_v,u_v,v\\}$. \nFurthermore, $a_v \\notin N(C_0)$ or $u_v \\notin N(C_0)$ because $N(a_v) \\cap N(u_v)$ is an $a_vu_v$-separator of $G \\setminus (c_v,v)$ by the hypothesis.\nSo, let $\\{z,z'\\} = \\{a_v,u_v\\}$ satisfy $z' \\notin N(C_0)$.\nSince  $G$ is prime by the hypothesis, and so, biconnected, $G \\setminus z$ is connected.\nFurthermore, $N(C_0) \\setminus z \\subseteq N(z')$ (by the definition of $W$), therefore, $N(C_0) \\setminus z$ is a minimal separator of $G \\setminus z$.\nBy Lemma~\\ref{lem:P3exists} there exist $s,t \\in N(a_v) \\cap N(u_v)$ non-adjacent such that $N(C_0) \\setminus z = \\{s,t\\}$.\nSince $b_v \\in N(C_0)$ by construction, therefore, let us set $\\{s,t\\} = \\{b_v,x\\}$, that finally proves the claim.\n\nWe claim in addition that $x$ does not depend on the choice of the component $C_0$.\nBy contradiction, let $C,C'$ be two components of $G \\setminus W$ such that $b_v \\in N(C) \\cap N(C')$ and let $x,x' \\in N(a_v) \\cap N_G(u_v)$ be distinct and such that $x \\in N(C), \\ x' \\in N(C')$.\nThen, there exists a $K_{3,3}$-minor with $\\{a_v,b_v,u_v\\}$ and $\\{ \\{c_v,v\\}, C \\cup \\{x\\}, C' \\cup \\{x'\\} \\}$ being the sides of the bipartition, that contradicts the hypothesis that $G$ is planar.\nThus from now on, let $x \\in N(a_v) \\cap N(u_v) \\setminus b_v$ be the unique vertex satisfying that for every component $C$ of $G \\setminus W$, if $b_v \\in N(C)$ then $x \\in N(C)$.\n\n\\begin{figure}[h!]\n\t\\centering\n\t\\includegraphics[width=0.25\\textwidth]{Fig/add-chord-to-quadrangle.pdf}\n\t\\caption{Component $C_0$ such that $b_v,x \\in N(C_0)$.}\n\t\\label{fig:add-chord-to-quadrangle}\n\\end{figure}\n\n\\smallskip\nRecall that $C_0$ is a fixed component of $G \\setminus W$ such that $b_v,x \\in N(C_0)$ (see Figure~\\ref{fig:add-chord-to-quadrangle} for an illustration).\nFinally, assume for the remaining of the proof that $tb(G) = 1$ and let us prove that $N(b_v) \\cap N(x)$ is a $b_vx$-separator and $|N(b_v) \\cap N(x)| \\geq 3$.\nTo prove it, we will only need to prove that $N(b_v) \\cap N(x)$ is a $b_vx$-separator of $G$.\nIndeed, in such a case $N(b_v) \\cap N(x) \\cap C_0 \\neq \\emptyset$, and so, $|N(b_v) \\cap N(x)| \\geq 3$ because $a_v,u_v \\in N(b_v) \\cap N(x)$ and $a_v,u_v \\notin C_0$. \n\n\nLet $(T,{\\cal X})$ be star-decomposition of $G$, that exists by Lemma~\\ref{lem:dominator-in-bag}, minimizing the distance in $T$ between the subtrees $T_{b_v}$ and $T_x$.\n\nWe claim that $T_{b_v} \\cap T_x = \\emptyset$.\nBy contradiction, suppose $T_{b_v} \\cap T_x \\neq \\emptyset$.\nLet us prove as an intermediate subclaim that $T_{a_v} \\cap T_{u_v} \\neq \\emptyset$. \nBy contradiction, let $T_{a_v} \\cap T_{u_v} = \\emptyset$. \nBy the properties of a tree decomposition, every bag $B$ onto the path in $T$ between $T_{a_v}$ and $T_{u_v}$ must contain $N(a_v) \\cap N(u_v)$ and at least one of $v$ or $c_v$.\nIf $c_v \\in B$ then $B \\subseteq N[u_v]$ since $N(c_v) = \\{b_v,u_v,v\\}$ and $x \\in B$.\nSimilarly if $v \\in B$ then $B \\subseteq N[a_v]$ since $N(v) = \\{a_v,b_v,c_v\\}$ and $x \\in B$.\nConsequently, there are two adjacent bags $B_{a_v},B_{u_v}$ such that $a_v \\in B_{a_v} \\setminus B_{u_v}$ and $u_v \\in B_{u_v} \\setminus B_{a_v}$ respectively dominate $B_{a_v}$ and $B_{u_v}$.\nHowever, by the properties of a tree decomposition, $B_{a_v} \\cap B_{u_v} = N(a_v) \\cap N(u_v)$ is an $a_vu_v$-separator of $G$, thus contradicting the existence of the path $(a_v,v,c_v,u_v)$ in $G$.\nTherefore, it follows that $T_{a_v} \\cap T_{u_v} \\neq \\emptyset$, that proves the subclaim.\n\nIf $T_{a_v} \\cap T_{u_v} \\neq \\emptyset$ and $T_{b_v} \\cap T_x \\neq \\emptyset$ then the subtrees $T_{a_v},T_{b_v},T_{u_v},T_x$ are pairwise intersecting and so, it implies $T_{a_v} \\cap T_{u_v} \\cap T_{b_v} \\cap T_x \\neq \\emptyset$ by the Helly property (Lemma~\\ref{lem:helly}).\nHowever, let $B' \\in T_{a_v} \\cap T_{u_v} \\cap T_{b_v} \\cap T_x$, no vertex in $G$ can dominate $B'$ because $N(b_v) \\cap N(a_v) \\cap N(u_v) = \\emptyset$ by the hypothesis, thus contradicting the fact that $(T,{\\cal X})$ is a star-decomposition.\nAs a result, we proved the claim that $T_{b_v} \\cap T_x = \\emptyset$.\n\nFinally, since there exists $S \\subseteq (N(b_v) \\cap N(x)) \\cup \\{b_v,x\\}$ a minimal separator of $G$ such that $b_v,x \\in S$ (namely, $S := N(C_0)$), and $(T,{\\cal X})$ is assumed to minimize the distance in $T$ between $T_{b_v}$ and $T_x$, by Corollary~\\ref{cor:strong-sep} there exist two adjacent bags $B_{b_v},B_x$ such that $b_v \\in B_{b_v} \\setminus B_x, \\ x \\in B_x \\setminus B_{b_v}$ respectively dominate $B_{b_v}$ and $B_x$.\nBy the properties of a tree decomposition, $B_{b_v} \\cap B_x = N(b_v) \\cap N(x)$ is indeed a $b_vx$-separator of $G$. \n\\end{proof}\n\n\\begin{lemma}\\label{claim:final-case-2}\nLet $G$ be a prime planar graph, let $v$ be a leaf-vertex of Type 2, $\\Pi_v = (a_v,b_v,c_v)$ be as in Definition~\\ref{def:leafVertex}, and let $u_v \\notin \\Pi_v \\cup \\{v\\}$ be such that $(b_v,u_v)$ is an edge-separator of $G \\setminus v$. \n\nSuppose $u_v \\in N(c_v) \\setminus N(a_v)$, $N(a_v) \\cap N(u_v)$ is an $a_vu_v$-separator in the subgraph $G \\setminus (c_v,v)$, $N(b_v) \\neq \\{a_v,c_v,u_v,v\\}$ and $N(a_v) \\cap N(b_v) \\cap N(u_v) = \\emptyset$.\nAssume furthermore that there is $x \\in N(a_v) \\cap N(u_v)$, and there exists a leaf-vertex $l \\in N(b_v) \\cap N(x)$.\n\nThen, $l$ is a leaf-vertex of Type 1, or $l$ is a leaf-vertex of Type 2 or 3 and $G \\setminus l$ is prime.\n\\end{lemma}\n\n\\begin{figure}[h!]\n \\centering\n \\includegraphics[width=0.65\\textwidth]{Fig/planar-clique-new-leaf.pdf}\n \\caption{Existence of a leaf-vertex in $N(b_v) \\cap N(x)$.}\n \\label{fig:planar-clique-new-leaf}\n\\end{figure}\n\n\\begin{proof}\nSuppose for the proof that $l$ is not of Type 1 (else, Lemma~\\ref{claim:final-case-2} is trivial).\nThen, $l$ is of Type 2 or 3, let $\\Pi_l$ be as in Definition~\\ref{def:leafVertex}.\nNote that $l \\neq a_v$ because $v,b_v,x \\in N(a_v)$ do not induce a path, similarly $l \\neq u_v$ because $b_v,c_v,x \\in N(u_v)$ do not induce a path.\nFurthermore by the hypothesis, $b_v$ and $x$ are the two endpoints of $\\Pi_l$.\nSuppose by way of contradiction that there is a minimal clique-separator $S$ of $G \\setminus l$.\nSince $G$ is prime by the hypothesis, by Lemma~\\ref{lem:separatorInCompo} $S$ is a $b_vx$-separator of $G \\setminus l$.\nHowever, it implies that $a_v,u_v \\in S$, that contradicts the fact that $S$ is a clique.\nAs a result, $G \\setminus l$ is prime.   \n\\end{proof}\n\nEquipped with Lemma~\\ref{claim:final-case-2}, we can assume from now on that there is no leaf-vertex that is adjacent to both vertices $b_v,x$, or else it could be immediately processed by the algorithm.\n\n\\begin{theorem}\\label{lem:final-case-3}\nLet $G$ be a prime planar graph, let $v$ be a leaf-vertex of Type 2, $\\Pi_v = (a_v,b_v,c_v)$ be as in Definition~\\ref{def:leafVertex}, and let $u_v \\notin \\Pi_v \\cup \\{v\\}$ be such that $(b_v,u_v)$ is an edge-separator of $G \\setminus v$. \n\nSuppose $u_v \\in N(c_v) \\setminus N(a_v)$, $N(a_v) \\cap N(u_v)$ is an $a_vu_v$-separator in the subgraph $G \\setminus (c_v,v)$, $N(b_v) \\neq \\{a_v,c_v,u_v,v\\}$ and $N(a_v) \\cap N(b_v) \\cap N(u_v) = \\emptyset$.\nAssume furthermore that there is $x \\in N(a_v) \\cap N(u_v)$ such that $N(b_v) \\cap N(x)$ is a $b_vx$-separator, $|N(b_v) \\cap N(x)| \\geq 3$, and there is no leaf-vertex in $N(b_v) \\cap N(x)$.\n\nThen, there exist $y,z \\in N(b_v) \\cap N(x)$ non-adjacent such that the graph $G'$, obtained from $G$ by making $y,z$ adjacent, is planar and prime, and it holds $tb(G) = 1$ if and only if $tb(G') = 1$.\nFurthermore, the pair $y,z$ can be computed in linear-time.\n\\end{theorem}\n\n\\begin{figure}[h!]\n \\centering\n \\includegraphics[width=0.25\\textwidth]{Fig/planar-clique-add-edge.pdf}\n \\caption{Illustration of Theorem~\\ref{lem:final-case-3}.}\n \\label{fig:planar-clique-add-edge}\n\\end{figure}\n\n\\begin{proof}\nLet us first show how to find the pair $y,z$.\nLet $W = \\{a_v,c_v,v,u_v\\} \\cup (N(a_v) \\cap N(u_v))$. \nChoose any component $C_0$ of $G \\setminus W$ such that $b_v,x \\in N(C_0)$ and $N(C_0) \\subseteq (a_v,b_v,x)$ or $N(C_0) \\subseteq (u_v,b_v,x)$ (the existence of such a component has been proved in Theorem~\\ref{lem:final-case-1}).\nNote that $N(b_v) \\cap N(x) \\cap C_0 \\neq \\emptyset$ since $N(b_v) \\cap N(x)$ is a $b_vx$-separator of $G$ by the hypothesis.\n\n\n\n\n\nThen, let $S := N(b_v) \\cap N(x)$. \nBy the hypothesis $S$ is a minimal separator of $G$ and $|S| \\geq 3$, therefore, by Corollary~\\ref{cor:make-sep-cyc} there is a planar supergraph $G_S$ of $G$ so that $S$ induces a cycle of $G_S$.\nFurthermore, $G_S$ can be computed in linear-time.\nLet $P$ be an $a_vu_v$-path of the cycle $G_S[S]$ that intersects $C_0$.\nSince by the above claim $a_v \\notin N_G(C_0)$ or $u_v \\notin N_G(C_0)$, therefore, there is $y \\in C_0 \\cap V(P)$, there is $z$ adjacent to vertex $y$ in $P$ so that either $z \\in C_1$ for some component $C_1$ of $G \\setminus (W \\cup C_0)$ or $z \\in \\{a_v,u_v\\} \\setminus N_G(C_0)$. \nIn particular, $z \\notin N_G[C_0] = C_0 \\cup N_G(C_0)$.\nMoreover, the graph $G'$, obtained from $G$ by adding an edge between $y$ and $z$, is planar by construction.\n\n\\begin{claim}\n\\label{claim:gprime-prime-2}\n$G'$ is prime.\n\\end{claim}\n\n\\begin{proofclaim}\nBy contradiction, let $X$ be a minimal clique-separator of $G'$.\nSince $G'$ is a supergraph of $G$, $X$ is a separator of $G$.\nAs a result, $y,z \\in X$ because $G$ is prime by the hypothesis.\n\nLet us prove as an intermediate step that $N(y) \\cap N(z) = \\{b_v,x\\}$.\nThere are two cases.\nIf $z \\in \\{a_v,u_v\\}$, then let $\\{z,z'\\} = \\{a_v,u_v\\}$.\nSince $N(C_0) \\subseteq (z',b_v,x)$ (because $z \\notin N_G(C_0)$) and $z,z'$ are non-adjacent by the hypothesis, therefore, the claim immediately follows in this case.\nElse, $z \\notin \\{a_v,u_v\\}$.\nLet $C_1$ be the component of $G \\setminus (W \\cup C_0)$ containing $z$.\nIn such case, $b_v,x \\in N(C_1)$ because $z \\in S$ by construction.\nTherefore, $N(C_1) \\subseteq (a_v,b_v,x)$ or $N(C_1) \\subseteq (u_v,b_v,x)$ because the respective roles of components $C_0,C_1$ are symmetrical in this case.\nSuppose by way of contradiction $N(C_0) = N(C_1) = \\{s,b_v,x\\}$ for some $s \\in \\{a_v,u_v\\}$ and let $\\{s,t\\} = \\{a_v,u_v\\}$. \nThen, there is a $K_{3,3}$-minor of $G$ with $\\{b_v,x,s\\}$ and $\\{C_0,C_1,\\{c_v,v,t\\}\\}$ being the sides of the bipartition, that contradicts the hypothesis that $G$ is planar.\nAs a result, $N(C_0) \\cap N(C_1) = \\{b_v,x\\}$, that finally proves the claim.\n\nSince $X$ is assumed to be a clique of $G'$ and $y,z \\in X$, it follows $X \\subseteq \\{b_v,y,z\\}$ or $X \\subseteq \\{x,y,z\\}$.\nConsequently, $G[W \\setminus X]$ is connected because $a_v,u_v \\notin X$ is a dominating pair of $W$, $b_v,x \\in N(a_v) \\cap N(u_v)$ and $b_v \\notin X$ or $x \\notin X$. \nHowever, since $y,z \\in X$ and $N_G(y) \\subseteq W \\cup C_0$, then in such case there must be a component $A$ of $G \\setminus X$ so that $A \\subset C_0$.  \nSince $z \\notin N_G[C_0]$ by construction, $N_G(A) \\subseteq X \\setminus z$ is a clique-separator of $G$, thus contradicting the hypothesis that $G$ is prime.\nAs a result, $G'$ is prime.\n\\end{proofclaim}\n\nNow, let us prove $tb(G) = 1$ if and only if $tb(G') = 1$.\n\nIf $tb(G) = 1$, then let $(T,{\\cal X})$ be star-decomposition of $G$, that exists by Lemma~\\ref{lem:dominator-in-bag}, minimizing the distance in $T$ between $T_{a_v}$ and $T_{u_v}$.\nLet us prove that $(T,{\\cal X})$ is a star-decomposition of $G'$, whence $tb(G') = 1$.\nTo prove it, it is sufficient to prove $T_y \\cap T_z \\neq \\emptyset$.\nWe will prove as an intermediate claim that $T_{a_v} \\cap T_{u_v} \\neq \\emptyset$.\nBy contradiction, assume $T_{a_v} \\cap T_{u_v} = \\emptyset$.\nObserve that $\\Pi' = (a_v,b_v,u_v) \\in {\\cal P}_3(G)$ with $\\{c_v,v\\}$ being a full component of $G \\setminus \\Pi'$.\nTherefore, since $G$ is prime by the hypothesis, one of $\\Pi'$ or $\\Pi' \\setminus b_v$ is a minimal separator of $G$.\nSince $(T,{\\cal X})$ is assumed to minimize the distance in $T$ between $T_{a_v}$ and $T_{u_v}$, therefore, by Corollary~\\ref{cor:strong-sep} there are two adjacent bags $B_{a_v},B_{u_v}$ such that $a_v \\in B_{a_v} \\setminus B_{u_v}$ and $u_v \\in B_{u_v} \\setminus B_{a_v}$ respectively dominate $B_{a_v}$ and $B_{u_v}$.\nHowever, by the properties of a tree decomposition $B_{a_v} \\cap B_{u_v} = N(a_v) \\cap N(u_v)$ is an $a_vu_v$-separator of $G$, that contradicts the existence of the path $(a_v,v,c_v,u_v)$ in $G$.\nConsequently the claim is proved, hence $T_{a_v} \\cap T_{u_v} \\neq \\emptyset$. \nThe latter claim implies $T_{b_v} \\cap T_{x} = \\emptyset$, for if $T_{b_v} \\cap T_x \\neq \\emptyset$ then the subtrees $T_{a_v},T_{b_v},T_{u_v},T_x$ are pairwise intersecting, hence $T_{a_v} \\cap T_{b_v} \\cap T_x \\cap T_{u_v} \\neq \\emptyset$ by the Helly property (Lemma~\\ref{lem:helly}), that would contradict the fact that $(T,{\\cal X})$ is a star-decomposition because $N(a_v) \\cap N(u_v) \\cap N(b_v) = \\emptyset$ by the hypothesis.\nFinally, since $(x,y,b_v,z)$ induces a cycle of $G$ and $T_{b_v} \\cap T_x = \\emptyset$, therefore, by the properties of a tree decomposition $T_y \\cap T_z \\neq \\emptyset$, and so, $(T,{\\cal X})$ is indeed a star-decomposition of $G'$.\n\n\n\\smallskip\nConversely, let us prove $tb(G') = 1$ implies $tb(G) = 1$.\nTo prove it, let $(T',{\\cal X}')$ be a star-decomposition of $G'$, that exists by Lemma~\\ref{lem:dominator-in-bag}, minimizing the number $|{\\cal X}'|$ of bags.\nAssume furthermore $(T',{\\cal X}')$ to minimize the number of bags $B \\in {\\cal X}'$ that are not contained into the closed neighbourhood of some vertex in $G$ w.r.t. the minimality of $|{\\cal X}'|$. \nIn order to prove $tb(G) = 1$, it suffices to prove that $(T',{\\cal X}')$ is a star-decomposition of $G$.\nWe will start proving intermediate claims.\n\n\\begin{claim}\n\\label{claim:neighbours-y}\n$a_v,u_v \\notin N_G(y)$.\n\\end{claim}\n\n\\begin{proofclaim}\nBy contradiction, assume the existence of $z' \\in \\{a_v,u_v\\}$ so that $z'$ and $y$ are adjacent in $G$.\nIn particular, $z' \\neq z$ (since $z \\notin N_G[C_0]$) and $N_G(C_0) = \\{b_v,x,z'\\}$ since either $N_G(C_0) \\subseteq \\{b_v,x,a_v\\}$ or $N_G(C_0) \\subseteq \\{b_v,x,u_v\\}$. \nHence, the path $(b_v,z',x)$ is a separator of $G$.\nSince $y \\in N_G(b_v) \\cap N_G(z') \\cap N_G(x)$, by Lemma~\\ref{lem:common-neighbour} either $C_0$ is reduced to $y$ or $(b_v,y,x) \\in  {\\cal P}_3(G)$ separates $z'$ from $C_0 \\setminus y$.\nThe case $C_0 \\setminus y = \\emptyset$ implies that $y$ is a leaf-vertex of Type 2, that contradicts the hypothesis that there is no leaf-vertex in $N_G(b_v) \\cap N_G(x)$.\nTherefore, let $(b_v,y,x) \\in {\\cal P}_3(G)$ separates $z'$ from $C_0 \\setminus y$ in $G$, and let $C_0' \\subseteq C_0 \\setminus y$ be a component of $G \\setminus (b_v,y,x)$ (such a component $C_0'$ exists because $N_G(C_0) = \\{z',b_v,x\\}$).\nSince $G$ is prime, $b_v,x \\in N_G(C_0')$ (indeed, neither $b_v$ nor $y$ nor $x$ nor $(b_v,y)$ nor $(y,x)$ can be a separator of $G$).\nTherefore, $N_G(b_v) \\cap N_G(x) \\cap C_0' \\neq \\emptyset$ because $N_G(b_v) \\cap N_G(x)$ is a $b_vx$-separator of $G$ by the hypothesis.\nFurthermore, $y \\in N_G(C_0')$ because $C_0$ is connected.\n\n\nHowever in such case, there is a $K_{3,3}$-minor of $G'$ with $\\{b_v,x,y\\}$ and $\\{a_v,C_0',u_v\\}$ being the sides of the bipartition, that contradicts the fact that $G'$ is planar.\n\\end{proofclaim}\n\n\\begin{claim}\n\\label{claim:no-dominator-for-cycle}\nThere is no vertex dominating the cycle $(a_v,b_v,u_v,x)$ in $G'$.\n\\end{claim}\n\n\\begin{proofclaim}\nBy contradiction, if it were the case that such a vertex exists, then, since $N_G(b_v) \\cap N_G(a_v) \\cap N_G(u_v) = \\emptyset$ by the hypothesis, the dominator should be $y$ and furthermore $z \\in \\{a_v,u_v\\}$.\nIn particular, $y \\in N_G(b_v) \\cap N_G(x) \\cap N_G(z')$ with $\\{z,z'\\} = \\{a_v,u_v\\}$, thus contradicting Claim~\\ref{claim:neighbours-y}. \n\n\n\n\n\n\n\n\n\\end{proofclaim} \n\n\\begin{claim}\n\\label{claim:crossing-subtrees}\n$T'_{a_v} \\cap T'_{u_v} \\neq \\emptyset$.\n\\end{claim}\n\n\\begin{proofclaim}\nBy contradiction, let $T'_{a_v} \\cap T'_{u_v} = \\emptyset$. \nBy the properties of a tree decomposition, every bag $B$ onto the path in $T'$ between $T'_{a_v}$ and $T'_{u_v}$ (including the endpoints) must contain $N_{G'}(a_v) \\cap N_{G'}(u_v)$ and at least one of $v$ or $c_v$.\nThen, if $c_v \\in B$ then $B \\subseteq N_{G'}[u_v]$ and so, $B \\in T'_{u_v}$, since $N_{G'}(c_v) = \\{b_v,u_v,v\\}$ and $x \\in B$.\nSimilarly if $v \\in B$ then $B \\subseteq N_{G'}[a_v]$ and so, $B \\in T'_{a_v}$, since $N_{G'}(v) = \\{a_v,b_v,c_v\\}$ and $x \\in B$.\nConsequently, there are two adjacent bags $B_{a_v},B_{u_v}$ such that $a_v \\in B_{a_v} \\setminus B_{u_v}$ and $u_v \\in B_{u_v} \\setminus B_{a_v}$ respectively dominate $B_{a_v}$ and $B_{u_v}$ in $G'$.\nHowever, by the properties of a tree decomposition, $B_{a_v} \\cap B_{u_v} = N_{G'}(a_v) \\cap N_{G'}(u_v)$ is an $a_vu_v$-separator of $G'$, thus contradicting the existence of the path $(a_v,v,c_v,u_v)$ in $G'$.\nTherefore, it follows that $T'_{a_v} \\cap T'_{u_v} \\neq \\emptyset$, that proves the claim.\n\\end{proofclaim}\n\n\\begin{claim}\n\\label{claim:disjoint-subtrees}\n$T'_{b_v} \\cap T'_x = \\emptyset$\n\\end{claim}\n\n\\begin{proofclaim}\nSuppose for the sake of contradiction that $T'_{b_v} \\cap T'_x \\neq \\emptyset$.\nBy Claim~\\ref{claim:crossing-subtrees}, $T'_{a_v} \\cap T'_{u_v} \\neq \\emptyset$, and so, the subtrees $T'_{a_v},T'_{b_v},T'_{u_v},T'_x$ are pairwise intersecting.\nHence by the Helly property (Lemma~\\ref{lem:helly}), $T'_{a_v} \\cap T'_{b_v} \\cap T'_{u_v} \\cap T'_x \\neq \\emptyset$.\nHowever in such case, since $(T',{\\cal X}')$ is a star-decomposition of $G'$ there must be a vertex dominating the cycle $(a_v,b_v,u_v,x)$ in $G'$, thereby contradicting Claim~\\ref{claim:no-dominator-for-cycle}. \n\\end{proofclaim}\n\nAs a result, $T'_{a_v} \\cap T'_{u_v} \\neq \\emptyset$ by Claim~\\ref{claim:crossing-subtrees} and $T'_{b_v} \\cap T'_x = \\emptyset$ by Claim~\\ref{claim:disjoint-subtrees}.\n\nFinally, suppose by way of contradiction $(T',{\\cal X}')$ is not a star-decomposition of $G$.\nIn such case, since $G$ and $G'$ only differ in the edge $\\{y,z\\}$, there must exist $B \\in T'_y \\cap T'_z$ that is uniquely dominated by some of $y,z$ in $G'$.\nMore precisely, let us prove that only one of $y,z$ can dominate $B$.\nBy contradiction, suppose $B \\subseteq N_{G'}[y] \\cap N_{G'}[z] = \\{b_v,x,y,z\\}$ (indeed, $y \\in C_0$ whereas $z \\notin N_G[C_0]$).\nSince $T'_{b_v} \\cap T'_x = \\emptyset$ by Claim~\\ref{claim:disjoint-subtrees}, $B \\subseteq \\{b_v,y,z\\}$ or $B \\subseteq \\{x,y,z,\\}$.\nTherefore, $B$ is a clique of $G'$.\nHowever, since $B \\neq V(G')$, there is a bag $B'$ adjacent to $B$ and by the properties of a tree decomposition $B \\cap B'$ is a clique-separator of $G'$, thus contradicting the fact that $G'$ is prime by Claim~\\ref{claim:gprime-prime-2}.\nConsequently, either $B \\subseteq N_{G'}[y]$ or $B \\subseteq N_{G'}[z]$, and either $B \\not\\subseteq N_{G'}[y]$ or $B \\not\\subseteq N_{G'}[z]$.\nIn the following, let $\\{s,t\\} = \\{y,z\\}$ satisfy $B \\subseteq N_{G'}[s]$, that is well-defined.\nLet $B'$ be any bag adjacent to $B$ so that $t \\in B'$ (such bag exists because $y,z \\in N(b_v) \\cap N(x)$, and $b_v \\notin B$ or $x \\notin B$ because $T'_{b_v} \\cap T'_x = \\emptyset$).\nThere are three cases.\n\n\\begin{itemize}\n\\item Suppose no vertex of $b_v,x,y,z$ dominates $B'$ in $G'$ (see Figure~\\ref{fig:very-last-case} for an illustration).\nSince $b_v \\notin B$ or $x \\notin B$ because $T'_{b_v} \\cap T'_x = \\emptyset$, therefore, $(B \\cap B') \\setminus (b_v,x,y,z) \\neq \\emptyset$, or else by the properties of a tree decomposition that would be a clique-separator of $G'$, thus contradicting the fact that $G'$ is prime by Claim~\\ref{claim:gprime-prime-2}.  \nLet $t' \\in (B \\cap B') \\setminus (b_v,x,y,z)$.\nNote that $t'$ and $t$ are non-adjacent in $G'$ because $t' \\in N_{G'}[s]$ and $N_{G'}[y] \\cap N_{G'}[z] = \\{b_v,x,y,z\\}$.\nLet $s' \\in B'$ dominate this bag.\nNote that $s'$ and $s$ are non-adjacent in $G'$ because we assume $s' \\notin \\{b_v,x,y,z\\}$, $t \\in N_{G'}(s')$ and $N_{G'}[y] \\cap N_{G'}[z] = \\{b_v,x,y,z\\}$.\nIn particular, $s' \\neq t'$ and $(s,t',s',t)$ induces a path in $G$. \nBy construction, $y \\in C_0$ and $z \\notin N_G[C_0]$, hence there must be some of $s',t'$ in $N_G(C_0)$. \nSince $N_G(C_0) \\subseteq \\{a_v,b_v,u_v,x\\}$ and $s',t' \\notin \\{b_v,x,y,z\\}$, therefore the pairs $\\{s',t'\\}$ and $\\{a_v,u_v\\}$ intersect.\nHowever, by Claim~\\ref{claim:neighbours-y} $a_v,u_v \\notin N_G(y)$, similarly $a_v,u_v \\notin N_G(z)$, that contradicts the existence of the path $(s,t',s',t)$ in $G$.\nConsequently, assume in the remaining cases that there is some vertex of $b_v,x,y,z$ dominating $B'$ in $G'$.\n\n\\begin{figure}[h!]\n\t\\centering\n\t\\includegraphics[width=0.25\\textwidth]{Fig/very-last-case.pdf}\n\t\\caption{$B \\subseteq N_{G'}[s]$, $B' \\subseteq N_{G'}[s']$.}\n\t\\label{fig:very-last-case}\n\\end{figure}\n\n\\item Suppose $B'$ is dominated by one of $y,z$ in $G'$.\nWe claim that $B$ and $B'$ are dominated by the same vertex of $y,z$, for if it were not the case $B \\cap B' \\subseteq N_{G'}[y] \\cap N_{G'}[z] = \\{b_v,x,y,z\\}$, and so, since by the properties of a tree decomposition $B \\cap B'$ is a separator of $G'$, and $b_v \\notin B$ or $x \\notin B$ because $T'_{b_v} \\cap T'_x = \\emptyset$, $B \\cap B'$ should be a clique-separator of $G'$, thus contradicting the fact that $G'$ is prime by Claim~\\ref{claim:gprime-prime-2}. \nHowever, in such a case bags $B,B'$ could be merged into one while preserving the property for the tree decomposition to be a star-decomposition of $G'$, that would contradict the minimality of $|{\\cal X}'|$.\n\\item Therefore, $B'$ is dominated by some of $b_v,x$. \nWe claim that there is a unique such bag $B'$ that is adjacent to $B$.\nBy contradiction, let $B'' \\neq B'$ be adjacent to $B$ and such that $B''$ is also dominated by some of $b_v,x$.\nIn particular, if $B''  \\cup B' \\subseteq N[b_v]$ or $B'' \\cup B' \\subseteq N[x]$ then both bags $B',B''$ could be merged into one without violating the property for the tree decomposition to be a star-decomposition of $G'$, that would contradict the minimality of $|{\\cal X}'|$.\nElse, w.l.o.g. $B' \\subseteq N[b_v]$ and $B'' \\subseteq N[x]$.\nSince $T'_{b_v} \\cap T'_x = \\emptyset$, $a_v,u_v \\in N(b_v) \\cap N(x)$ and $B',B''$ are adjacent to $B$, therefore, by the properties of the tree decomposition $a_v,u_v \\in B$.\nHowever, $a_v,u_v \\notin N_G[y]$ by Claim~\\ref{claim:neighbours-y}, $a_v$ and $u_v$ are non-adjacent, and either $z \\in \\{a_v,u_v\\}$ or $a_v,u_v \\notin N_G[z]$ (by the same proof as for Claim~\\ref{claim:neighbours-y}), thus contradicting the fact that either $B \\subseteq N_{G'}[y]$ or $B \\subseteq N_{G'}[z]$.\nHence, the claim is proved and $B'$ is assumed to be the unique bag adjacent to $B$ such that $B \\subseteq N[b_v]$ or $B \\subseteq N[x]$.   \nIn particular, $B'$ is the unique bag adjacent to $B$ containing vertex $t$ (recall that $\\{s,t\\} = \\{y,z\\}$ and $B \\subseteq N_{G'}[s]$, $B \\not\\subseteq N_{G'}[t]$).\n\nLet us substitute the bags $B,B'$ with $B \\setminus t, B' \\cup \\{s\\}$.\nWe claim that this operation keeps the property for $(T',{\\cal X}')$ to be a star-decomposition of $G'$.\nTo prove the claim, first note that the operation only modifies bags $B$ and $B'$, furthermore $B \\setminus t \\subseteq N[s]$ and $B' \\cup \\{s\\} \\subseteq N[b_v]$ or $B' \\cup \\{s\\} \\subseteq N[x]$.\nConsequently, to prove the claim, it suffices to prove that the operation keeps the property for $(T',{\\cal X}')$ to be a tree decomposition of $G'$ (for in such a case, it is always a star-decomposition).\nSince $T'_t \\setminus B$ is connected because $B'$ is the only bag containing vertex $t$ that is adjacent to the bag $B$, therefore, we are left to prove that there is no $w \\in N_{G'}(t) \\setminus s$ such that $T'_w \\cap T'_t = \\{B\\}$.\nBy contradiction, let $w \\in N_{G'}(t) \\setminus s$ satisfy $T'_w \\cap T'_t = \\{B\\}$.\nSince $w \\in B \\subseteq N_{G'}[s]$, therefore $w \\in N_{G'}(s) \\cap N_{G'}(t) = N_{G}(y) \\cap N_G(z) = \\{b_v,x\\}$.\nMoreover, $w \\notin B'$ because $t \\in B'$ and we assume that $T'_w \\cap T'_t = \\{B\\}$.\nIn such a case, since it is assumed that $B' \\subseteq N[b_v]$ or $B' \\subseteq N[x]$, and in addition $T'_x \\cap T'_{b_v} = \\emptyset$, let us write $\\{w,w'\\} = \\{b_v,x\\}$ such that $w \\in B \\setminus B', \\ w' \\in B' \\setminus B$ and $B' \\subseteq N_{G'}[w']$.\nBy the properties of a tree decomposition, $B \\cap B'$ is a $b_vx$-separator of $G'$, so, $a_v,u_v \\in B \\cap B'$.\nHowever, $a_v,u_v \\notin N_G(y)$ by Claim~\\ref{claim:neighbours-y} and similarly $a_v,u_v \\notin N_G(z)$, that contradicts the fact that $B \\subseteq N_{G'}[s]$ for some $s \\in \\{y,z\\}$.\nThis finally proves the claim that substituting the bags $B,B'$ with $B \\setminus t, B' \\cup \\{s\\}$ keeps the property for $(T',{\\cal X}')$ to be a star-decomposition of $G'$.\n\nHowever, the above operation does not increase the number of bags $|{\\cal X}'|$, furthermore there is one less bag that is not contained in the closed neighbourhood of some vertex in $G$.\nThis contradicts the minimality of $(T',{\\cal X}')$ w.r.t. these two properties.\n\\end{itemize} \nAs a result, we proved by contradiction that $(T',{\\cal X}')$ is a star-decomposition of $G$, hence $tb(G) = 1$.\n\\end{proof}\n\n\\subsection{Complexity of Algorithm \\texttt{Leaf-BottomUp}}\n\nTo complete this section, let us emphasize on some computational aspects of Algorithm \\texttt{Leaf-BottomUp}, that will ensure the quadratic-time complexity of the algorithm.\n\nWe here assume that the planar graph $G$ is encoded with adjacency lists.\nNote that the adjacency lists can be updated in linear-time before each recursive call to the algorithm.\n\nWe will need as a routine to test whether two vertices are adjacent in \\emph{constant-time}.\nIn order to achieve the goal, the following result (relying upon the bounded degeneracy of planar graphs) will be used:\n\n\\begin{lemma}[~\\cite{Chrobak91}]\nThere exists a data structure such that each entry in the adjacency matrix of a planar graph can be looked up in constant time. \nThe data structure uses linear storage, and can be constructed in linear time.\n\\end{lemma}\n\n\\subsubsection{Finding a leaf-vertex}\n\\label{sec:complexity-leaf-vertex}\n\nAt each call to the algorithm, it is first required to decide whether a leaf-vertex exists.\nIf that is the case, then one such a vertex must be computed.\nHere is a way to achieve the goal in linear-time.\nLet us start computing the degree sequence of $G$, then let us order the vertices of the graph $G$ by increasing degree.\n\n\\paragraph{Finding a leaf-vertex of Type 1.}\nLet $v$ be any vertex of degree at least four.\nWe claim that a necessary condition for $v$ to be a leaf-vertex of Type 1 is that all but at most two neighbours of $v$ have degree four.\nIndeed, if $v$ is a leaf-vertex of Type 1, then let $\\Pi_v, d_v$ be defined as in Definition~\\ref{def:leafVertex}.\nBy Lemma~\\ref{lem:ends-separate}, either $V(G) = N[v] \\cup \\{d_v\\}$ or $\\Pi' = (a_v,d_v,c_v) \\in {\\cal P}_3(G)$ and $N[v] \\setminus (a_v,c_v)$ is a full component of $G \\setminus \\Pi'$. \nIn both cases, all neighbours in $N(v) \\setminus (a_v,c_v)$ have degree four.\n\n\\begin{itemize}\n\\item Therefore, let us count the number of neighbours of degree four in $N(v)$, that can be done in ${\\cal O}(deg(v))$-time simply by traversing the adjacency list of vertex $v$ (recall that the degree sequence of $G$ has been computed).\n\n\\item If there are all but at most two neighbours in $N(v)$ that have degree four, then we claim that one can construct the induced subgraph $G[N(v)]$ in ${\\cal O}(deg(v))$-time.\nIndeed, for every neighbour $u \\in N(v)$ that has degree four, let us test in constant-time for each of its four neighbours whether they are adjacent to vertex $v$ --- we only keep those for which it is the case in the adjacency list of $u$ in $G[N(v)]$.\nThen, for every $u \\in N(v)$ that does not have degree four (there are at most two such vertices), let us construct the adjacency list of $u$ in $G[N(v)]$ simply by testing to which vertices in $N(v) \\setminus u$ it is adjacent --- the latter takes constant-time by neighbour.\n\n\\item Once $G[N(v)]$ has been computed, it is easy to check whether it is a path in ${\\cal O}(|N(v)|) = {\\cal O}(deg(v))$-time.\n\n\\item Finally, let $u \\in N(v)$ have degree four. Let us pick in constant-time any neighbour $d_v \\in N(u) \\setminus N(v)$ (note that such a vertex is unique if $G[N(v)]$ induces a path).\nIn order to decide whether $v$ is a leaf-vertex of Type 1, it is now sufficient to test whether vertex $d_v$ is adjacent to every vertex in $N(v)$ --- that takes constant-time by neighbour. \n\\end{itemize}\n\n\n\\paragraph{Finding a leaf-vertex of Type 2.}\nRecall that a vertex is a leaf-vertex of Type 2 if and only if it has degree three and its three neighbours induce a path.\nGiven any vertex of degree three, three adjacency tests are enough in order to determine whether its three neighbours induce a path --- and each adjacency tests takes constant-time.\nTherefore, it can be checked in constant-time whether a vertex is a leaf-vertex of Type 2.\n\n\\paragraph{Finding a leaf-vertex of Type 3.}\nBy Definition~\\ref{def:leafVertex}, a vertex $v$ is a leaf-vertex of Type 3 if and only if it has degree two and its two neighbours are non-adjacent and they have at least two common neighbours (including $v$).\nNote that given a degree-two vertex, it can be checked whether its two neighbours are non-adjacent in constant-time.  \nWe now distinguish three cases.\n\n\\begin{enumerate}\n\\item First, suppose there is a vertex $v$ such that $N(v) = \\{x,y\\}$ and neighbour $x$ is a degree-two vertex.\nIn such case, let $N(x) = \\{v,z\\}$, in order to decide whether $v$ is a leaf-vertex of Type 3, it is sufficient to test in constant-time whether $y,z$ are adjacent.\t\n\t\n\\item Second, suppose there are two degree-two vertices $v,v'$ that share the same two non-adjacent neighbours ({\\it i.e.}, $N(v) = N(v') = \\{x,y\\}$ and $x,y$ are non-adjacent).\nIn such case, both vertices $v,v'$ are leaf-vertices of Type 3 (this case may happen if for instance, $G = K_{2,q}$ with $q \\geq 2$).\nIn order to check whether this case happens, it is sufficient to sort the pairs $N(v)$ with $v$ being a degree-two vertex in linear-time (for instance, using a bucket-sort).\n\n\\item Else, let $V'$ contain every degree-two vertex $v$ with two non-adjacent neighbours of degree at least three (if one of the two neighbours of $v$ has degree two, we fall in the first case)\nW.l.o.g., every vertex $v \\in V'$ is uniquely determined by the pair $N(v)$ composed of its two neighbours (or else, we fall in the second case).\nIn such case, let us contract every $v \\in V'$ to one of its two neighbours.\nBy doing so, we remove $v$ and we make the two vertices in $N(v)$ adjacent.\nNote that all these edge-contractions are pairwise independent.\nLet us call $G'$ the graph resulting from all edge-contractions, and let us call ``virtual edges'' any new edge resulting from an edge-contraction.\nThen, let us list all triangles in the resulting graph $G'$, it can be done in linear-time~\\cite{Papadimitriou81}.\nBy construction, $v \\in V'$ is a leaf-vertex of Type 3 if and only if the virtual edge resulting from its contraction belongs to a triangle in which it is the unique virtual edge.\n\\end{enumerate}\n\nOverall, finding a leaf-vertex in $G$ takes ${\\cal O}(\\sum_{v \\in V} deg(v))$-time, that is ${\\cal O}(n)$-time because $G$ is planar.\n\n\\subsubsection{Existence of a star-decomposition with two bags}\n\n\\begin{lemma}\\label{lem:complexity-2bags}\nLet $G$ be a planar graph, it can be decided in quadratic-time whether $G$ admits a star-decomposition with one or two bags.\n\\end{lemma}\n\n\\begin{proof}\n$G$ admits a star-decomposition with one bag if and only if there is a universal vertex in $G$, hence it can be decided in linear-time.\nAssume for the remaining of the proof that $G$ does not admit a star-decomposition with less than two bags.\nWe will consider two necessary conditions for some fixed pair $x,y$ to be the dominators of the only two bags in some star-decomposition of $G$.\nFor each of the two conditions, we will prove that all pairs satisfying the condition can be computed in quadratic-time.\nThen, we will conclude the proof by showing that the two conditions are sufficient to ensure the existence of a star-decomposition of $G$ with two bags.\n\n\\begin{enumerate}\n\\item Recall that if it exists a star-decomposition of $G$ with two bags, then by the properties of a tree decomposition every vertex of $G$ must be contained in at least one bag. \nTherefore, if $x,y$ are the only two dominators of the bags in some star-decomposition of $G$, they must be a dominating pair of $G$.\nIt can be decided in ${\\cal O}(deg(x) + deg(y))$-time whether a fixed pair $x,y$ is a dominating pair.\nSo, overall, it takes ${\\cal O}(n^2)$-time to compute all dominating pairs of $G$ with $n$ being the order of the graph, for the graph is planar and so, it is a sparse graph.\n\\item Furthermore, recall that if it exists a star-decomposition of $G$ with two bags, then by the properties of a tree decomposition every edge of $G$ must be contained in at least one bag. \nTherefore, if there is a star-decomposition of $G$ with two bags that are respectively dominated by $x$ and $y$, then it must be the case that there does not exist any edge $e = \\{u,v\\}$ so that $u \\in N[x] \\setminus N[y]$ and $v \\in N[y] \\setminus N[x]$ (else, such an edge could not be contained in any of the two bags).\nIn order to decide whether the latter condition holds for some fixed pair $x,y$, it suffices to test whether every vertex of $N[x] \\setminus N[y]$ is non-adjacent to all vertices in $N[y] \\setminus N[x]$ --- it takes constant-time per test and so, ${\\cal O}(deg(x) \\cdot deg(y))$-time in total.\nAs a result, computing all pairs $x,y$ satisfying the condition requires ${\\cal O}(\\sum_{x,y} deg(x) \\cdot deg(y)) = {\\cal O}([\\sum_x deg(x)][\\sum_y deg(y)]) = {\\cal O}(n^2)$-time because the graph $G$ is planar and so, it is a sparse graph.\n\\end{enumerate}\n\nFinally, let $x,y$ satisfy the two above necessary conditions.\nWe claim that $(T,{\\cal X})$ with $T$ being an edge and ${\\cal X} = \\{ N[x], N[y] \\}$ is a star-decomposition of $G$.\nIndeed, every vertex is contained into a bag because the pair $x,y$ satisfies the first necessary condition.\nFurthermore, every edge has its both ends contained into a common bag because the pair $x,y$ satisfies the second necessary condition.\nLast, all the bags containing a common vertex induce a subtree because there are only two bags.\nAs a result, $(T,{\\cal X})$ is a tree decomposition of $G$.\nSince each bag of ${\\cal X}$ is respectively dominated by $x$ or $y$, therefore $(T,{\\cal X})$ is indeed a star-decomposition of $G$, that proves the claim, hence the lemma.\n\\end{proof}\n\nNote that in any execution of Algorithm \\texttt{Leaf-BottomUp}, it is verified at most once whether some planar graph admits a star-decomposition with one or two bags.\n\n\\subsubsection{Upper-bound on the number of steps in the algorithm}\n\n\\begin{lemma}\\label{lem:ub-steps}\nLet $G$ be a prime planar graph with $n$ vertices and $m$ edges.\nThen, there are at most $5n-m$ recursive calls to the Algorithm \\texttt{Leaf-BottomUp}, that is ${\\cal O}(n)$. \n\\end{lemma}\n\n\\begin{proof}\nFirst note that since $G$ is planar by the hypothesis, $5n-m \\geq 0$ and $5n-m = {\\cal O}(n)$. \nLet $G'$ with $n'$ vertices and $m'$ edges so that Algorithm \\texttt{Leaf-BottomUp} is recursively applied on $G'$ when $G$ is the input.\nSince there is at most one such a graph $G'$ ({\\it i.e.}, there is no more than one recursive call at each call of the algorithm), furthermore $G'$ is prime and planar, therefore, in order to prove the lemma it suffices to prove that $5n' - m '< 5n -m$.\nTo prove it, let us consider at which step of the algorithm the recursive call occurs.\n\\begin{itemize}\n\\item If it is at~\\ref{step:type-1}, then $G'$ is obtained by removing a leaf-vertex of Type 1, denoted by $v$, and then contracting all the internal vertices in the path $\\Pi_v$ (induced by $N(v)$) to a single edge.\nTherefore, $n' = n - deg(v) + 3$, $m' = m - 3deg(v) + 8$ and so, $5n'-m' =  5n - m - (2deg(v) - 7) < 5n - m$ because $deg(v) \\geq 4$.\n\nThus, from now on let us assume we fall in~\\ref{step:type-2-3}, {\\it i.e.}, a leaf-vertex of Type 2 or 3 is considered, denoted by $v$.\n\n\\item If the recursion happens at~\\ref{step:prime-case}~\\ref{step:many-neighbours}, then $G'$ is obtained by removing $v$.\nTherefore, $n' = n - 1$ and either $m' = m-3$ (if $v$ is of Type 2) or $m'=m-2$ (if $v$ is of Type 3), hence $m' \\geq m - 3$ and so, $5n' - m' \\leq 5n -m - 2 < 5n - m$.\n\\item If it is at~\\ref{step:prime-case}~\\ref{step:few-neighbours}, then we fall in~\\ref{step:prime-case}~\\ref{step:few-neighbours}~\\ref{step:two-neighbours} (no recursion occurs in~\\ref{step:prime-case}~\\ref{step:few-neighbours}~\\ref{step:one-neighbour}), thus $G'$ is obtained by making $v$ adjacent to the two vertices in $(N(a_v) \\cap N(c_v)) \\setminus v$ (including $b_v$ in the case when $v$ is of Type 3).\nTherefore, $n' = n$ and either $m'=m+1$ (if $v$ is of Type 2) or $m'=m+2$ (if $v$ is of Type 3), hence $m' \\geq m+1$ and so, $5n' -m' \\leq 5n -m - 1 < 5n-m$.\n\n\\item Else, the recursion happens at~\\ref{step:new-clique-sep}.\nRecall that in such case, there exists a vertex $u_v$ such that $(b_v,u_v)$ is a clique-separator of $G \\setminus v$.\nAdding an edge between $v$ and $b_v$ if it does not exist, decreases $5n-m$ by $1$, therefore from now on let us assume that $v$ is a leaf-vertex of Type 2.\n\n\\begin{itemize}\n\\item if it is at~\\ref{step:new-clique-sep}~\\ref{step:no-separation}, then $G'$ is obtained by contracting the edge $\\{v,a_v\\}$.\nTherefore, $n'=n-1$, $m'=m-2$, hence $5n'-m' = 5n-m-3 < 5n-m$.\n\\item If it is at~\\ref{step:new-clique-sep}~\\ref{step:separation}~\\ref{step:contraction-case}, then $G'$ is obtained by adding an edge between $b_v$ and some vertex $x \\in (N(a_v) \\cap N(u_v)) \\setminus b_v$ then contracting this edge. \nFurthermore, $N(b_v) = \\{a_v,c_v,u_v,v\\}$ in such case and $c_v,v \\notin N(x)$.\nTherefore, $n'=n-1$, $m'=m-2$ and so, $5n'-m' = 5n-m-3 < 5n-m$.\n\\item If it is at~\\ref{step:new-clique-sep}~\\ref{step:separation}~\\ref{step:diamond-case}, then $G'$ is obtained by contracting the edge $\\{b_v,x\\}$ where $x \\in N(a_v) \\cap N(u_v) \\cap N(b_v)$.\nFurthermore, $N(b_v) = \\{a_v,c_v,u_v,v,x\\}$ in such case and $c_v,v \\notin N(x)$.\nTherefore, $n'=n-1$, $m' = m-3$ and so, $5n' - m' = 5n -m - 2 < 5n - m$.\n\\item Finally, in all other cases the recursive call happens at~\\ref{step:new-clique-sep}~\\ref{step:separation}~\\ref{step:no-diamond-case}.\nThen, $G'$ is obtained by adding an edge between two vertices $y,z \\in N(b_v) \\cap N(x)$ for some $x \\in (N(a_v) \\cap N(u_v)) \\setminus b_v$.\nTherefore, $n' = n$, $m' = m+1$ and so, $5n' -m' = 5n -m - 1 < 5n-m$.\n\\end{itemize}\n\n\\end{itemize}\n\\end{proof}\n\n\\section{Conclusion and Open questions}\n\\label{sec:conclusion}\n\n\nOn the negative side, we proved the NP-hardness of computing five metric graph invariants (namely, tree-breadth, path-length, path-breadth, $k$-good tree and path decompositions) whose complexity has been left open in several works~\\cite{Dourisboure2007b,Dragan2014a,Dragan2014b}.\nThese results add up to the proof in~\\cite{Lokshtanov2010} that it is NP-hard to compute the tree-length.\n\n\n\n\n\n\n\n\n\n\nWe leave as a future work further study on the border between tractable and intractable instances for the problem of computing the above metric graph invariants.\nEspecially, what are the graph classes for which it can be decided in polynomial-time whether a graph admits a star-decomposition ?\nIn this paper, we partially answer to this question by proving that it is the case for bipartite graphs and planar graphs.\nBased on these two positive results, we conjecture that the problem is Fixed-Parameter Tractable when it is parameterized by the \\emph{clique-number} of the graph (note that there is a large clique in all the graphs obtained from our polynomial-time reductions).\nIntermediate challenges could be to determine whether the problem is Fixed-Parameter Tractable when it is parameterized by the genus, the tree-width or the Hardwiger number.\n\n\nFinally, we notice that all our NP-hardness results imply that the above metric graph invariants cannot be approximated below some constant-factor.\nThere remains a gap between our inapproximability results and the constant-ratio of the approximation algorithms in~\\cite{Dourisboure2007b,Dragan2014b}.\nTherefore, we leave as an interesting open question whether we can fill in this gap.\n\n\\bibliographystyle{abbrv}\n\\bibliography{biblio}\n\n\n\\iffalse\n\\appendix\n\n\\section{Existence of a $k$-good tree decomposition is NP-complete to decide}\n\\label{sec:k-good}\n\nWe will prove the following result in this section.\n\n\\begin{theorem}\n\t\\label{thm:k-good-npc}\n\tDeciding whether a graph admits a $k$-good tree decomposition is NP-complete if $k$ is part of the input.\n\\end{theorem}\n\nNote that in order to certify that a graph $G$ admits a $k$-good tree decomposition, it is enough to provide a $k$-good tree decomposition of $G$ with a collection of dominating paths for each bag.\nTherefore the problem is in NP, and so we will only need to prove here that it is NP-hard.\nTo prove the NP-hardness, we will reduce from the Minimum Dominating Induced Path problem, defined below.\nThe Minimum Dominating Induced Path problem is (strongly) NP-hard~\\cite{Li2014}.\n\n\\begin{center}\n\t\\fbox{\\begin{minipage}{.95\\linewidth}\\label{prob:domi-path}\n\t\t\t\\begin{problem}[Minimum Dominating Induced Path]\\ \n\t\t\t\t\\begin{description}\n\t\t\t\t\t\\item[Input:] a connected graph $G=(V,E)$, a positive integer $k$.\n\t\t\t\t\t\\item[Question:] Does there exist a dominating induced path of $G$ of length at most $k-1$ ?\n\t\t\t\t\\end{description}\n\t\t\t\\end{problem}     \n\t\t\\end{minipage}}\n\t\\end{center}\n\t\n\tLet $(G,k)$ be an instance of the Miminimum Dominating Induced Path problem with $n > 2$ vertices in $G$ (otherwise the problem is trivial).\n\tWithout loss of generality, $k \\leq n$.\n\tWe will construct from $(G,k)$ a graph $G_k'$ such that $G$ admits a dominating induced path of length at most $k-1$ if and only if $G_k'$ admits a $k$-good tree decomposition.\n\tThe main ingredient in our reduction is a so-called {\\it link-gadget}, denoted by $L_{uv}$ that we will add between any two non-adjacent vertices $u,v$ of $G$.\n\tAs we will see later in the proof, the gadget $L_{uv}$ is aimed to ensure that vertices $u,v$ must belong to a common bag in any $k$-good tree decomposition of $G_k'$.\n\t\n\t\\begin{figure}[h!]\n\t\t\\centering\n\t\t\\begin{minipage}{.48\\textwidth}\\centering\n\t\t\t\\includegraphics[width=.95\\textwidth]{Fig/k-caterpillar}\n\t\t\t\\caption{The gadget $L_{uv}$.}\n\t\t\t\\label{fig:k-caterpillar}\n\t\t\\end{minipage}\n\t\t\\hfill\n\t\t\\begin{minipage}{.48\\textwidth}\\centering\n\t\t\t\\includegraphics[width=0.75\\textwidth]{Fig/k-caterpillar-tree-dec}\n\t\t\t\\caption{A $k$-good tree decomposition of $L_{uv}$.}\n\t\t\t\\label{fig:k-caterpillar-tree-dec}\n\t\t\\end{minipage}\n\t\t\n\t\t\n\t\\end{figure}\n\t\n\t\\begin{definition}\n\t\t\\label{def:link-gadget}\n\t\tLet $u,s_{uv},v,t_{uv}$ partition a cycle of length $4(k+1)$ in four paths of length $k-1$, that are respectively denoted by $P_1,P_2,P_3$ and $P_4$.\n\t\tThe link-gadget $L_{uv}$ is constructed from this cycle as follows.\n\t\t\\begin{itemize}\n\t\t\t\\item There are two more $uv$-paths $Q_a,Q_b$ of length $k+1$ with $Q_a = (u,P_a,v) = (u,a_1,a_2,\\ldots,a_k,v)$ and $Q_b=(u,P_b,v)=(u,b_1,b_2,\\ldots,b_k,v)$.\n\t\t\t\\item Furthermore the two vertices $a_{\\left\\lceil k / 2 \\right\\rceil},b_{\\left\\lfloor k /2 \\right\\rfloor+1}$ are respectively adjacent to the vertices $s_{uv},t_{uv}$.\n\t\t\\end{itemize}\n\t\\end{definition}\n\t\n\tWe refer to Figure~\\ref{fig:k-caterpillar} for an illustration. \n\t\n\t\\begin{lemma}\n\t\t\\label{lem:k-good-gadget}\n\t\tLet $L_{uv}$ be the link-gadget as it is defined above, there exists a $k$-good tree decomposition $(T,{\\cal X})$ of $L_{uv}$ such that $T_u \\cap T_v \\neq \\emptyset$. \n\t\\end{lemma}\n\t\n\t\\begin{proof}\n\t\tSuch a tree decomposition is illustrated on Figure~\\ref{fig:k-caterpillar-tree-dec}.\n\t\tNamely, $T$ has four leaves $B_1,B_2,B_3,B_4$ and two adjacent internal nodes $B_a,B_b$ of degree three.\n\t\tThe bags of the leaves are respectively $B_1 = P_1 \\cup \\{u,s_{uv}\\}$ (dominated by $P_1$), $B_2 = P_2 \\cup \\{v,s_{uv}\\}$ (dominated by $P_2$), $B_3 = P_3 \\cup \\{v,t_{uv}\\}$ (dominated by $P_3$) and $B_4 = P_4 \\cup \\{u,t_{uv}\\}$ (dominated by $P_4$).\n\t\tFinally, the bags $B_1,B_2$ are adjacent to the bag $B_a = P_a \\cup \\{u,s_{uv},v\\}$ (dominated by $P_a$), the bags $B_3,B_4$ are adjacent to the bag $B_b = \\{u,t_{uv},v\\} \\cup P_b$ (dominated by $P_b$).\n\t\tBy construction $u,v \\in B_a$ and so, $T_u \\cap T_v \\neq \\emptyset$. \n\t\\end{proof}\n\t\n\tFor every two non-adjacent vertices $u,v \\in V(G)$, let us identify these two vertices $u,v \\in V(G)$ with the two vertices $u,v$ of some distinct copy of the link-gadget $L_{uv}$.\n\tWe emphasize that a distinct copy of the link-gadget $L_{uv}$ must be constructed for each considered pair $u,v$.\n\tLet $G'_k$ be the graph obtained from $G$ by the above construction (it has $n+(\\binom{n}{2}- m)(6k+2)$ vertices and $m+(\\binom{n}{2}- m)(6k+6)$ edges). \n\tRecall that the link-gadget $L_{uv}$ is aimed to ensure that the two vertices $u,v$ must be contained into a common bag in {\\it any} $k$-good tree decomposition of $G_k'$.\n\tWe now prove why it is the case.\n\t\n\t\\begin{lemma}\n\t\t\\label{lem:k-good-reduction}\n\t\tLet $G$ be a graph, let $G_k'$ be constructed from $G$ by adding a distinct copy of the link-gadget $L_{uv}$ between every two non-adjacent vertices $u,v \\in V(G)$.\n\t\tIf there is a $k$-good tree decomposition $(T,{\\cal X})$ of $G_k'$ then for every two vertices $u,v \\in V(G)$, $T_u \\cap T_v \\neq \\emptyset$.\n\t\\end{lemma}\n\t\n\t\\begin{proof}\n\t\tBy way of contradiction, let $u,v$ be such that $T_u \\cap T_v = \\emptyset$.\n\t\tBy the properties of a tree decomposition, $u,v$ are non-adjacent.\n\t\tThen, any bag $B$ of the path between $T_u$ and $T_v$ in $T$ must contain vertices in the four paths $(P_1 \\cdot s_{uv} \\cdot P_2), P_a, P_b$, and $(P_3 \\cdot t_{uv} \\cdot P_4)$ of $L_{uv}$.\n\t\tLet $Q \\subseteq B$ be an induced path of length at most $k-1$ dominating $G'_k[B]$, that exists because $(T,{\\cal X})$ is a $k$-good tree decomposition of $G_k'$.\n\t\tBy previous remark $Q$ dominates vertices in the four paths $(P_1 \\cdot s_{uv} \\cdot P_2), P_a, P_b$, and $(P_3 \\cdot t_{uv} \\cdot P_4)$ of $L_{uv}$.\n\t\tSince the removal of $u,v$ disconnects the paths $(P_1 \\cdot s_{uv} \\cdot P_2)$ and $P_a$ from the paths $P_b$ and $(P_3 \\cdot t_{uv} \\cdot P_4)$, then either $u \\in Q$ or $v \\in Q$.\n\t\tThis implies that either $B \\in T_u$, or $B \\in T_v$.\n\t\tTherefore, there must be two adjacent bags $B_u, B_v$ that are respectively dominated by the induced paths $Q_u,Q_v$ of length at most $k-1$ and such that $u \\in Q_u, v \\in Q_v$.\n\t\t\n\t\tMoreover, $B_u \\cap B_v \\cap P_a \\neq \\emptyset$ and $B_u \\cap B_v \\cap P_b \\neq \\emptyset$ because $B_u \\cap B_v$ is an $uv$-separator by the properties of a tree decomposition.\n\t\tSay w.l.o.g. that there are $1 \\leq i,j \\leq k$ such that $a_i \\in B_u \\cap B_v \\cap P_a$ and $b_j \\in B_u \\cap B_v \\cap P_b$.\n\t\tBy construction, the only two $ua_i$-paths in $G'_k \\setminus v$ are $(u,P_1,s_{uv},a_{\\left\\lceil k/2 \\right\\rceil},\\ldots,a_i)$ and $(u,a1, \\ldots, a_i)$.\n\t\tSimilarly, the only two $ub_j$-paths in $G'_k \\setminus v$ are $(u,P_4,t_{uv},b_{\\left\\lfloor k/2 \\right\\rfloor+1},\\ldots,b_j)$ and $(u,b1, \\ldots, b_j)$.\n\t\tTherefore, $(u,a1, \\ldots, a_{i-1})$ and $(u,b_1,\\ldots,b_{j-1})$ are two subpaths of $Q_u$ (or else it would have length at least $k$), in the same way $(a_{i+1},\\ldots,a_k,v)$ and $(b_{j+1},\\ldots,b_k,v)$ are two subpaths of $Q_v$.\n\t\tAs a result, since $Q_u,Q_v$ both have length at most $k-1$, then $Q_u = (a_{i-1},\\ldots,a_1,u,b_1,\\ldots,b_{j-1})$, $Q_v = (a_{i+1},\\ldots,a_k,v,b_k,\\ldots,b_{j+1})$ and in particular $i+j-1 = k$.\n\t\tNote that the paths $Q_u,Q_v$ are vertex-disjoint.\n\t\tHowever, in such case it holds $N[Q_u] \\cap N[Q_v] \\cap (P_1 \\cdot s_{uv} \\cdot P_2) = \\emptyset$, whence $B_u \\cap B_v \\cap (P_1 \\cdot s_{uv} \\cdot P_2) = \\emptyset$ which contradicts the fact that $B_u \\cap B_v$ is an $uv$-separator.\n\t\\end{proof}\n\t\n\tWe are finally able to prove Theorem~\\ref{thm:k-good-npc}.\n\t\n\t\\begin{proofof}{Theorem~\\ref{thm:k-good-npc}}\n\t\tThe problem is in NP.\n\t\tTo prove the NP-hardness, let $G$ be a graph with more than two vertices and let $G_k'$ be constructed from $G$ by adding a distinct copy of the link-gadget $L_{uv}$ (as defined in Definition~\\ref{def:link-gadget}) between every two non-adjacent vertices $u,v \\in V(G)$.\n\t\tWe claim that there is a dominating induced path of length at most $k-1$ in $G$ if and only if $G_k'$ admits a $k$-good tree decomposition.\n\t\tNote that it will prove that the problem is NP-hard because our reduction is polynomial and the Minimum Dominating Induced Path problem is NP-hard~\\cite{Li2014}.\n\t\t\n\t\tTo prove the claim in one direction, assume that there exists a dominating induced path of length at most $k-1$ in $G$ and let us prove that there is a $k$-good tree decomposition for $G_k'$.\n\t\tSuch a tree decomposition can be constructed as follows.\n\t\tFirst, we create a bag $B_0$ containing all of $V(G)$. Note that it is dominated by an induced path of length at most $k-1$ because $G$ is an induced subgraph of $G_k'$ by construction.\n\t\tThen, for every two non-adjacent vertices $u$ and $v$, let $(T^{uv},{\\cal X}^{uv})$ be a $k$-good tree decomposition of $L_{uv}$ so that $u$ and $v$ are contained into a common bag, that exists by Lemma~\\ref{lem:k-good-gadget}.\n\t\tTo obtain a $k$-good tree decomposition of $G_k'$, it suffices to make $B_0$ adjacent to some (arbitrary) bag of $T^{uv}$ containing $u,v$, for every two non-adjacent vertices $u,v \\in V(G)$.\n\t\t\n\t\tConversely, suppose there exists $(T,{\\cal X})$ a $k$-good tree decomposition of $G_k'$, and let us prove that it implies the existence of a dominating induced path of length at most $k-1$ in $G$.\n\t\tTo prove it, we will first prove that there is a bag which contains all of $V(G)$ or equivalently $\\bigcap_{v \\in V(G)} T_v \\neq \\emptyset$.\n\t\tBy the Helly property (Lemma~\\ref{lem:helly}), having $\\bigcap_{v \\in V(G)} T_v \\neq \\emptyset$ is equivalent to have that $T_u \\cap T_v  \\neq \\emptyset$ for every two vertices $u,v \\in V(G)$.\n\t\tTherefore, it follows from Lemma~\\ref{lem:k-good-reduction} that there exists a bag $B_0$ containing all of $V(G)$.\n\t\tSince $(T,{\\cal X})$ is $k$-good by the hypothesis, there is a path $Q_0 \\subseteq B_0$ which dominates the bag.\n\t\tIn particular, let $Q_0'$ be a subpath of $Q_0$ of minimum length that dominates all of $V(G)$.\n\t\tSince for every $u,v$ that are non-adjacent every $uv$-path of $L_{uv}$ has length at least $k+1$, then $Q_0' \\subseteq V(G)$ or else it would dominate no more than two vertices of $V(G)$ (recall that $|V(G)|>2$). \n\t\tConsequently, there is a dominating induced path $Q_0'$ of length at most $k-1$ in $G$. \n\t\\end{proofof}\n\\fi\n\n\n", "itemtype": "equation", "pos": 14142, "prevtext": "\n\n\\maketitle\n\n\\begin{abstract}\n\n\nWe here investigate on the complexity of computing the \\emph{tree-length} and the \\emph{tree-breadth} of any graph $G$, that are respectively the best possible upper-bounds on the diameter and the radius of the bags in a tree decomposition of $G$.\n\\emph{Path-length} and \\emph{path-breadth} are similarly defined and studied for path decompositions.\t\nSo far, it was already known that tree-length is NP-hard to compute.\nWe here prove it is also the case for tree-breadth, path-length and path-breadth.\nFurthermore, we provide a more detailed analysis on the complexity of computing the tree-breadth.\nIn particular, we show that graphs with tree-breadth one are in some sense the hardest instances for the problem of computing the tree-breadth.\nWe give new properties of graphs with tree-breadth one.\nThen we use these properties in order to recognize in polynomial-time all graphs with tree-breadth one that are planar or bipartite graphs.\nOn the way, we relate tree-breadth with the notion of \\emph{$k$-good} tree decompositions (for $k=1$), that have been introduced in former work for routing.\nAs a byproduct of the above relation, we prove that deciding on the existence of a $k$-good tree decomposition is NP-complete (even if $k=1$).\nAll this answers open questions from the literature.\n\\end{abstract}\n\n\\keywords{tree-length; tree-breadth; path-length; path-breadth; $k$-good tree decompositions.}\n\n\n\n\n\\section{Introduction}\n\\label{sec:intro}\n\n\\paragraph{Context.}\nIt is a fundamental problem in metric graph theory~\\cite{Bandelt2008} to embed a graph into a simpler metric space while minimizing the (multiplicative) distortion of the distances in the graph.\nIn particular, minimum distortion embeddings of a graph into a tree or a path have practical applications in computer vision~\\cite{Tenenbaum2000}, computational chemistry and biology~\\cite{Indyk2001} as well as in network design and distributed protocols~\\cite{Herlihy2006}.\nThe two problems to embed a graph into a tree or a path with minimum distortion are NP-hard~\\cite{Agarwala1998,B\u00c7\u008edoiu2005,Monien1986}.\nHowever, there exists a nice setting in order to approximate these two problems.\nMore precisely, a series of graph parameters has been introduced in recent work in order to measure how much the \\emph{distance distribution} of a graph is close to a tree metric or a path metric~\\cite{Dourisboure2007b,Dragan2014a,Dragan2014b}.\nWe refer to~\\cite{Dragan2013,Dragan2014b} for details about the relationships between these parameters and the two above-mentioned embedding problems.\nHere we study the complexity of computing these parameters, thereby solving open problems in the literature.\n\nThe parameters that are considered in this note can be defined using the terminology of Robertson and Seymour tree decompositions~\\cite{Robertson1986}.\nInformally, a tree decomposition is a dividing of a graph $G$ into ``bags'': that are overlapping subgraphs that can be pieced together in a tree-like manner (formal definitions will be given in the technical sections of the paper).   \nThe shortest-path metric of $G$ is ``tree-like'' when each bag of the tree decomposition has bounded diameter and bounded radius, where the distance taken between two vertices in a same bag is their distance in $G$.\nThe \\emph{tree-length}~\\cite{Dourisboure2007b} and the \\emph{tree-breadth}~\\cite{Dragan2014a} of $G$ are respectively the best possible upper-bounds on the diameter and the radius of the bags in a tree decomposition of $G$.\n\\emph{Path-length}~\\cite{Umezawa2009} and \\emph{path-breadth}~\\cite{Dragan2014b} are defined in the same fashion as tree-length and tree-breadth for path decompositions.\nIn this paper, we focus on the complexity of computing the four parameters tree-length, tree-breadth, path-length and path-breadth.  \n\n\\medskip\nRecent studies suggest that some classes of real-life networks -- including biological networks and social networks -- have bounded tree-length and tree-breadth~\\cite{Abu2015}.\nThis metric tree-likeness can be exploited in algorithms.\nFor instance, bounded tree-length graphs admit compact distance labeling scheme~\\cite{Dourisboure2007a} as well as a PTAS for the well-known Traveling Salesman problem~\\cite{Krauthgamer2006}.\nFurthermore, the diameter and the radius of bounded tree-length graphs can be approximated up to an additive constant in linear-time~\\cite{Chepoi2008}.\nIn contrast to the above result, we emphasize that under classical complexity assumptions the diameter of general graphs \\emph{cannot} be approximated up to an additive constant in subquadratic-time, that is prohibitive for very large graphs~\\cite{Chechik2014}. \n\nNote that a large amount of the literature about tree decompositions rather seeks to minimize the \\emph{size} of the bags than their diameter. \nThe \\emph{tree-width}~\\cite{Robertson1986} of a graph $G$ is the best possible upper-bound on the size of the bags in a tree decomposition of $G$. \nHowever, tree-length and the other parameters that are considered in this paper can differ arbitrarily from tree-width;\nwe refer to~\\cite{Coudert2014} for a global picture on the relations between tree-length and tree-width.\nFurthermore, one aim of this paper is to complete the comparison between tree-width and path-width on one side, and tree-length, tree-breadth, path-length and path-breadth on the other side, from the complexity point of view.\nLet us remind that computing the tree-width (resp. the path-width) is NP-hard~\\cite{Arnborg1987,Kashiwabara1979}, however for every fixed $k \\geq 1$ there is a linear-time algorithm to decide whether a graph has tree-width at most $k$ (resp., path-width at most $k$)~\\cite{Bodlaender1996,Bodlaender1996b}.\n\n\\paragraph{Related work.}\nThe complexity of computing tree-length, tree-breadth, path-length and path-breadth has been left open in several works~\\cite{Dourisboure2007b,Dragan2014a,Dragan2014b}.\nSo far, it has been solved only for tree-length, that is NP-hard to compute.\n\n{\\it Tree-length and tree-breadth.} \nIt is NP-complete to decide whether a graph has tree-length at most $k$ for every constant $k \\geq 2$~\\cite{Lokshtanov2010}.\nHowever, the reduction used for tree-length goes through weighted graphs and then goes back to unweighted graphs using rather elegant gadgets.\nIt does not seem to us these gadgets can be easily generalized in order to apply to the other parameters that are considered in this note.\nOn a more positive side, there exists a $3$-approximation algorithm for tree-length~\\cite{Dourisboure2007b}.\nIn this aspect, it looks natural to investigate on the complexity of computing the tree-breadth, since any polynomial-time algorithm would imply an improved $2$-approximation algorithm for tree-length.\n\n{\\it Path-length and path-breadth.}\nThere exist constant-factor approximation algorithms for path-length and path-breadth~\\cite{Dragan2014b}.\nRecently, the minimum eccentricity shortest-path problem -- that is close to the computation of path-length and path-breadth -- has been proved NP-hard~\\cite{Dragan2015}.\nLet us point out that for every fixed $k$, it can be decided in polynomial-time whether a graph admits a shortest-path with eccentricity at most $k$~\\cite{Dragan2015}.\nOur results will show the situation is different for path-length and path-breadth than for the  minimum eccentricity shortest-path. \n\n\\paragraph{Our contributions.}\nOn the negative side, we prove that tree-breadth, path-length and path-breadth are NP-hard to compute.\nMore precisely:\n\\begin{itemize}\n \\item recognizing graphs with tree-breadth one is NP-complete;\n \\item recognizing graphs with path-length two is NP-complete;\n \\item recognizing graphs with path-breadth one is NP-complete.\n\\end{itemize} \nIt is remarkable the last two results (for path-length and path-breadth) are obtained using \\emph{the same reduction}.\nOur reductions have distant similarities with the reduction that was used for tree-length.\nHowever, they do not need any detour through weighted graphs.\n\n\\medskip\nWe next focus our work on tree-breadth (although part of the results may extend to the three other parameters that are considered in this note).\nWe give a more in-depth analysis on the complexity of computing this parameter.\nIn particular, we prove it is equally hard to compute tree-breadth as to recognize graphs with tree-breadth one.\nTherefore, graphs with tree-breadth one are in some sense the hardest instances for the problem of computing the tree-breadth.\nThe latter partly answers an open question from~\\cite{Dragan2014a}, where it was asked for a characterization of graphs with tree-breadth one.\n\nWe also prove a few properties of graphs with tree-breadth one.\nIn particular, graphs with tree-breadth one are exactly those graphs admitting a \\emph{$1$-good tree decomposition}, that is a tree decomposition whose each bag has a spanning star.\nThe more general notion of $k$-good tree decompositions was introduced in~\\cite{Kosowski2015} to obtain new compact routing schemes.\nNote that as a byproduct of the above relation between $1$-good tree decompositions and graphs with tree-breadth one, we obtain that deciding on the existence of a $k$-good tree decomposition is an NP-complete problem even when $k=1$. \n\nFinally, on the algorithmic side, we show how to recognize in polynomial time all graphs of tree-breadth one that are planar or bipartite. \nIn particular, our recognition algorithm for planar graphs of tree-breadth one relies upon deep structural properties of these graphs.\n\n\\medskip\nDefinitions and useful notations are given in Section~\\ref{sec:def}.\nAll our results of NP-completeness are listed and proved in Section~\\ref{sec:np-hard}.\nSections~\\ref{sec:tb} and~\\ref{sec:planar} are devoted to the computation of tree-breadth.\nIn particular, in Section~\\ref{sec:planar} we present and we prove correctness of an algorithm to recognize planar graphs with tree-breadth one.\nFinally, we discuss about some open questions in the conclusion (Section~\\ref{sec:conclusion}). \n\n\\section{Definitions and preliminary results}\n\\label{sec:def}\n\nWe refer to~\\cite{Diestel2012} for a survey on graph theory.\nGraphs in this study are finite, simple, connected and unweighted.\nLet $G=(V,E)$ be a graph. \nFor any $X \\subseteq V$, let $G[X]$ denote the subgraph of $G$ induced by $X$. \nFor any subgraph $H$ of $G$, let $N_H(v)$ denote the set of neighbors of $v\\in V$ in $H$, and let $N_H[v]=N_H(v)\\cup \\{v\\}$. \nThe distance $dist_H(u,v)$ between two vertices $u,v \\in V$ in $H$ is the minimum length (number of edges) of a path between $u$ and $v$ in a subgraph $H$ of $G$. \nIn what follows, we will omit the subscript when no ambiguity occurs. \nA set $S \\subseteq V$ is a dominating set of $G$ if any vertex of $V\\setminus S$ has a neighbor in $S$. \nThe {\\it dominating number} $\\gamma(G)$ of a graph $G$ is the minimum size of a dominating set of $G$.\n\n\\paragraph{Tree decompositions and path decompositions of a graph.}\nA {\\it tree decomposition} $(T,{\\cal X})$ of $G$ is a pair consisting of a tree $T$ and of a family ${\\cal X}=(X_t)_{t \\in V(T)}$ of subsets of $V$ indexed by the nodes of $T$ and satisfying:\n\\begin{itemize}\n\\item $\\bigcup_{t \\in V(T)}X_t=V$;\n\\item for any edge $e=\\{u,v\\} \\in E$, there exists $t\\in V(T)$ such that $u,v \\in X_t$;\n\\item for any $v \\in V$, the set of nodes $t \\in V(T)$ such that $v \\in X_t$ induces a subtree, denoted by $T_v$, of $T$. \n\\end{itemize}\n\nThe sets $X_t$ are called {\\it the bags} of the decomposition. \nIf no bag is contained into another one, then the tree decomposition is called \\emph{reduced}.\nStarting from any tree decomposition, a reduced tree decomposition can be obtained in polynomial-time by contracting any two adjacent bags with one contained into the other until it is no more possible to do that.\n\nIn the following we will make use of the \\emph{Helly property} in our proofs:\n\n\\begin{lemma}~\\cite[Helly property]{Balakrishnan2012}\n\\label{lem:helly}\t\n Let $T$ be a tree and let $T_1,T_2,\\ldots,T_k$ be a finite family of pairwise intersecting subtrees.\n Then, $\\bigcap_{i=1}^k T_i \\neq \\emptyset$, or equivalently there is a node contained in all the $k$ subtrees.\n\\end{lemma}\n\n\nFinally, let $(T,{\\cal X})$ be a tree decomposition, it is called a \\emph{path decomposition} if $T$ induces a path.\n\n\\paragraph{Metric tree-likeness and path-likeness.}\nAll graph invariants that we consider in the paper can be defined in terms of tree decompositions and path decompositions.\nLet $(T,{\\cal X})$ be any tree decomposition of a graph $G$.\nFor any $t \\in V(T)$, \n\\begin{itemize}\n \\item the {\\it diameter} of bag $X_t$ equals $\\max_{v,w \\in X_t} dist_G(v,w)$;\n \\item the {\\it radius} $\\rho(t)$ of a bag $X_t$ equals $\\min_{v \\in V} \\max_{w\\in X_t} dist_G(v,w)$. \n\\end{itemize}\nThe {\\it length} of $(T,{\\cal X})$ is the maximum diameter of its bags, while the {\\it breadth} of $(T,{\\cal X})$ is the maximum radius of its bags.\nThe {\\it tree-length} and the {\\it tree-breadth} of $G$, respectively denoted by $tl(G)$ and $tb(G)$, are the minimum length and breadth of its tree decomposition, respectively.\n\nLet $k$ be a positive integer, the tree decomposition $(T,{\\cal X})$ is called \\emph{$k$-good} when each bag contains a dominating induced path of length at most $k-1$.\n\n\nIt is proved in~\\cite{Kosowski2015} every graph $G$ has a $k$-good tree decomposition for $k = ch(G) - 1$, with $ch(G)$ denoting the size of a longest induced cycle of $G$.\nFinally, path-length, path-breadth and $k$-good path decompositions are similarly defined and studied for the path decompositions as tree-length, tree-breadth and $k$-good tree decompositions are defined and studied for the tree decompositions.\nThe path-length and path-breadth of $G$ are respectively denoted by $pl(G)$ and $pb(G)$.\n\n\\medskip\nIt has been observed in~\\cite{Dragan2014a,Dragan2014b} that the four parameters tree-length, tree-breadth and path-length, path-breadth are contraction-closed invariants.\nWe will use the latter property in our proofs.\n\n\\begin{lemma}[~\\cite{Dragan2014a,Dragan2014b}]\n\\label{lem:contraction-closed}\nFor every $G = (V,E)$ and for any edge $e \\in E$:\n\n", "index": 1, "text": "$$tl(G/e) \\leq tl(G), \\ tb(G /e) \\leq tb(G) \\text{ and } pl(G/e) \\leq pl(G), \\ pb(G/e) \\leq pb(G).$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"tl(G/e)\\leq tl(G),\\ tb(G/e)\\leq tb(G)\\text{ and }pl(G/e)\\leq pl(G),\\ pb(G/e)%&#10;\\leq pb(G).\" display=\"block\"><mrow><mrow><mrow><mrow><mrow><mi>t</mi><mo>\u2062</mo><mi>l</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>G</mi><mo>/</mo><mi>e</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2264</mo><mrow><mi>t</mi><mo>\u2062</mo><mi>l</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>G</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo rspace=\"7.5pt\">,</mo><mrow><mrow><mi>t</mi><mo>\u2062</mo><mi>b</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>G</mi><mo>/</mo><mi>e</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2264</mo><mrow><mi>t</mi><mo>\u2062</mo><mi>b</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>G</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mtext>\u00a0and\u00a0</mtext><mo>\u2062</mo><mi>p</mi><mo>\u2062</mo><mi>l</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>G</mi><mo>/</mo><mi>e</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2264</mo><mrow><mi>p</mi><mo>\u2062</mo><mi>l</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>G</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo rspace=\"7.5pt\">,</mo><mrow><mrow><mi>p</mi><mo>\u2062</mo><mi>b</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>G</mi><mo>/</mo><mi>e</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2264</mo><mrow><mi>p</mi><mo>\u2062</mo><mi>b</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>G</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}]