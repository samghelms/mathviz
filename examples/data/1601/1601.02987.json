[{"file": "1601.02987.tex", "nexttext": "\nwhere\n\\begin{eqnarray}\n\\beta_{\\sf opt}^2 & = & \\left\\{\n\\begin{array}{cc}\n\\frac{ {\\cal A} + \\sqrt{ {\\cal B}} }{2 {\\hspace{0.01in}} {\\cal C}}\n& {\\rm if} {\\hspace{0.1in}} |\\alpha_1| \\geq |\\alpha_2| \\\\\n\\frac{ {\\cal A} - \\sqrt{ {\\cal B}} }{2 {\\hspace{0.01in}} {\\cal C}}\n& {\\rm if} {\\hspace{0.1in}} |\\alpha_1| < |\\alpha_2|\n\\end{array}\n{\\hspace{0.10in}} {\\rm with} \\right.\n\\nonumber \\\\\n{\\cal A} & = & \\frac{ (|\\alpha_1|^2 - |\\alpha_2|^2)^2 }\n{ |{\\bf v}_1^{H} {\\bf v}_2|^2 } + 2 |\\alpha_1|^2 \\cdot ( |\\alpha_1|^2 + |\\alpha_2|^2 )\n\\nonumber \\\\\n{\\cal B} & = & \\frac{ (|\\alpha_1|^2 - |\\alpha_2|^2 )^4 }\n{ |{\\bf v}_1^{H} {\\bf v}_2|^4 } +\n\\frac{ 4 |\\alpha_1|^2 |\\alpha_2|^2 }{ | {\\bf v}_1^{H} {\\bf v}_2|^2 }\n\n\\cdot \\left( |\\alpha_1|^2 - |\\alpha_2|^2 \\right)^2\n\\nonumber \\\\\n{\\cal C} & = & \\left( 1 + \\frac{1}{ |{\\bf v}_1^{H} {\\bf v}_2|^2} \\right)\n\\cdot \\left( |\\alpha_1|^2 + |\\alpha_2|^2  \\right)^2 -\n\\frac{ 4 |\\alpha_1|^2 |\\alpha_2|^2 }{ |{\\bf v}_1^{H} {\\bf v}_2 |^2 }.\n\n\\label{eq14}\n\\end{eqnarray}\nFor specific examples, note that $\\beta_{\\sf opt}$ converges to $1$ or $0$ as\n${\\bf v}_1$ and ${\\bf v}_2$ become more orthogonal. On the other hand, the optimal\nscheme converges to proportional squared power allocation as ${\\bf v}_1$ and\n${\\bf v}_2$ become more parallel. That is,\n\\begin{eqnarray}\n|{\\bf v}_1^{H} {\\bf v}_2| \\rightarrow 1 \\Longrightarrow\n\\beta_{\\sf opt}^2 \\rightarrow \\frac{ |\\alpha_1|^4 }\n{ |\\alpha_1|^4 + |\\alpha_2|^4 }.  \n\\label{eq15}\n\\end{eqnarray}\nSimilar expressions can be found in~\\cite{vasanth_gcom15} for the cases where ${\\bf v}_1$\nand ${\\bf v}_2$ are near-parallel (${\\bf v}_1^H {\\bf v}_2 \\approx 1$), ${\\bf u}_1$\nand ${\\bf u}_2$ are near-parallel (${\\bf u}_1^H {\\bf u}_2 \\approx 1$), etc.\n\n\\subsection{Optimal Beamforming with Phase-Only Control}\n\\label{sec3_b}\n\nIn practice, the antenna arrays at the MWB and UE ends are often controlled by a\ncommon PA disallowing per-antenna power control. Thus, there is a need to\nunderstand the performance with phase-only control at both the ends. Let\n${\\cal F}_{\\infty}^{N_t}$ denote the class of amplitude-constrained beamforming\nvectors with phase-only control reflecting such an assumption. That is,\n${\\cal F}_{\\infty}^{N_t} \\triangleq \\{ {\\bf f} \\in {\\mathbb{C}}^{N_t} {\\hspace{0.02in} } :\n{\\hspace{0.02in} } \\| {\\bf f} \\|_{\\infty} \\leq \\frac{1}{ \\sqrt{N_t} } \\}$. We now consider\nthe problem of optimal beamforming with ${\\bf f} \\in {\\cal F}_{\\infty}^{N_t}$\nand ${\\bf g} \\in {\\cal F}_{\\infty}^{N_r}$. Note that if ${\\bf f} \\in\n{\\cal F}_{\\infty}^{N_t}$, then ${\\bf f} \\in {\\cal F}_{2}^{N_t}$. However, unlike\nthe optimization over ${\\cal F}_{2}^{N_t}$, it is not clear that the received\n${\\sf SNR}$ is maximized by a choice ${\\bf f}_{\\sf opt}$ with\n$\\| {\\bf f}_{\\sf opt} \\|_{\\infty} = \\frac{1}{ \\sqrt{N_t} }$. Nor is it clear that\n$\\| {\\bf f}_{\\sf opt} \\|_2 = 1$. With this background, we have the following result.\n\\begin{thm}\n\\label{thm2}\nThe optimal choice ${\\bf f}_{\\sf opt}$ from ${\\cal F}_{\\infty}^{N_t}$ is an equal\ngain transmission scheme. That is, $| {\\bf f}_{\\sf opt}(i) | = \\frac{1}{ \\sqrt{N_t} },\n{\\hspace{0.05in} } i = 1, \\cdots, N_t$. The optimal choice ${\\bf g}_{\\sf opt}$ from ${\\cal F}_{\\infty}^{N_r}$\nsatisfies\n\\begin{eqnarray}\n{\\bf g}_{\\sf opt} = \\frac{1}{ \\sqrt{N_r} } \\cdot  \\frac{ {\\sf H} {\\hspace{0.02in} } {\\bf f}_{\\sf opt} }\n{ \\| {\\sf H} {\\hspace{0.02in} } {\\bf f}_{\\sf opt} \\|_{\\infty} }.\n\\label{eq_4}\n\\end{eqnarray}\n\n\\end{thm}\n\\begin{proof}\nSee Appendix~\\ref{appB}.\n\n\\end{proof}\n\nNote that as with the proof of the optimal beamforming structure from\n${\\cal F}_2^{N_t}$ and ${\\cal F}_2^{N_r}$ where given a fixed ${\\bf f} \\in\n{\\cal F}_2^{N_t}$, the matched filter combiner corresponding to it is optimal\nfrom ${\\cal F}_2^{N_r}$, the matched filter combiner structure in~(\\ref{eq_4}) is\noptimal for any fixed ${\\bf f} \\in {\\cal F}_{\\infty}^{N_t}$. Further, (by\nconstruction), ${\\bf f}_{\\sf opt}$ corresponds to an equal gain transmission\nscheme, which is also power efficient. That is, $\\| {\\bf f}_{\\sf opt} \\|_2 = 1$\nand $\\| {\\bf f}_{\\sf opt} \\|_{\\infty} = \\frac{ 1 }{ \\sqrt{N_t} }$. On the other\nhand, while $\\| {\\bf g}_{\\sf opt} \\|_{\\infty} = \\frac{1} { \\sqrt{N_r} }$, it is\nunclear if ${\\bf g}_{\\sf opt}$ corresponds to an equal gain reception scheme, let\nalone a power efficient scheme. That is, not only can $\\| {\\bf g}_{\\sf opt} \\|_2$\nbe smaller than $1$, but also $| {\\bf g}_{\\sf opt}(i)|$ need not be $\\frac{1}\n{ \\sqrt{N_r} }$ for some $i$.\n\nWhile Theorem~\\ref{thm2} specifies the amplitudes of $\\left\\{ {\\bf f}_{\\sf opt}(i) \\right\\}$,\nit is unclear on the phases of $\\left\\{ {\\bf f}_{\\sf opt}(i) \\right\\}$. In general,\nthe search for the optimal phases of ${\\bf f}_{\\sf opt}(i)$ appears to be a quadratic\nprogramming problem with attendant issues on initialization and convergence to local\noptima. We now provide two good solutions (as evidenced by their performance\nrelative to the optimal scheme from Sec.~\\ref{sec3_a} in subsequent numerical studies)\nto the received ${\\sf SNR}$ maximization problem from ${\\cal F}_{\\infty}^{N_t}$ and\n${\\cal F}_{\\infty}^{N_r}$. The first solution is the equal-gain RSV and its matched\nfilter as candidate beamforming vectors at the two ends (${\\bf f}_{\\sf cand, {\\hspace{0.02in} } 1}$\nand ${\\bf g}_{\\sf cand, {\\hspace{0.02in} } 1}$):\n\\begin{eqnarray}\n{\\bf f}_{\\sf cand, {\\hspace{0.02in} } 1}(i) = \\frac{1}{ \\sqrt{N_t} } \\cdot \\angle{ {\\sf v}_1(i) },\n{\\hspace{0.05in} }\n{\\bf g}_{\\sf cand, {\\hspace{0.02in} } 1} = \\frac{1}{ \\sqrt{N_r} } \\cdot \\frac{ {\\sf H}\n{\\hspace{0.02in} } {\\bf f}_{\\sf cand, {\\hspace{0.02in} } 1}}\n{ \\| {\\sf H} {\\hspace{0.02in} } {\\bf f}_{\\sf cand, {\\hspace{0.02in} } 1} \\|_{\\infty} }.\n\\label{eq_5}\n\\end{eqnarray}\nFor the second solution, we have the following statement.\n\\begin{prop}\nLet ${\\sf H}$ be decomposed along the column vectors as ${\\sf H} = \\left[\n{\\sf h}_1, \\cdots, {\\sf h}_{N_t} \\right]$. With $\\theta_1 = 0$, let $\\theta_i$\nbe recursively defined as\n\\begin{eqnarray}\n\\theta_i = \\angle{ \\left( \\sum_{k = 1}^{i-1} e^{j \\theta_k} \\cdot\n{\\sf h}_i^H {\\sf h}_k \\right).}\n\n\\label{eq18}\n\\end{eqnarray}\nThe beamforming vector ${\\bf f}_{\\sf cand, {\\hspace{0.02in} } 2}$ where ${\\bf f}_{\\sf cand, {\\hspace{0.02in} } 2}(i)\n= \\frac{1} { \\sqrt{N_t} } \\cdot e^{j \\theta_i}$ and ${\\bf g}_{\\sf cand,{\\hspace{0.02in} } 2} =\n\\frac{1} { \\sqrt{N_t} } \\cdot \\frac{ {\\sf H} {\\hspace{0.02in} } {\\bf f}_{\\sf cand, {\\hspace{0.02in} } 2} }\n{ \\| {\\sf H} {\\hspace{0.02in} } {\\bf f}_{\\sf cand, {\\hspace{0.02in} } 2} \\|_{\\infty} }$ lead to a good\nbeamforming solution for the problem considered in this section.\n\\label{prop1}\n\\end{prop}\n\\begin{proof}\nSee Appendix~\\ref{appC}.\n\n\\end{proof}\n\nThe importance of the beamforming structure from Prop.~\\ref{prop1} relative to the\none in~(\\ref{eq_5}) is that while the latter is just a equal-gain quantization\nof~(\\ref{eq_2}) and thus requires the entire ${\\sf H}$ for its design, the former\nis more transparent in terms of the column vectors of ${\\sf H}$ and can thus be\ndesigned via a simple uplink training scheme.\n\nFig.~\\ref{fig1}(a) plots the complementary cumulative distribution function (complementary\nCDF) of the loss in ${\\sf SNR}_{\\sf rx}$ between the optimal beamforming scheme in~(\\ref{eq_2})\nand four candidate beamforming schemes: i) equal-gain RSV and matched filter scheme\nfrom~(\\ref{eq_5}), ii) beamforming scheme from Prop.~\\ref{prop1}, iii) beamforming\nalong the dominant direction at the MWB and the matched filter to the dominant\ndirection at the UE, and iv) beamforming along the dominant directions at the MWB\nand the UE in a $N_r = 4, N_t = 64$ system generated by $L = 2$ clusters whose AoAs/AoDs\nare independently and identically distributed (i.i.d.) in the $120^{\\sf o}$ field-of-view\n(coverage area) of the arrays in the azimuth. From this study, we see that the\nperformance of the scheme from Prop.~\\ref{prop1} is similar to that from~(\\ref{eq_5}),\nas is the replacement of matched filter at the UE end with the dominant direction.\n\n\n\\begin{figure*}[htb!]\n\\begin{center}\n\\begin{tabular}{cc}\n\\includegraphics[height=2.7in,width=3.15in] {fig1a_v1.eps}\n&\n\\includegraphics[height=2.7in,width=3.15in] {fig1b_v1.eps}\n\\\\ {\\hspace{0.35in}} (a) & {\\hspace{0.12in}} (b)\n\\end{tabular}\n\\caption{\\label{fig1}\nComplementary CDF of loss in ${\\sf SNR}_{\\sf rx}$ between the optimal beamforming\nscheme from ${\\cal F}_2^{N_t}$ in~(\\ref{eq_2}) relative to: (a) different\nbeamforming solutions with $L = 2$ clusters, and (b) a dominant directional\nbeamforming scheme with different choices of $L$. }\n\\end{center}\n\\vspace{-5mm}\n\\end{figure*}\n\n\\subsection{Issues with RSV Learning}\n\\label{sec_3c}\n\nThe (near-)optimality of the RSV-type solutions from ${\\cal F}_2^{N_t}$ and\n${\\cal F}_{\\infty}^{N_t}$ suggests that a reasonable approach for beamformer design\nis to let the MWB and UE learn an approximation to ${\\bf f}_{\\sf opt}$ and\n${\\bf g}_{\\sf opt}$, respectively. A similar approach is adopted at cellular\nfrequencies under the rubric of limited feedback schemes that approximate the RSV\nof the channel from a codebook of beamforming vectors. We specialize this approach\nand elaborate on their appropriateness for mmW systems.\n\nA well-known RSV learning scheme that exploits the time division duplexing(TDD)-reciprocity\nof the channel ${\\sf H}$ is power iteration~\\cite[Sec.\\ 7.3]{golub} which iterates\n($i = 0, 1, \\cdots$) a randomly initialized beamforming vector (${\\bf f}_0$) over the\nchannel as follows:\n\\begin{eqnarray}\n\\widetilde{\\bf g}_{i+1} & = & \\sqrt{ \\rho_{\\sf f} } \\cdot {\\sf H} {\\bf f}_i +\n{\\bf n}_{ {\\sf f}, {\\hspace{0.02in} } i +1}\n\\label{eq_7}\n\\\\\n{\\bf g}_{i+1} & = & \\frac{ \\widetilde{\\bf g}_{i+1} } { \\| \\widetilde{\\bf g}_{i+1} \\|_2}\n= \\frac{ \\sqrt{ \\rho_{\\sf f} } \\cdot {\\sf H}  {\\bf f}_i + {\\bf n}_{ {\\sf f}, {\\hspace{0.02in} } i +1} }\n{ \\| \\sqrt{ \\rho_{\\sf f} } \\cdot {\\sf H} {\\bf f}_i + {\\bf n}_{ {\\sf f}, {\\hspace{0.02in} } i +1} \\|_2 }\n\\label{eq_8}\n\\\\\n{\\bf z}_{i+1} & = & \\sqrt{ \\rho_{\\sf r} } \\cdot {\\sf H}^T {\\bf g}_{i + 1}^{\\star} +\n{\\bf n}_{ {\\sf r}, {\\hspace{0.02in} } i+1}^{\\star}\n\\label{eq_9}\n\\\\\n{\\bf f}_{i+1} & = & \\frac{ {\\bf z}_{i+1}^{\\star} } { \\| {\\bf z}_{i+1} \\|_2 }\n= \\frac{ \\sqrt{ \\rho_{\\sf r} } \\cdot {\\sf H}^H {\\bf g}_{i + 1} + {\\bf n}_{ {\\sf r}, {\\hspace{0.02in} } i+1} }\n{ \\| \\sqrt{ \\rho_{\\sf r} } \\cdot {\\sf H}^H {\\bf g}_{i + 1} + {\\bf n}_{ {\\sf r}, {\\hspace{0.02in} } i+1} \\|_2 }.\n\\label{eq_10}\n\\end{eqnarray}\nIn~(\\ref{eq_7})-(\\ref{eq_10}), $\\rho_{\\sf f}$ and $\\rho_{\\sf r}$ stand for the\npre-beamforming ${\\sf SNR}$s of the forward and reverse links, respectively. A\nstraightforward simplification shows that\n\\begin{eqnarray}\n{\\bf f}_{i+1} = \\frac{\n\\sqrt{ \\rho_{\\sf f} \\rho_{\\sf r} } \\cdot {\\sf H}^H {\\sf H} {\\hspace{0.02in} } {\\bf f}_i +\n\\sqrt{\\rho_{\\sf r} } {\\hspace{0.02in} } {\\sf H}^H {\\bf n}_{ {\\sf f}, {\\hspace{0.02in} } i + 1} +\n\\| \\sqrt{ \\rho_{\\sf f}} {\\hspace{0.02in} } {\\sf H} {\\hspace{0.02in} } {\\bf f}_i + {\\bf n}_{ {\\sf f}, {\\hspace{0.02in} } i + 1} \\|_2\n\\cdot {\\bf n}_{ {\\sf r}, {\\hspace{0.02in} } i + 1} }\n{ \\| \\sqrt{ \\rho_{\\sf f} \\rho_{\\sf r} } \\cdot {\\sf H}^H {\\sf H} {\\hspace{0.02in} } {\\bf f}_i +\n\\sqrt{\\rho_{\\sf r} } {\\hspace{0.02in} } {\\sf H}^H {\\bf n}_{ {\\sf f}, {\\hspace{0.02in} } i + 1} +\n\\| \\sqrt{ \\rho_{\\sf f}} {\\hspace{0.02in} } {\\sf H} {\\hspace{0.02in} } {\\bf f}_i + {\\bf n}_{ {\\sf f}, {\\hspace{0.02in} } i + 1} \\|_2\n\\cdot {\\bf n}_{ {\\sf r}, {\\hspace{0.02in} } i + 1} \\|_2 }.\n\n\\label{eq23}\n\\end{eqnarray}\nWhen the system is noise-free ($\\{ \\rho_{\\sf f} , {\\hspace{0.02in} } \\rho_{\\sf r} \\} \\rightarrow \\infty$),\nthe above algorithm reduces to\n\\begin{eqnarray}\n{\\bf f}_{i+1} & \\rightarrow & \\frac{ {\\sf H}^H {\\sf H} {\\hspace{0.02in} } {\\bf f}_i }\n{ \\| {\\sf H}^H {\\sf H} {\\hspace{0.02in} } {\\bf f}_i \\|_2 }  \\Longrightarrow {\\bf f}_{i+1}\n\\rightarrow \\frac{ \\left( {\\sf H}^H {\\sf H} \\right)^{i+1} {\\bf f}_0 }\n{ \\| \\left( {\\sf H}^H {\\sf H} \\right)^{i+1} {\\bf f}_0  \\|_2}\n\\label{eq24}\n\\\\\n{\\bf g}_{i+1} & \\rightarrow & \\frac{ {\\sf H} {\\hspace{0.02in} } {\\bf f}_i }\n{ \\| {\\sf H} {\\hspace{0.02in} } {\\bf f}_i \\|_2 }\n\\Longrightarrow {\\bf g}_{i+1} \\rightarrow\n \\frac{ {\\sf H} \\left( {\\sf H}^H {\\sf H} \\right)^{i+1} {\\bf f}_0 }\n{ \\| {\\sf H} \\left( {\\sf H}^H {\\sf H} \\right)^{i+1} {\\bf f}_0  \\|_2} .\n\\label{eq25}\n\\end{eqnarray}\nWith ${\\sf H}^H {\\sf H} = {\\sf V} {\\sf \\Lambda} {\\sf V}^H$, we have\n\\begin{eqnarray}\n{\\bf f}_{i+1} = \\frac{ \\sum_{j = 1}^{N_t} {\\sf v}_j \\cdot\n\\left( {\\sf v}_j^H {\\bf f}_0 \\right) \\cdot \\left( {\\sf \\Lambda}_j \\right)^{i+1} }\n{ \\|\\sum_{j = 1}^{N_t} {\\sf v}_j \\cdot\n\\left( {\\sf v}_j^H {\\bf f}_0 \\right) \\cdot \\left( {\\sf \\Lambda}_j \\right)^{i+1} \\|_2 }.\n\\label{eq26}\n\\end{eqnarray}\n\n\n\\begin{figure*}[htb!]\n\\begin{center}\n\\begin{tabular}{cc}\n\\includegraphics[height=2.7in,width=3.15in] {fig2a_v1.eps}\n&\n\\includegraphics[height=2.7in,width=3.15in] {fig2b_v1.eps}\n\\\\ {\\hspace{0.35in}} (a) & {\\hspace{0.12in}} (b)\n\\end{tabular}\n\\caption{\\label{fig2}\nComplementary CDF of loss in ${\\sf SNR}_{\\sf rx}$ between the optimal beamforming\nscheme from ${\\cal F}_2^{N_t}$ in~(\\ref{eq_2}) and the noisy power iteration scheme\nwith (a) $\\rho_{\\sf f} = \\rho_{\\sf r} = -25$ dB and (b) $\\rho_{\\sf f} = \\rho_{\\sf r}\n= -10$ dB.}\n\\end{center}\n\\vspace{-5mm}\n\\end{figure*}\n\nWhile the noise-free power iteration scheme has been proposed in the MIMO context\nin~\\cite{dahl}, understanding the performance tradeoff of the noisy case analytically\nappears to be a difficult problem, in general. To surmount this difficulty, we\nnumerically study the performance of the noisy case at a low pre-beamforming ${\\sf SNR}$\non the order of $-25$ to $-10$ dB. We consider the case where $N_{\\sf npi} = 256$\nsamples are used for RSV learning and these samples are partitioned in different\nways\\footnote{Note that the $2$ factor in the partition of $N_{\\sf npi}$ arises because\npower iteration is bi-directional.} as $N_{\\sf npi} = 2N_{\\sf noi} \\times N_{\\sf iter}$.\nHere, $N_{\\sf noi}$ samples are used to improve $\\rho_{\\sf f}$ by noise averaging and\n$N_{\\sf iter}$ samples are used for beamformer iteration. In particular, we consider the\nfollowing choices for $N_{\\sf noi}$ in our study: $\\{4, 8, 16, 32, 64 \\}$ with $\\rho_{\\sf f}\n= \\rho_{\\sf r} = \\{-25, {\\hspace{0.02in} } -10 \\}$ dB and Figs.~\\ref{fig2}(a)-(b) plot the\ncomplementary cumulative distribution function (CDF)\nof the loss in ${\\sf SNR}_{\\sf rx}$ for these two scenarios in a $L = 2, N_r = 4$ and\n$N_t = 64$ system with averaging over the random choice of ${\\bf f}_0$. From these two\nplots, we observe that given $N_{\\sf npi}$ samples, noise averaging is a task of higher\nimportance at low pre-beamforming ${\\sf SNR}$s than beamformer iteration. Nevertheless,\nin spite of the best noise averaging, the noisy power iteration scheme has a poor\nperformance at low ${\\sf SNR}$s (for a large fraction of the users at $-25$ dB and a good\nfraction at $-10$ dB) as noise is amplified in the iteration process rather than the\nchannel's RSV.\n\n\nThe RSV learning scheme also suffers from other problems that make its applicability\nin mmW systems difficult. Since each user's RSV has to be learned via a bi-directional\niteration, it is not amenable (in this form) as a common broadcast solution for the\ndownlink setting. This is particularly disadvantageous and impractical if each MWB has\nto initiate a unicast session with a UE that is yet to be discovered. Further, the need\nto sample each antenna individually (at both ends) can considerably slow down the iteration\nprocess with RF hardware constraints (e.g., when there are fewer RF chains than antennas).\nIn addition, this approach requires calibration of the receive-side RF chain relative to\nthe transmit-side RF chain with respect to phase and amplitude as well as phase coherence\nduring the iteration. More importantly, this approach critically depends on TDD\nreciprocity, which could be complicated in certain deployment scenarios that do not allow\nthis possibility~\\cite{roh}.\n\nAn alternate approach given the RSV structure in Theorem~\\ref{thm1} is to learn the\ndominant directions at the MWB end $\\{ \\widehat{\\phi}_{ {\\sf T}, \\ell} \\}$ and then\ncombine the beams with appropriate weights $\\{ \\widehat{\\alpha}_{\\ell} \\}$ to result\nin a \nbeamforming vector:\n\\begin{eqnarray}\n{\\bf f}_{\\sf comb} = \\frac{  \\sum_{\\ell = 1}^L \\widehat{\\alpha}_{\\ell} {\\hspace{0.05in} }\n{\\sf CPO} ( \\widehat{ \\phi}_{ {\\sf T}, \\ell } ) }\n{\\| \\sum_{\\ell = 1}^L \\widehat{\\alpha}_{\\ell} {\\hspace{0.05in} }\n{\\sf CPO} ( \\widehat{ \\phi}_{ {\\sf T}, \\ell } )\\|_2 }.\n\\label{eq27}\n\\end{eqnarray}\nThe difficulty with this approach is that it suffers from PA inefficiency (not all\nthe PAs operate at maximal power). Fig.~\\ref{fig3}(a) plots the complementary CDF of\nthe peak-to-average ratio \n\n\n(PAR) of ${\\bf f}_{\\sf comb}$, defined as,\n\\begin{eqnarray}\n{\\sf PAR} \\triangleq  \n\n\\frac{ \\max_i | {\\bf f}_{\\sf comb}(i) |^2}{ 1/ N_t} =\nN_t \\cdot \\max_i | {\\bf f}_{\\sf comb}(i)|^2\n\\end{eqnarray}\ncorresponding to beam combining along two randomly chosen, but known directions\nwith random weights. Fig.~\\ref{fig3}(a) shows that a median PAR loss of over $2$ dB\nis seen for $N_t \\geq 8$ suggesting that the RSV gain relative to directional\nbeamforming of less than a dB (see Fig.~\\ref{fig1}(a)) is significantly outweighed\nby the PA inefficiency. In other words, the ${\\sf SNR}_{\\sf rx}$ loss with just\nselecting the dominant direction at the MWB and the UE ends is far less than the PA\nbackoff due to combining multiple directions at the MWB or the UE.\n\n\n\n\\begin{figure*}[htb!]\n\\begin{center}\n\\begin{tabular}{cc}\n\\includegraphics[height=2.7in,width=3.15in] {fig3a_v1.eps}\n&\n\\includegraphics[height=2.7in,width=3.15in] {fig3b_v1.eps}\n\\\\ {\\hspace{0.35in}} (a) & {\\hspace{0.12in}} (b)\n\\end{tabular}\n\\caption{\\label{fig3}\n(a) Complementary CDF of PAR of the combined beamforming vector needed to mimic the\nRSV structure. (b) Typical performance loss with mismatched RSV and mismatched\ndominant directional beamforming schemes relative to optimal beamforming in the\nperturbed case.}\n\\end{center}\n\\vspace{-5mm}\n\\end{figure*}\n\nMore generally, any RSV learning scheme is bound to be extremely sensitive\\footnote{Note\nthat the higher sensitivity of the eigenvectors of a MIMO channel matrix (relative to\nthe eigenvalues) to small perturbations in the channel entries has been\nwell-understood~\\cite{vasanth_isit05,vasanth_jsac}. See~\\cite[Sec.\\ 7.2]{golub} for\ntheoretical details.} to relative phase changes across paths. For example, Fig.~\\ref{fig3}(b)\nplots the typical behavior of loss in ${\\sf SNR}_{\\sf rx}$ with the mismatched reuse of\nthe optimal beamformer and the dominant directional beamformer (both from the unperturbed\ncase) relative to the optimal beamformer in the perturbed case as the phase of the dominant\npath in a $L = 2, N_r = 4, N_t = 64$ system changes. In this example, the two paths are\nsuch that $\\phi_{ {\\sf R},1} = 108.57^{\\sf o}$, $\\phi_{ {\\sf T},1} = 83.74^{\\sf o}$,\n$\\alpha_1 = 2.61$, $\\phi_{ {\\sf R},2} = 92.74^{\\sf o}$, $\\phi_{ {\\sf T},2} = 94.26^{\\sf o}$,\n$\\alpha_2 = 1.79$. We note that the RSV scheme takes a steep fall in performance as the\nphase changes, whereas the directional scheme remains approximately stable in performance.\nIt is important to note that a $360^{\\sf o}$ change in phase corresponds to a change in path\nlength of $\\lambda$ (a small distance at higher carrier frequencies and hence an increasingly\nlikely possibility). Such a sensitivity for any RSV reconstruction scheme to phase changes\nrenders this approach's utility in the mmW context questionable.\n\n\\section{Directional Beamforming and Direction Learning}\n\\label{sec4}\n\nInstead of the RSV solution, we now consider the performance loss with a\nlow-complexity strategy that beamforms along the dominant direction at the MWB and\nthe UE. From the numerical study in Fig.~\\ref{fig1}(a), we see that the dominant\ndirectional beamforming scheme suffers only a minimal loss relative to even the best\nscheme from ${\\cal F}_2^{N_t}$ and ${\\cal F}_2^{N_r}$ (a median loss of a fraction\nof a dB and less than a dB even at the $90$-th percentile level). Further,\nFig.~\\ref{fig1}(b) plots the complementary CDF of the loss in ${\\sf SNR}_{\\sf rx}$\nbetween the optimal scheme in~(\\ref{eq_2}) and the dominant directional beamforming\nscheme with different choices of $L$: $L = 2, 3, 4, 5, 10$ or $20$. From this study,\nwe note that directional beamforming results in less than a dB loss for over $50\\%$\nof the users for even up to $L = 5$ clusters. Further, directional beamforming results\nin no more than $2.5$ dB loss for even up to $90\\%$ of the users. Thus, this study\nsuggests that learning the directions (AoAs/AoDs) along which the UE and MWB should\nbeamform is a useful strategy for initial UE discovery.\n\n\\subsection{Learning Dominant Directions via Subspace Methods}\n\\label{sec4_a}\n\nAoA/AoD learning with multiple antenna arrays has a long and illustrious history\nin the signal/array processing literature~\\cite{krim}. In the simplest case of\nestimating a single unknown source (signal direction) at the UE end with system\nequation:\n\\begin{eqnarray}\n{\\bf y} = \\alpha_1 {\\bf u}( \\phi_1) + {\\bf n}\n\n\\label{eq28}\n\\end{eqnarray}\nwhere $\\alpha_1$ is known, ${\\bf u}(\\cdot)$ denotes the array steering vector\nand ${\\bf n} \\sim {\\cal CN}( {\\bf 0}, {\\bf I})$, it can be seen that the density\nfunction $\\log \\left( f( {\\bf y} | \\alpha_1, \\phi_1) \\right)$ can be written as ${\\sf C} -\n( {\\bf y} - \\alpha_1 {\\bf u}(\\phi_1) )^H ( {\\bf y} - \\alpha_1 {\\bf u}(\\phi_1) )$\nfor an appropriately defined constant ${\\sf C}$. Thus, the maximum likelihood (ML) solution\n($\\widehat{\\phi}_1$) that maximizes the density can be seen to be $\\widehat{\\phi}_1 =\n\\arg \\max_{\\phi} | {\\bf u}(\\phi)^H {\\bf y} |^2$. Rephrasing, correlation of the\nreceived vector ${\\bf y}$ for the best signal strength results in the ML solution\nfor the problem of signal coming from one unknown direction.\n\nIn general, if there are multiple ($K$) sources with system equation\n\\begin{eqnarray}\n{\\bf y} = \\sum_{k = 1}^K \\alpha_k {\\bf u}(\\phi_k) + {\\bf n},\n\n\\label{eq29}\n\\end{eqnarray}\nthe density function of ${\\bf y}$ is non-convex in the parameters resulting in a\nnumerical multi-dimensional search in the parameter space. In this context, the main\npremise behind the \nMUSIC algorithm~\\cite{schmidt} is\nthat the signal subspace is $K$-dimensional and is orthogonal to the noise subspace.\nFurthermore, the $K$ largest eigenvalues of the estimated received covariance matrix,\n$\\widehat{\\bf R}_{\\bf y}$, correspond to the signal subspace and the other eigenvalues\nto the noise subspace (provided the covariance matrix estimate is reliable). The MUSIC\nalgorithm then estimates the signal directions by finding the ($K$) peaks of the\npseudospectrum\\footnote{In general, the choice of $K$ in~(\\ref{eq_17}) has to be\nestimated via an information theoretic criterion as in~\\cite{wax_kailath} or via\nminimum description length criteria such as those due to Rissanen or Schwartz.},\ndefined as,\n\\begin{eqnarray}\nP_{\\sf MUSIC}(\\phi) \\triangleq \\frac{1}{ \\sum_{n = K+1}^{N_r} | {\\bf u}(\\phi)^H\n\\widehat{\\bf q}_n|^2 }\n\\label{eq_17}\n\\end{eqnarray}\nwhere $\\{ \\widehat{\\bf q}_{K+1}, \\cdots, \\widehat{\\bf q}_{N_r} \\}$ denote the\neigenvectors of the noise subspace of $\\widehat{\\bf R}_{\\bf y}$. The principal advantage\nof the MUSIC algorithm is that the signal maximization task has been recasted as a noise\nminimization task, a one-dimensional line search problem albeit at the cost of computing\nthe eigenvectors of $\\widehat{\\bf R}_{\\bf y}$. Nevertheless, since $\\{ \\widehat{\\bf q}_1,\n\\cdots, \\widehat{\\bf q}_{N_r}\\}$ can be chosen to form a unitary basis, it is seen that\nMUSIC attempts to maximize $\\sum_{n = 1}^K | {\\bf u}(\\phi)^H \\widehat{\\bf q}_n|^2$ (or in\nother words, it assigns equal weights to all the components of the signal subspace and is\nhence not ML-optimal).\n\nWe now apply the MUSIC algorithm to direction learning at the MWB and UE by a bi-directional\napproach where the MWB learns the AoD by estimating the uplink covariance matrix (where the\nUE trains the MWB), and the UE learns the AoA by estimating the downlink covariance matrix\n(where the MWB trains the UE). We consider the case where $N_{\\sf music} = 256$ samples\nare used for direction learning. Since the MWB is equipped with more antennas than the UE,\nwe partition $N_{\\sf music}$ into $N_{\\sf up} = 192$ samples for uplink (AoD) training and\n$N_{\\sf down} = 64$ samples for downlink (AoA) training. As before, we partition $N_{\\sf up}$\nin different ways as $N_{\\sf up} = N_{\\sf up,cov} \\times N_{\\sf up,noi}$ where $N_{\\sf up,noi}$\nsamples are used for link margin improvement and $N_{\\sf up,cov}$ samples are used for uplink\ncovariance matrix estimation. In particular, we study the following choices here:\n$N_{\\sf up,cov} = \\{12, 24, 32, 48, 64, 96 \\}$. $N_{\\sf down} = 64$ is partitioned as\n$N_{\\sf down,noi} = N_{\\sf down,cov} = 8$. Figs.~\\ref{fig4}(a) and (b) plot the complementary\nCDF of ${\\sf SNR}_{\\sf rx}$ with such a bi-directional MUSIC algorithm for $\\rho_{\\sf f}\n= \\rho_{\\sf r} = -25$ dB and $-10$ dB, respectively. In general, $\\rho_{\\sf f} > \\rho_{\\sf r}$\nand Fig.~\\ref{fig4} serves as a more optimistic characterization of the MUSIC scheme for mmW\nsystems.\n\n\n\\begin{figure*}[htb!]\n\\begin{center}\n\\begin{tabular}{cc}\n\\includegraphics[height=2.7in,width=3.15in] {fig4a_v1.eps}\n&\n\\includegraphics[height=2.7in,width=3.15in] {fig4b_v1.eps}\n\\\\ {\\hspace{0.35in}} (a) & {\\hspace{0.12in}} (b)\n\\end{tabular}\n\\caption{\\label{fig4}\nComplementary CDF of loss in ${\\sf SNR}_{\\sf rx}$ between the optimal\nbeamforming scheme in ${\\cal F}_2^{N_t}$ in~(\\ref{eq_2}) and MUSIC with\n(a) $\\rho_{\\sf f} = \\rho_{\\sf r} = -25$ dB and (b) $\\rho_{\\sf f} =\n\\rho_{\\sf r} = -10$ dB.}\n\\end{center}\n\\vspace{-5mm}\n\\end{figure*}\n\n\nFrom Fig.~\\ref{fig4}, we note that the performance is rather poor at low link margins, but\nsignificantly better as the link margin improves. An important reason for the poor performance\nof the MUSIC approach is that consistent covariance matrix estimation becomes a difficult\nexercise with very few samples, especially as the antenna dimensions increase at the MWB end.\nFurthermore, as with the noisy power iteration scheme, MUSIC also requires a non-broadcast\nsystem design. It also suffers from a high computational complexity (dominated by the\neigen-decomposition of an $N_t \\times N_t$ matrix in uplink training). In general, the\ncomputational complexity of MUSIC can be traded off by constraining the antenna array\nstructure in various ways. Nevertheless, we expect the computational complexity of other\nsuch constrained AoA/AoD learning techniques such as Estimation of Signal Parameters via\nRotational Invariance Techniques (ESPRIT) algorithm~\\cite{roy_kailath}, Space-Alternating\nGeneralized Expectation maximization (SAGE) algorithm~\\cite{fessler,fleury}, higher-order\nsingular value decomposition, RIMAX~\\cite{richter}, and compressive sensing techniques that\nemploy nuclear norm optimization~\\cite{ramasamy,schniter,recht} to be of similar nature as the MUSIC algorithm.\nAll these reasons suggest that while the MUSIC algorithm may be useful for beam refinement\nafter the UE has been discovered, its utility in UE discovery is questionable.\n\n\n\\begin{figure*}[htb!]\n\\begin{center}\n\\includegraphics[height=3.0in,width=4.5in]{fig_beamsoverlaid_CPO_interm_broad_v1.eps}\n\\caption{\\label{fig4c}\nMain idea of beam broadening illustrated with the overlaid beam patterns of beamforming\nvectors from three (narrow/${\\sf CPO}$ beams, intermediate beams and broad beams) codebooks.}\n\\end{center}\n\\vspace{-5mm}\n\\end{figure*}\n\n\\subsection{Beam Broadening for Initial UE Discovery}\n\\label{sec_4b}\nLet $\\Omega$ denote the beamspace transformation at the MWB side, $\\Omega = k d_{\\sf T}\n\\cos(\\phi_{\\sf T}) = \\pi \\cos( \\phi_{\\sf T})$, corresponding to an inter-antenna spacing of\n$\\lambda/2$. Towards the goal of alternate direction learning strategies, we consider\nthe problem of understanding the tradeoff in the design of beamforming vectors that cover a\nbeamspace area of $\\overline{\\Omega}$ with as few beamforming vectors as possible without\nsacrificing the worst-case beamforming gain in the coverage area~\\cite{hur,rajagopal}.\n\nThe basic idea of beam broadening is illustrated in Fig.~\\ref{fig4c} where three\ndifferent codebooks of beamforming vectors are used to cover a coverage area of\n$120^{\\sf o}$ (from $30^{\\sf o}$ to $150^{\\sf o}$). The first codebook (illustrated\nin red) consists of narrow ${\\sf CPO}$ beams (pointing at optimally chosen directions\nover the coverage area) which leads to a peak beamforming gain of $10 \\log_{10}(N_t)$\ndB as well as a reasonably high worst-case beamforming gain over the coverage area,\nalthough at the cost of a high UE discovery latency corresponding to a beam sweep over\n$16$ directions/beams. The second codebook (illustrated in black) consists of intermediate\nbeams which leads to a lower peak beamforming gain (as well as a worst-case gain) over\nthe coverage area, but the UE discovery period is shortened as it now consists of a beam\nsweep over $8$ directions/beams. The third codebook (illustrated in blue) consists of\nbroad beams which leads to a more reduced peak beamforming gain, but the UE discovery\nperiod is a sweep over only $4$ directions/beams. Either codebook could be useful\nfor initial UE discovery depending on the link margin of the UE's involved. For example,\na UE geographically close to the MWB and suffering minimal path loss can accommodate a\nbroad beam codebook and be quickly discovered, whereas a UE at the cell-edge or suffering\nfrom huge blocking losses may need the narrow ${\\sf CPO}$ beam codebook to even close the\nlink with the MWB. The intermediate codebook trades off these two properties.\n\nWe now recast the above idea in the form of a well-posed optimization problem. For this,\ngiven a beamspace coverage area of $\\Omega_0$ for a single beam (centered around\n$\\Omega_{\\sf c} = \\pi/2$, without loss in generality), \nwe seek the design of:\n\\begin{eqnarray}\n{\\bf f}_{ \\Omega_0} \\triangleq \\arg \\max \\limits_{ {\\bf f} {\\hspace{0.02in} } \\in\n{\\hspace{0.02in} } {\\cal F}_{\\infty}^{N_t} } \\min \\limits_{ \\Omega {\\hspace{0.02in} } \\in {\\hspace{0.02in} }\n\\left[ \\Omega_{\\sf c} - \\frac{ \\Omega_0}{2} , {\\hspace{0.02in} } \\Omega_{\\sf c} +\n\\frac{ \\Omega_0}{2} \\right] } | {\\bf F}(\\Omega)|^2\n\\label{eq31}\n\\end{eqnarray}\nwhere ${\\bf F}(\\Omega) = \\sum_{n = 0}^{N_t - 1} {\\bf f}(n) e^{-j \\Omega n}\n= {\\bf a}(\\Omega)^H {\\bf f}$ with ${\\bf a}(\\Omega) = \\left[ 1, {\\hspace{0.02in} } e^{j \\Omega},\n\\cdots, e^{ j(N_t-1) \\Omega} \\right]^T$.\nWith ${\\bf f}_{\\Omega_0}$ as template, the number of beamforming vectors needed to\ncover $\\overline{\\Omega}$ (say, a $120^{\\sf o}$ field-of-view as in Fig.~\\ref{fig4c})\nis ${\\sf No. {\\hspace{0.02in} } beams} = \\frac{ \\overline{\\Omega}} { \\Omega_0}$.\n\nWe start with an upper bound on the tradeoff between ${\\sf No. {\\hspace{0.02in} } beams}$ and\nthe worst-case beamforming gain over $\\overline{\\Omega}$. From the Parseval identity,\nwe have the following trivial relationship for any ${\\bf f}$:\n\\begin{eqnarray}\n\\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} | {\\bf F}(\\Omega)|^2 d \\Omega =\n\\sum_{n = 0}^{N_t - 1} |{\\bf f}(n)|^2 \\leq 1.\n\\label{eq_19}\n\\end{eqnarray}\n\n\n\n\n\n\n\n\nIf $\\min \\limits_{ \\Omega {\\hspace{0.02in} } \\in {\\hspace{0.02in} } \\left[ \\Omega_{\\sf c} - \\frac{ \\Omega_0}{2} ,\n{\\hspace{0.02in} } \\Omega_{\\sf c} + \\frac{ \\Omega_0}{2} \\right] } | {\\bf F}(\\Omega)|^2 = P$, we have\n\\begin{eqnarray}\n\\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} | {\\bf F}(\\Omega)|^2 d \\Omega\n\\geq \\frac{1}{2\\pi} \\int_{ \\Omega {\\hspace{0.02in} } \\in {\\hspace{0.02in} } \\left[ \\Omega_{\\sf c} - \\frac{ \\Omega_0}{2} ,\n{\\hspace{0.02in} } \\Omega_{\\sf c} + \\frac{ \\Omega_0}{2} \\right] } | {\\bf F}(\\Omega)|^2 d \\Omega\n\\geq P \\cdot \\frac{ \\Omega_0}{ 2 \\pi}\n\\Longrightarrow P \\leq \\frac{ 2 \\pi}{ \\Omega_0}.\n\\label{eq33}\n\\end{eqnarray}\nFurther, $P$ is also constrained as $P \\leq N_t$ since the maximal beamforming gain cannot\nexceed $N_t$ in any direction. Thus, the worst-case beamforming gain over\nthis area (in dB) is upper bounded as\n\\begin{eqnarray}\n{\\sf BF {\\hspace{0.05in} } Gain} & \\triangleq & \n\n\n\n\n\n\n10 \\log_{10}\\left( P \\right) \\leq 10 \\log_{10} \\left( \\min\n\\left(N_t, {\\hspace{0.02in} } \\frac{ 2 \\pi} { \\overline{\\Omega} } \\cdot {\\sf No. {\\hspace{0.02in} } beams}\n\\right) \\right).\n\\label{eq35}\n\\end{eqnarray}\nWe now provide an alternate non-trivial approach based on computation of eigenvalues of\ncertain appropriately-defined matrices for a better upper bound of this tradeoff.\n\n\\begin{figure*}[htb!]\n\\begin{center}\n\\begin{tabular}{cc}\n\\includegraphics[height=2.7in,width=3.15in] {fig5a_v1.eps}\n&\n\\includegraphics[height=2.7in,width=3.15in] {fig5b_v1.eps}\n\\\\ {\\hspace{0.35in}} (a) & {\\hspace{0.12in}} (b)\n\\\\\n\\includegraphics[height=2.7in,width=3.15in] {fig5c_v1.eps}\n&\n\\includegraphics[height=2.7in,width=3.15in] {fig5d_v1.eps}\n\\\\ {\\hspace{0.35in}} (c) & {\\hspace{0.12in}} (d)\n\\end{tabular}\n\\caption{\\label{fig5}\n(a) Upper bound to the beamforming gain vs.\\ number of beams tradeoff for\n$N_t = 64$. (b) Optimal ${\\sf f}$ and (c) length of middle subarray(s)\nas a function of $\\Omega_0$ for different choices of $M$. (d) Beam patterns\nof broadened beams for certain choices of $\\Omega_0$ in the $M = 2$ case.\n}\n\\end{center}\n\\vspace{-5mm}\n\\end{figure*}\n\n\n\n\\begin{thm}\n\\label{thm3}\nLet $\\Omega_j, {\\hspace{0.05in} } j = 1, \\cdots , J$ be a set of sampling frequencies over the\nbeamspace area of $\\Omega_0$ spanned by the beamforming vector ${\\bf f}$. The worst-case\nbeamforming gain with ${\\bf f}$ is upper bounded by the solution to the following\noptimization:\n\\begin{eqnarray}\n{\\sf BF {\\hspace{0.05in} } Gain} \\leq 10 \\log_{10} \\left(\nN_t, {\\hspace{0.05in} } \\min \\limits_{ J, {\\hspace{0.02in} } \\{ \\Omega_j \\} }\n\\frac{ \\lambda_{\\sf max} \\left(\n\\sum_{j = 1}^J {\\bf a}(\\Omega_j) {\\bf a}(\\Omega_j)^H \\right) }{J}\n\\right)\n\\label{eq_23}\n\\end{eqnarray}\nwhere $\\Omega_j \\in \\left[ \\Omega_{\\sf c} - \\frac{ \\Omega_0 }{ 2} , {\\hspace{0.02in} }\n\\Omega_{\\sf c} + \\frac{ \\Omega_0 }{2} \\right]$ with $\\Omega_0 = \\frac{ \\overline{\\Omega}}\n{ {\\sf No. {\\hspace{0.02in} } beams} }$ and $\\lambda_{\\sf max}(\\bullet)$ stands for the\nlargest eigenvalue of the underlying positive semi-definite matrix.\n\\end{thm}\n\\begin{proof}\nSee Appendix~\\ref{appD}.\n\n\\end{proof}\n\nFig.~\\ref{fig5}(a) numerically optimizes the expression in~(\\ref{eq_23}) and\nplots the upper bound to the worst-case beamforming gain as a function of the\nnumber of beams to cover a $120^{\\sf o}$ field-of-view with $N_t = 64$. For\nthe eigenvalue-based approach, we plot the upper bound for specific choices of\n$J$ with $\\{ \\Omega_j \\}$ optimized, as well as the upper bound based on a joint\noptimization over $J$ and $\\{ \\Omega_j \\}$. Note that the horizontal segments in\nthe joint optimization correspond to the fact that the tradeoff with a larger\nnumber of beams can be no worser than the tradeoff with a smaller number of beams.\n\nIn contrast to the upper bound, we now propose specific approaches towards the\ngoal of beam broadening. For this, we initially consider partitioning of the antenna\narray at the MWB side into {\\em virtual subarrays} where each virtual subarray is\nused to beamform to a certain appropriately-chosen virtual direction. The expectation\nfrom this approach is that the beam patterns from the individual virtual subarrays\ncombine to enhance the coverage area of the resultant beam with minimal loss in peak\ngain due to reduction in the effective aperture of the subarrays.\n\n\n\\begin{figure*}[htb!]\n\\begin{center}\n\\begin{tabular}{cc}\n\\includegraphics[height=2.7in,width=3.15in] {fig6a_v1.eps}\n&\n\\includegraphics[height=2.7in,width=3.15in] {fig6b_v1.eps}\n\\\\ {\\hspace{0.35in}} (a) & {\\hspace{0.12in}} (b)\n\\end{tabular}\n\\caption{\\label{fig6}\n(a) Performance tradeoff with different beam broadening approaches for $N_t = 64$.\n(b) Complementary CDF of loss in ${\\sf SNR}_{\\sf rx}$ between the optimal\nbeamforming scheme in ${\\cal F}_2^{N_t}$ in~(\\ref{eq_2}) and beam sweep with the\nbroadened beams as in Fig.~\\ref{fig6}(a) at $\\rho_{\\sf f} = -10$ dB.}\n\\end{center}\n\\vspace{-5mm}\n\\end{figure*}\n\n\nAs a specific example, in the $M = 2$ virtual subarray setting, we propose the\nfollowing beamforming vector that orients along\n$\\pi - \\cos^{-1} \\left( \\frac{2 {\\sf f}} {N_t} \\right)$ and\n$\\cos^{-1} \\left (  \\frac{2 {\\sf f} } {N_t} \\right)$ with each half of the array.\nThat is,\n\\begin{eqnarray}\n{\\bf f}(n) = \\frac{1}{ \\sqrt{N_t} } \\left\\{\n\\begin{array}{ll}\n\\exp \\left( - \\frac{j 2 \\pi {\\sf f}}{N_t} ( n - \\frac{N_t}{2} + \\frac{1}{2} ) \\right)\n& {\\sf if} {\\hspace{0.05in} } 0 \\leq n \\leq \\frac{N_t}{2} - 1 \\\\\n\\exp \\left( \\frac{j 2 \\pi {\\sf f}}{N_t} ( n - \\frac{N_t}{2} + \\frac{1}{2} ) \\right)\n& {\\sf if} {\\hspace{0.05in} } \\frac{N_t}{2} \\leq n \\leq N_t - 1\n\\end{array}\n\\right.\n\\label{eq_24}\n\\end{eqnarray}\nwhere ${\\bf f}$ is designed to be a broadened beam by optimally choosing ${\\sf f}$.\nSimilarly, in the $M = 3$ and $M = 4$ settings, we propose the following beamforming\nvectors with two parameters (${\\sf f}$ and $0 \\leq L \\leq \\frac{N_t}{2}$)\nand three parameters (${\\sf f}$, {\\hspace{0.02in} } $\\delta {\\sf f}$ and $0 \\leq L \\leq \\frac{N_t}{2}$),\nrespectively:\n\\begin{eqnarray}\n{\\bf f} & = &\n\\frac{1}{ \\sqrt{N_t} } \\left\\{\n\\begin{array}{ll}\n\\exp \\left(- \\frac{j 2 \\pi {\\sf f}}{N_t} ( n - \\frac{N_t}{2} + \\frac{1}{2} + L) \\right)\n& {\\sf if} {\\hspace{0.05in} } 0 \\leq n \\leq \\frac{N_t}{2}  - L - 1 \\\\\n1 & {\\sf if} {\\hspace{0.05in} } \\frac{N_t}{2} - L \\leq n \\leq \\frac{N_t}{2} + L - 1 \\\\\n\\exp \\left( \\frac{j 2 \\pi {\\sf f}}{N_t} ( n - \\frac{N_t}{2} + \\frac{1}{2} - L) \\right)\n& {\\sf if} {\\hspace{0.05in} } \\frac{N_t}{2} + L \\leq n \\leq N_t - 1,\n\\end{array}\n\\right.\n\\label{eq_25}\n\\\\\n\n\n{\\bf f} & = &\n\\frac{1}{ \\sqrt{N_t} } \\left\\{\n\\begin{array}{ll}\n\\exp \\left(- \\frac{j 2 \\pi ( {\\sf f} + \\delta {\\sf f})  }{N_t}\n( n - \\frac{N_t}{2} + \\frac{1}{2} ) - \\frac{j 2 \\pi \\cdot \\delta{\\sf f}}\n{N_t} \\left( L - \\frac{1}{2} \\right) \\right)\n& {\\sf if} {\\hspace{0.05in} } 0 \\leq n \\leq \\frac{N_t}{2} - L - 1 \\\\\n\\exp \\left( - \\frac{j 2 \\pi {\\sf f}} {N_t} (n - \\frac{N_t}{2} + \\frac{1}{2} ) \\right)\n& {\\sf if} {\\hspace{0.05in} } \\frac{N_t}{2} - L \\leq n \\leq \\frac{N_t}{2} - 1 \\\\\n\\exp \\left(  \\frac{j 2 \\pi {\\sf f}} {N_t} (n - \\frac{N_t}{2} + \\frac{1}{2} ) \\right)\n& {\\sf if} {\\hspace{0.05in} } \\frac{N_t}{2} \\leq n \\leq \\frac{N_t}{2} + L - 1 \\\\\n\\exp \\left( \\frac{j 2 \\pi ( {\\sf f} + \\delta {\\sf f})  }{N_t}\n( n - \\frac{N_t}{2} + \\frac{1}{2} ) - \\frac{j 2 \\pi \\cdot \\delta{\\sf f}}\n{N_t} \\left( L - \\frac{1}{2} \\right) \\right)\n& {\\sf if} {\\hspace{0.05in} } \\frac{N_t}{2} + L \\leq n \\leq N_t - 1.\n\\end{array}\n\\right.\n\\label{eq_26}\n\\end{eqnarray}\nNote that~(\\ref{eq_25}) reduces to the $M = 2$ setting in~(\\ref{eq_24}) with $L = 0$\nwhere the beams are pointed at ${\\sf f}$, and with $L = \\frac{N_t}{2}$ where the beams\nare pointed at ${\\sf f} = 0$. Similarly,~(\\ref{eq_26}) reduces to the $M = 2$ setting\nwith $L = 0$ and $L = \\frac{N_t}{2}$ where the beams are pointed at ${\\sf f} + \\delta {\\sf f}$\nand ${\\sf f}$, respectively.\n\nFig.~\\ref{fig5}(b) plots the optimal values of ${\\sf f}$ (and $\\delta {\\sf f}$)\ndesigned to maximize $\\min |{\\bf F}(\\Omega)|^2$ as a function of $\\Omega_0$ with\n$M = 2, 3, 4$ and $N_t = 64$. Fig.~\\ref{fig5}(c) plots the length of the middle\nsubarray in the $M = 3$ case (middle subarrays in the $M = 4$ case) as a function of\n$\\Omega_0$. From these two plots, we see that for small values of $\\Omega_0$,\nchoosing ${\\sf f} = 0$ is optimal, whereas the length of the middle subarray\ndecreases as $\\Omega_0$ increases corresponding to gradual beam orientation away\nfrom ${\\sf f} = 0$. Fig.~\\ref{fig5}(d) plots the shape of the broadened beams so\noptimized for three choices of $\\Omega_0$: $\\frac{ \\Omega_0}{ 2 \\pi/N_t} =\n\\{ 1.3, {\\hspace{0.05in} } 2, {\\hspace{0.05in} } 3.5 \\}$. Also, plotted are vertical lines at\n$\\frac{ \\Omega_0}{ 2 \\pi/N_t}  = \\pm 1.3, {\\hspace{0.05in} } \\pm 2, {\\hspace{0.05in} } \\pm 3.5$. From this\nplot, we see that within their corresponding regimes, each broadened beam maximizes\n$\\min |{\\bf F}(\\Omega)|^2$. In addition, Fig.~\\ref{fig6}(a) captures the tradeoff\nbetween the number of beamforming vectors and the worst-case beamforming gain with\nthe $M = 2, 3, 4$ subarray scheme in the $N_t = 64$ case. Clearly, across all\nregimes of interest of ${\\sf No. {\\hspace{0.05in} } beams}$, the $M = 4$ subarray scheme is\nwithin a couple of dB of the upper bound in terms of beamforming gain illustrating\nthe utility of the proposed approach.\n\n\\subsection{Learning Dominant Directions via Beam Sweep with Broadened Beam Codebooks}\n\\label{sec_4c}\n\nWe use the template broadened beamforming vectors designed in Sec.~\\ref{sec_4b}\ncorresponding to different beam broadening factors (and their shifted versions) to\ndesign a beam sweep codebook for the MWB side. In particular, we consider those beam\nbroadening factors that lead to $N_{\\sf mwb} = \\{8, {\\hspace{0.05in} } 16, {\\hspace{0.05in} } 24, {\\hspace{0.05in} } 32, {\\hspace{0.05in} }\n40, {\\hspace{0.05in} } 48, {\\hspace{0.05in} } 56,  {\\hspace{0.05in} } 64 \\}$ elements in the beam sweep codebook at the MWB.\nOn the other hand, since $N_r = 4$ at the UE side, a simpler codebook of $N_{\\sf ue}\n= 4$ beamforming vectors corresponding to an equal partition of the field-of-view is\nsufficient for the purpose of beam sweep. With these different codebook choices at\nthe MWB and UE, we find the best choice of beamforming vectors that maximize\n${\\sf SNR}_{\\sf rx}$ and use them for subsequent beamforming/beam refinement. An\nimportant advantage of the beam sweep approach is that it allows a broadcast solution\n(the same codebook can be reused across multiple UEs within the field-of-view).\n\n\n\\begin{figure*}[htb!]\n\\begin{center}\n\\begin{tabular}{cc}\n\\includegraphics[height=2.7in,width=3.15in] {fig7a_v1.eps}\n&\n\\includegraphics[height=2.7in,width=3.15in] {fig7b_v1.eps}\n\\\\ {\\hspace{0.35in}} (a) & {\\hspace{0.12in}} (b)\n\\end{tabular}\n\\caption{\\label{fig7}\n(a) Comparison of complementary CDF of ${\\sf SNR}_{\\sf rx}$ loss with different\nbeamforming approaches at $\\rho_{\\sf f} = \\rho_{\\sf r} = -10$ dB. (b) Tradeoff\nbetween number of samples for channel learning with the beam sweep approach and loss\nin ${\\sf SNR}_{\\sf rx}$ in initial UE discovery. }\n\\end{center}\n\\vspace{-5mm}\n\\end{figure*}\n\nFig.~\\ref{fig6}(b) plots the complementary CDF of the loss in ${\\sf SNR}_{\\sf rx}$\nwith the beam sweep approach at $\\rho_{\\sf f} = -10$ dB. Fig.~\\ref{fig7}(a) compares\nthe complementary CDF of loss in ${\\sf SNR}_{\\sf rx}$ with the best noisy power\niteration scheme, MUSIC algorithm and the beam sweep approach at the same $\\rho_{\\sf f}$\nvalue. Clearly, the beam sweep approach has a poorer performance relative to the\nother schemes, but its simplicity results in a better system design than possible with\nthe other approaches. Further, Fig.~\\ref{fig7}(b) plots the loss in ${\\sf SNR}_{\\sf rx}$\nat different percentile levels ($10\\%, {\\hspace{0.02in} } 25\\%, {\\hspace{0.02in} } 50\\%, {\\hspace{0.02in} } 75\\%, {\\hspace{0.02in} }\n90\\%$ and $95\\%$) as a function of the number of samples used in channel learning with\nthe beam sweep scheme. From this study, we note that at small coverage levels, certain\ncodebook size choices are better in the tradeoff curve than other choices (for example,\na $N_{\\sf mwb} = 20$ codebook over a $N_{\\sf mwb} = 40$ codebook) and these advantages\ncorrespond to the steepness of the achievability curve (see Fig.~\\ref{fig6}(a)).\n\nFurther, while ${\\sf SNR}_{\\sf rx}$ improves as the codebook size increases, good\nusers with a better link margin (e.g., users with a smaller path loss) can be discovered\nwith a lower discovery latency (corresponding to a smaller codebook size) than those\ncell-edge/blocked users with a worser link margin. Fig.~\\ref{fig7}(b) suggests a\nsmooth roll-off in the discovery latency of the users with a worser link margin. That\nsaid, the beam sweep approach could indeed suffer a significant loss in performance\nespecially with a cell-edge/blocked user. In such scenarios, the design for such a\nuser could include coding over long sequences for enhanced time-repetition/processing\ngain, high MWB densification, a low-frequency overlay of multiple narrow CPO beams with\na worst-case beamforming gain (as close to the $10 \\log_{10}(N_t)$ dB peak gain) in the\ncoverage area, among many approaches. However, such a design could lead to a significant\ndrag on the performance tradeoffs of the good/median user. Thus, they could be initiated\nby the UE when it perceives a poor link on a unicast basis.\n\n\\begin{figure*}[htb!]\n\\begin{center}\n\\begin{tabular}{cc}\n\\includegraphics[height=2.7in,width=3.15in] {fig_snrloss_RSVtypeschemes_perf_quantBeq3n4.eps}\n&\n\\includegraphics[height=2.7in,width=3.15in] {fig_losswithdirectional_Nteq64_Leq2n5_diffNr.eps}\n\\\\ {\\hspace{0.35in}} (a) & {\\hspace{0.12in}} (b)\n\\end{tabular}\n\\caption{\\label{fig8}\n(a) Loss in ${\\sf SNR}_{\\sf rx}$ with different RSV-type beamforming schemes with\nperfect phase of beamformers, and finite $B = 3$ and $B = 4$ bit phase quantization.\n(b) Complementary CDF of loss in ${\\sf SNR}_{\\sf rx}$ as a function of $N_r$ with\n$L = 2$ and $L = 5$ clusters.\n}\n\\end{center}\n\\vspace{-5mm}\n\\end{figure*}\n\n\\section{Comments on Practical Applications}\n\n\\subsection{Finite-Bit Phase Shifters}\nThe entire focus of this work has been on beamformers that can be realized with\ninfinite-precision phase shifters allowing an arbitrary phase resolution for the\nbeamformer weights. However, in practice, beamformers at both the MWB and UE ends\nare constrained to use finite-bit phase shifters. Nevertheless, our studies suggest\nthat even a $B = 3$ or $B = 4$ bit phase shifter (which is practically realizable\nat low cost) is sufficient. Specifically, Fig.~\\ref{fig8}(a) considers the $L = 2$,\n$N_r = 4$ and $N_t = 64$ case considered in Fig.~\\ref{fig1}(a) with $B = 3$ and\n$B = 4$ bit phase shifters and plots the loss in ${\\sf SNR}_{\\sf rx}$ relative to\nthe infinite-precision optimal beamforming scheme. From Fig.~\\ref{fig8}(a), we observe\na minimal loss (less than $0.25$ dB) with a $B = 4$ bit phase shifter, thereby\nsuggesting that quantization is not a serious detriment to the performance of mmW\nMIMO systems. This justifies focus on infinite-precision beamformers in this work.\n\n\n\\subsection{More Antennas at the UE End}\nA larger number of antenna elements (at the MWB and UE ends) could render mmW\nsystems more attractive in terms of data rates. With this backdrop, the UE-side\nand MWB-side antenna numbers of $N_r = 4$ and $N_t = 64$ in our simulation studies\ncan be justified as follows. The MWB serves as a network resource with softer\nconstraints on the array aperture and hence, sectorized coverage ($90^{\\sf o}$ or\n$120^{\\sf o}$ coverage per array at the MWB end) is likely leading to a larger number\nof antennas at this end. On the other hand, multiple subarrays need to deployed at\nthe UE end to cover all the sectors leading to a smaller-dimensional subarray. For\nexample, a $16$ element antenna array consisting of $4$ subarrays of $4$ antennas\neach with a $\\lambda/2$ inter-antenna element spacing would still require an aperture of\n$7.5$ cm at $30$ GHz --- a considerable expense in array aperture at the UE end. Thus,\nthe $N_r = 4$ assumption made in this work is not conservative, but quite realistic for\npractical mmW systems.\n\nAs $N_r$ increases, the performance of all the directional schemes get better\nrelative to the optimal scheme (this is also true in terms of absolute values of\n${\\sf SNR}_{\\sf rx}$ due to increased array gain with increasing $N_r$, but this\nis not shown here) as can be seen from Fig.~\\ref{fig8}(b) where the complementary\nCDF of loss in ${\\sf SNR}_{\\sf rx}$ is plotted for the $N_t = 64$ case with\n$L = 2$ and $L = 5$ clusters for four different choices of $N_r$: $N_r \\in \\{ 4,\n{\\hspace{0.02in} } 8, {\\hspace{0.02in} } 12, {\\hspace{0.02in} } 16 \\}$. While these plots correspond to perfect\ndirectional beamforming, with reasonable $\\rho_{\\sf f}$, we expect the performance\nof the directional learning schemes such as beam sweep or MUSIC to get similarly\nbetter with increasing $N_r$.\n\n\\subsection{Coherence Time Constraints}\nIn addition to the different architectural tradeoffs in terms of system design,\nthe realizability of different beamforming strategies also critically depend on the\ncoherence time of the mmW channel. Initial measurement studies suggest that the\ncoherence time is on the order of a few milliseconds~\\cite{adhikary,swindlehurst_mmw}.\nWhile this coherence time is considerably (an order of magnitude) shorter than in\nsub-$6$ GHz systems, this constraint only leads to a more favorable view of\ndirectional beamforming approaches relative to RSV-type schemes due to the need for\na bi-directional feedback for the implementation of an RSV-type scheme.\nFig.~\\ref{fig3}(b) also addresses the lack of robustness with an RSV-type scheme\ndue to small path length changes that could happen at a sub-coherence time level. On\nthe other hand, the essentially stable performance of the directional beamforming\nscheme to such changes makes it an attractive candidate for initial UE discovery.\n\n\n\\subsection{Planar Antenna Arrays}\nWhile the entire development in this paper so far assumed an ULA geometry for the\nantennas, this was done primarily for the sake of illustrating the tradeoffs in the\nbeam broadening problem which would have been difficult with a smaller dimensional\nplanar array, e.g., $8 \\times 8$. More general expressions can be written for the\narray steering vectors when the antennas are laid out according to other geometric\nconfigurations~\\cite{oelayach,balanis}. In particular, the proposed development of\nthis paper can be easily extended to a planar array geometry.\n\n\\subsection{Comparison with Other Initial UE Discovery Approaches}\n\\label{sec_5e}\nJeong {\\em et al.}~\\cite{jeong_et_al} study a random access procedure for initial\nUE discovery based on beam scanning and propose different approaches to enhance the\nperformance of beam sweep such as the use of multiple RF chains, enhanced preamble\ndetection, optimal cell design, etc. However, the viability of beam scanning as a\nbeamforming procedure for initial UE discovery (relative to other signal\nprocessing-based techniques) is not considered in~\\cite{jeong_et_al}.\n\nGhadikolaei {\\em et al.}~\\cite{ghadikolaei} also address the initial UE discovery\nproblem and characterize the essential tradeoffs in the design of control channels.\nInitial UE search approaches such as an omni-directional beam sweep, one-sided\ndirectional beam sweep, or a bi-directional beam sweep are considered. Since the\nperformance tradeoffs are addressed from a MAC layer perspective, PHY aspects\nsuch as beamformer design under RF constraints, tradeoffs between and implications\nof different beamforming approaches on mmW system design, etc. are not considered\nin~\\cite{ghadikolaei}. Nevertheless, our work is similar in flavor to~\\cite{ghadikolaei}\nin terms of the received ${\\sf SNR}$ vs.\\ initial UE discovery latency tradeoff that\nboth works quantify from PHY and MAC viewpoints, respectively.\n\nThe theme considered in Barati {\\em et al.}~\\cite{barati} for the initial UE discovery\nproblem is closely aligned with the theme of our work. The authors consider a beam sweep\nprocedure and derive the structure of generalized likelihood ratio detectors for detecting the\nprimary sync signal. Based on this study, the authors conclude that omni-directional\nbeam scanning provides a better tradeoff point in the received ${\\sf SNR}$ vs.\\ initial\nUE discovery latency curve than a beam sweep. At this stage, note that an extreme case\nof beam broadening considered in our work (where only one beam covers the entire coverage\narea) is equivalent to an omni-directional scan considered in~\\cite{barati} and thus the\nissue lies in figuring out the best tradeoff point on the received ${\\sf SNR}$ vs.\\ initial\nUE discovery latency tradeoff curve. Independent of performance comparisons, from a\nsystem design perspective, as the authors rightly point out in~\\cite{barati}, detection\nof the primary sync signal via an omni-directional scan provides no knowledge of the AoD\nafter the detection/discovery of the UE unlike in the beam sweep case (broadened codebooks\nlead to increasing uncertainty on the AoD that needs to be refined subsequently). For\nan asymmetric downlink setup (as considered in this work), knowledge of AoD is more\nimportant than that of AoA for the subsequent data delivery stage. Thus, it would be\nof interest in understanding the latency tradeoffs between a broad beam scan (with\nomni-directional scan as an extreme case) for the initial UE discovery stage followed by\nbeam/AoD refinement for the data delivery stage. While Fig.~8(b) of this work provides\na certain preliminary analysis, a more detailed study would be of interest.\nFurthermore, architecturally speaking, an omni-directional scan would also render the\ndiscovery of multiple MWBs impossible. Given that a mmW setup is expected to be primarily\nof use in a small cell setting with a number of potential MWBs available for handoff,\nlack of knowledge of AoD in an omni-directional scan could be potentially a disadvantage.\n\n\n\\section{Concluding Remarks}\nWe studied the efficacy of different beamforming approaches for initial UE discovery\nin mmW MIMO systems in this work. The structure of the (near-)optimal beamformers\nsuggested RSV learning as a useful strategy for beamformer learning. However, RSV\nlearning is sensitive to small path length changes, a problem of serious importance\nat mmW carrier frequencies. A further examination of the beamformer structure suggests\ndirection (AoA/AoD) learning as a viable strategy. We started by studying the utility\nof classical approaches such as MUSIC in the context of direction learning. As with\nRSV learning, MUSIC also requires a non-broadcast system design that could render it\nunattractive from a system level standpoint. An alternate strategy motivated by the\nlimited feedback approach at cellular frequencies (albeit a directional codebook in \nthe mmW context) of ${\\sf SNR}$ estimation via the\nuse of a codebook of beamforming vectors at the MWB and UE is seen to result in a\nbroadcast solution that is conducive for initial UE discovery. While this approach has\na slightly poor performance relative to RSV learning and MUSIC, its simplicity\noverweighs its sub-optimality. Table~\\ref{table1} provides a brief summary of the\nfeatures of the different beamforming algorithms such as computational complexity,\n${\\sf PAR}$ of beamforming vector, system design issues and scaling with different\nbeamformer architectures.\n\n\n\\begin{table*}[htb!]\n\\caption{Qualitative Comparison Between Different Beamforming Approaches}\n\\label{table1}\n\\begin{center}\n\\begin{tabular}{|c||c|c|c|c|}\n\\hline\nIssue of interest & RSV Learning & MUSIC/ESPRIT & Compressive Sensing & Beam Sweep \\\\\n\\hline\n\\hline\nComputational& Iterative method & Computing eigenvectors &\nConvex optimization & Received ${\\sf SNR}$ \\\\\ncomplexity & & & or similar & computation \\\\\n\\hline\n${\\sf PAR}$ of & Non-constant & CPO beam for & Non-constant & CPO \\\\\nbeamforming vector & amplitude & training & amplitude for & beam \\\\\n& & & good dictionary & \\\\\n\\hline\nPerformance & Poor & Poor & Reasonable & Reasonable \\\\\nrobustness & & & & \\\\\n\\hline\nSystem design & Unicast & Unicast & Broadcast & Broadcast \\\\\nissues & Bi-directional & Bi-directional & Uni-directional & Uni-directional \\\\\n\\hline\nScaling with & Poor & Poor & Poor with a & Comparable \\\\\nanalog beamforming & & & general dictionary & \\\\\n\\hline\n\\end{tabular}\n\\end{center}\n\\end{table*}\n\n\n\\section*{Acknowledgments}\nThe authors would like to thank Prof.\\ Sundeep Rangan (the Associate Editor), the\nreviewers, Dr.\\ Saurabh Tavildar, Dr.\\ Omar El Ayach and Dr.\\ Tianyang Bai for \nproviding constructive comments that helped in improving the exposition of this paper.\n\n\\appendix\n\\subsection{Proof of Theorem~\\ref{thm1}}\n\\label{appA}\n\nThe $N_t \\times N_t$ matrix ${\\sf H}^H {\\sf H}$ can be expanded as\n\\begin{eqnarray}\n\\frac{L}{N_t N_r} \\cdot {\\sf H}^H {\\sf H} & = &\n\\sum_{i,j} \n\n\\alpha_i^{\\star} \\alpha_j \\cdot \\left( {\\bf u}_i^H {\\bf u}_j \\right) \\cdot\n{\\bf v}_i {\\bf v}_j^H\n\n\\label{eq_HhermH}\n\n\n\n\n= {\\sf V} {\\hspace{0.02in} } {\\sf A} {\\hspace{0.02in} } {\\sf V}^H\n\n\n\n\n\n\n\n\\end{eqnarray}\nwhere ${\\sf V} = \\left[ \\alpha_1^{\\star} {\\hspace{0.02in} } {\\bf v}_1, {\\hspace{0.02in} } \\cdots , {\\hspace{0.02in} }\n\\alpha_L^{\\star} {\\hspace{0.02in} } {\\bf v}_L \\right]$ and ${\\sf A}(i,j) = {\\bf u}_i^H {\\bf u}_j,\n{\\hspace{0.02in} } i, j = 1, \\cdots, L$.\n\n\nLet ${\\sf X}$ be an $L \\times L$ eigenvector matrix of ${\\sf A} {\\hspace{0.02in} }\n{\\sf V}^H {\\hspace{0.02in} } {\\sf V}$ with the corresponding diagonal matrix of eigenvalues\ndenoted by ${\\sf D}$. That is (the eigenvalue equation is given as),\n\\begin{eqnarray}\n\\left( {\\sf A} {\\hspace{0.02in} } {\\sf V}^H {\\hspace{0.02in} } {\\sf V} \\right) \\cdot {\\sf X} =\n{\\sf X} \\cdot {\\sf D}.\n\\label{eq_premultiply_eigs}\n\n\\end{eqnarray}\nPre-multiplying both sides of~(\\ref{eq_premultiply_eigs}) by ${\\sf V}$, we have\n\\begin{eqnarray}\n{\\sf V} {\\hspace{0.02in} } {\\sf X} \\cdot {\\sf D} =\n\\left( {\\sf V} {\\hspace{0.02in} } {\\sf A} {\\hspace{0.02in} } {\\sf V}^H {\\hspace{0.02in} } {\\sf V} \\right) \\cdot {\\sf X} =\n\\left( \\frac{L}{N_t N_r} \\cdot {\\sf H}^H {\\sf H}  \\right) \\cdot\n{\\sf V} {\\hspace{0.02in} } {\\sf X}.\n\n\\label{eq_premultiply_eigs1}\n\\end{eqnarray}\nReading~(\\ref{eq_premultiply_eigs1}) from right to left, we see that\n${\\sf V} {\\hspace{0.02in} } {\\sf X}$ forms the eigenvector matrix for ${\\sf H}^H {\\sf H}$ with the\ndiagonal eigenvalue matrix being the same as ${\\sf D}$. In other words, all the\neigenvectors of ${\\sf H}^H {\\sf H}$ (and hence ${\\bf f}_{\\sf opt}$) can be represented\nas {\\em linear combinations} of ${\\bf v}_1, \\cdots , {\\bf v}_L$.\n\nThe only difference between the $L \\leq N_t$ and $L > N_t$ cases is that the number\nof distinct eigenvectors of ${\\sf X}$ is less than or equal to $L$ and $N_t$ in the\ntwo cases, respectively.\n\nGiven the structure of ${\\bf f}_{\\sf opt} = \\sum_{j = 1}^L \\beta_j {\\bf v}_j$, we have\n\\begin{eqnarray}\n{\\sf H} {\\hspace{0.02in} } {\\bf f}_{\\sf opt} = \\left ( \\sum_{i = 1}^L \\alpha_i {\\bf u}_i {\\bf v}_i^H \\right)\n\\cdot \\left( \\sum_{j = 1}^L \\beta_j {\\bf v}_j \\right)\n= \\sum_{i = 1}^L \\alpha_i \\cdot \\left( \\sum_j \\beta_j {\\bf v}_i^H {\\bf v}_j \\right)\n{\\bf u}_i\n\\label{eq43}\n\\end{eqnarray}\nand thus ${\\bf g}_{\\sf opt}$ is a linear combination of $\\{ {\\bf u}_1, \\cdots,\n{\\bf u}_L \\}$.\n\\qed\n\n\n\\subsection{Proof of Theorem~\\ref{thm2}}\n\\label{appB}\nSince ${\\sf SNR}_{\\sf rx} = \\rho_{\\sf f} \\cdot\n\\frac{ |{\\bf g}^H {\\sf H} {\\bf f} |^2} { {\\bf g}^H {\\bf g} }$ is invariant to\n$\\| {\\bf g} \\|_2$, we let ${\\bf g} = \\| {\\bf g} \\|_2\n\\cdot {\\widetilde{\\bf g}}$ where $\\| {\\widetilde{\\bf g} } \\|_2 = 1$ (Constraint 1).\nThe $2$- and $\\infty$-norm constraints on ${\\bf g}$ are equivalent to $\\| {\\bf g} \\|_2\n\\leq 1$ and $\\| {\\bf g} \\|_{\\infty} = \\| {\\bf g} \\|_2 \\cdot \\| {\\widetilde{\\bf g}}\n\\|_{\\infty} \\leq \\frac{1}{ \\sqrt{N_r}}$ (Constraints 2 and 3). The received ${\\sf SNR}$\nmaximization can then be recast as\n\\begin{eqnarray}\n\\widetilde{\\bf g}_{\\sf opt} = \\arg \\max_{ \\widetilde{\\bf g}}  \\frac{ {\\sf SNR}_{\\sf rx} }\n{\\rho_{\\sf f} } = \\arg \\max_{ \\widetilde{\\bf g}} \\frac{ |\\widetilde{\\bf g}^H {\\sf H} {\\bf f}|^2 }\n{ \\widetilde{\\bf g}^H \\widetilde{\\bf g} }\n\\label{eq44}\n\\end{eqnarray}\nsubject to Constraints 1 to 3. Ignoring Constraints 2 and 3 in the above optimization,\n${\\sf SNR}_{\\sf rx}$ can be upper bounded as $\\rho_{\\sf f} \\cdot  \\| {\\sf H}{\\bf f}\\|_2^2$\nwith equality if $\\widetilde{\\bf g} = \\alpha \\cdot {\\sf H} {\\bf f}$ for some $\\alpha$.\nWe now consider a specific choice ${\\bf g} = \\frac{1}{ \\sqrt{N_r} } \\cdot \\frac{\n{\\sf H} {\\bf f} }{ \\| {\\sf H} {\\bf f} \\|_{\\infty} }.$ We note that this choice is in\n${\\cal F}_{\\infty}^{N_r}$ by satisfying all the three constraints since $\\widetilde{\\bf g}\n= \\frac{ {\\sf H}{\\bf f} }{ \\| {\\sf H} {\\bf f} \\|_2 }$, $\\| {\\bf g} \\|_2 =\n\\frac{ \\| {\\sf H} {\\bf f} \\|_2 }{ \\sqrt{N_r} \\cdot \\| {\\sf H} {\\bf f} \\|_{\\infty} }\n\\leq 1$ and $\\| {\\bf g} \\|_2 \\cdot \\| {\\widetilde{\\bf g}} \\|_{\\infty} = \\frac{1}{\n\\sqrt{N_r} }$. Further, the upper bound for ${\\sf SNR}_{\\sf rx}$ is also met and this\nchoice is optimal from ${\\cal F}_{\\infty}^{N_r}$.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nLet ${\\bf f}$ be the optimal beamformer from ${\\cal F}_{\\infty}^{N_t}$ that maximizes\n${\\bf f}^H {\\sf H}^H{\\sf H} {\\bf f}$ and let the magnitude of at least one of its entries\nnot equal $\\frac{1}{\\sqrt{N_t}}$. Without loss in generality (by appropriate rotations with\npermutation matrices), let one of these entries be the first entry. Let ${\\bf f}$ and\n${\\sf H}^H {\\sf H}$ be partitioned as\n\\begin{eqnarray}\n{\\bf f} = \\left[\n\\begin{array}{c}\n\\underbrace{ {\\bf f}(1) }_{1 \\times 1} \\\\\n\\underbrace{ {\\bf f}_{\\sf r} }_{ N_t - 1 \\times 1 }\n\\end{array}\n\\right], {\\hspace{0.05in} }\n{\\sf H}^H {\\sf H} = \\left[\n\\begin{array}{cc}\n\\underbrace{ {\\sf h} }_{1 \\times 1} & \\underbrace{ {\\sf h}_{\\sf r}^H }_{1 \\times N_t - 1} \\\\\n\\underbrace{ {\\sf h}_{\\sf r} }_{ N_t - 1 \\times 1} & \\underbrace{ {\\sf H}_{\\sf r} }\n_{ N_t - 1 \\times N_t - 1}\n\\end{array}\n\\right].\n\n\\end{eqnarray}\nWith this partition, we have the following expansion:\n\\begin{eqnarray}\n{\\bf f}^H {\\sf H}^H{\\sf H} {\\bf f} =\n|{\\bf f}(1)|^2 {\\hspace{0.02in} } {\\sf h} +\n2 {\\hspace{0.02in} } {\\sf Re} \\left( {\\bf f}(1) \\cdot {\\bf f}_{\\sf r}^H {\\sf h}_{\\sf r} \\right) +\n{\\bf f}_{\\sf r}^H {\\sf H}_{\\sf r} {\\bf f}_{\\sf r}. \n\\label{eq_exp1}\n\\end{eqnarray}\nSince ${\\bf f}$ is optimal, whatever be the choice of ${\\bf f}_{\\sf r}$, we should have\n$\\angle{ {\\bf f}(1) } = \\angle{ {\\bf h}_{\\sf r}^H {\\bf f}_{\\sf r} }$. Otherwise, we can find\na better choice of ${\\bf f}(1)$ for the same ${\\bf f}_{\\sf r}$. With this optimal choice\nfor $\\angle{ {\\bf f}(1) }$,~(\\ref{eq_exp1}) reduces to\n\\begin{eqnarray}\n{\\bf f}^H {\\sf H}^H{\\sf H} {\\bf f} =\n|{\\bf f}(1)|^2 {\\hspace{0.02in} } {\\sf h} + 2 |{\\bf f}(1)| \\cdot | {\\bf f}_{\\sf r}^H {\\bf h}_{\\sf r} | +\n{\\bf f}_{\\sf r}^H {\\sf H}_{\\sf r} {\\bf f}_{\\sf r}.\n\\label{eq_exp2}\n\\end{eqnarray}\nClearly,~(\\ref{eq_exp2}) is increasing in $|{\\bf f}(1)|$ and thus $|{\\bf f}(1)| = \\frac{1}{ \\sqrt{N_t} }$.\nThus, the assumption that the magnitude of at least one of the entries of ${\\bf f}$ is not\n$\\frac{1}{ \\sqrt{N_t} }$ is untenable and we end up with a contradiction to the statement. This\nimplies that equal gain transmit beamforming is optimal.\n\\qed\n\n\\subsection{Proof of Prop.~\\ref{prop1}}\n\\label{appC}\nLet ${\\bf f}(i)  = \\frac{1}{ \\sqrt{N_t} } \\cdot e^{j \\theta_i}$ for some $\\theta_i$.\nWith the matched filter structure for ${\\bf g}$ and with ${\\sf H}$ as in the statement\nof the proposition, ${\\bf f}^H{\\sf H}^H {\\sf H}{\\bf f}$ is given as\n\\begin{eqnarray}\n\\frac{ {\\sf SNR}_{\\sf rx}} { \\rho_{\\sf f}} = {\\bf f}^H {\\sf H}^H {\\sf H} {\\bf f} & = &\n\\sum_{i, k  = 1}^{N_t} {\\sf h}_i^H {\\sf h}_k \\cdot e^{j (\\theta_k - \\theta_i)}\n\n\\label{eq45}\n\\\\\n& = & \\sum_{i = 1}^{N_t} {\\sf h}_i^H {\\sf h}_i + 2 \\sum_{ k < i }\n{\\sf Re} \\left( {\\sf h}_i^H {\\sf h}_k \\cdot e^{j (\\theta_k - \\theta_i)} \\right).\n\\label{eq46}\n\\end{eqnarray}\nWhile the optimal beamforming vector requires a simultaneous optimization over\n$\\{ \\theta_i \\}$, we can rewrite the objective function as\n\\begin{eqnarray}\n{\\bf f}^H {\\sf H}^H {\\sf H} {\\bf f} =\n\\sum_{i = 1}^{N_t} {\\sf h}_i^H {\\sf h}_i +\n2 \\sum_{i = 1}^{N_t} {\\sf Re} \\left( e^{-j\\theta_i} \\cdot\n\\left( \\sum_{k = 1}^{i-1}e^{j \\theta_k} \\cdot {\\sf h}_i^H {\\sf h}_k\n\\right) \\right).\n\\label{eq_34}\n\\end{eqnarray}\nWith a recursive structure as in~(\\ref{eq18}), each term in~(\\ref{eq_34}) is\nmaximized, even though the impact of this structure on the sum of these terms\nis unclear.\n\\qed\n\n\\subsection{Proof of Theorem~\\ref{thm3}}\n\\label{appD}\nWith $\\{ \\Omega_j \\}$ as sampling frequencies, we have\n\\begin{eqnarray}\n\\min_{ j = 1, \\cdots, J} | {\\bf F}(\\Omega_j)|^2 & \\leq &\n\\frac{1}{J} \\cdot \\sum_{j = 1}^J  | {\\bf F}(\\Omega_j)|^2 =\n\\frac{1}{J} \\cdot {\\bf f}^H \\left( \\sum_{j = 1}^J {\\bf a}(\\Omega_j)\n{\\bf a}(\\Omega_j)^H \\right) {\\bf f}\n\\label{eq48}\n\\\\\n& \\leq & \\frac{ \\lambda_{\\sf max} \\left(\n\\sum_{j = 1}^J {\\bf a}(\\Omega_j) {\\bf a}(\\Omega_j)^Hi \\right)}{J}\n\\label{eq_36}\n\\end{eqnarray}\nwhere the last inequality follows from the Rayleigh coefficient of a Hermitian\nmatrix and its largest eigenvalue. A straightforward argument shows that the $J = 2$\nsetting minimizes the above upper bound when $\\Omega_0 = \\frac{ {\\sf A} \\cdot 2 \\pi}\n{N_t}$ where $0 \\leq {\\sf A} \\leq 1$. Further, in this case, the choice $\\Omega_2 =\n\\frac{ \\pi}{2} + \\frac{ {\\sf A} \\cdot \\pi}{N_t}$ and $\\Omega_1 = \\frac{\\pi}{2} -\n\\frac{ {\\sf A} \\cdot \\pi}{N_t}$ minimizes the upper bound resulting in\n\\begin{eqnarray}\n\\lambda_{\\sf max} \\left(\n\\sum_{j = 1}^J {\\bf a}(\\Omega_j) {\\bf a}(\\Omega_j)^H \\right) =\nN_t + \\Bigg| \\frac{ \\sin( N_t(\\Omega_2 - \\Omega_1)/2) }\n{ \\sin( (\\Omega_2 - \\Omega_1)/2) } \\Bigg|.\n\\label{eq50}\n\\end{eqnarray}\nUsing this fact, the worst-case beamforming gain is seen to be\n\\begin{eqnarray}\n{\\sf BF {\\hspace{0.05in} } Gain} \\leq 10 \\log_{10} \\left( \\min \\left( N_t,\n{\\hspace{0.05in} } \\frac{N_t}{2} + \\frac{1}{2} \\cdot\n\\left| \\frac{ \\sin \\left( \\frac{ \\overline{\\Omega} \\cdot N_t }\n{2 {\\hspace{0.02in} } {\\sf No. {\\hspace{0.02in} } beams} } \\right) }\n{ \\sin \\left( \\frac{ \\overline{\\Omega}  }\n{2 {\\hspace{0.02in} } {\\sf No. {\\hspace{0.02in} } beams} } \\right) }\n\\right| \\right) \\right)\n\\label{eq51}\n\\end{eqnarray}\nprovided ${\\sf No. {\\hspace{0.02in} } beams} \\geq \\frac{ \\overline{\\Omega} \\cdot N_t} {2 \\pi}$.\nIn general, it is difficult to obtain closed-form expressions for the eigenvalues of\n$\\sum_{j = 1}^J {\\bf a}(\\Omega_j) {\\bf a}(\\Omega_j)^H$ with $J = 3,4$ and this task\nis impossible if $J > 4$. Thus, in these settings (${\\sf No. {\\hspace{0.02in} } beams} <\n\\frac{ \\overline{\\Omega} \\cdot N_t}{2 \\pi}$), the best-case (smallest) upper bound is\nobtained by minimizing the quantity in~(\\ref{eq_36}) over different choices of $J$\nand $\\{ \\Omega_j \\}$ leading to~(\\ref{eq_23}), where $\\Omega_j \\in\n\\left[ \\Omega_{\\sf c} - \\frac{\\Omega_0}{2}, {\\hspace{0.05in} } \\Omega_{\\sf c} + \\frac{ \\Omega_0}{2}\n\\right]$ with $\\Omega_0 = \\frac{ \\overline{\\Omega}}{ {\\sf No. {\\hspace{0.02in} } beams}} >\n\\frac{2 \\pi}{N_t}$.\n\\qed\n\n\n\n\n\n{\\vspace{-0.05in}}\n\\bibliographystyle{IEEEbib}\n\\bibliography{newrefsx}\n\n\n\n", "itemtype": "equation", "pos": 25457, "prevtext": "\n\n\n\n\n\\title{Beamforming Tradeoffs for Initial UE Discovery in Millimeter-Wave MIMO Systems}\n\\author{\\large Vasanthan Raghavan, Juergen Cezanne, Sundar Subramanian, Ashwin Sampath,\nand Ozge Koymen \\\\\nQualcomm Corporate R\\&D, Bridgewater, NJ 08807 \\\\\nE-mail: \\{vraghava, jcezanne, sundars, asampath, okoymen@qti.qualcomm.com\\}\n}\n\n\\maketitle\n\n\\vspace{-10mm}\n\n\n\n\\begin{abstract}\n\\noindent\nMillimeter-wave (mmW) multi-input multi-output (MIMO) systems have gained\nincreasing traction towards the goal of meeting the high data-rate requirements\nfor next-generation wireless systems. The focus of this work is on low-complexity\nbeamforming approaches for initial user equipment (UE) discovery in such systems.\nTowards this goal, we first note the structure of the optimal beamformer with\nper-antenna gain and phase control and establish the structure of good beamformers\nwith per-antenna phase-only control. Learning these right singular vector (RSV)-type\nbeamforming structures in mmW systems is fraught with considerable complexities such\nas the need for a non-broadcast system design, the sensitivity of the beamformer\napproximants to small path length changes, inefficiencies due to power amplifier\nbackoff, etc. To overcome these issues, we establish a physical interpretation\nbetween the RSV-type beamformer structures and the angles of departure/arrival (AoD/AoA)\nof the dominant path(s) capturing the scattering environment. This physical\ninterpretation provides a theoretical underpinning to the emerging interest on\ndirectional beamforming approaches that are less sensitive to small path length changes.\nWhile classical approaches for direction learning such as MUltiple SIgnal Classification\n(MUSIC) have been well-understood, they suffer from many practical difficulties in a mmW\ncontext such as a non-broadcast system design and high computational complexity. A simpler\nbroadcast-based solution for mmW systems is the adaptation of limited feedback-type\ndirectional codebooks for beamforming at the two ends. We establish fundamental limits\nfor the best beam broadening codebooks and propose a construction motivated by a virtual\nsubarray architecture that is within a couple of dB of the best tradeoff curve at all\nuseful beam broadening factors. We finally provide the received ${\\sf SNR}$ loss-UE\ndiscovery latency tradeoff with the proposed beam broadening constructions. Our results\nshow that users with a reasonable link margin can be quickly discovered by the proposed\ndesign with a smooth roll-off in performance as the link margin deteriorates. While these\ndesigns are poorer in performance than the RSV learning approaches or MUSIC for cell-edge\nusers, their\nlow-complexity that leads to a broadcast system design makes them a useful candidate for\npractical mmW systems.\n\\end{abstract}\n\n\\begin{keywords}\n\\noindent Millimeter-wave systems, MIMO, initial UE discovery, beamforming, beam\nbroadening, MUSIC, right singular vector, noisy power iteration, sparse channels.\n\\end{keywords}\n\n\n\n\\section{Introduction}\n\\label{sec1}\nThe ubiquitous nature of communications made possible by the smart-phone and social\nmedia revolutions has meant that the data-rate requirements will continue to grow at an\nexponential pace. On the other hand, even under the most optimistic assumptions, system\nresources can continue to scale at best at a linear rate, leading to enormous mismatches\nbetween supply and demand. Given this backdrop, many candidate solutions have been\nproposed~\\cite{rusek,qualcomm,boccardi1} to mesh into the patchwork that addresses the\n$1000$-{\\sf X} data challenge~\\cite{qualcomm1} --- an intermediate stepping stone towards\nbridging this burgeoning gap.\n\nOne such solution that has gained increasing traction over the last few years is\ncommunications over the millimeter-wave (mmW)\nregime~\\cite{khan,torkildson,rappaport,rangan,roh,akdeniz} where the carrier frequency\nis in the $30$ to $300$ GHz range. Spectrum crunch, which is the major bottleneck at\nlower/cellular carrier frequencies, is less problematic at higher carrier frequencies\ndue to the availability of large (either unlicensed or lightly licensed) bandwidths.\nHowever, the high frequency-dependent propagation and shadowing losses (that can offset\nthe link margin substantially) complicate the exploitation of these large bandwidths. It\nis visualized that these losses can be mitigated by limiting coverage to small areas and\nleveraging the small wavelengths that allows the deployment of a large number of antennas\nin a fixed array aperture.\n\nDespite the possibility of multi-input multi-output (MIMO) communications, mmW signaling\ndiffers significantly from traditional MIMO architectures at cellular frequencies. Current\nimplementations\\footnote{In a downlink setting, the first dimension corresponds to the\nnumber of antennas at the user equipment end and the second at the base-station end.} at\ncellular frequencies are on the order of $4 \\times 8$ with a precoder rank (number of\nlayers) of $1$ to $4$; see, e.g.,~\\cite{lim}. Higher rank signaling requires multiple\nradio-frequency (RF) chains\\footnote{An RF chain includes (but is not limited to)\nanalog-to-digital and digital-to-analog converters, power and low-noise amplifiers,\nupconverters/mixers, etc.} which are easier to realize at lower carrier frequencies\nthan at the mmW regime. Thus, there has been a growing interest in understanding the\ncapabilities of low-complexity approaches such as beamforming (that require only a\nsingle RF chain) in mmW\nsystems~\\cite{torkildson,venkateswaran,brady,oelayach,hur,alkhateeb,sun}. On the other\nhand, smaller form factors at mmW frequencies ensure\\footnote{For example, an $N_t = 64$\nelement uniform linear array (ULA) at $30$ GHz requires an aperture of $\\sim1$ foot at\nthe critical $\\lambda/2$ spacing --- a constraint that can be realized at the base-station\nend.} that configurations such as $4 \\times 64$ (or even higher dimensionalities) are\nrealistic. Such high antenna dimensionalities as well as the considerably large bandwidths\nat mmW frequencies result in a higher resolvability of the multipath and thus, the MIMO\nchannel is naturally {\\em sparser} in the mmW regime than at cellular\nfrequencies~\\cite{akdeniz,zhao,oelayach,akbar,vasanth_jstsp,vasanth_it2}.\n\nWhile the optimal right singular vector (RSV) beamforming structure has been known in\nthe MIMO literature~\\cite{tky_lo}, an explicit characterization of the connection of\nthis structure to the underlying physical scattering environment has not been\nwell-understood. We start with such an explicit physical interpretation by showing\nthat the optimal beamformer structure corresponds to beam steering across the different\npaths with appropriate power allocation and phase compensation confirming many recent\nobservations~\\cite{oelayach,oelayach1}. Despite using only a single RF chain, the\noptimal beamformer requires per-antenna phase and gain control (in general), which\ncould render this scheme disadvantageous from a cost perspective. Thus, we also\ncharacterize the structure and performance of good beamformer structures with\nper-antenna phase-only control~\\cite{hur,david_egc,pi,oelayach1}.\n\nEither of these structures can be realized in practice via an (iterative) RSV learning\nscheme. To the best of our understanding, specific instantiations of RSV learning such\nas power iteration \nhave not been\nstudied in the literature (even numerically), except in the noise-less case~\\cite{dahl}.\nA low-complexity proxy to the RSV-type beamformer structures is directional beamforming\nalong the dominant path at the millimeter-wave base-station (MWB) and the user equipment\n(UE). The directional beamforming structure is particularly relevant in mmW systems due\nto the sparse nature of the channel, and this structure is not expected to be optimal at\nnon-sparse cellular narrowband frequencies. Our studies show that directional beamforming\nsuffers only a minimal loss in performance relative to the optimal structures, rendering\nthe importance of direction learning for practical mmW MIMO systems, again confirming many\nrecent observations~\\cite{oelayach,oelayach1,rangan,swindlehurst_mmw,brady,hur,alkhateeb,sun}.\n\nSuch schemes can be realized in practice via direction learning techniques. Direction\nlearning methods such as MUltiple SIgnal Classification (MUSIC), Estimation of Signal\nParameters via Rotational Invariance Techniques (ESPRIT) and related\napproaches~\\cite{schmidt,roy_kailath,krim} have been well-understood in the signal\nprocessing literature, albeit primarily in the context of military/radar applications.\nTheir utility in these applications is as a ``super-resolution'' method to discern\nmultiple obstacles/targets given that the pre-beamforming ${\\sf SNR}$ is moderate-to-high,\nat the expense of array aperture (a large number of antennas) and computations/energy.\nWhile MUSIC has been suggested as a possible candidate beamforming strategy for mmW\napplications, it is of interest to fairly compare different beamforming strategies given\na specific objective (such as initial UE discovery).\n\nThe novelty of this work is on such a fair comparison between different strategies in\nterms of: i) architecture of system design (broadcast/unicast solution), ii)\nresilience/robustness to low pre-beamforming ${\\sf SNR}$'s expected in mmW systems,\niii) performance loss relative to the optimal beamforming scheme, iv) adaptability to\noperating on different points of the tradeoff curve of initial UE discovery latency\nvs.\\ accrued beamforming gain, v) scalability to beam refinement as a part of the data\ntransfer process, etc. Our broad conclusions are as follows. The fundamental difficulty\nwith any RSV learning scheme is its extreme sensitivity to small path length changes\nthat could result in a full-cycle phase change across paths, which becomes increasingly\nlikely at mmW carrier frequencies. Further, these methods suffer from implementation\ndifficulties as seen from a system-level standpoint such as a non-broadcast design,\npoor performance at low link margins, power amplifier (PA) backoff, poor adaptability to\ndifferent beamforming architectures, etc. In commonality with noisy power iteration,\nMUSIC, ESPRIT and related approaches also suffer from a non-broadcast solution, poor\nperformance at low link margins and computational complexity.\n\nTo overcome these difficulties, inspired by the limited feedback\nliterature~\\cite{david_review,david_grass,mukkavilli}, we study the received\n${\\sf SNR}$ performance with the use of a globally known directional beamforming\ncodebook at the MWB and UE ends. The simplest codebook of beamformers made of constant\nphase offset (CPO) array steering vectors (see Fig.~\\ref{fig4c} for illustration)\nrequires an increasing number of codebook elements as the number of antennas increases\nto cover a certain coverage area, thereby corresponding to a proportional increase in\nthe UE discovery latency. We study the beam broadening problem of trading off UE\ndiscovery latency at the cost of the peak gain in a beam's coverage\narea~\\cite{hur,rajagopal}. We establish fundamental performance limits for this problem,\nas well as realizable constructions that are within a couple of dB of this limit at all\nbeam broadening factors (and considerably lower at most beam broadening factors). With\nbeams so constructed, we show that directional beamforming can tradeoff the UE discovery\nlatency substantially for a good fraction of the users with a slow roll-off in performance\nas the link margin deteriorates. While the codebook-based approach is sub-optimal relative\nto noisy power iteration or MUSIC, its simplicity of system design and adaptability to\ndifferent beamforming architectures and scalability to beam refinement makes it a viable\ncandidate for initial UE discovery in practical mmW beamforming implementations. Our work\nprovides further impetus to the initial UE discovery problem (See Sec.~\\ref{sec_5e} for a\ndiscussion) that has attracted attention from many related recent\nworks~\\cite{jeong_et_al,ghadikolaei,barati}.\n\n\n\\noindent {\\bf \\em \\underline{Notations:}} Lower- (${\\bf x}$) and upper-case block\n(${\\bf X}$) letters denote vectors and matrices with ${\\bf x}(i)$ and ${\\bf X}(i, j)$\ndenoting the $i$-th and $(i, j)$-th entries of ${\\bf x}$ and ${\\bf X}$, respectively.\n$\\| {\\bf x} \\|_2$ and $\\| {\\bf x} \\|_{\\infty}$ denote the $2$-norm and $\\infty$-norm\nof a vector ${\\bf x}$, whereas ${\\bf x}^H$, ${\\bf x}^T$ and ${\\bf x}^{\\star}$ denote\nthe complex conjugate Hermitian transpose, regular transpose and complex\nconjugation operations of ${\\bf x}$, respectively. We use ${\\mathbb{C}}$ to denote the\nfield of complex numbers, ${\\mathbb{E}}$ to denote the expectation operation and\n$\\chi({\\cal A})$ to denote the indicator function of a set ${\\cal A}$.\n\n\\section{System Setup}\n\\label{sec2}\n\nWe consider the downlink setting where the MWB is equipped with $N_t$ transmit antennas\nand the UE is equipped with $N_r$ receive antennas. Let ${\\bf H}$ denote the $N_r \\times N_t$\nchannel matrix capturing the scattering between the MWB and the UE. We are interested in\nbeamforming (rank-$1$ signaling) over ${\\bf H}$ with the unit-norm $N_t \\times 1$\nbeamforming vector ${\\bf f}$. The system model in this setting is given as\n\\begin{eqnarray}\n{\\bf y} = \\sqrt{ \\rho_{\\sf f} } \\cdot {\\bf H} {\\bf f} s + {\\bf n}\n\n\\label{eq1}\n\\end{eqnarray}\nwhere $\\rho_{\\sf f}$ is the pre-beamforming\\footnote{The pre-beamforming ${\\sf SNR}$\nis the received ${\\sf SNR}$ seen with antenna selection at both ends of the link and\nunder the wide-sense stationary uncorrelated scattering (WSSUS) assumption. This\n${\\sf SNR}$ is the same independent of which antenna is selected at either end.}\n${\\sf SNR}$, $s$ is the symbol chosen from an appropriate\nconstellation for signaling with ${\\bf E}[s] = 0$ and ${\\bf E}[|s^2|] = 1$, and\n${\\bf n}$ is the $N_r \\times 1$ proper complex white\nGaussian noise vector (that is, ${\\bf n} \\sim {\\cal CN}( {\\bf 0}, {\\hspace{0.02in} } {\\bf I})$)\nadded at the UE. The\nsymbol $s$ is decoded by beamforming at the receiver along the $N_r \\times 1$\nunit-norm vector ${\\bf g}$ to obtain\n\\begin{eqnarray}\n\\widehat{s} = {\\bf g}^H {\\bf y} = \\sqrt{ \\rho_{\\sf f} } \\cdot {\\bf g}^H {\\bf H} {\\bf f} s\n+ {\\bf g}^H {\\bf n}.\n\n\\label{eq2}\n\\end{eqnarray}\n\nFor the channel, we assume an extended Saleh-Valenzuela geometric model~\\cite{saleh}\nin the ideal setting where ${\\bf H}$ is determined by scattering over\n$L$ clusters/paths with no near-field impairments at the UE end and is denoted as follows:\n\\begin{eqnarray}\n{\\bf H} = \\sqrt{ \\frac{N_r N_t}{L} } \\cdot \\sum_{\\ell = 1}^L \\alpha_{\\ell} \\cdot\n{\\bf u}_{\\ell} {\\bf v}_{\\ell}^H.\n\n\\label{eq_1}\n\\end{eqnarray}\nIn~(\\ref{eq_1}), $\\alpha_{\\ell} \\sim {\\cal CN}(0, 1)$ denotes the complex\ngain\\footnote{We assume a complex Gaussian model for $\\alpha_{\\ell}$ only for the\nsake of illustration of the main results. However, all the results straightforwardly\ncarry over to more general models.}, ${\\bf u}_{\\ell}$ denotes the $N_r \\times 1$\nreceive array steering vector, and ${\\bf v}_{\\ell}$ denotes the $N_t \\times 1$\ntransmit array steering vector, all corresponding to the $\\ell$-th path. With this\nassumption, the normalization constant $\\sqrt{ \\frac{N_r N_t}{L} }$ in ${\\bf H}$\nensures that the standard channel power normalization\\footnote{The standard\nnormalization that has been used in MIMO system studies is ${\\bf E} \\left[\n{\\sf Tr}( {\\bf H} {\\bf H}^H ) \\right] = N_rN_t$. However, as $\\{ N_r, N_t \\}$\nincreases as is the case with massive MIMO systems such as those in mmW signaling,\nthis normalization violates physical laws and needs to be modified appropriately;\nsee~\\cite{vasanth_it2,sayeed_itw} and references therein. Such a modification will\nnot alter the results herein since the main focus is on a performance comparison\nbetween different schemes. Thus, we will not concern ourselves with these technical\ndetails here.} in MIMO system studies holds. As a typical example of the case where\na uniform linear array (ULA) of antennas are deployed at both ends of the link (and\nwithout loss of generality pointing along the ${\\sf X}$-axis in a certain global reference\nframe), the array steering vectors ${\\bf u}_{\\ell}$ and ${\\bf v}_{\\ell}$ corresponding\nto angle of arrival (AoA) $\\phi_{{\\sf R}, \\ell}$ and angle of departure (AoD)\n$\\phi_{ {\\sf T}, \\ell}$ in the azimuth in that reference frame (assuming an elevation\nangle $\\theta_{ {\\sf R}, \\ell} = \\theta_{ {\\sf T}, \\ell} = 90^{\\sf o}$) are given as\n\\begin{eqnarray}\n{\\bf u}_{\\ell} & = & \\frac{1}{ \\sqrt{N_r} } \\cdot \\Big[1 , {\\hspace{0.05in} }\ne^{j k d_{\\sf R} \\cos(\\phi_{ {\\sf R}, \\ell })}, {\\hspace{0.05in} } \\cdots {\\hspace{0.05in} } ,\ne^{j (N_r - 1) k d_{\\sf R} \\cos(\\phi_{ {\\sf R}, \\ell })} \\Big]^T\n\n\\label{eq4}\n\\\\\n\n{\\bf v}_{\\ell} & = & \\frac{1}{ \\sqrt{N_t} } \\cdot \\Big[1 , {\\hspace{0.05in} }\ne^{j k d_{\\sf T} \\cos(\\phi_{ {\\sf T}, \\ell })}, {\\hspace{0.05in} } \\cdots {\\hspace{0.05in} } ,\ne^{j (N_t - 1) k d_{\\sf T} \\cos(\\phi_{ {\\sf T}, \\ell })} \\Big]^T\n\n\\label{eq5}\n\\end{eqnarray}\nwhere $k = \\frac{2\\pi}{\\lambda}$ is the wave number with $\\lambda$ the wavelength of\npropagation, and $d_{\\sf R}$ and $d_{\\sf T}$ are the inter-antenna element\nspacing\\footnote{With the typical $d_{\\sf R} = d_{\\sf T} = \\frac{\\lambda}{2}$\nspacing, we have $kd_{\\sf R} = kd_{\\sf T} = \\pi$.} at the receive and transmit sides,\nrespectively. To simplify the notations and to capture the {\\em constant phase offset}\n(CPO)-nature of the array-steering vectors and the correspondence with their respective\nphysical angles, we will henceforth denote ${\\bf u}_{\\ell}$ and ${\\bf v}_{\\ell}$\nabove as ${\\sf CPO}(\\phi_{ {\\sf R},\\ell})$ and ${\\sf CPO}(\\phi_{ {\\sf T},\\ell})$,\nrespectively.\n\n\\section{Optimal Beamforming and RSV Learning}\n\\label{sec3}\n\nIn terms of performance metric, we are interested in the received ${\\sf SNR}$ in\nthe instantaneous channel setting (that is, ${\\bf H} = {\\sf H}$), denoted as\n${\\sf SNR}_{\\sf rx}$ and defined as,\n\\begin{eqnarray}\n{\\sf SNR}_{\\sf rx} \\triangleq \\rho_{\\sf f} \\cdot\n\\frac{ |{\\bf g}^H {\\hspace{0.02in} } {\\sf H} {\\hspace{0.02in} } {\\bf f}|^2 \\cdot\n{\\bf E} [ |s|^2 ] }{ {\\bf E} \\left[ |{\\bf g}^H {\\bf n}|^2 \\right]}\n= \\rho_{\\sf f} \\cdot \\frac{ |{\\bf g}^H {\\hspace{0.02in} } {\\sf H} {\\hspace{0.02in} } {\\bf f}|^2}\n{ {\\bf g}^H {\\bf g} }\n\n\\label{eq6}\n\\end{eqnarray}\nsince the achievable rate as well as the error probability in estimating $s$ are\ncaptured by this quantity~\\cite{david_review,gesbert_review,andrea_review}. We are\ninterested in studying the performance loss between the optimal beamforming scheme\nbased on the RSV of the channel and a low-complexity directional beamforming scheme.\nTowards this goal, we start by studying the structure of the optimal beamforming\nscheme under various RF hardware constraints.\nFor the link margin, we are interested\\footnote{Consider the following\nback-of-the-envelope calculation. Let us assume a nominal\npath loss corresponding to a $100$-$200$ m cell-radius of $130$ dB, and mmW-specific\nshadowing and other losses of $20$ dB. We assume a bandwidth of $500$ MHz with a\nnoise figure of $7$ dB to result in a thermal noise floor of $-80$ dBm. With an\nequivalent isotropically radiated power (EIRP) of $40$ to $55$ dBm in an $N_t = 64$\nantenna setting, the pre-beamforming ${\\sf SNR}$ corresponding to $64$-level\ntime-repetition (processing) gain (of $18$ dB) is $-30$ to $-15$ dB. This\nsuggests that low pre-beamforming ${\\sf SNR}$s are the norm in mmW systems.} in low\npre-beamforming ${\\sf SNR}$'s.\n\n\n\n\\subsection{Optimal Beamforming with Full Amplitude and Phase Control}\n\\label{sec3_a}\nWe start with the setting where there is full amplitude and phase control of the\nbeamforming vector coefficients at both the MWB and the UE. Let ${\\cal F}_{2}^{N_t}$\ndenote the class of energy-constrained beamforming vectors reflecting this assumption.\nThat is, ${\\cal F}_{2}^{N_t} \\triangleq \\left\\{ {\\bf f} \\in {\\mathbb{C}}^{N_t} {\\hspace{0.02in} }\n: {\\hspace{0.02in} } \\| {\\bf f} \\|_2 \\leq 1 \\right\\}$. Under perfect channel state information\n(CSI) of ${\\sf H}$ at both the MWB and the UE, optimal beamforming vectors\n${\\bf f}_{\\sf opt}$ and ${\\bf g}_{\\sf opt}$ are to be designed from ${\\cal F}_2^{N_t}$ and\n${\\cal F}_2^{N_r}$ to maximize ${\\sf SNR}_{\\sf rx}$~\\cite{tky_lo}. Clearly,\n${\\sf SNR}_{\\sf rx}$ is maximized with $\\| {\\bf f}_{\\sf opt} \\|_2 = 1$, otherwise\nenergy is unused in beamforming. Further, a simple application~\\cite{tky_lo} of the \nCauchy-Schwarz inequality shows that ${\\bf g}_{\\sf opt}$ is a matched filter combiner \nat the receiver and assuming that $\\| {\\bf g}_{\\sf opt}\\|_2 = 1$ (for convenience), we \nobtain ${\\sf SNR}_{\\sf rx} = \\rho_{\\sf f} \\cdot {\\bf f}_{\\sf opt}^H {\\sf H}^H {\\sf H} \n{\\bf f}_{\\sf opt}$. We thus have\n\\begin{eqnarray}\n{\\bf f}_{\\sf opt} = {\\sf v}_1, {\\hspace{0.05in} } {\\bf g}_{\\sf opt} = \\frac{ {\\sf H} {\\hspace{0.02in} } {\\sf v}_1 }\n{ \\| {\\sf H} {\\hspace{0.02in} } {\\sf v}_1 \\|_2},\n\n\\label{eq_2}\n\\end{eqnarray}\nwhere ${\\sf v}_1$ denotes a dominant unit-norm right singular vector (RSV) of ${\\sf H}$.\nHere, the singular value decomposition of ${\\sf H}$ is given as ${\\sf H} = {\\sf U}\n{\\hspace{0.02in} } {\\sf \\Lambda} {\\hspace{0.02in} } {\\sf V}^H$ with ${\\sf U}$ and ${\\sf V}$ being $N_r \\times N_r$\nand $N_t \\times N_t$ unitary matrices of left and right singular vectors, respectively,\nand arranged so that the corresponding leading diagonal entries of the $N_r \\times N_t$\nsingular value matrix ${\\sf \\Lambda}$ are in non-increasing order.\n\nThe following result establishes the connection between the physical directions\n$\\{ \\phi_{ {\\sf R},\\ell}, {\\hspace{0.02in} } \\phi_{ {\\sf T}, \\ell} \\}$ in the ULA channel model\nin~(\\ref{eq_1}) and $\\left\\{ {\\bf f}_{\\sf opt},  {\\hspace{0.02in} }\n{\\bf g}_{\\sf opt} \\right\\}$ in~(\\ref{eq_2}) and confirms the observations in many\nrecent works~\\cite{oelayach,oelayach1}.\n\\begin{thm}\n\\label{thm1}\nWith ${\\bf H} = {\\sf H}$ and the channel model in~(\\ref{eq_1}), all the eigenvectors\nof ${\\sf H}^H{\\sf H}$ can be represented as linear combinations of ${\\bf v}_1, \\cdots ,\n{\\bf v}_L$ (the transmit array steering vectors). Thus, ${\\bf f}_{\\sf opt}$ is a\nlinear combination of ${\\bf v}_1, \\cdots , {\\bf v}_L$ and ${\\bf g}_{\\sf opt}$ is a\nlinear combination of ${\\bf u}_1, \\cdots , {\\bf u}_L$.\n\n\\end{thm}\n\\begin{proof}\nSee Appendix~\\ref{appA}.\n\n\\end{proof}\n\nTheorem~\\ref{thm1} suggests the efficacy of directional beamforming when the channels\nare sparse~\\cite{oelayach,zhao,akbar,vasanth_jstsp,vasanth_it2}, as is likely the\ncase in mmW systems. On the other hand, limited feedback schemes commonly used at\ncellular frequencies~\\cite{david_review,david_grass,mukkavilli} for CSI acquisition\nare similar in spirit to directional beamforming schemes for mmW systems. In\nparticular, the typically non-sparse nature of channels at cellular frequencies\n(corresponding to a large number of paths) washes away any of the underlying Fourier\nstructure~\\cite{akbar} of the steering vectors with a uniformly-spaced array.\nWithout any specific structure on the space of optimal beamforming vectors, a\ngood limited feedback codebook such as a Grassmannian line packing solution\nuniformly quantizes the space of all beamforming vectors.\n\nOn a technical note, Theorem~\\ref{thm1} provides a non-unitary basis\\footnote{The\nuse of non-unitary bases in the context of MIMO system studies is not new; see,\ne.g.,~\\cite{vasanth_asilomar,vasanth_arxiv2011}.} for the eigen-space of\n${\\sf H}^H {\\sf H}$ (with eigenvalues greater than $0$)\nwhen $L \\leq N_t$ (in the $L > N_t$ case, $\\{ {\\bf v}_1, \\cdots , {\\bf v}_L \\}$ span\nthe eigen-space but do not form a basis). The intuitive meaning of ${\\bf f}_{\\sf opt}$\nand ${\\bf g}_{\\sf opt}$ is that they perform ``coherent'' beam-combining by appropriate\nphase compensation to maximize the energy delivered to the receiver. As an illustration\nof Theorem~\\ref{thm1}, in the special case of $L = 2$ paths, when ${\\bf v}_1$ and ${\\bf v}_2$\nare orthogonal (${\\bf v}_1^H {\\bf v}_2 = 0$), the non-unit-norm version of\n${\\bf f}_{\\sf opt}$ and ${\\bf g}_{\\sf opt}$ are given as\n\\begin{eqnarray}\n{\\bf f}_{\\sf opt} & = & \\beta_{\\sf opt} \\cdot {\\bf v}_1 +\ne^{j \\left(\\angle{\\alpha_1} - \\angle{\\alpha_2} - \\angle{ {\\bf u}_1^H {\\bf u}_2 } \\right) }\n\\sqrt{1 - \\beta_{\\sf opt}^2}  \\cdot {\\bf v}_2\n\n\\label{eq8}\n\\\\\n\n{\\bf g}_{\\sf opt} & = & \\alpha_1 \\beta_{\\sf opt} \\cdot {\\bf u}_1 +\ne^{j \\left(\\angle{\\alpha_1} - \\angle{\\alpha_2} - \\angle{ {\\bf u}_1^H {\\bf u}_2 } \\right) }\n\\alpha_2 \\sqrt{1 - \\beta_{\\sf opt}^2}  \\cdot {\\bf u}_2\n\n\\label{eq9}\n\\end{eqnarray}\nwhere\n\\begin{eqnarray}\n\\beta_{\\sf opt}^2  = \n\n\n\\frac{1}{ 2} \\cdot \\left[ 1 +\n\\frac{ |\\alpha_1|^2 - |\\alpha_2|^2}\n{ \\sqrt{  \\left( |\\alpha_1|^2 - |\\alpha_2|^2 \\right)^2 + 4\n|\\alpha_1|^2 |\\alpha_2|^2 \\cdot |{\\bf u}_1^H {\\bf u}_2|^2 }}\n\\right] .\n\n\\label{eq10}\n\\end{eqnarray}\nIn addition, if ${\\bf u}_1$ and ${\\bf u}_2$ are orthogonal, it can be seen that\n$\\beta_{\\sf opt}$ is either $1$ or $0$ with full power allocated to the dominant path.\nAt the other extreme of near-parallel ${\\bf u}_1$ and ${\\bf u}_2$, the optimal scheme\nconverges to proportional power allocation. That is,\n\\begin{eqnarray}\n|{\\bf u}_1^H {\\bf u}_2| \\rightarrow 1 \\Longrightarrow \\beta_{\\sf opt}^2\n\\rightarrow \\frac{ |\\alpha_1|^2} { |\\alpha_1|^2 + |\\alpha_2|^2}.\n\n\\label{eq11}\n\\end{eqnarray}\n\nIf ${\\bf u}_1$ and ${\\bf u}_2$ are orthogonal (${\\bf u}_1^H {\\bf u}_2 = 0$),\nthe non-unit-norm version of ${\\bf f}_{\\sf opt}$ and ${\\bf g}_{\\sf opt}$ are given as\n\n", "index": 1, "text": "\\begin{align}\n&{\\bf f}_{\\sf opt} = \\beta_{\\sf opt} \\cdot {\\bf v}_1 +\ne^{ - j \\angle{ {\\bf v}_1^{H} {\\bf v}_2}} \\sqrt{1 - \\beta_{\\sf opt}^2} \\cdot\n{\\bf v}_2 \n\\label{eq12}\n\\\\\n\n\n&{\\bf g}_{\\sf opt} =  \\alpha_1 \\left( \\beta_{\\sf opt} + | {\\bf v}_1^H {\\bf v}_2 |\n \\sqrt{1 - \\beta_{\\sf opt}^2} \\right) \\cdot {\\bf u}_1 +\ne^{ - j \\angle{ {\\bf v}_1^{H} {\\bf v}_2}} \\alpha_2\n\\left( | {\\bf v}_1^H {\\bf v}_2 | \\beta_{\\sf opt} +\n \\sqrt{1 - \\beta_{\\sf opt}^2} \\right) \\cdot {\\bf u}_2\n\n\\label{eq13}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle{\\bf f}_{\\sf opt}=\\beta_{\\sf opt}\\cdot{\\bf v}_{1}+e^{-j\\angle{{%&#10;\\bf v}_{1}^{H}{\\bf v}_{2}}}\\sqrt{1-\\beta_{\\sf opt}^{2}}\\cdot{\\bf v}_{2}\" display=\"inline\"><mrow><msub><mi>\ud835\udc1f</mi><mi>\ud835\uddc8\ud835\uddc9\ud835\uddcd</mi></msub><mo>=</mo><mrow><mrow><msub><mi>\u03b2</mi><mi>\ud835\uddc8\ud835\uddc9\ud835\uddcd</mi></msub><mo>\u22c5</mo><msub><mi>\ud835\udc2f</mi><mn>1</mn></msub></mrow><mo>+</mo><mrow><mrow><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi>j</mi><mo>\u2062</mo><mi mathvariant=\"normal\">\u2220</mi><mo>\u2062</mo><msubsup><mi>\ud835\udc2f</mi><mn>1</mn><mi>H</mi></msubsup><mo>\u2062</mo><msub><mi>\ud835\udc2f</mi><mn>2</mn></msub></mrow></mrow></msup><mo>\u2062</mo><msqrt><mrow><mn>1</mn><mo>-</mo><msubsup><mi>\u03b2</mi><mi>\ud835\uddc8\ud835\uddc9\ud835\uddcd</mi><mn>2</mn></msubsup></mrow></msqrt></mrow><mo>\u22c5</mo><msub><mi>\ud835\udc2f</mi><mn>2</mn></msub></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle{\\bf g}_{\\sf opt}=\\alpha_{1}\\left(\\beta_{\\sf opt}+|{\\bf v}_{1}^{H%&#10;}{\\bf v}_{2}|\\sqrt{1-\\beta_{\\sf opt}^{2}}\\right)\\cdot{\\bf u}_{1}+e^{-j\\angle{{%&#10;\\bf v}_{1}^{H}{\\bf v}_{2}}}\\alpha_{2}\\left(|{\\bf v}_{1}^{H}{\\bf v}_{2}|\\beta_{%&#10;\\sf opt}+\\sqrt{1-\\beta_{\\sf opt}^{2}}\\right)\\cdot{\\bf u}_{2}\\par&#10;\" display=\"inline\"><mrow><msub><mi>\ud835\udc20</mi><mi>\ud835\uddc8\ud835\uddc9\ud835\uddcd</mi></msub><mo>=</mo><mrow><mrow><mrow><msub><mi>\u03b1</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo>(</mo><mrow><msub><mi>\u03b2</mi><mi>\ud835\uddc8\ud835\uddc9\ud835\uddcd</mi></msub><mo>+</mo><mrow><mrow><mo stretchy=\"false\">|</mo><mrow><msubsup><mi>\ud835\udc2f</mi><mn>1</mn><mi>H</mi></msubsup><mo>\u2062</mo><msub><mi>\ud835\udc2f</mi><mn>2</mn></msub></mrow><mo stretchy=\"false\">|</mo></mrow><mo>\u2062</mo><msqrt><mrow><mn>1</mn><mo>-</mo><msubsup><mi>\u03b2</mi><mi>\ud835\uddc8\ud835\uddc9\ud835\uddcd</mi><mn>2</mn></msubsup></mrow></msqrt></mrow></mrow><mo>)</mo></mrow></mrow><mo>\u22c5</mo><msub><mi>\ud835\udc2e</mi><mn>1</mn></msub></mrow><mo>+</mo><mrow><mrow><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi>j</mi><mo>\u2062</mo><mi mathvariant=\"normal\">\u2220</mi><mo>\u2062</mo><msubsup><mi>\ud835\udc2f</mi><mn>1</mn><mi>H</mi></msubsup><mo>\u2062</mo><msub><mi>\ud835\udc2f</mi><mn>2</mn></msub></mrow></mrow></msup><mo>\u2062</mo><msub><mi>\u03b1</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mo>(</mo><mrow><mrow><mrow><mo stretchy=\"false\">|</mo><mrow><msubsup><mi>\ud835\udc2f</mi><mn>1</mn><mi>H</mi></msubsup><mo>\u2062</mo><msub><mi>\ud835\udc2f</mi><mn>2</mn></msub></mrow><mo stretchy=\"false\">|</mo></mrow><mo>\u2062</mo><msub><mi>\u03b2</mi><mi>\ud835\uddc8\ud835\uddc9\ud835\uddcd</mi></msub></mrow><mo>+</mo><msqrt><mrow><mn>1</mn><mo>-</mo><msubsup><mi>\u03b2</mi><mi>\ud835\uddc8\ud835\uddc9\ud835\uddcd</mi><mn>2</mn></msubsup></mrow></msqrt></mrow><mo>)</mo></mrow></mrow><mo>\u22c5</mo><msub><mi>\ud835\udc2e</mi><mn>2</mn></msub></mrow></mrow></mrow></math>", "type": "latex"}]