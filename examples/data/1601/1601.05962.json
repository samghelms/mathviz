[{"file": "1601.05962.tex", "nexttext": "\nWe call $\\Delta$ the {\\em unshuffling coproduct of permutations}. For\ninstance,\n\n", "itemtype": "equation", "pos": 14399, "prevtext": "\n\n\n\n\\title{\nUnshuffling Permutations}\n\n\\author{\n  Samuele Giraudo \\and\n  St\\'ephane Vialette\n}\n\\institute{\n  Universit\\'e Paris-Est, LIGM (UMR 8049), CNRS, UPEM, ESIEE Paris, ENPC,\n  F-77454, Marne-la-Vall\u00c3\u00a9e, France\\\\\n  \\email{samuele.giraudo@univ-mlv.fr} \\\\\n  \\email{vialette@univ-mlv.fr}\n}\n\\date{\\today}\n\n\\maketitle\n\n\n\n\\begin{abstract}\n    A permutation is said to be a square if it can be obtained by\n    shuffling two order-isomorphic patterns. The definition is intended\n    to be the natural counterpart to the ordinary shuffle of words and\n    languages. In this paper, we tackle the problem of recognizing square\n    permutations from both the point of view of algebra and algorithms.\n    On the one hand, we present some algebraic and combinatorial\n    properties of the shuffle product of permutations. We follow an\n    unusual line consisting in defining the shuffle of permutations by\n    means of an unshuffling operator, known as a coproduct. This\n    strategy allows to obtain easy proofs for algebraic and combinatorial\n    properties of our shuffle product. We besides exhibit a bijection\n    between square $(213,231)$-avoiding permutations and square binary\n    words. On the other hand, using a containment-free perfect matching\n    criterion, we prove that recognizing square permutations is {{\\sf\\bf NP}{\\text{-complete}}\\xspace}.\n\\end{abstract}\n\n\n\n\n\n\n\n\\section{Introduction}\n\\label{section:Introduction}\nThe {\\em shuffle product}, denoted $\\shuffle$, is a well-known operation on words\nfirst defined by Eilenberg and Mac Lane~\\cite{Eilenberg:MacLane:1953}.\nGiven three words $u$, $v_1$, and $v_2$, $u$ is said to be a \\emph{shuffle}\nof $v_1$ and $v_2$ if it can be formed by interleaving the letters from\n$v_1$ and $v_2$ in a way that maintains the left-to-right ordering of the\nletters from each word.\nBesides purely combinatorial questions,\nthe shuffle product of words naturally leads to the following computational\nproblems:\n\\begin{enumerate}\n    \\item \\label{item:problem_1}\n    Given two words $v_1$ and $v_2$, compute the set $v_1 \\shuffle v_2$.\n    \\item \\label{item:problem_2}\n    Given three words $u$, $v_1$, and $v_2$, decide if $u$ is a shuffle\n    of $v_1$ and $v_2$.\n    \\item \\label{item:problem_3}\n    Given words $u$, $v_1$, \\dots, $v_k$, decide if $u$ is in\n    $v_1 \\shuffle \\dots \\shuffle v_k$.\n    \\item \\label{item:problem_4}\n    Given a word $u$, decide if there is a word $v$ such that $u$ is\n    in $v \\shuffle v$.\n\\end{enumerate}\nEven if these problems seem similar, they radically differ in terms\nof time complexity. Let us now review some facts about these. In what follows,\n$n$ denotes the size of $u$ and $m_i$ denotes the size of each $v_i$.\nA solution to Problem~\\ref{item:problem_1} can be computed in\n\n\n\n$O\\left((m_1 + m_2) \\; \\binom{m_1 + m_2}{m_1}\\right)$\ntime~\\cite{Spehner:TCS:1986}. An improvement and a generalization\nof~Problem~\\ref{item:problem_1} has been proposed\nin~\\cite{Allauzen:IGM:2000}, where it is proved that given words\n$v_1$, \\dots, $v_k$, the iterated shuffle\n$v_1 \\shuffle \\dots \\shuffle v_k$ can be computed in\n\n\n\n$O\\left(\\binom{m_1 + \\dots + m_k}{m_1, \\dots, m_k}\\right)$\ntime. Problem~\\ref{item:problem_2} is in {{\\sf\\bf P}\\xspace}; it is indeed a\nclassical textbook exercise to design an efficient dynamic programming\nalgorithm solving it. It can be tested in $O\\left(n^2 / \\log(n)\\right)$\ntime~\\cite{Leeuwen:Nivat:IPL:1982}. To the best of our knowledge, the\nfirst $O(n^2)$ time algorithm for this problem appeared\nin~\\cite{Mansfield:DAM:1983}. This algorithm can easily be extended to\ncheck in polynomial-time whether or not a word is in the shuffle of any\nfixed number of given words. Nevertheless, Problem~\\ref{item:problem_3}\nis {{\\sf\\bf NP}{\\text{-complete}}\\xspace}~\\cite{Mansfield:DAM:1983,Warmuth:Haussler:JCSS:1984}. This\nremains true even if the ground alphabet has size\n$3$~\\cite{Warmuth:Haussler:JCSS:1984}. Of particular interest,\nit is shown in~\\cite{Warmuth:Haussler:JCSS:1984} that\nProblem~\\ref{item:problem_3} remains {{\\sf\\bf NP}{\\text{-complete}}\\xspace} even if all the words $v_i$,\n$i \\in [k]$, are identical, thereby proving that, for two words $u$ and\n$v$, it is {{\\sf\\bf NP}{\\text{-complete}}\\xspace} to decide whether or not $u$ is in the iterated shuffle\nof $v$. Again, this remains true even if the ground alphabet has size $3$.\nLet us now finally focus on Problem~\\ref{item:problem_4}. It is shown\nin~\\cite{Buss:Soltys:2014,Rizzi:Vialette:CSR:2013} that it is {{\\sf\\bf NP}{\\text{-complete}}\\xspace} to\ndecide if a word $u$ is a \\emph{square} (w.r.t. the shuffle), that is\na word $u$ with the property that there exists a word $v$ such that $u$\nis a shuffle of $v$ with itself. Hence, Problem~\\ref{item:problem_4}\nis {{\\sf\\bf NP}{\\text{-complete}}\\xspace}.\n\\smallskip\n\nThis paper is intended to study a natural generalization of $\\shuffle$,\ndenoted by ${\\operatorname{\\bullet}}$, as a shuffle of permutations. Roughly speaking,\ngiven three permutations $\\pi$, $\\sigma_1$, and $\\sigma_2$, $\\pi$ is\nsaid to be a {\\em shuffle} of $\\sigma_1$ and $\\sigma_2$ if $\\pi$ (viewed\nas a word) is a shuffle of two words that are order-isomorphic to\n$\\sigma_1$ and $\\sigma_2$. This shuffle product was first introduced by\nVargas~\\cite{Vargas:2014} under the name of {\\em supershuffle}. Our\nintention in this paper is to study this shuffle product of permutations\n${\\operatorname{\\bullet}}$ both from a combinatorial and from a computational point of\nview by focusing on {\\em square} permutations, that are permutations\n$\\pi$ being in the shuffle of a permutation $\\sigma$ with itself. Many\nother shuffle products on permutations appear in the literature. For\ninstance, in~\\cite{DHT:IJAC:2002}, the authors define the {\\em convolution\nproduct} and the {\\em shifted shuffle product}. For this last product,\n$\\pi$ is a shuffle of $\\sigma_1$ and $\\sigma_2$ if $\\pi$ is in the shuffle,\nas words, of $\\sigma_1$ and the word obtained by incrementing all the\nletters of $\\sigma_2$ by the size of $\\sigma_1$. It is a simple exercise\nto prove that, given three permutations $\\pi$, $\\sigma_1$, and $\\sigma_2$,\ndeciding if $\\pi$ is in the shifted shuffle of $\\sigma_1$ and $\\sigma_2$\nis in~{{\\sf\\bf P}\\xspace}.\n\\smallskip\n\nThis paper is organized as follows. In\nSection~\\ref{section:Shuffle product on permutations} we provide a\nprecise definition of ${\\operatorname{\\bullet}}$. This definition passes through the\npreliminary definition of an operator~$\\Delta$, allowing to\n{\\em unshuffle} permutations. This operator is in fact a coproduct,\nendowing the linear span of all permutations with a coalgebra structure\n(see~\\cite{Joni:Rota:1979} or~\\cite{Grinberg:Reiner:2014} for the\ndefinition of these algebraic structures). By duality, the unshuffling\noperator $\\Delta$ leads to the definition of our shuffle operation on\npermutations. This approach has many advantages. First, some\ncombinatorial properties of ${\\operatorname{\\bullet}}$ depend on properties of $\\Delta$\nand are more easy to prove on the coproduct side. Second, this way of\ndoing allows to obtain a clear description of the multiplicities of the\nelements appearing in the shuffle of two permutations, which are worthy\nof interest from a combinatorial point of view.\nSection~\\ref{section:Binary square words and permutations} is devoted to\nshowing that the problems related to the shuffle of words has links with\nthe shuffle of permutations. In particular, we show that binary words\nthat are square are in one-to-one correspondence with square\npermutations avoiding some patterns\n(Proposition~\\ref{prop:bijection_binary_to_permutations_squares}). Next,\nSection~\\ref{section:Algebraic issues} presents some algebraic and\ncombinatorial properties of~${\\operatorname{\\bullet}}$. We show that ${\\operatorname{\\bullet}}$ is\nassociative and commutative\n(Proposition~\\ref{prop:shuffle_associative_commutative}), and that if a\npermutation is a square, its mirror, complement, and inverse are also\nsquares (Proposition~\\ref{prop:square_stability}). Finally,\nSection~\\ref{section:Algorithmic issues} presents the most important result\nof this paper: the fact that deciding if a permutation is a square is\n{{\\sf\\bf NP}{\\text{-complete}}\\xspace} (Proposition~\\ref{proposition:hardness}). This result is obtained\nby exhibiting a reduction from the pattern involvement\nproblem~\\cite{Bose:Buss:Lubiw:1998} which is {{\\sf\\bf NP}{\\text{-complete}}\\xspace}.\n\n\n\n\n\n\n\\section{Notations}\n\\label{section:Notations}\n\nIf $S$ is a finite set, the cardinality of $S$ is denoted by $|S|$,\nand if $P$ and $Q$ are two disjoint sets, $P \\sqcup Q$ denotes the\ndisjoint union of $P$ and $Q$. For any nonnegative integer $n$, $[n]$\nis the set $\\{1, \\dots, n\\}$.\n\nWe follow the usual terminology on words~\\cite{ChoffrutKarhumaki1997}.\nLet us recall here the most important ones. Let $u$ be a word. The\nlength of $u$ is denoted by $|u|$. The {\\em empty word}, the only word\nof null length, is denoted by $\\epsilon$. We denote by $\\widetilde{u}$\nthe {\\em mirror image} of $u$, that is the word\n$u_{|u|} u_{|u| - 1} \\dots u_1$. If $P$ is a subset of $[|u|]$, $u_{|P}$\nis the subword of $u$ consisting in the letters of $u$ at the positions\nspecified by the elements of $P$. If $u$ is a word of integers and $k$\nis an integer, we denote by $u[k]$ the word obtained by incrementing by\n$k$ all letters of $u$. The {\\em shuffle} of two words $u$ and $v$ is\nthe set recursively defined by\n$u \\shuffle \\epsilon = \\{u\\} = \\epsilon \\shuffle u$ and\n$ua \\shuffle vb = (u \\shuffle vb)a \\cup (ua \\shuffle v)b$, were $a$ and\n$b$ are letters. A word $u$ is a {\\em square} if there exists a word $v$\nsuch that $u$ belongs to $v \\shuffle v$.\n\nWe denote by $S_n$ the set of permutations of size $n$ and by $S$ the\nset of all permutations. In this paper, permutations of a size $n$ are\nspecified by words of length $n$ on the alphabet $[n]$ and without\nmultiple occurrence of a letter, so that all above definitions about\nwords remain valid on permutations. The only difference lies on the\nfact that we shall denote by $\\pi(i)$ (instead of $\\pi_i$) the $i$-th\nletter of any permutation $\\pi$. For any nonnegative integer $n$, we\nwrite $\\nearrow_{n}$ (resp. $\\searrow_{n}$) for the permutation\n$1 2 \\dots n$ (resp. $n\\,(n-1) \\dots 1$). If $\\pi$ is a permutation of\n$S_n$, we denote by $\\bar \\pi$ the {\\em complement} of $\\pi$, that is\nthe permutation satisfying $\\bar \\pi(i) = n - \\pi(i) + 1$ for all\n$i \\in [n]$. The {\\em inverse} of $\\pi$ is denoted by $\\pi^{-1}$.\n\nIf $u$ is a word of integers without multiple occurrences of a same\nletter, ${\\operatorname{\\mathrm{s}}}(u)$ is the {\\em standardized} of $u$, that is the unique\npermutation of the same size as $u$ such that for all $i, j \\in [|u|]$,\n$u_i < u_j$ if and only if ${\\operatorname{\\mathrm{s}}}(u)(i) < {\\operatorname{\\mathrm{s}}}(u)(j)$. In particular, the\nimage of the map ${\\operatorname{\\mathrm{s}}}$ is the set $S$ of all permutations. Two words $u$\nand $v$ having the same standardized are {\\em order-isomorphic}. If\n$\\sigma$ is a permutation, there is an {\\em occurrence} of (the\n{\\em pattern}) $\\sigma$ in $\\pi$ if there is a set $P$ of indexes of\nletters of $\\pi$ such that $\\sigma$ and $\\pi_{|P}$ are order-isomorphic.\nWhen $\\pi$ does not admit any occurrence of $\\sigma$, $\\pi$ {\\em avoids}\n$\\sigma$. The set of permutations of size $n$ avoiding $\\sigma$ is\ndenoted by $S_n(\\sigma)$.\n\nLet us now provide some definitions about graphs and matching that are used in\nthe sequel. For a graph $G$, we denote ${{\\mathbf{V}}({G})}$ as the set of vertices\nand ${{\\mathbf{E}}({G})}$ as the set of edges of $G$. Let $u = u_1 u_2 \\dots u_n$ be\na word. The \\emph{clique graph associated with $u$}, denoted by $K_u$, is\nthe complete graph on ${{\\mathbf{V}}({K_u})} = \\{u_1, u_2, \\ldots, u_n\\}$. The\nstructure of this underlying graph is linear, \\emph{i.e.}, the set of\nits vertices is equipped with a natural total order $<$ defined by\n$u_i < u_j$ if and only if $i < j$. For a linear graph, we write\n$(u_i, u_j)$ instead of $\\{u_i, u_j\\}$ for an edge if it is clear from\nthe context that $i < j$. Recall that two edges of a graph are\n\\emph{independent} if they do not share a common vertex, and that a\n\\emph{matching} $\\mathcal{M}$ in $G$ is a set of pairwise independent\nedges. A matching is \\emph{perfect} if it covers all the vertices of the\ngraph.\nFor an edge $e = \\{u,v\\}$, we shall occasionally say that $u$ and $v$\nare \\emph{involved} in $e$.\nIn case the set of vertices is equipped with a total order, a\nmatching $\\mathcal{M}$ is said to be \\emph{containment-free} if there do\nnot exist (independent) edges $(u_i, u_j)$ and $(u_k, u_\\ell)$ in\n$\\mathcal{M}$ such that $u_i < u_k < u_\\ell < u_j$\n\n(\\emph{i.e.}, $\\mathcal{M}$ avoids~ \\begin{tikzpicture}[scale=0.1,inner sep=.8pt,node distance=.25cm] \\draw node [draw,circle,fill=black] (U1)               {}; \\draw node [draw,circle,fill=black] [right of=U1] (U2) {}; \\draw node [draw,circle,fill=black] [right of=U2] (U3) {}; \\draw node [draw,circle,fill=black] [right of=U3] (U4) {}; \\draw (U2.north) .. controls ($ (U2.north) + (0,1.75) $) and ($ (U3.north) + (0,1.75) $) .. (U3.north); \\draw (U1.north) .. controls ($ (U1.north) + (0,2.5) $) and ($ (U4.north) + (0,2.5) $) .. (U4.north); \\end{tikzpicture} ).\n\n\n\n\n\n\n\\section{Shuffle product on permutations}\n\\label{section:Shuffle product on permutations}\n\nThe purpose of this section is to define a shuffle product ${\\operatorname{\\bullet}}$\non permutations. Recall that a first definition of this product was\nprovided by Vargas~\\cite{Vargas:2014}. To present an alternative\ndefinition of this product adapted to our study, we shall first define\na coproduct denoted by $\\Delta$, enabling to unshuffle permutations.\nBy duality, $\\Delta$ implies the definition of ${\\operatorname{\\bullet}}$. The reason\nwhy we need to pass by the definition of $\\Delta$ to define ${\\operatorname{\\bullet}}$\nis justified by the fact that a lot of properties of ${\\operatorname{\\bullet}}$ depend\nof properties of $\\Delta$, and that this strategy allows to write concise\nand clear proofs of them. We invite the reader unfamiliar with the\nconcepts of coproduct and duality to consult~\\cite{Joni:Rota:1979}\nor~\\cite{Grinberg:Reiner:2014}.\n\nLet us denote by ${\\operatorname{\\mathbb{Q}}}[S]$ the linear span of all permutations. We\ndefine a linear coproduct $\\Delta$ on ${\\operatorname{\\mathbb{Q}}}[S]$ in the following way. For\nany permutation $\\pi$, we set\n\n", "index": 1, "text": "\\begin{equation} \\label{equ:unshuffling_coproduct}\n    \\Delta(\\pi) =\n    \\sum_{P_1 \\sqcup P_2 = [|\\pi|]}\n    {\\operatorname{\\mathrm{s}}}\\left(\\pi_{|P_1}\\right) \\otimes {\\operatorname{\\mathrm{s}}}\\left(\\pi_{|P_2}\\right).\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"\\Delta(\\pi)=\\sum_{P_{1}\\sqcup P_{2}=[|\\pi|]}{\\operatorname{\\mathrm{s}}}\\left(%&#10;\\pi_{|P_{1}}\\right)\\otimes{\\operatorname{\\mathrm{s}}}\\left(\\pi_{|P_{2}}\\right).\" display=\"block\"><mrow><mrow><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c0</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mrow><msub><mi>P</mi><mn>1</mn></msub><mo>\u2294</mo><msub><mi>P</mi><mn>2</mn></msub></mrow><mo>=</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mo stretchy=\"false\">|</mo><mi>\u03c0</mi><mo stretchy=\"false\">|</mo></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></munder><mrow><mrow><mo>s</mo><mo>\u2061</mo><mrow><mo>(</mo><msub><mi>\u03c0</mi><mrow><mo stretchy=\"false\">|</mo><msub><mi>P</mi><mn>1</mn></msub></mrow></msub><mo>)</mo></mrow></mrow><mo>\u2297</mo><mrow><mo>s</mo><mo>\u2061</mo><mrow><mo>(</mo><msub><mi>\u03c0</mi><mrow><mo stretchy=\"false\">|</mo><msub><mi>P</mi><mn>2</mn></msub></mrow></msub><mo>)</mo></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05962.tex", "nexttext": "\n\n", "itemtype": "equation", "pos": 14714, "prevtext": "\nWe call $\\Delta$ the {\\em unshuffling coproduct of permutations}. For\ninstance,\n\n", "index": 3, "text": "\\begin{equation}\n    \\Delta(213) =\n    \\epsilon \\otimes 213 + 2 \\cdot 1 \\otimes 12 +\n    1 \\otimes 21 + 2 \\cdot 12 \\otimes 1 + 21 \\otimes 1\n    + 213 \\otimes \\epsilon,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"\\Delta(213)=\\epsilon\\otimes 213+2\\cdot 1\\otimes 12+1\\otimes 21+2\\cdot 12%&#10;\\otimes 1+21\\otimes 1+213\\otimes\\epsilon,\" display=\"block\"><mrow><mrow><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>213</mn><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>\u03f5</mi><mo>\u2297</mo><mn>213</mn></mrow><mo>+</mo><mrow><mrow><mn>2</mn><mo>\u22c5</mo><mn>1</mn></mrow><mo>\u2297</mo><mn>12</mn></mrow><mo>+</mo><mrow><mn>1</mn><mo>\u2297</mo><mn>21</mn></mrow><mo>+</mo><mrow><mrow><mn>2</mn><mo>\u22c5</mo><mn>12</mn></mrow><mo>\u2297</mo><mn>1</mn></mrow><mo>+</mo><mrow><mn>21</mn><mo>\u2297</mo><mn>1</mn></mrow><mo>+</mo><mrow><mn>213</mn><mo>\u2297</mo><mi>\u03f5</mi></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05962.tex", "nexttext": "\n\n", "itemtype": "equation", "pos": 14897, "prevtext": "\n\n", "index": 5, "text": "\\begin{equation}\n    \\Delta(1234) =\n    \\epsilon \\otimes 1234 + 4 \\cdot 1 \\otimes 123 + 6 \\cdot 12 \\otimes 12 +\n    4 \\cdot 123 \\otimes 1 + 1234 \\otimes \\epsilon,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"\\Delta(1234)=\\epsilon\\otimes 1234+4\\cdot 1\\otimes 123+6\\cdot 12\\otimes 12+4%&#10;\\cdot 123\\otimes 1+1234\\otimes\\epsilon,\" display=\"block\"><mrow><mrow><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>1234</mn><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>\u03f5</mi><mo>\u2297</mo><mn>1234</mn></mrow><mo>+</mo><mrow><mrow><mn>4</mn><mo>\u22c5</mo><mn>1</mn></mrow><mo>\u2297</mo><mn>123</mn></mrow><mo>+</mo><mrow><mrow><mn>6</mn><mo>\u22c5</mo><mn>12</mn></mrow><mo>\u2297</mo><mn>12</mn></mrow><mo>+</mo><mrow><mrow><mn>4</mn><mo>\u22c5</mo><mn>123</mn></mrow><mo>\u2297</mo><mn>1</mn></mrow><mo>+</mo><mrow><mn>1234</mn><mo>\u2297</mo><mi>\u03f5</mi></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05962.tex", "nexttext": "\nObserve that the coefficient of the tensor $1 \\otimes 132$ is $3$\nin~\\eqref{equ:example_unshuffling_coproduct} because there are exactly\nthree ways to extract from the permutation $1432$ two disjoint subwords\nrespectively order-isomorphic to the permutations $1$ and $132$.\n\nAs announced, let us now use $\\Delta$ to define a shuffle product on\npermutations. As any coproduct, $\\Delta$ leads to the definition of a\nproduct obtained by duality in the following way.\nFrom~\\eqref{equ:unshuffling_coproduct}, for any permutation $\\pi$, we\nhave\n\n", "itemtype": "equation", "pos": 15075, "prevtext": "\n\n", "index": 7, "text": "\\begin{equation}\\begin{split} \\label{equ:example_unshuffling_coproduct}\n    \\Delta(1432) & =\n    \\epsilon \\otimes 1432 + 3 \\cdot {\\bf 1 \\otimes 132} + 1 \\otimes 321 +\n    3 \\cdot 12 \\otimes 21 \\\\ & + 3 \\cdot 21 \\otimes 12\n    + 3 \\cdot 132 \\otimes 1 + 321 \\otimes 1 + 1432 \\otimes \\epsilon.\n\\end{split}\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"\\begin{split}\\displaystyle\\Delta(1432)&amp;\\displaystyle=\\epsilon\\otimes 1432+3%&#10;\\cdot{\\bf 1\\otimes 132}+1\\otimes 321+3\\cdot 12\\otimes 21\\\\&#10;&amp;\\displaystyle+3\\cdot 21\\otimes 12+3\\cdot 132\\otimes 1+321\\otimes 1+1432%&#10;\\otimes\\epsilon.\\end{split}\" display=\"block\"><mtable columnspacing=\"0pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"right\"><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>1432</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"left\"><mrow><mi/><mo>=</mo><mrow><mrow><mi>\u03f5</mi><mo>\u2297</mo><mn>1432</mn></mrow><mo>+</mo><mrow><mrow><mn>3</mn><mo>\u22c5</mo><mn>\ud835\udfcf</mn></mrow><mo>\u2297</mo><mn>\ud835\udfcf\ud835\udfd1\ud835\udfd0</mn></mrow><mo>+</mo><mrow><mn>1</mn><mo>\u2297</mo><mn>321</mn></mrow><mo>+</mo><mrow><mrow><mn>3</mn><mo>\u22c5</mo><mn>12</mn></mrow><mo>\u2297</mo><mn>21</mn></mrow></mrow></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mrow><mrow><mo>+</mo><mrow><mrow><mn>3</mn><mo>\u22c5</mo><mn>21</mn></mrow><mo>\u2297</mo><mn>12</mn></mrow></mrow><mo>+</mo><mrow><mrow><mn>3</mn><mo>\u22c5</mo><mn>132</mn></mrow><mo>\u2297</mo><mn>1</mn></mrow><mo>+</mo><mrow><mn>321</mn><mo>\u2297</mo><mn>1</mn></mrow><mo>+</mo><mrow><mn>1432</mn><mo>\u2297</mo><mi>\u03f5</mi></mrow></mrow><mo>.</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.05962.tex", "nexttext": "\nwhere the $\\lambda_{\\sigma, \\nu}^\\pi$ are nonnegative integers. Now,\nby definition of duality, the dual product of $\\Delta$, denoted by\n${\\operatorname{\\bullet}}$, is a linear binary product on ${\\operatorname{\\mathbb{Q}}}[S]$. It satisfies, for\nany permutations $\\sigma$ and $\\nu$,\n\n", "itemtype": "equation", "pos": 15931, "prevtext": "\nObserve that the coefficient of the tensor $1 \\otimes 132$ is $3$\nin~\\eqref{equ:example_unshuffling_coproduct} because there are exactly\nthree ways to extract from the permutation $1432$ two disjoint subwords\nrespectively order-isomorphic to the permutations $1$ and $132$.\n\nAs announced, let us now use $\\Delta$ to define a shuffle product on\npermutations. As any coproduct, $\\Delta$ leads to the definition of a\nproduct obtained by duality in the following way.\nFrom~\\eqref{equ:unshuffling_coproduct}, for any permutation $\\pi$, we\nhave\n\n", "index": 9, "text": "\\begin{equation} \\label{equ:schematic_coproduct}\n    \\Delta(\\pi) =\n    \\sum_{\\sigma, \\nu \\in S} \\lambda_{\\sigma, \\nu}^\\pi \\;\n    \\sigma \\otimes \\nu,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"\\Delta(\\pi)=\\sum_{\\sigma,\\nu\\in S}\\lambda_{\\sigma,\\nu}^{\\pi}\\;\\sigma\\otimes\\nu,\" display=\"block\"><mrow><mrow><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c0</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mrow><mi>\u03c3</mi><mo>,</mo><mi>\u03bd</mi></mrow><mo>\u2208</mo><mi>S</mi></mrow></munder><mrow><mrow><mpadded width=\"+2.8pt\"><msubsup><mi>\u03bb</mi><mrow><mi>\u03c3</mi><mo>,</mo><mi>\u03bd</mi></mrow><mi>\u03c0</mi></msubsup></mpadded><mo>\u2062</mo><mi>\u03c3</mi></mrow><mo>\u2297</mo><mi>\u03bd</mi></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05962.tex", "nexttext": "\nwhere the coefficients $\\lambda_{\\sigma, \\nu}^\\pi$ are the ones\nof~\\eqref{equ:schematic_coproduct}. We call ${\\operatorname{\\bullet}}$ the\n{\\em shuffle product of permutations}. For instance,\n\n", "itemtype": "equation", "pos": 16378, "prevtext": "\nwhere the $\\lambda_{\\sigma, \\nu}^\\pi$ are nonnegative integers. Now,\nby definition of duality, the dual product of $\\Delta$, denoted by\n${\\operatorname{\\bullet}}$, is a linear binary product on ${\\operatorname{\\mathbb{Q}}}[S]$. It satisfies, for\nany permutations $\\sigma$ and $\\nu$,\n\n", "index": 11, "text": "\\begin{equation}\n    \\sigma {\\operatorname{\\bullet}} \\nu =\n    \\sum_{\\pi \\in S}\n    \\lambda_{\\sigma, \\nu}^\\pi \\; \\pi,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"\\sigma{\\operatorname{\\bullet}}\\nu=\\sum_{\\pi\\in S}\\lambda_{\\sigma,\\nu}^{\\pi}\\;\\pi,\" display=\"block\"><mrow><mrow><mrow><mi>\u03c3</mi><mo>\u2062</mo><mrow><mo>\u2219</mo><mo>\u2061</mo><mi>\u03bd</mi></mrow></mrow><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>\u03c0</mi><mo>\u2208</mo><mi>S</mi></mrow></munder><mrow><mpadded width=\"+2.8pt\"><msubsup><mi>\u03bb</mi><mrow><mi>\u03c3</mi><mo>,</mo><mi>\u03bd</mi></mrow><mi>\u03c0</mi></msubsup></mpadded><mo>\u2062</mo><mi>\u03c0</mi></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05962.tex", "nexttext": "\nObserve that the coefficient $3$ of the permutation $1432$\nin~\\eqref{equ:example_shuffle_product} comes from the fact that the\ncoefficient of the tensor $12 \\otimes 21$ is $3$\nin~\\eqref{equ:example_unshuffling_coproduct}.\n\nIntuitively, this product shuffles the values and the positions of the\nletters of the permutations. One can observe that the empty permutation\n$\\epsilon$ is a unit for ${\\operatorname{\\bullet}}$ and that this product is graded by\nthe sizes of the permutations ({\\em i.e.}, the product of a permutation\nof size $n$ with a permutation of size $m$ produces a sum of permutations\nof size $n + m$).\n\nWe say that a permutation $\\pi$ {\\em appears} in the shuffle\n$\\sigma {\\operatorname{\\bullet}} \\nu$ of two permutations $\\sigma$ and $\\nu$ if the\ncoefficient $\\lambda_{\\sigma, \\nu}^\\pi$ defined above is different from\nzero. In a more combinatorial way, this is equivalent to say that there\nare two sets $P_1$ and $P_2$ of disjoints indexes of letters of $\\pi$\nsatisfying $P_1 \\sqcup P_2 = [|\\pi|]$ such that the subword $\\pi_{|P_1}$\nis order-isomorphic to $\\sigma$ and the subword $\\pi_{|P_2}$ is\norder-isomorphic to $\\nu$.\n\nA permutation $\\pi$ is a {\\em square} if there is a permutation\n$\\sigma$ such that $\\pi$ appears in $\\sigma {\\operatorname{\\bullet}} \\sigma$.\nIn this case, we say that $\\sigma$ is a {\\em square root} of $\\pi$.\nEquivalently, $\\pi$ is a square with $\\sigma$ as square root if and only\nif in the expansion of $\\Delta(\\pi)$, there is a tensor\n$\\sigma \\otimes \\sigma$ with a nonzero coefficient. In a more\ncombinatorial way, this is equivalent to saying that there are two sets\n$P_1$ and $P_2$ of disjoints indexes of letters of $\\pi$ satisfying\n$P_1 \\sqcup P_2 = [|\\pi|]$ such that the subwords $\\pi_{|P_1}$ and\n$\\pi_{|P_2}$ are order-isomorphic. Computer experiments give us the\nfirst numbers of square permutations with respects to their size, which\nare, from size $0$ to $10$,\n\n", "itemtype": "equation", "pos": 16703, "prevtext": "\nwhere the coefficients $\\lambda_{\\sigma, \\nu}^\\pi$ are the ones\nof~\\eqref{equ:schematic_coproduct}. We call ${\\operatorname{\\bullet}}$ the\n{\\em shuffle product of permutations}. For instance,\n\n", "index": 13, "text": "\\begin{equation}\\begin{split} \\label{equ:example_shuffle_product}\n    12 {\\operatorname{\\bullet}} 21 & =\n    1243 + 1324 + 2 \\cdot 1342 + 2 \\cdot 1423 + 3 \\cdot {\\bf 1432} +\n    2134 + 2 \\cdot 2314 \\\\\n    & + 3 \\cdot 2341 + 2413 + 2 \\cdot 2431 + 2 \\cdot 3124 + 3142 +\n    3 \\cdot 3214 + 2 \\cdot 3241 \\\\\n    & + 3421 + 3 \\cdot 4123 + 2 \\cdot 4132 + 2 \\cdot 4213 + 4231 + 4312.\n\\end{split}\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"\\begin{split}\\displaystyle 12{\\operatorname{\\bullet}}21&amp;\\displaystyle=1243+132%&#10;4+2\\cdot 1342+2\\cdot 1423+3\\cdot{\\bf 1432}+2134+2\\cdot 2314\\\\&#10;&amp;\\displaystyle+3\\cdot 2341+2413+2\\cdot 2431+2\\cdot 3124+3142+3\\cdot 3214+2%&#10;\\cdot 3241\\\\&#10;&amp;\\displaystyle+3421+3\\cdot 4123+2\\cdot 4132+2\\cdot 4213+4231+4312.\\end{split}\" display=\"block\"><mtable columnspacing=\"0pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"right\"><mrow><mn>12</mn><mo>\u2062</mo><mrow><mo>\u2219</mo><mo>\u2061</mo><mn>21</mn></mrow></mrow></mtd><mtd columnalign=\"left\"><mrow><mi/><mo>=</mo><mrow><mn>1243</mn><mo>+</mo><mn>1324</mn><mo>+</mo><mrow><mn>2</mn><mo>\u22c5</mo><mn>1342</mn></mrow><mo>+</mo><mrow><mn>2</mn><mo>\u22c5</mo><mn>1423</mn></mrow><mo>+</mo><mrow><mn>3</mn><mo>\u22c5</mo><mn>\ud835\udfcf\ud835\udfd2\ud835\udfd1\ud835\udfd0</mn></mrow><mo>+</mo><mn>2134</mn><mo>+</mo><mrow><mn>2</mn><mo>\u22c5</mo><mn>2314</mn></mrow></mrow></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mrow><mo>+</mo><mrow><mn>3</mn><mo>\u22c5</mo><mn>2341</mn></mrow></mrow><mo>+</mo><mn>2413</mn><mo>+</mo><mrow><mn>2</mn><mo>\u22c5</mo><mn>2431</mn></mrow><mo>+</mo><mrow><mn>2</mn><mo>\u22c5</mo><mn>3124</mn></mrow><mo>+</mo><mn>3142</mn><mo>+</mo><mrow><mn>3</mn><mo>\u22c5</mo><mn>3214</mn></mrow><mo>+</mo><mrow><mn>2</mn><mo>\u22c5</mo><mn>3241</mn></mrow></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mrow><mrow><mo>+</mo><mn>3421</mn></mrow><mo>+</mo><mrow><mn>3</mn><mo>\u22c5</mo><mn>4123</mn></mrow><mo>+</mo><mrow><mn>2</mn><mo>\u22c5</mo><mn>4132</mn></mrow><mo>+</mo><mrow><mn>2</mn><mo>\u22c5</mo><mn>4213</mn></mrow><mo>+</mo><mn>4231</mn><mo>+</mo><mn>4312</mn></mrow><mo>.</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.05962.tex", "nexttext": "\nThis sequence (and its subsequence obtained by removing the $0$'s) is for\nthe time being not listed in~\\cite{Slo}. The square permutations of\nsizes $0$ to $4$ are\n\\smallskip\n\n\\begin{tabular}{c|c|c}\n    Size $0$ \\, & Size $2$ & Size $4$ \\\\ \\hline\n    \\multirow{2}{*}{\\, $\\epsilon$} &\n    \\multirow{2}{*}{\\, $12$, $21$ \\,} &\n    $1234$, $1243$, $1423$, $1324$, $1342$, $4132$, $3124$, $3142$,\n    $3412$, $4312$, \\\\\n    & & $2134$, $2143$, $2413$, $4213$, $2314$, $2431$, $4231$, $3241$,\n    $3421$, $4321$\n\\end{tabular}\n\n\n\n\n\n\n\\section{Binary square words and permutations}\n\\label{section:Binary square words and permutations}\nIn this section, we shall show that the square binary words are in\none-to-one correspondence with square permutations avoiding some\npatterns. This property establishes a link between the shuffle of binary\nwords and our shuffle of permutations and allows to obtain a new\ndescription of square binary words.\n\nLet $u$ be a binary word of length $n$ with $k$ occurrences of $0$.\nWe denote by ${\\operatorname{\\mathrm{btp}}}$ (Binary word To Permutation) the map sending\nany such word $u$ to the permutation obtained by replacing from left to\nright each occurrence of $0$ in $u$ by $1$, $2$, \\dots, $k$, and from\nright to left each occurrence of $1$ in $u$ by $k + 1$, $k + 2$, \\dots, $n$.\nFor instance,\n\n", "itemtype": "equation", "pos": 19023, "prevtext": "\nObserve that the coefficient $3$ of the permutation $1432$\nin~\\eqref{equ:example_shuffle_product} comes from the fact that the\ncoefficient of the tensor $12 \\otimes 21$ is $3$\nin~\\eqref{equ:example_unshuffling_coproduct}.\n\nIntuitively, this product shuffles the values and the positions of the\nletters of the permutations. One can observe that the empty permutation\n$\\epsilon$ is a unit for ${\\operatorname{\\bullet}}$ and that this product is graded by\nthe sizes of the permutations ({\\em i.e.}, the product of a permutation\nof size $n$ with a permutation of size $m$ produces a sum of permutations\nof size $n + m$).\n\nWe say that a permutation $\\pi$ {\\em appears} in the shuffle\n$\\sigma {\\operatorname{\\bullet}} \\nu$ of two permutations $\\sigma$ and $\\nu$ if the\ncoefficient $\\lambda_{\\sigma, \\nu}^\\pi$ defined above is different from\nzero. In a more combinatorial way, this is equivalent to say that there\nare two sets $P_1$ and $P_2$ of disjoints indexes of letters of $\\pi$\nsatisfying $P_1 \\sqcup P_2 = [|\\pi|]$ such that the subword $\\pi_{|P_1}$\nis order-isomorphic to $\\sigma$ and the subword $\\pi_{|P_2}$ is\norder-isomorphic to $\\nu$.\n\nA permutation $\\pi$ is a {\\em square} if there is a permutation\n$\\sigma$ such that $\\pi$ appears in $\\sigma {\\operatorname{\\bullet}} \\sigma$.\nIn this case, we say that $\\sigma$ is a {\\em square root} of $\\pi$.\nEquivalently, $\\pi$ is a square with $\\sigma$ as square root if and only\nif in the expansion of $\\Delta(\\pi)$, there is a tensor\n$\\sigma \\otimes \\sigma$ with a nonzero coefficient. In a more\ncombinatorial way, this is equivalent to saying that there are two sets\n$P_1$ and $P_2$ of disjoints indexes of letters of $\\pi$ satisfying\n$P_1 \\sqcup P_2 = [|\\pi|]$ such that the subwords $\\pi_{|P_1}$ and\n$\\pi_{|P_2}$ are order-isomorphic. Computer experiments give us the\nfirst numbers of square permutations with respects to their size, which\nare, from size $0$ to $10$,\n\n", "index": 15, "text": "\\begin{equation}\n    1, 0, 2, 0, 20, 0, 504, 0, 21032, 0, 1293418.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m1\" class=\"ltx_Math\" alttext=\"1,0,2,0,20,0,504,0,21032,0,1293418.\" display=\"block\"><mrow><mrow><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>20</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>504</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>21032</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1293418</mn></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05962.tex", "nexttext": "\nwhere $\\mathrm{A}$, $\\mathrm{B}$, and $\\mathrm{C}$ respectively stand\nfor $10$, $11$, and $12$. Observe that for any nonempty permutation\n$\\pi$ in the image of ${\\operatorname{\\mathrm{btp}}}$, there is exactly one binary word $u$\nsuch that ${\\operatorname{\\mathrm{btp}}}(u0) = {\\operatorname{\\mathrm{btp}}}(u1) = \\pi$. In support of this\nobservation, when $\\pi$ has an even size, we denote by ${\\operatorname{\\mathrm{ptb}}}(\\pi)$\n(Permutation To Binary word) the word $ua$ such that $|ua|_0$ and $|ua|_1$\nare both even, where $a \\in \\{0, 1\\}$.\n\n\\begin{proposition} \\label{prop:bijection_binary_to_permutations_squares}\n    For any $n \\geq 0$, the map ${\\operatorname{\\mathrm{btp}}}$ restricted to the set of\n    square binary words of length $2n$ is a bijection between this last\n    set and the set of square permutations of size $2n$ avoiding the\n    patterns $213$ and $231$.\n\\end{proposition}\n\\begin{proof}\n    [of Proposition~\\ref{prop:bijection_binary_to_permutations_squares}]\n    The statement of the proposition is a consequence of the\n    following claims implying that ${\\operatorname{\\mathrm{ptb}}}$ is the inverse\n    map of ${\\operatorname{\\mathrm{btp}}}$ over the set of square binary words.\n    \\begin{claim} \\label{claim:binary_to_permutation_avoiding}\n        The image of ${\\operatorname{\\mathrm{btp}}}$ is the set of all permutations\n        avoiding $213$ and $231$.\n    \\end{claim}\n    \\begin{proof}[of Claim~\\ref{claim:binary_to_permutation_avoiding}]\n        Let us first show that the image of ${\\operatorname{\\mathrm{btp}}}$ contains only\n        permutations avoiding $213$ and $231$. Let $u$ be a binary word,\n        $\\pi = {\\operatorname{\\mathrm{btp}}}(u)$, and $P_0$ (resp. $P_1$) be the set of the\n        positions of the occurrences of $0$ (resp. $1$) in $u$. By\n        definition of ${\\operatorname{\\mathrm{btp}}}$, from left to right, the subword\n        $v = \\pi_{|P_0}$ is increasing and the subword $w = \\pi_{|P_1}$\n        is decreasing, and all letters of $w$ are greater than those\n        of~$v$. Now, assume that $\\pi$ admits an occurrence of $213$.\n        Then, since $v$ is increasing and $w$ is decreasing, there is an\n        occurrence of $3$ (resp. $13$, $23$) in $v$ and a relative\n        occurrence of $21$ (resp. $2$, $1$). All these three cases\n        contradict the fact that all letters of $w$ are greater than\n        those of $v$. A similar argument shows that $\\pi$ avoids~$231$\n        as well.\n        \\smallskip\n\n        Finally, observe that any permutation $\\pi$ avoiding $213$ and\n        $231$ necessarily starts by the smallest possible letter or the\n        greatest possible letter. This property is then true for the\n        suffix of $\\pi$ obtained by deleting its first letter,\n        and so on for all of its suffixes. Thus, by\n        replacing each letter $a$ of $\\pi$ by $0$ (resp. $1$) if $a$ has the\n        role of a smallest (resp. greatest) letter, one obtains a binary\n        word $u$ such that ${\\operatorname{\\mathrm{btp}}}(u) = \\pi$. Hence, all permutations\n        avoiding $213$ and $231$ are in the image of ${\\operatorname{\\mathrm{btp}}}$.\n        \\qed\n    \\end{proof}\n\n    \\begin{claim} \\label{claim:square_binary_to_square_permutation}\n        If $u$ is a square binary word, ${\\operatorname{\\mathrm{btp}}}(u)$ is a square\n        permutation.\n    \\end{claim}\n    \\begin{proof}[of Claim~\\ref{claim:square_binary_to_square_permutation}]\n        Since $u$ is a square binary word, there is a binary word $v$\n        such that $u \\in v \\shuffle v$. Then, there are two disjoint\n        sets $P$ and $Q$ of positions of letters of $u$ such that\n        $u_{|P} = v = u_{|Q}$. Now, by definition of ${\\operatorname{\\mathrm{btp}}}$, the\n        words ${\\operatorname{\\mathrm{btp}}}(u)_{|P}$ and ${\\operatorname{\\mathrm{btp}}}(u)_{|Q}$ have the\n        same standardized $\\sigma$. Hence, and by definition of\n        the shuffle product of permutations, ${\\operatorname{\\mathrm{btp}}}(u)$ appears in\n        $\\sigma {\\operatorname{\\bullet}} \\sigma$, showing that ${\\operatorname{\\mathrm{btp}}}(u)$ is a\n        square permutation.\n        \\qed\n    \\end{proof}\n\n    \\begin{claim} \\label{claim:square_permutation_to_square_binary}\n        If $\\pi$ is a square permutation avoiding $213$ and $231$,\n        ${\\operatorname{\\mathrm{ptb}}}(\\pi)$ is a square binary word.\n    \\end{claim}\n    \\begin{proof}[of Claim~\\ref{claim:square_permutation_to_square_binary}]\n        Let $\\pi$ be a square permutation avoiding $213$ and $231$. By\n        Claim~\\ref{claim:binary_to_permutation_avoiding}, $\\pi$ is in\n        the image of ${\\operatorname{\\mathrm{btp}}}$ and hence, $u = {\\operatorname{\\mathrm{ptb}}}(\\pi)$ is a\n        well-defined binary word. Since $\\pi$ is a square permutation,\n        there are two disjoint sets $P_1$ and $P_2$ of indexes of letters\n        of $\\pi$ such that $\\pi_{|P_1}$ and $\\pi_{|P_2}$ are\n        order-isomorphic. This implies, by the definitions of ${\\operatorname{\\mathrm{btp}}}$\n        and ${\\operatorname{\\mathrm{ptb}}}$, that $u_{|P_1} = u_{|P_2}$, showing that $u$\n        is a square binary word.\n        \\qed\n    \\end{proof}\n    \\qed\n\\end{proof}\n\nThe number of square binary words is Sequence A191755 of~\\cite{Slo}\nbeginning by\n\n", "itemtype": "equation", "pos": 20428, "prevtext": "\nThis sequence (and its subsequence obtained by removing the $0$'s) is for\nthe time being not listed in~\\cite{Slo}. The square permutations of\nsizes $0$ to $4$ are\n\\smallskip\n\n\\begin{tabular}{c|c|c}\n    Size $0$ \\, & Size $2$ & Size $4$ \\\\ \\hline\n    \\multirow{2}{*}{\\, $\\epsilon$} &\n    \\multirow{2}{*}{\\, $12$, $21$ \\,} &\n    $1234$, $1243$, $1423$, $1324$, $1342$, $4132$, $3124$, $3142$,\n    $3412$, $4312$, \\\\\n    & & $2134$, $2143$, $2413$, $4213$, $2314$, $2431$, $4231$, $3241$,\n    $3421$, $4321$\n\\end{tabular}\n\n\n\n\n\n\n\\section{Binary square words and permutations}\n\\label{section:Binary square words and permutations}\nIn this section, we shall show that the square binary words are in\none-to-one correspondence with square permutations avoiding some\npatterns. This property establishes a link between the shuffle of binary\nwords and our shuffle of permutations and allows to obtain a new\ndescription of square binary words.\n\nLet $u$ be a binary word of length $n$ with $k$ occurrences of $0$.\nWe denote by ${\\operatorname{\\mathrm{btp}}}$ (Binary word To Permutation) the map sending\nany such word $u$ to the permutation obtained by replacing from left to\nright each occurrence of $0$ in $u$ by $1$, $2$, \\dots, $k$, and from\nright to left each occurrence of $1$ in $u$ by $k + 1$, $k + 2$, \\dots, $n$.\nFor instance,\n\n", "index": 17, "text": "\\begin{equation}\n    {\\operatorname{\\mathrm{btp}}}({\\bf 1}00{\\bf 1}0{\\bf 1}{\\bf 1}0{\\bf 1}000) =\n    {\\bf C} 12 {\\bf B} 3 {\\bf A} {\\bf 9} 4 {\\bf 8} 567,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m1\" class=\"ltx_Math\" alttext=\"{\\operatorname{\\mathrm{btp}}}({\\bf 1}00{\\bf 1}0{\\bf 1}{\\bf 1}0{\\bf 1}000)={\\bf&#10;C%&#10;}12{\\bf B}3{\\bf A}{\\bf 9}4{\\bf 8}567,\" display=\"block\"><mrow><mrow><mrow><mo>btp</mo><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mn>100101101000</mn><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mi>\ud835\udc02</mi><mo>\u2062</mo><mn>12</mn><mo>\u2062</mo><mi>\ud835\udc01</mi><mo>\u2062</mo><mn>3</mn><mo>\u2062</mo><mi>\ud835\udc00\ud835\udfd7\ud835\udfd2\ud835\udfd6</mi><mo>\u2062</mo><mn>567</mn></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05962.tex", "nexttext": "\nAccording to\nProposition~\\ref{prop:bijection_binary_to_permutations_squares}, this\nis also the sequence enumerating square permutations avoiding $213$\nand $231$.\n\n\n\n\n\n\n\\section{Algebraic issues}\n\\label{section:Algebraic issues}\nThe aim of this section is to establish some of properties of the\nshuffle product of permutations ${\\operatorname{\\bullet}}$. It is worth to note that, as\nwe will see, algebraic properties of the unshuffling coproduct $\\Delta$\nof permutations defined in\nSection~\\ref{section:Shuffle product on permutations} lead to\ncombinatorial properties of ${\\operatorname{\\bullet}}$.\n\n\\begin{proposition} \\label{prop:shuffle_associative_commutative}\n    The shuffle product ${\\operatorname{\\bullet}}$ of permutations is associative and\n    commutative.\n\\end{proposition}\n\\begin{proof}[of Proposition~\\ref{prop:shuffle_associative_commutative}]\n    To prove the associativity of ${\\operatorname{\\bullet}}$, it is convenient to show\n    that its dual coproduct $\\Delta$ is coassociative, that is\n    \n", "itemtype": "equation", "pos": 25850, "prevtext": "\nwhere $\\mathrm{A}$, $\\mathrm{B}$, and $\\mathrm{C}$ respectively stand\nfor $10$, $11$, and $12$. Observe that for any nonempty permutation\n$\\pi$ in the image of ${\\operatorname{\\mathrm{btp}}}$, there is exactly one binary word $u$\nsuch that ${\\operatorname{\\mathrm{btp}}}(u0) = {\\operatorname{\\mathrm{btp}}}(u1) = \\pi$. In support of this\nobservation, when $\\pi$ has an even size, we denote by ${\\operatorname{\\mathrm{ptb}}}(\\pi)$\n(Permutation To Binary word) the word $ua$ such that $|ua|_0$ and $|ua|_1$\nare both even, where $a \\in \\{0, 1\\}$.\n\n\\begin{proposition} \\label{prop:bijection_binary_to_permutations_squares}\n    For any $n \\geq 0$, the map ${\\operatorname{\\mathrm{btp}}}$ restricted to the set of\n    square binary words of length $2n$ is a bijection between this last\n    set and the set of square permutations of size $2n$ avoiding the\n    patterns $213$ and $231$.\n\\end{proposition}\n\\begin{proof}\n    [of Proposition~\\ref{prop:bijection_binary_to_permutations_squares}]\n    The statement of the proposition is a consequence of the\n    following claims implying that ${\\operatorname{\\mathrm{ptb}}}$ is the inverse\n    map of ${\\operatorname{\\mathrm{btp}}}$ over the set of square binary words.\n    \\begin{claim} \\label{claim:binary_to_permutation_avoiding}\n        The image of ${\\operatorname{\\mathrm{btp}}}$ is the set of all permutations\n        avoiding $213$ and $231$.\n    \\end{claim}\n    \\begin{proof}[of Claim~\\ref{claim:binary_to_permutation_avoiding}]\n        Let us first show that the image of ${\\operatorname{\\mathrm{btp}}}$ contains only\n        permutations avoiding $213$ and $231$. Let $u$ be a binary word,\n        $\\pi = {\\operatorname{\\mathrm{btp}}}(u)$, and $P_0$ (resp. $P_1$) be the set of the\n        positions of the occurrences of $0$ (resp. $1$) in $u$. By\n        definition of ${\\operatorname{\\mathrm{btp}}}$, from left to right, the subword\n        $v = \\pi_{|P_0}$ is increasing and the subword $w = \\pi_{|P_1}$\n        is decreasing, and all letters of $w$ are greater than those\n        of~$v$. Now, assume that $\\pi$ admits an occurrence of $213$.\n        Then, since $v$ is increasing and $w$ is decreasing, there is an\n        occurrence of $3$ (resp. $13$, $23$) in $v$ and a relative\n        occurrence of $21$ (resp. $2$, $1$). All these three cases\n        contradict the fact that all letters of $w$ are greater than\n        those of $v$. A similar argument shows that $\\pi$ avoids~$231$\n        as well.\n        \\smallskip\n\n        Finally, observe that any permutation $\\pi$ avoiding $213$ and\n        $231$ necessarily starts by the smallest possible letter or the\n        greatest possible letter. This property is then true for the\n        suffix of $\\pi$ obtained by deleting its first letter,\n        and so on for all of its suffixes. Thus, by\n        replacing each letter $a$ of $\\pi$ by $0$ (resp. $1$) if $a$ has the\n        role of a smallest (resp. greatest) letter, one obtains a binary\n        word $u$ such that ${\\operatorname{\\mathrm{btp}}}(u) = \\pi$. Hence, all permutations\n        avoiding $213$ and $231$ are in the image of ${\\operatorname{\\mathrm{btp}}}$.\n        \\qed\n    \\end{proof}\n\n    \\begin{claim} \\label{claim:square_binary_to_square_permutation}\n        If $u$ is a square binary word, ${\\operatorname{\\mathrm{btp}}}(u)$ is a square\n        permutation.\n    \\end{claim}\n    \\begin{proof}[of Claim~\\ref{claim:square_binary_to_square_permutation}]\n        Since $u$ is a square binary word, there is a binary word $v$\n        such that $u \\in v \\shuffle v$. Then, there are two disjoint\n        sets $P$ and $Q$ of positions of letters of $u$ such that\n        $u_{|P} = v = u_{|Q}$. Now, by definition of ${\\operatorname{\\mathrm{btp}}}$, the\n        words ${\\operatorname{\\mathrm{btp}}}(u)_{|P}$ and ${\\operatorname{\\mathrm{btp}}}(u)_{|Q}$ have the\n        same standardized $\\sigma$. Hence, and by definition of\n        the shuffle product of permutations, ${\\operatorname{\\mathrm{btp}}}(u)$ appears in\n        $\\sigma {\\operatorname{\\bullet}} \\sigma$, showing that ${\\operatorname{\\mathrm{btp}}}(u)$ is a\n        square permutation.\n        \\qed\n    \\end{proof}\n\n    \\begin{claim} \\label{claim:square_permutation_to_square_binary}\n        If $\\pi$ is a square permutation avoiding $213$ and $231$,\n        ${\\operatorname{\\mathrm{ptb}}}(\\pi)$ is a square binary word.\n    \\end{claim}\n    \\begin{proof}[of Claim~\\ref{claim:square_permutation_to_square_binary}]\n        Let $\\pi$ be a square permutation avoiding $213$ and $231$. By\n        Claim~\\ref{claim:binary_to_permutation_avoiding}, $\\pi$ is in\n        the image of ${\\operatorname{\\mathrm{btp}}}$ and hence, $u = {\\operatorname{\\mathrm{ptb}}}(\\pi)$ is a\n        well-defined binary word. Since $\\pi$ is a square permutation,\n        there are two disjoint sets $P_1$ and $P_2$ of indexes of letters\n        of $\\pi$ such that $\\pi_{|P_1}$ and $\\pi_{|P_2}$ are\n        order-isomorphic. This implies, by the definitions of ${\\operatorname{\\mathrm{btp}}}$\n        and ${\\operatorname{\\mathrm{ptb}}}$, that $u_{|P_1} = u_{|P_2}$, showing that $u$\n        is a square binary word.\n        \\qed\n    \\end{proof}\n    \\qed\n\\end{proof}\n\nThe number of square binary words is Sequence A191755 of~\\cite{Slo}\nbeginning by\n\n", "index": 19, "text": "\\begin{equation}\n1, 0, 2, 0, 6, 0, 22, 0, 82, 0, 320, 0, 1268, 0, 5102, 0, 020632.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E10.m1\" class=\"ltx_Math\" alttext=\"1,0,2,0,6,0,22,0,82,0,320,0,1268,0,5102,0,020632.\" display=\"block\"><mrow><mrow><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>6</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>22</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>82</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>320</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1268</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>5102</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>020632</mn></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05962.tex", "nexttext": "\n    where $I$ denotes the identity map. This strategy relies on the fact\n    that a product is associative if and only if its dual coproduct is\n    coassociative. For any permutation $\\pi$, we have\n    \n", "itemtype": "equation", "pos": 26962, "prevtext": "\nAccording to\nProposition~\\ref{prop:bijection_binary_to_permutations_squares}, this\nis also the sequence enumerating square permutations avoiding $213$\nand $231$.\n\n\n\n\n\n\n\\section{Algebraic issues}\n\\label{section:Algebraic issues}\nThe aim of this section is to establish some of properties of the\nshuffle product of permutations ${\\operatorname{\\bullet}}$. It is worth to note that, as\nwe will see, algebraic properties of the unshuffling coproduct $\\Delta$\nof permutations defined in\nSection~\\ref{section:Shuffle product on permutations} lead to\ncombinatorial properties of ${\\operatorname{\\bullet}}$.\n\n\\begin{proposition} \\label{prop:shuffle_associative_commutative}\n    The shuffle product ${\\operatorname{\\bullet}}$ of permutations is associative and\n    commutative.\n\\end{proposition}\n\\begin{proof}[of Proposition~\\ref{prop:shuffle_associative_commutative}]\n    To prove the associativity of ${\\operatorname{\\bullet}}$, it is convenient to show\n    that its dual coproduct $\\Delta$ is coassociative, that is\n    \n", "index": 21, "text": "\\begin{equation}\n        (\\Delta \\otimes I) \\Delta = (I \\otimes \\Delta) \\Delta,\n    \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E11.m1\" class=\"ltx_Math\" alttext=\"(\\Delta\\otimes I)\\Delta=(I\\otimes\\Delta)\\Delta,\" display=\"block\"><mrow><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2297</mo><mi>I</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi mathvariant=\"normal\">\u0394</mi></mrow><mo>=</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>I</mi><mo>\u2297</mo><mi mathvariant=\"normal\">\u0394</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi mathvariant=\"normal\">\u0394</mi></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05962.tex", "nexttext": "\n    An analogous computation shows that $(I \\otimes \\Delta) \\Delta(\\pi)$\n    is equal to the last member\n    of~\\eqref{equ:shuffle_associative_commutative}, whence the\n    associativity of ${\\operatorname{\\bullet}}$.\n    \\smallskip\n\n    Finally, to prove the commutativity of ${\\operatorname{\\bullet}}$, we shall show\n    that $\\Delta$ is cocommutative, that is for any permutation $\\pi$,\n    if in the expansion of $\\Delta(\\pi)$ there is a tensor\n    $\\sigma \\otimes \\nu$ with a coefficient $\\lambda$, there is in the\n    same expansion the tensor $\\nu \\otimes \\sigma$ with the same\n    coefficient $\\lambda$. Clearly, a product is commutative if and only\n    if its dual coproduct is cocommutative. Now, from the\n    definition~\\eqref{equ:unshuffling_coproduct} of $\\Delta$, one\n    observes that if the pair $(P_1, P_2)$ of subsets of $[|\\pi|]$\n    contributes to the coefficient of\n    ${\\operatorname{\\mathrm{s}}}\\left(\\pi_{|P_1}\\right) \\otimes {\\operatorname{\\mathrm{s}}}\\left(\\pi_{|P_2}\\right)$,\n    the pair $(P_2, P_1)$ contributes to the coefficient of\n    ${\\operatorname{\\mathrm{s}}}\\left(\\pi_{|P_2}\\right) \\otimes {\\operatorname{\\mathrm{s}}}\\left(\\pi_{|P_1}\\right)$.\n    This shows that $\\Delta$ is cocommutative and hence, that ${\\operatorname{\\bullet}}$\n    is commutative.\n    \\qed\n\\end{proof}\n\nProposition~\\ref{prop:shuffle_associative_commutative} implies that\n${\\operatorname{\\mathbb{Q}}}[S]$ endowed with the unshuffling coproduct $\\Delta$ is a\ncoassociative cocommutative coalgebra, or in an equivalent way, that\n${\\operatorname{\\mathbb{Q}}}[S]$ endowed with the shuffle product ${\\operatorname{\\bullet}}$ is an associative\ncommutative algebra.\n\n\\begin{lemma} \\label{lem:endomorphisms}\n    The three linear maps\n    \n", "itemtype": "equation", "pos": 27263, "prevtext": "\n    where $I$ denotes the identity map. This strategy relies on the fact\n    that a product is associative if and only if its dual coproduct is\n    coassociative. For any permutation $\\pi$, we have\n    \n", "index": 23, "text": "\\begin{equation} \\begin{split}\n    \\label{equ:shuffle_associative_commutative}\n        (\\Delta \\otimes I) \\Delta(\\pi) & =\n        (\\Delta \\otimes I)\n        \\sum_{P_1 \\sqcup P_2 = [|\\pi|]}\n        {\\operatorname{\\mathrm{s}}}\\left(\\pi_{|P_1}\\right) \\otimes {\\operatorname{\\mathrm{s}}}\\left(\\pi_{|P_2}\\right) \\\\\n        & =\n        \\sum_{P_1 \\sqcup P_2 = [|\\pi|]}\n        \\Delta\\left({\\operatorname{\\mathrm{s}}}\\left(\\pi_{|P_1}\\right)\\right)\n        \\otimes I\\left({\\operatorname{\\mathrm{s}}}\\left(\\pi_{|P_2}\\right)\\right) \\\\\n        & =\n        \\sum_{P_1 \\sqcup P_2 = [|\\pi|]} \\;\n        \\sum_{Q_1 \\sqcup Q_2 = [|P_1|]}\n        {\\operatorname{\\mathrm{s}}}\\left({\\operatorname{\\mathrm{s}}}\\left(\\pi_{|P_1}\\right)_{|Q_1}\\right)\n        \\otimes\n        {\\operatorname{\\mathrm{s}}}\\left({\\operatorname{\\mathrm{s}}}\\left(\\pi_{|P_1}\\right)_{|Q_2}\\right)\n        \\otimes {\\operatorname{\\mathrm{s}}}\\left(\\pi_{|P_2}\\right) \\\\\n        & =\n        \\sum_{P_1 \\sqcup P_2 \\sqcup P_3 = [|\\pi|]}\n        {\\operatorname{\\mathrm{s}}}\\left(\\pi_{|P_1}\\right) \\otimes\n        {\\operatorname{\\mathrm{s}}}\\left(\\pi_{|P_2}\\right) \\otimes\n        {\\operatorname{\\mathrm{s}}}\\left(\\pi_{|P_3}\\right).\n    \\end{split} \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E12.m1\" class=\"ltx_Math\" alttext=\"\\begin{split}\\displaystyle(\\Delta\\otimes I)\\Delta(\\pi)&amp;\\displaystyle=(\\Delta%&#10;\\otimes I)\\sum_{P_{1}\\sqcup P_{2}=[|\\pi|]}{\\operatorname{\\mathrm{s}}}\\left(\\pi%&#10;_{|P_{1}}\\right)\\otimes{\\operatorname{\\mathrm{s}}}\\left(\\pi_{|P_{2}}\\right)\\\\&#10;&amp;\\displaystyle=\\sum_{P_{1}\\sqcup P_{2}=[|\\pi|]}\\Delta\\left({\\operatorname{%&#10;\\mathrm{s}}}\\left(\\pi_{|P_{1}}\\right)\\right)\\otimes I\\left({\\operatorname{%&#10;\\mathrm{s}}}\\left(\\pi_{|P_{2}}\\right)\\right)\\\\&#10;&amp;\\displaystyle=\\sum_{P_{1}\\sqcup P_{2}=[|\\pi|]}\\;\\sum_{Q_{1}\\sqcup Q_{2}=[|P_{%&#10;1}|]}{\\operatorname{\\mathrm{s}}}\\left({\\operatorname{\\mathrm{s}}}\\left(\\pi_{|P%&#10;_{1}}\\right)_{|Q_{1}}\\right)\\otimes{\\operatorname{\\mathrm{s}}}\\left({%&#10;\\operatorname{\\mathrm{s}}}\\left(\\pi_{|P_{1}}\\right)_{|Q_{2}}\\right)\\otimes{%&#10;\\operatorname{\\mathrm{s}}}\\left(\\pi_{|P_{2}}\\right)\\\\&#10;&amp;\\displaystyle=\\sum_{P_{1}\\sqcup P_{2}\\sqcup P_{3}=[|\\pi|]}{\\operatorname{%&#10;\\mathrm{s}}}\\left(\\pi_{|P_{1}}\\right)\\otimes{\\operatorname{\\mathrm{s}}}\\left(%&#10;\\pi_{|P_{2}}\\right)\\otimes{\\operatorname{\\mathrm{s}}}\\left(\\pi_{|P_{3}}\\right)%&#10;.\\end{split}\" display=\"block\"><mtable columnspacing=\"0pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"right\"><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2297</mo><mi>I</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c0</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"left\"><mrow><mi/><mo>=</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2297</mo><mi>I</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mrow><msub><mi>P</mi><mn>1</mn></msub><mo>\u2294</mo><msub><mi>P</mi><mn>2</mn></msub></mrow><mo>=</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mo stretchy=\"false\">|</mo><mi>\u03c0</mi><mo stretchy=\"false\">|</mo></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></munder><mrow><mrow><mo>s</mo><mo>\u2061</mo><mrow><mo>(</mo><msub><mi>\u03c0</mi><mrow><mo stretchy=\"false\">|</mo><msub><mi>P</mi><mn>1</mn></msub></mrow></msub><mo>)</mo></mrow></mrow><mo>\u2297</mo><mrow><mo>s</mo><mo>\u2061</mo><mrow><mo>(</mo><msub><mi>\u03c0</mi><mrow><mo stretchy=\"false\">|</mo><msub><mi>P</mi><mn>2</mn></msub></mrow></msub><mo>)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mi/><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mrow><msub><mi>P</mi><mn>1</mn></msub><mo>\u2294</mo><msub><mi>P</mi><mn>2</mn></msub></mrow><mo>=</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mo stretchy=\"false\">|</mo><mi>\u03c0</mi><mo stretchy=\"false\">|</mo></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></munder><mrow><mrow><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><mrow><mo>(</mo><mrow><mo>s</mo><mo>\u2061</mo><mrow><mo>(</mo><msub><mi>\u03c0</mi><mrow><mo stretchy=\"false\">|</mo><msub><mi>P</mi><mn>1</mn></msub></mrow></msub><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow><mo>\u2297</mo><mi>I</mi></mrow><mo>\u2062</mo><mrow><mo>(</mo><mrow><mo>s</mo><mo>\u2061</mo><mrow><mo>(</mo><msub><mi>\u03c0</mi><mrow><mo stretchy=\"false\">|</mo><msub><mi>P</mi><mn>2</mn></msub></mrow></msub><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mo>=</mo><mpadded width=\"+2.8pt\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mrow><msub><mi>P</mi><mn>1</mn></msub><mo>\u2294</mo><msub><mi>P</mi><mn>2</mn></msub></mrow><mo>=</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mo stretchy=\"false\">|</mo><mi>\u03c0</mi><mo stretchy=\"false\">|</mo></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></munder></mpadded><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mrow><msub><mi>Q</mi><mn>1</mn></msub><mo>\u2294</mo><msub><mi>Q</mi><mn>2</mn></msub></mrow><mo>=</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mo stretchy=\"false\">|</mo><msub><mi>P</mi><mn>1</mn></msub><mo stretchy=\"false\">|</mo></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></munder><mo>s</mo><mrow><mo>(</mo><mo>s</mo><msub><mrow><mo>(</mo><msub><mi>\u03c0</mi><mrow><mo stretchy=\"false\">|</mo><msub><mi>P</mi><mn>1</mn></msub></mrow></msub><mo>)</mo></mrow><mrow><mo stretchy=\"false\">|</mo><msub><mi>Q</mi><mn>1</mn></msub></mrow></msub><mo>)</mo></mrow><mo>\u2297</mo><mo>s</mo><mrow><mo>(</mo><mo>s</mo><msub><mrow><mo>(</mo><msub><mi>\u03c0</mi><mrow><mo stretchy=\"false\">|</mo><msub><mi>P</mi><mn>1</mn></msub></mrow></msub><mo>)</mo></mrow><mrow><mo stretchy=\"false\">|</mo><msub><mi>Q</mi><mn>2</mn></msub></mrow></msub><mo>)</mo></mrow><mo>\u2297</mo><mo>s</mo><mrow><mo>(</mo><msub><mi>\u03c0</mi><mrow><mo stretchy=\"false\">|</mo><msub><mi>P</mi><mn>2</mn></msub></mrow></msub><mo>)</mo></mrow></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mrow><mi/><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mrow><msub><mi>P</mi><mn>1</mn></msub><mo>\u2294</mo><msub><mi>P</mi><mn>2</mn></msub><mo>\u2294</mo><msub><mi>P</mi><mn>3</mn></msub></mrow><mo>=</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mo stretchy=\"false\">|</mo><mi>\u03c0</mi><mo stretchy=\"false\">|</mo></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></munder><mrow><mrow><mo>s</mo><mo>\u2061</mo><mrow><mo>(</mo><msub><mi>\u03c0</mi><mrow><mo stretchy=\"false\">|</mo><msub><mi>P</mi><mn>1</mn></msub></mrow></msub><mo>)</mo></mrow></mrow><mo>\u2297</mo><mrow><mo>s</mo><mo>\u2061</mo><mrow><mo>(</mo><msub><mi>\u03c0</mi><mrow><mo stretchy=\"false\">|</mo><msub><mi>P</mi><mn>2</mn></msub></mrow></msub><mo>)</mo></mrow></mrow><mo>\u2297</mo><mrow><mo>s</mo><mo>\u2061</mo><mrow><mo>(</mo><msub><mi>\u03c0</mi><mrow><mo stretchy=\"false\">|</mo><msub><mi>P</mi><mn>3</mn></msub></mrow></msub><mo>)</mo></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.05962.tex", "nexttext": "\n    linearly sending a permutation $\\pi$ to, respectively,\n    $\\widetilde{\\pi}$, $\\bar \\pi$, and $\\pi^{-1}$ are endomorphims of\n    associative algebras.\n\\end{lemma}\n\nWe now use the algebraic properties of ${\\operatorname{\\bullet}}$ exhibited by\nLemma~\\ref{lem:endomorphisms} to obtain combinatorial properties\nof square permutations.\n\n\\begin{proposition} \\label{prop:square_stability}\n    Let $\\pi$ be a square permutation and $\\sigma$ be a square root of\n    $\\pi$. Then,\n    \\begin{enumerate}[label={\\it (\\roman*)},fullwidth]\n        \\item \\label{item:square_stability_1}\n        the permutation $\\widetilde{\\pi}$ is a square and\n        $\\widetilde{\\sigma}$ is one of its square roots;\n        \\item \\label{item:square_stability_2}\n        the permutation $\\bar \\pi$ is a square and $\\bar \\sigma$ is one of\n        its square roots;\n        \\item \\label{item:square_stability_3}\n        the permutation $\\pi^{-1}$ is a square and $\\sigma^{-1}$ is one of\n        its square roots.\n    \\end{enumerate}\n\\end{proposition}\n\\begin{proof}[of Proposition~\\ref{prop:square_stability}]\n    All statements~\\ref{item:square_stability_1},\n    \\ref{item:square_stability_2}, and~\\ref{item:square_stability_3} are\n    consequences of Lemma~\\ref{lem:endomorphisms}. Indeed,\n    since $\\pi$ is a square permutation and $\\sigma$ is a square root of\n    $\\pi$, by definition, $\\pi$ appears in the product\n    $\\sigma {\\operatorname{\\bullet}} \\sigma$. Now, by Lemma~\\ref{lem:endomorphisms},\n    for any $j = 1, 2, 3$, since $\\phi_j$ is a morphism of associative\n    algebras from ${\\operatorname{\\mathbb{Q}}}[S]$ to ${\\operatorname{\\mathbb{Q}}}[S]$, $\\phi_j$ commutes with the\n    shuffle product of permutations ${\\operatorname{\\bullet}}$. Hence, in particular,\n    one has\n    \n", "itemtype": "equation", "pos": 30205, "prevtext": "\n    An analogous computation shows that $(I \\otimes \\Delta) \\Delta(\\pi)$\n    is equal to the last member\n    of~\\eqref{equ:shuffle_associative_commutative}, whence the\n    associativity of ${\\operatorname{\\bullet}}$.\n    \\smallskip\n\n    Finally, to prove the commutativity of ${\\operatorname{\\bullet}}$, we shall show\n    that $\\Delta$ is cocommutative, that is for any permutation $\\pi$,\n    if in the expansion of $\\Delta(\\pi)$ there is a tensor\n    $\\sigma \\otimes \\nu$ with a coefficient $\\lambda$, there is in the\n    same expansion the tensor $\\nu \\otimes \\sigma$ with the same\n    coefficient $\\lambda$. Clearly, a product is commutative if and only\n    if its dual coproduct is cocommutative. Now, from the\n    definition~\\eqref{equ:unshuffling_coproduct} of $\\Delta$, one\n    observes that if the pair $(P_1, P_2)$ of subsets of $[|\\pi|]$\n    contributes to the coefficient of\n    ${\\operatorname{\\mathrm{s}}}\\left(\\pi_{|P_1}\\right) \\otimes {\\operatorname{\\mathrm{s}}}\\left(\\pi_{|P_2}\\right)$,\n    the pair $(P_2, P_1)$ contributes to the coefficient of\n    ${\\operatorname{\\mathrm{s}}}\\left(\\pi_{|P_2}\\right) \\otimes {\\operatorname{\\mathrm{s}}}\\left(\\pi_{|P_1}\\right)$.\n    This shows that $\\Delta$ is cocommutative and hence, that ${\\operatorname{\\bullet}}$\n    is commutative.\n    \\qed\n\\end{proof}\n\nProposition~\\ref{prop:shuffle_associative_commutative} implies that\n${\\operatorname{\\mathbb{Q}}}[S]$ endowed with the unshuffling coproduct $\\Delta$ is a\ncoassociative cocommutative coalgebra, or in an equivalent way, that\n${\\operatorname{\\mathbb{Q}}}[S]$ endowed with the shuffle product ${\\operatorname{\\bullet}}$ is an associative\ncommutative algebra.\n\n\\begin{lemma} \\label{lem:endomorphisms}\n    The three linear maps\n    \n", "index": 25, "text": "\\begin{equation}\n        \\phi_1, \\phi_2, \\phi_3 : {\\operatorname{\\mathbb{Q}}}[S] \\to {\\operatorname{\\mathbb{Q}}}[S]\n    \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E13.m1\" class=\"ltx_Math\" alttext=\"\\phi_{1},\\phi_{2},\\phi_{3}:{\\operatorname{\\mathbb{Q}}}[S]\\to{\\operatorname{%&#10;\\mathbb{Q}}}[S]\" display=\"block\"><mrow><mrow><msub><mi>\u03d5</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\u03d5</mi><mn>2</mn></msub><mo>,</mo><msub><mi>\u03d5</mi><mn>3</mn></msub></mrow><mo>:</mo><mrow><mrow><mo>\u211a</mo><mo>\u2061</mo><mrow><mo stretchy=\"false\">[</mo><mi>S</mi><mo stretchy=\"false\">]</mo></mrow></mrow><mo>\u2192</mo><mrow><mo>\u211a</mo><mo>\u2061</mo><mrow><mo stretchy=\"false\">[</mo><mi>S</mi><mo stretchy=\"false\">]</mo></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.05962.tex", "nexttext": "\n    Then, since $\\pi$ appears in $\\sigma {\\operatorname{\\bullet}} \\sigma$, $\\phi_j(\\pi)$\n    appears in $\\phi_j(\\sigma {\\operatorname{\\bullet}} \\sigma)$ and appears also in\n    $\\phi_j(\\sigma) {\\operatorname{\\bullet}} \\phi_j(\\sigma)$. This shows that\n    $\\phi_j(\\sigma)$ is a square root of $\\phi_j(\\pi)$ and\n    implies~\\ref{item:square_stability_1}, \\ref{item:square_stability_2},\n    and~\\ref{item:square_stability_3}.\n    \\qed\n\\end{proof}\n\nLet us make an observation about Wilf-equivalence classes of permutations\nrestrained on square permutations. Recall that two permutations $\\sigma$\nand $\\nu$ of the same size are {\\em Wilf equivalent} if\n$\\# S_n(\\sigma) = \\# S_n(\\nu)$ for all $n \\geq 0$. The\nwell-known~\\cite{Simion:Schmidt:EJC:1985} fact that there is a single\nWilf-equivalence class of permutations of size $3$ together with\nProposition~\\ref{prop:square_stability} imply that $123$ and $321$ are\nin the same Wilf-equivalence class of square permutations, and that\n$132$, $213$, $231$, and $312$ are in the same Wilf-equivalence class of\nsquare permutations. Computer experiments show us that there are two\nWilf-equivalence classes of square permutations of size $3$. Indeed, the\nnumber of square permutations avoiding $123$ begins by\n\n", "itemtype": "equation", "pos": 32104, "prevtext": "\n    linearly sending a permutation $\\pi$ to, respectively,\n    $\\widetilde{\\pi}$, $\\bar \\pi$, and $\\pi^{-1}$ are endomorphims of\n    associative algebras.\n\\end{lemma}\n\nWe now use the algebraic properties of ${\\operatorname{\\bullet}}$ exhibited by\nLemma~\\ref{lem:endomorphisms} to obtain combinatorial properties\nof square permutations.\n\n\\begin{proposition} \\label{prop:square_stability}\n    Let $\\pi$ be a square permutation and $\\sigma$ be a square root of\n    $\\pi$. Then,\n    \\begin{enumerate}[label={\\it (\\roman*)},fullwidth]\n        \\item \\label{item:square_stability_1}\n        the permutation $\\widetilde{\\pi}$ is a square and\n        $\\widetilde{\\sigma}$ is one of its square roots;\n        \\item \\label{item:square_stability_2}\n        the permutation $\\bar \\pi$ is a square and $\\bar \\sigma$ is one of\n        its square roots;\n        \\item \\label{item:square_stability_3}\n        the permutation $\\pi^{-1}$ is a square and $\\sigma^{-1}$ is one of\n        its square roots.\n    \\end{enumerate}\n\\end{proposition}\n\\begin{proof}[of Proposition~\\ref{prop:square_stability}]\n    All statements~\\ref{item:square_stability_1},\n    \\ref{item:square_stability_2}, and~\\ref{item:square_stability_3} are\n    consequences of Lemma~\\ref{lem:endomorphisms}. Indeed,\n    since $\\pi$ is a square permutation and $\\sigma$ is a square root of\n    $\\pi$, by definition, $\\pi$ appears in the product\n    $\\sigma {\\operatorname{\\bullet}} \\sigma$. Now, by Lemma~\\ref{lem:endomorphisms},\n    for any $j = 1, 2, 3$, since $\\phi_j$ is a morphism of associative\n    algebras from ${\\operatorname{\\mathbb{Q}}}[S]$ to ${\\operatorname{\\mathbb{Q}}}[S]$, $\\phi_j$ commutes with the\n    shuffle product of permutations ${\\operatorname{\\bullet}}$. Hence, in particular,\n    one has\n    \n", "index": 27, "text": "\\begin{equation}\n        \\phi_j(\\sigma {\\operatorname{\\bullet}} \\sigma) =\n        \\phi_j(\\sigma) {\\operatorname{\\bullet}} \\phi_j(\\sigma).\n    \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14.m1\" class=\"ltx_Math\" alttext=\"\\phi_{j}(\\sigma{\\operatorname{\\bullet}}\\sigma)=\\phi_{j}(\\sigma){\\operatorname{%&#10;\\bullet}}\\phi_{j}(\\sigma).\" display=\"block\"><mrow><mrow><mrow><msub><mi>\u03d5</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03c3</mi><mo>\u2062</mo><mrow><mo>\u2219</mo><mo>\u2061</mo><mi>\u03c3</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><msub><mi>\u03d5</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c3</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>\u2219</mo><mo>\u2061</mo><msub><mi>\u03d5</mi><mi>j</mi></msub></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c3</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05962.tex", "nexttext": "\nwhile the number of square permutations avoiding $132$ begins by\n\n", "itemtype": "equation", "pos": 33508, "prevtext": "\n    Then, since $\\pi$ appears in $\\sigma {\\operatorname{\\bullet}} \\sigma$, $\\phi_j(\\pi)$\n    appears in $\\phi_j(\\sigma {\\operatorname{\\bullet}} \\sigma)$ and appears also in\n    $\\phi_j(\\sigma) {\\operatorname{\\bullet}} \\phi_j(\\sigma)$. This shows that\n    $\\phi_j(\\sigma)$ is a square root of $\\phi_j(\\pi)$ and\n    implies~\\ref{item:square_stability_1}, \\ref{item:square_stability_2},\n    and~\\ref{item:square_stability_3}.\n    \\qed\n\\end{proof}\n\nLet us make an observation about Wilf-equivalence classes of permutations\nrestrained on square permutations. Recall that two permutations $\\sigma$\nand $\\nu$ of the same size are {\\em Wilf equivalent} if\n$\\# S_n(\\sigma) = \\# S_n(\\nu)$ for all $n \\geq 0$. The\nwell-known~\\cite{Simion:Schmidt:EJC:1985} fact that there is a single\nWilf-equivalence class of permutations of size $3$ together with\nProposition~\\ref{prop:square_stability} imply that $123$ and $321$ are\nin the same Wilf-equivalence class of square permutations, and that\n$132$, $213$, $231$, and $312$ are in the same Wilf-equivalence class of\nsquare permutations. Computer experiments show us that there are two\nWilf-equivalence classes of square permutations of size $3$. Indeed, the\nnumber of square permutations avoiding $123$ begins by\n\n", "index": 29, "text": "\\begin{equation} \\label{equ:sequence_square_123}\n    1, 0, 2, 0, 12, 0, 118, 0, 1218, 0, 14272,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E15.m1\" class=\"ltx_Math\" alttext=\"1,0,2,0,12,0,118,0,1218,0,14272,\" display=\"block\"><mrow><mrow><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>12</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>118</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1218</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>14272</mn></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05962.tex", "nexttext": "\n\nBesides, an other consequence of Proposition~\\ref{prop:square_stability}\nis that its makes sense to enumerate the sets of square permutations\nquotiented by the operations of mirror image, complement, and\ninverse. The sequence enumerating these sets begins by\n\n", "itemtype": "equation", "pos": 33684, "prevtext": "\nwhile the number of square permutations avoiding $132$ begins by\n\n", "index": 31, "text": "\\begin{equation} \\label{equ:sequence_square_132}\n    1, 0, 2, 0, 11, 0, 84, 0, 743, 0, 7108.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E16.m1\" class=\"ltx_Math\" alttext=\"1,0,2,0,11,0,84,0,743,0,7108.\" display=\"block\"><mrow><mrow><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>11</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>84</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>743</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>7108</mn></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05962.tex", "nexttext": "\n\nAll Sequences~\\eqref{equ:sequence_square_123}, \\eqref{equ:sequence_square_132},\nand~\\eqref{equ:sequence_square_classes} (and their subsequences obtained\nby removing the $0$s) are for the time being not listed in~\\cite{Slo}.\n\n\n\n\n\n\n\\section{Algorithmic issues}\n\\label{section:Algorithmic issues}\n\nThis section is devoted to proving hardness of recognizing square\npermutations. In the same way as happens with words, we shall use a\nlinear graph framework where deciding whether a permutation is a square\nreduces to computing some specific matching in the associated linear\ngraph~\\cite{Buss:Soltys:2014,Rizzi:Vialette:CSR:2013}. It reads as follows\n(see Fig.\\ref{fig:example containment-free matching}).\n\\begin{figure}[ht!]\n  \\centering\n  \\begin{tikzpicture}[scale=0.5,inner sep=2pt,node distance=1cm]\n    \\draw node (K) {$K_\\pi$};\n    \\draw node [draw, circle, minimum size=.55cm, fill=black!10] [right of=K]   (U01) {$2$};\n    \\draw node [draw, circle, minimum size=.55cm, fill=black!10] [right of=U01] (U02) {$A$};\n    \\draw node [draw, circle, minimum size=.55cm] [right of=U02] (U03) {$4$};\n    \\draw node [draw, circle, minimum size=.55cm, fill=black!10] [right of=U03] (U04) {$7$};\n    \\draw node [draw, circle, minimum size=.55cm, fill=black!10] [right of=U04] (U05) {$1$};\n    \\draw node [draw, circle, minimum size=.55cm] [right of=U05] (U06) {$9$};\n    \\draw node [draw, circle, minimum size=.55cm] [right of=U06] (U07) {$5$};\n    \\draw node [draw, circle, minimum size=.55cm] [right of=U07] (U08) {$3$};\n    \\draw node [draw, circle, minimum size=.55cm, fill=black!10] [right of=U08] (U09) {$8$};\n    \\draw node [draw, circle, minimum size=.55cm] [right of=U09] (U10) {$6$};\n    \\draw [thick]\n      (U01.north) .. controls ($ (U01.north) + (0,2.25) $) and ($ (U03.north) + (0,2.25) $) .. (U03.north);\n    \\draw [thick]\n      (U02.north) .. controls ($ (U02.north) + (0,2.25) $) and ($ (U06.north) + (0,2.25) $) .. (U06.north);\n    \\draw [thick]\n      (U04.north) .. controls ($ (U04.north) + (0,2.5) $) and ($ (U07.north) + (0,2.5) $) .. (U07.north);\n    \\draw [thick]\n      (U05.north) .. controls ($ (U05.north) + (0,2.5) $) and ($ (U08.north) + (0,2.5) $) .. (U08.north);\n    \\draw [thick]\n      (U09.north) .. controls ($ (U09.north) + (0,2.5) $) and ($ (U10.north) + (0,2.5) $) .. (U10.north);\n  \\end{tikzpicture}\n  \\caption{\\label{fig:example containment-free matching}\n    The linear graph $K_\\pi$ associated with the permutation\n    $\\pi = 2A47195386$ together with\n    a containment-free perfect matching $\\mathcal{M}$\n    such that for any two distinct edges $(a, b)$ and\n    $(a', b')$ in $\\mathcal{M}$ we have $\\pi(a) < \\pi(a')$ if and only\n    if $\\pi(b) < \\pi(b')$.\n    From $\\mathcal{M}$, it follows that $\\pi$ is square as it is in\n    the shuffle of $2A718$ and $49536$, both being\n    order-isomorphic to $25314$.\n  }\n\\end{figure}\n\n\\begin{figure}[t!]\n  \\centering\n  \\subfigure[\n    An increasing pattern before and above a decreasing pattern.\n  ]{\n    \\begin{tikzpicture}\n      [\n        scale=0.325,\n        label/.style={anchor=base}\n      ]\n      \n      \\draw[step=1cm,black!30,ultra thin,fill=black!10] (-0.2,5.8) grid (5.2,11.2);\n      \\foreach \\x/\\y in {0/6,1/7,2/8,3/9,4/10,5/11} {\n          \\draw [fill=black] (\\x,\\y) circle (0.1);\n      }\n      \n      \\draw[step=1cm,black!30,ultra thin,fill=black!10] (5.8,-0.2) grid (11.2,5.2);\n      \\foreach \\x/\\y in {6/5,7/4,8/3,9/2,10/1,11/0} {\n          \\draw [fill=black] (\\x,\\y) circle (0.1);\n      }\n      \n      \\node [label] (a) at (1,5) {$a$};\n      \\node [label] (b) at (4,5) {$b$};\n      \\node [label] (ap) at (7,-1) {$a'$};\n      \\node [label] (bp) at (10,-1) {$b'$};\n      \\node (nu1) at (2.5,4) {$\\sigma_1$};\n      \\node (nu2) at (8.5,-2) {$\\sigma_2$};\n      \n      \\draw [line width=1pt]\n      (1,7) .. controls +(0,12) and +(0,10) .. (7,4);\n      \\draw [line width=1pt]\n      (4,10) .. controls +(0,12) and +(0,10) .. (10,1);\n    \\end{tikzpicture}\n    \\label{subfig:increasing before and above decreasing}\n  }\n  \\qquad\\qquad\\qquad\n  \\subfigure[\n    A decreasing pattern before and below an increasing pattern.\n  ]{\n  \\begin{tikzpicture}\n    [\n      scale=0.325,\n      label/.style={anchor=base}\n    ]\n    \n    \\draw[step=1cm,black!30,ultra thin,fill=black!10] (-0.2,-0.2) grid (5.2,5.2);\n    \\foreach \\x/\\y in {0/5,1/4,2/3,3/2,4/1,5/0} {\n        \\draw [fill=black] (\\x,\\y) circle (0.1);\n    }\n    \n    \\draw[step=1cm,black!30,ultra thin,fill=black!10] (5.8,5.8) grid (11.2,11.2);\n    \\foreach \\x/\\y in {6/6,7/7,8/8,9/9,10/10,11/11} {\n        \\draw [fill=black] (\\x,\\y) circle (0.1);\n    }\n    \n    \\node [label] (a) at (1,-1) {$a$};\n    \\node [label] (b) at (4,-1) {$b$};\n    \\node [label] (ap) at (7,5) {$a'$};\n    \\node [label] (bp) at (10,5) {$b'$};\n    \\node (nu1) at (2.5,-2) {$\\sigma_1$};\n    \\node (nu2) at (8.5,4) {$\\sigma_2$};\n    \n    \\draw [line width=1pt]\n    (1,4) .. controls +(0,10) and +(0,12) .. (7,7);\n    \\draw [line width=1pt]\n    (4,1) .. controls +(0,10) and +(0,12) .. (10,10);\n    \\end{tikzpicture}\n    \\label{subfig:decreasing before and below increasing}\n  }\n  \\caption{\\label{fig:subfig:no (nu_1, nu_2)-edge}\n    Illustration of Lemma~\\ref{lemma:at most one edge monotone}.\n  }\n\\end{figure}\n\n\\begin{lemma}\n  \\label{lemma:matching}\n  Let $\\pi$ be a permutation. The following statements are equivalent:\n  \\begin{enumerate}\n    \\item The permutation $\\pi$ is a square.\n    \\item There exists a perfect containment-free matching $\\mathcal{M}$\n    of $K_\\pi$ such that for any two distinct edges $(a, b)$ and\n    $(a', b')$ in $\\mathcal{M}$ we have $\\pi(a) < \\pi(a')$ if and only\n    if $\\pi(b) < \\pi(b')$.\n  \\end{enumerate}\n\\end{lemma}\n\nLet $\\pi$ be a permutation. For the sake of clarity, we will say that a\nbunch of consecutive positions $P$ of $\\pi$ is \\emph{above} (resp.\n\\emph{below}) above another bunch of consecutive positions $P'$ in $\\pi$\nif $\\pi(i) > \\pi(j)$ (resp. $\\pi(i) < \\pi(j)$) for every $i \\in P$ and\nevery $j \\in P'$. For example, $\\sigma_1$ is above $\\sigma_2$ (in an\nequivalent manner, $\\sigma_2$ is below $\\sigma_1$) in\nFig.~\\ref{subfig:increasing before and above decreasing}, whereas\n$\\sigma_1$ is below $\\sigma_2$ (in an equivalent manner, $\\sigma_2$ is\nabove $\\sigma_1$) in Fig.~\\ref{subfig:decreasing before and below\nincreasing}.\n\nBefore proving hardness, we give an easy lemma that will prove extremely\nuseful for simplifying the proof of upcoming\nProposition~\\ref{proposition:hardness}.\n\n\\begin{lemma}\n  \\label{lemma:at most one edge monotone}\n  Let $\\pi = \\pi_1 \\, \\sigma_1 \\, \\pi_2 \\, \\sigma_2 \\, \\pi_3$\n  be a permutation with $|\\sigma_1| \\geq 2$ and $|\\sigma_2| \\geq 2$,\n  and $\\mathcal{M}$ be a containment-free perfect matching of $K_\\pi$.\n  The following assertions hold:\n  \\begin{enumerate}\n    \\item\n    If $\\sigma_1$ is increasing, $\\sigma_2$ is decreasing, and\n    $\\sigma_1$ is above $\\sigma_2$ (see Fig.~\\ref{subfig:increasing before\n    and above decreasing}), then $\\mathcal{M}$ contains at most one\n    $(\\sigma_1, \\sigma_2)$-edge.\n    \\item\n    If $\\sigma_1$ is decreasing, $\\sigma_2$ is increasing, and $\\sigma_1$\n    is below $\\sigma_2$ (see Fig.~\\ref{subfig:decreasing before and below\n    increasing}), then $\\mathcal{M}$ contains at most one\n    $(\\sigma_1, \\sigma_2)$-edge.\n  \\end{enumerate}\n\\end{lemma}\n\n\\begin{proposition}\n  \\label{proposition:hardness}\n  Deciding whether a permutation is a square is {{\\sf\\bf NP}{\\text{-complete}}\\xspace}.\n\\end{proposition}\n\n\\begin{proof}[of Proposition~\\ref{proposition:hardness}]\n  The problem is certainly in ${{\\sf\\bf NP}\\xspace}$. We propose a reduction from\n  the pattern involvement problem which is known to be\n  {{\\sf\\bf NP}{\\text{-complete}}\\xspace}~\\cite{Bose:Buss:Lubiw:1998}: Given two permutations $\\pi$ and\n  $\\sigma$, decide whether $\\sigma$ occurs in $\\pi$ (as an\n  order-isomorphic pattern).\n\n  \\begin{figure}[t!]\n    \\centering\n    \\begin{tikzpicture}[\n      scale=.8,\n      >=stealth',\n      shorten >=1pt,\n      main node/.style={align=center},\n      cell/.style={draw,ultra thick,fill=black!5},\n      structure link/.style={line width=1.5pt},\n      pattern link/.style={line width=1.5pt,black!20},\n      monotone/.style={->,thick}\n      ]\n      \n      \n      \\draw [pattern link] (8.5,6) .. controls +(0,1) and +(0,2) .. (10.5,5);\n      \n      \\draw [pattern link] (10.5,5) .. controls +(0,1) and +(0,3) .. (11.5,4);\n      \n      \\draw [structure link] (0.5,11) .. controls +(0,2) and +(0,1) .. (2.5,12);\n      \n      \n      \n      \n      \\draw [structure link] (1.5,2) .. controls +(0,1) and +(0,3) .. (6.5,1);\n      \n      \n      \n      \n      \\draw [structure link] (3.5,9) .. controls +(0,3) and +(0,1.5) .. (7.5,10);\n      \n      \n      \n      \\draw [structure link] (5.5,8) .. controls +(0,1) and +(0,7) .. (9.5,3);\n      \n      \n      \n      \\draw [structure link] (4.5,6) .. controls +(0,-2) and +(0,-1) .. (8.5,5);\n      \n      \n      \n      \\draw [cell] (0,10) -- (1,10) -- (1,11) -- (0,11) -- cycle;\n      \\draw [monotone] (0,10) -- ++(1,1) node [midway,fill=white,fill=black!5] {$\\nu_1$};\n      \n      \\draw [cell] (2,11) -- (3,11) -- (3,12) -- (2,12) -- cycle;\n      \\draw [monotone] (2,11) -- ++(1,1) node [midway,fill=white,fill=black!5] {$\\nu'_1$};\n      \n      \\draw [cell] (1,1) -- (2,1) -- (2,2) -- (1,2) -- cycle;\n      \\draw [monotone] (1,2) -- ++(1,-1) node [midway,fill=white,fill=black!5] {$\\nu_2$};\n      \\draw [cell] (6,0) -- (7,0) -- (7,1) -- (6,1) -- cycle;\n      \\draw [monotone] (6,1) -- ++(1,-1) node [midway,fill=white,fill=black!5] {$\\nu'_2$};\n      \n      \\draw [cell] (3,8) -- (4,8) -- (4,9) -- (3,9) -- cycle;\n      \\draw [monotone] (3,8) -- ++(1,1) node [midway,fill=white,fill=black!5] {$\\nu_3$};\n      \\draw [cell] (7,9) -- (8,9) -- (8,10) -- (7,10) -- cycle;\n      \\draw [monotone] (7,9) -- ++(1,1) node [midway,fill=white,fill=black!5] {$\\nu'_3$};\n      \n      \\draw [cell] (5,7) -- (6,7) -- (6,8) -- (5,8) -- cycle;\n      \\draw [monotone] (5,8) -- ++(1,-1) node [midway,fill=white,fill=black!5] {$\\nu_4$};\n      \\draw [cell] (9,2) -- (10,2) -- (10,3) -- (9,3) -- cycle;\n      \\draw [monotone] (9,3) -- ++(1,-1) node [midway,fill=white,fill=black!5] {$\\nu'_4$};\n      \n      \\draw [cell] (4,6) -- (5,6) -- (5,7) -- (4,7) -- cycle;\n      \\node [main node] (sigma1) at (4.5,6.5) {$\\sigma'$};\n      \n      \\draw [cell] (8,5) -- (9,5) -- (9,6) -- (8,6) -- cycle;\n      \\node [main node] (pi1) at (8.5,5.5) {$\\pi'$};\n      \n      \\draw [cell] (10,4) -- (11,4) -- (11,5) -- (10,5) -- cycle;\n      \\node [main node] (sigma2) at (10.5,4.5) {$\\pi''$};\n      \n      \\draw [cell] (11,3) -- (12,3) -- (12,4) -- (11,4) -- cycle;\n      \\node [main node] (pi2) at (11.5,3.5) {$\\sigma''$};\n      \n      \\draw[step=1cm,black!30,thin,fill=black!10] (0,0) grid (12,12);\n      \n      \\foreach \\y/\\N in {0.5/N_2,1.5/N_2,2.5/N_4,3.5/k,4.5/n,5.5/n+2,6.5/k+2,7.5/N_4,8.5/N_3,9.5/N_3,10.5/N_1,11.4/N_1} {\n          \\node at (-0.5,\\y) (R\\y) {$\\N$};\n      }\n      \n      \\foreach \\x/\\N in\n      {0.5/N_1,1.5/N_2,2.5/N_1,3.5/N_3,4.5/k+2,5.5/N_4,6.5/N_2,7.5/N_3,8.5/n+2,9.5/N_4,10.5/n,11.5/k} {\n          \\node at (\\x,-0.5) (C\\x) {$\\N$};\n      }\n    \\end{tikzpicture}\n    \\caption{\\label{fig:reduction}\n      Schematic representation of the permutation $\\mu$ used\n      in Proposition~\\ref{proposition:hardness}.\n      Black edges denote the presence of at least one edge between two bunches of\n      vertices in $K_\\mu$.\n      Grey edges denote edges that are only considered in the forward direction of the\n      proof.\n    }\n  \\end{figure}\n\n  Let $\\pi \\in S_n$ and $\\sigma \\in S_k$ be two arbitrary permutations.\n  Define\n  \n  \n  \n  \n  \n  \n  $N_4 = 2(2n + 2k + 4) + 1  = 4n + 4k + 9$,\n  $N_3 = 2(2N_4 + 2n + 2k + 4) + 1 = 20n + 20k + 45$,\n  $N_2 = 2(2N_3 + 2N_4 + 2n + 2k + 4) + 1 = 100n + 100k + 225$ and\n  $N_1 = 2(2N_2 + 2N_3 + 2N_4 + 2n + 2k + 4) + 1 = 1000n + 1000k  + 1325$.\n  Notice that $N_1, N_2, N_3$ and $N_4$ are polynomial in $n$.\n  The crucial properties are that\n  (i) $N_1, N_2, N_3$ and $N_4$ are odd integers\n  and\n  (ii) $N_i > \\left(\\sum_{i < j \\leq 4} 2N_j\\right) + 2n + 2k + k$\n  for every $1 \\leq i \\leq 4$.\n\n  We now turn to defining various gadgets (sequences of integers)\n  that act as building blocks in our construction of a new permutation $\\mu$:\n  \n", "itemtype": "equation", "pos": 34052, "prevtext": "\n\nBesides, an other consequence of Proposition~\\ref{prop:square_stability}\nis that its makes sense to enumerate the sets of square permutations\nquotiented by the operations of mirror image, complement, and\ninverse. The sequence enumerating these sets begins by\n\n", "index": 33, "text": "\\begin{equation} \\label{equ:sequence_square_classes}\n    1, 0, 1, 0, 6, 0, 81, 0, 2774, 0, 162945.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E17.m1\" class=\"ltx_Math\" alttext=\"1,0,1,0,6,0,81,0,2774,0,162945.\" display=\"block\"><mrow><mrow><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>6</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>81</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>2774</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>162945</mn></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05962.tex", "nexttext": "\n  We are now in position to define our target permutation $\\mu$\n  (see Fig.~\\ref{fig:reduction} for an illustration):\n  \n", "itemtype": "equation", "pos": 46386, "prevtext": "\n\nAll Sequences~\\eqref{equ:sequence_square_123}, \\eqref{equ:sequence_square_132},\nand~\\eqref{equ:sequence_square_classes} (and their subsequences obtained\nby removing the $0$s) are for the time being not listed in~\\cite{Slo}.\n\n\n\n\n\n\n\\section{Algorithmic issues}\n\\label{section:Algorithmic issues}\n\nThis section is devoted to proving hardness of recognizing square\npermutations. In the same way as happens with words, we shall use a\nlinear graph framework where deciding whether a permutation is a square\nreduces to computing some specific matching in the associated linear\ngraph~\\cite{Buss:Soltys:2014,Rizzi:Vialette:CSR:2013}. It reads as follows\n(see Fig.\\ref{fig:example containment-free matching}).\n\\begin{figure}[ht!]\n  \\centering\n  \\begin{tikzpicture}[scale=0.5,inner sep=2pt,node distance=1cm]\n    \\draw node (K) {$K_\\pi$};\n    \\draw node [draw, circle, minimum size=.55cm, fill=black!10] [right of=K]   (U01) {$2$};\n    \\draw node [draw, circle, minimum size=.55cm, fill=black!10] [right of=U01] (U02) {$A$};\n    \\draw node [draw, circle, minimum size=.55cm] [right of=U02] (U03) {$4$};\n    \\draw node [draw, circle, minimum size=.55cm, fill=black!10] [right of=U03] (U04) {$7$};\n    \\draw node [draw, circle, minimum size=.55cm, fill=black!10] [right of=U04] (U05) {$1$};\n    \\draw node [draw, circle, minimum size=.55cm] [right of=U05] (U06) {$9$};\n    \\draw node [draw, circle, minimum size=.55cm] [right of=U06] (U07) {$5$};\n    \\draw node [draw, circle, minimum size=.55cm] [right of=U07] (U08) {$3$};\n    \\draw node [draw, circle, minimum size=.55cm, fill=black!10] [right of=U08] (U09) {$8$};\n    \\draw node [draw, circle, minimum size=.55cm] [right of=U09] (U10) {$6$};\n    \\draw [thick]\n      (U01.north) .. controls ($ (U01.north) + (0,2.25) $) and ($ (U03.north) + (0,2.25) $) .. (U03.north);\n    \\draw [thick]\n      (U02.north) .. controls ($ (U02.north) + (0,2.25) $) and ($ (U06.north) + (0,2.25) $) .. (U06.north);\n    \\draw [thick]\n      (U04.north) .. controls ($ (U04.north) + (0,2.5) $) and ($ (U07.north) + (0,2.5) $) .. (U07.north);\n    \\draw [thick]\n      (U05.north) .. controls ($ (U05.north) + (0,2.5) $) and ($ (U08.north) + (0,2.5) $) .. (U08.north);\n    \\draw [thick]\n      (U09.north) .. controls ($ (U09.north) + (0,2.5) $) and ($ (U10.north) + (0,2.5) $) .. (U10.north);\n  \\end{tikzpicture}\n  \\caption{\\label{fig:example containment-free matching}\n    The linear graph $K_\\pi$ associated with the permutation\n    $\\pi = 2A47195386$ together with\n    a containment-free perfect matching $\\mathcal{M}$\n    such that for any two distinct edges $(a, b)$ and\n    $(a', b')$ in $\\mathcal{M}$ we have $\\pi(a) < \\pi(a')$ if and only\n    if $\\pi(b) < \\pi(b')$.\n    From $\\mathcal{M}$, it follows that $\\pi$ is square as it is in\n    the shuffle of $2A718$ and $49536$, both being\n    order-isomorphic to $25314$.\n  }\n\\end{figure}\n\n\\begin{figure}[t!]\n  \\centering\n  \\subfigure[\n    An increasing pattern before and above a decreasing pattern.\n  ]{\n    \\begin{tikzpicture}\n      [\n        scale=0.325,\n        label/.style={anchor=base}\n      ]\n      \n      \\draw[step=1cm,black!30,ultra thin,fill=black!10] (-0.2,5.8) grid (5.2,11.2);\n      \\foreach \\x/\\y in {0/6,1/7,2/8,3/9,4/10,5/11} {\n          \\draw [fill=black] (\\x,\\y) circle (0.1);\n      }\n      \n      \\draw[step=1cm,black!30,ultra thin,fill=black!10] (5.8,-0.2) grid (11.2,5.2);\n      \\foreach \\x/\\y in {6/5,7/4,8/3,9/2,10/1,11/0} {\n          \\draw [fill=black] (\\x,\\y) circle (0.1);\n      }\n      \n      \\node [label] (a) at (1,5) {$a$};\n      \\node [label] (b) at (4,5) {$b$};\n      \\node [label] (ap) at (7,-1) {$a'$};\n      \\node [label] (bp) at (10,-1) {$b'$};\n      \\node (nu1) at (2.5,4) {$\\sigma_1$};\n      \\node (nu2) at (8.5,-2) {$\\sigma_2$};\n      \n      \\draw [line width=1pt]\n      (1,7) .. controls +(0,12) and +(0,10) .. (7,4);\n      \\draw [line width=1pt]\n      (4,10) .. controls +(0,12) and +(0,10) .. (10,1);\n    \\end{tikzpicture}\n    \\label{subfig:increasing before and above decreasing}\n  }\n  \\qquad\\qquad\\qquad\n  \\subfigure[\n    A decreasing pattern before and below an increasing pattern.\n  ]{\n  \\begin{tikzpicture}\n    [\n      scale=0.325,\n      label/.style={anchor=base}\n    ]\n    \n    \\draw[step=1cm,black!30,ultra thin,fill=black!10] (-0.2,-0.2) grid (5.2,5.2);\n    \\foreach \\x/\\y in {0/5,1/4,2/3,3/2,4/1,5/0} {\n        \\draw [fill=black] (\\x,\\y) circle (0.1);\n    }\n    \n    \\draw[step=1cm,black!30,ultra thin,fill=black!10] (5.8,5.8) grid (11.2,11.2);\n    \\foreach \\x/\\y in {6/6,7/7,8/8,9/9,10/10,11/11} {\n        \\draw [fill=black] (\\x,\\y) circle (0.1);\n    }\n    \n    \\node [label] (a) at (1,-1) {$a$};\n    \\node [label] (b) at (4,-1) {$b$};\n    \\node [label] (ap) at (7,5) {$a'$};\n    \\node [label] (bp) at (10,5) {$b'$};\n    \\node (nu1) at (2.5,-2) {$\\sigma_1$};\n    \\node (nu2) at (8.5,4) {$\\sigma_2$};\n    \n    \\draw [line width=1pt]\n    (1,4) .. controls +(0,10) and +(0,12) .. (7,7);\n    \\draw [line width=1pt]\n    (4,1) .. controls +(0,10) and +(0,12) .. (10,10);\n    \\end{tikzpicture}\n    \\label{subfig:decreasing before and below increasing}\n  }\n  \\caption{\\label{fig:subfig:no (nu_1, nu_2)-edge}\n    Illustration of Lemma~\\ref{lemma:at most one edge monotone}.\n  }\n\\end{figure}\n\n\\begin{lemma}\n  \\label{lemma:matching}\n  Let $\\pi$ be a permutation. The following statements are equivalent:\n  \\begin{enumerate}\n    \\item The permutation $\\pi$ is a square.\n    \\item There exists a perfect containment-free matching $\\mathcal{M}$\n    of $K_\\pi$ such that for any two distinct edges $(a, b)$ and\n    $(a', b')$ in $\\mathcal{M}$ we have $\\pi(a) < \\pi(a')$ if and only\n    if $\\pi(b) < \\pi(b')$.\n  \\end{enumerate}\n\\end{lemma}\n\nLet $\\pi$ be a permutation. For the sake of clarity, we will say that a\nbunch of consecutive positions $P$ of $\\pi$ is \\emph{above} (resp.\n\\emph{below}) above another bunch of consecutive positions $P'$ in $\\pi$\nif $\\pi(i) > \\pi(j)$ (resp. $\\pi(i) < \\pi(j)$) for every $i \\in P$ and\nevery $j \\in P'$. For example, $\\sigma_1$ is above $\\sigma_2$ (in an\nequivalent manner, $\\sigma_2$ is below $\\sigma_1$) in\nFig.~\\ref{subfig:increasing before and above decreasing}, whereas\n$\\sigma_1$ is below $\\sigma_2$ (in an equivalent manner, $\\sigma_2$ is\nabove $\\sigma_1$) in Fig.~\\ref{subfig:decreasing before and below\nincreasing}.\n\nBefore proving hardness, we give an easy lemma that will prove extremely\nuseful for simplifying the proof of upcoming\nProposition~\\ref{proposition:hardness}.\n\n\\begin{lemma}\n  \\label{lemma:at most one edge monotone}\n  Let $\\pi = \\pi_1 \\, \\sigma_1 \\, \\pi_2 \\, \\sigma_2 \\, \\pi_3$\n  be a permutation with $|\\sigma_1| \\geq 2$ and $|\\sigma_2| \\geq 2$,\n  and $\\mathcal{M}$ be a containment-free perfect matching of $K_\\pi$.\n  The following assertions hold:\n  \\begin{enumerate}\n    \\item\n    If $\\sigma_1$ is increasing, $\\sigma_2$ is decreasing, and\n    $\\sigma_1$ is above $\\sigma_2$ (see Fig.~\\ref{subfig:increasing before\n    and above decreasing}), then $\\mathcal{M}$ contains at most one\n    $(\\sigma_1, \\sigma_2)$-edge.\n    \\item\n    If $\\sigma_1$ is decreasing, $\\sigma_2$ is increasing, and $\\sigma_1$\n    is below $\\sigma_2$ (see Fig.~\\ref{subfig:decreasing before and below\n    increasing}), then $\\mathcal{M}$ contains at most one\n    $(\\sigma_1, \\sigma_2)$-edge.\n  \\end{enumerate}\n\\end{lemma}\n\n\\begin{proposition}\n  \\label{proposition:hardness}\n  Deciding whether a permutation is a square is {{\\sf\\bf NP}{\\text{-complete}}\\xspace}.\n\\end{proposition}\n\n\\begin{proof}[of Proposition~\\ref{proposition:hardness}]\n  The problem is certainly in ${{\\sf\\bf NP}\\xspace}$. We propose a reduction from\n  the pattern involvement problem which is known to be\n  {{\\sf\\bf NP}{\\text{-complete}}\\xspace}~\\cite{Bose:Buss:Lubiw:1998}: Given two permutations $\\pi$ and\n  $\\sigma$, decide whether $\\sigma$ occurs in $\\pi$ (as an\n  order-isomorphic pattern).\n\n  \\begin{figure}[t!]\n    \\centering\n    \\begin{tikzpicture}[\n      scale=.8,\n      >=stealth',\n      shorten >=1pt,\n      main node/.style={align=center},\n      cell/.style={draw,ultra thick,fill=black!5},\n      structure link/.style={line width=1.5pt},\n      pattern link/.style={line width=1.5pt,black!20},\n      monotone/.style={->,thick}\n      ]\n      \n      \n      \\draw [pattern link] (8.5,6) .. controls +(0,1) and +(0,2) .. (10.5,5);\n      \n      \\draw [pattern link] (10.5,5) .. controls +(0,1) and +(0,3) .. (11.5,4);\n      \n      \\draw [structure link] (0.5,11) .. controls +(0,2) and +(0,1) .. (2.5,12);\n      \n      \n      \n      \n      \\draw [structure link] (1.5,2) .. controls +(0,1) and +(0,3) .. (6.5,1);\n      \n      \n      \n      \n      \\draw [structure link] (3.5,9) .. controls +(0,3) and +(0,1.5) .. (7.5,10);\n      \n      \n      \n      \\draw [structure link] (5.5,8) .. controls +(0,1) and +(0,7) .. (9.5,3);\n      \n      \n      \n      \\draw [structure link] (4.5,6) .. controls +(0,-2) and +(0,-1) .. (8.5,5);\n      \n      \n      \n      \\draw [cell] (0,10) -- (1,10) -- (1,11) -- (0,11) -- cycle;\n      \\draw [monotone] (0,10) -- ++(1,1) node [midway,fill=white,fill=black!5] {$\\nu_1$};\n      \n      \\draw [cell] (2,11) -- (3,11) -- (3,12) -- (2,12) -- cycle;\n      \\draw [monotone] (2,11) -- ++(1,1) node [midway,fill=white,fill=black!5] {$\\nu'_1$};\n      \n      \\draw [cell] (1,1) -- (2,1) -- (2,2) -- (1,2) -- cycle;\n      \\draw [monotone] (1,2) -- ++(1,-1) node [midway,fill=white,fill=black!5] {$\\nu_2$};\n      \\draw [cell] (6,0) -- (7,0) -- (7,1) -- (6,1) -- cycle;\n      \\draw [monotone] (6,1) -- ++(1,-1) node [midway,fill=white,fill=black!5] {$\\nu'_2$};\n      \n      \\draw [cell] (3,8) -- (4,8) -- (4,9) -- (3,9) -- cycle;\n      \\draw [monotone] (3,8) -- ++(1,1) node [midway,fill=white,fill=black!5] {$\\nu_3$};\n      \\draw [cell] (7,9) -- (8,9) -- (8,10) -- (7,10) -- cycle;\n      \\draw [monotone] (7,9) -- ++(1,1) node [midway,fill=white,fill=black!5] {$\\nu'_3$};\n      \n      \\draw [cell] (5,7) -- (6,7) -- (6,8) -- (5,8) -- cycle;\n      \\draw [monotone] (5,8) -- ++(1,-1) node [midway,fill=white,fill=black!5] {$\\nu_4$};\n      \\draw [cell] (9,2) -- (10,2) -- (10,3) -- (9,3) -- cycle;\n      \\draw [monotone] (9,3) -- ++(1,-1) node [midway,fill=white,fill=black!5] {$\\nu'_4$};\n      \n      \\draw [cell] (4,6) -- (5,6) -- (5,7) -- (4,7) -- cycle;\n      \\node [main node] (sigma1) at (4.5,6.5) {$\\sigma'$};\n      \n      \\draw [cell] (8,5) -- (9,5) -- (9,6) -- (8,6) -- cycle;\n      \\node [main node] (pi1) at (8.5,5.5) {$\\pi'$};\n      \n      \\draw [cell] (10,4) -- (11,4) -- (11,5) -- (10,5) -- cycle;\n      \\node [main node] (sigma2) at (10.5,4.5) {$\\pi''$};\n      \n      \\draw [cell] (11,3) -- (12,3) -- (12,4) -- (11,4) -- cycle;\n      \\node [main node] (pi2) at (11.5,3.5) {$\\sigma''$};\n      \n      \\draw[step=1cm,black!30,thin,fill=black!10] (0,0) grid (12,12);\n      \n      \\foreach \\y/\\N in {0.5/N_2,1.5/N_2,2.5/N_4,3.5/k,4.5/n,5.5/n+2,6.5/k+2,7.5/N_4,8.5/N_3,9.5/N_3,10.5/N_1,11.4/N_1} {\n          \\node at (-0.5,\\y) (R\\y) {$\\N$};\n      }\n      \n      \\foreach \\x/\\N in\n      {0.5/N_1,1.5/N_2,2.5/N_1,3.5/N_3,4.5/k+2,5.5/N_4,6.5/N_2,7.5/N_3,8.5/n+2,9.5/N_4,10.5/n,11.5/k} {\n          \\node at (\\x,-0.5) (C\\x) {$\\N$};\n      }\n    \\end{tikzpicture}\n    \\caption{\\label{fig:reduction}\n      Schematic representation of the permutation $\\mu$ used\n      in Proposition~\\ref{proposition:hardness}.\n      Black edges denote the presence of at least one edge between two bunches of\n      vertices in $K_\\mu$.\n      Grey edges denote edges that are only considered in the forward direction of the\n      proof.\n    }\n  \\end{figure}\n\n  Let $\\pi \\in S_n$ and $\\sigma \\in S_k$ be two arbitrary permutations.\n  Define\n  \n  \n  \n  \n  \n  \n  $N_4 = 2(2n + 2k + 4) + 1  = 4n + 4k + 9$,\n  $N_3 = 2(2N_4 + 2n + 2k + 4) + 1 = 20n + 20k + 45$,\n  $N_2 = 2(2N_3 + 2N_4 + 2n + 2k + 4) + 1 = 100n + 100k + 225$ and\n  $N_1 = 2(2N_2 + 2N_3 + 2N_4 + 2n + 2k + 4) + 1 = 1000n + 1000k  + 1325$.\n  Notice that $N_1, N_2, N_3$ and $N_4$ are polynomial in $n$.\n  The crucial properties are that\n  (i) $N_1, N_2, N_3$ and $N_4$ are odd integers\n  and\n  (ii) $N_i > \\left(\\sum_{i < j \\leq 4} 2N_j\\right) + 2n + 2k + k$\n  for every $1 \\leq i \\leq 4$.\n\n  We now turn to defining various gadgets (sequences of integers)\n  that act as building blocks in our construction of a new permutation $\\mu$:\n  \n", "index": 35, "text": "\\begin{align*}\n  \\sigma'  &= ((k+1) \\; \\sigma \\; (k+2)) \\; [2N_2 + N_4 + 2n + k + 2] \\\\\n  \\pi'     &= ((n+1) \\; \\pi \\; (n+2)) \\; [2N_2 + N_4 + n + k] \\\\\n  \\sigma'' &= \\sigma \\; [2N_2 + N_4] \\\\\n  \\pi''    &= \\pi \\; [2N_2 + N_4 + k] \\\\\n  \\nu_1    &= \\nearrow_{N_1} \\; [2N_2 + 2N_3 + 2N_4 + 2n + 2k + 4] \\\\\n  \\nu'_1   &= \\nearrow_{N_1} \\; [N_1 + 2N_2 + 2N_3 + 2N_4 + 2n + 2k + 4] \\\\\n  \\nu_2    &= \\nearrow_{N_2} \\; [N_2] \\\\\n  \\nu'_2   &= \\searrow_{N_2} \\\\\n  \\nu_3    &= \\nearrow_{N_3} \\; [2N_2 + 2N_4 + 2n + 2k + 4] \\\\\n  \\nu'_3   &= \\nearrow_{N_3} \\; [2N_2 + N_3 + 2N_4 + 2n + 2k + 4] \\\\\n  \\nu_4    &= \\searrow_{N_4} \\; [2N_2 + N_4 + 2n + 2k + 4] \\\\\n  \\nu'_4   &= \\searrow_{N_4} \\; [2N_2]\\text{.}\n  \\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\sigma^{\\prime}\" display=\"inline\"><msup><mi>\u03c3</mi><mo>\u2032</mo></msup></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=((k+1)\\;\\sigma\\;(k+2))\\;[2N_{2}+N_{4}+2n+k+2]\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mo rspace=\"5.3pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mpadded width=\"+2.8pt\"><mi>\u03c3</mi></mpadded><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>k</mi><mo>+</mo><mn>2</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo rspace=\"5.3pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>N</mi><mn>2</mn></msub></mrow><mo>+</mo><msub><mi>N</mi><mn>4</mn></msub><mo>+</mo><mrow><mn>2</mn><mo>\u2062</mo><mi>n</mi></mrow><mo>+</mo><mi>k</mi><mo>+</mo><mn>2</mn></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\pi^{\\prime}\" display=\"inline\"><msup><mi>\u03c0</mi><mo>\u2032</mo></msup></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=((n+1)\\;\\pi\\;(n+2))\\;[2N_{2}+N_{4}+n+k]\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mo rspace=\"5.3pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mpadded width=\"+2.8pt\"><mi>\u03c0</mi></mpadded><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>n</mi><mo>+</mo><mn>2</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo rspace=\"5.3pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>N</mi><mn>2</mn></msub></mrow><mo>+</mo><msub><mi>N</mi><mn>4</mn></msub><mo>+</mo><mi>n</mi><mo>+</mo><mi>k</mi></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\sigma^{\\prime\\prime}\" display=\"inline\"><msup><mi>\u03c3</mi><mi>\u2032\u2032</mi></msup></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\sigma\\;[2N_{2}+N_{4}]\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mpadded width=\"+2.8pt\"><mi>\u03c3</mi></mpadded><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>N</mi><mn>2</mn></msub></mrow><mo>+</mo><msub><mi>N</mi><mn>4</mn></msub></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\pi^{\\prime\\prime}\" display=\"inline\"><msup><mi>\u03c0</mi><mi>\u2032\u2032</mi></msup></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\pi\\;[2N_{2}+N_{4}+k]\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mpadded width=\"+2.8pt\"><mi>\u03c0</mi></mpadded><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>N</mi><mn>2</mn></msub></mrow><mo>+</mo><msub><mi>N</mi><mn>4</mn></msub><mo>+</mo><mi>k</mi></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\nu_{1}\" display=\"inline\"><msub><mi>\u03bd</mi><mn>1</mn></msub></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\nearrow_{N_{1}}\\;[2N_{2}+2N_{3}+2N_{4}+2n+2k+4]\" display=\"inline\"><mrow><mo>=</mo><mpadded width=\"+2.8pt\"><msub><mo>\u2197</mo><msub><mi>N</mi><mn>1</mn></msub></msub></mpadded><mrow><mo stretchy=\"false\">[</mo><mn>2</mn><msub><mi>N</mi><mn>2</mn></msub><mo>+</mo><mn>2</mn><msub><mi>N</mi><mn>3</mn></msub><mo>+</mo><mn>2</mn><msub><mi>N</mi><mn>4</mn></msub><mo>+</mo><mn>2</mn><mi>n</mi><mo>+</mo><mn>2</mn><mi>k</mi><mo>+</mo><mn>4</mn><mo stretchy=\"false\">]</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex6.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\nu^{\\prime}_{1}\" display=\"inline\"><msubsup><mi>\u03bd</mi><mn>1</mn><mo>\u2032</mo></msubsup></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex6.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\nearrow_{N_{1}}\\;[N_{1}+2N_{2}+2N_{3}+2N_{4}+2n+2k+4]\" display=\"inline\"><mrow><mo>=</mo><mpadded width=\"+2.8pt\"><msub><mo>\u2197</mo><msub><mi>N</mi><mn>1</mn></msub></msub></mpadded><mrow><mo stretchy=\"false\">[</mo><msub><mi>N</mi><mn>1</mn></msub><mo>+</mo><mn>2</mn><msub><mi>N</mi><mn>2</mn></msub><mo>+</mo><mn>2</mn><msub><mi>N</mi><mn>3</mn></msub><mo>+</mo><mn>2</mn><msub><mi>N</mi><mn>4</mn></msub><mo>+</mo><mn>2</mn><mi>n</mi><mo>+</mo><mn>2</mn><mi>k</mi><mo>+</mo><mn>4</mn><mo stretchy=\"false\">]</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex7.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\nu_{2}\" display=\"inline\"><msub><mi>\u03bd</mi><mn>2</mn></msub></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex7.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\nearrow_{N_{2}}\\;[N_{2}]\" display=\"inline\"><mrow><mo>=</mo><mpadded width=\"+2.8pt\"><msub><mo>\u2197</mo><msub><mi>N</mi><mn>2</mn></msub></msub></mpadded><mrow><mo stretchy=\"false\">[</mo><msub><mi>N</mi><mn>2</mn></msub><mo stretchy=\"false\">]</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex8.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\nu^{\\prime}_{2}\" display=\"inline\"><msubsup><mi>\u03bd</mi><mn>2</mn><mo>\u2032</mo></msubsup></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex8.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\searrow_{N_{2}}\" display=\"inline\"><mrow><mi/><mo>=</mo><msub><mo>\u2198</mo><msub><mi>N</mi><mn>2</mn></msub></msub></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex9.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\nu_{3}\" display=\"inline\"><msub><mi>\u03bd</mi><mn>3</mn></msub></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex9.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\nearrow_{N_{3}}\\;[2N_{2}+2N_{4}+2n+2k+4]\" display=\"inline\"><mrow><mo>=</mo><mpadded width=\"+2.8pt\"><msub><mo>\u2197</mo><msub><mi>N</mi><mn>3</mn></msub></msub></mpadded><mrow><mo stretchy=\"false\">[</mo><mn>2</mn><msub><mi>N</mi><mn>2</mn></msub><mo>+</mo><mn>2</mn><msub><mi>N</mi><mn>4</mn></msub><mo>+</mo><mn>2</mn><mi>n</mi><mo>+</mo><mn>2</mn><mi>k</mi><mo>+</mo><mn>4</mn><mo stretchy=\"false\">]</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex10.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\nu^{\\prime}_{3}\" display=\"inline\"><msubsup><mi>\u03bd</mi><mn>3</mn><mo>\u2032</mo></msubsup></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex10.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\nearrow_{N_{3}}\\;[2N_{2}+N_{3}+2N_{4}+2n+2k+4]\" display=\"inline\"><mrow><mo>=</mo><mpadded width=\"+2.8pt\"><msub><mo>\u2197</mo><msub><mi>N</mi><mn>3</mn></msub></msub></mpadded><mrow><mo stretchy=\"false\">[</mo><mn>2</mn><msub><mi>N</mi><mn>2</mn></msub><mo>+</mo><msub><mi>N</mi><mn>3</mn></msub><mo>+</mo><mn>2</mn><msub><mi>N</mi><mn>4</mn></msub><mo>+</mo><mn>2</mn><mi>n</mi><mo>+</mo><mn>2</mn><mi>k</mi><mo>+</mo><mn>4</mn><mo stretchy=\"false\">]</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex11.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\nu_{4}\" display=\"inline\"><msub><mi>\u03bd</mi><mn>4</mn></msub></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex11.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\searrow_{N_{4}}\\;[2N_{2}+N_{4}+2n+2k+4]\" display=\"inline\"><mrow><mo>=</mo><mpadded width=\"+2.8pt\"><msub><mo>\u2198</mo><msub><mi>N</mi><mn>4</mn></msub></msub></mpadded><mrow><mo stretchy=\"false\">[</mo><mn>2</mn><msub><mi>N</mi><mn>2</mn></msub><mo>+</mo><msub><mi>N</mi><mn>4</mn></msub><mo>+</mo><mn>2</mn><mi>n</mi><mo>+</mo><mn>2</mn><mi>k</mi><mo>+</mo><mn>4</mn><mo stretchy=\"false\">]</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex12.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\nu^{\\prime}_{4}\" display=\"inline\"><msubsup><mi>\u03bd</mi><mn>4</mn><mo>\u2032</mo></msubsup></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex12.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\searrow_{N_{4}}\\;[2N_{2}]\\text{.}\" display=\"inline\"><mrow><mo>=</mo><mpadded width=\"+2.8pt\"><msub><mo>\u2198</mo><msub><mi>N</mi><mn>4</mn></msub></msub></mpadded><mrow><mo stretchy=\"false\">[</mo><mn>2</mn><msub><mi>N</mi><mn>2</mn></msub><mo stretchy=\"false\">]</mo></mrow><mtext>.</mtext></mrow></math>", "type": "latex"}, {"file": "1601.05962.tex", "nexttext": "\n\n  It is immediate that $\\mu$ can be constructed in polynomial-time in $n$ and $k$.\n  \n  \n  \n  \n  \n  \n  It can be shown\n  \n  that $\\sigma$ occurs in $\\pi$ if and only if\n  there exists a containment-free perfect matching\n  $\\mathcal{M}$ in $K_\\mu$ such that\n  for any two disctinct edges\n  $(a, b)$ and $(a', b')$ in $\\mathcal{M}$\n  we have $\\mu(a) < \\mu(a')$ if and only if $\\mu(b) < \\mu(b')$.\n  \\qed\n\\end{proof}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\section{Conclusion}\n\\label{section:Conclusion}\n\nThere are a number of further directions of investigation in this\ngeneral subject. They cover several areas: algorithmic, combinatorics,\nand algebra. Let us mention several -~not necessarily new~- open\nproblems that are, in our opinion, the most interesting. How many\npermutations of $S_{2n}$ are squares? How many $(213,231)$-avoiding\npermutations of $S_{2n}$ are squares? (Equivalently, by\nProposition~\\ref{prop:bijection_binary_to_permutations_squares},\nhow many binary strings of length $2n$ are squares; see also Problem~4\nin \\cite{Henshall:Rampersad:Shallit:2011})? How hard is the problem of\ndeciding whether a $(213,231)$-avoiding permutation is a square\n(Problem~4 in \\cite{Henshall:Rampersad:Shallit:2011},\nsee also \\cite{Buss:Soltys:2014,Rizzi:Vialette:CSR:2013})?\nGiven two permutations $\\pi$ and~$\\sigma$, how hard is the problem of\ndeciding whether $\\sigma$ is a square root of~$\\pi$?\nAs for algebra, one can ask for a complete algebraic study of\n${\\operatorname{\\mathbb{Q}}}[S]$ as a graded associative algebra for the shuffle  product\n${\\operatorname{\\bullet}}$. Describing a generating family for ${\\operatorname{\\mathbb{Q}}}[S]$, defining\nmultiplicative bases of ${\\operatorname{\\mathbb{Q}}}[S]$, and determining whether ${\\operatorname{\\mathbb{Q}}}[S]$ is\nfree as an associative algebra are worthwhile questions.\n\n\n\n\n\n\n\n\\bibliographystyle{plain}\n\\bibliography{biblio}\n\n\n\n\n\n\n", "itemtype": "equation", "pos": 47215, "prevtext": "\n  We are now in position to define our target permutation $\\mu$\n  (see Fig.~\\ref{fig:reduction} for an illustration):\n  \n", "index": 37, "text": "$$\n  \\mu\n  =\n  \\nu_1 \\; \\nu_2 \\; \\nu'_1 \\; \\nu_3 \\; \\sigma' \\; \\nu_4 \\; \\nu'_2 \\; \\nu'_3 \\; \\pi' \\; \\nu'_4 \\; \\pi'' \\; \\sigma''\n  \\text{.}\n  $$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex13.m1\" class=\"ltx_Math\" alttext=\"\\mu=\\nu_{1}\\;\\nu_{2}\\;\\nu^{\\prime}_{1}\\;\\nu_{3}\\;\\sigma^{\\prime}\\;\\nu_{4}\\;\\nu%&#10;^{\\prime}_{2}\\;\\nu^{\\prime}_{3}\\;\\pi^{\\prime}\\;\\nu^{\\prime}_{4}\\;\\pi^{\\prime%&#10;\\prime}\\;\\sigma^{\\prime\\prime}\\text{.}\" display=\"block\"><mrow><mi>\u03bc</mi><mo>=</mo><mrow><mpadded width=\"+2.8pt\"><msub><mi>\u03bd</mi><mn>1</mn></msub></mpadded><mo>\u2062</mo><mpadded width=\"+2.8pt\"><msub><mi>\u03bd</mi><mn>2</mn></msub></mpadded><mo>\u2062</mo><mpadded width=\"+2.8pt\"><msubsup><mi>\u03bd</mi><mn>1</mn><mo>\u2032</mo></msubsup></mpadded><mo>\u2062</mo><mpadded width=\"+2.8pt\"><msub><mi>\u03bd</mi><mn>3</mn></msub></mpadded><mo>\u2062</mo><mpadded width=\"+2.8pt\"><msup><mi>\u03c3</mi><mo>\u2032</mo></msup></mpadded><mo>\u2062</mo><mpadded width=\"+2.8pt\"><msub><mi>\u03bd</mi><mn>4</mn></msub></mpadded><mo>\u2062</mo><mpadded width=\"+2.8pt\"><msubsup><mi>\u03bd</mi><mn>2</mn><mo>\u2032</mo></msubsup></mpadded><mo>\u2062</mo><mpadded width=\"+2.8pt\"><msubsup><mi>\u03bd</mi><mn>3</mn><mo>\u2032</mo></msubsup></mpadded><mo>\u2062</mo><mpadded width=\"+2.8pt\"><msup><mi>\u03c0</mi><mo>\u2032</mo></msup></mpadded><mo>\u2062</mo><mpadded width=\"+2.8pt\"><msubsup><mi>\u03bd</mi><mn>4</mn><mo>\u2032</mo></msubsup></mpadded><mo>\u2062</mo><mpadded width=\"+2.8pt\"><msup><mi>\u03c0</mi><mi>\u2032\u2032</mi></msup></mpadded><mo>\u2062</mo><msup><mi>\u03c3</mi><mi>\u2032\u2032</mi></msup><mo>\u2062</mo><mtext>.</mtext></mrow></mrow></math>", "type": "latex"}]