[{"file": "1601.04391.tex", "nexttext": "\nFor the details of the properties of the sequence, see \\cite{WW1994}.\n\nSince $\\sigma$ is a morphism, $\\sigma(ab)=\\sigma(a)\\sigma(b)$.\nThe $m$-th iteration of $\\sigma$ is $\\sigma^m(a)=\\sigma^{m-1}(\\sigma(a))$ for $m\\geq2$ and we denote $F_m=\\sigma^m(a)$.\nWe define $\\sigma^0(a)=a$ and $\\sigma^{-1}(a)=\\sigma^0(b)=b$.\nNote that the length of $F_m=\\sigma^m(a)$ is the $m$-th Fibonacci number $f_m$,\ngiven by the recursion formulas $f_{-1}=1$, $f_0=1$, $f_{m+1}=f_m+f_{m-1}$ for $m\\geq 0$.\nLet $\\delta_m\\in\\{a,b\\}$ be the last letter of $F_m$. It's easy to see that\n$\\delta_m=a$ if $m$ is even; $\\delta_m=b$ if $m$ is odd.\n\nFor a finite word $\\omega=x_1x_2\\cdots x_n$, the length of $\\omega$ is equal to $n$ and denoted by $|\\omega|$. We denote by $|\\omega|_a$ (resp. $|\\omega|_b$) the number of letters of $a$ (resp. $b$) occurring in $\\omega$.\nThe $i$-th conjugation of $\\omega$ is the word $C_i(\\omega):=x_{i+1}\\cdots x_nx_1\\cdots x_i$ where $0\\leq i\\leq n-1$.\nThe mirror word $\\overleftarrow{\\omega}$ of $\\omega$ is defined to be $\\overleftarrow{\\omega}=x_n\\cdots x_2x_1$. A word $\\omega$ is called a palindrome if $\\omega=\\overleftarrow{\\omega}$.\nLet $\\mathcal{P}$ be all palindromes occurring in $\\mathbb{F}$, and $\\mathcal{P}(n)$ be all palindromes occurring in $\\mathbb{F}$ of length $n$.\n\nLet $\\tau=x_1\\cdots x_n$ be a finite word (or $\\tau=x_1x_2\\cdots$ be a sequence).\nFor any $i\\leq j\\leq n$, define $\\tau[i,j]:=x_ix_{i+1}\\cdots x_{j-1}x_j$. That means $\\tau[i,j]$ is the factor of $\\tau$ of length $j-i+1$, starting from the $i$-th letter and ending to the $j$-th letter. By convention, we denote $\\tau[i]:=\\tau[i,i]=x_i$ and $\\tau[i,i-1]:=\\varepsilon$.\n\nWe say $\\omega=\\tau[i,j]$ is a factor of $\\tau$, denoted by $\\omega\\prec\\tau$.\nWhen we say $\\omega\\prec\\tau$, it can be that $\\omega=\\tau$.\n\nWe say that $\\nu$ is a prefix (resp. suffix) of a word $\\omega$, and write $\\nu\\triangleleft\\omega$ (resp. $\\nu\\triangleright\\omega$) if there exists $u\\in\\mathcal{A}^\\ast$ such that $\\omega=\\nu u$ (resp. $\\omega=u\\nu$).\nIn this case, we can write $\\nu^{-1}\\omega=u$ (resp. $\\omega\\nu^{-1}=u$).\n\nLet $A$, $B$, $C$ be three sets. We say $A$ is the disjoint unite of $B$ and $C$, if $A=B\\cup C$ and $B\\cap C=\\emptyset$, denoted by $A=B\\sqcup C$.\n\nIt is well known that the Fibonacci sequence $\\mathbb{F}$ is uniformly recurrent, i.e., each factor $\\omega$ occurs infinitely often and with bounded gaps between consecutive occurrences \\cite{AS2003}.\nWe arrange them in the sequence\n$\\{\\omega_p\\}_{p\\ge 1}$, where $\\omega_p$ denote the $p$-th occurrence of $\\omega$.\n\nThe definitions of return words and the sequence of return words below are from F.Durand\\cite{D1998}. Let $\\omega$ be a factor of $\\mathbb{F}$. For $p\\geq1$, let $\\omega_p=x_{i+1}\\cdots x_{i+n}$ and $\\omega_{p+1}=x_{j+1}\\cdots x_{j+n}$.\nThe factor $x_{i+1}\\cdots x_{j}$ is called the $p$-th return word of $\\omega$ and denoted by $r_{p}(\\omega)$.\nThe sequence $\\{r_p(\\omega)\\}_{p\\geq1}$ is called the sequences of the return words of factor $\\omega$.\n\nThe $m$-th singular word is defined as $K_m=\\delta_{m+1}F_m\\delta_m^{-1}$.\n\nIt is known that all singular words are palindromes and $K_m=K_{m-2}K_{m-3}K_{m-2}$ for all $m\\geq2$ see \\cite{WW1994}.\nLet $Ker(\\omega)$ be the maximal singular word occurring in factor $\\omega$, then by Theorem 1.9 in \\cite{HW2015-1},\n$Ker(\\omega)$ occurs in $\\omega$ only once.\nMoreover\n\n\\begin{property}[Theorem 2.8 in \\cite{HW2015-1}]\\label{wp}~\n$Ker(\\omega_p)=Ker(\\omega)_p$ for all $\\omega\\in\\mathbb{F}$ and $p\\geq1.$\n\\end{property}\nThis means, let $Ker(\\omega)=K_m$, then the maximal singular word occurring in $\\omega_p$ is just $K_{m,p}$. For instance, $Ker(aba)=b$, $(aba)_3=\\mathbb{F}[6,8]$, $(b)_3=\\mathbb{F}[7]$, so $Ker((aba)_3)=(b)_3$, $(aba)_3=a(b)_3a$.\n\n\\begin{property}[Theorem 2.11 in \\cite{HW2015-1}]\\label{G}~\nFor any factor $\\omega$,\nthe sequence of return words $\\{r_p(\\omega)\\}_{p\\geq1}$ is the Fibonacci sequence over the alphabet $\\{r_1(\\omega),r_2(\\omega)\\}$.\n\\end{property}\n\n\n\n\n\\section{The cylinder structure of palindromes}\n\nWe have known that all singular words are palindromes, in this section,\nwe will show that any palindrome can be generated by singular words.\n\n\\begin{property}[]\\\nLet $\\omega\\in\\cal P$, $Ker(\\omega)$ occurs in the middle of $\\omega$.\n\\end{property}\n\n\\begin{proof}\nSince both $\\omega$ and  $Ker(\\omega)$ are palindromes, $\\overleftarrow{\\omega}=\\omega$ and $\\overleftarrow{Ker(\\omega)}=Ker(\\omega)$. If $Ker(\\omega)$ does not occur in the middle of $\\omega$,\nwe can find two occurrences of $Ker(\\omega)$ in $\\omega$. That leads to a contradiction with\n$Ker(\\omega)$ occurs in $\\omega$ only once.\n\n\\end{proof}\n\nBy Corollary 2.10 in \\cite{HW2015-1} and $K_{m+3}=K_{m+1}K_m K_{m+1}$, any factor $\\omega$ with kernel $K_m$ can be expressed uniquely as\n\n", "itemtype": "equation", "pos": 5050, "prevtext": "\n\\begin{CJK*}{GBK}{song}\n\\CJKindent\n\n\\centerline{\\textbf{\\LARGE{The structure of palindromes}}}\n\n\\vspace{0.2cm}\n\n\\centerline{\\textbf{\\LARGE{in the Fibonacci sequence\nand some applications}}}\n\n\\vspace{0.2cm}\n\n\\centerline{Huang Yuke\\footnote[1]{School of Mathematics and Systems Science, Beihang University (BUAA), Beijing, 100191, P. R. China.}$^,$\\footnote[2]{E-mail address: huangyuke07@tsinghua.org.cn.}\n~~Wen Zhiying\\footnote[3]{Department of Mathematical Sciences, Tsinghua University, Beijing, 100084, P. R. China.}$^,$\\footnote[4]{E-mail address: wenzy@tsinghua.edu.cn(Corresponding author).}}\n\n\\vspace{1cm}\n\n\\centerline{\\textbf{\\large{ABSTRACT}}}\n\n\\vspace{0.2cm}\n\nLet ${\\cal P}$ be the set of palindromes occurring in the Fibonacci sequence.\nIn this note, we establish three structures of $\\mathcal{P}$ and and discuss their properties:\ncylinder structure, chain structure and recursive structure. Using these structures, we determine that\nthe number of distinct palindrome occurrences in $\\mathbb{F}[1,n]$ is exactly $n$, where $\\mathbb{F}[1,n]$\nis the prefix of the Fibonacci sequence of length $n$. Then we give an algorithm for counting the number of repeated palindrome occurrences in $\\mathbb{F}[1,n]$, and get explicit expressions for some special $n$,\nwhich include the known results. We also give simpler proofs of some classical properties, such as in X.Droubay\\cite{D1995}, W.F.Chuan\\cite{C1993} and J.Shallit et al\\cite{DMSS2014}.\n\n\\vspace{0.2cm}\n\n\\noindent\\textbf{Key words:} the Fibonacci sequence; palindrome; structure; algorithm;\nthe sequence of return words.\n\n\\section{Introduction}\n\nAs a classical example over a binary alphabet, the Fibonacci sequence, having many remarkable properties, appears in many aspects of mathematics and computer science\netc., we refer to M.Lothaire\\cite{L1983,L2002}, J.M.Allouche and J.Shallit\\cite{AS2003},\nBerstel\\cite{B1966,B1980}.\n\nIn this paper, we establish and discuss three structures of palindromes in the Fibonacci sequence.\nThese structures are important because palindromes are objects of a great interest in computer science, etc.\n\nIn 1993 and 1995, W.F.Chuan\\cite{C1993} and X.Droubay\\cite{D1995} determined the number of palindromes in conjugations of $F_m$ respectively, where $F_m=\\sigma^m(a)$ and $\\sigma$ is the Fibonacci morphism. X.Droubay\\cite{D1995} also determined the number of palindromes of length $n$.\nIn 2014, C.F.Du, H.Mousavi, L.Schaeffer and J.Shallit\\cite{DMSS2014} showed the necessary and sufficient condition of $\\mathbb{F}[1,n]$ is a palindrome.\nIn this paper, \nwe will give simper proofs of these properties above by the structures of palindromes, see Corollary 3.4, 3.5 and Remark 4.3.\n\nOn the other hand, as new results, we first determine the number of distinct palindrome occurrences in $\\mathbb{F}[1,n]$ is exactly $n$ (Theorem 4.5), then we give an algorithm for counting\nthe number of repeat palindrome occurrences in $\\mathbb{F}[1,n]$ (Algorithm 6.9), and give explicit expressions in some particular cases, such as when $n=f_m$ etc. (Theorem 6.7).\n\nThe main tool of this paper is the structure property of the sequence of return words in the Fibonacci sequence which introduced and studied in \\cite{HW2015-1}.\nBy this property, we can determine the positions of all occurrences for each palindrome, and establish the sequence properties of them.\nMoreover, we can count the number of palindromes occurrences in each prefix of $\\mathbb{F}$, not only in $F_m$.\n\nThis paper is organized as follows.\nSection 2 present some basic notations and known results. Sections 3 to 5 are devoted to establish three structure properties of palindromes in the Fibonacci sequence: cylinder sets, chain structure and recursive structure. In Sections 4 and 6, using the structure properties mentioned above, we determined also the number of distinct  and repeated palindrome occurrences in $\\mathbb{F}[1,n]$ for all $n$ respectively.\n\n\n\\section{Preliminaries}\n\nLet $\\mathcal{A}=\\{a,b\\}$ be a binary alphabet.\nA word is a finite string of elements in $\\mathcal{A}$.\nThe set of all finite words on $\\mathcal{A}$ is denoted by $\\mathcal{A}^\\ast$, which is a free monoid generated by $\\mathcal{A}$ with the concatenation operation.\nThe concatenation of two words $\\nu=x_1x_2\\cdots x_r$ and $\\omega=y_1y_2\\cdots y_n$ is the word $x_1x_2\\cdots x_ry_1y_2\\cdots y_n$, denoted by $\\nu\\omega$. This operation is associative and has a unit element, the empty word $\\varepsilon$.\nThe set $\\mathcal{A}^\\ast$ is thus endowed with the structure of a monoid, and is called the free monoid generated by $\\mathcal{A}$.\n\nLet $\\mathcal{B}$ and $\\mathcal{C}$ be two alphabets. A morphism is a map $\\varphi$ from\n$\\mathcal{B}^\\ast$ to $\\mathcal{C}^\\ast$ that the identity $\\varphi(xy)=\\varphi(x)\\varphi(y)$ for all words $x,y\\in\\mathcal{B}^\\ast$, see \\cite{AS2003}.\nThe Fibonacci sequence $\\mathbb{F}$ is the fixed point beginning with $a$ of the Fibonacci morphism $\\sigma:\\mathcal{A}^\\ast\\rightarrow \\mathcal{A}^\\ast$ defined over $\\mathcal{A}^\\ast$ by $\\sigma(a)=ab$ and $\\sigma(b)=a$.\n\n", "index": 1, "text": "$$\\mathbb{F}=abaababa abaab abaababa abaababa abaab abaababa abaab abaababa\\cdots$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"\\mathbb{F}=abaababaabaababaababaabaababaabaababaababaabaababaababa\\cdots\" display=\"block\"><mrow><mi>\ud835\udd3d</mi><mo>=</mo><mrow><mi>a</mi><mo>\u2062</mo><mi>b</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>b</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>b</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>b</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>b</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>b</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>b</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>b</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>b</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>b</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>b</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>b</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>b</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>b</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>b</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>b</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>b</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>b</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>b</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>b</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>b</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi mathvariant=\"normal\">\u22ef</mi></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04391.tex", "nexttext": "\nwhere $2\\leq i\\leq f_{m+1}+1$, $0\\leq j\\leq f_{m+1}-1$. Thus by Property 3.1 we have\n\n\\begin{property}[]\\\nAny palindrome with kernel $K_m$ can be expressed uniquely as\n\n", "itemtype": "equation", "pos": 9933, "prevtext": "\nFor the details of the properties of the sequence, see \\cite{WW1994}.\n\nSince $\\sigma$ is a morphism, $\\sigma(ab)=\\sigma(a)\\sigma(b)$.\nThe $m$-th iteration of $\\sigma$ is $\\sigma^m(a)=\\sigma^{m-1}(\\sigma(a))$ for $m\\geq2$ and we denote $F_m=\\sigma^m(a)$.\nWe define $\\sigma^0(a)=a$ and $\\sigma^{-1}(a)=\\sigma^0(b)=b$.\nNote that the length of $F_m=\\sigma^m(a)$ is the $m$-th Fibonacci number $f_m$,\ngiven by the recursion formulas $f_{-1}=1$, $f_0=1$, $f_{m+1}=f_m+f_{m-1}$ for $m\\geq 0$.\nLet $\\delta_m\\in\\{a,b\\}$ be the last letter of $F_m$. It's easy to see that\n$\\delta_m=a$ if $m$ is even; $\\delta_m=b$ if $m$ is odd.\n\nFor a finite word $\\omega=x_1x_2\\cdots x_n$, the length of $\\omega$ is equal to $n$ and denoted by $|\\omega|$. We denote by $|\\omega|_a$ (resp. $|\\omega|_b$) the number of letters of $a$ (resp. $b$) occurring in $\\omega$.\nThe $i$-th conjugation of $\\omega$ is the word $C_i(\\omega):=x_{i+1}\\cdots x_nx_1\\cdots x_i$ where $0\\leq i\\leq n-1$.\nThe mirror word $\\overleftarrow{\\omega}$ of $\\omega$ is defined to be $\\overleftarrow{\\omega}=x_n\\cdots x_2x_1$. A word $\\omega$ is called a palindrome if $\\omega=\\overleftarrow{\\omega}$.\nLet $\\mathcal{P}$ be all palindromes occurring in $\\mathbb{F}$, and $\\mathcal{P}(n)$ be all palindromes occurring in $\\mathbb{F}$ of length $n$.\n\nLet $\\tau=x_1\\cdots x_n$ be a finite word (or $\\tau=x_1x_2\\cdots$ be a sequence).\nFor any $i\\leq j\\leq n$, define $\\tau[i,j]:=x_ix_{i+1}\\cdots x_{j-1}x_j$. That means $\\tau[i,j]$ is the factor of $\\tau$ of length $j-i+1$, starting from the $i$-th letter and ending to the $j$-th letter. By convention, we denote $\\tau[i]:=\\tau[i,i]=x_i$ and $\\tau[i,i-1]:=\\varepsilon$.\n\nWe say $\\omega=\\tau[i,j]$ is a factor of $\\tau$, denoted by $\\omega\\prec\\tau$.\nWhen we say $\\omega\\prec\\tau$, it can be that $\\omega=\\tau$.\n\nWe say that $\\nu$ is a prefix (resp. suffix) of a word $\\omega$, and write $\\nu\\triangleleft\\omega$ (resp. $\\nu\\triangleright\\omega$) if there exists $u\\in\\mathcal{A}^\\ast$ such that $\\omega=\\nu u$ (resp. $\\omega=u\\nu$).\nIn this case, we can write $\\nu^{-1}\\omega=u$ (resp. $\\omega\\nu^{-1}=u$).\n\nLet $A$, $B$, $C$ be three sets. We say $A$ is the disjoint unite of $B$ and $C$, if $A=B\\cup C$ and $B\\cap C=\\emptyset$, denoted by $A=B\\sqcup C$.\n\nIt is well known that the Fibonacci sequence $\\mathbb{F}$ is uniformly recurrent, i.e., each factor $\\omega$ occurs infinitely often and with bounded gaps between consecutive occurrences \\cite{AS2003}.\nWe arrange them in the sequence\n$\\{\\omega_p\\}_{p\\ge 1}$, where $\\omega_p$ denote the $p$-th occurrence of $\\omega$.\n\nThe definitions of return words and the sequence of return words below are from F.Durand\\cite{D1998}. Let $\\omega$ be a factor of $\\mathbb{F}$. For $p\\geq1$, let $\\omega_p=x_{i+1}\\cdots x_{i+n}$ and $\\omega_{p+1}=x_{j+1}\\cdots x_{j+n}$.\nThe factor $x_{i+1}\\cdots x_{j}$ is called the $p$-th return word of $\\omega$ and denoted by $r_{p}(\\omega)$.\nThe sequence $\\{r_p(\\omega)\\}_{p\\geq1}$ is called the sequences of the return words of factor $\\omega$.\n\nThe $m$-th singular word is defined as $K_m=\\delta_{m+1}F_m\\delta_m^{-1}$.\n\nIt is known that all singular words are palindromes and $K_m=K_{m-2}K_{m-3}K_{m-2}$ for all $m\\geq2$ see \\cite{WW1994}.\nLet $Ker(\\omega)$ be the maximal singular word occurring in factor $\\omega$, then by Theorem 1.9 in \\cite{HW2015-1},\n$Ker(\\omega)$ occurs in $\\omega$ only once.\nMoreover\n\n\\begin{property}[Theorem 2.8 in \\cite{HW2015-1}]\\label{wp}~\n$Ker(\\omega_p)=Ker(\\omega)_p$ for all $\\omega\\in\\mathbb{F}$ and $p\\geq1.$\n\\end{property}\nThis means, let $Ker(\\omega)=K_m$, then the maximal singular word occurring in $\\omega_p$ is just $K_{m,p}$. For instance, $Ker(aba)=b$, $(aba)_3=\\mathbb{F}[6,8]$, $(b)_3=\\mathbb{F}[7]$, so $Ker((aba)_3)=(b)_3$, $(aba)_3=a(b)_3a$.\n\n\\begin{property}[Theorem 2.11 in \\cite{HW2015-1}]\\label{G}~\nFor any factor $\\omega$,\nthe sequence of return words $\\{r_p(\\omega)\\}_{p\\geq1}$ is the Fibonacci sequence over the alphabet $\\{r_1(\\omega),r_2(\\omega)\\}$.\n\\end{property}\n\n\n\n\n\\section{The cylinder structure of palindromes}\n\nWe have known that all singular words are palindromes, in this section,\nwe will show that any palindrome can be generated by singular words.\n\n\\begin{property}[]\\\nLet $\\omega\\in\\cal P$, $Ker(\\omega)$ occurs in the middle of $\\omega$.\n\\end{property}\n\n\\begin{proof}\nSince both $\\omega$ and  $Ker(\\omega)$ are palindromes, $\\overleftarrow{\\omega}=\\omega$ and $\\overleftarrow{Ker(\\omega)}=Ker(\\omega)$. If $Ker(\\omega)$ does not occur in the middle of $\\omega$,\nwe can find two occurrences of $Ker(\\omega)$ in $\\omega$. That leads to a contradiction with\n$Ker(\\omega)$ occurs in $\\omega$ only once.\n\n\\end{proof}\n\nBy Corollary 2.10 in \\cite{HW2015-1} and $K_{m+3}=K_{m+1}K_m K_{m+1}$, any factor $\\omega$ with kernel $K_m$ can be expressed uniquely as\n\n", "index": 3, "text": "$$\\omega=K_{m+1}[i,f_{m+1}] K_m K_{m+1}[1,j]=K_{m+3}[i,f_{m+2}+j],$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"\\omega=K_{m+1}[i,f_{m+1}]K_{m}K_{m+1}[1,j]=K_{m+3}[i,f_{m+2}+j],\" display=\"block\"><mrow><mrow><mi>\u03c9</mi><mo>=</mo><mrow><msub><mi>K</mi><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>i</mi><mo>,</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">]</mo></mrow><mo>\u2062</mo><msub><mi>K</mi><mi>m</mi></msub><mo>\u2062</mo><msub><mi>K</mi><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo stretchy=\"false\">]</mo></mrow></mrow><mo>=</mo><mrow><msub><mi>K</mi><mrow><mi>m</mi><mo>+</mo><mn>3</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>i</mi><mo>,</mo><mrow><msub><mi>f</mi><mrow><mi>m</mi><mo>+</mo><mn>2</mn></mrow></msub><mo>+</mo><mi>j</mi></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04391.tex", "nexttext": "\nwhere $1\\leq i\\leq f_{m+1}$.\n\\end{property}\n\nThis property above shows that for any $m\\ge -1$, all palindromes with kernel $K_m$ can be listed as $\\{K_{m+3}[i+1,f_{m+3}-i],1\\leq i\\leq f_{m+1}\\}$, so any palindrome $\\omega$ with kernel $K_m$, there exists\nuniquely $i$ with $1\\leq i\\leq f_{m+1}$ so that $\\omega=K_{m+3}[i+1,f_{m+3}-i]$.\n\n\nBy the expression (1), we see that the set $\\cal P$ decomposes into three disjoint cylinder sets\n$\\langle a\\rangle$, $\\langle b\\rangle$ and $\\langle aa\\rangle$, which can be illustrated by the following way, see Tab.1, which we call the cylinder structure of $\\cal P$.\nThis means any palindromes can be generated by singular words.\nMore concretely, let $\\omega$ be a palindrome, then $\\omega\\in \\langle aa\\rangle$ if $|\\omega|$ is even;\n$\\omega\\in\\langle a\\rangle$ (resp. $\\langle b\\rangle$) if $|\\omega|$ is odd and the middle letter of $\\omega$ is $a$ (resp. $b$).\n\n\\begin{remark}\nTab.1 shows the first several elements of cylinder sets $\\langle a\\rangle$, $\\langle b\\rangle$ and $\\langle aa\\rangle$, where we sign all singular words with underlines.\nWe can see that the singular words are sparse in $\\mathcal{P}$, this means the palindromes are generated ``high efficient'' from singular words.\n\\end{remark}\n\n\\vspace{0.2cm}\n\n\n\\centerline{Tab.1: The cylinder structure of palindromes.}\n\\vspace{-0.2cm}\n\\begin{center}\n\\begin{tabular}{ccc}\n\\hline\ncylinder$\\langle a\\rangle$&cylinder$\\langle b\\rangle$&cylinder$\\langle aa\\rangle$\\\\\\hline\n\\underline{a}&\\underline{b}&\\underline{aa}\\\\\n\\underline{bab}&aba&baab\\\\\nababa&\\underline{aabaa}&abaaba\\\\\naababaa&baabaab&\\underline{babaabab}\\\\\nbaababaab&abaabaaba&ababaababa\\\\\nabaababaaba&babaabaabab&aababaababaa\\\\\n\\underline{aabaababaabaa}&ababaabaababa&baababaababaab\\\\\nbaabaababaabaab&aababaabaababaa&abaababaababaaba\\\\\nabaabaababaabaaba&baababaabaababaab&aabaababaababaabaa\\\\\nbabaabaababaabaabab&abaababaabaababaaba&baabaababaababaabaab\\\\\nababaabaababaabaababa&\\underline{babaababaabaababaabab}&abaabaababaababaabaaba\\\\\naababaabaababaabaababaa&ababaababaabaababaababa&babaabaababaababaabaabab\\\\\n\\vdots&\\vdots&\\vdots\\\\\\hline\n\\end{tabular}\n\\end{center}\n\n\nBy the cylinder structure of palindromes, we can recover some results immediately.\n\n\\begin{corollary}[Droubay\\cite{D1995}]~ For any $n\\geq1$, $\\mathcal{P}(n)=2$ if $n$ is odd; $\\mathcal{P}(n)=1$ if $n$ is even.\n\\end{corollary}\n\n\\begin{corollary}[Chuan\\cite{C1993} and Droubay\\cite{D1995}]~ For any $m\\geq-1$,\n\n", "itemtype": "equation", "pos": 10170, "prevtext": "\nwhere $2\\leq i\\leq f_{m+1}+1$, $0\\leq j\\leq f_{m+1}-1$. Thus by Property 3.1 we have\n\n\\begin{property}[]\\\nAny palindrome with kernel $K_m$ can be expressed uniquely as\n\n", "index": 5, "text": "$$K_{m+1}[i+1,f_{m+1}] K_m K_{m+1}[1,f_{m+1}-i]=K_{m+3}[i+1,f_{m+3}-i],\\eqno(1)$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"K_{m+1}[i+1,f_{m+1}]K_{m}K_{m+1}[1,f_{m+1}-i]=K_{m+3}[i+1,f_{m+3}-i],\" display=\"block\"><mrow><mrow><mrow><msub><mi>K</mi><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mo>,</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">]</mo></mrow><mo>\u2062</mo><msub><mi>K</mi><mi>m</mi></msub><mo>\u2062</mo><msub><mi>K</mi><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo>,</mo><mrow><msub><mi>f</mi><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>-</mo><mi>i</mi></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mo>=</mo><mrow><msub><mi>K</mi><mrow><mi>m</mi><mo>+</mo><mn>3</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mo>,</mo><mrow><msub><mi>f</mi><mrow><mi>m</mi><mo>+</mo><mn>3</mn></mrow></msub><mo>-</mo><mi>i</mi></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04391.tex", "nexttext": "\n\\end{corollary}\n\n\\begin{proof}\nNotice that all factors with length $f_m$ are $\\{K_m\\}\\sqcup\\{C_i(F_m),0\\leq i\\leq f_{m}\\}$ see \\cite{WW1994}.\nWhen $m\\equiv 1$ (mod 3), $f_m$ is even, there is only one palindrome with length $f_m$, i.e. $K_m$, so there is no palindrome as a conjugation of $F_m$. When $m\\equiv0,2$ (mod 3), $f_m$ is odd, there are exactly 2 palindromes with length $f_m$. One of them is $K_m$, the other one is a conjugation of $F_m$.\nThus the conclusion holds.\n\\end{proof}\n\n\n\n\n\\section{The chain structure of palindromes}\n\nRecall that $\\omega_p$ be the p-th occurrence of the factor $\\omega$ in $\\mathbb F$. We denote by $L(\\omega,p)$ the position of the first letter of $\\omega_p$, then the position of the last letter of $\\omega_p$ is $P(\\omega,p):=L(\\omega,p)+|\\omega|-1$.\n\nDenote $\\phi=\\frac{\\sqrt{5}-1}{2}$, $\\lfloor\\alpha\\rfloor$ is the biggest integer not larger than $\\alpha$.\n\n\n\\begin{property}\\label{P}\nFor $m\\geq-1$, $p\\geq1$,\n$P(K_m,p)=pf_{m+1}+(\\lfloor\\phi p\\rfloor+1)f_{m}-1.$\n\\end{property}\n\n\n\\begin{proof}\nBy Proposition 3.4 in \\cite{HW2015-1},\n$L(K_m,p)=pf_{m+1}+|\\mathbb{F}[1,p-1]|_af_{m}$. Since\n$|\\mathbb{F}[1,p-1]|_a=\\lfloor\\phi p\\rfloor$\nand $|K_m|=f_m$, we have $P(K_m,p)=L(K_m,p)+|K_m|-1=pf_{m+1}+(\\lfloor\\phi p\\rfloor+1)f_{m}-1$.\n\\end{proof}\n\n\n\n\\begin{corollary}\\label{P1}\n$P(a,p)=p+\\lfloor\\phi p\\rfloor$,\n$P(b,p)=2p+\\lfloor\\phi p\\rfloor$\nand $P(aa,p)=3p+2\\lfloor\\phi p\\rfloor+1$.\n\\end{corollary}\n\nLet $\\omega$ be a palindrome with kernel $K_m$ satisfying expression (1), $1\\leq i\\leq f_{m+1}$.\nBy Property \\ref{wp}, we get the relation between $P(\\omega,p)$ and $P(K_m,p)$. Using Property \\ref{P},\nwe have\n\n", "itemtype": "equation", "pos": 12694, "prevtext": "\nwhere $1\\leq i\\leq f_{m+1}$.\n\\end{property}\n\nThis property above shows that for any $m\\ge -1$, all palindromes with kernel $K_m$ can be listed as $\\{K_{m+3}[i+1,f_{m+3}-i],1\\leq i\\leq f_{m+1}\\}$, so any palindrome $\\omega$ with kernel $K_m$, there exists\nuniquely $i$ with $1\\leq i\\leq f_{m+1}$ so that $\\omega=K_{m+3}[i+1,f_{m+3}-i]$.\n\n\nBy the expression (1), we see that the set $\\cal P$ decomposes into three disjoint cylinder sets\n$\\langle a\\rangle$, $\\langle b\\rangle$ and $\\langle aa\\rangle$, which can be illustrated by the following way, see Tab.1, which we call the cylinder structure of $\\cal P$.\nThis means any palindromes can be generated by singular words.\nMore concretely, let $\\omega$ be a palindrome, then $\\omega\\in \\langle aa\\rangle$ if $|\\omega|$ is even;\n$\\omega\\in\\langle a\\rangle$ (resp. $\\langle b\\rangle$) if $|\\omega|$ is odd and the middle letter of $\\omega$ is $a$ (resp. $b$).\n\n\\begin{remark}\nTab.1 shows the first several elements of cylinder sets $\\langle a\\rangle$, $\\langle b\\rangle$ and $\\langle aa\\rangle$, where we sign all singular words with underlines.\nWe can see that the singular words are sparse in $\\mathcal{P}$, this means the palindromes are generated ``high efficient'' from singular words.\n\\end{remark}\n\n\\vspace{0.2cm}\n\n\n\\centerline{Tab.1: The cylinder structure of palindromes.}\n\\vspace{-0.2cm}\n\\begin{center}\n\\begin{tabular}{ccc}\n\\hline\ncylinder$\\langle a\\rangle$&cylinder$\\langle b\\rangle$&cylinder$\\langle aa\\rangle$\\\\\\hline\n\\underline{a}&\\underline{b}&\\underline{aa}\\\\\n\\underline{bab}&aba&baab\\\\\nababa&\\underline{aabaa}&abaaba\\\\\naababaa&baabaab&\\underline{babaabab}\\\\\nbaababaab&abaabaaba&ababaababa\\\\\nabaababaaba&babaabaabab&aababaababaa\\\\\n\\underline{aabaababaabaa}&ababaabaababa&baababaababaab\\\\\nbaabaababaabaab&aababaabaababaa&abaababaababaaba\\\\\nabaabaababaabaaba&baababaabaababaab&aabaababaababaabaa\\\\\nbabaabaababaabaabab&abaababaabaababaaba&baabaababaababaabaab\\\\\nababaabaababaabaababa&\\underline{babaababaabaababaabab}&abaabaababaababaabaaba\\\\\naababaabaababaabaababaa&ababaababaabaababaababa&babaabaababaababaabaabab\\\\\n\\vdots&\\vdots&\\vdots\\\\\\hline\n\\end{tabular}\n\\end{center}\n\n\nBy the cylinder structure of palindromes, we can recover some results immediately.\n\n\\begin{corollary}[Droubay\\cite{D1995}]~ For any $n\\geq1$, $\\mathcal{P}(n)=2$ if $n$ is odd; $\\mathcal{P}(n)=1$ if $n$ is even.\n\\end{corollary}\n\n\\begin{corollary}[Chuan\\cite{C1993} and Droubay\\cite{D1995}]~ For any $m\\geq-1$,\n\n", "index": 7, "text": "\\begin{equation*}\n\\mathcal{P}(f_m)\\cap\\{C_i(F_m),0\\leq i\\leq f_{m}\\}=\n\\begin{cases}\n0,&m\\equiv1~(mod~3)\\\\\n1,&otherwise\n\\end{cases}\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m1\" class=\"ltx_Math\" alttext=\"\\mathcal{P}(f_{m})\\cap\\{C_{i}(F_{m}),0\\leq i\\leq f_{m}\\}=\\begin{cases}0,&amp;m%&#10;\\equiv 1~{}(mod~{}3)\\\\&#10;1,&amp;otherwise\\end{cases}\" display=\"block\"><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcab</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mi>m</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2229</mo><mrow><mo stretchy=\"false\">{</mo><msub><mi>C</mi><mi>i</mi></msub><mrow><mo stretchy=\"false\">(</mo><msub><mi>F</mi><mi>m</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mn>0</mn><mo>\u2264</mo><mi>i</mi><mo>\u2264</mo><msub><mi>f</mi><mi>m</mi></msub><mo stretchy=\"false\">}</mo></mrow><mo>=</mo><mrow><mo>{</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><mn>0</mn><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mi>m</mi><mo>\u2261</mo><mrow><mpadded width=\"+3.3pt\"><mn>1</mn></mpadded><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>m</mi><mo>\u2062</mo><mi>o</mi><mo>\u2062</mo><mpadded width=\"+3.3pt\"><mi>d</mi></mpadded><mo>\u2062</mo><mn>3</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mrow><mn>1</mn><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mi>o</mi><mo>\u2062</mo><mi>t</mi><mo>\u2062</mo><mi>h</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>r</mi><mo>\u2062</mo><mi>w</mi><mo>\u2062</mo><mi>i</mi><mo>\u2062</mo><mi>s</mi><mo>\u2062</mo><mi>e</mi></mrow></mtd></mtr></mtable></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04391.tex", "nexttext": "\n\n\\begin{remark} As a simple application of the expression (2), we give a necessary and sufficient condition\nsuch that the prefix $\\mathbb{F}[1,n]$ is a palindrome which was proved by J.Shallit et al \\cite{DMSS2014}. In fact,\n\n", "itemtype": "equation", "pos": 14490, "prevtext": "\n\\end{corollary}\n\n\\begin{proof}\nNotice that all factors with length $f_m$ are $\\{K_m\\}\\sqcup\\{C_i(F_m),0\\leq i\\leq f_{m}\\}$ see \\cite{WW1994}.\nWhen $m\\equiv 1$ (mod 3), $f_m$ is even, there is only one palindrome with length $f_m$, i.e. $K_m$, so there is no palindrome as a conjugation of $F_m$. When $m\\equiv0,2$ (mod 3), $f_m$ is odd, there are exactly 2 palindromes with length $f_m$. One of them is $K_m$, the other one is a conjugation of $F_m$.\nThus the conclusion holds.\n\\end{proof}\n\n\n\n\n\\section{The chain structure of palindromes}\n\nRecall that $\\omega_p$ be the p-th occurrence of the factor $\\omega$ in $\\mathbb F$. We denote by $L(\\omega,p)$ the position of the first letter of $\\omega_p$, then the position of the last letter of $\\omega_p$ is $P(\\omega,p):=L(\\omega,p)+|\\omega|-1$.\n\nDenote $\\phi=\\frac{\\sqrt{5}-1}{2}$, $\\lfloor\\alpha\\rfloor$ is the biggest integer not larger than $\\alpha$.\n\n\n\\begin{property}\\label{P}\nFor $m\\geq-1$, $p\\geq1$,\n$P(K_m,p)=pf_{m+1}+(\\lfloor\\phi p\\rfloor+1)f_{m}-1.$\n\\end{property}\n\n\n\\begin{proof}\nBy Proposition 3.4 in \\cite{HW2015-1},\n$L(K_m,p)=pf_{m+1}+|\\mathbb{F}[1,p-1]|_af_{m}$. Since\n$|\\mathbb{F}[1,p-1]|_a=\\lfloor\\phi p\\rfloor$\nand $|K_m|=f_m$, we have $P(K_m,p)=L(K_m,p)+|K_m|-1=pf_{m+1}+(\\lfloor\\phi p\\rfloor+1)f_{m}-1$.\n\\end{proof}\n\n\n\n\\begin{corollary}\\label{P1}\n$P(a,p)=p+\\lfloor\\phi p\\rfloor$,\n$P(b,p)=2p+\\lfloor\\phi p\\rfloor$\nand $P(aa,p)=3p+2\\lfloor\\phi p\\rfloor+1$.\n\\end{corollary}\n\nLet $\\omega$ be a palindrome with kernel $K_m$ satisfying expression (1), $1\\leq i\\leq f_{m+1}$.\nBy Property \\ref{wp}, we get the relation between $P(\\omega,p)$ and $P(K_m,p)$. Using Property \\ref{P},\nwe have\n\n", "index": 9, "text": "$$P(\\omega,p)=P(K_m,p)+f_{m+1}-i=pf_{m+1}+(\\lfloor\\phi p\\rfloor+1)f_{m}-1+f_{m+1}-i.\\eqno(2)$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m1\" class=\"ltx_Math\" alttext=\"P(\\omega,p)=P(K_{m},p)+f_{m+1}-i=pf_{m+1}+(\\lfloor\\phi p\\rfloor+1)f_{m}-1+f_{m%&#10;+1}-i.\" display=\"block\"><mrow><mrow><mrow><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo>,</mo><mi>p</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mrow><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>K</mi><mi>m</mi></msub><mo>,</mo><mi>p</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mo>-</mo><mi>i</mi></mrow><mo>=</mo><mrow><mrow><mrow><mrow><mrow><mi>p</mi><mo>\u2062</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mo stretchy=\"false\">\u230a</mo><mrow><mi>\u03d5</mi><mo>\u2062</mo><mi>p</mi></mrow><mo stretchy=\"false\">\u230b</mo></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>f</mi><mi>m</mi></msub></mrow></mrow><mo>-</mo><mn>1</mn></mrow><mo>+</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mo>-</mo><mi>i</mi></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04391.tex", "nexttext": "\nSince $P(\\omega,1)=2f_{m+1}+f_m-i-1$ and $|\\omega|=f_{m+3}-2i$, we have $|\\omega|=P(\\omega,1)$ iff $i=f_{m+3}-2f_{m+1}-f_m+1=1\\in\\{1,\\cdots,f_{m+1}\\}.$\nThis means $\\mathbb{F}[1,n]$ is a palindrome iff $n=f_{m+3}-2$ for $m\\geq-1$,\ni.e. $n=f_m-2$ for $m\\geq2$, which is Theorem 14 in \\cite{DMSS2014}.\n\\end{remark}\n\n\n\nDefine the set\n$\\langle K_m,p\\rangle:=\\{P(\\omega,p):\\omega\\in\\mathcal{P},Ker(\\omega)=K_m\\},$\nwhich is the finite subset of $\\mathbb{N}$. \nBy the expression (2), we have\n\n\\begin{property}\\label{K}\nFor $m\\geq-1$, $p\\geq 1$,\n\n", "itemtype": "equation", "pos": 14810, "prevtext": "\n\n\\begin{remark} As a simple application of the expression (2), we give a necessary and sufficient condition\nsuch that the prefix $\\mathbb{F}[1,n]$ is a palindrome which was proved by J.Shallit et al \\cite{DMSS2014}. In fact,\n\n", "index": 11, "text": "$$\\{n:\\mathbb{F}[1,n]\\in\\mathcal{P}\\}=\\{n:\\omega\\in\\mathcal{P},|\\omega|=n,L(\\omega,1)=1\\}\n=\\{n:\\omega\\in\\mathcal{P},|\\omega|=P(\\omega,1)=n\\}.$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex6.m1\" class=\"ltx_Math\" alttext=\"\\{n:\\mathbb{F}[1,n]\\in\\mathcal{P}\\}=\\{n:\\omega\\in\\mathcal{P},|\\omega|=n,L(%&#10;\\omega,1)=1\\}=\\{n:\\omega\\in\\mathcal{P},|\\omega|=P(\\omega,1)=n\\}.\" display=\"block\"><mrow><mrow><mrow><mo stretchy=\"false\">{</mo><mi>n</mi><mo>:</mo><mrow><mrow><mi>\ud835\udd3d</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo>,</mo><mi>n</mi><mo stretchy=\"false\">]</mo></mrow></mrow><mo>\u2208</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcab</mi></mrow><mo stretchy=\"false\">}</mo></mrow><mo>=</mo><mrow><mo stretchy=\"false\">{</mo><mi>n</mi><mo>:</mo><mrow><mrow><mi>\u03c9</mi><mo>\u2208</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcab</mi></mrow><mo>,</mo><mrow><mrow><mrow><mo stretchy=\"false\">|</mo><mi>\u03c9</mi><mo stretchy=\"false\">|</mo></mrow><mo>=</mo><mi>n</mi></mrow><mo>,</mo><mrow><mrow><mi>L</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mn>1</mn></mrow></mrow></mrow><mo stretchy=\"false\">}</mo></mrow><mo>=</mo><mrow><mo stretchy=\"false\">{</mo><mi>n</mi><mo>:</mo><mrow><mrow><mi>\u03c9</mi><mo>\u2208</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcab</mi></mrow><mo>,</mo><mrow><mrow><mo stretchy=\"false\">|</mo><mi>\u03c9</mi><mo stretchy=\"false\">|</mo></mrow><mo>=</mo><mrow><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mi>n</mi></mrow></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04391.tex", "nexttext": "\n\\end{property}\n\nAn immediately corollary is $|\\langle K_m,p\\rangle|=|\\{1\\leq i\\leq f_{m+1}\\}|=f_{m+1}$.\n\nEspecially,\n$\\langle K_m,1\\rangle=\\{f_{m+2}-1,\\cdots,f_{m+3}-2\\}.$\nThus for $m\\geq -1$, two integer sets $\\langle K_m,1\\rangle$ and $\\langle K_{m+1},1\\rangle$ are consecutive.\nTherefore we get a chain $\\{\\langle K_m,1\\rangle\\}_{m\\geq-1}$ satisfying $\\bigsqcup_{m=-1}^\\infty\\langle K_m,1\\rangle=\\mathbb{N}$,\nsee Tab.2 below which we call the chain structure of $\\cal P$.\n\n\n\n\\vspace{0.2cm}\n\n\\centerline{Tab.2: The chain structure of palindromes.}\n\\vspace{-0.2cm}\n\\small\n\\begin{center}\n\\begin{tabular}{l|l|l|l|l|l|l|l|l}\n\\hline\n$\\langle a,1\\rangle$&$\\langle b,1\\rangle$&$\\langle aa,1\\rangle$&$\\langle K_2,1\\rangle$&$\\langle K_3,1\\rangle$&$\\langle K_4,1\\rangle$&$\\langle K_5,1\\rangle$&$\\langle K_6,1\\rangle$&$\\ldots$\\\\\n$\\{1\\}$&$\\{2,3\\}$&$\\{4,5,6\\}$&$\\{7,\\cdots,11\\}$&$\\{12,\\cdots,19\\}$\n&$\\{20,\\cdots,32\\}$&$\\{33,\\cdots,53\\}$&$\\{54,\\cdots,87\\}$&\\\\\\hline\n\\end{tabular}\n\\end{center}\n\\normalsize\n\n\\begin{theorem}\nFor $n\\geq1$, the number of distinct palindrome occurrences in $\\mathbb{F}[1,n]$ is $n$.\n\\end{theorem}\n\n\\begin{proof} By the chain structure of palindromes, for $n\\geq1$\n\n", "itemtype": "equation", "pos": 15491, "prevtext": "\nSince $P(\\omega,1)=2f_{m+1}+f_m-i-1$ and $|\\omega|=f_{m+3}-2i$, we have $|\\omega|=P(\\omega,1)$ iff $i=f_{m+3}-2f_{m+1}-f_m+1=1\\in\\{1,\\cdots,f_{m+1}\\}.$\nThis means $\\mathbb{F}[1,n]$ is a palindrome iff $n=f_{m+3}-2$ for $m\\geq-1$,\ni.e. $n=f_m-2$ for $m\\geq2$, which is Theorem 14 in \\cite{DMSS2014}.\n\\end{remark}\n\n\n\nDefine the set\n$\\langle K_m,p\\rangle:=\\{P(\\omega,p):\\omega\\in\\mathcal{P},Ker(\\omega)=K_m\\},$\nwhich is the finite subset of $\\mathbb{N}$. \nBy the expression (2), we have\n\n\\begin{property}\\label{K}\nFor $m\\geq-1$, $p\\geq 1$,\n\n", "index": 13, "text": "$$\\langle K_m,p\\rangle=\\{pf_{m+1}+(\\lfloor\\phi p\\rfloor+1) f_{m}-1,\\cdots,(p+1)f_{m+1}+(\\lfloor\\phi p\\rfloor+1)f_{m}-2\\}.\\eqno(3)$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex7.m1\" class=\"ltx_Math\" alttext=\"\\langle K_{m},p\\rangle=\\{pf_{m+1}+(\\lfloor\\phi p\\rfloor+1)f_{m}-1,\\cdots,(p+1)%&#10;f_{m+1}+(\\lfloor\\phi p\\rfloor+1)f_{m}-2\\}.\" display=\"block\"><mrow><mrow><mrow><mo stretchy=\"false\">\u27e8</mo><msub><mi>K</mi><mi>m</mi></msub><mo>,</mo><mi>p</mi><mo stretchy=\"false\">\u27e9</mo></mrow><mo>=</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mrow><mrow><mi>p</mi><mo>\u2062</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mo stretchy=\"false\">\u230a</mo><mrow><mi>\u03d5</mi><mo>\u2062</mo><mi>p</mi></mrow><mo stretchy=\"false\">\u230b</mo></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>f</mi><mi>m</mi></msub></mrow></mrow><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mi mathvariant=\"normal\">\u22ef</mi><mo>,</mo><mrow><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mo stretchy=\"false\">\u230a</mo><mrow><mi>\u03d5</mi><mo>\u2062</mo><mi>p</mi></mrow><mo stretchy=\"false\">\u230b</mo></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>f</mi><mi>m</mi></msub></mrow></mrow><mo>-</mo><mn>2</mn></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04391.tex", "nexttext": "\nThis is equivalent to our theorem.\n\\end{proof}\n\n\n\n\\section{The recursive structure of palindromes}\n\nIn this section, we establish a recursive structure of palindromes. Using it, we will count\nthe number of repeated palindrome occurrences in $\\mathbb{F}[1,n]$ in Section 6.\n\n\\begin{lemma}\\label{L1}\n$\\lfloor\\phi (p+\\lfloor\\phi p\\rfloor)\\rfloor=p-1$.\n\\end{lemma}\n\n\\begin{proof}\nNotice that $Ker(aba)=b$, by Property \\ref{wp}, we have $(aba)_p=a(b)_pa$. So\n\n", "itemtype": "equation", "pos": 16803, "prevtext": "\n\\end{property}\n\nAn immediately corollary is $|\\langle K_m,p\\rangle|=|\\{1\\leq i\\leq f_{m+1}\\}|=f_{m+1}$.\n\nEspecially,\n$\\langle K_m,1\\rangle=\\{f_{m+2}-1,\\cdots,f_{m+3}-2\\}.$\nThus for $m\\geq -1$, two integer sets $\\langle K_m,1\\rangle$ and $\\langle K_{m+1},1\\rangle$ are consecutive.\nTherefore we get a chain $\\{\\langle K_m,1\\rangle\\}_{m\\geq-1}$ satisfying $\\bigsqcup_{m=-1}^\\infty\\langle K_m,1\\rangle=\\mathbb{N}$,\nsee Tab.2 below which we call the chain structure of $\\cal P$.\n\n\n\n\\vspace{0.2cm}\n\n\\centerline{Tab.2: The chain structure of palindromes.}\n\\vspace{-0.2cm}\n\\small\n\\begin{center}\n\\begin{tabular}{l|l|l|l|l|l|l|l|l}\n\\hline\n$\\langle a,1\\rangle$&$\\langle b,1\\rangle$&$\\langle aa,1\\rangle$&$\\langle K_2,1\\rangle$&$\\langle K_3,1\\rangle$&$\\langle K_4,1\\rangle$&$\\langle K_5,1\\rangle$&$\\langle K_6,1\\rangle$&$\\ldots$\\\\\n$\\{1\\}$&$\\{2,3\\}$&$\\{4,5,6\\}$&$\\{7,\\cdots,11\\}$&$\\{12,\\cdots,19\\}$\n&$\\{20,\\cdots,32\\}$&$\\{33,\\cdots,53\\}$&$\\{54,\\cdots,87\\}$&\\\\\\hline\n\\end{tabular}\n\\end{center}\n\\normalsize\n\n\\begin{theorem}\nFor $n\\geq1$, the number of distinct palindrome occurrences in $\\mathbb{F}[1,n]$ is $n$.\n\\end{theorem}\n\n\\begin{proof} By the chain structure of palindromes, for $n\\geq1$\n\n", "index": 15, "text": "\\begin{equation*}\n\\begin{split}\n&\\bigsqcup_{m=-1}^\\infty\\langle K_m,1\\rangle=\\mathbb{N}\\Rightarrow\n|\\{\\omega:\\omega\\in\\mathcal{P},P(\\omega,1)=n\\}|=1\\Rightarrow\n|\\{\\omega:\\omega\\in\\mathcal{P},\\omega_1\\triangleright\\mathbb{F}[1,n]\\}|=1\\\\\n\\Rightarrow&|\\{\\omega:\\omega\\in\\mathcal{P},\\omega\\prec\\mathbb{F}[1,n],\n\\omega\\not\\!\\prec\\mathbb{F}[1,n-1]\\}|=1.\n\\end{split}\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex8.m1\" class=\"ltx_Math\" alttext=\"\\begin{split}&amp;\\displaystyle\\bigsqcup_{m=-1}^{\\infty}\\langle K_{m},1\\rangle=%&#10;\\mathbb{N}\\Rightarrow|\\{\\omega:\\omega\\in\\mathcal{P},P(\\omega,1)=n\\}|=1%&#10;\\Rightarrow|\\{\\omega:\\omega\\in\\mathcal{P},\\omega_{1}\\triangleright\\mathbb{F}[1%&#10;,n]\\}|=1\\\\&#10;\\displaystyle\\Rightarrow&amp;\\displaystyle|\\{\\omega:\\omega\\in\\mathcal{P},\\omega%&#10;\\prec\\mathbb{F}[1,n],\\omega\\not\\!\\prec\\mathbb{F}[1,n-1]\\}|=1.\\end{split}\" display=\"block\"><mtable columnspacing=\"0pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd/><mtd columnalign=\"left\"><mrow><mrow><munderover><mo largeop=\"true\" mathsize=\"160%\" movablelimits=\"false\" stretchy=\"false\" symmetric=\"true\">\u2294</mo><mrow><mi>m</mi><mo>=</mo><mrow><mo>-</mo><mn>1</mn></mrow></mrow><mi mathvariant=\"normal\">\u221e</mi></munderover><mrow><mo stretchy=\"false\">\u27e8</mo><msub><mi>K</mi><mi>m</mi></msub><mo>,</mo><mn>1</mn><mo stretchy=\"false\">\u27e9</mo></mrow></mrow><mo>=</mo><mi>\u2115</mi><mo>\u21d2</mo><mrow><mo stretchy=\"false\">|</mo><mrow><mo stretchy=\"false\">{</mo><mi>\u03c9</mi><mo>:</mo><mrow><mrow><mi>\u03c9</mi><mo>\u2208</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcab</mi></mrow><mo>,</mo><mrow><mrow><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mi>n</mi></mrow></mrow><mo stretchy=\"false\">}</mo></mrow><mo stretchy=\"false\">|</mo></mrow><mo>=</mo><mn>1</mn><mo>\u21d2</mo><mrow><mo stretchy=\"false\">|</mo><mrow><mo stretchy=\"false\">{</mo><mi>\u03c9</mi><mo>:</mo><mrow><mi>\u03c9</mi><mo>\u2208</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcab</mi><mo>,</mo><mrow><msub><mi>\u03c9</mi><mn>1</mn></msub><mo>\u25b7</mo><mrow><mi>\ud835\udd3d</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo>,</mo><mi>n</mi><mo stretchy=\"false\">]</mo></mrow></mrow></mrow></mrow></mrow><mo stretchy=\"false\">}</mo></mrow><mo stretchy=\"false\">|</mo></mrow><mo>=</mo><mn>1</mn></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mo>\u21d2</mo></mtd><mtd columnalign=\"left\"><mrow><mrow><mrow><mo stretchy=\"false\">|</mo><mrow><mo stretchy=\"false\">{</mo><mi>\u03c9</mi><mo>:</mo><mrow><mrow><mi>\u03c9</mi><mo>\u2208</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcab</mi></mrow><mo>,</mo><mrow><mrow><mi>\u03c9</mi><mo>\u227a</mo><mrow><mi>\ud835\udd3d</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo>,</mo><mi>n</mi><mo stretchy=\"false\">]</mo></mrow></mrow></mrow><mo>,</mo><mrow><mrow><mi>\u03c9</mi><mo>\u2062</mo><menclose notation=\"updiagonalstrike\"><mspace width=\"-1.7pt\"/></menclose></mrow><mo>\u227a</mo><mrow><mi>\ud835\udd3d</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo>,</mo><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow></mrow></mrow><mo stretchy=\"false\">}</mo></mrow><mo stretchy=\"false\">|</mo></mrow><mo>=</mo><mn>1</mn></mrow><mo>.</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.04391.tex", "nexttext": "\n\nOn the other hand, by Property \\ref{G}, the $p$-th occurrence of $aba=r_1(a)a$ is equal to the $L(a,p)$-th occurrence of $a$. This means $L(aba,p)=L(a,L(a,p))$, i.e.,\n\n", "itemtype": "equation", "pos": 17633, "prevtext": "\nThis is equivalent to our theorem.\n\\end{proof}\n\n\n\n\\section{The recursive structure of palindromes}\n\nIn this section, we establish a recursive structure of palindromes. Using it, we will count\nthe number of repeated palindrome occurrences in $\\mathbb{F}[1,n]$ in Section 6.\n\n\\begin{lemma}\\label{L1}\n$\\lfloor\\phi (p+\\lfloor\\phi p\\rfloor)\\rfloor=p-1$.\n\\end{lemma}\n\n\\begin{proof}\nNotice that $Ker(aba)=b$, by Property \\ref{wp}, we have $(aba)_p=a(b)_pa$. So\n\n", "index": 17, "text": "$$P(aba,p)=P(b,p)+1=2p+\\lfloor\\phi p\\rfloor+1.$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex9.m1\" class=\"ltx_Math\" alttext=\"P(aba,p)=P(b,p)+1=2p+\\lfloor\\phi p\\rfloor+1.\" display=\"block\"><mrow><mrow><mrow><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>a</mi><mo>\u2062</mo><mi>b</mi><mo>\u2062</mo><mi>a</mi></mrow><mo>,</mo><mi>p</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>b</mi><mo>,</mo><mi>p</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mn>1</mn></mrow><mo>=</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>p</mi></mrow><mo>+</mo><mrow><mo stretchy=\"false\">\u230a</mo><mrow><mi>\u03d5</mi><mo>\u2062</mo><mi>p</mi></mrow><mo stretchy=\"false\">\u230b</mo></mrow><mo>+</mo><mn>1</mn></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04391.tex", "nexttext": "\n\nCompare the two expressions of $P(aba,p)$, we have $p-1=\\lfloor\\phi (p+\\lfloor\\phi p\\rfloor)\\rfloor$.\n\\end{proof}\n\n\\begin{remark}\\label{L2}\nBy an analogous argument, we can get interesting identity:\n$p+\\lfloor\\phi p\\rfloor=\\lfloor\\phi (2p+\\lfloor\\phi p\\rfloor)\\rfloor.$\n\\end{remark}\n\n\\begin{lemma}\\label{L3} $\\lfloor\\phi(p+\\lfloor\\phi p\\rfloor+1)\\rfloor=p$.\\end{lemma}\n\n\\begin{proof}\nWe only need to prove $p\\leq\\phi(p+\\lfloor\\phi p\\rfloor+1)<p+1$.\n\nBy Lemma \\ref{L1}, $\\lfloor\\phi (p+\\lfloor\\phi p\\rfloor)\\rfloor=p-1$. So\n$\\phi(p+\\lfloor\\phi p\\rfloor)<p$, $\\phi(p+\\lfloor\\phi p\\rfloor+1)<p+\\phi<p+1$.\n\nOn the other hand, by Corollary \\ref{P1}, $P(a,p)=p+\\lfloor\\phi p\\rfloor$,\nA known result is $L(a,p)=\\lfloor p/\\phi\\rfloor$.\nSince $L(a,p)=P(a,p)$, $\\lfloor p/\\phi\\rfloor=p+\\lfloor\\phi p\\rfloor$.\nSo $\\phi(\\lfloor p/\\phi\\rfloor+1)=\\phi(p+\\lfloor\\phi p\\rfloor+1)$.\nBy the definition of function $\\lfloor\\cdot\\rfloor$, $\\lfloor p/\\phi\\rfloor+1\\geq p/\\phi$, i.e. $\\phi(\\lfloor p/\\phi\\rfloor+1)\\geq p$.\nThus $\\phi(p+\\lfloor\\phi p\\rfloor+1)\\geq p$.\n\\end{proof}\n\n\\begin{lemma}\\label{L4}\n$\\lfloor\\phi(2p+\\lfloor\\phi p\\rfloor+1)\\rfloor=p+\\lfloor\\phi p\\rfloor$.\n\\end{lemma}\n\n\\begin{proof} By Property \\ref{G}, the $p$-th occurrence of $aa=r_2(a)a$ is equal to the $L(b,p)$-th occurrence of\n$a$. An immediate corollary is: the $(L(b,p)+1)$-th occurrence of\n$a$ is at position $L(aa,p)+1=P(aa,p)$.\nThis means $P(aa,p)=P(a,P(b,p)+1)=P(a,2p+\\lfloor\\phi p\\rfloor+1)$. By Corollary \\ref{P1},\n\n", "itemtype": "equation", "pos": 17850, "prevtext": "\n\nOn the other hand, by Property \\ref{G}, the $p$-th occurrence of $aba=r_1(a)a$ is equal to the $L(a,p)$-th occurrence of $a$. This means $L(aba,p)=L(a,L(a,p))$, i.e.,\n\n", "index": 19, "text": "$$P(aba,p)=P(a,P(a,p))+2=P(a,p)+\\lfloor\\phi P(a,p)\\rfloor+2=p+\\lfloor\\phi p\\rfloor+\\lfloor\\phi (p+\\lfloor\\phi p\\rfloor)\\rfloor+2.$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex10.m1\" class=\"ltx_Math\" alttext=\"P(aba,p)=P(a,P(a,p))+2=P(a,p)+\\lfloor\\phi P(a,p)\\rfloor+2=p+\\lfloor\\phi p%&#10;\\rfloor+\\lfloor\\phi(p+\\lfloor\\phi p\\rfloor)\\rfloor+2.\" display=\"block\"><mrow><mrow><mrow><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>a</mi><mo>\u2062</mo><mi>b</mi><mo>\u2062</mo><mi>a</mi></mrow><mo>,</mo><mi>p</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>a</mi><mo>,</mo><mrow><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>a</mi><mo>,</mo><mi>p</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mn>2</mn></mrow><mo>=</mo><mrow><mrow><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>a</mi><mo>,</mo><mi>p</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mo stretchy=\"false\">\u230a</mo><mrow><mi>\u03d5</mi><mo>\u2062</mo><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>a</mi><mo>,</mo><mi>p</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">\u230b</mo></mrow><mo>+</mo><mn>2</mn></mrow><mo>=</mo><mrow><mi>p</mi><mo>+</mo><mrow><mo stretchy=\"false\">\u230a</mo><mrow><mi>\u03d5</mi><mo>\u2062</mo><mi>p</mi></mrow><mo stretchy=\"false\">\u230b</mo></mrow><mo>+</mo><mrow><mo stretchy=\"false\">\u230a</mo><mrow><mi>\u03d5</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>p</mi><mo>+</mo><mrow><mo stretchy=\"false\">\u230a</mo><mrow><mi>\u03d5</mi><mo>\u2062</mo><mi>p</mi></mrow><mo stretchy=\"false\">\u230b</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">\u230b</mo></mrow><mo>+</mo><mn>2</mn></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04391.tex", "nexttext": "\nSo $p+\\lfloor\\phi p\\rfloor=\\lfloor\\phi(2p+\\lfloor\\phi p\\rfloor+1)\\rfloor$.\n\\end{proof}\n\n\\begin{property}\\label{P4.1}\n$\\langle K_m,p\\rangle=\\langle K_{m-2},P(b,p)+1\\rangle\\sqcup\\langle K_{m-1},P(a,p)+1\\rangle$ for $m\\geq1$.\n\\end{property}\n\n\\begin{proof} By Lemma \\ref{L4}, $\\lfloor\\phi(2p+\\lfloor\\phi p\\rfloor+1)\\rfloor=p+\\lfloor\\phi p\\rfloor$. By Property \\ref{P},\n\n", "itemtype": "equation", "pos": 19462, "prevtext": "\n\nCompare the two expressions of $P(aba,p)$, we have $p-1=\\lfloor\\phi (p+\\lfloor\\phi p\\rfloor)\\rfloor$.\n\\end{proof}\n\n\\begin{remark}\\label{L2}\nBy an analogous argument, we can get interesting identity:\n$p+\\lfloor\\phi p\\rfloor=\\lfloor\\phi (2p+\\lfloor\\phi p\\rfloor)\\rfloor.$\n\\end{remark}\n\n\\begin{lemma}\\label{L3} $\\lfloor\\phi(p+\\lfloor\\phi p\\rfloor+1)\\rfloor=p$.\\end{lemma}\n\n\\begin{proof}\nWe only need to prove $p\\leq\\phi(p+\\lfloor\\phi p\\rfloor+1)<p+1$.\n\nBy Lemma \\ref{L1}, $\\lfloor\\phi (p+\\lfloor\\phi p\\rfloor)\\rfloor=p-1$. So\n$\\phi(p+\\lfloor\\phi p\\rfloor)<p$, $\\phi(p+\\lfloor\\phi p\\rfloor+1)<p+\\phi<p+1$.\n\nOn the other hand, by Corollary \\ref{P1}, $P(a,p)=p+\\lfloor\\phi p\\rfloor$,\nA known result is $L(a,p)=\\lfloor p/\\phi\\rfloor$.\nSince $L(a,p)=P(a,p)$, $\\lfloor p/\\phi\\rfloor=p+\\lfloor\\phi p\\rfloor$.\nSo $\\phi(\\lfloor p/\\phi\\rfloor+1)=\\phi(p+\\lfloor\\phi p\\rfloor+1)$.\nBy the definition of function $\\lfloor\\cdot\\rfloor$, $\\lfloor p/\\phi\\rfloor+1\\geq p/\\phi$, i.e. $\\phi(\\lfloor p/\\phi\\rfloor+1)\\geq p$.\nThus $\\phi(p+\\lfloor\\phi p\\rfloor+1)\\geq p$.\n\\end{proof}\n\n\\begin{lemma}\\label{L4}\n$\\lfloor\\phi(2p+\\lfloor\\phi p\\rfloor+1)\\rfloor=p+\\lfloor\\phi p\\rfloor$.\n\\end{lemma}\n\n\\begin{proof} By Property \\ref{G}, the $p$-th occurrence of $aa=r_2(a)a$ is equal to the $L(b,p)$-th occurrence of\n$a$. An immediate corollary is: the $(L(b,p)+1)$-th occurrence of\n$a$ is at position $L(aa,p)+1=P(aa,p)$.\nThis means $P(aa,p)=P(a,P(b,p)+1)=P(a,2p+\\lfloor\\phi p\\rfloor+1)$. By Corollary \\ref{P1},\n\n", "index": 21, "text": "$$3p+2\\lfloor\\phi p\\rfloor+1=2p+\\lfloor\\phi p\\rfloor+1+\\lfloor\\phi(2p+\\lfloor\\phi p\\rfloor+1)\\rfloor.$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex11.m1\" class=\"ltx_Math\" alttext=\"3p+2\\lfloor\\phi p\\rfloor+1=2p+\\lfloor\\phi p\\rfloor+1+\\lfloor\\phi(2p+\\lfloor%&#10;\\phi p\\rfloor+1)\\rfloor.\" display=\"block\"><mrow><mrow><mrow><mrow><mn>3</mn><mo>\u2062</mo><mi>p</mi></mrow><mo>+</mo><mrow><mn>2</mn><mo>\u2062</mo><mrow><mo stretchy=\"false\">\u230a</mo><mrow><mi>\u03d5</mi><mo>\u2062</mo><mi>p</mi></mrow><mo stretchy=\"false\">\u230b</mo></mrow></mrow><mo>+</mo><mn>1</mn></mrow><mo>=</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>p</mi></mrow><mo>+</mo><mrow><mo stretchy=\"false\">\u230a</mo><mrow><mi>\u03d5</mi><mo>\u2062</mo><mi>p</mi></mrow><mo stretchy=\"false\">\u230b</mo></mrow><mo>+</mo><mn>1</mn><mo>+</mo><mrow><mo stretchy=\"false\">\u230a</mo><mrow><mi>\u03d5</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>p</mi></mrow><mo>+</mo><mrow><mo stretchy=\"false\">\u230a</mo><mrow><mi>\u03d5</mi><mo>\u2062</mo><mi>p</mi></mrow><mo stretchy=\"false\">\u230b</mo></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">\u230b</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04391.tex", "nexttext": "\nSince $\\min\\langle K_m,p\\rangle=pf_{m+1}+(\\lfloor\\phi p\\rfloor+1)f_{m}-1$, $\\min\\langle K_{m-2},P(b,p)+1\\rangle=\\min\\langle K_m,p\\rangle$.\n\n\nBy Lemma \\ref{L3} and Property \\ref{P}, we have \n$\\max\\langle K_{m-1},P(a,p)+1\\rangle=\\max\\langle K_m,p\\rangle$.\n\nSimilarly, $\\max\\langle K_{m-2},P(b,p)+1\\rangle+1=\\min\\langle K_{m-1},P(a,p)+1\\rangle$. So the conclusion holds.\n\\end{proof}\n\nFor instance, taking $m=4$ and $p=1$, we have $P(b,p)+1=3$ and $P(a,p)+1=2$. Thus $\\langle K_4,1\\rangle=\\{20,\\cdots,32\\}$ is the disjoint unite of $\\langle K_2,3\\rangle=\\{20,\\cdots,24\\}$ and $\\langle K_3,2\\rangle=\\{25,\\cdots,32\\}$.\n\n\\begin{property}[]\\label{P4.2}\n$\\max\\langle b,p\\rangle=\\langle a,P(a,p)+1\\rangle$  for $p\\geq1$.\n\\end{property}\n\n\\begin{proof} By Corollary \\ref{P1}, $P(a,p)=p+\\lfloor\\phi p\\rfloor$. By Lemma \\ref{L3}, $\\lfloor\\phi(p+\\lfloor\\phi p\\rfloor+1)\\rfloor=p$. So\n\n", "itemtype": "equation", "pos": 19931, "prevtext": "\nSo $p+\\lfloor\\phi p\\rfloor=\\lfloor\\phi(2p+\\lfloor\\phi p\\rfloor+1)\\rfloor$.\n\\end{proof}\n\n\\begin{property}\\label{P4.1}\n$\\langle K_m,p\\rangle=\\langle K_{m-2},P(b,p)+1\\rangle\\sqcup\\langle K_{m-1},P(a,p)+1\\rangle$ for $m\\geq1$.\n\\end{property}\n\n\\begin{proof} By Lemma \\ref{L4}, $\\lfloor\\phi(2p+\\lfloor\\phi p\\rfloor+1)\\rfloor=p+\\lfloor\\phi p\\rfloor$. By Property \\ref{P},\n\n", "index": 23, "text": "\\begin{equation*}\n\\begin{split}\n&\\min\\langle K_{m-2},P(b,p)+1\\rangle=\\min\\langle K_{m-2},2p+\\lfloor\\phi p\\rfloor+1\\rangle\\\\\n=&(2p+\\lfloor\\phi p\\rfloor+1)f_{m-1}+(\\lfloor\\phi(2p+\\lfloor\\phi p\\rfloor+1)\\rfloor+1) f_{m-2}-1\\\\\n=&(2p+\\lfloor\\phi p\\rfloor+1)f_{m-1}+(p+\\lfloor\\phi p\\rfloor+1) f_{m-2}-1\n=pf_{m+1}+(\\lfloor\\phi p\\rfloor+1)f_{m}-1.\n\\end{split}\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex12.m1\" class=\"ltx_Math\" alttext=\"\\begin{split}&amp;\\displaystyle\\min\\langle K_{m-2},P(b,p)+1\\rangle=\\min\\langle K_{%&#10;m-2},2p+\\lfloor\\phi p\\rfloor+1\\rangle\\\\&#10;\\displaystyle=&amp;\\displaystyle(2p+\\lfloor\\phi p\\rfloor+1)f_{m-1}+(\\lfloor\\phi(2p%&#10;+\\lfloor\\phi p\\rfloor+1)\\rfloor+1)f_{m-2}-1\\\\&#10;\\displaystyle=&amp;\\displaystyle(2p+\\lfloor\\phi p\\rfloor+1)f_{m-1}+(p+\\lfloor\\phi p%&#10;\\rfloor+1)f_{m-2}-1=pf_{m+1}+(\\lfloor\\phi p\\rfloor+1)f_{m}-1.\\end{split}\" display=\"block\"><mtable columnspacing=\"0pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd/><mtd columnalign=\"left\"><mrow><mrow><mi>min</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">\u27e8</mo><msub><mi>K</mi><mrow><mi>m</mi><mo>-</mo><mn>2</mn></mrow></msub><mo>,</mo><mrow><mrow><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>b</mi><mo>,</mo><mi>p</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">\u27e9</mo></mrow></mrow><mo>=</mo><mrow><mi>min</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">\u27e8</mo><msub><mi>K</mi><mrow><mi>m</mi><mo>-</mo><mn>2</mn></mrow></msub><mo>,</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>p</mi></mrow><mo>+</mo><mrow><mo stretchy=\"false\">\u230a</mo><mrow><mi>\u03d5</mi><mo>\u2062</mo><mi>p</mi></mrow><mo stretchy=\"false\">\u230b</mo></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">\u27e9</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mo>=</mo></mtd><mtd columnalign=\"left\"><mrow><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>p</mi></mrow><mo>+</mo><mrow><mo stretchy=\"false\">\u230a</mo><mrow><mi>\u03d5</mi><mo>\u2062</mo><mi>p</mi></mrow><mo stretchy=\"false\">\u230b</mo></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mo stretchy=\"false\">\u230a</mo><mrow><mi>\u03d5</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>p</mi></mrow><mo>+</mo><mrow><mo stretchy=\"false\">\u230a</mo><mrow><mi>\u03d5</mi><mo>\u2062</mo><mi>p</mi></mrow><mo stretchy=\"false\">\u230b</mo></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">\u230b</mo></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>2</mn></mrow></msub></mrow></mrow><mo>-</mo><mn>1</mn></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mo>=</mo></mtd><mtd columnalign=\"left\"><mrow><mrow><mrow><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>p</mi></mrow><mo>+</mo><mrow><mo stretchy=\"false\">\u230a</mo><mrow><mi>\u03d5</mi><mo>\u2062</mo><mi>p</mi></mrow><mo stretchy=\"false\">\u230b</mo></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>p</mi><mo>+</mo><mrow><mo stretchy=\"false\">\u230a</mo><mrow><mi>\u03d5</mi><mo>\u2062</mo><mi>p</mi></mrow><mo stretchy=\"false\">\u230b</mo></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>2</mn></mrow></msub></mrow></mrow><mo>-</mo><mn>1</mn></mrow><mo>=</mo><mrow><mrow><mrow><mi>p</mi><mo>\u2062</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mo stretchy=\"false\">\u230a</mo><mrow><mi>\u03d5</mi><mo>\u2062</mo><mi>p</mi></mrow><mo stretchy=\"false\">\u230b</mo></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>f</mi><mi>m</mi></msub></mrow></mrow><mo>-</mo><mn>1</mn></mrow></mrow><mo>.</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.04391.tex", "nexttext": "\nBy expression (3), $\\max\\langle b,p\\rangle\n=(p+1)f_{1}+(\\lfloor\\phi p\\rfloor+1)f_{0}-2=2p+\\lfloor\\phi p\\rfloor+1=\\langle a,P(a,p)+1\\rangle$.\n\\end{proof}\n\nFrom properties \\ref{P4.1} and \\ref{P4.2}, we can establish the following recursive relations for any $\\langle K_m,p\\rangle$, which we call the recursive structure of $\\cal P$.\n\n", "itemtype": "equation", "pos": 21168, "prevtext": "\nSince $\\min\\langle K_m,p\\rangle=pf_{m+1}+(\\lfloor\\phi p\\rfloor+1)f_{m}-1$, $\\min\\langle K_{m-2},P(b,p)+1\\rangle=\\min\\langle K_m,p\\rangle$.\n\n\nBy Lemma \\ref{L3} and Property \\ref{P}, we have \n$\\max\\langle K_{m-1},P(a,p)+1\\rangle=\\max\\langle K_m,p\\rangle$.\n\nSimilarly, $\\max\\langle K_{m-2},P(b,p)+1\\rangle+1=\\min\\langle K_{m-1},P(a,p)+1\\rangle$. So the conclusion holds.\n\\end{proof}\n\nFor instance, taking $m=4$ and $p=1$, we have $P(b,p)+1=3$ and $P(a,p)+1=2$. Thus $\\langle K_4,1\\rangle=\\{20,\\cdots,32\\}$ is the disjoint unite of $\\langle K_2,3\\rangle=\\{20,\\cdots,24\\}$ and $\\langle K_3,2\\rangle=\\{25,\\cdots,32\\}$.\n\n\\begin{property}[]\\label{P4.2}\n$\\max\\langle b,p\\rangle=\\langle a,P(a,p)+1\\rangle$  for $p\\geq1$.\n\\end{property}\n\n\\begin{proof} By Corollary \\ref{P1}, $P(a,p)=p+\\lfloor\\phi p\\rfloor$. By Lemma \\ref{L3}, $\\lfloor\\phi(p+\\lfloor\\phi p\\rfloor+1)\\rfloor=p$. So\n\n", "index": 25, "text": "$$\\langle a,P(a,p)+1\\rangle\n=\\langle a,p+\\lfloor\\phi p\\rfloor+1\\rangle\n=p+\\lfloor\\phi p\\rfloor+1+\\lfloor\\phi(p+\\lfloor\\phi p\\rfloor+1)\\rfloor\n=p+\\lfloor\\phi p\\rfloor+1+p.$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex13.m1\" class=\"ltx_Math\" alttext=\"\\langle a,P(a,p)+1\\rangle=\\langle a,p+\\lfloor\\phi p\\rfloor+1\\rangle=p+\\lfloor%&#10;\\phi p\\rfloor+1+\\lfloor\\phi(p+\\lfloor\\phi p\\rfloor+1)\\rfloor=p+\\lfloor\\phi p%&#10;\\rfloor+1+p.\" display=\"block\"><mrow><mrow><mrow><mo stretchy=\"false\">\u27e8</mo><mi>a</mi><mo>,</mo><mrow><mrow><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>a</mi><mo>,</mo><mi>p</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">\u27e9</mo></mrow><mo>=</mo><mrow><mo stretchy=\"false\">\u27e8</mo><mi>a</mi><mo>,</mo><mrow><mi>p</mi><mo>+</mo><mrow><mo stretchy=\"false\">\u230a</mo><mrow><mi>\u03d5</mi><mo>\u2062</mo><mi>p</mi></mrow><mo stretchy=\"false\">\u230b</mo></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">\u27e9</mo></mrow><mo>=</mo><mrow><mi>p</mi><mo>+</mo><mrow><mo stretchy=\"false\">\u230a</mo><mrow><mi>\u03d5</mi><mo>\u2062</mo><mi>p</mi></mrow><mo stretchy=\"false\">\u230b</mo></mrow><mo>+</mo><mn>1</mn><mo>+</mo><mrow><mo stretchy=\"false\">\u230a</mo><mrow><mi>\u03d5</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>p</mi><mo>+</mo><mrow><mo stretchy=\"false\">\u230a</mo><mrow><mi>\u03d5</mi><mo>\u2062</mo><mi>p</mi></mrow><mo stretchy=\"false\">\u230b</mo></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">\u230b</mo></mrow></mrow><mo>=</mo><mrow><mi>p</mi><mo>+</mo><mrow><mo stretchy=\"false\">\u230a</mo><mrow><mi>\u03d5</mi><mo>\u2062</mo><mi>p</mi></mrow><mo stretchy=\"false\">\u230b</mo></mrow><mo>+</mo><mn>1</mn><mo>+</mo><mi>p</mi></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04391.tex", "nexttext": "\n\n\nOn the other hand, (a) For any $m\\geq-1$, each $\\langle K_{m},1\\rangle$ belongs to the recursive structure.\n(b) Since $\\mathbb{F}$ over alphabet $\\{a,b\\}$, $\\mathbb{N}=\\{1\\}\\sqcup\\{P(a,\\hat{p})+1\\}\\sqcup\\{P(b,\\hat{p})+1\\}$. So for any $p\\geq2$, there exists\n$\\hat{p}$ such that $P(a,\\hat{p})+1=p$ or $P(b,\\hat{p})+1=p$.\n\n", "itemtype": "equation", "pos": 21672, "prevtext": "\nBy expression (3), $\\max\\langle b,p\\rangle\n=(p+1)f_{1}+(\\lfloor\\phi p\\rfloor+1)f_{0}-2=2p+\\lfloor\\phi p\\rfloor+1=\\langle a,P(a,p)+1\\rangle$.\n\\end{proof}\n\nFrom properties \\ref{P4.1} and \\ref{P4.2}, we can establish the following recursive relations for any $\\langle K_m,p\\rangle$, which we call the recursive structure of $\\cal P$.\n\n", "index": 27, "text": "\\begin{equation*}\n\\begin{cases}\n\\tau_1\\langle K_m,p\\rangle:=\\langle K_{m-2},P(b,p)+1\\rangle\\sqcup\\langle K_{m-1},P(a,p)+1\\rangle&\\text{for }m\\geq1;\\\\\n\\tau_2\\langle K_0,p\\rangle=\\tau_2\\langle b,p\\rangle:=\\langle K_{-1},P(a,p)+1\\rangle.\n\\end{cases}\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex14.m1\" class=\"ltx_Math\" alttext=\"\\begin{cases}\\tau_{1}\\langle K_{m},p\\rangle:=\\langle K_{m-2},P(b,p)+1\\rangle%&#10;\\sqcup\\langle K_{m-1},P(a,p)+1\\rangle&amp;\\text{for }m\\geq 1;\\\\&#10;\\tau_{2}\\langle K_{0},p\\rangle=\\tau_{2}\\langle b,p\\rangle:=\\langle K_{-1},P(a,%&#10;p)+1\\rangle.\\end{cases}\" display=\"block\"><mrow><mo>{</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><mrow><msub><mi>\u03c4</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">\u27e8</mo><msub><mi>K</mi><mi>m</mi></msub><mo>,</mo><mi>p</mi><mo stretchy=\"false\">\u27e9</mo></mrow></mrow><mo>:=</mo><mrow><mrow><mo stretchy=\"false\">\u27e8</mo><msub><mi>K</mi><mrow><mi>m</mi><mo>-</mo><mn>2</mn></mrow></msub><mo>,</mo><mrow><mrow><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>b</mi><mo>,</mo><mi>p</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">\u27e9</mo></mrow><mo>\u2294</mo><mrow><mo stretchy=\"false\">\u27e8</mo><msub><mi>K</mi><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>,</mo><mrow><mrow><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>a</mi><mo>,</mo><mi>p</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">\u27e9</mo></mrow></mrow></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mrow><mtext>for\u00a0</mtext><mo>\u2062</mo><mi>m</mi></mrow><mo>\u2265</mo><mn>1</mn></mrow><mo>;</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mrow><mrow><mrow><msub><mi>\u03c4</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">\u27e8</mo><msub><mi>K</mi><mn>0</mn></msub><mo>,</mo><mi>p</mi><mo stretchy=\"false\">\u27e9</mo></mrow></mrow><mo>=</mo><mrow><msub><mi>\u03c4</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">\u27e8</mo><mi>b</mi><mo>,</mo><mi>p</mi><mo stretchy=\"false\">\u27e9</mo></mrow></mrow><mo>:=</mo><mrow><mo stretchy=\"false\">\u27e8</mo><msub><mi>K</mi><mrow><mo>-</mo><mn>1</mn></mrow></msub><mo>,</mo><mrow><mrow><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>a</mi><mo>,</mo><mi>p</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">\u27e9</mo></mrow></mrow><mo>.</mo></mrow></mtd><mtd/></mtr></mtable></mrow></math>", "type": "latex"}, {"file": "1601.04391.tex", "nexttext": "\n\nThus the recursive structure contains all $\\langle K_m,p\\rangle$, i.e. contains all palindromes in $\\mathbb{F}$.\n\n\\vspace{-0.3cm}\n\\small\n\\setlength{\\unitlength}{1.2mm}\n\\begin{center}\n\\begin{picture}(70,65)\n\\put(0,0.5){\\line(1,0){70}}\n\\put(0,63.5){\\line(1,0){70}}\n\\put(0,0.5){\\line(0,1){63}}\n\\put(11,0.5){\\line(0,1){63}}\n\\put(22,0.5){\\line(0,1){63}}\n\\put(33,0.5){\\line(0,1){63}}\n\\put(44,0.5){\\line(0,1){63}}\n\\put(56,0.5){\\line(0,1){63}}\n\\put(70,0.5){\\line(0,1){63}}\n\\put(4,1){32}\n\\put(4,4){31}\n\\put(4,10){30}\n\\put(4,16){29}\n\\put(4,19){28}\n\\put(4,25){27}\n\\put(4,28){26}\n\\put(4,34){25}\n\\put(4,40){24}\n\\put(4,43){23}\n\\put(4,49){22}\n\\put(4,55){21}\n\\put(4,58){20}\n\\put(1,61){$\\langle K_4,1\\rangle$}\n\\put(26,40){24}\n\\put(26,43){23}\n\\put(26,49){22}\n\\put(26,55){21}\n\\put(26,58){20}\n\\put(23,61){$\\langle K_2,3\\rangle$}\n\\put(15,1){32}\n\\put(15,4){31}\n\\put(15,10){30}\n\\put(15,16){29}\n\\put(15,19){28}\n\\put(15,25){27}\n\\put(15,28){26}\n\\put(15,34){25}\n\\put(12,37){$\\langle K_3,2\\rangle$}\n\\put(11,39.5){\\line(1,0){59}}\n\\put(26,1){32}\n\\put(26,4){31}\n\\put(26,10){30}\n\\put(26,16){29}\n\\put(26,19){28}\n\\put(23,22){$\\langle K_2,4\\rangle$}\n\\put(22,24.5){\\line(1,0){48}}\n\\put(37,40){24}\n\\put(37,43){23}\n\\put(37,49){22}\n\\put(34,52){$\\langle K_1,5\\rangle$}\n\\put(33,54.5){\\line(1,0){37}}\n\\put(37,25){27}\n\\put(37,28){26}\n\\put(37,34){25}\n\\put(34,37){$\\langle K_1,6\\rangle$}\n\\put(37,1){32}\n\\put(37,4){31}\n\\put(37,10){30}\n\\put(34,13){$\\langle K_1,7\\rangle$}\n\\put(33,15.5){\\line(1,0){37}}\n\\put(48,55){21}\n\\put(48,58){20}\n\\put(45,61){$\\langle K_0,8\\rangle$}\n\\put(48,40){24}\n\\put(48,43){23}\n\\put(45,46){$\\langle K_0,9\\rangle$}\n\\put(44,48.5){\\line(1,0){26}}\n\\put(48,25){27}\n\\put(48,28){26}\n\\put(45,31){$\\langle K_0,10\\rangle$}\n\\put(44,33.5){\\line(1,0){26}}\n\\put(48,16){29}\n\\put(48,19){28}\n\\put(45,22){$\\langle K_0,11\\rangle$}\n\\put(48,1){32}\n\\put(48,4){31}\n\\put(45,7){$\\langle K_0,12\\rangle$}\n\\put(44,9.5){\\line(1,0){26}}\n\\put(62,55){21}\n\\put(57,61){$\\langle K_{-1},13\\rangle$}\n\\put(62,49){22}\n\\put(57,52){$\\langle K_{-1},14\\rangle$}\n\\put(62,40){24}\n\\put(57,46){$\\langle K_{-1},15\\rangle$}\n\\put(62,34){25}\n\\put(57,37){$\\langle K_{-1},16\\rangle$}\n\\put(62,25){27}\n\\put(57,31){$\\langle K_{-1},17\\rangle$}\n\\put(62,16){29}\n\\put(57,22){$\\langle K_{-1},18\\rangle$}\n\\put(62,10){30}\n\\put(57,13){$\\langle K_{-1},19\\rangle$}\n\\put(62,1){32}\n\\put(57,7){$\\langle K_{-1},20\\rangle$}\n\\end{picture}\n\\end{center}\n\\normalsize\n\\vspace{-0.4cm}\n\\centerline{(a)}\n\n\\small\n\\setlength{\\unitlength}{1.85mm}\n\\newsavebox{\\bb}\n\\savebox{\\bb}(7,3.5){\n\\begin{picture}(7,3.5)\n\\put(0,0){\\line(1,0){7}}\n\\put(0,3.5){\\line(1,0){7}}\n\\put(0,0){\\line(0,1){3.5}}\n\\put(7,0){\\line(0,1){3.5}}\n\\end{picture}}\n\\newsavebox{\\bbb}\n\\savebox{\\bbb}(9,3.5){\n\\begin{picture}(9,3.5)\n\\put(0,0){\\line(1,0){9}}\n\\put(0,3.5){\\line(1,0){9}}\n\\put(0,0){\\line(0,1){3.5}}\n\\put(9,0){\\line(0,1){3.5}}\n\\end{picture}}\n\n\\begin{center}\n\\begin{picture}(60,42)\n\\put(1,41){$\\langle K_4,1\\rangle$}\n\\put(0,40){\\usebox{\\bb}}\n\\put(8,42){\\vector(1,0){11.5}}\n\\put(8,42){\\vector(1,-3){4.3}}\n\\put(21,41){$\\langle K_2,3\\rangle$}\n\\put(20,40){\\usebox{\\bb}}\n\\put(28,42){\\vector(1,0){12}}\n\\put(28,42){\\vector(1,-1){3}}\n\\put(41,41){$\\langle K_0,8\\rangle$}\n\\put(40,40){\\usebox{\\bb}}\n\\put(51,41){$\\langle K_{-1},13\\rangle$}\n\\put(50,40){\\usebox{\\bbb}}\n\\put(48,42){\\vector(1,0){2}}\n\\put(31,36){$\\langle K_1,5\\rangle$}\n\\put(30,35){\\usebox{\\bb}}\n\\put(38,37){\\vector(1,0){12}}\n\\put(38,37){\\vector(1,-1){3}}\n\\put(51,36){$\\langle K_{-1},14\\rangle$}\n\\put(50,35){\\usebox{\\bbb}}\n\\put(41,31){$\\langle K_0,9\\rangle$}\n\\put(40,30){\\usebox{\\bb}}\n\\put(51,31){$\\langle K_{-1},15\\rangle$}\n\\put(50,30){\\usebox{\\bbb}}\n\\put(48,32){\\vector(1,0){2}}\n\\put(11,26){$\\langle K_3,2\\rangle$}\n\\put(10,25){\\usebox{\\bb}}\n\\put(18,27){\\vector(1,0){12}}\n\\put(18,27){\\vector(2,-3){5}}\n\\put(31,26){$\\langle K_1,6\\rangle$}\n\\put(30,25){\\usebox{\\bb}}\n\\put(38,27){\\vector(1,0){12}}\n\\put(38,27){\\vector(1,-1){3}}\n\\put(51,26){$\\langle K_{-1},16\\rangle$}\n\\put(50,25){\\usebox{\\bbb}}\n\\put(40.5,21){$\\langle K_0,10\\rangle$}\n\\put(40,20){\\usebox{\\bb}}\n\\put(51,21){$\\langle K_{-1},17\\rangle$}\n\\put(50,20){\\usebox{\\bbb}}\n\\put(48,22){\\vector(1,0){2}}\n\\put(21,16){$\\langle K_2,4\\rangle$}\n\\put(20,15){\\usebox{\\bb}}\n\\put(28,17){\\vector(1,0){12}}\n\\put(28,17){\\vector(1,-1){3}}\n\\put(40.5,16){$\\langle K_0,11\\rangle$}\n\\put(40,15){\\usebox{\\bb}}\n\\put(51,16){$\\langle K_{-1},18\\rangle$}\n\\put(50,15){\\usebox{\\bbb}}\n\\put(48,17){\\vector(1,0){2}}\n\\put(31,11){$\\langle K_1,7\\rangle$}\n\\put(30,10){\\usebox{\\bb}}\n\\put(38,12){\\vector(1,0){12}}\n\\put(38,12){\\vector(1,-1){3}}\n\\put(51,11){$\\langle K_{-1},19\\rangle$}\n\\put(50,10){\\usebox{\\bbb}}\n\\put(40.5,6){$\\langle K_0,12\\rangle$}\n\\put(40,5){\\usebox{\\bb}}\n\\put(51,6){$\\langle K_{-1},20\\rangle$}\n\\put(50,5){\\usebox{\\bbb}}\n\\put(48,7){\\vector(1,0){2}}\n\\end{picture}\n\\end{center}\n\\normalsize\n\\vspace{-1.2cm}\n\\centerline{(b)}\n\\centerline{Fig.1: The recursive structure of palindromes from $\\langle K_4,1\\rangle$.}\n\n\\vspace{0.2cm}\n\n\nBy the recursive structure, the property below give the relation between the number of palindromes ending at position $pf_{m+1}+(\\lfloor\\phi p\\rfloor+1) f_{m}+i-2$ and $f_{m+2}+i-2$, which are the $i$-th element in $\\langle K_m,p\\rangle$ and $\\langle K_m,1\\rangle$ respectively, where $1\\leq i\\leq f_{m+1}$.\n\n\n\\begin{property}[]\\label{P5.5} For $1\\leq i\\leq f_{m+1}$,\n\n", "itemtype": "equation", "pos": 22257, "prevtext": "\n\n\nOn the other hand, (a) For any $m\\geq-1$, each $\\langle K_{m},1\\rangle$ belongs to the recursive structure.\n(b) Since $\\mathbb{F}$ over alphabet $\\{a,b\\}$, $\\mathbb{N}=\\{1\\}\\sqcup\\{P(a,\\hat{p})+1\\}\\sqcup\\{P(b,\\hat{p})+1\\}$. So for any $p\\geq2$, there exists\n$\\hat{p}$ such that $P(a,\\hat{p})+1=p$ or $P(b,\\hat{p})+1=p$.\n\n", "index": 29, "text": "\\begin{equation*}\n\\begin{cases}\n\\text{If there exists }\\hat{p}\\text{ such that }P(a,\\hat{p})+1=p,\n\\begin{cases}\n\\langle K_{m},p\\rangle\\subset\\tau_1\\langle K_{m+1},\\hat{p}\\rangle\\text{ for }m\\geq0\\\\\n\\langle K_{m},p\\rangle=\\langle a,p\\rangle\\subset\\tau_2\\langle b,\\hat{p}\\rangle\\text{ for }m=-1\n\\end{cases}\\\\\n\\text{If there exists }\\hat{p}\\text{ such that }P(b,\\hat{p})+1=p,\n\\langle K_{m},p\\rangle\\subset\\tau_1\\langle K_{m+2},\\hat{p}\\rangle.\n\\end{cases}\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex15.m1\" class=\"ltx_Math\" alttext=\"\\begin{cases}\\text{If there exists }\\hat{p}\\text{ such that }P(a,\\hat{p})+1=p,%&#10;\\begin{cases}\\langle K_{m},p\\rangle\\subset\\tau_{1}\\langle K_{m+1},\\hat{p}%&#10;\\rangle\\text{ for }m\\geq 0\\\\&#10;\\langle K_{m},p\\rangle=\\langle a,p\\rangle\\subset\\tau_{2}\\langle b,\\hat{p}%&#10;\\rangle\\text{ for }m=-1\\end{cases}\\\\&#10;\\text{If there exists }\\hat{p}\\text{ such that }P(b,\\hat{p})+1=p,\\langle K_{m}%&#10;,p\\rangle\\subset\\tau_{1}\\langle K_{m+2},\\hat{p}\\rangle.\\end{cases}\" display=\"block\"><mrow><mo>{</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><mrow><mrow><mtext>If there exists\u00a0</mtext><mo>\u2062</mo><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">^</mo></mover><mo>\u2062</mo><mtext>\u00a0such that\u00a0</mtext><mo>\u2062</mo><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>a</mi><mo>,</mo><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">^</mo></mover><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mn>1</mn></mrow><mo>=</mo><mrow><mi>p</mi><mo>,</mo><mrow><mo>{</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><mrow><mo stretchy=\"false\">\u27e8</mo><msub><mi>K</mi><mi>m</mi></msub><mo>,</mo><mi>p</mi><mo stretchy=\"false\">\u27e9</mo></mrow><mo>\u2282</mo><mrow><msub><mi>\u03c4</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">\u27e8</mo><msub><mi>K</mi><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">^</mo></mover><mo stretchy=\"false\">\u27e9</mo></mrow><mo>\u2062</mo><mtext>\u00a0for\u00a0</mtext><mo>\u2062</mo><mi>m</mi></mrow><mo>\u2265</mo><mn>0</mn></mrow></mtd><mtd/></mtr><mtr><mtd columnalign=\"left\"><mrow><mrow><mo stretchy=\"false\">\u27e8</mo><msub><mi>K</mi><mi>m</mi></msub><mo>,</mo><mi>p</mi><mo stretchy=\"false\">\u27e9</mo></mrow><mo>=</mo><mrow><mo stretchy=\"false\">\u27e8</mo><mi>a</mi><mo>,</mo><mi>p</mi><mo stretchy=\"false\">\u27e9</mo></mrow><mo>\u2282</mo><mrow><msub><mi>\u03c4</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">\u27e8</mo><mi>b</mi><mo>,</mo><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">^</mo></mover><mo stretchy=\"false\">\u27e9</mo></mrow><mo>\u2062</mo><mtext>\u00a0for\u00a0</mtext><mo>\u2062</mo><mi>m</mi></mrow><mo>=</mo><mrow><mo>-</mo><mn>1</mn></mrow></mrow></mtd><mtd/></mtr></mtable></mrow></mrow></mrow></mtd><mtd/></mtr><mtr><mtd columnalign=\"left\"><mrow><mrow><mrow><mrow><mrow><mtext>If there exists\u00a0</mtext><mo>\u2062</mo><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">^</mo></mover><mo>\u2062</mo><mtext>\u00a0such that\u00a0</mtext><mo>\u2062</mo><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>b</mi><mo>,</mo><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">^</mo></mover><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mn>1</mn></mrow><mo>=</mo><mi>p</mi></mrow><mo>,</mo><mrow><mrow><mo stretchy=\"false\">\u27e8</mo><msub><mi>K</mi><mi>m</mi></msub><mo>,</mo><mi>p</mi><mo stretchy=\"false\">\u27e9</mo></mrow><mo>\u2282</mo><mrow><msub><mi>\u03c4</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">\u27e8</mo><msub><mi>K</mi><mrow><mi>m</mi><mo>+</mo><mn>2</mn></mrow></msub><mo>,</mo><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">^</mo></mover><mo stretchy=\"false\">\u27e9</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></mtd><mtd/></mtr></mtable></mrow></math>", "type": "latex"}, {"file": "1601.04391.tex", "nexttext": "\n\\end{property}\n\nFor instance, taking $m=2$, $p=3$, $i=2$. All palindromes ending at position 8 are $\\{a,aba,ababa\\}$.\nAll palindromes ending at position 21 are $\\{a,aba,ababa,\\omega\\}$ where $\\omega=ababaababa$.\nSince $Ker(a)=K_{-1}$, $Ker(aba)=K_0$, $Ker(ababa)=K_2$ and $Ker(\\omega)=K_3$,\nonly $\\{a,aba,ababa\\}$ are palindromes with kernel $K_{j}$, $-1\\leq j\\leq 2$.\n\n\\section{The number of repeated palindrome occurrences in $\\mathbb{F}[1,n]$}\n\nBy the recursive structure of palindromes in $\\mathbb{F}$, we can count the number of palindromes end at position $n$, denoted by $A(n):=|\\{\\omega_p:\\omega_p\\triangleright\\mathbb{F}[1,n]\\}|.$\nAnd obviously the number of repeated palindrome occurrences in $\\mathbb{F}[1,n]$ is $B(n):=\\sum_{i=1}^nA(i)$.\n\nBy Property \\ref{P4.1}, \\ref{P4.2}, \\ref{P5.5}, and the recursive structure of palindromes, we have:\n\n\\begin{theorem}\\label{P4.3} The vectors $[A(1)]=[1]$, $[A(2),A(3)]=[1,2]$ and for $m\\geq3$\n\n", "itemtype": "equation", "pos": 27970, "prevtext": "\n\nThus the recursive structure contains all $\\langle K_m,p\\rangle$, i.e. contains all palindromes in $\\mathbb{F}$.\n\n\\vspace{-0.3cm}\n\\small\n\\setlength{\\unitlength}{1.2mm}\n\\begin{center}\n\\begin{picture}(70,65)\n\\put(0,0.5){\\line(1,0){70}}\n\\put(0,63.5){\\line(1,0){70}}\n\\put(0,0.5){\\line(0,1){63}}\n\\put(11,0.5){\\line(0,1){63}}\n\\put(22,0.5){\\line(0,1){63}}\n\\put(33,0.5){\\line(0,1){63}}\n\\put(44,0.5){\\line(0,1){63}}\n\\put(56,0.5){\\line(0,1){63}}\n\\put(70,0.5){\\line(0,1){63}}\n\\put(4,1){32}\n\\put(4,4){31}\n\\put(4,10){30}\n\\put(4,16){29}\n\\put(4,19){28}\n\\put(4,25){27}\n\\put(4,28){26}\n\\put(4,34){25}\n\\put(4,40){24}\n\\put(4,43){23}\n\\put(4,49){22}\n\\put(4,55){21}\n\\put(4,58){20}\n\\put(1,61){$\\langle K_4,1\\rangle$}\n\\put(26,40){24}\n\\put(26,43){23}\n\\put(26,49){22}\n\\put(26,55){21}\n\\put(26,58){20}\n\\put(23,61){$\\langle K_2,3\\rangle$}\n\\put(15,1){32}\n\\put(15,4){31}\n\\put(15,10){30}\n\\put(15,16){29}\n\\put(15,19){28}\n\\put(15,25){27}\n\\put(15,28){26}\n\\put(15,34){25}\n\\put(12,37){$\\langle K_3,2\\rangle$}\n\\put(11,39.5){\\line(1,0){59}}\n\\put(26,1){32}\n\\put(26,4){31}\n\\put(26,10){30}\n\\put(26,16){29}\n\\put(26,19){28}\n\\put(23,22){$\\langle K_2,4\\rangle$}\n\\put(22,24.5){\\line(1,0){48}}\n\\put(37,40){24}\n\\put(37,43){23}\n\\put(37,49){22}\n\\put(34,52){$\\langle K_1,5\\rangle$}\n\\put(33,54.5){\\line(1,0){37}}\n\\put(37,25){27}\n\\put(37,28){26}\n\\put(37,34){25}\n\\put(34,37){$\\langle K_1,6\\rangle$}\n\\put(37,1){32}\n\\put(37,4){31}\n\\put(37,10){30}\n\\put(34,13){$\\langle K_1,7\\rangle$}\n\\put(33,15.5){\\line(1,0){37}}\n\\put(48,55){21}\n\\put(48,58){20}\n\\put(45,61){$\\langle K_0,8\\rangle$}\n\\put(48,40){24}\n\\put(48,43){23}\n\\put(45,46){$\\langle K_0,9\\rangle$}\n\\put(44,48.5){\\line(1,0){26}}\n\\put(48,25){27}\n\\put(48,28){26}\n\\put(45,31){$\\langle K_0,10\\rangle$}\n\\put(44,33.5){\\line(1,0){26}}\n\\put(48,16){29}\n\\put(48,19){28}\n\\put(45,22){$\\langle K_0,11\\rangle$}\n\\put(48,1){32}\n\\put(48,4){31}\n\\put(45,7){$\\langle K_0,12\\rangle$}\n\\put(44,9.5){\\line(1,0){26}}\n\\put(62,55){21}\n\\put(57,61){$\\langle K_{-1},13\\rangle$}\n\\put(62,49){22}\n\\put(57,52){$\\langle K_{-1},14\\rangle$}\n\\put(62,40){24}\n\\put(57,46){$\\langle K_{-1},15\\rangle$}\n\\put(62,34){25}\n\\put(57,37){$\\langle K_{-1},16\\rangle$}\n\\put(62,25){27}\n\\put(57,31){$\\langle K_{-1},17\\rangle$}\n\\put(62,16){29}\n\\put(57,22){$\\langle K_{-1},18\\rangle$}\n\\put(62,10){30}\n\\put(57,13){$\\langle K_{-1},19\\rangle$}\n\\put(62,1){32}\n\\put(57,7){$\\langle K_{-1},20\\rangle$}\n\\end{picture}\n\\end{center}\n\\normalsize\n\\vspace{-0.4cm}\n\\centerline{(a)}\n\n\\small\n\\setlength{\\unitlength}{1.85mm}\n\\newsavebox{\\bb}\n\\savebox{\\bb}(7,3.5){\n\\begin{picture}(7,3.5)\n\\put(0,0){\\line(1,0){7}}\n\\put(0,3.5){\\line(1,0){7}}\n\\put(0,0){\\line(0,1){3.5}}\n\\put(7,0){\\line(0,1){3.5}}\n\\end{picture}}\n\\newsavebox{\\bbb}\n\\savebox{\\bbb}(9,3.5){\n\\begin{picture}(9,3.5)\n\\put(0,0){\\line(1,0){9}}\n\\put(0,3.5){\\line(1,0){9}}\n\\put(0,0){\\line(0,1){3.5}}\n\\put(9,0){\\line(0,1){3.5}}\n\\end{picture}}\n\n\\begin{center}\n\\begin{picture}(60,42)\n\\put(1,41){$\\langle K_4,1\\rangle$}\n\\put(0,40){\\usebox{\\bb}}\n\\put(8,42){\\vector(1,0){11.5}}\n\\put(8,42){\\vector(1,-3){4.3}}\n\\put(21,41){$\\langle K_2,3\\rangle$}\n\\put(20,40){\\usebox{\\bb}}\n\\put(28,42){\\vector(1,0){12}}\n\\put(28,42){\\vector(1,-1){3}}\n\\put(41,41){$\\langle K_0,8\\rangle$}\n\\put(40,40){\\usebox{\\bb}}\n\\put(51,41){$\\langle K_{-1},13\\rangle$}\n\\put(50,40){\\usebox{\\bbb}}\n\\put(48,42){\\vector(1,0){2}}\n\\put(31,36){$\\langle K_1,5\\rangle$}\n\\put(30,35){\\usebox{\\bb}}\n\\put(38,37){\\vector(1,0){12}}\n\\put(38,37){\\vector(1,-1){3}}\n\\put(51,36){$\\langle K_{-1},14\\rangle$}\n\\put(50,35){\\usebox{\\bbb}}\n\\put(41,31){$\\langle K_0,9\\rangle$}\n\\put(40,30){\\usebox{\\bb}}\n\\put(51,31){$\\langle K_{-1},15\\rangle$}\n\\put(50,30){\\usebox{\\bbb}}\n\\put(48,32){\\vector(1,0){2}}\n\\put(11,26){$\\langle K_3,2\\rangle$}\n\\put(10,25){\\usebox{\\bb}}\n\\put(18,27){\\vector(1,0){12}}\n\\put(18,27){\\vector(2,-3){5}}\n\\put(31,26){$\\langle K_1,6\\rangle$}\n\\put(30,25){\\usebox{\\bb}}\n\\put(38,27){\\vector(1,0){12}}\n\\put(38,27){\\vector(1,-1){3}}\n\\put(51,26){$\\langle K_{-1},16\\rangle$}\n\\put(50,25){\\usebox{\\bbb}}\n\\put(40.5,21){$\\langle K_0,10\\rangle$}\n\\put(40,20){\\usebox{\\bb}}\n\\put(51,21){$\\langle K_{-1},17\\rangle$}\n\\put(50,20){\\usebox{\\bbb}}\n\\put(48,22){\\vector(1,0){2}}\n\\put(21,16){$\\langle K_2,4\\rangle$}\n\\put(20,15){\\usebox{\\bb}}\n\\put(28,17){\\vector(1,0){12}}\n\\put(28,17){\\vector(1,-1){3}}\n\\put(40.5,16){$\\langle K_0,11\\rangle$}\n\\put(40,15){\\usebox{\\bb}}\n\\put(51,16){$\\langle K_{-1},18\\rangle$}\n\\put(50,15){\\usebox{\\bbb}}\n\\put(48,17){\\vector(1,0){2}}\n\\put(31,11){$\\langle K_1,7\\rangle$}\n\\put(30,10){\\usebox{\\bb}}\n\\put(38,12){\\vector(1,0){12}}\n\\put(38,12){\\vector(1,-1){3}}\n\\put(51,11){$\\langle K_{-1},19\\rangle$}\n\\put(50,10){\\usebox{\\bbb}}\n\\put(40.5,6){$\\langle K_0,12\\rangle$}\n\\put(40,5){\\usebox{\\bb}}\n\\put(51,6){$\\langle K_{-1},20\\rangle$}\n\\put(50,5){\\usebox{\\bbb}}\n\\put(48,7){\\vector(1,0){2}}\n\\end{picture}\n\\end{center}\n\\normalsize\n\\vspace{-1.2cm}\n\\centerline{(b)}\n\\centerline{Fig.1: The recursive structure of palindromes from $\\langle K_4,1\\rangle$.}\n\n\\vspace{0.2cm}\n\n\nBy the recursive structure, the property below give the relation between the number of palindromes ending at position $pf_{m+1}+(\\lfloor\\phi p\\rfloor+1) f_{m}+i-2$ and $f_{m+2}+i-2$, which are the $i$-th element in $\\langle K_m,p\\rangle$ and $\\langle K_m,1\\rangle$ respectively, where $1\\leq i\\leq f_{m+1}$.\n\n\n\\begin{property}[]\\label{P5.5} For $1\\leq i\\leq f_{m+1}$,\n\n", "index": 31, "text": "\\begin{equation*}\n\\begin{split}\n&\\{\\omega:\\omega\\in\\mathcal{P},\\omega\\triangleright\\mathbb{F}[1,f_{m+2}+i-2]\\}\\\\\n=&\\{\\omega:\\omega\\in\\mathcal{P},\\omega\\triangleright\\mathbb{F}[1,pf_{m+1}+(\\lfloor\\phi p\\rfloor+1) f_{m}+i-2],Ker(\\omega)=K_j,-1\\leq j\\leq m\\}.\n\\end{split}\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex16.m1\" class=\"ltx_Math\" alttext=\"\\begin{split}&amp;\\displaystyle\\{\\omega:\\omega\\in\\mathcal{P},\\omega\\triangleright%&#10;\\mathbb{F}[1,f_{m+2}+i-2]\\}\\\\&#10;\\displaystyle=&amp;\\displaystyle\\{\\omega:\\omega\\in\\mathcal{P},\\omega\\triangleright%&#10;\\mathbb{F}[1,pf_{m+1}+(\\lfloor\\phi p\\rfloor+1)f_{m}+i-2],Ker(\\omega)=K_{j},-1%&#10;\\leq j\\leq m\\}.\\end{split}\" display=\"block\"><mtable columnspacing=\"0pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd/><mtd columnalign=\"left\"><mrow><mo stretchy=\"false\">{</mo><mi>\u03c9</mi><mo>:</mo><mrow><mi>\u03c9</mi><mo>\u2208</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcab</mi><mo>,</mo><mrow><mi>\u03c9</mi><mo>\u25b7</mo><mrow><mi>\ud835\udd3d</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo>,</mo><mrow><mrow><msub><mi>f</mi><mrow><mi>m</mi><mo>+</mo><mn>2</mn></mrow></msub><mo>+</mo><mi>i</mi></mrow><mo>-</mo><mn>2</mn></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow></mrow></mrow><mo stretchy=\"false\">}</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mo>=</mo></mtd><mtd columnalign=\"left\"><mrow><mrow><mo stretchy=\"false\">{</mo><mi>\u03c9</mi><mo>:</mo><mrow><mrow><mi>\u03c9</mi><mo>\u2208</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcab</mi><mo>,</mo><mrow><mi>\u03c9</mi><mo>\u25b7</mo><mrow><mi>\ud835\udd3d</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo>,</mo><mrow><mrow><mrow><mi>p</mi><mo>\u2062</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mo stretchy=\"false\">\u230a</mo><mrow><mi>\u03d5</mi><mo>\u2062</mo><mi>p</mi></mrow><mo stretchy=\"false\">\u230b</mo></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>f</mi><mi>m</mi></msub></mrow><mo>+</mo><mi>i</mi></mrow><mo>-</mo><mn>2</mn></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow></mrow></mrow><mo>,</mo><mrow><mrow><mrow><mi>K</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>r</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><msub><mi>K</mi><mi>j</mi></msub></mrow><mo>,</mo><mrow><mrow><mo>-</mo><mn>1</mn></mrow><mo>\u2264</mo><mi>j</mi><mo>\u2264</mo><mi>m</mi></mrow></mrow></mrow><mo stretchy=\"false\">}</mo></mrow><mo>.</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.04391.tex", "nexttext": "\n\\end{theorem}\n\nThe first few values of $A(n)$ are\n$[A(1)]=[1]$,\n$[A(2),A(3)]=[1,2]$,\n\n$[A(4),A(5),A(6)]=[1,1,2]+[1,1,1]=[2,2,3]$,\n\n$[A(7),\\cdots,A(11)]=[1,2,2,2,3]+[\\underbrace{1,\\cdots,1}_5]=[2,3,3,3,4]$,\n\n$[A(12),\\cdots,A(19)]=[2,2,3,2,3,3,3,4]+[\\underbrace{1,\\cdots,1}_8]=[3,3,4,3,4,4,4,5]$.\n\n\\begin{theorem}[] The number of repeated palindrome occurrences in $\\mathbb{F}[1,n]$ is $B(n)=\\sum\\limits_{i=1}^nA(i)$.\n\\end{theorem}\n\nBy considering $B(f_{m}-2)$ for $m\\geq2$, we can determine the expressions of $B(f_{m})$ etc, and give a fast algorithm of $B(n)$ for all $n\\geq1$.\n\nLet $C(m)=B(f_{m+1}-2)-B(f_{m}-2)$, then an immediate corollary of Property \\ref{P4.3} is\n\n", "itemtype": "equation", "pos": 29199, "prevtext": "\n\\end{property}\n\nFor instance, taking $m=2$, $p=3$, $i=2$. All palindromes ending at position 8 are $\\{a,aba,ababa\\}$.\nAll palindromes ending at position 21 are $\\{a,aba,ababa,\\omega\\}$ where $\\omega=ababaababa$.\nSince $Ker(a)=K_{-1}$, $Ker(aba)=K_0$, $Ker(ababa)=K_2$ and $Ker(\\omega)=K_3$,\nonly $\\{a,aba,ababa\\}$ are palindromes with kernel $K_{j}$, $-1\\leq j\\leq 2$.\n\n\\section{The number of repeated palindrome occurrences in $\\mathbb{F}[1,n]$}\n\nBy the recursive structure of palindromes in $\\mathbb{F}$, we can count the number of palindromes end at position $n$, denoted by $A(n):=|\\{\\omega_p:\\omega_p\\triangleright\\mathbb{F}[1,n]\\}|.$\nAnd obviously the number of repeated palindrome occurrences in $\\mathbb{F}[1,n]$ is $B(n):=\\sum_{i=1}^nA(i)$.\n\nBy Property \\ref{P4.1}, \\ref{P4.2}, \\ref{P5.5}, and the recursive structure of palindromes, we have:\n\n\\begin{theorem}\\label{P4.3} The vectors $[A(1)]=[1]$, $[A(2),A(3)]=[1,2]$ and for $m\\geq3$\n\n", "index": 33, "text": "\\begin{equation*}\n\\begin{split}\n&[A(f_{m}-1),\\cdots,A(f_{m+1}-2)]\\\\\n=&[A(f_{m-2}-1),\\cdots,A(f_{m-1}-2),A(f_{m-1}-1),\\cdots,A(f_{m}-2)]\n+[\\underbrace{1,\\cdots,1}_{f_{m-1}}].\n\\end{split}\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex17.m1\" class=\"ltx_Math\" alttext=\"\\begin{split}&amp;\\displaystyle[A(f_{m}-1),\\cdots,A(f_{m+1}-2)]\\\\&#10;\\displaystyle=&amp;\\displaystyle[A(f_{m-2}-1),\\cdots,A(f_{m-1}-2),A(f_{m-1}-1),%&#10;\\cdots,A(f_{m}-2)]+[\\underbrace{1,\\cdots,1}_{f_{m-1}}].\\end{split}\" display=\"block\"><mtable columnspacing=\"0pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd/><mtd columnalign=\"left\"><mrow><mo stretchy=\"false\">[</mo><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>f</mi><mi>m</mi></msub><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>,</mo><mi mathvariant=\"normal\">\u22ef</mi><mo>,</mo><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>f</mi><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>-</mo><mn>2</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mo>=</mo></mtd><mtd columnalign=\"left\"><mrow><mrow><mrow><mo stretchy=\"false\">[</mo><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>2</mn></mrow></msub><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>,</mo><mi mathvariant=\"normal\">\u22ef</mi><mo>,</mo><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>-</mo><mn>2</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>,</mo><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>,</mo><mi mathvariant=\"normal\">\u22ef</mi><mo>,</mo><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>f</mi><mi>m</mi></msub><mo>-</mo><mn>2</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">]</mo></mrow><mo>+</mo><mrow><mo stretchy=\"false\">[</mo><munder><munder accentunder=\"true\"><mrow><mn>1</mn><mo movablelimits=\"false\">,</mo><mi mathvariant=\"normal\">\u22ef</mi><mo movablelimits=\"false\">,</mo><mn>1</mn></mrow><mo movablelimits=\"false\">\u23df</mo></munder><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow></msub></munder><mo stretchy=\"false\">]</mo></mrow></mrow><mo>.</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.04391.tex", "nexttext": "\nThis means $C(m)=C(m-2)+C(m-1)+f_{m-1}$.\n\nBy induction, we can have Property 6.3 and Remark 6.4 easily.\n\n\\begin{property} $C(m)\n=\\frac{m+1}{5}f_{m+1}+\\frac{m-2}{5}f_{m-1}$ for $m\\geq1$.\n\n\\end{property}\n\n\\begin{remark}[] In fact, we get the expression of $C(m)$ by an interesting identity that\n\n", "itemtype": "equation", "pos": 30071, "prevtext": "\n\\end{theorem}\n\nThe first few values of $A(n)$ are\n$[A(1)]=[1]$,\n$[A(2),A(3)]=[1,2]$,\n\n$[A(4),A(5),A(6)]=[1,1,2]+[1,1,1]=[2,2,3]$,\n\n$[A(7),\\cdots,A(11)]=[1,2,2,2,3]+[\\underbrace{1,\\cdots,1}_5]=[2,3,3,3,4]$,\n\n$[A(12),\\cdots,A(19)]=[2,2,3,2,3,3,3,4]+[\\underbrace{1,\\cdots,1}_8]=[3,3,4,3,4,4,4,5]$.\n\n\\begin{theorem}[] The number of repeated palindrome occurrences in $\\mathbb{F}[1,n]$ is $B(n)=\\sum\\limits_{i=1}^nA(i)$.\n\\end{theorem}\n\nBy considering $B(f_{m}-2)$ for $m\\geq2$, we can determine the expressions of $B(f_{m})$ etc, and give a fast algorithm of $B(n)$ for all $n\\geq1$.\n\nLet $C(m)=B(f_{m+1}-2)-B(f_{m}-2)$, then an immediate corollary of Property \\ref{P4.3} is\n\n", "index": 35, "text": "$$\\begin{array}{c}\nC(m)=\\sum\\limits_{n=f_{m}-1}^{f_{m+1}-2}A(n)\n=\\sum\\limits_{n=f_{m-2}-1}^{f_{m-1}-2}A(n)+\\sum\\limits_{n=f_{m-1}-1}^{f_{m}-2}A(n)+f_{m-1}.\n\\end{array}$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex18.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{c}C(m)=\\sum\\limits_{n=f_{m}-1}^{f_{m+1}-2}A(n)=\\sum\\limits_{n=%&#10;f_{m-2}-1}^{f_{m-1}-2}A(n)+\\sum\\limits_{n=f_{m-1}-1}^{f_{m}-2}A(n)+f_{m-1}.%&#10;\\end{array}\" display=\"block\"><mtable displaystyle=\"true\"><mtr><mtd columnalign=\"center\"><mrow><mrow><mrow><mi>C</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>m</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mrow><msub><mi>f</mi><mi>m</mi></msub><mo>-</mo><mn>1</mn></mrow></mrow><mrow><msub><mi>f</mi><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>-</mo><mn>2</mn></mrow></munderover><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>=</mo><mrow><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mrow><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>2</mn></mrow></msub><mo>-</mo><mn>1</mn></mrow></mrow><mrow><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>-</mo><mn>2</mn></mrow></munderover><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mrow><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>-</mo><mn>1</mn></mrow></mrow><mrow><msub><mi>f</mi><mi>m</mi></msub><mo>-</mo><mn>2</mn></mrow></munderover><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow></mrow><mo>.</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.04391.tex", "nexttext": "\n\\end{remark}\n\nBy $B(f_{m}-2)=\\sum_{n=1}^{m-1}C(n)$,\n$C(m)=\\frac{m+1}{5}f_{m+1}+\\frac{m-2}{5}f_{m-1}$ and $\\sum_{i=-1}^mf_i= f_{m+2}-1$, we have\n\n\\begin{property} $B(f_{m}-2)=\\frac{m-3}{5}f_{m+2}+\\frac{m-1}{5}f_{m}+2$ for $m\\geq2$.\n\\end{property}\n\n\n\\vspace{0.2cm}\n\nBy Theorem \\ref{P4.3}, we can get the property below easily by induction.\n\n\\begin{property}\\\n$A(f_{m}-2)=m-1$, $A(f_{m}-1)=\\lfloor\\frac{m+1}{2}\\rfloor$, $A(f_{m})=\\lfloor\\frac{m+2}{2}\\rfloor$, $A(f_{m}-1)+A(f_{m})=m+1$.\n\\end{property}\n\nThus, by the two properties above, we can determine the expressions of $B(f_{m}-3)$, $B(f_{m}-1)$, $B(f_{m})$.\nEspecially, since $B(f_{m})=B(f_{m}-2)+A(f_{m}-1)+A(f_{m})$, we have\n\n\\begin{theorem}[]\nThe number of repeated palindrome occurrences in $F_m$ is\n\n", "itemtype": "equation", "pos": 30534, "prevtext": "\nThis means $C(m)=C(m-2)+C(m-1)+f_{m-1}$.\n\nBy induction, we can have Property 6.3 and Remark 6.4 easily.\n\n\\begin{property} $C(m)\n=\\frac{m+1}{5}f_{m+1}+\\frac{m-2}{5}f_{m-1}$ for $m\\geq1$.\n\n\\end{property}\n\n\\begin{remark}[] In fact, we get the expression of $C(m)$ by an interesting identity that\n\n", "index": 37, "text": "$$\\begin{array}{c}\n\\sum\\limits_{i=-1}^{m}f_if_{m-i-1}=\\frac{m+2}{5}f_{m+2}+\\frac{m+4}{5}f_{m}\\text{ for } m\\geq1,\n\\end{array}$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex19.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{c}\\sum\\limits_{i=-1}^{m}f_{i}f_{m-i-1}=\\frac{m+2}{5}f_{m+2}+%&#10;\\frac{m+4}{5}f_{m}\\text{ for }m\\geq 1,\\end{array}\" display=\"block\"><mtable displaystyle=\"true\"><mtr><mtd columnalign=\"center\"><mrow><mrow><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mrow><mo>-</mo><mn>1</mn></mrow></mrow><mi>m</mi></munderover><mrow><msub><mi>f</mi><mi>i</mi></msub><mo>\u2062</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mi>i</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow></mrow><mo>=</mo><mrow><mrow><mfrac><mrow><mi>m</mi><mo>+</mo><mn>2</mn></mrow><mn>5</mn></mfrac><mo>\u2062</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>+</mo><mn>2</mn></mrow></msub></mrow><mo>+</mo><mrow><mfrac><mrow><mi>m</mi><mo>+</mo><mn>4</mn></mrow><mn>5</mn></mfrac><mo>\u2062</mo><msub><mi>f</mi><mi>m</mi></msub><mo>\u2062</mo><mtext>\u00a0for\u00a0</mtext><mo>\u2062</mo><mi>m</mi></mrow></mrow><mo>\u2265</mo><mn>1</mn></mrow><mo>,</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.04391.tex", "nexttext": "\n\\end{theorem}\n\nFor instance, taking $m=5$, $B(13)=\\frac{2}{5}f_{7}+\\frac{4}{5}f_{5}+10\n=\\frac{2}{5}\\times34+\\frac{4}{5}\\times13+8=32$.\n\n\\vspace{0.2cm}\n\nFor any $n\\geq1$, let $m$ such that $f_m\\leq n+1< f_{m+1}$. Since we already determine the expression of $B(f_m-2)$, in order to give a fast algorithm\nof $B(n)$, we only need to calculate $\\sum_{i=f_{m}-1}^{n}A(i)$. One method is calculating $A(n)$ by Theorem \\ref{P4.3}, the other method is using the corollary as below.\n\n\\begin{corollary}\\label{c5} For $n\\geq1$, let $m$ such that $f_m\\leq n+1< f_{m+1}$, then\n\n", "itemtype": "equation", "pos": 31419, "prevtext": "\n\\end{remark}\n\nBy $B(f_{m}-2)=\\sum_{n=1}^{m-1}C(n)$,\n$C(m)=\\frac{m+1}{5}f_{m+1}+\\frac{m-2}{5}f_{m-1}$ and $\\sum_{i=-1}^mf_i= f_{m+2}-1$, we have\n\n\\begin{property} $B(f_{m}-2)=\\frac{m-3}{5}f_{m+2}+\\frac{m-1}{5}f_{m}+2$ for $m\\geq2$.\n\\end{property}\n\n\n\\vspace{0.2cm}\n\nBy Theorem \\ref{P4.3}, we can get the property below easily by induction.\n\n\\begin{property}\\\n$A(f_{m}-2)=m-1$, $A(f_{m}-1)=\\lfloor\\frac{m+1}{2}\\rfloor$, $A(f_{m})=\\lfloor\\frac{m+2}{2}\\rfloor$, $A(f_{m}-1)+A(f_{m})=m+1$.\n\\end{property}\n\nThus, by the two properties above, we can determine the expressions of $B(f_{m}-3)$, $B(f_{m}-1)$, $B(f_{m})$.\nEspecially, since $B(f_{m})=B(f_{m}-2)+A(f_{m}-1)+A(f_{m})$, we have\n\n\\begin{theorem}[]\nThe number of repeated palindrome occurrences in $F_m$ is\n\n", "index": 39, "text": "$$\\begin{array}{c}\nB(f_m)=\\frac{m-3}{5}f_{m+2}+\\frac{m-1}{5}f_{m}+m+3.\n\\end{array}$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex20.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{c}B(f_{m})=\\frac{m-3}{5}f_{m+2}+\\frac{m-1}{5}f_{m}+m+3.\\end{array}\" display=\"block\"><mtable displaystyle=\"true\"><mtr><mtd columnalign=\"center\"><mrow><mrow><mrow><mi>B</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mi>m</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mfrac><mrow><mi>m</mi><mo>-</mo><mn>3</mn></mrow><mn>5</mn></mfrac><mo>\u2062</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>+</mo><mn>2</mn></mrow></msub></mrow><mo>+</mo><mrow><mfrac><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow><mn>5</mn></mfrac><mo>\u2062</mo><msub><mi>f</mi><mi>m</mi></msub></mrow><mo>+</mo><mi>m</mi><mo>+</mo><mn>3</mn></mrow></mrow><mo>.</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.04391.tex", "nexttext": "\n\\end{corollary}\n\n\\begin{proof} By Theorem \\ref{P4.3},\nwhen $f_m\\leq n+1< 2f_{m-1}$,\n\n", "itemtype": "equation", "pos": 32068, "prevtext": "\n\\end{theorem}\n\nFor instance, taking $m=5$, $B(13)=\\frac{2}{5}f_{7}+\\frac{4}{5}f_{5}+10\n=\\frac{2}{5}\\times34+\\frac{4}{5}\\times13+8=32$.\n\n\\vspace{0.2cm}\n\nFor any $n\\geq1$, let $m$ such that $f_m\\leq n+1< f_{m+1}$. Since we already determine the expression of $B(f_m-2)$, in order to give a fast algorithm\nof $B(n)$, we only need to calculate $\\sum_{i=f_{m}-1}^{n}A(i)$. One method is calculating $A(n)$ by Theorem \\ref{P4.3}, the other method is using the corollary as below.\n\n\\begin{corollary}\\label{c5} For $n\\geq1$, let $m$ such that $f_m\\leq n+1< f_{m+1}$, then\n\n", "index": 41, "text": "\\begin{equation*}\n\\sum_{i=f_{m}-1}^{n}A(i)=\n\\begin{cases}\n\\sum\\limits_{i=f_{m-2}-1}^{n-f_{m-1}}A(i)+n-f_{m}+2,&n+1< 2f_{m-1};\\\\\n\\sum\\limits_{i=f_{m-1}-1}^{n-f_{m-1}}A(i)+n+\\frac{m-11}{5}f_{m-1}+\\frac{m+1}{5}f_{m-3}+2,\n&otherwise.\n\\end{cases}\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex21.m1\" class=\"ltx_Math\" alttext=\"\\sum_{i=f_{m}-1}^{n}A(i)=\\begin{cases}\\sum\\limits_{i=f_{m-2}-1}^{n-f_{m-1}}A(i%&#10;)+n-f_{m}+2,&amp;n+1&lt;2f_{m-1};\\\\&#10;\\sum\\limits_{i=f_{m-1}-1}^{n-f_{m-1}}A(i)+n+\\frac{m-11}{5}f_{m-1}+\\frac{m+1}{5%&#10;}f_{m-3}+2,&amp;otherwise.\\end{cases}\" display=\"block\"><mrow><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mrow><msub><mi>f</mi><mi>m</mi></msub><mo>-</mo><mn>1</mn></mrow></mrow><mi>n</mi></munderover><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>=</mo><mrow><mo>{</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><mrow><mrow><mrow><mrow><mstyle displaystyle=\"false\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mrow><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>2</mn></mrow></msub><mo>-</mo><mn>1</mn></mrow></mrow><mrow><mi>n</mi><mo>-</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow></munderover></mstyle><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><mi>n</mi></mrow><mo>-</mo><msub><mi>f</mi><mi>m</mi></msub></mrow><mo>+</mo><mn>2</mn></mrow><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mo>&lt;</mo><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow></mrow><mo>;</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mrow><mrow><mrow><mstyle displaystyle=\"false\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mrow><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>-</mo><mn>1</mn></mrow></mrow><mrow><mi>n</mi><mo>-</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow></munderover></mstyle><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><mi>n</mi><mo>+</mo><mrow><mstyle displaystyle=\"false\"><mfrac><mrow><mi>m</mi><mo>-</mo><mn>11</mn></mrow><mn>5</mn></mfrac></mstyle><mo>\u2062</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow><mo>+</mo><mrow><mstyle displaystyle=\"false\"><mfrac><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow><mn>5</mn></mfrac></mstyle><mo>\u2062</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>3</mn></mrow></msub></mrow><mo>+</mo><mn>2</mn></mrow><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mi>o</mi><mo>\u2062</mo><mi>t</mi><mo>\u2062</mo><mi>h</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>r</mi><mo>\u2062</mo><mi>w</mi><mo>\u2062</mo><mi>i</mi><mo>\u2062</mo><mi>s</mi><mo>\u2062</mo><mi>e</mi></mrow><mo>.</mo></mrow></mtd></mtr></mtable></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04391.tex", "nexttext": "\n\nWhen $2f_{m-1}\\leq n+1< f_{m+1}$, $\\sum_{i=f_{m}-1}^{n}A(i)\n=\\sum\\limits_{i=f_{m}-1}^{2f_{m-1}-2}A(i)+\\sum\\limits_{i=2f_{m-1}-1}^{n}A(i)$,\nwhere\n\n", "itemtype": "equation", "pos": 32410, "prevtext": "\n\\end{corollary}\n\n\\begin{proof} By Theorem \\ref{P4.3},\nwhen $f_m\\leq n+1< 2f_{m-1}$,\n\n", "index": 43, "text": "$$\\begin{array}{c}\n\\sum\\limits_{i=f_{m}-1}^{n}A(i)=\\sum\\limits_{i=f_{m-2}-1}^{n-f_{m-1}}(A(i)+1)\n=\\sum\\limits_{i=f_{m-2}-1}^{n-f_{m-1}}A(i)+n-f_{m}+2.\n\\end{array}$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex22.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{c}\\sum\\limits_{i=f_{m}-1}^{n}A(i)=\\sum\\limits_{i=f_{m-2}-1}^{n%&#10;-f_{m-1}}(A(i)+1)=\\sum\\limits_{i=f_{m-2}-1}^{n-f_{m-1}}A(i)+n-f_{m}+2.\\end{array}\" display=\"block\"><mtable displaystyle=\"true\"><mtr><mtd columnalign=\"center\"><mrow><mrow><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mrow><msub><mi>f</mi><mi>m</mi></msub><mo>-</mo><mn>1</mn></mrow></mrow><mi>n</mi></munderover><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>=</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mrow><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>2</mn></mrow></msub><mo>-</mo><mn>1</mn></mrow></mrow><mrow><mi>n</mi><mo>-</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow></munderover><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mrow><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mrow><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>2</mn></mrow></msub><mo>-</mo><mn>1</mn></mrow></mrow><mrow><mi>n</mi><mo>-</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow></munderover><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><mi>n</mi></mrow><mo>-</mo><msub><mi>f</mi><mi>m</mi></msub></mrow><mo>+</mo><mn>2</mn></mrow></mrow><mo>.</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.04391.tex", "nexttext": "\n\nThus we have the expression that\n$\\sum\\limits_{i=f_{m}-1}^{n}A(i)\n=\\sum\\limits_{i=f_{m-1}-1}^{n-f_{m-1}}A(i)+n+\\frac{m-11}{5}f_{m-1}+\\frac{m+1}{5}f_{m-3}+2,$\nwhich yields the conclusion holds.\n\\end{proof}\n\n\\noindent\\textbf{Example.} We calculate $\\sum_{i=20}^{29}A(i)$. One method is using Theorem \\ref{P4.3}, we have\n\n$[A(1)]=[1]$,\n$[A(2),A(3)]=[1,2]$,\n$[A(4),A(5),A(6)]=[2,2,3]$,\n$[A(7),\\cdots,A(11)]=[2,3,3,3,4]$,\n\n$[A(12),\\cdots,A(19)]=[3,3,4,3,4,4,4,5]$,\n$[A(20),\\cdots,A(32)]=[3,4,4,4,5,4,4,5,4,5,5,5,6]$.\n\nSo $\\sum_{i=20}^{29}A(i)=3+4+4+4+5+4+4+5+4+5=42$.\n\nThe other method is using Corollary \\ref{c5}.\n\nSince $f_6=21\\leq 29+1< f_{7}=34$, $m=6$. Moreover $2f_5=26\\leq 29+1$,\n\n", "itemtype": "equation", "pos": 32721, "prevtext": "\n\nWhen $2f_{m-1}\\leq n+1< f_{m+1}$, $\\sum_{i=f_{m}-1}^{n}A(i)\n=\\sum\\limits_{i=f_{m}-1}^{2f_{m-1}-2}A(i)+\\sum\\limits_{i=2f_{m-1}-1}^{n}A(i)$,\nwhere\n\n", "index": 45, "text": "$$\\begin{array}{rl}\n\\sum\\limits_{i=f_{m}-1}^{2f_{m-1}-2}A(i)=&\\sum\\limits_{i=f_{m-2}-1}^{f_{m-1}-2}A(i)+ f_{m-3}=C(m-2)+f_{m-3}\\\\\n=&\\frac{m-1}{5}f_{m-1}+\\frac{m-4}{5}f_{m-3}+f_{m-3}\n=\\frac{m-1}{5}f_{m-1}+\\frac{m+1}{5}f_{m-3}.\\\\\n\\sum\\limits_{i=2f_{m-1}-1}^{n}A(i)=&\\sum\\limits_{i=f_{m-1}-1}^{n-f_{m-1}}A(i)+n-2f_{m-1}+2.\n\\end{array}$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex23.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{rl}\\sum\\limits_{i=f_{m}-1}^{2f_{m-1}-2}A(i)=&amp;\\sum\\limits_{i=f_%&#10;{m-2}-1}^{f_{m-1}-2}A(i)+f_{m-3}=C(m-2)+f_{m-3}\\\\&#10;=&amp;\\frac{m-1}{5}f_{m-1}+\\frac{m-4}{5}f_{m-3}+f_{m-3}=\\frac{m-1}{5}f_{m-1}+\\frac%&#10;{m+1}{5}f_{m-3}.\\\\&#10;\\sum\\limits_{i=2f_{m-1}-1}^{n}A(i)=&amp;\\sum\\limits_{i=f_{m-1}-1}^{n-f_{m-1}}A(i)+%&#10;n-2f_{m-1}+2.\\end{array}\" display=\"block\"><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"right\"><mrow><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mrow><msub><mi>f</mi><mi>m</mi></msub><mo>-</mo><mn>1</mn></mrow></mrow><mrow><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow><mo>-</mo><mn>2</mn></mrow></munderover><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>=</mo><mi/></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mrow><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>2</mn></mrow></msub><mo>-</mo><mn>1</mn></mrow></mrow><mrow><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>-</mo><mn>2</mn></mrow></munderover><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>3</mn></mrow></msub></mrow><mo>=</mo><mrow><mrow><mi>C</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>m</mi><mo>-</mo><mn>2</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>3</mn></mrow></msub></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mo>=</mo></mtd><mtd columnalign=\"left\"><mrow><mrow><mrow><mrow><mfrac><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow><mn>5</mn></mfrac><mo>\u2062</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow><mo>+</mo><mrow><mfrac><mrow><mi>m</mi><mo>-</mo><mn>4</mn></mrow><mn>5</mn></mfrac><mo>\u2062</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>3</mn></mrow></msub></mrow><mo>+</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>3</mn></mrow></msub></mrow><mo>=</mo><mrow><mrow><mfrac><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow><mn>5</mn></mfrac><mo>\u2062</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow><mo>+</mo><mrow><mfrac><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow><mn>5</mn></mfrac><mo>\u2062</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>3</mn></mrow></msub></mrow></mrow></mrow><mo>.</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mrow><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow><mo>-</mo><mn>1</mn></mrow></mrow><mi>n</mi></munderover><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>=</mo><mi/></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mrow><mrow><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mrow><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>-</mo><mn>1</mn></mrow></mrow><mrow><mi>n</mi><mo>-</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow></munderover><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><mi>n</mi></mrow><mo>-</mo><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>f</mi><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow></mrow><mo>+</mo><mn>2</mn></mrow><mo>.</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.04391.tex", "nexttext": "\n\nSimilarly, $\\sum\\limits_{i=f_{5}-1}^{16}A(i)=\\sum\\limits_{i=f_{4}-1}^{8}A(i)+12$ and\n$\\sum\\limits_{i=f_{4}-1}^{8}A(i)=A(2)+A(3)+2=5$.\n\nThus $\\sum_{i=f_{6}-1}^{29}A(i)=25+12+5=42$.\n\n\n\\begin{algorithm}[The number of repeated palindrome occurrences, $B(n)$]\\\n\nStep 1. Find the $m$ such that $f_m\\leq n+1< f_{m+1}$, then $B(n)=B(f_m-2)+\\sum_{i=f_{m}-1}^{n}A(i)$.\n\nStep 2. Calculate $B(f_m-2)$ by the expression in Property 6.5;\n\nCalculate $\\sum_{i=f_{m}-1}^{n}A(i)$ by the recursive relation in Corollary \\ref{c5} or Theorem \\ref{P4.3}.\n\\end{algorithm}\n\nFor instance, since $f_6\\leq 29+1< f_{7}$, we have $m=6$.\nBy Theorem 6.2,\n$B(29)=B(19)+\\sum_{i=20}^{29}A(i)$.\nBy Property 6.5, $B(19)=\n\\frac{3}{5}f_{8}+\\frac{5}{5}f_{6}+2=56$.\nBy Theorem \\ref{P4.3} or Corollary \\ref{c5}, $\\sum_{i=20}^{29}A(i)=42$.\nThus $B(29)=98$.\n\n\\vspace{0.5cm}\n\n\\noindent\\textbf{\\Large{Acknowledgments}}\n\n\\vspace{0.4cm}\n\nThe research is supported by the Grant NSF No.11431007, No.11271223 and No.11371210.\n\n\\begin{thebibliography}{AB}\n\n\\bibitem{AS2003}  J.M.Allouche, J.Shallit, Automatic sequences: Theory, applications, generalizations. Cambridge University Press, Cambridge, 2003.\n\n\\bibitem{B1966} J.Berstel, Recent results in Sturmian words, in J.Dassow, A.Salomaa (Eds.), Developments in Language Theory, World Scientific, Singapore. (1966) 13-24.\n\n\\bibitem{B1980} J.Berstel, Mot de Fibonacci, S$\\acute{e}$minaire d'informatique th$\\acute{e}$rique, L.I.T.P., Paris, Ann$\\acute{e}$e 1980/1981, pp.57-78.\n    \n\\bibitem{B1980} L.Balkov$\\acute{a}$, E.Pelantov$\\acute{a}$, $\\check{S}$.Starosta, Palindromes in infinite ternary words. RAIRO-Theoretical Informatics and Applications, 43.4 (2009) 687-702.\n\n\\bibitem{C1993} W.-F.Chuan, Symmetric Fibonacci words, Fibonacci Quart 3 (1993) 251-255.\n\n\\bibitem{C2008} J.Cassaigne, On extremal properties of the Fibonacci word. RAIRO-Theoretical Informatics and Applications,42.4 (2008) 701-715.\n\n\\bibitem{CH2005} W.-F.Chuan, H.-L.Ho, Locating factors of the infinite Fibonacci word,\nTheoretical Computer Science. 349 (2005) 429-442.\n\n\\bibitem{CW2003} W.-T.Cao, Z.-Y.Wen, Some properties of the factors of Sturmian sequences,\nTheoretical Computer Science. 304 (2003) 365-385.\n\n\\bibitem{D1981} A.De Luca, A combinatorial property of the Fibonacci words, Information Processing Letters. 12.4 (1981) 193-195.\n\n\\bibitem{D1995} X.Droubay, Palindromes in the Fibonacci Word, Information Processing Letters. 55 (1995) 217-221.\n\n\\bibitem{D1998} F.Durand, A characterization of substitutive sequences using return words, Discrete Math. 179 (1998) 89-101.\n\n\\bibitem{DMSS2014} C.F.Du, H.Mousavi, L.Schaeffer, J.Shallit, Decision algorithms for fibonacci-automatic words, with applications to pattern avoidance. 2014.  arXiv:1406.0670.\n\n\\bibitem{DSS2015} C.F.Du, L.Schaeffer, J.Shallit, Decision Algorithms for Fibonacci-Automatic Words, I: Basic Results. Submitted, 2015.\n\n\\bibitem{DMRSS2015} C.F.Du, H.Mousavi, E.Rowland, L.Schaeffer, J.Shallit, Decision Algorithms for Fibonacci-Automatic Words, II: Related Sequences and Avoidability. Submitted, 2015.\n\n\\bibitem{DMSS2015} C.F.Du, H.Mousavi, L.Schaeffer, J.Shallit, Decision Algorithms for Fibonacci-Automatic Words, III: Enumeration and Abelian Properties. Submitted, 2015.\n\n\\bibitem{G2006} A.Glen, On Sturmian and Episturmian Words, and Related Topics, PhD thesis, The University of Adelaide, Australia. 2006.\n\n\\bibitem{G2006-1} A.Glen, Occurrences of palindromes in characteristic Sturmian words,\nTheoretical Computer Science. 352 (2006) 31-46.\n\n\\bibitem{HW2015-1} Y.-K.Huang, Z.-Y.Wen, The sequence of return words of the Fibonacci sequence, Theoretical Computer Science. 593 (2015) 106-116.\n\n\\bibitem{HW2015-2} Y.-K.Huang, Z.-Y.Wen, Kernel words and gap sequence of the Tribonacci sequence, Acta Mathematica Scientia (Series B). 36.1 (2016) 173-194.\n\n\n\\bibitem{L1983} M.Lothaire, Combinatorics on words, in: Encyclopedia of Mathematics and its applications, Vol.17, Addison-Wesley, Reading, MA, 1983.\n\n\\bibitem{L2002} M.Lothaire, Algebraic combinatorics on words, Cambridge Univ. Press, Cambridge, 2002.\n\n\\bibitem{WW1994} Z.-X.Wen, Z.-Y.Wen. Some properties of the singular words of the Fibonacci word, European J. Combin. 15 (1994) 587-598.\n\n\\end{thebibliography}\n\n\n\n\n\n\n\n\n\n\n\\end{CJK*}\n\n", "itemtype": "equation", "pos": 33738, "prevtext": "\n\nThus we have the expression that\n$\\sum\\limits_{i=f_{m}-1}^{n}A(i)\n=\\sum\\limits_{i=f_{m-1}-1}^{n-f_{m-1}}A(i)+n+\\frac{m-11}{5}f_{m-1}+\\frac{m+1}{5}f_{m-3}+2,$\nwhich yields the conclusion holds.\n\\end{proof}\n\n\\noindent\\textbf{Example.} We calculate $\\sum_{i=20}^{29}A(i)$. One method is using Theorem \\ref{P4.3}, we have\n\n$[A(1)]=[1]$,\n$[A(2),A(3)]=[1,2]$,\n$[A(4),A(5),A(6)]=[2,2,3]$,\n$[A(7),\\cdots,A(11)]=[2,3,3,3,4]$,\n\n$[A(12),\\cdots,A(19)]=[3,3,4,3,4,4,4,5]$,\n$[A(20),\\cdots,A(32)]=[3,4,4,4,5,4,4,5,4,5,5,5,6]$.\n\nSo $\\sum_{i=20}^{29}A(i)=3+4+4+4+5+4+4+5+4+5=42$.\n\nThe other method is using Corollary \\ref{c5}.\n\nSince $f_6=21\\leq 29+1< f_{7}=34$, $m=6$. Moreover $2f_5=26\\leq 29+1$,\n\n", "index": 47, "text": "$$\\begin{array}{c}\n\\sum\\limits_{i=f_{6}-1}^{29}A(i)\n=\\sum\\limits_{i=f_{5}-1}^{29-f_{5}}A(i)+29+\\frac{-5}{5}f_{5}+\\frac{7}{5}f_{3}+2\n=\\sum\\limits_{i=f_{5}-1}^{16}A(i)+25.\n\\end{array}$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex24.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{c}\\sum\\limits_{i=f_{6}-1}^{29}A(i)=\\sum\\limits_{i=f_{5}-1}^{29%&#10;-f_{5}}A(i)+29+\\frac{-5}{5}f_{5}+\\frac{7}{5}f_{3}+2=\\sum\\limits_{i=f_{5}-1}^{1%&#10;6}A(i)+25.\\end{array}\" display=\"block\"><mtable displaystyle=\"true\"><mtr><mtd columnalign=\"center\"><mrow><mrow><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mrow><msub><mi>f</mi><mn>6</mn></msub><mo>-</mo><mn>1</mn></mrow></mrow><mn>29</mn></munderover><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>=</mo><mrow><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mrow><msub><mi>f</mi><mn>5</mn></msub><mo>-</mo><mn>1</mn></mrow></mrow><mrow><mn>29</mn><mo>-</mo><msub><mi>f</mi><mn>5</mn></msub></mrow></munderover><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><mn>29</mn><mo>+</mo><mrow><mfrac><mrow><mo>-</mo><mn>5</mn></mrow><mn>5</mn></mfrac><mo>\u2062</mo><msub><mi>f</mi><mn>5</mn></msub></mrow><mo>+</mo><mrow><mfrac><mn>7</mn><mn>5</mn></mfrac><mo>\u2062</mo><msub><mi>f</mi><mn>3</mn></msub></mrow><mo>+</mo><mn>2</mn></mrow><mo>=</mo><mrow><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mrow><msub><mi>f</mi><mn>5</mn></msub><mo>-</mo><mn>1</mn></mrow></mrow><mn>16</mn></munderover><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><mn>25</mn></mrow></mrow><mo>.</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}]