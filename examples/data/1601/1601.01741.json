[{"file": "1601.01741.tex", "nexttext": "\nwhere $\\gamma$ ranges over all multi-bijections\\footnote{A multi-bijection is a bijective map between two multi-sets counted with their multiplicity.} from $D$ to $E$.\nNote that the cardinalities of $D$ and $E$ are equal by considering diagonal points with infinite multiplicity.\n\nA persistence diagram $D$ is said to be {\\em finite} if $\\underline{D}$ is a finite set.\nIt is known that if $X$ is a finite set \\cite{CSO} or $f$ is tame \\cite{CEH}, the persistence diagram $D_{q}(X)$ or $D_{q}(f)$ is finite, respectively.\nIn this paper, all persistence diagrams are assumed to be finite.\n\n\\subsection{Stability with respect to {\\boldmath $d_{B}$}}\n\nIt often happens that data obtained from measurements includes some noise, and thus its topology may be different from that of underlying geometric structure.\nIn such a case, it is desired that the persistence diagrams are stable under perturbation of data.\n\nWhen the input is given by a function, the stability of the persistence diagram is shown in \\cite{CEH}.\nHere, we measure the difference between two functions $f,g:M {\\rightarrow} \\lR$ by $\\norm{f-g}_{\\infty}=\\sup_{\\bm{x} \\in M} |f(\\bm{x})-g(\\bm{x})|$.\n\\begin{prop}[Cohen-Steiner et al. \\cite{CEH}]\n\\label{func_stability}\nLet $M$ be a triangulable compact metric space with continuous tame functions $f,g:M {\\rightarrow} \\lR$. \nThen the persistence diagrams satisfy \n", "itemtype": "equation", "pos": 12891, "prevtext": "\n\\maketitle\n\n\n\n\n\\begin{abstract}\n\nTopological data analysis is an emerging mathematical concept for characterizing shapes in multi-scale data. In this field, persistence diagrams are widely used as a descriptor of the input data, and can distinguish robust and noisy topological properties.  \nNowadays, it is highly desired to develop a statistical framework on persistence diagrams to deal with practical data. \nThis paper proposes a kernel method on persistence diagrams. \nA theoretical contribution of our method is that the proposed kernel allows one to control the effect of persistence, and, if necessary, noisy topological properties can be discounted in data analysis. \nFurthermore, the method provides a fast approximation technique. The method is applied into several problems including practical data in physics, and the results show the advantage compared to the existing kernel method on persistence diagrams.\n\\end{abstract}\n\n\n\\section{Introduction}\n\nRecent years have witnessed an increasing interest in utilizing methods of algebraic topology for statistical data analysis.  \nThis line of research is called {\\em topological data analysis} (TDA) \\cite{Ca}, which has been successfully applied to various problems including information science \\cite{CIdSZ,dSG,Ed}, biology \\cite{KZPSGP,XW}, brain science \\cite{LCKKL,PETCNHV,SMISCR}, biochemistry \\cite{GHIKMN}, and material science \\cite{HNHEMN, NHHEN}.  The motivation of this approach is to uncover informative topological properties (e.g., connected component, ring, and cavity) in complex geometric configurations of data, and use them as a description of data. \n\nA key mathematical apparatus in TDA is {\\em persistent homology}, which is an algebraic method for extracting robust topological information from the input data.  To illustrate the persistent homology intuitively, let us consider a setting of manifold learning. Assume that data points are generated by a distribution with support on a manifold embedded in a high-dimensional Euclidean space.  The aim is to make inference on the topology of the underlying manifold from finite data points.  We represent the data points by the $r$-balls in a common practice,  as employed in constructing an $r$-neighbor graph for many manifold learning algorithms, and consider a filtration generated by increasing radii, i.e., an increasing sequence of balls (Figure \\ref{fig:filtration}).  While it is expected that, with an appropriate choice of $r$, the $r$-ball model can represent the underlying topological structures of the manifold, it is also known that the result is sensitive to the choice of $r$.  If $r$ is too small, the union consists simply of the disjoint $r$-balls. On the other hand, if $r$ is too large, the union becomes a contractible space. Persistent homology can consider {\\em all} $r$ simultaneously and provide an algebraic expression of topological properties together with their persistence over $r$.  We give the definition and basic properties of persistent homology in Section \\ref{background} (for more details, see \\cite{Bu,Ca}).\n\n\\begin{figure}[htbp]\n \\begin{center}\n  \\includegraphics[width=80mm]{filtration.pdf}\n \\end{center}\n  \\caption{The union $ X_{r}$ of $r$-balls at points sampled from an annulus with noise. The values $\\beta_{0}$ and $\\beta_{1}$ are the number of connected components and rings, respectively.}\n  \\label{fig:filtration}\n\\end{figure}\n\nThe persistent homology can be visualized in a compact form called a {\\em persistence diagram} $D=\\{(b_i,d_i) \\in \\lR^{2} \\mid i\\in I, \\ b_i \\leq d_i\\}$ \\cite{ELZ}. Here, each point $(b_i,d_i)$, called a generator of the persistent homology, represents a topological property in the input data. Furthermore, the {\\em persistence} $d_i-b_i$ of the generator shows the lifetime of the topological property in the filtration. As an example, for the $r$-ball model in Figure \\ref{fig:filtration}, the rings $\\alpha_{1},\\alpha_{2}$ and other tiny ones are expressed as $x_{1},x_{2}$, and the other points in the persistence diagram shown in Figure \\ref{fig:pd}. A topological property with large persistence can be regarded as a reliable structure, while that with small persistence (points close to the diagonal) is likely to be noise. In this way, persistence diagrams encode topological and geometric information of data points.\n\n\\begin{figure}[htbp]\n \\begin{center}\n  \\includegraphics[width=60mm]{pd.pdf}\n \\end{center}\n  \\caption{The persistence diagram of the $r$-ball model in Figure \\ref{fig:filtration}. The point $x_{1}$ represents the ring $\\alpha_{1}$, which is born at $r=0.63$ and dies at $r=0.92$. The noisy rings are plotted as the points close to the diagonal.}\n  \\label{fig:pd}\n\\end{figure}\n\nAs a useful tool in TDA, persistence diagrams have been studied by many researchers.  One of the theoretical concerns is the {\\em stability} of persistence diagrams, asking whether a small change of data causes a small change in the persistence diagram. It has been proved that this is true for the bottleneck distance \\cite{CSO, CEH} (see also Section \\ref{background}) and the $L^{p}$-Wasserstein distance \\cite{CEHM} on the persistence diagrams. From statistical perspective, given random data, the paper \\cite{FLRWB} discusses confidence sets of generators in terms of the distance from the diagonal.\n\nThis paper discusses kernel methods for TDA, aiming at developing a framework of statistical data analysis for persistence diagrams.  Since a persistence diagram is a point set of variable size, it is not straightforward to apply standard methods of statistical data analysis, which typically treat vectorial data.  We introduce a useful class of positive definite kernels on persistence diagrams. The idea of our kernel is based on recent developments of kernel mean \\cite{MFDS,SGSS} in which a probability distribution is embedded as a mean of feature vectors in a Hilbert space. It is also known \\cite{SFL} that more generally, with an appropriate choice of kernels, a signed measure can be uniquely represented by the Bochner integral of the feature vectors with respect to the measure.  Since a persistence diagram is regarded as a non-negative measure above the diagonal, it can be embedded into a Hilbert space by the Bochner integral. Once such a vector representation is obtained, we can utilize any kernel methods for persistence diagrams.\n\nIn this paper, we propose a {\\em persistence weighted Gaussian kernel} (Section \\ref{pdkernel}) on the space of persistence diagrams. In addition to the Gaussian factor, the kernel has a weight to control the kernel value based on the persistence of generators. This definition reflects the property of persistence diagrams that generators close to the diagonal are likely to be noise and, if necessary, our kernel can discount these generators in data analysis. We also show that the kernel defines a distance on persistence diagrams and prove stability results with this distance.\nThese stability results ensure the continuity from data to the vector representation of the persistence diagram in a Hilbert space.\nIn Section \\ref{experiment}, we demonstrate the proposed method for kernel change point detection \\cite{HBM} and kernel principal component analysis \\cite{SSM} on synthesized data, and experimental/simulation data in physics. The computational results show the effectiveness of our method. \n\nSome works have been already done on the methods for transforming a persistence diagram to a vector: persistence landscape \\cite{Bu}, persistent homology rank function \\cite{RT}, and persistence image \\cite{CEHK}.  In these methods, a transformed vector is a function in a Hilbert space, typically $L^p$ space, and simple summary statistics like means and variances are used as inputs to data analysis, such as principal component analysis and support vector machines. However, these methods do not incorporate the higher-order statistics of persistence diagrams.  The most relevant work to our method is studied in \\cite{RHBK}, where kernel embedding is used to represent persistence diagrams. They use the difference of two Gaussian kernels evaluated at symmetric points with respect to the diagonal so that it vanishes on the diagonal. However, their method cannot explicitly control the persistence, showing the advantage of our method. We give detailed comparisons between our kernel and the one in \\cite{RHBK}.\n\n\n\\section{Background}\n\\label{background}\n\nIn this section, we review the concepts of persistence diagrams and kernel methods.\n\n\\subsection{Persistence diagram}\n\nLet $X = \\{\\bm{x}_1, \\ldots, \\bm{x}_n \\}$ be a finite subset of some metric space $(M,d_{M})$.\nIn practice, $X$ is an input data for some analysis, and we wish to use the topological properties in the analysis.\nTo this aim, let us consider a fattened set $X_{r}=\\bigcup_{i=1}^{n} B(\\bm{x}_{i};r)$, where $B(\\bm{x};r)=\\{ \\bm{x}' \\in M \\mid d_{M}(\\bm{x},\\bm{x}') \\leq r\\}$ and $r$ is regarded as a parameter changing resolutions.\nThen, we use the {\\em homology} $H_{q}(X_{r})$ to describe the topology of $X_{r}$.\nHere, for a topological space $S$, its $q$-th homology $H_{q}(S) \\ (q=0,1,\\cdots)$ is defined as a vector space\\footnote{Throughout this paper we use a field coefficient for homology. For accessible introduction to homology, see \\cite{Mu}.} and its dimension $\\dim H_{q}(S)$ measures the number of connected components $(q=0)$, rings $(q=1)$, cavities $(q=2)$, and so on.\nBecause of $X_{r} \\subset X_{s}$ for $r \\leq s$, the set $\\lX=\\{X_{r} \\mid r \\geq 0\\}$ becomes a filtration\\footnote{A {\\em filtration} is a family of subsets $\\{X_a \\mid a \\in A \\}$ indexed by a partially ordered set $A$ such that $X_a\\subset X_b$ for $a\\leq b$.} and the inclusion $X_{r} {\\hookrightarrow} X_{s}$ induces the linear map $\\iota^{s}_{r} : H_{q}(X_{r}) {\\rightarrow} H_{q}(X_{s})$ in homology.\nThen, the persistent homology $H_{q}(\\lX)$ is defined by $\\{ \\iota^{s}_{r}:H_{q}(X_{r}) {\\rightarrow} H_{q}(X_{s}) \\mid r \\leq s \\}$ as a graded module $H_{q}(\\lX)=\\bigoplus_{r \\geq 0} H_{q}(X_{r})$ (see \\cite{Ca} for details).\n\nIt is known that the persistent homology has a compact expression called the persistence diagram.\nLet a generator $\\alpha_{i} \\in H_{q}(X_{r})$ appear at $r=b_{i}$ and disappear at $r=d_{i} \\ (b_{i} < d_{i})$ in the filtration.\nIf $\\alpha_{i} \\in H_{q}(X_{r})$ does not disappear, we assign $d_{i}=\\infty$.\nThen, we plot the birth-death pair $(b_{i},d_{i})$ on $\\overline{\\lR}^{2}$, where $\\overline{\\lR}=\\lR \\cup \\{ \\infty\\}$.\nBy gathering all generators $\\alpha_{i} \\  (i \\in I)$, we obtain the collection of these pairs $\\underline{D}_{q}(X)=\\{ (b_{i},d_{i}) \\in \\overline{\\lR}^{2} \\mid i \\in I \\}$ as a multi-set.\nThe {\\em persistence diagram} $D_{q}(X)$ is defined by the disjoint union of $\\underline{D}_{q}(X)$ and the diagonal set ${\\Delta}=\\{(x,x) \\mid x \\in \\overline{\\lR}\\}$ counted with infinite multiplicity.\n\nFor a point $x=(b,d) \\in D_{q}(X)$, the {\\em persistence} ${\\rm pers}(x):=d-b$ of $x$ is defined by its lifetime.\nIn Figure \\ref{fig:pd}, the persistence of $x_{2}$ is the longest and that of $x_{1}$ is the second longest.\nOn the other hand, since the other generators have small persistences, they can be seen as noisy rings.\nIn this way, a persistence diagram provides a topological summary of $X_{r}$ over all $r$.\n\nThere is another type of popular constructions of persistent homology, which supposes a function as an input.\nGiven a function $f:M {\\rightarrow} \\lR$, a {\\em sub-level set} $F_{a}=\\{ \\bm{x} \\in M \\mid f(\\bm{x}) \\leq a\\}$ defines the persistent homology $H_{q}(\\lF)=\\bigoplus_{a \\in \\lR} H_{q}(F_{a})$ via the filtration $\\lF = \\{ F_{a} \\mid a \\in \\lR\\}$ (Figure \\ref{fig:sub-level}). A function $f$ is said to be {\\em tame} if the rank of homology $H_{q}(F_{a})$ is finite for all $a \\in \\lR$ and the number of homological critical values\\footnote{A {\\em homological critical value} of $f$ is the number $a \\in \\lR$ such that the linear map $H_{q}(F_{a-{\\varepsilon}}) {\\rightarrow} H_{q}(F_{a+{\\varepsilon}})$ is not isomorphic for any ${\\varepsilon}>0$.} of $f$ is finite. \nFor a tame function $f:M {\\rightarrow} \\lR$, the persistence diagram of $H_{q}(\\lF)$ can be defined in a similar way and it is denoted by $D_{q}(f)$ for short.\nNote that, for a finite set $X=\\{\\bm{x}_1, \\ldots, \\bm{x}_n \\}$ of $M \\subset \\lR^{d}$ and the function $f_{X}:M {\\rightarrow} \\lR$ defined by $f_{X}(\\bm{x})=\\min_{\\bm{x}_{i} \\in X} d_{M} (\\bm{x},\\bm{x}_{i})$, $f_{X}$ is tame and the persistence diagram $D_{q}(f_{X})$ of the sub-level set is the same as $D_{q}(X)$.\n\\begin{figure}[htbp]\n \\begin{center}\n  \\includegraphics[width=60mm]{sub-level.pdf}\n \\end{center}\n  \\caption{A filtration $\\lF=\\{ F_{a} \\mid a \\in \\lR\\}$ of sub-level sets.}\n  \\label{fig:sub-level}\n\\end{figure}\n\nWe measure the distance between two persistence diagrams $D$ and $E$ by the {\\em bottleneck distance}\n", "index": 1, "text": "\n\\[\nd_{B}(D,E):=\\inf_{\\gamma} \\sup_{x \\in D} \\norm{x-\\gamma(x)}_{\\infty},\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"d_{B}(D,E):=\\inf_{\\gamma}\\sup_{x\\in D}\\norm{x-\\gamma(x)}_{\\infty},\" display=\"block\"><mrow><mrow><mrow><msub><mi>d</mi><mi>B</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>D</mi><mo>,</mo><mi>E</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>:=</mo><mrow><mrow><munder><mo movablelimits=\"false\">inf</mo><mi>\u03b3</mi></munder><mo>\u2061</mo><mrow><munder><mo movablelimits=\"false\">sup</mo><mrow><mi>x</mi><mo>\u2208</mo><mi>D</mi></mrow></munder><mo>\u2061</mo><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><mi>x</mi></mrow></mrow></mrow><mo>-</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mi mathvariant=\"normal\">\u221e</mi></msub></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\n\\end{prop}\n\nFor finite subsets $X$ and $Y$ of $M$, $\\norm{f_{X}-f_{Y}}_{\\infty}$ is nothing but the Hausdorff distance $d_{H}(X,Y)$ given by\n", "itemtype": "equation", "pos": 14341, "prevtext": "\nwhere $\\gamma$ ranges over all multi-bijections\\footnote{A multi-bijection is a bijective map between two multi-sets counted with their multiplicity.} from $D$ to $E$.\nNote that the cardinalities of $D$ and $E$ are equal by considering diagonal points with infinite multiplicity.\n\nA persistence diagram $D$ is said to be {\\em finite} if $\\underline{D}$ is a finite set.\nIt is known that if $X$ is a finite set \\cite{CSO} or $f$ is tame \\cite{CEH}, the persistence diagram $D_{q}(X)$ or $D_{q}(f)$ is finite, respectively.\nIn this paper, all persistence diagrams are assumed to be finite.\n\n\\subsection{Stability with respect to {\\boldmath $d_{B}$}}\n\nIt often happens that data obtained from measurements includes some noise, and thus its topology may be different from that of underlying geometric structure.\nIn such a case, it is desired that the persistence diagrams are stable under perturbation of data.\n\nWhen the input is given by a function, the stability of the persistence diagram is shown in \\cite{CEH}.\nHere, we measure the difference between two functions $f,g:M {\\rightarrow} \\lR$ by $\\norm{f-g}_{\\infty}=\\sup_{\\bm{x} \\in M} |f(\\bm{x})-g(\\bm{x})|$.\n\\begin{prop}[Cohen-Steiner et al. \\cite{CEH}]\n\\label{func_stability}\nLet $M$ be a triangulable compact metric space with continuous tame functions $f,g:M {\\rightarrow} \\lR$. \nThen the persistence diagrams satisfy \n", "index": 3, "text": "\n\\[\nd_{B}(D_{q}(f),D_{q}(g)) < \\norm{f-g}_{\\infty}.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"d_{B}(D_{q}(f),D_{q}(g))&lt;\\norm{f-g}_{\\infty}.\" display=\"block\"><mrow><mrow><mrow><msub><mi>d</mi><mi>B</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>D</mi><mi>q</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>,</mo><mrow><msub><mi>D</mi><mi>q</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>g</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>&lt;</mo><mrow><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><mi>f</mi></mrow><mo>-</mo><msub><mi>g</mi><mi mathvariant=\"normal\">\u221e</mi></msub></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\nHence, we also have the following (for more general setting, see \\cite{CSO}).\n\\begin{prop}\n\\label{point_stability}\nLet $X$ and $Y$ be finite subsets of a metric space $(M,d_{M})$. \nThen the persistence diagrams satisfy \n", "itemtype": "equation", "pos": 14536, "prevtext": "\n\\end{prop}\n\nFor finite subsets $X$ and $Y$ of $M$, $\\norm{f_{X}-f_{Y}}_{\\infty}$ is nothing but the Hausdorff distance $d_{H}(X,Y)$ given by\n", "index": 5, "text": "\n\\[\n\\max \\left\\{\\sup_{\\bm{x} \\in X} \\inf_{\\bm{y} \\in Y} d_{M}(\\bm{x},\\bm{y}), \\sup_{\\bm{y} \\in Y} \\inf_{\\bm{x} \\in X} d_{M}(\\bm{x},\\bm{y}) \\right\\}.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"\\max\\left\\{\\sup_{\\bm{x}\\in X}\\inf_{\\bm{y}\\in Y}d_{M}(\\bm{x},\\bm{y}),\\sup_{\\bm{%&#10;y}\\in Y}\\inf_{\\bm{x}\\in X}d_{M}(\\bm{x},\\bm{y})\\right\\}.\" display=\"block\"><mrow><mrow><mi>max</mi><mo>\u2061</mo><mrow><mo>{</mo><mrow><munder><mo movablelimits=\"false\">sup</mo><mrow><mi>\ud835\udc99</mi><mo>\u2208</mo><mi>X</mi></mrow></munder><mo>\u2061</mo><mrow><munder><mo movablelimits=\"false\">inf</mo><mrow><mi>\ud835\udc9a</mi><mo>\u2208</mo><mi>Y</mi></mrow></munder><mo>\u2061</mo><mrow><msub><mi>d</mi><mi>M</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc99</mi><mo>,</mo><mi>\ud835\udc9a</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>,</mo><mrow><munder><mo movablelimits=\"false\">sup</mo><mrow><mi>\ud835\udc9a</mi><mo>\u2208</mo><mi>Y</mi></mrow></munder><mo>\u2061</mo><mrow><munder><mo movablelimits=\"false\">inf</mo><mrow><mi>\ud835\udc99</mi><mo>\u2208</mo><mi>X</mi></mrow></munder><mo>\u2061</mo><mrow><msub><mi>d</mi><mi>M</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc99</mi><mo>,</mo><mi>\ud835\udc9a</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>}</mo></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\n\\end{prop}\n\nUsing Proposition \\ref{point_stability}, let us explain a geometric intuition of the stability of persistence diagrams.\nAssume that $X$ is the true location of points and $Y$ is a data obtained from skewed measurement with ${\\varepsilon}=d_{H}(X,Y)$ (Figure \\ref{fig:stability}).\nIf there is a point $(b,d) \\in D_{q}(Y)$,\nthen we can automatically conclude that there is at least one generator in $X$ which is born in $(b-{\\varepsilon},b+{\\varepsilon})$ and dies in $(d-{\\varepsilon},d+{\\varepsilon})$ (Figure \\ref{fig:stability}).\nThus the stability guarantees the similarity of two persistence diagrams, and hence allows us to study some features in one persistence diagram by another. \n\\begin{figure}[htbp]\n\\begin{center}\n\\includegraphics[width=80mm]{stability.pdf}\n\\end{center}\n\\caption{Two data $X$ and $Y$ (left) and their persistence diagrams (right). The green region is an ${\\varepsilon}$-neighborhood of $D_{q}(Y)$.}\n\\label{fig:stability}\n\\end{figure}\n\n\n\\subsection{Kernel methods for representing signed measures}\n\\label{subsec:universal}\n\nLet $\\Omega$ be a set and $k:\\Omega \\times \\Omega {\\rightarrow} \\lR$ be a {\\em positive definite kernel} on $\\Omega$, i.e., $k$ is symmetric, and \nfor any number of points $x_{1},\\ldots,x_{n}$ in $\\Omega$, the Gram matrix $\\pare{k(x_{i},x_{j})}_{i,j=1,\\ldots,n}$ is nonnegative definite.\nIt is well known that the Gaussian kernel $k_{G}(x,y)=e^{-\\frac{\\norm{x-y}^{2}}{2 \\sigma^{2}}}, \\ (\\sigma>0)$ is an example of positive definite kernels on $\\lR^{d}$, where $\\norm{\\cdot}$ is the $L^{2}$-norm of $\\lR^{d}$.  It is also known that every positive definite kernel $k$ on $\\Omega$ is uniquely associated with a reproducing kernel Hilbert space (RKHS), for which $k$ serves as a reproducing kernel, i.e., $\\inn{f}{k(\\cdot,x)}_{\\cH_{k}}=f(x)$ for each $x \\in \\Omega$ and $f \\in \\cH_{k}$. There are many works using positive definite kernels for data analysis; they are called kernel methods (see \\cite{SS} as a reference). \n\nWe use a positive definite kernel to represent persistence diagrams by following the idea of the kernel mean embedding of distributions \\cite{SGSS,SFL}.  Let $\\Omega$ be a measurable space, $M_{b}(\\Omega)$ be the space of all finite signed Radon measures on $\\Omega$, and $k$ be a bounded measurable kernel on $\\Omega$.\nThen we define a mapping from $M_{b}(\\Omega)$ to $\\cH_{k}$ by\n\n", "itemtype": "equation", "pos": 14907, "prevtext": "\nHence, we also have the following (for more general setting, see \\cite{CSO}).\n\\begin{prop}\n\\label{point_stability}\nLet $X$ and $Y$ be finite subsets of a metric space $(M,d_{M})$. \nThen the persistence diagrams satisfy \n", "index": 7, "text": "\n\\[\nd_{B}(D_{q}(X),D_{q}(Y)) < d_{H}(X,Y).\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m1\" class=\"ltx_Math\" alttext=\"d_{B}(D_{q}(X),D_{q}(Y))&lt;d_{H}(X,Y).\" display=\"block\"><mrow><mrow><mrow><msub><mi>d</mi><mi>B</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>D</mi><mi>q</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>,</mo><mrow><msub><mi>D</mi><mi>q</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>&lt;</mo><mrow><msub><mi>d</mi><mi>H</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>X</mi><mo>,</mo><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\n\nThe integral should be understood as the Bochner integral \\cite{DU}, which exists when $\\int \\norm{k(\\cdot,x)}_{\\cH_{k}} d \\mu(x)$ is finite.\nFrom the boundedness of $k$ and the finiteness of $\\mu$, the norm $\\norm{k(\\cdot,x)}_{\\cH_{k}}=\\sqrt{k(x,x)}$ is integrable.  \n\nFor a locally compact Hausdorff (LCH) space $\\Omega$,\nlet $C_{0}(\\Omega)$ denote the space of continuous functions vanishing at infinity\\footnote{A function $f$ is said to vanish at infinity if for any ${\\varepsilon} >0$ there is a compact set $K \\subset \\Omega$ such that $\\sup_{x \\in K^{c}} |f(x)| \\leq {\\varepsilon}$.}.\nA kernel $k$ on $\\Omega$ is said to be $C_{0}$-kernel if $k(x,x)$ is of $C_{0}(\\Omega)$ as a function of $x$.\nIf $k$ is $C_{0}$-kernel, the associated RKHS $\\cH_{k}$ is a subspace of $C_{0}(\\Omega)$. \nA $C_{0}$-kernel $k$ is called {\\em $C_{0}$-universal} if $\\cH_{k}$ is dense in $C_{0}(\\Omega)$.\nIt is known that the Gaussian kernel $k_{G}$ is $C_{0}$-universal on $\\lR^{d}$ \\cite{SFL}.  \nWith $C_{0}$-universal kernel, the mapping $E_{k}$ defines an injection from $M_{b}(\\Omega)$ to $\\cH_{k}$. Then, from the injectivity, the Bochner integral introduces a distance on $M_{b}(\\Omega)$:\n\\begin{prop}[Sriperumbudur et al. \\cite{SFL}]\n\\label{C0_distance}\nIf $k$ is $C_{0}$-universal,\n", "itemtype": "equation", "pos": 17320, "prevtext": "\n\\end{prop}\n\nUsing Proposition \\ref{point_stability}, let us explain a geometric intuition of the stability of persistence diagrams.\nAssume that $X$ is the true location of points and $Y$ is a data obtained from skewed measurement with ${\\varepsilon}=d_{H}(X,Y)$ (Figure \\ref{fig:stability}).\nIf there is a point $(b,d) \\in D_{q}(Y)$,\nthen we can automatically conclude that there is at least one generator in $X$ which is born in $(b-{\\varepsilon},b+{\\varepsilon})$ and dies in $(d-{\\varepsilon},d+{\\varepsilon})$ (Figure \\ref{fig:stability}).\nThus the stability guarantees the similarity of two persistence diagrams, and hence allows us to study some features in one persistence diagram by another. \n\\begin{figure}[htbp]\n\\begin{center}\n\\includegraphics[width=80mm]{stability.pdf}\n\\end{center}\n\\caption{Two data $X$ and $Y$ (left) and their persistence diagrams (right). The green region is an ${\\varepsilon}$-neighborhood of $D_{q}(Y)$.}\n\\label{fig:stability}\n\\end{figure}\n\n\n\\subsection{Kernel methods for representing signed measures}\n\\label{subsec:universal}\n\nLet $\\Omega$ be a set and $k:\\Omega \\times \\Omega {\\rightarrow} \\lR$ be a {\\em positive definite kernel} on $\\Omega$, i.e., $k$ is symmetric, and \nfor any number of points $x_{1},\\ldots,x_{n}$ in $\\Omega$, the Gram matrix $\\pare{k(x_{i},x_{j})}_{i,j=1,\\ldots,n}$ is nonnegative definite.\nIt is well known that the Gaussian kernel $k_{G}(x,y)=e^{-\\frac{\\norm{x-y}^{2}}{2 \\sigma^{2}}}, \\ (\\sigma>0)$ is an example of positive definite kernels on $\\lR^{d}$, where $\\norm{\\cdot}$ is the $L^{2}$-norm of $\\lR^{d}$.  It is also known that every positive definite kernel $k$ on $\\Omega$ is uniquely associated with a reproducing kernel Hilbert space (RKHS), for which $k$ serves as a reproducing kernel, i.e., $\\inn{f}{k(\\cdot,x)}_{\\cH_{k}}=f(x)$ for each $x \\in \\Omega$ and $f \\in \\cH_{k}$. There are many works using positive definite kernels for data analysis; they are called kernel methods (see \\cite{SS} as a reference). \n\nWe use a positive definite kernel to represent persistence diagrams by following the idea of the kernel mean embedding of distributions \\cite{SGSS,SFL}.  Let $\\Omega$ be a measurable space, $M_{b}(\\Omega)$ be the space of all finite signed Radon measures on $\\Omega$, and $k$ be a bounded measurable kernel on $\\Omega$.\nThen we define a mapping from $M_{b}(\\Omega)$ to $\\cH_{k}$ by\n\n", "index": 9, "text": "\\begin{equation}\\label{E_k}\nE_{k}:M_{b}(\\Omega) {\\rightarrow} \\cH_{k}, ~~ \\mu \\mapsto \\int k(\\cdot, x) d \\mu(x).\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"E_{k}:M_{b}(\\Omega){\\rightarrow}\\cH_{k},~{}~{}\\mu\\mapsto\\int k(\\cdot,x)d\\mu(x).\" display=\"block\"><mrow><mrow><msub><mi>E</mi><mi>k</mi></msub><mo>:</mo><mrow><mrow><mrow><msub><mi>M</mi><mi>b</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">\u03a9</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2192</mo><msub><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\cH</mtext></merror><mi>k</mi></msub></mrow><mo rspace=\"9.1pt\">,</mo><mrow><mi>\u03bc</mi><mo>\u21a6</mo><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mi>k</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mo>\u22c5</mo><mo>,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>\u03bc</mi></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\ndefines a distance on $M_{b}(\\Omega)$.\n\\end{prop}\n\n\n\\section{Kernel on persistence diagrams}\n\\label{pdkernel}\n\nIn this section, we propose a kernel specializing in a persistence diagram.\nThe kernel enables us to apply any kernel methods to persistence diagrams and defines a distance on persistence diagrams.\nWe also discuss the stability properties with respect to the distance.\n\n\\subsection{Persistence weighted Gaussian kernel}\n\nA finite persistence diagram $D$ can be seen as a sum of Dirac delta measures $\\mu_{D}:=\\sum_{x \\in \\underline{D}} {\\delta}_{x}$.\nMore generally, we can treat $D$ as an weighted measure $\\mu^{w}_{D}:=\\sum_{x \\in \\underline{D}} w(x){\\delta}_{x}$ with an appropriate weight $w(x) \\in \\lR$ for each generator $x \\in \\underline{D}$ (Figure \\ref{fig:weighted}). \nIn later application, $w$ is chosen so that we can control the effect of persistence.\n\\begin{figure}[htbp]\n\\begin{center}\n\\includegraphics[width=80mm]{weighted_delta.pdf}\n\\end{center}\n\\caption{ Comparison between $\\mu_{D}$ (left) and $\\mu^{w}_{D}$ (right).}\n\\label{fig:weighted}\n\\end{figure}\n\nAs mentioned in Section \\ref{subsec:universal}, by a positive definite kernel $k$ on $\\lR^{2}$, the finite signed Radon measure $\\mu^{w}_{D}$ can be transformed into an element of RKHS $\\cH_{k}$ via $\\mu^{w}_{D} \\mapsto E_{k}(\\mu^{w}_{D})$. \nMoreover, if $k$ is $C_0$-universal, $E_k$ is injective, and hence there is no loss of information about persistence diagrams.\nIn addition, from Proposition \\ref{C0_distance}, $d^{w}_{k}(D,E):=\\norm{E_k (\\mu^{w}_D) -E_k (\\mu^{w}_E)}_{\\cH_{k}} $ defines a distance on the set of finite persistence diagrams.\nIn this case, $d^{w}_{k}(D,E)$ has the following expansion which is easy to compute:\n\n", "itemtype": "equation", "pos": 18725, "prevtext": "\n\nThe integral should be understood as the Bochner integral \\cite{DU}, which exists when $\\int \\norm{k(\\cdot,x)}_{\\cH_{k}} d \\mu(x)$ is finite.\nFrom the boundedness of $k$ and the finiteness of $\\mu$, the norm $\\norm{k(\\cdot,x)}_{\\cH_{k}}=\\sqrt{k(x,x)}$ is integrable.  \n\nFor a locally compact Hausdorff (LCH) space $\\Omega$,\nlet $C_{0}(\\Omega)$ denote the space of continuous functions vanishing at infinity\\footnote{A function $f$ is said to vanish at infinity if for any ${\\varepsilon} >0$ there is a compact set $K \\subset \\Omega$ such that $\\sup_{x \\in K^{c}} |f(x)| \\leq {\\varepsilon}$.}.\nA kernel $k$ on $\\Omega$ is said to be $C_{0}$-kernel if $k(x,x)$ is of $C_{0}(\\Omega)$ as a function of $x$.\nIf $k$ is $C_{0}$-kernel, the associated RKHS $\\cH_{k}$ is a subspace of $C_{0}(\\Omega)$. \nA $C_{0}$-kernel $k$ is called {\\em $C_{0}$-universal} if $\\cH_{k}$ is dense in $C_{0}(\\Omega)$.\nIt is known that the Gaussian kernel $k_{G}$ is $C_{0}$-universal on $\\lR^{d}$ \\cite{SFL}.  \nWith $C_{0}$-universal kernel, the mapping $E_{k}$ defines an injection from $M_{b}(\\Omega)$ to $\\cH_{k}$. Then, from the injectivity, the Bochner integral introduces a distance on $M_{b}(\\Omega)$:\n\\begin{prop}[Sriperumbudur et al. \\cite{SFL}]\n\\label{C0_distance}\nIf $k$ is $C_{0}$-universal,\n", "index": 11, "text": "\n\\[\nd_{k}(\\mu,\\nu)=\\norm{E_{k}(\\mu)-E_{k}(\\nu)}_{\\cH_{k}}\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m1\" class=\"ltx_Math\" alttext=\"d_{k}(\\mu,\\nu)=\\norm{E_{k}(\\mu)-E_{k}(\\nu)}_{\\cH_{k}}\" display=\"block\"><mrow><mrow><msub><mi>d</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03bc</mi><mo>,</mo><mi>\u03bd</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><msub><mi>E</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03bc</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><msub><mi>E</mi><mi>k</mi></msub><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">(</mo><mi>\u03bd</mi><mo stretchy=\"false\">)</mo></mrow><msub><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\cH</mtext></merror><mi>k</mi></msub></msub></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\n\nIn this paper, we choose the Gaussian kernel $k_{G}(x,y)=e^{-\\frac{\\norm{x-y}^{2}}{2 \\sigma^{2}}} \\ (\\sigma>0)$ as a $C_{0}$-universal kernel and $w(x)=\\arctan(C {\\rm pers}(x)^{p}) \\ (C,p >0)$ as an weight function.\nThe reasons of these choices are followings:\n(i) $w:\\lR^{2} {\\rightarrow} \\lR$ satisfies $\\mu^{w}_{D} \\in M_{b}(\\lR^{2})$,\n(ii) $w$ is an increasing function with respect to persistence so that a noisy (resp. characteristic) generator $x$ corresponds to small (resp. large) value $w(x)$,\n(iii) parameters $C$ and $p$ can control the weight of generators,\n(iv) stability properties with respect to $d^{w}_{k_{G}}$ hold (Section \\ref{subsec:stability}).\n\nFollowing \\cite{MFDS}, we make a nonlinear kernel on persistence diagrams such as \n\n", "itemtype": "equation", "pos": 20503, "prevtext": "\ndefines a distance on $M_{b}(\\Omega)$.\n\\end{prop}\n\n\n\\section{Kernel on persistence diagrams}\n\\label{pdkernel}\n\nIn this section, we propose a kernel specializing in a persistence diagram.\nThe kernel enables us to apply any kernel methods to persistence diagrams and defines a distance on persistence diagrams.\nWe also discuss the stability properties with respect to the distance.\n\n\\subsection{Persistence weighted Gaussian kernel}\n\nA finite persistence diagram $D$ can be seen as a sum of Dirac delta measures $\\mu_{D}:=\\sum_{x \\in \\underline{D}} {\\delta}_{x}$.\nMore generally, we can treat $D$ as an weighted measure $\\mu^{w}_{D}:=\\sum_{x \\in \\underline{D}} w(x){\\delta}_{x}$ with an appropriate weight $w(x) \\in \\lR$ for each generator $x \\in \\underline{D}$ (Figure \\ref{fig:weighted}). \nIn later application, $w$ is chosen so that we can control the effect of persistence.\n\\begin{figure}[htbp]\n\\begin{center}\n\\includegraphics[width=80mm]{weighted_delta.pdf}\n\\end{center}\n\\caption{ Comparison between $\\mu_{D}$ (left) and $\\mu^{w}_{D}$ (right).}\n\\label{fig:weighted}\n\\end{figure}\n\nAs mentioned in Section \\ref{subsec:universal}, by a positive definite kernel $k$ on $\\lR^{2}$, the finite signed Radon measure $\\mu^{w}_{D}$ can be transformed into an element of RKHS $\\cH_{k}$ via $\\mu^{w}_{D} \\mapsto E_{k}(\\mu^{w}_{D})$. \nMoreover, if $k$ is $C_0$-universal, $E_k$ is injective, and hence there is no loss of information about persistence diagrams.\nIn addition, from Proposition \\ref{C0_distance}, $d^{w}_{k}(D,E):=\\norm{E_k (\\mu^{w}_D) -E_k (\\mu^{w}_E)}_{\\cH_{k}} $ defines a distance on the set of finite persistence diagrams.\nIn this case, $d^{w}_{k}(D,E)$ has the following expansion which is easy to compute:\n\n", "index": 13, "text": "\\begin{align*}\nd^{w}_{k}(D,E)^{2} \n&=\\sum_{x \\in \\underline{D}} \\sum_{x' \\in \\underline{D}} w(x)w(x')k(x,x') \\\\\n& ~~ +\\sum_{y \\in \\underline{E}} \\sum_{y' \\in \\underline{E}} w(y)w(y')k(y,y') \\\\\n& ~~ - 2 \\sum_{x \\in \\underline{D}} \\sum_{y \\in \\underline{E}} w(x)w(y)k(x,y) .\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex6.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle d^{w}_{k}(D,E)^{2}\" display=\"inline\"><mrow><msubsup><mi>d</mi><mi>k</mi><mi>w</mi></msubsup><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>D</mi><mo>,</mo><mi>E</mi><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex6.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\sum_{x\\in\\underline{D}}\\sum_{x^{\\prime}\\in\\underline{D}}w(x)w(x%&#10;^{\\prime})k(x,x^{\\prime})\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>x</mi><mo>\u2208</mo><munder accentunder=\"true\"><mi>D</mi><mo>\u00af</mo></munder></mrow></munder></mstyle><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><msup><mi>x</mi><mo>\u2032</mo></msup><mo>\u2208</mo><munder accentunder=\"true\"><mi>D</mi><mo>\u00af</mo></munder></mrow></munder></mstyle><mrow><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>x</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>k</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><msup><mi>x</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex7.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle~{}~{}+\\sum_{y\\in\\underline{E}}\\sum_{y^{\\prime}\\in\\underline{E}}w%&#10;(y)w(y^{\\prime})k(y,y^{\\prime})\" display=\"inline\"><mrow><mpadded width=\"+3.3pt\"><mi mathvariant=\"normal\">\u00a0</mi></mpadded><mo>+</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>y</mi><mo>\u2208</mo><munder accentunder=\"true\"><mi>E</mi><mo>\u00af</mo></munder></mrow></munder></mstyle><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><msup><mi>y</mi><mo>\u2032</mo></msup><mo>\u2208</mo><munder accentunder=\"true\"><mi>E</mi><mo>\u00af</mo></munder></mrow></munder></mstyle><mrow><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>y</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>k</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><msup><mi>y</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex8.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle~{}~{}-2\\sum_{x\\in\\underline{D}}\\sum_{y\\in\\underline{E}}w(x)w(y)k%&#10;(x,y).\" display=\"inline\"><mrow><mrow><mpadded width=\"+3.3pt\"><mi mathvariant=\"normal\">\u00a0</mi></mpadded><mo>-</mo><mrow><mn>2</mn><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>x</mi><mo>\u2208</mo><munder accentunder=\"true\"><mi>D</mi><mo>\u00af</mo></munder></mrow></munder></mstyle><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>y</mi><mo>\u2208</mo><munder accentunder=\"true\"><mi>E</mi><mo>\u00af</mo></munder></mrow></munder></mstyle><mrow><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>k</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\nwhere $\\tau$ is a positive parameter.\nWe call $K_{PWG}$ a {\\em persistence weighted Gaussian kernel} (PWGK for short).\nAlthough we can also consider a linear kernel \n\n", "itemtype": "equation", "pos": 21542, "prevtext": "\n\nIn this paper, we choose the Gaussian kernel $k_{G}(x,y)=e^{-\\frac{\\norm{x-y}^{2}}{2 \\sigma^{2}}} \\ (\\sigma>0)$ as a $C_{0}$-universal kernel and $w(x)=\\arctan(C {\\rm pers}(x)^{p}) \\ (C,p >0)$ as an weight function.\nThe reasons of these choices are followings:\n(i) $w:\\lR^{2} {\\rightarrow} \\lR$ satisfies $\\mu^{w}_{D} \\in M_{b}(\\lR^{2})$,\n(ii) $w$ is an increasing function with respect to persistence so that a noisy (resp. characteristic) generator $x$ corresponds to small (resp. large) value $w(x)$,\n(iii) parameters $C$ and $p$ can control the weight of generators,\n(iv) stability properties with respect to $d^{w}_{k_{G}}$ hold (Section \\ref{subsec:stability}).\n\nFollowing \\cite{MFDS}, we make a nonlinear kernel on persistence diagrams such as \n\n", "index": 15, "text": "\\begin{align}\nK_{PWG}(D, E) = \\exp \\pare{- \\frac{d^{w}_{k_{G}}(D,E)^{2} }{ 2 \\tau^{2} } },  \\label{eq:kernel}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle K_{PWG}(D,E)=\\exp\\pare{-\\frac{d^{w}_{k_{G}}(D,E)^{2}}{2\\tau^{2}}},\" display=\"inline\"><mrow><mrow><mrow><msub><mi>K</mi><mrow><mi>P</mi><mo>\u2062</mo><mi>W</mi><mo>\u2062</mo><mi>G</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>D</mi><mo>,</mo><mi>E</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>exp</mi><mo>\u2061</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\pare</mtext></merror></mrow><mo>-</mo><mstyle displaystyle=\"true\"><mfrac><mrow><msubsup><mi>d</mi><msub><mi>k</mi><mi>G</mi></msub><mi>w</mi></msubsup><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>D</mi><mo>,</mo><mi>E</mi><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></mrow><mrow><mn>2</mn><mo>\u2062</mo><msup><mi>\u03c4</mi><mn>2</mn></msup></mrow></mfrac></mstyle></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\nwe choose the PWGK as a kernel on persistence diagrams, in this paper, because advantages of using nonlinear kernels are demonstrated in \\cite{MFDS}, where nonlinear kernels show better performance for classification tasks. \n\n\\subsection{Stability with respect to {\\boldmath $d^{w}_{k_{G}}$}}\n\\label{subsec:stability}\n\nGiven an input data, we have vectorized its persistence diagram $D$ as an element of RKHS $E_{k_{G}}(\\mu^{w}_{D})$.\nBy the norm $\\norm{\\cdot}_{\\cH_{k_{G}}}$, we can measure the distance between two persistence diagrams $D,E$ such as $d^{w}_{k_{G}}(D,E)=\\norm{E_{k_{G}}(\\mu^{w}_{D})-E_{k}(\\mu^{w}_{E})}_{\\cH_{k_{G}}}$.\nIf two input data are similar to each other under an appropriate setting, the following theorems guarantee that the distance $d^{w}_{k_{G}}$  between these persistence diagrams is small (see Appendix for proofs).\nThat is, a small change of input data has little effect on the expression of RKHS and the results of kernel methods.\n\\begin{thm}\n\\label{kfunc_stability}\nLet $M$ be a triangulable compact subspace in $\\lR^{d}$, $p>d+1$ and $f,g:M {\\rightarrow} \\lR$ be tame Lipschitz functions.\nThen \n\n", "itemtype": "equation", "pos": 21830, "prevtext": "\nwhere $\\tau$ is a positive parameter.\nWe call $K_{PWG}$ a {\\em persistence weighted Gaussian kernel} (PWGK for short).\nAlthough we can also consider a linear kernel \n\n", "index": 17, "text": "\\begin{align*}\nK_{L}(D,E)=\\inn{E_{k_{G}}(\\mu^{w}_{D})}{E_{k_{G}}(\\mu^{w}_{E})}_{\\cH_{k_{G}}}=\\sum_{x \\in \\underline{D}} \\sum_{y \\in \\underline{E}} w(x)w(y)k_{G}(x,y),\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex9.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle K_{L}(D,E)=\\inn{E_{k_{G}}(\\mu^{w}_{D})}{E_{k_{G}}(\\mu^{w}_{E})}_%&#10;{\\cH_{k_{G}}}=\\sum_{x\\in\\underline{D}}\\sum_{y\\in\\underline{E}}w(x)w(y)k_{G}(x,%&#10;y),\" display=\"inline\"><mrow><mrow><mrow><msub><mi>K</mi><mi>L</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>D</mi><mo>,</mo><mi>E</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\inn</mtext></merror><mo>\u2062</mo><msub><mi>E</mi><msub><mi>k</mi><mi>G</mi></msub></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msubsup><mi>\u03bc</mi><mi>D</mi><mi>w</mi></msubsup><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>E</mi><msub><mi>k</mi><mi>G</mi></msub></msub><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">(</mo><msubsup><mi>\u03bc</mi><mi>E</mi><mi>w</mi></msubsup><mo stretchy=\"false\">)</mo></mrow><msub><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\cH</mtext></merror><msub><mi>k</mi><mi>G</mi></msub></msub></msub></mrow><mo>=</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>x</mi><mo>\u2208</mo><munder accentunder=\"true\"><mi>D</mi><mo>\u00af</mo></munder></mrow></munder></mstyle><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>y</mi><mo>\u2208</mo><munder accentunder=\"true\"><mi>E</mi><mo>\u00af</mo></munder></mrow></munder></mstyle><mrow><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>k</mi><mi>G</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\nwhere $L(f,g;C,p,\\sigma)$ is a constant depending on $f,g,C,p,\\sigma$.\n\\end{thm}\n\nIn the case of finite sets $X,Y \\subset \\lR^{d}$, by setting $f=f_{X}$ and $g=f_{Y}$, we have the following:\n\\begin{thm}\n\\label{kpoint_stability}\nLet $M$ be a compact subset in $\\lR^{d}$, $X,Y \\subset M$ be finite subsets and $p>d+1$.\nThen\n", "itemtype": "equation", "pos": 23143, "prevtext": "\nwe choose the PWGK as a kernel on persistence diagrams, in this paper, because advantages of using nonlinear kernels are demonstrated in \\cite{MFDS}, where nonlinear kernels show better performance for classification tasks. \n\n\\subsection{Stability with respect to {\\boldmath $d^{w}_{k_{G}}$}}\n\\label{subsec:stability}\n\nGiven an input data, we have vectorized its persistence diagram $D$ as an element of RKHS $E_{k_{G}}(\\mu^{w}_{D})$.\nBy the norm $\\norm{\\cdot}_{\\cH_{k_{G}}}$, we can measure the distance between two persistence diagrams $D,E$ such as $d^{w}_{k_{G}}(D,E)=\\norm{E_{k_{G}}(\\mu^{w}_{D})-E_{k}(\\mu^{w}_{E})}_{\\cH_{k_{G}}}$.\nIf two input data are similar to each other under an appropriate setting, the following theorems guarantee that the distance $d^{w}_{k_{G}}$  between these persistence diagrams is small (see Appendix for proofs).\nThat is, a small change of input data has little effect on the expression of RKHS and the results of kernel methods.\n\\begin{thm}\n\\label{kfunc_stability}\nLet $M$ be a triangulable compact subspace in $\\lR^{d}$, $p>d+1$ and $f,g:M {\\rightarrow} \\lR$ be tame Lipschitz functions.\nThen \n\n", "index": 19, "text": "\\begin{align*}\nd^{w}_{k_{G}}(D_{q}(f),D_{q}(g)) < L(f,g;C,p,\\sigma) \\norm{f-g}_{\\infty},\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex10.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle d^{w}_{k_{G}}(D_{q}(f),D_{q}(g))&lt;L(f,g;C,p,\\sigma)\\norm{f-g}_{%&#10;\\infty},\" display=\"inline\"><mrow><mrow><mrow><msubsup><mi>d</mi><msub><mi>k</mi><mi>G</mi></msub><mi>w</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>D</mi><mi>q</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>,</mo><mrow><msub><mi>D</mi><mi>q</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>g</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>&lt;</mo><mrow><mrow><mi>L</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo>,</mo><mi>g</mi><mo>;</mo><mi>C</mi><mo>,</mo><mi>p</mi><mo>,</mo><mi>\u03c3</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><mi>f</mi></mrow><mo>-</mo><msub><mi>g</mi><mi mathvariant=\"normal\">\u221e</mi></msub></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\nwhere $L(M,d;C,p,\\sigma)$ is a constant depending on $M,d,C,p,\\sigma$.\n\\end{thm}\n\nLet $\\cP_{{\\rm finite}}(M)$ be the set of finite subsets in a compact subset $M \\subset \\lR^{d}$.\nSince the constant $L(M,d;C,p,\\sigma)$ is independent of $X$ and $Y$, we can conclude that the map \n", "itemtype": "equation", "pos": 23566, "prevtext": "\nwhere $L(f,g;C,p,\\sigma)$ is a constant depending on $f,g,C,p,\\sigma$.\n\\end{thm}\n\nIn the case of finite sets $X,Y \\subset \\lR^{d}$, by setting $f=f_{X}$ and $g=f_{Y}$, we have the following:\n\\begin{thm}\n\\label{kpoint_stability}\nLet $M$ be a compact subset in $\\lR^{d}$, $X,Y \\subset M$ be finite subsets and $p>d+1$.\nThen\n", "index": 21, "text": "\n\\[\nd^{w}_{k_{G}}(D_{q}(X),D_{q}(Y) ) < L(M,d;C,p,\\sigma) d_{H}(X,Y),\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex11.m1\" class=\"ltx_Math\" alttext=\"d^{w}_{k_{G}}(D_{q}(X),D_{q}(Y))&lt;L(M,d;C,p,\\sigma)d_{H}(X,Y),\" display=\"block\"><mrow><mrow><mrow><msubsup><mi>d</mi><msub><mi>k</mi><mi>G</mi></msub><mi>w</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>D</mi><mi>q</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>,</mo><mrow><msub><mi>D</mi><mi>q</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>&lt;</mo><mrow><mi>L</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>M</mi><mo>,</mo><mi>d</mi><mo>;</mo><mi>C</mi><mo>,</mo><mi>p</mi><mo>,</mo><mi>\u03c3</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>d</mi><mi>H</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>X</mi><mo>,</mo><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\nis Lipschitz continuous.\n\n\\subsection{Calculation of Gram matrix}\n\\label{calculation}\n\nFrom now on, we use the symbol $D,E$, etc. for persistence diagrams without specifying the dimension of homology, and subscripts express indices of diagrams.\nLet $\\cD=\\{D_{\\ell} \\mid \\ell=1,\\ldots,n\\}$ be a collection of persistence diagrams.\nIn many practical applications, the number of points in a persistence diagram can be large.\nIf the persistence diagrams contain at most $m$ elements, then each element of the Gram matrix $(K_{PWG}(D_{i},D_{j}))_{i,j=1,\\ldots,n}$ involves $O(m^2)$ evaluation of $e^{-\\frac{\\norm{x-y}^{2}}{2\\sigma^{2}}}$, resulting the complexity $O(m^{2}n^{2})$ for obtaining the Gram matrix.\nHence, reducing computational cost with respect to $m$ is an important issue.\n\nWe solve this computational issue by using the random kitchen sink method \\cite{RR}.  To be more precise, let $z_{1},\\ldots,z_{M}$ be random variables from the $2$-dimensional normal distribution $N( (0,0), \\sigma^{-2} I)$ where $I$ is the identity matrix.  This method approximates $e^{-\\frac{\\norm{x-y}^{2}}{2\\sigma^{2}}}$ by $\\frac{1}{M}\\sum_{a=1}^{M} e^{\\sqrt{-1}z_{a}x} (e^{\\sqrt{-1}z_{a}y})^{*}$, where $*$ denotes the complex conjugation.  \nThen,  $\\sum_{x \\in \\underline{D}_{i}} \\sum_{y \\in \\underline{D}_{j}} w(x)w(y)k_{G}(x,y)$ is approximated by $\\frac{1}{M}\\sum_{a=1}^{M}B^{a}_{i} (B^{a}_{j})^{*}$, where $B^{a}_{\\ell}=\\sum_{x \\in \\underline{D}_{\\ell}} w(x) e^{\\sqrt{-1}z_{a}x}$.\nAs a result, the computational complexity of the approximated Gram matrix is $O(mnM+n^2M)$. \nIn the computations of this paper, we set $M=1000$. \n\nWe note that the approximation by the random kitchen sink method can be sensitive to the choice of $\\sigma$.\nIf $\\sigma$ is much smaller than $\\norm{x-y}$, the relative error can be large.  For example, \nin the case of $x=(1,2),y=(1,2.1)$ and $\\sigma=0.01$, $e^{-\\frac{\\norm{x-y}^{2}}{2\\sigma^{2}}}$ is about $10^{-22}$ while the approximated value is about $10^{-3}$.\nAs a whole, these $m^{2}$ errors may cause a critical error to the approximation.\nMoreover, if $\\sigma$ is largely deviated from the ensemble $\\norm{x-y}$ for $x \\in \\underline{D}_{i},y \\in \\underline{D}_{j}$, then most values $e^{-\\frac{\\norm{x-y}^{2}}{2 \\sigma^{2}}}$ become close to $0$ or $1$.\n\nIn order to obtain a good approximation and extract meaningful values, we follow the heuristics proposed in \\cite{GFTSSS}.\nWe set $\\sigma$ to be close to many $\\norm{x-y}$ by $\\sigma ={\\rm median} \\{ \\sigma(D_{\\ell}) \\mid \\ell=1,\\ldots,n\\}$, where $\\sigma(D)={\\rm median} \\{ \\norm{x_{i}-x_{j}} \\mid x_{i},x_{j} \\in \\underline{D}, \\ i<j \\}$.\nFor the parameter $C$, we also set $C=( {\\rm median} \\{{\\rm pers}(D_{\\ell}) \\mid \\ell=1,\\ldots,n\\} )^{-p}$, where  ${\\rm pers}(D)={\\rm median} \\{ {\\rm pers}(x_{i}) \\mid x_{i} \\in \\underline{D} \\}$.\nSimilarly, $\\tau$ is defined by ${\\rm median} \\{ d^{w}_{k_{G}}(D_{i},D_{j}) \\mid 1 \\leq i < j \\leq n\\}$.\nIn this paper, since all points of data are in $\\lR^{3}$, we set $p=5$ by following the assumption $p>d+1$ in Theorem \\ref{kpoint_stability}.\n\n\\section{Experiments}\n\\label{experiment}\n\nWe demonstrate the effectiveness of the PWGK using synthesized and real data.  Among other kernel methods, we show change point detection with kernel Fisher discriminant ratio \\cite{HBM} (KFDR) and kernel principal component analysis \\cite{SSM} (KPCA).  \n\nFor a collection $\\cD=\\{D_{\\ell} \\mid \\ell=1,\\ldots,n\\}$ of persistence diagrams, we use the {\\em kernel Fisher discriminant ratio} ${\\rm KFDR}_{n,\\ell,\\gamma}(\\cD)$ (see \\cite{HBM} for the definition) as a statistical quantity for the kernel based change point detection. Here, we set $\\gamma=10^{-3}$ in this paper, and the index $\\ell$ achieving the maximum of ${\\rm KFDR}_{n,\\ell,\\gamma}(\\cD)$ corresponds to the estimated change point.\nThe ${\\rm KFDR}$ is calculated by the Gram matrix $(K(D_{i},D_{j}))_{i,j=1,\\ldots,n}$.\n\nIn this section, all persistence diagrams are computed by CGAL \\cite{CGAL} and PHAT \\cite{PHAT}.\n\n\\subsection{Comparison to the persistence scale space kernel}\n\\label{sec:pssk}\n\nThe most relevant to the PWGK is the {\\em persistence scale space kernel} \\cite{RHBK} (PSSK for short) $K_{PSS}$, which is defined by:\n\n", "itemtype": "equation", "pos": 23918, "prevtext": "\nwhere $L(M,d;C,p,\\sigma)$ is a constant depending on $M,d,C,p,\\sigma$.\n\\end{thm}\n\nLet $\\cP_{{\\rm finite}}(M)$ be the set of finite subsets in a compact subset $M \\subset \\lR^{d}$.\nSince the constant $L(M,d;C,p,\\sigma)$ is independent of $X$ and $Y$, we can conclude that the map \n", "index": 23, "text": "\n\\[\n\\cP_{{\\rm finite}}(M) {\\rightarrow} \\cH_{k_{G}} , ~~ X \\mapsto E_{k_{G}} \\pare{\\mu^{w}_{D_{q}(X)}}\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex12.m1\" class=\"ltx_Math\" alttext=\"\\cP_{{\\rm finite}}(M){\\rightarrow}\\cH_{k_{G}},~{}~{}X\\mapsto E_{k_{G}}\\pare{%&#10;\\mu^{w}_{D_{q}(X)}}\" display=\"block\"><mrow><mrow><mrow><msub><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\cP</mtext></merror><mi>finite</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>M</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2192</mo><msub><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\cH</mtext></merror><msub><mi>k</mi><mi>G</mi></msub></msub></mrow><mo rspace=\"9.1pt\">,</mo><mrow><mi>X</mi><mo>\u21a6</mo><mrow><msub><mi>E</mi><msub><mi>k</mi><mi>G</mi></msub></msub><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\pare</mtext></merror><mo>\u2062</mo><msubsup><mi>\u03bc</mi><mrow><msub><mi>D</mi><mi>q</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mi>w</mi></msubsup></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\nwhere $\\Phi_{t}(D)=\\frac{1}{4\\pi t} \\sum_{y \\in \\underline{D}} e^{-\\frac{\\norm{x-y}^{2}}{4 t}} - e^{-\\frac{\\norm{x-\\bar{y}}^{2}}{4 t}}$, $\\Omega=\\{(x^{1},x^{2}) \\in \\lR^{2} \\mid x^{1} \\leq x^{2} \\}$, and $\\bar{y}=(y^{2},y^{1})$ for $y=(y^{1},y^{2})$.\n\nNote that the PSSK also takes zero on the diagonal.  In spite of this similarity between the PWGK and the PSSK, the former has several advantages over the latter.  (i) The map $D \\mapsto E_{k_{G}}(\\mu^{w}_{D}) \\in \\cH_{k_{G}}$ used in the PWGK can control the effect of the persistence by changing parameters $C$ and $p$, while the map $D \\mapsto \\Phi_{t}(D) \\in L^{2}(\\Omega)$ cannot explicitly control the persistence.  Thus, the PWGK has more flexibility on the extent to disregard noisy generators.  (ii) The approximation by the random kitchen sink method is not possible for the PSSK.  It is not shift-invariant in total, and thus Bochner's theorem cannot be applied.  If we apply the approximation to the two terms $e^{-\\frac{ \\norm{x-y}^{2} }{8 t}}$ and $e^{-\\frac{ \\norm{x-\\bar{y}}^{2} }{8 t}}$ separately, the choice of the bandwidth parameter $t$ would be difficult for a good approximation of $K_{PSS}$.  For instance, given $x=(1,2)$ and $y=(1,2.1)$, we have $\\norm{x-y}=0.1$ and $\\norm{x-\\bar{y}} \\approx 1.48$, and hence $t$ cannot be chosen appropriately.\n  (iii) We also note that in \\cite{RHBK}, only the linear kernel is combined to the PSSK as a kernel on the RKHS, while our proposed method considers the Gaussian kernel on the RKHS.  \n\nIn light of (ii) discussed above, we calculate the Gram matrix of the PSSK without approximation in this paper. The computational time of the PSSK thus takes $O(m^{2}n^{2})$.\n\nWith respect to the parameter $t$, since $e^{-\\frac{ \\norm{x-\\bar{y}}^{2} }{8 t}}$ is only used to vanish the value of the feature map $\\Phi_{t}(D)$ on the diagonal, we set $t=\\sigma^{2}$ by using the same $\\sigma$ defined in Section \\ref{calculation}.\n\n\\subsection{Synthesized data}\n\nTo compare the performance between the PWGK and the PSSK, we calculate the change point determined by the ${\\rm KFDR}$ for both methods. An underlying space $T_{R,r}$ that we use here is given by\n\n", "itemtype": "equation", "pos": 28243, "prevtext": "\nis Lipschitz continuous.\n\n\\subsection{Calculation of Gram matrix}\n\\label{calculation}\n\nFrom now on, we use the symbol $D,E$, etc. for persistence diagrams without specifying the dimension of homology, and subscripts express indices of diagrams.\nLet $\\cD=\\{D_{\\ell} \\mid \\ell=1,\\ldots,n\\}$ be a collection of persistence diagrams.\nIn many practical applications, the number of points in a persistence diagram can be large.\nIf the persistence diagrams contain at most $m$ elements, then each element of the Gram matrix $(K_{PWG}(D_{i},D_{j}))_{i,j=1,\\ldots,n}$ involves $O(m^2)$ evaluation of $e^{-\\frac{\\norm{x-y}^{2}}{2\\sigma^{2}}}$, resulting the complexity $O(m^{2}n^{2})$ for obtaining the Gram matrix.\nHence, reducing computational cost with respect to $m$ is an important issue.\n\nWe solve this computational issue by using the random kitchen sink method \\cite{RR}.  To be more precise, let $z_{1},\\ldots,z_{M}$ be random variables from the $2$-dimensional normal distribution $N( (0,0), \\sigma^{-2} I)$ where $I$ is the identity matrix.  This method approximates $e^{-\\frac{\\norm{x-y}^{2}}{2\\sigma^{2}}}$ by $\\frac{1}{M}\\sum_{a=1}^{M} e^{\\sqrt{-1}z_{a}x} (e^{\\sqrt{-1}z_{a}y})^{*}$, where $*$ denotes the complex conjugation.  \nThen,  $\\sum_{x \\in \\underline{D}_{i}} \\sum_{y \\in \\underline{D}_{j}} w(x)w(y)k_{G}(x,y)$ is approximated by $\\frac{1}{M}\\sum_{a=1}^{M}B^{a}_{i} (B^{a}_{j})^{*}$, where $B^{a}_{\\ell}=\\sum_{x \\in \\underline{D}_{\\ell}} w(x) e^{\\sqrt{-1}z_{a}x}$.\nAs a result, the computational complexity of the approximated Gram matrix is $O(mnM+n^2M)$. \nIn the computations of this paper, we set $M=1000$. \n\nWe note that the approximation by the random kitchen sink method can be sensitive to the choice of $\\sigma$.\nIf $\\sigma$ is much smaller than $\\norm{x-y}$, the relative error can be large.  For example, \nin the case of $x=(1,2),y=(1,2.1)$ and $\\sigma=0.01$, $e^{-\\frac{\\norm{x-y}^{2}}{2\\sigma^{2}}}$ is about $10^{-22}$ while the approximated value is about $10^{-3}$.\nAs a whole, these $m^{2}$ errors may cause a critical error to the approximation.\nMoreover, if $\\sigma$ is largely deviated from the ensemble $\\norm{x-y}$ for $x \\in \\underline{D}_{i},y \\in \\underline{D}_{j}$, then most values $e^{-\\frac{\\norm{x-y}^{2}}{2 \\sigma^{2}}}$ become close to $0$ or $1$.\n\nIn order to obtain a good approximation and extract meaningful values, we follow the heuristics proposed in \\cite{GFTSSS}.\nWe set $\\sigma$ to be close to many $\\norm{x-y}$ by $\\sigma ={\\rm median} \\{ \\sigma(D_{\\ell}) \\mid \\ell=1,\\ldots,n\\}$, where $\\sigma(D)={\\rm median} \\{ \\norm{x_{i}-x_{j}} \\mid x_{i},x_{j} \\in \\underline{D}, \\ i<j \\}$.\nFor the parameter $C$, we also set $C=( {\\rm median} \\{{\\rm pers}(D_{\\ell}) \\mid \\ell=1,\\ldots,n\\} )^{-p}$, where  ${\\rm pers}(D)={\\rm median} \\{ {\\rm pers}(x_{i}) \\mid x_{i} \\in \\underline{D} \\}$.\nSimilarly, $\\tau$ is defined by ${\\rm median} \\{ d^{w}_{k_{G}}(D_{i},D_{j}) \\mid 1 \\leq i < j \\leq n\\}$.\nIn this paper, since all points of data are in $\\lR^{3}$, we set $p=5$ by following the assumption $p>d+1$ in Theorem \\ref{kpoint_stability}.\n\n\\section{Experiments}\n\\label{experiment}\n\nWe demonstrate the effectiveness of the PWGK using synthesized and real data.  Among other kernel methods, we show change point detection with kernel Fisher discriminant ratio \\cite{HBM} (KFDR) and kernel principal component analysis \\cite{SSM} (KPCA).  \n\nFor a collection $\\cD=\\{D_{\\ell} \\mid \\ell=1,\\ldots,n\\}$ of persistence diagrams, we use the {\\em kernel Fisher discriminant ratio} ${\\rm KFDR}_{n,\\ell,\\gamma}(\\cD)$ (see \\cite{HBM} for the definition) as a statistical quantity for the kernel based change point detection. Here, we set $\\gamma=10^{-3}$ in this paper, and the index $\\ell$ achieving the maximum of ${\\rm KFDR}_{n,\\ell,\\gamma}(\\cD)$ corresponds to the estimated change point.\nThe ${\\rm KFDR}$ is calculated by the Gram matrix $(K(D_{i},D_{j}))_{i,j=1,\\ldots,n}$.\n\nIn this section, all persistence diagrams are computed by CGAL \\cite{CGAL} and PHAT \\cite{PHAT}.\n\n\\subsection{Comparison to the persistence scale space kernel}\n\\label{sec:pssk}\n\nThe most relevant to the PWGK is the {\\em persistence scale space kernel} \\cite{RHBK} (PSSK for short) $K_{PSS}$, which is defined by:\n\n", "index": 25, "text": "\\begin{align*}\nK_{PSS}(D,E) \n&=\\inn{\\Phi_{t}(D)}{\\Phi_{t}(E)}_{L^{2}(\\Omega)} \\\\\n&=\\frac{1}{8 \\pi t} \\sum_{x \\in \\underline{D}} \\sum_{y \\in \\underline{E}}  e^{-\\frac{ \\norm{x-y}^{2} }{8 t}} - e^{-\\frac{ \\norm{x-\\bar{y}}^{2} }{8 t}} ,\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex13.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle K_{PSS}(D,E)\" display=\"inline\"><mrow><msub><mi>K</mi><mrow><mi>P</mi><mo>\u2062</mo><mi>S</mi><mo>\u2062</mo><mi>S</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>D</mi><mo>,</mo><mi>E</mi><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex13.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\inn{\\Phi_{t}(D)}{\\Phi_{t}(E)}_{L^{2}(\\Omega)}\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\inn</mtext></merror><mo>\u2062</mo><msub><mi mathvariant=\"normal\">\u03a6</mi><mi>t</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>D</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi mathvariant=\"normal\">\u03a6</mi><mi>t</mi></msub><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">(</mo><mi>E</mi><mo stretchy=\"false\">)</mo></mrow><mrow><msup><mi>L</mi><mn>2</mn></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">\u03a9</mi><mo stretchy=\"false\">)</mo></mrow></mrow></msub></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex14.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\frac{1}{8\\pi t}\\sum_{x\\in\\underline{D}}\\sum_{y\\in\\underline{E}}%&#10;e^{-\\frac{\\norm{x-y}^{2}}{8t}}-e^{-\\frac{\\norm{x-\\bar{y}}^{2}}{8t}},\" display=\"inline\"><mrow><mrow><mi/><mo>=</mo><mrow><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><mrow><mn>8</mn><mo>\u2062</mo><mi>\u03c0</mi><mo>\u2062</mo><mi>t</mi></mrow></mfrac></mstyle><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>x</mi><mo>\u2208</mo><munder accentunder=\"true\"><mi>D</mi><mo>\u00af</mo></munder></mrow></munder></mstyle><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>y</mi><mo>\u2208</mo><munder accentunder=\"true\"><mi>E</mi><mo>\u00af</mo></munder></mrow></munder></mstyle><msup><mi>e</mi><mrow><mo>-</mo><mfrac><mrow><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><mi>x</mi></mrow><mo>-</mo><msup><mi>y</mi><mn>2</mn></msup></mrow><mrow><mn>8</mn><mo>\u2062</mo><mi>t</mi></mrow></mfrac></mrow></msup></mrow></mrow></mrow><mo>-</mo><msup><mi>e</mi><mrow><mo>-</mo><mfrac><mrow><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><mi>x</mi></mrow><mo>-</mo><msup><mover accent=\"true\"><mi>y</mi><mo stretchy=\"false\">\u00af</mo></mover><mn>2</mn></msup></mrow><mrow><mn>8</mn><mo>\u2062</mo><mi>t</mi></mrow></mfrac></mrow></msup></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\nwhere $s \\in [-\\pi,\\pi)$, and $t \\in [-\\pi,\\pi)$ for $R \\geq r$ or $t \\in [-\\pi+\\arccos(\\frac{R}{r}),\\pi-\\arccos(\\frac{R}{r}))$ for $R<r$.\nThe space $T_{R,r}$ is a torus for $R > r$ and a sphere $S^{2}$ for $R<r$ (Figure \\ref{fig:tori}).\nWhen we fix $r>0$ and vary $R$, the point where $T_{R,r}$ changes from spheres to tori is $R=r$.\n\\begin{figure}[htbp]\n\\begin{center}\n\\includegraphics[width=70mm]{tori.pdf}\n\\end{center}\n\\caption{Sampling from $T_{R,r}$ for $R<r$ (left, sphere), $R=r$ (center), and $R>r$ (right, torus).}\n\\label{fig:tori}\n\\end{figure}\n\nIn this example, 1000 points are uniformly sampled from $T_{R,2}$ for each $R=R_{\\ell}$, where $R_{\\ell}=1.5+0.025 \\ell$, $\\ell=1,\\ldots,40$.\nThen we compute the $2$-dimensional persistence diagrams of them. \nWe estimate the change point by the ${\\rm KFDR}$ with respect to the PWGK and the PSSK, where the parameters are defined in Section \\ref{calculation} and Section \\ref{sec:pssk}.\nWe repeat this procedure 50 times.  \nThe means of the estimated change points for the PWGK and the PSSK are 20.14 and 20.46.\nIt shows that both methods capture the points close to the true change point $\\ell=20$.\nThe mean absolute errors for the PWGK and the PSSK are 1.58 (STD 1.55) and 2.02 (STD 2.53), respectively. It implies the advantage of the PWGK over the PSSK in the accuracy of detecting the change point.\n\n\n\n\\subsection{Analysis of granular system}\n\\label{subsec:granular} \n\nWe apply the PWGK to persistence diagrams made from experimental data in a granular packing system \\cite{FSCS}. In this example, a partially crystalized packing with $150,000$ monosized beads (diameter $=1$mm, polydispersity $=0.025$mm) is obtained by experiment. One of the fundamental interests in the study of granular packings is to understand the transition from random packings to crystalized packings. In particular, \nthe maximum packing density $\\phi_*$ that random packings can attain is still a controversial issue (e.g., see \\cite{torquato}). Here, we apply the change point analysis to statistically detect $\\phi_*$. Furthermore, we compare the PWGK and the PSSK in terms of computational cost.  \n\nWe divide the original full system into $35$ cubical subsets containing approximately $4000$ beads, which  are offered from the authors of the paper \\cite{FSCS}. The packing densities of the subsets range from $\\phi=0.590$ to $\\phi=0.730$. In the work \\cite{takeuchi}, the authors computed a persistence diagram for each subset by taking the beads configuration as a finite subset in $\\mathbb{R}^3$, and found that the persistence diagrams characterize different configurations  in random packings (small $\\phi$) and crystalized packings (large $\\phi$). Hence, it is expected that the change point analysis applied on these persistence diagrams can detect the maximum packing density $\\phi_*$ as a transition from the random to crystalized packings. \n\nLet $\\{D_\\ell\\mid \\ell=1,\\dots,35\\}$ be a collection of the persistence diagrams sorted by the increasing order of the packing density. In Figure \\ref{fig:packing_KFDR}, the both graphs detect $\\ell=12$ as the maximum of the KFDR. This result statistically indicates that the maximum packing density $\\phi_*$ exists in the interval $[0.604,0.653]$ and supports the traditional observation $\\phi_* \\approx 0.636$ \\cite{nature}. \n\\begin{figure}[htbp]\n \\begin{minipage}{0.48\\hsize}\n \\begin{center}\n  \\includegraphics[width=35mm]{packing_kfdr_pwgk.pdf}\n \\end{center}\n \\end{minipage}\n \\hspace{1mm}\n \\begin{minipage}{0.48\\hsize}\n \\begin{center}\n  \\includegraphics[width=35mm]{packing_kfdr_pssk.pdf}\n \\end{center}\n \\end{minipage}\n   \\caption{The ${\\rm KFDR}$ graphs of the PWGK (left) and the PSSK (right).}\n  \\label{fig:packing_KFDR}\n\\end{figure}\n\nWe emphasize that the computational time of the Gram matrix of the PWGK is much faster than that of the PSSK (Figure \\ref{fig:packing_kmat}). In the same setting of the computer\\footnote{MacBook Pro, 2.6 GHz Intel Core i5, 8 GB 1600 MHz DDR3}, the PWGK takes about 20 seconds, while the PSSK takes about 35 hours. \n\\begin{figure}[htbp]\n \\begin{minipage}{0.48\\hsize}\n \\begin{center}\n  \\includegraphics[width=33mm]{gauss_kmat.pdf}\n \\end{center}\n \\end{minipage}\n \\hspace{1mm}\n \\begin{minipage}{0.48\\hsize}\n \\begin{center}\n  \\includegraphics[width=33mm]{jan_kmat.pdf}\n \\end{center}\n \\end{minipage}\n   \\caption{The Gram matrix of the PWGK (left) and that of the PSSK (right). Each matrix is expressed as a heat map; that is, strong red point and light yellow point represent a high value and a low value, respectively.}\n  \\label{fig:packing_kmat}\n\\end{figure}\n\nWe also apply KPCA to the same collection of the 35 persistence diagrams. \nFigure \\ref{fig:packing_kpca} shows the $2$-dimensional KPCA plots in red for random packing and in blue for crystalized packing have clear two cluster structure corresponding to the two phases.\n\\begin{figure}[htbp]\n \\begin{minipage}{0.48\\hsize}\n \\begin{center}\n  \\includegraphics[width=30mm]{packing_kpca_pwgk.pdf}\n \\end{center}\n \\end{minipage}\n \\hspace{1mm}\n \\begin{minipage}{0.48\\hsize}\n \\begin{center}\n  \\includegraphics[width=30mm]{packing_kpca_pssk.pdf}\n \\end{center}\n \\end{minipage}\n   \\caption{The KPCA plots of the PWGK (left) and the PSSK (right).}\n  \\label{fig:packing_kpca}\n\\end{figure}\n\n\n\\subsection{Analysis of ${\\rm {\\bf SiO_2}}$}\n\\label{sec:glass}\n\nIn this example, we study the glass transition temperature of the material ${\\rm SiO}_2$. When we rapidly cool down the liquid state of ${\\rm SiO}_2$, it avoids the usual crystallization and changes into a glass state. \nUnderstanding the glass transition is an important issue in the current physics. For estimating the glass transition temperature by molecular dynamics simulations, we first prepare atomic configurations of ${\\rm SiO_{2}}$ for a certain range of temperatures, and then draw the temperature-enthalpy graph. The graph is convex sandwiched by two lines corresponding to the liquid and glass states. The glass transition temperature is usually estimated in an interval where the second derivative of the graph does not vanish (e.g., see \\cite{El}). However, since the slopes of the two lines are close to each other, determining the interval is a delicate problem and it is desired to make a mathematical framework to detect the glass transition temperature. \n\nLet $\\{D_\\ell\\mid \\ell=1,\\dots,80\\}$ be the persistence diagrams of the atomic configurations sorted by the increasing order of temperatures (see \\cite{HNHEMN,NHHEN} for details).\nFigure \\ref{fig:glass} shows the KFDR graph of the PWGK. It should be noted that the problem size of this example is too big for the PSSK to have reasonable computational time, and hence we cannot obtain the KFDR for the PSSK. \nThe maximum of the graph is given by $\\ell=39$, which corresponds to the temperature $3100$K. In this example, the interval constructed by the standard method mentioned above is roughly estimated by $[2000{\\rm K},3500{\\rm K}]$. Therefore, we can conclude that our method statistically determines the glass transition temperature consistent to the conventional method. \n\n\\begin{figure}[htbp]\n \\begin{minipage}{0.48\\hsize}\n  \\begin{center}\n  \\includegraphics[width=30mm]{glass_kfdr_pwgk.pdf}\n \\end{center}\n \\end{minipage}\n \\hspace{1mm}\n \\begin{minipage}{0.48\\hsize}\n \\begin{center}\n  \\includegraphics[width=33mm]{glass_kmat.pdf}\n \\end{center}\n \\end{minipage}\n   \\caption{The ${\\rm KFDR}$ graph (left) and the Gram matrix (right) of the PWGK.}\n  \\label{fig:glass}\n\\end{figure}\n\nFigure \\ref{fig:glass_kpca} shows the $2$-dimensional KPCA plot.  Similar to the granular packings, the clear difference can be seen between before (red) and after (blue) the change point. This implies that the glass transition occurs at the detected change point. \n\n\\begin{figure}\n \\begin{center}\n  \\includegraphics[width=30mm]{glass_kpca_pwgk.pdf}\n \\end{center}\n    \\caption{The KPCA plot of the PWGK.}\n  \\label{fig:glass_kpca}\n\\end{figure}\n\n\\section{Conclusion}\nIn this paper, we have proposed the persistence weighted Gaussian kernel on persistence diagrams.\nAs an significant advantage, our kernel enables one to control the effect of persistence in data analysis. \nWe have also proved the stability results with respect to the kernel distance. \nFurthermore, we have analyzed the synthesized and real data by statistical methods based on the proposed kernel.\nFor the granular packing and ${\\rm SiO}_2$, the change point detection and the principal component analysis using the PWGK derived meaningful results in physics. From the viewpoint of computations, our kernel provides an accurate and efficient approximation to compute the Gram matrix, suitable for practical applications of TDA. \n\nThe statistical methods used in this paper are all unsupervised learning and all the parameters of our kernel are determined by the heuristic approach. In the future work, it will be of great importance to introduce a framework for tuning those parameters by supervised learning.  \nSuch a framework will further emphasizes the advantage of our method including the flexibility and respecting the persistence. \n\n\\subsection*{Acknowledgement}\nWe thank Mohammad Saadatfar and Takenobu Nakamura for providing experimental and simulation data used in Section \\ref{subsec:granular} and \\ref{sec:glass}. This work is partially supported by JST Mathematics CREST (15656429) and JSPS KAKENHI Grant Number 26540016.\n\n\\begin{thebibliography}{9}\n\\bibitem{nature}\nAnonymous. What Is Random Packing?. Nature, 239, 488--489, 1972.\n\\bibitem{Bu}\nP. Bubenik. Statistical Topological Data Analysis using Persistence Landscapes. Journal of Machine Learning Research, 16,  77--102, 2015.\n\\bibitem{Ca}\nG. Carlsson. Topology and Data. Bull. AMS., 46(2), 255--308, 2009.\n\\bibitem{CIdSZ}\nG. Carlsson, T. Ishkhanov, V. de Silva and A. Zomorodian. On the local behavior of spaces of natural images. Internat. J. Comput., Vision, 76, 1--12, 2008.\n\\bibitem{CGAL}\nCGAL webpage: {\\tt http://www.cgal.org/}\n\\bibitem{CSO}\nF. Chazal, V. de Silva, and S. Oudot. Persistence stability for geometric complexes. Geometriae Dedicata, 173, 193--214, 2014.\n\\bibitem{CEHK}\nS. Chepushtanova, T. Emerson, E. Hanson, M, Kirby, F. Motta, R. Neville, C. Peterson, P. Shipman, and L. Ziegelmeier. Persistence Images: An Alternative Persistent Homology Representation. arXiv: 1507.06217.\n\\bibitem{CEH}\nD. Cohen-Steiner, H. Edelsbrunner, and J. Harer. Stability of Persistence Diagrams. Discrete. Comput. Geom., 37(1), 103--120, 2007.\n\\bibitem{CEHM}\nD. Cohen-Steiner, H. Edelsbrunner, J. Harer, and Y. Mileyko. Lipschitz Functions Have $L_{p}$-Stable Persistence. Found. Comput. Math., 10, 127--139, 2010.\n\\bibitem{dSG}\nV. de Silva and R. Ghrist. Coverage in sensor networks via persistent homology. Algebraic \\& Geometric Topology, 7, 339--358, 2007.\n\\bibitem{DU}\nJ. Diestel and J. J. Uhl. Vector Measures. AMS. 1977. \n\\bibitem{Ed}\nH. Edelsbrunner.  Persistent Homology in Image Processing.  In Graph-Based Representations in Pattern Recognition, Lecture Notes in Computer Science, 7877, 182--183, 2013.\n\\bibitem{ELZ}\nH. Edelsbrunner, D. Letscher, and A. Zomorodian. Topological persistence and simplification. Discrete. Comput. Geom., 28, 511--533, 2002.\n\\bibitem{El}\nS. R. Elliott. Physics of Amorphous Materials (2nd ed). Longman, 1990.\n\\bibitem{FLRWB}\nB. T. Fasy, F. Lecci, A. Rinaldo, L. Wasserman, S. Balakrishnan, and A. Singh. Confidence sets for persistence diagrams. Ann. Statist., 42(6), 2301--2339, 2014.\n\\bibitem{FSCS}\nN. Francois, M. Saadatfar, R. Cruikshank, and A. Sheppard. Geometrical Frustration in Amorphous and Partially Crystallized Packings of Spheres. Phys. Rev. Lett., 111, 148001, 2013. \n\\bibitem{GHIKMN}\nM. Gameiro, Y. Hiraoka, S. Izumi, M. Kramar, K. Mischaikow, and V. Nanda, Topological Measurement of Protein Compressibility via Persistent Diagrams.  J. Indust. Appl. Math., 32, 1--17, 2015.\n\\bibitem{GFTSSS}\nA. Gretton, K. Fukumizu, C. H. Teo, L. Song, B. Sch{\\\"o}lkopf, and A. Smola.  A kernel statistical test of independence. Advances in NIPS 20, 585--592,  MIT press, 2008.\n\\bibitem{HBM}\nZ. Harchaoui, F. Bach, and E. Moulines. Kernel change point analysis. In Neural Information Processing Systems, 21, 609--616, 2009.\n\\bibitem{HNHEMN}\nY. Hiraoka, T. Nakamura, A. Hirata, E. G. Escolar, K. Matsue, and Y. Nishiura. Hierarchical structures of amorphous solids characterized by persistent homology. arXiv: 1501.03611.\n\\bibitem{KZPSGP}\nP. M. Kasson, A. Zomorodian, S. Park, N. Singhal, L. J. Guibas, and V. S. Pande. Persistent voids: a new structural metric for membrane fusion. Bioinformatics, 23(14), 1753--1759, 2007.\n\\bibitem{LCKKL}\nH. Lee, M. K. Chung, H. Kang, B. N. Kim, and D. S. Lee. Discriminative persistent homology of brain networks. IEEE International Symposium on Biomedical Imaging, 841--844, 2011.\n\\bibitem{MFDS}\nK. Muandet, K. Fukumizu, F. Dinuzzo, and B. Sch\\\"olkopf. Learning from Distributions via Support Measure Machines. Advances in NIPS 26, 10--18, 2012.\n\\bibitem{Mu}\nJ. R. Munkres. Elements of Algebraic Topology. Westview Press, 1984.\n\\bibitem{NHHEN}\nT. Nakamura, Y. Hiraoka, A. Hirata, E. G. Escolar, and Y. Nishiura. Persistent Homology and Many-Body Atomic Structure for Medium-Range Order in the Glass. Nanotechnology, 26, 304001, 2015.\n\\bibitem{PHAT}\nPHAT webpage: {\\tt https://code.google.com/p/phat/}\n\\bibitem{PETCNHV}\nG. Petri, P. Expert, F. Turkheimer, R. Carhart-Harris, D. Nutt, P. J. Hellyer, and F. Vaccarino. Homological scaffolds of\nbrain functional networks. J. R. Soc. Interface, 11, 20140873, 2014.\n\\bibitem{RHBK}\nJ. Reininghaus, S. Huber, U. Bauer, and R. Kwitt. A Stable Multi-Scale Kernel for Topological Machine Learning.\nProc. 2015 IEEE Conf. Comp. Vision \\& Pat. Rec., 4741--4748, 2015.\n\\bibitem{RR}\nA. Rahimi and B. Recht. Random Features for Large-Scale Kernel Machines. Advances in NIPS 20, 1177--1184, 2008.\n\\bibitem{RT}\nV. Robins and K. Turner. Principal Component Analysis of Persistent Homology Rank Functions with case studies of Spatial Point Patterns, Sphere Packing and Colloids. arXiv: 1507.01454.\n\\bibitem{SS}\nB. Sch{\\\"o}lkopf and A. J. Smola.  Learning with Kernels. MIT Press, 2001.\n\\bibitem{SMISCR}\nG. Singh, F. Memoli, R. Ishkhanov, G. Sapiro, G. Carlsson, and D. L. Ringach. Topological analysis of population activity in visual cortex. Journal of vision, 8(8), 2008.\n\\bibitem{SGSS}\nA. Smola, A. Gretton, L. Song, and B. Sch\\\"olkopf.  A Hilbert Space Embedding for Distributions.  Algorithmic Learning Theory. Lecture Notes in Computer Sciences 4754, 13--31, Springer, 2007.\n\\bibitem{SFL}\nB. K. Sriperumbudur, K. Fukumizu, and G. R. G. Lanckriet. Universality, characteristic kernels and RKHS embedding of measures. Journal of Machine Learning Research, 12, 2389--2410, 2011.\n\\bibitem{SSM}\nB. Sch{\\\"o}lkopf, A. Smola, and K. M{\\\"u}ller. Nonlinear Component Analysis as a Kernel Eigenvalue Problem. Neural Computation 10, 1299--1319, 1998.\n\\bibitem{takeuchi}\nH. Takeuchi, V. Robins, N. Francois, Y. Hiraoka, and M. Saadatfar. Topological description of granular crystallization. In preparation. \n\\bibitem{torquato}\nS. Torquato, T. M. Truskett, and P. G. Debenedetti. Is Random Close Packing of Spheres Well Defined?. Phys. Rev. Lett., 84, 2064--2067, 2000.\n\\bibitem{XW}\nK. Xia, and G. W. Wei.  Persistent homology analysis of protein structure, flexibility, and folding. Int. J. Numer. Meth. Biomed. Engng., 30, 814--844. 2014.\n\n\\end{thebibliography}\n\n\\appendix\n\n\\section{Total persistence}\n\nIn order to estimate constants $L$ appearing in Section \\ref{subsec:stability}, especially show that the constant in Theorem \\ref{kpoint_stability} is independent of $X$ and $Y$, we will review several properties of persistence.\n\nLet $(M,d_{M})$ be a triangulable compact metric space.\nFor a Lipschitz function $f:M {\\rightarrow} \\lR$, the {\\em degree-$p$ total persistence} is defined by \n\n", "itemtype": "equation", "pos": 30657, "prevtext": "\nwhere $\\Phi_{t}(D)=\\frac{1}{4\\pi t} \\sum_{y \\in \\underline{D}} e^{-\\frac{\\norm{x-y}^{2}}{4 t}} - e^{-\\frac{\\norm{x-\\bar{y}}^{2}}{4 t}}$, $\\Omega=\\{(x^{1},x^{2}) \\in \\lR^{2} \\mid x^{1} \\leq x^{2} \\}$, and $\\bar{y}=(y^{2},y^{1})$ for $y=(y^{1},y^{2})$.\n\nNote that the PSSK also takes zero on the diagonal.  In spite of this similarity between the PWGK and the PSSK, the former has several advantages over the latter.  (i) The map $D \\mapsto E_{k_{G}}(\\mu^{w}_{D}) \\in \\cH_{k_{G}}$ used in the PWGK can control the effect of the persistence by changing parameters $C$ and $p$, while the map $D \\mapsto \\Phi_{t}(D) \\in L^{2}(\\Omega)$ cannot explicitly control the persistence.  Thus, the PWGK has more flexibility on the extent to disregard noisy generators.  (ii) The approximation by the random kitchen sink method is not possible for the PSSK.  It is not shift-invariant in total, and thus Bochner's theorem cannot be applied.  If we apply the approximation to the two terms $e^{-\\frac{ \\norm{x-y}^{2} }{8 t}}$ and $e^{-\\frac{ \\norm{x-\\bar{y}}^{2} }{8 t}}$ separately, the choice of the bandwidth parameter $t$ would be difficult for a good approximation of $K_{PSS}$.  For instance, given $x=(1,2)$ and $y=(1,2.1)$, we have $\\norm{x-y}=0.1$ and $\\norm{x-\\bar{y}} \\approx 1.48$, and hence $t$ cannot be chosen appropriately.\n  (iii) We also note that in \\cite{RHBK}, only the linear kernel is combined to the PSSK as a kernel on the RKHS, while our proposed method considers the Gaussian kernel on the RKHS.  \n\nIn light of (ii) discussed above, we calculate the Gram matrix of the PSSK without approximation in this paper. The computational time of the PSSK thus takes $O(m^{2}n^{2})$.\n\nWith respect to the parameter $t$, since $e^{-\\frac{ \\norm{x-\\bar{y}}^{2} }{8 t}}$ is only used to vanish the value of the feature map $\\Phi_{t}(D)$ on the diagonal, we set $t=\\sigma^{2}$ by using the same $\\sigma$ defined in Section \\ref{calculation}.\n\n\\subsection{Synthesized data}\n\nTo compare the performance between the PWGK and the PSSK, we calculate the change point determined by the ${\\rm KFDR}$ for both methods. An underlying space $T_{R,r}$ that we use here is given by\n\n", "index": 27, "text": "\\begin{align*}\nx&=R \\cos(s)+r \\cos(t)\\cos(s), \\\\\ny&=R \\sin(s)+r \\cos(t)\\sin(s), \\\\\nz&=r\\sin(t), \n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex15.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle x\" display=\"inline\"><mi>x</mi></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex15.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=R\\cos(s)+r\\cos(t)\\cos(s),\" display=\"inline\"><mrow><mrow><mi/><mo>=</mo><mrow><mrow><mi>R</mi><mo>\u2062</mo><mrow><mi>cos</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><mrow><mi>r</mi><mo>\u2062</mo><mrow><mi>cos</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2062</mo><mrow><mi>cos</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex16.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle y\" display=\"inline\"><mi>y</mi></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex16.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=R\\sin(s)+r\\cos(t)\\sin(s),\" display=\"inline\"><mrow><mrow><mi/><mo>=</mo><mrow><mrow><mi>R</mi><mo>\u2062</mo><mrow><mi>sin</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><mrow><mi>r</mi><mo>\u2062</mo><mrow><mi>cos</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2062</mo><mrow><mi>sin</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex17.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle z\" display=\"inline\"><mi>z</mi></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex17.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=r\\sin(t),\" display=\"inline\"><mrow><mrow><mi/><mo>=</mo><mrow><mi>r</mi><mo>\u2062</mo><mrow><mi>sin</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\nfor $0 \\leq t \\leq {\\rm Amp}(f)$.\nHere, ${\\rm Amp}(f) := \\max_{\\bm{x} \\in M}f(\\bm{x})-\\min_{\\bm{x} \\in M} f(\\bm{x})$ is the amplitude of $f$.\nLet $K$ be a triangulated simplicial complex of $M$ by a homeomorphism $\\theta: |K| {\\rightarrow} M$.\nThe diameter of a simplex $\\sigma \\in K$ and the mesh of the triangulation $K$ are defined by ${\\rm diam}(\\sigma) = \\max_{\\bm{x},\\bm{y} \\in \\sigma} d_{M}(\\theta(\\bm{x}),\\theta(\\bm{y}))$ and ${\\rm mesh}(K) = \\max_{\\sigma \\in K} {\\rm diam}(\\sigma )$, respectively.\nFurthermore, let us set $N(r)= \\min_{{\\rm mesh}(K ) \\leq r} \\card{K}$.\nThe degree-$p$ total persistence is bounded as follows:\n\\begin{lem}[Cohen-Steiner et al. \\cite{CEHM}]\nLet $M$ be a triangulable compact metric space and $f:M {\\rightarrow} \\lR$ be a tame Lipschitz function.\nThen ${\\rm Pers}_{p}(f,t)$ is bounded from above by\n", "itemtype": "equation", "pos": 46588, "prevtext": "\nwhere $s \\in [-\\pi,\\pi)$, and $t \\in [-\\pi,\\pi)$ for $R \\geq r$ or $t \\in [-\\pi+\\arccos(\\frac{R}{r}),\\pi-\\arccos(\\frac{R}{r}))$ for $R<r$.\nThe space $T_{R,r}$ is a torus for $R > r$ and a sphere $S^{2}$ for $R<r$ (Figure \\ref{fig:tori}).\nWhen we fix $r>0$ and vary $R$, the point where $T_{R,r}$ changes from spheres to tori is $R=r$.\n\\begin{figure}[htbp]\n\\begin{center}\n\\includegraphics[width=70mm]{tori.pdf}\n\\end{center}\n\\caption{Sampling from $T_{R,r}$ for $R<r$ (left, sphere), $R=r$ (center), and $R>r$ (right, torus).}\n\\label{fig:tori}\n\\end{figure}\n\nIn this example, 1000 points are uniformly sampled from $T_{R,2}$ for each $R=R_{\\ell}$, where $R_{\\ell}=1.5+0.025 \\ell$, $\\ell=1,\\ldots,40$.\nThen we compute the $2$-dimensional persistence diagrams of them. \nWe estimate the change point by the ${\\rm KFDR}$ with respect to the PWGK and the PSSK, where the parameters are defined in Section \\ref{calculation} and Section \\ref{sec:pssk}.\nWe repeat this procedure 50 times.  \nThe means of the estimated change points for the PWGK and the PSSK are 20.14 and 20.46.\nIt shows that both methods capture the points close to the true change point $\\ell=20$.\nThe mean absolute errors for the PWGK and the PSSK are 1.58 (STD 1.55) and 2.02 (STD 2.53), respectively. It implies the advantage of the PWGK over the PSSK in the accuracy of detecting the change point.\n\n\n\n\\subsection{Analysis of granular system}\n\\label{subsec:granular} \n\nWe apply the PWGK to persistence diagrams made from experimental data in a granular packing system \\cite{FSCS}. In this example, a partially crystalized packing with $150,000$ monosized beads (diameter $=1$mm, polydispersity $=0.025$mm) is obtained by experiment. One of the fundamental interests in the study of granular packings is to understand the transition from random packings to crystalized packings. In particular, \nthe maximum packing density $\\phi_*$ that random packings can attain is still a controversial issue (e.g., see \\cite{torquato}). Here, we apply the change point analysis to statistically detect $\\phi_*$. Furthermore, we compare the PWGK and the PSSK in terms of computational cost.  \n\nWe divide the original full system into $35$ cubical subsets containing approximately $4000$ beads, which  are offered from the authors of the paper \\cite{FSCS}. The packing densities of the subsets range from $\\phi=0.590$ to $\\phi=0.730$. In the work \\cite{takeuchi}, the authors computed a persistence diagram for each subset by taking the beads configuration as a finite subset in $\\mathbb{R}^3$, and found that the persistence diagrams characterize different configurations  in random packings (small $\\phi$) and crystalized packings (large $\\phi$). Hence, it is expected that the change point analysis applied on these persistence diagrams can detect the maximum packing density $\\phi_*$ as a transition from the random to crystalized packings. \n\nLet $\\{D_\\ell\\mid \\ell=1,\\dots,35\\}$ be a collection of the persistence diagrams sorted by the increasing order of the packing density. In Figure \\ref{fig:packing_KFDR}, the both graphs detect $\\ell=12$ as the maximum of the KFDR. This result statistically indicates that the maximum packing density $\\phi_*$ exists in the interval $[0.604,0.653]$ and supports the traditional observation $\\phi_* \\approx 0.636$ \\cite{nature}. \n\\begin{figure}[htbp]\n \\begin{minipage}{0.48\\hsize}\n \\begin{center}\n  \\includegraphics[width=35mm]{packing_kfdr_pwgk.pdf}\n \\end{center}\n \\end{minipage}\n \\hspace{1mm}\n \\begin{minipage}{0.48\\hsize}\n \\begin{center}\n  \\includegraphics[width=35mm]{packing_kfdr_pssk.pdf}\n \\end{center}\n \\end{minipage}\n   \\caption{The ${\\rm KFDR}$ graphs of the PWGK (left) and the PSSK (right).}\n  \\label{fig:packing_KFDR}\n\\end{figure}\n\nWe emphasize that the computational time of the Gram matrix of the PWGK is much faster than that of the PSSK (Figure \\ref{fig:packing_kmat}). In the same setting of the computer\\footnote{MacBook Pro, 2.6 GHz Intel Core i5, 8 GB 1600 MHz DDR3}, the PWGK takes about 20 seconds, while the PSSK takes about 35 hours. \n\\begin{figure}[htbp]\n \\begin{minipage}{0.48\\hsize}\n \\begin{center}\n  \\includegraphics[width=33mm]{gauss_kmat.pdf}\n \\end{center}\n \\end{minipage}\n \\hspace{1mm}\n \\begin{minipage}{0.48\\hsize}\n \\begin{center}\n  \\includegraphics[width=33mm]{jan_kmat.pdf}\n \\end{center}\n \\end{minipage}\n   \\caption{The Gram matrix of the PWGK (left) and that of the PSSK (right). Each matrix is expressed as a heat map; that is, strong red point and light yellow point represent a high value and a low value, respectively.}\n  \\label{fig:packing_kmat}\n\\end{figure}\n\nWe also apply KPCA to the same collection of the 35 persistence diagrams. \nFigure \\ref{fig:packing_kpca} shows the $2$-dimensional KPCA plots in red for random packing and in blue for crystalized packing have clear two cluster structure corresponding to the two phases.\n\\begin{figure}[htbp]\n \\begin{minipage}{0.48\\hsize}\n \\begin{center}\n  \\includegraphics[width=30mm]{packing_kpca_pwgk.pdf}\n \\end{center}\n \\end{minipage}\n \\hspace{1mm}\n \\begin{minipage}{0.48\\hsize}\n \\begin{center}\n  \\includegraphics[width=30mm]{packing_kpca_pssk.pdf}\n \\end{center}\n \\end{minipage}\n   \\caption{The KPCA plots of the PWGK (left) and the PSSK (right).}\n  \\label{fig:packing_kpca}\n\\end{figure}\n\n\n\\subsection{Analysis of ${\\rm {\\bf SiO_2}}$}\n\\label{sec:glass}\n\nIn this example, we study the glass transition temperature of the material ${\\rm SiO}_2$. When we rapidly cool down the liquid state of ${\\rm SiO}_2$, it avoids the usual crystallization and changes into a glass state. \nUnderstanding the glass transition is an important issue in the current physics. For estimating the glass transition temperature by molecular dynamics simulations, we first prepare atomic configurations of ${\\rm SiO_{2}}$ for a certain range of temperatures, and then draw the temperature-enthalpy graph. The graph is convex sandwiched by two lines corresponding to the liquid and glass states. The glass transition temperature is usually estimated in an interval where the second derivative of the graph does not vanish (e.g., see \\cite{El}). However, since the slopes of the two lines are close to each other, determining the interval is a delicate problem and it is desired to make a mathematical framework to detect the glass transition temperature. \n\nLet $\\{D_\\ell\\mid \\ell=1,\\dots,80\\}$ be the persistence diagrams of the atomic configurations sorted by the increasing order of temperatures (see \\cite{HNHEMN,NHHEN} for details).\nFigure \\ref{fig:glass} shows the KFDR graph of the PWGK. It should be noted that the problem size of this example is too big for the PSSK to have reasonable computational time, and hence we cannot obtain the KFDR for the PSSK. \nThe maximum of the graph is given by $\\ell=39$, which corresponds to the temperature $3100$K. In this example, the interval constructed by the standard method mentioned above is roughly estimated by $[2000{\\rm K},3500{\\rm K}]$. Therefore, we can conclude that our method statistically determines the glass transition temperature consistent to the conventional method. \n\n\\begin{figure}[htbp]\n \\begin{minipage}{0.48\\hsize}\n  \\begin{center}\n  \\includegraphics[width=30mm]{glass_kfdr_pwgk.pdf}\n \\end{center}\n \\end{minipage}\n \\hspace{1mm}\n \\begin{minipage}{0.48\\hsize}\n \\begin{center}\n  \\includegraphics[width=33mm]{glass_kmat.pdf}\n \\end{center}\n \\end{minipage}\n   \\caption{The ${\\rm KFDR}$ graph (left) and the Gram matrix (right) of the PWGK.}\n  \\label{fig:glass}\n\\end{figure}\n\nFigure \\ref{fig:glass_kpca} shows the $2$-dimensional KPCA plot.  Similar to the granular packings, the clear difference can be seen between before (red) and after (blue) the change point. This implies that the glass transition occurs at the detected change point. \n\n\\begin{figure}\n \\begin{center}\n  \\includegraphics[width=30mm]{glass_kpca_pwgk.pdf}\n \\end{center}\n    \\caption{The KPCA plot of the PWGK.}\n  \\label{fig:glass_kpca}\n\\end{figure}\n\n\\section{Conclusion}\nIn this paper, we have proposed the persistence weighted Gaussian kernel on persistence diagrams.\nAs an significant advantage, our kernel enables one to control the effect of persistence in data analysis. \nWe have also proved the stability results with respect to the kernel distance. \nFurthermore, we have analyzed the synthesized and real data by statistical methods based on the proposed kernel.\nFor the granular packing and ${\\rm SiO}_2$, the change point detection and the principal component analysis using the PWGK derived meaningful results in physics. From the viewpoint of computations, our kernel provides an accurate and efficient approximation to compute the Gram matrix, suitable for practical applications of TDA. \n\nThe statistical methods used in this paper are all unsupervised learning and all the parameters of our kernel are determined by the heuristic approach. In the future work, it will be of great importance to introduce a framework for tuning those parameters by supervised learning.  \nSuch a framework will further emphasizes the advantage of our method including the flexibility and respecting the persistence. \n\n\\subsection*{Acknowledgement}\nWe thank Mohammad Saadatfar and Takenobu Nakamura for providing experimental and simulation data used in Section \\ref{subsec:granular} and \\ref{sec:glass}. This work is partially supported by JST Mathematics CREST (15656429) and JSPS KAKENHI Grant Number 26540016.\n\n\\begin{thebibliography}{9}\n\\bibitem{nature}\nAnonymous. What Is Random Packing?. Nature, 239, 488--489, 1972.\n\\bibitem{Bu}\nP. Bubenik. Statistical Topological Data Analysis using Persistence Landscapes. Journal of Machine Learning Research, 16,  77--102, 2015.\n\\bibitem{Ca}\nG. Carlsson. Topology and Data. Bull. AMS., 46(2), 255--308, 2009.\n\\bibitem{CIdSZ}\nG. Carlsson, T. Ishkhanov, V. de Silva and A. Zomorodian. On the local behavior of spaces of natural images. Internat. J. Comput., Vision, 76, 1--12, 2008.\n\\bibitem{CGAL}\nCGAL webpage: {\\tt http://www.cgal.org/}\n\\bibitem{CSO}\nF. Chazal, V. de Silva, and S. Oudot. Persistence stability for geometric complexes. Geometriae Dedicata, 173, 193--214, 2014.\n\\bibitem{CEHK}\nS. Chepushtanova, T. Emerson, E. Hanson, M, Kirby, F. Motta, R. Neville, C. Peterson, P. Shipman, and L. Ziegelmeier. Persistence Images: An Alternative Persistent Homology Representation. arXiv: 1507.06217.\n\\bibitem{CEH}\nD. Cohen-Steiner, H. Edelsbrunner, and J. Harer. Stability of Persistence Diagrams. Discrete. Comput. Geom., 37(1), 103--120, 2007.\n\\bibitem{CEHM}\nD. Cohen-Steiner, H. Edelsbrunner, J. Harer, and Y. Mileyko. Lipschitz Functions Have $L_{p}$-Stable Persistence. Found. Comput. Math., 10, 127--139, 2010.\n\\bibitem{dSG}\nV. de Silva and R. Ghrist. Coverage in sensor networks via persistent homology. Algebraic \\& Geometric Topology, 7, 339--358, 2007.\n\\bibitem{DU}\nJ. Diestel and J. J. Uhl. Vector Measures. AMS. 1977. \n\\bibitem{Ed}\nH. Edelsbrunner.  Persistent Homology in Image Processing.  In Graph-Based Representations in Pattern Recognition, Lecture Notes in Computer Science, 7877, 182--183, 2013.\n\\bibitem{ELZ}\nH. Edelsbrunner, D. Letscher, and A. Zomorodian. Topological persistence and simplification. Discrete. Comput. Geom., 28, 511--533, 2002.\n\\bibitem{El}\nS. R. Elliott. Physics of Amorphous Materials (2nd ed). Longman, 1990.\n\\bibitem{FLRWB}\nB. T. Fasy, F. Lecci, A. Rinaldo, L. Wasserman, S. Balakrishnan, and A. Singh. Confidence sets for persistence diagrams. Ann. Statist., 42(6), 2301--2339, 2014.\n\\bibitem{FSCS}\nN. Francois, M. Saadatfar, R. Cruikshank, and A. Sheppard. Geometrical Frustration in Amorphous and Partially Crystallized Packings of Spheres. Phys. Rev. Lett., 111, 148001, 2013. \n\\bibitem{GHIKMN}\nM. Gameiro, Y. Hiraoka, S. Izumi, M. Kramar, K. Mischaikow, and V. Nanda, Topological Measurement of Protein Compressibility via Persistent Diagrams.  J. Indust. Appl. Math., 32, 1--17, 2015.\n\\bibitem{GFTSSS}\nA. Gretton, K. Fukumizu, C. H. Teo, L. Song, B. Sch{\\\"o}lkopf, and A. Smola.  A kernel statistical test of independence. Advances in NIPS 20, 585--592,  MIT press, 2008.\n\\bibitem{HBM}\nZ. Harchaoui, F. Bach, and E. Moulines. Kernel change point analysis. In Neural Information Processing Systems, 21, 609--616, 2009.\n\\bibitem{HNHEMN}\nY. Hiraoka, T. Nakamura, A. Hirata, E. G. Escolar, K. Matsue, and Y. Nishiura. Hierarchical structures of amorphous solids characterized by persistent homology. arXiv: 1501.03611.\n\\bibitem{KZPSGP}\nP. M. Kasson, A. Zomorodian, S. Park, N. Singhal, L. J. Guibas, and V. S. Pande. Persistent voids: a new structural metric for membrane fusion. Bioinformatics, 23(14), 1753--1759, 2007.\n\\bibitem{LCKKL}\nH. Lee, M. K. Chung, H. Kang, B. N. Kim, and D. S. Lee. Discriminative persistent homology of brain networks. IEEE International Symposium on Biomedical Imaging, 841--844, 2011.\n\\bibitem{MFDS}\nK. Muandet, K. Fukumizu, F. Dinuzzo, and B. Sch\\\"olkopf. Learning from Distributions via Support Measure Machines. Advances in NIPS 26, 10--18, 2012.\n\\bibitem{Mu}\nJ. R. Munkres. Elements of Algebraic Topology. Westview Press, 1984.\n\\bibitem{NHHEN}\nT. Nakamura, Y. Hiraoka, A. Hirata, E. G. Escolar, and Y. Nishiura. Persistent Homology and Many-Body Atomic Structure for Medium-Range Order in the Glass. Nanotechnology, 26, 304001, 2015.\n\\bibitem{PHAT}\nPHAT webpage: {\\tt https://code.google.com/p/phat/}\n\\bibitem{PETCNHV}\nG. Petri, P. Expert, F. Turkheimer, R. Carhart-Harris, D. Nutt, P. J. Hellyer, and F. Vaccarino. Homological scaffolds of\nbrain functional networks. J. R. Soc. Interface, 11, 20140873, 2014.\n\\bibitem{RHBK}\nJ. Reininghaus, S. Huber, U. Bauer, and R. Kwitt. A Stable Multi-Scale Kernel for Topological Machine Learning.\nProc. 2015 IEEE Conf. Comp. Vision \\& Pat. Rec., 4741--4748, 2015.\n\\bibitem{RR}\nA. Rahimi and B. Recht. Random Features for Large-Scale Kernel Machines. Advances in NIPS 20, 1177--1184, 2008.\n\\bibitem{RT}\nV. Robins and K. Turner. Principal Component Analysis of Persistent Homology Rank Functions with case studies of Spatial Point Patterns, Sphere Packing and Colloids. arXiv: 1507.01454.\n\\bibitem{SS}\nB. Sch{\\\"o}lkopf and A. J. Smola.  Learning with Kernels. MIT Press, 2001.\n\\bibitem{SMISCR}\nG. Singh, F. Memoli, R. Ishkhanov, G. Sapiro, G. Carlsson, and D. L. Ringach. Topological analysis of population activity in visual cortex. Journal of vision, 8(8), 2008.\n\\bibitem{SGSS}\nA. Smola, A. Gretton, L. Song, and B. Sch\\\"olkopf.  A Hilbert Space Embedding for Distributions.  Algorithmic Learning Theory. Lecture Notes in Computer Sciences 4754, 13--31, Springer, 2007.\n\\bibitem{SFL}\nB. K. Sriperumbudur, K. Fukumizu, and G. R. G. Lanckriet. Universality, characteristic kernels and RKHS embedding of measures. Journal of Machine Learning Research, 12, 2389--2410, 2011.\n\\bibitem{SSM}\nB. Sch{\\\"o}lkopf, A. Smola, and K. M{\\\"u}ller. Nonlinear Component Analysis as a Kernel Eigenvalue Problem. Neural Computation 10, 1299--1319, 1998.\n\\bibitem{takeuchi}\nH. Takeuchi, V. Robins, N. Francois, Y. Hiraoka, and M. Saadatfar. Topological description of granular crystallization. In preparation. \n\\bibitem{torquato}\nS. Torquato, T. M. Truskett, and P. G. Debenedetti. Is Random Close Packing of Spheres Well Defined?. Phys. Rev. Lett., 84, 2064--2067, 2000.\n\\bibitem{XW}\nK. Xia, and G. W. Wei.  Persistent homology analysis of protein structure, flexibility, and folding. Int. J. Numer. Meth. Biomed. Engng., 30, 814--844. 2014.\n\n\\end{thebibliography}\n\n\\appendix\n\n\\section{Total persistence}\n\nIn order to estimate constants $L$ appearing in Section \\ref{subsec:stability}, especially show that the constant in Theorem \\ref{kpoint_stability} is independent of $X$ and $Y$, we will review several properties of persistence.\n\nLet $(M,d_{M})$ be a triangulable compact metric space.\nFor a Lipschitz function $f:M {\\rightarrow} \\lR$, the {\\em degree-$p$ total persistence} is defined by \n\n", "index": 29, "text": "\\begin{equation*}\n{\\rm Pers}_{p}(f,t)=\\sum_{\\substack{x \\in D_{q}(f) \\\\ {\\rm pers}(x)>t}} {\\rm pers}(x)^{p} \n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex18.m1\" class=\"ltx_Math\" alttext=\"{\\rm Pers}_{p}(f,t)=\\sum_{\\begin{subarray}{c}x\\in D_{q}(f)\\\\&#10;{\\rm pers}(x)&gt;t\\end{subarray}}{\\rm pers}(x)^{p}\" display=\"block\"><mrow><mrow><msub><mi>Pers</mi><mi>p</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mtable class=\"ltx_align_c\" rowspacing=\"0.0pt\"><mtr><mtd><mrow><mi>x</mi><mo>\u2208</mo><mrow><msub><mi>D</mi><mi>q</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mi>pers</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>&gt;</mo><mi>t</mi></mrow></mtd></mtr></mtable></munder><mrow><mi>pers</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mi>p</mi></msup></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\nwhere ${\\rm Lip}(f)$ is the Lipschitz constant of $f$.\n\\end{lem}\n\nFor a compact subspace $M$ in $\\lR^{d}$, the number of $d$-cubes with length $r>0$ covering $M$ is bounded for every $r>0$.\nThe minimum of these numbers is $N(r)$ and bounded from above by $C_{M}/r^{d}$ for some constant $C_{M}$ depending only on $M$.\n\nFor $p>d$, we can find upper bounds for the both terms as follows:\n\n", "itemtype": "equation", "pos": 47549, "prevtext": "\nfor $0 \\leq t \\leq {\\rm Amp}(f)$.\nHere, ${\\rm Amp}(f) := \\max_{\\bm{x} \\in M}f(\\bm{x})-\\min_{\\bm{x} \\in M} f(\\bm{x})$ is the amplitude of $f$.\nLet $K$ be a triangulated simplicial complex of $M$ by a homeomorphism $\\theta: |K| {\\rightarrow} M$.\nThe diameter of a simplex $\\sigma \\in K$ and the mesh of the triangulation $K$ are defined by ${\\rm diam}(\\sigma) = \\max_{\\bm{x},\\bm{y} \\in \\sigma} d_{M}(\\theta(\\bm{x}),\\theta(\\bm{y}))$ and ${\\rm mesh}(K) = \\max_{\\sigma \\in K} {\\rm diam}(\\sigma )$, respectively.\nFurthermore, let us set $N(r)= \\min_{{\\rm mesh}(K ) \\leq r} \\card{K}$.\nThe degree-$p$ total persistence is bounded as follows:\n\\begin{lem}[Cohen-Steiner et al. \\cite{CEHM}]\nLet $M$ be a triangulable compact metric space and $f:M {\\rightarrow} \\lR$ be a tame Lipschitz function.\nThen ${\\rm Pers}_{p}(f,t)$ is bounded from above by\n", "index": 31, "text": "\n\\[\nt^{p}N(t/{\\rm Lip}(f)) + p \\int^{{\\rm Amp}(f)}_{{\\varepsilon}=t} N({\\varepsilon}/{\\rm Lip}(f)){\\varepsilon}^{p-1}d{\\varepsilon},\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex19.m1\" class=\"ltx_Math\" alttext=\"t^{p}N(t/{\\rm Lip}(f))+p\\int^{{\\rm Amp}(f)}_{{\\varepsilon}=t}N({\\varepsilon}/{%&#10;\\rm Lip}(f)){\\varepsilon}^{p-1}d{\\varepsilon},\" display=\"block\"><mrow><mrow><mrow><msup><mi>t</mi><mi>p</mi></msup><mo>\u2062</mo><mi>N</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mi>t</mi><mo>/</mo><mi>Lip</mi></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mi>p</mi><mo>\u2062</mo><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mi>\u03b5</mi><mo>=</mo><mi>t</mi></mrow><mrow><mi>Amp</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow></mrow></msubsup><mrow><mi>N</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mi>\u03b5</mi><mo>/</mo><mi>Lip</mi></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msup><mi>\u03b5</mi><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>\u03b5</mi></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\nand\n\n", "itemtype": "equation", "pos": 48071, "prevtext": "\nwhere ${\\rm Lip}(f)$ is the Lipschitz constant of $f$.\n\\end{lem}\n\nFor a compact subspace $M$ in $\\lR^{d}$, the number of $d$-cubes with length $r>0$ covering $M$ is bounded for every $r>0$.\nThe minimum of these numbers is $N(r)$ and bounded from above by $C_{M}/r^{d}$ for some constant $C_{M}$ depending only on $M$.\n\nFor $p>d$, we can find upper bounds for the both terms as follows:\n\n", "index": 33, "text": "\\begin{align*}\nt^{p}N(t/{\\rm Lip}(f)) \\leq t^{p}C_{M} \\frac{ {\\rm Lip}(f)^{d}} {t^{d}} \n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex20.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle t^{p}N(t/{\\rm Lip}(f))\\leq t^{p}C_{M}\\frac{{\\rm Lip}(f)^{d}}{t^{%&#10;d}}\" display=\"inline\"><mrow><mrow><msup><mi>t</mi><mi>p</mi></msup><mo>\u2062</mo><mi>N</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mi>t</mi><mo>/</mo><mi>Lip</mi></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2264</mo><mrow><msup><mi>t</mi><mi>p</mi></msup><mo>\u2062</mo><msub><mi>C</mi><mi>M</mi></msub><mo>\u2062</mo><mstyle displaystyle=\"true\"><mfrac><mrow><mi>Lip</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow><mi>d</mi></msup></mrow><msup><mi>t</mi><mi>d</mi></msup></mfrac></mstyle></mrow></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\nWe note $\\lim_{t {\\rightarrow} 0} t^{p}N(t/{\\rm Lip}(f))=0$ for $p>d$.\nThen, an upper bound of the total persistence ${\\rm Pers}(f):={\\rm Pers}_{p}(f,0)$ is given as follows:\n\\begin{lem}\n\\label{total}\nLet $M$ be a triangulable compact subspace in $\\lR^{d}$ and $p>d$.\nFor any Lipschitz function $f:M {\\rightarrow} \\lR$, \n", "itemtype": "equation", "pos": 48176, "prevtext": "\nand\n\n", "index": 35, "text": "\\begin{align*}\np \\int^{{\\rm Amp}(f)}_{{\\varepsilon}=t} N({\\varepsilon}/{\\rm Lip}(f)){\\varepsilon}^{p-1}d{\\varepsilon} \\leq \\frac{p}{p-d} C_{M} {\\rm Lip}(f)^{d} {\\rm Amp}(f)^{p-d} .\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex21.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle p\\int^{{\\rm Amp}(f)}_{{\\varepsilon}=t}N({\\varepsilon}/{\\rm Lip}(%&#10;f)){\\varepsilon}^{p-1}d{\\varepsilon}\\leq\\frac{p}{p-d}C_{M}{\\rm Lip}(f)^{d}{\\rm&#10;Amp%&#10;}(f)^{p-d}.\" display=\"inline\"><mrow><mrow><mrow><mi>p</mi><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mi>\u03b5</mi><mo>=</mo><mi>t</mi></mrow><mrow><mi>Amp</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow></mrow></msubsup></mstyle><mrow><mi>N</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mi>\u03b5</mi><mo>/</mo><mi>Lip</mi></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msup><mi>\u03b5</mi><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>\u03b5</mi></mrow></mrow></mrow></mrow><mo>\u2264</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mi>p</mi><mrow><mi>p</mi><mo>-</mo><mi>d</mi></mrow></mfrac></mstyle><mo>\u2062</mo><msub><mi>C</mi><mi>M</mi></msub><mo>\u2062</mo><mi>Lip</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow><mi>d</mi></msup><mo>\u2062</mo><mi>Amp</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>p</mi><mo>-</mo><mi>d</mi></mrow></msup></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\nwhere $C_{M}$ is a constant depending only on $M$.\n\\end{lem}\n\nIn the case of $f_{X}$, since $X$ is a finite subset in $\\lR^{d}$, there exists an $R$-ball $M$ containing $X$ for some $R>0$, which is a triangulable compact subspace in $\\lR^{d}$.\n\n\\begin{lem}\n\\label{point_total}\nLet $M$ be a triangulable compact subspace in $\\lR^{d}$, $X=\\{\\bm{x}_{1},\\ldots,\\bm{x}_{n}\\}$ be a finite subset of $M$, and $p>d$. Then \n", "itemtype": "equation", "pos": 48690, "prevtext": "\nWe note $\\lim_{t {\\rightarrow} 0} t^{p}N(t/{\\rm Lip}(f))=0$ for $p>d$.\nThen, an upper bound of the total persistence ${\\rm Pers}(f):={\\rm Pers}_{p}(f,0)$ is given as follows:\n\\begin{lem}\n\\label{total}\nLet $M$ be a triangulable compact subspace in $\\lR^{d}$ and $p>d$.\nFor any Lipschitz function $f:M {\\rightarrow} \\lR$, \n", "index": 37, "text": "\n\\[\n{\\rm Pers}_{p}(f) \\leq \\frac{p}{p-d}C_{M} {\\rm Lip}(f)^{d} {\\rm Amp}(f)^{p-d},\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex22.m1\" class=\"ltx_Math\" alttext=\"{\\rm Pers}_{p}(f)\\leq\\frac{p}{p-d}C_{M}{\\rm Lip}(f)^{d}{\\rm Amp}(f)^{p-d},\" display=\"block\"><mrow><mrow><mrow><msub><mi>Pers</mi><mi>p</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2264</mo><mrow><mfrac><mi>p</mi><mrow><mi>p</mi><mo>-</mo><mi>d</mi></mrow></mfrac><mo>\u2062</mo><msub><mi>C</mi><mi>M</mi></msub><mo>\u2062</mo><mi>Lip</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow><mi>d</mi></msup><mo>\u2062</mo><mi>Amp</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>p</mi><mo>-</mo><mi>d</mi></mrow></msup></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\nwhere $C_{M}$ is a constant depending only on $M$.\n\\end{lem}\n\n\\begin{proof}\nThe Lipschitz constant of $f_{X}$ is $1$, because, for any $\\bm{x},\\bm{y} \\in M$,\n\n", "itemtype": "equation", "pos": 49190, "prevtext": "\nwhere $C_{M}$ is a constant depending only on $M$.\n\\end{lem}\n\nIn the case of $f_{X}$, since $X$ is a finite subset in $\\lR^{d}$, there exists an $R$-ball $M$ containing $X$ for some $R>0$, which is a triangulable compact subspace in $\\lR^{d}$.\n\n\\begin{lem}\n\\label{point_total}\nLet $M$ be a triangulable compact subspace in $\\lR^{d}$, $X=\\{\\bm{x}_{1},\\ldots,\\bm{x}_{n}\\}$ be a finite subset of $M$, and $p>d$. Then \n", "index": 39, "text": "\n\\[\n{\\rm Pers}_{p}(f_{X}) \\leq \\frac{p}{p-d}C_{M}{\\rm diam}(M)^{p-d},\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex23.m1\" class=\"ltx_Math\" alttext=\"{\\rm Pers}_{p}(f_{X})\\leq\\frac{p}{p-d}C_{M}{\\rm diam}(M)^{p-d},\" display=\"block\"><mrow><mrow><mrow><msub><mi>Pers</mi><mi>p</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mi>X</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2264</mo><mrow><mfrac><mi>p</mi><mrow><mi>p</mi><mo>-</mo><mi>d</mi></mrow></mfrac><mo>\u2062</mo><msub><mi>C</mi><mi>M</mi></msub><mo>\u2062</mo><mi>diam</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>M</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>p</mi><mo>-</mo><mi>d</mi></mrow></msup></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\nMoreover, the amplitude ${\\rm Amp}(f_{X})$ is less than or equal to ${\\rm diam}(M)$, because $\\min_{\\bm{x} \\in M} f_{X}(\\bm{x})=0$ and $\\max_{\\bm{x} \\in M} f_{X}(\\bm{x}) \\leq {\\rm diam}(M)$.\n\\end{proof}\n\nFor more general, for a persistence diagram $D$, we define $p$-degree total persistence of $D$ by ${\\rm Pers}_{p}(D):=\\sum_{x \\in D} {\\rm pers}(x)^{p}$.\nLet $x_{1},\\ldots,x_{n}$ be points of $\\underline{D}$.\nThen we can consider the following $n$-dimensional vector from $D$:\n", "itemtype": "equation", "pos": 49421, "prevtext": "\nwhere $C_{M}$ is a constant depending only on $M$.\n\\end{lem}\n\n\\begin{proof}\nThe Lipschitz constant of $f_{X}$ is $1$, because, for any $\\bm{x},\\bm{y} \\in M$,\n\n", "index": 41, "text": "\\begin{align*}\nf_{X}(\\bm{x})-f_{X}(\\bm{y}) \n&=\\min_{\\bm{x}_{i} \\in X} d(\\bm{x},\\bm{x}_{i})-\\min_{\\bm{x}_{i} \\in X} d(\\bm{y},\\bm{x}_{i}) \\\\\n&\\leq \\min_{\\bm{x}_{i} \\in X} (d(\\bm{x},\\bm{y})+d(\\bm{y},\\bm{x}_{i})) - \\min_{\\bm{x}_{i} \\in X} d(\\bm{y},\\bm{x}_{i}) \\\\\n&=d(\\bm{x},\\bm{y}).\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex24.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle f_{X}(\\bm{x})-f_{X}(\\bm{y})\" display=\"inline\"><mrow><mrow><msub><mi>f</mi><mi>X</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc99</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><msub><mi>f</mi><mi>X</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc9a</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex24.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\min_{\\bm{x}_{i}\\in X}d(\\bm{x},\\bm{x}_{i})-\\min_{\\bm{x}_{i}\\in X%&#10;}d(\\bm{y},\\bm{x}_{i})\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mrow><mrow><munder><mi>min</mi><mrow><msub><mi>\ud835\udc99</mi><mi>i</mi></msub><mo>\u2208</mo><mi>X</mi></mrow></munder><mo>\u2061</mo><mi>d</mi></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc99</mi><mo>,</mo><msub><mi>\ud835\udc99</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mrow><munder><mi>min</mi><mrow><msub><mi>\ud835\udc99</mi><mi>i</mi></msub><mo>\u2208</mo><mi>X</mi></mrow></munder><mo>\u2061</mo><mi>d</mi></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc9a</mi><mo>,</mo><msub><mi>\ud835\udc99</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex25.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\leq\\min_{\\bm{x}_{i}\\in X}(d(\\bm{x},\\bm{y})+d(\\bm{y},\\bm{x}_{i}))%&#10;-\\min_{\\bm{x}_{i}\\in X}d(\\bm{y},\\bm{x}_{i})\" display=\"inline\"><mrow><mi/><mo>\u2264</mo><mrow><mrow><munder><mi>min</mi><mrow><msub><mi>\ud835\udc99</mi><mi>i</mi></msub><mo>\u2208</mo><mi>X</mi></mrow></munder><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mi>d</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc99</mi><mo>,</mo><mi>\ud835\udc9a</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mi>d</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc9a</mi><mo>,</mo><msub><mi>\ud835\udc99</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mrow><munder><mi>min</mi><mrow><msub><mi>\ud835\udc99</mi><mi>i</mi></msub><mo>\u2208</mo><mi>X</mi></mrow></munder><mo>\u2061</mo><mi>d</mi></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc9a</mi><mo>,</mo><msub><mi>\ud835\udc99</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex26.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=d(\\bm{x},\\bm{y}).\" display=\"inline\"><mrow><mrow><mi/><mo>=</mo><mrow><mi>d</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc99</mi><mo>,</mo><mi>\ud835\udc9a</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\nSince each ${\\rm pers}(x) \\ (x \\in \\underline{D})$ is always positive, by using the $\\ell^{p}$-norm of $v(D)$, we have ${\\rm Pers}_{p}(D)=\\norm{v(D)}^{p}_{p}$.\nIn general, since $\\norm{v}_{q} \\leq \\norm{v}_{p} \\ (v \\in \\lR^{n}, \\ 1 \\leq p \\leq q)$, we have\n", "itemtype": "equation", "pos": 50192, "prevtext": "\nMoreover, the amplitude ${\\rm Amp}(f_{X})$ is less than or equal to ${\\rm diam}(M)$, because $\\min_{\\bm{x} \\in M} f_{X}(\\bm{x})=0$ and $\\max_{\\bm{x} \\in M} f_{X}(\\bm{x}) \\leq {\\rm diam}(M)$.\n\\end{proof}\n\nFor more general, for a persistence diagram $D$, we define $p$-degree total persistence of $D$ by ${\\rm Pers}_{p}(D):=\\sum_{x \\in D} {\\rm pers}(x)^{p}$.\nLet $x_{1},\\ldots,x_{n}$ be points of $\\underline{D}$.\nThen we can consider the following $n$-dimensional vector from $D$:\n", "index": 43, "text": "\n\\[\nv(D):=\\pare{ {\\rm pers}(x_{1}),\\ldots,{\\rm pers}(x_{n}) }.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex27.m1\" class=\"ltx_Math\" alttext=\"v(D):=\\pare{{\\rm pers}(x_{1}),\\ldots,{\\rm pers}(x_{n})}.\" display=\"block\"><mrow><mrow><mrow><mi>v</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>D</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>:=</mo><mrow><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\pare</mtext></merror><mo>\u2062</mo><mi>pers</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><mrow><mi>pers</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\n\n\\begin{prop}\n\\label{prop:persistence_inequality}\nIf $1 \\leq p \\leq q<\\infty$ and ${\\rm Pers}_{p}(D)$ is bounded, ${\\rm Pers}_{q}(D)$ is also bounded.\n\\end{prop}\n\n\n\n\\section{Proofs of Theorem \\ref{kfunc_stability} and Theorem \\ref{kpoint_stability} }\n\nIn fact, we can calculate the constant $L(f,g;C,p,\\sigma)$ in Theorem \\ref{kfunc_stability} such as\n", "itemtype": "equation", "pos": 50514, "prevtext": "\nSince each ${\\rm pers}(x) \\ (x \\in \\underline{D})$ is always positive, by using the $\\ell^{p}$-norm of $v(D)$, we have ${\\rm Pers}_{p}(D)=\\norm{v(D)}^{p}_{p}$.\nIn general, since $\\norm{v}_{q} \\leq \\norm{v}_{p} \\ (v \\in \\lR^{n}, \\ 1 \\leq p \\leq q)$, we have\n", "index": 45, "text": "\n\\[\n{\\rm Pers}_{q}(D)^{\\frac{1}{q}} =\\norm{v(D)}_{q} \\leq \\norm{v(D)}_{p} = {\\rm Pers}_{p}(D)^{\\frac{1}{p}}.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex28.m1\" class=\"ltx_Math\" alttext=\"{\\rm Pers}_{q}(D)^{\\frac{1}{q}}=\\norm{v(D)}_{q}\\leq\\norm{v(D)}_{p}={\\rm Pers}_%&#10;{p}(D)^{\\frac{1}{p}}.\" display=\"block\"><mrow><mrow><mrow><msub><mi>Pers</mi><mi>q</mi></msub><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>D</mi><mo stretchy=\"false\">)</mo></mrow><mfrac><mn>1</mn><mi>q</mi></mfrac></msup></mrow><mo>=</mo><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><mi>v</mi><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">(</mo><mi>D</mi><mo stretchy=\"false\">)</mo></mrow><mi>q</mi></msub></mrow><mo>\u2264</mo><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><mi>v</mi><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">(</mo><mi>D</mi><mo stretchy=\"false\">)</mo></mrow><mi>p</mi></msub></mrow><mo>=</mo><mrow><msub><mi>Pers</mi><mi>p</mi></msub><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>D</mi><mo stretchy=\"false\">)</mo></mrow><mfrac><mn>1</mn><mi>p</mi></mfrac></msup></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\nTo obtain this value, we show several lemmas.\n\n\\begin{lem}\n\\label{lemm:Lip_k}\nFor any $x,y \\in \\lR^{2}$, $\\norm{k_{G}(\\cdot,x)-k_{G}(\\cdot,y)}_{\\cH_{k_{G}}} \\leq \\frac{\\sqrt{2}}{\\sigma} \\norm{x-y}_{\\infty}$.\n\\end{lem}\n\n\\begin{proof}\n\n", "itemtype": "equation", "pos": 50977, "prevtext": "\n\n\\begin{prop}\n\\label{prop:persistence_inequality}\nIf $1 \\leq p \\leq q<\\infty$ and ${\\rm Pers}_{p}(D)$ is bounded, ${\\rm Pers}_{q}(D)$ is also bounded.\n\\end{prop}\n\n\n\n\\section{Proofs of Theorem \\ref{kfunc_stability} and Theorem \\ref{kpoint_stability} }\n\nIn fact, we can calculate the constant $L(f,g;C,p,\\sigma)$ in Theorem \\ref{kfunc_stability} such as\n", "index": 47, "text": "\n\\[\n\\rl{ \\frac{\\sqrt{2}}{\\sigma} {\\rm Pers}_{p}(D_{q}(f))+ 2p{\\rm Pers}_{p-1}(D_{q}(f))+(2p+1){\\rm Pers}_{p-1}(D_{q}(g)) } C.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex29.m1\" class=\"ltx_Math\" alttext=\"\\rl{\\frac{\\sqrt{2}}{\\sigma}{\\rm Pers}_{p}(D_{q}(f))+2p{\\rm Pers}_{p-1}(D_{q}(f%&#10;))+(2p+1){\\rm Pers}_{p-1}(D_{q}(g))}C.\" display=\"block\"><mrow><mrow><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\rl</mtext></merror><mo>\u2062</mo><mfrac><msqrt><mn>2</mn></msqrt><mi>\u03c3</mi></mfrac><mo>\u2062</mo><msub><mi>Pers</mi><mi>p</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>D</mi><mi>q</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mn>2</mn><mo>\u2062</mo><mi>p</mi><mo>\u2062</mo><msub><mi>Pers</mi><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>D</mi><mi>q</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>p</mi></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>Pers</mi><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>D</mi><mi>q</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>g</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>C</mi></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\nWe have used the fact $1-e^{-t} \\leq t \\ ( t \\in \\lR)$ in \\eqref{eq:eq1} and $\\norm{x}^{2} \\leq 2 \\norm{x}^{2}_{\\infty} \\ (x \\in \\lR^{2})$ in \\eqref{eq:eq2}.\n\\end{proof}\n\n\\begin{lem}\n\\label{lemm:persistence}\nFor any $x,y \\in \\lR^{2}$, the difference of persistences $\\abs{{\\rm pers}(x)-{\\rm pers}(y)}$ is less than or equal to $2 \\norm{x-y}_{\\infty}$.\n\\end{lem}\n\n\\begin{proof}\nFor $x=(x_{1},x_{2}),y=(y_{1},y_{2})$, we have\n\n", "itemtype": "equation", "pos": 51339, "prevtext": "\nTo obtain this value, we show several lemmas.\n\n\\begin{lem}\n\\label{lemm:Lip_k}\nFor any $x,y \\in \\lR^{2}$, $\\norm{k_{G}(\\cdot,x)-k_{G}(\\cdot,y)}_{\\cH_{k_{G}}} \\leq \\frac{\\sqrt{2}}{\\sigma} \\norm{x-y}_{\\infty}$.\n\\end{lem}\n\n\\begin{proof}\n\n", "index": 49, "text": "\\begin{align}\n\\norm{k_{G}(\\cdot,x)-k_{G}(\\cdot,y)}^{2}_{\\cH_{k_{G}}} \\nonumber  \n&=k_{G}(x,x)+k_{G}(y,y)-2k_{G}(x,y) \\nonumber \\\\\n&=1+1-2 e^{-\\frac{\\norm{x-y}^{2}}{2 \\sigma^{2}}} \\nonumber \\\\\n&= 2 \\pare{ 1-e^{-\\frac{\\norm{x-y}^{2}}{2 \\sigma^{2}}} } \\nonumber  \\\\\n& \\leq  \\frac{1}{\\sigma^{2}}\\norm{x-y}^{2} \\label{eq:eq1} \\\\\n& \\leq \\frac{2}{\\sigma^{2}}\\norm{x-y}^{2}_{\\infty}. \\label{eq:eq2} \n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex30.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\norm{k_{G}(\\cdot,x)-k_{G}(\\cdot,y)}^{2}_{\\cH_{k_{G}}}\" display=\"inline\"><mrow><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><msub><mi>k</mi><mi>G</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mo>\u22c5</mo><mo>,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><msub><mi>k</mi><mi>G</mi></msub><mo>\u2062</mo><msubsup><mrow><mo stretchy=\"false\">(</mo><mo>\u22c5</mo><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><msub><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\cH</mtext></merror><msub><mi>k</mi><mi>G</mi></msub></msub><mn>2</mn></msubsup></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex30.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=k_{G}(x,x)+k_{G}(y,y)-2k_{G}(x,y)\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mrow><mrow><msub><mi>k</mi><mi>G</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><msub><mi>k</mi><mi>G</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>-</mo><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>k</mi><mi>G</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex31.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=1+1-2e^{-\\frac{\\norm{x-y}^{2}}{2\\sigma^{2}}}\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mrow><mn>1</mn><mo>+</mo><mn>1</mn></mrow><mo>-</mo><mrow><mn>2</mn><mo>\u2062</mo><msup><mi>e</mi><mrow><mo>-</mo><mfrac><mrow><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><mi>x</mi></mrow><mo>-</mo><msup><mi>y</mi><mn>2</mn></msup></mrow><mrow><mn>2</mn><mo>\u2062</mo><msup><mi>\u03c3</mi><mn>2</mn></msup></mrow></mfrac></mrow></msup></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex32.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=2\\pare{1-e^{-\\frac{\\norm{x-y}^{2}}{2\\sigma^{2}}}}\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\pare</mtext></merror><mo>\u2062</mo><mn>1</mn></mrow><mo>-</mo><msup><mi>e</mi><mrow><mo>-</mo><mfrac><mrow><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><mi>x</mi></mrow><mo>-</mo><msup><mi>y</mi><mn>2</mn></msup></mrow><mrow><mn>2</mn><mo>\u2062</mo><msup><mi>\u03c3</mi><mn>2</mn></msup></mrow></mfrac></mrow></msup></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\leq\\frac{1}{\\sigma^{2}}\\norm{x-y}^{2}\" display=\"inline\"><mrow><mi/><mo>\u2264</mo><mrow><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><msup><mi>\u03c3</mi><mn>2</mn></msup></mfrac></mstyle><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><mi>x</mi></mrow><mo>-</mo><msup><mi>y</mi><mn>2</mn></msup></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\leq\\frac{2}{\\sigma^{2}}\\norm{x-y}^{2}_{\\infty}.\" display=\"inline\"><mrow><mrow><mi/><mo>\u2264</mo><mrow><mrow><mstyle displaystyle=\"true\"><mfrac><mn>2</mn><msup><mi>\u03c3</mi><mn>2</mn></msup></mfrac></mstyle><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><mi>x</mi></mrow><mo>-</mo><msubsup><mi>y</mi><mi mathvariant=\"normal\">\u221e</mi><mn>2</mn></msubsup></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\n\\end{proof}\n\n\\begin{lem}\n\\label{lemm:w_continuous}\nFor any $x,y \\in \\lR^{2}$, we have \n\n", "itemtype": "equation", "pos": 52167, "prevtext": "\nWe have used the fact $1-e^{-t} \\leq t \\ ( t \\in \\lR)$ in \\eqref{eq:eq1} and $\\norm{x}^{2} \\leq 2 \\norm{x}^{2}_{\\infty} \\ (x \\in \\lR^{2})$ in \\eqref{eq:eq2}.\n\\end{proof}\n\n\\begin{lem}\n\\label{lemm:persistence}\nFor any $x,y \\in \\lR^{2}$, the difference of persistences $\\abs{{\\rm pers}(x)-{\\rm pers}(y)}$ is less than or equal to $2 \\norm{x-y}_{\\infty}$.\n\\end{lem}\n\n\\begin{proof}\nFor $x=(x_{1},x_{2}),y=(y_{1},y_{2})$, we have\n\n", "index": 51, "text": "\\begin{align}\n| {\\rm pers}(x)-{\\rm pers}(y) |\n&= |(x_{2}-x_{1}) - (y_{2}-y_{1})| \\nonumber \\\\\n&\\leq |x_{2}-y_{2}|+|x_{1}-y_{1}| \\nonumber \\\\\n&\\leq 2 \\norm{x-y}_{\\infty}. \\nonumber\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex33.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle|{\\rm pers}(x)-{\\rm pers}(y)|\" display=\"inline\"><mrow><mo stretchy=\"false\">|</mo><mrow><mrow><mi>pers</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mi>pers</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">|</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex33.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=|(x_{2}-x_{1})-(y_{2}-y_{1})|\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mo stretchy=\"false\">|</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>x</mi><mn>2</mn></msub><mo>-</mo><msub><mi>x</mi><mn>1</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>-</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>y</mi><mn>2</mn></msub><mo>-</mo><msub><mi>y</mi><mn>1</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">|</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex34.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\leq|x_{2}-y_{2}|+|x_{1}-y_{1}|\" display=\"inline\"><mrow><mi/><mo>\u2264</mo><mrow><mrow><mo stretchy=\"false\">|</mo><mrow><msub><mi>x</mi><mn>2</mn></msub><mo>-</mo><msub><mi>y</mi><mn>2</mn></msub></mrow><mo stretchy=\"false\">|</mo></mrow><mo>+</mo><mrow><mo stretchy=\"false\">|</mo><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>-</mo><msub><mi>y</mi><mn>1</mn></msub></mrow><mo stretchy=\"false\">|</mo></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex35.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\leq 2\\norm{x-y}_{\\infty}.\" display=\"inline\"><mrow><mrow><mi/><mo>\u2264</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><mi>x</mi></mrow><mo>-</mo><msub><mi>y</mi><mi mathvariant=\"normal\">\u221e</mi></msub></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\n\\end{lem}\n\n\\begin{proof}\n\n", "itemtype": "equation", "pos": 52446, "prevtext": "\n\\end{proof}\n\n\\begin{lem}\n\\label{lemm:w_continuous}\nFor any $x,y \\in \\lR^{2}$, we have \n\n", "index": 53, "text": "\\begin{align*}\n\\abs{w(x)-w(y)} \\leq 2pC \\max \\{{\\rm pers}(x)^{p-1}, {\\rm pers}(y)^{p-1}\\} \\norm{x-y}_{\\infty}.\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex36.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\abs{w(x)-w(y)}\\leq 2pC\\max\\{{\\rm pers}(x)^{p-1},{\\rm pers}(y)^{p%&#10;-1}\\}\\norm{x-y}_{\\infty}.\" display=\"inline\"><mrow><mrow><mrow><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\abs</mtext></merror><mo>\u2062</mo><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>\u2264</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>p</mi><mo>\u2062</mo><mi>C</mi><mo>\u2062</mo><mrow><mi>max</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mi>pers</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow><mo>,</mo><mrow><mi>pers</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><mi>x</mi></mrow><mo>-</mo><msub><mi>y</mi><mi mathvariant=\"normal\">\u221e</mi></msub></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\nWe have used the fact that the Lipschitz constant of $\\arctan$ is $1$ in \\eqref{eq:arctan} and for any $s,t \\in \\lR$,\n\n", "itemtype": "equation", "pos": 52595, "prevtext": "\n\\end{lem}\n\n\\begin{proof}\n\n", "index": 55, "text": "\\begin{align}\n&\\abs{w(x)-w(y) } \\nonumber \\\\\n&=\\abs{ \\arctan(C {\\rm pers}(x)^{p})-\\arctan(C {\\rm pers}(y)^{p}) } \\label{eq:arctan} \\\\\n& \\leq C \\abs{ {\\rm pers}(x)^{p}-{\\rm pers}(y)^{p}} \\nonumber \\\\\n& \\leq C \\abs{{\\rm pers}(x)-{\\rm pers}(y)} p \\max \\{{\\rm pers}(x)^{p-1}, {\\rm pers}(y)^{p-1}\\} \\label{eq:p}\\\\\n& \\leq 2 pC \\max \\{{\\rm pers}(x)^{p-1}, {\\rm pers}(y)^{p-1}\\} \\norm{x-y}_{\\infty}. \\nonumber\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex37.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\abs{w(x)-w(y)}\" display=\"inline\"><mrow><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\abs</mtext></merror><mo>\u2062</mo><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\abs{\\arctan(C{\\rm pers}(x)^{p})-\\arctan(C{\\rm pers}(y)^{p})}\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\abs</mtext></merror><mo>\u2062</mo><mrow><mi>arctan</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>C</mi><mo>\u2062</mo><mi>pers</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mi>p</mi></msup></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>-</mo><mrow><mi>arctan</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>C</mi><mo>\u2062</mo><mi>pers</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><mi>p</mi></msup></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex38.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\leq C\\abs{{\\rm pers}(x)^{p}-{\\rm pers}(y)^{p}}\" display=\"inline\"><mrow><mi/><mo>\u2264</mo><mrow><mrow><mi>C</mi><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\abs</mtext></merror><mo>\u2062</mo><mi>pers</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mi>p</mi></msup></mrow><mo>-</mo><mrow><mi>pers</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><mi>p</mi></msup></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\leq C\\abs{{\\rm pers}(x)-{\\rm pers}(y)}p\\max\\{{\\rm pers}(x)^{p-1}%&#10;,{\\rm pers}(y)^{p-1}\\}\" display=\"inline\"><mrow><mi/><mo>\u2264</mo><mrow><mrow><mi>C</mi><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\abs</mtext></merror><mo>\u2062</mo><mi>pers</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mi>pers</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>p</mi><mo>\u2062</mo><mrow><mi>max</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mi>pers</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow><mo>,</mo><mrow><mi>pers</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow><mo stretchy=\"false\">}</mo></mrow></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex39.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\leq 2pC\\max\\{{\\rm pers}(x)^{p-1},{\\rm pers}(y)^{p-1}\\}\\norm{x-y}%&#10;_{\\infty}.\" display=\"inline\"><mrow><mrow><mi/><mo>\u2264</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>p</mi><mo>\u2062</mo><mi>C</mi><mo>\u2062</mo><mrow><mi>max</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mi>pers</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow><mo>,</mo><mrow><mi>pers</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><mi>x</mi></mrow><mo>-</mo><msub><mi>y</mi><mi mathvariant=\"normal\">\u221e</mi></msub></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\nin \\eqref{eq:p}.\n\\end{proof}\n\nTheorem \\ref{kfunc_stability} is a stability result for functions $f,g:M {\\rightarrow} \\lR$.\nIf $\\norm{f-g}_{\\infty} < {\\varepsilon}$, from Proposition \\ref{func_stability}, the bottleneck distance $d_{B}(D_{q}(f),D_{q}(g))$ is less than ${\\varepsilon}$.\nFrom now on, we show a generalized stability result.\nThat is, for two finite persistence diagrams $D$ and $E$ satisfying $d_{B}(D,E) < {\\varepsilon}$, we will find a constant $L$ such that\n", "itemtype": "equation", "pos": 53127, "prevtext": "\nWe have used the fact that the Lipschitz constant of $\\arctan$ is $1$ in \\eqref{eq:arctan} and for any $s,t \\in \\lR$,\n\n", "index": 57, "text": "\\begin{align*}\ns^{p}-t^{p} \n&=(s-t)(s^{p-1}+s^{p-2}t+\\cdots+t^{p-1}) \\\\\n& \\leq (s-t) p \\max \\{ s^{p-1},t^{p-1}\\}\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex40.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle s^{p}-t^{p}\" display=\"inline\"><mrow><msup><mi>s</mi><mi>p</mi></msup><mo>-</mo><msup><mi>t</mi><mi>p</mi></msup></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex40.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=(s-t)(s^{p-1}+s^{p-2}t+\\cdots+t^{p-1})\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>s</mi><mo>-</mo><mi>t</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mi>s</mi><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msup><mo>+</mo><mrow><msup><mi>s</mi><mrow><mi>p</mi><mo>-</mo><mn>2</mn></mrow></msup><mo>\u2062</mo><mi>t</mi></mrow><mo>+</mo><mi mathvariant=\"normal\">\u22ef</mi><mo>+</mo><msup><mi>t</mi><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex41.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\leq(s-t)p\\max\\{s^{p-1},t^{p-1}\\}\" display=\"inline\"><mrow><mi/><mo>\u2264</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>s</mi><mo>-</mo><mi>t</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>p</mi><mo>\u2062</mo><mrow><mi>max</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">{</mo><msup><mi>s</mi><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msup><mo>,</mo><msup><mi>t</mi><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msup><mo stretchy=\"false\">}</mo></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": " \nHere, let a multi-bijection $\\gamma:D {\\rightarrow} E$ such that $\\sup_{x \\in D} \\norm{x-\\gamma(x)}_{\\infty} < {\\varepsilon}$ and  $E':=\\underline{E}-(\\gamma(\\underline{D})-{\\Delta})$.\nBy the definition of $\\gamma$, each point in $E'$ is ${\\varepsilon}$-close to the diagonal.\n\n\n\n\n\n\n\n\n\n", "itemtype": "equation", "pos": -1, "prevtext": "\nin \\eqref{eq:p}.\n\\end{proof}\n\nTheorem \\ref{kfunc_stability} is a stability result for functions $f,g:M {\\rightarrow} \\lR$.\nIf $\\norm{f-g}_{\\infty} < {\\varepsilon}$, from Proposition \\ref{func_stability}, the bottleneck distance $d_{B}(D_{q}(f),D_{q}(g))$ is less than ${\\varepsilon}$.\nFrom now on, we show a generalized stability result.\nThat is, for two finite persistence diagrams $D$ and $E$ satisfying $d_{B}(D,E) < {\\varepsilon}$, we will find a constant $L$ such that\n", "index": 59, "text": "\n\\[\nd^{w}_{k_{G}}(D,E) < L {\\varepsilon}.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex42.m1\" class=\"ltx_Math\" alttext=\"d^{w}_{k_{G}}(D,E)&lt;L{\\varepsilon}.\" display=\"block\"><mrow><mrow><mrow><msubsup><mi>d</mi><msub><mi>k</mi><mi>G</mi></msub><mi>w</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>D</mi><mo>,</mo><mi>E</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>&lt;</mo><mrow><mi>L</mi><mo>\u2062</mo><mi>\u03b5</mi></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\nForm Lemma \\ref{lemm:Lip_k}, we have\n", "itemtype": "equation", "pos": 54057, "prevtext": " \nHere, let a multi-bijection $\\gamma:D {\\rightarrow} E$ such that $\\sup_{x \\in D} \\norm{x-\\gamma(x)}_{\\infty} < {\\varepsilon}$ and  $E':=\\underline{E}-(\\gamma(\\underline{D})-{\\Delta})$.\nBy the definition of $\\gamma$, each point in $E'$ is ${\\varepsilon}$-close to the diagonal.\n\n\n\n\n\n\n\n\n\n", "index": 61, "text": "\\begin{align}\n&d^{w}_{k_{G}}(D,E) \\nonumber \\\\\n&=\\norm{\\int k_{G}(\\cdot,x) d \\mu^{w}_{D}(x)-\\int k_{G}(\\cdot,x) d \\mu^{w}_{E}(y)}_{\\cH_{k_{G}}} \\nonumber \\\\\n&=\\norm{ \\int k_{G}(\\cdot,x) d \\mu^{w}_{D}(x) -\\int k_{G}(\\cdot,y) d \\mu^{w}_{\\gamma(\\underline{D})}(y)-\\int k_{G}(\\cdot,y) d \\mu^{w}_{E'}(y)}_{\\cH_{k_{G}}} \\nonumber \\\\\n&=\\norm{ \\sum_{x \\in D} w(x)k_{G}(\\cdot,x) -\\sum_{x \\in D} w(\\gamma(x)) k_{G}(\\cdot,\\gamma(x)) -\\sum_{y \\in E'} w(y)k_{G}(\\cdot,y) }_{\\cH_{k_{G}}}\\nonumber  \\\\\n\n\n&\\leq \\norm{ \\sum_{x \\in D} w(x)k_{G}(\\cdot,x) -\\sum_{x \\in D} w(x) k_{G}(\\cdot,\\gamma(x)) }_{\\cH_{k_{G}}} \\nonumber  \\\\\n& ~~~ + \\norm{\\sum_{x \\in D} w(x) k_{G}(\\cdot,\\gamma(x)) -\\sum_{x \\in D} w(\\gamma(x)) k_{G}(\\cdot,\\gamma(x))}_{\\cH_{k_{G}}} +\\norm{\\sum_{y \\in E'} w(y)k_{G}(\\cdot,y) }_{\\cH_{k_{G}}} \\nonumber \\\\\n&\\leq \\sum_{x \\in D} w(x) \\norm{k_{G}(\\cdot,x)-k_{G}(\\cdot,\\gamma(x))}_{\\cH_{k_{G}}} + \\sum_{x \\in D} \\abs{w(x)-w(\\gamma(x))} \\norm{k_{G}(\\cdot,\\gamma(x))}_{\\cH_{k_{G}}} \\nonumber \\\\\n& ~~ + \\sum_{y \\in E'} w(y) \\norm{k_{G}(\\cdot,y)}_{\\cH_{k_{G}}} \\label{eq:dk_halfway}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex43.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle d^{w}_{k_{G}}(D,E)\" display=\"inline\"><mrow><msubsup><mi>d</mi><msub><mi>k</mi><mi>G</mi></msub><mi>w</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>D</mi><mo>,</mo><mi>E</mi><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex44.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\norm{\\int k_{G}(\\cdot,x)d\\mu^{w}_{D}(x)-\\int k_{G}(\\cdot,x)d\\mu%&#10;^{w}_{E}(y)}_{\\cH_{k_{G}}}\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><mstyle displaystyle=\"true\"><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><msub><mi>k</mi><mi>G</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mo>\u22c5</mo><mo>,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><msubsup><mi>\u03bc</mi><mi>D</mi><mi>w</mi></msubsup></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mstyle></mrow><mo>-</mo><mstyle displaystyle=\"true\"><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><msub><mi>k</mi><mi>G</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mo>\u22c5</mo><mo>,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><msubsup><mi>\u03bc</mi><mi>E</mi><mi>w</mi></msubsup></mrow><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><msub><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\cH</mtext></merror><msub><mi>k</mi><mi>G</mi></msub></msub></msub></mrow></mrow></mstyle></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex45.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\norm{\\int k_{G}(\\cdot,x)d\\mu^{w}_{D}(x)-\\int k_{G}(\\cdot,y)d\\mu%&#10;^{w}_{\\gamma(\\underline{D})}(y)-\\int k_{G}(\\cdot,y)d\\mu^{w}_{E^{\\prime}}(y)}_{%&#10;\\cH_{k_{G}}}\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><mstyle displaystyle=\"true\"><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><msub><mi>k</mi><mi>G</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mo>\u22c5</mo><mo>,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><msubsup><mi>\u03bc</mi><mi>D</mi><mi>w</mi></msubsup></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mstyle></mrow><mo>-</mo><mstyle displaystyle=\"true\"><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><msub><mi>k</mi><mi>G</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mo>\u22c5</mo><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><msubsup><mi>\u03bc</mi><mrow><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><munder accentunder=\"true\"><mi>D</mi><mo>\u00af</mo></munder><mo stretchy=\"false\">)</mo></mrow></mrow><mi>w</mi></msubsup></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mstyle><mo>-</mo><mstyle displaystyle=\"true\"><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><msub><mi>k</mi><mi>G</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mo>\u22c5</mo><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><msubsup><mi>\u03bc</mi><msup><mi>E</mi><mo>\u2032</mo></msup><mi>w</mi></msubsup></mrow><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><msub><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\cH</mtext></merror><msub><mi>k</mi><mi>G</mi></msub></msub></msub></mrow></mrow></mstyle></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex46.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\norm{\\sum_{x\\in D}w(x)k_{G}(\\cdot,x)-\\sum_{x\\in D}w(\\gamma(x))k%&#10;_{G}(\\cdot,\\gamma(x))-\\sum_{y\\in E^{\\prime}}w(y)k_{G}(\\cdot,y)}_{\\cH_{k_{G}}}\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>x</mi><mo>\u2208</mo><mi>D</mi></mrow></munder></mstyle><mrow><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>k</mi><mi>G</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mo>\u22c5</mo><mo>,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>-</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>x</mi><mo>\u2208</mo><mi>D</mi></mrow></munder></mstyle><mrow><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>k</mi><mi>G</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mo>\u22c5</mo><mo>,</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>-</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>y</mi><mo>\u2208</mo><msup><mi>E</mi><mo>\u2032</mo></msup></mrow></munder></mstyle><mrow><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>k</mi><mi>G</mi></msub><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">(</mo><mo>\u22c5</mo><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><msub><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\cH</mtext></merror><msub><mi>k</mi><mi>G</mi></msub></msub></msub></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex47.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\leq\\norm{\\sum_{x\\in D}w(x)k_{G}(\\cdot,x)-\\sum_{x\\in D}w(x)k_{G}(%&#10;\\cdot,\\gamma(x))}_{\\cH_{k_{G}}}\" display=\"inline\"><mrow><mi/><mo>\u2264</mo><mrow><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>x</mi><mo>\u2208</mo><mi>D</mi></mrow></munder></mstyle><mrow><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>k</mi><mi>G</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mo>\u22c5</mo><mo>,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>-</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>x</mi><mo>\u2208</mo><mi>D</mi></mrow></munder></mstyle><mrow><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>k</mi><mi>G</mi></msub><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">(</mo><mo>\u22c5</mo><mo>,</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><msub><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\cH</mtext></merror><msub><mi>k</mi><mi>G</mi></msub></msub></msub></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex48.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle~{}~{}~{}+\\norm{\\sum_{x\\in D}w(x)k_{G}(\\cdot,\\gamma(x))-\\sum_{x%&#10;\\in D}w(\\gamma(x))k_{G}(\\cdot,\\gamma(x))}_{\\cH_{k_{G}}}+\\norm{\\sum_{y\\in E^{%&#10;\\prime}}w(y)k_{G}(\\cdot,y)}_{\\cH_{k_{G}}}\" display=\"inline\"><mrow><mrow><mrow><mpadded width=\"+6.6pt\"><mi mathvariant=\"normal\">\u00a0</mi></mpadded><mo>+</mo><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>x</mi><mo>\u2208</mo><mi>D</mi></mrow></munder></mstyle><mrow><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>k</mi><mi>G</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mo>\u22c5</mo><mo>,</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow><mo>-</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>x</mi><mo>\u2208</mo><mi>D</mi></mrow></munder></mstyle><mrow><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>k</mi><mi>G</mi></msub><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">(</mo><mo>\u22c5</mo><mo>,</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><msub><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\cH</mtext></merror><msub><mi>k</mi><mi>G</mi></msub></msub></msub></mrow></mrow></mrow><mo>+</mo><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>y</mi><mo>\u2208</mo><msup><mi>E</mi><mo>\u2032</mo></msup></mrow></munder></mstyle><mrow><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>k</mi><mi>G</mi></msub><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">(</mo><mo>\u22c5</mo><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><msub><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\cH</mtext></merror><msub><mi>k</mi><mi>G</mi></msub></msub></msub></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex49.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\leq\\sum_{x\\in D}w(x)\\norm{k_{G}(\\cdot,x)-k_{G}(\\cdot,\\gamma(x))}%&#10;_{\\cH_{k_{G}}}+\\sum_{x\\in D}\\abs{w(x)-w(\\gamma(x))}\\norm{k_{G}(\\cdot,\\gamma(x)%&#10;)}_{\\cH_{k_{G}}}\" display=\"inline\"><mrow><mi/><mo>\u2264</mo><mrow><mrow><mrow><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>x</mi><mo>\u2208</mo><mi>D</mi></mrow></munder></mstyle><mrow><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><msub><mi>k</mi><mi>G</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mo>\u22c5</mo><mo>,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>-</mo><mrow><msub><mi>k</mi><mi>G</mi></msub><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">(</mo><mo>\u22c5</mo><mo>,</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><msub><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\cH</mtext></merror><msub><mi>k</mi><mi>G</mi></msub></msub></msub></mrow></mrow><mo>+</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>x</mi><mo>\u2208</mo><mi>D</mi></mrow></munder></mstyle><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\abs</mtext></merror><mo>\u2062</mo><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>-</mo><mrow><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><msub><mi>k</mi><mi>G</mi></msub><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">(</mo><mo>\u22c5</mo><mo>,</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><msub><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\cH</mtext></merror><msub><mi>k</mi><mi>G</mi></msub></msub></msub></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle~{}~{}+\\sum_{y\\in E^{\\prime}}w(y)\\norm{k_{G}(\\cdot,y)}_{\\cH_{k_{G%&#10;}}}\" display=\"inline\"><mrow><mpadded width=\"+3.3pt\"><mi mathvariant=\"normal\">\u00a0</mi></mpadded><mo>+</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>y</mi><mo>\u2208</mo><msup><mi>E</mi><mo>\u2032</mo></msup></mrow></munder></mstyle><mrow><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><msub><mi>k</mi><mi>G</mi></msub><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">(</mo><mo>\u22c5</mo><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><msub><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\cH</mtext></merror><msub><mi>k</mi><mi>G</mi></msub></msub></msub></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\nfrom Lemma \\ref{lemm:w_continuous}, \n", "itemtype": "equation", "pos": 55179, "prevtext": "\nForm Lemma \\ref{lemm:Lip_k}, we have\n", "index": 63, "text": "\n\\[\n\\norm{k_{G}(\\cdot,x)-k_{G}(\\cdot,\\gamma(x))}_{\\cH_{k_{G}}} \\leq \\frac{\\sqrt{2}}{\\sigma} \\norm{x-\\gamma(x)}_{\\infty},\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex50.m1\" class=\"ltx_Math\" alttext=\"\\norm{k_{G}(\\cdot,x)-k_{G}(\\cdot,\\gamma(x))}_{\\cH_{k_{G}}}\\leq\\frac{\\sqrt{2}}{%&#10;\\sigma}\\norm{x-\\gamma(x)}_{\\infty},\" display=\"block\"><mrow><mrow><mrow><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><msub><mi>k</mi><mi>G</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mo>\u22c5</mo><mo>,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><msub><mi>k</mi><mi>G</mi></msub><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">(</mo><mo>\u22c5</mo><mo>,</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><msub><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\cH</mtext></merror><msub><mi>k</mi><mi>G</mi></msub></msub></msub></mrow></mrow><mo>\u2264</mo><mrow><mrow><mfrac><msqrt><mn>2</mn></msqrt><mi>\u03c3</mi></mfrac><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><mi>x</mi></mrow><mo>-</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mi mathvariant=\"normal\">\u221e</mi></msub></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\nMoreover, for any $x \\in \\lR^{2}$ we have $\\norm{k_{G}(\\cdot,x)}_{\\cH_{k_{G}}}=\\sqrt{k_{G}(x,x)}=1$.\nTherefore, the continuation of \\eqref{eq:dk_halfway} is\n\n", "itemtype": "equation", "pos": 55339, "prevtext": "\nfrom Lemma \\ref{lemm:w_continuous}, \n", "index": 65, "text": "\n\\[\n\\abs{w(x)-w(\\gamma(x))} \\leq 2pC \\max \\{{\\rm pers}(x)^{p-1}, {\\rm pers}(\\gamma(x))^{p-1}\\} \\norm{x-\\gamma(x)}_{\\infty}.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex51.m1\" class=\"ltx_Math\" alttext=\"\\abs{w(x)-w(\\gamma(x))}\\leq 2pC\\max\\{{\\rm pers}(x)^{p-1},{\\rm pers}(\\gamma(x))%&#10;^{p-1}\\}\\norm{x-\\gamma(x)}_{\\infty}.\" display=\"block\"><mrow><mrow><mrow><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\abs</mtext></merror><mo>\u2062</mo><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>\u2264</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>p</mi><mo>\u2062</mo><mi>C</mi><mo>\u2062</mo><mrow><mi>max</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mi>pers</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow><mo>,</mo><mrow><mi>pers</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><mi>x</mi></mrow><mo>-</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mi mathvariant=\"normal\">\u221e</mi></msub></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\nWe have used the fact ${\\rm pers}(y) \\leq {\\varepsilon} \\ ( y \\in E')$ in \\eqref{eq:pers_ee} and ${\\rm Pers}_{p-1}(\\gamma(D)),{\\rm Pers}_{p-1}(E') \\leq {\\rm Pers}_{p-1}(E)$ in \\eqref{eq:total_last}.\nThus, if both $(p-1)$-degree total persistence of $D$ and that of $E$ are bounded, since $p$-degree total persistence of $D$ is also bounded from Proposition \\ref{prop:persistence_inequality}, the coefficient of ${\\varepsilon}$ appearing in \\eqref{eq:total_last} is bounded.\n \n\\begin{proof}[Proof of Theorem \\ref{kfunc_stability}]\nFrom Lemma \\ref{total}, for any Lipschitz function $f:M {\\rightarrow} \\lR$, there exists a constant $C_{M}>0$ such that \n", "itemtype": "equation", "pos": 55623, "prevtext": "\nMoreover, for any $x \\in \\lR^{2}$ we have $\\norm{k_{G}(\\cdot,x)}_{\\cH_{k_{G}}}=\\sqrt{k_{G}(x,x)}=1$.\nTherefore, the continuation of \\eqref{eq:dk_halfway} is\n\n", "index": 67, "text": "\\begin{align}\n& ~~\\sum_{x \\in D} w(x) \\frac{\\sqrt{2}}{\\sigma} \\norm{x-\\gamma(x)}_{\\infty} \\nonumber \\\\\n& ~~~ + \\sum_{x \\in D} 2pC \\max \\{{\\rm pers}(x)^{p-1}, {\\rm pers}(\\gamma(x))^{p-1}\\} \\norm{x-\\gamma(x)}_{\\infty}  + \\sum_{y \\in E'} w(y) \\nonumber \\\\\n& \\leq  \\frac{\\sqrt{2}}{\\sigma} C {\\varepsilon} \\sum_{x \\in D} {\\rm pers}(x)^{p}+ 2pC {\\varepsilon} \\sum_{x \\in D}  \\pare{{\\rm pers}(x)^{p-1}+{\\rm pers}(\\gamma(x))^{p-1} }  +C \\sum_{y \\in E'} {\\rm pers}(y)^{p} \\nonumber \\\\\n& \\leq  \\frac{\\sqrt{2}}{\\sigma} C {\\varepsilon} \\sum_{x \\in D} {\\rm pers}(x)^{p}+ 2pC {\\varepsilon} \\sum_{x \\in D}  \\pare{{\\rm pers}(x)^{p-1}+{\\rm pers}(\\gamma(x))^{p-1} }  +C {\\varepsilon} \\sum_{y \\in E'} {\\rm pers}(y)^{p-1} \\label{eq:pers_ee} \\\\\n& = \\rl{ \\frac{\\sqrt{2}}{\\sigma} {\\rm Pers}_{p}(D)+ 2p\\pare{{\\rm Pers}_{p-1}(D)+{\\rm Pers}_{p-1}(\\gamma(D)) }  +{\\rm Pers}_{p-1}(E') } C {\\varepsilon} \\\\\n&= \\rl{ \\frac{\\sqrt{2}}{\\sigma} {\\rm Pers}_{p}(D)+ 2p{\\rm Pers}_{p-1}(D)+(2p+1){\\rm Pers}_{p-1}(E)  } C {\\varepsilon} \\label{eq:total_last}.\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex52.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle~{}~{}\\sum_{x\\in D}w(x)\\frac{\\sqrt{2}}{\\sigma}\\norm{x-\\gamma(x)}_%&#10;{\\infty}\" display=\"inline\"><mrow><mrow><mpadded width=\"+3.3pt\"><mi mathvariant=\"normal\">\u00a0</mi></mpadded><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>x</mi><mo>\u2208</mo><mi>D</mi></mrow></munder></mstyle><mrow><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mstyle displaystyle=\"true\"><mfrac><msqrt><mn>2</mn></msqrt><mi>\u03c3</mi></mfrac></mstyle><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><mi>x</mi></mrow></mrow></mrow><mo>-</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mi mathvariant=\"normal\">\u221e</mi></msub></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex53.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle~{}~{}~{}+\\sum_{x\\in D}2pC\\max\\{{\\rm pers}(x)^{p-1},{\\rm pers}(%&#10;\\gamma(x))^{p-1}\\}\\norm{x-\\gamma(x)}_{\\infty}+\\sum_{y\\in E^{\\prime}}w(y)\" display=\"inline\"><mrow><mrow><mrow><mpadded width=\"+6.6pt\"><mi mathvariant=\"normal\">\u00a0</mi></mpadded><mo>+</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>x</mi><mo>\u2208</mo><mi>D</mi></mrow></munder></mstyle><mrow><mn>2</mn><mo>\u2062</mo><mi>p</mi><mo>\u2062</mo><mi>C</mi><mo>\u2062</mo><mrow><mi>max</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mi>pers</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow><mo>,</mo><mrow><mi>pers</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\norm</mtext></merror><mo>\u2062</mo><mi>x</mi></mrow></mrow></mrow><mo>-</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mi mathvariant=\"normal\">\u221e</mi></msub></mrow></mrow><mo>+</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>y</mi><mo>\u2208</mo><msup><mi>E</mi><mo>\u2032</mo></msup></mrow></munder></mstyle><mrow><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex54.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\leq\\frac{\\sqrt{2}}{\\sigma}C{\\varepsilon}\\sum_{x\\in D}{\\rm pers}(%&#10;x)^{p}+2pC{\\varepsilon}\\sum_{x\\in D}\\pare{{\\rm pers}(x)^{p-1}+{\\rm pers}(%&#10;\\gamma(x))^{p-1}}+C\\sum_{y\\in E^{\\prime}}{\\rm pers}(y)^{p}\" display=\"inline\"><mrow><mi/><mo>\u2264</mo><mrow><mrow><mstyle displaystyle=\"true\"><mfrac><msqrt><mn>2</mn></msqrt><mi>\u03c3</mi></mfrac></mstyle><mo>\u2062</mo><mi>C</mi><mo>\u2062</mo><mi>\u03b5</mi><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>x</mi><mo>\u2208</mo><mi>D</mi></mrow></munder></mstyle><mrow><mi>pers</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mi>p</mi></msup></mrow></mrow></mrow><mo>+</mo><mrow><mn>2</mn><mo>\u2062</mo><mi>p</mi><mo>\u2062</mo><mi>C</mi><mo>\u2062</mo><mi>\u03b5</mi><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>x</mi><mo>\u2208</mo><mi>D</mi></mrow></munder></mstyle><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\pare</mtext></merror><mo>\u2062</mo><mi>pers</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow></mrow></mrow><mo>+</mo><mrow><mi>pers</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow><mo>+</mo><mrow><mi>C</mi><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>y</mi><mo>\u2208</mo><msup><mi>E</mi><mo>\u2032</mo></msup></mrow></munder></mstyle><mrow><mi>pers</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><mi>p</mi></msup></mrow></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\leq\\frac{\\sqrt{2}}{\\sigma}C{\\varepsilon}\\sum_{x\\in D}{\\rm pers}(%&#10;x)^{p}+2pC{\\varepsilon}\\sum_{x\\in D}\\pare{{\\rm pers}(x)^{p-1}+{\\rm pers}(%&#10;\\gamma(x))^{p-1}}+C{\\varepsilon}\\sum_{y\\in E^{\\prime}}{\\rm pers}(y)^{p-1}\" display=\"inline\"><mrow><mi/><mo>\u2264</mo><mrow><mrow><mstyle displaystyle=\"true\"><mfrac><msqrt><mn>2</mn></msqrt><mi>\u03c3</mi></mfrac></mstyle><mo>\u2062</mo><mi>C</mi><mo>\u2062</mo><mi>\u03b5</mi><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>x</mi><mo>\u2208</mo><mi>D</mi></mrow></munder></mstyle><mrow><mi>pers</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mi>p</mi></msup></mrow></mrow></mrow><mo>+</mo><mrow><mn>2</mn><mo>\u2062</mo><mi>p</mi><mo>\u2062</mo><mi>C</mi><mo>\u2062</mo><mi>\u03b5</mi><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>x</mi><mo>\u2208</mo><mi>D</mi></mrow></munder></mstyle><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\pare</mtext></merror><mo>\u2062</mo><mi>pers</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow></mrow></mrow><mo>+</mo><mrow><mi>pers</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow><mo>+</mo><mrow><mi>C</mi><mo>\u2062</mo><mi>\u03b5</mi><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>y</mi><mo>\u2208</mo><msup><mi>E</mi><mo>\u2032</mo></msup></mrow></munder></mstyle><mrow><mi>pers</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\rl{\\frac{\\sqrt{2}}{\\sigma}{\\rm Pers}_{p}(D)+2p\\pare{{\\rm Pers}_%&#10;{p-1}(D)+{\\rm Pers}_{p-1}(\\gamma(D))}+{\\rm Pers}_{p-1}(E^{\\prime})}C{\\varepsilon}\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\rl</mtext></merror><mo>\u2062</mo><mstyle displaystyle=\"true\"><mfrac><msqrt><mn>2</mn></msqrt><mi>\u03c3</mi></mfrac></mstyle><mo>\u2062</mo><msub><mi>Pers</mi><mi>p</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>D</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mn>2</mn><mo>\u2062</mo><mi>p</mi><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\pare</mtext></merror><mo>\u2062</mo><msub><mi>Pers</mi><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>D</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><msub><mi>Pers</mi><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>D</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><msub><mi>Pers</mi><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>E</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>C</mi><mo>\u2062</mo><mi>\u03b5</mi></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E10.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\rl{\\frac{\\sqrt{2}}{\\sigma}{\\rm Pers}_{p}(D)+2p{\\rm Pers}_{p-1}(%&#10;D)+(2p+1){\\rm Pers}_{p-1}(E)}C{\\varepsilon}.\" display=\"inline\"><mrow><mrow><mi/><mo>=</mo><mrow><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\rl</mtext></merror><mo>\u2062</mo><mstyle displaystyle=\"true\"><mfrac><msqrt><mn>2</mn></msqrt><mi>\u03c3</mi></mfrac></mstyle><mo>\u2062</mo><msub><mi>Pers</mi><mi>p</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>D</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mn>2</mn><mo>\u2062</mo><mi>p</mi><mo>\u2062</mo><msub><mi>Pers</mi><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>D</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>p</mi></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>Pers</mi><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>E</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>C</mi><mo>\u2062</mo><mi>\u03b5</mi></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\nSince $M$ is compact, ${\\rm Amp}(f)$ is bounded, and hence ${\\rm Pers}_{p-1}(f)$ is bounded.\nReplacing $D$ and $E$ with $D_{q}(f)$ and $D_{q}(g)$ in \\eqref{eq:total_last}, respectively, we have \n", "itemtype": "equation", "pos": 57304, "prevtext": "\nWe have used the fact ${\\rm pers}(y) \\leq {\\varepsilon} \\ ( y \\in E')$ in \\eqref{eq:pers_ee} and ${\\rm Pers}_{p-1}(\\gamma(D)),{\\rm Pers}_{p-1}(E') \\leq {\\rm Pers}_{p-1}(E)$ in \\eqref{eq:total_last}.\nThus, if both $(p-1)$-degree total persistence of $D$ and that of $E$ are bounded, since $p$-degree total persistence of $D$ is also bounded from Proposition \\ref{prop:persistence_inequality}, the coefficient of ${\\varepsilon}$ appearing in \\eqref{eq:total_last} is bounded.\n \n\\begin{proof}[Proof of Theorem \\ref{kfunc_stability}]\nFrom Lemma \\ref{total}, for any Lipschitz function $f:M {\\rightarrow} \\lR$, there exists a constant $C_{M}>0$ such that \n", "index": 69, "text": "\n\\[\n{\\rm Pers}_{p-1}(f) \\leq \\frac{p-1}{p-1-d}C_{M} {\\rm Lip}(f)^{d} {\\rm Amp}(f)^{p-1-d}.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex55.m1\" class=\"ltx_Math\" alttext=\"{\\rm Pers}_{p-1}(f)\\leq\\frac{p-1}{p-1-d}C_{M}{\\rm Lip}(f)^{d}{\\rm Amp}(f)^{p-1%&#10;-d}.\" display=\"block\"><mrow><mrow><mrow><msub><mi>Pers</mi><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2264</mo><mrow><mfrac><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow><mrow><mi>p</mi><mo>-</mo><mn>1</mn><mo>-</mo><mi>d</mi></mrow></mfrac><mo>\u2062</mo><msub><mi>C</mi><mi>M</mi></msub><mo>\u2062</mo><mi>Lip</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow><mi>d</mi></msup><mo>\u2062</mo><mi>Amp</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>p</mi><mo>-</mo><mn>1</mn><mo>-</mo><mi>d</mi></mrow></msup></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\n\\end{proof}\n\n\n\\begin{proof}[Proof of Theorem \\ref{kpoint_stability}]\nFor any point set $X \\subset M$, from Lemma \\ref{point_total}, there exists a constant $C_{M}>0$ such that\n", "itemtype": "equation", "pos": 57592, "prevtext": "\nSince $M$ is compact, ${\\rm Amp}(f)$ is bounded, and hence ${\\rm Pers}_{p-1}(f)$ is bounded.\nReplacing $D$ and $E$ with $D_{q}(f)$ and $D_{q}(g)$ in \\eqref{eq:total_last}, respectively, we have \n", "index": 71, "text": "\n\\[\nL(f,g;C,p,\\sigma) = \\rl{ \\frac{\\sqrt{2}}{\\sigma} {\\rm Pers}_{p}(f)+ 2p{\\rm Pers}_{p-1}(f)+(2p+1){\\rm Pers}_{p-1}(g)  } C.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex56.m1\" class=\"ltx_Math\" alttext=\"L(f,g;C,p,\\sigma)=\\rl{\\frac{\\sqrt{2}}{\\sigma}{\\rm Pers}_{p}(f)+2p{\\rm Pers}_{p%&#10;-1}(f)+(2p+1){\\rm Pers}_{p-1}(g)}C.\" display=\"block\"><mrow><mrow><mrow><mi>L</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo>,</mo><mi>g</mi><mo>;</mo><mi>C</mi><mo>,</mo><mi>p</mi><mo>,</mo><mi>\u03c3</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\rl</mtext></merror><mo>\u2062</mo><mfrac><msqrt><mn>2</mn></msqrt><mi>\u03c3</mi></mfrac><mo>\u2062</mo><msub><mi>Pers</mi><mi>p</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mn>2</mn><mo>\u2062</mo><mi>p</mi><mo>\u2062</mo><msub><mi>Pers</mi><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>p</mi></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>Pers</mi><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>g</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>C</mi></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\nThus, we have the continuation of \\eqref{eq:total_last} as follows:\n\n", "itemtype": "equation", "pos": 57896, "prevtext": "\n\\end{proof}\n\n\n\\begin{proof}[Proof of Theorem \\ref{kpoint_stability}]\nFor any point set $X \\subset M$, from Lemma \\ref{point_total}, there exists a constant $C_{M}>0$ such that\n", "index": 73, "text": "\n\\[\n{\\rm Pers}_{p}(D_{q}(X)) \\leq \\frac{p}{p-d} C_{M}{\\rm diam}(M)^{p-d}.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex57.m1\" class=\"ltx_Math\" alttext=\"{\\rm Pers}_{p}(D_{q}(X))\\leq\\frac{p}{p-d}C_{M}{\\rm diam}(M)^{p-d}.\" display=\"block\"><mrow><mrow><mrow><msub><mi>Pers</mi><mi>p</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>D</mi><mi>q</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2264</mo><mrow><mfrac><mi>p</mi><mrow><mi>p</mi><mo>-</mo><mi>d</mi></mrow></mfrac><mo>\u2062</mo><msub><mi>C</mi><mi>M</mi></msub><mo>\u2062</mo><mi>diam</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>M</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>p</mi><mo>-</mo><mi>d</mi></mrow></msup></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01741.tex", "nexttext": "\nThis value is a constant dependent on $M,d,C,p,\\sigma$ but independent of $X,Y$.\n\\end{proof}\n\n\n\n", "itemtype": "equation", "pos": 58041, "prevtext": "\nThus, we have the continuation of \\eqref{eq:total_last} as follows:\n\n", "index": 75, "text": "\\begin{align*}\n& \\frac{\\sqrt{2}}{\\sigma} {\\rm Pers}_{p}(D_{q}(X))+ 2p {\\rm Pers}_{p-1}(D_{q}(X))+(2p+1){\\rm Pers}_{p-1}(D_{q}(Y))  \\\\\n& \\leq \\frac{\\sqrt{2}}{\\sigma} \\frac{p}{p-d} C_{M}{\\rm diam}(M)^{p-d}+ (4p+1) \\frac{p-1}{p-1-d} C_{M}{\\rm diam}(M)^{p-1-d} \\\\\n& = L(M,d;C,p,\\sigma).\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex58.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\frac{\\sqrt{2}}{\\sigma}{\\rm Pers}_{p}(D_{q}(X))+2p{\\rm Pers}_{p-1%&#10;}(D_{q}(X))+(2p+1){\\rm Pers}_{p-1}(D_{q}(Y))\" display=\"inline\"><mrow><mrow><mstyle displaystyle=\"true\"><mfrac><msqrt><mn>2</mn></msqrt><mi>\u03c3</mi></mfrac></mstyle><mo>\u2062</mo><msub><mi>Pers</mi><mi>p</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>D</mi><mi>q</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mn>2</mn><mo>\u2062</mo><mi>p</mi><mo>\u2062</mo><msub><mi>Pers</mi><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>D</mi><mi>q</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>p</mi></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>Pers</mi><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>D</mi><mi>q</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex59.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\leq\\frac{\\sqrt{2}}{\\sigma}\\frac{p}{p-d}C_{M}{\\rm diam}(M)^{p-d}+%&#10;(4p+1)\\frac{p-1}{p-1-d}C_{M}{\\rm diam}(M)^{p-1-d}\" display=\"inline\"><mrow><mi/><mo>\u2264</mo><mrow><mrow><mstyle displaystyle=\"true\"><mfrac><msqrt><mn>2</mn></msqrt><mi>\u03c3</mi></mfrac></mstyle><mo>\u2062</mo><mstyle displaystyle=\"true\"><mfrac><mi>p</mi><mrow><mi>p</mi><mo>-</mo><mi>d</mi></mrow></mfrac></mstyle><mo>\u2062</mo><msub><mi>C</mi><mi>M</mi></msub><mo>\u2062</mo><mi>diam</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>M</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>p</mi><mo>-</mo><mi>d</mi></mrow></msup></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mn>4</mn><mo>\u2062</mo><mi>p</mi></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mstyle displaystyle=\"true\"><mfrac><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow><mrow><mi>p</mi><mo>-</mo><mn>1</mn><mo>-</mo><mi>d</mi></mrow></mfrac></mstyle><mo>\u2062</mo><msub><mi>C</mi><mi>M</mi></msub><mo>\u2062</mo><mi>diam</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>M</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>p</mi><mo>-</mo><mn>1</mn><mo>-</mo><mi>d</mi></mrow></msup></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex60.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle=L(M,d;C,p,\\sigma).\" display=\"inline\"><mrow><mrow><mi/><mo>=</mo><mrow><mi>L</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>M</mi><mo>,</mo><mi>d</mi><mo>;</mo><mi>C</mi><mo>,</mo><mi>p</mi><mo>,</mo><mi>\u03c3</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}]