[{"file": "1601.02832.tex", "nexttext": "\nwhich can be translated to a set of SDEs~\\cite{Gardiner1989,kopp}. \\(f\\) is the particle phase space distribution function,\n\\(\\kappa\\) the diffusion tensor, \\(\\mathbf{V}\\) the solar wind\nvelocity, \\(\\mathbf{V}_D\\) the particle drift velocity in the\nheliospheric magnetic field and \\(p\\) the particle momentum. The concrete form of the diffusion tensor \\(\\kappa\\), the solar wind \\(\\mathbf{V}\\) and drift effects at the magnetic field irregularities \\(\\mathbf{V}_D\\) are model dependent.\nThe corresponding SDEs can be written as\n\n", "itemtype": "equation", "pos": 3275, "prevtext": "\n\n\\newenvironment{code}{\n\\setlength{\\parskip}{2mm}\n\\setlength{\\parindent}{0pt}\n\\ttfamily\\par\n}\n{\\[2mm]}\n\n\\title{Charge-sign dependent solar modulation for everyone}\n\n\\author{Rolf Kappl}\n\n\\address{Bethe Center for Theoretical Physics\nand\nPhysikalisches Institut der Universit\\\"at Bonn\nNussallee 12, 53115 Bonn, Germany}\n\n\\ead{kappl@th.physik.uni-bonn.de}\n\n\\begin{abstract}\nWe present a tool to compute the influence of\ncharge-sign dependent solar modulation for cosmic ray\nspectra. The code is publicly available, easy to use and offers an extended \nview on solar modulation compared to the force-field approximation. \nWe present some examples for proton and antiproton fluxes in the light\nof recent experimental data.\n\\end{abstract}\n\n\\section{Introduction}\n\nThe influence of the heliosphere on the strength of galactic cosmic rays has been studied intensively in the past. Its time dependence follows a 22-year cycle with a polarity reversal of the solar magnetic field after approximately every 11 years. The influence on cosmic rays is called solar modulation. A detailed understanding of this effect is necessary from a particle physicists point of view because indirect dark matter detection is often based on cosmic ray fluxes. If some part of the observed cosmic rays at earth originates from the annihilation or decay of dark matter it has also been influenced by solar modulation. Moreover it is important to be able to discriminate a possible dark matter contribution from the effect of the heliosphere on cosmic rays. \n\nInterestingly, solar modulation is important for energies around a few GeV, the energy scale where the observed antiproton spectrum has its peak. Antiprotons are potentially interesting for indirect dark matter detection as the astrophysical background is very low.\nA well known approximation to account for solar modulation is the so-called force-field method~\\cite{Gleeson:1968zza}. This approximation is very accurate, but is charge-sign independent. It further depends on one free time dependent parameter, the so-called Fisk potential \\(\\phi\\). A common approach is to assume a given local interstellar proton flux and to take the observed proton flux at earth to fit this free parameter. \nIt can afterwards be used to predict the influence of solar modulation on the antiproton flux. The drawback is of course, that all charge-sign dependent influences are neglected with this approach. In an extreme case, one could image that the effect of solar modulation on antiprotons is much larger than for protons and thus compensates a possible additional antiproton contribution from dark matter. \n\nTo exclude such a possibility, more detailed models of solar modulation including charge-sign dependent effects have to be applied. Such models have been studied in the literature and are based on Fokker-Planck equations taking also drift effects into account. \nIn contrast to the force-field approximation, these equations can only be solved numerically. We have developed a public tool called \\texttt{SOLARPROP}~\\cite{solarprop,Kappl:2015hxv}, which is able to solve the corresponding stochastic differential equations (SDEs) for different solar modulation models. \nThe starting point is the Fokker-Planck equation\n~\\cite{Parker19659, parker}\n\n", "index": 1, "text": "\\begin{equation}\n\\frac{\\partial f}{\\partial t} = \\nabla\\cdot (\\kappa\\cdot \\nabla f) -\n(\\mathbf{V}+\\mathbf{V}_D)\\cdot \\nabla f+\\frac{1}{3}(\\nabla\\cdot\n\\mathbf{V}) \\frac{\\partial f}{\\partial\\ln p}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"\\frac{\\partial f}{\\partial t}=\\nabla\\cdot(\\kappa\\cdot\\nabla f)-(\\mathbf{V}+%&#10;\\mathbf{V}_{D})\\cdot\\nabla f+\\frac{1}{3}(\\nabla\\cdot\\mathbf{V})\\frac{\\partial f%&#10;}{\\partial\\ln p}\" display=\"block\"><mrow><mfrac><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>f</mi></mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mrow><mrow><mrow><mo>\u2207</mo><mo>\u22c5</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03ba</mi><mo>\u22c5</mo><mrow><mo>\u2207</mo><mo>\u2061</mo><mi>f</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc15</mi><mo>+</mo><msub><mi>\ud835\udc15</mi><mi>D</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u22c5</mo><mrow><mo>\u2207</mo><mo>\u2061</mo><mi>f</mi></mrow></mrow></mrow><mo>+</mo><mrow><mfrac><mn>1</mn><mn>3</mn></mfrac><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo>\u2207</mo><mo>\u22c5</mo><mi>\ud835\udc15</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mfrac><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>f</mi></mrow><mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>ln</mi></mrow><mo>\u2061</mo><mi>p</mi></mrow></mfrac></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.02832.tex", "nexttext": "\nwhere \\(x_i\\) are some coordinates of pseudo-particles, \\(t\\) is the time, \\(A_i\\) is a drift and\n\\(B_{ij}\\) a diffusion term. \\(W_j\\) is a Wiener process which can be related to a Gaussian \ndistribution \\(dw_j\\) with mean zero and standard deviation of one \\(N(0,1)\\) by \\(dW_j=\\sqrt{dt}dw_j\\).\n\nThe desired particle phase space distribution \\(f\\) is now obtained by solving the SDEs for a large sample of pseudo-particles. The SDEs for a simple one dimensional example are given by~\\cite{yamada}\n\n", "itemtype": "equation", "pos": 4013, "prevtext": "\nwhich can be translated to a set of SDEs~\\cite{Gardiner1989,kopp}. \\(f\\) is the particle phase space distribution function,\n\\(\\kappa\\) the diffusion tensor, \\(\\mathbf{V}\\) the solar wind\nvelocity, \\(\\mathbf{V}_D\\) the particle drift velocity in the\nheliospheric magnetic field and \\(p\\) the particle momentum. The concrete form of the diffusion tensor \\(\\kappa\\), the solar wind \\(\\mathbf{V}\\) and drift effects at the magnetic field irregularities \\(\\mathbf{V}_D\\) are model dependent.\nThe corresponding SDEs can be written as\n\n", "index": 3, "text": "\\begin{equation}\ndx_i=A_i(x_i)dt+\\sum_jB_{ij}(x_i)dW_j\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"dx_{i}=A_{i}(x_{i})dt+\\sum_{j}B_{ij}(x_{i})dW_{j}\" display=\"block\"><mrow><mrow><mi>d</mi><mo>\u2062</mo><msub><mi>x</mi><mi>i</mi></msub></mrow><mo>=</mo><mrow><mrow><msub><mi>A</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>d</mi><mo>\u2062</mo><mi>t</mi></mrow><mo>+</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mi>j</mi></munder><mrow><msub><mi>B</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>d</mi><mo>\u2062</mo><msub><mi>W</mi><mi>j</mi></msub></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.02832.tex", "nexttext": "\nwith radial coordinate \\(r\\), particle mass \\(m\\) and kinetic energy \\(T\\). \\(V\\) labels a constant solar wind and \\(\\kappa_{rr}=\\kappa_0\\beta\\mathcal{R}\\) is the energy dependent diffusion constant. \\(\\kappa_0\\) is a normalization constant, \\(\\beta\\) the particle speed and \\(\\mathcal{R}\\) its rigidity. Drift effects are not present in this model.\n\nSDEs are well suited for numerical approaches. The equations are already discrete and parallelization is easily possible as the equations have to be solved for many pseudo-particles to find a reasonable result. The random number generation necessary for the Wiener process is a well studied problem and known library solutions can be used.\n\nWe have established a tool to compute solutions to these kind of SDEs called \\texttt{SOLARPROP}~\\cite{solarprop,Kappl:2015hxv} which we will present in the next section.\n\n\\section{Solar Modulation with \\texttt{SOLARPROP}}\n\nTwo typical pseudo-particle trajectories for protons computed with \\texttt{SOLARPROP} are displayed in figure \\ref{fig:trajectory}.\n\\begin{figure}[htb]\n\\centering\n\\includegraphics[width=10.0cm]{trajectory.pdf}\n\\caption{Two characteristic pseudo-particle trajectories for protons, one for positive solar magnetic polarity \\(A > 0\\) and one for negative solar magnetic field polarity \\(A < 0\\) computed with \\texttt{SOLARPROP}. The particles have been propagated backward in time from the position of the earth at 1 AU to the boundary of the heliosphere assumed to be at 100 AU.}\n\\label{fig:trajectory}\n\\end{figure}\nThe heliosphere with boundary at 100 AU is shown. The heliospheric current sheet (HCS) separates the northern from the southern region where the magnetic field has opposite magnetic polarity \\(A\\). It is expected to be wavy, where the waviness is described by the time dependent tilt angle \\(\\alpha\\). In the scenario depicted in figure \\ref{fig:trajectory}, the waviness of the HCS is \\(\\alpha = 5^\\circ\\) (see~\\cite{lrsp-2013-3} for a detailed review). The displayed trajectories for protons in figure \\ref{fig:trajectory} have an initial energy of 0.81 GeV at earth and have been traced backward in time until they reached the boundary of the heliosphere. For positive polarity \\(A>0\\) protons drift mainly towards the poles, whereas for negative polarity \\(A<0\\) protons move in the direction of the HCS. This qualitative behavior is in agreement with results from the literature~\\cite{strauss}.\n\nTo ensure that our numerical approach is also quantitatively correct, we checked it against results from the literature. Several reference models are implemented for this purpose in \\texttt{SOLARPROP}. \nIn figure \\ref{fig:jokipii} a two dimensional model without tilt angle dependence (flat HCS) is used. \n\nThe parameters chosen in figure \\ref{fig:jokipii} match the ones in table 1 and figure 2 of~\\cite{jokipii}. The model can be used in \\texttt{SOLARPROP} with parameter \\texttt{ref2}. The code is controlled by simple text files (see~\\cite{Kappl:2015hxv} for more information). For negative solar polarity \\(A<0\\) the file for \\texttt{SOLARPROP} to reproduce the figure is:\n\\begin{code}\nmodel ref2\\\\\nmass 0.938\\\\\ncharge 1\\\\\npolarity -1\n\\end{code}\n\\begin{figure}[htb]\n\\centering\n\\includegraphics[width=10.0cm]{jokipiiNew.pdf}\n\\caption{Validation of \\texttt{SOLARPROP} with the reference model \\texttt{ref2} from~\\cite{jokipii}. The displayed spectra correspond to protons. LIS labels the local interstellar spectrum and TOA the flux at the top of the atmosphere after solar modulation.}\n\\label{fig:jokipii}\n\\end{figure}\nIn addition to the reference models a more sophisticated model is also implemented. This model, called \\texttt{standard2D} is a two dimensional model with drift effects inspired by the model discussed in~\\cite{Bobik:2011ig}. In contrast to the force-field approximation no fit parameter is needed. Based on the date when the experiment under consideration took place, \\texttt{SOLARPROP} calculates the strength of diffusion and drift effects based on the measured neutron monitor data at earth and the tilt angle of the heliospheric magnetic field.\n\n\\section{Results for Protons and Antiprotons}\n\nThe result for solar modulation with \\texttt{SOLARPROP} is presented in figure \\ref{fig:besspolarp} for protons and in figure \\ref{fig:besspolarpbar} for antiprotons. Comparisons with different data sets from the BESS and BESS-Polar experiment for both cosmic ray species are displayed. The result is based on the model \\texttt{standard2D} and is independent of any fit parameters. It includes charge-sign dependent drift effects and is able to provide an accurate description of the data. The local interstellar proton flux is used from~\\cite{burger2000} (see also~\\cite{usoskin05}). This flux is potentially in tension with the recent Voyager 1 data~\\cite{voyager}. A detailed analysis of different local interstellar fluxes is nevertheless beyond the scope of this note. For antiprotons the propagation setup of~\\cite{Kappl:2015bqa} together with the production cross sections from~\\cite{Kappl:2014hha} has been used to calculate the secondary local interstellar antiproton flux. \n\n\\begin{figure}[htb]\n\\centering\n\\includegraphics[width=10.0cm]{pBESS.pdf}\n\\caption{Data for cosmic ray protons at different solar activities measured by BESS 97, BESS 2002~\\cite{Shikaze:2006je} and BESS-Polar I, BESS-Polar II~\\cite{Abe:2015mga} together with the result of \\texttt{SOLARPROP}. The local interstellar flux originates from~\\cite{burger2000}.}\n\\label{fig:besspolarp}\n\\end{figure}\n\n\\begin{figure}[htb]\n\\centering\n\\includegraphics[width=10.0cm]{pbarBESS.pdf}\n\\caption{Data for cosmic ray antiprotons at different solar activities measured by BESS 97, BESS 2002~\\cite{Orito:1999re,bess2002} and BESS-Polar I, BESS-Polar II~\\cite{Abe:2008sh,Abe:2011nx} together with the result of \\texttt{SOLARPROP}.}\n\\label{fig:besspolarpbar}\n\\end{figure}\n\n\\section{Conclusion}\n\nWe have presented several results of charge-sign dependent solar modulation. To provide a better estimation for solar modulation than the force-field approximation, charge-sign dependent drift effects have to be taken into account. This is especially necessary if one is interested in a possible dark matter origin of cosmic rays. Annihilating or decaying dark matter would manifest itself mainly in antimatter data, as there the known astrophysical background is lower. Solar modulation is due to the polarity dependence different for antimatter than for matter and a stronger effect for antimatter could potentially hide a dark matter component. \n\nWith \\texttt{SOLARPROP}, a freely available tool has been introduced for a detailed treatment of solar modulation for charged cosmic rays. We have shown the agreement with results from the literature and recent data of cosmic ray experiments. The time dependent computation of solar modulation is shown to be possible without any fit parameter if well measured data like the tilt angle of the heliospheric current sheet are used as input. This is another advantage compared to the force-field approximation, where the time dependent Fisk potential is a priori undetermined. \n\n\\section*{References}\n\\bibliography{kappl_CR}{}\n\\bibliographystyle{iopart-num}\n\n\n", "itemtype": "equation", "pos": 4581, "prevtext": "\nwhere \\(x_i\\) are some coordinates of pseudo-particles, \\(t\\) is the time, \\(A_i\\) is a drift and\n\\(B_{ij}\\) a diffusion term. \\(W_j\\) is a Wiener process which can be related to a Gaussian \ndistribution \\(dw_j\\) with mean zero and standard deviation of one \\(N(0,1)\\) by \\(dW_j=\\sqrt{dt}dw_j\\).\n\nThe desired particle phase space distribution \\(f\\) is now obtained by solving the SDEs for a large sample of pseudo-particles. The SDEs for a simple one dimensional example are given by~\\cite{yamada}\n\n", "index": 5, "text": "\\begin{align}\n\\Delta r &= \\left(- V + \\frac{2\\kappa_{rr}}{r}\\right)\\Delta t + \\sqrt{2\\kappa_{rr}\\Delta t}dw_r,\\\\\n\\Delta T &= \\frac{2V}{3r}\\frac{T^2+2Tm}{T+m}\\Delta t\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\Delta r\" display=\"inline\"><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><mi>r</mi></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\left(-V+\\frac{2\\kappa_{rr}}{r}\\right)\\Delta t+\\sqrt{2\\kappa_{rr%&#10;}\\Delta t}dw_{r},\" display=\"inline\"><mrow><mrow><mi/><mo>=</mo><mrow><mrow><mrow><mo>(</mo><mrow><mrow><mo>-</mo><mi>V</mi></mrow><mo>+</mo><mstyle displaystyle=\"true\"><mfrac><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>\u03ba</mi><mrow><mi>r</mi><mo>\u2062</mo><mi>r</mi></mrow></msub></mrow><mi>r</mi></mfrac></mstyle></mrow><mo>)</mo></mrow><mo>\u2062</mo><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><mi>t</mi></mrow><mo>+</mo><mrow><msqrt><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>\u03ba</mi><mrow><mi>r</mi><mo>\u2062</mo><mi>r</mi></mrow></msub><mo>\u2062</mo><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><mi>t</mi></mrow></msqrt><mo>\u2062</mo><mi>d</mi><mo>\u2062</mo><msub><mi>w</mi><mi>r</mi></msub></mrow></mrow></mrow><mo>,</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\Delta T\" display=\"inline\"><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><mi>T</mi></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\frac{2V}{3r}\\frac{T^{2}+2Tm}{T+m}\\Delta t\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mrow><mn>2</mn><mo>\u2062</mo><mi>V</mi></mrow><mrow><mn>3</mn><mo>\u2062</mo><mi>r</mi></mrow></mfrac></mstyle><mo>\u2062</mo><mstyle displaystyle=\"true\"><mfrac><mrow><msup><mi>T</mi><mn>2</mn></msup><mo>+</mo><mrow><mn>2</mn><mo>\u2062</mo><mi>T</mi><mo>\u2062</mo><mi>m</mi></mrow></mrow><mrow><mi>T</mi><mo>+</mo><mi>m</mi></mrow></mfrac></mstyle><mo>\u2062</mo><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><mi>t</mi></mrow></mrow></math>", "type": "latex"}]