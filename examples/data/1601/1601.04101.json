[{"file": "1601.04101.tex", "nexttext": "\nwhere $\\mathpzc{B}$ denotes the corresponding Born matrix element,\n$\\mathpzc{V}$ the UV-subtracted virtual contribution, $\\mathpzc{R}$ the real\ncontribution and $\\mathpzc{A}$ the subtraction term (the contribution from the\ncollinear counter term to subtract additional initial state collinear\nsingularities is hereby neglected). The subtractive matching formula can\ncorrespondingly be written in a condensed notation as shown in\neq.~(\\ref{eq:MCatNLO})\n\\begin{figure}[h]\n\\vspace{1.25cm}\n\n", "itemtype": "equation", "pos": 3886, "prevtext": "\n\n\\section{Introduction}\n\nThe new release of version 7 of the Herwig event generator~\\cite{Bellm:2015jjp}\nmarks the end of distinguishing Herwig++~\\cite{Bahr:2008pv,Bellm:2013lba} and\nHERWIG~\\cite{Corcella:2000bw} and the point at which the physics capabilities of both\nits predecessors (from the Herwig++ 2 series and the HERWIG 6 series) are\nsuperseded.\n\nHerwig is a computer program for the simulation of exclusive event generation\nin particle collisions at hadron-hadron, hadron-lepton, and lepton-lepton\ncolliders. It is written in the programming language C++ and based on ThePEG,\nwhich in the new version 2.0 is available for download along with Herwig 7.0 at\n\\href{https://herwig.hepforge.org/downloads}{https://herwig.hepforge.org/downloads}.\n\nHerwig features the full simulation of particle collision events up to the\nparticle level, i.e. perturbative as well as non-perturbative physics. The\nperturbative part provides the simulation of\nhard processes at NLO QCD (including several built-in LO and NLO matrix\nelements, LH event file input as well as the fully automated assembly of NLO\nQCD calculations for almost all Standard Model processes, utilizing various\ninterfaces to several external matrix element providers),\nshower Monte Carlos (facilitating two coherent shower algorithms - an\nangular-ordered parton shower~\\cite{Gieseke:2003rz} as well as a dipole\nshower~\\cite{Platzer:2009jq}, including the simulation of decays with full spin\ncorrelations),\nas well as the corresponding LO and NLO matching procedures (dedicated matrix\nelement corrected shower plug-ins and built-in Powheg matched cross sections,\nas well as a fully automated matching machinery, with algorithms based on\nMC@NLO-~\\cite{Frixione:2002ik} and Powheg-type~\\cite{Nason:2004rx} matching).\nThe non-perturbative part offers the simulation of\nthe hadronization process (utilizing the cluster hadronization model)\nas well as of the underlying event (utilizing an eikonal multiple interaction\nmodel).\nIn addition, Herwig features a highly flexible machinery for BSM\nprocesses (including built-in BSM matrix elements as well as UFO model input\ncapabilities).\n\n\\section{NLO Automatization and Matching}\n\nAutomated NLO matching and merging requires full control over the fixed-order\ninput and hence the need for a fully integrated framework arises. The\nprevioulsy developed Matchbox framework~\\cite{Platzer:2011bc} provides such\nfunctionality and its extension forms the basis for the automated NLO\ncapabilities of the new Herwig release.\n\nBased on the Matchbox framework the new Herwig release facilitates the\nautomated setup of all processes and ingredients necessary for a full NLO QCD\ncalculation in the subtraction formalism:\nan implementation of the dipole subtraction method based on the approach by\nCatani and Seymour (including massive dipole\nsubtraction)~\\cite{Catani:1996vz,Catani:2002hc},\nas well as interfaces to various external matrix element providers,\nor to in-house calculations for the hard sub-processes\nsuch as electroweak corrections to the production of heavy vector boson\npairs~\\cite{Bierweiler:2013dja,Bierweiler:2012kw,Gieseke:2014gka}\nor amplitudes for electroweak Higgs plus jets production provided by the\nHJets++ plug-in to Matchbox.\nFully automated matching algorithms are available, inspired by\nMC@NLO-~\\cite{Frixione:2002ik} and Powheg-type~\\cite{Nason:2004rx} matching (referred\nto as subtractive and multiplicative matching respectively), for the systematic\nand consistent combination of NLO QCD calculations with both shower variants in\nHerwig~\\cite{Gieseke:2003rz,Platzer:2009jq}.\n\nConsider the subtractive matching for example. An observable $O_\\mathrm{NLO}$\nat NLO QCD, whose leading order contribution for $n$ final state partons is\ngiven by $O_\\mathrm{LO} = \\int\\mathrm{d}\\Phi_n\\mathpzc{B}O_n$, can in a\ncondensed notation in the subtraction formalism be written as\n\n", "index": 1, "text": "\\begin{align}\nO_\\mathrm{NLO} =\n\\int\\mathrm{d}\\Phi_n \\Big(\\mathpzc{B}+\\bar{\\mathpzc{V}}\\Big)O_n +\n\\int\\mathrm{d}\\Phi_{n+1} \\Big(\\mathpzc{R}O_{n+1} - \\mathpzc{A}O_n\\Big)\n\\;\\;,\\quad\n\\bar{\\mathpzc{V}} = \\mathpzc{V}+\\int\\mathrm{d}\\Phi_1\\mathpzc{A} \n\\label{eq:ONLO}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle O_{\\mathrm{NLO}}=\\int\\mathrm{d}\\Phi_{n}\\Big{(}\\mathpzc{B}+\\bar{%&#10;\\mathpzc{V}}\\Big{)}O_{n}+\\int\\mathrm{d}\\Phi_{n+1}\\Big{(}\\mathpzc{R}O_{n+1}-%&#10;\\mathpzc{A}O_{n}\\Big{)}\\;\\;,\\quad\\bar{\\mathpzc{V}}=\\mathpzc{V}+\\int\\mathrm{d}%&#10;\\Phi_{1}\\mathpzc{A}\" display=\"inline\"><mrow><mrow><msub><mi>O</mi><mi>NLO</mi></msub><mo>=</mo><mrow><mstyle displaystyle=\"true\"><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mrow><mo>d</mo><msub><mi mathvariant=\"normal\">\u03a6</mi><mi>n</mi></msub></mrow><mo>\u2062</mo><mrow><mo maxsize=\"160%\" minsize=\"160%\">(</mo><mrow><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\mathpzc</mtext></merror><mo>\u2062</mo><mi>B</mi></mrow><mo>+</mo><mover accent=\"true\"><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\mathpzc</mtext></merror><mo>\u2062</mo><mi>V</mi></mrow><mo stretchy=\"false\">\u00af</mo></mover></mrow><mo maxsize=\"160%\" minsize=\"160%\">)</mo></mrow><mo>\u2062</mo><msub><mi>O</mi><mi>n</mi></msub></mrow></mrow></mstyle><mo>+</mo><mstyle displaystyle=\"true\"><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mrow><mo>d</mo><msub><mi mathvariant=\"normal\">\u03a6</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mo>\u2062</mo><mrow><mo maxsize=\"160%\" minsize=\"160%\">(</mo><mrow><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\mathpzc</mtext></merror><mo>\u2062</mo><mi>R</mi><mo>\u2062</mo><msub><mi>O</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mo>-</mo><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\mathpzc</mtext></merror><mo>\u2062</mo><mi>A</mi><mo>\u2062</mo><msub><mi>O</mi><mi>n</mi></msub></mrow></mrow><mo maxsize=\"160%\" minsize=\"160%\" rspace=\"8.1pt\">)</mo></mrow></mrow></mrow></mstyle></mrow></mrow><mo rspace=\"12.5pt\">,</mo><mrow><mover accent=\"true\"><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\mathpzc</mtext></merror><mo>\u2062</mo><mi>V</mi></mrow><mo stretchy=\"false\">\u00af</mo></mover><mo>=</mo><mrow><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\mathpzc</mtext></merror><mo>\u2062</mo><mi>V</mi></mrow><mo>+</mo><mstyle displaystyle=\"true\"><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mrow><mo>d</mo><msub><mi mathvariant=\"normal\">\u03a6</mi><mn>1</mn></msub></mrow><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\mathpzc</mtext></merror><mo>\u2062</mo><mi>A</mi></mrow></mrow></mstyle></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04101.tex", "nexttext": "\n\\begin{tikzpicture}[remember picture, overlay]\n\\draw (3,4) node[font=\\footnotesize,draw=red,rounded corners,fill=red!10] (description1)\n{{}$\\begin{matrix}\n    \\textcolor{green}{A_n^{(0)},A_n^{(1)}}\\\\\n    \\textcolor{blue}{|A_n^{(0)}|^2,\\langle A_n^{(0)}|A_n^{(1)}\\rangle,|A_n^{(0)}\\!|^2_{ij}}\n    \\end{matrix}$};\n\\draw[->] (description1) -- (firstA);\n\\draw[->] (description1) -- (firstB);\n\\draw[->] (description1) -- (secondA);\n\\draw[->] (description1) -- (fifthA);\n\\end{tikzpicture}\n\\begin{tikzpicture}[remember picture, overlay]\n\\draw (8.5,4) node[font=\\footnotesize,draw=red,rounded corners,fill=red!10] (description2)\n{{}$\\begin{matrix}\n    \\textcolor{red}{P(\\tilde{q}),D(p_{\\!\\bot})}\\\\\n    \\textcolor{red}{R_{MEC}(p_{\\!\\bot})}\n    \\end{matrix}$};\n\\draw[->] (description2) -- (secondB);\n\\end{tikzpicture}\n\\begin{tikzpicture}[remember picture, overlay]\n\\draw (12,4) node[font=\\footnotesize,draw=red,rounded corners,fill=red!10] (description3)\n{{}$\\begin{matrix}\n    \\textcolor{green}{A_n^{(0)}}\\\\\n    \\textcolor{blue}{|A_n^{(0)}|^2_{ij}}\n    \\end{matrix}$};\n\\draw[->] (description3) -- (third);\n\\end{tikzpicture}\n\n\\begin{tikzpicture}[remember picture, overlay]\n\\draw (3.5,-0.75) node[font=\\footnotesize,draw=red,rounded corners,fill=red!10] (description4)\n{{}$\\begin{matrix}\n    \\textcolor{green}{A_{n+1}^{(0)}}\\\\\n    \\textcolor{blue}{|A_{n+1}^{(0)}|^2}\n    \\end{matrix}$};\n\\draw[->] (description4) -- (fourth);\n\\end{tikzpicture}\n\\begin{tikzpicture}[remember picture, overlay]\n\\draw (7,-0.75) node[font=\\footnotesize,draw=red,rounded corners,fill=red!10] (description5)\n{{}$\\begin{matrix}\n    \\textcolor{red}{P(\\tilde{q}),D(p_{\\!\\bot})}\\\\\n    \\textcolor{red}{R_{MEC}(p_{\\!\\bot})}\n    \\end{matrix}$};\n\\draw[->] (description5) -- (fifthB);\n\\end{tikzpicture}\n\\begin{tikzpicture}[remember picture, overlay]\n\\draw (10.75,-0.75) node[font=\\footnotesize,draw=red,rounded corners,fill=red!10] (description6)\n{{}$\\begin{matrix}\n    \\textcolor{green}{A_n^{(0)}}\\\\\n    \\textcolor{blue}{|A_n^{(0)}|^2_{ij}}\n    \\end{matrix}$};\n\\draw[->] (description6) -- (sixth);\n\\end{tikzpicture}\n\\vspace{1.25cm}\n\\end{figure}\n\n\\noindent where $\\mathpzc{P}(q^2)$ denotes the shower kernel, evaluated at the\nshower evolution scale $q$, $Q$ the hard process scale (aka the shower start\nscale) and $\\mu_\\mathrm{IR}$ the shower cut-off scale, and which is rearranged\nwith respect to $O_n$ and $O_{n+1}$, i.e. in terms of so-called $S$- and\n$H$-events respectively.\n\nFor the Born, virtual, real and subtraction term contributions various\ninterfaces to matrix element code exist:\neither at the level of squared matrix elements through the BLHA interface\nstandard~\\cite{Binoth:2010xt,Alioli:2013nda,Andersen:2014efa} to various\nexternal matrix element providers such as GoSam~\\cite{Cullen:2014yla},\nNJet~\\cite{Badger:2012pg}, OpenLoops~\\cite{Cascioli:2011va} or\nVBFNLO~\\cite{Arnold:2008rz,Baglio:2014uba},\nor at the level of color ordered sub-amplitudes with a dedicated interface to\nMadGraph~\\cite{Alwall:2011uj,Alwall:2014hca}, where the color bases are\nprovided by an interface to the ColorFull~\\cite{Sjodahl:2014opa} and\nCVolver~\\cite{Platzer:2013fha} libraries, or at the level of built-in helicity\nsub-amplitudes, with dedicated spinor-helicity libraries and caching\nfacilities.\nFor the shower subtraction plug-ins for the shower algorithms of Herwig are\nprovided: for the angular-ordered parton shower ($P(\\tilde{q})$), the dipole\nshower ($D(p_{\\!\\bot})$), or in the form of matrix element corrections.\n\nFor the multiplicative matching, additional capabilities to sample Sudakov-type\ndistributions are provided~\\cite{Platzer:2011dr}.\n\n\\section{Shower Improvements, Uncertainties and Tuning}\n\nThe angular-ordered parton shower of the new Herwig release finally reaches\nthe same level of accuracy as in HERWIG 6. This is due to a number of\nimprovements.\nThe inclusion of QED radiation: the maximum scale for QED radiation differs in\ngeneral from the maximum scale for QCD radiation and is selected from the other\ncharged particles in the process rather than from colored partners. Which type\nof emission is generated first is decided according to a competition algorithm:\ntrial QCD and QED emissions are generated and the one with the higher scale is\nchosen. Depending on which type of emission suceeds over the other any\nsubsequent emissions of the same type are required to be angular ordered, while\nthe others are just required to be ordered in the evolution variable.\nSpin correlations: effects of two types of correlations between the azimuthal\nangle of a branching and both the hard scattering process and any previous\nbranchings in the parton shower are included, using the algorithm\nof~\\cite{Knowles:1988vs,Knowles:1988hu,Collins:1987cp}. There is now no\nrequirement anymore that unstable decays are generated before the parton shower\nin order to generate the spin correlations between the production and decay of\nthe particles, as described in~\\cite{Richardson:2001df,Gigg:2007cr}, since\nthe decays of unstable fundamental particles are now handled as part of the\nparton shower including all the spin correlations.\nRelaxed conditions for $g\\rightarrow q\\bar{q}$ branchings: the branching\n$g\\to q\\bar{q}$ does not have a soft singularity and therefore should not be\nangular-ordered in the parton shower (but must continue to be ordered in the\nevolution variable). In any $g\\to q\\bar{q}$ branching the maximum scale is\nthus determined by the scale at which the gluon itself was produced.\n\nUncertainties in fixed-order only runs can be assessed by variations of\nrenormalization and factorization scale. Similarly in runs with subsequent\nshowering, variations of the renormalization and factorization scales in the\nshower as well as the hard process scale for the matching can be performed.\nWithin the new steering formalism default settings are provided for a coherent\nassessment of those uncertainties.\n\nDue to the new developments in the shower algorithms the need for a new tune to\n$e^+e^-$ data arises. This tune has been carried through and a reasonable\ndescription of the data has been achieved for both shower variants in Herwig. A\ngood description of underlying event data and double parton scattering data has\nbeen obtained by including the latter with sufficently large weight in the fit.\nHerwig 7.0 is released with the tune H7-UE-MMHT, using the MMHT2014 LO PDF\nset~\\cite{Harland-Lang:2014zoa} (tunes using the CT14~\\cite{Dulat:2015mca} and\nNNPDF3.0~\\cite{Ball:2014uwa} PDF sets are planned for the near future as well),\nfor which more details can be found on\n\\href{https://herwig.hepforge.org/tutorials/mpi/tunes.html}\n{https://herwig.hepforge.org/tutorials/mpi/tunes.html}\nor in~\\cite{Bellm:2015jjp}.\n\n\\section{Availability and Usage}\n\nIn the new Herwig release NLO event simulation is now possible without the\nrequirement of separately running external codes and/or dealing with\nintermediate event sample files.\nSlight changes have been made to improve Herwig's steering at the level of\ninput files, and significant improvements are provided to integration and\nunweighting, including parallelization to meet the requirements of more\ncomplex processes.\nBy virtue of the Matchbox framework the new release introduces some new run\nmodes in compliance to two new integrator modules which provide far superior\nperformance compared to the old default, ACDC of ThePEG, especially for more\ncomplex processes (one of them is based on the standard sampling algorithm\ncontained in the ExSample library~\\cite{Platzer:2011dr}, the other is based on\nthe MONACO algorithm, a VEGAS~\\cite{Lepage:1980dq} variant, used by\nVBFNLO~\\cite{Arnold:2008rz,Baglio:2014uba}).\nBoth integrators require an integration grid to be set up prior to the event\ngeneration, and hence two levels of run mode have been introduced in addition\nto the old \\texttt{read} and \\texttt{run} steps.\nThe new \\texttt{integrate} step performs the grid adaptation, and can be\ntrivially parallelized to be submitted to any standard batch or grid queues.\nThe event generation (the \\texttt{run} step) itself can of course also be\nparallelized similarly.\nThe \\texttt{integrate} step is to be preceded by a \\texttt{build} step, which\nwill assemble the full fixed-order or matched cross section, including\nsubtraction terms and the possibility of external amplitude libraries\ngenerating dedicated code for the process of interest. The old \\texttt{read}\nstep is still available, representing the subsequent execution of the\n\\texttt{build} and \\texttt{integrate} steps. Various examples of how this new\nwork-flow paradigm can be utilized are given in the new online documentation\non \\href{https://herwig.hepforge.org/tutorials/index.html}\n{https://herwig.hepforge.org/tutorials/index.html}.\n\nA variety of related project code has been developed along with Herwig 7, which\nis not supported at the same level as the core Herwig code, but is nevertheless\nprovided along with it in the Herwig \\texttt{Contrib} folder. Plug-ins to\nvarious projects exist, such as electroweak Higgs plus jets\nproduction~\\cite{Campanario:2013fsa}, provided by the HJets++ plug-in to Matchbox,\nFxFx merging~\\cite{Frederix:2012ps} for $\\mathrm{W+jets}$ and $\\mathrm{Z+jets}$\nevents~\\cite{Frederix:2015eii} or Higgs boson boson pair\nproduction~\\cite{Goertz:2014qta,Maierhofer:2013sha}. More details can be found\nin~\\cite{Bellm:2013lba,Bellm:2015jjp} and in the Contrib section on\n\\href{https://herwig.hepforge.org/tutorials/index.html}\n{https://herwig.hepforge.org/tutorials/index.html}.\n\n\\section{Examples}\n\n\\subsection{Checks and Validation}\n\nFigs.~\\ref{fig:test3} and \\ref{fig:test4} show validation plots for various\nmatrix element providers against results obtained from MCFM.\nFigs.~\\ref{fig:test5} and \\ref{fig:test6} demonstrate pole cancellation and\nsubtraction checks.\n\n\\begin{figure}[h]\n\\centering\n\\vspace{1.5ex}\n\\begin{minipage}{.45\\textwidth}\n  \\centering\n  \n  \\includegraphics[trim=140 452.5 240 140, clip, scale=0.625]{Dy_WZ_MCFM_HerwigGoSam_WhzBellmp9p1.pdf}\n  \\caption{\\small\\it Validation against MCFM for $WZ$ production: $\\Delta y$ between $W$ and $Z$ boson.}\n  \\label{fig:test3}\n\\end{minipage}\n\\hspace{0.05\\textwidth}\n\\begin{minipage}{.45\\textwidth}\n  \\centering\n  \\hspace{-1.75ex}\n  \n  \\includegraphics[trim=135 452.5 245 140, clip, scale=0.625]{pT_tbar_MCFM_HerwigGoSam_HerwigMadGraph_WhzBellmp9p3.pdf}\n  \\caption{\\small\\it Validation against MCFM for $t\\bar{t}$ production: $p_{T}$ of the top antiquark.}\n  \\label{fig:test4}\n\\end{minipage}\n\\end{figure}\n\n\\begin{figure}[h]\n\\centering\n\\vspace{-0.5ex}\n\\begin{minipage}{.45\\textwidth}\n  \\centering\n  \\vspace{1.5ex}\n  \n  \\includegraphics[trim=140 512.5 240 135, clip, scale=0.625]{subchk_uubar_epemgg_s14_WhzBellmp9p2.pdf}\n  \\caption{\\small\\it Real emission subtraction check for $Z+$jet production: singularity cancellation in $u\\bar{u}\\rightarrow e^+e^-gg$.}\n  \\label{fig:test5}\n\\end{minipage}\n\\hspace{0.05\\textwidth}\n\\begin{minipage}{.45\\textwidth}\n  \\centering\n  \\vspace{-1.5ex}\n  \\hspace{-1.75ex}\n  \n  \\includegraphics[trim=135 512.5 245 135, clip, scale=0.625]{polchk_pp_3j_WhzBellmp9p4.pdf}\n  \\caption{\\small\\it Pole cancellation check for $3$jet production: $\\frac{1}{\\varepsilon}$-pole cancellation.}\n  \\label{fig:test6}\n\\end{minipage}\n\\end{figure}\n\n\\subsection{A more concrete example: $t\\bar{t}$ Production}\n\nFigs.~\\ref{fig:test9} and \\ref{fig:test10} show validation plots for various\nmatrix element providers against results obtained from MCFM, for $t\\bar{t}$\nproduction at NLO.\nFig.~\\ref{fig:test11} shows results for $t\\bar{t}$ production at NLO,\nsupplemented with the angular-ordered shower of Herwig and subtractive\nmatching.\n\n\\begin{figure}[h]\n\\centering\n\n\\includegraphics[trim=0 0 0 22.5, clip, scale=0.65]{pp-tt-NLO.pdf}\n\\caption{\\small\\it Comparison of total cross sections for $pp\\rightarrow t\\bar{t}$ at NLO. Various matrix element providers against MCFM.\n         Fixed scale $\\mu=\\mu_F=\\mu_R=80$ GeV. CT10nlo PDF set, $\\alpha_s(M_Z)|_{\\rm{CT10nlo}}$. $M_t=173.5$ GeV, on-shell.}\n\\label{fig:test9}\n\\end{figure}\n\n\\begin{figure}[h]\n\\centering\n\\includegraphics[scale=0.325]{j_pT.pdf}\n\\includegraphics[scale=0.325]{j_y.pdf}\n\\includegraphics[scale=0.325]{tbar_pT.pdf}\\\\\n\\includegraphics[scale=0.325]{tbar_y.pdf}\n\\includegraphics[scale=0.325]{t_pT.pdf}\n\\includegraphics[scale=0.325]{t_y.pdf}\n\\caption{\\small\\it Comparison of various distributions for $pp\\rightarrow t\\bar{t}$ at NLO, at $14$ TeV. Various matrix element providers against MCFM.\n         Fixed scale $\\mu=\\mu_F=\\mu_R=80$ GeV. CT10nlo PDF set, $\\alpha_s(M_Z)|_{\\rm{CT10nlo}}$. $M_t=173.5$ GeV, on-shell.}\n\\label{fig:test10}\n\\end{figure}\n\n\\begin{figure}[h]\n\\centering\n\\includegraphics[scale=0.5]{ttb_pT_TopMinMtScale.pdf}\n\\hspace{7.5ex}\n\\includegraphics[scale=0.5]{TTbarPtLogX_TopMinMtScale.pdf}\n\\caption{\\small\\it $pp\\rightarrow t\\bar{t}$ NLO matched, at $14$ TeV.\n         MC@NLO--like matching to the angular ordered $\\tilde{q}$--shower. Shower start scale $Q^2=\\mu^2$.\n         Hard scale variation: $\\mu^2=\\mu_F^2=\\mu_R^2$ by factors of $0.5$ and $2$,\n         where $\\mu^2=\\mu_{\\min_{t\\bar{t}}\\{m_T\\}}^2 = \\min_{i=t,\\bar{t}} \\left(m_i^2+p_{T,i}^2\\right)$.\n}\n\\label{fig:test11}\n\\end{figure}\n\n\\subsection{Data Comparison and Comparison vs. Herwig++ 2.7}\n\nIn figs.~\\ref{results1} to \\ref{results4} a small sample of results is shown\nthat have been improved in the new release of Herwig 7.0 in contrast to the\nprevious Herwig++ version 2.7. The following is just a small selection of\ndistributions that have been checked against data. More will be shown in a\nseries of upcoming papers.\nThe Monte Carlo results from Herwig++ 2.7 use leading order plus parton\nshower,\nthose from Herwig 7.0 use\nthe angular-ordered parton shower (LO $\\oplus$ PS),\nthe angular-ordered parton shower supplemented\n  by the built-in Powheg correction, which includes QCD and QED corrections for\n  the case of $e^+e^-\\to q\\bar{q}$ (QCD $\\otimes$ QED $\\otimes$PS),\n  by the automatically-calculated by Matchbox subtractive (MC@NLO-type)\n  matching (NLO $\\oplus$ PS) and \n  multiplicative (Powheg-type, NLO $\\otimes$ PS) corrections\nand, finally, the dipole shower supplemented by a subtractive matching to NLO\ncross sections (NLO $\\oplus$ Dipoles).\n\nFig.~\\ref{results1} shows the thrust distribution at LEP, in comparison with\ndata from ALEPH~\\cite{Barate:1996fi}. A long-standing problem of Herwig++\n(producing too many very hard events, whether or not NLO matching was used)\nhas been been solved by the improvements to the angular-ordered parton shower:\nall of the variants of NLO matching give a similar description of the data.\nIn Fig.~\\ref{results2}, the effect of the inclusion of photon emission in the\nangular-ordered parton shower is shown. Events at $z_\\gamma=1$ are isolated\nphotons (``jets'' for which all of the jet energy is carried by a single\nphoton), while events at lower $z_\\gamma$ come from hard collinear photon\nemission from the final state quark jets. We see clearly that the results from\nHerwig++ have no component at large $z_\\gamma$ at all, while all of the Herwig\n7.0 variants are much closer to the data.\n\\begin{figure}[h]\n\\centering\n\\vspace{-2.5ex}\n\\begin{minipage}{.45\\textwidth}\n  \\centering\n\\includegraphics[scale=0.5]{ALEPH_1996_S3486095-d03-x01-y01.pdf}\n  \\caption{\\small\\it The thrust distribution in $\\mathrm{e^+e^-}$ annihilation at\n    $\\sqrt{s}=M_z$, in comparison with ALEPH data~\\cite{Barate:1996fi}.}\n  \\label{results1}\n\\end{minipage}\n\\hspace{0.05\\textwidth}\n\\begin{minipage}{.45\\textwidth}\n  \\centering\n\\vspace{2.5ex}\n\\includegraphics[scale=0.5]{ALEPH_1996_S3196992-d07-x01-y01.pdf}\n  \\caption{\\small\\it The distribution of photon-jet energy fraction in three-jet\n    $\\mathrm{e^+e^-}$ events at $\\sqrt{s}=M_z$ defined with a cutoff in\n    the $k_\\perp$ algorithm of $y=0.1$ in comparison with ALEPH\n    data~\\cite{Buskulic:1995au}.}\n  \\label{results2}\n\\end{minipage}\n\\end{figure}\n\nFig.~\\ref{results3} shows results for $\\mathrm{Z+jets}$ production at the LHC,\nmore concretely the distribution of separation in azimuthal angle between the\n$\\mathrm{Z}$ boson and the hardest jet. The region $\\Delta\\phi\\sim\\pi$\ncorresponds to leading order kinematics, in which the $\\mathrm{Z}$ boson gains\ntransverse momentum by recoiling against a single hard parton, whereas the\nspectrum of events down to $\\Delta\\phi=0$ corresponds to events in which the\n$\\mathrm{Z}$ boson recoils against two or more jets. The need for NLO\ncorrections is clearly seen. An important cross-check of the two different\nautomated NLO matching schemes and the two different shower algorithms, both\nusing subtractive matching, can also be seen.\nIn Fig.~\\ref{results4} the jet activity in $\\mathrm{t\\bar{t}}$ events at the\nLHC is shown, as revealed by the gap fraction.\nHerwig++ 2.7 is seen to have far too little jet activity (too many gap events).\nWhile Herwig 7.0 with the shower alone is somewhat closer to the data at small\n$Q_{\\mathrm{sum}}$, a clear deficit is seen for hard jet events at high\n$Q_{\\mathrm{sum}}$, while both the NLO matching schemes describe the data well.\n\\begin{figure}[h]\n\\centering\n\\vspace{-2.5ex}\n\\begin{minipage}{.45\\textwidth}\n  \\centering\n\\includegraphics[scale=0.5]{CMS_2013_I1209721-d01-x01-y01.pdf}\n  \\caption{\\small\\it The distribution of separation in azimuthal angle between\n    the $\\mathrm{Z}$ boson and the hardest jet in $\\mathrm{Z+jets}$\n    events in $\\mathrm{pp}$ collisions at $\\sqrt{s}=7\\,\\mathrm{TeV}$ in\n    comparison with CMS data~\\cite{Chatrchyan:2013tna}.}\n  \\label{results3}\n\\end{minipage}\n\\hspace{0.05\\textwidth}\n\\begin{minipage}{.45\\textwidth}\n  \\centering\n\\vspace{2.5ex}\n\\includegraphics[scale=0.5]{ATLAS_2012_I1094568-d04-x02-y01.pdf}\n  \\caption{\\small\\it The fraction of events that have less than $Q_{\\mathrm{sum}}$\n    transverse energy in the rapidity region $|y|<2.1$ in top\n    quark-antiquark events in $\\mathrm{pp}$ collisions at\n    $\\sqrt{s}=7\\,\\mathrm{TeV}$ in comparison with ATLAS\n    data~\\cite{ATLAS:2012al}.}\n  \\label{results4}\n\\end{minipage}\n\\vspace{-1.0ex}\n\\end{figure}\n\n\\section{Summary and Outlook}\n\nThe Herwig event generator has expanded its range of applicability to a\nmultitude of underlying hard processes at NLO QCD, and a new version has\nrecently been released~\\cite{Bellm:2015jjp}. Much of the new development is due\nto the Matchbox framework for fully automated NLO calculations and matching,\nwhich, however, also triggered crucial improvements to hitherto existing\nstructures. The new release is the first major release in the new Herwig 7\nseries, which supersedes the capabilities of both its predecessors in the\nHerwig++ 2~\\cite{Bahr:2008pv,Bellm:2013lba} and HERWIG 6~\\cite{Corcella:2000bw}\nseries.\nFurther physics related studies adressed by the new version, as well as\ncomparisons with other event generator programs such as\nPythia~\\cite{Sjostrand:2007gs,Sjostrand:2014zea} or Sherpa~\\cite{Gleisberg:2008ta},\nwill be covered in subsequent publications.\nFuture development, for which the recent release forms the basis, includes LO\nand NLO multijet merging as well as the automation of NLO electroweak\ncorrections.\n\n\\section*{Acknowledgements}\n\nCR is thankful to the organizers of the Radcor 2015 and LoopFest XIV joined\nsymposium, for the possibility to present the new developments in Herwig.\nThis work was supported in part by the European Union as part of the FP7 Marie\nCurie Initial Training Network MCnetITN (PITN-GA-2012-315877).\n\nAll contributors, hosting institutions and funding agencies who gave invaluable\ninput, feedback and support for the new release of Herwig 7 are furthermore\nacknowledged in~\\cite{Bellm:2015jjp}.\n\n\\bibliography{Herwig}{}\n\\bibliographystyle{JHEP}\n\n\n", "itemtype": "equation", "pos": 4644, "prevtext": "\nwhere $\\mathpzc{B}$ denotes the corresponding Born matrix element,\n$\\mathpzc{V}$ the UV-subtracted virtual contribution, $\\mathpzc{R}$ the real\ncontribution and $\\mathpzc{A}$ the subtraction term (the contribution from the\ncollinear counter term to subtract additional initial state collinear\nsingularities is hereby neglected). The subtractive matching formula can\ncorrespondingly be written in a condensed notation as shown in\neq.~(\\ref{eq:MCatNLO})\n\\begin{figure}[h]\n\\vspace{1.25cm}\n\n", "index": 3, "text": "\\begin{align}\nO^{\\rm{matched}}_{\\rm{NLO}} = \n \\Bigg[ &\n          \\displaystyle\\int\\mathrm{d}\\Phi_n\\Big(\\tikzmark[firstA]{\\mathpzc{B}}+\\tikzmark[firstB]{\\bar{\\mathpzc{V}}}\\Big)\n          +\n          \\displaystyle\\int\\mathrm{d}\\Phi_n\\tikzmark[secondA]{\\mathpzc{B}}\\displaystyle\\int^{Q^2}_{\\mu^2_{IR}}\\mathrm{d}\\tikzmark[secondB]{\\!\\!\\!\\mathpzc{P}(q^2)}\n          -\n          \\displaystyle\\int\\mathrm{d}\\Phi_{n+1}\\tikzmark[third]{\\mathpzc{A}}\\Theta(q^2-\\mu^2_{IR})\n \\Bigg] O_n \\notag\\\\\n +\n \\Bigg[ &\n          \\displaystyle\\int\\mathrm{d}\\Phi_{n+1}\\tikzmark[fourth]{\\mathpzc{R}}\n          -\n          \\displaystyle\\int\\mathrm{d}\\Phi_n\\tikzmark[fifthA]{\\mathpzc{B}}\\displaystyle\\int^{Q^2}_{\\mu^2_{IR}}\\mathrm{d}\\tikzmark[fifthB]{\\!\\!\\!\\mathpzc{P}\\big(q^2\\big)}\n          -\n          \\displaystyle\\int\\mathrm{d}\\Phi_{n+1}\\tikzmark[sixth]{\\mathpzc{A}}\\Theta\\big(\\mu^2_{IR}-q^2\\big)\n \\Bigg] O_{n+1}\n\\label{eq:MCatNLO}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle O^{\\rm{matched}}_{\\rm{NLO}}=\\Bigg{[}\" display=\"inline\"><mrow><msubsup><mi>O</mi><mi>NLO</mi><mi>matched</mi></msubsup><mo>=</mo><mo maxsize=\"260%\" minsize=\"260%\">[</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\displaystyle\\int\\mathrm{d}\\Phi_{n}\\Big{(}\\tikzmark[firstA]{%&#10;\\mathpzc{B}}+\\tikzmark[firstB]{\\bar{\\mathpzc{V}}}\\Big{)}+\\displaystyle\\int%&#10;\\mathrm{d}\\Phi_{n}\\tikzmark[secondA]{\\mathpzc{B}}\\displaystyle\\int^{Q^{2}}_{%&#10;\\mu^{2}_{IR}}\\mathrm{d}\\tikzmark[secondB]{\\!\\!\\!\\mathpzc{P}(q^{2})}-%&#10;\\displaystyle\\int\\mathrm{d}\\Phi_{n+1}\\tikzmark[third]{\\mathpzc{A}}\\Theta(q^{2}%&#10;-\\mu^{2}_{IR})\\Bigg{]}O_{n}\" display=\"inline\"><mrow><mstyle displaystyle=\"true\"><mo largeop=\"true\" symmetric=\"true\">\u222b</mo></mstyle><mi mathvariant=\"normal\">d</mi><msub><mi mathvariant=\"normal\">\u03a6</mi><mi>n</mi></msub><mrow><mo maxsize=\"160%\" minsize=\"160%\">(</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\tikzmark</mtext></merror><mrow><mo stretchy=\"false\">[</mo><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi><mi>A</mi><mo stretchy=\"false\">]</mo></mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\mathpzc</mtext></merror><mi>B</mi><mo>+</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\tikzmark</mtext></merror><mrow><mo stretchy=\"false\">[</mo><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi><mi>B</mi><mo stretchy=\"false\">]</mo></mrow><mover accent=\"true\"><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\mathpzc</mtext></merror><mo>\u2062</mo><mi>V</mi></mrow><mo stretchy=\"false\">\u00af</mo></mover><mo maxsize=\"160%\" minsize=\"160%\">)</mo></mrow><mo>+</mo><mstyle displaystyle=\"true\"><mo largeop=\"true\" symmetric=\"true\">\u222b</mo></mstyle><mi mathvariant=\"normal\">d</mi><msub><mi mathvariant=\"normal\">\u03a6</mi><mi>n</mi></msub><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\tikzmark</mtext></merror><mrow><mo stretchy=\"false\">[</mo><mi>s</mi><mi>e</mi><mi>c</mi><mi>o</mi><mi>n</mi><mi>d</mi><mi>A</mi><mo stretchy=\"false\">]</mo></mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\mathpzc</mtext></merror><mi>B</mi><mstyle displaystyle=\"true\"><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><msubsup><mi>\u03bc</mi><mrow><mi>I</mi><mo>\u2062</mo><mi>R</mi></mrow><mn>2</mn></msubsup><msup><mi>Q</mi><mn>2</mn></msup></msubsup></mstyle><mi mathvariant=\"normal\">d</mi><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\tikzmark</mtext></merror><mrow><mo stretchy=\"false\">[</mo><mi>s</mi><mi>e</mi><mi>c</mi><mi>o</mi><mi>n</mi><mi>d</mi><mi>B</mi><mo rspace=\"0pt\" stretchy=\"false\">]</mo></mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\mathpzc</mtext></merror><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><msup><mi>q</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><mo>-</mo><mstyle displaystyle=\"true\"><mo largeop=\"true\" symmetric=\"true\">\u222b</mo></mstyle><mi mathvariant=\"normal\">d</mi><msub><mi mathvariant=\"normal\">\u03a6</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\tikzmark</mtext></merror><mrow><mo stretchy=\"false\">[</mo><mi>t</mi><mi>h</mi><mi>i</mi><mi>r</mi><mi>d</mi><mo stretchy=\"false\">]</mo></mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\mathpzc</mtext></merror><mi>A</mi><mi mathvariant=\"normal\">\u0398</mi><mrow><mo stretchy=\"false\">(</mo><msup><mi>q</mi><mn>2</mn></msup><mo>-</mo><msubsup><mi>\u03bc</mi><mrow><mi>I</mi><mo>\u2062</mo><mi>R</mi></mrow><mn>2</mn></msubsup><mo stretchy=\"false\">)</mo></mrow><mo maxsize=\"260%\" minsize=\"260%\">]</mo><mi>O</mi><msub><mi/><mi>n</mi></msub></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle+\\Bigg{[}\" display=\"inline\"><mrow><mo>+</mo><mo maxsize=\"260%\" minsize=\"260%\">[</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\displaystyle\\int\\mathrm{d}\\Phi_{n+1}\\tikzmark[fourth]{\\mathpzc{R%&#10;}}-\\displaystyle\\int\\mathrm{d}\\Phi_{n}\\tikzmark[fifthA]{\\mathpzc{B}}%&#10;\\displaystyle\\int^{Q^{2}}_{\\mu^{2}_{IR}}\\mathrm{d}\\tikzmark[fifthB]{\\!\\!\\!%&#10;\\mathpzc{P}\\big{(}q^{2}\\big{)}}-\\displaystyle\\int\\mathrm{d}\\Phi_{n+1}\\tikzmark%&#10;[sixth]{\\mathpzc{A}}\\Theta\\big{(}\\mu^{2}_{IR}-q^{2}\\big{)}\\Bigg{]}O_{n+1}\" display=\"inline\"><mrow><mstyle displaystyle=\"true\"><mo largeop=\"true\" symmetric=\"true\">\u222b</mo></mstyle><mi mathvariant=\"normal\">d</mi><msub><mi mathvariant=\"normal\">\u03a6</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\tikzmark</mtext></merror><mrow><mo stretchy=\"false\">[</mo><mi>f</mi><mi>o</mi><mi>u</mi><mi>r</mi><mi>t</mi><mi>h</mi><mo stretchy=\"false\">]</mo></mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\mathpzc</mtext></merror><mi>R</mi><mo>-</mo><mstyle displaystyle=\"true\"><mo largeop=\"true\" symmetric=\"true\">\u222b</mo></mstyle><mi mathvariant=\"normal\">d</mi><msub><mi mathvariant=\"normal\">\u03a6</mi><mi>n</mi></msub><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\tikzmark</mtext></merror><mrow><mo stretchy=\"false\">[</mo><mi>f</mi><mi>i</mi><mi>f</mi><mi>t</mi><mi>h</mi><mi>A</mi><mo stretchy=\"false\">]</mo></mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\mathpzc</mtext></merror><mi>B</mi><mstyle displaystyle=\"true\"><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><msubsup><mi>\u03bc</mi><mrow><mi>I</mi><mo>\u2062</mo><mi>R</mi></mrow><mn>2</mn></msubsup><msup><mi>Q</mi><mn>2</mn></msup></msubsup></mstyle><mi mathvariant=\"normal\">d</mi><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\tikzmark</mtext></merror><mrow><mo stretchy=\"false\">[</mo><mi>f</mi><mi>i</mi><mi>f</mi><mi>t</mi><mi>h</mi><mi>B</mi><mo rspace=\"0pt\" stretchy=\"false\">]</mo></mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\mathpzc</mtext></merror><mi>P</mi><mrow><mo maxsize=\"120%\" minsize=\"120%\">(</mo><msup><mi>q</mi><mn>2</mn></msup><mo maxsize=\"120%\" minsize=\"120%\">)</mo></mrow><mo>-</mo><mstyle displaystyle=\"true\"><mo largeop=\"true\" symmetric=\"true\">\u222b</mo></mstyle><mi mathvariant=\"normal\">d</mi><msub><mi mathvariant=\"normal\">\u03a6</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\tikzmark</mtext></merror><mrow><mo stretchy=\"false\">[</mo><mi>s</mi><mi>i</mi><mi>x</mi><mi>t</mi><mi>h</mi><mo stretchy=\"false\">]</mo></mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\mathpzc</mtext></merror><mi>A</mi><mi mathvariant=\"normal\">\u0398</mi><mrow><mo maxsize=\"120%\" minsize=\"120%\">(</mo><msubsup><mi>\u03bc</mi><mrow><mi>I</mi><mo>\u2062</mo><mi>R</mi></mrow><mn>2</mn></msubsup><mo>-</mo><msup><mi>q</mi><mn>2</mn></msup><mo maxsize=\"120%\" minsize=\"120%\">)</mo></mrow><mo maxsize=\"260%\" minsize=\"260%\">]</mo><mi>O</mi><msub><mi/><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></math>", "type": "latex"}]