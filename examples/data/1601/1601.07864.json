[{"file": "1601.07864.tex", "nexttext": "\nwhere the existence of the continuous function $\\psi_q(u)$ with\n$0\\leq \\psi_q(u) \\leq 2/(qu)$ and support in $(e_q,e_{q-1})$ is\njustified by $\\int_{e_q}^{e_{q-1}}(du/u)=q.$ The following\nrelations hold for $\\phi_q\\in{\\mathcal C}^2({\\mathbb R},{\\mathbb R})$ with\n$\\phi_q(0)=0,$\n \n", "itemtype": "equation", "pos": 11399, "prevtext": "\n\n\n\\title{On construction of boundary preserving numerical schemes}\n\n\\author{Nikolaos Halidias \\\\\n{\\small\\textsl{Department of Mathematics }}\\\\\n{\\small\\textsl{University of the Aegean }}\\\\\n{\\small\\textsl{Karlovassi  83200  Samos, Greece} }\\\\\n{\\small\\textsl{email: nikoshalidias@hotmail.com}}}\n\n\\maketitle\n\n\n\n\n\\begin{abstract}Our aim in this note is to extend the semi discrete technique by combine it with the split step method.  We apply\nour new method to the Ait-Sahalia model and propose an explicit\nand positivity preserving numerical scheme.\n\\end{abstract}\n\n{\\bf Keywords} Explicit numerical scheme, Ait-Sahalia model,\nboundary preserving.\n\n{\\bf 2010 Mathematics Subject Classification} 60H10, 60H35\n\n\n\\section{Introduction}\nIn this paper we describe a technique to construct numerical\nschemes by combining the split step method (see for example\n\\cite{schurz1}) and the semi discrete method (see\n\\cite{Halidias1}, \\cite{Halidias2}, \\cite{Halidias3}). Using the\nsemi discrete method we have constructed explicit and positivity\nnumerical schemes for various stochastic differential equations\narising in finance (see \\cite{Halidias4}, \\cite{Halidias5},\n\\cite{Halidias6}, \\cite{Halidias7}, \\cite{Halidias8}).\n\n\n\n\n\nUsing the proposed technique (split-step and semi-discrete) we are\nable to handle more situations in which we want to construct\nexplicit and boundary preserving numerical schemes. Our starting\npoint was the paper \\cite{Mao} (see also \\cite{Andreas}) in which\nthe authors proposed an implicit numerical scheme to approximate\nthe Ait-Sahalia model (see \\cite{Ait}), which is the following,\n\\begin{eqnarray*}\nx_t = x_0 + \\int_0^t \\left(\\frac{a_1}{x_s} - a_2 + a_3x_s -\na_4x_s^{r} \\right) ds + \\int_0^t \\sigma x_s^{\\rho} dw_s\n\\end{eqnarray*}\nwith $x_0 \\in \\mathbb{R}_+$. We assume that all the coefficients\nare nonnegative and that $r+1 > 2 \\rho$.\n\nUsing this new method we describe and analyze a new explicit and\npositivity preserving numerical scheme for the Ait-Sahalia model\nwhich arise in finance. As far as we know this is the first\nexplicit scheme for this model, however this does not mean that\nfrom the computational point of view is cheaper than the implicit\nones (\\cite{Mao}, \\cite{Andreas}). We have to   make extended\nnumerical experiments in order to compare them.\n\n\\section{The drift splitting}\nLet $(\\Omega, {\\cal F}, \\mathbb{P}, {\\cal F}_t)$ be a complete\nprobability space with a filtration and let  a Wiener process\n$(W_t)_{t \\geq 0}$ defined on this space. Consider the following\nstochastic differential equation,\n\\begin{eqnarray}\nx_t = x_0 + \\int_0^t a(s,x_s)ds + \\int_0^t b(s,x_s)dW_s,\n\\end{eqnarray}\nwhere $a,b: \\mathbb{R}_+ \\times \\mathbb{R} \\to \\mathbb{R}$ are\nmeasurable functions\n and $x_0$ such that is ${\\cal F}_0$-measurable and square\n integrable.\n\nLet $0 = t_0 < t_1 < ...<t_n = T$ and set $\\Delta = \\frac{T}{n}$.\nIn general, one can split the sde above in $m$ equations. For\nexample, if $a(t,x) = a_1(t,x) + ... +a_m(t,x)$  then we can have\nthe following splitting\n\\begin{eqnarray*}\ny_m(0) & = & x_0 \\\\\ny_1(t) &  = & y_m(t_n) + \\int_{t_n}^t a_1(s,y_1(s))ds, \\quad t \\in (t_n,t_{n+1}] \\\\\n& \\vdots  & \\\\ y_{m-1}(t) & = &  y_{m-2}(t_{n+1})+\\int_{t_n}^t\na_{m-1}(s,y_{m-1}(s))ds, \\quad t \\in (t_n,t_{n+1}] \\\\  y_m(t) & =\n& y_{m-1}(t_{n+1}) + \\int_{t_n}^t a_m(s,y_m(s))ds + \\int_{t_n}^t\nb(s,y_m(s)) dw_s, \\quad t \\in (t_n,t_{n+1}]\n\\end{eqnarray*}\nand approximate each of the above equations by a semi discrete\nscheme (or another converging scheme).\n\nThen, we can write, for $t \\in (t_n,t_{n+1}]$ and $y_m(0) = x_0$\n\\begin{eqnarray*}\ny_m(t) = y_m(t_n) & +  & \\int_{t_n}^{t_{n+1}}\n\\left(a_1(s,y_1(s))+...+a_{m-1}(s,y_{m-1}(s))\\right) ds \\\\ & + &\n\\int_{t_n}^t a_m(s,y_m(s)) ds   +   \\int_{t_n}^t b(s,y_m(s)) dw_s\n\\end{eqnarray*}\nor\n\\begin{eqnarray*}\ny_m(t) = x_0 & +  & \\int_{0}^{t_{n+1}}\n\\left(a_1(s,y_1(s))+...+a_{m-1}(s,y_{m-1}(s))\\right) ds \\\\ & + &\n\\int_{0}^t a_m(s,y_m(s)) ds  + \\int_{0}^t b(s,y_m(s)) dw_s\n\\end{eqnarray*}\n\n\nWe shall denote by $\\hat{t} = t_n$ when $ t \\in [t_n,t_{n+1}]$ and\n$\\tilde{t} = t_{n+1}$ when $t \\in [t_n,t_{n+1}]$.\n\n\n\n\n\n\\section{Approximating with the semi discrete method}\nSuppose that there are functions\n$f_1(t,x,y,z)$,...,$f_m(t,x,y,z)$,$f_{m+1}(t,x,y)$\n such that $f_i(t,x,x,x) = a_i(t,x)$ for $i=1,...,m$ and $f_{m+1}(t,x,x) =\n b(t,x)$.\n\nOur numerical scheme depends on the choices of $f_i$ and therefore\nwe should impose conditions on them. For fixed $a(t,x),b(t,x)$ one\ncan choose different $f_i$ in such a way that the corresponding\nnumerical schemes does not converge.\n\nDenoting again our approximation by $y_m(t)$ we write, for $t \\in\n(t_n,t_{n+1}]$\n\\begin{eqnarray*}\ny_m(0) & = & x_0, \\nonumber \\\\\ny_1(t) & = & y_m(t_n) + \\int_{t_n}^t\nf_1(s,y_m(t_n)),y_1(t),y_1(s))ds,\n \\\\\ny_2(t) & = & y_1(t_{n+1}) + \\int_{t_n}^t\nf_2(s,y_m(t_n),y_2(t),y_2(s))ds,  \\\\\n& \\vdots & \\\\\ny_{m-1}(t) & = & y_{m-2}(t_{n+1}) + \\int_{t_n}^t\nf_{m-1}(s,y_m(t_n),y_{m-1}(t),y_{m-1}(s))ds,  \\\\\ny_m(t) & = & y_{m-1}(t_{n+1}) +  \\int_{t_n}^t\nf_{m}(s,y_m(t_n),y_{m}(s))ds + \\int_{t_n}^t b(s,y_m(t_n),y_m(s))\ndw_s,\n\\end{eqnarray*}\nIt is obvious that we should choose $f_i$ in such a way that all\nthe above equations has at least one strong solution. Then, we\nhave constructed an approximation scheme which is $y_m(t)$ and\nunder suitable conditions we will show that this converges\nstrongly to the unique strong solution of problem (1). If some of\nthe above equations admits more than one solution then we have\nconstructed at least two approximation schemes and we choose the\nnumerical scheme that has  the desired properties, positivity\npreserving for example.\n\nIn a more compact form we can write, for $t \\in (t_n,t_{n+1}]$,\n\n\n\\begin{eqnarray}\ny_m(t) = y_m(t_n) & +  & \\int_{t_n}^{t_{n+1}}\n\\Big(f_1(s,y_1(s),y_1(t),y_m(t_n))+...+f_{m-1}(s,y_{m-1}(s),y_{m-1}(t),y_m(t_n))\\Big)\nds \\nonumber \\\\ & + & \\int_{t_n}^t f_m(s,y_m(s), y_m(t_n)) ds\n  +  \\int_{t_n}^t f_{m+1}(s,y_m(s),y_m(t_n)) dw_s, \\; t\n\\in (t_n,t_{n+1}],\n\\end{eqnarray}\nwith $y_m(0) = x_0$, and also\n\\begin{eqnarray}\ny_m(t) = x_0 & +  & \\int_{0}^{t_{n+1}}\n\\Big(f_1(s,y_1(s),y_1(t),y_m(\\hat{s}))+...+f_{m-1}(s,y_{m}(s),y_{m-1}(t),y_{m}(\\hat{s}))\\Big)\nds \\nonumber \\\\ & + & \\int_{0}^t f_m(s,y_m(s), y_m(\\hat{s})) ds  +\n \\int_{0}^t f_{m+1}(s,y_m(s),y_m(\\hat{s})) dw_s, \\quad  t \\in\n(t_n,t_{n+1}]\n\\end{eqnarray}\n\nFurthermore we have, for $i=1,...,m-1$ and for $t \\in\n(t_n,t_{n+1}]$\n\\begin{eqnarray}\ny_i(t)  =  y_i(t_n) & + & \\int_{t_n}^{t_{n+1}}\n\\Big(f_1(s,y_1(s),y_1(t),y_m(\\hat{s}))+...+f_{i-1}(s,y_{i-1}(s),y_{i-1}(t),y_{m}(\\hat{s}))\\Big)\nds \\nonumber \\\\ &  + & \\int_{t_{n-1}}^{t_n}\n\\Big(f_{i+1}(s,y_{i+1}(s),y_{i+1}(t),y_{m}(\\hat{s}))+...+f_{m}(s,y_{m}(s),y_{m}(t),y_{m}(\\hat{s}))\\Big)\nds \\nonumber \\\\ &  +  & \\int_{t_n}^t f_i\n(s,y_{i}(s),y_{i}(t),y_{m}(\\hat{s}))ds + \\int_{t_{n-1}}^{t_n}\nf_{m+1}(s,y_{m}(s),y_{m}(\\hat{s})) dw_s,\n\\\\\ny_m(t)  =  y_i(t_{n+1})  & + & \\int_{t_n}^{t_{n+1}}\nf_i(s,y_i(s),y_{i}(t),y_m(\\hat{s}))+...+f_{m-1}(s,y_{m-1}(s),y_{m-1}(t),y_{m}(\\hat{s}))\nds \\nonumber \\\\ & + & \\int_{t_n}^t\nf_m(s,y_m(s),y_{m}(t),y_m(\\hat{s})) ds + \\int_{t_n}^t\nf_{m+1}(s,y_{m}(s),y_{m}(\\hat{s}))dw_s\n\\end{eqnarray}\n\n\n\n\n\n {\\bf Assumption A} Suppose that problem (1)\nhas a unique strong solution and  that the following moment bounds\nholds, for every $p > 0$,\n\\begin{eqnarray*}\n\\mathbb{E}( |y_1(t)|^p + |y_2(t)|^p +...+y_m(t)+ |x(t)|^p ) <\n\\infty\n\\end{eqnarray*}\n\n\n\n\n{\\bf Assumption B} Suppose that the functions $f_i$ for\n$i=1,...,m$ satisfy the following locally Lipschitz condition,\n\\begin{eqnarray*}\n |f_i(t,x,x,x) - f_i(t,x_1,x_2,x_3)|  & \\leq &  C_R (|x-x_1| +\n|x-x_2|+|x-x_3| ), \\quad i=2,...,m \\\\\n|f_{m+1}(t,x,x) - f_{m+1}(t,x_1,x_2)| & \\leq & C_R (|x-x_1| +\n|x-x_2| + |x-x_1|^a)\n\\end{eqnarray*}\nfor $|x_1|, |x_2|, |x_3|, |x| \\leq R$,  and for some $a \\in\n[\\frac{1}{2},1)$.\n\n\n\n\n\n\n\\begin{theorem} Under Assumptions  A and B we have that\n\\begin{eqnarray*}\n \\mathbb{E}  |y_m(t) - x(t)|^2  \\leq C_R \\Delta +\n\\frac{2^{p+1} \\delta A}{p} + \\frac{(p-2)2A}{p\n\\delta^{\\frac{2}{p-2}}R^p} + e_{q-1} + \\frac{C_R\\Delta}{q e_q}\n\\end{eqnarray*}\nwhere $e_q=e^{-q(q+1)/2}$ for every $q \\in \\mathbb{N}$. Therefore,\nfor every ${\\varepsilon} > 0$, we can  fix first big enough $q$, then small\nenough $\\delta$ and big enough $R$ and finally for small enough\n$\\Delta$ we obtain that $\\mathbb{E}  |y_m(t) - x(t)|^2  \\leq\n{\\varepsilon}$.\n\\end{theorem}\n\n{\\noindent\\textbf{Proof.~}} Set $ \\rho_R = \\inf \\{ t \\in [0,T]:\n |x(t)| \\geq R \\}$, $ \\tau^i_R = \\inf \\{ t \\in [0,T] : |y_i(t)| \\geq R\n\\}$ for $i=1,...,m$. Let $\\theta_R = \\min \\{ \\tau^i_R,  \\rho_R\n\\}$.\n\n\n\nWe can prove that $\\mathbb{P}(\\tau^{i}_r \\leq T \\mbox{ or } \\rho_R\n\\leq T ) \\leq \\frac{2 A}{R^p}$. Using  Young inequality we obtain,\nfor any $\\delta > 0$,\n\\begin{eqnarray*}\n\\mathbb{E}\\left(\\sup_{0 \\leq t \\leq T } |y_m(t) -x(t)|^2\\right)\n\\leq \\mathbb{E}\\left( \\sup_{ 0 \\leq t \\leq T} \\left|y_m(t\n\\wedge\\theta_R) - x(t \\wedge\\theta_R)\\right|^2\\right) +\n\\frac{2^{p+1} \\delta A}{p} + \\frac{(p-2)2A}{p\n\\delta^{\\frac{2}{p-2}}R^p}.\n\\end{eqnarray*}\n\n\n\nThe difference $x(t) - y_m(t)$ is as follows,\n\\begin{eqnarray*}\nx(t) - y_m(t) = & &  \\int_0^t \\sum_{i=1}^m \\big(\nf_i(s,x(s),x(s),x(s)) - f_i(s,y_i(s),y_i(t),y_m(\\hat{s}) )\\big)ds\n\\\\ & + & \\int_0^t \\big(f_{m+1} \\big(s,x(s),x(s)) -\nf_{m+1}(s,y_m(s),y_m(\\hat{s})) \\big) dw_s \\\\ & + &\n\\int_t^{t_{n+1}} \\sum_{i=1}^{m-1} \\big( f_i(s,x(s),x(s),x(s)) -\nf_i(s,y_i(s),y_i(t),y_m(\\hat{s}) \\big)ds\n\\end{eqnarray*}\n\n\nWe shall estimate  the term $|x(t\\wedge \\theta_R) - y_m(t\\wedge\n\\theta_R)|^2$ as follows, using  Assumption  B\n\\begin{eqnarray}\n  & & \\mathbb{E} |x(t\\wedge \\theta_R) - y_m(t\\wedge \\theta_R)|^2\n  \\nonumber\n  \\\\\n  & \\leq & C_R\\Delta^2+C_R \\int_0^{t \\wedge \\theta_R}    \\sum_{i=1}^{m}\n\\mathbb{E}\\big(|x(s) - y_m(s)|^2 +|y_m(s)-y_i(\\tilde{s})|^2\n\\nonumber \\\\ & &  + |y_m(s)-y_m(\\hat{s})|^2 +\n|y_i(\\tilde{s})-y_i(s)|^2  + |x(s)-y_m(s)|^{2a}\\big) \\nonumber \\\\\n& \\leq & C_R\\sqrt{\\Delta} + C_R \\int_0^{t \\wedge \\theta_R}\n(\\mathbb{E}|x(s) - y_m(s)|^2 +\\mathbb{E}|x(s) - y_m(s)|) ds\n\\end{eqnarray}\nThe term $C_R \\Delta^2$ comes from the estimation of\n\\begin{eqnarray*}\n\\int_t^{t_{n+1}} \\sum_{i=1}^{m-1} \\big( f_i(s,x(s),x(s),x(s)) -\nf_i(s,y_i(s),y_i(t),y_m(\\hat{s}) \\big)ds\n\\end{eqnarray*}\n\nTo get (6) above we have used the following, for $i=1,...,m+1$\n\\begin{eqnarray*}\n|x(s) - y_i(s)| & \\leq &  |x(s) - y_m(s)| + |y_m(s)-y_i(s)| \\\\ &\n\\leq & |x(s) - y_m(s)| + |y_m(s)-y_{i}(\\tilde{s})| + |\ny_{i}(\\tilde{s}) - y_i(s)|\n\\end{eqnarray*}\ncombined with (4) and (5). Furthermore we have used that  for $2a\n\\geq 1$ it holds that\n\\begin{eqnarray*}\n\\mathbb{E}|x(s)-y_i(s)|^{2a} = \\mathbb{E}|x(s)-y_i(s)|\n|x(s)-y_i(s)|^{2a-1} \\leq C_R \\mathbb{E}|x(s)-y_i(s)|\n\\end{eqnarray*}\n\nFrom (4) and (5) we have, for $s \\in (t_n , t_{n+1} ]$ and $\ni=1,...,m$,\n\\begin{eqnarray*}\n\\mathbb{E}|y_i(s \\wedge \\theta_R) - y_i(t_n \\wedge\n\\theta_R)|^2 & \\leq & C_R \\Delta, \\quad \\\\\n\\mathbb{E}|y_m(s \\wedge \\theta_R) - y_i(t_{n+1} \\wedge\n\\theta_R)|^2 & \\leq & C_R \\Delta, \\\\\n\\mathbb{E} |y_i(t_{n+1} \\wedge \\theta_R) - y_i(s \\wedge\n\\theta_R)|^2 & \\leq & C_R \\Delta\n\\end{eqnarray*}\nand all these estimates are useful to get (6).\n\n\n\n\n\nWe should estimate the following quantity (and substitute this\nestimation to (6)),\n\\begin{eqnarray*}\n\\mathbb{E} |x(s)-y_m(s)| \\\\\n\\end{eqnarray*}\n\nLet the non increasing sequence $\\{e_q\\}_{q\\in\\mathbb{N}}$ with\n$e_q=e^{-q(q+1)/2}$ and $e_0=1.$ We introduce the following\nsequence of smooth approximations of $|x|,$\n\n", "index": 1, "text": "$$\n\\phi_q(x)=\\int_0^{|x|}dy\\int_0^{y}\\psi_q(u)du,\n$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"\\phi_{q}(x)=\\int_{0}^{|x|}dy\\int_{0}^{y}\\psi_{q}(u)du,\" display=\"block\"><mrow><mrow><mrow><msub><mi>\u03d5</mi><mi>q</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mrow><mo stretchy=\"false\">|</mo><mi>x</mi><mo stretchy=\"false\">|</mo></mrow></msubsup><mrow><mrow><mo>\ud835\udc51</mo><mi>y</mi></mrow><mo>\u2062</mo><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mi>y</mi></msubsup><mrow><msub><mi>\u03c8</mi><mi>q</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>u</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>u</mi></mrow></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.07864.tex", "nexttext": "\n \n", "itemtype": "equation", "pos": 11730, "prevtext": "\nwhere the existence of the continuous function $\\psi_q(u)$ with\n$0\\leq \\psi_q(u) \\leq 2/(qu)$ and support in $(e_q,e_{q-1})$ is\njustified by $\\int_{e_q}^{e_{q-1}}(du/u)=q.$ The following\nrelations hold for $\\phi_q\\in{\\mathcal C}^2({\\mathbb R},{\\mathbb R})$ with\n$\\phi_q(0)=0,$\n \n", "index": 3, "text": "$$\n |x| - e_{q-1}\\leq\\phi_q(x)\\leq |x|, \\quad |\\phi_{q}^{\\prime}(x)|\\leq1, \\quad x\\in{\\mathbb R}, $$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"|x|-e_{q-1}\\leq\\phi_{q}(x)\\leq|x|,\\quad|\\phi_{q}^{\\prime}(x)|\\leq 1,\\quad x\\in%&#10;{\\mathbb{R}},\" display=\"block\"><mrow><mrow><mrow><mrow><mrow><mo stretchy=\"false\">|</mo><mi>x</mi><mo stretchy=\"false\">|</mo></mrow><mo>-</mo><msub><mi>e</mi><mrow><mi>q</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow><mo>\u2264</mo><mrow><msub><mi>\u03d5</mi><mi>q</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2264</mo><mrow><mo stretchy=\"false\">|</mo><mi>x</mi><mo stretchy=\"false\">|</mo></mrow></mrow><mo rspace=\"12.5pt\">,</mo><mrow><mrow><mrow><mo stretchy=\"false\">|</mo><mrow><msubsup><mi>\u03d5</mi><mi>q</mi><mo>\u2032</mo></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">|</mo></mrow><mo>\u2264</mo><mn>1</mn></mrow><mo rspace=\"12.5pt\">,</mo><mrow><mi>x</mi><mo>\u2208</mo><mi>\u211d</mi></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.07864.tex", "nexttext": "\n\n\nApplying Ito's formula on $\\phi_q(x(t)-y_m(t))$ for $t \\in [0,t\n\\wedge \\theta_R]$ we get\n\\begin{eqnarray*}\n\\mathbb{E}\\phi_q(x(t) - y_m(t)| & \\leq & C_R \\Delta +\n\\frac{C_R\\Delta}{q e_q}+C_R\\int_0^t \\mathbb{E}\\phi_q^{'}(x(t) -\ny_m(t)) |x(s)-y_m(s)|ds \\\\  & &  + C_R\\int_0^t\n\\mathbb{E}|x(s)-y_m(s)|ds\n\\end{eqnarray*}\nTherefore\n\\begin{eqnarray*}\n\\mathbb{E}|x(t)-y_m(t)| \\leq e_{q-1} + C_R \\Delta+\n\\frac{C_R\\Delta}{q e_q} + C_R\\int_0^t \\mathbb{E}|x(s)-y_m(s)|ds\n\\end{eqnarray*}\nApplying Gronwall's inequality and substituting in (6) and then\nagain Gronwall inequality we get the desired result. {\\space\\hfill\\hspace*{\\fill} $\\vbox{\\hrule\\hbox{\\vrule height1.3ex\\hskip1.3ex\\vrule}\\hrule}$\\hss\\vskip\\topsep\\relax}\n\n\n\nAn example, is the following stochastic differential equation,\n\\begin{eqnarray*}\nx_t = x_0 + \\int_0^t k(l-x_s) - dx_s^2 ds + \\sigma \\int_0^t\n\\sqrt{x_s} dw_s\n\\end{eqnarray*}\nFor this sde, we propose the following splitting, for $t \\in\n(t_n,t_{n+1}]$\n\\begin{eqnarray*}\ny_2(0) & = & x_0, \\\\\ny_1(t) & = & y_2(t_n) + \\int_{t_n}^t -ky_1(s) - dy_1^2(s) ds, \\\\\ny_2(t) & = & y_1(t_{n+1}) + \\int_{t_n}^t kl ds + \\sigma\n\\int_{t_n}^t \\sqrt{y_2(s)}dw_s\n\\end{eqnarray*}\n\nThe first equation can be approximated as follows, denoting again\nby $y_1(t)$ the approximation\n\\begin{eqnarray*}\ny_1(t) = y_2(t_n) + \\int_{t_n}^t -k y_1(s) - dy_1(s) y_2(\\hat{s})\nds\n\\end{eqnarray*}\nwhich produces a positive solution whenever $y_2(t_n) > 0$. The\nsecond equation can be approximated in the spirit of\n\\cite{Halidias2}.\n\n\n\\section{Application to the Ait-Sahalia model}\nIn the previous section we have described a new technique to\nconstruct numerical schemes by combining the splitting technique\nand the semi discrete method. We have proved a convergence result\nwhen the numerical scheme satisfy some classic hypotheses. Below\nwe shall use this technique to construct an explicit and\npositivity preserving numerical scheme for the Ait-Sahalia model\nwhich is the following,\n\n\\begin{eqnarray*}\nx_t = x_0 + \\int_0^t \\frac{1}{2}\\left(\\frac{a_1}{x_s} - a_2 +\na_3x_s - a_4x_s^{r} \\right) ds + \\int_0^t \\sigma x_s^{\\rho} dw_s\n\\end{eqnarray*}\nwith $x_0 \\in \\mathbb{R}_+$. We first use the transformation\n\\begin{eqnarray*}\ny_t = x_t^2\n\\end{eqnarray*}\nBy using Ito's formula we obtain\n\\begin{eqnarray*}\ny(t) = y(0) + \\int_0^t \\Big(a_1 - a_2 \\sqrt{y(s)} + a_3 y(s) - a_4\ny^{\\frac{r+1}{2}}(s) + \\sigma^2 y^{\\rho}(s) \\Big)ds + \\int_0^t 2\n\\sigma y^{\\frac{\\rho+1}{2}}(s) dw_s\n\\end{eqnarray*}\n We assume that  that $r+1\n> 2 \\rho$. Then, we split as follows, introducing a free parameter\n$a\n> 0$,\n\\begin{eqnarray}\ny_2(0) & = & x_0^2 \\nonumber \\\\\ny_1(t) & = & y_2(t_n) + \\int_{t_n}^t \\big( a y_1(s) - a_2\n\\sqrt{y_1(s)} \\big)ds, \\\\\ny_2(t) & = & y_1(t_{n+1}) + \\int_{t_n}^t \\big( a_1 +(a_3-a)y_2(s)-\na_4y^{\\frac{r+1}{2}}_2(s) + \\sigma^2 y^{\\rho}_2(s) \\big)ds +\n\\int_{t_n}^t 2 \\sigma y^{\\frac{\\rho+1}{2}}_2(s) dw_s\n\\end{eqnarray}\n\nIt is easy to verify that equation (7) has at least one solution\nin each interval and one of  them is the following\n\\begin{eqnarray*}\ny_1(t) = \\Big(\\frac{a_2}{a} + (\\sqrt{y_2(t_n)} - \\frac{a_2}{a})\ne^{a\\frac{(t-t_n)}{2}} \\Big)^2\n\\end{eqnarray*}\nwhich is always positive and well posed whenever $y_2(t_n) \\geq\n0$.\n\n\n\n\nWe can approximate equation (8) by using a semi discrete approach,\nnamely\n\\begin{eqnarray*}\ny_2(t) = y_1(t_{n+1}) + \\int_{t_n}^t a_1+y_2(s)\\big(a_3-a+\\sigma^2\ny_2^{\\rho-1}(\\hat{s})-a_4y_2^{\\frac{r-1}{2}}(\\hat{s}) \\big) ds +\n\\int_{t_n}^t 2 \\sigma y_2(s) y_2^{\\frac{\\rho-1}{2}}(\\hat{s}) dw_s\n\\end{eqnarray*}\nwhich have a positive and known strong solution whenever\n$y_1(t_{n+1}) \\geq 0$. We denote again by $y_2(t)$ the\napproximation of (8).\n\n\n\nWe will use later on the following forms of $y_1,y_2$, for $t \\in\n(t_n,t_{n+1}]$,\n\\begin{eqnarray*}\ny_1(t)  =  y_1(t_n) & + & \\int_{t_{n-1}}^{t_n}\na_1+y_2(s)\\big(a_3-a+\\sigma^2\ny_2^{\\rho-1}(\\hat{s})-a_4y_2^{\\frac{r-1}{2}}(\\hat{s}) \\big) ds \\\\\n&   + & \\int_{t_{n-1}}^{t_n} 2 \\sigma y_2(s)\ny_2^{\\frac{\\rho-1}{2}}(\\hat{s}) dw_s + \\int_{t_n}^t \\big( a y_1(s)\n- a_2 \\sqrt{y_1(s)} \\big)ds, \\\\\n y_2(t)  =  y_2(t_n) & + & \\int_{t_n}^t \\Big(\n  a y_1(s) - a_2\n\\sqrt{y_1(s)}+  a_1+y_2(s)\\big(a_3-a+\\sigma^2\ny_2^{\\rho-1}(\\hat{s})-a_4y_2^{\\frac{r-1}{2}}(\\hat{s}) \\big) ds \\\\\n&  + & \\int_{t_n}^t 2 \\sigma y_2(s)\ny_2^{\\frac{\\rho-1}{2}}(\\hat{s}) dw_s + \\int_{t}^{t_{n+1}}  a\ny_1(s) - a_2 \\sqrt{y_1(s)} ds\n\\end{eqnarray*}\n\n\n\n\\begin{proposition}\nIf $r+1 > 2 \\rho$  then   we have the following moment bounds, for\n$\\Delta < 1$ if $a = \\ln \\frac{4}{3}$,\n\\begin{eqnarray*}\n\\mathbb{E}(|y_1(t)|^p+|y_2(t)|^p) < \\infty\n\\end{eqnarray*}\n\\end{proposition}\n\n{\\noindent\\textbf{Proof.~}} Let $\\tau_R = \\inf \\{ t \\in [0,T] : |y_2(t)| > R \\}$. Note\nthat $y_1(t \\wedge \\tau_R)$ is also uniformly bounded for all\n$\\omega \\in \\Omega$.\n\n\n\n We can write\n\\begin{eqnarray*}\ny_2(t \\wedge \\tau_R) = y_2(0) & + & \\int_0^{t \\wedge \\tau_R} (a_1\n- a_2 \\sqrt{y_1(s )} + ay_1(s)+y_2(s)\\big(a_3-a+\\sigma^2\ny_2^{\\rho-1}(\\hat{s})-a_4y_2^{\\frac{r-1}{2}}(\\hat{s}) \\big) ds \\\\\n& + & \\int_{0}^{t\\wedge \\tau_R} 2 \\sigma y_2(s)\ny_2^{\\frac{\\rho-1}{2}}(\\hat{s}) dw_s + \\int_{t\\wedge\n\\tau_R}^{t_{n+1}\\wedge \\tau_R}  ay_1(s) - a_2 \\sqrt{y_1(s)} ds\n\\end{eqnarray*}\nBut\n\\begin{eqnarray*}\ny_2(t\\wedge \\tau_R) \\leq y_2(0)  & + & \\int_0^{t\\wedge \\tau_R}\n(a_1 + ay_1(s)+y_2(s)\\big(a_3+\\sigma^2\ny_2^{\\rho-1}(\\hat{s})-a_4y_2^{\\frac{r-1}{2}}(\\hat{s}) \\big) ds \\\\\n& + & \\int_{0}^{t\\wedge \\tau_R} 2 \\sigma y_2(s)\ny_2^{\\frac{\\rho-1}{2}}(\\hat{s}) dw_s + \\int_{t_n\\wedge\n\\tau_R}^{t_{n+1}\\wedge \\tau_R} a y_1(s)  ds\n\\end{eqnarray*}\nLet us estimate\n\\begin{eqnarray*}\n\\int_{t_n\\wedge \\tau_R}^{t_{n+1}\\wedge \\tau_R} a y_1(s)  ds & = &\na\\int_{t_n\\wedge \\tau_R}^{t_{n+1}\\wedge \\tau_R}\\Big(\\frac{a_2}{a}\n+ (\\sqrt{y_2(t_n)} - \\frac{a_2}{a}) e^{a\\frac{(t-t_n)}{2}} \\Big)^2\nds \\\\ & = &  a \\int_{t_n\\wedge \\tau_R}^{t_{n+1}\\wedge \\tau_R}\n\\Big(\\frac{a^2_2}{a^2} + (\\sqrt{y_2(t_n)} - \\frac{a_2}{a})^2\ne^{a(t-t_n)} +2\\frac{a_2}{a}(\\sqrt{y_2(t_n)} -\n\\frac{a_2}{a})e^{a\\frac{(t-t_n)}{2}} \\Big) \\\\ & \\leq & C\n+\\int_{t_n\\wedge \\tau_R}^{t_{n+1}\\wedge \\tau_R}a(\\sqrt{y_2(t_n)} -\n\\frac{a_2}{a})^2 e^{a(t-t_n)} + 2a\\frac{a^2_2}{a^2} + \\frac{1}{2}a\n(\\sqrt{y_2(t_n)} - \\frac{a_2}{a})^2 e^{a(t-t_n)}ds \\\\ & = & C +\n\\int_{t_n\\wedge \\tau_R}^{t_{n+1}\\wedge\n\\tau_R}\\frac{3}{2}a(\\sqrt{y_2(t_n)} - \\frac{a_2}{a})^2\ne^{a(t-t_n)} \\\\ & \\leq & C + \\frac{3a_2^2\\Delta}{2a} e^{a\\Delta} +\n\\int_{t_n\\wedge \\tau_R}^{t_{n+1}\\wedge \\tau_R}\\frac{3}{2}a\ny_2(t_n)e^{a(t-t_n)}ds \\\\ & \\leq & C + \\frac{3}{2} y_2(t_n\\wedge\n\\tau_R)(e^{a \\Delta}-1)\n\\end{eqnarray*}\n\nTherefore\n\\begin{eqnarray*}\ny_2(t\\wedge \\tau_R) \\leq  C & + & \\frac{3}{2} y_2(t_n\\wedge\n\\tau_R)(e^{a \\Delta}-1)  + \\int_0^{t\\wedge \\tau_R} (a_1  +\nay_1(s)+y_2(s)\\big(a_3+\\sigma^2\ny_2^{\\rho-1}(\\hat{s})-a_4y_2^{\\frac{r-1}{2}}(\\hat{s}) \\big) ds \\\\\n & + &  \\int_{0}^{t\\wedge\n\\tau_R} 2 \\sigma y_2(s) y_2^{\\frac{\\rho-1}{2}}(\\hat{s}) dw_s\n\\end{eqnarray*}\n\n\n\nDenoting by $v(s\\wedge \\tau_R)$ the following Ito process,\n\\begin{eqnarray*}\nv(s\\wedge \\tau_R) =  C & + & \\frac{3}{2} y_2(t_n\\wedge\n\\tau_R)(e^{a \\Delta}-1) + \\int_0^{t\\wedge \\tau_R} (a_1  +\nay_1(s)+y_2(s)\\big(a_3+\\sigma^2\ny_2^{\\rho-1}(\\hat{s})-a_4y_2^{\\frac{r-1}{2}}(\\hat{s}) \\big) ds \\\\\n & + &  \\int_{0}^{t\\wedge\n\\tau_R} 2 \\sigma y_2(s) y_2^{\\frac{\\rho-1}{2}}(\\hat{s}) dw_s\n\\end{eqnarray*}\nwe see that $y_2(s\\wedge \\tau_R) \\leq v(s\\wedge \\tau_R)$. We shall\nprove that $v(s)$ has bounded $pth$ moments and therefore $y_2(t)$\nalso.\n\n\n\n Applying\nIto's formula on $v^p(t \\wedge \\tau_R)$ we get that\n\\begin{eqnarray*}\nv^p(t\\wedge \\tau_R) = & & (C+\\frac{3}{2} y_2(t_n\\wedge\n\\tau_R)(e^{a \\Delta}-1) )^p \\\\ & + & \\int_0^{t\\wedge \\tau_R}\npv^{p-1} \\big(a_1 + ay_1(s)+y_2(s)\\big(a_3+\\sigma^2\ny_2^{\\rho-1}(\\hat{s})-a_4y_2^{\\frac{r-1}{2}}(\\hat{s})\\big)\\big)ds\n\\\\ & + &\\int_0^{t\\wedge \\tau_R}\\frac{p(p-1)}{2} 4 \\sigma^2 y_2^{2}(s)\nv^{p-2}(s)y_2^{\\rho-1}(\\hat{s}) ds \\\\ & + & \\int_{0}^{t\\wedge\n\\tau_R}p 2 \\sigma y_2(s)v^{p-1}(s) y_2^{\\frac{\\rho-1}{2}}(\\hat{s})\ndw_s\n\\end{eqnarray*}\nTaking expectations we arrive at\n\\begin{eqnarray*}\n\\mathbb{E}v^p(t \\wedge \\tau_R) \\leq & &  \\mathbb{E} (C+\\frac{3}{2}\ny_2(t_n\\wedge \\tau_R)(e^{a \\Delta}-1) )^p \\\\ & & + \\int_0^{t\n\\wedge \\tau_R} ( C + C \\mathbb{E}v^p(s) + pa\\mathbb{E}y_1(s)v^{p-1}(s)ds \\\\\n& & + \\int_0^{t \\wedge \\tau_R}p\\mathbb{E}v^{p}(s)\n\\big(a_3+\\sigma^2\ny_2^{\\rho-1}(\\hat{s})-a_4y_2^{\\frac{r-1}{2}}(\\hat{s}) +\n\\frac{p(p-1)}{2} 4 \\sigma^2  y_2^{\\rho-1}(\\hat{s})\\big)ds\n\\end{eqnarray*}\nWe have assumed that $r+1 > 2 \\rho$ so there exists some constant\n$C$ independent of $\\omega,\\Delta$ such that\n\\begin{eqnarray*}\na_3+\\sigma^2 y_2^{\\rho-1}(\\hat{s})-a_4y_2^{\\frac{r-1}{2}}(\\hat{s})\n+ \\frac{p(p-1)}{2} 4 \\sigma^2  y_2^{\\rho-1}(\\hat{s}) \\leq C\n\\end{eqnarray*}\n\nWe will estimate now the term, using the inequality $(a+b)^p \\leq\n2^{p-1}a^p + 2^{p-1}b^b$,\n\\begin{eqnarray*}\n\\mathbb{E} (C+\\frac{3}{2} y_2(t_n\\wedge \\tau_R)(e^{a \\Delta}-1)\n)^p \\leq C + \\frac{3^p}{2}  (e^{a \\Delta}-1)^p\n\\mathbb{E}y_2^p(t_n\\wedge \\tau_R)\n\\end{eqnarray*}\nFurthermore the following term\n\\begin{eqnarray*}\n\\mathbb{E}y_1(s)v^{p-1}(s) = \\mathbb{E}\\Big(\\frac{a_2}{a} +\n(\\sqrt{y_2(\\hat{s})} - \\frac{a_2}{a}) e^{a\\frac{(t-t_n)}{2}}\n\\Big)^2 v^{p-1}(s) \\leq C + C\\sup_{ 0 \\leq l \\leq\ns}\\mathbb{E}v^p(l)\n\\end{eqnarray*}\nCollecting all the above results, we obtain\n\\begin{eqnarray*}\n\\mathbb{E}v^p(t \\wedge \\tau_R) \\leq C + \\frac{3^p}{2}  (e^{a\n\\Delta}-1)^p\\mathbb{E}v^p(t_n\\wedge \\tau_R) + C\\int_{0}^{t \\wedge\n\\tau_R} \\mathbb{E}v^p(s) + \\sup_{ 0 \\leq l \\leq s}\\mathbb{E}v^p(l)\nds\n\\end{eqnarray*}\n\n Next setting\n\\begin{eqnarray*}\nu(s) = \\sup_{ 0 \\leq l \\leq s} \\mathbb{E} v^p(l)\n\\end{eqnarray*}\nwe can write\n\\begin{eqnarray*}\n(1- \\frac{3^p}{2}  (e^{a \\Delta}-1)^p)u(t) \\leq C + \\int_{0}^{t\n\\wedge \\tau_R} C u(s) ds\n\\end{eqnarray*}\nNow it is the time to choose accordingly the free parameter $a$ so\nas\n\\begin{eqnarray*}\n \\frac{3^p}{2}  (e^{a \\Delta}-1)^p < 1\n \\end{eqnarray*}\n Choosing $a = \\ln \\frac{4}{3}$ we easily see that the above\n inequality holds for every $\\Delta < 1$. It is clear that if we\n use smaller $\\Delta$ then we can choose bigger $a$ so that the\n corresponding constants will be smaller.\n\nUsing Gronwall's inequality and then Fatou's lemma we get the\nresult.\n {\\space\\hfill\\hspace*{\\fill} $\\vbox{\\hrule\\hbox{\\vrule height1.3ex\\hskip1.3ex\\vrule}\\hrule}$\\hss\\vskip\\topsep\\relax}\n\n\nUnfortunately, we can not use our Theorem 1 directly to get the\ndesired result, therefore we will argue differently.\n\n\\begin{theorem} If $r+1 > 2 \\rho$ then\n\\begin{eqnarray*}\n\\mathbb{E}|y(t) - y_2(t)|^2 \\leq C_R \\Delta + \\frac{C}{R}\n\\end{eqnarray*}\nfor any $R > 0$. Therefore, for every ${\\varepsilon} > 0$ we fix  $R$ such\nthat $\\frac{C}{R} < {\\varepsilon}$ and then for small enough $\\Delta$ we\nhave that\n\\begin{eqnarray*}\n\\mathbb{E}|y(t) - y_2(t)|^2 \\leq {\\varepsilon}\n\\end{eqnarray*}\n\\end{theorem}\n\n\n{\\noindent\\textbf{Proof.~}} The approximate solution $y_2(t)$ is as follows,\n\\begin{eqnarray*}\n y_2(t)  =  x_0^2 & + & \\int_0^t ( a_1 - a_2 \\sqrt{y_1(s)} +\n(a_3-a)y_2(s) + a y_1(s) - a_4 y_2(s)y_2^{\\frac{r-1}{2}}(\\hat{s})\n+ \\sigma^2 y_2(s)y_2^{\\rho-1}(\\hat{s}) ) ds \\\\ &  + & \\int_0^t 2\n\\sigma y_2(s)y_2^{\\frac{\\rho-1}{2}}(\\hat{s}) dw_s +\n\\int_t^{t_{n+1}} a y_1(s) - a_2 \\sqrt{y_1(s)} ds\n\\end{eqnarray*}\nSet\n\\begin{eqnarray*}\nv(t)  =  x_0^2 & + & \\int_0^t ( a_1 - a_2 \\sqrt{y_1(s)} +\n(a_3-a)y_2(s) + a y_1(s) - a_4 y_2(s)y_2^{\\frac{r-1}{2}}(\\hat{s})\n+ \\sigma^2 y_2(s)y_2^{\\rho-1}(\\hat{s}) ) ds \\\\ &  + & \\int_0^t 2\n\\sigma y_2(s)y_2^{\\frac{\\rho-1}{2}}(\\hat{s}) dw_s\n\\end{eqnarray*}\nThen it is clear that $\\mathbb{E}|y_2(t) - v(t)|^p \\leq C\n\\Delta^p$ and therefore $v(t)$ has bounded moments as well.\n\nThe difference $y(t)-v(t)$ is as follows\n\\begin{eqnarray*}\ny(t)-v(t) & = & \\int_0^t \\Big( a_2(\\sqrt{y_1(s)} - \\sqrt{y(s)})\n+(a_3-a)(y(s)-y_2(s)) + a (y(s)-y_1(s))\n  \\\\ & & +a_4(y_2(s)y_2^{\\frac{r-1}{2}}(\\hat{s}) - y^{\\frac{r+1}{2}}(s)  +\n\\sigma^2 (y^{\\rho}(s) - y_2(s)y_2^{\\rho-1}(\\hat{s})) \\Big)ds \\\\ &\n& + \\int_0^t 2 \\sigma (y^{\\frac{\\rho+1}{2}}(s) -\ny_2(s)y^{\\frac{\\rho-1}{2}}_2(\\hat{s})) dw_s\n\\end{eqnarray*}\n\nApplying Ito's formula on $(y(t)-v(t))^2$ and setting\n\\begin{eqnarray*}\ng(t)  & = & a_2(\\sqrt{y_1(s)} - \\sqrt{y(s)}) +(a_3-a)(y(s)-y_2(s))\n+ a (y(s)-y_1(s))\n   \\\\ & & +a_4(y_2(s)y_2^{\\frac{r-1}{2}}(\\hat{s}) - y^{\\frac{r+1}{2}}(s))  +\n\\sigma^2 (y^{\\rho}(s) - y_2(s)y_2^{\\rho-1}(\\hat{s}))\n\\end{eqnarray*}\n we obtain\n\\begin{eqnarray*}\n\\mathbb{E}(y(t)-v(t))^2 = \\mathbb{E}\\int_0^t 2 (y(t)-y_2(t)) g(s)\n+ 2 (y_2(t)-v(t)) g(s)  + 4 \\sigma^2 (y^{\\frac{\\rho+1}{2}}(s) -\ny_2(s)y^{\\frac{\\rho-1}{2}}_2(\\hat{s}))^2 ds\n\\end{eqnarray*}\n\nThen, it is clear that\n\\begin{eqnarray*}\n2 \\mathbb{E} (y_2(t)-v(t)) g(s) \\leq C \\Delta\n\\end{eqnarray*}\nusing  the moment bounds of $y,y_2$.\n\nNext we will estimate the term\n\\begin{eqnarray*}\n2 a_2\\mathbb{E} (y(t)-y_2(t)) (\\sqrt{y_1(s)} - \\sqrt{y(s)}) & = &\n2 a_2\\mathbb{E} (y(t)-y_2(t)) (\\sqrt{y_2(s)} - \\sqrt{y(s)}) \\\\ & &\n+ 2 a_2\\mathbb{E} (y(t)-y_2(t)) (\\sqrt{y_1(s)} - \\sqrt{y_2(s)}) \\\\\n& \\leq & 2 a_2\\mathbb{E} (y(t)-y_2(t)) (\\sqrt{y_1(s)} -\n\\sqrt{y_2(s)})\n\\end{eqnarray*}\nwhere we have used the fact that $h(x) = -\\sqrt{x}$ is a\ndecreasing function. Using Holder's inequality and the fact that\n$y,y_1,y_2$ have bounded moments, we obtain\n\\begin{eqnarray*}\n\\mathbb{E} (y(t)-y_2(t)) (\\sqrt{y_1(s)} - \\sqrt{y_2(s)}) \\leq\n\\sqrt{\\mathbb{E} |y(t)-y_2(t)|^2} \\sqrt{\\mathbb{E}\n|y_1(s)-y_2(s)|} \\leq C \\sqrt{\\mathbb{E} |y_1(s)-y_2(s)|}\n\\end{eqnarray*}\nTherefore it remains to estimate the term\n\\begin{eqnarray*}\n\\mathbb{E}|y_1(s) - y_2(s)| & \\leq &\n\\mathbb{E}|y_1(\\tilde{s})-y_2(s)| + \\mathbb{E}|y_1(s) -\ny_1(\\tilde{s})| \\\\ & \\leq & \\mathbb{E}|y_1(\\tilde{s})-y_2(s)| +\n\\mathbb{E}|y_1(\\tilde{s})-y_1(\\hat{s})| +\n\\mathbb{E}|y_1(\\hat{s})-y_1(s)| \\\\ & \\leq & C \\sqrt{\\Delta}\n\\end{eqnarray*}\n\nNow we will estimate the term\n\\begin{eqnarray*}\n& & 2 \\mathbb{E} (y(t)-y_2(t))\\Big((a_3-a)(y(s)-y_2(s)) + a\n(y(s)-y_1(s))\\Big) \\\\ &=& 2 a_3\\mathbb{E} (y(t)-y_2(t))^2  +2 a\n\\mathbb{E} (y(t)-y_2(t)) (y_1(t)-y_2(t)) \\\\ & \\leq & C\\mathbb{E}\n(y(t)-y_2(t))^2 + C \\sqrt{\\Delta}\n\\end{eqnarray*}\n\n\nThe term\n\\begin{eqnarray*}\n& & 2 \\mathbb{E} (y(t)-y_2(t))\n(a_4(y_2(s)y_2^{\\frac{r-1}{2}}(\\hat{s}) - y^{\\frac{r+1}{2}}(s)) \\\\\n& = &  2 a_4\\mathbb{E} (y(t)-y_2(t)) (y^{\\frac{r+1}{2}}_2(s) -\ny^{\\frac{r+1}{2}}(s)) +2\na_4\\mathbb{E}(y(t)-y_2(t))y_2(s)(y_2^{\\frac{r-1}{2}}(\\hat{s})-y_2^{\\frac{r-1}{2}}(s))\n\\\\ & \\leq & C \\Delta + 2\na_4\\mathbb{E}(y(t)-y_2(t))y_2(s)(y_2^{\\frac{r-1}{2}}(\\hat{s})-y_2^{\\frac{r-1}{2}}(s))\n\\end{eqnarray*}\nusing the fact that $h(x) = - x^{\\frac{r+1}{2}}$ is a decreasing\nfunction. But\n\\begin{eqnarray*}\n& &\n2a_4\\mathbb{E}(y(t)-y_2(t))y_2(s)(y_2^{\\frac{r-1}{2}}(\\hat{s})-y_2^{\\frac{r-1}{2}}(s))\n \\\\ & = & 2a_4\\mathbb{E}(y(t)-y_2(t))\\big( y_2^{\\frac{r+1}{2}}(\\hat{s}) -\n y_2^{\\frac{r+1}{2}}(s)\\big) +\n 2a_4\\mathbb{E}(y(t)-y_2(t))(y_2(s)-y_2(\\hat{s}))y_2^{\\frac{r-1}{2}}(\\hat{s})\n \\end{eqnarray*}\nSince $\\mathbb{E}y^{\\frac{r-1}{2}}_2(t) < \\infty$ we can use the\nmean value theorem arriving to the following estimate,\n\\begin{eqnarray*}\n\\mathbb{E} (y(t)-y_2(t)) (a_4(y_2(s)y_2^{\\frac{r-1}{2}}(\\hat{s}) -\ny^{\\frac{r+1}{2}}(s)) \\leq C \\sqrt{\\Delta}\n\\end{eqnarray*}\n\n\n\nThe term\n\\begin{eqnarray*}\n2 \\mathbb{E}(y(t)-y_2(t))(y^{\\rho}(t) - y_2^{\\rho}(t)) = 2(\\rho-1)\n\\mathbb{E} (y(t)-y_2(t))^2 h^{\\rho-1}(t)\n\\end{eqnarray*}\nusing the mean value theorem, for some $h(t)$ located between\n$y(t),y_2(t)$. Using the moment bounds of $y,y_2$ we arrive at,\nfor any $R>0$,\n\\begin{eqnarray*}\n2(\\rho-1) \\mathbb{E} (y(t)-y_2(t))^2 h^{\\rho-1}(t) & = & 2(\\rho-1)\n\\mathbb{E} (y(t)-y_2(t))^2 h^{\\rho-1}(t) \\mathbb{I}_{ \\{\nh^{\\rho-1}(t) > R \\}} \\\\ & & + 2(\\rho-1) \\mathbb{E}\n(y(t)-y_2(t))^2 h^{\\rho-1}(t) \\mathbb{I}_{ \\{ h^{\\rho-1}(t) \\leq R\n\\}} \\\\ & \\leq & C_R \\mathbb{E} |y(t)-y_2(t)|^2  +2(\\rho-1)\n\\mathbb{E} (y(t)-y_2(t))^2 h^{\\rho-1}(t) \\mathbb{I}_{ \\{\nh^{\\rho-1}(t) > R \\}}\n\\end{eqnarray*}\nUsing Holder's inequality we deduce that\n\\begin{eqnarray*}\n\\mathbb{E} (y(t)-y_2(t))^2 h^{\\rho-1}(t) \\mathbb{I}_{ \\{\nh^{\\rho-1}(t) > R \\}} \\leq \\sqrt{\\mathbb{E} (y(t)-y_2(t))^4\nh^{2\\rho-2}(t)} \\sqrt{\\mathbb{E} \\mathbb{I}_{ \\{ h^{\\rho-1}(t) > R\n\\}}}\n\\end{eqnarray*}\nUsing the moment bounds of $y,y_2,h$ and Markov's inequality we\narrive at the following estimate,\n\\begin{eqnarray*}\n2 \\mathbb{E}(y(t)-y_2(t))(y^{\\rho}(t) - y_2^{\\rho}(t)) \\leq C_R\n\\mathbb{E} |y(t)-y_2(t)|^2 + \\frac{C}{R}\n\\end{eqnarray*}\n\n\n\nThe same holds for the term $4 \\sigma^2\n\\mathbb{E}(y^{\\frac{\\rho+1}{2}}(s) -\ny_2(s)y^{\\frac{\\rho-1}{2}}_2(\\hat{s}))^2$ therefore we conclude\nthat\n\\begin{eqnarray*}\n\\mathbb{E}(y(t)-v(t))^2 \\leq \\frac{C}{R} + C \\sqrt{\\Delta} +\nC_R\\int_0^t \\mathbb{E}(y(s)-v(s))^2 ds\n\\end{eqnarray*}\nand using Gronwall's inequality we conclude the desired result.\n\nNow it is easy to see that\n\\begin{eqnarray*}\n\\mathbb{E}|y(t)-y_2(t)|^2 \\leq C \\mathbb{E}|y(t)-v(t)|^2 + C\n\\mathbb{E}|y_2(t)-v(t)|^2 \\to 0 \\mbox{ as } \\Delta \\to 0\n\\end{eqnarray*}\n {\\space\\hfill\\hspace*{\\fill} $\\vbox{\\hrule\\hbox{\\vrule height1.3ex\\hskip1.3ex\\vrule}\\hrule}$\\hss\\vskip\\topsep\\relax}\n\n \\begin{theorem} If $r+1> 2 \\rho$ we have that\n \\begin{eqnarray*}\n\\lim_{\\Delta \\to 0} \\mathbb{E} | \\sqrt{y_2(t)} - \\sqrt{y(t)} |^2 =\n0\n\\end{eqnarray*}\n\\end{theorem}\n\n\n{\\noindent\\textbf{Proof.~}} Using Holder's inequality and the nonnegativity of the\napproximation we have\n\\begin{eqnarray*}\n\\mathbb{E} |\\sqrt{y_2(t)} - \\sqrt{y(t)} |^2 & = & \\mathbb{E}\n\\frac{|y_2(t) - y(t)|^2}{(\\sqrt{y(t)} + \\sqrt{y_2(t)})^2} \\\\ &\n\\leq & \\sqrt{\\mathbb{E}|y_2(t) - y(t)|^2}\n\\sqrt[4]{\\mathbb{E}|y(t)+y_2(t)|^4\\mathbb{E}\\frac{1}{y^2(t)}}\n\\end{eqnarray*}\nRecalling from \\cite{Mao} that the inverse moments of the true\nsolution are bounded we conclude our proof. {\\space\\hfill\\hspace*{\\fill} $\\vbox{\\hrule\\hbox{\\vrule height1.3ex\\hskip1.3ex\\vrule}\\hrule}$\\hss\\vskip\\topsep\\relax}\n\nIn practice, we will approximate equation (8) with a slightly\ndifferent approximation which is the following\n\\begin{eqnarray*}\ny_2(t) = y_1(t_{n+1}) + a_1 \\Delta+ \\int_{t_n}^t\ny_2(s)\\big(\\sigma^2\ny_2^{\\rho-1}(\\hat{s})-a_4y_2^{\\frac{r-1}{2}}(\\hat{s}) \\big) ds +\n\\int_{t_n}^t 2 \\sigma y_2(s) y_2^{\\frac{\\rho-1}{2}}(\\hat{s}) dw_s\n\\end{eqnarray*}\n\nOur numerical scheme for the transformed Ait-Sahalia model is as\nfollows\n\\begin{eqnarray*}\ny_0 & = & x_0^2, \\\\\ny_{n+1} &  = & \\Big(a_1\\Delta + \\left(\\frac{a_2}{a} +\n(\\sqrt{y_n}-\\frac{a_2}{a}) e^{\\frac{a\\Delta}{2}}\\right)^2 \\Big)\ne^{-\\Delta(\\sigma^2y_n^{\\rho-1} + a_4 y_n^{\\frac{r-1}{2}})  + 2\n\\sigma y_n^{\\frac{\\rho-1}{2}} \\Delta W}\n\\end{eqnarray*}\n\nThe approximation of the Ait-Sahalia model will be $x_n =\n\\sqrt{y_n}$.\n\n\\section{Summary and comments}\nIn this paper we extend the semi discrete method by combine it\nwith the split step method. We can, in general, split our\nstochastic differential equation in $m$ equations (by splitting\nthe drift term) and then in each equation we apply any\napproximation method. The aim of this new technique is that the\nresulting numerical scheme will be boundary preserving.\n\nConsider for example the following Ait-Sahalia type model,\n\\begin{eqnarray*}\nx_t = x_0 + \\int_0^t \\frac{1}{2}\\Big(\\frac{a_1}{x_s} - a_2 -b_1\n\\sqrt{x_s} - b_2 x^{\\frac{3}{2}}_s - b_3 \\ln (1+x_s^2) + a_3 x_s -\na_4 x^{r}_s \\Big) ds + \\int_0^t \\sigma x_s^{\\rho} dw_s.\n\\end{eqnarray*}\nUsing the transformation $y_t = x_t^2$ we get the following\nstochastic differential equation for $y_t$,\n\\begin{eqnarray*}\ny_t = y_0 & + &  \\int_0^t \\Big(a_1-a_2 \\sqrt{y_s} - b_1\ny_s^{\\frac{3}{4}} - b_2 y^{\\frac{5}{4}}_s - b_3 \\sqrt{y_s} \\ln\n(1+y_s) + a_3 y_s - a_4 y_s^{\\frac{r+1}{2}}  +  \\sigma^2\ny_s^{\\rho} \\Big) ds \\\\ & + & \\int_0^t 2 \\sigma\ny_s^{\\frac{\\rho+1}{2}} dw_s\n\\end{eqnarray*}\nThen we propose the following slit step combined with the semi\ndiscrete technique numerical scheme, for $t \\in ( t_n, t_{n+1}]$\n\\begin{eqnarray*}\ny_5(0) & = & x_0,  \\\\\ny_1(t) & =& y_5(t_n) -b_3 \\int_{t_n}^t \\sqrt{y_1(s)} \\ln\n(1+y_5(t_n))\nds, \\\\\ny_2(t) & = & y_1(t_{n+1}) -b_2 \\int_{t_n}^t\ny_2(s)y_5^{\\frac{1}{4}}(t_n) ds,\n\\\\\ny_3(t) & = & y_2(t_{n+1}) - b_1 \\int_{t_n}^t y_3^{\\frac{3}{4}}(s)\nds,\n\\\\\ny_4(t) & = & y_3(t_{n+1}) + \\int_{t_n}^t a_3 y_4(s) -\na_2\\sqrt{y_4(s)}\nds, \\\\\ny_5(t) & = & y_4(t_{n+1}) + a_1\\Delta+ \\int_{t_n}^t y_5(s)\n\\big(-a_4 y_5^{\\frac{r-1}{2}}(t_n) + \\sigma^2 y_5^{\\rho-1}(t_n)\n\\big) ds + \\int_{t_n}^t 2 \\sigma y_5^{\\frac{\\rho-1}{2}}(t_n)y_5(s)\ndw_s\n\\end{eqnarray*}\nThe solutions are\n\\begin{eqnarray*}\ny_1(t) & = & \\Big(\\sqrt{y_5(t_n)}-\\frac{b_3\n\\ln(1+y_5(t_n))}{2}(t-t_n) \\Big)^2, \\\\\ny_2(t) & = & y_1(t_{n+1}) e^{-b_2y_5(t_n) (t-t_n)}, \\\\\ny_3(t) & = & \\Big(\\sqrt[4]{y_2(t_{n+1})} - b_1\\frac{t-t_n}{4}\n\\Big)^4,\\\\\ny_4(t) & = & \\Big(\\frac{a_2}{a_3} + (\\sqrt{y_3(t_n)} -\n\\frac{a_2}{a_3}) e^{a_3\\frac{(t-t_n)}{2}} \\Big)^2, \\\\\ny_5(t) & = & (y_4(t_{n+1}) + a_1\\Delta)\ne^{-\\Delta(\\sigma^2y_5^{\\rho-1}(t_n) + a_4\ny_5^{\\frac{r-1}{2}}(t_n)) + 2 \\sigma y_5^{\\frac{\\rho-1}{2}}(t_n)\n\\Delta W}\n\\end{eqnarray*}\n\n\n\nThis use of the splitting-semi discrete technique produces a\npositivity preserving and explicit numerical scheme.\n\n\n\nAnother, obviously generalization, is that we can semi-discretize\nin the time variable also. For example we can assume the following\nassumption,\n\\[0.2cm]\n{\\bf Assumption C} Suppose that the functions $f_i$ for\n$i=1,...,m$ satisfy the following locally Lipschitz condition,\n\\begin{eqnarray*}\n |f_i(t,t,x,x,x) - f_i(t,t_1,x_1,x_2,x_3)|  & \\leq &  C_R (|t-t_1|^{b_1}+|x-x_1| +\n|x-x_2|+|x-x_3| ), \\quad i=2,...,m \\\\\n|f_{m+1}(t,t,x,x) - f_{m+1}(t,t_1,x_1,x_2)| & \\leq & C_R\n(|t-t_1|^{b_2}+|x-x_1| + |x-x_2| + |x-x_1|^a)\n\\end{eqnarray*}\nfor $|x_1|, |x_2|, |x_3|, |x| \\leq R$, for $t,t_1 \\in [0,T]$, for\nsome $a \\in [\\frac{1}{2},1)$ and for some $b_1,b_2 > 0$. With this\nkind of generalization we can handle problems which has time\ndepending parameters (see \\cite{Halidias1}).\n\n\n\n\n\nThere is also the possibility to split the diffusion term. For\nexample, if $a_1+...+a_m = a$ and $b_1+...+b_l = b$ then for $ t\n\\in (t_n,t_{n+1}]$,\n\\begin{eqnarray*}\ny_m(0) & = & x_0, \\nonumber \\\\\ny_1(t) & = & y_m(t_n) + \\int_{t_n}^t a_1(s,y_1(s)) ds, \\\\\n & \\vdots & \\\\\n y_i(t) & = & y_{i-1}(t_{n+1}) + \\int_{t_n}^t a_i(s,y_i(s))ds +\n \\int_{t_n}^t b_1(s,y_i(s))dw_s, \\\\\n& \\vdots & \\\\\n y_j(t) & = & y_{j-1}(t_{n+1}) + \\int_{t_n}^t a_j(s,y_j(s))ds, \\\\\n& \\vdots & \\\\\ny_m(t) & =  & y_m(t_{n+1}) + \\int_{t_n}^t a_m(s,y_2(s)) ds +\n\\int_{t_n}^t b_{l}(s,y_m(s))dw_s\n\\end{eqnarray*}\nwhere $i,j \\in \\{1,...,m \\}$. The general idea is that if we want\nto construct a numerical scheme with values in a domain $D$ then\nwe can split accordingly such as $y_1 \\in D_1$, whenever the\ninitial value (for $y_1$) is in $D$, $y_2 \\in D_2$ whenever the\ninitial value is in $D_1$ and finally $y_m \\in D$ whenever the\ninitial value for $y_m$ is in $D_{m-1}$.\n\n\n\n\nTo approximate any of the above equations which do not have a\ndiffusion term we can use any suitable numerical scheme and any\nsemi discrete approximation. The same holds also for the first\nstochastic differential equation (in our setting is the\n$i$-equation) but to approximate any other stochastic differential\nequation (i.e. with a diffusion term) we should fully discretize\nthe corresponding sde, i.e. we can not use a semi discrete method.\nIf we want to produce a boundary preserving numerical scheme then\nthese  sdes (that we should fully discretize) can be approximated\nby balanced Milstein methods (see \\cite{Kahl}, \\cite{Milstein},\n\\cite{Milstein2} and \\cite{Dan}).\n\n\n\n\n\n\n\n\nAn interesting question (that we do not answer in this paper) is\nthe rate of convergence of the explicit numerical schemes that the\nsemi discrete method produces. In  \\cite{Hunt1}, \\cite{Hunt2},\n\\cite{Jentzen}  the authors study the convergence rates of various\nnumerical schemes and it seems that these techniques will be\nuseful also for the semi discrete schemes.\n\n\n\n\\begin{thebibliography}{99}\n\n\\bibitem{Ait} Y. Ait-Sahalia, Testing continuous-time models of\nthe spot interest rate, Rev. Financ. Stud. 9 (2) 385-426, (1996)\n\n\n\\bibitem{Dan} C. E. Dangerfield - D. Kay - S. MacNamara - K.\nBurrage, A boundary preserving numerical algorithm for the\nWright-Fisher model with mutation, BIT Numerical Mathematics,\nVolume 52, Issue 2, pp 283-304, (2012)\n\n\\bibitem{Halidias1} Halidias Nikolaos,  Semi-discrete approximations\nfor stochastic differential equations and applications, Int. J.\nComput. Math. 89, No. 6, 780-794, (2012)\n\n\n\n\\bibitem{Halidias2} Halidias Nikolaos,  A novel approach to construct\nnumerical methods for stochastic differential equations, Numerical\nAlgorithms, Springer, (6), 79-87, (2014)\n\n\n\n\\bibitem{Halidias3} Halidias Nikolaos,  Construction of positivity\npreserving numerical schemes for multidimensional stochastic\ndifferential equations, Discrete and Continuous Dynamical\nSystems-Series B,  20, 153-160, (2015)\n\n\n\n\n\n\\bibitem{Halidias4} Halidias Nikolaos, A new numerical scheme\nfor the CIR process, Monte Carlo Methods and Applications, Volume\n21, Issue 3, pp. 245-253, (2015)\n\n\n\\bibitem{Halidias5} Halidias Nikolaos,  An explicit and positivity\npreserving numerical scheme for the mean reverting CEV model,\nJapan J. Indust. Appl. Math. 32, 545-552 (2015)\n\n\n\n\n\n\n\n\n\n\\bibitem{Halidias6} Halidias Nikolaos, Constructing positivity preserving numerical schemes for the two-factor CIR\nmodel, Monte Carlo Methods Appl. 21, No. 4, 313-323 (2015)\n\n\n\n\\bibitem{Halidias7} N. Halidias - I. Stamatiou, Approximating explicitly the mean-reverting CEV\nprocess, Journal of Probability and Statistics, Volume 2015 (2015)\n\n\\bibitem{Halidias8} N. Halidias - I. Stamatiou, On the numerical solution of some nonlinear stochastic differential equations using the semi discrete\nmethod, Computational Methods in Applied Mathematics, Volume 16,\nIssue 1,  105-132, (2016)\n\n\\bibitem{Hunt1} M.  Hutzenthaler - A. Jentzen - M. Noll, Strong convergence rates and temporal regularity for Cox-Ingersoll-Ross processes and Bessel processes with accessible\nboundaries, arXiv:1403.6385\n\n\\bibitem{Hunt2} M.  Hutzenthaler - A. Jentzen, Numerical approximations of stochastic differential equations with non-globally Lipschitz continuous\ncoefficients, Memoirs of the American Mathematical Society, Volume\n236, Number 1112, (2015)\n\n\\bibitem{Jentzen} A. Jentzen -  T. M\\\"{u}ller-Gronbach - L.\nYaroslavtseva, On stochastic differential equations with arbitrary\nslow convergence rates for strong approximation, arXiv:1506.02828\n\n\\bibitem{Kahl} C. Kahl - H. Schurz, Balanced Milstein methods for ordinary\nSDEs, Monte Carlo Methods and Applications, Volume 12, Issue 2,\nPages 143-170, (2006)\n\n\\bibitem{Milstein} G. N. Milstein - E. Platen -  H. Schurz, Balanced implicit methods for stiff stochastic\nsystems, SIAM Journal on Numerical Analysis Vol. 35, No. 3, pp.\n1010-1019, (1998)\n\n\\bibitem{Milstein2} G. N. Milstein - M. Tretyakov, Stochastic\nNumerics for Mathematical Physics, Springer, (2004)\n\n\\bibitem{schurz1} E. Moro - H. Schurz,  Boundary\npreserving semi-analytic numerical algorithms for stochastic\ndifferential equations, SIAM J. Sci. Comput. 29 1525-1549 (2007)\n\n\\bibitem{Andreas} A. Neuenkirch - L. Szpruch, First order strong approximations of scalar SDEs with values in a domain, Numerische Mathematik,  Volume 128, Issue 1, pp 103-136, (2014)\n\n\\bibitem{Mao} L. Szpruch - X. Mao - D. Higham - J. Pan, Numerical\nsimulation of a strongly nonlinear Ait-Sahalia-type interest rate\nmodel, BIT Numer. Math.  51, pp. 405-425 (2011)\n\n\n\n\\end{thebibliography}\n\n\n", "itemtype": "equation", "pos": 11832, "prevtext": "\n \n", "index": 5, "text": "$$\n |\\phi_{q}^{\\prime \\prime }(x)|\\leq\\frac{2}{q|x|}, \\,\\hbox{ when }  \\,e_q<|x|<e_{q-1} \\,\\hbox{ and }  \\,  |\\phi_{q}^{\\prime \\prime }(x)|=0 \\,\\hbox{ otherwise. }\n $$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"|\\phi_{q}^{\\prime\\prime}(x)|\\leq\\frac{2}{q|x|},\\,\\hbox{ when }\\,e_{q}&lt;|x|&lt;e_{q%&#10;-1}\\,\\hbox{ and }\\,|\\phi_{q}^{\\prime\\prime}(x)|=0\\,\\hbox{ otherwise. }\" display=\"block\"><mrow><mrow><mrow><mo stretchy=\"false\">|</mo><mrow><msubsup><mi>\u03d5</mi><mi>q</mi><mi>\u2032\u2032</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">|</mo></mrow><mo>\u2264</mo><mfrac><mn>2</mn><mrow><mi>q</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mi>x</mi><mo stretchy=\"false\">|</mo></mrow></mrow></mfrac></mrow><mo rspace=\"4.2pt\">,</mo><mrow><mrow><mpadded width=\"+1.7pt\"><mtext>\u00a0when\u00a0</mtext></mpadded><mo>\u2062</mo><msub><mi>e</mi><mi>q</mi></msub></mrow><mo>&lt;</mo><mrow><mo stretchy=\"false\">|</mo><mi>x</mi><mo stretchy=\"false\">|</mo></mrow><mo>&lt;</mo><mrow><mpadded width=\"+1.7pt\"><msub><mi>e</mi><mrow><mi>q</mi><mo>-</mo><mn>1</mn></mrow></msub></mpadded><mo>\u2062</mo><mpadded width=\"+1.7pt\"><mtext>\u00a0and\u00a0</mtext></mpadded><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mrow><msubsup><mi>\u03d5</mi><mi>q</mi><mi>\u2032\u2032</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">|</mo></mrow></mrow><mo>=</mo><mrow><mpadded width=\"+1.7pt\"><mn>0</mn></mpadded><mo>\u2062</mo><mtext>\u00a0otherwise.\u00a0</mtext></mrow></mrow></mrow></math>", "type": "latex"}]