[{"file": "1601.02359.tex", "nexttext": "\nAfter that, the system blur is still over 1.0 mm, much more lager than one pixel size at object plane. In order to gain better result, the blur factor must be considered in density reconstruction.\n\nAt present, the blur effect of the areal source is usually handled as a space-invariant blur as the detector blur in the most popular reconstruction methods includes analytical methods (such as Abel transform, filter back projection(FBP)) , iterative methods(such as ART). In hydro-test radiography, the statistic method Bayesian Inference Engine is used at Los Alamos National Laboratory(LANL), which is a type of constrained method for the statistic term of the object information equals a constraint. Meanwhile, the LANL forward model for density reconstruction was proposed\\cite{Aufderheide2002}. In the model, the source size effect is also considered space-invariant as the detector blur. They payed more attention on the attenuation coefficient of spectrum effect rather than the systematic blur.\n\nIn this paper, we proposed our forward reconstruction model with space-variant of source size. The space-variant of the source size is considered, and it is achieved using x-ray trace technique and gridded source methods. Our model was verified by comparing between experimental image and calculated image.\n\n\\section{theory} \\label{sec.theory}\n\n\n\n\\subsection{forward model}\n\n\n\tIn ref\\cite{Aufderheide2002}, the LANL forward model is\n\n", "itemtype": "equation", "pos": 3469, "prevtext": "\n\n\\include{newcmd}\n\n\n\n\n\n\n\\title{ Forward model with space-variant of source size  for reconstruction on x-ray radiographic image }\n\\author{Jin Liu$^{1}$\\footnote{E-mail:ljin$\\_$ifp@caep.ac.cn},Jun Liu$^{1}$, Yue-feng Jing$^{1}$,\nBo Xiao$^{1}$,Cai-hua Wei$^{1}$,Yong-hong Guan$^{1}$, Xuan Zhang$^{1}$}\n\n\\affiliation{ $ ^1$ Institute of Fluid Physics, CAEP, P. O. Box 919-105, Mianyang 621900, China }\n\n\\date{\\today}\n\\maketitle\n\n\\begin{center}\n{\\bf Abstract}\n\n\\begin{minipage}{15cm}\n{ \\small\n\\hskip 0.25cm\n\n Forward imaging technique is the base of combined method on density reconstruction with the forward calculation and inverse problem solution. In the paper, we introduced the projection equation for the radiographic system with areal source blur and detector blur, gained the projecting matrix from any point source to any detector pixel with x-ray trace technique, proposed the ideal on gridding the areal source as many point sources with different weights, and used the blurring window as the effect of the detector blur. We used the forward projection equation to gain the same deviation information about the object edge as the experimental image. Our forward projection equation is combined with Constrained Conjugate Gradient method to form a new method for density reconstruction, XTRACE-CCG. The new method worked on the simulated image of French Test Object and experimental image. The same results have been concluded the affecting range of the blur is decreased and can be controlled to one or two pixels. The method is also suitable for reconstruction of density-variant object. The capability of our method to handle blur effect is useful for  all radiographic systems with larger source size comparing to pixel size. }\n\n\\end{minipage}\n\\end{center}\n\n\n\n\n\\newpage\n\n\n\n\n\n\n\n\n\n\n\n\\section{Introduction}\\label{sec.introduction}\n\nAfter the Comprehensive Test Ban Treaty (CTBT) \\cite{Cunningham:2003}, the high-energy x-ray flash radiography has become an important technique to determine the edges and\ndensity distributions of materials for the hydro-test. The intensity of the X-ray beam obeys Beer-Lambert law when it passes through an object,\nand the Beer-Lambert law is the basic for density reconstruction\\cite{Morris2003}. In the x-ray flash radiographic system with the goal to achieve 1\\% density uncertainty, the 100ns, 2 kA, 20 MeV electron beam is used as the driven source to produce bremsstrahlung x-ray beam with average energy about 3-5 MeV, which has the most powerful penetrating capability. Although, the mean free path of French Test Object(FTO) exceeds 8.0\\cite{Cunningham:2003}, the intensity of the  most powerful x-ray reduced to below one thousandth, and reduce the ratio of signal to noise. Besides the noise, the blur is an important factor for density reconstruction. The systematic blur of x-ray radiography consists of source size and detector blur. The space charge effect of the kA level current limits the reduction of the source size, and the full width of half maximum (FWHM) of source size is over 1.0 mm for the leading machines such as DARHT and Dragon-I\\cite{Davis2006,Ding:2005,Jiang2012}. The detector blur of 20 mm CsI plate is about 2.1 mm.\n\nSome experimental measurement is carried out to reduce the impact of the blur on the image quantity. We can optimize the system magnification to make the system blur as small as possible. And the optimized magnification \\textit{m} is satisfied that\\cite{Burns:1999,LJIN2012}\n\n", "index": 1, "text": "\\begin{equation}\\label{eq.magification}\n    m =1+\\frac{\\textrm{FWHM}^{2}_{\\textrm{D}}}{\\textrm{FWHM}^{2}_{\\textrm{S}}},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"m=1+\\frac{\\textrm{FWHM}^{2}_{\\textrm{D}}}{\\textrm{FWHM}^{2}_{\\textrm{S}}},\" display=\"block\"><mrow><mrow><mi>m</mi><mo>=</mo><mrow><mn>1</mn><mo>+</mo><mfrac><msubsup><mtext>FWHM</mtext><mtext>D</mtext><mn>2</mn></msubsup><msubsup><mtext>FWHM</mtext><mtext>S</mtext><mn>2</mn></msubsup></mfrac></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02359.tex", "nexttext": "\nWhere $\\textbf{B}_{ij}$, $\\textbf{B}'_{i,j}$ are the elements of  matrix of detector blur and source blur, respectively. The $S_{j}$ is the photon number of the jth energy bin. The $u_{ijk}$ is the mass absorption of material $l$ in voxel $k$ at energy bin $j$. $a_{ik}$ is ikth element of the projection matrix $\\textbf{A}$, $\\zeta_{j}$  is scatter radiation at detector i.\nIn Equ.\\ref{eq.LANL_model}, the source blur is a convolution matrix at detector plane. It means that the source blur is space-invariant.\nIn fact, the projection matrix $\\textbf{A}$ is different via the change of the source position. So we proposed our forward model(IFP model)with many weighted source points. The model is\n\n\n", "itemtype": "equation", "pos": 5040, "prevtext": "\nAfter that, the system blur is still over 1.0 mm, much more lager than one pixel size at object plane. In order to gain better result, the blur factor must be considered in density reconstruction.\n\nAt present, the blur effect of the areal source is usually handled as a space-invariant blur as the detector blur in the most popular reconstruction methods includes analytical methods (such as Abel transform, filter back projection(FBP)) , iterative methods(such as ART). In hydro-test radiography, the statistic method Bayesian Inference Engine is used at Los Alamos National Laboratory(LANL), which is a type of constrained method for the statistic term of the object information equals a constraint. Meanwhile, the LANL forward model for density reconstruction was proposed\\cite{Aufderheide2002}. In the model, the source size effect is also considered space-invariant as the detector blur. They payed more attention on the attenuation coefficient of spectrum effect rather than the systematic blur.\n\nIn this paper, we proposed our forward reconstruction model with space-variant of source size. The space-variant of the source size is considered, and it is achieved using x-ray trace technique and gridded source methods. Our model was verified by comparing between experimental image and calculated image.\n\n\\section{theory} \\label{sec.theory}\n\n\n\n\\subsection{forward model}\n\n\n\tIn ref\\cite{Aufderheide2002}, the LANL forward model is\n\n", "index": 3, "text": "\\begin{equation}\\label{eq.LANL_model}\n    y_{i}=\\sum_{j} \\textbf{B}_{ij}\\textbf{B}'_{i,j}[S_{j}\\exp (-\\sum_{l}\\sum_{k}\\mu_{ljk}a_{ik}x_{k})+\\zeta_{j}].\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"y_{i}=\\sum_{j}\\textbf{B}_{ij}\\textbf{B}^{\\prime}_{i,j}[S_{j}\\exp(-\\sum_{l}\\sum%&#10;_{k}\\mu_{ljk}a_{ik}x_{k})+\\zeta_{j}].\" display=\"block\"><mrow><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mi>j</mi></munder><mrow><msub><mtext>\ud835\udc01</mtext><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><msubsup><mtext>\ud835\udc01</mtext><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow><mo>\u2032</mo></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mrow><msub><mi>S</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mi>l</mi></munder><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mi>k</mi></munder><mrow><msub><mi>\u03bc</mi><mrow><mi>l</mi><mo>\u2062</mo><mi>j</mi><mo>\u2062</mo><mi>k</mi></mrow></msub><mo>\u2062</mo><msub><mi>a</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>k</mi></mrow></msub><mo>\u2062</mo><msub><mi>x</mi><mi>k</mi></msub></mrow></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><msub><mi>\u03b6</mi><mi>j</mi></msub></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02359.tex", "nexttext": "\nWhere $\\textbf{X}_{T}$ is total dose at detector plane, $\\textbf{B}_{det}$ is detector blur matrix, $w_{i}$ is the ith source weight, $X_{0}$ is dose for empty field at detector plane, $\\textbf{A}^{i}$ is the projection matrix of the ith source, $X_{S}^{i}$ is scatter dose and $\\xi$ is noise.\n\nIf we consider that source blur is space-invariant, we can just use the blur matrix $\\textbf{B}_{sys}$ to demonstrate system blur, which is equal to $\\textbf{B}_{ij}\\textbf{B}'_{i,j}$ of Equ.\\ref{eq.LANL_model} as LANL model does. And we use $\\textbf{B}_{sys}$ as system blur to instead of $\\textbf{B}_{det}\\sum_{i}w_{i}$ in Equ.\\ref{eq.proposed_model}, we obtained the projection equation with space-invariant blur as LANL model\n\n\n", "itemtype": "equation", "pos": 5906, "prevtext": "\nWhere $\\textbf{B}_{ij}$, $\\textbf{B}'_{i,j}$ are the elements of  matrix of detector blur and source blur, respectively. The $S_{j}$ is the photon number of the jth energy bin. The $u_{ijk}$ is the mass absorption of material $l$ in voxel $k$ at energy bin $j$. $a_{ik}$ is ikth element of the projection matrix $\\textbf{A}$, $\\zeta_{j}$  is scatter radiation at detector i.\nIn Equ.\\ref{eq.LANL_model}, the source blur is a convolution matrix at detector plane. It means that the source blur is space-invariant.\nIn fact, the projection matrix $\\textbf{A}$ is different via the change of the source position. So we proposed our forward model(IFP model)with many weighted source points. The model is\n\n\n", "index": 5, "text": "\\begin{equation}\\label{eq.proposed_model}\n    \\textbf{X}_{T}=\\textbf{B}_{det}\\sum_{i}[w_{i}X_{0}\\exp(-\\textbf{A}^{(i)}\\textbf{x})]+X_{S}+\\xi\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"\\textbf{X}_{T}=\\textbf{B}_{det}\\sum_{i}[w_{i}X_{0}\\exp(-\\textbf{A}^{(i)}%&#10;\\textbf{x})]+X_{S}+\\xi\" display=\"block\"><mrow><msub><mtext>\ud835\udc17</mtext><mi>T</mi></msub><mo>=</mo><mrow><mrow><msub><mtext>\ud835\udc01</mtext><mrow><mi>d</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>t</mi></mrow></msub><mo>\u2062</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mi>i</mi></munder><mrow><mo stretchy=\"false\">[</mo><mrow><msub><mi>w</mi><mi>i</mi></msub><mo>\u2062</mo><msub><mi>X</mi><mn>0</mn></msub><mo>\u2062</mo><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mrow><msup><mtext>\ud835\udc00</mtext><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>\u2062</mo><mtext>\ud835\udc31</mtext></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow><mo>+</mo><msub><mi>X</mi><mi>S</mi></msub><mo>+</mo><mi>\u03be</mi></mrow></mrow></math>", "type": "latex"}, {"file": "1601.02359.tex", "nexttext": "\n\n\\subsection{projection matrix}\nThe different source point \\textit{i} induces different projection matrix $\\textbf{A}^{(i)}$. The layout of x-ray radiography is shown in Fig.\\ref{fig.layout}.\n\\begin{figure}[htpb]\n\\centering\n  \\includegraphics[height=1.5in]{layout}\\\\\n  \\caption{The layout of x-ray radiography system with cone beam} \\label{fig.layout}\n\\end{figure}\n\n\nThe object of a single view radiographic system is rotational symmetrical and can be divided into 2D grids(see Fig.\\ref{fig.gridded_object}). Along the rotational axis, the grids are parallel slabs with thickness $\\Delta h$ , and the grids are concentric circles with radius increment $\\Delta r$  on the Fig.\\ref{fig.gridded_object}.\n\n\\begin{figure}[h]\n\\centering\n \\subfigure[grids along rotational axis]{\n   \\label{fig.grid_along_rotational_axis} \n    \\includegraphics[height=2.0in]{grid_along_rotational_axis}} \\hspace{0.1cm}\n     \\subfigure[grids vertical to rotational axis]{\n    \\label{fig.grid_circles} \n    \\includegraphics[height=2.0in]{grid_circles}} \\hspace{0.1cm}\n\\setlength{\\abovecaptionskip}{2pt}\n\\setlength{\\belowcaptionskip}{-6pt} \\caption{The grids of rotational object}\n\\label{fig.gridded_object} \n\\end{figure}\n\n\n\nAfter the source position and object model was determined, We used x-ray trace method to calculate the matrix $\\textbf{A}^{i}$. With arbitrary source point O ($x_{\\textrm{O}},y_{\\textrm{O}},z_{\\textrm{O}}$), detected point R($x_{\\textrm{R}}, y_{\\textrm{R}},z_{\\textrm{R}}$) and its projecting point R'($x_{\\textrm{R}}, y_{\\textrm{R}},z_{\\textrm{O}}$) at vertical plane at $z=z_{\\textrm{O}}$. The X-ray $\\overrightarrow{\\textrm{OR}}$ intersects with the object and its projection  is $\\overrightarrow{\\textrm{OR}'}$ in plane $z=z_{\\textrm{O}}$. At this plane, X-ray  intersects with the concentric circles of the gridded object and forms \\textit{n}+1 points of intersection. From the Fig.\\ref{fig.intersection_with_horizontal_grids} the distance from the source point $\\textrm{O}$ to the intersecting point is\n\n\n", "itemtype": "equation", "pos": 6788, "prevtext": "\nWhere $\\textbf{X}_{T}$ is total dose at detector plane, $\\textbf{B}_{det}$ is detector blur matrix, $w_{i}$ is the ith source weight, $X_{0}$ is dose for empty field at detector plane, $\\textbf{A}^{i}$ is the projection matrix of the ith source, $X_{S}^{i}$ is scatter dose and $\\xi$ is noise.\n\nIf we consider that source blur is space-invariant, we can just use the blur matrix $\\textbf{B}_{sys}$ to demonstrate system blur, which is equal to $\\textbf{B}_{ij}\\textbf{B}'_{i,j}$ of Equ.\\ref{eq.LANL_model} as LANL model does. And we use $\\textbf{B}_{sys}$ as system blur to instead of $\\textbf{B}_{det}\\sum_{i}w_{i}$ in Equ.\\ref{eq.proposed_model}, we obtained the projection equation with space-invariant blur as LANL model\n\n\n", "index": 7, "text": "\\begin{equation}\\label{eq.proposed_model_space_invariant}\n    \\textbf{X}_{T}=\\textbf{B}_{sys}[X_{0}\\exp(-\\textbf{A}^{(i)}\\textbf{x})]+X_{S}+\\xi\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"\\textbf{X}_{T}=\\textbf{B}_{sys}[X_{0}\\exp(-\\textbf{A}^{(i)}\\textbf{x})]+X_{S}+\\xi\" display=\"block\"><mrow><msub><mtext>\ud835\udc17</mtext><mi>T</mi></msub><mo>=</mo><mrow><mrow><msub><mtext>\ud835\udc01</mtext><mrow><mi>s</mi><mo>\u2062</mo><mi>y</mi><mo>\u2062</mo><mi>s</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><msub><mi>X</mi><mn>0</mn></msub><mo>\u2062</mo><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mrow><msup><mtext>\ud835\udc00</mtext><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>\u2062</mo><mtext>\ud835\udc31</mtext></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mo>+</mo><msub><mi>X</mi><mi>S</mi></msub><mo>+</mo><mi>\u03be</mi></mrow></mrow></math>", "type": "latex"}, {"file": "1601.02359.tex", "nexttext": "\nWhere $\\textrm{O}^{*}$ is the center point of the object, $|\\overrightarrow{\\textrm{OO}^{*}}|$  is the length of the vector $\\overrightarrow{\\textrm{OO}^{*}}$ , $\\alpha$  is the angle between vectors $\\overrightarrow{\\textrm{OO}^{*}}$  and $\\overrightarrow{\\textrm{OR}'}$. Using Equ.\\ref{eq.distance}, we obtained ordered distances of the $\\ell_{rp}$'s and they can be described as $ \\ell_{r_{0}},\\ell_{r_{0}},\\cdots,\\ell_{r_{n}}$. Then  projecting the X-ray $\\overrightarrow{\\textrm{OR}'}$  back to   $\\overrightarrow{\\textrm{OR}}$,  the really lengths of the X-ray $\\overrightarrow{\\textrm{OR}}$  intersects of the object are gained as $ \\ell_{r_{0}}/\\cos\\phi,\\ell_{r_{0}}/\\cos\\phi,$ $\\cdots,\\ell_{r_{n}}/\\cos\\phi$ .Where $\\cos\\phi$ is the cosine of the angle between the  vectors $\\overrightarrow{\\textrm{OR}'}$ and  $\\overrightarrow{\\textrm{OR}}$ .\n\n\\begin{figure}[h]\n\\centering\n \\subfigure[intersection with horizontal grids]{\n   \\label{fig.intersection_with_horizontal_grids} \n    \\includegraphics[height=1.5in]{intersection_with_horizontal_grids}} \\hspace{0.1cm}\n     \\subfigure[intersection with vertical grids]{\n    \\label{fig.intersection_with_vertical_grids} \n    \\includegraphics[height=1.0in]{intersection_with_vertical_grids}} \\hspace{0.1cm}\n\\setlength{\\abovecaptionskip}{2pt}\n\\setlength{\\belowcaptionskip}{-6pt} \\caption{The intersection of the x-ray and gridded object}\n\\label{fig.intersections} \n\\end{figure}\n\nThen we calculated the distance from the source point $\\textrm{O}$ to intersecting point of the x-ray and gridded object at  the surface of slabs on Fig.\\ref{fig.intersection_with_vertical_grids}. Because the $q$th slab position is at plane $z=z_{\\textrm{q}}$, the distance $\\ell_{rq}$  is\n\n", "itemtype": "equation", "pos": 8955, "prevtext": "\n\n\\subsection{projection matrix}\nThe different source point \\textit{i} induces different projection matrix $\\textbf{A}^{(i)}$. The layout of x-ray radiography is shown in Fig.\\ref{fig.layout}.\n\\begin{figure}[htpb]\n\\centering\n  \\includegraphics[height=1.5in]{layout}\\\\\n  \\caption{The layout of x-ray radiography system with cone beam} \\label{fig.layout}\n\\end{figure}\n\n\nThe object of a single view radiographic system is rotational symmetrical and can be divided into 2D grids(see Fig.\\ref{fig.gridded_object}). Along the rotational axis, the grids are parallel slabs with thickness $\\Delta h$ , and the grids are concentric circles with radius increment $\\Delta r$  on the Fig.\\ref{fig.gridded_object}.\n\n\\begin{figure}[h]\n\\centering\n \\subfigure[grids along rotational axis]{\n   \\label{fig.grid_along_rotational_axis} \n    \\includegraphics[height=2.0in]{grid_along_rotational_axis}} \\hspace{0.1cm}\n     \\subfigure[grids vertical to rotational axis]{\n    \\label{fig.grid_circles} \n    \\includegraphics[height=2.0in]{grid_circles}} \\hspace{0.1cm}\n\\setlength{\\abovecaptionskip}{2pt}\n\\setlength{\\belowcaptionskip}{-6pt} \\caption{The grids of rotational object}\n\\label{fig.gridded_object} \n\\end{figure}\n\n\n\nAfter the source position and object model was determined, We used x-ray trace method to calculate the matrix $\\textbf{A}^{i}$. With arbitrary source point O ($x_{\\textrm{O}},y_{\\textrm{O}},z_{\\textrm{O}}$), detected point R($x_{\\textrm{R}}, y_{\\textrm{R}},z_{\\textrm{R}}$) and its projecting point R'($x_{\\textrm{R}}, y_{\\textrm{R}},z_{\\textrm{O}}$) at vertical plane at $z=z_{\\textrm{O}}$. The X-ray $\\overrightarrow{\\textrm{OR}}$ intersects with the object and its projection  is $\\overrightarrow{\\textrm{OR}'}$ in plane $z=z_{\\textrm{O}}$. At this plane, X-ray  intersects with the concentric circles of the gridded object and forms \\textit{n}+1 points of intersection. From the Fig.\\ref{fig.intersection_with_horizontal_grids} the distance from the source point $\\textrm{O}$ to the intersecting point is\n\n\n", "index": 9, "text": "\\begin{equation}\\label{eq.distance}\n    \\ell_{rp}=|\\overrightarrow{\\textrm{OO}^{*}}|\\cos\\alpha\\pm\\sqrt{r^{2}-(|\\overrightarrow{\\textrm{OO}^{*}}|\\sin\\alpha)^{2}}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"\\ell_{rp}=|\\overrightarrow{\\textrm{OO}^{*}}|\\cos\\alpha\\pm\\sqrt{r^{2}-(|%&#10;\\overrightarrow{\\textrm{OO}^{*}}|\\sin\\alpha)^{2}}\" display=\"block\"><mrow><msub><mi mathvariant=\"normal\">\u2113</mi><mrow><mi>r</mi><mo>\u2062</mo><mi>p</mi></mrow></msub><mo>=</mo><mrow><mrow><mrow><mo stretchy=\"false\">|</mo><mover accent=\"true\"><msup><mtext>OO</mtext><mo>*</mo></msup><mo>\u2192</mo></mover><mo stretchy=\"false\">|</mo></mrow><mo>\u2062</mo><mrow><mi>cos</mi><mo>\u2061</mo><mi>\u03b1</mi></mrow></mrow><mo>\u00b1</mo><msqrt><mrow><msup><mi>r</mi><mn>2</mn></msup><mo>-</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mo stretchy=\"false\">|</mo><mover accent=\"true\"><msup><mtext>OO</mtext><mo>*</mo></msup><mo>\u2192</mo></mover><mo stretchy=\"false\">|</mo></mrow><mo>\u2062</mo><mrow><mi>sin</mi><mo>\u2061</mo><mi>\u03b1</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></mrow></msqrt></mrow></mrow></math>", "type": "latex"}, {"file": "1601.02359.tex", "nexttext": "\nWhere $u$ is the cosine of the angle between the vector $\\overrightarrow{\\textrm{OR}}$ and z-axis. Now, we put all the distance into a set $\\{ \\ell_{r_{0}}/\\cos\\phi,\\ell_{r_{0}}/\\cos\\phi,\\cdots,\\ell_{r_{n}}/\\cos\\phi,\\ell_{z0},\\ell_{zq},\\cdots, \\ell_{zm}\\}$ ,called C. After putting the all data in the set C in ascending sort, we got the right set D $ \\{\\ell_{0},\\ell_{1},\\cdots,\\ell_{n+m+1}\\}$ to gain projection elements $\\textbf{A}^{(i)}_{kl}$ , and it follows\n\n", "itemtype": "equation", "pos": 10848, "prevtext": "\nWhere $\\textrm{O}^{*}$ is the center point of the object, $|\\overrightarrow{\\textrm{OO}^{*}}|$  is the length of the vector $\\overrightarrow{\\textrm{OO}^{*}}$ , $\\alpha$  is the angle between vectors $\\overrightarrow{\\textrm{OO}^{*}}$  and $\\overrightarrow{\\textrm{OR}'}$. Using Equ.\\ref{eq.distance}, we obtained ordered distances of the $\\ell_{rp}$'s and they can be described as $ \\ell_{r_{0}},\\ell_{r_{0}},\\cdots,\\ell_{r_{n}}$. Then  projecting the X-ray $\\overrightarrow{\\textrm{OR}'}$  back to   $\\overrightarrow{\\textrm{OR}}$,  the really lengths of the X-ray $\\overrightarrow{\\textrm{OR}}$  intersects of the object are gained as $ \\ell_{r_{0}}/\\cos\\phi,\\ell_{r_{0}}/\\cos\\phi,$ $\\cdots,\\ell_{r_{n}}/\\cos\\phi$ .Where $\\cos\\phi$ is the cosine of the angle between the  vectors $\\overrightarrow{\\textrm{OR}'}$ and  $\\overrightarrow{\\textrm{OR}}$ .\n\n\\begin{figure}[h]\n\\centering\n \\subfigure[intersection with horizontal grids]{\n   \\label{fig.intersection_with_horizontal_grids} \n    \\includegraphics[height=1.5in]{intersection_with_horizontal_grids}} \\hspace{0.1cm}\n     \\subfigure[intersection with vertical grids]{\n    \\label{fig.intersection_with_vertical_grids} \n    \\includegraphics[height=1.0in]{intersection_with_vertical_grids}} \\hspace{0.1cm}\n\\setlength{\\abovecaptionskip}{2pt}\n\\setlength{\\belowcaptionskip}{-6pt} \\caption{The intersection of the x-ray and gridded object}\n\\label{fig.intersections} \n\\end{figure}\n\nThen we calculated the distance from the source point $\\textrm{O}$ to intersecting point of the x-ray and gridded object at  the surface of slabs on Fig.\\ref{fig.intersection_with_vertical_grids}. Because the $q$th slab position is at plane $z=z_{\\textrm{q}}$, the distance $\\ell_{rq}$  is\n\n", "index": 11, "text": "\\begin{equation}\\label{eq.z_distance}\n    \\ell_{zq}=(z_{\\textrm{q}}-z_{\\textrm{O}})/u,  \\texttt{if}  \\ell_{r_{0}}/\\cos\\phi \\leq \\ell_{zq}\\leq \\ell_{r_{n}}/\\cos\\phi\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"\\ell_{zq}=(z_{\\textrm{q}}-z_{\\textrm{O}})/u,\\texttt{if}\\ell_{r_{0}}/\\cos\\phi%&#10;\\leq\\ell_{zq}\\leq\\ell_{r_{n}}/\\cos\\phi\" display=\"block\"><mrow><mrow><msub><mi mathvariant=\"normal\">\u2113</mi><mrow><mi>z</mi><mo>\u2062</mo><mi>q</mi></mrow></msub><mo>=</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>z</mi><mtext>q</mtext></msub><mo>-</mo><msub><mi>z</mi><mtext>O</mtext></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>/</mo><mi>u</mi></mrow></mrow><mo>,</mo><mrow><mrow><mrow><mtext>\ud835\ude92\ud835\ude8f</mtext><mo>\u2062</mo><msub><mi mathvariant=\"normal\">\u2113</mi><msub><mi>r</mi><mn>0</mn></msub></msub></mrow><mo>/</mo><mrow><mi>cos</mi><mo>\u2061</mo><mi>\u03d5</mi></mrow></mrow><mo>\u2264</mo><msub><mi mathvariant=\"normal\">\u2113</mi><mrow><mi>z</mi><mo>\u2062</mo><mi>q</mi></mrow></msub><mo>\u2264</mo><mrow><msub><mi mathvariant=\"normal\">\u2113</mi><msub><mi>r</mi><mi>n</mi></msub></msub><mo>/</mo><mrow><mi>cos</mi><mo>\u2061</mo><mi>\u03d5</mi></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.02359.tex", "nexttext": "\nWhere the superscript $i$  of the projection matrix elements the index of the source points, the subscript $k$ is the index of the detector pixels and the subscript $l$ is the index of the object voxel.\n\n\\subsection{source position and weight}\\label{subsec.source}\nThe forward model is the base for the combined reconstruction method including the forward projection and solution of inverse problem.\nIn the most popular method, the source is usually considered as an ideal point. And it is not suitable for an areal source.\nSo it is necessary to simulate or describe the source distribution in detail other than a point.\n\nThe best methods to simulate/calculate the radiographic image is Monte Carlo (MC)method. In which the source size is achieved by sampling source point according to the source size distribution function $f(r,\\theta)$. The advantage of the MC method is that the description of the source is correct enough as the size distribution function, and the space- variant is considered naturally. But the speed for the simulating process is very slow so that the MC method is not suitable to implement into density reconstruction. Even so, the idea on description of the source position is great, and it can be expressed as weighted gridded source.In the Fig.1, the source is divided into several concentric circles with same radius increment $\\Delta r$. The source point is determined with the angle increment  $\\pi /2n$ and the source is given different weight according to source distribution function. The final source can be expressed as follows.\n\n\n\n", "itemtype": "equation", "pos": 11491, "prevtext": "\nWhere $u$ is the cosine of the angle between the vector $\\overrightarrow{\\textrm{OR}}$ and z-axis. Now, we put all the distance into a set $\\{ \\ell_{r_{0}}/\\cos\\phi,\\ell_{r_{0}}/\\cos\\phi,\\cdots,\\ell_{r_{n}}/\\cos\\phi,\\ell_{z0},\\ell_{zq},\\cdots, \\ell_{zm}\\}$ ,called C. After putting the all data in the set C in ascending sort, we got the right set D $ \\{\\ell_{0},\\ell_{1},\\cdots,\\ell_{n+m+1}\\}$ to gain projection elements $\\textbf{A}^{(i)}_{kl}$ , and it follows\n\n", "index": 13, "text": "\\begin{equation}\\label{eq.matrix_element}\n    \\textbf{A}^{(i)}_{kl}=\\ell_{n'+1}-\\ell_{n'}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"\\textbf{A}^{(i)}_{kl}=\\ell_{n^{\\prime}+1}-\\ell_{n^{\\prime}}\" display=\"block\"><mrow><msubsup><mtext>\ud835\udc00</mtext><mrow><mi>k</mi><mo>\u2062</mo><mi>l</mi></mrow><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>=</mo><mrow><msub><mi mathvariant=\"normal\">\u2113</mi><mrow><msup><mi>n</mi><mo>\u2032</mo></msup><mo>+</mo><mn>1</mn></mrow></msub><mo>-</mo><msub><mi mathvariant=\"normal\">\u2113</mi><msup><mi>n</mi><mo>\u2032</mo></msup></msub></mrow></mrow></math>", "type": "latex"}, {"file": "1601.02359.tex", "nexttext": "\nwhere j equals $\\textrm{int}[(i-1)/4n]+1$, $x_{i}$, $y_{i}$ and $w_{i}$ are source x-axis, y-axis coordinations and weights, and $\\theta_{i}$ is\n\n", "itemtype": "equation", "pos": 13162, "prevtext": "\nWhere the superscript $i$  of the projection matrix elements the index of the source points, the subscript $k$ is the index of the detector pixels and the subscript $l$ is the index of the object voxel.\n\n\\subsection{source position and weight}\\label{subsec.source}\nThe forward model is the base for the combined reconstruction method including the forward projection and solution of inverse problem.\nIn the most popular method, the source is usually considered as an ideal point. And it is not suitable for an areal source.\nSo it is necessary to simulate or describe the source distribution in detail other than a point.\n\nThe best methods to simulate/calculate the radiographic image is Monte Carlo (MC)method. In which the source size is achieved by sampling source point according to the source size distribution function $f(r,\\theta)$. The advantage of the MC method is that the description of the source is correct enough as the size distribution function, and the space- variant is considered naturally. But the speed for the simulating process is very slow so that the MC method is not suitable to implement into density reconstruction. Even so, the idea on description of the source position is great, and it can be expressed as weighted gridded source.In the Fig.1, the source is divided into several concentric circles with same radius increment $\\Delta r$. The source point is determined with the angle increment  $\\pi /2n$ and the source is given different weight according to source distribution function. The final source can be expressed as follows.\n\n\n\n", "index": 15, "text": "\\begin{equation}\\label{eq.source_parameters}\n\\left\\{\n\\begin{array}{ll}\n     x_{i}=(j-0.5)\\Delta r\\cos\\theta_{i},  \\\\\n     y_{i}=(j-0.5)\\Delta r\\sin\\theta_{i}, \\\\\n     w_{i}=\\int_{\\theta_{i-0.5}}^{\\theta_{i+0.5}}\\int_{(j-1)\\Delta r}^{j\\Delta r}f(r,\\theta)rdrd\\theta\n\\end{array}\n\\right.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m1\" class=\"ltx_Math\" alttext=\"\\left\\{\\begin{array}[]{ll}x_{i}=(j-0.5)\\Delta r\\cos\\theta_{i},\\\\&#10;y_{i}=(j-0.5)\\Delta r\\sin\\theta_{i},\\\\&#10;w_{i}=\\int_{\\theta_{i-0.5}}^{\\theta_{i+0.5}}\\int_{(j-1)\\Delta r}^{j\\Delta r}f(%&#10;r,\\theta)rdrd\\theta\\end{array}\\right.\" display=\"block\"><mrow><mo>{</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>j</mi><mo>-</mo><mn>0.5</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><mi>r</mi><mo>\u2062</mo><mrow><mi>cos</mi><mo>\u2061</mo><msub><mi>\u03b8</mi><mi>i</mi></msub></mrow></mrow></mrow><mo>,</mo></mrow></mtd><mtd/></mtr><mtr><mtd columnalign=\"left\"><mrow><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>j</mi><mo>-</mo><mn>0.5</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><mi>r</mi><mo>\u2062</mo><mrow><mi>sin</mi><mo>\u2061</mo><msub><mi>\u03b8</mi><mi>i</mi></msub></mrow></mrow></mrow><mo>,</mo></mrow></mtd><mtd/></mtr><mtr><mtd columnalign=\"left\"><mrow><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><msub><mi>\u03b8</mi><mrow><mi>i</mi><mo>-</mo><mn>0.5</mn></mrow></msub><msub><mi>\u03b8</mi><mrow><mi>i</mi><mo>+</mo><mn>0.5</mn></mrow></msub></msubsup><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>j</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><mi>r</mi></mrow><mrow><mi>j</mi><mo>\u2062</mo><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><mi>r</mi></mrow></msubsup><mrow><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>r</mi><mo>,</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>r</mi><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>r</mi></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>\u03b8</mi></mrow></mrow></mrow></mrow></mrow></mtd><mtd/></mtr></mtable><mi/></mrow></math>", "type": "latex"}, {"file": "1601.02359.tex", "nexttext": "\n\n\n\\begin{figure}[htpb]\n\\centering\n  \\includegraphics[height=2.0in]{gridded_source}\\\\\n  \\caption{The diagram of the gridded areal source with angle increment  $\\pi/2$} \\label{fig.gridded_source}\n\\end{figure}\n\n\\subsection{matrix of detector blur}\nThe effect of the blur can be expressed as a window, just as a filter window. The windows size is N*N, and N is equal to the devision of 3sigma of the blur size to pixel size. The element of window matrix is\n\n", "itemtype": "equation", "pos": 13607, "prevtext": "\nwhere j equals $\\textrm{int}[(i-1)/4n]+1$, $x_{i}$, $y_{i}$ and $w_{i}$ are source x-axis, y-axis coordinations and weights, and $\\theta_{i}$ is\n\n", "index": 17, "text": "\\begin{equation*}\n   \\theta_{i}=[(i-1)\\pi /2n],\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"\\theta_{i}=[(i-1)\\pi/2n],\" display=\"block\"><mrow><mrow><msub><mi>\u03b8</mi><mi>i</mi></msub><mo>=</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>i</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>\u03c0</mi></mrow><mo>/</mo><mn>2</mn></mrow><mo>\u2062</mo><mi>n</mi></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02359.tex", "nexttext": "\nwhere $B(x,y)$ is the distribution of the detector blur.\n\n\\subsection{space-variant of source size effect}\nThe space-variant of the size effect presents in difference of the projection matrixes from different point source. We accounted the elements numbers of the projection matrix for x-ray radiography of an Object.The parameters of the x-ray radiographic system are that Full Width of Half Maximum of source is 1.5 mm, the Object locates 200.0 cm downstream from the source, the detector locates 300.0 cm and the voxel size of the object is 0.2 mm* 0.2 mm.  As described in section\\ref{subsec.source}, we divided the areal source into 24 points(six circles and four points per circle). From the accounted result of projection matrixes in table\\ref{table:matrix_element}, we found that the difference of the matrix elements number is larger than 3\\%. So the space-variant of the size effect exits and it becomes obvious via the increment of the source size.\n\n\\begin{table}[!h]\n\\tabcolsep 0pt \\caption{number of matrix elements} \\vspace*{-12pt}\n\\begin{center}\n{\\rule{{0.85\\textwidth}}{1pt}}\n\\begin{tabular*}{{0.85\\textwidth}}{@{\\extracolsep{\\fill}}cccccccc}\n\\label{table:matrix_element}\n& No.   & account & No.   & account & No.  & account \\\\\n\\hline\n&      \\#1 &  30745264 &      \\#9 &  30260432  &      \\#17 &  29778914 \\\\\n\\hline\n&      \\#2 &  33740127 &      \\#10 &  32941718  &     \\#18 &  32076213 \\\\\n\\hline\n&      \\#3 &  30745264 &      \\#11 &  30260432  &     \\#19 &  29778914 \\\\\n\\hline\n&      \\#4 &  33740127 &      \\#12 &  32941718  &     \\#20 &  32076213 \\\\\n\\hline\n&      \\#5 &  30502316 &      \\#13 &  30019524  &     \\#21 &  29539134 \\\\\n\\hline\n&      \\#6 &  33356949 &      \\#14 &  32509435  &     \\#22 &  31639597 \\\\\n\\hline\n&      \\#7 &  30502316 &      \\#15 &  30019524  &     \\#23 &  29539134 \\\\\n\\hline\n&      \\#8 &  33356949 &      \\#16 &  32509435  &     \\#24 &  31639597 \\\\\n            \\end{tabular*}\n       {\\rule{{0.85\\textwidth}}{1pt}}\n       \\end{center}\n       \\end{table}\n\n\\section{verification} \\label{sec.verification}\n\tOne method to prove the correction of our model is the consistence of the edge position between an experimental image and calculated image with our proposed forward model. The parameters used in calculating the simulated image can be measured with Roll-bar method, the source size(FWHM) is 1.5 mm , and detector blur is 2.1 mm. The experimental object is similar to FTO. The experimental image and its denoised central  profile were showed on Fig.\\ref{fig.balanced_exp_image}-Fig.\\ref{fig.denoised_profile}. The calculated image is Fig.\\ref{fig.calculated_image}. After using the gradient method to obtain the outsider edge of the tungsten layers, we got the deviation of the detected edge from the given value is about 2.0 mm whether for the experiment image or calculated image. And the detected edge is shown in red line on Fig.\\ref{fig.calculated_image}.\n\n\\begin{figure}[h]\n\\centering\n \\subfigure[]{\n   \\label{fig.balanced_exp_image} \n    \\includegraphics[height=1.4in]{balanced_exp_image}} \\hspace{0.1cm}\n     \\subfigure[]{\n    \\label{fig.denoised_profile} \n    \\includegraphics[height=1.4in]{denoised_profile}} \\hspace{0.1cm}\n     \\subfigure[]{\n    \\label{fig.calculated_image} \n    \\includegraphics[height=1.4in]{calculated_image}} \\hspace{0.1cm}\n\\setlength{\\abovecaptionskip}{2pt}\n\\setlength{\\belowcaptionskip}{-6pt} \\caption{The balanced experimental image(left), denoised profile(middle) and forward calculated image of a spherical object(right)}\n\\label{fig.intersections} \n\\end{figure}\n\n\n\n\\section{application}\\label{sec.application}\n\nThe forward model combined with reconstruction method, such as conjugate constrained gradient(CCG)\\cite{LJIN2015}, to form a more precise method for density reconstruction of penetrating radiography and the combined method is called as XTRACE-CCG. The CCG method is stably convergent. The XTRACE-CCG is applied for density reconstruction of a simulated image and an experimental image.\n\n\\subsection{reconstruction of a simulated image}\\label{subsec.rec0}\n\nWe used the XTRACE-CCG method to reconstruct the density from the simulated direct x-ray information. The parameters of simulated x-ray radiography layout are that the French Test Object locates 200.0 cm downstream from the source and the detector locates 300.0 cm. The simulated image is gained by that FXRMC(a simulated code for photon radiography developed by institute of fluid physics) simulates the direct x-ray information with areal source effect and the direct x-ray information convolved the Gaussian detector blur(FWHM is 2.1 mm). The central line of the simulated image is shown on Fig.\\ref{fig.optical_length}. The Fig.\\ref{fig.rec_images} is the reconstructed result. The result shows that the reconstructed density is same at the flat density zone whether the blur is considered or not and the reconstructed density is more closer to the true value at the edge between different layers if the blur is considered. Further, the effect range of blur size is reduced to 1-2 pixels. In another word, the blur effect is reduced to an ignorable level.\n\n\\begin{figure}[h]\n\\centering\n     \\subfigure[the total view]{\n    \\label{fig.total_view} \n    \\includegraphics[height=1.8in]{total_view}} \\hspace{0.3cm}\n     \\subfigure[The magnified part of Fig.\\ref{fig.total_view}]{\n    \\label{fig.magnified_part} \n    \\includegraphics[height=1.8in]{magnified_part}} \\hspace{0.3cm}\n\\setlength{\\abovecaptionskip}{2pt}\n\\setlength{\\belowcaptionskip}{-6pt} \\caption{The central line of the optical length with or without blur.\nThe solid line with square is FXRMC simulated result and the dash line with circle is FXRMC simulated result convolving with detector blur. }\n\\label{fig.optical_length} \n\\end{figure}\n\n\n\\begin{figure}[h]\n\\centering\n     \\subfigure[the total view]{\n    \\label{fig.total_view1} \n    \\includegraphics[height=1.8in]{total_view1}} \\hspace{0.3cm}\n     \\subfigure[The magnified part of Fig.\\ref{fig.total_view1}]{\n    \\label{fig.magnified_part1} \n    \\includegraphics[height=1.8in]{magnified_part1}} \\hspace{0.3cm}\n\\setlength{\\abovecaptionskip}{2pt}\n\\setlength{\\belowcaptionskip}{-6pt} \\caption{The central line of reconstructed density from a simulated image with different forward equations. The solid line with square is deblurred\n result of our forward model, the dash line with circle is result without consideration of blur and the dash dot line with triangle is true value.}\n\\label{fig.rec_images} \n\\end{figure}\n\n\\subsection{reconstruction of an experimental image}\n\nThe same method is used to reconstruct density from an experimental image. The constructed result(Fig.\\ref{fig.rec_exp}) shows the same result of the reconstruction of the simulated image that when the reasonable blur is considered in our forward model, the effect of blur size is removed completely at the edge between different layers. So the more precise density can be gained with our forward model and the reasonable blur size. The reasonable blur size can be obtained according to our published research.\n\n\\begin{figure}[htpb]\n\\centering\n  \\includegraphics[height=1.5in]{rec_exp}\\\\\n  \\caption{The central line of reconstructed density from an experimental image. The solid line with square is result without consideration of blur and the dash line with circle is deblurred result of our forward model.} \\label{fig.rec_exp}\n\\end{figure}\n\n\\subsection{robustness of the method}\n\nOur method was used to reconstruct density from a density-variant object image to investigate the robustness of the method . The density-variant object is formed by changing the unform density of the French Test Object into a sloped one and the density distribution is shown on the Fig.\\ref{fig.rec_sim1}. As the process of section\\ref{subsec.rec0}, the density distribution is turned into simulated image with FXRMC code and the density is reconstructed from it. The reconstructed result shows that our method is also robust for reconstructing the density-variant object from the simulated image to the given value and can reduce the blur effect to the ignorable level.\n\n\\begin{figure}[htpb]\n\\centering\n  \\includegraphics[height=1.5in]{rec_sim1}\\\\\n  \\caption{The central line of reconstructed density from a simulated image with forward forward. The solid line is true value, the symbol circle is reconstructed result.} \\label{fig.rec_sim1}\n\\end{figure}\n\n\n\\section{Conclusion and discussion} \\label{sec.conclusion}\nWe treated the areal source as many weighted point sources and used the forward model to achieve a reasonable simulated image by comparing to experimental image. Our methods reduced the blur effect on the edge of the density only to 1~2 pixels, and it is also suitable for reconstruction of density-variant object.\n\nAdditionally, the determination of the blur size is important to the reconstructed result. If the blur size is much lower than the true value, the effect of blur size on the density can not be removed completely. Otherwise, a faked step will appear in result, detailed in ref\\cite{LJIN2015}.\n\t\nThe main difference between our model and the LANL model is that we pay more attention on the areal source and handle it as different point sources while LANL pay more attention on the spectrum effect on attenuation coefficient and handle it as many energy bins. In our research, if the object is thick enough that the spectrum effect becomes weak and the attenuation coefficient is almost close to a constant while the blur effect of the source still covers several pixels. So we handle the blur first. In the future, the spectrum effect will be under consideration in the procedure of post-image processing.\n\n{\\em Acknowledgements:} This work is supported in part by the Foundation of China Academy of Engineering Physics (No.2013B0202021, No.2014B0403056) and the Youth Natural Sciences Foundation of China (No. 11304295).\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\bibliographystyle{elsarticle-num}\n\\bibliography{<your-bib-database>}\n\n\n\n\n\n\n\n \\begin{thebibliography}{00}\n\n\n\n\n\n\n\\bibitem{Cunningham:2003}\nG.S.~Cunningham and C.~Morris,\n\\newblock Los Alamos Science 28, 2003.\n\n\\bibitem{Morris2003}\nC.~Morris and G.~S.~Cunningham,\n\\newblock Los Alamos Science, 28 (2003) 76.\n\n\\bibitem{Davis2006}\nH.~Davis, R.~Scarpetti,\n\\newblock Proceedings of LINAC,2006.\n\n\\bibitem{Ding:2005}\nB.N.~Ding, J.J.~Deng, H.C.~Wang, et al,\n\\newblock High Energy Physics And Nuclear Physics (in Chinese) 29 (2005) 604-610 .\n\n\\bibitem{Jiang2012}\nX.G.~Jiang, Y.~Wang, K.Z.Zhang, et al,\n\\newblock High Power Laser and Particle Beams (in Chinese) 24 (2012) 1146-1150.\n\n\n\\bibitem{Burns:1999}\nM.J.~Burns, B.E.~Carlsten, T.J.T.~Kwan, et al,\n\\newblock Proceedings of the 1999 Particle Accelerator Conference. New York, (1999) 617-621.\n\n\\bibitem{LJIN2012}\nJ.~Liu, J.~Liu, L.W.~Zhang, J.J.~Shi\n\\newblock High Power Laser and Particle Beams (in Chinese) 24 (2012) 193.\n\n\\bibitem{Aufderheide2002}\nM. B. Aufderheide III, H. E. Martz Jr., D. M. Slone, and et al,\n\\newblock UCRL-ID-146938, 2002.\n\n\\bibitem{LJIN2015}\nJ.~Liu, J.~Liu, Y.~Jing, X.~Zhang, J.~Shi, B.~Xiao,\n\\newblock Nucl. Instr. and Meth. A, 788 (2015) 122.\n\n\n\n\n\n \\end{thebibliography}\n\n\n\n\n\n", "itemtype": "equation", "pos": 14124, "prevtext": "\n\n\n\\begin{figure}[htpb]\n\\centering\n  \\includegraphics[height=2.0in]{gridded_source}\\\\\n  \\caption{The diagram of the gridded areal source with angle increment  $\\pi/2$} \\label{fig.gridded_source}\n\\end{figure}\n\n\\subsection{matrix of detector blur}\nThe effect of the blur can be expressed as a window, just as a filter window. The windows size is N*N, and N is equal to the devision of 3sigma of the blur size to pixel size. The element of window matrix is\n\n", "index": 19, "text": "\\begin{equation}\\label{eq.matrix_element_detector_blur}\n    b_{ij}=\\int_{x_{i}}^{x_{i+1}}\\int_{y_{j}}^{y_{j+1}}B(x,y)dxdy\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m1\" class=\"ltx_Math\" alttext=\"b_{ij}=\\int_{x_{i}}^{x_{i+1}}\\int_{y_{j}}^{y_{j+1}}B(x,y)dxdy\" display=\"block\"><mrow><msub><mi>b</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>=</mo><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><msub><mi>x</mi><mi>i</mi></msub><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></msubsup><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><msub><mi>y</mi><mi>j</mi></msub><msub><mi>y</mi><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub></msubsup><mrow><mi>B</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>x</mi></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>y</mi></mrow></mrow></mrow></mrow></mrow></math>", "type": "latex"}]