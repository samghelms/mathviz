[{"file": "1601.02577.tex", "nexttext": "\n\\end{proposition}\n\n\\begin{proof}\nIt has width at least two since $e_d$ is an interior lattice point in it. For every $i=1,\\dots,d-1$, removing $e_i$ or $-e_i$ gives width one with respect to the $i$-th coordinate.\n\\end{proof}\n\nA slight modification of this construction shows that in $d\\ge 3$ there are infinitely many \\emph{minimal} polytopes: \n", "itemtype": "equation", "pos": 15423, "prevtext": "\n\n\\title{On the enumeration of lattice $3$-polytopes}\n\\author{M\\'onica Blanco}\n\\author{Francisco Santos}\n\n\\address\n[F.~Santos and M. Blanco]\n{\nDepartamento de Matem\\'aticas, Estad\\'istica y Computaci\\'on,\nUniversidad de Cantabria,\n39005 Santander, Spain\n}\n\\email{francisco.santos@unican.es, monica.blancogomez@unican.es}\n\n\n\\thanks{Supported by grants MTM2011-22792, MTM2014-54207-P (both authors) and BES-2012-058920 (M.~Blanco) of the Spanish Ministry of Science }\n\n\n\\begin{abstract}\n\n\n\n\nA lattice $3$-polytope is a polytope $P$ with integer vertices. We call size of $P$ the number of lattice points it contains, and width of $P$ the minimum, over all integer linear functionals $f$, of the length of the interval $f(P)$. \n\nIn a previous paper we have shown that all but finitely many lattice $3$-polytopes of a given size have width one, which opens the possibility of  enumerating those of width larger than one.\nThere is none of size 4 (White, 1964) and those of sizes five and six were classified in our previous papers. \nIn this paper we prove that every lattice $3$-polytope $P$ of width larger than one and size at least seven falls into one of the following three categories:\n\n\\begin{itemize}\n\\item It projects in a very specific manner to one of a list of seven particular $2$-polytopes. We call $3$-polytopes of this type \\emph{spiked}, and we describe them explicitly.\n\n\\item All except three of the lattice points in $P$ are contained in a rational parallelepiped of width one with respect to every facet. We call  these polytopes \\emph{boxed}. They have size at most 11 and we have completely enumerated them.\n\n\\item $P$ has (at least) two vertices $u$ and $v$ such that, when removing each of them, the width is still larger than one. Polytopes of this type can be all obtained ``gluing'' smaller polytopes of width larger than one.\n\\end{itemize}\n\nThis allows for a computational enumeration of all lattice $3$-polytopes of width larger than one up to any given size. We have completely enumerated $3$-polytopes of width larger than one and size up to eleven. In particular, this implies the complete classification of ``distinct-pair-sum'' (or dps, for short) $3$-polytopes, which have size at most eight, of width larger than one.\n\n\n\n\n\n\\end{abstract}\n\n\\keywords{Lattice polytopes, unimodular equivalence, lattice points, finiteness, lattice width}\n\\subjclass[2000]{52B10, 52B20}\n\\maketitle\n\n\\setcounter{tocdepth}{1}\n\\tableofcontents\n\n\n\n\n\\section{Introduction}\n\nIn this paper we describe an algorithm to classify all the lattice $3$-polytopes with a given number of lattice points, which we call its \\emph{size}. We have implemented the algorithm and run it up to size eleven. Running it for larger sizes requires either more careful implementations or more computer power (or both).\n\nOur starting point is, as in our previous papers~\\cite{5points,6points}, the fact that there are only finitely many isomorphism classes of $3$-polytopes of a given size $n$ and width larger than one~\\cite[Corollary 5.1]{5points}. Of width one are infinitely many, even in fixed size $n$, but they are easy to describe: they consist of two parallel $2$-polytopes of sizes $n_1$ and $n_2$ at lattice distance one, with $n_1+n_2=n$.\n\nHere we call two lattice polytopes \\emph{isomorphic} or \\emph{unimodularly equivalent} if there exists an affine unimodular transformation $t:{\\mathbb{R}}^d\\to {\\mathbb{R}}^d$ that preserves the lattice and maps one polytope to the other. The \\emph{width} of a lattice $d$-polytope $P$ is the minimum of $\\max_{x\\in P}f(x) -\\min_{x\\in P} f(x)$ over all choices of a (non-constant) affine functional $f:{\\mathbb{R}}^d\\to {\\mathbb{R}}$ with $f({\\mathbb{Z}}^d) \\subset {\\mathbb{Z}}$.\n\nIn~\\cite{5points,6points} we gave the complete lists of lattice $3$-polytopes of sizes 5 and 6 (those of size 4 were classified by White \\cite{White}). The methods used were quite ad-hoc and based on first classifying the possible oriented matroids of the five or six lattice points and then doing a detailed case study for each oriented matroid (or almost). \n\nHere we take a different approach, already hinted in \\cite{5points}. \nSuppose that we know already the list of lattice $3$-polytopes of size $n-1$. One can expect that \\emph{most} of the polytopes of size $n$ can be obtained by ``gluing'' two polytopes of size $n-1$ in the following sense: We say that $P$ (of size $n$) is obtained by gluing $P_1$ and $P_2$ (both of size $n-1$) if both are (modulo unimodular equivalence) subpolytopes of $P$, and they have a common subpolytope $P_3$ (of size $n-2$) that is still three-dimensional. For given $P_1$ and $P_2$, the following algorithm computes all the polytopes $P$ that can be obtained by gluing them:\n\n\\begin{algorithm}[Gluing]\n\\label{algorithm:gluing}\n\\ \\\\\nINPUT: two lattice $d$-polytopes $P_1$ and $P_2$ of size $n-1$\\\\\nOUTPUT: all the lattice $d$-polytopes of size $n$ obtained gluing $P_1$ and $P_2$.\\\\\nFor each vertex $v_1$ of $P_1$ and $v_2$ of $P_2$:\n\\begin{enumerate}\n\\item Let $P'_1={\\operatorname{conv} }({\\mathbb{Z}}^d\\cap P_1 \\setminus \\{v_1\\})$ and $P'_2={\\operatorname{conv} }({\\mathbb{Z}}^d\\cap P_2 \\setminus \\{v_2\\})$.\n\\item Check if $P'_1$ and $P'_2$ are $d$-dimensional and unimodularly equivalent. If they are, let $t: {\\mathbb{Z}}^d\\to {\\mathbb{Z}}^d$ be an equivalence sending $P'_1$ to $P'_2$. ($t$ may be not unique, but there are finitely many possibilities for it; do step 3 for each). \n\\item If the size of $P:= {\\operatorname{conv} }(t(P_1)\\cup P_2)$ equals $n$, add $P$ to the output list.\n\\end{enumerate}\n\\end{algorithm}\n\nA brute force algorithm for step (2) is: choose an affine basis $B_1$ consisting of lattice points in $P'_1$ and, for each of the at most ${n-2 \\choose 4}$ affine basis $B_2$ consisting of lattice points in $P'_2$ and each of the $24$ permutations of $B_2$ consider the unique affine map $t$ sending $B_1$ to $B_2$ in that order. $t$ is a unimodular equivalence if (and only if) $\\det(t)=1$, $t(P'_1)=P'_2$ and it has integer coefficients. This algorithm can be made considerably faster by first computing certain unimodular equivalence invariants of $P'_1$ and $P'_2$, most notably their volume vectors, as defined in~\\cite{5points}.\n\nThanks to Algorithm~\\ref{algorithm:gluing}, to completely enumerate lattice $3$-polytopes of a given size we only need to understand (and enumerate) the lattice $3$-polytopes that \\emph{cannot} be obtained by gluing two smaller ones. For this we introduce the following definitions, in which we use the notation $P^v:={\\operatorname{conv} }({\\mathbb{Z}}^3 \\cap P\\setminus \\{v\\})$ for a lattice polytope $P$ and a vertex $v$ of it:\nA $d$-polytope  $P$ of width $>1$ is \\emph{minimal} if it has no vertex $v$ such that $P^v$ is still of width larger than one.\nA $d$-polytope  $P$ of width $>1$ is \\emph{quasi-minimal} if it has at most one vertex $v$ such that $P^v$ is still of width larger than one.\n\nA polytope that is not quasi-minimal has at least two vertices $v_1$ and $v_2$ with $P^{v_1}$ and $P^{v_2}$ of width larger than one. \nThis does not imply that $P$ is glued from $P^{v_1}$ and $P^{v_2}$ because $P^{v_1v_2}:=(P^{v_1})^{v_2}=(P^{v_2})^{v_1}$ could be $2$-dimensional. This is excluded in the definition of gluing, because gluing over a $2$-dimensional intersection makes the set of transformations $t$ to be tested in Algorithm~\\ref{algorithm:gluing} infinite. However, it turns out there is no lattice $3$-polytope of size greater than six in which this is a problem:\n\n\\begin{theorem}\n\\label{theorem:exception_intro}\nAll lattice $3$-polytopes $P$ of size $n\\ge 7$ and width larger than one are either quasi-minimal, or have two vertices $v_1,v_2 \\in {\\operatorname{vert}}(P)$ such that $P$ can be glued from $P^{v_1}$ and $P^{v_2}$.\n\\end{theorem}\n\nOnce this is established, the algorithm for classifying all lattice $3$-polytopes of size $n$ and width larger than one consists simply in computing all the gluings of polytopes of size $n-1$ (which are assumed recursively precomputed), adding to those the quasi-minimal ones and (in size 6) the exceptional one (see Theorem~\\ref{thm:exception}). Computing the gluings is done via Algorithm~\\ref{algorithm:gluing}. \n\nFor the quasi-minimal ones we prove the following:\n\n\\begin{theorem}\n\\label{thm:spiked_intro}\nLet $P$ be a quasi-minimal lattice $3$-polytope with more than $11$ lattice points. Then $P$ projects to one of the following $2$-polytopes in such a way that all of the vertices in the projection have a unique element in the preimage. \n\\medskip\n\n\\centerline{\n\\includegraphics[scale=0.6]{projections.pdf}\n}\n\\end{theorem} \n\n\nMore precise versions of  Theorems~\\ref{theorem:exception_intro} and~\\ref{thm:spiked_intro} are proved as Theorem~\\ref{thm:exception} and Corollary~\\ref{coro:spiked-projections}\nin Sections~\\ref{sec:finiteness} and~\\ref{sec:spiked}. There, we divide the quasi-minimal polytopes into two types. Those that project as \nstated in Theorem~\\ref{thm:spiked_intro} (or, rather, as in its more precise version Corollary~\\ref{coro:spiked-projections}) are called\n\\emph{spiked} (see Definition~\\ref{def:spiked}). The rest, apart of having at most $11$ lattice points, have some extra properties that make us call them \\emph{boxed}  (see Definition~\\ref{def:boxed}). There are infinitely many spiked polytopes in total but finitely many for each size, and they are explicitly described in Section~\\ref{sec:spiked} (Theorems~\\ref{theorem:spiked-minimals} and~\\ref{theorem:spiked-quasiminimals}). Boxed $3$-polytopes are finitely many. They are studied and completely classified, for size at least seven, in Section~\\ref{sec:boxed}, via a computer exhaustive search.\nTable~\\ref{table-minimal} in Section~\\ref{sec:result-tables} shows the numbers of boxed and spiked $3$-polytopes for each size and number of vertices.\n\nAfter we have a classification of quasi-minimal  polytopes we can run the full algorithm. The results are summarized as follows, and are given in more detail in Section~\\ref{sec:result-tables}:\n\n\\begin{theorem}\nThere are $9$, $76$, $496$, $2675$, $11698$, $45035$ and $156464$ lattice $3$-polytopes of width larger than one and sizes $5$, $6$, $7$, $8$, $9$, $10$ and $11$, respectively.  \n\\end{theorem}\n\n\\begin{remark}\nIt may seem that this theorem and our algorithm make the results in~\\cite{5points,6points} useless, but that is not the case. Quite the opposite, we need those results as the starting point for our algorithm, since there are several issues that make the techniques in this paper only applicable for size at least seven (or, at least, difficult to apply to smaller sizes). \nOne of them is already hinted in Theorem~\\ref{theorem:exception_intro}. But most importantly, the assumption of the size being at least seven considerably simplifies the cases to be considered \n in the classification of spiked (see Theorem~\\ref{thm:projection_shape}) and boxed (see Lemma~\\ref{lemma:cubes}) $3$-polytopes. In particular, classifying quasi-minimal $3$-polytopes of size six might have been not significantly simpler than repeating the work done in~\\cite{6points}. \n\\end{remark}\n\nKasprzyk~\\cite{Kasprzyk-database} and Balletti and Kasprzyk (personal communication) have enumerated all lattice $3$-polytopes with exactly one or two interior lattice points. Our results agree with theirs. Those with one interior lattice point are specially important for their connections to toric geometry and are called \n\\emph{canonical}. If, moreover, the interior point is the unique non-vertex they are called \\emph{terminal}. In Table~\\ref{table:canonical} we show the numbers of canonical and terminal $3$-polytopes up to size $11$.\n\n\\medskip\n\nOur  studies are partially motivated by the concept of \\emph{distinct pair-sums polytopes} (or \\emph{dps} polytopes for short), first introduced in~\\cite{ChoiLamReznick}. Dps polytopes are lattice polytopes in which all the pairwise sums $\\{a+b: a,b\\in P\\cap {\\mathbb{Z}}^d\\}$ are distinct. Equivalently, they are lattice polytopes containing no three collinear lattice points nor the vertices of a parallelogram~\\protect{\\cite[Lemma~1]{ChoiLamReznick}}. Dps polytopes of dimension $d$ have at most $2^d$ lattice points, hence in this paper we complete the classification of lattice dps $3$-polytopes, which is summarized as follows (see Table~\\ref{table:dps} for more details):\n\n\\begin{theorem}\nThere are exactly $108$ dps $3$-polytopes of width larger than one. Specifically, there are $9$, $45$, $48$ and $6$ of sizes $5$, $6$, $7$ and $8$, respectively, and $37$, $58$ and $13$ with $4$, $5$ and $6$ vertices.\n\\end{theorem}\n  \nIn particular we can answer in dimension $3$ the several questions posed by Reznick~\\cite{Reznick-favorite} regarding dps polytopes. For example, we obtain that not every dps $3$-polytope is a subset of one of size $8$. Specifically, there are exactly $33$ dps $3$-polytopes of width larger than one that have no extension to size $8$, and they all are of size $7$. \n\n\n\n\\subsection*{Acknowledgements} We thank Gabriele Balletti for sharing with us his results (joint with A.~Kasprzyk) on the classification of lattice $3$-polytopes with two interior points. In particular, a discrepancy between their results and a preliminary version of ours allowed us to correct a mistake in a first version of Theorem~\\ref{thm:projection_shape} and Corollary~\\ref{coro:spiked-projections}.\n\n\n\n\n\\section{Quasi-minimal polytopes: spiked vs.~boxed}\n\\label{sec:finiteness}\n\n\nLet $A \\subset {\\mathbb{Z}}^d$ be a finite set of lattice points.\nIn the rest of this section we assume the corresponding lattice polytope ${\\operatorname{conv} }(A)$ to have width greater than one.\nFor each vertex $v$ of ${\\operatorname{conv} }(A)$ we denote $A^v:=A \\setminus \\{v\\}$. \n\\begin{definition}\nWe say that a vertex $v$ of ${\\operatorname{conv} }(A)$ is \\emph{essential} if ${\\operatorname{conv} }(A^v)$ has width at most one. That is, if ${\\operatorname{conv} }(A^v)$ either has width one or is $(d-1)$-dimensional. \n\\end{definition}\n\nLet ${\\operatorname{vert}}(A)$ be the set of all vertices of ${\\operatorname{conv} }(A)$ and $ {\\operatorname{vert}}^*(A) \\subseteq  {\\operatorname{vert}}(A)$ the set of essential vertices.\nWe are primarily interested in the case $A=P\\cap {\\mathbb{Z}}^d$, for a lattice $d$-polytope $P$, in which case we use ${\\operatorname{vert}}(P)$, ${\\operatorname{vert}}^*(P)$ and $P^v$ for ${\\operatorname{vert}}(A)$, ${\\operatorname{vert}}^*(A)$ and ${\\operatorname{conv} }(A^v)$, but we need also to consider more general cases.\n\n\n\n\\begin{definition}\n\\label{definition:minimal}\nWe say that $A$ is a \\emph{minimal configuration} if all its vertices are essential, and that it is a \\emph{quasi-minimal configuration} if at most one vertex is not essential. That is, if ${\\operatorname{vert}}^* (A)={\\operatorname{vert}} (A)$ and $|{\\operatorname{vert}}^*(A) |\\ge |{\\operatorname{vert}}(A)|-1$, respectively.\n\nWe say that a $d$-polytope $P$ is \\emph{minimal} or \\emph{quasi-minimal} if its set of lattice points is a minimal or quasi-minimal configuration, respectively.\n\\end{definition}\n\nOne of the main ingredients in this paper is the complete classification of quasi-minimal $3$-polytopes. As a warm-up let us show that there are infinitely many of them in any dimension:\n\n\\begin{proposition}\nFor every $d\\ge 2$ and $k\\ge 2$ the following $d$-polytope with $2^{d-1} + 1$ vertices and $2^{d-1} + k+1$ lattice points is quasi-minimal:\n", "index": 1, "text": "\n\\[\n{\\operatorname{conv} }\\{ \\pm e_1,\\dots, \\pm e_{d-1}, ke_d\\}.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"{\\operatorname{conv}}\\{\\pm e_{1},\\dots,\\pm e_{d-1},ke_{d}\\}.\" display=\"block\"><mrow><mrow><mo>conv</mo><mo>\u2061</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mo>\u00b1</mo><msub><mi>e</mi><mn>1</mn></msub></mrow><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><mrow><mo>\u00b1</mo><msub><mi>e</mi><mrow><mi>d</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow><mo>,</mo><mrow><mi>k</mi><mo>\u2062</mo><msub><mi>e</mi><mi>d</mi></msub></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\n\nIn dimension 2, however, there are only four minimal polygons, as follows from the complete classification of quasi-minimal polygons that we work out in Lemma~\\ref{lemma:quasi-minimal-dim2} below (see also Figure~\\ref{fig:minimal-dim2}).\n\n\\subsection{A dichotomy}\n\nLet us introduce the following two types of configurations:\n\n\\begin{definition}[Spiked configuration]\n\\label{def:spiked}\nLet $A\\subset {\\mathbb{Z}}^d$ be a quasi-minimal configuration and let $A':=\\pi(A)$, for $\\pi: {\\mathbb{Z}}^d \\to {\\mathbb{Z}}^{d-1}$ a lattice projection such that:\n\\begin{itemize}\n\\item Every vertex of ${\\operatorname{conv} }(A')$ has a unique preimage in $A$.\n\\item The projection bijects essential vertices of $A$ and $A'$.\n\\end{itemize}\nThen, we say that $A$ is \\emph{spiked with respect to $A'$}.\n\\end{definition}\n\n\n\\begin{definition}[Boxed configuration]\n\\label{def:boxed}\nLet $A\\subset {\\mathbb{Z}}^d$ be a configuration of width larger than one, and let $Q\\subset {\\operatorname{conv} }(A)$ be a rational $d$-dimensional parallelepiped such that:\n\n\\begin{itemize}\n\\item The facets of $Q$ are defined by lattice hyperplanes, with opposite facets  at  distance one. That is, \n", "itemtype": "equation", "pos": 15836, "prevtext": "\n\\end{proposition}\n\n\\begin{proof}\nIt has width at least two since $e_d$ is an interior lattice point in it. For every $i=1,\\dots,d-1$, removing $e_i$ or $-e_i$ gives width one with respect to the $i$-th coordinate.\n\\end{proof}\n\nA slight modification of this construction shows that in $d\\ge 3$ there are infinitely many \\emph{minimal} polytopes: \n", "index": 3, "text": "\n\\[\n{\\operatorname{conv} }\\{\\pm e_1,\\dots, \\pm e_{d-2}, - e_{d-1}, e_{d-1} + ke_d\\}.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"{\\operatorname{conv}}\\{\\pm e_{1},\\dots,\\pm e_{d-2},-e_{d-1},e_{d-1}+ke_{d}\\}.\" display=\"block\"><mrow><mrow><mo>conv</mo><mo>\u2061</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mo>\u00b1</mo><msub><mi>e</mi><mn>1</mn></msub></mrow><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><mrow><mo>\u00b1</mo><msub><mi>e</mi><mrow><mi>d</mi><mo>-</mo><mn>2</mn></mrow></msub></mrow><mo>,</mo><mrow><mo>-</mo><msub><mi>e</mi><mrow><mi>d</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow><mo>,</mo><mrow><msub><mi>e</mi><mrow><mi>d</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>+</mo><mrow><mi>k</mi><mo>\u2062</mo><msub><mi>e</mi><mi>d</mi></msub></mrow></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\nwhere the $f_i$ are affinely independent integer primitive functionals. \n\n\\item $A\\setminus Q= \\{v_1, \\dots,v_d\\}$ where,\nfor each $i,j\\in\\{1, \\dots, d\\}$, $f_i(v_j)\\in \\{0,1\\}$ if $i\\ne j$, and $f_i(v_i)\\not\\in \\{0,1\\}$.\n\\end{itemize}\nThen, we say that $A$ is \\emph{boxed with respect to $Q$}.\n\\end{definition}\n\nWe say that a quasi-minimal $d$-polytope is spiked (resp. boxed) if its set of lattice points is a spiked (resp. boxed) configuration.\n\n\\begin{remark}\nThe definition of spiked assumes $A$ to be quasi-minimal, but the definition of boxed does not. Observe also the following immediate consequences of the definitions: \n\\begin{itemize}\n\\item The $(d-1)$-dimensional configuration $A'$ in the definition of spiked is automatically quasi-minimal. More precisely, it has at most as many non-essential vertices as $A$.\n\\item Boxed configurations have at most $d+2^d$ lattice points: apart from $v_1,\\dots, v_d$, only the $2^d$ vertices of $Q$ can be lattice points of $A$.\n\\end{itemize}\n\\end{remark}\n\nThe reason for these seemingly strange definitions is the following result:\n\n\\begin{theorem}\n\\label{thm:spiked_vs_boxed}\nEvery quasi-minimal configuration is spiked or boxed. \n\\end{theorem}\n\n\n\n\\begin{proof}\nLet $A \\subset {\\mathbb{Z}}^d$ be a quasi-minimal configuration. For each $v_i\\in {\\operatorname{vert}}^*(A)$ let $f_i$ be an affine integer functional with $A ^{v_i} \\subset f_i^{-1}(\\{0,1\\})$.\nLet $\\hat f_i$ be the corresponding linear functional. Two things can happen:\n\\begin{enumerate}\n\n\\item If the set $\\{\\hat f_i : v_i\\in {\\operatorname{vert}}^*(A)\\}$ linearly spans $({\\mathbb{R}}^d)^*$, then assume without loss of generality that $\\hat f_1,\\dots, \\hat f_d$ are independent. By construction $A$ is boxed with respect to the parallelepiped\n", "itemtype": "equation", "pos": 17093, "prevtext": "\n\nIn dimension 2, however, there are only four minimal polygons, as follows from the complete classification of quasi-minimal polygons that we work out in Lemma~\\ref{lemma:quasi-minimal-dim2} below (see also Figure~\\ref{fig:minimal-dim2}).\n\n\\subsection{A dichotomy}\n\nLet us introduce the following two types of configurations:\n\n\\begin{definition}[Spiked configuration]\n\\label{def:spiked}\nLet $A\\subset {\\mathbb{Z}}^d$ be a quasi-minimal configuration and let $A':=\\pi(A)$, for $\\pi: {\\mathbb{Z}}^d \\to {\\mathbb{Z}}^{d-1}$ a lattice projection such that:\n\\begin{itemize}\n\\item Every vertex of ${\\operatorname{conv} }(A')$ has a unique preimage in $A$.\n\\item The projection bijects essential vertices of $A$ and $A'$.\n\\end{itemize}\nThen, we say that $A$ is \\emph{spiked with respect to $A'$}.\n\\end{definition}\n\n\n\\begin{definition}[Boxed configuration]\n\\label{def:boxed}\nLet $A\\subset {\\mathbb{Z}}^d$ be a configuration of width larger than one, and let $Q\\subset {\\operatorname{conv} }(A)$ be a rational $d$-dimensional parallelepiped such that:\n\n\\begin{itemize}\n\\item The facets of $Q$ are defined by lattice hyperplanes, with opposite facets  at  distance one. That is, \n", "index": 5, "text": "\n\\[\nQ=\\underset{i=1}{\\overset{d}{\\bigcap}} f_i^{-1} ([0,1]),\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"Q=\\underset{i=1}{\\overset{d}{\\bigcap}}f_{i}^{-1}([0,1]),\" display=\"block\"><mrow><mrow><mi>Q</mi><mo>=</mo><mrow><munderover accent=\"true\" accentunder=\"true\"><mo largeop=\"true\" mathsize=\"160%\" movablelimits=\"false\" stretchy=\"false\" symmetric=\"true\">\u22c2</mo><mrow><mi mathsize=\"142%\">i</mi><mo mathsize=\"142%\" stretchy=\"false\">=</mo><mn mathsize=\"142%\">1</mn></mrow><mo>\ud835\udc51</mo></munderover><mo>\u2062</mo><msubsup><mi>f</mi><mi>i</mi><mrow><mo>-</mo><mn>1</mn></mrow></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\n\n\\item If the set $\\{\\hat f_i : v_i\\in {\\operatorname{vert}}^*(A)\\}$ does not linearly span $({\\mathbb{R}}^d)^*$, then there is a line where all the $\\hat f_i$ are constant. That is, there exists an element $r \\in {\\mathbb{Z}}^d$ such that $\\hat f_i(r)=0$ for all $i$. Let $\\pi: {\\mathbb{Z}}^d \\to L:={\\mathbb{Z}}^{d}/\\langle r\\rangle \\cong{\\mathbb{Z}}^{d-1}$, and let $f_i'$ be the  functional in $L$ defined by $f_i(x)=f_i'(\\pi(x))$ for each $x\\in {\\mathbb{Z}}^d$. \nSince $A$ has width greater than one, so does $A':=\\pi(A)$ in $L$. Let us see that $A$ is spiked with respect to $A'$.\n\nLet us first see that each vertex of ${\\operatorname{conv} }(A')$ has a unique preimage in $A$. For this, let $v'$ be a vertex of ${\\operatorname{conv} }(A')$ and suppose $u,v$ are two different vertices of $A$ projecting to $v'$. Then we would have $\\pi(A^{u})=\\pi(A^{v})=\\pi(A)=A'$. But at least one of $u$ and $v$ must be an essential vertex of $A$. Say $v=v_i\\in{\\operatorname{vert}}^*(A)$, then $A^v$ has width one with respect to $f_i$, which is constant in $r$. This would imply $\\pi(A^v)=A'$ to have width one in $L$ with respect to $f_i'$, which is a contradiction.\n\nFinally, let us prove that $\\pi$ bijects essential vertices of $A$ and $A'$. Let $v'$ be a vertex of ${\\operatorname{conv} }(A')$ and let $v$ be the unique vertex of ${\\operatorname{conv} }(A)$ with $\\pi(v)=v'$. \nThen $v\\in{\\operatorname{vert}}^*(A)$ if and only if $A^v$ has width one with respect to a functional $f$ with $\\hat f(r)=0$. This happens if and only if the corresponding functional $f'$ gives width one to $A'\\setminus\\{v'\\}$ in $L$, which in turn is equivalent to $v'\\in{\\operatorname{vert}}^*(A')$.\n\\end{enumerate}\n\\end{proof}\n\n\n\nIn dimension one the only minimal configurations are $\\{0,1,2\\}$ and $\\{0,k\\}$ for any $k\\ge 1$. The only quasi-minimal ones that are not minimal are $\\{0,1, k\\}$, for any $k\\ge 3$.\n\nIn dimension two, classifying quasi-minimal configurations is not that easy, but Theorem~\\ref{thm:spiked_vs_boxed} allows us to classify quasi-minimal polygons:\n\n\\begin{lemma}\n\\label{lemma:quasi-minimal-dim2}\nEvery quasi-minimal $2$-polytope is unimodularly equivalent to one in Figure~\\ref{fig:minimal-dim2}.\n\n\\begin{figure}[ht]\n\\begin{center}\n\\includegraphics[scale=0.7]{polygons3.pdf}\\\\\n\\bigskip\n\\includegraphics[scale=0.7]{polygons4.pdf}\n\\end{center}\n\\caption{The quasi-minimal lattice polygons. In the non-minimal ones (top row) the white dot is the non-essential vertex. Labels 1 to 7 are used in the proof of Theorem~\\ref{thm:exception}.}\n\\label{fig:minimal-dim2}\n\\end{figure}\n\\end{lemma}\n\n\n\\begin{proof}\nAn exhaustive search proves the list for lattice polygones with up to $6$ points.\nSo, for the rest of the proof let $P$ be a quasi-minimal polygon with at least $7$ lattice points. Since it has to be spiked, Theorem~\\ref{thm:spiked_vs_boxed} implies that $P$ projects to $\\{0,1,k\\}$ ($k\\ge 2$) with a single point in the fibers of $0$ and $k$, hence with at least five in the fiber of $1$.\n\nIf $k=2$, then $P$ is a quasi-minimal triangle like one of the two in the statement with an arbitrary number of interior points. If $k\\ge 3$, the fact that there are (at least) five points in the fiber of $1$ implies that there must be some other lattice points of $P$ in the fiber of $2$. Indeed, the fiber of $1$ is a segment of length at least $4$, hence the fiber of $2$ has length at least $4(k-2)/(k-1)\\ge 2$. This cannot happen.\n\\end{proof}\n\n\n\n\nObserve that a polytope can be both spiked and boxed. An example is $P={\\operatorname{conv} }\\{(1,0,0), (0,1,0),(-1,0,0),(0,-1,2)\\}$, whose set of lattice points is $A=\\{(1,0,0),$ $(0,1,0) , (-1,0,0), (0,-1,2),(0,0,0), (0,0,1)\\}$.\n\n\n\n\n\\subsection{An exception}\n\nWe said in the introduction that all $3$-polytopes of size at least $7$ that are not quasi-minimal can be glued from smaller ones. Here we prove a more explicit result:\n\n\\begin{theorem}\n\\label{thm:exception}\nFor every lattice $3$-polytope $P$ of width larger than one exactly one of the following happens:\n\\begin{enumerate}\n\\item $P$ is quasi-minimal.\n\\item There exist vertices $v_1,v_2 \\in {\\operatorname{vert}}(P) \\setminus {\\operatorname{vert}}^*(P)$ such that $P^{v_1,v_2}$ is $3$-dimensional.\n\\item $P$ has size $6$ and is equivalent to \n\n", "itemtype": "equation", "pos": 18920, "prevtext": "\nwhere the $f_i$ are affinely independent integer primitive functionals. \n\n\\item $A\\setminus Q= \\{v_1, \\dots,v_d\\}$ where,\nfor each $i,j\\in\\{1, \\dots, d\\}$, $f_i(v_j)\\in \\{0,1\\}$ if $i\\ne j$, and $f_i(v_i)\\not\\in \\{0,1\\}$.\n\\end{itemize}\nThen, we say that $A$ is \\emph{boxed with respect to $Q$}.\n\\end{definition}\n\nWe say that a quasi-minimal $d$-polytope is spiked (resp. boxed) if its set of lattice points is a spiked (resp. boxed) configuration.\n\n\\begin{remark}\nThe definition of spiked assumes $A$ to be quasi-minimal, but the definition of boxed does not. Observe also the following immediate consequences of the definitions: \n\\begin{itemize}\n\\item The $(d-1)$-dimensional configuration $A'$ in the definition of spiked is automatically quasi-minimal. More precisely, it has at most as many non-essential vertices as $A$.\n\\item Boxed configurations have at most $d+2^d$ lattice points: apart from $v_1,\\dots, v_d$, only the $2^d$ vertices of $Q$ can be lattice points of $A$.\n\\end{itemize}\n\\end{remark}\n\nThe reason for these seemingly strange definitions is the following result:\n\n\\begin{theorem}\n\\label{thm:spiked_vs_boxed}\nEvery quasi-minimal configuration is spiked or boxed. \n\\end{theorem}\n\n\n\n\\begin{proof}\nLet $A \\subset {\\mathbb{Z}}^d$ be a quasi-minimal configuration. For each $v_i\\in {\\operatorname{vert}}^*(A)$ let $f_i$ be an affine integer functional with $A ^{v_i} \\subset f_i^{-1}(\\{0,1\\})$.\nLet $\\hat f_i$ be the corresponding linear functional. Two things can happen:\n\\begin{enumerate}\n\n\\item If the set $\\{\\hat f_i : v_i\\in {\\operatorname{vert}}^*(A)\\}$ linearly spans $({\\mathbb{R}}^d)^*$, then assume without loss of generality that $\\hat f_1,\\dots, \\hat f_d$ are independent. By construction $A$ is boxed with respect to the parallelepiped\n", "index": 7, "text": "\n\\[\n\\underset{i=1}{\\overset{d}{\\bigcap}} f_i^{-1} ([0,1]).\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m1\" class=\"ltx_Math\" alttext=\"\\underset{i=1}{\\overset{d}{\\bigcap}}f_{i}^{-1}([0,1]).\" display=\"block\"><mrow><mrow><munderover accent=\"true\" accentunder=\"true\"><mo largeop=\"true\" mathsize=\"160%\" movablelimits=\"false\" stretchy=\"false\" symmetric=\"true\">\u22c2</mo><mrow><mi mathsize=\"142%\">i</mi><mo mathsize=\"142%\" stretchy=\"false\">=</mo><mn mathsize=\"142%\">1</mn></mrow><mo>\ud835\udc51</mo></munderover><mo>\u2062</mo><msubsup><mi>f</mi><mi>i</mi><mrow><mo>-</mo><mn>1</mn></mrow></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\n\n\\end{enumerate}\n\\end{theorem}\n\nThe proof needs a preliminary result, which follows from he classification of lattice $3$-polytopes of sizes five and six. See~\\cite{5points} and~\\cite[Section 5]{6points}:\n\n\\begin{lemma}\n\\label{lemma:exception-height}\nLet $P$ be a lattice $3$-polytope with all but one of its lattice points, call it $v$, in the same plane. Let $Q:=P^v$ be the lattice polygon obtained removing $v$, which we assume to be in the horizontal plane $z=0$. Then:\n\\begin{enumerate}\n\\item If $Q$ contains either a unimodular parallelogram or the following five points, then $v$ is at lattice distance one from $Q$:\n\\label{lemma:exception-height-a}\n", "itemtype": "equation", "pos": 23236, "prevtext": "\n\n\\item If the set $\\{\\hat f_i : v_i\\in {\\operatorname{vert}}^*(A)\\}$ does not linearly span $({\\mathbb{R}}^d)^*$, then there is a line where all the $\\hat f_i$ are constant. That is, there exists an element $r \\in {\\mathbb{Z}}^d$ such that $\\hat f_i(r)=0$ for all $i$. Let $\\pi: {\\mathbb{Z}}^d \\to L:={\\mathbb{Z}}^{d}/\\langle r\\rangle \\cong{\\mathbb{Z}}^{d-1}$, and let $f_i'$ be the  functional in $L$ defined by $f_i(x)=f_i'(\\pi(x))$ for each $x\\in {\\mathbb{Z}}^d$. \nSince $A$ has width greater than one, so does $A':=\\pi(A)$ in $L$. Let us see that $A$ is spiked with respect to $A'$.\n\nLet us first see that each vertex of ${\\operatorname{conv} }(A')$ has a unique preimage in $A$. For this, let $v'$ be a vertex of ${\\operatorname{conv} }(A')$ and suppose $u,v$ are two different vertices of $A$ projecting to $v'$. Then we would have $\\pi(A^{u})=\\pi(A^{v})=\\pi(A)=A'$. But at least one of $u$ and $v$ must be an essential vertex of $A$. Say $v=v_i\\in{\\operatorname{vert}}^*(A)$, then $A^v$ has width one with respect to $f_i$, which is constant in $r$. This would imply $\\pi(A^v)=A'$ to have width one in $L$ with respect to $f_i'$, which is a contradiction.\n\nFinally, let us prove that $\\pi$ bijects essential vertices of $A$ and $A'$. Let $v'$ be a vertex of ${\\operatorname{conv} }(A')$ and let $v$ be the unique vertex of ${\\operatorname{conv} }(A)$ with $\\pi(v)=v'$. \nThen $v\\in{\\operatorname{vert}}^*(A)$ if and only if $A^v$ has width one with respect to a functional $f$ with $\\hat f(r)=0$. This happens if and only if the corresponding functional $f'$ gives width one to $A'\\setminus\\{v'\\}$ in $L$, which in turn is equivalent to $v'\\in{\\operatorname{vert}}^*(A')$.\n\\end{enumerate}\n\\end{proof}\n\n\n\nIn dimension one the only minimal configurations are $\\{0,1,2\\}$ and $\\{0,k\\}$ for any $k\\ge 1$. The only quasi-minimal ones that are not minimal are $\\{0,1, k\\}$, for any $k\\ge 3$.\n\nIn dimension two, classifying quasi-minimal configurations is not that easy, but Theorem~\\ref{thm:spiked_vs_boxed} allows us to classify quasi-minimal polygons:\n\n\\begin{lemma}\n\\label{lemma:quasi-minimal-dim2}\nEvery quasi-minimal $2$-polytope is unimodularly equivalent to one in Figure~\\ref{fig:minimal-dim2}.\n\n\\begin{figure}[ht]\n\\begin{center}\n\\includegraphics[scale=0.7]{polygons3.pdf}\\\\\n\\bigskip\n\\includegraphics[scale=0.7]{polygons4.pdf}\n\\end{center}\n\\caption{The quasi-minimal lattice polygons. In the non-minimal ones (top row) the white dot is the non-essential vertex. Labels 1 to 7 are used in the proof of Theorem~\\ref{thm:exception}.}\n\\label{fig:minimal-dim2}\n\\end{figure}\n\\end{lemma}\n\n\n\\begin{proof}\nAn exhaustive search proves the list for lattice polygones with up to $6$ points.\nSo, for the rest of the proof let $P$ be a quasi-minimal polygon with at least $7$ lattice points. Since it has to be spiked, Theorem~\\ref{thm:spiked_vs_boxed} implies that $P$ projects to $\\{0,1,k\\}$ ($k\\ge 2$) with a single point in the fibers of $0$ and $k$, hence with at least five in the fiber of $1$.\n\nIf $k=2$, then $P$ is a quasi-minimal triangle like one of the two in the statement with an arbitrary number of interior points. If $k\\ge 3$, the fact that there are (at least) five points in the fiber of $1$ implies that there must be some other lattice points of $P$ in the fiber of $2$. Indeed, the fiber of $1$ is a segment of length at least $4$, hence the fiber of $2$ has length at least $4(k-2)/(k-1)\\ge 2$. This cannot happen.\n\\end{proof}\n\n\n\n\nObserve that a polytope can be both spiked and boxed. An example is $P={\\operatorname{conv} }\\{(1,0,0), (0,1,0),(-1,0,0),(0,-1,2)\\}$, whose set of lattice points is $A=\\{(1,0,0),$ $(0,1,0) , (-1,0,0), (0,-1,2),(0,0,0), (0,0,1)\\}$.\n\n\n\n\n\\subsection{An exception}\n\nWe said in the introduction that all $3$-polytopes of size at least $7$ that are not quasi-minimal can be glued from smaller ones. Here we prove a more explicit result:\n\n\\begin{theorem}\n\\label{thm:exception}\nFor every lattice $3$-polytope $P$ of width larger than one exactly one of the following happens:\n\\begin{enumerate}\n\\item $P$ is quasi-minimal.\n\\item There exist vertices $v_1,v_2 \\in {\\operatorname{vert}}(P) \\setminus {\\operatorname{vert}}^*(P)$ such that $P^{v_1,v_2}$ is $3$-dimensional.\n\\item $P$ has size $6$ and is equivalent to \n\n", "index": 9, "text": "\n\\[\\left( \\begin{array}{cccccc}\n0  & 1 & 0 &-1 & 1 & -1\\\\ \n0  & 0 & 1 &-1 & 2 & -2\\\\ \n0  & 0 & 0 & 0 & 3 & -3\\end{array} \\right)\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m1\" class=\"ltx_Math\" alttext=\"\\left(\\begin{array}[]{cccccc}0&amp;1&amp;0&amp;-1&amp;1&amp;-1\\\\&#10;0&amp;0&amp;1&amp;-1&amp;2&amp;-2\\\\&#10;0&amp;0&amp;0&amp;0&amp;3&amp;-3\\end{array}\\right)\" display=\"block\"><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mn>0</mn></mtd><mtd columnalign=\"center\"><mn>1</mn></mtd><mtd columnalign=\"center\"><mn>0</mn></mtd><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>1</mn></mrow></mtd><mtd columnalign=\"center\"><mn>1</mn></mtd><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>1</mn></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mn>0</mn></mtd><mtd columnalign=\"center\"><mn>0</mn></mtd><mtd columnalign=\"center\"><mn>1</mn></mtd><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>1</mn></mrow></mtd><mtd columnalign=\"center\"><mn>2</mn></mtd><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>2</mn></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mn>0</mn></mtd><mtd columnalign=\"center\"><mn>0</mn></mtd><mtd columnalign=\"center\"><mn>0</mn></mtd><mtd columnalign=\"center\"><mn>0</mn></mtd><mtd columnalign=\"center\"><mn>3</mn></mtd><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>3</mn></mrow></mtd></mtr></mtable><mo>)</mo></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\n\n\\item If $Q$ contains one of the following five-point sets, then either $v$ is at lattice distance one from $Q$ or $v=(a,b,\\pm 2)$ with $a \\equiv 1\\equiv b \\mod 2$:\n\\label{lemma:exception-height-b}\n", "itemtype": "equation", "pos": 24024, "prevtext": "\n\n\\end{enumerate}\n\\end{theorem}\n\nThe proof needs a preliminary result, which follows from he classification of lattice $3$-polytopes of sizes five and six. See~\\cite{5points} and~\\cite[Section 5]{6points}:\n\n\\begin{lemma}\n\\label{lemma:exception-height}\nLet $P$ be a lattice $3$-polytope with all but one of its lattice points, call it $v$, in the same plane. Let $Q:=P^v$ be the lattice polygon obtained removing $v$, which we assume to be in the horizontal plane $z=0$. Then:\n\\begin{enumerate}\n\\item If $Q$ contains either a unimodular parallelogram or the following five points, then $v$ is at lattice distance one from $Q$:\n\\label{lemma:exception-height-a}\n", "index": 11, "text": "\n\\[\n(0,0), (-1,0), (-2,0), (0,1), (1,-1).\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex6.m1\" class=\"ltx_Math\" alttext=\"(0,0),(-1,0),(-2,0),(0,1),(1,-1).\" display=\"block\"><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mn>2</mn></mrow><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo>,</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\n\\end{enumerate}\n\\end{lemma}\n\n\n\n\\begin{proof}[Proof of Theorem~\\ref{thm:exception}]\nThat the three cases are mutually exclusive is obvious. Let us assume that $P$ is not in the conditions of (1) or (2). That is, $P$ has at least two non-essential vertices, and for every choice $v_1$ and $v_2$ of them we have that $Q:=P^{v_1,v_2}$ is lower dimensional.\nWe are going to conclude that the only possibility is the configuration in (3), by proving several properties about $P$, and $Q$:\n\n\\begin{enumerate}\n\n\\item[(a)] \\emph{$Q$ is $2$-dimensional}. \\\\\nIf $Q$ is contained in a line then all the lattice points in $P$ lie in the two segments $Q$ and ${\\operatorname{conv} }(v_1,v_2)$. The classification of lattice $3$-polytopes of size $5$ implies that these two segments are at lattice distance one, which contradicts the fact that $P$ has width greater than one.\n\n\\item[(b)] \\emph{$v_1$ and $v_2$ both lie at distance greater than 1 from (the lattice plane containing) $Q$}, since $v_1$ and $v_2$ are not essential.\n\n\\item[(c)] \\emph{$Q$ does not contain a unimodular lattice parallelogram}, by Lemma~\\ref{lemma:exception-height}\\eqref{lemma:exception-height-a}.\n\n\\item[(d)] \\emph{$Q$ has width larger than one}.\\\\ \nSuppose not, so that $Q$ lies in two consecutive parallel lattice lines in the plane that it spans. If both lines have at least two points, then $Q$ contains a unimodular lattice parallelepiped, which contradicts (c). If one of the lines contains only one point then all the points in $P^{v_i}$ lie in two lines so, as in step (a), $P^{v_i}$ has width one for $i=1,2$, which contradicts the fact the $v_1$ and $v_2$ are non-essential.\n\n\\item[(e)] \\emph{None of the non-essential vertices of $Q$ (if it has any) are vertices of $P$.}\\\\\nSuppose otherwise, and let $w$ be a non-essential vertex of $Q$ that is a vertex of $P$. Then $P$ is in the conditions of part (2) with respect to the pair of vertices $\\{w,v_i\\}$, for any choice of $i$. Indeed, the polytope $P^{w,v_i}={\\operatorname{conv} }(Q^{w} \\cup \\{v_j\\})$, for $\\{i,j\\}=\\{1,2\\}$ is $3$-dimensional.\n\n\\item[(f)] \\emph{$Q$ is quasi-minimal (as a polygon in ${\\mathbb{Z}}^2\\times \\{0\\} \\cong {\\mathbb{Z}}^2$)}.\n\nSuppose not. Then $Q$ has at least two non-essential vertices, $w$ and $w'$. By part (e) neither $w$ nor $w'$ are vertices of $P$. This implies that $v_1$ and $v_2$ are on opposite sides of $Q$, and that the intersection point of the segment $v_1v_2$ with the plane containing $Q$ (call it $v_0$) is such that $w$ and $w'$ belong to ${\\operatorname{conv} }(Q^{w,w'}\\cup v_0)$. Observe that $v_0$ cannot be a lattice point. More precisely, the triangle $v_0ww'$ cannot contain lattice points outside the segment $ww'$.\n\nTo fix ideas, without loss of generality let $Q$ lie in the plane $z=0$ and let $w=(0,0,0)$, $w'=(k,0,0)$, and $v_0=(a,b,0)$ with $k,b>0$ and $k\\in {\\mathbb{Z}}$. \nConsider the first lattice point $w''$ in the segment from $w$ to $w'$ (which could equal $w'$); that is, let $w''=(1,0,0)$. Since the triangle $ww''v_0$ does not contain lattice points other than $w$ and $w''$, we can assume by an affine transformation in the plane $z=0$ and fixing the line through $w$ and $w''$ that $0\\le a \\le1$. \n\nLet $v$ and $v'$ be the vertices of ${\\operatorname{conv} }(Q^{w,w'}\\cup v_0)$ adjacent to $v_0$ on the sides of $w$ and $w'$, respectively. The wedge formed by the rays from $v_0$ to $v$ and $v'$ contains the points $u=(0,-1,0)$ and $u'=(1,-1,0)$. Since the $y$ coordinate of $v$ and $v'$ is clearly $\\le -1$, those two points are actually in ${\\operatorname{conv} }\\{w,w',v,v'\\} \\subseteq Q$. That is impossible because then $Q$ contains the unimodular parallelogram $ww''u'u$.\n\n\n\\item[(g)] \\emph{$Q$ is (isomorphic to) the triangle ${\\operatorname{conv} }\\{(-1,-1), (1,0), (0,1)\\}$.}\\\\\nThe full list of quasi-minimal polygons is worked out in Lemma~\\ref{lemma:quasi-minimal-dim2} above and is shown in Figure~\\ref{fig:minimal-dim2}.\nConfigurations 1, 3 and 7 are excluded by Lemma~\\ref{lemma:exception-height}\\eqref{lemma:exception-height-a}. Let us see how to exclude 2, 4 and 5.\n\nObserve that in the three of them, $Q$ together with any of $v_1$ or $v_2$ is in the conditions of Lemma~\\ref{lemma:exception-height}\\eqref{lemma:exception-height-b}, which means that $v_i$ is of the form $(a_i,b_i, \\pm 2)$ with $a_i \\equiv 1\\equiv b_i \\mod 2$, for both $i=1,2$. $v_1$ and $v_2$ cannot be both at the same side of $Q$, for then their mid-point is another lattice point in $P$ apart from $Q$, $v_1$ and $v_2$. So, $v_1$ and $v_2$ are on opposite sides and, in particular, their mid-point is one of the lattice points in $Q$. \n\nConsider first configuration 2 and without loss of generality assume $v_1=(1,1,2)$. Its non-essential vertex $(-k,0,0)$ must not be a vertex in $P$, by part (e). Hence, that non-essential vertex is  the mid-point of $v_1$ and $v_2$, which means $v_2=(-2k+1,-1,-2)$. But then let $v_3=(0,1,0)$ and let us show that the polytope $P^{v_3}$ has width at least two. A linear functional $f$ giving width one to $P^{v_3}$ must be constant in the collinearities $\\{ (0,0,0), (-1,0,0), (-2,0,0)\\}$ and $\\{ (1,1,2), (-k,0,0), (-2k+1,-1,-2)\\}$ which means that $f(x,y,z)= 2y-z$. But then $f(0,0,0)=0$ and $f(0,-1,0) =-2$, which means $P^{v_3}$ has width two. Then $P$, with respect to $v_3$ and any of $v_1$ or $v_2$, is as in part (2) of the Theorem.\n\nIn configurations 4 and 5 the argument is the same, except now the mid-point of $v_1$ and $v_2$ can be any of the five lattice points in $Q$. But in all cases there is a vertex $v_3$ in $Q$ such that $P^{v_3}$ has width at least two. Details are left to the reader.\n\\end{enumerate}\n\nOnce we know that $Q={\\operatorname{conv} }\\{(1,0,0),(0,1,0),(-1,-1,0)\\}$ (modulo isomorphism), then \n$P$ has six lattice points, so we can rely in the classification of $3$-polytopes of size six and width larger than one, contained in~\\cite{6points}. More precisely, Section 6 of that paper studies in detail the configurations consisting of our $Q_1$ plus another two points. The only ones in which the two extra points are at distance larger than one from $Q_1$ (see Sections 6.1.3 and 6.2.2 of~\\cite{6points}) are:\n\n", "itemtype": "equation", "pos": 24267, "prevtext": "\n\n\\item If $Q$ contains one of the following five-point sets, then either $v$ is at lattice distance one from $Q$ or $v=(a,b,\\pm 2)$ with $a \\equiv 1\\equiv b \\mod 2$:\n\\label{lemma:exception-height-b}\n", "index": 13, "text": "\n\\[\n\\{(-1,0), (0,0), (1,0), (0,1), (0,-1)\\}, \\qquad\n\\{(0,0), (-1,0), (-2,0), (0,1), (0,-1)\\}.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex7.m1\" class=\"ltx_Math\" alttext=\"\\{(-1,0),(0,0),(1,0),(0,1),(0,-1)\\},\\qquad\\{(0,0),(-1,0),(-2,0),(0,1),(0,-1)\\}.\" display=\"block\"><mrow><mrow><mrow><mo stretchy=\"false\">{</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">}</mo></mrow><mo rspace=\"22.5pt\">,</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mn>2</mn></mrow><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\n\nIn the first one, $v_1$ and $v_2$ are the only vertices of $P$ that are not in ${\\operatorname{vert}}^*(P)$, and $P^{v_1,v_2}$ is $2$-dimensional, so it is  an exception to cases (1) and (2).\nThe second one is in the conditions of part (2) since $P^{v_3}$ has width larger than one  for $v_3=(1,0,0)$ and the polytope \n", "itemtype": "equation", "pos": 30538, "prevtext": "\n\\end{enumerate}\n\\end{lemma}\n\n\n\n\\begin{proof}[Proof of Theorem~\\ref{thm:exception}]\nThat the three cases are mutually exclusive is obvious. Let us assume that $P$ is not in the conditions of (1) or (2). That is, $P$ has at least two non-essential vertices, and for every choice $v_1$ and $v_2$ of them we have that $Q:=P^{v_1,v_2}$ is lower dimensional.\nWe are going to conclude that the only possibility is the configuration in (3), by proving several properties about $P$, and $Q$:\n\n\\begin{enumerate}\n\n\\item[(a)] \\emph{$Q$ is $2$-dimensional}. \\\\\nIf $Q$ is contained in a line then all the lattice points in $P$ lie in the two segments $Q$ and ${\\operatorname{conv} }(v_1,v_2)$. The classification of lattice $3$-polytopes of size $5$ implies that these two segments are at lattice distance one, which contradicts the fact that $P$ has width greater than one.\n\n\\item[(b)] \\emph{$v_1$ and $v_2$ both lie at distance greater than 1 from (the lattice plane containing) $Q$}, since $v_1$ and $v_2$ are not essential.\n\n\\item[(c)] \\emph{$Q$ does not contain a unimodular lattice parallelogram}, by Lemma~\\ref{lemma:exception-height}\\eqref{lemma:exception-height-a}.\n\n\\item[(d)] \\emph{$Q$ has width larger than one}.\\\\ \nSuppose not, so that $Q$ lies in two consecutive parallel lattice lines in the plane that it spans. If both lines have at least two points, then $Q$ contains a unimodular lattice parallelepiped, which contradicts (c). If one of the lines contains only one point then all the points in $P^{v_i}$ lie in two lines so, as in step (a), $P^{v_i}$ has width one for $i=1,2$, which contradicts the fact the $v_1$ and $v_2$ are non-essential.\n\n\\item[(e)] \\emph{None of the non-essential vertices of $Q$ (if it has any) are vertices of $P$.}\\\\\nSuppose otherwise, and let $w$ be a non-essential vertex of $Q$ that is a vertex of $P$. Then $P$ is in the conditions of part (2) with respect to the pair of vertices $\\{w,v_i\\}$, for any choice of $i$. Indeed, the polytope $P^{w,v_i}={\\operatorname{conv} }(Q^{w} \\cup \\{v_j\\})$, for $\\{i,j\\}=\\{1,2\\}$ is $3$-dimensional.\n\n\\item[(f)] \\emph{$Q$ is quasi-minimal (as a polygon in ${\\mathbb{Z}}^2\\times \\{0\\} \\cong {\\mathbb{Z}}^2$)}.\n\nSuppose not. Then $Q$ has at least two non-essential vertices, $w$ and $w'$. By part (e) neither $w$ nor $w'$ are vertices of $P$. This implies that $v_1$ and $v_2$ are on opposite sides of $Q$, and that the intersection point of the segment $v_1v_2$ with the plane containing $Q$ (call it $v_0$) is such that $w$ and $w'$ belong to ${\\operatorname{conv} }(Q^{w,w'}\\cup v_0)$. Observe that $v_0$ cannot be a lattice point. More precisely, the triangle $v_0ww'$ cannot contain lattice points outside the segment $ww'$.\n\nTo fix ideas, without loss of generality let $Q$ lie in the plane $z=0$ and let $w=(0,0,0)$, $w'=(k,0,0)$, and $v_0=(a,b,0)$ with $k,b>0$ and $k\\in {\\mathbb{Z}}$. \nConsider the first lattice point $w''$ in the segment from $w$ to $w'$ (which could equal $w'$); that is, let $w''=(1,0,0)$. Since the triangle $ww''v_0$ does not contain lattice points other than $w$ and $w''$, we can assume by an affine transformation in the plane $z=0$ and fixing the line through $w$ and $w''$ that $0\\le a \\le1$. \n\nLet $v$ and $v'$ be the vertices of ${\\operatorname{conv} }(Q^{w,w'}\\cup v_0)$ adjacent to $v_0$ on the sides of $w$ and $w'$, respectively. The wedge formed by the rays from $v_0$ to $v$ and $v'$ contains the points $u=(0,-1,0)$ and $u'=(1,-1,0)$. Since the $y$ coordinate of $v$ and $v'$ is clearly $\\le -1$, those two points are actually in ${\\operatorname{conv} }\\{w,w',v,v'\\} \\subseteq Q$. That is impossible because then $Q$ contains the unimodular parallelogram $ww''u'u$.\n\n\n\\item[(g)] \\emph{$Q$ is (isomorphic to) the triangle ${\\operatorname{conv} }\\{(-1,-1), (1,0), (0,1)\\}$.}\\\\\nThe full list of quasi-minimal polygons is worked out in Lemma~\\ref{lemma:quasi-minimal-dim2} above and is shown in Figure~\\ref{fig:minimal-dim2}.\nConfigurations 1, 3 and 7 are excluded by Lemma~\\ref{lemma:exception-height}\\eqref{lemma:exception-height-a}. Let us see how to exclude 2, 4 and 5.\n\nObserve that in the three of them, $Q$ together with any of $v_1$ or $v_2$ is in the conditions of Lemma~\\ref{lemma:exception-height}\\eqref{lemma:exception-height-b}, which means that $v_i$ is of the form $(a_i,b_i, \\pm 2)$ with $a_i \\equiv 1\\equiv b_i \\mod 2$, for both $i=1,2$. $v_1$ and $v_2$ cannot be both at the same side of $Q$, for then their mid-point is another lattice point in $P$ apart from $Q$, $v_1$ and $v_2$. So, $v_1$ and $v_2$ are on opposite sides and, in particular, their mid-point is one of the lattice points in $Q$. \n\nConsider first configuration 2 and without loss of generality assume $v_1=(1,1,2)$. Its non-essential vertex $(-k,0,0)$ must not be a vertex in $P$, by part (e). Hence, that non-essential vertex is  the mid-point of $v_1$ and $v_2$, which means $v_2=(-2k+1,-1,-2)$. But then let $v_3=(0,1,0)$ and let us show that the polytope $P^{v_3}$ has width at least two. A linear functional $f$ giving width one to $P^{v_3}$ must be constant in the collinearities $\\{ (0,0,0), (-1,0,0), (-2,0,0)\\}$ and $\\{ (1,1,2), (-k,0,0), (-2k+1,-1,-2)\\}$ which means that $f(x,y,z)= 2y-z$. But then $f(0,0,0)=0$ and $f(0,-1,0) =-2$, which means $P^{v_3}$ has width two. Then $P$, with respect to $v_3$ and any of $v_1$ or $v_2$, is as in part (2) of the Theorem.\n\nIn configurations 4 and 5 the argument is the same, except now the mid-point of $v_1$ and $v_2$ can be any of the five lattice points in $Q$. But in all cases there is a vertex $v_3$ in $Q$ such that $P^{v_3}$ has width at least two. Details are left to the reader.\n\\end{enumerate}\n\nOnce we know that $Q={\\operatorname{conv} }\\{(1,0,0),(0,1,0),(-1,-1,0)\\}$ (modulo isomorphism), then \n$P$ has six lattice points, so we can rely in the classification of $3$-polytopes of size six and width larger than one, contained in~\\cite{6points}. More precisely, Section 6 of that paper studies in detail the configurations consisting of our $Q_1$ plus another two points. The only ones in which the two extra points are at distance larger than one from $Q_1$ (see Sections 6.1.3 and 6.2.2 of~\\cite{6points}) are:\n\n", "index": 15, "text": "\n\\[\\left( \\begin{array}{cccccc}\n0  & 1 & 0 &-1 & 1 & -1\\\\ \n0  & 0 & 1 &-1 & 2 & -2\\\\ \n0  & 0 & 0 & 0 & 3 & -3\\end{array} \\right) \\quad\n\\left( \\begin{array}{cccccc}\n0  & 1 & 0 &-1 & 1 & -1\\\\ \n0  & 0 & 1 &-1 & 2 &  1\\\\ \n0  & 0 & 0 & 0 & 3 & -3\\end{array} \\right)\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex8.m1\" class=\"ltx_Math\" alttext=\"\\left(\\begin{array}[]{cccccc}0&amp;1&amp;0&amp;-1&amp;1&amp;-1\\\\&#10;0&amp;0&amp;1&amp;-1&amp;2&amp;-2\\\\&#10;0&amp;0&amp;0&amp;0&amp;3&amp;-3\\end{array}\\right)\\quad\\left(\\begin{array}[]{cccccc}0&amp;1&amp;0&amp;-1&amp;1&amp;-1%&#10;\\\\&#10;0&amp;0&amp;1&amp;-1&amp;2&amp;1\\\\&#10;0&amp;0&amp;0&amp;0&amp;3&amp;-3\\end{array}\\right)\" display=\"block\"><mrow><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mn>0</mn></mtd><mtd columnalign=\"center\"><mn>1</mn></mtd><mtd columnalign=\"center\"><mn>0</mn></mtd><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>1</mn></mrow></mtd><mtd columnalign=\"center\"><mn>1</mn></mtd><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>1</mn></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mn>0</mn></mtd><mtd columnalign=\"center\"><mn>0</mn></mtd><mtd columnalign=\"center\"><mn>1</mn></mtd><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>1</mn></mrow></mtd><mtd columnalign=\"center\"><mn>2</mn></mtd><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>2</mn></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mn>0</mn></mtd><mtd columnalign=\"center\"><mn>0</mn></mtd><mtd columnalign=\"center\"><mn>0</mn></mtd><mtd columnalign=\"center\"><mn>0</mn></mtd><mtd columnalign=\"center\"><mn>3</mn></mtd><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>3</mn></mrow></mtd></mtr></mtable><mo>)</mo></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003</mo><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mn>0</mn></mtd><mtd columnalign=\"center\"><mn>1</mn></mtd><mtd columnalign=\"center\"><mn>0</mn></mtd><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>1</mn></mrow></mtd><mtd columnalign=\"center\"><mn>1</mn></mtd><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>1</mn></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mn>0</mn></mtd><mtd columnalign=\"center\"><mn>0</mn></mtd><mtd columnalign=\"center\"><mn>1</mn></mtd><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>1</mn></mrow></mtd><mtd columnalign=\"center\"><mn>2</mn></mtd><mtd columnalign=\"center\"><mn>1</mn></mtd></mtr><mtr><mtd columnalign=\"center\"><mn>0</mn></mtd><mtd columnalign=\"center\"><mn>0</mn></mtd><mtd columnalign=\"center\"><mn>0</mn></mtd><mtd columnalign=\"center\"><mn>0</mn></mtd><mtd columnalign=\"center\"><mn>3</mn></mtd><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>3</mn></mrow></mtd></mtr></mtable><mo>)</mo></mrow></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\nis $3$-dimensional. \n\\end{proof}\n\n\n\n\n\n\n\n\n\\section{The classification of spiked $3$-polytopes}\n\\label{sec:spiked}\n\n\nThe definition of \\emph{spiked} translates in dimension $3$ to Theorem~\\ref{thm:projection_shape} below. In its proof the following easy fact is used several times.\n\n\\begin{lemma}\n\\label{lemma:triangles}\nLet $T:={\\operatorname{conv} }\\{v_1,v_2,v_3\\}$ be a lattice triangle, with $v_3$ at distance more than one from the segment $v_1v_2$. Then, \nthere exists a lattice point $p\\in T$ at smaller, but non-zero, distance to $v_1v_2$ than $v_3$.\n\\end{lemma}\n\\begin{proof}\nWithout loss of generality let $T:={\\operatorname{conv} }\\{(0,0),(0,k),(a,b)\\}$ with $k\\ge1$ and $a\\ge 2$. Consider the triangle $T'={\\operatorname{conv} }\\{(0,0),(0,1),(a,b)\\} \\subseteq T$. Since $T'$ is not unimodular, it contains some extra lattice point $(c,d)$. It is clear that  $0<c<a$.\n\\end{proof}\n\n\n\n\\begin{theorem}\n\\label{thm:projection_shape}\nLet $P$ be a $3$-polytope of size at least seven, spiked with respect to a certain $2$-dimensional configuration $A'$. Let $P'={\\operatorname{conv} }(A')$. Then one of the following three things happens:\n\\begin{enumerate}\n\\item $P'$ is the second dilation of a unimodular triangle.\n \\label{item:dilated_unimodular}\n\\item $P'$ is a reflexive triangle and $A'$ consists of the three vertices of it plus its unique interior point. \\label{item:reflexive}\n\\item $P'$ is a triangle or quadrilateral and $A'=P'\\cap{\\mathbb{Z}}^2$ consists of four lattice points in the boundary and one in the interior. Moreover, the interior point $p'$ is the mid-point of two of the boundary points $v'_2$ and $v'_4$, and the other two boundary points $v'_1$ and $v'_3$ are vertices at lattice distance one from the line containing $p'$, $v'_2$ and $v'_4$.\n\\label{item:spiked}\n\\end{enumerate}\n\\end{theorem}\n\n\\begin{proof}\nLet $\\pi: {\\mathbb{Z}}^3 \\to {\\mathbb{Z}}^2$ be the projection that makes $P$ spiked and let\n $A=P \\cap {\\mathbb{Z}}^3$, so that  $A'=\\pi(A)\\subset {\\mathbb{Z}}^2$. Remember that $A'$ has width at least two, each vertex of ${\\operatorname{conv} }(A')$ has a unique preimage in $A$, at most one vertex of $A'$ is not essential, and $\\pi$ bijects the essential vertices of $A$ to the essential vertices of $A'$.\n\nIf ${\\operatorname{conv} }(A')$ is hollow, then it equals the second dilation of a unimodular triangle (the only hollow polygon of width greater than one), which is case~\\eqref{item:dilated_unimodular} of the statement. So, for the rest of the proof we assume that ${\\operatorname{conv} }(A')$ is not hollow, and let $p'$ be a point in its interior. Let us see that if $A'$ has three vertices in the boundary of ${\\operatorname{conv} }(A')$ then we are in case~\\eqref{item:reflexive}  and if it has four or more then we are in case~\\eqref{item:spiked}.\n\n\\begin{itemize}\n\\item If $A'$ has only three points in the boundary of $P'$, these three points must be essential vertices. Moreover, $A'$ must have some extra point (that is, we can assume $p'$ is in $A'$), since $\\pi$ bijects essential vertices and $|A|\\ge 7$. We claim that ${\\operatorname{conv} }(A')$ is a reflexive triangle with respect to $p'$ (in particular, it has no other interior points), which is case~\\eqref{item:reflexive}. \n\nIf ${\\operatorname{conv} }(A')$ is not reflexive, then $p'$ is at lattice distance more than one from one of the sides $v'_1v'_2$ of it. But the triangle $p'v'_1v'_2$ has width one, because the third vertex $v'_3$ of ${\\operatorname{conv} }(A')$ is essential. Suppose $p'v'_1v'_2$ has width one with respect to $p'v'_2$. By Pick's Theorem, ${\\operatorname{conv} }(p'v'_1v'_2)$ must contain more lattice points, which can only be in the segment $p'v'_2$. A priori these extra lattice points may or may not be in $A'$, but both possibilities lead to a contradiction: If at least one of them is in $A'$ then $A'\\setminus \\{v'_2\\}$ is not of width one because $p'$ is an interior point of it. If none of them is in $A'$, then $A'$ consists only of the four points we know of. Since the fibers of $v'_1$, $v'_2$ and $v'_3$ have a single point, the fiber of $p'$ has at least four lattice points. By Lemma~\\ref{lemma:triangles}, there is some point of $A$ projecting to an interior point of the segment $p'v'_2$, which would then be in $A'$. \n\n\\item If $A'$ has at least four points in the boundary of $P'$, let $v_1', ... , v_3'$ be essential vertices and let $v'_4$ be another boundary lattice point, which may or may not be a vertex. We assume $v_1', ... , v_4'$ to be cyclically ordered along the boundary.\n\nObserve that the segment $v'_2v'_4$ decomposes ${\\operatorname{conv} }(A')$ as the union of two polygons $P'_1$ and $P'_3$ contained respectively in \n ${\\operatorname{conv} }(A'\\setminus \\{v'_1\\})$ and ${\\operatorname{conv} }(A'\\setminus \\{v'_3\\})$, with the point $p'$  lying either in the segment $v'_2v'_4$ or in the interior of one of the two subpolygons. Since ${\\operatorname{conv} }(A'\\setminus \\{v'_1\\})$ and ${\\operatorname{conv} }(A'\\setminus \\{v'_3\\})$ have width one, the latter is impossible, so $p'$ lies in $v'_2v'_4$. This forces the widths of ${\\operatorname{conv} }(A'\\setminus \\{v'_1\\})$ and ${\\operatorname{conv} }(A'\\setminus \\{v'_3\\})$ to be one with respect to a functional constant on the segment, which implies that $v'_1$ and $v'_3$ are the only lattice points of ${\\operatorname{conv} }(A')$ outside the segment $v'_2v'_4$, and they are at lattice distance one from the segment.\nIn particular, $v'_1,v'_2,v_3'$, and $v_4'$ are the only boundary lattice points in ${\\operatorname{conv} }(A')$, $v'_4$ is either a vertex or it lies in the segment $v'_1v'_3$. \n\nLet us see that $A'$ must have some interior lattice point (a priori, $p'$ may not be in $A'$).\nSince the preimages of vertices of $A'$ in $A$ consist of a single point and $A'$ has at least size seven, if $v'_4$ is a vertex then $A'$ must have some other lattice point, hence an interior point. In the case of $v_4'$ not being a vertex, if there are no other points in $A'$ then the fiber of $v'_4$ must have at least four lattice points. Applying Lemma~\\ref{lemma:triangles} to the triangle formed by the fiber of $v'_4$ (a segment) and $v'_2$ (a point)  we conclude that $A$ has some lattice point projecting to the  interior of the segment $v_4'v'_2$.\n\nOn the other hand, $A'$ cannot have \\emph{two} interior lattice points: if it does, they are both in the segment $v'_2v'_4$, and call $q'$ the closest to $v'_4$. Then $q$ is in the interior of  $ {\\operatorname{conv} }(A'\\setminus \\{v'_2\\})$, which is a contradiction since $v_2'$ is an essential vertex of $A'$. \n\nThat is, we can assume that $p'$ is the only point of $A'$ in the interior of ${\\operatorname{conv} }(A')$, and to conclude that $A'$ is in the conditions of part~\\eqref{item:spiked} we only need to check that $p'v'_2$ and $p'v'_4$ are primitive.\nIf the fiber of $p'$ in $A$ has at least two points, then Lemma~\\ref{lemma:triangles} applied to the triangle formed by these two points plus $v'_2$ (resp.~$v'_4$) implies that $p'v_2'$ (resp.~ $v_4'p'$) is primitive: otherwise, $A$ must have lattice points projecting to the interior of them.\nIf the fiber of $p'$ in $A$ has a single point then the fiber of $v'_4$ must have at least three and the same argument shows that $v'_4p'$ is primitive, but we need an extra argument for $p'v'_2$.\n\nSo, suppose that $p'$ has a single point $p$ in its fiber, which implies $v'_4$ has at least three. \nCall $v^+_4$, $v^0_4$ and $v^-_4$ three consecutive points in the fiber of $v'_4$, and call $p^+= p + v^+_4-v^0_4$ and $p^-= p + v^-_4-v^0_4$. That is, $p^+$, $p$ and $p^-$ are consecutive points projecting to $p'$, in the same order as $v^+_4$, $v^0_4$ and $v^-_4$. Let $v_2$ be the point in the fiber of $v'_2$. See Figure~\\ref{fig:diff_triangle}.\nSince the triangle $v^+_4v^-_4v_2$ leaves $p^+$ and $p^-$ outside, $v_2$ must lie in the ray from $v^0_4$ through $p$. Then the lattice points \nin the segment $pv_2$ are all in $A$, but no such point can arise other than $p$ and $v_2$ because it would project to a point of $A'$ in the interior of the segment $p'v'_2$, which does not exist. Hence, $pv_2$ is primitive, and so is $p'v'_2$.\n\\begin{figure}\n\\centerline{\n\\includegraphics[scale=.8]{diff_triangle.pdf}}\n\\caption{The situation in the final part of the proof of Theorem~\\ref{thm:projection_shape}}\n\\label{fig:diff_triangle}\n\\end{figure}\n\\end{itemize}\n\\end{proof}\n\n\n\n\n\\begin{corollary}\n\\label{coro:spiked-projections}\nA spiked $3$-polytope is spiked with respect to one of the ten quasi-minimal configurations of Figure~\\ref{fig:2dim_projections}.\n\\begin{figure}[h]\n\\centerline{\\includegraphics[scale=0.8]{proof1.pdf}}\n\\centerline{\\includegraphics[scale=0.8]{proof2.pdf}}\n\\centerline{\\includegraphics[scale=0.8]{proof3.pdf}}\n\\caption{The ten quasi-minimal configurations that can arise as the projection of a spiked $3$-polytope. Labels $v'_i$ of certain lattice points are there for reference in the proof of Theorem~\\ref{theorem:spiked-quasiminimals}.}\n\\label{fig:2dim_projections}\n\\end{figure}\n\\end{corollary}\n\n\\begin{proof}\nLet $P$ be our spiked $3$-polytope and let $A'=\\pi(P\\cap {\\mathbb{Z}}^3)\\subset{\\mathbb{Z}}^2$ be the quasi-minimal configuration for which $P$ is spiked. \nWithout loss of generality assume that $\\pi$ is the projection that forgets the third coordinate.\n\nLet us look at the three cases allowed by Theorem~\\ref{thm:projection_shape} for $P':={\\operatorname{conv} }(A')$:\n\n\\begin{enumerate}\n\\item[\\eqref{item:dilated_unimodular}] If $P'$ is the dilated unimodular triangle, all three vertices of $P'$ are in $A'$ but the mid-points of edges may or may not be in $A'$. The statement simply says that at least one of them is in $A'$. (This is the only case missing from the top row of Figure~\\ref{fig:2dim_projections}). To show this, let $v_1$, $v_2$ and $v_3$ be the three essential vertices of $P$ projecting to the three essential vertices $v'_1$, $v'_2$ and $v'_3$ of $P'$. At least two of the $v_i$'s, say $v_1$ and $v_2$, have third coordinate of the same parity. That implies that their midpoint is a lattice point, so the midpoint of $v'_1$ and $v'_2$ is in $A'$.\n\n\\item[\\eqref{item:reflexive}] Suppose $P'$ is a reflexive triangle and the unique points of $A'$ are the three vertices and the unique interior point of $P'$. There are five reflexive triangles; the four in the middle row of Figure~\\ref{fig:2dim_projections} plus the following one:\n\n\\centerline{\n\\includegraphics[scale=0.7]{reflexive_exception.pdf}}\n\\label{fig:reflexive_exception}\nBut, as in case (1), if $P'$ is this triangle then two of the essential vertices of $P$ are at heights of the same parity and their mid-point projects to a lattice point in $A'$.\n\n\\item[\\eqref{item:spiked}] In case \\eqref{item:spiked} of the theorem, without loss of generality take $p'=(0,0)$, $v'_2=(0,-1)$ and $v'_4=(0,1)$. Then, $v'_1=(-1,0)$ and $v'_3=(1,a)$. For all the $v'_i$'s to be in the boundary and $v'_2$ be a vertex we need $a\\in(-2,2]$. Since $a=1$ and $a=-1$ are equivalent, we are left with the three possibilities in the last row of Figure~\\ref{fig:2dim_projections}.\n\\end{enumerate}\n\\end{proof}\n\n\n\\begin{theorem}\n\\label{theorem:spiked-minimals}\nLet $P$ be a spiked minimal lattice $3$-polytope of size at least seven. Then $P$ is equivalent to\n", "itemtype": "equation", "pos": 31120, "prevtext": "\n\nIn the first one, $v_1$ and $v_2$ are the only vertices of $P$ that are not in ${\\operatorname{vert}}^*(P)$, and $P^{v_1,v_2}$ is $2$-dimensional, so it is  an exception to cases (1) and (2).\nThe second one is in the conditions of part (2) since $P^{v_3}$ has width larger than one  for $v_3=(1,0,0)$ and the polytope \n", "index": 17, "text": "\n\\[\nP^{v_1,v_3}={\\operatorname{conv} }\\{(0,0,0),(0,1,0),(-1,-1,0),(-1,1,-3)\\}\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex9.m1\" class=\"ltx_Math\" alttext=\"P^{v_{1},v_{3}}={\\operatorname{conv}}\\{(0,0,0),(0,1,0),(-1,-1,0),(-1,1,-3)\\}\" display=\"block\"><mrow><msup><mi>P</mi><mrow><msub><mi>v</mi><mn>1</mn></msub><mo>,</mo><msub><mi>v</mi><mn>3</mn></msub></mrow></msup><mo>=</mo><mrow><mo>conv</mo><mo>\u2061</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mn>1</mn><mo>,</mo><mrow><mo>-</mo><mn>3</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">}</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\nfor some $(a,b) \\in \\{(0,0),(0,1),(1,1)\\}$ and an integer $k\\ge 2$. It has size $k+5$.\n\\end{theorem}\n\n\n\\begin{proof}\nBy Corollary~\\ref{coro:spiked-projections}, $P$ is spiked with respect to one of the configurations $A'_i$ in Figure~\\ref{fig:2dim_projections}. Since $P$ has at least four essential vertices,  so does $A'_i$, which leaves only the possibility $A'_8$.\nWe use the coordinates and labels from Figure~\\ref{fig:2dim_projections}, and assume that the projection is the one that forgets the $z$ coordinate. \n\nBy definition of spiked the lattice points in $P$ are its four essential vertices $v_i$ that project to each $v_i'$, plus the lattice points projecting to $(0,0)$, none of which are vertices. We assume that there are $k+1$ such points and they form the segment $S_k=\\{(0,0,0),(0,0,1),\\dots, (0,0,k)\\}$ for some $k$ (with $k\\ge 2$ or otherwise $P$ has size less than seven). Since the triangle $v'_0v'_1v'_2$ is unimodular, we can arbitrarily change the heights of $v_1$ and $v_2$ keeping the choices so far, so we assume $v_1=(1,0,0)$ and $v_2=(0,1,0)$. \n\nLet $l$ be the vertical line $\\{x=y=0\\}$. \nIn order for the fiber of $v'_0$ in $P\\cap {\\mathbb{Z}}^3$ to equal $S_k$,\none of the segments $v_1v_3$ and $v_2v_4$ must cut  the vertical line $\\{x=y=0\\}$ at height in $(-1,0]$, and the other at height in $[k,k+1)$. Furthermore, by the symmetry of the configuration of points, we can assume that $a\\le b$. That is, without loss of generality, $v_3=(-1,0,-a)$ and $v_4=(0,-1,2k+b)$ with $(a,b) \\in \\{(0,0),(0,1),(1,1)\\}$.\n\\end{proof}\n\n\n\\begin{theorem}\n\\label{theorem:spiked-quasiminimals}\nLet $P$ be a spiked quasi-minimal but not minimal lattice $3$-polytope of size at least seven. Then $P$ is equivalent to one of the following. In all cases $k\\ge 2$ is an  integer and the point in boldface is the non essential vertex of $P$.\n\\begin{enumerate}\n\n\\item ${\\operatorname{conv} }\\{(1,-1,-1),(-1,1,1),(-1,-1,0),{\\bf (0,0,k)}\\}$, of size $k+4$. \n\\smallskip\n\n\n\\item $ {\\operatorname{conv} }\\{(1,-1,0),(-1,1,-1),(-1,-1,0),{\\bf (0,0,k)}\\}$, of size $k+5$. \n\\smallskip\n\n\n\\item $ {\\operatorname{conv} }\\{(1,-1,0),(-1,1,0),(-1,-1,0),{\\bf (0,0,k)}\\}$, of size $k+6$. \n\\smallskip\n\n\n\\item ${\\operatorname{conv} }\\{(2,-1,-1),(-1,2,1),(-1,-1,0),{\\bf (0,0,k)}\\}$, of size $k+4$. \n\\smallskip\n\n\n\\item $ {\\operatorname{conv} }\\{(1,-1,-1),(0,1,a),(-1,-1,0),{\\bf (0,0,k)}\\}, a\\in \\{-1,0\\}$, of size $k+4$.  \n\\smallskip\n\n\n\\item $ {\\operatorname{conv} }\\{(1,0,0),(0,1,a),(-1,-1,0),{\\bf (0,0,k)}\\}, \\ a \\in \\{-2,-1,0\\}$, of size $k+4$.\n\\smallskip\n\n\n\\item $ {\\operatorname{conv} }\\{(2,1,0),(-1,1,a),(-1,-1,0),{\\bf (0,0,k)}\\}, \\ a \\in \\{-5,-1\\}$, of size $k+4$.\n\\smallskip\n\n\n\\item $ {\\operatorname{conv} }\\{(1,0,0),(0,1,0),(-1,0,a),(0,-1,b),{\\bf (0,0,k)}\\}, \\  a \\in \\{-1,0\\}, a \\le b < 2k$, of size $k+5$. \n\\smallskip\n\n\n\\item $ {\\operatorname{conv} }\\{(1,0,0),(0,1,0),(-1,-1,a),{\\bf (1,1,2k-a+b)}\\}, \\ a \\in \\{-2,-1,0\\}, b \\in \\{0,1\\}$, of size $k +5$.\n\\smallskip\n\n\n\n\\item[(10a)] ${\\operatorname{conv} }\\{(1,0,a),(0,2,b),(-1,0,0),{\\bf (0,0,k)}\\}, \\ a, b \\in \\{-1,0\\}$, of size $\\lfloor (3k+b)/2 \\rfloor +5$. \n\\smallskip\n\n\n\\item[(10b)] $ {\\operatorname{conv} }\\{(1,0,0),(0,2,a),(-1,0,0),{\\bf (0,1,k)}\\}, \\ a \\in \\{-1,0\\}$, of size $k+5$. \n\n\\end{enumerate}\n\\end{theorem}\n\n\n\\begin{proof} \nBy Corollary~\\ref{coro:spiked-projections}, $P$ is spiked with respect to one of the ten configurations $A'_i$ in Figure~\\ref{fig:2dim_projections}. \nThis will correspond to the ten cases in the statement, except that case (10) subdivides into two subcases as we show below.\nWithout loss of generality we can assume that the projection is the one that forgets the $z$ coordinate and we take in ${\\mathbb{Z}}^2$ the system of coordinates of Figure~\\ref{fig:2dim_projections}. \n\nLet us first concentrate in cases (1) to (7), in which $A'_i$ is a minimal configuration and ${\\operatorname{conv} }(A_i')$ a triangle (with vertices $v'_1$, $v'_2$ and $v'_3$ as labeled in the figure). \nThis implies that $P$ is a tetrahedron with three essential vertices $v_1$, $v_2$, $v_3$ projecting to the three vertices of ${\\operatorname{conv} }(A'_i)$, plus a non-essential vertex $v_0$ projecting to a non-vertex lattice point $v'_0$ of $A'_i$. In all except $A'_2$ and $A'_3$ there is only one choice for $v'_0$. In cases $A'_2$ and $A'_3$ there are several possibilities for $v'_0$ but they are equivalent to one another. This allows as to assume $v'_0$ is as shown in the figure in all cases. Hence, to finish the proof for these seven cases  we only need to derive the possible third coordinates (the heights) for the four vertices $v_i$, in each case. We denote these heights $h_0$, $h_1$, $h_2$ and $h_3$, and let us check that without loss of generality they are as in the statement:\n\n\\begin{itemize}\n\\item Let $k+1$ be the number of lattice points in the fiber of $v'_0$  in $P\\cap {\\mathbb{Z}}^3$. We take without loss of generality $v_0=(0,0,k)$ (that is, $h_0=k$), so that $(0,0,0)$ is the bottom-most point in the fiber. Observe that $v'_0$ is the only point of $A'_i$ whose fiber in $P\\cap {\\mathbb{Z}}^3$ has more than a single point. For all except $A'_2$ and $A'_3$ this is obvious, since $v'_0$ is the only non-vertex. For $A'_2$ and $A'_3$, the fibers of $(0,-1)$  (in both) and $(-1,0)$ (in $A'_3$) must be single points or otherwise they produce additional vertices in $P$, which do not exist.\n\n\\item Since the segment $v'_0v'_3$ is primitive, there is no loss of generality in taking height zero for $v_3$. That is to say, $h_3=0$ and $v_3=(-1,-1,0)$, in all seven cases.\n\n\\item Let $d_i\\ge 1$ be the lattice distance from $v'_1$ to the line  $\\{x=y\\}$ spanned by $v'_0v'_3$. (That is, $d_i=2,2,2,3,2,1$ and $1$, respectively, in cases (1) to (7)). \nSince the unimodular transformation $(x,y,z)\\to (x,y,z\\pm(x-y))$ fixes the plane containing all the choices so far and changes the height of $v_1$ by $d_i$ units, without loss of generality we choose the height of $v_1$ to be in $\\{0,-1,\\dots, -d_i +1\\}$.\nMoreover, this height must be even in  cases  (2) and (3), in order for the midpoint of $v_1v_3$ be a lattice point, and it must be prime with $d_i$ in all other cases, in order for the segment $v_1v_3$ to be primitive. Summing up, the height $h_1$ of $v_1$ equals: $0$ in (2), (3), (6), and (7); $-1$ in (1) and (5);  and $-1$ or $-2$ in (4). \n\n\n\\item In order to study $h_2$, let $h$ be the height at which the triangle $v_1v_2v_3$ intersects the vertical line projecting to $v'_0$. Since our choice is that $(0,0,0)$ is the bottom-most lattice point in the fiber of $v'_0$, we must have $h\\in (-1,0]$. This in turn implies a bounded interval for the height $h_2$ in each case, namely:\n\n\\begin{itemize}\n\\item[(1)] $h_2 \\in(-1,1]$.\n\\hfil \n\\ \\ \\ \\quad(5) $h_2 \\in (-3/2,1/2]$.\n\n\\item[(2)] $h_2 \\in(-2,0]$.\n\\hfil \n(6) $h_2 \\in (-3,0]$.\n\n\\item[(3)] $h_2 \\in (-2,0]$.\n\\hfil \n(7) $h_2 \\in (-6,0]$.\n\n\\item[(4)] $h_2 \\in (-2, 1]$ if $h_1=-1$ and $h_2 \\in (-1, 2]$ if $h_1=-2$.\n\\end{itemize}\n\n\\item This already gives a finite list of possibilities for all heights, but there are the following additional considerations:\n\n\\begin{itemize}\n\\item In (3), $h_2$ must be even in order for the midpoint of $v_2v_3$ to be integer.\n\\item In (1), (2) and (7), $h_2$ must be odd for the segment $v_2v_3$ to be primitive.\n\\item In (4), $h_2 \\ne 0 \\pmod 3$ for the segment $v_2v_3$ to be primitive.\n\\item In (4) and (7),  $h_2 \\ne h_1 \\pmod 3$  for the segment $v_1v_2$ to be primitive.\n\\end{itemize}\nTogether with the intervals stated above, this fixes $h_2$ to be $1$, $-1$, and $0$, in cases (1), (2) and (3), respectively. In case (4) we have two possibilities for $(h_1,h_2)$, namely $(-1,1)$ and $(-2,2)$, but they produce equivalent configurations via the transformation $(x,y,z)\\mapsto(y,x,x-y+z)$), so we take the first one.\nIn cases (5), (6) and (7) we have $h_2\\in \\{-1,0\\}$, $h_2\\in \\{-2,-1,0\\}$, and $h_2\\in \\{-5,-1\\}$, respectively. This finishes the proofs of these seven cases.\n\n\\end{itemize}\n\n\nWe now look at the  three remaining cases, $A'_8$, $A'_9$, and $A'_{10}$.  As before, we will denote by $h_i$ the height of the vertex $v_i$ of $P$ projecting to a point $v_i'\\in A_i'$. The ideas are essentially the same, with slight modifications:\n\\begin{itemize}\n\n\\item[(8)] $A'_{8}$ is minimal, hence in this case $P$ has four essential vertices $v_1,v_2,v_3,v_4$ projecting to the four vertices of $A'_8$ plus a fifth non-essential vertex $v_0$  projecting to $v'_0=(0,0)$. \nAgain, we choose $v_0=(0,0,k)$ where $k+1$ is the number of lattice points above $v'_0$, and as in Theorem~\\ref{theorem:spiked-minimals}, we can take without loss of generality, the heights of $v_1$ and $v_2$ to be zero. By symmetry, we can also assume $h_3\\le h_4$ which implies, in order for the bottom-most point in the fiber of $v'_0$ to be $(0,0,0)$, that $h_3\\in \\{-1,0\\}$. \nFinally, in order for $v_0$ to be above the segment $v_2v_4$ we need $h_4 < 2k$.\n\n\\item[(9)] $A'_{9}$ is not minimal, so the vertices of $P$ biject to those of $A'_{9}$ and all other lattice points in $P$ project to the unique non-vertex point $p_0'=(0,0)$. We let the fiber of $p'_0$ consist of $(0,0,0),\\dots, (0,0,k)$, as in previous cases. Since the triangle $p'_0v'_1v'_2$ is unimodular we can choose the heights of $v_1$ and $v_2$ to be zero. Also, we make the choice that the triangle $v_1v_2v_3$ lies below (perhaps not strictly) $(0,0,0)$ and the segment $v_0v_3$ lies above. The opposite choice would lead to equivalent configurations.\n\nThen, for the triangle $v_1v_2v_3$ to cut the line $\\{x=y=0\\}$ at height in $(-1,0]$ we need $h_3\\in (-3,0]$. And for the segment  $v_0v_3$ to cut that line at height in $[k,k+1)$ we need $(h_0+h_3)/2 \\in [k, k+1)$. Hence $h_0\\in\\{2k-h_3,2k-h_3+1\\}$ and $k=\\lfloor(h_0+h_3)/2\\rfloor$.\n\n\n\\item[(10)] $A'_{10}$ is minimal, which implies $P$ to have three essential vertices $v_1,v_2,v_3$ projecting to the three vertices of $A'_{10}$, plus a fourth non-essential vertex  projecting to one of the other two lattice points,  $v'_0=(0,0)$ and $w'_0=(0,1)$. We consider the two cases separately:\n\\begin{itemize}\n\\item[(10a)] If the non-essential vertex projects to $v'_0$, call it $v_0$. By the same arguments as before, we can assume that $v_0=(0,0,k)$, $(0,0,0)$ is the bottom-most point in the fiber of $v_0'$, $h_3=0$ and $h_1 \\in \\{-1,0\\}$. Once these are fixed, unimodular transformations can change the height of $v_2$ by arbitrary even numbers, so we can take the height of $v_2$ in $\\{0,-1\\}$ as well. \nObserve that the fiber of point $w_0'$ in $P$ is the segment going from $(0,1,h')$, with $h'=(h_1+2 h_2)/4\\in (-1,0]$, to $(0,1,(h_2 + k)/2)$. It then contains the $\\lfloor (h_2+k)/2 \\rfloor+1$ lattice points from $(0,1,0)$  to $(0,1,\n\\lfloor (h_2+k)/2 \\rfloor)$.\n\n\\item[(10b)] If the non-essential vertex projects to $w'_0$, call it $w_0$. By the same arguments as before, we can assume that $w_0=(0,1,k)$, $(0,1,0)$ is the bottom-most point in the fiber of $w_0'$, $h_3=0$ and $h_1 \\in \\{-1,0\\}$. In this case, the fiber of $v_0'$ consists of a single point, the middle point of segment $v_1v_3$. In order for this point to be a lattice point, $h_1$ has to be even, hence $h_1=0$. Then, in order for the triangle $v_1v_2v_3$ to cut the fiber of $w_0'$ at a height in $(-1,0]$, we need $h_2\\in\\{-1,0\\}$.\n\n\\end{itemize}\n\n\\end{itemize}\n\nIn all cases $k$ can be assumed at least two: In case  $A'_3$ because otherwise $P$ has width one with respect to the vertical direction. In all other cases because otherwise $P$ has size at most $6$. \n\\end{proof}\n\n\n\\begin{remark}\n\\label{remark:spiked}\n\\rm\nFor $k\\ge 3$  all the polytopes described in Theorem~\\ref{theorem:spiked-quasiminimals} are spiked, quasi-minimal, not minimal, non-isomorphic to one another, and have size $\\ge 7$. But for $k=2$ the following happens: \n\\begin{itemize}\n\\item Cases (1), (4), (5), (6), and (7) produce size six.\n\\item In some cases (sometimes depending also on the values of $a$ and $b$) the vertex that should be non-essential (the vertex $v_0$ or $w_0$ in the proof, projecting to $v'_0$ or $w'_0$ in Figure~\\ref{fig:2dim_projections}) turns out to be essential. In this case the polytope obtained is minimal, and it is not spiked: the projection does not biject essential vertices to essential vertices.\n\\end{itemize}\n\nThis means that for each size $n\\ge 9$ there are \\emph{exactly} the following non-equivalent spiked $3$-polytopes: $3$ spiked minimal tetrahedra; $23$ if $n=0 \\pmod 3$ and $21$ if $n \\ne 0 \\pmod 3$ spiked quasi-minimal, not minimal tetrahedra; and $4n-19$ spiked quasi-minimal, not minimal $3$-polytopes with $5$ vertices. For $n=8$ and $7$ the global counts are decreased by two. See exact numbers in Table~\\ref{table-minimal}.\n\\end{remark}\n\n\\begin{remark}\n\\rm\nObserve as well that no $3$-polytope of size at least seven can be both spiked and boxed. \nIndeed, with $k\\ge 2$ in Theorems~\\ref{theorem:spiked-minimals} and~\\ref{theorem:spiked-quasiminimals} the only way to get a boxed and spiked polytope is if there exists an essential vertex $v$ such that $P^v$ has width one with respect to a functional that is not constant on the fibers of the projection. This implies that each fiber can contain at most two lattice points of $P^v$. Since $v$ is an essential vertex, it does not belong to the fiber of $S_k$, and the previous implies that $k=1$.\n\n\\end{remark}\n\n\n\n\n\n\n\n\\section{The classification of boxed $3$-polytopes}\n\\label{sec:boxed}\n\n\nIn this section, let $P$ be a  boxed $d$-polytope of size at least seven.\n\nWith the notation of Definition~\\ref{def:boxed}, for each $i \\in \\{1, \\dots, d\\}$, $v_{i} \\in{\\operatorname{vert}}^*(P)$, $f_{i}(v_i)\\not\\in \\{0,1\\}$ and $v_i \\in \\underset{j\\neq i}{\\bigcap} f_j^{-1} (\\{0,1\\})$. Let\n", "itemtype": "equation", "pos": 42501, "prevtext": "\nis $3$-dimensional. \n\\end{proof}\n\n\n\n\n\n\n\n\n\\section{The classification of spiked $3$-polytopes}\n\\label{sec:spiked}\n\n\nThe definition of \\emph{spiked} translates in dimension $3$ to Theorem~\\ref{thm:projection_shape} below. In its proof the following easy fact is used several times.\n\n\\begin{lemma}\n\\label{lemma:triangles}\nLet $T:={\\operatorname{conv} }\\{v_1,v_2,v_3\\}$ be a lattice triangle, with $v_3$ at distance more than one from the segment $v_1v_2$. Then, \nthere exists a lattice point $p\\in T$ at smaller, but non-zero, distance to $v_1v_2$ than $v_3$.\n\\end{lemma}\n\\begin{proof}\nWithout loss of generality let $T:={\\operatorname{conv} }\\{(0,0),(0,k),(a,b)\\}$ with $k\\ge1$ and $a\\ge 2$. Consider the triangle $T'={\\operatorname{conv} }\\{(0,0),(0,1),(a,b)\\} \\subseteq T$. Since $T'$ is not unimodular, it contains some extra lattice point $(c,d)$. It is clear that  $0<c<a$.\n\\end{proof}\n\n\n\n\\begin{theorem}\n\\label{thm:projection_shape}\nLet $P$ be a $3$-polytope of size at least seven, spiked with respect to a certain $2$-dimensional configuration $A'$. Let $P'={\\operatorname{conv} }(A')$. Then one of the following three things happens:\n\\begin{enumerate}\n\\item $P'$ is the second dilation of a unimodular triangle.\n \\label{item:dilated_unimodular}\n\\item $P'$ is a reflexive triangle and $A'$ consists of the three vertices of it plus its unique interior point. \\label{item:reflexive}\n\\item $P'$ is a triangle or quadrilateral and $A'=P'\\cap{\\mathbb{Z}}^2$ consists of four lattice points in the boundary and one in the interior. Moreover, the interior point $p'$ is the mid-point of two of the boundary points $v'_2$ and $v'_4$, and the other two boundary points $v'_1$ and $v'_3$ are vertices at lattice distance one from the line containing $p'$, $v'_2$ and $v'_4$.\n\\label{item:spiked}\n\\end{enumerate}\n\\end{theorem}\n\n\\begin{proof}\nLet $\\pi: {\\mathbb{Z}}^3 \\to {\\mathbb{Z}}^2$ be the projection that makes $P$ spiked and let\n $A=P \\cap {\\mathbb{Z}}^3$, so that  $A'=\\pi(A)\\subset {\\mathbb{Z}}^2$. Remember that $A'$ has width at least two, each vertex of ${\\operatorname{conv} }(A')$ has a unique preimage in $A$, at most one vertex of $A'$ is not essential, and $\\pi$ bijects the essential vertices of $A$ to the essential vertices of $A'$.\n\nIf ${\\operatorname{conv} }(A')$ is hollow, then it equals the second dilation of a unimodular triangle (the only hollow polygon of width greater than one), which is case~\\eqref{item:dilated_unimodular} of the statement. So, for the rest of the proof we assume that ${\\operatorname{conv} }(A')$ is not hollow, and let $p'$ be a point in its interior. Let us see that if $A'$ has three vertices in the boundary of ${\\operatorname{conv} }(A')$ then we are in case~\\eqref{item:reflexive}  and if it has four or more then we are in case~\\eqref{item:spiked}.\n\n\\begin{itemize}\n\\item If $A'$ has only three points in the boundary of $P'$, these three points must be essential vertices. Moreover, $A'$ must have some extra point (that is, we can assume $p'$ is in $A'$), since $\\pi$ bijects essential vertices and $|A|\\ge 7$. We claim that ${\\operatorname{conv} }(A')$ is a reflexive triangle with respect to $p'$ (in particular, it has no other interior points), which is case~\\eqref{item:reflexive}. \n\nIf ${\\operatorname{conv} }(A')$ is not reflexive, then $p'$ is at lattice distance more than one from one of the sides $v'_1v'_2$ of it. But the triangle $p'v'_1v'_2$ has width one, because the third vertex $v'_3$ of ${\\operatorname{conv} }(A')$ is essential. Suppose $p'v'_1v'_2$ has width one with respect to $p'v'_2$. By Pick's Theorem, ${\\operatorname{conv} }(p'v'_1v'_2)$ must contain more lattice points, which can only be in the segment $p'v'_2$. A priori these extra lattice points may or may not be in $A'$, but both possibilities lead to a contradiction: If at least one of them is in $A'$ then $A'\\setminus \\{v'_2\\}$ is not of width one because $p'$ is an interior point of it. If none of them is in $A'$, then $A'$ consists only of the four points we know of. Since the fibers of $v'_1$, $v'_2$ and $v'_3$ have a single point, the fiber of $p'$ has at least four lattice points. By Lemma~\\ref{lemma:triangles}, there is some point of $A$ projecting to an interior point of the segment $p'v'_2$, which would then be in $A'$. \n\n\\item If $A'$ has at least four points in the boundary of $P'$, let $v_1', ... , v_3'$ be essential vertices and let $v'_4$ be another boundary lattice point, which may or may not be a vertex. We assume $v_1', ... , v_4'$ to be cyclically ordered along the boundary.\n\nObserve that the segment $v'_2v'_4$ decomposes ${\\operatorname{conv} }(A')$ as the union of two polygons $P'_1$ and $P'_3$ contained respectively in \n ${\\operatorname{conv} }(A'\\setminus \\{v'_1\\})$ and ${\\operatorname{conv} }(A'\\setminus \\{v'_3\\})$, with the point $p'$  lying either in the segment $v'_2v'_4$ or in the interior of one of the two subpolygons. Since ${\\operatorname{conv} }(A'\\setminus \\{v'_1\\})$ and ${\\operatorname{conv} }(A'\\setminus \\{v'_3\\})$ have width one, the latter is impossible, so $p'$ lies in $v'_2v'_4$. This forces the widths of ${\\operatorname{conv} }(A'\\setminus \\{v'_1\\})$ and ${\\operatorname{conv} }(A'\\setminus \\{v'_3\\})$ to be one with respect to a functional constant on the segment, which implies that $v'_1$ and $v'_3$ are the only lattice points of ${\\operatorname{conv} }(A')$ outside the segment $v'_2v'_4$, and they are at lattice distance one from the segment.\nIn particular, $v'_1,v'_2,v_3'$, and $v_4'$ are the only boundary lattice points in ${\\operatorname{conv} }(A')$, $v'_4$ is either a vertex or it lies in the segment $v'_1v'_3$. \n\nLet us see that $A'$ must have some interior lattice point (a priori, $p'$ may not be in $A'$).\nSince the preimages of vertices of $A'$ in $A$ consist of a single point and $A'$ has at least size seven, if $v'_4$ is a vertex then $A'$ must have some other lattice point, hence an interior point. In the case of $v_4'$ not being a vertex, if there are no other points in $A'$ then the fiber of $v'_4$ must have at least four lattice points. Applying Lemma~\\ref{lemma:triangles} to the triangle formed by the fiber of $v'_4$ (a segment) and $v'_2$ (a point)  we conclude that $A$ has some lattice point projecting to the  interior of the segment $v_4'v'_2$.\n\nOn the other hand, $A'$ cannot have \\emph{two} interior lattice points: if it does, they are both in the segment $v'_2v'_4$, and call $q'$ the closest to $v'_4$. Then $q$ is in the interior of  $ {\\operatorname{conv} }(A'\\setminus \\{v'_2\\})$, which is a contradiction since $v_2'$ is an essential vertex of $A'$. \n\nThat is, we can assume that $p'$ is the only point of $A'$ in the interior of ${\\operatorname{conv} }(A')$, and to conclude that $A'$ is in the conditions of part~\\eqref{item:spiked} we only need to check that $p'v'_2$ and $p'v'_4$ are primitive.\nIf the fiber of $p'$ in $A$ has at least two points, then Lemma~\\ref{lemma:triangles} applied to the triangle formed by these two points plus $v'_2$ (resp.~$v'_4$) implies that $p'v_2'$ (resp.~ $v_4'p'$) is primitive: otherwise, $A$ must have lattice points projecting to the interior of them.\nIf the fiber of $p'$ in $A$ has a single point then the fiber of $v'_4$ must have at least three and the same argument shows that $v'_4p'$ is primitive, but we need an extra argument for $p'v'_2$.\n\nSo, suppose that $p'$ has a single point $p$ in its fiber, which implies $v'_4$ has at least three. \nCall $v^+_4$, $v^0_4$ and $v^-_4$ three consecutive points in the fiber of $v'_4$, and call $p^+= p + v^+_4-v^0_4$ and $p^-= p + v^-_4-v^0_4$. That is, $p^+$, $p$ and $p^-$ are consecutive points projecting to $p'$, in the same order as $v^+_4$, $v^0_4$ and $v^-_4$. Let $v_2$ be the point in the fiber of $v'_2$. See Figure~\\ref{fig:diff_triangle}.\nSince the triangle $v^+_4v^-_4v_2$ leaves $p^+$ and $p^-$ outside, $v_2$ must lie in the ray from $v^0_4$ through $p$. Then the lattice points \nin the segment $pv_2$ are all in $A$, but no such point can arise other than $p$ and $v_2$ because it would project to a point of $A'$ in the interior of the segment $p'v'_2$, which does not exist. Hence, $pv_2$ is primitive, and so is $p'v'_2$.\n\\begin{figure}\n\\centerline{\n\\includegraphics[scale=.8]{diff_triangle.pdf}}\n\\caption{The situation in the final part of the proof of Theorem~\\ref{thm:projection_shape}}\n\\label{fig:diff_triangle}\n\\end{figure}\n\\end{itemize}\n\\end{proof}\n\n\n\n\n\\begin{corollary}\n\\label{coro:spiked-projections}\nA spiked $3$-polytope is spiked with respect to one of the ten quasi-minimal configurations of Figure~\\ref{fig:2dim_projections}.\n\\begin{figure}[h]\n\\centerline{\\includegraphics[scale=0.8]{proof1.pdf}}\n\\centerline{\\includegraphics[scale=0.8]{proof2.pdf}}\n\\centerline{\\includegraphics[scale=0.8]{proof3.pdf}}\n\\caption{The ten quasi-minimal configurations that can arise as the projection of a spiked $3$-polytope. Labels $v'_i$ of certain lattice points are there for reference in the proof of Theorem~\\ref{theorem:spiked-quasiminimals}.}\n\\label{fig:2dim_projections}\n\\end{figure}\n\\end{corollary}\n\n\\begin{proof}\nLet $P$ be our spiked $3$-polytope and let $A'=\\pi(P\\cap {\\mathbb{Z}}^3)\\subset{\\mathbb{Z}}^2$ be the quasi-minimal configuration for which $P$ is spiked. \nWithout loss of generality assume that $\\pi$ is the projection that forgets the third coordinate.\n\nLet us look at the three cases allowed by Theorem~\\ref{thm:projection_shape} for $P':={\\operatorname{conv} }(A')$:\n\n\\begin{enumerate}\n\\item[\\eqref{item:dilated_unimodular}] If $P'$ is the dilated unimodular triangle, all three vertices of $P'$ are in $A'$ but the mid-points of edges may or may not be in $A'$. The statement simply says that at least one of them is in $A'$. (This is the only case missing from the top row of Figure~\\ref{fig:2dim_projections}). To show this, let $v_1$, $v_2$ and $v_3$ be the three essential vertices of $P$ projecting to the three essential vertices $v'_1$, $v'_2$ and $v'_3$ of $P'$. At least two of the $v_i$'s, say $v_1$ and $v_2$, have third coordinate of the same parity. That implies that their midpoint is a lattice point, so the midpoint of $v'_1$ and $v'_2$ is in $A'$.\n\n\\item[\\eqref{item:reflexive}] Suppose $P'$ is a reflexive triangle and the unique points of $A'$ are the three vertices and the unique interior point of $P'$. There are five reflexive triangles; the four in the middle row of Figure~\\ref{fig:2dim_projections} plus the following one:\n\n\\centerline{\n\\includegraphics[scale=0.7]{reflexive_exception.pdf}}\n\\label{fig:reflexive_exception}\nBut, as in case (1), if $P'$ is this triangle then two of the essential vertices of $P$ are at heights of the same parity and their mid-point projects to a lattice point in $A'$.\n\n\\item[\\eqref{item:spiked}] In case \\eqref{item:spiked} of the theorem, without loss of generality take $p'=(0,0)$, $v'_2=(0,-1)$ and $v'_4=(0,1)$. Then, $v'_1=(-1,0)$ and $v'_3=(1,a)$. For all the $v'_i$'s to be in the boundary and $v'_2$ be a vertex we need $a\\in(-2,2]$. Since $a=1$ and $a=-1$ are equivalent, we are left with the three possibilities in the last row of Figure~\\ref{fig:2dim_projections}.\n\\end{enumerate}\n\\end{proof}\n\n\n\\begin{theorem}\n\\label{theorem:spiked-minimals}\nLet $P$ be a spiked minimal lattice $3$-polytope of size at least seven. Then $P$ is equivalent to\n", "index": 19, "text": "\n\\[\n{\\operatorname{conv} }\\{(1,0,0),(0,1,0),(-1,0,-a),(0,-1,2k+b)\\}\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex10.m1\" class=\"ltx_Math\" alttext=\"{\\operatorname{conv}}\\{(1,0,0),(0,1,0),(-1,0,-a),(0,-1,2k+b)\\}\" display=\"block\"><mrow><mo>conv</mo><mo>\u2061</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mn>0</mn><mo>,</mo><mrow><mo>-</mo><mi>a</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>k</mi></mrow><mo>+</mo><mi>b</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">}</mo></mrow></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\nand\n", "itemtype": "equation", "pos": 56304, "prevtext": "\nfor some $(a,b) \\in \\{(0,0),(0,1),(1,1)\\}$ and an integer $k\\ge 2$. It has size $k+5$.\n\\end{theorem}\n\n\n\\begin{proof}\nBy Corollary~\\ref{coro:spiked-projections}, $P$ is spiked with respect to one of the configurations $A'_i$ in Figure~\\ref{fig:2dim_projections}. Since $P$ has at least four essential vertices,  so does $A'_i$, which leaves only the possibility $A'_8$.\nWe use the coordinates and labels from Figure~\\ref{fig:2dim_projections}, and assume that the projection is the one that forgets the $z$ coordinate. \n\nBy definition of spiked the lattice points in $P$ are its four essential vertices $v_i$ that project to each $v_i'$, plus the lattice points projecting to $(0,0)$, none of which are vertices. We assume that there are $k+1$ such points and they form the segment $S_k=\\{(0,0,0),(0,0,1),\\dots, (0,0,k)\\}$ for some $k$ (with $k\\ge 2$ or otherwise $P$ has size less than seven). Since the triangle $v'_0v'_1v'_2$ is unimodular, we can arbitrarily change the heights of $v_1$ and $v_2$ keeping the choices so far, so we assume $v_1=(1,0,0)$ and $v_2=(0,1,0)$. \n\nLet $l$ be the vertical line $\\{x=y=0\\}$. \nIn order for the fiber of $v'_0$ in $P\\cap {\\mathbb{Z}}^3$ to equal $S_k$,\none of the segments $v_1v_3$ and $v_2v_4$ must cut  the vertical line $\\{x=y=0\\}$ at height in $(-1,0]$, and the other at height in $[k,k+1)$. Furthermore, by the symmetry of the configuration of points, we can assume that $a\\le b$. That is, without loss of generality, $v_3=(-1,0,-a)$ and $v_4=(0,-1,2k+b)$ with $(a,b) \\in \\{(0,0),(0,1),(1,1)\\}$.\n\\end{proof}\n\n\n\\begin{theorem}\n\\label{theorem:spiked-quasiminimals}\nLet $P$ be a spiked quasi-minimal but not minimal lattice $3$-polytope of size at least seven. Then $P$ is equivalent to one of the following. In all cases $k\\ge 2$ is an  integer and the point in boldface is the non essential vertex of $P$.\n\\begin{enumerate}\n\n\\item ${\\operatorname{conv} }\\{(1,-1,-1),(-1,1,1),(-1,-1,0),{\\bf (0,0,k)}\\}$, of size $k+4$. \n\\smallskip\n\n\n\\item $ {\\operatorname{conv} }\\{(1,-1,0),(-1,1,-1),(-1,-1,0),{\\bf (0,0,k)}\\}$, of size $k+5$. \n\\smallskip\n\n\n\\item $ {\\operatorname{conv} }\\{(1,-1,0),(-1,1,0),(-1,-1,0),{\\bf (0,0,k)}\\}$, of size $k+6$. \n\\smallskip\n\n\n\\item ${\\operatorname{conv} }\\{(2,-1,-1),(-1,2,1),(-1,-1,0),{\\bf (0,0,k)}\\}$, of size $k+4$. \n\\smallskip\n\n\n\\item $ {\\operatorname{conv} }\\{(1,-1,-1),(0,1,a),(-1,-1,0),{\\bf (0,0,k)}\\}, a\\in \\{-1,0\\}$, of size $k+4$.  \n\\smallskip\n\n\n\\item $ {\\operatorname{conv} }\\{(1,0,0),(0,1,a),(-1,-1,0),{\\bf (0,0,k)}\\}, \\ a \\in \\{-2,-1,0\\}$, of size $k+4$.\n\\smallskip\n\n\n\\item $ {\\operatorname{conv} }\\{(2,1,0),(-1,1,a),(-1,-1,0),{\\bf (0,0,k)}\\}, \\ a \\in \\{-5,-1\\}$, of size $k+4$.\n\\smallskip\n\n\n\\item $ {\\operatorname{conv} }\\{(1,0,0),(0,1,0),(-1,0,a),(0,-1,b),{\\bf (0,0,k)}\\}, \\  a \\in \\{-1,0\\}, a \\le b < 2k$, of size $k+5$. \n\\smallskip\n\n\n\\item $ {\\operatorname{conv} }\\{(1,0,0),(0,1,0),(-1,-1,a),{\\bf (1,1,2k-a+b)}\\}, \\ a \\in \\{-2,-1,0\\}, b \\in \\{0,1\\}$, of size $k +5$.\n\\smallskip\n\n\n\n\\item[(10a)] ${\\operatorname{conv} }\\{(1,0,a),(0,2,b),(-1,0,0),{\\bf (0,0,k)}\\}, \\ a, b \\in \\{-1,0\\}$, of size $\\lfloor (3k+b)/2 \\rfloor +5$. \n\\smallskip\n\n\n\\item[(10b)] $ {\\operatorname{conv} }\\{(1,0,0),(0,2,a),(-1,0,0),{\\bf (0,1,k)}\\}, \\ a \\in \\{-1,0\\}$, of size $k+5$. \n\n\\end{enumerate}\n\\end{theorem}\n\n\n\\begin{proof} \nBy Corollary~\\ref{coro:spiked-projections}, $P$ is spiked with respect to one of the ten configurations $A'_i$ in Figure~\\ref{fig:2dim_projections}. \nThis will correspond to the ten cases in the statement, except that case (10) subdivides into two subcases as we show below.\nWithout loss of generality we can assume that the projection is the one that forgets the $z$ coordinate and we take in ${\\mathbb{Z}}^2$ the system of coordinates of Figure~\\ref{fig:2dim_projections}. \n\nLet us first concentrate in cases (1) to (7), in which $A'_i$ is a minimal configuration and ${\\operatorname{conv} }(A_i')$ a triangle (with vertices $v'_1$, $v'_2$ and $v'_3$ as labeled in the figure). \nThis implies that $P$ is a tetrahedron with three essential vertices $v_1$, $v_2$, $v_3$ projecting to the three vertices of ${\\operatorname{conv} }(A'_i)$, plus a non-essential vertex $v_0$ projecting to a non-vertex lattice point $v'_0$ of $A'_i$. In all except $A'_2$ and $A'_3$ there is only one choice for $v'_0$. In cases $A'_2$ and $A'_3$ there are several possibilities for $v'_0$ but they are equivalent to one another. This allows as to assume $v'_0$ is as shown in the figure in all cases. Hence, to finish the proof for these seven cases  we only need to derive the possible third coordinates (the heights) for the four vertices $v_i$, in each case. We denote these heights $h_0$, $h_1$, $h_2$ and $h_3$, and let us check that without loss of generality they are as in the statement:\n\n\\begin{itemize}\n\\item Let $k+1$ be the number of lattice points in the fiber of $v'_0$  in $P\\cap {\\mathbb{Z}}^3$. We take without loss of generality $v_0=(0,0,k)$ (that is, $h_0=k$), so that $(0,0,0)$ is the bottom-most point in the fiber. Observe that $v'_0$ is the only point of $A'_i$ whose fiber in $P\\cap {\\mathbb{Z}}^3$ has more than a single point. For all except $A'_2$ and $A'_3$ this is obvious, since $v'_0$ is the only non-vertex. For $A'_2$ and $A'_3$, the fibers of $(0,-1)$  (in both) and $(-1,0)$ (in $A'_3$) must be single points or otherwise they produce additional vertices in $P$, which do not exist.\n\n\\item Since the segment $v'_0v'_3$ is primitive, there is no loss of generality in taking height zero for $v_3$. That is to say, $h_3=0$ and $v_3=(-1,-1,0)$, in all seven cases.\n\n\\item Let $d_i\\ge 1$ be the lattice distance from $v'_1$ to the line  $\\{x=y\\}$ spanned by $v'_0v'_3$. (That is, $d_i=2,2,2,3,2,1$ and $1$, respectively, in cases (1) to (7)). \nSince the unimodular transformation $(x,y,z)\\to (x,y,z\\pm(x-y))$ fixes the plane containing all the choices so far and changes the height of $v_1$ by $d_i$ units, without loss of generality we choose the height of $v_1$ to be in $\\{0,-1,\\dots, -d_i +1\\}$.\nMoreover, this height must be even in  cases  (2) and (3), in order for the midpoint of $v_1v_3$ be a lattice point, and it must be prime with $d_i$ in all other cases, in order for the segment $v_1v_3$ to be primitive. Summing up, the height $h_1$ of $v_1$ equals: $0$ in (2), (3), (6), and (7); $-1$ in (1) and (5);  and $-1$ or $-2$ in (4). \n\n\n\\item In order to study $h_2$, let $h$ be the height at which the triangle $v_1v_2v_3$ intersects the vertical line projecting to $v'_0$. Since our choice is that $(0,0,0)$ is the bottom-most lattice point in the fiber of $v'_0$, we must have $h\\in (-1,0]$. This in turn implies a bounded interval for the height $h_2$ in each case, namely:\n\n\\begin{itemize}\n\\item[(1)] $h_2 \\in(-1,1]$.\n\\hfil \n\\ \\ \\ \\quad(5) $h_2 \\in (-3/2,1/2]$.\n\n\\item[(2)] $h_2 \\in(-2,0]$.\n\\hfil \n(6) $h_2 \\in (-3,0]$.\n\n\\item[(3)] $h_2 \\in (-2,0]$.\n\\hfil \n(7) $h_2 \\in (-6,0]$.\n\n\\item[(4)] $h_2 \\in (-2, 1]$ if $h_1=-1$ and $h_2 \\in (-1, 2]$ if $h_1=-2$.\n\\end{itemize}\n\n\\item This already gives a finite list of possibilities for all heights, but there are the following additional considerations:\n\n\\begin{itemize}\n\\item In (3), $h_2$ must be even in order for the midpoint of $v_2v_3$ to be integer.\n\\item In (1), (2) and (7), $h_2$ must be odd for the segment $v_2v_3$ to be primitive.\n\\item In (4), $h_2 \\ne 0 \\pmod 3$ for the segment $v_2v_3$ to be primitive.\n\\item In (4) and (7),  $h_2 \\ne h_1 \\pmod 3$  for the segment $v_1v_2$ to be primitive.\n\\end{itemize}\nTogether with the intervals stated above, this fixes $h_2$ to be $1$, $-1$, and $0$, in cases (1), (2) and (3), respectively. In case (4) we have two possibilities for $(h_1,h_2)$, namely $(-1,1)$ and $(-2,2)$, but they produce equivalent configurations via the transformation $(x,y,z)\\mapsto(y,x,x-y+z)$), so we take the first one.\nIn cases (5), (6) and (7) we have $h_2\\in \\{-1,0\\}$, $h_2\\in \\{-2,-1,0\\}$, and $h_2\\in \\{-5,-1\\}$, respectively. This finishes the proofs of these seven cases.\n\n\\end{itemize}\n\n\nWe now look at the  three remaining cases, $A'_8$, $A'_9$, and $A'_{10}$.  As before, we will denote by $h_i$ the height of the vertex $v_i$ of $P$ projecting to a point $v_i'\\in A_i'$. The ideas are essentially the same, with slight modifications:\n\\begin{itemize}\n\n\\item[(8)] $A'_{8}$ is minimal, hence in this case $P$ has four essential vertices $v_1,v_2,v_3,v_4$ projecting to the four vertices of $A'_8$ plus a fifth non-essential vertex $v_0$  projecting to $v'_0=(0,0)$. \nAgain, we choose $v_0=(0,0,k)$ where $k+1$ is the number of lattice points above $v'_0$, and as in Theorem~\\ref{theorem:spiked-minimals}, we can take without loss of generality, the heights of $v_1$ and $v_2$ to be zero. By symmetry, we can also assume $h_3\\le h_4$ which implies, in order for the bottom-most point in the fiber of $v'_0$ to be $(0,0,0)$, that $h_3\\in \\{-1,0\\}$. \nFinally, in order for $v_0$ to be above the segment $v_2v_4$ we need $h_4 < 2k$.\n\n\\item[(9)] $A'_{9}$ is not minimal, so the vertices of $P$ biject to those of $A'_{9}$ and all other lattice points in $P$ project to the unique non-vertex point $p_0'=(0,0)$. We let the fiber of $p'_0$ consist of $(0,0,0),\\dots, (0,0,k)$, as in previous cases. Since the triangle $p'_0v'_1v'_2$ is unimodular we can choose the heights of $v_1$ and $v_2$ to be zero. Also, we make the choice that the triangle $v_1v_2v_3$ lies below (perhaps not strictly) $(0,0,0)$ and the segment $v_0v_3$ lies above. The opposite choice would lead to equivalent configurations.\n\nThen, for the triangle $v_1v_2v_3$ to cut the line $\\{x=y=0\\}$ at height in $(-1,0]$ we need $h_3\\in (-3,0]$. And for the segment  $v_0v_3$ to cut that line at height in $[k,k+1)$ we need $(h_0+h_3)/2 \\in [k, k+1)$. Hence $h_0\\in\\{2k-h_3,2k-h_3+1\\}$ and $k=\\lfloor(h_0+h_3)/2\\rfloor$.\n\n\n\\item[(10)] $A'_{10}$ is minimal, which implies $P$ to have three essential vertices $v_1,v_2,v_3$ projecting to the three vertices of $A'_{10}$, plus a fourth non-essential vertex  projecting to one of the other two lattice points,  $v'_0=(0,0)$ and $w'_0=(0,1)$. We consider the two cases separately:\n\\begin{itemize}\n\\item[(10a)] If the non-essential vertex projects to $v'_0$, call it $v_0$. By the same arguments as before, we can assume that $v_0=(0,0,k)$, $(0,0,0)$ is the bottom-most point in the fiber of $v_0'$, $h_3=0$ and $h_1 \\in \\{-1,0\\}$. Once these are fixed, unimodular transformations can change the height of $v_2$ by arbitrary even numbers, so we can take the height of $v_2$ in $\\{0,-1\\}$ as well. \nObserve that the fiber of point $w_0'$ in $P$ is the segment going from $(0,1,h')$, with $h'=(h_1+2 h_2)/4\\in (-1,0]$, to $(0,1,(h_2 + k)/2)$. It then contains the $\\lfloor (h_2+k)/2 \\rfloor+1$ lattice points from $(0,1,0)$  to $(0,1,\n\\lfloor (h_2+k)/2 \\rfloor)$.\n\n\\item[(10b)] If the non-essential vertex projects to $w'_0$, call it $w_0$. By the same arguments as before, we can assume that $w_0=(0,1,k)$, $(0,1,0)$ is the bottom-most point in the fiber of $w_0'$, $h_3=0$ and $h_1 \\in \\{-1,0\\}$. In this case, the fiber of $v_0'$ consists of a single point, the middle point of segment $v_1v_3$. In order for this point to be a lattice point, $h_1$ has to be even, hence $h_1=0$. Then, in order for the triangle $v_1v_2v_3$ to cut the fiber of $w_0'$ at a height in $(-1,0]$, we need $h_2\\in\\{-1,0\\}$.\n\n\\end{itemize}\n\n\\end{itemize}\n\nIn all cases $k$ can be assumed at least two: In case  $A'_3$ because otherwise $P$ has width one with respect to the vertical direction. In all other cases because otherwise $P$ has size at most $6$. \n\\end{proof}\n\n\n\\begin{remark}\n\\label{remark:spiked}\n\\rm\nFor $k\\ge 3$  all the polytopes described in Theorem~\\ref{theorem:spiked-quasiminimals} are spiked, quasi-minimal, not minimal, non-isomorphic to one another, and have size $\\ge 7$. But for $k=2$ the following happens: \n\\begin{itemize}\n\\item Cases (1), (4), (5), (6), and (7) produce size six.\n\\item In some cases (sometimes depending also on the values of $a$ and $b$) the vertex that should be non-essential (the vertex $v_0$ or $w_0$ in the proof, projecting to $v'_0$ or $w'_0$ in Figure~\\ref{fig:2dim_projections}) turns out to be essential. In this case the polytope obtained is minimal, and it is not spiked: the projection does not biject essential vertices to essential vertices.\n\\end{itemize}\n\nThis means that for each size $n\\ge 9$ there are \\emph{exactly} the following non-equivalent spiked $3$-polytopes: $3$ spiked minimal tetrahedra; $23$ if $n=0 \\pmod 3$ and $21$ if $n \\ne 0 \\pmod 3$ spiked quasi-minimal, not minimal tetrahedra; and $4n-19$ spiked quasi-minimal, not minimal $3$-polytopes with $5$ vertices. For $n=8$ and $7$ the global counts are decreased by two. See exact numbers in Table~\\ref{table-minimal}.\n\\end{remark}\n\n\\begin{remark}\n\\rm\nObserve as well that no $3$-polytope of size at least seven can be both spiked and boxed. \nIndeed, with $k\\ge 2$ in Theorems~\\ref{theorem:spiked-minimals} and~\\ref{theorem:spiked-quasiminimals} the only way to get a boxed and spiked polytope is if there exists an essential vertex $v$ such that $P^v$ has width one with respect to a functional that is not constant on the fibers of the projection. This implies that each fiber can contain at most two lattice points of $P^v$. Since $v$ is an essential vertex, it does not belong to the fiber of $S_k$, and the previous implies that $k=1$.\n\n\\end{remark}\n\n\n\n\n\n\n\n\\section{The classification of boxed $3$-polytopes}\n\\label{sec:boxed}\n\n\nIn this section, let $P$ be a  boxed $d$-polytope of size at least seven.\n\nWith the notation of Definition~\\ref{def:boxed}, for each $i \\in \\{1, \\dots, d\\}$, $v_{i} \\in{\\operatorname{vert}}^*(P)$, $f_{i}(v_i)\\not\\in \\{0,1\\}$ and $v_i \\in \\underset{j\\neq i}{\\bigcap} f_j^{-1} (\\{0,1\\})$. Let\n", "index": 21, "text": "\n\\[\nC_{i}^+=(\\underset{j\\neq i}{\\bigcap} f_j^{-1} ([0,1])) \\cap f_{i}^{-1} ((1,\\infty))\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex11.m1\" class=\"ltx_Math\" alttext=\"C_{i}^{+}=(\\underset{j\\neq i}{\\bigcap}f_{j}^{-1}([0,1]))\\cap f_{i}^{-1}((1,%&#10;\\infty))\" display=\"block\"><mrow><msubsup><mi>C</mi><mi>i</mi><mo>+</mo></msubsup><mo>=</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><munder accentunder=\"true\"><mo largeop=\"true\" mathsize=\"160%\" movablelimits=\"false\" stretchy=\"false\" symmetric=\"true\">\u22c2</mo><mrow><mi>j</mi><mo>\u2260</mo><mi>i</mi></mrow></munder><mo>\u2062</mo><msubsup><mi>f</mi><mi>j</mi><mrow><mo>-</mo><mn>1</mn></mrow></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2229</mo><mrow><msubsup><mi>f</mi><mi>i</mi><mrow><mo>-</mo><mn>1</mn></mrow></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo>,</mo><mi mathvariant=\"normal\">\u221e</mi><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\nwe refer to them as \\emph{half-chimneys}, whose  union is the \\emph{chimney} $C_{i}=C_{i}^+ \\cup C_{i}^-$. Observe that  $v_{i} \\in {\\mathbb{Z}}^d \\cap C_{i}$ and that a choice of half-chimney ($C_i^+$ or $C_i^-$) for each $i\\in\\{1,\\dots,d\\}$ corresponds to a choice of a vertex of $Q$.\n\nNow, for each $\\lambda \\in \\{0,1\\}^{d}$ we denote $r_{i}^{\\lambda}=\\cap_{j\\neq i} f_j^{-1}(\\lambda_j)$  one of the $2^{d-1}$ (potentially) lattice lines in $C_{i}$ and $s_{i}^{\\lambda}=r_{i}^{\\lambda}\\cap Q$ the corresponding edge of $Q$. (Observe that the $i$-th coordinate of $\\lambda$ is irrelevant).\n\nWith this notation:\n\n\\begin{lemma}\n\\label{lemma:firstpoint}\nSuppose that  $s_i^{\\lambda} \\cap P \\neq \\emptyset$ and $v_i \\in r_i^{\\lambda}$. Then $r_i^{\\lambda}$ does not contain any lattice point between $v_i$ and $s_i^{\\lambda}$. In particular, in the case $Q=[0,1]^d$, the $i$-th coordinate of $v_i$ is $-1$ or $2$. \n\\end{lemma}\n\\begin{proof}\nLet $p_0 \\in s_i^{\\lambda} \\cap P \\neq \\emptyset$. Since $v_i\\in P$,\nif there is a lattice point $p \\in r_i^{\\lambda}$ between $v_i$ and $s_i^{\\lambda}$, then $p\\in {\\operatorname{conv} }\\{p_0,v_i\\} \\subset P$, but in this case $P$ is not boxed with respect to the unit cube (it has two lattice points, $v_i$ and $p$, outside $f_i^{-1}(\\{0,1\\})$). \n\\end{proof}\n\n\\bigskip\n\n\\subsection{Boxed $d$-polytopes with respect to the unit cube}\n\nIf $P$ is boxed with respect to the unit cube $Q=[0,1]^d$ then each $v_i$ has all coordinates in $\\{0,1\\}$ except for the $i$-th coordinate, which is in ${\\mathbb{Z}}\\setminus \\{0,1\\}$. If, moreover, $P\\cap{\\mathbb{Z}}^3$ meets every edge of $Q$ then, by Lemma~\\ref{lemma:firstpoint}, the $i$-th coordinate equals $-1$ or $2$. In particular, it is easy to enumerate all boxed lattice polytopes with respect to the unit cube and containing a lattice point of every edge of it.\n\nThis enumeration is further simplified by the following lemma:\n\n\n\n\n\n\\begin{lemma}\n\\label{lemma:boxed-containment}\nLet $P$ be boxed with respect to the unit cube $Q=[0,1]^d$ and such that all edges of $Q$ contain at least a lattice point of $P$. Suppose that the size $|P|$ of $P$ is not $2^d+d$. \nThen there exists a polytope $P'$ of size $|P| +1$ boxed with respect to $Q$ such that $P \\subset P'$.\n\\end{lemma}\n\n\n\\begin{proof}\nLet $P$ be boxed with respect to the unit cube $Q=[0,1]^d$ and such that all edges of $Q$ contain at least a lattice point of $P$.\nBy Lemma~\\ref{lemma:firstpoint} $P$ is contained in the following polytope (the Minkowski sum of the $[0,1]$ $d$-dimensional cube and the unit cross-polytope):\n", "itemtype": "equation", "pos": 56398, "prevtext": "\nand\n", "index": 23, "text": "\n\\[\nC_{i}^-=(\\underset{j\\neq i}{\\bigcap} f_j^{-1} ([0,1])) \\cap f_{i}^{-1} ((-\\infty, 0)),\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex12.m1\" class=\"ltx_Math\" alttext=\"C_{i}^{-}=(\\underset{j\\neq i}{\\bigcap}f_{j}^{-1}([0,1]))\\cap f_{i}^{-1}((-%&#10;\\infty,0)),\" display=\"block\"><mrow><mrow><msubsup><mi>C</mi><mi>i</mi><mo>-</mo></msubsup><mo>=</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><munder accentunder=\"true\"><mo largeop=\"true\" mathsize=\"160%\" movablelimits=\"false\" stretchy=\"false\" symmetric=\"true\">\u22c2</mo><mrow><mi>j</mi><mo>\u2260</mo><mi>i</mi></mrow></munder><mo>\u2062</mo><msubsup><mi>f</mi><mi>j</mi><mrow><mo>-</mo><mn>1</mn></mrow></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2229</mo><mrow><msubsup><mi>f</mi><mi>i</mi><mrow><mo>-</mo><mn>1</mn></mrow></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mi mathvariant=\"normal\">\u221e</mi></mrow><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\nObserve that the only lattice points in $D$ are its $d2^d$ defining vertices plus the $2^d$ points with coordinates in $\\{0,1\\}$.\n\nSince $P$ has size smaller than $2^d+d$ (and since it has $d$ vertices outside the unit cube) there is a vertex $u_1$ of the unit cube not contained in $P$. Consider the polytope $P_1={\\operatorname{conv} }(P\\cup u_1)$, which is still boxed with respect to the unit cube and intersects all its edges. If $P_1$ has size $|P|+1$ we have finished. If not, let $u_2$ be a lattice point different from $u_1$ in $P_1\\setminus P$. Then $P_2={\\operatorname{conv} }(P\\cup v_2) \\subsetneq P_1$ is also boxed with respect to the unit cube ($u_2$ must also be in the unit cube, since it is in $D$ but is not a vertex of $D$) and intersects all its edges.\n\nIterating this process we must arrive at a polytope $P_k={\\operatorname{conv} }(P\\cup u_k)$ that is boxed with respect to the unit cube and intersects all its edges and such that the only lattice point in $P_k\\setminus P$ is $u_k$.\n\\end{proof}\n\n\nWe thus now want to deal with polytopes that are boxed with respect to the unit cube but with $P\\cap {\\mathbb{Z}}^d \\cap s_i^\\lambda=\\emptyset$ for some edge $s_i^\\lambda$ of the cube.\nFor this, we restrict our attention to the case of $3$-dimensional polytopes, and also to those of size at least $7$. With this assumption, we have that $P\\cap Q \\cap {\\mathbb{Z}}^3$ has at least four points, which implies that one of the following two things happens:\n\n\\begin{enumerate}\n\\item Either $P\\cap Q\\cap {\\mathbb{Z}}^3$ consists of the four lattice points in one of the two facets of $Q$ parallel to $s^\\lambda_i$, or \n\n\\item $P \\cap Q\\cap {\\mathbb{Z}}^3$ intersects the two edges parallel and not opposite to $s^\\lambda_i$.\n\\end{enumerate}\n\nWe analyze these cases separately:\n\n\\begin{lemma}\n\\label{lemma:bound-dim3-coplanar}\nLet $P$ be a lattice $3$-polytope, boxed with respect to the unit cube, such that $P \\cap \\{0,1\\}^3$ consists of \nthe four lattice points in one of the facets of the unit cube. Then the $i$-th coordinate of $v_i$ lies in $\\{-6,-5,-4,-3,-2,-1,2,3,4,5,6,7\\}$.\n\n\\end{lemma}\n\n\\begin{proof}\nAs usual, let $(P\\setminus [0,1]^3 ) \\cap {\\mathbb{Z}}^3=\\{v_1,v_2,v_3\\}$\n\nWithout loss of generality we can assume that \n", "itemtype": "equation", "pos": 59062, "prevtext": "\nwe refer to them as \\emph{half-chimneys}, whose  union is the \\emph{chimney} $C_{i}=C_{i}^+ \\cup C_{i}^-$. Observe that  $v_{i} \\in {\\mathbb{Z}}^d \\cap C_{i}$ and that a choice of half-chimney ($C_i^+$ or $C_i^-$) for each $i\\in\\{1,\\dots,d\\}$ corresponds to a choice of a vertex of $Q$.\n\nNow, for each $\\lambda \\in \\{0,1\\}^{d}$ we denote $r_{i}^{\\lambda}=\\cap_{j\\neq i} f_j^{-1}(\\lambda_j)$  one of the $2^{d-1}$ (potentially) lattice lines in $C_{i}$ and $s_{i}^{\\lambda}=r_{i}^{\\lambda}\\cap Q$ the corresponding edge of $Q$. (Observe that the $i$-th coordinate of $\\lambda$ is irrelevant).\n\nWith this notation:\n\n\\begin{lemma}\n\\label{lemma:firstpoint}\nSuppose that  $s_i^{\\lambda} \\cap P \\neq \\emptyset$ and $v_i \\in r_i^{\\lambda}$. Then $r_i^{\\lambda}$ does not contain any lattice point between $v_i$ and $s_i^{\\lambda}$. In particular, in the case $Q=[0,1]^d$, the $i$-th coordinate of $v_i$ is $-1$ or $2$. \n\\end{lemma}\n\\begin{proof}\nLet $p_0 \\in s_i^{\\lambda} \\cap P \\neq \\emptyset$. Since $v_i\\in P$,\nif there is a lattice point $p \\in r_i^{\\lambda}$ between $v_i$ and $s_i^{\\lambda}$, then $p\\in {\\operatorname{conv} }\\{p_0,v_i\\} \\subset P$, but in this case $P$ is not boxed with respect to the unit cube (it has two lattice points, $v_i$ and $p$, outside $f_i^{-1}(\\{0,1\\})$). \n\\end{proof}\n\n\\bigskip\n\n\\subsection{Boxed $d$-polytopes with respect to the unit cube}\n\nIf $P$ is boxed with respect to the unit cube $Q=[0,1]^d$ then each $v_i$ has all coordinates in $\\{0,1\\}$ except for the $i$-th coordinate, which is in ${\\mathbb{Z}}\\setminus \\{0,1\\}$. If, moreover, $P\\cap{\\mathbb{Z}}^3$ meets every edge of $Q$ then, by Lemma~\\ref{lemma:firstpoint}, the $i$-th coordinate equals $-1$ or $2$. In particular, it is easy to enumerate all boxed lattice polytopes with respect to the unit cube and containing a lattice point of every edge of it.\n\nThis enumeration is further simplified by the following lemma:\n\n\n\n\n\n\\begin{lemma}\n\\label{lemma:boxed-containment}\nLet $P$ be boxed with respect to the unit cube $Q=[0,1]^d$ and such that all edges of $Q$ contain at least a lattice point of $P$. Suppose that the size $|P|$ of $P$ is not $2^d+d$. \nThen there exists a polytope $P'$ of size $|P| +1$ boxed with respect to $Q$ such that $P \\subset P'$.\n\\end{lemma}\n\n\n\\begin{proof}\nLet $P$ be boxed with respect to the unit cube $Q=[0,1]^d$ and such that all edges of $Q$ contain at least a lattice point of $P$.\nBy Lemma~\\ref{lemma:firstpoint} $P$ is contained in the following polytope (the Minkowski sum of the $[0,1]$ $d$-dimensional cube and the unit cross-polytope):\n", "index": 25, "text": "\n\\[\nD:={\\operatorname{conv} }\\{(x_1,\\dots,x_d): \\text{$\\exists i$ with $x_i\\in\\{-1,2\\}$ and $x_j\\in \\{0,1\\}$ for all $j\\ne i$} \\}.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex13.m1\" class=\"ltx_Math\" alttext=\"D:={\\operatorname{conv}}\\{(x_{1},\\dots,x_{d}):\\text{$\\exists i$ with $x_{i}\\in%&#10;\\{-1,2\\}$ and $x_{j}\\in\\{0,1\\}$ for all $j\\neq i$}\\}.\" display=\"block\"><mrow><mrow><mi>D</mi><mo>:=</mo><mrow><mo>conv</mo><mo>\u2061</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><msub><mi>x</mi><mi>d</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>:</mo><mrow><mrow><mo>\u2203</mo><mi>i</mi></mrow><mtext>\u00a0with\u00a0</mtext><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>\u2208</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mn>2</mn><mo stretchy=\"false\">}</mo></mrow></mrow><mtext>\u00a0and\u00a0</mtext><mrow><msub><mi>x</mi><mi>j</mi></msub><mo>\u2208</mo><mrow><mo stretchy=\"false\">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">}</mo></mrow></mrow><mtext>\u00a0for all\u00a0</mtext><mrow><mi>j</mi><mo>\u2260</mo><mi>i</mi></mrow></mrow></mrow><mo stretchy=\"false\">}</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\nand, by Lemma~\\ref{lemma:firstpoint} we know that the third coordinate of $v_3$ equals $-1$. Without loss of generality, we assume $v_3=(0,0,-1)$ for the rest of the proof.\n\n\n\nNow, the vertices $v_1$ and $v_2$ have the third coordinate in $\\{0,1\\}$. In order for $P$ not to have width one with respect to the functional $z$, then at least one of $v_1$ and $v_2$ must lie in the plane $\\{z=1\\}$. Two things can happen: either the two vertices are in the plane $\\{z=1\\}$, or there is one in each plane. \n\nLet us see, in both cases, what conditions on $v_1$ and $v_2$ are necessary for no extra lattice points to arise in the plane $\\{z=0\\}$. This technique is very close to what we called the \\emph{parallel planes method} in~\\cite{6points}.\\smallskip\n\n\\begin{enumerate}\n\n\\item[(a)] One point in each plane:\n", "itemtype": "equation", "pos": 61445, "prevtext": "\nObserve that the only lattice points in $D$ are its $d2^d$ defining vertices plus the $2^d$ points with coordinates in $\\{0,1\\}$.\n\nSince $P$ has size smaller than $2^d+d$ (and since it has $d$ vertices outside the unit cube) there is a vertex $u_1$ of the unit cube not contained in $P$. Consider the polytope $P_1={\\operatorname{conv} }(P\\cup u_1)$, which is still boxed with respect to the unit cube and intersects all its edges. If $P_1$ has size $|P|+1$ we have finished. If not, let $u_2$ be a lattice point different from $u_1$ in $P_1\\setminus P$. Then $P_2={\\operatorname{conv} }(P\\cup v_2) \\subsetneq P_1$ is also boxed with respect to the unit cube ($u_2$ must also be in the unit cube, since it is in $D$ but is not a vertex of $D$) and intersects all its edges.\n\nIterating this process we must arrive at a polytope $P_k={\\operatorname{conv} }(P\\cup u_k)$ that is boxed with respect to the unit cube and intersects all its edges and such that the only lattice point in $P_k\\setminus P$ is $u_k$.\n\\end{proof}\n\n\nWe thus now want to deal with polytopes that are boxed with respect to the unit cube but with $P\\cap {\\mathbb{Z}}^d \\cap s_i^\\lambda=\\emptyset$ for some edge $s_i^\\lambda$ of the cube.\nFor this, we restrict our attention to the case of $3$-dimensional polytopes, and also to those of size at least $7$. With this assumption, we have that $P\\cap Q \\cap {\\mathbb{Z}}^3$ has at least four points, which implies that one of the following two things happens:\n\n\\begin{enumerate}\n\\item Either $P\\cap Q\\cap {\\mathbb{Z}}^3$ consists of the four lattice points in one of the two facets of $Q$ parallel to $s^\\lambda_i$, or \n\n\\item $P \\cap Q\\cap {\\mathbb{Z}}^3$ intersects the two edges parallel and not opposite to $s^\\lambda_i$.\n\\end{enumerate}\n\nWe analyze these cases separately:\n\n\\begin{lemma}\n\\label{lemma:bound-dim3-coplanar}\nLet $P$ be a lattice $3$-polytope, boxed with respect to the unit cube, such that $P \\cap \\{0,1\\}^3$ consists of \nthe four lattice points in one of the facets of the unit cube. Then the $i$-th coordinate of $v_i$ lies in $\\{-6,-5,-4,-3,-2,-1,2,3,4,5,6,7\\}$.\n\n\\end{lemma}\n\n\\begin{proof}\nAs usual, let $(P\\setminus [0,1]^3 ) \\cap {\\mathbb{Z}}^3=\\{v_1,v_2,v_3\\}$\n\nWithout loss of generality we can assume that \n", "index": 27, "text": "\n\\[\nP_0:=P \\cap \\{0,1\\}^3=\\{(0,0,0), (1,0,0), (0,1,0), (1,1,0)\\}\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex14.m1\" class=\"ltx_Math\" alttext=\"P_{0}:=P\\cap\\{0,1\\}^{3}=\\{(0,0,0),(1,0,0),(0,1,0),(1,1,0)\\}\" display=\"block\"><mrow><msub><mi>P</mi><mn>0</mn></msub><mo>:=</mo><mrow><mi>P</mi><mo>\u2229</mo><msup><mrow><mo stretchy=\"false\">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">}</mo></mrow><mn>3</mn></msup></mrow><mo>=</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">}</mo></mrow></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\nwith $a_i \\in {\\mathbb{Z}}\\setminus\\{0,1\\}$ and $\\lambda_i \\in \\{0,1\\}$. \n\nSince $s^\\lambda_2 \\cap P \\cap {\\mathbb{Z}}^3 \\neq \\emptyset$ for  $\\lambda \\in \\{(0,*,0),(1,*,0)\\}$, by Lemma~\\ref{lemma:firstpoint} we know that the second coordinate of $v_2$ is in $\\{-1,2\\}$. And the four possibilities $\\{(0,-1,0),(0,2,0),(1,-1,0),(1,2,0)\\}$ for the vertex $v_2$ are valid, since the convex hull of $P_0 \\cup \\{v_2,v_3\\}$ has exactly $6$ lattice points.\n\nOn the other hand, let us see which values of the coordinates of $v_1$ are allowed so that no extra lattice point is added when considering the whole polytope. $P$ is now contained in the three planes $z\\in\\{-1,0,1\\}$. There is one point at each $\\{z=\\pm 1\\}$, and the intersection of $P$ with $\\{z=0\\}$ consists of the convex hull of $P_0 \\cup \\{v_2\\}$, together with the intersection point of the edge $v_1v_3$ with that plane. This intersection point is \n", "itemtype": "equation", "pos": 62318, "prevtext": "\nand, by Lemma~\\ref{lemma:firstpoint} we know that the third coordinate of $v_3$ equals $-1$. Without loss of generality, we assume $v_3=(0,0,-1)$ for the rest of the proof.\n\n\n\nNow, the vertices $v_1$ and $v_2$ have the third coordinate in $\\{0,1\\}$. In order for $P$ not to have width one with respect to the functional $z$, then at least one of $v_1$ and $v_2$ must lie in the plane $\\{z=1\\}$. Two things can happen: either the two vertices are in the plane $\\{z=1\\}$, or there is one in each plane. \n\nLet us see, in both cases, what conditions on $v_1$ and $v_2$ are necessary for no extra lattice points to arise in the plane $\\{z=0\\}$. This technique is very close to what we called the \\emph{parallel planes method} in~\\cite{6points}.\\smallskip\n\n\\begin{enumerate}\n\n\\item[(a)] One point in each plane:\n", "index": 29, "text": "\n\\[v_1=(a_1,\\lambda_1,1), \\qquad v_2=(\\lambda_2,a_2,0),\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex15.m1\" class=\"ltx_Math\" alttext=\"v_{1}=(a_{1},\\lambda_{1},1),\\qquad v_{2}=(\\lambda_{2},a_{2},0),\" display=\"block\"><mrow><mrow><mrow><msub><mi>v</mi><mn>1</mn></msub><mo>=</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\u03bb</mi><mn>1</mn></msub><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mrow><mo rspace=\"22.5pt\">,</mo><mrow><msub><mi>v</mi><mn>2</mn></msub><mo>=</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03bb</mi><mn>2</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\n\nNotice that these conditions for $v_1'$, $v_1$ and $v_2$ are symmetric with respect to the plane $\\{2x-z=1\\}$ (that is, $\\{x=1/2\\}$ for the point $v_1'$ and $v_2$ and $\\{x=1\\}$ for $v_1$). \nIn Figure~\\ref{fig:3dim_coplanar_1} we show the open region where $v_1'$ needs to be so that the convex hull of $P_0 \\cup \\{v_2,v_1'\\}$ has no extra lattice points, when $v_2 \\in \\{(0,-1,0),(0,2,0)\\}$.\nThe corresponding positions that remain for $v_1$ are:\n", "itemtype": "equation", "pos": 63284, "prevtext": "\nwith $a_i \\in {\\mathbb{Z}}\\setminus\\{0,1\\}$ and $\\lambda_i \\in \\{0,1\\}$. \n\nSince $s^\\lambda_2 \\cap P \\cap {\\mathbb{Z}}^3 \\neq \\emptyset$ for  $\\lambda \\in \\{(0,*,0),(1,*,0)\\}$, by Lemma~\\ref{lemma:firstpoint} we know that the second coordinate of $v_2$ is in $\\{-1,2\\}$. And the four possibilities $\\{(0,-1,0),(0,2,0),(1,-1,0),(1,2,0)\\}$ for the vertex $v_2$ are valid, since the convex hull of $P_0 \\cup \\{v_2,v_3\\}$ has exactly $6$ lattice points.\n\nOn the other hand, let us see which values of the coordinates of $v_1$ are allowed so that no extra lattice point is added when considering the whole polytope. $P$ is now contained in the three planes $z\\in\\{-1,0,1\\}$. There is one point at each $\\{z=\\pm 1\\}$, and the intersection of $P$ with $\\{z=0\\}$ consists of the convex hull of $P_0 \\cup \\{v_2\\}$, together with the intersection point of the edge $v_1v_3$ with that plane. This intersection point is \n", "index": 31, "text": "\n\\[\nv_1'=\\left(\\frac{a_1}{2},\\frac{\\lambda_1}{2},0\\right) \\in {\\mathbb{Z}}/2  \\times \\left\\{0,\\frac{1}{2}\\right\\} \\times \\{0\\}. \n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex16.m1\" class=\"ltx_Math\" alttext=\"v_{1}^{\\prime}=\\left(\\frac{a_{1}}{2},\\frac{\\lambda_{1}}{2},0\\right)\\in{\\mathbb%&#10;{Z}}/2\\times\\left\\{0,\\frac{1}{2}\\right\\}\\times\\{0\\}.\" display=\"block\"><mrow><mrow><msubsup><mi>v</mi><mn>1</mn><mo>\u2032</mo></msubsup><mo>=</mo><mrow><mo>(</mo><mfrac><msub><mi>a</mi><mn>1</mn></msub><mn>2</mn></mfrac><mo>,</mo><mfrac><msub><mi>\u03bb</mi><mn>1</mn></msub><mn>2</mn></mfrac><mo>,</mo><mn>0</mn><mo>)</mo></mrow><mo>\u2208</mo><mrow><mrow><mi>\u2124</mi><mo>/</mo><mn>2</mn></mrow><mo>\u00d7</mo><mrow><mo>{</mo><mn>0</mn><mo>,</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>}</mo></mrow><mo>\u00d7</mo><mrow><mo stretchy=\"false\">{</mo><mn>0</mn><mo stretchy=\"false\">}</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\n\n\\begin{figure}[ht]\n\\centerline{\n\\includegraphics[scale=0.8]{3dim_coplanar_11.pdf} \\qquad\n\\includegraphics[scale=0.8]{3dim_coplanar_12.pdf} \n}\nCase $v_2=(0,-1,0)$ \\qquad \\qquad \\qquad \\qquad  \\qquad \\qquad Case $v_2=(0,2,0)$\n\\caption{The possible positions for $v_1'$ (hence for $v_1$) in case (a) in the proof of Lemma~\\ref{lemma:bound-dim3-coplanar}. Crosses mark the positions for $v_1'$ corresponding to $v_1$ lying in its chimney. The white (open) region are the positions where a point $v'$ has the property that $P_0\\cup \\{v_2,v'\\}$ does not add extra lattice points. The intersection of both gives the valid positions for $v'_1$.} \n\\label{fig:3dim_coplanar_1}\n\\end{figure}\n\n\n\nThe cases $v_2 \\in \\{(1,-1,0),(1,2,0)\\}$ give, by the symmetry mentioned above, the following possibilities for $v_1$:\n", "itemtype": "equation", "pos": 63863, "prevtext": "\n\nNotice that these conditions for $v_1'$, $v_1$ and $v_2$ are symmetric with respect to the plane $\\{2x-z=1\\}$ (that is, $\\{x=1/2\\}$ for the point $v_1'$ and $v_2$ and $\\{x=1\\}$ for $v_1$). \nIn Figure~\\ref{fig:3dim_coplanar_1} we show the open region where $v_1'$ needs to be so that the convex hull of $P_0 \\cup \\{v_2,v_1'\\}$ has no extra lattice points, when $v_2 \\in \\{(0,-1,0),(0,2,0)\\}$.\nThe corresponding positions that remain for $v_1$ are:\n", "index": 33, "text": "\n\\[\nv_1 \\in \\left( [-1,3] \\times \\{(0,0)\\} \\right) \\cup \\left( [-2,5] \\times \\{(1,0)\\} \\right) \n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex17.m1\" class=\"ltx_Math\" alttext=\"v_{1}\\in\\left([-1,3]\\times\\{(0,0)\\}\\right)\\cup\\left([-2,5]\\times\\{(1,0)\\}\\right)\" display=\"block\"><mrow><msub><mi>v</mi><mn>1</mn></msub><mo>\u2208</mo><mrow><mrow><mo>(</mo><mrow><mrow><mo stretchy=\"false\">[</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mn>3</mn><mo stretchy=\"false\">]</mo></mrow><mo>\u00d7</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><mo>)</mo></mrow><mo>\u222a</mo><mrow><mo>(</mo><mrow><mrow><mo stretchy=\"false\">[</mo><mrow><mo>-</mo><mn>2</mn></mrow><mo>,</mo><mn>5</mn><mo stretchy=\"false\">]</mo></mrow><mo>\u00d7</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><mo>)</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\n\nHence,  the first coordinate of $v_1$ is $a_1 \\in \\{-3,-2,-1,3,4,5\\}$ (we exclude values $0$ and $1$ since they do not belong to the open chimneys and value $2$ since it gives width one to $P$).\n\\medskip\n\n\\item[(b)] Both points in the  plane $\\{z=1\\}$:\n", "itemtype": "equation", "pos": 64764, "prevtext": "\n\n\\begin{figure}[ht]\n\\centerline{\n\\includegraphics[scale=0.8]{3dim_coplanar_11.pdf} \\qquad\n\\includegraphics[scale=0.8]{3dim_coplanar_12.pdf} \n}\nCase $v_2=(0,-1,0)$ \\qquad \\qquad \\qquad \\qquad  \\qquad \\qquad Case $v_2=(0,2,0)$\n\\caption{The possible positions for $v_1'$ (hence for $v_1$) in case (a) in the proof of Lemma~\\ref{lemma:bound-dim3-coplanar}. Crosses mark the positions for $v_1'$ corresponding to $v_1$ lying in its chimney. The white (open) region are the positions where a point $v'$ has the property that $P_0\\cup \\{v_2,v'\\}$ does not add extra lattice points. The intersection of both gives the valid positions for $v'_1$.} \n\\label{fig:3dim_coplanar_1}\n\\end{figure}\n\n\n\nThe cases $v_2 \\in \\{(1,-1,0),(1,2,0)\\}$ give, by the symmetry mentioned above, the following possibilities for $v_1$:\n", "index": 35, "text": "\n\\[\nv_1 \\in \\left( [-1,3] \\times \\{(0,0)\\} \\right) \\cup \\left( [-3,4] \\times \\{(1,0)\\} \\right).\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex18.m1\" class=\"ltx_Math\" alttext=\"v_{1}\\in\\left([-1,3]\\times\\{(0,0)\\}\\right)\\cup\\left([-3,4]\\times\\{(1,0)\\}%&#10;\\right).\" display=\"block\"><mrow><mrow><msub><mi>v</mi><mn>1</mn></msub><mo>\u2208</mo><mrow><mrow><mo>(</mo><mrow><mrow><mo stretchy=\"false\">[</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mn>3</mn><mo stretchy=\"false\">]</mo></mrow><mo>\u00d7</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><mo>)</mo></mrow><mo>\u222a</mo><mrow><mo>(</mo><mrow><mrow><mo stretchy=\"false\">[</mo><mrow><mo>-</mo><mn>3</mn></mrow><mo>,</mo><mn>4</mn><mo stretchy=\"false\">]</mo></mrow><mo>\u00d7</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><mo>)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\nwith $a_i \\in {\\mathbb{Z}}$ and $\\lambda_i \\in \\{0,1\\}$. \n\nLet us see which values of $a_i, \\lambda_i$ are allowed so that no extra lattice point is added when considering the whole polytope. $P$ is contained in the three planes $z\\in\\{-1,0,1\\}$. There is one point at $\\{z=- 1\\}$, the edge $v_1v_2$ at $\\{z=1\\}$, and the intersection of $P$ with $\\{z=0\\}$ consists of the convex hull of $P_0$, together with the intersection points of the edges $v_1v_3$ and $v_2v_3$ with that plane. These intersection points are \n", "itemtype": "equation", "pos": 65116, "prevtext": "\n\nHence,  the first coordinate of $v_1$ is $a_1 \\in \\{-3,-2,-1,3,4,5\\}$ (we exclude values $0$ and $1$ since they do not belong to the open chimneys and value $2$ since it gives width one to $P$).\n\\medskip\n\n\\item[(b)] Both points in the  plane $\\{z=1\\}$:\n", "index": 37, "text": "\n\\[v_1=(a_1,\\lambda_1,1), \\qquad v_2=(\\lambda_2,a_2,1)\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex19.m1\" class=\"ltx_Math\" alttext=\"v_{1}=(a_{1},\\lambda_{1},1),\\qquad v_{2}=(\\lambda_{2},a_{2},1)\" display=\"block\"><mrow><mrow><msub><mi>v</mi><mn>1</mn></msub><mo>=</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\u03bb</mi><mn>1</mn></msub><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mrow><mo rspace=\"22.5pt\">,</mo><mrow><msub><mi>v</mi><mn>2</mn></msub><mo>=</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03bb</mi><mn>2</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\nand\n", "itemtype": "equation", "pos": 65688, "prevtext": "\nwith $a_i \\in {\\mathbb{Z}}$ and $\\lambda_i \\in \\{0,1\\}$. \n\nLet us see which values of $a_i, \\lambda_i$ are allowed so that no extra lattice point is added when considering the whole polytope. $P$ is contained in the three planes $z\\in\\{-1,0,1\\}$. There is one point at $\\{z=- 1\\}$, the edge $v_1v_2$ at $\\{z=1\\}$, and the intersection of $P$ with $\\{z=0\\}$ consists of the convex hull of $P_0$, together with the intersection points of the edges $v_1v_3$ and $v_2v_3$ with that plane. These intersection points are \n", "index": 39, "text": "\n\\[\nv_1'=\\left(\\frac{a_1}{2},\\frac{\\lambda_1}{2},0\\right) \\in {\\mathbb{Z}}/2 \\times \\left\\{0,\\frac{1}{2}\\right\\} \\times \\{0\\} \n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex20.m1\" class=\"ltx_Math\" alttext=\"v_{1}^{\\prime}=\\left(\\frac{a_{1}}{2},\\frac{\\lambda_{1}}{2},0\\right)\\in{\\mathbb%&#10;{Z}}/2\\times\\left\\{0,\\frac{1}{2}\\right\\}\\times\\{0\\}\" display=\"block\"><mrow><msubsup><mi>v</mi><mn>1</mn><mo>\u2032</mo></msubsup><mo>=</mo><mrow><mo>(</mo><mfrac><msub><mi>a</mi><mn>1</mn></msub><mn>2</mn></mfrac><mo>,</mo><mfrac><msub><mi>\u03bb</mi><mn>1</mn></msub><mn>2</mn></mfrac><mo>,</mo><mn>0</mn><mo>)</mo></mrow><mo>\u2208</mo><mrow><mrow><mi>\u2124</mi><mo>/</mo><mn>2</mn></mrow><mo>\u00d7</mo><mrow><mo>{</mo><mn>0</mn><mo>,</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>}</mo></mrow><mo>\u00d7</mo><mrow><mo stretchy=\"false\">{</mo><mn>0</mn><mo stretchy=\"false\">}</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\n\n\nNotice that, for each $i=1,2$, the possibilities for $v_i'$ and $v_i$ are symmetric with respect to the plane $\\{2x_i-z=1\\}$ (that is, $\\{x_i=1/2\\}$ for the point $v_i'$ and $\\{x_i=1\\}$ for $v_i$).  Also, observe that we can exclude the cases $a_i\\in \\{0,1\\}$, because they do not lie in the chimney. \n\nWe first deal with the case of one of the $a_i$'s equal to 2. Suppose that $a_2=2$. If $\\lambda_1=1$, then the configuration has width one with respect to the functional $y-z$. If $\\lambda_1=0$, in order for $(2,0,0)$ and $(-1,0,0)$ not to lie in $P \\cap \\{z=0\\}$, the value of $a_1$ is restricted to $\\{-1,2,3\\}$, so the statement holds. By symmetry with respect to $\\{x=y\\}$, the same happens for $a_2$ if $a_1=2$.\n\nSo, for the rest of the proof we assume that $a_i\\not\\in \\{0,1,2\\}$ for both points, so that the restrictions on $v_i'$ and $v_i$ are again symmetric with respect to the plane $\\{2x_i-z=1\\}$ \n\nEach position of the point $v_2$ gives a range of possibilities for the position of $v_1$. The least restrictive choices are $v_2\\in\\{(0,3,1),(0,-1,1)\\}$ and $v_2 \\in \\{(1,3,1),(1,-1,1)\\}$, when $a_1 >2$ and $a_1<0$, respectively. These four choices, together with the admissible positions of $v_1$ (or, rather, of $v'_1$) for each of them, are drawn in Figure~\\ref{fig:3dim_coplanar_2}.\n\n\n\\begin{figure}[ht]\n\\centerline{\n\\includegraphics[scale=0.8]{3dim_coplanar_23.pdf} \\quad \\ \\includegraphics[scale=0.8]{3dim_coplanar_21.pdf} }\nCase $v_2=(1,3,1)$ \\qquad \\qquad \\qquad \\qquad  \\qquad \\qquad Case $v_2=(0,3,1)$\n\\vspace{3mm}\n\n\\centerline{\n\\includegraphics[scale=0.8]{3dim_coplanar_24.pdf} \\quad \\ \\includegraphics[scale=0.8]{3dim_coplanar_22.pdf}}\nCase $v_2=(1,-1,1)$ \\qquad \\qquad \\qquad \\qquad  \\qquad \\qquad Case $v_2=(0,-1,1)$\n\\caption{The possible positions for $v_1'$ (hence for $v_1$) in case (b) in the proof of Lemma~\\ref{lemma:bound-dim3-coplanar}. Crosses mark the positions for $v_1'$ corresponding to $v_1$ lying in its chimney. The white (open) region are the positions where a point $v'$ has the property that $P_0\\cup \\{v_2',v'\\}$ does not add extra lattice points. The intersection of both gives the valid positions for $v'_1$.} \\label{fig:3dim_coplanar_2}\n\\end{figure}\n\n\nThat is, the possible positions that remain for the vertex $v_1$ are:\n", "itemtype": "equation", "pos": 65821, "prevtext": "\nand\n", "index": 41, "text": "\n\\[\nv_2'=\\left(\\frac{\\lambda_2}{2},\\frac{a_2}{2},0\\right) \\in  \\left\\{0,\\frac{1}{2}\\right\\} \\times{\\mathbb{Z}}/2 \\times \\{0\\}. \n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex21.m1\" class=\"ltx_Math\" alttext=\"v_{2}^{\\prime}=\\left(\\frac{\\lambda_{2}}{2},\\frac{a_{2}}{2},0\\right)\\in\\left\\{0%&#10;,\\frac{1}{2}\\right\\}\\times{\\mathbb{Z}}/2\\times\\{0\\}.\" display=\"block\"><mrow><mrow><msubsup><mi>v</mi><mn>2</mn><mo>\u2032</mo></msubsup><mo>=</mo><mrow><mo>(</mo><mfrac><msub><mi>\u03bb</mi><mn>2</mn></msub><mn>2</mn></mfrac><mo>,</mo><mfrac><msub><mi>a</mi><mn>2</mn></msub><mn>2</mn></mfrac><mo>,</mo><mn>0</mn><mo>)</mo></mrow><mo>\u2208</mo><mrow><mrow><mrow><mrow><mo>{</mo><mn>0</mn><mo>,</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>}</mo></mrow><mo>\u00d7</mo><mi>\u2124</mi></mrow><mo>/</mo><mn>2</mn></mrow><mo>\u00d7</mo><mrow><mo stretchy=\"false\">{</mo><mn>0</mn><mo stretchy=\"false\">}</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\nand in particular the first coordinate of $v_1$ is in $ \\{-4,-3,-2,-1,3,4,5,6,7\\}$, so $v_1$ is at distance at most six from the unit cube.\n\nThe arguments for $v_2$, depending on the positions of $v_1$, are exactly the same, by symmetry with respect to the plane $\\{x=y\\}$.\n\\end{enumerate}\n\n\n\\end{proof}\n\n\n\nFor case $(2)$, we first study a similar question in dimension two.\n\n\\begin{lemma}\n\\label{lemma:bound-dim2}\nLet $P$ be a lattice $2$-polytope, boxed with respect to the unit square $Q=[0,1]^2$. Suppose that $P$ intersects the edge $\\{(0,t) : t \\in [0,1]\\}$ and does not contain the vertices $(1,0)$ and $(1,1)$ of $Q$. Assume further that $v_2=(1,h)$. Then, $h\\in \\{-2,-1,2,3\\}$.\n\\end{lemma}\n\n\\begin{proof}\nWe assume without loss of generality that $h >1$ and want to show that $h<4$ (the case $h<0$ is symmetric).\nLet $q_0=(0,y_0)\\in P$, with $y_0 \\in [0,1]$, be the point guaranteed by the hypotheses. We distinguish according to the possible positions of $v_1=(a_1, \\lambda_1)$. Remember that $\\lambda_1\\in\\{0,1\\}$ and $a_1\\in {\\mathbb{Z}}\\setminus \\{0,1\\}$:\n\\begin{itemize}\n\\item If $a_1>1$, then $P$ contains a point $q_1=(1,y_1) \\in {\\operatorname{conv} }\\{v_1,q_0\\}$ with $y_1\\in[0,1]$. But then, the point $(1,1)$ must be in $P$ (a contradiction) since it lies in the segment $q_1 v_2$ (see Figure~\\ref{fig:2dim}).\n\n\\item If $a_1 < 0$, consider the segment $v_1v_2$. We need it to intersect the line $\\{x=0\\}$ at height smaller than $2$, or otherwise the point $(0,2)$ is in $P$ (see Figure~\\ref{fig:2dim}).\n\\begin{figure}[ht]\n\\centerline{\n\\includegraphics[scale=0.8]{2dim+.pdf} \\qquad\n\\includegraphics[scale=0.8]{2dim-.pdf}\n}\nCase $a_1>1$ \\qquad \\qquad \\qquad \\qquad \\qquad Case $a_1 <0$\n\\caption{The analysis of the cases where $v_1$ lies in $x>1$ or $x<0$ in the proof of Lemma~\\ref{lemma:bound-dim2}. Black dots represent lattice points. Black squares represent the (possibly non-integer) points $q_0$ and $q_1$ that lie in $P$. White squares represent the vertices $v_1$ and $v_2$ of $P$. Each of them lies in their corresponding chimney (the white regions). The blue area is a (maybe rational) subpolytope of $P$.\n}\n\\label{fig:2dim}\n\\end{figure}\n\nThat is, we want the following determinant to be positive:\n", "itemtype": "equation", "pos": 68227, "prevtext": "\n\n\nNotice that, for each $i=1,2$, the possibilities for $v_i'$ and $v_i$ are symmetric with respect to the plane $\\{2x_i-z=1\\}$ (that is, $\\{x_i=1/2\\}$ for the point $v_i'$ and $\\{x_i=1\\}$ for $v_i$).  Also, observe that we can exclude the cases $a_i\\in \\{0,1\\}$, because they do not lie in the chimney. \n\nWe first deal with the case of one of the $a_i$'s equal to 2. Suppose that $a_2=2$. If $\\lambda_1=1$, then the configuration has width one with respect to the functional $y-z$. If $\\lambda_1=0$, in order for $(2,0,0)$ and $(-1,0,0)$ not to lie in $P \\cap \\{z=0\\}$, the value of $a_1$ is restricted to $\\{-1,2,3\\}$, so the statement holds. By symmetry with respect to $\\{x=y\\}$, the same happens for $a_2$ if $a_1=2$.\n\nSo, for the rest of the proof we assume that $a_i\\not\\in \\{0,1,2\\}$ for both points, so that the restrictions on $v_i'$ and $v_i$ are again symmetric with respect to the plane $\\{2x_i-z=1\\}$ \n\nEach position of the point $v_2$ gives a range of possibilities for the position of $v_1$. The least restrictive choices are $v_2\\in\\{(0,3,1),(0,-1,1)\\}$ and $v_2 \\in \\{(1,3,1),(1,-1,1)\\}$, when $a_1 >2$ and $a_1<0$, respectively. These four choices, together with the admissible positions of $v_1$ (or, rather, of $v'_1$) for each of them, are drawn in Figure~\\ref{fig:3dim_coplanar_2}.\n\n\n\\begin{figure}[ht]\n\\centerline{\n\\includegraphics[scale=0.8]{3dim_coplanar_23.pdf} \\quad \\ \\includegraphics[scale=0.8]{3dim_coplanar_21.pdf} }\nCase $v_2=(1,3,1)$ \\qquad \\qquad \\qquad \\qquad  \\qquad \\qquad Case $v_2=(0,3,1)$\n\\vspace{3mm}\n\n\\centerline{\n\\includegraphics[scale=0.8]{3dim_coplanar_24.pdf} \\quad \\ \\includegraphics[scale=0.8]{3dim_coplanar_22.pdf}}\nCase $v_2=(1,-1,1)$ \\qquad \\qquad \\qquad \\qquad  \\qquad \\qquad Case $v_2=(0,-1,1)$\n\\caption{The possible positions for $v_1'$ (hence for $v_1$) in case (b) in the proof of Lemma~\\ref{lemma:bound-dim3-coplanar}. Crosses mark the positions for $v_1'$ corresponding to $v_1$ lying in its chimney. The white (open) region are the positions where a point $v'$ has the property that $P_0\\cup \\{v_2',v'\\}$ does not add extra lattice points. The intersection of both gives the valid positions for $v'_1$.} \\label{fig:3dim_coplanar_2}\n\\end{figure}\n\n\nThat is, the possible positions that remain for the vertex $v_1$ are:\n", "index": 43, "text": "\n\\[\nv_1 \\in \\left( [-1,3] \\times \\{(0,0)\\} \\right) \\cup \\left( [-4,-3,-2,-1,3,4,5,6,7] \\times \\{(1,0)\\} \\right) \n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex22.m1\" class=\"ltx_Math\" alttext=\"v_{1}\\in\\left([-1,3]\\times\\{(0,0)\\}\\right)\\cup\\left([-4,-3,-2,-1,3,4,5,6,7]%&#10;\\times\\{(1,0)\\}\\right)\" display=\"block\"><mrow><msub><mi>v</mi><mn>1</mn></msub><mo>\u2208</mo><mrow><mrow><mo>(</mo><mrow><mrow><mo stretchy=\"false\">[</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mn>3</mn><mo stretchy=\"false\">]</mo></mrow><mo>\u00d7</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><mo>)</mo></mrow><mo>\u222a</mo><mrow><mo>(</mo><mrow><mrow><mo stretchy=\"false\">[</mo><mrow><mo>-</mo><mn>4</mn></mrow><mo>,</mo><mrow><mo>-</mo><mn>3</mn></mrow><mo>,</mo><mrow><mo>-</mo><mn>2</mn></mrow><mo>,</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>6</mn><mo>,</mo><mn>7</mn><mo stretchy=\"false\">]</mo></mrow><mo>\u00d7</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><mo>)</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\nThat is,\n", "itemtype": "equation", "pos": 70569, "prevtext": "\nand in particular the first coordinate of $v_1$ is in $ \\{-4,-3,-2,-1,3,4,5,6,7\\}$, so $v_1$ is at distance at most six from the unit cube.\n\nThe arguments for $v_2$, depending on the positions of $v_1$, are exactly the same, by symmetry with respect to the plane $\\{x=y\\}$.\n\\end{enumerate}\n\n\n\\end{proof}\n\n\n\nFor case $(2)$, we first study a similar question in dimension two.\n\n\\begin{lemma}\n\\label{lemma:bound-dim2}\nLet $P$ be a lattice $2$-polytope, boxed with respect to the unit square $Q=[0,1]^2$. Suppose that $P$ intersects the edge $\\{(0,t) : t \\in [0,1]\\}$ and does not contain the vertices $(1,0)$ and $(1,1)$ of $Q$. Assume further that $v_2=(1,h)$. Then, $h\\in \\{-2,-1,2,3\\}$.\n\\end{lemma}\n\n\\begin{proof}\nWe assume without loss of generality that $h >1$ and want to show that $h<4$ (the case $h<0$ is symmetric).\nLet $q_0=(0,y_0)\\in P$, with $y_0 \\in [0,1]$, be the point guaranteed by the hypotheses. We distinguish according to the possible positions of $v_1=(a_1, \\lambda_1)$. Remember that $\\lambda_1\\in\\{0,1\\}$ and $a_1\\in {\\mathbb{Z}}\\setminus \\{0,1\\}$:\n\\begin{itemize}\n\\item If $a_1>1$, then $P$ contains a point $q_1=(1,y_1) \\in {\\operatorname{conv} }\\{v_1,q_0\\}$ with $y_1\\in[0,1]$. But then, the point $(1,1)$ must be in $P$ (a contradiction) since it lies in the segment $q_1 v_2$ (see Figure~\\ref{fig:2dim}).\n\n\\item If $a_1 < 0$, consider the segment $v_1v_2$. We need it to intersect the line $\\{x=0\\}$ at height smaller than $2$, or otherwise the point $(0,2)$ is in $P$ (see Figure~\\ref{fig:2dim}).\n\\begin{figure}[ht]\n\\centerline{\n\\includegraphics[scale=0.8]{2dim+.pdf} \\qquad\n\\includegraphics[scale=0.8]{2dim-.pdf}\n}\nCase $a_1>1$ \\qquad \\qquad \\qquad \\qquad \\qquad Case $a_1 <0$\n\\caption{The analysis of the cases where $v_1$ lies in $x>1$ or $x<0$ in the proof of Lemma~\\ref{lemma:bound-dim2}. Black dots represent lattice points. Black squares represent the (possibly non-integer) points $q_0$ and $q_1$ that lie in $P$. White squares represent the vertices $v_1$ and $v_2$ of $P$. Each of them lies in their corresponding chimney (the white regions). The blue area is a (maybe rational) subpolytope of $P$.\n}\n\\label{fig:2dim}\n\\end{figure}\n\nThat is, we want the following determinant to be positive:\n", "index": 45, "text": "\n\\[\n\\begin{array}{|ccc|}\n1&1&1\\\\\na_1&1&0\\\\\n\\lambda_1 & h & 2 \\\\\n\\end{array}\n>0.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex23.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{|ccc|}1&amp;1&amp;1\\\\&#10;a_{1}&amp;1&amp;0\\\\&#10;\\lambda_{1}&amp;h&amp;2\\\\&#10;\\end{array}&gt;0.\" display=\"block\"><mrow><mrow><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd class=\"ltx_border_l\" columnalign=\"center\"><mn>1</mn></mtd><mtd columnalign=\"center\"><mn>1</mn></mtd><mtd class=\"ltx_border_r\" columnalign=\"center\"><mn>1</mn></mtd></mtr><mtr><mtd class=\"ltx_border_l\" columnalign=\"center\"><msub><mi>a</mi><mn>1</mn></msub></mtd><mtd columnalign=\"center\"><mn>1</mn></mtd><mtd class=\"ltx_border_r\" columnalign=\"center\"><mn>0</mn></mtd></mtr><mtr><mtd class=\"ltx_border_l\" columnalign=\"center\"><msub><mi>\u03bb</mi><mn>1</mn></msub></mtd><mtd columnalign=\"center\"><mi>h</mi></mtd><mtd class=\"ltx_border_r\" columnalign=\"center\"><mn>2</mn></mtd></mtr></mtable><mo>&gt;</mo><mn>0</mn></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\nor (since $a_1\\le -1$ and $\\lambda_1\\in \\{0,1\\}$)\n", "itemtype": "equation", "pos": 70660, "prevtext": "\nThat is,\n", "index": 47, "text": "\n\\[\na_1h+2-\\lambda_1-2a_1 >0,\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex24.m1\" class=\"ltx_Math\" alttext=\"a_{1}h+2-\\lambda_{1}-2a_{1}&gt;0,\" display=\"block\"><mrow><mrow><mrow><mrow><mrow><msub><mi>a</mi><mn>1</mn></msub><mo>\u2062</mo><mi>h</mi></mrow><mo>+</mo><mn>2</mn></mrow><mo>-</mo><msub><mi>\u03bb</mi><mn>1</mn></msub><mo>-</mo><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>a</mi><mn>1</mn></msub></mrow></mrow><mo>&gt;</mo><mn>0</mn></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\n\n\\end{itemize}\n\n\n\\end{proof}\n\n\n\n\\begin{lemma}\n\\label{lemma:bound-dim3}\nLet $P$ be a lattice $3$-polytope, boxed with respect to the unit cube $Q=[0,1]^3$ and of size at least seven. \nThen, unless $P$ is in the conditions of Lemma~\\ref{lemma:bound-dim3-coplanar},\n the $i$-th coordinate of each $v_i$ lies in $\\{-4,-3,-2,-1,2,3,4,5\\}$.\n\\end{lemma}\n\n\n\\begin{proof}\nSuppose that an edge $s=s^\\lambda_i$ of $Q$ does not contain any lattice point of $P$ and that $v_i \\in r^\\lambda_i$. (Otherwise we apply Lemma~\\ref{lemma:firstpoint}).\n\n\nLet $P$ be boxed with respect to the unit cube $[0,1]^3$ and of size at least seven. Then $P_Q:=P \\cap Q \\cap {\\mathbb{Z}}^3$ has size at least four and $(P\\setminus Q)\\cap {\\mathbb{Z}}^3=\\{v_1,v_2,v_3\\}$. Without loss of generality, we can assume that $s=s_3^{11*}={\\operatorname{conv} }\\{(1,1,0)(1,1,1)\\}$, so that $s_3^{11*} \\cap P_Q= \\emptyset$ and $v_3=(1,1,h)$, with $h\\in {\\mathbb{Z}} \\setminus\\{0,1\\}$. We assume without loss of generality that $h >1$ and want to show that $h<6$ (the case $h<0$ is symmetric).\n\nSince $P_Q$ does not consist of the four lattice points in a facet of $Q$,  at least one lattice point of each of $s_3^{10*}$ and $s_3^{01*}$ is in $P_Q$. That is, let $q_{10}=(1,0, z_{10}),q_{01}=(0,1, z_{01}) \\in P_Q$ for some $z_{10}, z_{01} \\in \\{0,1\\}$. \\smallskip\n\n\nWe distinguish according to the possible positions of \n", "itemtype": "equation", "pos": 70742, "prevtext": "\nor (since $a_1\\le -1$ and $\\lambda_1\\in \\{0,1\\}$)\n", "index": 49, "text": "\n\\[\nh < 2 + \\frac{2-\\lambda_1}{|a_1|} \\le 4 - \\lambda_1 \\le 4.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex25.m1\" class=\"ltx_Math\" alttext=\"h&lt;2+\\frac{2-\\lambda_{1}}{|a_{1}|}\\leq 4-\\lambda_{1}\\leq 4.\" display=\"block\"><mrow><mrow><mi>h</mi><mo>&lt;</mo><mrow><mn>2</mn><mo>+</mo><mfrac><mrow><mn>2</mn><mo>-</mo><msub><mi>\u03bb</mi><mn>1</mn></msub></mrow><mrow><mo stretchy=\"false\">|</mo><msub><mi>a</mi><mn>1</mn></msub><mo stretchy=\"false\">|</mo></mrow></mfrac></mrow><mo>\u2264</mo><mrow><mn>4</mn><mo>-</mo><msub><mi>\u03bb</mi><mn>1</mn></msub></mrow><mo>\u2264</mo><mn>4</mn></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\nRemember that $\\lambda_i, \\delta_i\\in\\{0,1\\}$ and $a_i\\in {\\mathbb{Z}}\\setminus \\{0,1\\}$, for $i=1,2$.\n\nFirst, suppose $\\delta_2=1$. Then $v_2,v_3,q_{10}\\in P$ are in the plane $\\{x=1\\}$. Then $P \\cap \\{x=1\\}$ is as in the hypothesis of Lemma~\\ref{lemma:bound-dim2}, hence $h \\in \\{2,3\\}$. By symmetry of coordinates $x$ and $y$, the same happens if $\\delta_1=1$, using the point $q_{01}$.\n\nSo now we have the case where $\\delta_1=0=\\delta_2$:\n", "itemtype": "equation", "pos": 72188, "prevtext": "\n\n\\end{itemize}\n\n\n\\end{proof}\n\n\n\n\\begin{lemma}\n\\label{lemma:bound-dim3}\nLet $P$ be a lattice $3$-polytope, boxed with respect to the unit cube $Q=[0,1]^3$ and of size at least seven. \nThen, unless $P$ is in the conditions of Lemma~\\ref{lemma:bound-dim3-coplanar},\n the $i$-th coordinate of each $v_i$ lies in $\\{-4,-3,-2,-1,2,3,4,5\\}$.\n\\end{lemma}\n\n\n\\begin{proof}\nSuppose that an edge $s=s^\\lambda_i$ of $Q$ does not contain any lattice point of $P$ and that $v_i \\in r^\\lambda_i$. (Otherwise we apply Lemma~\\ref{lemma:firstpoint}).\n\n\nLet $P$ be boxed with respect to the unit cube $[0,1]^3$ and of size at least seven. Then $P_Q:=P \\cap Q \\cap {\\mathbb{Z}}^3$ has size at least four and $(P\\setminus Q)\\cap {\\mathbb{Z}}^3=\\{v_1,v_2,v_3\\}$. Without loss of generality, we can assume that $s=s_3^{11*}={\\operatorname{conv} }\\{(1,1,0)(1,1,1)\\}$, so that $s_3^{11*} \\cap P_Q= \\emptyset$ and $v_3=(1,1,h)$, with $h\\in {\\mathbb{Z}} \\setminus\\{0,1\\}$. We assume without loss of generality that $h >1$ and want to show that $h<6$ (the case $h<0$ is symmetric).\n\nSince $P_Q$ does not consist of the four lattice points in a facet of $Q$,  at least one lattice point of each of $s_3^{10*}$ and $s_3^{01*}$ is in $P_Q$. That is, let $q_{10}=(1,0, z_{10}),q_{01}=(0,1, z_{01}) \\in P_Q$ for some $z_{10}, z_{01} \\in \\{0,1\\}$. \\smallskip\n\n\nWe distinguish according to the possible positions of \n", "index": 51, "text": "\n\\[\nv_1=(a_1, \\delta_1,\\lambda_1), \\; v_2=(\\delta_2,a_2,\\lambda_2).\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex26.m1\" class=\"ltx_Math\" alttext=\"v_{1}=(a_{1},\\delta_{1},\\lambda_{1}),\\;v_{2}=(\\delta_{2},a_{2},\\lambda_{2}).\" display=\"block\"><mrow><mrow><mrow><msub><mi>v</mi><mn>1</mn></msub><mo>=</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\u03b4</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\u03bb</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo rspace=\"5.3pt\">,</mo><mrow><msub><mi>v</mi><mn>2</mn></msub><mo>=</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03b4</mi><mn>2</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><msub><mi>\u03bb</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\n\n\nWe will now separate the cases where $a_1,a_2$ are positive or negative (see Figure~\\ref{fig:3dim_123}):\n\n\\begin{itemize}\n\n\\item If $a_1,a_2>1$, then $P$ contains a point $q_{11}=(1,1,z_{11}) \\in {\\operatorname{conv} }\\{v_1,v_2,q_{10}\\}$ with $z_1\\in[0,1]$. But then, the point $(1,1,1)$ must be in $P$ (a contradiction) since it lies in the segment $q_{11} v_3$.\n\n\\item If $a_1,a_2 < 0$, then $P$ contains a point $q_{00}=(0,0,z_{00}) \\in {\\operatorname{conv} }\\{v_1,v_2,q_{10}\\}$, with $z_{00} \\in[0,1]$. Consider now the triangle $v_1v_2v_3$. We need it to intersect the line $\\{x=0=y\\}$ at a height smaller than $2$, or otherwise, since $q_{00}\\in P$, the point $(0,0,2)$ must be in $P$ (a contradiction). That is, we want the following determinant to be positive:\n", "itemtype": "equation", "pos": 72702, "prevtext": "\nRemember that $\\lambda_i, \\delta_i\\in\\{0,1\\}$ and $a_i\\in {\\mathbb{Z}}\\setminus \\{0,1\\}$, for $i=1,2$.\n\nFirst, suppose $\\delta_2=1$. Then $v_2,v_3,q_{10}\\in P$ are in the plane $\\{x=1\\}$. Then $P \\cap \\{x=1\\}$ is as in the hypothesis of Lemma~\\ref{lemma:bound-dim2}, hence $h \\in \\{2,3\\}$. By symmetry of coordinates $x$ and $y$, the same happens if $\\delta_1=1$, using the point $q_{01}$.\n\nSo now we have the case where $\\delta_1=0=\\delta_2$:\n", "index": 53, "text": "\n\\[\nv_1=(a_1, 0,\\lambda_1), \\; v_2=(0,a_2,\\lambda_2)\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex27.m1\" class=\"ltx_Math\" alttext=\"v_{1}=(a_{1},0,\\lambda_{1}),\\;v_{2}=(0,a_{2},\\lambda_{2})\" display=\"block\"><mrow><mrow><msub><mi>v</mi><mn>1</mn></msub><mo>=</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><mn>0</mn><mo>,</mo><msub><mi>\u03bb</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo rspace=\"5.3pt\">,</mo><mrow><msub><mi>v</mi><mn>2</mn></msub><mo>=</mo><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><msub><mi>\u03bb</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\nThat is, $-a_1a_2h+\\lambda_1a_2+\\lambda_2a_1+2(a_1a_2-a_1-a_2) >0$ or, (since $a_1,a_2\\le -1$ and $\\lambda_1,\\lambda_2\\in \\{0,1\\}$)\n\n\\begin{eqnarray*}\nh &<& 2\\left(\\frac{(-a_1)(-a_2)+(-a_1)(1-\\lambda_2/2)+(-a_2)(1-\\lambda_1/2)}{(-a_1)(-a_2)}\\right) =\\\\\n&=& 2\\left(1+\\frac{1-\\lambda_2/2}{-a_2}+\\frac{1-\\lambda_1/2}{-a_1}\\right) \\le  2\\left(1+\\frac{1}{-a_2}+\\frac{1}{-a_1}\\right) \\le 6\\\\\n\\end{eqnarray*}\n\n\\begin{figure}[ht]\n\\centerline{\n\\includegraphics[scale=0.72]{3dim_1.pdf} \\qquad\n\\includegraphics[scale=0.72]{3dim_2.pdf} \\qquad\n\\includegraphics[scale=0.72]{3dim_3.pdf}\n}\nCase $a_1,a_2>1$ \\qquad \\qquad Case $a_1,a_2<0$ \\qquad \\qquad Case $a_1>1$, $a_2<0$\n\\caption{The analysis of the cases where $v_i$ lies in $C_i^+$ or in $C_i^-$, for $i=1,2$, in the proof of Lemma~\\ref{lemma:bound-dim3}. The figures represent the projection in the direction of the third coordinate. Black dots represent lattice points. Black squares represent the (possibly non-integer) points $q_{ij}$ that lie in $P$. White squares represent the vertices $v_i$ and lattice points $q_{ij}$ of $P$. Each of the vertices $v_i$ lies in its corresponding chimney (the white regions). The blue area is a (maybe rational) subpolytope of $P$.\n}\n\\label{fig:3dim_123}\n\\end{figure}\n\n\\item One is positive and one negative: suppose $a_1>1$ and $a_2 <0$. In this case, the triangle with vertices $v_1,v_2,v_3 \\in P$ must intersect the line $\\{x=1,y=0\\}$ at height smaller than $2$, otherwise, since $q_{10} \\in P$, the point $(1,0,2)$ is in $P$. This is equivalent to the following determinant being positive:\n\n", "itemtype": "equation", "pos": 73528, "prevtext": "\n\n\nWe will now separate the cases where $a_1,a_2$ are positive or negative (see Figure~\\ref{fig:3dim_123}):\n\n\\begin{itemize}\n\n\\item If $a_1,a_2>1$, then $P$ contains a point $q_{11}=(1,1,z_{11}) \\in {\\operatorname{conv} }\\{v_1,v_2,q_{10}\\}$ with $z_1\\in[0,1]$. But then, the point $(1,1,1)$ must be in $P$ (a contradiction) since it lies in the segment $q_{11} v_3$.\n\n\\item If $a_1,a_2 < 0$, then $P$ contains a point $q_{00}=(0,0,z_{00}) \\in {\\operatorname{conv} }\\{v_1,v_2,q_{10}\\}$, with $z_{00} \\in[0,1]$. Consider now the triangle $v_1v_2v_3$. We need it to intersect the line $\\{x=0=y\\}$ at a height smaller than $2$, or otherwise, since $q_{00}\\in P$, the point $(0,0,2)$ must be in $P$ (a contradiction). That is, we want the following determinant to be positive:\n", "index": 55, "text": "\n\\[\n\\begin{array}{|cccc|}\n1&1&1&1\\\\\na_1&0&1&0\\\\\n0 &a_2&1&0\\\\\n\\lambda_1 &\\lambda_2& h & 2 \\\\\n\\end{array}\n>0.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex28.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{|cccc|}1&amp;1&amp;1&amp;1\\\\&#10;a_{1}&amp;0&amp;1&amp;0\\\\&#10;0&amp;a_{2}&amp;1&amp;0\\\\&#10;\\lambda_{1}&amp;\\lambda_{2}&amp;h&amp;2\\\\&#10;\\end{array}&gt;0.\" display=\"block\"><mrow><mrow><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd class=\"ltx_border_l\" columnalign=\"center\"><mn>1</mn></mtd><mtd columnalign=\"center\"><mn>1</mn></mtd><mtd columnalign=\"center\"><mn>1</mn></mtd><mtd class=\"ltx_border_r\" columnalign=\"center\"><mn>1</mn></mtd></mtr><mtr><mtd class=\"ltx_border_l\" columnalign=\"center\"><msub><mi>a</mi><mn>1</mn></msub></mtd><mtd columnalign=\"center\"><mn>0</mn></mtd><mtd columnalign=\"center\"><mn>1</mn></mtd><mtd class=\"ltx_border_r\" columnalign=\"center\"><mn>0</mn></mtd></mtr><mtr><mtd class=\"ltx_border_l\" columnalign=\"center\"><mn>0</mn></mtd><mtd columnalign=\"center\"><msub><mi>a</mi><mn>2</mn></msub></mtd><mtd columnalign=\"center\"><mn>1</mn></mtd><mtd class=\"ltx_border_r\" columnalign=\"center\"><mn>0</mn></mtd></mtr><mtr><mtd class=\"ltx_border_l\" columnalign=\"center\"><msub><mi>\u03bb</mi><mn>1</mn></msub></mtd><mtd columnalign=\"center\"><msub><mi>\u03bb</mi><mn>2</mn></msub></mtd><mtd columnalign=\"center\"><mi>h</mi></mtd><mtd class=\"ltx_border_r\" columnalign=\"center\"><mn>2</mn></mtd></mtr></mtable><mo>&gt;</mo><mn>0</mn></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\nThat is, $2a_2 +a_1a_2h-2a_1a_2-a_2h+2a_1+\\lambda_2-a_1\\lambda_2-\\lambda_1>0$ \nor (since $a_1\\ge2$, $a_2\\le -1$ and $\\lambda_1,\\lambda_2\\in \\{0,1\\}$)\n\n\\begin{eqnarray*}\nh &<& 2\\left(\\frac{(-a_2)(a_1-1)+a_1  -\\lambda_1/2-\\lambda_2(a_1-1)/2}{(-a_2)(a_1-1)}\\right) \\le\\\\\n&\\le& 2\\left(\\frac{(-a_2)(a_1-1)+a_1}{(-a_2)(a_1-1)}\\right) = \\\\\n&=&2\\left(1+\\frac{1}{-a_2}+\\frac{1}{(-a_2)(a_1-1)}\\right) \\le 6\\\\\n\\end{eqnarray*}\n\nBy symmetry, the same happens if $a_1<0$ and $a_2>1$.\\end{itemize}\n\\end{proof}\n\n\n\n\n\n\\bigskip \n\n\\subsection{$3$-polytopes boxed with respect to other parallelepipeds}\n\n$3$-polytopes boxed with respect to many different parallelepipeds exist. But, since previous papers of us classify completely $3$-polytopes of size six or less, we assume here that $P$ is a boxed $3$-polytope of size at least seven. This simplifies things a lot:\n\n\\begin{lemma}\n\\label{lemma:cubes}\nLet $P$ be a  boxed $3$-polytope of size at least $7$. Then, modulo a unimodular transformation, $P$ is boxed with respect to either the unit cube or the following parallelepiped:\n\n\n\\begin{eqnarray*}\nQ_0&:=&{\\operatorname{conv} }\\{(0,0,0), (-1/2,1/2,1/2), (1/2,-1/2,1/2), \\\\ \n&&(1/2,1/2,-1/2),(1,0,0), (0,1,0), (0,0,1),(1/2,1/2,1/2)\\} \\\\\n\\end{eqnarray*}\nMoreover, in this case $P$ has size seven and every edge of $Q_0$ intersects $P$.\n\n\\begin{figure}[ht]\n\\centerline{\n\\includegraphics[scale=1]{Q0.pdf}\n}\n\\caption{The parallelepiped $Q_0$. White squares are the lattice points in it.}\n\\end{figure}\n\\end{lemma}\n\n\\begin{proof}\nIf at least $5$ vertices of $Q$ are lattice points, then all vertices of $Q$ are in the lattice. This would imply $Q$ to be a lattice parallelepiped of width one with respect to every facet, which would necessarily be unimodularly equivalent to the unit cube.\n\nSo, for the rest of the proof we assume $Q$ to have at most four lattice vertices. In order to have size at least seven, $P\\cap {\\mathbb{Z}}^3$ must consist precisely of those four lattice vertices plus the three extra points $v_1$, $v_2$ and $v_3$. That is, $P \\cap {\\mathbb{Z}}^3= A \\cup \\{v_1,v_2,v_3\\}$ with $A = Q \\cap {\\mathbb{Z}}^3$  of size four. Then, either the $4$ points in $A$ are coplanar or $A$ consists of alternating vertices of $Q$. If they are coplanar, they can form a facet of $Q$ or span two opposite parallel edges:\n\n\\begin{itemize}\n\n\\item If they  span a facet $F$, let $H$ be the plane containing $F$, and let $F'$ and $H'$ be the opposite facet and the plane containing it. Then, $F$ is a fundamental parallelogram of the lattice $H\\cap {\\mathbb{Z}}^3$. By translation, and since $H'$ is a lattice plane by definition of boxed, $F'$ is a fundamental parallelogram of $H'\\cap {\\mathbb{Z}}^3$, a contradiction with the fact that $F'$ contains no lattice points.\n\n\\item \nIf they span two opposite parallel edges, the four points still form an empty parallelogram. Assume without loss of generality that\n", "itemtype": "equation", "pos": 75213, "prevtext": "\nThat is, $-a_1a_2h+\\lambda_1a_2+\\lambda_2a_1+2(a_1a_2-a_1-a_2) >0$ or, (since $a_1,a_2\\le -1$ and $\\lambda_1,\\lambda_2\\in \\{0,1\\}$)\n\n\\begin{eqnarray*}\nh &<& 2\\left(\\frac{(-a_1)(-a_2)+(-a_1)(1-\\lambda_2/2)+(-a_2)(1-\\lambda_1/2)}{(-a_1)(-a_2)}\\right) =\\\\\n&=& 2\\left(1+\\frac{1-\\lambda_2/2}{-a_2}+\\frac{1-\\lambda_1/2}{-a_1}\\right) \\le  2\\left(1+\\frac{1}{-a_2}+\\frac{1}{-a_1}\\right) \\le 6\\\\\n\\end{eqnarray*}\n\n\\begin{figure}[ht]\n\\centerline{\n\\includegraphics[scale=0.72]{3dim_1.pdf} \\qquad\n\\includegraphics[scale=0.72]{3dim_2.pdf} \\qquad\n\\includegraphics[scale=0.72]{3dim_3.pdf}\n}\nCase $a_1,a_2>1$ \\qquad \\qquad Case $a_1,a_2<0$ \\qquad \\qquad Case $a_1>1$, $a_2<0$\n\\caption{The analysis of the cases where $v_i$ lies in $C_i^+$ or in $C_i^-$, for $i=1,2$, in the proof of Lemma~\\ref{lemma:bound-dim3}. The figures represent the projection in the direction of the third coordinate. Black dots represent lattice points. Black squares represent the (possibly non-integer) points $q_{ij}$ that lie in $P$. White squares represent the vertices $v_i$ and lattice points $q_{ij}$ of $P$. Each of the vertices $v_i$ lies in its corresponding chimney (the white regions). The blue area is a (maybe rational) subpolytope of $P$.\n}\n\\label{fig:3dim_123}\n\\end{figure}\n\n\\item One is positive and one negative: suppose $a_1>1$ and $a_2 <0$. In this case, the triangle with vertices $v_1,v_2,v_3 \\in P$ must intersect the line $\\{x=1,y=0\\}$ at height smaller than $2$, otherwise, since $q_{10} \\in P$, the point $(1,0,2)$ is in $P$. This is equivalent to the following determinant being positive:\n\n", "index": 57, "text": "\n\\[\n\\begin{array}{|cccc|}\n1&1&1&1\\\\\n0&a_1&1&1\\\\\na_2&0 &1&0\\\\\n\\lambda_2 &\\lambda_1& h & 2 \\\\\n\\end{array}\n>0.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex29.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{|cccc|}1&amp;1&amp;1&amp;1\\\\&#10;0&amp;a_{1}&amp;1&amp;1\\\\&#10;a_{2}&amp;0&amp;1&amp;0\\\\&#10;\\lambda_{2}&amp;\\lambda_{1}&amp;h&amp;2\\\\&#10;\\end{array}&gt;0.\" display=\"block\"><mrow><mrow><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd class=\"ltx_border_l\" columnalign=\"center\"><mn>1</mn></mtd><mtd columnalign=\"center\"><mn>1</mn></mtd><mtd columnalign=\"center\"><mn>1</mn></mtd><mtd class=\"ltx_border_r\" columnalign=\"center\"><mn>1</mn></mtd></mtr><mtr><mtd class=\"ltx_border_l\" columnalign=\"center\"><mn>0</mn></mtd><mtd columnalign=\"center\"><msub><mi>a</mi><mn>1</mn></msub></mtd><mtd columnalign=\"center\"><mn>1</mn></mtd><mtd class=\"ltx_border_r\" columnalign=\"center\"><mn>1</mn></mtd></mtr><mtr><mtd class=\"ltx_border_l\" columnalign=\"center\"><msub><mi>a</mi><mn>2</mn></msub></mtd><mtd columnalign=\"center\"><mn>0</mn></mtd><mtd columnalign=\"center\"><mn>1</mn></mtd><mtd class=\"ltx_border_r\" columnalign=\"center\"><mn>0</mn></mtd></mtr><mtr><mtd class=\"ltx_border_l\" columnalign=\"center\"><msub><mi>\u03bb</mi><mn>2</mn></msub></mtd><mtd columnalign=\"center\"><msub><mi>\u03bb</mi><mn>1</mn></msub></mtd><mtd columnalign=\"center\"><mi>h</mi></mtd><mtd class=\"ltx_border_r\" columnalign=\"center\"><mn>2</mn></mtd></mtr></mtable><mo>&gt;</mo><mn>0</mn></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\nwhere the lines $\\{x=z=0\\}$ and $\\{x=1, z=0\\}$ contain opposite edges of $Q$. One of the chimneys, say $C_1$, contains these two lattice lines and no other.\nBy symmetry of the conditions so far, we can assume that $v_1=(0,b_1,0)$, for $b_1\\ge 2$. But for any choice of $b_1$ the point $(0,2,0)$ is in $P$, so we must actually have $v_1=(0,2,0)$.\n\nNow, vertices $v_2$ and $v_3$ must satisfy that ${\\operatorname{conv} }(A\\cup\\{v_i\\})$ ($i=2,3$) does not have any extra lattice points. Since $A$ contains a unimodular parallelogram, $v_2$ and $v_3$ are at distance one from $A$  (Lemma~\\ref{lemma:exception-height}(1)). Moreover, they must be in opposite sides of $A$ or otherwise $P$ has width one. That is, without loss of generality we assume $v_2=(0,0,1)$, and $v_3=(a,b,-1)$, for some $a,b \\in {\\mathbb{Z}}$.\n\nThe functional $f_1$ can be taken equal to zero on the segment $(0,0,0)(0,1,0)$, and to $1$ in the segment $(1,0,0),(1,1,0)$, so it has the form $f(x,y,z)= y+cz$ for some $c\\in {\\mathbb{Z}}$. By definition of boxed, we need to have that $v_2,v_3 \\in f_1^{-1}(\\{0,1\\})$, which implies that $c\\in\\{0,1\\}$ and $b\\in\\{c,c+1\\} \\subset \\{0,1,2\\}$. \nBut then $P$ is boxed also with respect to the parallelepiped\n", "itemtype": "equation", "pos": 78217, "prevtext": "\nThat is, $2a_2 +a_1a_2h-2a_1a_2-a_2h+2a_1+\\lambda_2-a_1\\lambda_2-\\lambda_1>0$ \nor (since $a_1\\ge2$, $a_2\\le -1$ and $\\lambda_1,\\lambda_2\\in \\{0,1\\}$)\n\n\\begin{eqnarray*}\nh &<& 2\\left(\\frac{(-a_2)(a_1-1)+a_1  -\\lambda_1/2-\\lambda_2(a_1-1)/2}{(-a_2)(a_1-1)}\\right) \\le\\\\\n&\\le& 2\\left(\\frac{(-a_2)(a_1-1)+a_1}{(-a_2)(a_1-1)}\\right) = \\\\\n&=&2\\left(1+\\frac{1}{-a_2}+\\frac{1}{(-a_2)(a_1-1)}\\right) \\le 6\\\\\n\\end{eqnarray*}\n\nBy symmetry, the same happens if $a_1<0$ and $a_2>1$.\\end{itemize}\n\\end{proof}\n\n\n\n\n\n\\bigskip \n\n\\subsection{$3$-polytopes boxed with respect to other parallelepipeds}\n\n$3$-polytopes boxed with respect to many different parallelepipeds exist. But, since previous papers of us classify completely $3$-polytopes of size six or less, we assume here that $P$ is a boxed $3$-polytope of size at least seven. This simplifies things a lot:\n\n\\begin{lemma}\n\\label{lemma:cubes}\nLet $P$ be a  boxed $3$-polytope of size at least $7$. Then, modulo a unimodular transformation, $P$ is boxed with respect to either the unit cube or the following parallelepiped:\n\n\n\\begin{eqnarray*}\nQ_0&:=&{\\operatorname{conv} }\\{(0,0,0), (-1/2,1/2,1/2), (1/2,-1/2,1/2), \\\\ \n&&(1/2,1/2,-1/2),(1,0,0), (0,1,0), (0,0,1),(1/2,1/2,1/2)\\} \\\\\n\\end{eqnarray*}\nMoreover, in this case $P$ has size seven and every edge of $Q_0$ intersects $P$.\n\n\\begin{figure}[ht]\n\\centerline{\n\\includegraphics[scale=1]{Q0.pdf}\n}\n\\caption{The parallelepiped $Q_0$. White squares are the lattice points in it.}\n\\end{figure}\n\\end{lemma}\n\n\\begin{proof}\nIf at least $5$ vertices of $Q$ are lattice points, then all vertices of $Q$ are in the lattice. This would imply $Q$ to be a lattice parallelepiped of width one with respect to every facet, which would necessarily be unimodularly equivalent to the unit cube.\n\nSo, for the rest of the proof we assume $Q$ to have at most four lattice vertices. In order to have size at least seven, $P\\cap {\\mathbb{Z}}^3$ must consist precisely of those four lattice vertices plus the three extra points $v_1$, $v_2$ and $v_3$. That is, $P \\cap {\\mathbb{Z}}^3= A \\cup \\{v_1,v_2,v_3\\}$ with $A = Q \\cap {\\mathbb{Z}}^3$  of size four. Then, either the $4$ points in $A$ are coplanar or $A$ consists of alternating vertices of $Q$. If they are coplanar, they can form a facet of $Q$ or span two opposite parallel edges:\n\n\\begin{itemize}\n\n\\item If they  span a facet $F$, let $H$ be the plane containing $F$, and let $F'$ and $H'$ be the opposite facet and the plane containing it. Then, $F$ is a fundamental parallelogram of the lattice $H\\cap {\\mathbb{Z}}^3$. By translation, and since $H'$ is a lattice plane by definition of boxed, $F'$ is a fundamental parallelogram of $H'\\cap {\\mathbb{Z}}^3$, a contradiction with the fact that $F'$ contains no lattice points.\n\n\\item \nIf they span two opposite parallel edges, the four points still form an empty parallelogram. Assume without loss of generality that\n", "index": 59, "text": "\n\\[\nA={\\operatorname{conv} }\\{(0,0,0),(1,0,0),(0,1,0),(1,1,0)\\} \\subset Q\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex30.m1\" class=\"ltx_Math\" alttext=\"A={\\operatorname{conv}}\\{(0,0,0),(1,0,0),(0,1,0),(1,1,0)\\}\\subset Q\" display=\"block\"><mrow><mi>A</mi><mo>=</mo><mrow><mo>conv</mo><mo>\u2061</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><mo>\u2282</mo><mi>Q</mi></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\nfor $f'_2=-z$, $f'_3=x$ and $f'_1$ equal to $y$ if $b\\in\\{0,1\\}$ and to $y+z$ if $b=2$.\nIn both cases $Q'$ is unimodularly equivalent to the unit cube.\nObserve that to check the boxed property we need $f'_3(v_3)= a \\not\\in \\{0,1\\}$, which happens because $a\\in \\{0,1\\}$ gives\n$P$ width one with respect to $x$.\n\n\\item If $A$ consists of alternating vertices of $Q$, then ${\\operatorname{conv} }(A)$ is a lattice empty tetrahedron of width one with respect to each of its three pairs of edges. This implies it to be equivalent to either a unimodular tetrahedron or the unique tetrahedron of volume $2$ (see, e.g.,~\\cite{5points}). Since the functional giving width one with respect to a given pair of non-coplanar segments is unique, the stated property fixes $Q$ to be (equivalent to) the $Q_0$ in the statement in the first case and to the unit cube in the second case.\n\\end{itemize}\n\\end{proof}\n\n\\medskip\n\n\n\\begin{lemma}\n\\label{lemma:vertices_Q_0}\nLet $P$ be boxed with respect to $Q_0$ and of size $7$. Then, up to a unimodular transformation, $P \\cap {\\mathbb{Z}}^3= \\{o,e_1,e_2,e_3,v_1,v_2,v_3\\}$, with either\n\n", "itemtype": "equation", "pos": 79511, "prevtext": "\nwhere the lines $\\{x=z=0\\}$ and $\\{x=1, z=0\\}$ contain opposite edges of $Q$. One of the chimneys, say $C_1$, contains these two lattice lines and no other.\nBy symmetry of the conditions so far, we can assume that $v_1=(0,b_1,0)$, for $b_1\\ge 2$. But for any choice of $b_1$ the point $(0,2,0)$ is in $P$, so we must actually have $v_1=(0,2,0)$.\n\nNow, vertices $v_2$ and $v_3$ must satisfy that ${\\operatorname{conv} }(A\\cup\\{v_i\\})$ ($i=2,3$) does not have any extra lattice points. Since $A$ contains a unimodular parallelogram, $v_2$ and $v_3$ are at distance one from $A$  (Lemma~\\ref{lemma:exception-height}(1)). Moreover, they must be in opposite sides of $A$ or otherwise $P$ has width one. That is, without loss of generality we assume $v_2=(0,0,1)$, and $v_3=(a,b,-1)$, for some $a,b \\in {\\mathbb{Z}}$.\n\nThe functional $f_1$ can be taken equal to zero on the segment $(0,0,0)(0,1,0)$, and to $1$ in the segment $(1,0,0),(1,1,0)$, so it has the form $f(x,y,z)= y+cz$ for some $c\\in {\\mathbb{Z}}$. By definition of boxed, we need to have that $v_2,v_3 \\in f_1^{-1}(\\{0,1\\})$, which implies that $c\\in\\{0,1\\}$ and $b\\in\\{c,c+1\\} \\subset \\{0,1,2\\}$. \nBut then $P$ is boxed also with respect to the parallelepiped\n", "index": 61, "text": "\n\\[\nQ' := \\bigcap_{i=1}^3 f'^{-1}_i([0,1]),\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex31.m1\" class=\"ltx_Math\" alttext=\"Q^{\\prime}:=\\bigcap_{i=1}^{3}f^{\\prime-1}_{i}([0,1]),\" display=\"block\"><mrow><mrow><msup><mi>Q</mi><mo>\u2032</mo></msup><mo>:=</mo><mrow><munderover><mo largeop=\"true\" mathsize=\"160%\" movablelimits=\"false\" stretchy=\"false\" symmetric=\"true\">\u22c2</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>3</mn></munderover><mrow><msubsup><mi>f</mi><mi>i</mi><mrow><mi mathsize=\"142%\" mathvariant=\"normal\">\u2032</mi><mo>\u2063</mo><mrow><mo>-</mo><mn>1</mn></mrow></mrow></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\nor\n", "itemtype": "equation", "pos": 80673, "prevtext": "\nfor $f'_2=-z$, $f'_3=x$ and $f'_1$ equal to $y$ if $b\\in\\{0,1\\}$ and to $y+z$ if $b=2$.\nIn both cases $Q'$ is unimodularly equivalent to the unit cube.\nObserve that to check the boxed property we need $f'_3(v_3)= a \\not\\in \\{0,1\\}$, which happens because $a\\in \\{0,1\\}$ gives\n$P$ width one with respect to $x$.\n\n\\item If $A$ consists of alternating vertices of $Q$, then ${\\operatorname{conv} }(A)$ is a lattice empty tetrahedron of width one with respect to each of its three pairs of edges. This implies it to be equivalent to either a unimodular tetrahedron or the unique tetrahedron of volume $2$ (see, e.g.,~\\cite{5points}). Since the functional giving width one with respect to a given pair of non-coplanar segments is unique, the stated property fixes $Q$ to be (equivalent to) the $Q_0$ in the statement in the first case and to the unit cube in the second case.\n\\end{itemize}\n\\end{proof}\n\n\\medskip\n\n\n\\begin{lemma}\n\\label{lemma:vertices_Q_0}\nLet $P$ be boxed with respect to $Q_0$ and of size $7$. Then, up to a unimodular transformation, $P \\cap {\\mathbb{Z}}^3= \\{o,e_1,e_2,e_3,v_1,v_2,v_3\\}$, with either\n\n", "index": 63, "text": "\n\\[\nv_1\\in\n \\left\\{\\begin{tabular}{c} {$(-1,1,1)$} \\\\ {$(-1,1,2)$} \\\\ {$(-1,2,1)$} \\\\ {$(\\;\\;0,1,1)$} \\end{tabular}\\right\\} ,\\qquad\nv_2\\in\n \\left\\{\\begin{tabular}{c} {$(1,-1,1)$} \\\\ {$(1,-1,2)$} \\\\ {$(2,-1,1)$} \\\\ {$(1,\\;\\;0,1)$} \\end{tabular}\\right\\} ,\\qquad\n v_3\\in\n  \\left\\{\\begin{tabular}{c} {$(1,1,-1)$} \\\\ {$(1,2,-1)$} \\\\ {$(2,1,-1)$} \\\\ {$(1,1,\\;\\;0)$} \\end{tabular}\\right\\} \\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex32.m1\" class=\"ltx_Math\" alttext=\"v_{1}\\in\\left\\{\\begin{tabular}[]{c}{$(-1,1,1)$}\\\\&#10;{$(-1,1,2)$}\\\\&#10;{$(-1,2,1)$}\\\\&#10;{$(\\;\\;0,1,1)$}\\end{tabular}\\right\\},\\qquad v_{2}\\in\\left\\{\\begin{tabular}[]{c%&#10;}{$(1,-1,1)$}\\\\&#10;{$(1,-1,2)$}\\\\&#10;{$(2,-1,1)$}\\\\&#10;{$(1,\\;\\;0,1)$}\\end{tabular}\\right\\},\\qquad v_{3}\\in\\left\\{\\begin{tabular}[]{c%&#10;}{$(1,1,-1)$}\\\\&#10;{$(1,2,-1)$}\\\\&#10;{$(2,1,-1)$}\\\\&#10;{$(1,1,\\;\\;0)$}\\end{tabular}\\right\\}\" display=\"block\"><mrow><mrow><msub><mi>v</mi><mn>1</mn></msub><mo>\u2208</mo><mrow><mo>{</mo><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mo stretchy=\"false\">(</mo><mo>-</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mo stretchy=\"false\">(</mo><mo>-</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mo stretchy=\"false\">(</mo><mo>-</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mo stretchy=\"false\">(</mo><mn>\u2004\u20040</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mtd></mtr></mtable><mo>}</mo></mrow></mrow><mo rspace=\"22.5pt\">,</mo><mrow><mrow><msub><mi>v</mi><mn>2</mn></msub><mo>\u2208</mo><mrow><mo>{</mo><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mo stretchy=\"false\">(</mo><mn>1</mn><mo>,</mo><mo>-</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mo stretchy=\"false\">(</mo><mn>1</mn><mo>,</mo><mo>-</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mo stretchy=\"false\">(</mo><mn>2</mn><mo>,</mo><mo>-</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mo stretchy=\"false\">(</mo><mn>1</mn><mo>,</mo><mn>\u2004\u20040</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mtd></mtr></mtable><mo>}</mo></mrow></mrow><mo rspace=\"22.5pt\">,</mo><mrow><msub><mi>v</mi><mn>3</mn></msub><mo>\u2208</mo><mrow><mo>{</mo><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mo stretchy=\"false\">(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mo>-</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mo stretchy=\"false\">(</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>-</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mo stretchy=\"false\">(</mo><mn>2</mn><mo>,</mo><mn>1</mn><mo>,</mo><mo>-</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mo stretchy=\"false\">(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>\u2004\u20040</mn><mo stretchy=\"false\">)</mo></mtd></mtr></mtable><mo>}</mo></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\n\\end{lemma}\n\n\\begin{proof}\n\nThe three functionals that define $Q_0$ are $f_i(x_1,x_2,x_3)=x_j+x_k$, for $\\{i,j,k\\}=\\{1,2,3\\}$. That is, \n", "itemtype": "equation", "pos": 81060, "prevtext": "\nor\n", "index": 65, "text": "\n\\[\nv_1\\in\n \\left\\{\\begin{tabular}{c} {$(1,-1,-1)$} \\\\ {$(1,-1,\\;\\;0)$} \\\\ {$(1,\\;\\;0,-1)$} \\\\ {$(2,-1,-1)$} \\end{tabular}\\right\\}  ,\\qquad\nv_2\\in\n \\left\\{\\begin{tabular}{c} {$(-1,1,-1)$} \\\\ {$(-1,1,\\;\\;0)$} \\\\ {$(\\;\\;0,1,-1)$} \\\\ {$(-1,2,-1)$} \\end{tabular}\\right\\}  ,\\qquad\nv_3\\in\n \\left\\{\\begin{tabular}{c} {$(-1,-1,1)$} \\\\ {$(-1,\\;\\;0,1)$} \\\\ {$(\\;\\;0,-1,1)$} \\\\ {$(-1,-1,1)$} \\end{tabular}\\right\\}\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex33.m1\" class=\"ltx_Math\" alttext=\"v_{1}\\in\\left\\{\\begin{tabular}[]{c}{$(1,-1,-1)$}\\\\&#10;{$(1,-1,\\;\\;0)$}\\\\&#10;{$(1,\\;\\;0,-1)$}\\\\&#10;{$(2,-1,-1)$}\\end{tabular}\\right\\},\\qquad v_{2}\\in\\left\\{\\begin{tabular}[]{c}{%&#10;$(-1,1,-1)$}\\\\&#10;{$(-1,1,\\;\\;0)$}\\\\&#10;{$(\\;\\;0,1,-1)$}\\\\&#10;{$(-1,2,-1)$}\\end{tabular}\\right\\},\\qquad v_{3}\\in\\left\\{\\begin{tabular}[]{c}{%&#10;$(-1,-1,1)$}\\\\&#10;{$(-1,\\;\\;0,1)$}\\\\&#10;{$(\\;\\;0,-1,1)$}\\\\&#10;{$(-1,-1,1)$}\\end{tabular}\\right\\}\" display=\"block\"><mrow><mrow><msub><mi>v</mi><mn>1</mn></msub><mo>\u2208</mo><mrow><mo>{</mo><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mo stretchy=\"false\">(</mo><mn>1</mn><mo>,</mo><mo>-</mo><mn>1</mn><mo>,</mo><mo>-</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mo stretchy=\"false\">(</mo><mn>1</mn><mo>,</mo><mo>-</mo><mn>1</mn><mo>,</mo><mn>\u2004\u20040</mn><mo stretchy=\"false\">)</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mo stretchy=\"false\">(</mo><mn>1</mn><mo>,</mo><mn>\u2004\u20040</mn><mo>,</mo><mo>-</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mo stretchy=\"false\">(</mo><mn>2</mn><mo>,</mo><mo>-</mo><mn>1</mn><mo>,</mo><mo>-</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mtd></mtr></mtable><mo>}</mo></mrow></mrow><mo rspace=\"22.5pt\">,</mo><mrow><mrow><msub><mi>v</mi><mn>2</mn></msub><mo>\u2208</mo><mrow><mo>{</mo><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mo stretchy=\"false\">(</mo><mo>-</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mo>-</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mo stretchy=\"false\">(</mo><mo>-</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>\u2004\u20040</mn><mo stretchy=\"false\">)</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mo stretchy=\"false\">(</mo><mn>\u2004\u20040</mn><mo>,</mo><mn>1</mn><mo>,</mo><mo>-</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mo stretchy=\"false\">(</mo><mo>-</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>-</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mtd></mtr></mtable><mo>}</mo></mrow></mrow><mo rspace=\"22.5pt\">,</mo><mrow><msub><mi>v</mi><mn>3</mn></msub><mo>\u2208</mo><mrow><mo>{</mo><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mo stretchy=\"false\">(</mo><mo>-</mo><mn>1</mn><mo>,</mo><mo>-</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mo stretchy=\"false\">(</mo><mo>-</mo><mn>1</mn><mo>,</mo><mn>\u2004\u20040</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mo stretchy=\"false\">(</mo><mn>\u2004\u20040</mn><mo>,</mo><mo>-</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mo stretchy=\"false\">(</mo><mo>-</mo><mn>1</mn><mo>,</mo><mo>-</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mtd></mtr></mtable><mo>}</mo></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\n\nIf $P$ is boxed with respect to $Q_0$, then $P \\cap {\\mathbb{Z}}^3\\subset Q_0 \\cup \\{v_1,v_2,v_3\\}$. Since the size of $P$ is 7 and $Q_0$ has only the four lattice points $\\{o,e_1,e_2,e_3\\}$, we conclude that indeed  $P\\cap {\\mathbb{Z}}^3 = \\{o,e_1,e_2,e_3,v_1,v_2,v_3\\}$. We need to show that $v_1$, $v_2$ and $v_3$ are as stated.\n\nObserve that $P$ intersects all the edges of $Q_0$, so we are in the conditions of Lemma~\\ref{lemma:firstpoint}. This implies that we have eight candidate points for each $v_i$, namely the first lattice point in each of the eight lattice half-lines contained in the half-chimneys $C^+_i$ and $C^-_i$.\nThe eight points are:\n\n", "itemtype": "equation", "pos": 81601, "prevtext": "\n\\end{lemma}\n\n\\begin{proof}\n\nThe three functionals that define $Q_0$ are $f_i(x_1,x_2,x_3)=x_j+x_k$, for $\\{i,j,k\\}=\\{1,2,3\\}$. That is, \n", "index": 67, "text": "\n\\[\nQ_0= \\{(x_1,x_2,x_3)\\in {\\mathbb{R}}^3 \\, |\\ x_i+x_j \\in [0,1]\\ \\forall i \\neq j\\}.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex34.m1\" class=\"ltx_Math\" alttext=\"Q_{0}=\\{(x_{1},x_{2},x_{3})\\in{\\mathbb{R}}^{3}\\,|\\ x_{i}+x_{j}\\in[0,1]\\ %&#10;\\forall i\\neq j\\}.\" display=\"block\"><mrow><mrow><msub><mi>Q</mi><mn>0</mn></msub><mo>=</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><msub><mi>x</mi><mn>3</mn></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2208</mo><mpadded width=\"+1.7pt\"><msup><mi>\u211d</mi><mn>3</mn></msup></mpadded></mrow><mo rspace=\"7.5pt\" stretchy=\"false\">|</mo><mrow><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><msub><mi>x</mi><mi>j</mi></msub></mrow><mo>\u2208</mo><mrow><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo rspace=\"7.5pt\" stretchy=\"false\">]</mo></mrow><mo>\u2062</mo><mrow><mo>\u2200</mo><mi>i</mi></mrow></mrow><mo>\u2260</mo><mi>j</mi></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02577.tex", "nexttext": "\n\nOn the other hand, by the symmetries of $P\\cap {\\mathbb{Z}}^3$ in $Q_0$, without loss of generality we can assume that the $v_i$'s are in the half-chimneys that correspond to the vertices $(0,0,0)$ or $(1/2,1/2,1/2)$ of $Q_0$. That is, $v_i \\in C_i^+$ for all $i=1,2,3$ or $v_i \\in C_i^-$ for all $i=1,2,3$.\n\\end{proof}\n\n\\subsection{Enumeration of boxed $3$-polytopes}\n\\label{subsec:computer-routines}\nWe here summarize the results in this section and explain how we use them to enumerate boxed $3$-polytopes of size at least seven with the help of a computer. Let $P$ be a boxed $3$-polytope of size at least $7$, so that $P\\cap {\\mathbb{Z}}^3=A\\cup \\{v_1,v_2,v_3\\}$ and $A$, of size at least four, is a subset of vertices of a rational parallelepiped $Q$.\n\n\\begin{enumerate}\n\\item \\emph{If $Q$ is the unit cube and $A$ meets every edge of it} then, \nby Lemma~\\ref{lemma:boxed-containment}, either $A$ consists of all the vertices of the unit cube or there is a vertex that can be added, to get a bigger boxed configuration. Thus, to enumerate boxed polytopes of this type we can:\n\\begin{itemize}\n\\item Start with the maximal ones, in which $A$ has size eight and we have a priori $8^3=512$ possibilities for $v_1$, $v_2$ and $v_3$, since each $v_i$ has $i$-th coordinate in $\\{-1,2\\}$ (Lemma~\\ref{lemma:firstpoint}) and the other two in $\\{0,1\\}$. Of course, we eliminate redundancies.\n\\item We then remove lattice points (necessarily vertices of $P$ that belong to $A$) one by one. \n\\end{itemize}\n\nThis algorithm gives us the following numbers of boxed $3$-polytopes:\n\\medskip\\\\\n\\centerline{\n\\small\n\\begin{tabular}{c|ccccccc|c}\n{\\bf \\# vertices}&4 & 5 & 6&7&8&9&10&Total\\\\\n\\hline\n{\\bf size $7$}& 1 &   21 &   28 &    0 &    -  &   -  &   -    & 50 \\\\\n{\\bf size $8$}& 2  &  11  &  48  &  30  &   0 &    -  &   -    & 91 \\\\\n{\\bf size $9$}&  5  &  24 &   45 &   16  &   0  &   0  &   - & 90\\\\\n{\\bf size $10$}& 1  &   0 &    7  &  21  &  20 &    6 &    0    & 55 \\\\\n{\\bf size $11$}&0  &    1  &   0  &   4  &   6  &   4  &   1   & 16  \\\\\n\\end{tabular}\n}\n\\medskip\n\n\\item \\emph{If $Q$ is the unit cube and $A$ does not meet every edge of it}, there are eight possibilities (modulo symmetry) for $A$: one of size six (vertices of a triangular prism), two of size five (vertices of a square pyramid, with base on a facet or with base one a halving quadrilateral), and five of size four (two coplanarities plus the three types of unimodular tetrahedra in the unit cube).\n\nWe then exhaust all the possible coordinates for the vertices $v_i$ which are, according to Lemmas~\\ref{lemma:bound-dim3-coplanar} and~\\ref{lemma:bound-dim3}, less than $(2\\times2\\times 12)^3$ since the $i$-th coordinate of $v_i$ is in $\\{-6,\\dots,-1,2,\\dots,7\\}$ and the other two coordinates are in $\\{0,1\\}$. (This is a huge overcount, since the twelve possibilities have to be considered only when $A$ does not meet the particular edge contained in the same line as $v_i$, which happens quite rarely). This results in the following possibilities\n\\medskip\\\\\n\\centerline{\n\\small\n\\begin{tabular}{c|ccccc|c}\n{\\bf \\# vertices}&4 & 5 & 6&7&8 & Total\\\\\n\\hline\n{\\bf size $7$} &4&    51&    47  &   0  &   - & 102\\\\\n{\\bf size $8$}& 2 &   19 &   72  &  31 &    0 & 124\\\\\n{\\bf size $9$}& 0 &    3   & 20  &  35  &   8  & 66 \\\\ \n\\end{tabular}\n}\n\\medskip\n\n\n\n\\item \\emph{If $Q$ is not the unit cube}, then it equals the parallelepiped $Q_0$ of Lemma~\\ref{lemma:cubes}.  Since $A$ meets every edge of $Q_0$, by Lemma~\\ref{lemma:firstpoint} there are at most eight possible positions for each vertex $v_i$, giving $512$ possibilities in total. Many of them are equivalent and, in fact, the computer tells us that there are only five non-isomorphic boxed $3$-polytopes with respect to $Q_0$: $4$  with five vertices, and $1$ with six vertices.\n\\end{enumerate}\n\nThis classification contains some redundancy, since the same configuration can be boxed in more than one way. The following is the irredundant classification of boxed $3$-polytopes by size and number of vertices:\n\\medskip\\\\\n\\centerline{\n\\small\n\\begin{tabular}{c|ccccccc|c}\n{\\bf \\# vertices}&4 & 5 & 6&7&8 & Total\\\\\n\\hline\n{\\bf size $7$} &4&    51&    49  &   0  &   - & &&104\\\\\n{\\bf size $8$}& 2 &   19 &   77  &  38 &    0 &&& 136\\\\\n{\\bf size $9$}& 0 &    5   & 30  &  56  &   188  &&& 279 \\\\ \n{\\bf size $10$}& 1 &    0   & 7  &  21  &   20 & 6  && 55 \\\\ \n{\\bf size $11$}& 0 &    1   & 0  &  4  &   6  & 4 & 1 & 16 \\\\ \n\\end{tabular}\n}\n\\medskip\n\nOnly 32 of these 590 boxed $3$-polytopes are quasi-minimal. The following matrices, with columns corresponding to vertices,  are representatives for them. \n\n\\bigskip\n\n\\input{list_boxed}\n\n\n\n\\section{Results of the enumeration}\n\\label{sec:result-tables}\n\nHere we include the results of our enumerations. We start with the numbers of quasi-minimal polytopes (Table~\\ref{table-minimal}).\nBoxed ones are finitely many and of size at most ten. They are enumerated by computer as explained in Section~\\ref{subsec:computer-routines}. \n For spiked ones, the number was computed in Section~\\ref{sec:spiked} (see Remark~\\ref{remark:spiked}). These two counts are shown in the left and center parts of the table, and the right part contains the union of the two sets. For sizes $5$ and $6$ a polytope can be boxed and spiked at the same time, so we do not give the separate numbers. In fact, the numbers of quasi-minimal polytopes of these sizes were not computed with the methods of this paper, but directly extracted from the classifications in~\\cite{5points,6points}.\n \n\\input{table-minimal}\n \n We then present the summary of the enumeration of lattice $3$-polytopes by size and number of vertices (Table~\\ref{table:main}) obtained by the gluing algorithm from the classifications of size $\\le 6$ (\\cite{6points}) and of quasi-minimal polytopes. \nObserve that the zeros in the diagonal ``size=vertices'' follow from Howe's Theorem~\\cite{Scarf}: if all lattice points of a $3$-polytope $P$ are vertices then $P$ has width one.\n\n\\input{table-main}\n\nTable~\\ref{table:interior} shows a finer classification, in which the number of interior lattice points is also considered. \n\nPolytopes with a single interior point are of special importance in algebraic geometry, for their connections with toric varieties, and called \\emph{canonical}. If the interior point is the only non-vertex then they are called \\emph{terminal}. The numbers of canonical and terminal polytopes for each size can be extracted from Table~\\ref{table:interior} and are shown in Table~\\ref{table:canonical}. Their full classification was previously done by Kasprzyk~\\cite{Kasprzyk}, and our results agree with it.\n\\input{table-canonical}\n\nWe also present the classification of lattice polytopes by size and width, in Table~\\ref{table:width}. There is a remarkable gap between polytopes of width three, that exist already with six lattice points, and of width four, which need ten lattice points at the least.\n\n\\input{table-width}\n\n\n\n\nFinally, from the classification it is also easy to extract the full list of dps $3$-polytopes of width greater than one, as shown in Table~\\ref{table:dps}.\n\n\n\n\\begin{table}[h]\n\n\\begin{tabular}{cccc}\\small\n\n\\begin{tabular}{c|cccc|c}\n\\multicolumn{6}{c}{\\textbf{DPS $3$-polytopes}}\\\\\n\\hline\n{\\bf \\# vertices}& 4 & 5 & 6&7& \\text{total}\\\\\n\\hline\n{\\bf size $5$} & $9$  & $0$  & $-$  & $-$  &$9$\\\\\n{\\bf size $6$} & $20$  &$25$   & $0$  & $-$  &$45$\\\\\n{\\bf size $7$} & $5$  & $31$  & $12$  & $0$  &$48$\\\\\n{\\bf size $8$} & $3$  & $2$  & $1$  &  $0$ & $6$\\\\\n\\hline\n\\bf{total}       & $37$ &$58$ & $13$ &$0$ & $108$\n\\end{tabular}\n&&&\n\\begin{tabular}{c|cccc|c}\n\\multicolumn{6}{c}{\\textbf{maximal DPS $3$-polytopes}}\\\\\n\\hline\n{\\bf \\# vertices}& 4 & 5 & 6&7& \\text{total}\\\\\n\\hline\n{\\bf size $5$} & $0$  & $0$  & $-$  & $-$  &$0$\\\\\n{\\bf size $6$} & $0$  &$0$   & $0$  & $-$  &$0$\\\\\n{\\bf size $7$} & $3$  & $21$  & $9$  & $0$  &$33$\\\\\n{\\bf size $8$} & $3$  & $2$  & $1$  &  $0$ & $6$\\\\\n\\hline\n\\bf{total}       & $6$ &$23$ & $10$ &$0$ & $39$\n\\end{tabular}\n\\end{tabular}\n\\bigskip\n\\caption{The  number of DPS  $3$-polytopes of width larger than one, classified according to their numbers of lattice points (row) and vertices (column). On the right only the maximal ones (those that are not contained in another DPS $3$-polytope) are counted.}\n\\label{table:dps}\n\\end{table}\n\n\\input{table-interior}\n\n\n\n\n\n\n\n\\bigskip\n\\begin{thebibliography}{99}\n\n\\bibitem{5points}\nM.~Blanco and F.~Santos.\n\\newblock Lattice $3$-polytopes with few lattice points.\n\\newblock Preprint, 19 pages, September 2014, {\\tt arXiv:1409.6701}.\n\n\\bibitem{6points}\nM.~Blanco and F.~Santos.\n\\newblock Lattice $3$-polytopes with six lattice points.\n\\newblock Preprint, 31 pages, January 2015, {\\tt arXiv:1501.01055}.\n\n\\bibitem{ChoiLamReznick}\nM.~D.~Choi, T.~Y.~Lam and B.~Reznick.\n\\newblock Lattice polytopes with distinct pair-sums.\n\\newblock {\\em Discrete Comput. Geom.} 27 (2002), 65--72.\n\n\\bibitem{Kasprzyk}\nA.~Kasprzyk. \nCanonical toric Fano threefolds. \n\\emph{Canad.~J.~Math.} 62(6) (2010), 1293--1309.\n\n\\bibitem{Kasprzyk-database}\nA.~Kasprzyk, Graded ring database, \\url{http://grdb.lboro.ac.uk}.\n\n\\bibitem{Reznick-favorite} \nB.~Reznick.\n\\newblock Problem 3 in ``Let me tell you my favorite lattice-point problem'' in\n\\newblock {\\em Integer Points in Polyhedra---Geometry, Number Theory, Representation Theory, Algebra, Optimization, Statistics},\nM.~Beck, C.~Haase, B.~Reznick, M.~Vergne, V.~Welker, and R.~Yoshida (eds.).\nContemp.~Math.~{ 452}, Amer.~Math.~Soc.~2008.\n\n\\bibitem{Scarf}\nH.~E.~Scarf.\n\\newblock Integral polyhedra in three space.\n\\newblock {\\em Math. Oper. Res.} 10:3 (1985), 403--438.\n\n\\bibitem{White}\nG.~K.~White.\n\\newblock Lattice tetrahedra.\n\\newblock {\\em Canadian J.~Math.} 16 (1964), 389--396.\n\n\\end{thebibliography}\n\n\n\n\n", "itemtype": "equation", "pos": 82349, "prevtext": "\n\nIf $P$ is boxed with respect to $Q_0$, then $P \\cap {\\mathbb{Z}}^3\\subset Q_0 \\cup \\{v_1,v_2,v_3\\}$. Since the size of $P$ is 7 and $Q_0$ has only the four lattice points $\\{o,e_1,e_2,e_3\\}$, we conclude that indeed  $P\\cap {\\mathbb{Z}}^3 = \\{o,e_1,e_2,e_3,v_1,v_2,v_3\\}$. We need to show that $v_1$, $v_2$ and $v_3$ are as stated.\n\nObserve that $P$ intersects all the edges of $Q_0$, so we are in the conditions of Lemma~\\ref{lemma:firstpoint}. This implies that we have eight candidate points for each $v_i$, namely the first lattice point in each of the eight lattice half-lines contained in the half-chimneys $C^+_i$ and $C^-_i$.\nThe eight points are:\n\n", "index": 69, "text": "\n\\[\n\\begin{array}{cccccc}\n\\{-e_i + e_j +e_k, & -e_i + 2e_j +e_k, &  -e_i +  e_j +2e_k,  & e_j + e_k      \\} &\\in& C_i^+ \\\\\n\\{e_i -e_j -e_k, & e_i -e_k, & e_i -e_j, &  2e_i - e_j- e_k\\} &\\in& C_i^-.\n\\end{array}\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex35.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{cccccc}\\{-e_{i}+e_{j}+e_{k},&amp;-e_{i}+2e_{j}+e_{k},&amp;-e_{i}+e_{j}%&#10;+2e_{k},&amp;e_{j}+e_{k}\\}&amp;\\in&amp;C_{i}^{+}\\\\&#10;\\{e_{i}-e_{j}-e_{k},&amp;e_{i}-e_{k},&amp;e_{i}-e_{j},&amp;2e_{i}-e_{j}-e_{k}\\}&amp;\\in&amp;C_{i}^%&#10;{-}.\\end{array}\" display=\"block\"><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><mo stretchy=\"false\">{</mo><mo>-</mo><msub><mi>e</mi><mi>i</mi></msub><mo>+</mo><msub><mi>e</mi><mi>j</mi></msub><mo>+</mo><msub><mi>e</mi><mi>k</mi></msub><mo>,</mo></mrow></mtd><mtd columnalign=\"center\"><mrow><mrow><mrow><mo>-</mo><msub><mi>e</mi><mi>i</mi></msub></mrow><mo>+</mo><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>e</mi><mi>j</mi></msub></mrow><mo>+</mo><msub><mi>e</mi><mi>k</mi></msub></mrow><mo>,</mo></mrow></mtd><mtd columnalign=\"center\"><mrow><mrow><mrow><mo>-</mo><msub><mi>e</mi><mi>i</mi></msub></mrow><mo>+</mo><msub><mi>e</mi><mi>j</mi></msub><mo>+</mo><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>e</mi><mi>k</mi></msub></mrow></mrow><mo>,</mo></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>e</mi><mi>j</mi></msub><mo>+</mo><msub><mi>e</mi><mi>k</mi></msub><mo stretchy=\"false\">}</mo></mrow></mtd><mtd columnalign=\"center\"><mo>\u2208</mo></mtd><mtd columnalign=\"center\"><msubsup><mi>C</mi><mi>i</mi><mo>+</mo></msubsup></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><mo stretchy=\"false\">{</mo><msub><mi>e</mi><mi>i</mi></msub><mo>-</mo><msub><mi>e</mi><mi>j</mi></msub><mo>-</mo><msub><mi>e</mi><mi>k</mi></msub><mo>,</mo></mrow></mtd><mtd columnalign=\"center\"><mrow><mrow><msub><mi>e</mi><mi>i</mi></msub><mo>-</mo><msub><mi>e</mi><mi>k</mi></msub></mrow><mo>,</mo></mrow></mtd><mtd columnalign=\"center\"><mrow><mrow><msub><mi>e</mi><mi>i</mi></msub><mo>-</mo><msub><mi>e</mi><mi>j</mi></msub></mrow><mo>,</mo></mrow></mtd><mtd columnalign=\"center\"><mrow><mn>2</mn><msub><mi>e</mi><mi>i</mi></msub><mo>-</mo><msub><mi>e</mi><mi>j</mi></msub><mo>-</mo><msub><mi>e</mi><mi>k</mi></msub><mo stretchy=\"false\">}</mo></mrow></mtd><mtd columnalign=\"center\"><mo>\u2208</mo></mtd><mtd columnalign=\"center\"><mrow><msubsup><mi>C</mi><mi>i</mi><mo>-</mo></msubsup><mo>.</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}]