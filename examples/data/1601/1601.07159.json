[{"file": "1601.07159.tex", "nexttext": "\nHere the eigenvalues $\\{\\varepsilon_{i}\\}$ are ordered non-decreasingly,\nand $N_e$ is the number of electrons.  ${V_{\\mathrm{ion}}}$ is a local potential\ncharacterizing the electron-ion interaction in all-electron\ncalculations. In pseudopotential\nor effective core potential calculations, ${V_{\\mathrm{ion}}}$ may contain a low rank and semi-local component as well. ${V_{\\mathrm{ion}}}$ is independent of the\nelectronic states $\\{\\psi_{i}\\}$. \n$\\rho({\\mathbf{{r}}})$ is the electron\ndensity. The Hartree potential is a local potential, and depends\nonly on the electron density as\n", "itemtype": "equation", "pos": 8662, "prevtext": "\n\n\\begin{abstract}\nThe Fock exchange operator plays a central role in modern quantum\nchemistry. The large computational cost associated with the Fock\nexchange operator hinders Hartree-Fock calculations and Kohn-Sham\ndensity functional theory calculations with hybrid exchange-correlation\nfunctionals, even for systems consisting of hundreds of atoms. We\ndevelop the adaptively compressed exchange operator (ACE) formulation,\nwhich greatly reduces the computational cost associated with the Fock\nexchange operator without loss of accuracy. The ACE formulation does not\ndepend on the size of the band gap, and thus can be applied to insulating,\nsemiconducting as well as metallic systems. In an iterative framework\nfor solving Hartree-Fock-like systems, the ACE formulation only requires\nmoderate modification of the code, and can be potentially beneficial for\nall electronic structure software packages involving exchange\ncalculations. Numerical results indicate that the ACE formulation can\nbecome advantageous even for small systems with tens of atoms. In particular,\nthe cost of each self-consistent field iteration for the electron density in the ACE formulation is only marginally larger than that of the generalized gradient approximation (GGA) calculation, and thus offers orders of magnitude speedup for Hartree-Fock-like calculations.\n\\end{abstract}\n\n\\section{Introduction}\\label{sec:intro}\n\n\nThe Fock exchange operator, or simply the exchange operator, plays a\ncentral role both in wavefunction theory and in density functional\ntheory, two cornerstones of modern quantum chemistry. Hartree-Fock\ntheory (HF) is the starting point of nearly all wavefunction based\ncorrelation methods. Kohn-Sham density functional theory\n(KSDFT)~\\cite{HohenbergKohn1964,KohnSham1965} is the most widely used\nelectronic structure theory for molecules and systems in condensed\nphase. The accuracy of KSDFT is\nultimately determined by the exchange-correlation (XC) functional\nemployed in the calculation. Despite the great success of relatively\nsimple XC functionals such as local density approximation\n(LDA)~\\cite{CeperleyAlder1980,PerdewZunger1981},\ngeneralized gradient approximation\n(GGA)~\\cite{Becke1988,LeeYangParr1988,PerdewBurkeErnzerhof1996} and\nmeta-GGA~\\cite{StaroverovScuseriaTaoEtAl2003,ZhaoTruhlar2008}\nfunctionals, numerous computational studies in the past two decades\nsuggest that KSDFT calculations with hybrid\nfunctionals~\\cite{Becke1993,PerdewErnzerhofBurke1996,HeydScuseriaErnzerhof2003,HeydScuseriaErnzerhof2006}\ncan provide systematically\nimproved description of important physical quantities\nsuch as band gaps, for a\nvast range of systems. As an example, the B3LYP functional~\\cite{Becke1993}, which is only one specific hybrid\nfunctional, has\ngenerated more than $55,000$ citations (Data from ISI Web of Science,\nJanuary, 2016).\nHybrid functional calculations are computationally more involved since it\ncontains a fraction of the Fock exchange\nterm, which is defined using the entire density matrix rather than the\nelectron density. If the exchange operator is constructed explicitly,\nthe computational cost scales as ${\\mathcal{O}}(N_e^4)$ where $N_e$ is the number\nof electrons of the system. The cost can be reduced to ${\\mathcal{O}}(N_e^3)$ by\niterative algorithms that avoid the explicit construction of the\nexchange operator, but with a large preconstant.  Hence hybrid\nfunctional calculations for systems consisting of hundreds of atoms or\neven less can be a very challenging computational task.\n\n\n\n\nVarious numerical methods have been developed to reduce the\ncomputational cost of Hartree-Fock-like calculations (i.e. Hartree-Fock\ncalculations and KSDFT calculations with hybrid\nfunctionals), most notably methods with asymptotic ``linear scaling''\ncomplexity~\\cite{Goedecker1999,BowlerMiyazaki2012}. The linear scaling methods use the fact that for\nan insulating system with a finite HOMO-LUMO gap, the subspace spanned by\nthe occupied orbitals has a compressed representation: it is possible to\nfind a unitary transformation to transform all occupied orbitals into a\nset of orbitals localized in the real space. This is closely related to \nthe ``nearsightedness'' of electronic\nmatters~\\cite{Kohn1996,ProdanKohn2005}. Various efforts have been\ndeveloped to find such localized\nrepresentation~\\cite{FosterBoys1960,MarzariVanderbilt1997,WannierReview,Gygi2009,ELiLu2010,OzolinsLaiCaflischEtAl2013,DamleLinYing2015}.\nAfter such localized representation is obtained, the exchange operator\nalso becomes simplified, leading to more efficient\nnumerical\nschemes for systems of sufficiently large sizes~\\cite{WuSelloniCar2009,GygiDuchemin2012,DamleLinYing2015}.\nRecent numerical studies indicate that linear scaling methods can be\nvery successful in reducing the cost of the calculation of the exchange\nterm for systems of large sizes with substantial band gaps~\\cite{ChenWuCar2010,DiStasioSantraLiEtAl2014,DawsonGygi2015}.\n\nIn this work, we develop a new method for reducing the computational\ncost due to the Fock exchange operator. Our method aims at finding a low rank\ndecomposition of the exchange operator. However, standard low rank\ndecomposition schemes such as the singular value decomposition mandates the\nlow rank operator to yield similar result as the exchange\noperator does when applied to an arbitrary orbital. This is doomed to\nfail since the exchange operator is not a low rank operator, and\nforcefully applied low rank decomposition can lead to unphysical\nresults. The key observation of this work is that in order to compute\nphysical quantities in Hartree-Fock-like calculations, it is sufficient to construct an  operator that\nyields the same result as the exchange operator does when applied to the\n\\textit{occupied orbitals}. This is possible since the rank of the subspace spanned\nby the occupied orbitals is known \\textit{a priori}.\nSince occupied orbitals vary in self-consistent field\niterations, the compressed representation must be adaptive to the\nchanging orbitals. Hence our compressed exchange operator\nis referred to as the adaptively compressed exchange operator (ACE). \n\nThe ACE formulation has a few notable advantages:  1) The ACE is a strictly\nlow rank operator, and there is no loss of accuracy when used to compute physical\nquantities such as total energies and band gaps. \n2) The effectiveness of the ACE \\textit{does not} depend on the size of the band\ngap. Hence the method is applicable to insulators as well as\nsemiconductors or even metals. 3) The construction cost of the ACE is\nsimilar to the one time application cost of the exchange operator to the set of occupied\norbitals. Once constructed, the ACE can be repeatedly\nused. The cost of applying the ACE is similar to that of applying a\nnonlocal pseudopotential operator, thanks to the low rank structure. 4)\nIn an iterative framework for solving the Hartree-Fock-like equations,\nthe ACE formulation only requires moderate change of the code, and \ncould be potentially beneficial for all electronic structure software\npackages involving exchange calculations. \n\n\n\nOur numerical results indicate that once the ACE is constructed, the\ncost of each self-consistent field iteration (SCF) of the electron density\nin a hybrid functional calculation is only marginally larger than that\nof a GGA calculation.  The ACE formulation offers significant speedup\neven for small systems with tens of atoms in a serial implementation.\nFor moderately larger systems, such as a silicon system with $216$ atoms, we\nobserve  more than $50$ times speedup in terms of the cost\nof each SCF iteration for the electron density.\n\nThe rest of paper is organized as follows. Section~\\ref{sec:prelim}\nreviews the basic procedure of using iterative methods to solve\nHartree-Fock-like equations.\nSection~\\ref{sec:ace} describes the method of adaptively compressed\nexchange operator. The numerical results are presented in\nsection~\\ref{sec:numer}, followed by conclusion and future work in\nsection~\\ref{sec:conclusion}.\n\n\\section{Iterative methods for solving Hartree-Fock-like equations}\\label{sec:prelim}\n\nFor the sake of simplicity, our discussion below focuses on the\nHartree-Fock (HF) equations. The generalization from HF equations to KSDFT\nequations with hybrid functionals is straightforward, and will be\nmentioned at the end of this section.\nTo simplify notation we neglect the spin degeneracy in the discussion\nbelow and assume all orbitals $\\{{\\psi}_{i}({\\mathbf{{r}}})\\}$ are real.  The spin\ndegeneracy is properly included in the numerical results in\nsection~\\ref{sec:numer}.\n\nThe HF theory requires solving the\nfollowing set of equations in a self-consistent fashion.\n\n", "index": 1, "text": "\\begin{equation}\n  \\begin{split}\n    &H\\left[\\{\\psi_{j}\\}\\right]\\psi_{i} = \\left(-\\frac12 \\Delta  +\n    {V_{\\mathrm{ion}}} +\n    V_{H}[\\rho] + V_{X}[\\{\\psi_{j}\\}]\\right)\\psi_{i} = \\varepsilon_{i} {\\psi}_{i},\\\\\n    &\\int {\\psi}^{*}_{i}({\\mathbf{{r}}}) {\\psi}_{j}({\\mathbf{{r}}}) {\\,\\mathrm{d}} {\\mathbf{{r}}} = \\delta_{ij},\n    \\quad\n    {\\rho}({\\mathbf{{r}}}) = \\sum_{i=1}^{N_e} \\left\\lvert{{\\psi}_{i}({\\mathbf{{r}}})}\\right\\rvert^2.\n  \\end{split}\n  \\label{eqn:HF}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"\\begin{split}&amp;\\displaystyle H\\left[\\{\\psi_{j}\\}\\right]\\psi_{i}=\\left(-\\frac{1}%&#10;{2}\\Delta+{V_{\\mathrm{ion}}}+V_{H}[\\rho]+V_{X}[\\{\\psi_{j}\\}]\\right)\\psi_{i}=%&#10;\\varepsilon_{i}{\\psi}_{i},\\\\&#10;&amp;\\displaystyle\\int{\\psi}^{*}_{i}({\\mathbf{{r}}}){\\psi}_{j}({\\mathbf{{r}}}){\\,%&#10;\\mathrm{d}}{\\mathbf{{r}}}=\\delta_{ij},\\quad{\\rho}({\\mathbf{{r}}})=\\sum_{i=1}^{%&#10;N_{e}}\\left\\lvert{{\\psi}_{i}({\\mathbf{{r}}})}\\right\\rvert^{2}.\\end{split}\" display=\"block\"><mtable columnspacing=\"0pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd/><mtd columnalign=\"left\"><mrow><mrow><mrow><mi>H</mi><mo>\u2062</mo><mrow><mo>[</mo><mrow><mo stretchy=\"false\">{</mo><msub><mi>\u03c8</mi><mi>j</mi></msub><mo stretchy=\"false\">}</mo></mrow><mo>]</mo></mrow><mo>\u2062</mo><msub><mi>\u03c8</mi><mi>i</mi></msub></mrow><mo>=</mo><mrow><mrow><mo>(</mo><mrow><mrow><mo>-</mo><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>\u2062</mo><mi mathvariant=\"normal\">\u0394</mi></mrow></mrow><mo>+</mo><msub><mi>V</mi><mi>ion</mi></msub><mo>+</mo><mrow><msub><mi>V</mi><mi>H</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>\u03c1</mi><mo stretchy=\"false\">]</mo></mrow></mrow><mo>+</mo><mrow><msub><mi>V</mi><mi>X</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mo stretchy=\"false\">{</mo><msub><mi>\u03c8</mi><mi>j</mi></msub><mo stretchy=\"false\">}</mo></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow><mo>)</mo></mrow><mo>\u2062</mo><msub><mi>\u03c8</mi><mi>i</mi></msub></mrow><mo>=</mo><mrow><msub><mi>\u03b5</mi><mi>i</mi></msub><mo>\u2062</mo><msub><mi>\u03c8</mi><mi>i</mi></msub></mrow></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mrow><mrow><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><msubsup><mi>\u03c8</mi><mi>i</mi><mo>*</mo></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>\u03c8</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>d</mo><mi>\ud835\udc2b</mi></mrow></mrow></mrow><mo>=</mo><msub><mi>\u03b4</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub></mrow><mo rspace=\"12.5pt\">,</mo><mrow><mrow><mi>\u03c1</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mi>e</mi></msub></munderover><msup><mrow><mo fence=\"true\">|</mo><mrow><msub><mi>\u03c8</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo fence=\"true\">|</mo></mrow><mn>2</mn></msup></mrow></mrow></mrow><mo>.</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.07159.tex", "nexttext": "\nThe exchange operator $V_{X}$ is a full rank, nonlocal operator, and depends on not only the density but also the occupied orbitals \n$\\{\\psi_{j}\\}_{j=1}^{N_{e}}$ as\n\n", "itemtype": "equation", "pos": 9722, "prevtext": "\nHere the eigenvalues $\\{\\varepsilon_{i}\\}$ are ordered non-decreasingly,\nand $N_e$ is the number of electrons.  ${V_{\\mathrm{ion}}}$ is a local potential\ncharacterizing the electron-ion interaction in all-electron\ncalculations. In pseudopotential\nor effective core potential calculations, ${V_{\\mathrm{ion}}}$ may contain a low rank and semi-local component as well. ${V_{\\mathrm{ion}}}$ is independent of the\nelectronic states $\\{\\psi_{i}\\}$. \n$\\rho({\\mathbf{{r}}})$ is the electron\ndensity. The Hartree potential is a local potential, and depends\nonly on the electron density as\n", "index": 3, "text": "\n\\[\n{V}_{H}[{\\rho}]({\\mathbf{{r}}},{\\mathbf{{r}}}')= \\delta({\\mathbf{{r}}}-{\\mathbf{{r}}}')\\int \\frac{\\rho({\\mathbf{{r}}}')}{\\left\\lvert{{\\mathbf{{r}}}-{\\mathbf{{r}}}'}\\right\\rvert} {\\,\\mathrm{d}}\n{\\mathbf{{r}}}' .\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"{V}_{H}[{\\rho}]({\\mathbf{{r}}},{\\mathbf{{r}}}^{\\prime})=\\delta({\\mathbf{{r}}}-%&#10;{\\mathbf{{r}}}^{\\prime})\\int\\frac{\\rho({\\mathbf{{r}}}^{\\prime})}{\\left\\lvert{{%&#10;\\mathbf{{r}}}-{\\mathbf{{r}}}^{\\prime}}\\right\\rvert}{\\,\\mathrm{d}}{\\mathbf{{r}}%&#10;}^{\\prime}.\" display=\"block\"><mrow><mrow><mrow><msub><mi>V</mi><mi>H</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>\u03c1</mi><mo stretchy=\"false\">]</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo>,</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mi>\u03b4</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc2b</mi><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mpadded width=\"+1.7pt\"><mfrac><mrow><mi>\u03c1</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mo fence=\"true\">|</mo><mrow><mi>\ud835\udc2b</mi><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow><mo fence=\"true\">|</mo></mrow></mfrac></mpadded><mo>\u2062</mo><mrow><mo>d</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.07159.tex", "nexttext": "\nHere $\\Gamma({\\mathbf{{r}}},{\\mathbf{{r}}}';\\{\\psi_{j}\\})=\\sum_{j=1}^{N_{e}} \\psi_{j}({\\mathbf{{r}}}) \\psi_{j}({\\mathbf{{r}}}')$\nis the single particle density matrix with an exact rank $N_e$.\nHowever, $V_X$ is not a low rank operator due to the dot product (i.e. the Hadamard product) between $\\Gamma$ and the Coulomb kernel.\nOne common way to solve the HF equations~{(\\ref{{eqn:HF}})} is to expand the\norbitals $\\{\\psi_{j}\\}_{j=1}^{N_{e}}$ using a small basis set\n$\\{\\chi_{\\mu}\\}_{\\mu=1}^{N_{\\mu}}$, such as Gaussian type orbitals, Slater type\norbitals and numerical atomic orbitals.\nThe basis set is small in the sense\nthat the ratio $N_{\\mu}/N_{e}$ is is a small constant (usually in the order of $10$).  This results in a Hamiltonian\nmatrix $H$ with reduced dimension $N_{\\mu}$. In order to compute the\nmatrix element of $H$, the four-center integral \n", "itemtype": "equation", "pos": 10105, "prevtext": "\nThe exchange operator $V_{X}$ is a full rank, nonlocal operator, and depends on not only the density but also the occupied orbitals \n$\\{\\psi_{j}\\}_{j=1}^{N_{e}}$ as\n\n", "index": 5, "text": "\\begin{equation}\n  V_{X}[\\{\\psi_{j}\\}]({\\mathbf{{r}}},{\\mathbf{{r}}}') = \n  -\\sum_{j=1}^{N_{e}} \n  \\frac{\\psi_{j}({\\mathbf{{r}}}) \\psi_{j}({\\mathbf{{r}}}')}{|{\\mathbf{{r}}}-{\\mathbf{{r}}}'|} \\equiv\n  -\\frac{\\Gamma({\\mathbf{{r}}},{\\mathbf{{r}}}';\\{\\psi_{j}\\})}{\\left\\lvert{{\\mathbf{{r}}}-{\\mathbf{{r}}}'}\\right\\rvert}.\n  \\label{eqn:VXkernel}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"V_{X}[\\{\\psi_{j}\\}]({\\mathbf{{r}}},{\\mathbf{{r}}}^{\\prime})=-\\sum_{j=1}^{N_{e}%&#10;}\\frac{\\psi_{j}({\\mathbf{{r}}})\\psi_{j}({\\mathbf{{r}}}^{\\prime})}{|{\\mathbf{{r%&#10;}}}-{\\mathbf{{r}}}^{\\prime}|}\\equiv-\\frac{\\Gamma({\\mathbf{{r}}},{\\mathbf{{r}}}%&#10;^{\\prime};\\{\\psi_{j}\\})}{\\left\\lvert{{\\mathbf{{r}}}-{\\mathbf{{r}}}^{\\prime}}%&#10;\\right\\rvert}.\" display=\"block\"><mrow><mrow><mrow><msub><mi>V</mi><mi>X</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mo stretchy=\"false\">{</mo><msub><mi>\u03c8</mi><mi>j</mi></msub><mo stretchy=\"false\">}</mo></mrow><mo stretchy=\"false\">]</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo>,</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo>-</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mi>e</mi></msub></munderover><mfrac><mrow><msub><mi>\u03c8</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>\u03c8</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mo stretchy=\"false\">|</mo><mrow><mi>\ud835\udc2b</mi><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow><mo stretchy=\"false\">|</mo></mrow></mfrac></mrow></mrow><mo>\u2261</mo><mrow><mo>-</mo><mfrac><mrow><mi mathvariant=\"normal\">\u0393</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo>,</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo>;</mo><mrow><mo stretchy=\"false\">{</mo><msub><mi>\u03c8</mi><mi>j</mi></msub><mo stretchy=\"false\">}</mo></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mo fence=\"true\">|</mo><mrow><mi>\ud835\udc2b</mi><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow><mo fence=\"true\">|</mo></mrow></mfrac></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.07159.tex", "nexttext": "\nneeds to be performed. The cost of the four-center integral is\n${\\mathcal{O}}(N_{\\mu}^{4})$. The quartic scaling becomes very expensive for systems of\nlarge sizes.\n\nFor a more complete basis set such as planewaves and finite elements, the\nconstant $N_{\\mu}/N_{e}$ is much larger (usually $1000$ or more), and the cost of forming all\nfour-center integrals is prohibitively expensive even for very small\nsystems. In such case, it is only viable to use an iterative algorithm,\nwhich only requires the application of $V_X$ to a number of orbitals, rather than the explicit construction of $V_X$. According to\nEq.~{(\\ref{{eqn:VXkernel}})}, $V_{X}$ applied to any orbital $\\psi$ can be\ncomputed as\n\n", "itemtype": "equation", "pos": 11317, "prevtext": "\nHere $\\Gamma({\\mathbf{{r}}},{\\mathbf{{r}}}';\\{\\psi_{j}\\})=\\sum_{j=1}^{N_{e}} \\psi_{j}({\\mathbf{{r}}}) \\psi_{j}({\\mathbf{{r}}}')$\nis the single particle density matrix with an exact rank $N_e$.\nHowever, $V_X$ is not a low rank operator due to the dot product (i.e. the Hadamard product) between $\\Gamma$ and the Coulomb kernel.\nOne common way to solve the HF equations~{(\\ref{{eqn:HF}})} is to expand the\norbitals $\\{\\psi_{j}\\}_{j=1}^{N_{e}}$ using a small basis set\n$\\{\\chi_{\\mu}\\}_{\\mu=1}^{N_{\\mu}}$, such as Gaussian type orbitals, Slater type\norbitals and numerical atomic orbitals.\nThe basis set is small in the sense\nthat the ratio $N_{\\mu}/N_{e}$ is is a small constant (usually in the order of $10$).  This results in a Hamiltonian\nmatrix $H$ with reduced dimension $N_{\\mu}$. In order to compute the\nmatrix element of $H$, the four-center integral \n", "index": 7, "text": "\n\\[\n\\iint\\frac{\\chi_{\\mu}({\\mathbf{{r}}})\\chi_{\\alpha}({\\mathbf{{r}}})\\chi_{\\beta}({\\mathbf{{r}}}')\\chi_{\\nu}({\\mathbf{{r}}}')}{|{\\mathbf{{r}}}-{\\mathbf{{r}}}'|}\n{\\,\\mathrm{d}} {\\mathbf{{r}}} {\\,\\mathrm{d}} {\\mathbf{{r}}}', \\quad \\alpha,\\beta,\\mu,\\nu=1,\\ldots,N_{\\mu}\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"\\iint\\frac{\\chi_{\\mu}({\\mathbf{{r}}})\\chi_{\\alpha}({\\mathbf{{r}}})\\chi_{\\beta}%&#10;({\\mathbf{{r}}}^{\\prime})\\chi_{\\nu}({\\mathbf{{r}}}^{\\prime})}{|{\\mathbf{{r}}}-%&#10;{\\mathbf{{r}}}^{\\prime}|}{\\,\\mathrm{d}}{\\mathbf{{r}}}{\\,\\mathrm{d}}{\\mathbf{{r%&#10;}}}^{\\prime},\\quad\\alpha,\\beta,\\mu,\\nu=1,\\ldots,N_{\\mu}\" display=\"block\"><mrow><mrow><mrow><mrow><mo largeop=\"true\" symmetric=\"true\">\u222c</mo><mrow><mpadded width=\"+1.7pt\"><mfrac><mrow><msub><mi>\u03c7</mi><mi>\u03bc</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>\u03c7</mi><mi>\u03b1</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>\u03c7</mi><mi>\u03b2</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>\u03c7</mi><mi>\u03bd</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mo stretchy=\"false\">|</mo><mrow><mi>\ud835\udc2b</mi><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow><mo stretchy=\"false\">|</mo></mrow></mfrac></mpadded><mo>\u2062</mo><mrow><mo>d</mo><mpadded width=\"+1.7pt\"><mi>\ud835\udc2b</mi></mpadded></mrow><mo>\u2062</mo><mrow><mo>d</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow></mrow></mrow><mo rspace=\"12.5pt\">,</mo><mi>\u03b1</mi><mo>,</mo><mi>\u03b2</mi><mo>,</mo><mi>\u03bc</mi><mo>,</mo><mi>\u03bd</mi></mrow><mo>=</mo><mn>1</mn></mrow><mo>,</mo><mrow><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><msub><mi>N</mi><mi>\u03bc</mi></msub></mrow></mrow></math>", "type": "latex"}, {"file": "1601.07159.tex", "nexttext": "\nEq.~{(\\ref{{eqn:applyVX}})} can be performed by solving $N_{e}$ Poisson type\nproblems with an effective charge of the form $\\psi_{j}({\\mathbf{{r}}}')\\psi({\\mathbf{{r}}}')$. For instance,\nin planewave calculations, if we denote by $N_{g}\\equiv N_{\\mu}$ the\ntotal number of planewaves, then the cost for solving each Poisson\nequation is\n${\\mathcal{O}}(N_{g}\\log N_{g})$ thanks to techniques such as the Fast Fourier Transform (FFT). Applying $V_{X}$ to all $\\psi_{i}$'s \nrequires the solution of $N_{e}^2$ Poisson problems, and the total cost is\n${\\mathcal{O}}(N_{g}\\log (N_{g})N_{e}^2)$.  The cubic scaling makes \niterative algorithms asymptotically less expensive\ncompared to  quartic scaling algorithms associated with the four-center integral\ncalculation. Therefore for large systems, iterative methods \ncan become attractive even for calculations  with\nsmall basis sets.\n\n\nThe HF equations need to be performed self-consistently until the output\norbitals $\\{\\psi_{j}\\}_{j=1}^{N_{e}}$ from Eq.~{(\\ref{{eqn:HF}})} agree with those provided as the input to the Hamiltonian operator. However, the Fock exchange energy is only a small fraction (usually less than $5\\%$) of the total energy, and it is more efficient \\textit{not} to update the exchange operator in each self-consistent field iteration. For instance, in planewave based electronic structure software packages such as Quantum ESPRESSO~\\cite{GiannozziBaroniBoniniEtAl2009}, the \nself-consistent field (SCF) iteration of all occupied orbitals can be separated into two\nsets of SCF iterations. In the inner SCF iteration, the orbitals\ndefining the exchange operator $V_X$ as in Eq.~{(\\ref{{eqn:VXkernel}})} are\nfixed, denoted by $\\{\\varphi_{i}\\}_{i=1}^{N_{e}}$. \nThen the matrix-vector multiplication of $V_{X}$ and an orbital $\\psi$ is given by\n\n", "itemtype": "equation", "pos": 12280, "prevtext": "\nneeds to be performed. The cost of the four-center integral is\n${\\mathcal{O}}(N_{\\mu}^{4})$. The quartic scaling becomes very expensive for systems of\nlarge sizes.\n\nFor a more complete basis set such as planewaves and finite elements, the\nconstant $N_{\\mu}/N_{e}$ is much larger (usually $1000$ or more), and the cost of forming all\nfour-center integrals is prohibitively expensive even for very small\nsystems. In such case, it is only viable to use an iterative algorithm,\nwhich only requires the application of $V_X$ to a number of orbitals, rather than the explicit construction of $V_X$. According to\nEq.~{(\\ref{{eqn:VXkernel}})}, $V_{X}$ applied to any orbital $\\psi$ can be\ncomputed as\n\n", "index": 9, "text": "\\begin{equation}\n  \\left(V_{X}[\\{\\psi_{j}\\}]\\psi\\right)({\\mathbf{{r}}}) = \n  -\\sum_{j=1}^{N_{e}} \\psi_{j}({\\mathbf{{r}}}) \\int\n  \\frac{ \\psi_{j}({\\mathbf{{r}}}')\\psi({\\mathbf{{r}}}')}{|{\\mathbf{{r}}}-{\\mathbf{{r}}}'|} {\\,\\mathrm{d}} {\\mathbf{{r}}}'.\n  \\label{eqn:applyVX}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"\\left(V_{X}[\\{\\psi_{j}\\}]\\psi\\right)({\\mathbf{{r}}})=-\\sum_{j=1}^{N_{e}}\\psi_{%&#10;j}({\\mathbf{{r}}})\\int\\frac{\\psi_{j}({\\mathbf{{r}}}^{\\prime})\\psi({\\mathbf{{r}%&#10;}}^{\\prime})}{|{\\mathbf{{r}}}-{\\mathbf{{r}}}^{\\prime}|}{\\,\\mathrm{d}}{\\mathbf{%&#10;{r}}}^{\\prime}.\" display=\"block\"><mrow><mrow><mrow><mrow><mo>(</mo><mrow><msub><mi>V</mi><mi>X</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mo stretchy=\"false\">{</mo><msub><mi>\u03c8</mi><mi>j</mi></msub><mo stretchy=\"false\">}</mo></mrow><mo stretchy=\"false\">]</mo></mrow><mo>\u2062</mo><mi>\u03c8</mi></mrow><mo>)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo>-</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mi>e</mi></msub></munderover><mrow><msub><mi>\u03c8</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mpadded width=\"+1.7pt\"><mfrac><mrow><msub><mi>\u03c8</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>\u03c8</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mo stretchy=\"false\">|</mo><mrow><mi>\ud835\udc2b</mi><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow><mo stretchy=\"false\">|</mo></mrow></mfrac></mpadded><mo>\u2062</mo><mrow><mo>d</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.07159.tex", "nexttext": "\nWith $V_X$ fixed, the Hamiltonian operator only depends on the electron\ndensity $\\rho$, which needs to\nbe updated in the inner SCF iteration. This allows standard charge mixing\nschemes, such as Anderson acceleration~\\cite{Anderson1965} and Pulay\nmixing~\\cite{Pulay1980} to be used to converge the electron density efficiently. Note\nthat similar techniques to mix the density matrix directly can be\nprohibitively expensive for large basis sets. \n\n\n\n\nOnce the inner SCF for the electron density is converged, the\noutput orbitals can simply then be used as the input orbitals to update\nthe exchange operator. The outer SCF iteration continues until\nconvergence is reached. The convergence of the outer iteration can be\nmonitored by the convergence of the Fock exchange energy, defined as\n\n", "itemtype": "equation", "pos": 14372, "prevtext": "\nEq.~{(\\ref{{eqn:applyVX}})} can be performed by solving $N_{e}$ Poisson type\nproblems with an effective charge of the form $\\psi_{j}({\\mathbf{{r}}}')\\psi({\\mathbf{{r}}}')$. For instance,\nin planewave calculations, if we denote by $N_{g}\\equiv N_{\\mu}$ the\ntotal number of planewaves, then the cost for solving each Poisson\nequation is\n${\\mathcal{O}}(N_{g}\\log N_{g})$ thanks to techniques such as the Fast Fourier Transform (FFT). Applying $V_{X}$ to all $\\psi_{i}$'s \nrequires the solution of $N_{e}^2$ Poisson problems, and the total cost is\n${\\mathcal{O}}(N_{g}\\log (N_{g})N_{e}^2)$.  The cubic scaling makes \niterative algorithms asymptotically less expensive\ncompared to  quartic scaling algorithms associated with the four-center integral\ncalculation. Therefore for large systems, iterative methods \ncan become attractive even for calculations  with\nsmall basis sets.\n\n\nThe HF equations need to be performed self-consistently until the output\norbitals $\\{\\psi_{j}\\}_{j=1}^{N_{e}}$ from Eq.~{(\\ref{{eqn:HF}})} agree with those provided as the input to the Hamiltonian operator. However, the Fock exchange energy is only a small fraction (usually less than $5\\%$) of the total energy, and it is more efficient \\textit{not} to update the exchange operator in each self-consistent field iteration. For instance, in planewave based electronic structure software packages such as Quantum ESPRESSO~\\cite{GiannozziBaroniBoniniEtAl2009}, the \nself-consistent field (SCF) iteration of all occupied orbitals can be separated into two\nsets of SCF iterations. In the inner SCF iteration, the orbitals\ndefining the exchange operator $V_X$ as in Eq.~{(\\ref{{eqn:VXkernel}})} are\nfixed, denoted by $\\{\\varphi_{i}\\}_{i=1}^{N_{e}}$. \nThen the matrix-vector multiplication of $V_{X}$ and an orbital $\\psi$ is given by\n\n", "index": 11, "text": "\\begin{equation}\n  \\left(V_{X}[\\{\\varphi_{j}\\}]\\psi\\right)({\\mathbf{{r}}}) = \n  -\\sum_{j=1}^{N_{e}} \\varphi_{j}({\\mathbf{{r}}}) \\int\n  \\frac{ \\varphi_{j}({\\mathbf{{r}}}')\\psi({\\mathbf{{r}}}')}{|{\\mathbf{{r}}}-{\\mathbf{{r}}}'|} {\\,\\mathrm{d}} {\\mathbf{{r}}}'.\n  \\label{eqn:applyVX2}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"\\left(V_{X}[\\{\\varphi_{j}\\}]\\psi\\right)({\\mathbf{{r}}})=-\\sum_{j=1}^{N_{e}}%&#10;\\varphi_{j}({\\mathbf{{r}}})\\int\\frac{\\varphi_{j}({\\mathbf{{r}}}^{\\prime})\\psi(%&#10;{\\mathbf{{r}}}^{\\prime})}{|{\\mathbf{{r}}}-{\\mathbf{{r}}}^{\\prime}|}{\\,\\mathrm{%&#10;d}}{\\mathbf{{r}}}^{\\prime}.\" display=\"block\"><mrow><mrow><mrow><mrow><mo>(</mo><mrow><msub><mi>V</mi><mi>X</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mo stretchy=\"false\">{</mo><msub><mi>\u03c6</mi><mi>j</mi></msub><mo stretchy=\"false\">}</mo></mrow><mo stretchy=\"false\">]</mo></mrow><mo>\u2062</mo><mi>\u03c8</mi></mrow><mo>)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo>-</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mi>e</mi></msub></munderover><mrow><msub><mi>\u03c6</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mpadded width=\"+1.7pt\"><mfrac><mrow><msub><mi>\u03c6</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>\u03c8</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mo stretchy=\"false\">|</mo><mrow><mi>\ud835\udc2b</mi><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow><mo stretchy=\"false\">|</mo></mrow></mfrac></mpadded><mo>\u2062</mo><mrow><mo>d</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.07159.tex", "nexttext": "\n\nIn each inner SCF iteration, with both $\\rho$ and $\\varphi_i$'s fixed, the Hamiltonian operator $H$ becomes a linear operator, and the linear eigenvalue problem\n\n", "itemtype": "equation", "pos": 15454, "prevtext": "\nWith $V_X$ fixed, the Hamiltonian operator only depends on the electron\ndensity $\\rho$, which needs to\nbe updated in the inner SCF iteration. This allows standard charge mixing\nschemes, such as Anderson acceleration~\\cite{Anderson1965} and Pulay\nmixing~\\cite{Pulay1980} to be used to converge the electron density efficiently. Note\nthat similar techniques to mix the density matrix directly can be\nprohibitively expensive for large basis sets. \n\n\n\n\nOnce the inner SCF for the electron density is converged, the\noutput orbitals can simply then be used as the input orbitals to update\nthe exchange operator. The outer SCF iteration continues until\nconvergence is reached. The convergence of the outer iteration can be\nmonitored by the convergence of the Fock exchange energy, defined as\n\n", "index": 13, "text": "\\begin{equation}\n  \\label{eqn:EX}\n  E_{X}^{HF} = -\\frac{1}{2} \\sum_{i,j=1}^{N_e} \\iint\n  \\psi_{i}({\\mathbf{{r}}})\\psi_{j}({\\mathbf{{r}}}) \\psi_{j}({\\mathbf{{r}}}')\n  \\psi_{i}({\\mathbf{{r}}}')\\frac{1}{|{\\mathbf{{r}}}-{\\mathbf{{r}}}'|} {\\,\\mathrm{d}} {\\mathbf{{r}}} {\\,\\mathrm{d}} {\\mathbf{{r}}}'. \n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"E_{X}^{HF}=-\\frac{1}{2}\\sum_{i,j=1}^{N_{e}}\\iint\\psi_{i}({\\mathbf{{r}}})\\psi_{%&#10;j}({\\mathbf{{r}}})\\psi_{j}({\\mathbf{{r}}}^{\\prime})\\psi_{i}({\\mathbf{{r}}}^{%&#10;\\prime})\\frac{1}{|{\\mathbf{{r}}}-{\\mathbf{{r}}}^{\\prime}|}{\\,\\mathrm{d}}{%&#10;\\mathbf{{r}}}{\\,\\mathrm{d}}{\\mathbf{{r}}}^{\\prime}.\" display=\"block\"><mrow><mrow><msubsup><mi>E</mi><mi>X</mi><mrow><mi>H</mi><mo>\u2062</mo><mi>F</mi></mrow></msubsup><mo>=</mo><mrow><mo>-</mo><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mi>e</mi></msub></munderover><mrow><mo largeop=\"true\" symmetric=\"true\">\u222c</mo><mrow><msub><mi>\u03c8</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>\u03c8</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>\u03c8</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>\u03c8</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mpadded width=\"+1.7pt\"><mfrac><mn>1</mn><mrow><mo stretchy=\"false\">|</mo><mrow><mi>\ud835\udc2b</mi><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow><mo stretchy=\"false\">|</mo></mrow></mfrac></mpadded><mo>\u2062</mo><mrow><mo>d</mo><mpadded width=\"+1.7pt\"><mi>\ud835\udc2b</mi></mpadded></mrow><mo>\u2062</mo><mrow><mo>d</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.07159.tex", "nexttext": "\nneeds to be solved. The linear eigenvalue problem can be solved \nwith iterative algorithms such as the Davidson\nmethod~\\cite{Davidson1975} and the\nlocally optimal block preconditioned conjugated gradient (LOBPCG)\nmethod~\\cite{Knyazev2001}.  Alg.~\\ref{alg:fock} describes the pseudocode\nof using iterative methods to solve Hartree-Fock-like equations.\n\n\\begin{algorithm}[htbp]\n\\begin{center}\n  \\begin{minipage}{5in}\n\\begin{algorithmic}[1]\n  \\WHILE{exchange energy is not converged}\n  \\WHILE{electron density $\\rho$ is not converged}\n  \\STATE Solve the linear eigenvalue problem~{(\\ref{{eqn:HFlineig}})} with iterative schemes.\n  \\STATE Update $\\rho^{out}({\\mathbf{{r}}})\\gets \\sum_{i=1}^{N_e}\n  \\left\\lvert{{\\psi}_{i}({\\mathbf{{r}}})}\\right\\rvert^2$.\n  \\STATE Update $\\rho$ using $\\rho^{out}$ and possibly previous history of $\\rho$ with charge mixing schemes.\n  \\ENDWHILE\n  \\STATE Compute the exchange energy $E_{X}$.\n  \\STATE Update $\\{\\varphi_{j}\\}_{j=1}^{N_{e}}\\gets\n  \\{\\psi_{j}\\}_{j=1}^{N_{e}}$.\n  \\ENDWHILE\n\\end{algorithmic}\n\\end{minipage}\n\\end{center}\n\\caption{Iterative methods for solving Hartree-Fock-like\nequations.}\n\\label{alg:fock}\n\\end{algorithm}\n\nSo far our discussion focuses on the Hartree-Fock theory. For KSDFT calculations with hybrid functionals, such as the PBE0 functional~\\cite{PerdewErnzerhofBurke1996}, the exchange-correlation energy is\n\n", "itemtype": "equation", "pos": 15928, "prevtext": "\n\nIn each inner SCF iteration, with both $\\rho$ and $\\varphi_i$'s fixed, the Hamiltonian operator $H$ becomes a linear operator, and the linear eigenvalue problem\n\n", "index": 15, "text": "\\begin{equation}\n   (-\\frac12 \\Delta  + {V_{\\mathrm{ion}}} + V_{H}[\\rho] + V_{X}[\n   \\{\\varphi_{j}\\}])\\psi_{i} = \\varepsilon_i \\psi_i\n  \\label{eqn:HFlineig}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"(-\\frac{1}{2}\\Delta+{V_{\\mathrm{ion}}}+V_{H}[\\rho]+V_{X}[\\{\\varphi_{j}\\}])\\psi%&#10;_{i}=\\varepsilon_{i}\\psi_{i}\" display=\"block\"><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mo>-</mo><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>\u2062</mo><mi mathvariant=\"normal\">\u0394</mi></mrow></mrow><mo>+</mo><msub><mi>V</mi><mi>ion</mi></msub><mo>+</mo><mrow><msub><mi>V</mi><mi>H</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>\u03c1</mi><mo stretchy=\"false\">]</mo></mrow></mrow><mo>+</mo><mrow><msub><mi>V</mi><mi>X</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mo stretchy=\"false\">{</mo><msub><mi>\u03c6</mi><mi>j</mi></msub><mo stretchy=\"false\">}</mo></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>\u03c8</mi><mi>i</mi></msub></mrow><mo>=</mo><mrow><msub><mi>\u03b5</mi><mi>i</mi></msub><mo>\u2062</mo><msub><mi>\u03c8</mi><mi>i</mi></msub></mrow></mrow></math>", "type": "latex"}, {"file": "1601.07159.tex", "nexttext": "\nHere $E_X^{PBE}$ and $E_{c}^{PBE}$ are the exchange and correlation part of the energy from the GGA-type  \nPerdew-Burke-Ernzerhof (PBE) functional~\\cite{PerdewBurkeErnzerhof1996},\nrespectively. Hence the corresponding exchange operator $V_X^{PBE0}$ is\nsimply given by $1/4$ of the exchange operator defined in\nEq.~{(\\ref{{eqn:VXkernel}})}. For exchange-correlation functionals with screened exchange interactions such as the HSE functional~\\cite{HeydScuseriaErnzerhof2003}, the exchange-correlation energy is\n\n", "itemtype": "equation", "pos": 17464, "prevtext": "\nneeds to be solved. The linear eigenvalue problem can be solved \nwith iterative algorithms such as the Davidson\nmethod~\\cite{Davidson1975} and the\nlocally optimal block preconditioned conjugated gradient (LOBPCG)\nmethod~\\cite{Knyazev2001}.  Alg.~\\ref{alg:fock} describes the pseudocode\nof using iterative methods to solve Hartree-Fock-like equations.\n\n\\begin{algorithm}[htbp]\n\\begin{center}\n  \\begin{minipage}{5in}\n\\begin{algorithmic}[1]\n  \\WHILE{exchange energy is not converged}\n  \\WHILE{electron density $\\rho$ is not converged}\n  \\STATE Solve the linear eigenvalue problem~{(\\ref{{eqn:HFlineig}})} with iterative schemes.\n  \\STATE Update $\\rho^{out}({\\mathbf{{r}}})\\gets \\sum_{i=1}^{N_e}\n  \\left\\lvert{{\\psi}_{i}({\\mathbf{{r}}})}\\right\\rvert^2$.\n  \\STATE Update $\\rho$ using $\\rho^{out}$ and possibly previous history of $\\rho$ with charge mixing schemes.\n  \\ENDWHILE\n  \\STATE Compute the exchange energy $E_{X}$.\n  \\STATE Update $\\{\\varphi_{j}\\}_{j=1}^{N_{e}}\\gets\n  \\{\\psi_{j}\\}_{j=1}^{N_{e}}$.\n  \\ENDWHILE\n\\end{algorithmic}\n\\end{minipage}\n\\end{center}\n\\caption{Iterative methods for solving Hartree-Fock-like\nequations.}\n\\label{alg:fock}\n\\end{algorithm}\n\nSo far our discussion focuses on the Hartree-Fock theory. For KSDFT calculations with hybrid functionals, such as the PBE0 functional~\\cite{PerdewErnzerhofBurke1996}, the exchange-correlation energy is\n\n", "index": 17, "text": "\\begin{equation}\nE_{xc}^{PBE0} = \\frac{1}{4} E_X^{HF} + \\frac{3}{4} E_X^{PBE} + E_{c}^{PBE}. \n\\label{eqn:ExPBE0}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"E_{xc}^{PBE0}=\\frac{1}{4}E_{X}^{HF}+\\frac{3}{4}E_{X}^{PBE}+E_{c}^{PBE}.\" display=\"block\"><mrow><mrow><msubsup><mi>E</mi><mrow><mi>x</mi><mo>\u2062</mo><mi>c</mi></mrow><mrow><mi>P</mi><mo>\u2062</mo><mi>B</mi><mo>\u2062</mo><mi>E</mi><mo>\u2062</mo><mn>0</mn></mrow></msubsup><mo>=</mo><mrow><mrow><mfrac><mn>1</mn><mn>4</mn></mfrac><mo>\u2062</mo><msubsup><mi>E</mi><mi>X</mi><mrow><mi>H</mi><mo>\u2062</mo><mi>F</mi></mrow></msubsup></mrow><mo>+</mo><mrow><mfrac><mn>3</mn><mn>4</mn></mfrac><mo>\u2062</mo><msubsup><mi>E</mi><mi>X</mi><mrow><mi>P</mi><mo>\u2062</mo><mi>B</mi><mo>\u2062</mo><mi>E</mi></mrow></msubsup></mrow><mo>+</mo><msubsup><mi>E</mi><mi>c</mi><mrow><mi>P</mi><mo>\u2062</mo><mi>B</mi><mo>\u2062</mo><mi>E</mi></mrow></msubsup></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.07159.tex", "nexttext": "\nHere $E_X^{PBE,SR}$ and $E_X^{PBE,LR}$ refers to short range and long range part of the exchange contribution in the PBE functional, respectively. $E_X^{SR}$ is the short range part of the Fock exchange energy, defined as\n\n", "itemtype": "equation", "pos": 18101, "prevtext": "\nHere $E_X^{PBE}$ and $E_{c}^{PBE}$ are the exchange and correlation part of the energy from the GGA-type  \nPerdew-Burke-Ernzerhof (PBE) functional~\\cite{PerdewBurkeErnzerhof1996},\nrespectively. Hence the corresponding exchange operator $V_X^{PBE0}$ is\nsimply given by $1/4$ of the exchange operator defined in\nEq.~{(\\ref{{eqn:VXkernel}})}. For exchange-correlation functionals with screened exchange interactions such as the HSE functional~\\cite{HeydScuseriaErnzerhof2003}, the exchange-correlation energy is\n\n", "index": 19, "text": "\\begin{equation}\nE_{xc}^{HSE}(\\mu) = \\frac{1}{4} E_X^{SR}(\\mu) + \\frac{3}{4} E_X^{PBE,SR}(\\mu) + E_X^{PBE,LR} + E_{c}^{PBE}. \n\\label{eqn:ExHSE}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m1\" class=\"ltx_Math\" alttext=\"E_{xc}^{HSE}(\\mu)=\\frac{1}{4}E_{X}^{SR}(\\mu)+\\frac{3}{4}E_{X}^{PBE,SR}(\\mu)+E_%&#10;{X}^{PBE,LR}+E_{c}^{PBE}.\" display=\"block\"><mrow><mrow><mrow><msubsup><mi>E</mi><mrow><mi>x</mi><mo>\u2062</mo><mi>c</mi></mrow><mrow><mi>H</mi><mo>\u2062</mo><mi>S</mi><mo>\u2062</mo><mi>E</mi></mrow></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03bc</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mfrac><mn>1</mn><mn>4</mn></mfrac><mo>\u2062</mo><msubsup><mi>E</mi><mi>X</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>R</mi></mrow></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03bc</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mfrac><mn>3</mn><mn>4</mn></mfrac><mo>\u2062</mo><msubsup><mi>E</mi><mi>X</mi><mrow><mrow><mi>P</mi><mo>\u2062</mo><mi>B</mi><mo>\u2062</mo><mi>E</mi></mrow><mo>,</mo><mrow><mi>S</mi><mo>\u2062</mo><mi>R</mi></mrow></mrow></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03bc</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><msubsup><mi>E</mi><mi>X</mi><mrow><mrow><mi>P</mi><mo>\u2062</mo><mi>B</mi><mo>\u2062</mo><mi>E</mi></mrow><mo>,</mo><mrow><mi>L</mi><mo>\u2062</mo><mi>R</mi></mrow></mrow></msubsup><mo>+</mo><msubsup><mi>E</mi><mi>c</mi><mrow><mi>P</mi><mo>\u2062</mo><mi>B</mi><mo>\u2062</mo><mi>E</mi></mrow></msubsup></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.07159.tex", "nexttext": "\nHere $\\mathrm{erfc}$ is the complementary error function, and $\\mu$ is\nan adjustable parameter to control the screening length of the short\nrange part of the Fock exchange interaction. The only change is to\nreplace the Coulomb kernel by the screened Coulomb kernel, and the screened Coulomb kernel should be used\nto define the exchange operator $V_X^{HSE}$ accordingly.\n\n\n\\section{Adaptively compressed exchange operator}\\label{sec:ace}\n\nThe most expensive step of Alg.~\\ref{alg:fock} is the matrix-vector\nmultiplication between the Fock operator $V_X$ and all occupied\norbitals. Each set of such matrix-vector multiplication amounts to the\nsolution of $N_{e}^2$ Poisson equations. This needs to be done for each\niteration step when solving the linear eigenvalue problem~{(\\ref{{eqn:HFlineig}})},\nand in each inner SCF iteration for updating the electron density.\n\n\n\n\nIn order to reduce the computational cost, it is desirable to use a low rank decomposition to approximate the Fock exchange operator $V_X$. \n\n\n\n\nHowever, the exchange operator is a full rank operator, and a compressed\nrepresentation, such as the singular value decomposition (SVD), can\nlead to inaccurate results.  However, note that the goal of a singular value decomposition of is to find\nan effective operator, denoted by ${\\widetilde{{V}}}_{X}$, so that the discrepancy\nmeasured by \n$\\left\\lVert{V_{X}\\psi - {\\widetilde{{V}}}_{X}\\psi}\\right\\rVert_{2}$ is\nsmall for \\textit{any\norbital} $\\psi$. The key observation of the adaptively compressed\nexchange operator (ACE) is that the condition above, while desirable, is\nnot necessary to solve Hartree-Fock-like \nequations. In fact, it is sufficient to construct ${\\widetilde{{V}}}_{X}$\nsuch that $\\left\\lVert{V_{X}\\psi-{\\widetilde{{V}}}_{X}\\psi}\\right\\rVert_{2}$ is small when $\\psi$ is\n\\textit{any occupied orbital}, which spans a subspace of strict rank $N_e$. \nIn this sense, the ACE is designed to be adaptive to the occupied orbitals. \nWhen self-consistency of the occupied orbitals is reached, the physical\nquantities computed in the ACE formulation is exactly the same as\nthat obtained with standard methods for solving Hartree-Fock-like\nequations.\n\nMore specifically, in each outer iteration, for a \ngiven set of orbitals $\\{\\varphi_{i}\\}_{i=1}^{N_{e}}$, we first compute\n\n", "itemtype": "equation", "pos": 18482, "prevtext": "\nHere $E_X^{PBE,SR}$ and $E_X^{PBE,LR}$ refers to short range and long range part of the exchange contribution in the PBE functional, respectively. $E_X^{SR}$ is the short range part of the Fock exchange energy, defined as\n\n", "index": 21, "text": "\\begin{equation}\n  \\label{eqn:EXSR}\n  E_{X}^{SR}(\\mu) = -\\frac{1}{2} \\sum_{i,j=1}^{N_e} \\iint\n  \\psi_{i}({\\mathbf{{r}}})\\psi_{j}({\\mathbf{{r}}}) \\psi_{j}({\\mathbf{{r}}}')\n  \\psi_{i}({\\mathbf{{r}}}')\\frac{\\mathrm{erfc}(\\mu(|{\\mathbf{{r}}}-{\\mathbf{{r}}}'|))}{|{\\mathbf{{r}}}-{\\mathbf{{r}}}'|} {\\,\\mathrm{d}} {\\mathbf{{r}}} {\\,\\mathrm{d}} {\\mathbf{{r}}}'. \n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m1\" class=\"ltx_Math\" alttext=\"E_{X}^{SR}(\\mu)=-\\frac{1}{2}\\sum_{i,j=1}^{N_{e}}\\iint\\psi_{i}({\\mathbf{{r}}})%&#10;\\psi_{j}({\\mathbf{{r}}})\\psi_{j}({\\mathbf{{r}}}^{\\prime})\\psi_{i}({\\mathbf{{r}%&#10;}}^{\\prime})\\frac{\\mathrm{erfc}(\\mu(|{\\mathbf{{r}}}-{\\mathbf{{r}}}^{\\prime}|))%&#10;}{|{\\mathbf{{r}}}-{\\mathbf{{r}}}^{\\prime}|}{\\,\\mathrm{d}}{\\mathbf{{r}}}{\\,%&#10;\\mathrm{d}}{\\mathbf{{r}}}^{\\prime}.\" display=\"block\"><mrow><mrow><mrow><msubsup><mi>E</mi><mi>X</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>R</mi></mrow></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03bc</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo>-</mo><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mi>e</mi></msub></munderover><mrow><mo largeop=\"true\" symmetric=\"true\">\u222c</mo><mrow><msub><mi>\u03c8</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>\u03c8</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>\u03c8</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>\u03c8</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mpadded width=\"+1.7pt\"><mfrac><mrow><mi>erfc</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03bc</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo stretchy=\"false\">|</mo><mrow><mi>\ud835\udc2b</mi><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow><mo stretchy=\"false\">|</mo></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mo stretchy=\"false\">|</mo><mrow><mi>\ud835\udc2b</mi><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow><mo stretchy=\"false\">|</mo></mrow></mfrac></mpadded><mo>\u2062</mo><mrow><mo>d</mo><mpadded width=\"+1.7pt\"><mi>\ud835\udc2b</mi></mpadded></mrow><mo>\u2062</mo><mrow><mo>d</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.07159.tex", "nexttext": "\nThe adaptively compressed exchange operator, denoted by ${V_{X}^{\\mathrm{ACE}}}$, should satisfy the conditions\n\n", "itemtype": "equation", "pos": 21150, "prevtext": "\nHere $\\mathrm{erfc}$ is the complementary error function, and $\\mu$ is\nan adjustable parameter to control the screening length of the short\nrange part of the Fock exchange interaction. The only change is to\nreplace the Coulomb kernel by the screened Coulomb kernel, and the screened Coulomb kernel should be used\nto define the exchange operator $V_X^{HSE}$ accordingly.\n\n\n\\section{Adaptively compressed exchange operator}\\label{sec:ace}\n\nThe most expensive step of Alg.~\\ref{alg:fock} is the matrix-vector\nmultiplication between the Fock operator $V_X$ and all occupied\norbitals. Each set of such matrix-vector multiplication amounts to the\nsolution of $N_{e}^2$ Poisson equations. This needs to be done for each\niteration step when solving the linear eigenvalue problem~{(\\ref{{eqn:HFlineig}})},\nand in each inner SCF iteration for updating the electron density.\n\n\n\n\nIn order to reduce the computational cost, it is desirable to use a low rank decomposition to approximate the Fock exchange operator $V_X$. \n\n\n\n\nHowever, the exchange operator is a full rank operator, and a compressed\nrepresentation, such as the singular value decomposition (SVD), can\nlead to inaccurate results.  However, note that the goal of a singular value decomposition of is to find\nan effective operator, denoted by ${\\widetilde{{V}}}_{X}$, so that the discrepancy\nmeasured by \n$\\left\\lVert{V_{X}\\psi - {\\widetilde{{V}}}_{X}\\psi}\\right\\rVert_{2}$ is\nsmall for \\textit{any\norbital} $\\psi$. The key observation of the adaptively compressed\nexchange operator (ACE) is that the condition above, while desirable, is\nnot necessary to solve Hartree-Fock-like \nequations. In fact, it is sufficient to construct ${\\widetilde{{V}}}_{X}$\nsuch that $\\left\\lVert{V_{X}\\psi-{\\widetilde{{V}}}_{X}\\psi}\\right\\rVert_{2}$ is small when $\\psi$ is\n\\textit{any occupied orbital}, which spans a subspace of strict rank $N_e$. \nIn this sense, the ACE is designed to be adaptive to the occupied orbitals. \nWhen self-consistency of the occupied orbitals is reached, the physical\nquantities computed in the ACE formulation is exactly the same as\nthat obtained with standard methods for solving Hartree-Fock-like\nequations.\n\nMore specifically, in each outer iteration, for a \ngiven set of orbitals $\\{\\varphi_{i}\\}_{i=1}^{N_{e}}$, we first compute\n\n", "index": 23, "text": "\\begin{equation}\n  W_{i}({\\mathbf{{r}}}) = (V_{X}[\\{\\varphi\\}]\\varphi_{i})({\\mathbf{{r}}}), \\quad\n  i=1,\\ldots,N_{e}.\n  \\label{eqn:W}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E10.m1\" class=\"ltx_Math\" alttext=\"W_{i}({\\mathbf{{r}}})=(V_{X}[\\{\\varphi\\}]\\varphi_{i})({\\mathbf{{r}}}),\\quad i=%&#10;1,\\ldots,N_{e}.\" display=\"block\"><mrow><mrow><mrow><mrow><msub><mi>W</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>V</mi><mi>X</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mo stretchy=\"false\">{</mo><mi>\u03c6</mi><mo stretchy=\"false\">}</mo></mrow><mo stretchy=\"false\">]</mo></mrow><mo>\u2062</mo><msub><mi>\u03c6</mi><mi>i</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo rspace=\"12.5pt\">,</mo><mrow><mi>i</mi><mo>=</mo><mrow><mn>1</mn><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><msub><mi>N</mi><mi>e</mi></msub></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.07159.tex", "nexttext": "\nOne possible choice to satisfy both conditions in\nEq.~{(\\ref{{eqn:ACEcond}})} is\n\n", "itemtype": "equation", "pos": 21411, "prevtext": "\nThe adaptively compressed exchange operator, denoted by ${V_{X}^{\\mathrm{ACE}}}$, should satisfy the conditions\n\n", "index": 25, "text": "\\begin{equation}\n  ({V_{X}^{\\mathrm{ACE}}} \\varphi_{i})({\\mathbf{{r}}}) = W_{i}({\\mathbf{{r}}}), \\quad\n   \\mbox{and} \\quad\n  {V_{X}^{\\mathrm{ACE}}}({\\mathbf{{r}}},{\\mathbf{{r}}}') = {V_{X}^{\\mathrm{ACE}}}({\\mathbf{{r}}}',{\\mathbf{{r}}}).\n  \\label{eqn:ACEcond}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E11.m1\" class=\"ltx_Math\" alttext=\"({V_{X}^{\\mathrm{ACE}}}\\varphi_{i})({\\mathbf{{r}}})=W_{i}({\\mathbf{{r}}}),%&#10;\\quad\\mbox{and}\\quad{V_{X}^{\\mathrm{ACE}}}({\\mathbf{{r}}},{\\mathbf{{r}}}^{%&#10;\\prime})={V_{X}^{\\mathrm{ACE}}}({\\mathbf{{r}}}^{\\prime},{\\mathbf{{r}}}).\" display=\"block\"><mrow><mrow><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msubsup><mi>V</mi><mi>X</mi><mi>ACE</mi></msubsup><mo>\u2062</mo><msub><mi>\u03c6</mi><mi>i</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msub><mi>W</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo rspace=\"12.5pt\">,</mo><mtext>and</mtext></mrow></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003</mo><mrow><mrow><msubsup><mi>V</mi><mi>X</mi><mi>ACE</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo>,</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><msubsup><mi>V</mi><mi>X</mi><mi>ACE</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo>,</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.07159.tex", "nexttext": "\nwhere $B$ is a negative semidefinite matrix to be determined, since $V_{X}$ is a negative semidefinite operator.\nIn order to determine\nthe matrix $B$, for any $k,l=1,\\ldots,N_{e}$, we require\n\n", "itemtype": "equation", "pos": 21767, "prevtext": "\nOne possible choice to satisfy both conditions in\nEq.~{(\\ref{{eqn:ACEcond}})} is\n\n", "index": 27, "text": "\\begin{equation}\n  {V_{X}^{\\mathrm{ACE}}}({\\mathbf{{r}}},{\\mathbf{{r}}}') = \\sum_{i,j=1}^{N_{e}} W_{i}({\\mathbf{{r}}})\n  B_{ij} W_{j}({\\mathbf{{r}}}'),\n  \\label{eqn:ACEconstruct1}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E12.m1\" class=\"ltx_Math\" alttext=\"{V_{X}^{\\mathrm{ACE}}}({\\mathbf{{r}}},{\\mathbf{{r}}}^{\\prime})=\\sum_{i,j=1}^{N%&#10;_{e}}W_{i}({\\mathbf{{r}}})B_{ij}W_{j}({\\mathbf{{r}}}^{\\prime}),\" display=\"block\"><mrow><mrow><mrow><msubsup><mi>V</mi><mi>X</mi><mi>ACE</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo>,</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mi>e</mi></msub></munderover><mrow><msub><mi>W</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>B</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><msub><mi>W</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.07159.tex", "nexttext": "\nDefine \n$M_{kl} = \\int \\varphi_{k}({\\mathbf{{r}}}) W_{l}({\\mathbf{{r}}}) {\\,\\mathrm{d}} {\\mathbf{{r}}}$,\nthen by Eq.~{(\\ref{{eqn:W}})}, $M$ is a negative semidefinite matrix of size\n$N_{e}$.\nEq.~{(\\ref{{eqn:ACEconstruct2}})} can be simplified using matrix notation as\n", "itemtype": "equation", "pos": 22154, "prevtext": "\nwhere $B$ is a negative semidefinite matrix to be determined, since $V_{X}$ is a negative semidefinite operator.\nIn order to determine\nthe matrix $B$, for any $k,l=1,\\ldots,N_{e}$, we require\n\n", "index": 29, "text": "\\begin{multline}\n  \\iint \\varphi_{k}({\\mathbf{{r}}}) {V_{X}^{\\mathrm{ACE}}}({\\mathbf{{r}}},{\\mathbf{{r}}}') \\varphi_{l}({\\mathbf{{r}}}') {\\,\\mathrm{d}} {\\mathbf{{r}}}\n  {\\,\\mathrm{d}} {\\mathbf{{r}}}' \\equiv \\int \\varphi_{k}({\\mathbf{{r}}}) W_{l}({\\mathbf{{r}}}) {\\,\\mathrm{d}} {\\mathbf{{r}}}\\\\\n  = \\sum_{i,j=1}^{N_{e}} \\left(\\int \\varphi_{k}({\\mathbf{{r}}}) W_{i}({\\mathbf{{r}}}) {\\,\\mathrm{d}}\n  {\\mathbf{{r}}}\\right)\n  B_{ij} \\left(\\int W_{j}({\\mathbf{{r}}}')\\varphi_{l}({\\mathbf{{r}}}') {\\,\\mathrm{d}} {\\mathbf{{r}}}'\\right).\n  \\label{eqn:ACEconstruct2}\n\\end{multline}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E13.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\iint\\varphi_{k}({\\mathbf{{r}}}){V_{X}^{\\mathrm{ACE}}}({\\mathbf{{%&#10;r}}},{\\mathbf{{r}}}^{\\prime})\\varphi_{l}({\\mathbf{{r}}}^{\\prime}){\\,\\mathrm{d}%&#10;}{\\mathbf{{r}}}{\\,\\mathrm{d}}{\\mathbf{{r}}}^{\\prime}\\equiv\\int\\varphi_{k}({%&#10;\\mathbf{{r}}})W_{l}({\\mathbf{{r}}}){\\,\\mathrm{d}}{\\mathbf{{r}}}\\\\&#10;\\displaystyle=\\sum_{i,j=1}^{N_{e}}\\left(\\int\\varphi_{k}({\\mathbf{{r}}})W_{i}({%&#10;\\mathbf{{r}}}){\\,\\mathrm{d}}{\\mathbf{{r}}}\\right)B_{ij}\\left(\\int W_{j}({%&#10;\\mathbf{{r}}}^{\\prime})\\varphi_{l}({\\mathbf{{r}}}^{\\prime}){\\,\\mathrm{d}}{%&#10;\\mathbf{{r}}}^{\\prime}\\right).\" display=\"block\"><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><mrow><mo largeop=\"true\" symmetric=\"true\">\u222c</mo><mrow><msub><mi>\u03c6</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msubsup><mi>V</mi><mi>X</mi><mi>ACE</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo>,</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>\u03c6</mi><mi>l</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>d</mo><mpadded width=\"+1.7pt\"><mi>\ud835\udc2b</mi></mpadded></mrow><mo>\u2062</mo><mrow><mo>d</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow></mrow></mrow><mo>\u2261</mo><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><msub><mi>\u03c6</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>W</mi><mi>l</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>d</mo><mi>\ud835\udc2b</mi></mrow></mrow></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mrow><mrow><mi/><mo>=</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mi>e</mi></msub></munderover><mrow><mrow><mo>(</mo><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><msub><mi>\u03c6</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>W</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>d</mo><mi>\ud835\udc2b</mi></mrow></mrow></mrow><mo>)</mo></mrow><mo>\u2062</mo><msub><mi>B</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><mrow><mo>(</mo><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><msub><mi>W</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>\u03c6</mi><mi>l</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>d</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow></mrow></mrow><mo>)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.07159.tex", "nexttext": "\nPerform Cholesky factorization for $-M$, i.e. $M=-LL^{T}$, where $L$ is a lower\ntriangular matrix, then the solution to~{(\\ref{{eqn:ACEconstruct2}})} is\n$B=-L^{-T}L^{-1}$.\nDefine the projection vector in the ACE formulation as\n\n", "itemtype": "equation", "pos": 22993, "prevtext": "\nDefine \n$M_{kl} = \\int \\varphi_{k}({\\mathbf{{r}}}) W_{l}({\\mathbf{{r}}}) {\\,\\mathrm{d}} {\\mathbf{{r}}}$,\nthen by Eq.~{(\\ref{{eqn:W}})}, $M$ is a negative semidefinite matrix of size\n$N_{e}$.\nEq.~{(\\ref{{eqn:ACEconstruct2}})} can be simplified using matrix notation as\n", "index": 31, "text": "\n\\[\nM = M B M.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"M=MBM.\" display=\"block\"><mrow><mrow><mi>M</mi><mo>=</mo><mrow><mi>M</mi><mo>\u2062</mo><mi>B</mi><mo>\u2062</mo><mi>M</mi></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.07159.tex", "nexttext": "\nthen the adaptively compressed exchange operator is given by\n\n", "itemtype": "equation", "pos": 23238, "prevtext": "\nPerform Cholesky factorization for $-M$, i.e. $M=-LL^{T}$, where $L$ is a lower\ntriangular matrix, then the solution to~{(\\ref{{eqn:ACEconstruct2}})} is\n$B=-L^{-T}L^{-1}$.\nDefine the projection vector in the ACE formulation as\n\n", "index": 33, "text": "\\begin{equation}\n  \\xi_{k}({\\mathbf{{r}}}) = \\sum_{i=1}^{N_{e}} W_{i}({\\mathbf{{r}}}) (L^{-T})_{ik},\n  \\label{eqn:Wtilde}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14.m1\" class=\"ltx_Math\" alttext=\"\\xi_{k}({\\mathbf{{r}}})=\\sum_{i=1}^{N_{e}}W_{i}({\\mathbf{{r}}})(L^{-T})_{ik},\" display=\"block\"><mrow><mrow><mrow><msub><mi>\u03be</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mi>e</mi></msub></munderover><mrow><msub><mi>W</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">(</mo><msup><mi>L</mi><mrow><mo>-</mo><mi>T</mi></mrow></msup><mo stretchy=\"false\">)</mo></mrow><mrow><mi>i</mi><mo>\u2062</mo><mi>k</mi></mrow></msub></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.07159.tex", "nexttext": "\n\n\n\n\n\n\n\n\n\n\nIt should be noted that ${V_{X}^{\\mathrm{ACE}}}$ is an operator of strict rank\n$N_{e}$. By construction ${V_{X}^{\\mathrm{ACE}}}$ only agrees with $V_{X}$ when\napplied to $\\{\\varphi_{i}\\}_{i=1}^{N_{e}}$. In the subspace\northogonal to the subspace spanned by\n$\\{\\varphi_{i}\\}_{i=1}^{N_{\\varphi}}$, the discrepancy between\n$V_{X}$ and ${V_{X}^{\\mathrm{ACE}}}$ is in principle not controlled. Nonetheless, the ACE\nformulation is sufficient to provide correct eigenvalues $\\{\\varepsilon_{i}\\}$ in\nEq.~{(\\ref{{eqn:HF}})} when self-consistency of the orbitals is reached. \n\nThe main advantage of the ACE formulation is the significantly reduced\ncost of applying ${V_{X}^{\\mathrm{ACE}}}$ to a set of orbitals than that of applying $V_X$.\nOnce ACE is constructed, the cost of applying ${V_{X}^{\\mathrm{ACE}}}$\nto any orbital $\\psi$\nis similar to the application of a nonlocal pseudopotential,\nthanks to its low rank structure.  \nACE only needs to be constructed once when $\\varphi_i$'s are updated in\nthe outer iteration. After constructed,\nthe ACE can be reused for all the subsequent inner SCF iterations for the electron\ndensity, and each iterative step for solving the linear eigenvalue\nproblem. Since each outer iteration could require $10\\sim 100$ or more\napplications of the Hamiltonian matrix $H$, the cost associated with the\nsolution of the Poisson problem is hence greatly reduced. The pseudocode\nfor iterative methods with the ACE formulation is given in\nAlg.~\\ref{alg:ACE}. Comparing with Alg.~\\ref{alg:fock}, the ACE\nformulation only requires moderate modification of the code.\n\nWe also remark that ACE can be readily used to  reduce the computational cost of the exchange energy, without the need of solving any extra Poisson equation:\n\n", "itemtype": "equation", "pos": 23436, "prevtext": "\nthen the adaptively compressed exchange operator is given by\n\n", "index": 35, "text": "\\begin{equation}\n  {V_{X}^{\\mathrm{ACE}}}({\\mathbf{{r}}},{\\mathbf{{r}}}') = -\\sum_{k=1}^{N_{e}} \\xi_{k}({\\mathbf{{r}}})\n  \\xi_{k}({\\mathbf{{r}}}').\n  \\label{eqn:ACE}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E15.m1\" class=\"ltx_Math\" alttext=\"{V_{X}^{\\mathrm{ACE}}}({\\mathbf{{r}}},{\\mathbf{{r}}}^{\\prime})=-\\sum_{k=1}^{N_%&#10;{e}}\\xi_{k}({\\mathbf{{r}}})\\xi_{k}({\\mathbf{{r}}}^{\\prime}).\" display=\"block\"><mrow><mrow><mrow><msubsup><mi>V</mi><mi>X</mi><mi>ACE</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo>,</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo>-</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mi>e</mi></msub></munderover><mrow><msub><mi>\u03be</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>\u03be</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.07159.tex", "nexttext": "\n\n\n\\begin{algorithm}[htbp]\n\\begin{center}\n  \\begin{minipage}{5in}\n\\begin{algorithmic}[1]\n  \\WHILE{exchange energy is not converged}\n  \\STATE Compute $\\{W_{i}\\}$ according to ~{(\\ref{{eqn:W}})}.\n  \\STATE Compute $\\{\\xi_{k}\\}$ according to ~{(\\ref{{eqn:Wtilde}})}.\n  \\WHILE{electron density $\\rho$ is not converged}\n  \\STATE Solve the linear eigenvalue problem~{(\\ref{{eqn:HFlineig}})} with\n  iterative schemes, with $V_{X}$ replaced by ${V_{X}^{\\mathrm{ACE}}}$ according to~{(\\ref{{eqn:ACE}})}.\n  \\STATE Update $\\rho^{out}({\\mathbf{{r}}})\\gets \\sum_{i=1}^{N_e}\n  \\left\\lvert{{\\psi}_{i}({\\mathbf{{r}}})}\\right\\rvert^2$.\n  \\STATE Update $\\rho$ using $\\rho^{out}$ and possibly previous history of $\\rho$ with charge mixing schemes.\n  \\ENDWHILE\n  \\STATE Compute the exchange energy $E_{X}$ according to~{(\\ref{{eqn:EX_ACE}})}.\n  \\STATE Update $\\{\\varphi_{j}\\}_{j=1}^{N_{e}}\\gets\n  \\{\\psi_{j}\\}_{j=1}^{N_{e}}$.\n  \\ENDWHILE\n\\end{algorithmic}\n\\end{minipage}\n\\end{center}\n\\caption{Iterative methods for solving Hartree-Fock-like\nequations in the ACE formulation.}\n\\label{alg:ACE}\n\\end{algorithm}\n\nSo far we assumed the number of $\\{\\varphi_i\\}$ orbitals, denoted by\n$N_{\\varphi}$, is exactly equal to $N_e$. When unoccupied states are\nneeded, e.g. for the computation of the HOMO-LUMO gap or for excited state calculations, \n$N_{\\varphi}>N_e$ should be used. We define the oversampling ratio\n$r=N_{\\varphi}/N_{e}$. Choosing the oversampling ratio $r>1$\ncan be potentially advantageous in the ACE formulation to accelerate the\nconvergence of the outer SCF iteration. This is because when $r>1$,  ${V_{X}^{\\mathrm{ACE}}}$ agrees with the true exchange operator $V_X$ when\napplied to orbitals over a\nlarger subspace. Our numerical results, while validating this intuitive\nunderstanding, also indicates that\nthe choice $r=1$ (i.e. $N_{\\varphi}=N_e$) can be good enough for\npractical hybrid functional calculations.\n\n\\section{Numerical results}\\label{sec:numer}\n\nIn this section we demonstrate the effectiveness of the ACE formulation\nfor accelerating KSDFT calculations with hybrid functionals. The ACE\nformulation is implemented in the\nDGDFT software package~\\cite{LinLuYingE2012,HuLinYang2015a}. DGDFT is a\nmassively parallel electronic structure software package for ground\nstate calculations written in C++.\nIt includes a relatively self-contained module called PWDFT for\nperforming standard planewave based electronic structure calculations.\nWe implement the Heyd-Scuseria-Ernzerhof\n(HSE06)~\\cite{HeydScuseriaErnzerhof2003,HeydScuseriaErnzerhof2006}\nhybrid functional in PWDFT, using periodic boundary conditions with\n$\\Gamma$-point Brillouin zone sampling. The screening parameter in the HSE functional $\\mu$ is set to $0.106$ au. Our implementation is comparable to that in\nstandard planewave based software packages such as Quantum\nESPRESSO~\\cite{GiannozziBaroniBoniniEtAl2009}.  All results are performed on a single\ncomputational core of a 3.4 GHz Intel i-7 processor with 64 GB memory.\n\nWe first validate the accuracy of the hybrid functional implementation in\nPWDFT by benchmarking with Quantum ESPRESSO, and by comparing the converged Fock exchange energy and\nthe HOMO-LUMO gap for a single water molecule (Fig.~\\ref{fig:water1})\nand an $8$-atom silicon system (Fig.~\\ref{fig:si1}). The\nHartwigsen-Goedecker-Hutter (HGH)\ndual-space pseudopotential~\\cite{HartwigsenGoedeckerHutter1998} is used in all\ncalculations.  Both Quantum ESPRESSO and PWDFT control the accuracy using a\nsingle parameter $E_{\\mbox{cut}}$, the kinetic energy cutoff.\nHowever, there is notable difference in the detailed implementation. For instance, PWDFT uses a real space implementation of the\npseudopotential with a pseudo-charge formulation~\\cite{PaskSterne2005},\nand implements the exchange-correlation functionals via the\nLibXC~\\cite{MarquesOliveiraBurnus2012} library, while Quantum ESPRESSO uses a\nFourier space implementation of the HGH pseudopotential converted from\nthe CPMD library~\\cite{HutterCurioni2005}, and uses a self-contained\nimplementation of exchange-correlation functionals. Nonetheless, at\nsufficiently large $E_{\\mbox{cut}}$, the difference of the total Fock\nexchange energy between Quantum ESPRESSO and PWDFT is only $9$ meV for the water system and \n$11$ meV for the silicon system, and the difference of the gap is $8$ meV for\nthe water system and $5$ meV for the silicon system, respectively. In\nboth systems, the difference of the results from PWDFT is negligibly\nsmall between the standard\nimplementation of hybrid functional (No-ACE), and with the ACE\nformulation.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\begin{figure}[ht]\n  \\begin{center}\n    \\subfloat[(a)]{\\includegraphics[width=0.3\\textwidth]{fock_water1}}\n    \\quad\n    \\subfloat[(b)]{\\includegraphics[width=0.3\\textwidth]{gap_water1}}\n  \\end{center}\n  \\caption{(color online) (a) Fock exchange energy and (b) HOMO-LUMO gap obtained from\n  Quantum ESPRESSO, PWDFT with and without the ACE formulation for a\n  water molecule.}\n  \\label{fig:water1}\n\\end{figure}\n\n\\begin{figure}[ht]\n  \\begin{center}\n    \\subfloat[(a)]{\\includegraphics[width=0.3\\textwidth]{fock_si1}}\n    \\quad\n    \\subfloat[(b)]{\\includegraphics[width=0.3\\textwidth]{gap_si1}}\n  \\end{center}\n  \\caption{(color online) (a) Fock exchange energy and (b) HOMO-LUMO gap obtained from\n  Quantum ESPRESSO, PWDFT with and without the ACE formulation for a\n  silicon system with $8$ atoms.}\n  \\label{fig:si1}\n\\end{figure}\n\n\nIn section~\\ref{sec:ace} the oversampling ratio\n$r=N_{\\varphi}/N_{e}$ is defined. It is conceivable that as $r$\nincreases, the convergence of the outer iteration for the orbitals\n$\\{\\varphi_{i}\\}$ can accelerate. Fig.~\\ref{fig:oversample} (a) and (b)\nreport the convergence of the difference of the Fock exchange energy at\neach outer iteration with respect to different oversampling ratio\n$r$ for the water and silicon system, respectively, as a measure of the\nconvergence of the outer iteration.  The kinetic energy\ncutoff for the water and silicon systems is set to $100$ au and $20$ au,\nrespectively. The convergence without the ACE formulation is also\nincluded fir comparison. We observe that as the oversampling\nratio increases, the convergence rate of the outer iteration becomes\nmarginally improved. In fact the convergence rate using the ACE\nformulation with $r=1$ is very close to that without the ACE formulation\nat all. This indicates that the use of the ACE formulation does not\nhinder the convergence rate of the hybrid functional calculation.\n\nIn order to demonstrate the efficiency of the ACE formulation for hybrid\nfunctional calculations, we study three silicon systems with increasing\nsizes $8$, $64$\nand $216$ atoms, respectively. The latter two systems correspond to a\nsilicon unit cell with $8$ atoms replicated into a $2\\times 2\\times 2$\nand a $3\\times3\\times 3$ supercell, respectively. Since hybrid\nfunctional is implemented in PWDFT so far in the serial\nmode, we use a\nrelatively small kinetic energy cutoff $E_{\\mbox{cut}}=5$ au in\nthese calculations. Nonetheless, the kinetic energy cutoff mainly\naffects the cost of the FFTs, and we expect that the ACE formulation\nwill become more advantageous with a higher\n$E_{\\mbox{cut}}$ in terms of the reduction of the absolute computational time.\nFig.~\\ref{fig:time_si} shows the time cost of each SCF iteration for the\nelectron density, which\ninvolves $10$ LOBPCG iterations, for the\ncalculation with the HSE functional with and without the ACE formulation. For comparison we also include the time cost of each SCF\niteration for the electron density in a GGA functional calculation using the\nPerdew-Burke-Ernzerhof (PBE) functional~\\cite{PerdewBurkeErnzerhof1996},\nof which the cost is much less expensive. The cost of the construction phase of the ACE formulation is\nmarked separately as ``ACE,Construct'' in Fig.~\\ref{fig:time_si}. \n\nFirst we confirm that the cost of each hybrid functional calculations is\nmuch higher than that of GGA calculations. The time per SCF iteration for the\nelectron density of the HSE\ncalculation without ACE is $42$ times higher than that of the PBE calculation\nfor the $64$ atom system. This ratio becomes $58$ times for the $216$ atom system.\nWith the ACE formulation, this ratio is reduced to $1.18$ and $1.05$,\nfor the $64$ and $216$ atom systems, respectively, i.e. the cost of each\nHSE calculation in the ACE formulation is only marginally larger than\nthat of the GGA calculation. Although the construction of the ACE still\nrequires solving a large number of Poisson equations, the overall time\nis greatly reduced since the\nACE, once constructed, can be used for multiple SCFs for converging the\nelectron density, until the orbitals $\\varphi_{i}$'s are changed in the\nouter iteration. Even assuming the inner iteration only consists of\none SCF iteration, for the system with $216$ atoms, the ACE formulation\nalready achieves a speedup $8.8$ times compared to the standard\nimplementation. The ACE formulation becomes orders of magnitude more efficient when\nmultiple inner SCF iterations is required, which is usually the case\nboth in PWDFT and in other software packages such as Quantum ESPRESSO.\n\n\\begin{figure}[ht]\n  \\begin{center}\n    \\subfloat[(a) Water molecule]{\\includegraphics[width=0.3\\textwidth]{oversample_si1}}\n    \\quad\n    \\subfloat[(b) Silicon with $8$ atoms]{\\includegraphics[width=0.3\\textwidth]{oversample_water1}}\n  \\end{center}\n  \\caption{(color online) Convergence of the difference of the exchange energy.}\n  \\label{fig:oversample}\n\\end{figure}\n\n\\begin{figure}[ht]\n  \\begin{center}\n    \\subfloat[(a)$8$ atoms]{\\includegraphics[width=0.3\\textwidth]{time_si1}}\n    \\subfloat[(b)$64$ atoms]{\\includegraphics[width=0.3\\textwidth]{time_si2}}\n    \\subfloat[(c)$216$ atoms]{\\includegraphics[width=0.3\\textwidth]{time_si3}}\n  \\end{center}\n  \\caption{(color online) Computational time for silicon systems with increasing system\n  sizes.}\n  \\label{fig:time_si}\n\\end{figure}\n\n\\section{Conclusion}\\label{sec:conclusion}\n\nWe have introduced the adaptively compressed exchange operator (ACE)\nformulation for compressing the Fock exchange operator. The main\nadvantage of the ACE formulation is that there is no loss of accuracy,\nand its effectiveness does not depend on the size of the band gap. Hence\nthe ACE formulation can be used for insulators, semiconductors as well\nas metals. We demonstrated the use of the ACE formulation in an\niterative framework for solving Hartree-Fock equations and Kohn-Sham\nequations with hybrid exchange-correlation functionals.  The ACE\nformulation only requires moderate modification of the code, and can\npotentially be applied to all electronic structure software packages for\ntreating the exchange interaction.  The construction cost of the ACE\nformulation is the same as applying the Fock exchange operator once to\nthe occupied orbitals. Once constructed, the cost of each\nself-consistent field iteration for the electron density in hybrid functional calculations\nbecomes only marginally larger than that of  GGA calculations.\nOur numerical results indicate that the computational advantage of the ACE\nformulation can be clearly observed even for small systems with tens of atoms.\n\nFor insulating systems, the cost of the ACE formulation can be further\nreduced when combined with linear scaling type methods. For range separated\nhybrid functionals, it might even be possible to localize the projection\nvectors $\\xi_k$'s due to the screened Coulomb interaction in the real\nspace. This could further reduce the construction as well as the\napplication cost of the ACE, and opens the door to Hartree-Fock-like\ncalculations for a large range of systems beyond reach at present.\n\n\\begin{acknowledgement}\nThis work was partially supported by Laboratory Directed Research and\nDevelopment (LDRD) funding from Berkeley Lab, provided by the Director,\nOffice of Science, of the U.S. Department of Energy under Contract No.\nDE-AC02-05CH11231, by the Scientific Discovery through Advanced Computing\n(SciDAC) program and the Center for Applied Mathematics for Energy\nResearch Applications (CAMERA) funded by U.S. Department of Energy,\nOffice of Science, Advanced Scientific Computing Research and Basic\nEnergy Sciences, and by the Alfred P. Sloan fellowship.\n\\end{acknowledgement}\n\n\\providecommand{\\latin}[1]{#1}\n\\providecommand*\\mcitethebibliography{\\thebibliography}\n\\csname @ifundefined\\endcsname{endmcitethebibliography}\n  {\\let\\endmcitethebibliography\\endthebibliography}{}\n\\begin{mcitethebibliography}{41}\n\\providecommand*\\natexlab[1]{#1}\n\\providecommand*\\mciteSetBstSublistMode[1]{}\n\\providecommand*\\mciteSetBstMaxWidthForm[2]{}\n\\providecommand*\\mciteBstWouldAddEndPuncttrue\n  {\\def\\EndOfBibitem{\\unskip.}}\n\\providecommand*\\mciteBstWouldAddEndPunctfalse\n  {\\let\\EndOfBibitem\\relax}\n\\providecommand*\\mciteSetBstMidEndSepPunct[3]{}\n\\providecommand*\\mciteSetBstSublistLabelBeginEnd[3]{}\n\\providecommand*\\EndOfBibitem{}\n\\mciteSetBstSublistMode{f}\n\\mciteSetBstMaxWidthForm{subitem}{(\\alph{mcitesubitemcount})}\n\\mciteSetBstSublistLabelBeginEnd\n  {\\mcitemaxwidthsubitemform\\space}\n  {\\relax}\n  {\\relax}\n\n\\bibitem[Hohenberg and Kohn(1964)Hohenberg, and Kohn]{HohenbergKohn1964}\nHohenberg,~P.; Kohn,~W. \\emph{Phys. Rev.} \\textbf{1964}, \\emph{136},\n  B864--B871\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Kohn and Sham(1965)Kohn, and Sham]{KohnSham1965}\nKohn,~W.; Sham,~L. \\emph{Phys. Rev.} \\textbf{1965}, \\emph{140},\n  A1133--A1138\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Ceperley and Alder(1980)Ceperley, and Alder]{CeperleyAlder1980}\nCeperley,~D.~M.; Alder,~B.~J. \\emph{Phys. Rev. Lett.} \\textbf{1980}, \\emph{45},\n  566--569\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Perdew and Zunger(1981)Perdew, and Zunger]{PerdewZunger1981}\nPerdew,~J.~P.; Zunger,~A. \\emph{Phys. Rev. B} \\textbf{1981}, \\emph{23},\n  5048--5079\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Becke(1988)]{Becke1988}\nBecke,~A.~D. \\emph{Phys. Rev. A} \\textbf{1988}, \\emph{38}, 3098--3100\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Lee \\latin{et~al.}(1988)Lee, Yang, and Parr]{LeeYangParr1988}\nLee,~C.; Yang,~W.; Parr,~R.~G. \\emph{Phys. Rev. B} \\textbf{1988}, \\emph{37},\n  785--789\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Perdew \\latin{et~al.}(1996)Perdew, Burke, and\n  Ernzerhof]{PerdewBurkeErnzerhof1996}\nPerdew,~J.~P.; Burke,~K.; Ernzerhof,~M. \\emph{Phys. Rev. Lett.} \\textbf{1996},\n  \\emph{77}, 3865--3868\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Staroverov \\latin{et~al.}(2003)Staroverov, Scuseria, Tao, and\n  Perdew]{StaroverovScuseriaTaoEtAl2003}\nStaroverov,~V.~N.; Scuseria,~G.~E.; Tao,~J.; Perdew,~J.~P. \\emph{J. Chem.\n  Phys.} \\textbf{2003}, \\emph{119}, 12129--12137\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Zhao and Truhlar(2008)Zhao, and Truhlar]{ZhaoTruhlar2008}\nZhao,~Y.; Truhlar,~D.~G. \\emph{Theor. Chem. Acc.} \\textbf{2008}, \\emph{120},\n  215--241\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Becke(1993)]{Becke1993}\nBecke,~A.~D. \\emph{J. Chem. Phys.} \\textbf{1993}, \\emph{98}, 5648\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Perdew \\latin{et~al.}(1996)Perdew, Ernzerhof, and\n  Burke]{PerdewErnzerhofBurke1996}\nPerdew,~J.~P.; Ernzerhof,~M.; Burke,~K. \\emph{J. Chem. Phys.} \\textbf{1996},\n  \\emph{105}, 9982--9985\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Heyd \\latin{et~al.}(2003)Heyd, Scuseria, and\n  Ernzerhof]{HeydScuseriaErnzerhof2003}\nHeyd,~J.; Scuseria,~G.~E.; Ernzerhof,~M. \\emph{J. Chem. Phys.} \\textbf{2003},\n  \\emph{118}, 8207--8215\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Heyd \\latin{et~al.}(2006)Heyd, Scuseria, and\n  Ernzerhof]{HeydScuseriaErnzerhof2006}\nHeyd,~J.; Scuseria,~G.~E.; Ernzerhof,~M. \\emph{J. Chem. Phys.} \\textbf{2006},\n  \\emph{124}, 219906\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Goedecker(1999)]{Goedecker1999}\nGoedecker,~S. \\emph{Rev. Mod. Phys.} \\textbf{1999}, \\emph{71}, 1085\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Bowler and Miyazaki(2012)Bowler, and Miyazaki]{BowlerMiyazaki2012}\nBowler,~D.~R.; Miyazaki,~T. \\emph{Rep. Prog. Phys.} \\textbf{2012}, \\emph{75},\n  036503\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Kohn(1996)]{Kohn1996}\nKohn,~W. \\emph{Phys. Rev. Lett.} \\textbf{1996}, \\emph{76}, 3168--3171\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Prodan and Kohn(2005)Prodan, and Kohn]{ProdanKohn2005}\nProdan,~E.; Kohn,~W. \\emph{Proc. Natl. Acad. Sci.} \\textbf{2005}, \\emph{102},\n  11635--11638\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Foster and Boys(1960)Foster, and Boys]{FosterBoys1960}\nFoster,~J.~M.; Boys,~S.~F. \\emph{Rev. Mod. Phys.} \\textbf{1960}, \\emph{32},\n  300\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Marzari and Vanderbilt(1997)Marzari, and\n  Vanderbilt]{MarzariVanderbilt1997}\nMarzari,~N.; Vanderbilt,~D. \\emph{Phys. Rev. B} \\textbf{1997}, \\emph{56},\n  12847\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Marzari \\latin{et~al.}(2012)Marzari, Mostofi, Yates, Souza, and\n  Vanderbilt]{WannierReview}\nMarzari,~N.; Mostofi,~A.~A.; Yates,~J.~R.; Souza,~I.; Vanderbilt,~D. \\emph{Rev.\n  Mod. Phys.} \\textbf{2012}, \\emph{84}, 1419--1475\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Gygi(2009)]{Gygi2009}\nGygi,~F. \\emph{Phys. Rev. Lett.} \\textbf{2009}, \\emph{102}, 166406\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[E \\latin{et~al.}(2010)E, Li, and Lu]{ELiLu2010}\nE,~W.; Li,~T.; Lu,~J. \\emph{Proc. Natl. Acad. Sci.} \\textbf{2010}, \\emph{107},\n  1273--1278\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Ozoli{\\c{n}}{\\v{s}} \\latin{et~al.}(2013)Ozoli{\\c{n}}{\\v{s}}, Lai,\n  Caflisch, and Osher]{OzolinsLaiCaflischEtAl2013}\nOzoli{\\c{n}}{\\v{s}},~V.; Lai,~R.; Caflisch,~R.; Osher,~S. \\emph{Proc. Natl.\n  Acad. Sci.} \\textbf{2013}, \\emph{110}, 18368--18373\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Damle \\latin{et~al.}(2015)Damle, Lin, and Ying]{DamleLinYing2015}\nDamle,~A.; Lin,~L.; Ying,~L. \\emph{J. Chem. Theory Comput.} \\textbf{2015},\n  \\emph{11}, 1463--1469\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Wu \\latin{et~al.}(2009)Wu, Selloni, and Car]{WuSelloniCar2009}\nWu,~X.; Selloni,~A.; Car,~R. \\emph{Phys. Rev. B} \\textbf{2009}, \\emph{79},\n  085102\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Gygi and Duchemin(2012)Gygi, and Duchemin]{GygiDuchemin2012}\nGygi,~F.; Duchemin,~I. \\emph{J. Chem. Theory Comput.} \\textbf{2012}, \\emph{9},\n  582--587\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Chen \\latin{et~al.}(2010)Chen, Wu, and Car]{ChenWuCar2010}\nChen,~W.; Wu,~X.; Car,~R. \\emph{Phys. Rev. Lett.} \\textbf{2010}, \\emph{105},\n  017802\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[DiStasio \\latin{et~al.}(2014)DiStasio, Santra, Li, Wu, and\n  Car]{DiStasioSantraLiEtAl2014}\nDiStasio,~R.~A.; Santra,~B.; Li,~Z.; Wu,~X.; Car,~R. \\emph{J. Chem. Phys.}\n  \\textbf{2014}, \\emph{141}, 084502\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Dawson and Gygi(2015)Dawson, and Gygi]{DawsonGygi2015}\nDawson,~W.; Gygi,~F. \\emph{J. Chem. Theory Comput.} \\textbf{2015}, \\emph{11},\n  4655--4663\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Giannozzi \\latin{et~al.}(2009)Giannozzi, Baroni, Bonini, Calandra,\n  Car, Cavazzoni, Ceresoli, Chiarotti, Cococcioni, and\n  Dabo]{GiannozziBaroniBoniniEtAl2009}\nGiannozzi,~P.; Baroni,~S.; Bonini,~N.; Calandra,~M.; Car,~R.; Cavazzoni,~C.;\n  Ceresoli,~D.; Chiarotti,~G.~L.; Cococcioni,~M.; Dabo,~I. \\emph{J. Phys.:\n  Condens. Matter} \\textbf{2009}, \\emph{21}, 395502--395520\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Anderson(1965)]{Anderson1965}\nAnderson,~D.~G. \\emph{J. Assoc. Comput. Mach.} \\textbf{1965}, \\emph{12},\n  547--560\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Pulay(1980)]{Pulay1980}\nPulay,~P. \\emph{Chem. Phys. Lett.} \\textbf{1980}, \\emph{73}, 393--398\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Davidson(1975)]{Davidson1975}\nDavidson,~E. \\emph{J. Comput. Phys.} \\textbf{1975}, \\emph{17}, 87--94\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Knyazev(2001)]{Knyazev2001}\nKnyazev,~A.~V. \\emph{SIAM J. Sci. Comp.} \\textbf{2001}, \\emph{23},\n  517--541\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Lin \\latin{et~al.}(2012)Lin, Lu, Ying, and E]{LinLuYingE2012}\nLin,~L.; Lu,~J.; Ying,~L.; E,~W. \\emph{J. Comput. Phys.} \\textbf{2012},\n  \\emph{231}, 2140--2154\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Hu \\latin{et~al.}(2015)Hu, Lin, and Yang]{HuLinYang2015a}\nHu,~W.; Lin,~L.; Yang,~C. \\emph{J. Chem. Phys.} \\textbf{2015}, \\emph{143},\n  124110\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Hartwigsen \\latin{et~al.}(1998)Hartwigsen, Goedecker, and\n  Hutter]{HartwigsenGoedeckerHutter1998}\nHartwigsen,~C.; Goedecker,~S.; Hutter,~J. \\emph{Phys. Rev. B} \\textbf{1998},\n  \\emph{58}, 3641--3662\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Pask and Sterne(2005)Pask, and Sterne]{PaskSterne2005}\nPask,~J.~E.; Sterne,~P.~A. \\emph{Phys. Rev. B} \\textbf{2005}, \\emph{71},\n  113101--113104\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Marques \\latin{et~al.}(2012)Marques, Oliveira, and\n  Burnus]{MarquesOliveiraBurnus2012}\nMarques,~M. A.~L.; Oliveira,~M. J.~T.; Burnus,~T. \\emph{Comput. Phys. Commun.}\n  \\textbf{2012}, \\emph{183}, 2272--2281\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\bibitem[Hutter and Curioni(2005)Hutter, and Curioni]{HutterCurioni2005}\nHutter,~J.; Curioni,~A. \\emph{Parallel Comput.} \\textbf{2005}, \\emph{31},\n  1--17\\relax\n\\mciteBstWouldAddEndPuncttrue\n\\mciteSetBstMidEndSepPunct{\\mcitedefaultmidpunct}\n{\\mcitedefaultendpunct}{\\mcitedefaultseppunct}\\relax\n\\EndOfBibitem\n\\end{mcitethebibliography}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n", "itemtype": "equation", "pos": 25369, "prevtext": "\n\n\n\n\n\n\n\n\n\n\nIt should be noted that ${V_{X}^{\\mathrm{ACE}}}$ is an operator of strict rank\n$N_{e}$. By construction ${V_{X}^{\\mathrm{ACE}}}$ only agrees with $V_{X}$ when\napplied to $\\{\\varphi_{i}\\}_{i=1}^{N_{e}}$. In the subspace\northogonal to the subspace spanned by\n$\\{\\varphi_{i}\\}_{i=1}^{N_{\\varphi}}$, the discrepancy between\n$V_{X}$ and ${V_{X}^{\\mathrm{ACE}}}$ is in principle not controlled. Nonetheless, the ACE\nformulation is sufficient to provide correct eigenvalues $\\{\\varepsilon_{i}\\}$ in\nEq.~{(\\ref{{eqn:HF}})} when self-consistency of the orbitals is reached. \n\nThe main advantage of the ACE formulation is the significantly reduced\ncost of applying ${V_{X}^{\\mathrm{ACE}}}$ to a set of orbitals than that of applying $V_X$.\nOnce ACE is constructed, the cost of applying ${V_{X}^{\\mathrm{ACE}}}$\nto any orbital $\\psi$\nis similar to the application of a nonlocal pseudopotential,\nthanks to its low rank structure.  \nACE only needs to be constructed once when $\\varphi_i$'s are updated in\nthe outer iteration. After constructed,\nthe ACE can be reused for all the subsequent inner SCF iterations for the electron\ndensity, and each iterative step for solving the linear eigenvalue\nproblem. Since each outer iteration could require $10\\sim 100$ or more\napplications of the Hamiltonian matrix $H$, the cost associated with the\nsolution of the Poisson problem is hence greatly reduced. The pseudocode\nfor iterative methods with the ACE formulation is given in\nAlg.~\\ref{alg:ACE}. Comparing with Alg.~\\ref{alg:fock}, the ACE\nformulation only requires moderate modification of the code.\n\nWe also remark that ACE can be readily used to  reduce the computational cost of the exchange energy, without the need of solving any extra Poisson equation:\n\n", "index": 37, "text": "\\begin{equation}\n\nE_X^{HF} = \\frac{1}{2} \\sum_{i=1}^{N_e} \\iint\n  \\psi_{i}({\\mathbf{{r}}}){V_{X}^{\\mathrm{ACE}}}({\\mathbf{{r}}},{\\mathbf{{r}}}')\\psi_i({\\mathbf{{r}}}') {\\,\\mathrm{d}} {\\mathbf{{r}}} {\\,\\mathrm{d}} {\\mathbf{{r}}}' \n  =-\\frac{1}{2} \\sum_{i,k=1}^{N_e} \\left(\\int \\psi_i({\\mathbf{{r}}}) \\xi_k({\\mathbf{{r}}}) {\\,\\mathrm{d}} {\\mathbf{{r}}}\\right)^2.  \n\n\\label{eqn:EX_ACE}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E16.m1\" class=\"ltx_Math\" alttext=\"\\par&#10; E_{X}^{HF}=\\frac{1}{2}\\sum_{i=1}^{N_{e}}\\iint\\psi_{i}({\\mathbf{{r}}}){V_%&#10;{X}^{\\mathrm{ACE}}}({\\mathbf{{r}}},{\\mathbf{{r}}}^{\\prime})\\psi_{i}({\\mathbf{{%&#10;r}}}^{\\prime}){\\,\\mathrm{d}}{\\mathbf{{r}}}{\\,\\mathrm{d}}{\\mathbf{{r}}}^{\\prime%&#10;}=-\\frac{1}{2}\\sum_{i,k=1}^{N_{e}}\\left(\\int\\psi_{i}({\\mathbf{{r}}})\\xi_{k}({%&#10;\\mathbf{{r}}}){\\,\\mathrm{d}}{\\mathbf{{r}}}\\right)^{2}.\\par&#10;\" display=\"block\"><mrow><mrow><msubsup><mi>E</mi><mi>X</mi><mrow><mi>H</mi><mo>\u2062</mo><mi>F</mi></mrow></msubsup><mo>=</mo><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mi>e</mi></msub></munderover><mrow><mo largeop=\"true\" symmetric=\"true\">\u222c</mo><mrow><msub><mi>\u03c8</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msubsup><mi>V</mi><mi>X</mi><mi>ACE</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo>,</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>\u03c8</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>d</mo><mpadded width=\"+1.7pt\"><mi>\ud835\udc2b</mi></mpadded></mrow><mo>\u2062</mo><mrow><mo>d</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow></mrow></mrow></mrow></mrow><mo>=</mo><mrow><mo>-</mo><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mrow><mi>i</mi><mo>,</mo><mi>k</mi></mrow><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mi>e</mi></msub></munderover><msup><mrow><mo>(</mo><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><msub><mi>\u03c8</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>\u03be</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>d</mo><mi>\ud835\udc2b</mi></mrow></mrow></mrow><mo>)</mo></mrow><mn>2</mn></msup></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}]