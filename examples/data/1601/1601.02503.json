[{"file": "1601.02503.tex", "nexttext": "\n\twhere $V_{0} = V_{\\textrm{tip}} - V_{\\textrm{sample}}$ is the contact potential difference between the tip and sample when both are grounded, and $\\zeta_{j}\\equiv\\zeta_{j}(V_{AC})$ is the sensitivity, which depends on the KPFM technique used (indicated through the subscript $j$), $V_{AC}$, the probe geometry, and imaging settings: such as the lift height. When $V_{K}=-V_{0}=V_{\\textrm{sample}}-V_{\\textrm{tip}}$, the signal vanishes. An image is created from the recorded $V_{K}$ as the cantilever raster scans the surface. The KPFM signal is written in the form of equation \\ref{eq:KPFM_feedback} in order emphasize the similarity of H-KPFM with prior KPFM techniques and to facilitate their comparison. \n\t\t\t\n\tIn AM-KPFM, $S_{K}$ is detected at the same frequency as the applied $V_{AC}$ ($\\textcolor{purple}{\\updownarrow}$ in figure \\ref{fig:CantileverResponse}), {\\it{i.e.}} $f_{D}=f_{A}$ for AM-KPFM. Here we calculate the force above a conducting sample by modeling the tip-sample system as an metallic capacitor with energy $U = 1/2 C V^{2}$. The case for semiconductors is more complicated, but KPFM feedback operation is similar, and reduces to the metal case in the heavily-doped limit\\cite{Hudlet1995}. The force on the cantilever has components at frequencies DC, $f_{D}$, and $2f_{D}$. The vertical force on the cantilever at frequency $f_{D}$ is then\\cite{Jacobs1997}:\n\t\t\n", "itemtype": "equation", "pos": 7781, "prevtext": "\n\n\\title{Fast, high-resolution surface potential measurements in air\\\\ with heterodyne Kelvin probe force microscopy}\n\\author{Joseph L. Garrett}\n\t\\address{ University of Maryland Department of Physics, College Park, MD 20742, USA}\n\t\\address{ Institute for Research in Electronics and Applied Physics, College Park, MD 20742}\n\\author{Jeremy N. Munday}\n\t\n\t\\address{ University of Maryland Department of Physics, College Park, MD 20742, USA}\n\t\\address{ Institute for Research in Electronics and Applied Physics, College Park, MD 20742}\n\t\\address{ Department of Electrical and Computer Engineering, College Park, MD 20742}\n\n\n\\begin{abstract}\n\t\n\tKelvin probe force microscopy (KPFM) adapts an atomic force microscope to measure electric potential on surfaces at nanometer length scales. Here we demonstrate that Heterodyne-KPFM enables scan rates of several frames per minute in air, and concurrently maintains spatial resolution and voltage sensitivity comparable to frequency-modulation KPFM, the current spatial resolution standard. Two common classes of topography-coupled artifacts are shown to be avoidable with H-KPFM. A second implementation of H-KPFM is also introduced, in which the voltage signal is amplified by the first cantilever resonance for enhanced sensitivity.\n\t\n\\end{abstract}\n\n\\maketitle \n\\section{Introduction}\n\t\tThe original amplitude-modulation Kelvin probe force microscopy (AM-KPFM) method\\cite{Nonnenmacher1991}  has been used in numerous studies investigating: potential contrast between metals\\cite{{Nonnenmacher1992}}, components of integrated circuits\\cite{Weaver1991}, semiconductor doping\\cite{Henning1995a}, pn junctions\\cite{Kikukawa1995}, self-assembled monolayers\\cite{Lu1999}, Langmuir films\\cite{Reitzel2001}, crystal orientation of metals\\cite{Gaillard2006}, and biomolecular binding to DNA\\cite{Sinensky2007}. Developments such as lift mode\\cite{Jacobs1997} allowed the investigation of softer surfaces\\cite{Lee2000,Palermo2006}. However, in AM-KPFM, the voltage contrast is typically only a qualitative representation of the surface potential due to an averaging effect of the cantilever\\cite{Jacobs1997}. \n\t\t\n\t\tThe development of Frequency-Modulation (FM) KPFM\\cite{Kitamura1998} improved spatial resolution and repeatability\\cite{Glatzel2003, Zerweck2005, Panchal2013} and has been used to quantitatively compare nanoscale potentials with macroscopic work functions on both semiconductors\\cite{Sommerhalter1999} and graphene\\cite{Panchal2013}, to identify semiconductor crystal orientations\\cite{Sadewasser2002}, to characterize lipid self-organization\\cite{Leonenko2007}, to quantify band bending at grain boundaries\\cite{Sadewasser2003}, to study charge transport and trapping in quantum dots\\cite{Zhang2015}, and to investigate the charge distribution at sub-molecular and atomic length scales\\cite{Mohn2012,Gross2009}. However, dynamics are difficult to measure with FM-KPFM because of its slow scan speeds---the result of potential and topographic feedback loops detected near the same cantilever resonance, limiting detection bandwidth\\cite{Glatzel2003,Zerweck2005}. A recent technique, Heterodyne (H) KPFM, operates similarly to FM-KFPM but separates the topography and voltage signals by hundreds of kHz. Originally, in vacuum, the separation was utilized to increase the voltage sensitivity through amplification by the second cantilever eigenmode, while maintaining spatial resolution equal to FM-KPFM\\cite{Sugawara2012,Ma2013,Ma2013a}. \n\t\t\n\t\tHere we demonstrate that H-KPFM overcomes the scan speed limitations of FM-KPFM in air, and achieves speeds of up to 16 s/frame (1x1 $\\mu$m, 256$\\times$256 pixels). Other techniques that emphasize time resolution include time resolved electrostatic force microscopy and pump-probe KPFM, which both probe the dynamic response to an impulse point-by-point\\cite{Coffey2006a,Murawski2015}, and open loop (OL) KPFM techniques, which eliminate the KPFM voltage feedback loop\\cite{Takeuchi2007,Collins2013, Borgani2014a}. The advantage of H-KPFM is that it does not require an impulse, unlike the former, and achieves scan rates over an order of magnitude faster than the latter.\n\t\t \n\t\tH-KPFM avoids a class of artifacts that originate from interfering signals and appear in traditional KPFM measurements as topographical coupling\\cite{Diesinger2008,Melin2011}, by separating the frequency at which the voltage signal is detected from both the frequency of the topographical feedback loop and the frequency at which the voltage is applied. Measurements in vacuum showed that H-KPFM also avoids the stray capacitance artifact\\cite{Ma2013}, and we demonstrate that this holds in air as well.\n\t\t \n\t\tOperation in air is necessary to study biological molecules such as lipids and DNA\\cite{Moores2010,Sinensky2007} and to study solar cell properties such as open-circuit voltage and degradation in realistic operation conditions\\cite{Tennyson,Sengupta2011}. However, developments of KPFM have often focused on operation in vacuum\\cite{Kitamura1998,Sugawara2012}. In air, several challenges must be overcome, such as vastly lower Q factors, which reduce sensitivity, and a thin adhesive water layer\\cite{Wastl2013a}. The lower Q can be utilized for faster scan speeds, because the maximum detection bandwidth is proportional to 1/Q. Additionally, lift mode can alleviate adhesion by first scanning the cantilever over the surface once to measure the topography and then raising it above the topographical profile for a second scan, during which surface potential data is collected\\cite{Jacobs1997}. Here we also show compatibility of H-KPFM with lift mode, in addition to single-pass operation. \n\t\t\n\t\tWe demonstrate that H-KPFM quickly measures high resolution surface potentials in air. It is not susceptible to several topographical artifacts that hinder the other KPFM methods. A second implementation of H-KFPM is also introduced, in which the topography is detected with the second cantilever resonance and the voltage with the first, for additional voltage sensitivity. The temporal resolution, voltage contrast, and spatial resolution of H-KPFM are each compared to those of both FM- and AM-KPFM. It is deduced that H-KPFM improves upon the spatial resolution of AM-KPFM and improves upon the scan speed of FM-KPFM, resulting in a new technique with improved performance in ambient conditions.\n\t\n\\section{Implementation}\n\t\\begin{figure}[!htb]\n\t\\centering\n\t\\includegraphics[width=.45\\textwidth]{Figure1}\n\t\\caption{In H-KPFM (\\textbf{\\textcolor{light-blue}{$\\blacksquare$}} a,b) an alternating voltage is applied at a frequency $f_{2}-f_{1}$  (\\textbf{$\\textcolor{red} \\downarrow$}). The cantilever's response is detected at one resonance (${\\textcolor{bright-blue} \\uparrow}$) while the time-averaged distance to the surface is maintained by oscillations at another resonance ($\\mid$). Likewise, in the sideband implementation of FM-KPFM ($\\square$, c) a voltage is applied and the response detected at different frequencies: the alternating voltage is applied at $ f_{A} \\ll f_{1}$ and detected at $f_{1}+f_{A}$. In AM-KPFM ({\\textcolor{light-red}{$\\blacksquare$}}), the alternating voltage is applied at the same frequency at which the cantilever response is detected ($\\textcolor{purple}{\\updownarrow}$). The magnitude of the cantilever transfer function $G(f)$ with each eigenmode modeled as a point-mass, is shown in (e).\n\t}\n\t\\label{fig:CantileverResponse}\n\t\\end{figure}\n\\subsection{Analysis of the KPFM method}\n\nIn KPFM, a signal, $S_{K}$, is generated by applying an AC voltage, $V_{AC}$, at frequency $f$ to a conductive tip above a grounded sample. A feedback loop applies a KPFM voltage, $V_{K}$, to the probe so that $S_{K}$ vanishes. The signal on which the KPFM feedback acts is:\n\t\t \n", "index": 1, "text": "\\begin{align}\n\t\t  S_{K} = - \\zeta_{j} (V_{K}+V_{0}),\t\n\t\t  \\label{eq:KPFM_feedback}\n\t\t \\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle S_{K}=-\\zeta_{j}(V_{K}+V_{0}),\" display=\"inline\"><mrow><mrow><msub><mi>S</mi><mi>K</mi></msub><mo>=</mo><mrow><mo>-</mo><mrow><msub><mi>\u03b6</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>V</mi><mi>K</mi></msub><mo>+</mo><msub><mi>V</mi><mn>0</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\n\twhere $C' = \\frac{dC}{dz}$.\tWe assume that the motion of each cantilever eigenmode is purely along the $z$-axis so that the transfer function of the cantilever $G(f)$ relates the driving force on the tip to the oscillation amplitude $A_{f}$ of the cantilever:\n\t\n", "itemtype": "equation", "pos": 9267, "prevtext": "\n\twhere $V_{0} = V_{\\textrm{tip}} - V_{\\textrm{sample}}$ is the contact potential difference between the tip and sample when both are grounded, and $\\zeta_{j}\\equiv\\zeta_{j}(V_{AC})$ is the sensitivity, which depends on the KPFM technique used (indicated through the subscript $j$), $V_{AC}$, the probe geometry, and imaging settings: such as the lift height. When $V_{K}=-V_{0}=V_{\\textrm{sample}}-V_{\\textrm{tip}}$, the signal vanishes. An image is created from the recorded $V_{K}$ as the cantilever raster scans the surface. The KPFM signal is written in the form of equation \\ref{eq:KPFM_feedback} in order emphasize the similarity of H-KPFM with prior KPFM techniques and to facilitate their comparison. \n\t\t\t\n\tIn AM-KPFM, $S_{K}$ is detected at the same frequency as the applied $V_{AC}$ ($\\textcolor{purple}{\\updownarrow}$ in figure \\ref{fig:CantileverResponse}), {\\it{i.e.}} $f_{D}=f_{A}$ for AM-KPFM. Here we calculate the force above a conducting sample by modeling the tip-sample system as an metallic capacitor with energy $U = 1/2 C V^{2}$. The case for semiconductors is more complicated, but KPFM feedback operation is similar, and reduces to the metal case in the heavily-doped limit\\cite{Hudlet1995}. The force on the cantilever has components at frequencies DC, $f_{D}$, and $2f_{D}$. The vertical force on the cantilever at frequency $f_{D}$ is then\\cite{Jacobs1997}:\n\t\t\n", "index": 3, "text": "\\begin{align}\n\t\t\tF_{f_{D}} =  - C' V_{AC}(V_{K}+V_{0}),\n\t\t\t\\label{eq:AM_force}\n\t\t\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle F_{f_{D}}=-C^{\\prime}V_{AC}(V_{K}+V_{0}),\" display=\"inline\"><mrow><mrow><msub><mi>F</mi><msub><mi>f</mi><mi>D</mi></msub></msub><mo>=</mo><mrow><mo>-</mo><mrow><msup><mi>C</mi><mo>\u2032</mo></msup><mo>\u2062</mo><msub><mi>V</mi><mrow><mi>A</mi><mo>\u2062</mo><mi>C</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>V</mi><mi>K</mi></msub><mo>+</mo><msub><mi>V</mi><mn>0</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\n\t The optical lever sensitivity $\\gamma(f)$ relates the signal generated at the photodetector to the amplitude of cantilever oscillation, so that:\n\t \n\t \t\n", "itemtype": "equation", "pos": 9622, "prevtext": "\n\twhere $C' = \\frac{dC}{dz}$.\tWe assume that the motion of each cantilever eigenmode is purely along the $z$-axis so that the transfer function of the cantilever $G(f)$ relates the driving force on the tip to the oscillation amplitude $A_{f}$ of the cantilever:\n\t\n", "index": 5, "text": "\\begin{align}\n\t\tA_{f_{D}} &= G(f_{D})F_{f_{D}}.\n\t\t\\label{eq:amplitude}\n\t\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle A_{f_{D}}\" display=\"inline\"><msub><mi>A</mi><msub><mi>f</mi><mi>D</mi></msub></msub></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=G(f_{D})F_{f_{D}}.\" display=\"inline\"><mrow><mrow><mi/><mo>=</mo><mrow><mi>G</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mi>D</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>F</mi><msub><mi>f</mi><mi>D</mi></msub></msub></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\n\t \n\t\t The signal from the photodetector is recorded by a quadrature lock-in amplifier with relative phase $\\phi_{D}$:\n\t \n", "itemtype": "equation", "pos": 9859, "prevtext": "\n\t The optical lever sensitivity $\\gamma(f)$ relates the signal generated at the photodetector to the amplitude of cantilever oscillation, so that:\n\t \n\t \t\n", "index": 7, "text": "\\begin{align}\n\t \t\\label{eq:at_photodetector}\n\t \tS_{\\text{photo}} &= \\gamma(f_{D})A_{f_{D}}, \\\\\n\t \t&=  - \\gamma(f_{D})G(f_{D})C' V_{AC}(V_{K}+V_{0}).\\notag\n\t \t\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle S_{\\text{photo}}\" display=\"inline\"><msub><mi>S</mi><mtext>photo</mtext></msub></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\gamma(f_{D})A_{f_{D}},\" display=\"inline\"><mrow><mrow><mi/><mo>=</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mi>D</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>A</mi><msub><mi>f</mi><mi>D</mi></msub></msub></mrow></mrow><mo>,</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=-\\gamma(f_{D})G(f_{D})C^{\\prime}V_{AC}(V_{K}+V_{0}).\" display=\"inline\"><mrow><mrow><mi/><mo>=</mo><mrow><mo>-</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mi>D</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>G</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mi>D</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msup><mi>C</mi><mo>\u2032</mo></msup><mo>\u2062</mo><msub><mi>V</mi><mrow><mi>A</mi><mo>\u2062</mo><mi>C</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>V</mi><mi>K</mi></msub><mo>+</mo><msub><mi>V</mi><mn>0</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\n\t where $S_{LIA}^{i}$ and $S_{LIA}^{q}$ are the in-phase and quadrature components of the signal, respectively, at the lock-in amplifier. The KPFM feedback loop operates on $S_{LIA}^{i}$, and when put in the form of equation \\ref{eq:KPFM_feedback} is:\n\t\n", "itemtype": "equation", "pos": 10149, "prevtext": "\n\t \n\t\t The signal from the photodetector is recorded by a quadrature lock-in amplifier with relative phase $\\phi_{D}$:\n\t \n", "index": 9, "text": "\\begin{align}\n\t \\label{eq:lock_in_signals}\n\t S_{LIA}^{i}&= \\text{Re}[- \\gamma(f_{D})G(f_{D})C' V_{AC}(V_{K}+V_{0})e^{i\\phi_{D}}],  \\\\\n\t S_{LIA}^{q}&=  \\text{Re}[- \\gamma(f_{D})G(f_{D})C' V_{AC}(V_{K}+V_{0})e^{i(\\phi_{D}+\\frac{\\pi}{2})}], \\notag\n\t \\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle S_{LIA}^{i}\" display=\"inline\"><msubsup><mi>S</mi><mrow><mi>L</mi><mo>\u2062</mo><mi>I</mi><mo>\u2062</mo><mi>A</mi></mrow><mi>i</mi></msubsup></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\text{Re}[-\\gamma(f_{D})G(f_{D})C^{\\prime}V_{AC}(V_{K}+V_{0})e^{%&#10;i\\phi_{D}}],\" display=\"inline\"><mrow><mrow><mi/><mo>=</mo><mrow><mtext>Re</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mo>-</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mi>D</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>G</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mi>D</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msup><mi>C</mi><mo>\u2032</mo></msup><mo>\u2062</mo><msub><mi>V</mi><mrow><mi>A</mi><mo>\u2062</mo><mi>C</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>V</mi><mi>K</mi></msub><mo>+</mo><msub><mi>V</mi><mn>0</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msup><mi>e</mi><mrow><mi>i</mi><mo>\u2062</mo><msub><mi>\u03d5</mi><mi>D</mi></msub></mrow></msup></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle S_{LIA}^{q}\" display=\"inline\"><msubsup><mi>S</mi><mrow><mi>L</mi><mo>\u2062</mo><mi>I</mi><mo>\u2062</mo><mi>A</mi></mrow><mi>q</mi></msubsup></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\text{Re}[-\\gamma(f_{D})G(f_{D})C^{\\prime}V_{AC}(V_{K}+V_{0})e^{%&#10;i(\\phi_{D}+\\frac{\\pi}{2})}],\" display=\"inline\"><mrow><mrow><mi/><mo>=</mo><mrow><mtext>Re</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mo>-</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mi>D</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>G</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mi>D</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msup><mi>C</mi><mo>\u2032</mo></msup><mo>\u2062</mo><msub><mi>V</mi><mrow><mi>A</mi><mo>\u2062</mo><mi>C</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>V</mi><mi>K</mi></msub><mo>+</mo><msub><mi>V</mi><mn>0</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msup><mi>e</mi><mrow><mi>i</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\u03d5</mi><mi>D</mi></msub><mo>+</mo><mfrac><mi>\u03c0</mi><mn>2</mn></mfrac></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msup></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\n\twhere the sensitivity of AM-KPFM is:\n\t\n", "itemtype": "equation", "pos": 10661, "prevtext": "\n\t where $S_{LIA}^{i}$ and $S_{LIA}^{q}$ are the in-phase and quadrature components of the signal, respectively, at the lock-in amplifier. The KPFM feedback loop operates on $S_{LIA}^{i}$, and when put in the form of equation \\ref{eq:KPFM_feedback} is:\n\t\n", "index": 11, "text": "\\begin{align}\n\t\t  S_{K} &\\equiv S_{LIA}^{i} = - \\zeta_{AM}(V_{K}+V_{0}),\n\t\t  \\label{eq:SKforAM}\n\t\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle S_{K}\" display=\"inline\"><msub><mi>S</mi><mi>K</mi></msub></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\equiv S_{LIA}^{i}=-\\zeta_{AM}(V_{K}+V_{0}),\" display=\"inline\"><mrow><mrow><mi/><mo>\u2261</mo><msubsup><mi>S</mi><mrow><mi>L</mi><mo>\u2062</mo><mi>I</mi><mo>\u2062</mo><mi>A</mi></mrow><mi>i</mi></msubsup><mo>=</mo><mrow><mo>-</mo><mrow><msub><mi>\u03b6</mi><mrow><mi>A</mi><mo>\u2062</mo><mi>M</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>V</mi><mi>K</mi></msub><mo>+</mo><msub><mi>V</mi><mn>0</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\t\n\tThe relative phase of the lock-in amplifier, $\\phi_{D}$, is adjusted in order to maximize the sensitivity for all techniques.\n\n\tIn H-KPFM and FM-KPFM, the cantilever is shaken with amplitude $A_{T}$ at frequency $f_{T}$ by a non-electrostatic method (here, photothermally), $V_{AC}$ is applied at $f_{A}$, and the KPFM signal is detected at $f_{D}$ ($\\mid$, \\textbf{$\\textcolor{red} \\downarrow$}, and ${\\textcolor{bright-blue} \\uparrow}$, respectively, in figure \\ref{fig:CantileverResponse}). We assume that the cantilever position is well-approximated by the sinusoidal motion at $f_{T}$ used by the topographic feedback loop (\\ref{fig:CantileverResponse}), so that:\n\t\n", "itemtype": "equation", "pos": -1, "prevtext": "\n\twhere the sensitivity of AM-KPFM is:\n\t\n", "index": 13, "text": "\\begin{equation}\n\t\t\\zeta_{AM} = \\text{Re}[\\gamma(f_{D}) G(f_{D}) C'V_{AC}e^{i\\phi_{D}}].\n\t\t\\label{eq:chi_am}\n\t\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"\\zeta_{AM}=\\text{Re}[\\gamma(f_{D})G(f_{D})C^{\\prime}V_{AC}e^{i\\phi_{D}}].\" display=\"block\"><mrow><mrow><msub><mi>\u03b6</mi><mrow><mi>A</mi><mo>\u2062</mo><mi>M</mi></mrow></msub><mo>=</mo><mrow><mtext>Re</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mi>D</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>G</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mi>D</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msup><mi>C</mi><mo>\u2032</mo></msup><mo>\u2062</mo><msub><mi>V</mi><mrow><mi>A</mi><mo>\u2062</mo><mi>C</mi></mrow></msub><mo>\u2062</mo><msup><mi>e</mi><mrow><mi>i</mi><mo>\u2062</mo><msub><mi>\u03d5</mi><mi>D</mi></msub></mrow></msup></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\n\twhere $z$ is the instantaneous tip-sample separation, $\\bar{z}$ is the time-averaged separation, $A_{T}$ is the amplitude of topographic oscillation, and $\\phi_{T}$ is the phase. Here we Taylor expand the tip-sample electrostatic force around its time-averaged height $\\bar{z}$ so that the capacitive force on the cantilever is\\cite{Sugawara2012}:\n\t\t\n", "itemtype": "equation", "pos": 11606, "prevtext": "\t\n\tThe relative phase of the lock-in amplifier, $\\phi_{D}$, is adjusted in order to maximize the sensitivity for all techniques.\n\n\tIn H-KPFM and FM-KPFM, the cantilever is shaken with amplitude $A_{T}$ at frequency $f_{T}$ by a non-electrostatic method (here, photothermally), $V_{AC}$ is applied at $f_{A}$, and the KPFM signal is detected at $f_{D}$ ($\\mid$, \\textbf{$\\textcolor{red} \\downarrow$}, and ${\\textcolor{bright-blue} \\uparrow}$, respectively, in figure \\ref{fig:CantileverResponse}). We assume that the cantilever position is well-approximated by the sinusoidal motion at $f_{T}$ used by the topographic feedback loop (\\ref{fig:CantileverResponse}), so that:\n\t\n", "index": 15, "text": "\\begin{align}\n\t\t(z-\\bar{z}) =& A_{T}\\cos(2 \\pi f_{T}t + \\phi_{T}),\n\t\t\\label{eq:expand_z}\n\t\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle(z-\\bar{z})=\" display=\"inline\"><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>z</mi><mo>-</mo><mover accent=\"true\"><mi>z</mi><mo stretchy=\"false\">\u00af</mo></mover></mrow><mo stretchy=\"false\">)</mo></mrow><mo>=</mo><mi/></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle A_{T}\\cos(2\\pi f_{T}t+\\phi_{T}),\" display=\"inline\"><mrow><mrow><msub><mi>A</mi><mi>T</mi></msub><mo>\u2062</mo><mrow><mi>cos</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>\u03c0</mi><mo>\u2062</mo><msub><mi>f</mi><mi>T</mi></msub><mo>\u2062</mo><mi>t</mi></mrow><mo>+</mo><msub><mi>\u03d5</mi><mi>T</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\n\t\n\tAs in AM-KPFM, a term linear in $V_{AC}$ is used for the KPFM feedback, and there are three frequencies at which such a signal is generated: $f_{A}$,$f_{A}+f_{T}$, and $|f_{A}-f_{T}|$. The force at the first frequency, proportional to $C'$, is used for AM-KPFM (see equation \\ref{eq:AM_force}), while the forces at the second and third frequencies, each proportional to $C''$, are used for H-KPFM. Then, up to a phase shift, each force is:\n\t\n", "itemtype": "equation", "pos": 12059, "prevtext": "\n\twhere $z$ is the instantaneous tip-sample separation, $\\bar{z}$ is the time-averaged separation, $A_{T}$ is the amplitude of topographic oscillation, and $\\phi_{T}$ is the phase. Here we Taylor expand the tip-sample electrostatic force around its time-averaged height $\\bar{z}$ so that the capacitive force on the cantilever is\\cite{Sugawara2012}:\n\t\t\n", "index": 17, "text": "\\begin{align}\n\t\t\tF = \\Bigg[ C'+C''A_{T}\\cos(2 \\pi f_{T}t + \\phi_{T})\\Bigg] \\notag \\\\\n\t\t\t\\times \\frac{[V_{AC}\\cos(2\\pi f_{A}t +\\phi_{A})+V_{K}+V_{0}]^{2}}{2}.\n\t\t\t\\label{eq:All_u_terms}\n\t\t\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle F=\\Bigg{[}C^{\\prime}+C^{\\prime\\prime}A_{T}\\cos(2\\pi f_{T}t+\\phi_%&#10;{T})\\Bigg{]}\" display=\"inline\"><mrow><mi>F</mi><mo>=</mo><mrow><mo maxsize=\"260%\" minsize=\"260%\">[</mo><mrow><msup><mi>C</mi><mo>\u2032</mo></msup><mo>+</mo><mrow><msup><mi>C</mi><mi>\u2032\u2032</mi></msup><mo>\u2062</mo><msub><mi>A</mi><mi>T</mi></msub><mo>\u2062</mo><mrow><mi>cos</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>\u03c0</mi><mo>\u2062</mo><msub><mi>f</mi><mi>T</mi></msub><mo>\u2062</mo><mi>t</mi></mrow><mo>+</mo><msub><mi>\u03d5</mi><mi>T</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo maxsize=\"260%\" minsize=\"260%\">]</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\times\\frac{[V_{AC}\\cos(2\\pi f_{A}t+\\phi_{A})+V_{K}+V_{0}]^{2}}{2}.\" display=\"inline\"><mrow><mrow><mi/><mo>\u00d7</mo><mstyle displaystyle=\"true\"><mfrac><msup><mrow><mo stretchy=\"false\">[</mo><mrow><mrow><msub><mi>V</mi><mrow><mi>A</mi><mo>\u2062</mo><mi>C</mi></mrow></msub><mo>\u2062</mo><mrow><mi>cos</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>\u03c0</mi><mo>\u2062</mo><msub><mi>f</mi><mi>A</mi></msub><mo>\u2062</mo><mi>t</mi></mrow><mo>+</mo><msub><mi>\u03d5</mi><mi>A</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><msub><mi>V</mi><mi>K</mi></msub><mo>+</mo><msub><mi>V</mi><mn>0</mn></msub></mrow><mo stretchy=\"false\">]</mo></mrow><mn>2</mn></msup><mn>2</mn></mfrac></mstyle></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\n\tLike Sugawara {\\it et al}. \\cite{Sugawara2012}, we choose $f_{D} = f_{A}+f_{T}$. The case $f_{D} = |f_{A}-f_{T}|$ results in an equivalent force. Then, as with AM-KPFM above, the signal used for H-KPFM feedback depends on the cantilever transfer function and the optical lever sensitivity at the detection frequency, so that the signal at the photodiode is, up to a phase shift:\n\t\n", "itemtype": "equation", "pos": 12701, "prevtext": "\n\t\n\tAs in AM-KPFM, a term linear in $V_{AC}$ is used for the KPFM feedback, and there are three frequencies at which such a signal is generated: $f_{A}$,$f_{A}+f_{T}$, and $|f_{A}-f_{T}|$. The force at the first frequency, proportional to $C'$, is used for AM-KPFM (see equation \\ref{eq:AM_force}), while the forces at the second and third frequencies, each proportional to $C''$, are used for H-KPFM. Then, up to a phase shift, each force is:\n\t\n", "index": 19, "text": "\\begin{align}\n\tF_{f_{D}} = -\\frac{C^{''}A_{T}}{2}V_{AC}(V_{K}+V_{0}).\n\t\\label{eq:H_KPFM}\n\t\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E10.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle F_{f_{D}}=-\\frac{C^{{}^{\\prime\\prime}}A_{T}}{2}V_{AC}(V_{K}+V_{0%&#10;}).\" display=\"inline\"><mrow><mrow><msub><mi>F</mi><msub><mi>f</mi><mi>D</mi></msub></msub><mo>=</mo><mrow><mo>-</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mrow><msup><mi>C</mi><msup><mi/><mi>\u2032\u2032</mi></msup></msup><mo>\u2062</mo><msub><mi>A</mi><mi>T</mi></msub></mrow><mn>2</mn></mfrac></mstyle><mo>\u2062</mo><msub><mi>V</mi><mrow><mi>A</mi><mo>\u2062</mo><mi>C</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>V</mi><mi>K</mi></msub><mo>+</mo><msub><mi>V</mi><mn>0</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\n\t\n\tOnce the phase shift is included, the H-KPFM feedback signal is put in the form of equation \\ref{eq:KPFM_feedback} with sensitivity:\n\t\n", "itemtype": "equation", "pos": 13184, "prevtext": "\n\tLike Sugawara {\\it et al}. \\cite{Sugawara2012}, we choose $f_{D} = f_{A}+f_{T}$. The case $f_{D} = |f_{A}-f_{T}|$ results in an equivalent force. Then, as with AM-KPFM above, the signal used for H-KPFM feedback depends on the cantilever transfer function and the optical lever sensitivity at the detection frequency, so that the signal at the photodiode is, up to a phase shift:\n\t\n", "index": 21, "text": "\\begin{align}\n\tS_{\\text{photo}} &= -\\frac{\\gamma(f_{D})G(f_{D})C^{''}A_{T}}{2}V_{AC}(V_{K}+V_{0}).\n\t\\label{eq:signal_H}\n\t\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E11.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle S_{\\text{photo}}\" display=\"inline\"><msub><mi>S</mi><mtext>photo</mtext></msub></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E11.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=-\\frac{\\gamma(f_{D})G(f_{D})C^{{}^{\\prime\\prime}}A_{T}}{2}V_{AC}%&#10;(V_{K}+V_{0}).\" display=\"inline\"><mrow><mrow><mi/><mo>=</mo><mrow><mo>-</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mrow><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mi>D</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>G</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mi>D</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msup><mi>C</mi><msup><mi/><mi>\u2032\u2032</mi></msup></msup><mo>\u2062</mo><msub><mi>A</mi><mi>T</mi></msub></mrow><mn>2</mn></mfrac></mstyle><mo>\u2062</mo><msub><mi>V</mi><mrow><mi>A</mi><mo>\u2062</mo><mi>C</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>V</mi><mi>K</mi></msub><mo>+</mo><msub><mi>V</mi><mn>0</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\n\t\n\tIn H-KPFM, both the detection frequency, $f_{D}$ and the topographical feedback frequency, $f_{T}$, are free to be chosen, and once chosen, determine the frequency at which $V_{AC}$ is applied, $f_{A}$.\n\tEarlier works on H-KPFM considered the case $f_{T} = f_{1}$, the first cantilever resonance, and $f_{D} = f_{2}$, the second cantilever resonance\\cite{Sugawara2012,Ma2013,Ma2013a}. In this article, this implementation is called \"H2\" for heterodyne amplified by the second cantilever resonance. Here the case $f_{T} = f_{2}$, $f_{D} = f_{1}$ is also considered, for enhanced sensitivity, and we call it \"H1\" because $S_{K}$ is amplified by the first resonance. \n\t\n\\subsection{Experimental Setup}\n\n\tAll methods are implemented on a commercial AFM (Cypher, Asylum Research). The motion of a platinum-coated cantilever is measured with an optical lever employing a 860 nm laser and detected by a quad-photodiode.  The optical lever sensitivity is determined for each eigenmode from amplitude vs. distance curves, and the spring constants are determined by fitting the cantilever's thermal spectrum (table \\ref{table:cantilevers}).\n\t\n\t\\begin{figure}[!htb]\n\t\t\t\t\\centering\n\t\t\t\t\\includegraphics[width=.45\\textwidth]{Figure2}\n\t\t\t\t\\caption{A feedback loop controls the separation between a photothermally driven cantilever and the sample through the cantilever's oscillation amplitude by adjusting the sample height (left). A voltage $V_{AC}$ at frequency $f_{A}$ is added to $V_{K}$, the KPFM voltage, and applied to the probe. The cantilever oscillation at $f_{D}$ is then detected by lock-in amplifier B and used by a feedback loop to control the DC voltage applied to the cantilever (right). A third lock-in amplifier measures the response of $V_{K}$ to a perturbation in order to deduce the KPFM transfer function.\t\n\t\t\t\t}\n\t\t\t\t\\label{fig:HAMKPFMsetup}\n\t\\end{figure}\n\t\n\tKPFM is implemented using two direct digital synthesizers (DDS), each paired with a lock-in amplifier (LIA). In particular, the cantilever is excited at $f_{T}$ photothermally by DDS B (figure \\ref{fig:HAMKPFMsetup}) for topography control. DDS A generates an AC voltage at frequency $f_{A}$ that is applied to the probe. LIA A detects the cantilever's oscillation at $f_{D}$. The relative phases of signals from DDS A and B are maintained through the synchronization of the AFM's internal clock. To measure the transfer function of the KPFM loop, DDS C is used to apply an AC voltage, $V_{p}$ to the substrate. LIA C detects the response of $V_{K}$ to the perturbation. \n\t\n\tAM feedback is used for the topographical loop for all KPFM methods. In our earlier experiment\\cite{Garrett2015}, an FM feedback loop controlled the tip-substrate distance while maintaining attractive-mode scanning\\cite{Garcia1999}. Although FM topography feedback is adapted from the original implementation of H-KPFM\\cite{Sugawara2012}, it contains one major disadvantage: the frequency shift is a non-monotonic function of distance\\cite{Giessibl2003} and so the tip collides with the surface when its motion deviates too far from the topography setpoint. With AM topography control the feedback operates on a signal that is monotonic with distance, except at one bistability that can be avoided\\cite{Garcia1999}. When AM feedback is used for topography, small perturbations, that once destroyed probes, no longer affect scan stability.\n\t\t\t\\begin{table*}\n\t\t\t\t\\caption{Example cantilever characteristics}\n\t\t\t\t\\centering\n\t\t\t\t\\begin{tabular}{ l | c  c  c  c  c  c  c  c }\n\t\t\t\t\t\n\t\t\t\t\tName & $f_{1}$  (kHz)& $k_{1}$ (N/m) & \\hspace{5 pt}$Q_{1}$\\hspace{5 pt} &  $\\gamma_{1}$ (V/nm)& \\hspace{5 pt}$f_{2}$\\hspace{5 pt}  & \\hspace{5 pt}$k_{2}$\\hspace{5 pt} & \\hspace{5 pt}$Q_{2}$\\hspace{5 pt} & \\hspace{5 pt} $\\gamma_{2}$\\hspace{5 pt} \\\\\n\t\t\t\t\t\n\t\t\t\t\t\\hline\n\t\t\t\t\t\n\t\t\t\t\tHQ:CSC35/Pt-C ($\\mu$masch)& 130 & 5.0 & 230 & 0.030 & 810 & 88 & 440 & 0.070 \\\\\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\\end{tabular}\n\t\t\t\t\n\t\t\t\t\\label{table:cantilevers}\n\t\t\t\\end{table*}\n\t\t\t\n\tThe settings for the different KPFM techniques are chosen to realistically represent each technique's capabilities and are similar to those of previous experiments\\cite{Glatzel2003,Zerweck2005}. FM-KPFM is implemented with sideband detection\\cite{Zerweck2005}: $f_{T} = f_{1}$ and $f_{D} = f_{1}+ f_{A}$, and the modulation frequency $f_{A} = 2$ kHz is maintained. For AM-KPFM, $V_{AC}$ is applied at $f_{1}$, and the topography loop operates at $f_{2}$. For H-KPFM, the H1 implementation uses $f_{T} = f_{2}$ and $f_{D} = f_{1}$, while $f_{T} = f_{1}$ and $f_{D} = f_{2}$ for H2 (see figure \\ref{fig:CantileverResponse}). For all methods, $V_{AC}=1 \\text{ V}.$ \n\t\t\t\n\n\t\t\t\n\tAll scans are performed on a micron-sized flake of few-layer graphene (FLG) on boron doped silicon with a thin native oxide layer (15-25 Ohm-cm, Virginia Semiconductor), prepared by exfoliation\\cite{Novoselov2004}. Both flakes of Highly Ordered Pyrolytic Graphite (HOPG) and FLG are observed with AFM. The HOPG is a few tens of nm tall and causes band bending in the Si surface potential at its edges but has negligible patch potentials. The FLG is $\\approx$ 1 nm high and does not change the surface potential of Si around it but is covered with patch potentials. Because the FLG/Si boundary has less topography change, and a surface potential profile that is symmetric around the boundary, it is chosen for the following measurements.\n\\subsection{Eliminating artifacts}\n\tSeveral artifacts originate from signals interfering with the Kelvin probe signal, $S_{K}$ \\cite{Kalinin2000,Diesinger2008,Melin2011,Barbet2014}. Examples of such signals include AC coupling between $V_{AC}$ and a piezo in the cantilever holder (figure \\ref{fig:FreqCurves}) or detection of the topography oscillation (at $f_{T}$) within the lock-in amplifier (LIA) bandwidth (table \\ref{table:artifacts}). The resulting signal detected at the LIA contains both the desired signal, $S_{K}$, and an extraneous signal, $S_{E}$, and is given by:\n\t\n", "itemtype": "equation", "pos": 13454, "prevtext": "\n\t\n\tOnce the phase shift is included, the H-KPFM feedback signal is put in the form of equation \\ref{eq:KPFM_feedback} with sensitivity:\n\t\n", "index": 23, "text": "\\begin{align}\n\t\\zeta_{H}=\\text{Re}\\biggl[\\frac{\\gamma(f_{D})G(f_{D})A_{T}}{2}C^{''}V_{AC}e^{i(\\phi_{T}+\\phi_{A}+\\phi_{D})}\\biggr].\n\t\\label{eq:heterodyne_chi}\n\t\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E12.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\zeta_{H}=\\text{Re}\\biggl{[}\\frac{\\gamma(f_{D})G(f_{D})A_{T}}{2}C%&#10;^{{}^{\\prime\\prime}}V_{AC}e^{i(\\phi_{T}+\\phi_{A}+\\phi_{D})}\\biggr{]}.\" display=\"inline\"><mrow><mrow><msub><mi>\u03b6</mi><mi>H</mi></msub><mo>=</mo><mrow><mtext>Re</mtext><mo>\u2062</mo><mrow><mo maxsize=\"210%\" minsize=\"210%\">[</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mrow><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mi>D</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>G</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mi>D</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>A</mi><mi>T</mi></msub></mrow><mn>2</mn></mfrac></mstyle><mo>\u2062</mo><msup><mi>C</mi><msup><mi/><mi>\u2032\u2032</mi></msup></msup><mo>\u2062</mo><msub><mi>V</mi><mrow><mi>A</mi><mo>\u2062</mo><mi>C</mi></mrow></msub><mo>\u2062</mo><msup><mi>e</mi><mrow><mi>i</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\u03d5</mi><mi>T</mi></msub><mo>+</mo><msub><mi>\u03d5</mi><mi>A</mi></msub><mo>+</mo><msub><mi>\u03d5</mi><mi>D</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msup></mrow><mo maxsize=\"210%\" minsize=\"210%\">]</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\n\tA setpoint, $S_{sp}$ for the voltage feedback loop is chosen to compensate for $S_{E}$ (above we assume $S_{E}=0$, and so a setpoint is not needed). When both $S_{E}$ and $S_{sp}$ are included, the Kelvin probe loop detects the voltage:\n\t\n", "itemtype": "equation", "pos": 19586, "prevtext": "\n\t\n\tIn H-KPFM, both the detection frequency, $f_{D}$ and the topographical feedback frequency, $f_{T}$, are free to be chosen, and once chosen, determine the frequency at which $V_{AC}$ is applied, $f_{A}$.\n\tEarlier works on H-KPFM considered the case $f_{T} = f_{1}$, the first cantilever resonance, and $f_{D} = f_{2}$, the second cantilever resonance\\cite{Sugawara2012,Ma2013,Ma2013a}. In this article, this implementation is called \"H2\" for heterodyne amplified by the second cantilever resonance. Here the case $f_{T} = f_{2}$, $f_{D} = f_{1}$ is also considered, for enhanced sensitivity, and we call it \"H1\" because $S_{K}$ is amplified by the first resonance. \n\t\n\\subsection{Experimental Setup}\n\n\tAll methods are implemented on a commercial AFM (Cypher, Asylum Research). The motion of a platinum-coated cantilever is measured with an optical lever employing a 860 nm laser and detected by a quad-photodiode.  The optical lever sensitivity is determined for each eigenmode from amplitude vs. distance curves, and the spring constants are determined by fitting the cantilever's thermal spectrum (table \\ref{table:cantilevers}).\n\t\n\t\\begin{figure}[!htb]\n\t\t\t\t\\centering\n\t\t\t\t\\includegraphics[width=.45\\textwidth]{Figure2}\n\t\t\t\t\\caption{A feedback loop controls the separation between a photothermally driven cantilever and the sample through the cantilever's oscillation amplitude by adjusting the sample height (left). A voltage $V_{AC}$ at frequency $f_{A}$ is added to $V_{K}$, the KPFM voltage, and applied to the probe. The cantilever oscillation at $f_{D}$ is then detected by lock-in amplifier B and used by a feedback loop to control the DC voltage applied to the cantilever (right). A third lock-in amplifier measures the response of $V_{K}$ to a perturbation in order to deduce the KPFM transfer function.\t\n\t\t\t\t}\n\t\t\t\t\\label{fig:HAMKPFMsetup}\n\t\\end{figure}\n\t\n\tKPFM is implemented using two direct digital synthesizers (DDS), each paired with a lock-in amplifier (LIA). In particular, the cantilever is excited at $f_{T}$ photothermally by DDS B (figure \\ref{fig:HAMKPFMsetup}) for topography control. DDS A generates an AC voltage at frequency $f_{A}$ that is applied to the probe. LIA A detects the cantilever's oscillation at $f_{D}$. The relative phases of signals from DDS A and B are maintained through the synchronization of the AFM's internal clock. To measure the transfer function of the KPFM loop, DDS C is used to apply an AC voltage, $V_{p}$ to the substrate. LIA C detects the response of $V_{K}$ to the perturbation. \n\t\n\tAM feedback is used for the topographical loop for all KPFM methods. In our earlier experiment\\cite{Garrett2015}, an FM feedback loop controlled the tip-substrate distance while maintaining attractive-mode scanning\\cite{Garcia1999}. Although FM topography feedback is adapted from the original implementation of H-KPFM\\cite{Sugawara2012}, it contains one major disadvantage: the frequency shift is a non-monotonic function of distance\\cite{Giessibl2003} and so the tip collides with the surface when its motion deviates too far from the topography setpoint. With AM topography control the feedback operates on a signal that is monotonic with distance, except at one bistability that can be avoided\\cite{Garcia1999}. When AM feedback is used for topography, small perturbations, that once destroyed probes, no longer affect scan stability.\n\t\t\t\\begin{table*}\n\t\t\t\t\\caption{Example cantilever characteristics}\n\t\t\t\t\\centering\n\t\t\t\t\\begin{tabular}{ l | c  c  c  c  c  c  c  c }\n\t\t\t\t\t\n\t\t\t\t\tName & $f_{1}$  (kHz)& $k_{1}$ (N/m) & \\hspace{5 pt}$Q_{1}$\\hspace{5 pt} &  $\\gamma_{1}$ (V/nm)& \\hspace{5 pt}$f_{2}$\\hspace{5 pt}  & \\hspace{5 pt}$k_{2}$\\hspace{5 pt} & \\hspace{5 pt}$Q_{2}$\\hspace{5 pt} & \\hspace{5 pt} $\\gamma_{2}$\\hspace{5 pt} \\\\\n\t\t\t\t\t\n\t\t\t\t\t\\hline\n\t\t\t\t\t\n\t\t\t\t\tHQ:CSC35/Pt-C ($\\mu$masch)& 130 & 5.0 & 230 & 0.030 & 810 & 88 & 440 & 0.070 \\\\\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\\end{tabular}\n\t\t\t\t\n\t\t\t\t\\label{table:cantilevers}\n\t\t\t\\end{table*}\n\t\t\t\n\tThe settings for the different KPFM techniques are chosen to realistically represent each technique's capabilities and are similar to those of previous experiments\\cite{Glatzel2003,Zerweck2005}. FM-KPFM is implemented with sideband detection\\cite{Zerweck2005}: $f_{T} = f_{1}$ and $f_{D} = f_{1}+ f_{A}$, and the modulation frequency $f_{A} = 2$ kHz is maintained. For AM-KPFM, $V_{AC}$ is applied at $f_{1}$, and the topography loop operates at $f_{2}$. For H-KPFM, the H1 implementation uses $f_{T} = f_{2}$ and $f_{D} = f_{1}$, while $f_{T} = f_{1}$ and $f_{D} = f_{2}$ for H2 (see figure \\ref{fig:CantileverResponse}). For all methods, $V_{AC}=1 \\text{ V}.$ \n\t\t\t\n\n\t\t\t\n\tAll scans are performed on a micron-sized flake of few-layer graphene (FLG) on boron doped silicon with a thin native oxide layer (15-25 Ohm-cm, Virginia Semiconductor), prepared by exfoliation\\cite{Novoselov2004}. Both flakes of Highly Ordered Pyrolytic Graphite (HOPG) and FLG are observed with AFM. The HOPG is a few tens of nm tall and causes band bending in the Si surface potential at its edges but has negligible patch potentials. The FLG is $\\approx$ 1 nm high and does not change the surface potential of Si around it but is covered with patch potentials. Because the FLG/Si boundary has less topography change, and a surface potential profile that is symmetric around the boundary, it is chosen for the following measurements.\n\\subsection{Eliminating artifacts}\n\tSeveral artifacts originate from signals interfering with the Kelvin probe signal, $S_{K}$ \\cite{Kalinin2000,Diesinger2008,Melin2011,Barbet2014}. Examples of such signals include AC coupling between $V_{AC}$ and a piezo in the cantilever holder (figure \\ref{fig:FreqCurves}) or detection of the topography oscillation (at $f_{T}$) within the lock-in amplifier (LIA) bandwidth (table \\ref{table:artifacts}). The resulting signal detected at the LIA contains both the desired signal, $S_{K}$, and an extraneous signal, $S_{E}$, and is given by:\n\t\n", "index": 25, "text": "\\begin{align}\n\tS_{LIA}^{i} = S_{K}+ S_{E}.\n\t\\label{eq:Extra_signal}\n\t\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E13.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle S_{LIA}^{i}=S_{K}+S_{E}.\" display=\"inline\"><mrow><mrow><msubsup><mi>S</mi><mrow><mi>L</mi><mo>\u2062</mo><mi>I</mi><mo>\u2062</mo><mi>A</mi></mrow><mi>i</mi></msubsup><mo>=</mo><mrow><msub><mi>S</mi><mi>K</mi></msub><mo>+</mo><msub><mi>S</mi><mi>E</mi></msub></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\n\twhich contains an extraneous voltage:\n\t\n", "itemtype": "equation", "pos": 19906, "prevtext": "\n\tA setpoint, $S_{sp}$ for the voltage feedback loop is chosen to compensate for $S_{E}$ (above we assume $S_{E}=0$, and so a setpoint is not needed). When both $S_{E}$ and $S_{sp}$ are included, the Kelvin probe loop detects the voltage:\n\t\n", "index": 27, "text": "\\begin{align}\n\tV_{K} = -V_{0} + V_{E},\n\t\\label{eq:extra_voltage_inVK}\n\t\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle V_{K}=-V_{0}+V_{E},\" display=\"inline\"><mrow><mrow><msub><mi>V</mi><mi>K</mi></msub><mo>=</mo><mrow><mrow><mo>-</mo><msub><mi>V</mi><mn>0</mn></msub></mrow><mo>+</mo><msub><mi>V</mi><mi>E</mi></msub></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\n\t\n\t\t\t\\begin{figure}[!htb]\n\t\t\t\t\\centering\n\t\t\t\t\\includegraphics[width=.45\\textwidth]{Figure3}\n\t\t\t\t\\caption{H-KPFM removes the distortion caused by AC coupling in the KPFM signal vs. detection frequency curves ($S^{i}_{LIA}$ vs $f_{D}$ and  $S^{q}_{LIA}$ vs $f_{D}$). (a,b) At the first eigenmode, the in-phase ($i$) and quadrature ($q$) components of the AM-KPFM signal show little distortion, but (e,f) at the second eigenmode, distortion due to inductive AC coupling between the KPFM voltage and tip holder, which increases with frequency, is observed. (c,d,g,h) Heterodyne excitation generates no distortion. The KPFM voltage applied to the tip, $V_{K}$, is sampled at values above and below the contact potential difference. Similar measurements were used to detect AC coupling in \\cite{Diesinger2008}.}\n\t\t\t\t\\label{fig:FreqCurves}\n\t\t\t\\end{figure}\n\t\n\tThe topography is imprinted on $V_{K}$ through the height-dependence of $\\zeta_{j}$, the sensitivity from equation \\ref{eq:KPFM_feedback}, which complicates attempts to remove the artifact in post-processing\\cite{Barbet2014}. If $S_{E}$ is small enough and does not vary in time, $S_{sp}$ can be chosen so that the numerator of equation \\ref{eq:V_error} vanishes.\n\t\t\n\t\\begin{figure}[!ht]\n\t\t\\centering\n\t\t\\includegraphics[width=.45\\textwidth]{Figure4}\n\t\t\\caption{The setpoint of the KPFM feedback loop is adjusted to minimize the height-dependence of the KPFM voltage, $V_{K}$. Here the setpoint is swept from 150 to 350 $\\mu$V over several approaches. The center curve (240 $\\mu$V, $\\color{red}\\bullet$) shows a distance dependence of only 0.03 mV/nm. The dark blue curve indicates the topographical oscillation amplitude normalized to its value far from the surface. }\n\t\t\\label{fig:Distance_curves}\n\t\\end{figure}\n\t\t\n\t\tConversely, the height dependence of $V_{E}$ can also be used to identify $S_{E}$.\n\t\tIn this paper, the height dependence of $V_{K}$ is used to choose $S_{sp}$. If a sample has uniform surface potential, then:\n\t\t\n\t\t\n", "itemtype": "equation", "pos": 20029, "prevtext": "\n\twhich contains an extraneous voltage:\n\t\n", "index": 29, "text": "\\begin{align}\n\tV_{E} =  \\frac{S_{E}-S_{sp}}{\\zeta_{j}}.\n\t\\label{eq:V_error}\n\t\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E15.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle V_{E}=\\frac{S_{E}-S_{sp}}{\\zeta_{j}}.\" display=\"inline\"><mrow><mrow><msub><mi>V</mi><mi>E</mi></msub><mo>=</mo><mstyle displaystyle=\"true\"><mfrac><mrow><msub><mi>S</mi><mi>E</mi></msub><mo>-</mo><msub><mi>S</mi><mrow><mi>s</mi><mo>\u2062</mo><mi>p</mi></mrow></msub></mrow><msub><mi>\u03b6</mi><mi>j</mi></msub></mfrac></mstyle></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\n\t\tIf $dV_{K}/d\\bar{z}\\approx 0$, then $S_{sp}\\approx S_{E}$, as $d\\zeta_{j}/d\\bar{z}$ does not vanish. \n\t\t\n\t\tTo minimize $V_{E}$, the KPFM feedback setpoint, $S_{sp}$, is varied over a range of 200 $\\mu$V, and a $V_{K}$ vs. height curve is recorded for each $S_{sp}$ (figure \\ref{fig:Distance_curves}). For most $S_{sp}$, the measured $V_{K}$ does depend on height, indicating that $S_{sp}\\neq S_{E}$. The variation amongst the curves decreases when the tip-sample separation is reduced (until intermittent contact with the sample begins at $\\approx$ 20 nm). The setpoint with the least distance dependence (240 $\\mu$V), is maintained for the KPFM scans. The offset originates at the output of the low-pass filter on the lock-in amplifier for our setup, and it varies slightly from day to day, so the calibration must be repeated for every set of measurements.\n\t\t\n\t\\begin{table*}\n\t\t\\small\n\t\t\\caption{Common artifacts in Kelvin Probe Force Microscopy}\n\t\t\\centering\n\t\t\\begin{tabular}{ l | l |  c | c | c }\n\t\t\t\\hline\n\t\t\tType & Example Source & H & FM & AM \\\\\n\t\t\t\n\t\t\t\\hline\n\t\t\tExtraneous Signal ($S_{E}$)&&&&\\\\\n\t\t\t\\hspace{10 pt}\\textit{Time-independent}  & AC inductive coupling, between $V_{AC}$ and piezo (figure \\ref{fig:FreqCurves})\\cite{Barbet2014}&-&-& $\\times$\\\\\n\n\t\t\t\\hspace{10 pt}\\textit{Periodic}&  Topographical oscillation detected in voltage bandwidth (figure \\ref{fig:V_speed}i)& - & $\\times$ & -\\\\\n\n\t\t\t\\hspace{10 pt}\\textit{Intermittent} & Collision with surface &$\\times$ &$\\times$&$\\times$\\\\\n\t\t\t\\hline \n\t\t\tStray Capacitance &  Long-range electrostatic force from cantilever \\cite{Jacobs1997,Colchero2001,Ma2013}&-&-& $\\times$\\\\ \n\t\t\t\\hline\n\t\t\t\n\t\t\\end{tabular}\n\t\t\n\t\t\\begin{tabular}{c}\n\t\t\tLegend:\t$\\times$ =  large artifact, - = small artifact \n\t\t\\end{tabular}\n\t\t\\vspace*{-\\baselineskip}\n\t\t\\label{table:artifacts}\n\t\\end{table*}\n\n\\section{Resolutions}\\label{sec:on-resolution}\n\nThe temporal, voltage, and spatial resolutions of the different KPFM implementations discussed above are compared through several tests, the results of which are summarized in table \\ref{table:resolutions}. \n\n\\subsection{Time Resolution}\n\nH-KPFM achieves fast time resolution by avoiding several artifacts that limit speed of the other KPFM techniques (Table \\ref{table:artifacts}). Higher resonant frequencies are expected to increase bandwidth, but, for AM-KPFM, they also increase the AC coupling\\cite{Diesinger2008} (figure \\ref{fig:FreqCurves}).  AC coupling does not affect H-KPFM or FM-KPFM as significantly because the applied and detected signals are at different frequencies. Consequently, H-KPFM can employ cantilevers with higher resonant frequencies than AM-KPFM. FM-KPFM scan speed is limited by a periodic $S_{E}$ induced by the topographic oscillation. In both H- and FM-KPFM, topography and KPFM signals must be present at the same time. In FM-KPFM this causes an extraneous voltage because the two signals are so close in frequency space. The extraneous is estimated by considering how the cantilever oscillation $A_{T}$ at $f_{T}$ is detected by a lock-in amplifier with reference signal at $f_{D}$, and then inputting that signal into equation \\ref{eq:V_error}, so that the extraneous voltage is: \n\n", "itemtype": "equation", "pos": 22103, "prevtext": "\n\t\n\t\t\t\\begin{figure}[!htb]\n\t\t\t\t\\centering\n\t\t\t\t\\includegraphics[width=.45\\textwidth]{Figure3}\n\t\t\t\t\\caption{H-KPFM removes the distortion caused by AC coupling in the KPFM signal vs. detection frequency curves ($S^{i}_{LIA}$ vs $f_{D}$ and  $S^{q}_{LIA}$ vs $f_{D}$). (a,b) At the first eigenmode, the in-phase ($i$) and quadrature ($q$) components of the AM-KPFM signal show little distortion, but (e,f) at the second eigenmode, distortion due to inductive AC coupling between the KPFM voltage and tip holder, which increases with frequency, is observed. (c,d,g,h) Heterodyne excitation generates no distortion. The KPFM voltage applied to the tip, $V_{K}$, is sampled at values above and below the contact potential difference. Similar measurements were used to detect AC coupling in \\cite{Diesinger2008}.}\n\t\t\t\t\\label{fig:FreqCurves}\n\t\t\t\\end{figure}\n\t\n\tThe topography is imprinted on $V_{K}$ through the height-dependence of $\\zeta_{j}$, the sensitivity from equation \\ref{eq:KPFM_feedback}, which complicates attempts to remove the artifact in post-processing\\cite{Barbet2014}. If $S_{E}$ is small enough and does not vary in time, $S_{sp}$ can be chosen so that the numerator of equation \\ref{eq:V_error} vanishes.\n\t\t\n\t\\begin{figure}[!ht]\n\t\t\\centering\n\t\t\\includegraphics[width=.45\\textwidth]{Figure4}\n\t\t\\caption{The setpoint of the KPFM feedback loop is adjusted to minimize the height-dependence of the KPFM voltage, $V_{K}$. Here the setpoint is swept from 150 to 350 $\\mu$V over several approaches. The center curve (240 $\\mu$V, $\\color{red}\\bullet$) shows a distance dependence of only 0.03 mV/nm. The dark blue curve indicates the topographical oscillation amplitude normalized to its value far from the surface. }\n\t\t\\label{fig:Distance_curves}\n\t\\end{figure}\n\t\t\n\t\tConversely, the height dependence of $V_{E}$ can also be used to identify $S_{E}$.\n\t\tIn this paper, the height dependence of $V_{K}$ is used to choose $S_{sp}$. If a sample has uniform surface potential, then:\n\t\t\n\t\t\n", "index": 31, "text": "\\begin{align}\n\t\t\\frac{dV_{K}}{d\\bar{z}} = \\frac{dV_{E}}{d\\bar{z}} = \\frac{S_{sp}-S_{E}}{\\zeta_{j}^{2}}\\frac{d\\zeta_{j}}{d\\bar{z}}.\n\t\t\\label{eq:calibratin}\n\t\t\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E16.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\frac{dV_{K}}{d\\bar{z}}=\\frac{dV_{E}}{d\\bar{z}}=\\frac{S_{sp}-S_{E%&#10;}}{\\zeta_{j}^{2}}\\frac{d\\zeta_{j}}{d\\bar{z}}.\" display=\"inline\"><mrow><mrow><mstyle displaystyle=\"true\"><mfrac><mrow><mi>d</mi><mo>\u2062</mo><msub><mi>V</mi><mi>K</mi></msub></mrow><mrow><mi>d</mi><mo>\u2062</mo><mover accent=\"true\"><mi>z</mi><mo stretchy=\"false\">\u00af</mo></mover></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\"><mfrac><mrow><mi>d</mi><mo>\u2062</mo><msub><mi>V</mi><mi>E</mi></msub></mrow><mrow><mi>d</mi><mo>\u2062</mo><mover accent=\"true\"><mi>z</mi><mo stretchy=\"false\">\u00af</mo></mover></mrow></mfrac></mstyle><mo>=</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mrow><msub><mi>S</mi><mrow><mi>s</mi><mo>\u2062</mo><mi>p</mi></mrow></msub><mo>-</mo><msub><mi>S</mi><mi>E</mi></msub></mrow><msubsup><mi>\u03b6</mi><mi>j</mi><mn>2</mn></msubsup></mfrac></mstyle><mo>\u2062</mo><mstyle displaystyle=\"true\"><mfrac><mrow><mi>d</mi><mo>\u2062</mo><msub><mi>\u03b6</mi><mi>j</mi></msub></mrow><mrow><mi>d</mi><mo>\u2062</mo><mover accent=\"true\"><mi>z</mi><mo stretchy=\"false\">\u00af</mo></mover></mrow></mfrac></mstyle></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\nwhere $B$ is the bandwidth of the LIA's low-pass filter, and we set $S_{sp}=0$ for simplicity. In typical KPFM operation, the prefactor, $\\frac{\\gamma(f_{T})A_{T}}{\\zeta_{j}}$, is large compared to the surface voltage contrast being measured. To reduce $V_{E}^{\\text{top}}$ then, $B$ must be chosen so that $B\\ll f_{A}$. For H-KPFM $f_{A}>$100 kHz, so the bound on $B$ is large. For FM-KPFM, however, $f_{A}\\approx1-3$ kHz, and so $B$ is limited to several hundred hertz. The bandwidth of the lock-in amplifier then limits KPFM operation speed. Note also that $V_{E}^{\\text{top}}$ is periodic in time, and so it cannot be mitigated by varying the KPFM feedback loop setpoint. \n\nPrevious measurements of time resolution either investigate the KPFM feedback loop response to a periodic voltage applied to the setpoint\\cite{Zerweck2005}, or substrate \\cite{Diesinger2010}, or how quickly a well-characterized sample can be scanned while retaining KPFM contrast\\cite{Sinensky2007}. Here the former method is used to estimate the cut-off frequency, $f_{c}$, which is defined as the frequency at which the KPFM loop response has dropped to $\\approx 71\\%$ of the low-frequency response (-3 dB). In table \\ref{table:resolutions}, the cut-off time, $t_{c} =  1/f_{c}$, is listed instead, so that smaller values indicate a better resolution.\n\nThe reported time resolutions of AM-KPFM exceed those of FM-KPFM, even though the specific resolution depends on both the cantilever and atomic force microscope used. Diesinger {\\it et al.}\\cite{Diesinger2010} report an implementation of AM-KPFM that achieves $f_{c}\\approx200$ Hz, limited by the analog-digital conversion of the KPFM loop. In air, Sinensky {\\it et al.} demonstrate that AM-KPFM can maintain some voltage contrast at scan speeds up to 1,172 $\\mu$m s$^{-1}$, by scanning 2-$\\mu$m wide stripes of DNA\\cite{Sinensky2007}. In the language used here, that corresponds to $f_{c}\\approx1.2$ kHz. FM-KPFM is reported to operate with similar speed when either in the sideband ($f_{c}\\approx35 $ Hz) or phase locked loop ($f_{c}\\approx30$ Hz) are used, even though the sources of speed limitation are dissimilar\\cite{Zerweck2005,Diesinger2014}. Recent improvements to the KPFM feedback increase the cut-off frequency to $\\approx$ 100 Hz\\cite{Wagner2015a}. Open-loop FM-KPFM retains contrast up to scan speeds of $\\approx1.10$ $\\mu$m$^{-1}s^{-1}$ (or 5 min per 256$\\times$256 pixel scan)\\cite{Borgani2014a}.\n\n\n\\begin{figure}[!ht]\t\t\t\t\n\t\\centering\t\t\t\t\t\t\t\n\t\\includegraphics[width=.45\\textwidth]{Figure5}\n\t\\caption{ The transfer functions for the different KPFM methods are measured by applying a periodic voltage perturbation to the substrate and recording the response of the KPFM loop. (a) The transfer function of a H-KPFM voltage feedback loop increases and becomes more uniform as the gain is increased (H2 implementation). The proportional gain is increased 3 orders of magnitude, and overshoot is constrained to $\\frac{V_{K}}{V_{p}}\\leq1.2$. A dashed line indicates the -3 db point used to calculate the cut-off frequency, $f_{c}$. (b) The cut-off frequency depends strongly on the method used, varying by almost an order of magnitude. The gain for each of the methods is chosen by the same optimization procedure.\n\t}\t\t\n\t\\label{fig:transfers}\n\\end{figure}\n\nTo measure the closed loop transfer function of each KPFM method, an AC voltage ($V_{p}=1$ V at perturbation frequency $f_{p}$) is applied to the substrate by a third DDS, while the cantilever height is maintained at the surface by a topographical feedback loop, with $A_{T}\\approx8$ nm. The KPFM loop tracks the voltage, and $V_{K}(f_{p})$ is detected by a third lock-in amplifier. The frequency is swept from $f_{p}$ = 10 Hz to 25 kHz. The proportional gain of the control loop is increased until the bandwidth stops increasing, and the integral gain is then increased until the transfer function is flat across its bandwidth (figure \\ref{fig:transfers}). The cutoff frequencies for H2, H1, and AM are $5.3, 2.3,$ and $5.0$ kHz, respectively (table \\ref{table:resolutions}). By further optimizing the feedback loops the bandwidth might be increased\\cite{Diesinger2010,Bechhoefer2005,Wagner2015a}.\n\nThe measurement of the FM-KPFM transfer function is complicated by the presence of the topological feedback signal near the KPFM signal, which causes $V_{K}$ to include an extraneous, rapidly oscillating voltage (see equation \\ref{eq:FM_error}). First the transfer function is measured with only the lock-in amplifier's own low-pass filter, but the extraneous voltage is so large that it overwhelms the signal until the frequency of the low-pass filter is decreased to 700 Hz, giving $f_{c}\\approx400$ Hz. However, the extraneous voltage imprinted by the topography signal remains $\\approx400$ mV, prohibitively large for practical measurements. Second, a notch filter is placed on the lock-in amplifier at $f_{A}$ (2 kHz) in order to further mitigate $V_{E}^{\\text{top}}$. The notch filter both decreases $V_{E}^{\\text{top}}$, and also allows the filter on the lock-in amplifier to be increased to 1 kHz. In this configuration the cutoff frequency of FM-KFPM is determined to be $f_{c}\\approx820$ Hz.\n\nTo investigate how $f_{c}$ translates into imaging speed, a few-layer graphene (FLG) flake is scanned with H- and FM-KPFM while the line scan speed is continually increased from 1 Hz to 79 Hz, while scanning a 1$\\times$1 $\\mu$m area with 256$\\times$256 pixels with $A_{T}$ = 16 nm (figure \\ref{fig:V_speed}). By 4 Hz (48 s per frame), FM-KPFM shows stripes caused by $V_{E}^{\\text{top}}$. At higher frequencies, the FM feedback loop oscillates wildly near the edges of the FLG. With H-KPFM, on the other hand, clear contrast is maintained up to 16 Hz (16 s per frame), and at higher frequencies some contrast is maintained. However, the topographical feedback loop stops tracking the surface, and topographical inconsistency affects the potential image. At 79 Hz, patches on the graphene flake are no longer visible. A similar limitation due to topographical feedback loop speed is reported in \\cite{Sinensky2007}. \n\n\t\\begin{figure}[!ht]\n\t\t\\centering\n\t\t\\includegraphics[width=.45\\textwidth]{Figure6}\n\t\t\\caption{Images show the affect of increasing scan speed. (a-c) Topography images of the few layer graphene (FLG) become blurred. (d-f) H-KPFM allows the potential of FLG to be imaged with increasing speed with minimal distortion. (g-i) The topography oscillation is imprinted on the potential image when the bandwidth is increased if FM-KPFM is used. Topography scanning may be the primary speed limit. The height of the FLG is  $\\approx2$ nm. All scans are 256$\\times$256 pixels.}\n\t\t\\label{fig:V_speed}\n\t\\end{figure}\n\t\n\\begin{table*}[ht]\n\t\\small\n\t\\caption{Resolutions that characterize KPFM}\n\t\\centering\n\t\\begin{tabular}{l | c  | l  | r  r  r  r r}\n\t\t\\hline\n\t\tResolution & Figure of Merit  & Definition  & \\hspace{10 pt} H2    & \\hspace{10 pt}H1    & \\hspace{10 pt}FM    & \\hspace{10 pt}   AM & (units)\\\\\n\t\t\\hline\n\t\tTime* &  $t_{c}=1/f_{c}$  & Closed-loop 3 dB cut-off time\\cite{Diesinger2010} & 0.19 & 0.43 & 1.2 & 0.20 & ms\\\\\n\t\t&&&&&&&\\\\\n\t\t\\hline\n\t\tVoltage** & $V_{m}$ &  $V = V_{K}+V_{0}$ for which signal = noise\\cite{Nonnenmacher1991}& 73 & 41 & 96 & 2.0& mV\\\\\n\t\t& &   & &&&&\\\\\n\t\t\\hline\n\t\tSpace** & $l_{10-90}$ & Distance from boundary over which voltage & 45 & 42 & 49 & 68& nm\\\\ & & changes from 10\\% to 90\\% \\cite{Zerweck2005} &   &&&&\\\\\n\t\t\\hline\n\t\\end{tabular}\n\t\n\t\\begin{tabular}{c}\n\t\t*At $A_{T}=8$ nm, $V_{AC}=1$, $V_{p}=1$ V, and at the surface, with topographical feedback on\\\\\n\t\t**At $A_{T}=8$ nm, Bandwidth = 200 Hz, $V_{AC}$=1 V, and lift height 11 nm\\\\\n\t\\end{tabular}\n\t\\label{table:resolutions}\n\\end{table*}\n\\subsection{Voltage Resolution}\t\n\n\\subsubsection{Accuracy}\n\\label{sec:Accuracy}\n\n Whereas the tip apex detects the potential directly beneath it, the inclusion of stray capacitance of the cantilever results in surface potential spatially averaged over many microns (about the width of the cantilever)\\cite{Jacobs1997,Koley2001,Colchero2001,Ma2013}. The unknown and varying relative capacitances of the tip apex and cantilever limit AM-KPFM to qualitative contrast in most conditions\\cite{Jacobs1997,Colchero2001}. Both H-KPFM and FM-KFPM mitigate the stray capacitance effect through their dependence on $C''$ rather than $C'$\\cite{Glatzel2003,Ma2013}. Here the stray capacitance must be assessed in order to understand the relation between the measured potential sensitivity and the ability to actually distinguish between two nanoscale objects. \n\nThe capacitance of tip and cantilever changes with tip-sample separation, and consequently, so does the measured average voltage contrast between the FLG flake and Si substrate,  $\\Delta V$. The correspondence between the actual and measured potentials is tested by observing the change of $\\Delta V$ with lift height, akin to \\cite{Spadafora2011}. At closest approach the tip apex capacitance dominates. As the tip-sample separation is increased, $\\Delta V$ changes little until the proportion of capacitance due to the apex decreases to a value comparable to the cantilever capacitance contribution. The criterion of $\\frac{d\\Delta V}{d\\bar{z}}\\approx0$ near the surface is adopted to ensure that the apex contribution dominates. In the limit of large lift height, the cantilever contribution dominates, and no potential contrast is observed.\n\nThe contrast between Si and FLG change little for H- and FM-KPFM, as the cantilever lift height is varied (figure \\ref{fig:Distance_and_dv}a-c,g). On the other hand, the AM-KPFM detected voltage contrast changes by a factor of five as the lift height is decreased from 100 to 4 nm (figure \\ref{fig:Distance_and_dv}d-f,g). Thus the average potential contrast measured with $C''$ methods is more accurate than the contrast measured by AM-KPFM. \n\n\\begin{figure}[h]\t\t\t\t\n\t\\centering\t\t\t\t\t\t\t\n\t\\includegraphics[width=.45\\textwidth]{Figure7}\n\t\\caption{The voltage contrast between a few layer graphene (FLG) flake and Si substrate reveals the stray capacitance effect. (a-c) The voltage contrast between (few-layer) graphene and silicon changes little as the probe height increases from 4 to 100 nm for H-KPFM. (d-f) However, for AM-KPFM, the contrast at 100 nm differs by a factor of five from that at 4 nm. (g) A comparison between the four different KPFM methods shows that methods that depend on $C''$ more accurately represent the potential contrast than AM-KPFM, which depends on $C'$.\n\t}\t\t\n\t\\label{fig:Distance_and_dv}\n\\end{figure}\n\\subsubsection{Minimum detectable voltage}\n\nThe minimum detectable voltage, $V_{m}$, is the tip-sample voltage difference at which the signal is equal to the noise\\cite{Nonnenmacher1991,Giessibl2003,Sugawara2012,Ma2013a}. Here we consider a flat, broadband noise source with noise power spectral density $n_{B}$ present in $S^{i}_{LIA}$, so that the minimum detectable voltage is:\n\n", "itemtype": "equation", "pos": 25476, "prevtext": "\n\t\tIf $dV_{K}/d\\bar{z}\\approx 0$, then $S_{sp}\\approx S_{E}$, as $d\\zeta_{j}/d\\bar{z}$ does not vanish. \n\t\t\n\t\tTo minimize $V_{E}$, the KPFM feedback setpoint, $S_{sp}$, is varied over a range of 200 $\\mu$V, and a $V_{K}$ vs. height curve is recorded for each $S_{sp}$ (figure \\ref{fig:Distance_curves}). For most $S_{sp}$, the measured $V_{K}$ does depend on height, indicating that $S_{sp}\\neq S_{E}$. The variation amongst the curves decreases when the tip-sample separation is reduced (until intermittent contact with the sample begins at $\\approx$ 20 nm). The setpoint with the least distance dependence (240 $\\mu$V), is maintained for the KPFM scans. The offset originates at the output of the low-pass filter on the lock-in amplifier for our setup, and it varies slightly from day to day, so the calibration must be repeated for every set of measurements.\n\t\t\n\t\\begin{table*}\n\t\t\\small\n\t\t\\caption{Common artifacts in Kelvin Probe Force Microscopy}\n\t\t\\centering\n\t\t\\begin{tabular}{ l | l |  c | c | c }\n\t\t\t\\hline\n\t\t\tType & Example Source & H & FM & AM \\\\\n\t\t\t\n\t\t\t\\hline\n\t\t\tExtraneous Signal ($S_{E}$)&&&&\\\\\n\t\t\t\\hspace{10 pt}\\textit{Time-independent}  & AC inductive coupling, between $V_{AC}$ and piezo (figure \\ref{fig:FreqCurves})\\cite{Barbet2014}&-&-& $\\times$\\\\\n\n\t\t\t\\hspace{10 pt}\\textit{Periodic}&  Topographical oscillation detected in voltage bandwidth (figure \\ref{fig:V_speed}i)& - & $\\times$ & -\\\\\n\n\t\t\t\\hspace{10 pt}\\textit{Intermittent} & Collision with surface &$\\times$ &$\\times$&$\\times$\\\\\n\t\t\t\\hline \n\t\t\tStray Capacitance &  Long-range electrostatic force from cantilever \\cite{Jacobs1997,Colchero2001,Ma2013}&-&-& $\\times$\\\\ \n\t\t\t\\hline\n\t\t\t\n\t\t\\end{tabular}\n\t\t\n\t\t\\begin{tabular}{c}\n\t\t\tLegend:\t$\\times$ =  large artifact, - = small artifact \n\t\t\\end{tabular}\n\t\t\\vspace*{-\\baselineskip}\n\t\t\\label{table:artifacts}\n\t\\end{table*}\n\n\\section{Resolutions}\\label{sec:on-resolution}\n\nThe temporal, voltage, and spatial resolutions of the different KPFM implementations discussed above are compared through several tests, the results of which are summarized in table \\ref{table:resolutions}. \n\n\\subsection{Time Resolution}\n\nH-KPFM achieves fast time resolution by avoiding several artifacts that limit speed of the other KPFM techniques (Table \\ref{table:artifacts}). Higher resonant frequencies are expected to increase bandwidth, but, for AM-KPFM, they also increase the AC coupling\\cite{Diesinger2008} (figure \\ref{fig:FreqCurves}).  AC coupling does not affect H-KPFM or FM-KPFM as significantly because the applied and detected signals are at different frequencies. Consequently, H-KPFM can employ cantilevers with higher resonant frequencies than AM-KPFM. FM-KPFM scan speed is limited by a periodic $S_{E}$ induced by the topographic oscillation. In both H- and FM-KPFM, topography and KPFM signals must be present at the same time. In FM-KPFM this causes an extraneous voltage because the two signals are so close in frequency space. The extraneous is estimated by considering how the cantilever oscillation $A_{T}$ at $f_{T}$ is detected by a lock-in amplifier with reference signal at $f_{D}$, and then inputting that signal into equation \\ref{eq:V_error}, so that the extraneous voltage is: \n\n", "index": 33, "text": "\\begin{align}\nV_{E}^{\\text{top}} = \\frac{\\gamma(f_{T})A_{T}}{\\zeta_{j}} \\text{Re}\\Bigg[\\frac{e^{i(2\\pi f_{A} t)}}{1+if_{A}/B}\\Bigg],\n\\label{eq:FM_error}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E17.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle V_{E}^{\\text{top}}=\\frac{\\gamma(f_{T})A_{T}}{\\zeta_{j}}\\text{Re}%&#10;\\Bigg{[}\\frac{e^{i(2\\pi f_{A}t)}}{1+if_{A}/B}\\Bigg{]},\" display=\"inline\"><mrow><mrow><msubsup><mi>V</mi><mi>E</mi><mtext>top</mtext></msubsup><mo>=</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mrow><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mi>T</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>A</mi><mi>T</mi></msub></mrow><msub><mi>\u03b6</mi><mi>j</mi></msub></mfrac></mstyle><mo>\u2062</mo><mtext>Re</mtext><mo>\u2062</mo><mrow><mo maxsize=\"260%\" minsize=\"260%\">[</mo><mstyle displaystyle=\"true\"><mfrac><msup><mi>e</mi><mrow><mi>i</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mn>2</mn><mo>\u2062</mo><mi>\u03c0</mi><mo>\u2062</mo><msub><mi>f</mi><mi>A</mi></msub><mo>\u2062</mo><mi>t</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msup><mrow><mn>1</mn><mo>+</mo><mrow><mrow><mi>i</mi><mo>\u2062</mo><msub><mi>f</mi><mi>A</mi></msub></mrow><mo>/</mo><mi>B</mi></mrow></mrow></mfrac></mstyle><mo maxsize=\"260%\" minsize=\"260%\">]</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\nwhere $B$ is the detection bandwidth. By incorporating the H-KPFM sensitivity from equation \\ref{eq:heterodyne_chi}, it becomes:\n\n", "itemtype": "equation", "pos": 36578, "prevtext": "\nwhere $B$ is the bandwidth of the LIA's low-pass filter, and we set $S_{sp}=0$ for simplicity. In typical KPFM operation, the prefactor, $\\frac{\\gamma(f_{T})A_{T}}{\\zeta_{j}}$, is large compared to the surface voltage contrast being measured. To reduce $V_{E}^{\\text{top}}$ then, $B$ must be chosen so that $B\\ll f_{A}$. For H-KPFM $f_{A}>$100 kHz, so the bound on $B$ is large. For FM-KPFM, however, $f_{A}\\approx1-3$ kHz, and so $B$ is limited to several hundred hertz. The bandwidth of the lock-in amplifier then limits KPFM operation speed. Note also that $V_{E}^{\\text{top}}$ is periodic in time, and so it cannot be mitigated by varying the KPFM feedback loop setpoint. \n\nPrevious measurements of time resolution either investigate the KPFM feedback loop response to a periodic voltage applied to the setpoint\\cite{Zerweck2005}, or substrate \\cite{Diesinger2010}, or how quickly a well-characterized sample can be scanned while retaining KPFM contrast\\cite{Sinensky2007}. Here the former method is used to estimate the cut-off frequency, $f_{c}$, which is defined as the frequency at which the KPFM loop response has dropped to $\\approx 71\\%$ of the low-frequency response (-3 dB). In table \\ref{table:resolutions}, the cut-off time, $t_{c} =  1/f_{c}$, is listed instead, so that smaller values indicate a better resolution.\n\nThe reported time resolutions of AM-KPFM exceed those of FM-KPFM, even though the specific resolution depends on both the cantilever and atomic force microscope used. Diesinger {\\it et al.}\\cite{Diesinger2010} report an implementation of AM-KPFM that achieves $f_{c}\\approx200$ Hz, limited by the analog-digital conversion of the KPFM loop. In air, Sinensky {\\it et al.} demonstrate that AM-KPFM can maintain some voltage contrast at scan speeds up to 1,172 $\\mu$m s$^{-1}$, by scanning 2-$\\mu$m wide stripes of DNA\\cite{Sinensky2007}. In the language used here, that corresponds to $f_{c}\\approx1.2$ kHz. FM-KPFM is reported to operate with similar speed when either in the sideband ($f_{c}\\approx35 $ Hz) or phase locked loop ($f_{c}\\approx30$ Hz) are used, even though the sources of speed limitation are dissimilar\\cite{Zerweck2005,Diesinger2014}. Recent improvements to the KPFM feedback increase the cut-off frequency to $\\approx$ 100 Hz\\cite{Wagner2015a}. Open-loop FM-KPFM retains contrast up to scan speeds of $\\approx1.10$ $\\mu$m$^{-1}s^{-1}$ (or 5 min per 256$\\times$256 pixel scan)\\cite{Borgani2014a}.\n\n\n\\begin{figure}[!ht]\t\t\t\t\n\t\\centering\t\t\t\t\t\t\t\n\t\\includegraphics[width=.45\\textwidth]{Figure5}\n\t\\caption{ The transfer functions for the different KPFM methods are measured by applying a periodic voltage perturbation to the substrate and recording the response of the KPFM loop. (a) The transfer function of a H-KPFM voltage feedback loop increases and becomes more uniform as the gain is increased (H2 implementation). The proportional gain is increased 3 orders of magnitude, and overshoot is constrained to $\\frac{V_{K}}{V_{p}}\\leq1.2$. A dashed line indicates the -3 db point used to calculate the cut-off frequency, $f_{c}$. (b) The cut-off frequency depends strongly on the method used, varying by almost an order of magnitude. The gain for each of the methods is chosen by the same optimization procedure.\n\t}\t\t\n\t\\label{fig:transfers}\n\\end{figure}\n\nTo measure the closed loop transfer function of each KPFM method, an AC voltage ($V_{p}=1$ V at perturbation frequency $f_{p}$) is applied to the substrate by a third DDS, while the cantilever height is maintained at the surface by a topographical feedback loop, with $A_{T}\\approx8$ nm. The KPFM loop tracks the voltage, and $V_{K}(f_{p})$ is detected by a third lock-in amplifier. The frequency is swept from $f_{p}$ = 10 Hz to 25 kHz. The proportional gain of the control loop is increased until the bandwidth stops increasing, and the integral gain is then increased until the transfer function is flat across its bandwidth (figure \\ref{fig:transfers}). The cutoff frequencies for H2, H1, and AM are $5.3, 2.3,$ and $5.0$ kHz, respectively (table \\ref{table:resolutions}). By further optimizing the feedback loops the bandwidth might be increased\\cite{Diesinger2010,Bechhoefer2005,Wagner2015a}.\n\nThe measurement of the FM-KPFM transfer function is complicated by the presence of the topological feedback signal near the KPFM signal, which causes $V_{K}$ to include an extraneous, rapidly oscillating voltage (see equation \\ref{eq:FM_error}). First the transfer function is measured with only the lock-in amplifier's own low-pass filter, but the extraneous voltage is so large that it overwhelms the signal until the frequency of the low-pass filter is decreased to 700 Hz, giving $f_{c}\\approx400$ Hz. However, the extraneous voltage imprinted by the topography signal remains $\\approx400$ mV, prohibitively large for practical measurements. Second, a notch filter is placed on the lock-in amplifier at $f_{A}$ (2 kHz) in order to further mitigate $V_{E}^{\\text{top}}$. The notch filter both decreases $V_{E}^{\\text{top}}$, and also allows the filter on the lock-in amplifier to be increased to 1 kHz. In this configuration the cutoff frequency of FM-KFPM is determined to be $f_{c}\\approx820$ Hz.\n\nTo investigate how $f_{c}$ translates into imaging speed, a few-layer graphene (FLG) flake is scanned with H- and FM-KPFM while the line scan speed is continually increased from 1 Hz to 79 Hz, while scanning a 1$\\times$1 $\\mu$m area with 256$\\times$256 pixels with $A_{T}$ = 16 nm (figure \\ref{fig:V_speed}). By 4 Hz (48 s per frame), FM-KPFM shows stripes caused by $V_{E}^{\\text{top}}$. At higher frequencies, the FM feedback loop oscillates wildly near the edges of the FLG. With H-KPFM, on the other hand, clear contrast is maintained up to 16 Hz (16 s per frame), and at higher frequencies some contrast is maintained. However, the topographical feedback loop stops tracking the surface, and topographical inconsistency affects the potential image. At 79 Hz, patches on the graphene flake are no longer visible. A similar limitation due to topographical feedback loop speed is reported in \\cite{Sinensky2007}. \n\n\t\\begin{figure}[!ht]\n\t\t\\centering\n\t\t\\includegraphics[width=.45\\textwidth]{Figure6}\n\t\t\\caption{Images show the affect of increasing scan speed. (a-c) Topography images of the few layer graphene (FLG) become blurred. (d-f) H-KPFM allows the potential of FLG to be imaged with increasing speed with minimal distortion. (g-i) The topography oscillation is imprinted on the potential image when the bandwidth is increased if FM-KPFM is used. Topography scanning may be the primary speed limit. The height of the FLG is  $\\approx2$ nm. All scans are 256$\\times$256 pixels.}\n\t\t\\label{fig:V_speed}\n\t\\end{figure}\n\t\n\\begin{table*}[ht]\n\t\\small\n\t\\caption{Resolutions that characterize KPFM}\n\t\\centering\n\t\\begin{tabular}{l | c  | l  | r  r  r  r r}\n\t\t\\hline\n\t\tResolution & Figure of Merit  & Definition  & \\hspace{10 pt} H2    & \\hspace{10 pt}H1    & \\hspace{10 pt}FM    & \\hspace{10 pt}   AM & (units)\\\\\n\t\t\\hline\n\t\tTime* &  $t_{c}=1/f_{c}$  & Closed-loop 3 dB cut-off time\\cite{Diesinger2010} & 0.19 & 0.43 & 1.2 & 0.20 & ms\\\\\n\t\t&&&&&&&\\\\\n\t\t\\hline\n\t\tVoltage** & $V_{m}$ &  $V = V_{K}+V_{0}$ for which signal = noise\\cite{Nonnenmacher1991}& 73 & 41 & 96 & 2.0& mV\\\\\n\t\t& &   & &&&&\\\\\n\t\t\\hline\n\t\tSpace** & $l_{10-90}$ & Distance from boundary over which voltage & 45 & 42 & 49 & 68& nm\\\\ & & changes from 10\\% to 90\\% \\cite{Zerweck2005} &   &&&&\\\\\n\t\t\\hline\n\t\\end{tabular}\n\t\n\t\\begin{tabular}{c}\n\t\t*At $A_{T}=8$ nm, $V_{AC}=1$, $V_{p}=1$ V, and at the surface, with topographical feedback on\\\\\n\t\t**At $A_{T}=8$ nm, Bandwidth = 200 Hz, $V_{AC}$=1 V, and lift height 11 nm\\\\\n\t\\end{tabular}\n\t\\label{table:resolutions}\n\\end{table*}\n\\subsection{Voltage Resolution}\t\n\n\\subsubsection{Accuracy}\n\\label{sec:Accuracy}\n\n Whereas the tip apex detects the potential directly beneath it, the inclusion of stray capacitance of the cantilever results in surface potential spatially averaged over many microns (about the width of the cantilever)\\cite{Jacobs1997,Koley2001,Colchero2001,Ma2013}. The unknown and varying relative capacitances of the tip apex and cantilever limit AM-KPFM to qualitative contrast in most conditions\\cite{Jacobs1997,Colchero2001}. Both H-KPFM and FM-KFPM mitigate the stray capacitance effect through their dependence on $C''$ rather than $C'$\\cite{Glatzel2003,Ma2013}. Here the stray capacitance must be assessed in order to understand the relation between the measured potential sensitivity and the ability to actually distinguish between two nanoscale objects. \n\nThe capacitance of tip and cantilever changes with tip-sample separation, and consequently, so does the measured average voltage contrast between the FLG flake and Si substrate,  $\\Delta V$. The correspondence between the actual and measured potentials is tested by observing the change of $\\Delta V$ with lift height, akin to \\cite{Spadafora2011}. At closest approach the tip apex capacitance dominates. As the tip-sample separation is increased, $\\Delta V$ changes little until the proportion of capacitance due to the apex decreases to a value comparable to the cantilever capacitance contribution. The criterion of $\\frac{d\\Delta V}{d\\bar{z}}\\approx0$ near the surface is adopted to ensure that the apex contribution dominates. In the limit of large lift height, the cantilever contribution dominates, and no potential contrast is observed.\n\nThe contrast between Si and FLG change little for H- and FM-KPFM, as the cantilever lift height is varied (figure \\ref{fig:Distance_and_dv}a-c,g). On the other hand, the AM-KPFM detected voltage contrast changes by a factor of five as the lift height is decreased from 100 to 4 nm (figure \\ref{fig:Distance_and_dv}d-f,g). Thus the average potential contrast measured with $C''$ methods is more accurate than the contrast measured by AM-KPFM. \n\n\\begin{figure}[h]\t\t\t\t\n\t\\centering\t\t\t\t\t\t\t\n\t\\includegraphics[width=.45\\textwidth]{Figure7}\n\t\\caption{The voltage contrast between a few layer graphene (FLG) flake and Si substrate reveals the stray capacitance effect. (a-c) The voltage contrast between (few-layer) graphene and silicon changes little as the probe height increases from 4 to 100 nm for H-KPFM. (d-f) However, for AM-KPFM, the contrast at 100 nm differs by a factor of five from that at 4 nm. (g) A comparison between the four different KPFM methods shows that methods that depend on $C''$ more accurately represent the potential contrast than AM-KPFM, which depends on $C'$.\n\t}\t\t\n\t\\label{fig:Distance_and_dv}\n\\end{figure}\n\\subsubsection{Minimum detectable voltage}\n\nThe minimum detectable voltage, $V_{m}$, is the tip-sample voltage difference at which the signal is equal to the noise\\cite{Nonnenmacher1991,Giessibl2003,Sugawara2012,Ma2013a}. Here we consider a flat, broadband noise source with noise power spectral density $n_{B}$ present in $S^{i}_{LIA}$, so that the minimum detectable voltage is:\n\n", "index": 35, "text": "\\begin{align}\n\tV_{m} =\\frac{n_{B}\\sqrt{B}}{\\zeta_{j}},\n\t\\label{eq:Vm}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E18.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle V_{m}=\\frac{n_{B}\\sqrt{B}}{\\zeta_{j}},\" display=\"inline\"><mrow><mrow><msub><mi>V</mi><mi>m</mi></msub><mo>=</mo><mstyle displaystyle=\"true\"><mfrac><mrow><msub><mi>n</mi><mi>B</mi></msub><mo>\u2062</mo><msqrt><mi>B</mi></msqrt></mrow><msub><mi>\u03b6</mi><mi>j</mi></msub></mfrac></mstyle></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\nEach eigenmode of $G(f)$ is modeled as a point mass harmonic oscillator\\cite{Melcher2007}. In the H1 implementation of KPFM, the voltage signal is detected at $f_{1}$ (figure \\ref{fig:CantileverResponse}a), so that:\n\n", "itemtype": "equation", "pos": 36789, "prevtext": "\nwhere $B$ is the detection bandwidth. By incorporating the H-KPFM sensitivity from equation \\ref{eq:heterodyne_chi}, it becomes:\n\n", "index": 37, "text": "\\begin{align}\n\tV_{m,\\textrm{H}} = \\frac{2  n_{B}\\sqrt{B}}{G(f_{D})\\gamma(f_{D})A_{T} V_{AC} C'' }.\n\t\\label{eq:vm_H}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E19.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle V_{m,\\textrm{H}}=\\frac{2n_{B}\\sqrt{B}}{G(f_{D})\\gamma(f_{D})A_{T%&#10;}V_{AC}C^{\\prime\\prime}}.\" display=\"inline\"><mrow><mrow><msub><mi>V</mi><mrow><mi>m</mi><mo>,</mo><mtext>H</mtext></mrow></msub><mo>=</mo><mstyle displaystyle=\"true\"><mfrac><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>n</mi><mi>B</mi></msub><mo>\u2062</mo><msqrt><mi>B</mi></msqrt></mrow><mrow><mi>G</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mi>D</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mi>D</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>A</mi><mi>T</mi></msub><mo>\u2062</mo><msub><mi>V</mi><mrow><mi>A</mi><mo>\u2062</mo><mi>C</mi></mrow></msub><mo>\u2062</mo><msup><mi>C</mi><mi>\u2032\u2032</mi></msup></mrow></mfrac></mstyle></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\nNote that the optical lever sensitivity depends on the eigenmode excited (a cantilever bends more for the same $z$ displacement if excited at higher eigenmodes\\cite{Butt1995}).\n\t\t\\begin{figure}[h]\n\t\t\t\\centering\n\t\t\t\\includegraphics[width=.45\\textwidth]{Figure8}\n\t\t\t\\caption{The (a) minimum detectable voltage and (b) 10-90 resolution both increase with lift height, for all methods. The data plotted here are for cantilever topographical oscillation of $A_{T}=8$ nm. Both heterodyne methods achieve resolutions similar to FM-KFPM.}\n\t\t\t\\label{fig:Lift_Height_2}\n\t\t\\end{figure}\n\t\t\n\t\nThe minimum detectable voltage, $V_{m}$ is determined by measuring the signals at the lock-in amplifier,  $S_{LIA}^{i}$ and $S_{LIA}^{q}$ (equation \\ref{eq:lock_in_signals}), with the feedback loop open. The detection phase, $\\phi_{D}$, is swept from -180$^\\circ$ to 180$^\\circ$ at $V_{K}$ = -1, -0.3, 0.3, and 1 V. For each $\\phi_{D}$, the sensitivity $\\zeta_{j}$ is determined by fitting $S_{LIA}^{i}$ vs $(V_{K}+V_{0})$ to a line, the slope of which is $\\zeta_{j}$ (equation \\ref{eq:KPFM_feedback}). Calculating $\\zeta_{j}$ for several  $\\phi_{D}$, allows us to account for a small systematic offset on the output of the LIA, and to determine the $\\phi_{D}$ that maximizes $\\zeta_{j}$. The noise at the output of the LIA is sampled at 5 kHz, and the calculations here consider the noise within a bandwidth of 200 Hz. Then equation \\ref{eq:Vm} is used to calculate $V_{m}$.\n\n\t\t\\begin{figure}[h]\n\t\t\t\\centering\n\t\t\t\\includegraphics[width=.45\\textwidth]{Figure9}\n\t\t\t\\caption{With H-KPFM in the H2 implementation, (a) the minimum detectable voltage, $V_{m}$, and (b) the 10-90 resolution, $l_{10-90}$, both increase with lift height. Larger shake amplitude, $A_{T}$, decreases $V_{m}$, but no significant effect on resolution is found as a function of $A_{T}$.}\n\t\t\t\\label{fig:Lift_Height_1}\n\t\t\\end{figure} \n\tThe lift-height dependence of $V_{m}$ for FM- and H-KPFM with different heights is measured. For each lift height, a force curve is used to set the position at the chosen lift height, where the probe is held for the duration of the $V_{m}$ measurement. As the separation is increased, $V_{m}$ increases, for all implementations (figure \\ref{fig:Lift_Height_2}a). AM-KPFM has the smallest minimum detectable voltage; however, the small $V_{m}$ is a consequence of the stray capacitance of the cantilever, which causes potential contrast to only be qualitative, and limits spatial resolution\\cite{Jacobs1997,Zerweck2005}. Within H2, $V_{m}$ increases more quickly with lift height for smaller $A_{T}$ (figure \\ref{fig:Lift_Height_1}a).\n\t\\begin{figure}[h]\n\t\t\\centering\n\t\t\\includegraphics[width=.45\\textwidth]{Figure10}\n\t\t\\caption{ The minimum detectable voltage changes as a function of the  normalized $A_{T}$, which decreases as the probe moves closer to the surface (as in figure \\ref{fig:Distance_curves}). A smaller setpoint moves the cantilever closer to the surface. Far from the surface H2 and FM-KFPM have similar $V_{m}$, but it becomes much greater for FM-KPFM nearer the surface, where the noise increases. The H1 method uses a different eigenmode for topography, and does not have the steep increase in $V_{m}$. The gradient from dark to light represents the change from tapping mode to a non-contact mode as the topography setpoint is increased and the probe is lifted from the surface. }\n\t\t\\label{fig:Vm_contact}\n\t\\end{figure}\n\t\n\tSimilarly, we measure $V_{m}$ while imaging in contact mode, as the topographical setpoint is gradually decreased. The noise in both H-KPFM implementations increases slowly as the setpoint is decreased, but the noise density in FM-KPFM increases rapidly, so that close to the surface, $V_{m}$ for FM-KPFM is about an order of magnitude larger (figure \\ref{fig:Vm_contact}). When $f_{D}$ and $f_{T}$ are on the same eigenmode, the noise generated from the topographical tapping mode couples more strongly into the KPFM signal.\n\n\\subsection{Spatial resolution}\n\n\t Determining the spatial resolution of KPFM typically involves observing potential change around a boundary. Jacobs {\\it et al.} showed that the boundary between two micron-scale objects allows for a clear empirical definition of spatial resolution and calculated a 25-75 resolution, {\\it i.e.} the distance over which 50\\% of the total observed voltage change occurred, as a function of lift height\\cite{Jacobs1997,Jacobs1998,McMurray2002}. Zerweck {\\it et al.} similarly calculate a 10-90 resolution\\cite{Zerweck2005}. An equation for the resolution from a point probe is derived in \\cite{McMurray2002}. Others have sought information about the resolution by comparing the boundaries to particular functions, such as arctangent\\cite{McMurray2002} or Boltzmann functions\\cite{Liscio2006}.\n\n\tHere we estimate a 10-90 resolution, $l_{10\\text{-}90}$, by fitting the measured potential as a function of distance from the boundary to a hyperbolic tangent (figure \\ref{fig:Determining_resolution}). The theoretically expected form of the measured potential near the boundary is very nearly a tanh within the proximity force approximation, as shown in Appendix A. For large lift heights ($> 20$ nm), the resolution was large enough to prevent $V_{K}$ from reaching its asymptotic value over the scan size, which necessitates the use of a fit. The noise inherent in KPFM is overcome by averaging around the boundary. The equation of the hyperbolic tangent fit to the boundary is:\n\t\n", "itemtype": "equation", "pos": 37133, "prevtext": "\nEach eigenmode of $G(f)$ is modeled as a point mass harmonic oscillator\\cite{Melcher2007}. In the H1 implementation of KPFM, the voltage signal is detected at $f_{1}$ (figure \\ref{fig:CantileverResponse}a), so that:\n\n", "index": 39, "text": "\\begin{align}\n\tV_{m,\\textrm{H1}} = \\frac{2 k_{1}  n_{B}\\sqrt{B}}{Q_{1}\\gamma_{1}A_{T} V_{AC} C'' }.\n\t\\label{eq:vm_h1}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E20.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle V_{m,\\textrm{H1}}=\\frac{2k_{1}n_{B}\\sqrt{B}}{Q_{1}\\gamma_{1}A_{T%&#10;}V_{AC}C^{\\prime\\prime}}.\" display=\"inline\"><mrow><mrow><msub><mi>V</mi><mrow><mi>m</mi><mo>,</mo><mtext>H1</mtext></mrow></msub><mo>=</mo><mstyle displaystyle=\"true\"><mfrac><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>k</mi><mn>1</mn></msub><mo>\u2062</mo><msub><mi>n</mi><mi>B</mi></msub><mo>\u2062</mo><msqrt><mi>B</mi></msqrt></mrow><mrow><msub><mi>Q</mi><mn>1</mn></msub><mo>\u2062</mo><msub><mi>\u03b3</mi><mn>1</mn></msub><mo>\u2062</mo><msub><mi>A</mi><mi>T</mi></msub><mo>\u2062</mo><msub><mi>V</mi><mrow><mi>A</mi><mo>\u2062</mo><mi>C</mi></mrow></msub><mo>\u2062</mo><msup><mi>C</mi><mi>\u2032\u2032</mi></msup></mrow></mfrac></mstyle></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\t\n\twhere $V_{b}$ is the potential change across the boundary, $ \\overline{V_{K}}(x)$ is the average measured $V_{K}$ a distance $x$ from the boundary, $x_{0}$ is the center of the boundary, and $l_{10\\text{-}90}$ is the 10-90 resolution. This fit gives the empirical spatial resolution. In order to determine whether or not the potential on either side of the boundary corresponds to the actual potential difference, one must supplement this data with either theory\\cite{Zerweck2005} or knowledge of the accuracy of the detected voltage (as in figure \\ref{fig:Distance_and_dv}). \n\t\t\\begin{figure}[h]\n\t\t\t\\centering\n\t\t\t\\includegraphics[width=.45\\textwidth]{Figure11}\n\t\t\t\\caption{ Few layer graphene on silicon shows (a) height contrast and (b)  significant voltage contrast. (c) A histogram of the KPFM dat shows that the potential distribution is bimodal. (d,e) A watershed algorithm is applied to gradient magnitude of the potential image (d) in order to calculate the boundary (e, {\\color{red}$\\mathbf{- - -}$}). (f) Voltages are summed as a function of the distance from the boundary ({\\color{blue}$\\bullet$}) and fit to a tanh function (black solid line), from which the 10-90 resolution is deduced. \n\t\t\t} \n\t\t\t\\label{fig:Determining_resolution}\n\t\t\\end{figure}\n\t\t\n\tRegions of few layer graphene and silicon are identified by watershed segmentation\\cite{Gonzalez2004}. First, the image is median filtered in order to mitigate the effect of noise on the algorithm, and the trace and retrace are averaged. Second, the gradient magnitude of the resultant potential image is calculated with a Sobel algorithm\\cite{Gonzalez2004}. Third, points of lowest and highest potential across the image are marked. Fourth, the watershed algorithm is applied with the two marked points forming the origin of each basin (figure \\ref{fig:Determining_resolution}). \n\t\n\tOnce the image is divided into two components, we plot the potential of the unaltered measurement as a function of the distance from the estimated boundary, and fit the resulting curve to an tanh function (figure \\ref{fig:Determining_resolution}e,f). The 10-90 resolution, $l_{10\\text{-}90}$, is then extracted from the fit.\n\t\t\n\tFor all KPFM methods used, $l_{10\\text{-}90}$ increases with lift height (figures \\ref{fig:Lift_Height_2},\\ref{fig:Lift_Height_1}b), as observed before with AM-KPFM\\cite{Jacobs1997}. Both implementations of H-KPFM and FM-KPFM achieve better spatial resolution than AM-KPFM, at all heights, but the error was too large to discern a difference between the former three. However, when the resolution approaches the length of the few layer graphene, or when the minimum detectable voltage reached the contrast between the objects, the error grew large. Finding a longer, straighter boundary to measure, with larger contrast, could aid in future measurements of resolution at larger lift heights.  \n\t\n\\section{Conclusion}\n\n\tIn this paper, we explore the versatility of H-KPFM and uncover its beneficial characteristics, the most prominent of which is its speed. The H1 implementation improves the minimum detectable voltage by a factor of 2 relative to the original implementation.  Further studies into the technique of H-KPFM should investigate the effect of roughness, the effect of eigenmode shape (reportedly an issue with the simpler AM-KPFM)\\cite{Satzinger2012}, and how to incorporate better control techniques for potential estimation ({\\it e.g} \\cite{Wagner2015a}) and tracking of the surface({\\it e.g} \\cite{Ahmad2014}), which now limits KPFM scan speed. Cantilevers could be designed specifically for H-KPFM\\cite{Sadewasser2006} to reduce the difference between the spring constants of the first and second eigenmodes, which would improve the sensitivity of H-KPFM. Likewise, cantilever resonance frequencies could be chosen to enable open-loop H-KPFM\\cite{Collins2013}.\n\n\tHeterodyne KPFM improves upon the time resolution of FM-KPFM. Rates of several frames per minute are achieved. Its speed is not limited by AC coupling or bandwidth overlap, and so with appropriate cantilevers it will operate even faster. It also improves upon the spatial resolution of AM-KPFM. These new implementations of H-KPFM will facilitate fast and accurate nanoscale potential dynamics.\n\n\t\\section{Acknowledgements}\n\tWe thank Asylum Research for technical advice, in particular Anil Gannepalli. We thank Tao Gong, Beth Tennyson, and Marina Leite for insightful conversations about KPFM and for challenging us with difficult-to-scan samples, and Dakang Ma and David Somers for critical readings of this article. We thank the University of Maryland for financial support.\n\n\\appendix\n\n\t\\section{An equation for spatial resolution}\n\tAbove we discuss the spatial resolution of KPFM in terms of $l_{10\\text{-}90}$, the 10-90 resolution, or the distance over which 80\\% of the voltage change across a boundary occurs. We determine $l_{10\\text{-}90}$ by fitting $V_{K}(x)$,the potential measured across a boundary, to a hyperbolic tangent (equation \\ref{eq:arctanfit}).\n\t\n\tHere, we use the proximity force approximation (PFA) for a sphere interacting with a plate to derive an analytic expression for $V_{K}(x)$ for both $C'$ and $C''$ KPFM methods. Furthermore, we demonstrate that the tanh function approximates the form of $V_{K}(x)$ better than the arctan function in order to motivate our choices in the text. Finally, we estimate how $l_{10\\text{-}90}$ changes with height and tip radius. We note that an equation for resolution exists in the large separation, small probe limit\\cite{McMurray2002}, but better resolution is achieved with small tip-sample separation, and so that is our focus here.\n\t\n\tThe PFA for the capacitive force of a sphere above a plate can be written as\\cite{Kim2010}:\n\t\n", "itemtype": "equation", "pos": -1, "prevtext": "\nNote that the optical lever sensitivity depends on the eigenmode excited (a cantilever bends more for the same $z$ displacement if excited at higher eigenmodes\\cite{Butt1995}).\n\t\t\\begin{figure}[h]\n\t\t\t\\centering\n\t\t\t\\includegraphics[width=.45\\textwidth]{Figure8}\n\t\t\t\\caption{The (a) minimum detectable voltage and (b) 10-90 resolution both increase with lift height, for all methods. The data plotted here are for cantilever topographical oscillation of $A_{T}=8$ nm. Both heterodyne methods achieve resolutions similar to FM-KFPM.}\n\t\t\t\\label{fig:Lift_Height_2}\n\t\t\\end{figure}\n\t\t\n\t\nThe minimum detectable voltage, $V_{m}$ is determined by measuring the signals at the lock-in amplifier,  $S_{LIA}^{i}$ and $S_{LIA}^{q}$ (equation \\ref{eq:lock_in_signals}), with the feedback loop open. The detection phase, $\\phi_{D}$, is swept from -180$^\\circ$ to 180$^\\circ$ at $V_{K}$ = -1, -0.3, 0.3, and 1 V. For each $\\phi_{D}$, the sensitivity $\\zeta_{j}$ is determined by fitting $S_{LIA}^{i}$ vs $(V_{K}+V_{0})$ to a line, the slope of which is $\\zeta_{j}$ (equation \\ref{eq:KPFM_feedback}). Calculating $\\zeta_{j}$ for several  $\\phi_{D}$, allows us to account for a small systematic offset on the output of the LIA, and to determine the $\\phi_{D}$ that maximizes $\\zeta_{j}$. The noise at the output of the LIA is sampled at 5 kHz, and the calculations here consider the noise within a bandwidth of 200 Hz. Then equation \\ref{eq:Vm} is used to calculate $V_{m}$.\n\n\t\t\\begin{figure}[h]\n\t\t\t\\centering\n\t\t\t\\includegraphics[width=.45\\textwidth]{Figure9}\n\t\t\t\\caption{With H-KPFM in the H2 implementation, (a) the minimum detectable voltage, $V_{m}$, and (b) the 10-90 resolution, $l_{10-90}$, both increase with lift height. Larger shake amplitude, $A_{T}$, decreases $V_{m}$, but no significant effect on resolution is found as a function of $A_{T}$.}\n\t\t\t\\label{fig:Lift_Height_1}\n\t\t\\end{figure} \n\tThe lift-height dependence of $V_{m}$ for FM- and H-KPFM with different heights is measured. For each lift height, a force curve is used to set the position at the chosen lift height, where the probe is held for the duration of the $V_{m}$ measurement. As the separation is increased, $V_{m}$ increases, for all implementations (figure \\ref{fig:Lift_Height_2}a). AM-KPFM has the smallest minimum detectable voltage; however, the small $V_{m}$ is a consequence of the stray capacitance of the cantilever, which causes potential contrast to only be qualitative, and limits spatial resolution\\cite{Jacobs1997,Zerweck2005}. Within H2, $V_{m}$ increases more quickly with lift height for smaller $A_{T}$ (figure \\ref{fig:Lift_Height_1}a).\n\t\\begin{figure}[h]\n\t\t\\centering\n\t\t\\includegraphics[width=.45\\textwidth]{Figure10}\n\t\t\\caption{ The minimum detectable voltage changes as a function of the  normalized $A_{T}$, which decreases as the probe moves closer to the surface (as in figure \\ref{fig:Distance_curves}). A smaller setpoint moves the cantilever closer to the surface. Far from the surface H2 and FM-KFPM have similar $V_{m}$, but it becomes much greater for FM-KPFM nearer the surface, where the noise increases. The H1 method uses a different eigenmode for topography, and does not have the steep increase in $V_{m}$. The gradient from dark to light represents the change from tapping mode to a non-contact mode as the topography setpoint is increased and the probe is lifted from the surface. }\n\t\t\\label{fig:Vm_contact}\n\t\\end{figure}\n\t\n\tSimilarly, we measure $V_{m}$ while imaging in contact mode, as the topographical setpoint is gradually decreased. The noise in both H-KPFM implementations increases slowly as the setpoint is decreased, but the noise density in FM-KPFM increases rapidly, so that close to the surface, $V_{m}$ for FM-KPFM is about an order of magnitude larger (figure \\ref{fig:Vm_contact}). When $f_{D}$ and $f_{T}$ are on the same eigenmode, the noise generated from the topographical tapping mode couples more strongly into the KPFM signal.\n\n\\subsection{Spatial resolution}\n\n\t Determining the spatial resolution of KPFM typically involves observing potential change around a boundary. Jacobs {\\it et al.} showed that the boundary between two micron-scale objects allows for a clear empirical definition of spatial resolution and calculated a 25-75 resolution, {\\it i.e.} the distance over which 50\\% of the total observed voltage change occurred, as a function of lift height\\cite{Jacobs1997,Jacobs1998,McMurray2002}. Zerweck {\\it et al.} similarly calculate a 10-90 resolution\\cite{Zerweck2005}. An equation for the resolution from a point probe is derived in \\cite{McMurray2002}. Others have sought information about the resolution by comparing the boundaries to particular functions, such as arctangent\\cite{McMurray2002} or Boltzmann functions\\cite{Liscio2006}.\n\n\tHere we estimate a 10-90 resolution, $l_{10\\text{-}90}$, by fitting the measured potential as a function of distance from the boundary to a hyperbolic tangent (figure \\ref{fig:Determining_resolution}). The theoretically expected form of the measured potential near the boundary is very nearly a tanh within the proximity force approximation, as shown in Appendix A. For large lift heights ($> 20$ nm), the resolution was large enough to prevent $V_{K}$ from reaching its asymptotic value over the scan size, which necessitates the use of a fit. The noise inherent in KPFM is overcome by averaging around the boundary. The equation of the hyperbolic tangent fit to the boundary is:\n\t\n", "index": 41, "text": "\\begin{align}\n\t\t\\overline{V_{K}}(x)=(V_{b} \\tanh\\big[\\text{ln}(9)(x-x_{0})/l_{10\\text{-}90}\\big] + c)/2,\n\t\t\\label{eq:arctanfit}\n\t\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E21.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\overline{V_{K}}(x)=(V_{b}\\tanh\\big{[}\\text{ln}(9)(x-x_{0})/l_{10%&#10;\\text{-}90}\\big{]}+c)/2,\" display=\"inline\"><mrow><mrow><mrow><mover accent=\"true\"><msub><mi>V</mi><mi>K</mi></msub><mo>\u00af</mo></mover><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><msub><mi>V</mi><mi>b</mi></msub><mo>\u2062</mo><mrow><mi>tanh</mi><mo>\u2061</mo><mrow><mo maxsize=\"120%\" minsize=\"120%\">[</mo><mrow><mrow><mtext>ln</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>9</mn><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>x</mi><mo>-</mo><msub><mi>x</mi><mn>0</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>/</mo><msub><mi>l</mi><mrow><mn>10</mn><mo>\u2062</mo><mtext>-</mtext><mo>\u2062</mo><mn>90</mn></mrow></msub></mrow><mo maxsize=\"120%\" minsize=\"120%\">]</mo></mrow></mrow></mrow><mo>+</mo><mi>c</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>/</mo><mn>2</mn></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\n\twhere $R$ is the radius of the sphere, $V_{p}(r,\\phi)$ is the potential of the plate at position $(r,\\phi)$, and $V$ is the potential of the sphere (here assumed to be spatially uniform). \n\tThe voltage applied to the probe that minimizes $n$th derivative of this force can be found by taking $n$ derivatives with respect to $z$ and one with respect to $V$,\n\t\n", "itemtype": "equation", "pos": 48625, "prevtext": "\t\n\twhere $V_{b}$ is the potential change across the boundary, $ \\overline{V_{K}}(x)$ is the average measured $V_{K}$ a distance $x$ from the boundary, $x_{0}$ is the center of the boundary, and $l_{10\\text{-}90}$ is the 10-90 resolution. This fit gives the empirical spatial resolution. In order to determine whether or not the potential on either side of the boundary corresponds to the actual potential difference, one must supplement this data with either theory\\cite{Zerweck2005} or knowledge of the accuracy of the detected voltage (as in figure \\ref{fig:Distance_and_dv}). \n\t\t\\begin{figure}[h]\n\t\t\t\\centering\n\t\t\t\\includegraphics[width=.45\\textwidth]{Figure11}\n\t\t\t\\caption{ Few layer graphene on silicon shows (a) height contrast and (b)  significant voltage contrast. (c) A histogram of the KPFM dat shows that the potential distribution is bimodal. (d,e) A watershed algorithm is applied to gradient magnitude of the potential image (d) in order to calculate the boundary (e, {\\color{red}$\\mathbf{- - -}$}). (f) Voltages are summed as a function of the distance from the boundary ({\\color{blue}$\\bullet$}) and fit to a tanh function (black solid line), from which the 10-90 resolution is deduced. \n\t\t\t} \n\t\t\t\\label{fig:Determining_resolution}\n\t\t\\end{figure}\n\t\t\n\tRegions of few layer graphene and silicon are identified by watershed segmentation\\cite{Gonzalez2004}. First, the image is median filtered in order to mitigate the effect of noise on the algorithm, and the trace and retrace are averaged. Second, the gradient magnitude of the resultant potential image is calculated with a Sobel algorithm\\cite{Gonzalez2004}. Third, points of lowest and highest potential across the image are marked. Fourth, the watershed algorithm is applied with the two marked points forming the origin of each basin (figure \\ref{fig:Determining_resolution}). \n\t\n\tOnce the image is divided into two components, we plot the potential of the unaltered measurement as a function of the distance from the estimated boundary, and fit the resulting curve to an tanh function (figure \\ref{fig:Determining_resolution}e,f). The 10-90 resolution, $l_{10\\text{-}90}$, is then extracted from the fit.\n\t\t\n\tFor all KPFM methods used, $l_{10\\text{-}90}$ increases with lift height (figures \\ref{fig:Lift_Height_2},\\ref{fig:Lift_Height_1}b), as observed before with AM-KPFM\\cite{Jacobs1997}. Both implementations of H-KPFM and FM-KPFM achieve better spatial resolution than AM-KPFM, at all heights, but the error was too large to discern a difference between the former three. However, when the resolution approaches the length of the few layer graphene, or when the minimum detectable voltage reached the contrast between the objects, the error grew large. Finding a longer, straighter boundary to measure, with larger contrast, could aid in future measurements of resolution at larger lift heights.  \n\t\n\\section{Conclusion}\n\n\tIn this paper, we explore the versatility of H-KPFM and uncover its beneficial characteristics, the most prominent of which is its speed. The H1 implementation improves the minimum detectable voltage by a factor of 2 relative to the original implementation.  Further studies into the technique of H-KPFM should investigate the effect of roughness, the effect of eigenmode shape (reportedly an issue with the simpler AM-KPFM)\\cite{Satzinger2012}, and how to incorporate better control techniques for potential estimation ({\\it e.g} \\cite{Wagner2015a}) and tracking of the surface({\\it e.g} \\cite{Ahmad2014}), which now limits KPFM scan speed. Cantilevers could be designed specifically for H-KPFM\\cite{Sadewasser2006} to reduce the difference between the spring constants of the first and second eigenmodes, which would improve the sensitivity of H-KPFM. Likewise, cantilever resonance frequencies could be chosen to enable open-loop H-KPFM\\cite{Collins2013}.\n\n\tHeterodyne KPFM improves upon the time resolution of FM-KPFM. Rates of several frames per minute are achieved. Its speed is not limited by AC coupling or bandwidth overlap, and so with appropriate cantilevers it will operate even faster. It also improves upon the spatial resolution of AM-KPFM. These new implementations of H-KPFM will facilitate fast and accurate nanoscale potential dynamics.\n\n\t\\section{Acknowledgements}\n\tWe thank Asylum Research for technical advice, in particular Anil Gannepalli. We thank Tao Gong, Beth Tennyson, and Marina Leite for insightful conversations about KPFM and for challenging us with difficult-to-scan samples, and Dakang Ma and David Somers for critical readings of this article. We thank the University of Maryland for financial support.\n\n\\appendix\n\n\t\\section{An equation for spatial resolution}\n\tAbove we discuss the spatial resolution of KPFM in terms of $l_{10\\text{-}90}$, the 10-90 resolution, or the distance over which 80\\% of the voltage change across a boundary occurs. We determine $l_{10\\text{-}90}$ by fitting $V_{K}(x)$,the potential measured across a boundary, to a hyperbolic tangent (equation \\ref{eq:arctanfit}).\n\t\n\tHere, we use the proximity force approximation (PFA) for a sphere interacting with a plate to derive an analytic expression for $V_{K}(x)$ for both $C'$ and $C''$ KPFM methods. Furthermore, we demonstrate that the tanh function approximates the form of $V_{K}(x)$ better than the arctan function in order to motivate our choices in the text. Finally, we estimate how $l_{10\\text{-}90}$ changes with height and tip radius. We note that an equation for resolution exists in the large separation, small probe limit\\cite{McMurray2002}, but better resolution is achieved with small tip-sample separation, and so that is our focus here.\n\t\n\tThe PFA for the capacitive force of a sphere above a plate can be written as\\cite{Kim2010}:\n\t\n", "index": 43, "text": "\\begin{align}\n\tF(z) = \\frac{\\epsilon_{0}}{2} \\int_{0}^{2\\pi}{d\\phi}\\int_{0}^{R}r dr \\frac{(V-V_{pl}(r,\\phi))^2}{(z + r^{2}/2R)^2},\n\t\\label{eq:PFA}\n\t\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E22.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle F(z)=\\frac{\\epsilon_{0}}{2}\\int_{0}^{2\\pi}{d\\phi}\\int_{0}^{R}rdr%&#10;\\frac{(V-V_{pl}(r,\\phi))^{2}}{(z+r^{2}/2R)^{2}},\" display=\"inline\"><mrow><mrow><mrow><mi>F</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mstyle displaystyle=\"true\"><mfrac><msub><mi>\u03f5</mi><mn>0</mn></msub><mn>2</mn></mfrac></mstyle><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mrow><mn>2</mn><mo>\u2062</mo><mi>\u03c0</mi></mrow></msubsup></mstyle><mrow><mrow><mo>\ud835\udc51</mo><mi>\u03d5</mi></mrow><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mi>R</mi></msubsup></mstyle><mrow><mi>r</mi><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>r</mi></mrow><mo>\u2062</mo><mstyle displaystyle=\"true\"><mfrac><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>V</mi><mo>-</mo><mrow><msub><mi>V</mi><mrow><mi>p</mi><mo>\u2062</mo><mi>l</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>r</mi><mo>,</mo><mi>\u03d5</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>z</mi><mo>+</mo><mrow><mrow><msup><mi>r</mi><mn>2</mn></msup><mo>/</mo><mn>2</mn></mrow><mo>\u2062</mo><mi>R</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></mfrac></mstyle></mrow></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\n\tAt the Kelvin probe voltage, $V=V_{K}(x)$, for which the KPFM signal $S_{K}$ vanishes, equation \\ref{eq:force_der} vanishes as well. Near a boundary, the potential of the plate is $V_{pl}(r,\\phi) = V_{b}\\Theta(\\cos(\\phi)+L/r)$, where $L=x-x_{0}$ is the distance between the location of the probe and the boundary and $\\Theta$ is the Heaviside step function . The potential is $V_{b}$ for $x=r\\cos(\\phi)>L$ and 0 otherwise. To simplify the calculation, we define the function $\\Lambda(z,R,L)$:\n\t\n", "itemtype": "equation", "pos": 49144, "prevtext": "\n\twhere $R$ is the radius of the sphere, $V_{p}(r,\\phi)$ is the potential of the plate at position $(r,\\phi)$, and $V$ is the potential of the sphere (here assumed to be spatially uniform). \n\tThe voltage applied to the probe that minimizes $n$th derivative of this force can be found by taking $n$ derivatives with respect to $z$ and one with respect to $V$,\n\t\n", "index": 45, "text": "\\begin{align}\n\t\\frac{\\partial^{n+1}F(z)}{\\partial V\\partial z^{n}} = \\frac{\\partial}{\\partial z^{n}}\\Biggl[\\epsilon_{0} \\int_{0}^{2\\pi}{d\\phi}\\int_{0}^{R}r dr \\frac{V-V_{pl}(r,\\phi)}{(z + r^{2}/2R)^2}\\Biggr].\n\t\\label{eq:force_der}\n\t\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E23.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\frac{\\partial^{n+1}F(z)}{\\partial V\\partial z^{n}}=\\frac{%&#10;\\partial}{\\partial z^{n}}\\Biggl{[}\\epsilon_{0}\\int_{0}^{2\\pi}{d\\phi}\\int_{0}^{%&#10;R}rdr\\frac{V-V_{pl}(r,\\phi)}{(z+r^{2}/2R)^{2}}\\Biggr{]}.\" display=\"inline\"><mrow><mrow><mstyle displaystyle=\"true\"><mfrac><mrow><mrow><msup><mo>\u2202</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>\u2061</mo><mi>F</mi></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>V</mi></mrow><mo>\u2062</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><msup><mi>z</mi><mi>n</mi></msup></mrow></mrow></mfrac></mstyle><mo>=</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mo>\u2202</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><msup><mi>z</mi><mi>n</mi></msup></mrow></mfrac></mstyle><mo>\u2062</mo><mrow><mo maxsize=\"260%\" minsize=\"260%\">[</mo><mrow><msub><mi>\u03f5</mi><mn>0</mn></msub><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mrow><mn>2</mn><mo>\u2062</mo><mi>\u03c0</mi></mrow></msubsup></mstyle><mrow><mrow><mo>\ud835\udc51</mo><mi>\u03d5</mi></mrow><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mi>R</mi></msubsup></mstyle><mrow><mi>r</mi><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>r</mi></mrow><mo>\u2062</mo><mstyle displaystyle=\"true\"><mfrac><mrow><mi>V</mi><mo>-</mo><mrow><msub><mi>V</mi><mrow><mi>p</mi><mo>\u2062</mo><mi>l</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>r</mi><mo>,</mo><mi>\u03d5</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>z</mi><mo>+</mo><mrow><mrow><msup><mi>r</mi><mn>2</mn></msup><mo>/</mo><mn>2</mn></mrow><mo>\u2062</mo><mi>R</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></mfrac></mstyle></mrow></mrow></mrow></mrow></mrow><mo maxsize=\"260%\" minsize=\"260%\">]</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\n\tFor a KPFM method with a signal proportional to the $(n+1)^{\\text{th}}$ derivative of capacitance, the Kelvin probe voltage near a boundary is: \n\t\n", "itemtype": "equation", "pos": 49883, "prevtext": "\n\tAt the Kelvin probe voltage, $V=V_{K}(x)$, for which the KPFM signal $S_{K}$ vanishes, equation \\ref{eq:force_der} vanishes as well. Near a boundary, the potential of the plate is $V_{pl}(r,\\phi) = V_{b}\\Theta(\\cos(\\phi)+L/r)$, where $L=x-x_{0}$ is the distance between the location of the probe and the boundary and $\\Theta$ is the Heaviside step function . The potential is $V_{b}$ for $x=r\\cos(\\phi)>L$ and 0 otherwise. To simplify the calculation, we define the function $\\Lambda(z,R,L)$:\n\t\n", "index": 47, "text": "\\begin{gather}\n\t\\label{eq:lambda_def}\n\t\\Lambda(z,R,L)=\\int_{0}^{2\\pi}{d\\phi}\\int_{0}^{R}r dr \\frac{\\Theta(\\cos(\\phi)-L/r)}{(z + r^{2}/2R)^2},\\\\\n\t\t= R \\left(\\frac{2 L \\text{ arctan}\\left(\\sqrt{\\frac{R^2-L^2}{L^2+2 R z}}\\right)}{z \\sqrt{L^2+2 R z}}+\\frac{2 R \\text{ arccos}\\left(-\\frac{L}{R}\\right)}{z (R+2z)}\\right).\\notag\n\t\\end{gather}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E24.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\Lambda(z,R,L)=\\int_{0}^{2\\pi}{d\\phi}\\int_{0}^{R}rdr\\frac{\\Theta(%&#10;\\cos(\\phi)-L/r)}{(z+r^{2}/2R)^{2}},\" display=\"block\"><mrow><mrow><mrow><mi mathvariant=\"normal\">\u039b</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>z</mi><mo>,</mo><mi>R</mi><mo>,</mo><mi>L</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mrow><mn>2</mn><mo>\u2062</mo><mi>\u03c0</mi></mrow></msubsup><mrow><mrow><mo>\ud835\udc51</mo><mi>\u03d5</mi></mrow><mo>\u2062</mo><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mi>R</mi></msubsup><mrow><mi>r</mi><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>r</mi></mrow><mo>\u2062</mo><mfrac><mrow><mi mathvariant=\"normal\">\u0398</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mi>cos</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03d5</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mi>L</mi><mo>/</mo><mi>r</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>z</mi><mo>+</mo><mrow><mrow><msup><mi>r</mi><mn>2</mn></msup><mo>/</mo><mn>2</mn></mrow><mo>\u2062</mo><mi>R</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></mfrac></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle=R\\left(\\frac{2L\\text{ arctan}\\left(\\sqrt{\\frac{R^{2}-L^{2}}{L^{2%&#10;}+2Rz}}\\right)}{z\\sqrt{L^{2}+2Rz}}+\\frac{2R\\text{ arccos}\\left(-\\frac{L}{R}%&#10;\\right)}{z(R+2z)}\\right).\" display=\"block\"><mrow><mrow><mi/><mo>=</mo><mrow><mi>R</mi><mo>\u2062</mo><mrow><mo>(</mo><mrow><mfrac><mrow><mn>2</mn><mo>\u2062</mo><mi>L</mi><mo>\u2062</mo><mtext>\u00a0arctan</mtext><mo>\u2062</mo><mrow><mo>(</mo><msqrt><mfrac><mrow><msup><mi>R</mi><mn>2</mn></msup><mo>-</mo><msup><mi>L</mi><mn>2</mn></msup></mrow><mrow><msup><mi>L</mi><mn>2</mn></msup><mo>+</mo><mrow><mn>2</mn><mo>\u2062</mo><mi>R</mi><mo>\u2062</mo><mi>z</mi></mrow></mrow></mfrac></msqrt><mo>)</mo></mrow></mrow><mrow><mi>z</mi><mo>\u2062</mo><msqrt><mrow><msup><mi>L</mi><mn>2</mn></msup><mo>+</mo><mrow><mn>2</mn><mo>\u2062</mo><mi>R</mi><mo>\u2062</mo><mi>z</mi></mrow></mrow></msqrt></mrow></mfrac><mo>+</mo><mfrac><mrow><mn>2</mn><mo>\u2062</mo><mi>R</mi><mo>\u2062</mo><mtext>\u00a0arccos</mtext><mo>\u2062</mo><mrow><mo>(</mo><mrow><mo>-</mo><mfrac><mi>L</mi><mi>R</mi></mfrac></mrow><mo>)</mo></mrow></mrow><mrow><mi>z</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>R</mi><mo>+</mo><mrow><mn>2</mn><mo>\u2062</mo><mi>z</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mrow><mo>)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\n\twhere $\\Lambda^{(n)}=\\frac{\\partial^{n}\\Lambda}{\\partial z^{n}}$, and $C^{(n+1)}$ represents a methods that depends on the $(n+1)^{\\text{th}}$ derivative of capacitance. For example, for AM-KPFM, the signal of which is proportional to $C'$, the Kelvin probe voltage is:\n\t\n", "itemtype": "equation", "pos": 50366, "prevtext": "\n\tFor a KPFM method with a signal proportional to the $(n+1)^{\\text{th}}$ derivative of capacitance, the Kelvin probe voltage near a boundary is: \n\t\n", "index": 49, "text": "\\begin{align}\n\tV^{C^{(n+1)}}_{K}(L)=V_{b}\\frac{\\Lambda^{(n)}}{2\\Lambda^{(n)}|_{L=0}},\n\t\\label{eq:V_Kexact}\n\t\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E25.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle V^{C^{(n+1)}}_{K}(L)=V_{b}\\frac{\\Lambda^{(n)}}{2\\Lambda^{(n)}|_{%&#10;L=0}},\" display=\"inline\"><mrow><mrow><mrow><msubsup><mi>V</mi><mi>K</mi><msup><mi>C</mi><mrow><mo stretchy=\"false\">(</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></msup></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>L</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><msub><mi>V</mi><mi>b</mi></msub><mo>\u2062</mo><mstyle displaystyle=\"true\"><mfrac><msup><mi mathvariant=\"normal\">\u039b</mi><mrow><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow></msup><msub><mrow><mrow><mn>2</mn><mo>\u2062</mo><msup><mi mathvariant=\"normal\">\u039b</mi><mrow><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow></msup></mrow><mo fence=\"true\" stretchy=\"false\">|</mo></mrow><mrow><mi>L</mi><mo>=</mo><mn>0</mn></mrow></msub></mfrac></mstyle></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\n\tIt must be noted that the PFA only considers the contribution of the tip apex to the KPFM signal. In AM-KPFM the dominant contribution to the signal comes from the cantilever. At a boundary, equation \\ref{eq:am_res} will predict the shape of $V^{C^{(1)}}_{K}(x)$, but the $V_{b}$ coefficient will be much less than the potential difference across the boundary. AM-KPFM measures qualitative potential contrast\\cite{Jacobs1997}.\t\n\t\n\tFor the $C''$ methods (H- or FM-KPFM) the minimizing potential equation is more complicated, and so it has been plotted in figure \\ref{fig:Appendix}a.\n\t\\begin{figure}[h]\n\t\t\\centering\n\t\t\\includegraphics[width=0.45\\textwidth]{Figure12}\n\t\t\\caption{ The normalized Kelvin probe voltage near a boundary in the proximity force approximation (PFA) is shown in (a) for both the AM-KPFM ($C'$, red) and H- and FM-KPFM ($C''$, blue) variants. The dashed black line shows the normalized potential on the surface directly and two grey lines indicate the 10-90 potential change. (b) A tanh function (dashed orange) is a much better fit to the analytic expression (PFA) for the $C''$ method than an arctan function chosen in the same way (dashed green). (c) The 10-90 resolution predicted by a tanh function fit (solid) is compared to that calculated numerically by the exact PFA expression (${\\color{blue}\\bullet}$). At small z/R, the 10-90 resolution increases with separation $\\propto \\sqrt{z/R}$, and this approximate expression is plotted for both the $C'$ and $C''$ methods (dashed). A purple line indicates the value of $z/R$ for which (a,b) are plotted.\n\t\t}\n\t\t\\label{fig:Appendix}\n\t\\end{figure}\n\t To facilitate data analysis, a simpler function can be used to approximate equation \\ref{eq:V_Kexact}. Both arctan and tanh functions have the desired behavior: monotonic, odd around $L=0$, and asymptotic to a constant as $L\\rightarrow\\infty$. The slope of $V^{C^{(n+1)}}_{K}(L)$ is steepest at $L=0$ and so fitting for small $L$ is most important. Arctan and tanh are used to approximate equation \\ref{eq:V_Kexact} by matching the first derivative of each function to our exact analytic expression:\n\t \n", "itemtype": "equation", "pos": 50758, "prevtext": "\n\twhere $\\Lambda^{(n)}=\\frac{\\partial^{n}\\Lambda}{\\partial z^{n}}$, and $C^{(n+1)}$ represents a methods that depends on the $(n+1)^{\\text{th}}$ derivative of capacitance. For example, for AM-KPFM, the signal of which is proportional to $C'$, the Kelvin probe voltage is:\n\t\n", "index": 51, "text": "\\begin{align}\n\tV^{C^{(1)}}_{K}(L)=&V_{b}\\bigg[\\frac{1}{2}+\\frac{\\text{ arcsin}\\left(\\frac{L}{R}\\right)}{\\pi}\\notag \\\\&+\\frac{L (2 z+R) \\text{ arctan} \\left(\\sqrt{\\frac{R^2-L^2}{L^2+2 z R}}\\right)}{\\pi  R \\sqrt{2 z R+L^2}}\\bigg].\n\t\\label{eq:am_res}\n\t\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle V^{C^{(1)}}_{K}(L)=\" display=\"inline\"><mrow><mrow><msubsup><mi>V</mi><mi>K</mi><msup><mi>C</mi><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>L</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mi/></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle V_{b}\\bigg{[}\\frac{1}{2}+\\frac{\\text{ arcsin}\\left(\\frac{L}{R}%&#10;\\right)}{\\pi}\" display=\"inline\"><mrow><msub><mi>V</mi><mi>b</mi></msub><mrow><mo maxsize=\"210%\" minsize=\"210%\">[</mo><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle><mo>+</mo><mstyle displaystyle=\"true\"><mfrac><mrow><mtext>\u00a0arcsin</mtext><mo>\u2062</mo><mrow><mo>(</mo><mfrac><mi>L</mi><mi>R</mi></mfrac><mo>)</mo></mrow></mrow><mi>\u03c0</mi></mfrac></mstyle></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E26.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle+\\frac{L(2z+R)\\text{ arctan}\\left(\\sqrt{\\frac{R^{2}-L^{2}}{L^{2}+%&#10;2zR}}\\right)}{\\pi R\\sqrt{2zR+L^{2}}}\\bigg{]}.\" display=\"inline\"><mrow><mo>+</mo><mstyle displaystyle=\"true\"><mfrac><mrow><mi>L</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>z</mi></mrow><mo>+</mo><mi>R</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mtext>\u00a0arctan</mtext><mo>\u2062</mo><mrow><mo>(</mo><msqrt><mfrac><mrow><msup><mi>R</mi><mn>2</mn></msup><mo>-</mo><msup><mi>L</mi><mn>2</mn></msup></mrow><mrow><msup><mi>L</mi><mn>2</mn></msup><mo>+</mo><mrow><mn>2</mn><mo>\u2062</mo><mi>z</mi><mo>\u2062</mo><mi>R</mi></mrow></mrow></mfrac></msqrt><mo>)</mo></mrow></mrow><mrow><mi>\u03c0</mi><mo>\u2062</mo><mi>R</mi><mo>\u2062</mo><msqrt><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>z</mi><mo>\u2062</mo><mi>R</mi></mrow><mo>+</mo><msup><mi>L</mi><mn>2</mn></msup></mrow></msqrt></mrow></mfrac></mstyle><mo maxsize=\"210%\" minsize=\"210%\">]</mo><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\n\twhere, \n\t\n", "itemtype": "equation", "pos": 53144, "prevtext": "\n\tIt must be noted that the PFA only considers the contribution of the tip apex to the KPFM signal. In AM-KPFM the dominant contribution to the signal comes from the cantilever. At a boundary, equation \\ref{eq:am_res} will predict the shape of $V^{C^{(1)}}_{K}(x)$, but the $V_{b}$ coefficient will be much less than the potential difference across the boundary. AM-KPFM measures qualitative potential contrast\\cite{Jacobs1997}.\t\n\t\n\tFor the $C''$ methods (H- or FM-KPFM) the minimizing potential equation is more complicated, and so it has been plotted in figure \\ref{fig:Appendix}a.\n\t\\begin{figure}[h]\n\t\t\\centering\n\t\t\\includegraphics[width=0.45\\textwidth]{Figure12}\n\t\t\\caption{ The normalized Kelvin probe voltage near a boundary in the proximity force approximation (PFA) is shown in (a) for both the AM-KPFM ($C'$, red) and H- and FM-KPFM ($C''$, blue) variants. The dashed black line shows the normalized potential on the surface directly and two grey lines indicate the 10-90 potential change. (b) A tanh function (dashed orange) is a much better fit to the analytic expression (PFA) for the $C''$ method than an arctan function chosen in the same way (dashed green). (c) The 10-90 resolution predicted by a tanh function fit (solid) is compared to that calculated numerically by the exact PFA expression (${\\color{blue}\\bullet}$). At small z/R, the 10-90 resolution increases with separation $\\propto \\sqrt{z/R}$, and this approximate expression is plotted for both the $C'$ and $C''$ methods (dashed). A purple line indicates the value of $z/R$ for which (a,b) are plotted.\n\t\t}\n\t\t\\label{fig:Appendix}\n\t\\end{figure}\n\t To facilitate data analysis, a simpler function can be used to approximate equation \\ref{eq:V_Kexact}. Both arctan and tanh functions have the desired behavior: monotonic, odd around $L=0$, and asymptotic to a constant as $L\\rightarrow\\infty$. The slope of $V^{C^{(n+1)}}_{K}(L)$ is steepest at $L=0$ and so fitting for small $L$ is most important. Arctan and tanh are used to approximate equation \\ref{eq:V_Kexact} by matching the first derivative of each function to our exact analytic expression:\n\t \n", "index": 53, "text": "\\begin{align}\n\t \\label{eq:fits}\n\t V^{C^{(n+1)}}_{\\text{tanh}}=& V_{b}\\frac{\\tanh(2 a^{C^{(n+1)}} L)+1}{2},\\\\\n\t V^{C^{(n+1)}}_{\\text{arctan}}=& V_{b}\\frac{\\arctan(\\pi a^{C^{(n+1)}} L)+\\pi/2}{\\pi}, \\notag\t \n\t \\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E27.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle V^{C^{(n+1)}}_{\\text{tanh}}=\" display=\"inline\"><mrow><msubsup><mi>V</mi><mtext>tanh</mtext><msup><mi>C</mi><mrow><mo stretchy=\"false\">(</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></msup></msubsup><mo>=</mo><mi/></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E27.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle V_{b}\\frac{\\tanh(2a^{C^{(n+1)}}L)+1}{2},\" display=\"inline\"><mrow><mrow><msub><mi>V</mi><mi>b</mi></msub><mo>\u2062</mo><mstyle displaystyle=\"true\"><mfrac><mrow><mrow><mi>tanh</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mn>2</mn><mo>\u2062</mo><msup><mi>a</mi><msup><mi>C</mi><mrow><mo stretchy=\"false\">(</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></msup></msup><mo>\u2062</mo><mi>L</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mn>1</mn></mrow><mn>2</mn></mfrac></mstyle></mrow><mo>,</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex6.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle V^{C^{(n+1)}}_{\\text{arctan}}=\" display=\"inline\"><mrow><msubsup><mi>V</mi><mtext>arctan</mtext><msup><mi>C</mi><mrow><mo stretchy=\"false\">(</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></msup></msubsup><mo>=</mo><mi/></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex6.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle V_{b}\\frac{\\arctan(\\pi a^{C^{(n+1)}}L)+\\pi/2}{\\pi},\" display=\"inline\"><mrow><mrow><msub><mi>V</mi><mi>b</mi></msub><mo>\u2062</mo><mstyle displaystyle=\"true\"><mfrac><mrow><mrow><mi>arctan</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03c0</mi><mo>\u2062</mo><msup><mi>a</mi><msup><mi>C</mi><mrow><mo stretchy=\"false\">(</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></msup></msup><mo>\u2062</mo><mi>L</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mi>\u03c0</mi><mo>/</mo><mn>2</mn></mrow></mrow><mi>\u03c0</mi></mfrac></mstyle></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\n\tBoth functions are plotted in figure \\ref{fig:Appendix}b to visually depict how well each fits equation \\ref{eq:V_Kexact}. The tanh fit follows the exact expression more closely than the arctan fit. The tanh fit can then be used to estimate $l_{10-90}$ as a function of z and R:\n\t\n", "itemtype": "equation", "pos": 53373, "prevtext": "\n\twhere, \n\t\n", "index": 55, "text": "\\begin{align}\n\ta^{C^{(n+1)}}=& \\frac{\\partial V^{C^{(n+1)}}_{K}}{\\partial L}\\Bigg|_{L=0},\t \n\t\\label{eq:adef}\n\t\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E28.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle a^{C^{(n+1)}}=\" display=\"inline\"><mrow><msup><mi>a</mi><msup><mi>C</mi><mrow><mo stretchy=\"false\">(</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></msup></msup><mo>=</mo><mi/></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E28.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\frac{\\partial V^{C^{(n+1)}}_{K}}{\\partial L}\\Bigg{|}_{L=0},\" display=\"inline\"><mrow><msub><mrow><mstyle displaystyle=\"true\"><mfrac><mrow><mo>\u2202</mo><mo>\u2061</mo><msubsup><mi>V</mi><mi>K</mi><msup><mi>C</mi><mrow><mo stretchy=\"false\">(</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></msup></msubsup></mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>L</mi></mrow></mfrac></mstyle><mo fence=\"true\" maxsize=\"260%\" minsize=\"260%\">|</mo></mrow><mrow><mi>L</mi><mo>=</mo><mn>0</mn></mrow></msub><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\n\t\n\t\tWhich, for AM-KFPM is:\n\t\n", "itemtype": "equation", "pos": 53776, "prevtext": "\n\tBoth functions are plotted in figure \\ref{fig:Appendix}b to visually depict how well each fits equation \\ref{eq:V_Kexact}. The tanh fit follows the exact expression more closely than the arctan fit. The tanh fit can then be used to estimate $l_{10-90}$ as a function of z and R:\n\t\n", "index": 57, "text": "\\begin{align}\n\t l_{10-90}^{C^{(n+1)}} =& \\frac{\\text{ln}(9)}{2a^{C^{(n+1)}}}.  \n\t\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E29.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle l_{10-90}^{C^{(n+1)}}=\" display=\"inline\"><mrow><msubsup><mi>l</mi><mrow><mn>10</mn><mo>-</mo><mn>90</mn></mrow><msup><mi>C</mi><mrow><mo stretchy=\"false\">(</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></msup></msubsup><mo>=</mo><mi/></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E29.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\frac{\\text{ln}(9)}{2a^{C^{(n+1)}}}.\" display=\"inline\"><mrow><mstyle displaystyle=\"true\"><mfrac><mrow><mtext>ln</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>9</mn><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mn>2</mn><mo>\u2062</mo><msup><mi>a</mi><msup><mi>C</mi><mrow><mo stretchy=\"false\">(</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></msup></msup></mrow></mfrac></mstyle><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\n\tThe more complicated expression of $l_{10-90}^{C''}$ is plotted in figure \\ref{fig:Appendix}c. Taylor expanding around $\\sqrt{z/R}\\approx0$, the resolutions are: \n\t\t\n", "itemtype": "equation", "pos": 53897, "prevtext": "\n\t\n\t\tWhich, for AM-KFPM is:\n\t\n", "index": 59, "text": "\\begin{align}\n\t \tl_{10-90}^{C^{(1)}}=&\\frac{\\pi  \\log (81) \\sqrt{zR}}{2 \\sqrt{z /R}+\\sqrt{2} (2 z/R+1) \\text{ arctan}\\left(\\sqrt{\\frac{R}{2z}}\\right)}.\n\t \t\\label{eq:cpres}\n\t\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E30.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle l_{10-90}^{C^{(1)}}=\" display=\"inline\"><mrow><msubsup><mi>l</mi><mrow><mn>10</mn><mo>-</mo><mn>90</mn></mrow><msup><mi>C</mi><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup></msubsup><mo>=</mo><mi/></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E30.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\frac{\\pi\\log(81)\\sqrt{zR}}{2\\sqrt{z/R}+\\sqrt{2}(2z/R+1)\\text{ %&#10;arctan}\\left(\\sqrt{\\frac{R}{2z}}\\right)}.\" display=\"inline\"><mrow><mstyle displaystyle=\"true\"><mfrac><mrow><mi>\u03c0</mi><mo>\u2062</mo><mrow><mi>log</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mn>81</mn><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2062</mo><msqrt><mrow><mi>z</mi><mo>\u2062</mo><mi>R</mi></mrow></msqrt></mrow><mrow><mrow><mn>2</mn><mo>\u2062</mo><msqrt><mrow><mi>z</mi><mo>/</mo><mi>R</mi></mrow></msqrt></mrow><mo>+</mo><mrow><msqrt><mn>2</mn></msqrt><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>z</mi></mrow><mo>/</mo><mi>R</mi></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mtext>\u00a0arctan</mtext><mo>\u2062</mo><mrow><mo>(</mo><msqrt><mfrac><mi>R</mi><mrow><mn>2</mn><mo>\u2062</mo><mi>z</mi></mrow></mfrac></msqrt><mo>)</mo></mrow></mrow></mrow></mfrac></mstyle><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02503.tex", "nexttext": "\n\t\tJump-to-contact limits how small z can become, and consequently limits the possible spatial resolution. These approximations are also compared to the exact PFA result in figure \\ref{fig:Appendix}c. \n\t\t\n\t\n\t\n\t\t\t\n\t\t\t\tThe resolutions calculated here are a lower bound on the resolution possible with KPFM because many components of the probe that would broaden the resolution are neglected. Though the electrostatic probe-surface force from the tip cone and cantilever have been calculated for uniform potential\\cite{Hudlet1998,Colchero2001}, we are unaware of any analytic procedure to take into account variations of the surface potential. A procedure does exist to calculate the electrostatic force between a sphere and a plate with potential variations\\cite{Behunin2012a}, but the KPFM probe geometry is only slightly better represented by such a model. Most importantly, these extra cases all reduce to the PFA near the surface, where the best spatial resolution is achieved.\n\t\t\t\t\\FloatBarrier\n\t\t\t\t\\onecolumngrid\n\t\t\t\t\\section{Table of Variables}\n\t\t\t\t\\begin{table}[h]\n\t\t\t\t\t\\center\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\\small\n\t\t\t\t\t\\begin{tabular}{ c | l | l }\n\t\t\t\t\t\tVariable & Description  &  Equations \\\\\n\t\t\t\t\t\t\\hline\n\t\t\t\t\t\t$S_{K}$ & KPFM signal & \\ref{eq:KPFM_feedback},\\ref{eq:SKforAM},\\ref{eq:Extra_signal} \\\\ \n\t\t\t\t\t\t$V_{K}$,$V^{C^{(n+1)}}_{K}$ & KPFM voltage, KPFM voltage near a boundary & \\ref{eq:KPFM_feedback},\\ref{eq:AM_force},\\ref{eq:at_photodetector},\\ref{eq:lock_in_signals},\\ref{eq:SKforAM},\\ref{eq:All_u_terms},\\ref{eq:H_KPFM},\\ref{eq:signal_H},\\ref{eq:extra_voltage_inVK},\\ref{eq:calibratin},\\ref{eq:V_Kexact},\\ref{eq:fits},\\ref{eq:adef}\t \\\\ \n\t\t\t\t\t\t$V_{0}$ & Inherent contact potential difference & \\ref{eq:KPFM_feedback},\\ref{eq:AM_force},\\ref{eq:at_photodetector},\\ref{eq:lock_in_signals},\\ref{eq:SKforAM},\\ref{eq:All_u_terms},\\ref{eq:H_KPFM},\\ref{eq:signal_H},\\ref{eq:extra_voltage_inVK} \\\\ \n\t\t\t\t\t\t$\\zeta_{j}$ & Sensitivity of KPFM method $j$, where $j$ = AM, FM, or H & \\ref{eq:KPFM_feedback},\\ref{eq:SKforAM},\\ref{eq:chi_am},\\ref{eq:heterodyne_chi},\\ref{eq:V_error},\\ref{eq:calibratin},\\ref{eq:FM_error},\\ref{eq:Vm} \\\\ \n\t\t\t\t\t\t$f_{D}$ & Frequency at which the KPFM signal is detected & \\ref{eq:AM_force},\\ref{eq:lock_in_signals},\\ref{eq:heterodyne_chi},\\ref{eq:vm_H} \\\\\n\t\t\t\t\t\t$F_{f_{D}} $ & Force on cantilever at detection frequency & \\ref{eq:AM_force},\\ref{eq:amplitude},\\ref{eq:H_KPFM} \\\\\n\t\t\t\t\t\t$C$ & Tip-sample capacitance & \\ref{eq:AM_force},\\ref{eq:at_photodetector},\\ref{eq:lock_in_signals},\\ref{eq:chi_am},\\ref{eq:All_u_terms},\\ref{eq:H_KPFM},\\ref{eq:signal_H},\\ref{eq:vm_H},\\ref{eq:vm_h1} \\\\\n\t\t\t\t\t\t$V_{AC}$ & Periodic voltage applied to cantilever & \\ref{eq:AM_force},\\ref{eq:at_photodetector},\\ref{eq:chi_am},\\ref{eq:All_u_terms},\\ref{eq:H_KPFM},\\ref{eq:signal_H},\\ref{eq:heterodyne_chi},\\ref{eq:vm_H},\\ref{eq:vm_h1}\\\\\n\t\t\t\t\t\t$A_{f_{D}}$& Amplitude of cantilever oscillation at $f_{D}$&\\ref{eq:amplitude}\\\\\n\t\t\t\t\t\t$G(f)$ & Transfer function of cantilever at frequency $f$&\\ref{eq:amplitude},\\ref{eq:at_photodetector},\\ref{eq:lock_in_signals},\\ref{eq:chi_am},\\ref{eq:signal_H},\\ref{eq:heterodyne_chi}\\\\\n\t\t\t\t\t\t$S_{\\text{photo}}$ & KPFM signal at photodetector &\\ref{eq:at_photodetector},\\ref{eq:signal_H}\\\\\n\t\t\t\t\t\t$\\gamma(f)$ & Optical lever sensitivity of cantilever at frequency $f$ &\\ref{eq:at_photodetector},\\ref{eq:lock_in_signals},\\ref{eq:chi_am},\\ref{eq:signal_H},\\ref{eq:heterodyne_chi},\\ref{eq:FM_error},\\ref{eq:vm_H},\\ref{eq:vm_h1} \\\\\n\t\t\t\t\t\t$S_{LIA}^{i}$,$S_{LIA}^{q}$& In-phase ($i$) and $\\pi/2$-shifted ($q$) signals at lock-in &\\ref{eq:lock_in_signals},\\ref{eq:SKforAM},\\ref{eq:Extra_signal}\\\\\n\t\t\t\t\t\t$\\phi_{D}$ & Phase of shift of lock-in amplifier & \\ref{eq:lock_in_signals},\\ref{eq:chi_am},\\ref{eq:heterodyne_chi} \\\\\n\t\t\t\t\t\t\n\t\t\t\t\t\t$z$, ($\\bar{z}$) & Instantaneous (time-averaged) tip-sample separation &\\ref{eq:expand_z},\\ref{eq:calibratin},\\ref{eq:PFA},\\ref{eq:force_der},\\ref{eq:lambda_def},\\ref{eq:cpres},\\ref{eq:resolutions}\\\\\n\t\t\t\t\t\t\n\t\t\t\t\t\t$F$ & Capacitive force on cantilever & \\ref{eq:All_u_terms},\\ref{eq:PFA},\\ref{eq:force_der}\\\\\n\t\t\t\t\t\t$t$ & Time &\\ref{eq:expand_z},\\ref{eq:FM_error}\\\\\n\t\t\t\t\t\t$A_{T}$& Amplitude of oscillation used for topography feedback&\\ref{eq:expand_z},\\ref{eq:All_u_terms},\\ref{eq:H_KPFM},\\ref{eq:signal_H},\\ref{eq:heterodyne_chi},\\ref{eq:FM_error},\\ref{eq:vm_H},\\ref{eq:vm_h1}\\\\\n\t\t\t\t\t\t$f_{T}$ & Frequency at which the topographical feedback loop operates & \\ref{eq:expand_z},\\ref{eq:All_u_terms}\\\\\n\t\t\t\t\t\t$\\phi_{T}$&Phase of oscillation used for topography feedback&\\ref{eq:expand_z},\\ref{eq:heterodyne_chi}\\\\\n\t\t\t\t\t\t$f_{A}$ & Frequency at which $V_{AC}$ is applied to the cantilever &\\ref{eq:All_u_terms},\\ref{eq:FM_error} \\\\\n\t\t\t\t\t\t$\\phi_{A}$&Phase of applied voltage $V_{AC}$&\\ref{eq:All_u_terms},\\ref{eq:heterodyne_chi}\\\\\n\t\t\t\t\t\t$S_{E}$ & Extraneous signal in KPFM feedback & \\ref{eq:Extra_signal},\\ref{eq:V_error},\\ref{eq:calibratin}\\\\\n\t\t\t\t\t\t$V_{E}$ & Extraneous voltage artifact & \\ref{eq:extra_voltage_inVK},\\ref{eq:V_error},\\ref{eq:calibratin},\\ref{eq:FM_error}\\\\\n\t\t\t\t\t\t$S_{sp}$ & KPFM feedback setpoint & \\ref{eq:V_error},\\ref{eq:calibratin}\\\\\n\t\t\t\t\t\t$B$ & Bandwidth of low-pass filter on lock-in amplifier & \\ref{eq:FM_error},\\ref{eq:Vm},\\ref{eq:vm_H},\\ref{eq:vm_h1}\\\\\n\t\t\t\t\t\t$V_{p}$ & Voltage perturbation applied to plate & \\\\\n\t\t\t\t\t\t$f_{p}$ & Frequency of voltage perturbations applied to plate&\\\\\n\t\t\t\t\t\t$t_{c}=1/f_{c}$ & The cut-off time and the cut-off frequency&\\\\\n\t\t\t\t\t\t$V_{m}$ & Minimum detectable voltage & \\ref{eq:Vm},\\ref{eq:vm_H},\\ref{eq:vm_h1} \\\\\n\t\t\t\t\t\t$n_{B}$ & Noise density in detection bandwidth & \\ref{eq:Vm},\\ref{eq:vm_H},\\ref{eq:vm_h1}\\\\\n\t\t\t\t\t\t$k_{i}$, $Q_{i}$ & Spring constant and quality factor of cantilever eigenmode $i$ & \\ref{eq:vm_h1}\\\\\n\t\t\t\t\t\t$V_{b}$ & Surface voltage change across a boundary & \\ref{eq:arctanfit},\\ref{eq:V_Kexact},\\ref{eq:am_res},\\ref{eq:fits} \\\\\n\t\t\t\t\t\t$L\\equiv x-x_{0}$ & Distance from potential boundary & \\ref{eq:arctanfit},\\ref{eq:lambda_def},\\ref{eq:V_Kexact},\\ref{eq:fits},\\ref{eq:adef} \\\\\n\t\t\t\t\t\t$l_{10-90}$,$l_{10-90}^{C^{(n+1)}}$  & 10-90 resolution, for method that depends on $C^{(n+1)}$ & \\ref{eq:arctanfit},\\ref{eq:cpres},\\ref{eq:resolutions}\\\\\n\t\t\t\t\t\t$R$ & Tip radius & \\ref{eq:PFA},\\ref{eq:force_der},\\ref{eq:lambda_def},\\ref{eq:cpres},\\ref{eq:resolutions}\\\\\n\t\t\t\t\t\t$V_{pl}(r,\\phi)$ & Surface potential of the plate & \\ref{eq:PFA},\\ref{eq:force_der},\\ref{eq:lambda_def}\\\\\n\t\t\t\t\t\t$V$& Voltage of sphere in PFA & \\ref{eq:PFA},\\ref{eq:force_der},\\ref{eq:lambda_def}\\\\\n\t\t\t\t\t\t$\\Lambda(z,R,L)$&Function useful for calculating KPFM resolutions&\\ref{eq:lambda_def},\\ref{eq:V_Kexact}\\\\\n\t\t\t\t\t\t$a^{C^{(n+1)}}$& Slope of $V^{C^{(n+1)}}_{K}$ at boundary&\\ref{eq:fits},\\ref{eq:adef},\\ref{eq:cpres}\\\\\n\t\t\t\t\t\t\\hline\n\t\t\t\t\t\\end{tabular}\n\t\t\t\t\t\\label{table:variables}\n\t\t\t\t\\end{table}\t\n\t\t\\FloatBarrier\n\t\t\\vspace*{-\\baselineskip}\n\t\t\\twocolumngrid\n\\bibliographystyle{iopart_num_edited}\n\\bibliography{HeterodynePaper}\n\n\n", "itemtype": "equation", "pos": 54248, "prevtext": "\n\tThe more complicated expression of $l_{10-90}^{C''}$ is plotted in figure \\ref{fig:Appendix}c. Taylor expanding around $\\sqrt{z/R}\\approx0$, the resolutions are: \n\t\t\n", "index": 61, "text": "\\begin{align}\n\t\t\\label{eq:resolutions}\n\t\t\\frac{l_{10-90}^{C^{(1)}}}{R} \\approx \\sqrt{2}\\text{ ln}(9)\\sqrt{\\frac{z}{R}} &\\text{  (AM method)},\\\\\n\t\t\\frac{l_{10-90}^{C^{(2)}}}{R} \\approx \\frac{2}{3}\\sqrt{2}\\text{ ln}(9)\\sqrt{\\frac{z}{R}} &\\text{  (H-,FM- methods)}. \\notag\n\t\t\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E31.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\frac{l_{10-90}^{C^{(1)}}}{R}\\approx\\sqrt{2}\\text{ ln}(9)\\sqrt{%&#10;\\frac{z}{R}}\" display=\"inline\"><mrow><mstyle displaystyle=\"true\"><mfrac><msubsup><mi>l</mi><mrow><mn>10</mn><mo>-</mo><mn>90</mn></mrow><msup><mi>C</mi><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup></msubsup><mi>R</mi></mfrac></mstyle><mo>\u2248</mo><mrow><msqrt><mn>2</mn></msqrt><mo>\u2062</mo><mtext>\u00a0ln</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>9</mn><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msqrt><mstyle displaystyle=\"true\"><mfrac><mi>z</mi><mi>R</mi></mfrac></mstyle></msqrt></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E31.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\text{ (AM method)},\" display=\"inline\"><mrow><mtext>(AM method)</mtext><mo>,</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex7.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\frac{l_{10-90}^{C^{(2)}}}{R}\\approx\\frac{2}{3}\\sqrt{2}\\text{ ln}%&#10;(9)\\sqrt{\\frac{z}{R}}\" display=\"inline\"><mrow><mstyle displaystyle=\"true\"><mfrac><msubsup><mi>l</mi><mrow><mn>10</mn><mo>-</mo><mn>90</mn></mrow><msup><mi>C</mi><mrow><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></msup></msubsup><mi>R</mi></mfrac></mstyle><mo>\u2248</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mn>2</mn><mn>3</mn></mfrac></mstyle><mo>\u2062</mo><msqrt><mn>2</mn></msqrt><mo>\u2062</mo><mtext>\u00a0ln</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>9</mn><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msqrt><mstyle displaystyle=\"true\"><mfrac><mi>z</mi><mi>R</mi></mfrac></mstyle></msqrt></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex7.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\text{ (H-,FM- methods)}.\" display=\"inline\"><mrow><mtext>(H-,FM- methods)</mtext><mo>.</mo></mrow></math>", "type": "latex"}]