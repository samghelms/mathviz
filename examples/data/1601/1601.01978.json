[{"file": "1601.01978.tex", "nexttext": "\n$f(\\psi)=\\psi^8/(\\psi^8+1)$ is a nonlinear response of the lake\nsediments to phosphorous, $p$ is the nutrient rate input, taken\nhere as the control parameter. $\\epsilon$ is the strength of\ndiffusive spatial coupling, and $\\eta$ represents an additive\nstochastic perturbation uncorrelated in space and time. We take\n$b=r=1$ and $\\epsilon=1.2$. Space is discretized as a square\nlattice of $N=70\\times70=4900$ grid points separated by $dx=1$.\nThese will be the nodes of the functional network. The\nLaplacian is discretized with the simplest finite differences\nscheme and the deterministic terms in equation (\\ref{Lk}) are\nintegrated with a 4th order Runge-Kutta method of time step\n$dt=0.05$ after which the $\\eta$ term is implemented by adding\nan independent random number uniform in $[-a,a]$ to each\nlattice site (we use $a=0.125$). We approach from the left the\nSN bifurcation occurring at $p=p_{SN}=0.660$, above which the\nclear-water low-phosphorous state existing for $p<p_{SN}$\nceases to exist and the lake jumps to an eutrophicated\nhigh-phosphorous state. The stochastic perturbation makes the\njump to occur at a value of $p$, $p_d$, slightly below the SN\nvalue. On average (see Fig. \\ref{fig1}), we find $p_d\\approx\n0.658$. This value is sufficiently close to $p_{SN}$ as to\ndisplay the enhancement of correlations and slowing down which\nare at the basis of our method and of other early-warning\nmethodologies. In this paper we have only displayed results\nobtained when slowly increasing the control parameter $p$. When\ndecreasing $p$ from higher values hysteresis occurs and a\ndifferent SN bifurcation is encountered at a lower $p'_d\\approx\n0.389$. The sequence of precursors encountered when approaching\nthis lower transition point is similar to the one shown here.\n\nAs a second model, we consider the time-dependent\nGinzburg-Landau equation\\cite{Hohenberg1977} or model A\ndescribing, for example, transitions in anisotropic\nferromagnets. We study the one-dimensional version for the\nmagnetization $\\psi(x,t)$:\n\n", "itemtype": "equation", "pos": 18277, "prevtext": "\n\n\\title{Percolation-based precursors of transitions \\\\in spatially extended systems}\n\n\\author{V\\'{\\i}ctor Rodr\\'{\\i}guez-M\\'{e}ndez}\n\\author{V\\'{\\i}ctor M. Egu\\'{\\i}luz}\n\\author{Emilio Hern\\'{a}ndez-Garc\\'{\\i}a\n\n\n\n}\n\\author{Jos\\'e J.\\ Ramasco}\n\n\\affiliation{IFISC (CSIC-UIB), Instituto de F\\'{\\i}sica\nInterdisciplinar y Sistemas Complejos,\\\\\nCampus Universitat de les Illes Balears, E-07122 Palma de\nMallorca, Spain.}\n\n\\begin{abstract}\nAbrupt transitions are ubiquitous in the dynamics of complex\nsystems. Finding early indicators of their arrival, precursors,\nis fundamental in many areas of science such as ecology,\nelectrical engineering, physiology or climate. However,\nobtaining warnings of an approaching transition well in advance\nremains an elusive task. Here we show that a functional\nnetwork, constructed from spatial correlations of the system's\ntime series, experiences a percolation transition way before\nthe actual system reaches a bifurcation point due to the\ncollective phenomena leading to the global change. Concepts\nfrom percolation theory are then used to introduce early\nwarning precursors that anticipate the system's tipping point.\nWe illustrate the generality and versatility of our\npercolation-based framework with model systems experiencing\ndifferent types of bifurcations and with Sea Surface\nTemperature time series associated to El Ni\\~{n}o\nphenomenon.\n\\end{abstract}\n\n\n\\date{\\today}\n\\maketitle\n\n\nAbrupt transitions are ubiquitous in the dynamics of complex\nsystems. Finding early indicators of their arrival, precursors,\nis fundamental in many areas of science such as\necology\\cite{Scheffer2001},\n\nelectrical engineering \\cite{Dobson2007},\nphysiology\\cite{VandeLeemput2014} or climate\n\\cite{Dakos2008,Thompson2011,Lenton2012}. However, obtaining\nwarnings of an approaching transition well in advance remains\nan elusive task. Here we show that a functional network,\nconstructed from spatial correlations of the system's time\nseries\\cite{Tsonis2004,Eguiluz2005,Timme2014}, experiences a\npercolation transition way before the actual system reaches a\nbifurcation point due to the collective phenomena leading to\nthe global change. Concepts from percolation\ntheory\\cite{Stauffer1994,Newman2010} are then used to introduce\nearly warning precursors that anticipate the system's tipping\npoint. We illustrate the generality and versatility of our\npercolation-based framework with model systems experiencing\ndifferent types of bifurcations and with Sea Surface\nTemperature time series associated to El Ni\\~{n}o phenomenon.\n\n\nManagement of complex systems requires the detection with\nsufficient anticipation of approaching critical or tipping\npoints. Early-warning signals have been introduced and tested \nin recent works \\cite{Scheffer2012,Wang2012b,Dakos2015},\nincluding experimental verification in living and environmental\nsystems \\cite{Veraart2012e,Wang2012b,Quail2015}. These methods\nrely on the loss of resilience occurring generically when the\nsystem approaches most (although not all) types of bifurcation\npoints\\cite{Scheffer2009,Thompson2011,Dakos2015}. Recovery\nrates from perturbation become small, leading to critical\nslowing down of the dynamics, increased memory and long\ntemporal autocorrelations, and to growth of the temporal\nvariance \\cite{Scheffer2009,Thompson2011,Dakos2015}. From a\ndynamical viewpoint, these phenomena appear when the eigenvalue\nof the Jacobian matrix describing the rate of relaxation\ntowards the attractor approaches zero close to bifurcation\npoints. In many cases, particularly when different spatial\nparts of the system are coupled by diffusion-like processes,\nthe increase in temporal correlation is accompanied by the\ngrowth of spatial correlations\n\\cite{Guttal2009,Dakos2010,Dakos2011}. This, with the\nassociated increase in spatial variance and response functions,\nis actually a standard method to characterize phase transitions\nin thermodynamic physical systems.\n\n\nThe consideration of spatial correlations has led to a novel\nperspective for finding transition precursors through the use\nof correlation or functional networks\n\\cite{Tsonis2004,Eguiluz2005}. These networks are built\nmeasuring the correlation among all pairs of spatial units\ncomposing the system and keeping the most significant ones as\nlink weights. Several network-based precursors have been\nproposed. Specifically the values of the degree (number of\nconnections per node), assortativity (degree-degree\ncorrelations), clustering (average density of network\ntriangles) and kurtosis raise when approaching a tipping\npoint\\cite{VanderMheen2013d,Tirabassi2014,Feng2014}.\n\n\n\n\\begin{figure}[h]\n\\includegraphics[width=8.6cm]{Figure1.pdf}\n\n\\caption{{\\bf Transition precursors for the LE model, equation (\\ref{Lk})}.\nIn {\\bf a}, the steady\nhomogeneous phosphorous concentration $\\psi$ (orange) and the numerically\nobtained spatial average (black, further averaged over $T=1000$ temporal snapshots for each value of $p$)\nas a function of the control parameter $p$ which\nis slowly increased from low to high values. In {\\bf b},\n$\\langle\\bar{\\sigma_\\psi}\\rangle$, the spatial standard deviation (black) of $\\psi$\naveraged over $T=1000$ temporal snapshots.\nIn orange the clustering of the functional network built with threshold $\\gamma = 0.21$.\nIn {\\bf c}, the relative size of the giant component, $S_1$ (orange),\nand the average size of the leftover clusters ($\\langle s^2 \\rangle$, black).\nIn {\\bf d}, the probabilities $c_2$ (black), $c_5$ (orange), and $c_9$ (purple) are shown.\nIn all the panels, the vertical green line marks the position of the observed abrupt transition\n($p_d=0.658$). The grey area indicates the anticipation in\nparameter space gained by using the peak of $c_2$ as precursor of the percolation transition. All curves\nhave been further averaged over 100 realizations of the random noise and initial\nconditions.} \\label{fig1}\n\\end{figure}\n\n\nHere we show an important additional property of the functional\nnetworks: As internal correlations increase, networks evolve\nfrom a low to a high connectivity state and, \\emph{before}\nreaching its maximum link density at the bifurcation point, a\npercolation-like transition occurs in the network topology.\nConcepts from graph percolation theory\n\\cite{Stauffer1994,Newman2010} can thus be imported to\ncharacterize this transition. Importantly, metrics can be\ndefined that act as early warnings for this percolation\ntransition, which itself is a precursor of the dynamic\ntransition.\n\n\n\\begin{figure}[h]\n\\includegraphics[width=8.6cm,clip=true]{Figure2.pdf}\n\n\\caption{{\\bf Peaks of $\\mathbf{c_s}$ as transition precursors in the GL model}.\nThe GL model has a continuous transition at the\ncritical value $p_d = 0$ marked by the green line. In {\\bf a}, the theoretical (yellow)\nand the numerically obtained (black dash line, further averaged over $T=1000$ temporal\nsnapshots) homogeneous value of the field $\\psi$\nare shown. Functional networks were built using a threshold of $\\gamma = 0.25$.\n$S_1$ (orange) and $\\langle s^2\\rangle$ (black) are displayed in the panel {\\bf b}.\nPanel {\\bf c} shows $c_2$ (black), $c_5$ (orange), and $c_9$ (purple).\nIn {\\bf d}, the circles indicate the values of $p$, $p_s$ with $s=2,5,9,16$ and $21$,\nfor which $c_s$ attains its respective maximum. }\n\\label{fig2}\n\\end{figure}\n\n\nAs a first example, we consider a lake eutrophication (LE)\nmodel\\cite{Carpenter1999} that suffers a paradigmatic abrupt\ntransition associated to a saddle-node (SN) bifurcation (see\nMethods). Similar results are obtained for other models with\ndifferent types of transitions (see below and Supplementary\nInformation). The LE model describes a transition between two\ncontrasted states for the phosphorous concentration\n$\\psi({\\mathbf x},t)$ in a lake: low concentrations leading to clear\nwater, and excess of phosphates leading to turbid water. The\ncontrol parameter $p$ is the nutrient input rate into the lake\nand the transition point $p_d$ (see Fig. \\ref{fig1}) identifies\nthe value beyond which a switch occurs from the clear to the\nturbid state. A raise of the spatial variance of the field\n$\\psi$ (used in \\cite{Scheffer2009,Thompson2011,Dakos2015} as\ntransition indicator) when the system approaches $p_d$ can be\nobserved in Fig. \\ref{fig1}b. We constructed functional\nnetworks by assigning links between locations among which\nspatial correlations (as measured by Pearson correlation, see\nMethods) are larger than a threshold $\\gamma$. The correlation\nincrease leads to a growth of the link density in the vicinity\nof the critical point as indicated by the precursors proposed\nin \\cite{VanderMheen2013d,Tirabassi2014,Feng2014}. In fact, the\nclustering showed in Fig. \\ref{fig1}a (orange) has a peak at\nthe dynamical transition. But there is also a percolation\ntransition, and to capture it we studied how the size of the\ngiant component, $S_1$, and the average size of the leftover\nclusters ($\\langle s^2 \\rangle$, see Methods) change with $p$\n(see Fig. \\ref{fig1}c). Note that $\\langle s^2 \\rangle$ has a\npeak at $p=0.648$, which identifies the occurrence of\npercolation in the network, way before the SN transition has\nhappened, and thus it may be used as a signal that a dynamical\ntransition is coming. The distance in the parameter space\nbetween that signal and the transition depends on which\nthreshold is used to build the network, but there is an optimal\nvalue (see below).\n\n\n\\begin{figure}[h]\n\\includegraphics[width=8.6cm]{Figure3.pdf}\n\n\\caption{{\\bf Role of the correlation threshold $\\mathbf{\\gamma}$}.\n$c_2$ values, as given by the color bar, as a function of the\ncontrol parameter $p$ and the threshold $\\gamma$ used to build the\nfunctional network for the LE model. The white dots give\nthe locations of the $c_2$ maxima, while the black dots mark the maxima of\n$\\langle s^2 \\rangle$ (percolation transition). The dynamical\nsudden jump occurs at $p_d=0.658$. The horizontal\nblue line identifies the value of $\\gamma = 0.21$ used in Fig. \\ref{fig1}. Similar\nplots for other models are in Supplementary Information. }\n\\label{fig3}\n\\end{figure}\n\n\nThe percolation transition is not, however, the best precursor.\nBetter anticipation can be obtained by exploiting a phenomenon\nobserved for percolation in random graphs. In such graphs, as\nnew links are being added at random, percolation occurs when\nthe mean degree $\\langle k \\rangle$ equals one. Before this,\nthe probability that a randomly chosen node belongs to a small\ncomponent of size $s$ is given by\\cite{Newman2010} $c_{s} =\n{e^{-s\\langle k\\rangle}(s\\langle k\\rangle)^{s-1}}/{s!}$. This\nprobability has a maximum when the mean degree is $\\langle\nk\\rangle=k_s = \\frac{s-1}{s}$. The succession $\\{k_s\\}$ of\nlocation of maxima of $c_s$ converges to the percolation point\n$k_\\infty=1$ for increasing component size $s$, but for low $s$\nthese maxima could be quite far from the percolation point,\nanticipating it. We check that this early warning character of\n$c_s$ is also present in our non-random functional networks.\nThe probabilities $c_2$, $c_5$ and $c_9$ for the networks built\nfrom the LE system are shown in Fig. \\ref{fig1}d. Their maxima\nclearly anticipate the percolation transition signaled by $S_1$\nand $\\langle s^2 \\rangle$, which gives itself an early warning\nof the SN bifurcation. The peak in $c_2$ appears at\n$p_{2}=0.635$, anticipating $p_d$ more than twice as early as\nthe percolation transition.\n\n\nTo prove the generality of the precursors we analyze a\ndifferent system, the Ginzburg-Landau equation, which is a\nparadigmatic model experiencing a continuous transition (see\nMethods). Figure (\\ref{fig2}a) shows averages of the spatial\nmean field $\\bar\\psi$. Here correlations continuously build-up\nwhen increasing $p$ towards the critical point at $p_d=0$ and,\nunlike the previous discontinuous transition, continuously\ndecrease after crossing it. Therefore, there are now two\npercolation transitions in the functional networks: one at each\nside of $p_d$, as seen by the indicators $S_1$ and $\\langle s^2\n\\rangle$ in Fig. \\ref{fig2}b. Figure \\ref{fig2}c depicts the\nprobabilities $c_2$, $c_5$ and $c_9$, giving a clear warning\nfurther away from $p_d$. Figure \\ref{fig2}d displays the values\n$p_s$ corresponding to the maxima in $c_{s}$. There are two\nsuccessions of peaks converging to the percolation transitions\noccurring before and after the bifurcation.\n\nBuilding functional networks involves to fix the correlation\nthreshold $\\gamma$ above which two elements are considered as\nlinked. Figure \\ref{fig3} shows (for the LE model; results for\nother models are in Supplementary Information) how the\npercolation transition and the values of $c_2$ depend on both\n$p$ and $\\gamma$. If $\\gamma$ is very high, the network is\nnever connected and there is no signal. Similarly, if $\\gamma$\nis very low the network is always fully connected and there is\nno hint of the bifurcation. However, as shown in the figure\nthere is a range of values of $\\gamma$ where the percolation\ntransition and its associated early warning signals appear. For\na fixed value of $\\gamma$ the peak of $c_2$ (white dots) always\noccurs earlier than the percolation transition (black dots). As\n$\\gamma$ decreases, the peak of $c_2$ occurs at earlier values\nof $p$. The curve of $c_2$, however, widens and the resolution\nin the location of the peak gets poorer. The lowest (optimal)\nvalue of $\\gamma$ at which the peak can be distinguished marks\nthus the earliest warning signal that can be obtained for the\nbifurcation. The behavior exemplified in Fig. \\ref{fig3} is\ncommon to several types of transitions, as shown in the\nSupplementary Information.\n\n\n\\begin{figure}[h]\n\\includegraphics[width=8.6cm]{Figure4}\n\n\\caption{{\\bf Application to El Ni\\~no phenomenon}. The upper panel shows a map\nof the area over which the mean Sea Surface Temperature $T$ is\nmonitored in the NINO3.4. Points denote locations used here as nodes\nin a functional network. Three events, two La Ni\\~{n}a (cold) and one\nEl Ni\\~{n}o (warm), are shown in the time axis of panels\n{\\bf a} to {\\bf f}. Conventional starting dates of the events are marked\nby vertical orange lines. In {\\bf a} and {\\bf b}, the sea surface temperature $T$ as a\nfunction of time. A functional network is constructed from correlations\nat $\\gamma=1-\\varepsilon$ with $\\varepsilon=8\\times 10^{-5}$. The size\nof the giant component $S_1$ is shown in panels {\\bf c} and {\\bf d},\nshowing percolating phases at a plateau, flanked by two percolation transitions,\nwhich occurs before each of the events. Panels {\\bf e} and {\\bf f} show\n$c_2$ in the same time frame. Maxima in $c_2$\nflank both sides of the percolation plateaux, in a manner similar to the\nGinzburg-Landau case shown in Fig. \\ref{fig2}.}\n\\label{fig4}\n\\end{figure}\n\n\n\nTo test the behavior of our precursors in a real situation, we\nanalyze sea surface temperature data from the region of the\nPacific used to compute the NINO3.4 index\\cite{Ludescher2013}.\nEl Ni\\~{n}o-Southern\nOscillation\\cite{Sarachick2010,Dijkstra2006} is the dominant\nvariability mode in present-day climate, characterized by\nrather irregular (with average period of about 4 years) warm\n(El Ni\\~{n}o) and cold (La Ni\\~{n}a) episodes departing from\nthe long-term mean temperature in the equatorial Pacific. These\noscillations are related to the presence of a Hopf bifurcation\nin the coupled atmosphere-ocean\nsystem\\cite{Sarachick2010,Dijkstra2006}. The bifurcation can be\ncrossed or just approached, being then the oscillation excited\nby noise. In both cases there should be a build-up of\ncorrelations that would become visible in functional networks\nconstructed from temperature time series. In this case there is\nno control parameter to fix, but rather the equatorial Pacific\nevolves in time, coupled to the seasonal cycle, leading to\nchanging spatial correlations. We construct functional networks\nfrom time windows of the time series from different locations\n(see Fig. \\ref{fig4}) and analyze them with the methods\ndeveloped above.\n\nWe have focused on two different periods:  $1987-1989$, during\nwhich a strong La Ni\\~{n}a occurred, and $1996-1998$, featuring\none El Ni\\~{n}o-La Ni\\~{n}a pair. Modifying $\\gamma$, it is\npossible to find a range of values in which a percolation\ntransition is observed. Fixing $\\gamma$ where the\nsignal-to-noise ratio is stronger, a pair of percolation\ntransitions is clearly seen enclosing a percolated phase with a\nlarge value of $S_1$ for each of the events. The indicator\n$c_2$ has maxima before and after the two percolation\ntransitions associated to each event. The full picture is\nstrongly reminiscent of the situation found with the\nGinzburg-Landau model in Fig. \\ref{fig3}, characteristic of a\ncontinuous transition.\n\nWe have shown that consideration of the percolation transition\nin functional networks constructed from spatial correlations in\nextended systems provides powerful anticipatory tools for their\ndynamical regime shifts. Precursors of the percolation\ntransition itself, such as the probabilities $c_s$ for random\nnodes to belong to small clusters, add extra anticipatory\nrange. We note that $\\gamma$ and $s$ are methodological\nparameters, so that they can be explored even when far from the\ndynamical transition. Then plots similar to partial versions of\nFigs. \\ref{fig2}d or \\ref{fig3} can give a hint on the distance\nto the approaching transition. The tools presented here work in\na variety of transition types, provided correlations increase\nwhen approaching them, and are useful even in cases, such as El\nNi\\~{n}o events, where very little information on the\nunderlying dynamics is available. Thus we expect they will\nbecome instrumental in the monitoring and management of complex\nsystems.\n\n\n\\section*{METHODS}\n\n\nWe have considered two dynamical models with different\nbifurcations and also the Sea Surface Temperature time series\nfrom the Pacific Ocean. Results for a third model (the\nLorenz'96 model) are included in the Supplementary Information.\n\nThe first model, the LE model, is representative of systems\nexperiencing a SN bifurcation. It is a spatial version of a\ndescription of phosphorous recycling in a lake\n\\cite{Carpenter1999}. The state of the system is given by the\ntwo-dimensional field $\\psi({\\mathbf x},t)$ representing the amount of\nphosphorous in the lake, evolving according to\n\n", "index": 1, "text": "\\begin{equation}\n\\frac{\\partial\\psi({\\mathbf x},t)}{\\partial t} = p - b\\psi({\\mathbf x},t) +\nr f(\\psi) + \\epsilon\\nabla^2 \\psi({\\mathbf x},t) + \\eta({\\mathbf x},t) \\ .\n\\label{Lk}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"\\frac{\\partial\\psi({\\mathbf{x}},t)}{\\partial t}=p-b\\psi({\\mathbf{x}},t)+rf(%&#10;\\psi)+\\epsilon\\nabla^{2}\\psi({\\mathbf{x}},t)+\\eta({\\mathbf{x}},t)\\ .\" display=\"block\"><mrow><mrow><mfrac><mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>\u03c8</mi></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc31</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mrow><mrow><mi>p</mi><mo>-</mo><mrow><mi>b</mi><mo>\u2062</mo><mi>\u03c8</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc31</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><mrow><mi>r</mi><mo>\u2062</mo><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c8</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mi>\u03f5</mi><mo>\u2062</mo><mrow><msup><mo>\u2207</mo><mn>2</mn></msup><mo>\u2061</mo><mi>\u03c8</mi></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc31</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mi>\u03b7</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc31</mi><mo>,</mo><mi>t</mi><mo rspace=\"7.5pt\" stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01978.tex", "nexttext": "\nAs before, $\\epsilon$ is diffusive coupling and $\\eta$ is an\nadditive uncorrelated noise uniform in $[-a,a]$. We discretize\nequation (\\ref{Gi}) into $N=5000$ nodes, and take\n$\\epsilon=1.5$, $a=0.01$. The integration parameters $dt$ and\n$dx$ are as before. A continuous transition from zero\nmagnetization occurs when increasing the control parameter $p$\nabove $p_d=0$.\n\nFor the climatic data analysis, Sea Surface Temperatures were\nobtained from the ERA-interim reanalysis of the European Centre\nfor Medium-Range Weather Forecasts\\cite{ECSMs}, with daily\ntemporal resolution and a spatial resolution of $\\Delta x =\n0.125^\\circ$, in the range of years 1979--2014.\n\nIn all cases, the spatial variance of the fields is defined as:\n\n", "itemtype": "equation", "pos": 20490, "prevtext": "\n$f(\\psi)=\\psi^8/(\\psi^8+1)$ is a nonlinear response of the lake\nsediments to phosphorous, $p$ is the nutrient rate input, taken\nhere as the control parameter. $\\epsilon$ is the strength of\ndiffusive spatial coupling, and $\\eta$ represents an additive\nstochastic perturbation uncorrelated in space and time. We take\n$b=r=1$ and $\\epsilon=1.2$. Space is discretized as a square\nlattice of $N=70\\times70=4900$ grid points separated by $dx=1$.\nThese will be the nodes of the functional network. The\nLaplacian is discretized with the simplest finite differences\nscheme and the deterministic terms in equation (\\ref{Lk}) are\nintegrated with a 4th order Runge-Kutta method of time step\n$dt=0.05$ after which the $\\eta$ term is implemented by adding\nan independent random number uniform in $[-a,a]$ to each\nlattice site (we use $a=0.125$). We approach from the left the\nSN bifurcation occurring at $p=p_{SN}=0.660$, above which the\nclear-water low-phosphorous state existing for $p<p_{SN}$\nceases to exist and the lake jumps to an eutrophicated\nhigh-phosphorous state. The stochastic perturbation makes the\njump to occur at a value of $p$, $p_d$, slightly below the SN\nvalue. On average (see Fig. \\ref{fig1}), we find $p_d\\approx\n0.658$. This value is sufficiently close to $p_{SN}$ as to\ndisplay the enhancement of correlations and slowing down which\nare at the basis of our method and of other early-warning\nmethodologies. In this paper we have only displayed results\nobtained when slowly increasing the control parameter $p$. When\ndecreasing $p$ from higher values hysteresis occurs and a\ndifferent SN bifurcation is encountered at a lower $p'_d\\approx\n0.389$. The sequence of precursors encountered when approaching\nthis lower transition point is similar to the one shown here.\n\nAs a second model, we consider the time-dependent\nGinzburg-Landau equation\\cite{Hohenberg1977} or model A\ndescribing, for example, transitions in anisotropic\nferromagnets. We study the one-dimensional version for the\nmagnetization $\\psi(x,t)$:\n\n", "index": 3, "text": "\\begin{equation}\n\\frac{\\partial\\psi(x,t)}{\\partial t} = p\\psi(x,t) - \\psi(x,t)^3 + \\epsilon\\nabla^2\\psi(x,t)  + \\eta(x,t).\n\\label{Gi}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"\\frac{\\partial\\psi(x,t)}{\\partial t}=p\\psi(x,t)-\\psi(x,t)^{3}+\\epsilon\\nabla^{%&#10;2}\\psi(x,t)+\\eta(x,t).\" display=\"block\"><mrow><mrow><mfrac><mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>\u03c8</mi></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mrow><mrow><mrow><mi>p</mi><mo>\u2062</mo><mi>\u03c8</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mi>\u03c8</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mn>3</mn></msup></mrow></mrow><mo>+</mo><mrow><mi>\u03f5</mi><mo>\u2062</mo><mrow><msup><mo>\u2207</mo><mn>2</mn></msup><mo>\u2061</mo><mi>\u03c8</mi></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mi>\u03b7</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01978.tex", "nexttext": "\nwhere $\\bar\\psi(t) =\n\\frac{1}{N}\\sum\\limits_{l=1}^{N}\\psi({\\mathbf x_{l}},t)$ is the\naverage over the system nodes, at positions ${\\mathbf x}_l$,\n$l=1,...,N$. This quantity, further averaged over time, is\ndisplayed in Fig. \\ref{fig1}b for the LE model.\n\nTo construct functional networks from the time series of the LE\nand GL models at each location ${\\mathbf x}_l$, $l=1,...,N$, we take\n$T=1000$ temporal snapshots in the asymptotic state\n$\\{\\psi({\\mathbf x}_l,t_k)\\}_{k=1,...,T}$ (to improve statistics we\ntake them sufficiently distant in time as to be nearly\nuncorrelated temporally) and compute the Pearson correlation:\n\n", "itemtype": "equation", "pos": 21366, "prevtext": "\nAs before, $\\epsilon$ is diffusive coupling and $\\eta$ is an\nadditive uncorrelated noise uniform in $[-a,a]$. We discretize\nequation (\\ref{Gi}) into $N=5000$ nodes, and take\n$\\epsilon=1.5$, $a=0.01$. The integration parameters $dt$ and\n$dx$ are as before. A continuous transition from zero\nmagnetization occurs when increasing the control parameter $p$\nabove $p_d=0$.\n\nFor the climatic data analysis, Sea Surface Temperatures were\nobtained from the ERA-interim reanalysis of the European Centre\nfor Medium-Range Weather Forecasts\\cite{ECSMs}, with daily\ntemporal resolution and a spatial resolution of $\\Delta x =\n0.125^\\circ$, in the range of years 1979--2014.\n\nIn all cases, the spatial variance of the fields is defined as:\n\n", "index": 5, "text": "\\begin{equation}\n\\bar{\\sigma_{\\psi}} = \\sqrt{\\frac{1}{N}\\sum\\limits_{l=1}^{N}(\\psi({\\mathbf x_{l}},t) - \\bar\\psi(t))^2} \\ ,\n\\label{signmaSpatial}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"\\bar{\\sigma_{\\psi}}=\\sqrt{\\frac{1}{N}\\sum\\limits_{l=1}^{N}(\\psi({\\mathbf{x}_{l%&#10;}},t)-\\bar{\\psi}(t))^{2}}\\ ,\" display=\"block\"><mrow><mrow><mover accent=\"true\"><msub><mi>\u03c3</mi><mi>\u03c8</mi></msub><mo stretchy=\"false\">\u00af</mo></mover><mo>=</mo><mpadded width=\"+5pt\"><msqrt><mrow><mfrac><mn>1</mn><mi>N</mi></mfrac><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mi>\u03c8</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc31</mi><mi>l</mi></msub><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mover accent=\"true\"><mi>\u03c8</mi><mo stretchy=\"false\">\u00af</mo></mover><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></mrow></mrow></msqrt></mpadded></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01978.tex", "nexttext": "\nwhere $p_l(t_k)\\equiv \\psi({\\mathbf x}_l,t_k) - \\frac{1}{T}\\sum_k\n\\psi({\\mathbf x}_l,t_k)$. The network keeps links between pairs of\nnodes $(a,b)$ for which $\\rho_{ab}>\\gamma$. For the sea\ntemperature time-series daily functional networks at day $t$\nwere built from these time series computing the Pearson\ncorrelation with a time window of $T=200$ days (100 days before\nand 100 days after time $t$). The quantities plotted in Fig.\n\\ref{fig3} are further averaged over 5 days.\n\nTo study percolation in these functional networks, as the\ncontrol parameter $p$ approaches transition points $p_d$, we\nhave measured a number of quantities,\nnamely\\cite{Stauffer1994,Newman2010}: a) $S_1$, the relative\nsize of the largest connected component, i.e. the fraction of\nnodes that are in the largest cluster. It abruptly changes from\na value close to 0 to a value close to 1 at the percolation\npoint. b) The fraction of nodes belonging to clusters of size\n$s$, $c_s = s n_s/N$, where $n_s$ is the number of clusters of\nsize $s$ present in the system. This gives also the probability\nthat a randomly chosen node pertains to a cluster of size $s$.\nc) The average size of the clusters excluding the largest one,\ncalculated as $\\sum' s c_s = \\frac{1}{N}\\sum' s^2 n_s \\equiv\n\\langle s^2 \\rangle$, where the sum is over all cluster sizes\nexcluding the largest one. This quantity is maximal at the\npercolation point.\n\n\\section*{Acknowledgements}\nV.R-M. was supported by the European Commission Marie-Curie ITN\nprogram (FP7-320 PEOPLE-2011-ITN) through the LINC project\n(Grant no. 289447). We also acknowledge support from FEDER and\nMINECO (Spain) through the project INTENSE@COSYP\n(FIS2012-30634) and from the European Commission through\nproject LASAGNE (FP7-ICT- 318132).\n\n\n\\begin{thebibliography}{10}\n\n\\bibitem{Scheffer2001}\nScheffer, M., Carpenter, S., Foley, J.~A., Folke, C. \\& Walker, B.\nCatastrophic shifts in ecosystems. \\emph{Nature} \\textbf{413}, 591--596 (2001).\n\n\n\n\n\n\n\\bibitem{Dobson2007}\nDobson, I., Carreras, B.~A., Lynch, V.~E. \\& Newman, D.~E.\nComplex systems analysis of series of blackouts: Cascading failure, critical points,\nand self-organization. \\emph{Chaos} \\textbf{17}, 026103 (2007).\n\n\\bibitem{VandeLeemput2014}\nvan de Leemput, I.~a. \\emph{et~al.}\nCritical slowing down as early warning for the onset and termination of depression.\n\\emph{Procs. Natl. Acad. Sci. USA} \\textbf{111}, 87--92 (2014).\n\n\\bibitem{Dakos2008}\nDakos, V. \\emph{et~al.}\nSlowing down as an early warning signal for abrupt climate change.\n\\emph{Procs. Natl. Acad. Sci. USA} \\textbf{105}, 14308--14312 (2008).\n\n\\bibitem{Thompson2011}\nThompson, J. M.~T. \\& Sieber, J.\nPredicting Climate Tipping As a Noisy Bifurcation: a Review.\n\\emph{International Journal of Bifurcation and Chaos} \\textbf{21}, 399--423 (2011).\n\n\\bibitem{Lenton2012}\nLenton, T.~M., Livina, V.~N., Dakos, V., van Nes, E.~H. \\& Scheffer, M.\nEarly warning of climate tipping points from critical slowing down: comparing methods to improve robustness.\n\\emph{Philosophical Transactions of the Royal Society A} \\textbf{370}, 1185--1204 (2012).\n\n\\bibitem{Tsonis2004}\nTsonis, A.~A. \\& Roebber, P.~J.\nThe architecture of the climate network.\n\\emph{Physica A} \\textbf{333}, 497--504 (2004).\n\n\\bibitem{Eguiluz2005}\nEgu\\'{\\i}luz, V.~M., Chialvo, D.~R., Cecchi, G.~A., Baliki, M. \\& Apkarian, A.~V.\nScale-free brain functional networks.\n\\emph{Phys. Rev. Lett.} \\textbf{94}, 1--4 (2005).\n\n\\bibitem{Timme2014}\nTimme, M. \\& Casadiego, J.\nRevealing networks from dynamics: an introduction.\n\\emph{Journal of Physics A} \\textbf{47}, 343001 (2014).\n\n\\bibitem{Zhou2015} Zhou, D., Gozolchiani, A., Ashkenazy, Y. \\&\n    Havlin, S.\nTeleconnection Paths via Climate Network Direct Link Detection.\n\\emph{Phys. Rev. Lett.} \\textbf{115}, 268501  (2015).\n\n\\bibitem{Stauffer1994}\nStauffer, D. \\& Aharony, A.\n\\emph{Introduction to Percolation Theory} (Taylor \\& Francis Inc,\n  Philadelphia (1994)).\n\n\\bibitem{Newman2010}\nNewman, M.\n\\emph{Networks: An Introduction} (Oxford University Press, Oxford, UK, 2010).\n\n\\bibitem{Scheffer2012}\nScheffer, M. \\emph{et~al.}\nAnticipating Critical Transitions.\n\\emph{Science} \\textbf{338}, 344--348 (2012).\n\n\n\n\n\n\n\n\n\\bibitem{Wang2012b}\nWang, R. \\emph{et~al.}\nFlickering gives early warning signals of a critical\n  transition to a eutrophic lake state.\n\\emph{Nature} \\textbf{492}, 419--22 (2012).\n\n\\bibitem{Dakos2015}\nDakos, V., Carpenter, S.~R., Nes, E. H.~V. \\& Scheffer, M.\nResilience indicators: prospects and limitations for\n  early warnings of regime shifts.\n\\emph{Philosophical Transactions of the Royal Society of London B} \\textbf{370}, 20130263 (2015).\n\n\\bibitem{Veraart2012e}\nVeraart, A.~J. \\emph{et~al.}\nRecovery rates reflect distance to a tipping point in a living system.\n\\emph{Nature} \\textbf{481}, 357--359 (2012).\n\n\\bibitem{Quail2015}\nQuail, T., Shrier, A. \\& Glass, L.\nPredicting the onset of period-doubling bifurcations in noisy cardiac systems.\n\\emph{Proc. Natl. Acad. Sci. USA} \\textbf{112}, 9358--9363 (2015).\n\n\\bibitem{Scheffer2009}\nScheffer, M. \\emph{et~al.}\nEarly-warning signals for critical transitions.\n\\emph{Nature} \\textbf{461}, 53--59 (2009).\n\n\\bibitem{Guttal2009}\nGuttal, V. \\& Jayaprakash, C.\nSpatial variance and spatial skewness: leading indicators of regime shifts in spatial ecological systems.\n\\emph{Theoretical Ecology}\n  \\textbf{2}, 3--12 (2009).\n\n\\bibitem{Dakos2010}\nDakos, V., van Nes, E.~H., Donangelo, R., Fort, H. \\& Scheffer, M.\n Spatial correlation as leading indicator of catastrophic shifts.\n\\emph{Theoretical Ecology} \\textbf{3}, 163--174 (2010).\n\n\\bibitem{Dakos2011}\nDakos, V., K\\'{e}fi, S., Rietkerk, M., van Nes, E.~H. \\& Scheffer, M.\nSlowing down in spatially patterned ecosystems at the brink of collapse.\n\\emph{The American Naturalist} \\textbf{177}, E153--E166 (2011).\n\n\\bibitem{VanderMheen2013d}\n{Van Der Mheen}, M. \\emph{et~al.}\nInteraction network based early warning indicators for the Atlantic MOC collapse.\n\\emph{Geophysical Research Letters} \\textbf{40}, 2714--2719 (2013).\n\n\\bibitem{Tirabassi2014}\nTirabassi, G. \\emph{et~al.}\nInteraction network based early-warning indicators of vegetation transitions.\n\\emph{Ecological Complexity} \\textbf{19}, 148--157 (2014).\n\n\\bibitem{Feng2014}\nFeng, Q., Viebahn, J.~P. \\& Dijkstra, H.~A.\nDeep ocean early warning signals of an atlantic MOC collapse.\n\\emph{Geophysical Research Letters} \\textbf{41}, 6008--6014 (2014).\n\n\\bibitem{Ludescher2013}\nLudescher, J. \\emph{et~al.}\nImproved El Ni\\~no forecasting by cooperativity detection.\n\\emph{Procs. Natl. Acad. Sci. USA} \\textbf{110}, 11742--11745 (2013).\n\n\\bibitem{Sarachick2010}\nSarachik, E.~S. \\& Cane, M.~A.\n\\emph{The El Ni\\~no-Southern Oscillation Phenomenon}\n  (Cambridge University Press, Cambridge, UK, 2010).\n\n\\bibitem{Dijkstra2006}\nDijkstra, H.~A.\nThe ENSO phenomenon:\n    theory and mechanisms. \\emph{Advances in Geosciences}\n    \\textbf{6}, 3--15 (2006).\n\n\\bibitem{Carpenter1999}\nCarpenter, S.~R., Ludwig, D. \\& Brock, W.~A.\nManagement of eutrophication for lakes subject to potentially irreversible change.\n\\emph{Ecological Applications} \\textbf{9}, 75--771 (1999).\n\n\\bibitem{Hohenberg1977}\nHohenberg, P.~C. \\& Halperin, B.~I.\nTheory of dynamic critical phenomena.\n\\emph{Rev. Mod. Phys.} \\textbf{49}, 435--479 (1977).\n\n\\bibitem{ECSMs}\nECMWF.\nEuropean Centre for Medium-Range Weather Forecasts,\n  2009: ERA-Interim Project [Available online at\n  http://apps.ecmwf.int/datasets/data/interim-full-daily].\n\n\n\\end{thebibliography}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\newpage\n\n\n\\onecolumngrid\n\\appendix\n\n\n\\setcounter{equation}{0}  \n\\setcounter{figure}{0}  \n\n\n\n\n\\section*{Supplementary Information}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThis Supplementary Information gives additional data on\npercolation precursors for two different dynamical systems.\nFirst, dynamical and percolation transitions are studied for a\nsystem displaying regular and chaotic dynamics, the Lorenz'96\nmodel. Second, the behavior with changing threshold is analyzed\nfor the continuous transition experienced by the\nGinzburg-Landau model already presented in the main text.\n\n\n\\subsection{Transitions and percolation in the Lorenz'96 model}\n\nCoupled chaotic oscillators display a large variety of\ndynamical regimes. Thus, due to the different bifurcations\npresent in those models, they are an excellent test bed to\nprove the generality of the network-based percolation\nprecursors methodology. Here we consider the Lorenz'96 model\n\\cite{Lorenz1996}. It was proposed by E. Lorenz as a simplified\nframework to investigate atmospheric predictability. It reads:\n\n", "itemtype": "equation", "pos": 22151, "prevtext": "\nwhere $\\bar\\psi(t) =\n\\frac{1}{N}\\sum\\limits_{l=1}^{N}\\psi({\\mathbf x_{l}},t)$ is the\naverage over the system nodes, at positions ${\\mathbf x}_l$,\n$l=1,...,N$. This quantity, further averaged over time, is\ndisplayed in Fig. \\ref{fig1}b for the LE model.\n\nTo construct functional networks from the time series of the LE\nand GL models at each location ${\\mathbf x}_l$, $l=1,...,N$, we take\n$T=1000$ temporal snapshots in the asymptotic state\n$\\{\\psi({\\mathbf x}_l,t_k)\\}_{k=1,...,T}$ (to improve statistics we\ntake them sufficiently distant in time as to be nearly\nuncorrelated temporally) and compute the Pearson correlation:\n\n", "index": 7, "text": "\\begin{equation}\n\\rho_{a b} =\\frac{\\sum_k p_a(t_k) p_b(t_k)}{\\sqrt{\\left(\\sum_k p_a(t_k)^2\\right)\\left(\\sum_k p_b(t_k)^2\\right)}} \\ ,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"\\rho_{ab}=\\frac{\\sum_{k}p_{a}(t_{k})p_{b}(t_{k})}{\\sqrt{\\left(\\sum_{k}p_{a}(t_%&#10;{k})^{2}\\right)\\left(\\sum_{k}p_{b}(t_{k})^{2}\\right)}}\\ ,\" display=\"block\"><mrow><mrow><msub><mi>\u03c1</mi><mrow><mi>a</mi><mo>\u2062</mo><mi>b</mi></mrow></msub><mo>=</mo><mpadded width=\"+5pt\"><mfrac><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mi>k</mi></msub><mrow><msub><mi>p</mi><mi>a</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>p</mi><mi>b</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><msqrt><mrow><mrow><mo>(</mo><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mi>k</mi></msub><mrow><msub><mi>p</mi><mi>a</mi></msub><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></mrow></mrow><mo>)</mo></mrow><mo>\u2062</mo><mrow><mo>(</mo><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mi>k</mi></msub><mrow><msub><mi>p</mi><mi>b</mi></msub><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></mrow></mrow><mo>)</mo></mrow></mrow></msqrt></mfrac></mpadded></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01978.tex", "nexttext": "\n$\\psi_k(t)$ is meant to represent the values of some\natmospheric variable at different locations $k$, $k=1\\ldots N$,\narranged in a onedimensional ring around the globe (an thus\nhaving periodic boundary conditions). The structure of Eq.\n(\\ref{Lo}) contains some of the main elements of fluid\ndynamics, namely dissipation, external forcing, and quadratic\nnon-linearity through an advection-like term. In addition to\nthe constant forcing $p$, which will be our control parameter,\nwe include an additive stochastic perturbation $\\eta_k(t)$\nuncorrelated in space and time. It is implemented here by\nadding independent random numbers uniform in $[-a,a]$ ($a=0.1$)\nafter each time step ($dt=1/64$) of a fourth-order Runge-Kutta\nmethod which is used to integrate the rest of the terms. We\nfocus in the behavior for $N=2500$ elements or oscillators. In\nthe absence of the random forcing, three dynamical regimes are\neasily identified \\cite{Karimi2010}: i) For small $p$,\n$p<p_1=8/9$, the system stabilizes in the homogeneous fixed\npoint $\\psi_{k}(t) = p , \\forall \\ k, \\ t$. ii) for\nintermediate values of $p$, $8/9<p<4.1$ the system experiences\na Hopf bifurcation leading to traveling waves. iii) Beyond\n$p>p_2\\approx 4.1$ the system becomes spatiotemporally chaotic.\n\nTo display the bifurcations observed when integrating Eq.\n(\\ref{Lo}) for $N=2500$ elements we have calculated a\nPoincare's transversal section in the subspace of two\ncontiguous oscillators: one of the oscillators, say $\\psi_1$,\nis monitored and when it crosses the value $\\psi_1=1$ in the\nincreasing direction the value of the contiguous oscillator,\nsay $\\phi=\\psi_2$ is recorded and displayed. The bifurcation\ndiagram showing the values of these sections $\\phi$ is plotted\nin figure \\ref{figS1}a as a function of $p$. The three regimes\ndescribed above for the deterministic system are readily\nidentified here also.\n\nFunctional networks were constructed by interpreting the\nlocations $k$ as nodes and assigning links between pairs of\nnodes when the Pearson correlation is larger than a threshold\n$\\gamma$. Panel b shows the quantities $S_1$, the size of the\nlargest cluster, and $\\left<s^2\\right>$, the mean cluster size\nexcluding the largest one, for such network when $\\gamma=0.16$.\nPanels c and d display the properties of several $c_s$, the\nprobabilities of randomly chosen nodes to pertain to clusters\nof size $s$. These figures clearly identify the presence of a\npercolated phase at intermediate values of $p$, started and\nended by two percolation transitions. Figure \\ref{figS2} shows\nthe quantity $c_2$ in the ($\\gamma, p$) parameter plane for\nthis model. We see that for increasing threshold the maxima of\n$c_2$ approach the locations $p_1$ and $p_2$ at which traveling\nwaves are born at a Hopf bifurcation and give rise to chaotic\nbehavior, respectively. Thus, the percolating phase is a\nmanifestation of the long-range coherence of the traveling wave\nstate, whereas correlation length remains small in the\nhomogeneous and in the chaotic regime. The quantity $c_2$ (and\nindeed the other $c_s$) clearly anticipates the first\nbifurcation when increasing $p$. It also largely anticipates\nthe occurrence of a chaos-order transition when decreasing $p$\nfrom large values.\n\n\n\\begin{figure*}[h]\n\\begin{center}\n\\includegraphics[width=.7\\textwidth,clip=true]{FigureS1}\n\\end{center}\n\\vspace{-1cm}\n\\caption{Panel a shows the bifurcation diagram of\nthe Lorenz'96 model, Eq. (\\ref{Lo}), constructed from a\n2-oscillator Poincar\\'{e} section (see text). The transition to\ntraveling waves at $p_{1} = 8/9$ and to spatiotemporal chaos\n($p_{2}\\approx4.1$) are shown as vertical green lines.\nFunctional networks were built using a threshold of $\\gamma =\n0.16$. The percolation indicators $S_1$ (orange) and\n$\\left<s^2\\right>$ (black) are displayed in panel {\\bf b}.\nPanel {\\bf c} shows $c_2$ (black), $c_5$ (orange), and $c_9$\n(purple). In {\\bf d}, the circles indicate the value of $p$,\n$p_s$ with $s=2,5,9,16$ and $21$, for which the $c_s$ curves\nattain their respective maxima. These indicators reveal a phase\nof percolated correlations in a parameter region which includes\nthe interval $[p_{1},p_{2}]$, flanked by two percolation\ntransitions. The curves have been further averaged over 100\nrealizations of the random noise and initial condition.}\n\\label{figS1}\n\\end{figure*}\n\n\n\\begin{figure*}[t]\n\\begin{center}\n\\includegraphics[width=.5\\textwidth]{FigureS2}\n\\end{center}\n\\caption{The $c_2$ values, as given by the color bar, as a\nfunction of the control parameter $p$ and the threshold\n$\\gamma$ used to build the functional network for the Lorenz'96\nsystem. The dynamical transitions to traveling waves and to\nchaos are indicated by the vertical black lines. The horizontal\ngreen line identifies the value $\\gamma=0.16$ for which Fig.\n\\ref{figS1} was constructed} \\label{figS2}\n\\end{figure*}\n\n\\subsection{Changing the threshold in the Ginzburg-Landau model}\n\nIn the main text (Eq. (2) there) we presented the\nGinzburg-Landau model, which experiences a continuous pitchfork\nbifurcation at $p=0$, and showed the percolation behavior of\nthe functional network constructed at a fixed value of the\nthreshold $\\gamma$, namely $\\gamma=0.25$. Here, we study what\nhappens to the percolation transition when building the\nnetworks for different thresholds $\\gamma$. Figure \\ref{figS3}\nshows the maxima of $\\langle s^2 \\rangle$ (which locate the\npercolation transitions) and the values of $c_2$, in the\n($\\gamma, p$) parameter space. We see that, when increasing\n$p$, the maximum in the precursor $c_2$ anticipates the\npercolation transition, which itself anticipates the pitchfork\nbifurcation at $p=0$. At the other side of the transition, when\ndecreasing $p$ from the high $p$ state, the maximum in $c_2$\nalso occurs before the percolation transition, which also\nanticipates the dynamical transition. As in the other models\nstudied the amount of anticipation is larger for lower\n$\\gamma$.\n\n\n\n\n\n\n\\begin{figure*}[t]\n\\begin{center}\n\\includegraphics[width=.7\\textwidth]{FigureS3}\n\\end{center}\n\\caption{The $c_2$ values, as given by the color bar as a\nfunction of the control parameter $p$ and the threshold\n$\\gamma$ used to build the functional network for the\nGinzburg-Landau system. The continuous pitchfork bifurcation\noccurs at $p_d=0$. Black dots indicate the maxima of $\\langle\ns^2 \\rangle$, which locate the percolation transition. White\ndots locate the maxima of $c_2$. We see how the percolation\ntransition and its precursor $c_2$ anticipate in different\namounts (when increasing $p$ from the low $p$ state, or when\ndecreasing $p$ from the high $p$ state) the dynamical\nbifurcation. The horizontal green line identifies the value\n$\\gamma=0.25$ for which Fig. 2 of the main text was\nconstructed.} \\label{figS3}\n\\end{figure*}\n\n\\begin{thebibliography}{10}\n\n\\bibitem{Lorenz1996} E.N. Lorenz (1996), {\\sl Predictability: A\n    problem partly solved.} in Proc. Seminar on Predictability Vol. I,\nECMWF Seminar, edited by T. Palmer (ECMWF, Reading, UK), pp.\n1--18.\n\n\\bibitem{Karimi2010} A. Karimi and M. R. Paul (2010), {\\sl\n    Extensive chaos in the Lorenz-96 model}, Chaos {\\bf 20},\n    043105.\n\n\\end{thebibliography}\n\n\n\n", "itemtype": "equation", "pos": 30788, "prevtext": "\nwhere $p_l(t_k)\\equiv \\psi({\\mathbf x}_l,t_k) - \\frac{1}{T}\\sum_k\n\\psi({\\mathbf x}_l,t_k)$. The network keeps links between pairs of\nnodes $(a,b)$ for which $\\rho_{ab}>\\gamma$. For the sea\ntemperature time-series daily functional networks at day $t$\nwere built from these time series computing the Pearson\ncorrelation with a time window of $T=200$ days (100 days before\nand 100 days after time $t$). The quantities plotted in Fig.\n\\ref{fig3} are further averaged over 5 days.\n\nTo study percolation in these functional networks, as the\ncontrol parameter $p$ approaches transition points $p_d$, we\nhave measured a number of quantities,\nnamely\\cite{Stauffer1994,Newman2010}: a) $S_1$, the relative\nsize of the largest connected component, i.e. the fraction of\nnodes that are in the largest cluster. It abruptly changes from\na value close to 0 to a value close to 1 at the percolation\npoint. b) The fraction of nodes belonging to clusters of size\n$s$, $c_s = s n_s/N$, where $n_s$ is the number of clusters of\nsize $s$ present in the system. This gives also the probability\nthat a randomly chosen node pertains to a cluster of size $s$.\nc) The average size of the clusters excluding the largest one,\ncalculated as $\\sum' s c_s = \\frac{1}{N}\\sum' s^2 n_s \\equiv\n\\langle s^2 \\rangle$, where the sum is over all cluster sizes\nexcluding the largest one. This quantity is maximal at the\npercolation point.\n\n\\section*{Acknowledgements}\nV.R-M. was supported by the European Commission Marie-Curie ITN\nprogram (FP7-320 PEOPLE-2011-ITN) through the LINC project\n(Grant no. 289447). We also acknowledge support from FEDER and\nMINECO (Spain) through the project INTENSE@COSYP\n(FIS2012-30634) and from the European Commission through\nproject LASAGNE (FP7-ICT- 318132).\n\n\n\\begin{thebibliography}{10}\n\n\\bibitem{Scheffer2001}\nScheffer, M., Carpenter, S., Foley, J.~A., Folke, C. \\& Walker, B.\nCatastrophic shifts in ecosystems. \\emph{Nature} \\textbf{413}, 591--596 (2001).\n\n\n\n\n\n\n\\bibitem{Dobson2007}\nDobson, I., Carreras, B.~A., Lynch, V.~E. \\& Newman, D.~E.\nComplex systems analysis of series of blackouts: Cascading failure, critical points,\nand self-organization. \\emph{Chaos} \\textbf{17}, 026103 (2007).\n\n\\bibitem{VandeLeemput2014}\nvan de Leemput, I.~a. \\emph{et~al.}\nCritical slowing down as early warning for the onset and termination of depression.\n\\emph{Procs. Natl. Acad. Sci. USA} \\textbf{111}, 87--92 (2014).\n\n\\bibitem{Dakos2008}\nDakos, V. \\emph{et~al.}\nSlowing down as an early warning signal for abrupt climate change.\n\\emph{Procs. Natl. Acad. Sci. USA} \\textbf{105}, 14308--14312 (2008).\n\n\\bibitem{Thompson2011}\nThompson, J. M.~T. \\& Sieber, J.\nPredicting Climate Tipping As a Noisy Bifurcation: a Review.\n\\emph{International Journal of Bifurcation and Chaos} \\textbf{21}, 399--423 (2011).\n\n\\bibitem{Lenton2012}\nLenton, T.~M., Livina, V.~N., Dakos, V., van Nes, E.~H. \\& Scheffer, M.\nEarly warning of climate tipping points from critical slowing down: comparing methods to improve robustness.\n\\emph{Philosophical Transactions of the Royal Society A} \\textbf{370}, 1185--1204 (2012).\n\n\\bibitem{Tsonis2004}\nTsonis, A.~A. \\& Roebber, P.~J.\nThe architecture of the climate network.\n\\emph{Physica A} \\textbf{333}, 497--504 (2004).\n\n\\bibitem{Eguiluz2005}\nEgu\\'{\\i}luz, V.~M., Chialvo, D.~R., Cecchi, G.~A., Baliki, M. \\& Apkarian, A.~V.\nScale-free brain functional networks.\n\\emph{Phys. Rev. Lett.} \\textbf{94}, 1--4 (2005).\n\n\\bibitem{Timme2014}\nTimme, M. \\& Casadiego, J.\nRevealing networks from dynamics: an introduction.\n\\emph{Journal of Physics A} \\textbf{47}, 343001 (2014).\n\n\\bibitem{Zhou2015} Zhou, D., Gozolchiani, A., Ashkenazy, Y. \\&\n    Havlin, S.\nTeleconnection Paths via Climate Network Direct Link Detection.\n\\emph{Phys. Rev. Lett.} \\textbf{115}, 268501  (2015).\n\n\\bibitem{Stauffer1994}\nStauffer, D. \\& Aharony, A.\n\\emph{Introduction to Percolation Theory} (Taylor \\& Francis Inc,\n  Philadelphia (1994)).\n\n\\bibitem{Newman2010}\nNewman, M.\n\\emph{Networks: An Introduction} (Oxford University Press, Oxford, UK, 2010).\n\n\\bibitem{Scheffer2012}\nScheffer, M. \\emph{et~al.}\nAnticipating Critical Transitions.\n\\emph{Science} \\textbf{338}, 344--348 (2012).\n\n\n\n\n\n\n\n\n\\bibitem{Wang2012b}\nWang, R. \\emph{et~al.}\nFlickering gives early warning signals of a critical\n  transition to a eutrophic lake state.\n\\emph{Nature} \\textbf{492}, 419--22 (2012).\n\n\\bibitem{Dakos2015}\nDakos, V., Carpenter, S.~R., Nes, E. H.~V. \\& Scheffer, M.\nResilience indicators: prospects and limitations for\n  early warnings of regime shifts.\n\\emph{Philosophical Transactions of the Royal Society of London B} \\textbf{370}, 20130263 (2015).\n\n\\bibitem{Veraart2012e}\nVeraart, A.~J. \\emph{et~al.}\nRecovery rates reflect distance to a tipping point in a living system.\n\\emph{Nature} \\textbf{481}, 357--359 (2012).\n\n\\bibitem{Quail2015}\nQuail, T., Shrier, A. \\& Glass, L.\nPredicting the onset of period-doubling bifurcations in noisy cardiac systems.\n\\emph{Proc. Natl. Acad. Sci. USA} \\textbf{112}, 9358--9363 (2015).\n\n\\bibitem{Scheffer2009}\nScheffer, M. \\emph{et~al.}\nEarly-warning signals for critical transitions.\n\\emph{Nature} \\textbf{461}, 53--59 (2009).\n\n\\bibitem{Guttal2009}\nGuttal, V. \\& Jayaprakash, C.\nSpatial variance and spatial skewness: leading indicators of regime shifts in spatial ecological systems.\n\\emph{Theoretical Ecology}\n  \\textbf{2}, 3--12 (2009).\n\n\\bibitem{Dakos2010}\nDakos, V., van Nes, E.~H., Donangelo, R., Fort, H. \\& Scheffer, M.\n Spatial correlation as leading indicator of catastrophic shifts.\n\\emph{Theoretical Ecology} \\textbf{3}, 163--174 (2010).\n\n\\bibitem{Dakos2011}\nDakos, V., K\\'{e}fi, S., Rietkerk, M., van Nes, E.~H. \\& Scheffer, M.\nSlowing down in spatially patterned ecosystems at the brink of collapse.\n\\emph{The American Naturalist} \\textbf{177}, E153--E166 (2011).\n\n\\bibitem{VanderMheen2013d}\n{Van Der Mheen}, M. \\emph{et~al.}\nInteraction network based early warning indicators for the Atlantic MOC collapse.\n\\emph{Geophysical Research Letters} \\textbf{40}, 2714--2719 (2013).\n\n\\bibitem{Tirabassi2014}\nTirabassi, G. \\emph{et~al.}\nInteraction network based early-warning indicators of vegetation transitions.\n\\emph{Ecological Complexity} \\textbf{19}, 148--157 (2014).\n\n\\bibitem{Feng2014}\nFeng, Q., Viebahn, J.~P. \\& Dijkstra, H.~A.\nDeep ocean early warning signals of an atlantic MOC collapse.\n\\emph{Geophysical Research Letters} \\textbf{41}, 6008--6014 (2014).\n\n\\bibitem{Ludescher2013}\nLudescher, J. \\emph{et~al.}\nImproved El Ni\\~no forecasting by cooperativity detection.\n\\emph{Procs. Natl. Acad. Sci. USA} \\textbf{110}, 11742--11745 (2013).\n\n\\bibitem{Sarachick2010}\nSarachik, E.~S. \\& Cane, M.~A.\n\\emph{The El Ni\\~no-Southern Oscillation Phenomenon}\n  (Cambridge University Press, Cambridge, UK, 2010).\n\n\\bibitem{Dijkstra2006}\nDijkstra, H.~A.\nThe ENSO phenomenon:\n    theory and mechanisms. \\emph{Advances in Geosciences}\n    \\textbf{6}, 3--15 (2006).\n\n\\bibitem{Carpenter1999}\nCarpenter, S.~R., Ludwig, D. \\& Brock, W.~A.\nManagement of eutrophication for lakes subject to potentially irreversible change.\n\\emph{Ecological Applications} \\textbf{9}, 75--771 (1999).\n\n\\bibitem{Hohenberg1977}\nHohenberg, P.~C. \\& Halperin, B.~I.\nTheory of dynamic critical phenomena.\n\\emph{Rev. Mod. Phys.} \\textbf{49}, 435--479 (1977).\n\n\\bibitem{ECSMs}\nECMWF.\nEuropean Centre for Medium-Range Weather Forecasts,\n  2009: ERA-Interim Project [Available online at\n  http://apps.ecmwf.int/datasets/data/interim-full-daily].\n\n\n\\end{thebibliography}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\newpage\n\n\n\\onecolumngrid\n\\appendix\n\n\n\\setcounter{equation}{0}  \n\\setcounter{figure}{0}  \n\n\n\n\n\\section*{Supplementary Information}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThis Supplementary Information gives additional data on\npercolation precursors for two different dynamical systems.\nFirst, dynamical and percolation transitions are studied for a\nsystem displaying regular and chaotic dynamics, the Lorenz'96\nmodel. Second, the behavior with changing threshold is analyzed\nfor the continuous transition experienced by the\nGinzburg-Landau model already presented in the main text.\n\n\n\\subsection{Transitions and percolation in the Lorenz'96 model}\n\nCoupled chaotic oscillators display a large variety of\ndynamical regimes. Thus, due to the different bifurcations\npresent in those models, they are an excellent test bed to\nprove the generality of the network-based percolation\nprecursors methodology. Here we consider the Lorenz'96 model\n\\cite{Lorenz1996}. It was proposed by E. Lorenz as a simplified\nframework to investigate atmospheric predictability. It reads:\n\n", "index": 9, "text": "\\begin{equation}\n\\frac{d\\psi_k(t)}{dt}=\\left[\\psi_{k+1}(t) - \\psi_{k-2}(t)\\right]\\psi_{k-1}(t) - \\psi_k(t) + \\eta_k(t) + p \\ .\n\\label{Lo}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"\\frac{d\\psi_{k}(t)}{dt}=\\left[\\psi_{k+1}(t)-\\psi_{k-2}(t)\\right]\\psi_{k-1}(t)-%&#10;\\psi_{k}(t)+\\eta_{k}(t)+p\\ .\" display=\"block\"><mrow><mrow><mfrac><mrow><mi>d</mi><mo>\u2062</mo><msub><mi>\u03c8</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mi>d</mi><mo>\u2062</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mrow><mrow><mrow><mrow><mo>[</mo><mrow><mrow><msub><mi>\u03c8</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><msub><mi>\u03c8</mi><mrow><mi>k</mi><mo>-</mo><mn>2</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>]</mo></mrow><mo>\u2062</mo><msub><mi>\u03c8</mi><mrow><mi>k</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><msub><mi>\u03c8</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><mrow><msub><mi>\u03b7</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mpadded width=\"+5pt\"><mi>p</mi></mpadded></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}]