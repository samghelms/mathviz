[{"file": "1601.04321.tex", "nexttext": "\nThe total wind power fluctuation is denoted by $\\Omega \\doteq \\sum_{j\\in\\mathcal{W}}{\\omega_j}$.\nWhen we introduce wind power control, the output of the wind power plant changes depending on the control policy implemented.\nBoth the mean $\\mu$ and the (distribution of the) uncertain deviation $\\omega$ can be affected by the control, and we denote the new values by $v$ and $\\tilde{\\omega}$ respectively. The new total wind deviation from mean is given by $\\tilde{\\Omega} = \\sum_{j} \\tilde{\\omega}_j$.\n\n\\emph{Wind Power Plants with $\\Delta P$ control}\nThe TSO might use $\\Delta P$ control to reduce the scheduled mean power from a wind power plant $j \\in \\mathcal{W}$ to a value $v_j \\leq \\mu$.\n\nThe wind power output of such plants are given by\n \n", "itemtype": "equation", "pos": 11423, "prevtext": "\n\n\n\n\n\n\n\n\\title{Chance Constrained Optimal Power Flow with Curtailment and Reserves from Wind Power Plants}\n\n\n\n\n\\author{\n\\IEEEauthorblockN{Line Roald\\\\ G\\\"oran Andersson}\n\\IEEEauthorblockA{Power Systems Laboratory \\\\\nETH Zurich\\\\\nZurich, Switzerland\\\\\n\\{roald, andersson\\}@eeh.ee.ethz.ch}\n\\and\n\\IEEEauthorblockN{Sidhant Misra\\\\ Michael Chertkov\\\\ Scott Backhaus}\n\\IEEEauthorblockA{Theoretical Division and CNLS \\\\\nLos Alamos National Laboratory\\\\\nLos Alamos, United States\\\\\n\\{sidhant, chertkov\\}@lanl.gov}\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\maketitle\n\n\n\n\\begin{abstract}\nOver the past years, the share of electricity production from wind power plants has increased to significant levels in several power systems across Europe and the United States. In order to cope with the fluctuating and partially unpredictable nature of renewable energy sources, transmission system operators (TSOs) have responded by increasing their reserve capacity requirements and by requiring wind power plants to be capable of providing reserves or following active power set-point signals.\nThis paper addresses the issue of efficiently incorporating these new types of wind power control in the day-ahead operational planning. We review the technical requirements the wind power plants must fulfill, and propose a mathematical framework for modeling wind power control. The framework is based on an optimal power flow formulation with weighted chance constraints, which accounts for the uncertainty of wind power forecasts and allows us to limit the risk of constraint violations.\nIn a case study based on the IEEE 118 bus system, we use the developed method to assess the effectiveness of different types of wind power control in terms of operational cost, system security and wind power curtailment.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\nRenewables Integration, Reserves from Wind Power Plants, Probabilistic OPF, Operational Planning\n\\end{IEEEkeywords}\n\n\n\n\n\n\n\\section{Introduction}\nOver the last decade, electricity production from wind power plants has reached significant levels in several regions of Europe and the United States.\n\nThe forecast errors and fluctuations inherent to wind power generation has lead transmission system operators (TSOs) to reassess their reserve dimensioning policies \\cite{CAISOreserves}. In systems with large wind penetrations, such as Denmark \\cite{EnergiNet} or Ireland \\cite{EirGrid}, the grid codes now require wind power plants to be able to provide active power control. These control capabilities include droop control for frequency stabilization, down-regulation of the active power output for provision of spinning reserves, capability of following an active power set-point signal and enforcing a cap on the total wind power generation \\cite{EnergiNet}, \\cite{Aho}.\n\n\nWith the above mentioned capabilities, wind power plants are able to participate in ancillary service provision, system balancing and congestion management. While increased controllability is generally improving system performance, wind power plants still differ from conventional generators in that their generation output is fluctuating and their capacity is not fully known in day-ahead operational planning due to forecast uncertainty.\nTherefore, if ancillary service provision from wind power plants is not planned appropriately, the use wind power control might significantly increase operational risk. For example, wind power fluctuations can render the wind power plants unable to deliver the required reserve capacities in real-time.\n\n\nIn this paper, we address the question of how to optimally incorporate the use of wind power control in day-ahead planning.\n\nWe account for wind power variability through the use of the weighted chance constraints (WCC) developed in \\cite{CDC}. The WCC-OPF in \\cite{CDC} is an alternative to the standard Chance-Constrained OPF (CC-OPF) that limits the probability of constraint violations  \\cite{maria, line, 12BCH}.\nOur reason for choosing the WCC-OPF is two-fold.\nFirst, the WCCs accounts for the magnitude of constraint violation via the use of a weight function that assigns higher risk values to larger overloads. The weight function can be motivated using similar arguments as risk functions applied in risk-based OPF (e.g., \\cite{Xiao2009, 14PSCC}), although the WCC limits the expected risk (as opposed to the risk of the forecasted operating point \\cite{Xiao2009} or the worst-case risk with a given probability \\cite{14PSCC}).\nSecond, while wind power curtailment as a reduction of the mean wind power production can easily the incorporated in a CC-OPF formulation, the use of WCCs enables us to model caps on the actual wind power output (e.g., to only curtail wind when the fluctuations are large) while maintaining convexity of the OPF formulation. Convexity is crucial to design efficient optimization algorithms for the WCC-OPF that scale well.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWe review the wind power control capabilities, formulate the control policies associated with them, and incorporate them as tractable extensions to the WCC-OPF. In this paper, we model two types of wind control capabilities, a droop control policy that enables the wind power plants to provide reserves, and a control policy that enforces a cap on the maximum wind power output, while also accounting for the effect of the remaining uncertainty in the system. Leveraging the convexity of the WCC-OPF, we implement an efficient successive cutting-plane algorithm, and test our formulation on a modified version of the IEEE 118 bus system with 25 wind power plants. We quantify the benefits of each type of wind power control in terms of operational cost, system security and the amount of wind power curtailed.\n\n\nThe remainder of the paper is structured as follows: Section \\ref{sec:actControl} reviews the relevant control capabilities of the wind power plants. In Section \\ref{sec:OPF}, the full OPF formulation is presented, with particular focus on the mathematical modeling of wind power control. The definition and handling of the weighted chance constraint is described in Section \\ref{sec:WCC}.\nSection \\ref{sec:CaseStudy} presents the case study, and illustrates important aspects of the developed method, while Section \\ref{sec:Conclusion} summarizes and concludes the paper.\n\n\\subsection{Notations}\nWe denote vectors by lower case letters $p, \\omega$.\nThe components of the vectors are denoted by using subscripts, i.e, the $i$th component of $p$ is denoted by $p_i$.\nMatrices are denoted by upper/lower bold case letters, $\\mathbf{M}$, and $\\mathbf{M}_{(i,\\cdot)}, \\mathbf{M}_{(\\cdot,i)}$ denote the $i^{th}$ row and column of $\\mathbf{M}$, respectively.\nIndex $i$ refers to generators, index $j$ to wind power plants, and index $ij$ refers to lines.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\section{Active power control from wind turbines}\n\\label{sec:actControl}\nCurrent grid-codes in countries with significant penetration of electrical energy from wind power \\cite{EnergiNet, EirGrid} require new installations of wind power plants to provide a variety of active power controls to stabilize the grid frequency and balance the system. In this paper, we consider the situation where the wind turbine adjusts the active power output by changing the amount of energy extracted from the wind (e.g., through pitch control \\cite{Aho}) to follow a reference signal from the TSO. While wind power plants can provide reserves in different ways, we consider the following control mechanisms to be the most suitable for system balancing and congestion management:\\\\\n\\emph{$\\Delta$P control:} The wind power plants monitors the maximum available wind power (given by the current local wind condition) and keeps the output $\\Delta$MW below the maximum. The TSO can ask the wind power plant to implement this control to, e.g., curtail excess wind energy, relieve congestion, or to keep wind power capacity available for reserve provision.\\\\\n\\emph{Output cap:} The output cap is an absolute cap on the active power provided from a single wind power plant. The wind power plant produces at maximum as long as the maximum is below the output cap. If the maximum available power exceeds the output cap, the wind power output is kept constant at the cap. The TSO can use this policy to reduce the variability of the wind power output (with a low cap, the output will essentially be constant) or to handle local transmission constraints by decreasing the peak production.\n\nThe different types of control are shown schematically in Fig. 1. Notice that the power output (red line) is always less or equal to the maximum possible production (blue line) at any given point in time. In case of reserve provision, a nominal curtailment is necessary for the turbine to be able to increase the output power in reaction to a control signal from the TSO. In the case of an output cap, any production above the cap will be curtailed.\nIn the following, we will present a mathematical model of the two types of control, and show how they can be incorporated in an OPF formulation.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\t\n\n\n\n\n\n\n\n\n\n\n\n\n\\begin{figure}[]\n\n\\includegraphics[width=0.9\\columnwidth]{Fig/ActivePowerControl_v5.eps}\n\\centering\n\\caption{The different types active power control ($\\Delta P$ control and output caps), with wind power generation as a function of time (left) and the \"controlled\" wind power curve (right).}\n\\label{fig:actPow}\n\\end{figure}\n\n\n\n\n\n\\section{Optimal Power Flow with Wind Power Control}\n\\label{sec:OPF}\nIn this section, we provide a mathematical model that includes modeling of the wind power control described in the previous section within an OPF probabilistic constraints using the Weighted Chance Constraints.\nThe formulation extends those in \\cite{CDC, 12BCH} by introducing two new modeling elements:\n\\begin{itemize}\n\t\\item[(i)] the deterministic and probabilistic constraints are now modified using additional variables representing reserves from generator and wind power plants\n\t\\item[(ii)] the generation control policies are adapted to represent the two types of wind power control capabilities.\n\\end{itemize}\n\nIn what follows, we will first gradually build up the objective and constraints that describe the WCC-OPF and describe each step in detail.\n\n\\subsection{Network Representation}\nWe represent the power transmission network as an undirected graph $\\mathbb{G} = (\\mathcal{V}, \\mathcal{E})$, where $\\mathcal{V}$ is the set of nodes with $|\\mathcal{V}| = m$ and $\\mathcal{E}$ is the set of edges/transmission lines of the system with $|\\mathcal{E}| = n$.\nThe set of wind generators is denoted by $\\mathcal{W}\\subseteq\\mathcal{V}$.\n\nThe set of non-wind generators is denoted by $\\mathcal{G} \\subseteq \\mathcal{V}$, and are assumed to be controllable within their limits.\nTo simplify notation, we assume that each node of the system has one controllable regular generator with power output $p$, one wind generator with power output $w$ and one load with demand $d$. The nodes without generation or load can be handled by setting the respective entries to zero.\n\n\n\n\n\\subsection{System Modeling with Uncertain Wind Power in-feeds}\n\n\\subsubsection{Modeling Controlled Wind Power in-feeds}\nThe wind in-feeds $w_j$ of an uncontrolled wind power plant is modeled as the sum of the forecasted electricity production from wind, given by $\\mu_j=\\mathbb{E}[w_j]$, and a zero mean fluctuation around the mean, given by ${\\omega_j}$, such that\n\n", "index": 1, "text": "\\begin{align}\n\tw_j = \\mu_j + \\omega_j \\label{total_wind}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle w_{j}=\\mu_{j}+\\omega_{j}\" display=\"inline\"><mrow><msub><mi>w</mi><mi>j</mi></msub><mo>=</mo><mrow><msub><mi>\u03bc</mi><mi>j</mi></msub><mo>+</mo><msub><mi>\u03c9</mi><mi>j</mi></msub></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04321.tex", "nexttext": "\n\nWe assume that the wind power fluctuations $\\tilde{\\Omega}$ are balanced through the automatic generation control (AGC), with participation factors $\\alpha$. For wind power plants contributing to AGC, the resulting wind power output is thus given by\n \n", "itemtype": "equation", "pos": 12239, "prevtext": "\nThe total wind power fluctuation is denoted by $\\Omega \\doteq \\sum_{j\\in\\mathcal{W}}{\\omega_j}$.\nWhen we introduce wind power control, the output of the wind power plant changes depending on the control policy implemented.\nBoth the mean $\\mu$ and the (distribution of the) uncertain deviation $\\omega$ can be affected by the control, and we denote the new values by $v$ and $\\tilde{\\omega}$ respectively. The new total wind deviation from mean is given by $\\tilde{\\Omega} = \\sum_{j} \\tilde{\\omega}_j$.\n\n\\emph{Wind Power Plants with $\\Delta P$ control}\nThe TSO might use $\\Delta P$ control to reduce the scheduled mean power from a wind power plant $j \\in \\mathcal{W}$ to a value $v_j \\leq \\mu$.\n\nThe wind power output of such plants are given by\n \n", "index": 3, "text": "\\begin{align}\n \t\\tilde{w}_j = v_j + \\omega_j. \\label{wind_v}\n \\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\tilde{w}_{j}=v_{j}+\\omega_{j}.\" display=\"inline\"><mrow><mrow><msub><mover accent=\"true\"><mi>w</mi><mo stretchy=\"false\">~</mo></mover><mi>j</mi></msub><mo>=</mo><mrow><msub><mi>v</mi><mi>j</mi></msub><mo>+</mo><msub><mi>\u03c9</mi><mi>j</mi></msub></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04321.tex", "nexttext": "\nWe denote the set of wind power plants providing reserves by $\\mathcal{R}\\subset\\mathcal{C}$.\n\n\n\n\n\\emph{Wind power plants with Output Caps}\nWith output cap control, the TSO can enforce an upper limit on the power output of individual wind power plants. In this case, the power output is given by\n\n", "itemtype": "equation", "pos": 12565, "prevtext": "\n\nWe assume that the wind power fluctuations $\\tilde{\\Omega}$ are balanced through the automatic generation control (AGC), with participation factors $\\alpha$. For wind power plants contributing to AGC, the resulting wind power output is thus given by\n \n", "index": 5, "text": "\\begin{align}\n \t\\tilde{w}_j = v_j - \\alpha_j \\tilde{\\Omega} + \\omega_j. \t\\label{deltap_output}\n \\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\tilde{w}_{j}=v_{j}-\\alpha_{j}\\tilde{\\Omega}+\\omega_{j}.\" display=\"inline\"><mrow><mrow><msub><mover accent=\"true\"><mi>w</mi><mo stretchy=\"false\">~</mo></mover><mi>j</mi></msub><mo>=</mo><mrow><mrow><msub><mi>v</mi><mi>j</mi></msub><mo>-</mo><mrow><msub><mi>\u03b1</mi><mi>j</mi></msub><mo>\u2062</mo><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a9</mi><mo stretchy=\"false\">~</mo></mover></mrow></mrow><mo>+</mo><msub><mi>\u03c9</mi><mi>j</mi></msub></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04321.tex", "nexttext": "\nwhere $v_j \\leq \\mu_j$ is the mean power output and the cap $\\bar{\\omega}$ is the upper bound on the wind power fluctuation. We denote the set of wind power plants with output caps by $\\mathcal{C}\\subset\\mathcal{W}$, and assume that these wind power plants do not provide reserves, i.e., $\\alpha_j = 0~\\forall_{j \\in \\mathcal{C}}$.\n\n\n\n\n\n\n\n\n\n\n\\subsubsection{Modeling Generation Output}\nWe assume that the regular generators participate in reserve provision, and their power output is given by\n\n", "itemtype": "equation", "pos": 12969, "prevtext": "\nWe denote the set of wind power plants providing reserves by $\\mathcal{R}\\subset\\mathcal{C}$.\n\n\n\n\n\\emph{Wind power plants with Output Caps}\nWith output cap control, the TSO can enforce an upper limit on the power output of individual wind power plants. In this case, the power output is given by\n\n", "index": 7, "text": "\\begin{align}\n\t\\tilde{w}_j = v_j + \\min\\{ \\omega_j, \\bar{\\omega}_j \\}, \t\t\\label{cap_output}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\tilde{w}_{j}=v_{j}+\\min\\{\\omega_{j},\\bar{\\omega}_{j}\\},\" display=\"inline\"><mrow><mrow><msub><mover accent=\"true\"><mi>w</mi><mo stretchy=\"false\">~</mo></mover><mi>j</mi></msub><mo>=</mo><mrow><msub><mi>v</mi><mi>j</mi></msub><mo>+</mo><mrow><mi>min</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">{</mo><msub><mi>\u03c9</mi><mi>j</mi></msub><mo>,</mo><msub><mover accent=\"true\"><mi>\u03c9</mi><mo stretchy=\"false\">\u00af</mo></mover><mi>j</mi></msub><mo stretchy=\"false\">}</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04321.tex", "nexttext": "\nwhere $p_i$ is the nominal power output set point and $\\alpha_i$ is the participation factor in balancing the wind power fluctuations.\n\n\\subsubsection{Modeling Power Flows}\nThe power flows on each transmission line is computed according to the standard DC approximation \\cite{wollenberg},\n\n", "itemtype": "equation", "pos": 13565, "prevtext": "\nwhere $v_j \\leq \\mu_j$ is the mean power output and the cap $\\bar{\\omega}$ is the upper bound on the wind power fluctuation. We denote the set of wind power plants with output caps by $\\mathcal{C}\\subset\\mathcal{W}$, and assume that these wind power plants do not provide reserves, i.e., $\\alpha_j = 0~\\forall_{j \\in \\mathcal{C}}$.\n\n\n\n\n\n\n\n\n\n\n\\subsubsection{Modeling Generation Output}\nWe assume that the regular generators participate in reserve provision, and their power output is given by\n\n", "index": 9, "text": "\\begin{align}\n\t\\tilde{p}_i = p_i - \\alpha_i \\tilde{\\Omega},  \\label{gen_output}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\tilde{p}_{i}=p_{i}-\\alpha_{i}\\tilde{\\Omega},\" display=\"inline\"><mrow><mrow><msub><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">~</mo></mover><mi>i</mi></msub><mo>=</mo><mrow><msub><mi>p</mi><mi>i</mi></msub><mo>-</mo><mrow><msub><mi>\u03b1</mi><mi>i</mi></msub><mo>\u2062</mo><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a9</mi><mo stretchy=\"false\">~</mo></mover></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04321.tex", "nexttext": "\nThe matrix $\\mathbf{M} \\in \\mathbb{R}^{n \\times m}$ relates the line flows to the nodal power injections, which are expressed as the sum of controlled generation output $\\tilde{p}$, controlled wind power production $\\tilde{w}$ and demand $-d$.\nThe matrix $\\mathbf{M}$ is defined as\n\n", "itemtype": "equation", "pos": 13946, "prevtext": "\nwhere $p_i$ is the nominal power output set point and $\\alpha_i$ is the participation factor in balancing the wind power fluctuations.\n\n\\subsubsection{Modeling Power Flows}\nThe power flows on each transmission line is computed according to the standard DC approximation \\cite{wollenberg},\n\n", "index": 11, "text": "\\begin{equation}\np_{ij}=\\mathbf{M}_{(ij,\\cdot)}( \\tilde{p} + \\tilde{w}-d). \\forall_{ij\\in \\mathcal{E}}.\n\\label{eq:lineflows}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"p_{ij}=\\mathbf{M}_{(ij,\\cdot)}(\\tilde{p}+\\tilde{w}-d).\\forall_{ij\\in\\mathcal{E%&#10;}}.\" display=\"block\"><mrow><mrow><mrow><msub><mi>p</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>=</mo><mrow><msub><mi>\ud835\udc0c</mi><mrow><mo stretchy=\"false\">(</mo><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow><mo>,</mo><mo>\u22c5</mo><mo stretchy=\"false\">)</mo></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">~</mo></mover><mo>+</mo><mover accent=\"true\"><mi>w</mi><mo stretchy=\"false\">~</mo></mover></mrow><mo>-</mo><mi>d</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>.</mo><msub><mo>\u2200</mo><mrow><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow><mo>\u2208</mo><mi class=\"ltx_font_mathcaligraphic\">\u2130</mi></mrow></msub></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04321.tex", "nexttext": "\nwhere ${B}_{f}$ is the line susceptance matrix and $\\widetilde{B}_{bus}$ the bus susceptance matrix (without the last column and row) \\cite{maria}. We have used\n$\\mathbf{M}_{(ij,\\cdot)}$ as the row of $\\mathbf{M}$ related to the line $(ij) \\in \\mathcal{E}$.\n\n\n\\subsection{Objective function}\nThe objective of the WCC-OPF is to minimize the sum of the generation and reserve cost. This is expressed as\n\n", "itemtype": "equation", "pos": 14368, "prevtext": "\nThe matrix $\\mathbf{M} \\in \\mathbb{R}^{n \\times m}$ relates the line flows to the nodal power injections, which are expressed as the sum of controlled generation output $\\tilde{p}$, controlled wind power production $\\tilde{w}$ and demand $-d$.\nThe matrix $\\mathbf{M}$ is defined as\n\n", "index": 13, "text": "\\begin{equation}\n\\mathbf{M} = B_f \\begin{bmatrix} (\\widetilde{B}_{bus})^{-1}   ~~~ \\bold{0}  \\\\ ~~\\bold{0}  ~~~~~~~~~ 0\\end{bmatrix}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"\\mathbf{M}=B_{f}\\begin{bmatrix}(\\widetilde{B}_{bus})^{-1}~{}~{}~{}\\mathbb{0}\\\\&#10;~{}~{}\\mathbb{0}~{}~{}~{}~{}~{}~{}~{}~{}~{}0\\end{bmatrix}\" display=\"block\"><mrow><mi>\ud835\udc0c</mi><mo>=</mo><mrow><msub><mi>B</mi><mi>f</mi></msub><mo>\u2062</mo><mrow><mo>[</mo><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><mpadded width=\"+9.9pt\"><msup><mrow><mo stretchy=\"false\">(</mo><msub><mover accent=\"true\"><mi>B</mi><mo>~</mo></mover><mrow><mi>b</mi><mo>\u2062</mo><mi>u</mi><mo>\u2062</mo><mi>s</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup></mpadded><mo>\u2062</mo><mn/></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><mpadded lspace=\"6.6pt\" width=\"+6.6pt\"><mn/></mpadded><mo separator=\"true\">\u2003\u2003\u2002\u2003</mo><mn>0</mn></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04321.tex", "nexttext": "\nThe vectors $c,~c^+,~c^-$ denote the cost, i.e. bids, from the generators and wind power plants for energy, up- and down reserves. The up- and down-reserves $r^+,~r^-$ are defined as non-negative,\n\n", "itemtype": "equation", "pos": 14917, "prevtext": "\nwhere ${B}_{f}$ is the line susceptance matrix and $\\widetilde{B}_{bus}$ the bus susceptance matrix (without the last column and row) \\cite{maria}. We have used\n$\\mathbf{M}_{(ij,\\cdot)}$ as the row of $\\mathbf{M}$ related to the line $(ij) \\in \\mathcal{E}$.\n\n\n\\subsection{Objective function}\nThe objective of the WCC-OPF is to minimize the sum of the generation and reserve cost. This is expressed as\n\n", "index": 15, "text": "\\begin{equation}\n\n\n\\min\\limits_{p,v,\\alpha,r^+,r^-} \\ \\sum_{i\\in\\mathcal{G}} c_i p_i + \\sum_{j\\in\\mathcal{W}} c_j v_j\n                                    + \\sum_{i\\in\\mathcal{W,G}} \\left(c_i^+ r_i^+ + c_i^- r_i^-\\right)\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m1\" class=\"ltx_Math\" alttext=\"\\par&#10;\\par&#10;\\min\\limits_{p,v,\\alpha,r^{+},r^{-}}\\ \\sum_{i\\in\\mathcal{G}}c_{i}p_{%&#10;i}+\\sum_{j\\in\\mathcal{W}}c_{j}v_{j}+\\sum_{i\\in\\mathcal{W,G}}\\left(c_{i}^{+}r_{%&#10;i}^{+}+c_{i}^{-}r_{i}^{-}\\right)\" display=\"block\"><mrow><mrow><mpadded width=\"+5pt\"><munder><mi>min</mi><mrow><mi>p</mi><mo>,</mo><mi>v</mi><mo>,</mo><mi>\u03b1</mi><mo>,</mo><msup><mi>r</mi><mo>+</mo></msup><mo>,</mo><msup><mi>r</mi><mo>-</mo></msup></mrow></munder></mpadded><mo>\u2062</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>\u2208</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca2</mi></mrow></munder><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>\u2062</mo><msub><mi>p</mi><mi>i</mi></msub></mrow></mrow></mrow><mo>+</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>j</mi><mo>\u2208</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcb2</mi></mrow></munder><mrow><msub><mi>c</mi><mi>j</mi></msub><mo>\u2062</mo><msub><mi>v</mi><mi>j</mi></msub></mrow></mrow><mo>+</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>\u2208</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcb2</mi><mo>,</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca2</mi></mrow></mrow></munder><mrow><mo>(</mo><mrow><mrow><msubsup><mi>c</mi><mi>i</mi><mo>+</mo></msubsup><mo>\u2062</mo><msubsup><mi>r</mi><mi>i</mi><mo>+</mo></msubsup></mrow><mo>+</mo><mrow><msubsup><mi>c</mi><mi>i</mi><mo>-</mo></msubsup><mo>\u2062</mo><msubsup><mi>r</mi><mi>i</mi><mo>-</mo></msubsup></mrow></mrow><mo>)</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04321.tex", "nexttext": "\nand $r^+_{max},~r^-_{max}$ are upper limits that define the ability or willingness of the generators and wind power plants to provide reserves.\n\n\n\n\n\n\n\n\n\n\\subsection{Power Balance Constraints}\n\nTo ensure power balance, we enforce the constraint\n\n", "itemtype": "equation", "pos": 15349, "prevtext": "\nThe vectors $c,~c^+,~c^-$ denote the cost, i.e. bids, from the generators and wind power plants for energy, up- and down reserves. The up- and down-reserves $r^+,~r^-$ are defined as non-negative,\n\n", "index": 17, "text": "\\begin{equation}\n0 \\leq r^+ \\leq r^{+}_{max}~, \\quad 0 \\leq r^- \\leq r^-_{max}~.\n\\label{CC-OPF}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m1\" class=\"ltx_Math\" alttext=\"0\\leq r^{+}\\leq r^{+}_{max}~{},\\quad 0\\leq r^{-}\\leq r^{-}_{max}~{}.\" display=\"block\"><mrow><mrow><mrow><mn>0</mn><mo>\u2264</mo><msup><mi>r</mi><mo>+</mo></msup><mo>\u2264</mo><mpadded width=\"+3.3pt\"><msubsup><mi>r</mi><mrow><mi>m</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>x</mi></mrow><mo>+</mo></msubsup></mpadded></mrow><mo rspace=\"12.5pt\">,</mo><mrow><mn>0</mn><mo>\u2264</mo><msup><mi>r</mi><mo>-</mo></msup><mo>\u2264</mo><mpadded width=\"+3.3pt\"><msubsup><mi>r</mi><mrow><mi>m</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>x</mi></mrow><mo>-</mo></msubsup></mpadded></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04321.tex", "nexttext": "\nSince quantities $\\tilde{p}_i$ and $\\tilde{w}_i$ are random quantities whose values depend on the random wind fluctuation $\\omega$, the above relation must hold for all possible realizations of $\\omega$.\nThis can be enforced by separating the nominal part (when the fluctuation is zero) and the stochastic part of \\eqref{random_power_balance}.\n\nThe nominal constraint is obtained by substituting $\\omega = 0$ in Eqs.~(\\ref{deltap_output}),(\\ref{cap_output}),(\\ref{gen_output}) and plugging in Eq.~(\\ref{random_power_balance}),\n\n", "itemtype": "equation", "pos": 15704, "prevtext": "\nand $r^+_{max},~r^-_{max}$ are upper limits that define the ability or willingness of the generators and wind power plants to provide reserves.\n\n\n\n\n\n\n\n\n\n\\subsection{Power Balance Constraints}\n\nTo ensure power balance, we enforce the constraint\n\n", "index": 19, "text": "\\begin{align}\n\t\\sum_i \\tilde{p}_i + \\tilde{w}_i - d_i = 0.  \\label{random_power_balance}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E10.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\sum_{i}\\tilde{p}_{i}+\\tilde{w}_{i}-d_{i}=0.\" display=\"inline\"><mrow><mrow><mrow><mrow><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mi>i</mi></munder></mstyle><msub><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">~</mo></mover><mi>i</mi></msub></mrow><mo>+</mo><msub><mover accent=\"true\"><mi>w</mi><mo stretchy=\"false\">~</mo></mover><mi>i</mi></msub></mrow><mo>-</mo><msub><mi>d</mi><mi>i</mi></msub></mrow><mo>=</mo><mn>0</mn></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04321.tex", "nexttext": "\nWhen the wind fluctuation $\\omega$ is non-zero, we must have\n\n", "itemtype": "equation", "pos": 16332, "prevtext": "\nSince quantities $\\tilde{p}_i$ and $\\tilde{w}_i$ are random quantities whose values depend on the random wind fluctuation $\\omega$, the above relation must hold for all possible realizations of $\\omega$.\nThis can be enforced by separating the nominal part (when the fluctuation is zero) and the stochastic part of \\eqref{random_power_balance}.\n\nThe nominal constraint is obtained by substituting $\\omega = 0$ in Eqs.~(\\ref{deltap_output}),(\\ref{cap_output}),(\\ref{gen_output}) and plugging in Eq.~(\\ref{random_power_balance}),\n\n", "index": 21, "text": "\\begin{align}\n\t\\sum_{i \\in \\cal{G}} p_i - \\sum_{i \\in D} d_i + \\sum_{j \\in \\cal{W}} v_j + \\sum_{j \\in \\cal{C}}\\min\\{0,\\bar{\\omega}_j\\} = 0. \\label{nomial_powerbalance}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E11.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\sum_{i\\in\\cal{G}}p_{i}-\\sum_{i\\in D}d_{i}+\\sum_{j\\in\\cal{W}}v_{j%&#10;}+\\sum_{j\\in\\cal{C}}\\min\\{0,\\bar{\\omega}_{j}\\}=0.\" display=\"inline\"><mrow><mrow><mrow><mrow><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>\u2208</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca2</mi></mrow></munder></mstyle><msub><mi>p</mi><mi>i</mi></msub></mrow><mo>-</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>\u2208</mo><mi>D</mi></mrow></munder></mstyle><msub><mi>d</mi><mi>i</mi></msub></mrow></mrow><mo>+</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>j</mi><mo>\u2208</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcb2</mi></mrow></munder></mstyle><msub><mi>v</mi><mi>j</mi></msub></mrow><mo>+</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>j</mi><mo>\u2208</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udc9e</mi></mrow></munder></mstyle><mrow><mi>min</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">{</mo><mn>0</mn><mo>,</mo><msub><mover accent=\"true\"><mi>\u03c9</mi><mo stretchy=\"false\">\u00af</mo></mover><mi>j</mi></msub><mo stretchy=\"false\">}</mo></mrow></mrow></mrow></mrow><mo>=</mo><mn>0</mn></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04321.tex", "nexttext": "\nFrom the last line it follows that to ensure power balance for every value of random wind fluctuation, it is enough to enforce the constraint\n\n", "itemtype": "equation", "pos": 16573, "prevtext": "\nWhen the wind fluctuation $\\omega$ is non-zero, we must have\n\n", "index": 23, "text": "\\begin{align}\n\t0 &= \\sum_{i \\in \\cal{G}} \\left(p_i - \\alpha_i \\tilde{\\Omega}\\right) - \\sum_{i \\in \\cal{D}} d_i + \\sum_{j \\in \\cal{W}}\\left(v_j +\\omega_j\\right)\\nonumber\\\\\n      &  + \\sum_{j \\in \\cal{R}}\\alpha_j \\tilde{\\Omega}+ \\sum_{j \\in \\cal{C}}\\min\\{ \\omega_j, \\bar{\\omega}_j \\} \\nonumber \\\\\n\n\n\t &= (1 - \\sum_{i} \\alpha_i ) \\tilde{\\Omega}.\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle 0\" display=\"inline\"><mn>0</mn></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\sum_{i\\in\\cal{G}}\\left(p_{i}-\\alpha_{i}\\tilde{\\Omega}\\right)-%&#10;\\sum_{i\\in\\cal{D}}d_{i}+\\sum_{j\\in\\cal{W}}\\left(v_{j}+\\omega_{j}\\right)\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mrow><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>\u2208</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca2</mi></mrow></munder></mstyle><mrow><mo>(</mo><mrow><msub><mi>p</mi><mi>i</mi></msub><mo>-</mo><mrow><msub><mi>\u03b1</mi><mi>i</mi></msub><mo>\u2062</mo><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a9</mi><mo stretchy=\"false\">~</mo></mover></mrow></mrow><mo>)</mo></mrow></mrow><mo>-</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>\u2208</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udc9f</mi></mrow></munder></mstyle><msub><mi>d</mi><mi>i</mi></msub></mrow></mrow><mo>+</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>j</mi><mo>\u2208</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcb2</mi></mrow></munder></mstyle><mrow><mo>(</mo><mrow><msub><mi>v</mi><mi>j</mi></msub><mo>+</mo><msub><mi>\u03c9</mi><mi>j</mi></msub></mrow><mo>)</mo></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle+\\sum_{j\\in\\cal{R}}\\alpha_{j}\\tilde{\\Omega}+\\sum_{j\\in\\cal{C}}%&#10;\\min\\{\\omega_{j},\\bar{\\omega}_{j}\\}\" display=\"inline\"><mrow><mrow><mo>+</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>j</mi><mo>\u2208</mo><mi class=\"ltx_font_mathcaligraphic\">\u211b</mi></mrow></munder></mstyle><mrow><msub><mi>\u03b1</mi><mi>j</mi></msub><mo>\u2062</mo><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a9</mi><mo stretchy=\"false\">~</mo></mover></mrow></mrow></mrow><mo>+</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>j</mi><mo>\u2208</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udc9e</mi></mrow></munder></mstyle><mrow><mi>min</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">{</mo><msub><mi>\u03c9</mi><mi>j</mi></msub><mo>,</mo><msub><mover accent=\"true\"><mi>\u03c9</mi><mo stretchy=\"false\">\u00af</mo></mover><mi>j</mi></msub><mo stretchy=\"false\">}</mo></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E12.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=(1-\\sum_{i}\\alpha_{i})\\tilde{\\Omega}.\" display=\"inline\"><mrow><mrow><mi/><mo>=</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>-</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mi>i</mi></munder></mstyle><msub><mi>\u03b1</mi><mi>i</mi></msub></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a9</mi><mo stretchy=\"false\">~</mo></mover></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04321.tex", "nexttext": "\n\n\n\\subsection{Constraints for Line Flow Limits, Generation Limits and Reserves}\nWhat remains is to enforce generation and transmission constraints. For quantities that are functions of fluctuating wind in-feeds, we use WCCs to ensure that \\emph{(a)} the risk of having procured too little generation capacity, \\emph{(b)} the risk of wind power plants not being able to provide the contracted reserves and \\emph{(c)} the risk of line power flows exceeding the transmission limits, are all small in a probabilistic sense.\n\nFor the sake of readability, in this section we will suppress the details of the WCCs by using a short-hand notation, and describe them in detail in the next section. More specifically, whenever we need to enforce that the risk of the quantity $y(\\tilde{\\omega})$ (representing e.g. a line overload ) is small, we will denote it by\n\n", "itemtype": "equation", "pos": 17070, "prevtext": "\nFrom the last line it follows that to ensure power balance for every value of random wind fluctuation, it is enough to enforce the constraint\n\n", "index": 25, "text": "\\begin{align}\t\n\t\\sum_{i} \\alpha_i = 1.\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E13.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\sum_{i}\\alpha_{i}=1.\" display=\"inline\"><mrow><mrow><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mi>i</mi></munder></mstyle><msub><mi>\u03b1</mi><mi>i</mi></msub></mrow><mo>=</mo><mn>1</mn></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04321.tex", "nexttext": "\nwhere $\\epsilon$ represents the risk limit.\n\n\\subsubsection{Constraints for Conventional Generators}\nFor a conventional generator, we enforce generation limits and constraints on reserve availability in the following way:\n\\begin{alignat}{1}\n \\quad & p + r^{+}  \\leq  {p}_G^{max}~, \\label{gen_max2} \\\\\n \\quad &p - r^{-}  \\geq {p}_G^{min}~, \\label{gen_min2} \\\\\n \\quad &WCC\\left(- \\alpha_i \\tilde{\\Omega} {>} r^+_i \\right) < \\epsilon_i ~, \\quad  \\forall_{i \\in \\mathcal{G}}~, \\label{chance_gen_min2} \\\\\n \\quad &WCC\\left(- \\alpha_i \\tilde{\\Omega} {<} r^-_i \\right) < \\epsilon_i ~, \\quad  \\forall_{i \\in \\mathcal{G}}~.\\label{chance_gen_max2}\n\n\n\\end{alignat}\nHere, \\eqref{gen_max2}, \\eqref{gen_min2} \nenforces that the generators do not commit to providing energy and reserves that will cause them to exceed their physical minimum and maximum generation limits.\nConstraints \\eqref{chance_gen_min2}, \\eqref{chance_gen_max2} describe the activation of reserves in reaction to the wind fluctuation $\\tilde{\\Omega}$.\nThey use WCCs to enforce that the risk of not having enough reserves available to cover the fluctuations remains below the risk limit $\\epsilon_i$.\n\n\n\\subsubsection{Constraints for Wind Power Plants with $\\Delta P$ Control}\nThe wind power plants use $\\Delta P$ control to maintain constant capacities $r^+,~r^-$ available for reserves, similar to a conventional generator.\nHowever, for the wind power plants, we also need to ensure that the risk of the wind power plant not being able to provide the promised reserves is small, since the power output of a wind power plant is dependent on the wind realization.\n\nThis can be achieved by enforcing the following chance constraints:\n\\begin{alignat}{1}\n \\quad &v + r^{+} \\leq \\mu~, \\label{wind_max2} \\\\\n \\quad &WCC\\left(v_j + \\omega_j - r_j^{-} \\leq 0 \\right) < \\epsilon_r~, \\quad  \\forall_{j \\in \\mathcal{W}}~, \\label{wind_min2} \\\\\n \\quad &WCC\\left(- \\alpha_j \\tilde{\\Omega} {>} r^+_j \\right) < \\epsilon_j ~, \\quad  \\forall_{j \\in \\mathcal{W}}~, \\label{chance_wind_min} \\\\\n \\quad &WCC\\left(- \\alpha_j \\tilde{\\Omega} {<} r^-_j \\right) < \\epsilon_j ~, \\quad  \\forall_{j \\in \\mathcal{W}}~.\\label{chance_wind_max}\n\n\n\\end{alignat}\nEq. \\eqref{wind_max2} is the nominal constraint that ensures that the scheduled power generation $v$ and the capacity allocated for up-reserves $r^+$ remain below the forecasted power $\\mu$. This is a deterministic constraint, since both the actual produced power and the available power will vary by $\\omega$, and $\\omega$ therefore cancels out.\nEq. \\eqref{wind_min2} ensures that the actual produced power $v_j+\\omega_j$ is high enough to provide the expected down-reserves $r^+$. As above, this equation is formulated as a WCC, which limits the risk $\\epsilon_r$ that the wind power plant will not be able to provide the allocated reserve capacity.\nConstraints \\eqref{chance_wind_min}, \\eqref{chance_wind_max} have the same interpretation as the corresponding constraints for the conventional generators \\eqref{chance_gen_min2}, \\eqref{chance_gen_max2}.\n\nNote that the wind power plants are contracted to provide a constant amount of up and down reserves $r^+,~r^-$, i.e., the amount of provided reserves is not allowed to change with the available wind power. To provide up-reserves $r^+$, the wind power plants thus curtails a constant amount 1 MW wind power to provide 1 MW up-reserves.\n\n\n\n\n\\subsubsection{Constraints for Line Flow Limits}\nTo limit the risk of transmission line overloads, we enforce the power flow constraints using WCCs, i.e.,\n\n\n\\begin{alignat}{1}\n& WCC\\left(\\mathbf{M}_{(ij,\\cdot)}(p-\\alpha\\tilde{\\Omega}+\\tilde{v}-d) {>} p_{ij}^{max}  \\right) < \\epsilon_{ij}~, \\quad  \\forall_{ij \\in \\mathcal{E}}~, \\label{chance_line_max} \\\\\n& WCC\\left(\\mathbf{M}_{(ij,\\cdot)}(p-\\alpha\\tilde{\\Omega}+\\tilde{v}-d) {<} -p_{ij}^{max} \\right) < \\epsilon_{ij}~, \\quad  \\forall_{ij \\in \\mathcal{E}}~, \\label{chance_line_min}\n\n\n\\end{alignat}\nwhere $\\epsilon_{ij}$ is the risk limit for line overloads and $p_{ij}^{max}$ is the maximum transmission capacity of line $ij$.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\section{Weighted Chance Constraints}\n\\label{sec:WCC}\n\nIn this section we describe the specifics of the WCCs that should replace the constraints of the form \\eqref{eq:WCC_generalform} in the previous section.\n\n\nWe will first give a general introduction to the WCCs and describe the physical interpretation of a WCC with a linear weight function, which is adopted here. We then present analytical expressions for the WCCs with $\\Delta P$ and output cap control under assumption of a normal distribution.\n\n\n\\subsection{General Weighted Chance Constraint}\nThe general weighted chance constraint is a constraint of the form\n\n", "itemtype": "equation", "pos": 17974, "prevtext": "\n\n\n\\subsection{Constraints for Line Flow Limits, Generation Limits and Reserves}\nWhat remains is to enforce generation and transmission constraints. For quantities that are functions of fluctuating wind in-feeds, we use WCCs to ensure that \\emph{(a)} the risk of having procured too little generation capacity, \\emph{(b)} the risk of wind power plants not being able to provide the contracted reserves and \\emph{(c)} the risk of line power flows exceeding the transmission limits, are all small in a probabilistic sense.\n\nFor the sake of readability, in this section we will suppress the details of the WCCs by using a short-hand notation, and describe them in detail in the next section. More specifically, whenever we need to enforce that the risk of the quantity $y(\\tilde{\\omega})$ (representing e.g. a line overload ) is small, we will denote it by\n\n", "index": 27, "text": "\\begin{align}\n WCC\\left(y(\\tilde{\\omega}) \\leq 0 \\right) \\leq \\epsilon~,\n\t\n\\label{eq:WCC_generalform}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle WCC\\left(y(\\tilde{\\omega})\\leq 0\\right)\\leq\\epsilon~{},\\par&#10;\" display=\"inline\"><mrow><mi>W</mi><mi>C</mi><mi>C</mi><mrow><mo>(</mo><mi>y</mi><mrow><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mi>\u03c9</mi><mo stretchy=\"false\">~</mo></mover><mo stretchy=\"false\">)</mo></mrow><mo>\u2264</mo><mn>0</mn><mo>)</mo></mrow><mo>\u2264</mo><mpadded width=\"+3.3pt\"><mi>\u03f5</mi></mpadded><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04321.tex", "nexttext": "\nwhere $P(\\omega)$ is the multivariate distribution function of the fluctuations. The quantity $y(\\omega)$ denotes the magnitude of constraint violation, and is defined differently for each type of constraint, and $f(.)$ is the risk weighting function.\nFor a violation of the upper or lower reserve limits \\eqref{chance_gen_min2}, \\eqref{chance_gen_max2},  \\eqref{chance_wind_min} and \\eqref{chance_wind_max} the magnitude of constraint violation is given by\n\n", "itemtype": "equation", "pos": 22778, "prevtext": "\nwhere $\\epsilon$ represents the risk limit.\n\n\\subsubsection{Constraints for Conventional Generators}\nFor a conventional generator, we enforce generation limits and constraints on reserve availability in the following way:\n\\begin{alignat}{1}\n \\quad & p + r^{+}  \\leq  {p}_G^{max}~, \\label{gen_max2} \\\\\n \\quad &p - r^{-}  \\geq {p}_G^{min}~, \\label{gen_min2} \\\\\n \\quad &WCC\\left(- \\alpha_i \\tilde{\\Omega} {>} r^+_i \\right) < \\epsilon_i ~, \\quad  \\forall_{i \\in \\mathcal{G}}~, \\label{chance_gen_min2} \\\\\n \\quad &WCC\\left(- \\alpha_i \\tilde{\\Omega} {<} r^-_i \\right) < \\epsilon_i ~, \\quad  \\forall_{i \\in \\mathcal{G}}~.\\label{chance_gen_max2}\n\n\n\\end{alignat}\nHere, \\eqref{gen_max2}, \\eqref{gen_min2} \nenforces that the generators do not commit to providing energy and reserves that will cause them to exceed their physical minimum and maximum generation limits.\nConstraints \\eqref{chance_gen_min2}, \\eqref{chance_gen_max2} describe the activation of reserves in reaction to the wind fluctuation $\\tilde{\\Omega}$.\nThey use WCCs to enforce that the risk of not having enough reserves available to cover the fluctuations remains below the risk limit $\\epsilon_i$.\n\n\n\\subsubsection{Constraints for Wind Power Plants with $\\Delta P$ Control}\nThe wind power plants use $\\Delta P$ control to maintain constant capacities $r^+,~r^-$ available for reserves, similar to a conventional generator.\nHowever, for the wind power plants, we also need to ensure that the risk of the wind power plant not being able to provide the promised reserves is small, since the power output of a wind power plant is dependent on the wind realization.\n\nThis can be achieved by enforcing the following chance constraints:\n\\begin{alignat}{1}\n \\quad &v + r^{+} \\leq \\mu~, \\label{wind_max2} \\\\\n \\quad &WCC\\left(v_j + \\omega_j - r_j^{-} \\leq 0 \\right) < \\epsilon_r~, \\quad  \\forall_{j \\in \\mathcal{W}}~, \\label{wind_min2} \\\\\n \\quad &WCC\\left(- \\alpha_j \\tilde{\\Omega} {>} r^+_j \\right) < \\epsilon_j ~, \\quad  \\forall_{j \\in \\mathcal{W}}~, \\label{chance_wind_min} \\\\\n \\quad &WCC\\left(- \\alpha_j \\tilde{\\Omega} {<} r^-_j \\right) < \\epsilon_j ~, \\quad  \\forall_{j \\in \\mathcal{W}}~.\\label{chance_wind_max}\n\n\n\\end{alignat}\nEq. \\eqref{wind_max2} is the nominal constraint that ensures that the scheduled power generation $v$ and the capacity allocated for up-reserves $r^+$ remain below the forecasted power $\\mu$. This is a deterministic constraint, since both the actual produced power and the available power will vary by $\\omega$, and $\\omega$ therefore cancels out.\nEq. \\eqref{wind_min2} ensures that the actual produced power $v_j+\\omega_j$ is high enough to provide the expected down-reserves $r^+$. As above, this equation is formulated as a WCC, which limits the risk $\\epsilon_r$ that the wind power plant will not be able to provide the allocated reserve capacity.\nConstraints \\eqref{chance_wind_min}, \\eqref{chance_wind_max} have the same interpretation as the corresponding constraints for the conventional generators \\eqref{chance_gen_min2}, \\eqref{chance_gen_max2}.\n\nNote that the wind power plants are contracted to provide a constant amount of up and down reserves $r^+,~r^-$, i.e., the amount of provided reserves is not allowed to change with the available wind power. To provide up-reserves $r^+$, the wind power plants thus curtails a constant amount 1 MW wind power to provide 1 MW up-reserves.\n\n\n\n\n\\subsubsection{Constraints for Line Flow Limits}\nTo limit the risk of transmission line overloads, we enforce the power flow constraints using WCCs, i.e.,\n\n\n\\begin{alignat}{1}\n& WCC\\left(\\mathbf{M}_{(ij,\\cdot)}(p-\\alpha\\tilde{\\Omega}+\\tilde{v}-d) {>} p_{ij}^{max}  \\right) < \\epsilon_{ij}~, \\quad  \\forall_{ij \\in \\mathcal{E}}~, \\label{chance_line_max} \\\\\n& WCC\\left(\\mathbf{M}_{(ij,\\cdot)}(p-\\alpha\\tilde{\\Omega}+\\tilde{v}-d) {<} -p_{ij}^{max} \\right) < \\epsilon_{ij}~, \\quad  \\forall_{ij \\in \\mathcal{E}}~, \\label{chance_line_min}\n\n\n\\end{alignat}\nwhere $\\epsilon_{ij}$ is the risk limit for line overloads and $p_{ij}^{max}$ is the maximum transmission capacity of line $ij$.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\section{Weighted Chance Constraints}\n\\label{sec:WCC}\n\nIn this section we describe the specifics of the WCCs that should replace the constraints of the form \\eqref{eq:WCC_generalform} in the previous section.\n\n\nWe will first give a general introduction to the WCCs and describe the physical interpretation of a WCC with a linear weight function, which is adopted here. We then present analytical expressions for the WCCs with $\\Delta P$ and output cap control under assumption of a normal distribution.\n\n\n\\subsection{General Weighted Chance Constraint}\nThe general weighted chance constraint is a constraint of the form\n\n", "index": 29, "text": "\\begin{equation}\n\\int_{-\\infty}^{\\infty}f(y(\\omega))P(\\omega)d\\omega \\leq \\epsilon~,\n\\label{cvar_general_1}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E15.m1\" class=\"ltx_Math\" alttext=\"\\int_{-\\infty}^{\\infty}f(y(\\omega))P(\\omega)d\\omega\\leq\\epsilon~{},\" display=\"block\"><mrow><mrow><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mo>-</mo><mi mathvariant=\"normal\">\u221e</mi></mrow><mi mathvariant=\"normal\">\u221e</mi></msubsup><mrow><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>y</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>\u03c9</mi></mrow></mrow></mrow><mo>\u2264</mo><mpadded width=\"+3.3pt\"><mi>\u03f5</mi></mpadded></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04321.tex", "nexttext": "\nSimilarly, violations of the availability of down reserves \\eqref{wind_min2} are defined by\n\n", "itemtype": "equation", "pos": 23359, "prevtext": "\nwhere $P(\\omega)$ is the multivariate distribution function of the fluctuations. The quantity $y(\\omega)$ denotes the magnitude of constraint violation, and is defined differently for each type of constraint, and $f(.)$ is the risk weighting function.\nFor a violation of the upper or lower reserve limits \\eqref{chance_gen_min2}, \\eqref{chance_gen_max2},  \\eqref{chance_wind_min} and \\eqref{chance_wind_max} the magnitude of constraint violation is given by\n\n", "index": 31, "text": "\\begin{equation}\ny(\\omega) = -\\alpha_i \\tilde{\\Omega} - r^+~, \\quad y(\\omega) = r^- + \\alpha_i \\tilde{\\Omega}~, \\forall_{i \\in \\mathcal{G, W}}~. \\label{y_gen}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E16.m1\" class=\"ltx_Math\" alttext=\"y(\\omega)=-\\alpha_{i}\\tilde{\\Omega}-r^{+}~{},\\quad y(\\omega)=r^{-}+\\alpha_{i}%&#10;\\tilde{\\Omega}~{},\\forall_{i\\in\\mathcal{G,W}}~{}.\" display=\"block\"><mrow><mrow><mrow><mrow><mi>y</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mo>-</mo><mrow><msub><mi>\u03b1</mi><mi>i</mi></msub><mo>\u2062</mo><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a9</mi><mo stretchy=\"false\">~</mo></mover></mrow></mrow><mo>-</mo><mpadded width=\"+3.3pt\"><msup><mi>r</mi><mo>+</mo></msup></mpadded></mrow></mrow><mo rspace=\"12.5pt\">,</mo><mrow><mrow><mi>y</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msup><mi>r</mi><mo>-</mo></msup><mo>+</mo><mrow><msub><mi>\u03b1</mi><mi>i</mi></msub><mo>\u2062</mo><mpadded width=\"+3.3pt\"><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a9</mi><mo stretchy=\"false\">~</mo></mover></mpadded></mrow></mrow><mo>,</mo><mpadded width=\"+3.3pt\"><msub><mo>\u2200</mo><mrow><mi>i</mi><mo>\u2208</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca2</mi><mo>,</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcb2</mi></mrow></mrow></msub></mpadded></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04321.tex", "nexttext": "\nand violations of the upper and lower line flow limits by\n\n", "itemtype": "equation", "pos": 23625, "prevtext": "\nSimilarly, violations of the availability of down reserves \\eqref{wind_min2} are defined by\n\n", "index": 33, "text": "\\begin{equation}\ny(\\omega) = - v_j - \\omega_j + r_j^{-} , \\forall_{i \\in \\mathcal{W}}~,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E17.m1\" class=\"ltx_Math\" alttext=\"y(\\omega)=-v_{j}-\\omega_{j}+r_{j}^{-},\\forall_{i\\in\\mathcal{W}}~{},\" display=\"block\"><mrow><mrow><mrow><mi>y</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mrow><mrow><mo>-</mo><msub><mi>v</mi><mi>j</mi></msub></mrow><mo>-</mo><msub><mi>\u03c9</mi><mi>j</mi></msub></mrow><mo>+</mo><msubsup><mi>r</mi><mi>j</mi><mo>-</mo></msubsup></mrow><mo>,</mo><mpadded width=\"+3.3pt\"><msub><mo>\u2200</mo><mrow><mi>i</mi><mo>\u2208</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcb2</mi></mrow></msub></mpadded></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04321.tex", "nexttext": "\n\nWhenever we have $y>0$, it indicates a violation of the limit, while $y<0$ implies that we are in a safe operating region. The weighting function $f(y(\\omega))$, which is nonzero only if $y>0$, describes the risk related to the overload, and can be chosen in different ways.\nFor example, \\eqref{cvar_general_1} is equivalent to a standard chance constraint if $f(y)$ is the unit step function, i.e., 0 for $y<0$ and 1 for $y\\geq 0$. However, the step function is not convex, which means that the standard chance constraint will not always be a convex constraint.\nOn the other hand, as proven in \\cite{CDC}, the constraint (\\ref{cvar_general_1}) is a convex for general generation control policies and general probability distributions of the wind fluctuations whenever the weight function $f(.)$ is convex.\n\nUsing a convex risk function, which assigns a higher risk to constraint violations of larger magnitude, also makes sense from an engineering point of view, and has been applied in risk-based OPF (e.g. \\cite{Xiao2009}, \\cite{Gabi2012}, \\cite{14PSCC}). Note that the choice of the risk function affects the interpretation of the risk limit $\\epsilon$. For a weighted chance constraint with a linear weight function, which is applied here, the risk limit can can be interpreted as an upper bound on the expected constraint violation. The unit of $\\epsilon$ in Eq.~(\\ref{cvar_general_1}) is the same as for the LHS of the constraint, i.e., we define $\\epsilon$ as an acceptable expected magnitude of overload in MW.\n\nOne main advantage of  using a convex weighting function $f(y)$ in (\\ref{cvar_general_1})  is the ability to handle more general control policies while still maintaining convexity, as shown in \\cite{CDC}.\nThis is especially important when modeling wind power control with generation cap, since the associated policy is inherently non-affine and breaks the convexity of the standard chance constraints.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\subsection{Expressions for the Weighted Chance Constraints with Linear Weight Functions with and without Cap Control}\nThe expressions we derive for the WCC with a linear weight function assume that the line flows and generation outputs (which are weighted sums of the wind fluctuations omega) are normally distributed. While this is a relatively strong assumption, it might be justified using the Central Limit Theorem \\cite{dasgupta} in systems with a large number of wind power plants. However, the WCC can also be computed even when the distribution is not normal, although this might require more complex numerical methods for evaluation of the integrals.\n\\\\\n\\subsubsection{Without Cap Control}\nWhen the wind fluctuation $\\omega$ is a multivariate Gaussian random variable and there are no wind power plants enforcing cap control, then for each of the probabilistic constraints, the overload random variable  $y(\\omega)$ is normally distributed. In this case, the linear weighted chance constraint can be computed by using the expression for the expectation of a truncated normal random variable:\n \n", "itemtype": "equation", "pos": 23786, "prevtext": "\nand violations of the upper and lower line flow limits by\n\n", "index": 35, "text": "\\begin{equation}\ny(\\omega) = \\tilde{p}_{ij}(\\omega) - p_{ij}^{max}~, \\quad \ty(\\omega) = p_{ij}^{min} - \\tilde{p}_{ij}(\\omega)~, \\forall_{ij \\in \\mathcal{E}}~. \\label{y_line_l}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E18.m1\" class=\"ltx_Math\" alttext=\"y(\\omega)=\\tilde{p}_{ij}(\\omega)-p_{ij}^{max}~{},\\quad y(\\omega)=p_{ij}^{min}-%&#10;\\tilde{p}_{ij}(\\omega)~{},\\forall_{ij\\in\\mathcal{E}}~{}.\" display=\"block\"><mrow><mrow><mrow><mrow><mi>y</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msub><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">~</mo></mover><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mpadded width=\"+3.3pt\"><msubsup><mi>p</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow><mrow><mi>m</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>x</mi></mrow></msubsup></mpadded></mrow></mrow><mo rspace=\"12.5pt\">,</mo><mrow><mrow><mi>y</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msubsup><mi>p</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow><mrow><mi>m</mi><mo>\u2062</mo><mi>i</mi><mo>\u2062</mo><mi>n</mi></mrow></msubsup><mo>-</mo><mrow><msub><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">~</mo></mover><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo rspace=\"5.8pt\" stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>,</mo><mpadded width=\"+3.3pt\"><msub><mo>\u2200</mo><mrow><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow><mo>\u2208</mo><mi class=\"ltx_font_mathcaligraphic\">\u2130</mi></mrow></msub></mpadded></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04321.tex", "nexttext": "\n and $\\mu_y$ and $\\sigma_y$ denote the mean and standard deviation of $y$.\n\\\\\n\\subsubsection{With Cap Control}\n\nWhen some of the wind power plants are enforcing cap control, the distribution of $y$ is no longer normal, since the standard deviation changes when an output cap is reached. The computation of the linear weighted chance constraint thus becomes more involved.\nLet $\\mathcal{C} = \\{ i_1, \\ldots, i_K \\}$ denote the indices of the wind power plants implementing cap control.\nFor each of these wind power plants, we split the integral over ${\\omega}_{\\mathcal{C}}$ in \\eqref{cvar_general_1} into two parts, one where the fluctuation in the wind power output is below the cap  $\\bar{\\omega}_{\\mathcal{C}}$, and one where the fluctuation is above the cap, by defining the sets $\\mathcal{S}_{k,b} \\in \\mathbbm{R}$ for $k = 1, \\ldots, K$ and $b \\in \\{ 0,1\\}$ as\n \n", "itemtype": "equation", "pos": 27030, "prevtext": "\n\nWhenever we have $y>0$, it indicates a violation of the limit, while $y<0$ implies that we are in a safe operating region. The weighting function $f(y(\\omega))$, which is nonzero only if $y>0$, describes the risk related to the overload, and can be chosen in different ways.\nFor example, \\eqref{cvar_general_1} is equivalent to a standard chance constraint if $f(y)$ is the unit step function, i.e., 0 for $y<0$ and 1 for $y\\geq 0$. However, the step function is not convex, which means that the standard chance constraint will not always be a convex constraint.\nOn the other hand, as proven in \\cite{CDC}, the constraint (\\ref{cvar_general_1}) is a convex for general generation control policies and general probability distributions of the wind fluctuations whenever the weight function $f(.)$ is convex.\n\nUsing a convex risk function, which assigns a higher risk to constraint violations of larger magnitude, also makes sense from an engineering point of view, and has been applied in risk-based OPF (e.g. \\cite{Xiao2009}, \\cite{Gabi2012}, \\cite{14PSCC}). Note that the choice of the risk function affects the interpretation of the risk limit $\\epsilon$. For a weighted chance constraint with a linear weight function, which is applied here, the risk limit can can be interpreted as an upper bound on the expected constraint violation. The unit of $\\epsilon$ in Eq.~(\\ref{cvar_general_1}) is the same as for the LHS of the constraint, i.e., we define $\\epsilon$ as an acceptable expected magnitude of overload in MW.\n\nOne main advantage of  using a convex weighting function $f(y)$ in (\\ref{cvar_general_1})  is the ability to handle more general control policies while still maintaining convexity, as shown in \\cite{CDC}.\nThis is especially important when modeling wind power control with generation cap, since the associated policy is inherently non-affine and breaks the convexity of the standard chance constraints.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\subsection{Expressions for the Weighted Chance Constraints with Linear Weight Functions with and without Cap Control}\nThe expressions we derive for the WCC with a linear weight function assume that the line flows and generation outputs (which are weighted sums of the wind fluctuations omega) are normally distributed. While this is a relatively strong assumption, it might be justified using the Central Limit Theorem \\cite{dasgupta} in systems with a large number of wind power plants. However, the WCC can also be computed even when the distribution is not normal, although this might require more complex numerical methods for evaluation of the integrals.\n\\\\\n\\subsubsection{Without Cap Control}\nWhen the wind fluctuation $\\omega$ is a multivariate Gaussian random variable and there are no wind power plants enforcing cap control, then for each of the probabilistic constraints, the overload random variable  $y(\\omega)$ is normally distributed. In this case, the linear weighted chance constraint can be computed by using the expression for the expectation of a truncated normal random variable:\n \n", "index": 37, "text": "\\begin{align}\n \t& \\int_{0}^{\\infty} y P(y) dy = \\nonumber \\\\\n    & \\mu_y \\left(1 - \\Phi\\left( \\frac{-\\mu_y}{\\sigma_y} \\right)\\right) + \\frac{\\sigma_y}{\\sqrt{2\\pi}}e^{-\\frac{1}{2}\\left(\\frac{-\\mu_y}{\\sigma_y}\\right)^2} \\leq \\epsilon~, \\label{lin}\n \\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\int_{0}^{\\infty}yP(y)dy=\" display=\"inline\"><mrow><mrow><mstyle displaystyle=\"true\"><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mi mathvariant=\"normal\">\u221e</mi></msubsup></mstyle><mrow><mi>y</mi><mo>\u2062</mo><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>y</mi></mrow></mrow></mrow><mo>=</mo><mi/></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E19.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\mu_{y}\\left(1-\\Phi\\left(\\frac{-\\mu_{y}}{\\sigma_{y}}\\right)\\right%&#10;)+\\frac{\\sigma_{y}}{\\sqrt{2\\pi}}e^{-\\frac{1}{2}\\left(\\frac{-\\mu_{y}}{\\sigma_{y%&#10;}}\\right)^{2}}\\leq\\epsilon~{},\" display=\"inline\"><mrow><mrow><mrow><mrow><msub><mi>\u03bc</mi><mi>y</mi></msub><mo>\u2062</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><mrow><mi mathvariant=\"normal\">\u03a6</mi><mo>\u2062</mo><mrow><mo>(</mo><mstyle displaystyle=\"true\"><mfrac><mrow><mo>-</mo><msub><mi>\u03bc</mi><mi>y</mi></msub></mrow><msub><mi>\u03c3</mi><mi>y</mi></msub></mfrac></mstyle><mo>)</mo></mrow></mrow></mrow><mo>)</mo></mrow></mrow><mo>+</mo><mrow><mstyle displaystyle=\"true\"><mfrac><msub><mi>\u03c3</mi><mi>y</mi></msub><msqrt><mrow><mn>2</mn><mo>\u2062</mo><mi>\u03c0</mi></mrow></msqrt></mfrac></mstyle><mo>\u2062</mo><msup><mi>e</mi><mrow><mo>-</mo><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>\u2062</mo><msup><mrow><mo>(</mo><mfrac><mrow><mo>-</mo><msub><mi>\u03bc</mi><mi>y</mi></msub></mrow><msub><mi>\u03c3</mi><mi>y</mi></msub></mfrac><mo>)</mo></mrow><mn>2</mn></msup></mrow></mrow></msup></mrow></mrow><mo>\u2264</mo><mpadded width=\"+3.3pt\"><mi>\u03f5</mi></mpadded></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04321.tex", "nexttext": "\n\nThen, the linear weighted chance constraints can be computed as\n \n", "itemtype": "equation", "pos": 28157, "prevtext": "\n and $\\mu_y$ and $\\sigma_y$ denote the mean and standard deviation of $y$.\n\\\\\n\\subsubsection{With Cap Control}\n\nWhen some of the wind power plants are enforcing cap control, the distribution of $y$ is no longer normal, since the standard deviation changes when an output cap is reached. The computation of the linear weighted chance constraint thus becomes more involved.\nLet $\\mathcal{C} = \\{ i_1, \\ldots, i_K \\}$ denote the indices of the wind power plants implementing cap control.\nFor each of these wind power plants, we split the integral over ${\\omega}_{\\mathcal{C}}$ in \\eqref{cvar_general_1} into two parts, one where the fluctuation in the wind power output is below the cap  $\\bar{\\omega}_{\\mathcal{C}}$, and one where the fluctuation is above the cap, by defining the sets $\\mathcal{S}_{k,b} \\in \\mathbbm{R}$ for $k = 1, \\ldots, K$ and $b \\in \\{ 0,1\\}$ as\n \n", "index": 39, "text": "\\begin{align*}\n \t\\mathcal{S}_{k,b} = \\begin{cases} (-\\infty, \\bar{\\omega}_k], \\ &\\mbox{for } b = 0, \\\\\n\t\t\t\t\t\t\t\t( \\bar{\\omega}_k, \\infty) \\ &\\mbox{for } b =1.\n\t\t\t\t\t\t\t\t\\end{cases}\n \\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\mathcal{S}_{k,b}=\\begin{cases}(-\\infty,\\bar{\\omega}_{k}],&amp;\\mbox{%&#10;for }b=0,\\\\&#10;(\\bar{\\omega}_{k},\\infty)&amp;\\mbox{for }b=1.\\end{cases}\" display=\"inline\"><mrow><msub><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcae</mi><mrow><mi>k</mi><mo>,</mo><mi>b</mi></mrow></msub><mo>=</mo><mrow><mo>{</mo><mtable columnspacing=\"5pt\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mi mathvariant=\"normal\">\u221e</mi></mrow><mo>,</mo><msub><mover accent=\"true\"><mi>\u03c9</mi><mo stretchy=\"false\">\u00af</mo></mover><mi>k</mi></msub><mo stretchy=\"false\">]</mo></mrow><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mrow><mtext>for\u00a0</mtext><mo>\u2062</mo><mi>b</mi></mrow><mo>=</mo><mn>0</mn></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mrow><mo stretchy=\"false\">(</mo><msub><mover accent=\"true\"><mi>\u03c9</mi><mo stretchy=\"false\">\u00af</mo></mover><mi>k</mi></msub><mo>,</mo><mi mathvariant=\"normal\">\u221e</mi><mo stretchy=\"false\">)</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mrow><mtext>for\u00a0</mtext><mo>\u2062</mo><mi>b</mi></mrow><mo>=</mo><mn>1</mn></mrow><mo>.</mo></mrow></mtd></mtr></mtable></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04321.tex", "nexttext": "\nwhere $\\omega_{\\mathcal{C}} = ( \\omega_{i_1}, \\ldots, \\omega_{i_K})$.  In the above summation, whenever  $b_k = 1$, the corresponding $\\omega_{i_k}$ is larger than\n $\\bar{\\omega}_{i_k}$ and the power output is fixed at  $\\bar{\\omega}_{i_k}$. The overload $y$ is jointly distributed along with $\\omega_\\mathcal{C}$ according to a multivariate\n Gaussian distribution. One can evaluate the integrals using  efficient numerical schemes for Gaussian integration \\cite{Genz95}. For smaller values of $K$, it is efficient to split (\\ref{wcc_plain}) into the summation in (\\ref{wcc_specific}) and evaluate each of the terms using Gaussian quadrature integration specialized to rectangular domains. When $K$ is large, it is more appropriate to perform numerical integration  directly on Eq.~(\\ref{wcc_plain}) using Monte-Carlo sampling.\n\n We remark here that the constraints in Eq.~(\\ref{wcc_specific}) are convex w.r.t. the optimization variables in the WCC-OPF, namely $p,\\alpha$ and $r$, whereas the same can be shown to be non-convex for the case of standard chance constraints.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\section{Numerical Results}\n\\label{sec:CaseStudy}\n\n\\subsection{Implementation of the WCC-OPF with Wind Power Control}\nWe leverage the convexity of the WCCs to devise an efficient outer-approximation-cutting-plane algorithm, similar to the one in \\cite{12BCH}. The algorithm is implemented it in Julia language \\cite{julia} using JuMP \\cite{jump}. At each step, a Linear Program (LP) corresponding to an outer approximation of the feasible set is solved.\nThe outer approximation is progressively tightened by adding tangential cutting-planes to the convex WCCs that eliminate the current infeasible solution. Each successive Linear Program is warm started using the solution of the previous one.\n\n Since the constraints and gradients for the WCC-OPF with cap control must be evaluated using numerical integration methods, it is desirable to reduce the number of function evaluations corresponding to these integrals. The cutting-planes algorithm accomplishes this by selectively evaluating the gradients only for the violated constraints, and shifting most of the computations over to the Linear Programming Solver.\n\n\\subsection{Case Study}\n\nWe base our study on the IEEE 118-bus system as provided with Matpower 4.1 \\cite{matpower}, with a few modifications as follows. For the generator bids for energy and reserves $c,~c^+,~c^-$, we use the linear cost coefficients. For wind power plants, we assume zero marginal cost, and set $c_j=c^+_j=c^-_j=0$. Although the formulation could be extended to include unit commitment, it is not considered here.  Therefore, the minimum generation output of the conventional generators is set to zero. To obtain a more stressed system state, we increase the load by a factor of 1.25 and descrease the transmission limits by 0.75.\nWind power plants are located at 25 different buses throughout the system.\n \nTheir locations, forecasted power output and correlation matrix can be found in \\cite{118BusWindData}. The standard deviation of each wind power plant is set to 10\\% of the forecasted power output.\nWhen considering different levels of wind power penetration, both the forecasted power output and the standard deviations are scaled by a factor of\n\n", "itemtype": "equation", "pos": 28415, "prevtext": "\n\nThen, the linear weighted chance constraints can be computed as\n \n", "index": 41, "text": "\\begin{align}\n \t&\\int_{0}^{\\infty}\\! \\int_{\\!-\\!\\infty}^{\\infty} \\!  y P(y, \\omega_{\\mathcal{C}}) d \\omega_{\\mathcal{C}} dy  \\label{wcc_plain} \\\\\n    =&\\sum_{b \\in \\{ 0,1\\}^K}  \\int_{0}^{\\infty} \\! \\int_{\\mathcal{S}_{1,b_1}} \\ldots \\int_{\\mathcal{S}_{K,b_K}} \\! y P (y, \\omega_{\\mathcal{C}}) d \\omega_{\\mathcal{C}} d y \\leq \\epsilon,  \\label{wcc_specific}\n \\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E20.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\int_{0}^{\\infty}\\!\\int_{\\!-\\!\\infty}^{\\infty}\\!yP(y,\\omega_{%&#10;\\mathcal{C}})d\\omega_{\\mathcal{C}}dy\" display=\"inline\"><mrow><mpadded width=\"-1.7pt\"><mstyle displaystyle=\"true\"><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mi mathvariant=\"normal\">\u221e</mi></msubsup></mstyle></mpadded><mrow><mpadded width=\"-1.7pt\"><mstyle displaystyle=\"true\"><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mo lspace=\"0.8pt\" rspace=\"0.8pt\">-</mo><mi mathvariant=\"normal\">\u221e</mi></mrow><mi mathvariant=\"normal\">\u221e</mi></msubsup></mstyle></mpadded><mrow><mi>y</mi><mo>\u2062</mo><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><msub><mi>\u03c9</mi><mi class=\"ltx_font_mathcaligraphic\">\ud835\udc9e</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><msub><mi>\u03c9</mi><mi class=\"ltx_font_mathcaligraphic\">\ud835\udc9e</mi></msub></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>y</mi></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E21.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle=\" display=\"inline\"><mo>=</mo></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E21.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\sum_{b\\in\\{0,1\\}^{K}}\\int_{0}^{\\infty}\\!\\int_{\\mathcal{S}_{1,b_{%&#10;1}}}\\ldots\\int_{\\mathcal{S}_{K,b_{K}}}\\!yP(y,\\omega_{\\mathcal{C}})d\\omega_{%&#10;\\mathcal{C}}dy\\leq\\epsilon,\" display=\"inline\"><mrow><mrow><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>b</mi><mo>\u2208</mo><msup><mrow><mo stretchy=\"false\">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">}</mo></mrow><mi>K</mi></msup></mrow></munder></mstyle><mrow><mpadded width=\"-1.7pt\"><mstyle displaystyle=\"true\"><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mi mathvariant=\"normal\">\u221e</mi></msubsup></mstyle></mpadded><mrow><mstyle displaystyle=\"true\"><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><msub><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcae</mi><mrow><mn>1</mn><mo>,</mo><msub><mi>b</mi><mn>1</mn></msub></mrow></msub></msub></mstyle><mrow><mi mathvariant=\"normal\">\u2026</mi><mo>\u2062</mo><mrow><mpadded width=\"-1.7pt\"><mstyle displaystyle=\"true\"><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><msub><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcae</mi><mrow><mi>K</mi><mo>,</mo><msub><mi>b</mi><mi>K</mi></msub></mrow></msub></msub></mstyle></mpadded><mrow><mi>y</mi><mo>\u2062</mo><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><msub><mi>\u03c9</mi><mi class=\"ltx_font_mathcaligraphic\">\ud835\udc9e</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><msub><mi>\u03c9</mi><mi class=\"ltx_font_mathcaligraphic\">\ud835\udc9e</mi></msub></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>y</mi></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo>\u2264</mo><mi>\u03f5</mi></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04321.tex", "nexttext": "\nwhere $X=\\{25,~50,~75,~100,~125\\}$ denotes the percentage of forecasted wind power relative to the total system load.\nThe risk limits for all WCCs were set to $\\epsilon=0.1$ MW. With the cutting-plane algorithm described above, a solution to the WCC-OPF for the 118 bus system is obtained within a couple of minutes on a laptop.\n\n\n\n\n\\subsubsection{Impact of Reserve Provision from Wind Power Plants}\nWe compare the cases when the wind power plants using $\\Delta P$ control can (a) only curtail their mean as in Eq. \\eqref{wind_v} and (b) the curtailed energy can be used to provide reserves as in Eq. \\eqref{deltap_output}. Figure~\\ref{fig_comparison_cost} shows the total cost, cost of generation and cost of reserves for the two cases without and with wind power reserves under various levels of wind penetration, and Figure~\\ref{fig_comparison_wind} shows the total amount of generation and reserves provided by both conventional generators and wind power plants.\n\nAs one might expect, the total cost is lower when the wind power plants are providing reserves. This difference is especially amplified when the system\nhas higher wind penetration, and a large fraction of the cost difference is attributed to a higher cost of reserves. With high wind penetration, there is significantly more uncertainty in the system, and without (zero cost) wind power reserves, a large amount of reserves must be bought from conventional generators to balance fluctuations.\n\nAdditionally, in the case without wind power reserves, the nominal generation cost is also higher. \n\nAs observed in Figure~\\ref{fig_comparison_wind}, the generators must run at a higher nominal set-point $p$ in order to be able to provide enough down reserve $r^{-}$, particularly during high wind penetrations. Thus, the wind power nominal set points $v$ must be lowered, leading to under-utilization of available cheap wind power.\n\n\n\n\n\n\\begin{figure}\n\\includegraphics[width=0.9\\columnwidth]{Fig/TotalCost_WithWithoutReserves.eps}\n\\centering\n\\caption{Total cost, cost of production and cost of reserves for the two cases with and without reserves from wind power.}\n\\label{fig_comparison_cost}\n\\end{figure}\n\n\\begin{figure}\n\\includegraphics[width=0.9\\columnwidth]{Fig/TotalGenerationReserves_WithWithout.eps}\n\\centering\n\\caption{Production and reserves from generators and wind power plants for each level of wind penetration.}\n\\label{fig_comparison_wind}\n\\end{figure}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\subsubsection{The effect of wind power control through output caps}\nIn this section, we investigate the benefits of output cap control on wind power plants. We enable output cap control for the wind power plants at bus $85$ and bus $117$, since these have particularly large values of means and standard deviation, and allow the rest of the wind power plants to provide reserves according to Eq. \\eqref{deltap_output}. We compare this with the case when no wind power plants have output caps, but all are able to provide reserves (including bus $85$ and $117$).\nFigure~\\ref{fig_cost_with_cap} shows the cost with cap control relative to the case without cap control, for various values of the cap threshold $\\bar{\\omega}_i$ in Eq.~(\\ref{cap_output}).\nAround the cap threshold values of $(-45 MW,-45 MW)$, the total cost is minimized, and is significantly lower ($\\sim -6 \\%$) than the case without caps but with reserves. The cost increases as we move away from this band.\n\nTo explain the trend in cost, we first investigate the effect of the cap threshold on the power output of the two wind power plants on bus $85$ and $117$.\nIn Figure~\\ref{fig_ExpCur_StdDev}, the expected amount of wind power curtailment (left) and the standard deviation (right) for each power plant is shown as a function of the output cap on the left.\n\nNote that, while the output caps are the same for both wind power plants, their nominal standard deviations (without caps) are different, which leads to different values for the expected curtailment and the standard deviation.\nWhen the cap thresholds are lowered, the amount of utilized wind power drops due to higher expected curtailment. However, the standard deviation of the wind power output also drops significantly, which reduces wind power variability and thus the requirement for reserves.\n\n\n\n\n\n\n\nTo investigate how this trade-off influences the cost in more detail, we look at the total wind power used for generation, the total system reserves and the total wind energy curtailment (which includes both ``wasted\" energy and energy curtailed to provide reserves). These values are plotted for different pairs of output caps in Figure~\\ref{fig_comparison}.\n\nWith low output caps $(-75,-75)$, higher wind curtailment outweighs the benefits of reduced reserve requirements compared to case with the optimal output caps $(-45,-45)$.\nAs the output caps increase, the total system reserve requirements also increase, and reaches the highest value for the case without output caps.\nAt the same time, we observe a decrease in the use of wind power for nominal energy production, since more of it must be allocated for reserves.\n\nTh lowest utilization of wind for energy production happens with output caps of $(+75,+75)$, which is observed to be the point with highest cost in Figure~\\ref{fig_cost_with_cap}. In this case, high wind power variability and no possibility of procuring wind power reserves at buses $85$ and $117$ leads to an increased curtailment of the mean wind power $v$ at those buses.\n\nIn the case with output caps $(+45,+45)$, the total wind power generation is lower than in the case without output caps. Still, the total cost of the solution is approximately 1\\% lower with caps $(+45,+45)$ than without caps as observed in Figure~\\ref{fig_cost_with_cap}. This is because the output caps reduces variability and thus the risk of overload on some critical transmission lines, which allows for better utilization of the transmission capacity and dispatch of cheaper conventional generators.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\begin{figure}\n\\includegraphics[width=0.8\\columnwidth]{Fig/CostScatter_v3.eps}\n\\centering\n\\caption{Total cost of the case with caps on the output, relative to the case without any output caps. The output caps on the two different buses are defined relative to the mean output, and are varied from -75 MW to +75 MW. }\n\n\\label{fig_cost_with_cap}\n\\end{figure}\n\n\\begin{figure}\n\\includegraphics[width=0.9\\columnwidth]{Fig/ExpCur_StdDev.eps}\n\\centering\n\\caption{The upper and lower plots shows the expected curtailed wind energy and and the standard deviation of the wind power output at bus 117 and bus 85, respectively. }\n\n\\label{fig_ExpCur_StdDev}\n\\end{figure}\n\n\\begin{figure}\n\\includegraphics[width=1.0\\columnwidth]{Fig/Total_barplot.eps}\n\\centering\n\\caption{Comparison of the cases with and without caps on the wind power output at bus 117 and bus 85.\n\nFrom left to right, the total generation by all wind power plants, the total amount of reserves in the system and the expected total wind energy curtailment are shown.}\n\n\\label{fig_comparison}\n\\end{figure}\n\n\n\n\n\n\n\n\\section{Summary and conclusions}\n\\label{sec:Conclusion}\nIn this paper, we investigate two types of wind power control capabilities, $\\Delta P$ control which reduces the mean power output by a constant value and allows the wind power plants to provide reserves, and output cap control which enforces a hard threshold on the total power output. \n\nThe corresponding control and reserve models are developed and incorporated into an Optimal Power Flow formulation with Weighted Chance Constrains, which allows for controlling the risk of overloads due to wind fluctuations. Based on a case study on the IEEE 118 bus system, we observe that using $\\Delta P$ control with wind reserves provides substantial cost benefits. For wind power plants with high variability, the output cap control is shown to outperform  $\\Delta P$ control with reserves.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{20151001_bib_LR_v2,20151004_bib_SM}\n\n\n\n\n\n", "itemtype": "equation", "pos": 32121, "prevtext": "\nwhere $\\omega_{\\mathcal{C}} = ( \\omega_{i_1}, \\ldots, \\omega_{i_K})$.  In the above summation, whenever  $b_k = 1$, the corresponding $\\omega_{i_k}$ is larger than\n $\\bar{\\omega}_{i_k}$ and the power output is fixed at  $\\bar{\\omega}_{i_k}$. The overload $y$ is jointly distributed along with $\\omega_\\mathcal{C}$ according to a multivariate\n Gaussian distribution. One can evaluate the integrals using  efficient numerical schemes for Gaussian integration \\cite{Genz95}. For smaller values of $K$, it is efficient to split (\\ref{wcc_plain}) into the summation in (\\ref{wcc_specific}) and evaluate each of the terms using Gaussian quadrature integration specialized to rectangular domains. When $K$ is large, it is more appropriate to perform numerical integration  directly on Eq.~(\\ref{wcc_plain}) using Monte-Carlo sampling.\n\n We remark here that the constraints in Eq.~(\\ref{wcc_specific}) are convex w.r.t. the optimization variables in the WCC-OPF, namely $p,\\alpha$ and $r$, whereas the same can be shown to be non-convex for the case of standard chance constraints.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\section{Numerical Results}\n\\label{sec:CaseStudy}\n\n\\subsection{Implementation of the WCC-OPF with Wind Power Control}\nWe leverage the convexity of the WCCs to devise an efficient outer-approximation-cutting-plane algorithm, similar to the one in \\cite{12BCH}. The algorithm is implemented it in Julia language \\cite{julia} using JuMP \\cite{jump}. At each step, a Linear Program (LP) corresponding to an outer approximation of the feasible set is solved.\nThe outer approximation is progressively tightened by adding tangential cutting-planes to the convex WCCs that eliminate the current infeasible solution. Each successive Linear Program is warm started using the solution of the previous one.\n\n Since the constraints and gradients for the WCC-OPF with cap control must be evaluated using numerical integration methods, it is desirable to reduce the number of function evaluations corresponding to these integrals. The cutting-planes algorithm accomplishes this by selectively evaluating the gradients only for the violated constraints, and shifting most of the computations over to the Linear Programming Solver.\n\n\\subsection{Case Study}\n\nWe base our study on the IEEE 118-bus system as provided with Matpower 4.1 \\cite{matpower}, with a few modifications as follows. For the generator bids for energy and reserves $c,~c^+,~c^-$, we use the linear cost coefficients. For wind power plants, we assume zero marginal cost, and set $c_j=c^+_j=c^-_j=0$. Although the formulation could be extended to include unit commitment, it is not considered here.  Therefore, the minimum generation output of the conventional generators is set to zero. To obtain a more stressed system state, we increase the load by a factor of 1.25 and descrease the transmission limits by 0.75.\nWind power plants are located at 25 different buses throughout the system.\n \nTheir locations, forecasted power output and correlation matrix can be found in \\cite{118BusWindData}. The standard deviation of each wind power plant is set to 10\\% of the forecasted power output.\nWhen considering different levels of wind power penetration, both the forecasted power output and the standard deviations are scaled by a factor of\n\n", "index": 43, "text": "\\begin{equation}\n\\frac{\\sum_{i\\in\\mathcal{D}}{d_i}}{\\sum_{j\\in\\mathcal{W}}{\\mu_j}}\\cdot \\frac{X}{100}~,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E22.m1\" class=\"ltx_Math\" alttext=\"\\frac{\\sum_{i\\in\\mathcal{D}}{d_{i}}}{\\sum_{j\\in\\mathcal{W}}{\\mu_{j}}}\\cdot%&#10;\\frac{X}{100}~{},\" display=\"block\"><mrow><mrow><mfrac><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>\u2208</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udc9f</mi></mrow></msub><msub><mi>d</mi><mi>i</mi></msub></mrow><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><mi>j</mi><mo>\u2208</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcb2</mi></mrow></msub><msub><mi>\u03bc</mi><mi>j</mi></msub></mrow></mfrac><mo>\u22c5</mo><mpadded width=\"+3.3pt\"><mfrac><mi>X</mi><mn>100</mn></mfrac></mpadded></mrow><mo>,</mo></mrow></math>", "type": "latex"}]