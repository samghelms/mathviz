[{"file": "1601.06648.tex", "nexttext": "\nwhere $\\xi$ is a $d$-dimensional Gaussian white noise of unit variance,\n$F(x)\\in {\\bf R}^{d}$ a deterministic force, and $B(x)$ a $d\\times d$ matrix specifying the action of the noise on the particle\n~\\cite{footnoteinteraction}.\nWe use the It\\=o convention~\\cite{Gardiner} for stochastic calculus throughout this paper.\n\nWe restrict to ergodic systems, and we focus on rare events in which a time averaged quantity $\\Lambda(\\tau)$ \ntakes some non-typical value.  Here $\\tau$ is the long time period over which the average is taken, and\n$\n \\Lambda(\\tau) = \\Lambda_{\\rm d}(\\tau) + \\Lambda_{\\rm c}(\\tau)\n$\nconsists of a configurational contribution \n$\n\n\\Lambda_{\\rm d}(\\tau) =\\frac{1}{\\tau} \\int_{0}^{\\tau} \\lambda_{\\rm d}(x_t) {\\mathrm{d}} t\n\n$\nand a current one\n$\n\\Lambda_{\\rm c}(\\tau) = \\frac{1}{\\tau} \\int_{0}^{\\tau}\\lambda_{\\rm c}(x_t) \\cdot  {\\mathrm{d}} x_t ,\n$ where $\\lambda_{{\\rm d},{\\rm c}}$ are arbitrary functions of the particle position $x$.  Typical examples of $\\Lambda$ are \nentropy production~\\cite{lebowitz99,lecomte07jsp}, dynamical activity~\\cite{garrahan07,Hedges}, and particle fluxes~\\cite{bodineau05}.\n\nIn the limit of large $\\tau$, ergodicity of the system means that the observable $\\Lambda(\\tau)$ is almost surely equal to its\ntypical value $\\overline\\Lambda$.  Our aims are (i) to estimate the (small) probability of deviations\nfrom this value, and (ii) to generate the rare trajectories that lead to these deviations.  This is an important problem because these\nnon-typical trajectories can exhibit interesting and unusual structures, including misfolded proteins~\\cite{weber13,mey14}, stable glass states~\\cite{Hedges} \nand travelling waves in models of particle transport~\\cite{hurtado14}.\n\nTo achieve these aims, the standard theoretical route~\\cite{lebowitz99,Touchette} is to introduce a \\emph{biasing field} $h$, which controls \n deviations of $\\Lambda(\\tau)$ from its typical value.  Specifically, we consider an ensemble of paths $X=(x_t)_{t=0}^\\tau$ with (unnormalised) probability density \n$P_h[X] = \\pi_0(x_0) \\exp\\left[ -\\int_0^\\tau {\\cal L}(x_t,\\dot{x}_t) {\\mathrm{d}} t + h \\tau\\Lambda(\\tau) \\right]$, where\n\n", "itemtype": "equation", "pos": 4306, "prevtext": "\n\n\n\\title{\nPopulation dynamics method with a multi-canonical feedback control}\n\n\n\\author{Takahiro Nemoto}\n\\affiliation{Laboratoire de Probabili\\'es et Mod\\`eles Al\\'eatoires, Sorbonne Paris Cit\\'e, UMR 7599 CNRS, Universit\\'e Paris Diderot, 75013 Paris, France}\n\\affiliation{Laboratoire de Physique, ENS de Lyon, Universit\\'e de Lyon, CNRS, 46 all\\'ee d'Italie, 69364 Lyon, France}\n\\author{Freddy Bouchet}\n\\affiliation{Laboratoire de Physique, ENS de Lyon, Universit\\'e de Lyon, CNRS, 46 all\\'ee d'Italie, 69364 Lyon, France}\n\\author{Robert L. Jack}\n\\affiliation{Department of Physics, University of Bath, Bath BA2 7AY, United Kingdom}\n\\author{Vivien Lecomte}\n\\affiliation{Laboratoire de Probabili\\'es et Mod\\`eles Al\\'eatoires, Sorbonne Paris Cit\\'e, UMR 7599 CNRS, Universit\\'e Paris Diderot, 75013 Paris, France}\n\n\\date{\\today}\n\n\\begin{abstract}\nWe discuss the Giardin\\`a-Kurchan-Peliti population dynamics method for evaluating large deviations of time averaged quantities in Markov processes [Phys. Rev. Lett. \\textbf{96}, 120603 (2006)].  This method exhibits systematic errors which can be large in some circumstances, particularly for systems with weak noise, or close to dynamical phase transitions.  We show how these errors can be mitigated by introducing control forces to within the algorithm.  These forces are determined by an iteration-and-feedback scheme, inspired by multicanonical methods in equilibrium sampling.  We demonstrate substantially improved results in a simple model and we discuss potential applications to more complex systems.\n\n\n\n\n\\end{abstract}\n\n\\pacs{05.40.-a, 05.10.-a, 05.70.Ln}\n\n\\maketitle\n\n{\\it Introduction.}---\nIn many physical systems, interesting and important behaviour is associated with rare events -- examples include crystal nucleation, slow transitions in biomolecules~\\cite{auer01,sear07,ren05}, rare transitions in turbulent flows~\\cite{VKS,BouchetSimonnet}, and extreme events in climate dynamics~\\cite{ClimateExtremes}.  Many computational methods for sampling these events have been proposed and exploited~\\cite{auer01,ren05,BouchetSimonnet,Chandler,FFS1,Splittingmethod,Populationdynamics,TailleurKurchan,Nemoto_Sasa_PRL}.  One family of methods is based around population dynamics~\\cite{DMC,Aldous,Grassberger,Lelievre,Garnier,Rolland}, in which several copies of a system evolve in parallel: the copies which exhibit the rare behaviour of interest are copied (or \\emph{cloned}) while other copies are discarded.  The result is that \\emph{typical} copies within the population dynamics reproduce the desired rare events in the original system.  One such method has recently been employed to characterise a particular class of rare events~\\cite{Populationdynamics,TailleurKurchan}, in which time-averaged physical quantities exhibit  \\emph{large deviations}~\\cite{Touchette,Dembo_Zeitouni} from their typical values in the large time limit.\nStudies of such events have revealed new and unexpected features in\nglass-formers~\\cite{Hedges}, biomolecules~\\cite{picciani11,weber13,mey14}, non-equilibrium transport~\\cite{derrida07,hurtado14} and integrable systems~\\cite{TailleurKurchan}. \nIn this article, we identify a pitfall that limits the computational efficiency of the population dynamics method, and we show it can be modified so as to avoid this problem. \nThe issue at stake is the number of copies of the system that must be considered in order to obtain accurate results -- if very many copies are required then the method is difficult to apply, especially if even a single system is complex or contains many degrees of freedom.  In some relevant cases then the standard population dynamics method requires an exponentially large population to be effective~\\cite{hurtado09}.  However, the method that we propose here, which is inspired by multicanonical methods in equilibrium systems~\\cite{Berg_Neuhaus1,Wang_Landau1}, can still be effective in these cases.  We argue that this new method will provide a step-change in the complexity of the systems for which large deviation computations can be performed.\n\n{\\it Rare event problem}---\nThe rare events that we consider can take place in a variety of models.  To illustrate the method,  \nconsider a particle moving in $d$-dimensions, whose position $x\\in {\\bf R}^{d}$ obeys a Langevin equation\n\n", "index": 1, "text": "\\begin{equation}\n\\dot{x}_t = F(x_t) + B(x_t) \\xi_t,\n \\label{equ:dx}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"\\dot{x}_{t}=F(x_{t})+B(x_{t})\\xi_{t},\" display=\"block\"><mrow><mrow><msub><mover accent=\"true\"><mi>x</mi><mo>\u02d9</mo></mover><mi>t</mi></msub><mo>=</mo><mrow><mrow><mi>F</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mi>B</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>\u03be</mi><mi>t</mi></msub></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.06648.tex", "nexttext": "\nis a Lagrangian density that describes the (unbiased) model (\\ref{equ:dx}); \n$\\pi_0(x)$ is the initial condition for the trajectories, that can be arbitrary and which we take to be the stationary probability distribution of the unbiased model in the numerical examples.\nAlso, $\\kappa=B B^T$ where the notation $B^T$ indicates a matrix transpose~\\cite{footnoteinvertible}.\n\nNormalised averages with respect to $P_h$ are denoted by $\\langle \\cdot \\rangle_h$ and we use these averages \nto characterise the rare trajectories associated with deviations of $\\Lambda(\\tau)$ from $\\overline{\\Lambda}$, for the model in Eq.~\\eqref{equ:dx}.\nWe define the scaled cumulant generating function (CGF):\n$G(h) = \\lim_{\\tau \\rightarrow \\infty} \\tau^{-1} \\log  \\langle  {\\mathrm{e}}^{ \\tau h \\Lambda (\\tau)} \\rangle_0 $.\n\nIn the limit of large $\\tau$, the probability distribution of $\\Lambda(\\tau)$ satisfies a large deviation principle, and can\nbe obtained by a Legendre transformation of $G(h)$~\\cite{Touchette,Dembo_Zeitouni}. In the same limit, for a given deviation $\\Lambda$ from $\\overline{\\Lambda}$, there exists a bias $h^\\star(\\Lambda)$ for which \n$\\langle \\cdot \\rangle_{h^\\star(\\Lambda)}$ is equivalent to a \nconditional average over trajectories with $\\Lambda(\\tau) = \\Lambda$ \\cite{HTouchette_equivalence}. \n\n\n\n\n\n\n\n\n\n\n\\begin{figure}\n\\centering\n\n\n\n\n\n\n\n\\includegraphics[width=1\\columnwidth]{TrajectoryAll-Aux_dd1hh1NN4}\n\\caption{ \\label{Wholetrajectoryonedx_m1k0a1b1hm1dd01N100Step01} \n(a) Trajectories $x^a(t)$ generated by population dynamics at fixed total population~$N_c=4$ for the model system described in the main text ($\\epsilon=1,h=1$). \n\nAt certain times, some copies of the system are removed ($\\times$) and others are duplicated~($\\circ$). \n(b) Representative sample paths $\\tilde x_a(t)$ for the distribution $P_h[X]$, derived from those in (a) by keeping only trajectories surviving up to final time $\\tau=30$.}\n\n\\label{fig:traj}\n\\end{figure}\n\n\n\n\n\n\n\n\\emph{Population dynamics method} -- There are several computational methods that allow evaluation of averages with respect to $P_h$~\\cite{Populationdynamics,Populationdynamics3,Chandler,Nemoto_Sasa_PRL}.\nIn the population dynamics method~\\cite{Populationdynamics}, one considers $N_c$ copies (or clones) of the system.  \nThese clones evolve independently as a function of the time $t$, except that (for $h>0$) clones with small $\\Lambda(t)$ are periodically removed from the system, while clones with large $\\Lambda(t)$ are duplicated,\nto maintain a constant population.\nThe algorithm is described fully in Supplemental Material (SM)~\\cite{SM}.\nThis method biases the system towards the rare events of interest.  \nFor sufficiently large $N_c$ (and large enough $\\tau$), \nthe method provides accurate estimates of $G(h)$ and it generates sample paths consistent with the biased distribution $P_h$.  \n\nThe operation of the method\nis illustrated in Fig.~\\ref{fig:traj} for a one-dimensional model of a particle in a quartic potential.\n\n\n\nFig.~\\ref{fig:traj}(a) shows four copies of the system that evolve in time, except that\nsome trajectory segments stop and others branch, as the cloning operates.  Fig.~\\ref{fig:traj}(b) shows four\nrepresentative trajectories (sample paths) for the distribution $P_h[X]$, which have been reconstructed from panel (a),\nby tracing backwards in time from the clones that survived up to the final time~$\\tau$.\n\n\n\n\\emph{Sampling errors within population dynamics} -- \n\n\nThe accuracy of the population dynamics is limited by issues originating from clone multiplicity, as we now explain.\nConsider the distribution \n\n", "itemtype": "equation", "pos": 6539, "prevtext": "\nwhere $\\xi$ is a $d$-dimensional Gaussian white noise of unit variance,\n$F(x)\\in {\\bf R}^{d}$ a deterministic force, and $B(x)$ a $d\\times d$ matrix specifying the action of the noise on the particle\n~\\cite{footnoteinteraction}.\nWe use the It\\=o convention~\\cite{Gardiner} for stochastic calculus throughout this paper.\n\nWe restrict to ergodic systems, and we focus on rare events in which a time averaged quantity $\\Lambda(\\tau)$ \ntakes some non-typical value.  Here $\\tau$ is the long time period over which the average is taken, and\n$\n \\Lambda(\\tau) = \\Lambda_{\\rm d}(\\tau) + \\Lambda_{\\rm c}(\\tau)\n$\nconsists of a configurational contribution \n$\n\n\\Lambda_{\\rm d}(\\tau) =\\frac{1}{\\tau} \\int_{0}^{\\tau} \\lambda_{\\rm d}(x_t) {\\mathrm{d}} t\n\n$\nand a current one\n$\n\\Lambda_{\\rm c}(\\tau) = \\frac{1}{\\tau} \\int_{0}^{\\tau}\\lambda_{\\rm c}(x_t) \\cdot  {\\mathrm{d}} x_t ,\n$ where $\\lambda_{{\\rm d},{\\rm c}}$ are arbitrary functions of the particle position $x$.  Typical examples of $\\Lambda$ are \nentropy production~\\cite{lebowitz99,lecomte07jsp}, dynamical activity~\\cite{garrahan07,Hedges}, and particle fluxes~\\cite{bodineau05}.\n\nIn the limit of large $\\tau$, ergodicity of the system means that the observable $\\Lambda(\\tau)$ is almost surely equal to its\ntypical value $\\overline\\Lambda$.  Our aims are (i) to estimate the (small) probability of deviations\nfrom this value, and (ii) to generate the rare trajectories that lead to these deviations.  This is an important problem because these\nnon-typical trajectories can exhibit interesting and unusual structures, including misfolded proteins~\\cite{weber13,mey14}, stable glass states~\\cite{Hedges} \nand travelling waves in models of particle transport~\\cite{hurtado14}.\n\nTo achieve these aims, the standard theoretical route~\\cite{lebowitz99,Touchette} is to introduce a \\emph{biasing field} $h$, which controls \n deviations of $\\Lambda(\\tau)$ from its typical value.  Specifically, we consider an ensemble of paths $X=(x_t)_{t=0}^\\tau$ with (unnormalised) probability density \n$P_h[X] = \\pi_0(x_0) \\exp\\left[ -\\int_0^\\tau {\\cal L}(x_t,\\dot{x}_t) {\\mathrm{d}} t + h \\tau\\Lambda(\\tau) \\right]$, where\n\n", "index": 3, "text": "\\begin{equation}\n{\\cal L}(x,\\dot x) = \\tfrac{1}{2} [\\dot{x} - F(x)] \\cdot \\kappa(x)^{-1} [\\dot{x} - F(x)]\n\\label{eq:Lagrangian}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"{\\cal L}(x,\\dot{x})=\\tfrac{1}{2}[\\dot{x}-F(x)]\\cdot\\kappa(x)^{-1}[\\dot{x}-F(x)]\" display=\"block\"><mrow><mrow><mi class=\"ltx_font_mathcaligraphic\">\u2112</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mover accent=\"true\"><mi>x</mi><mo>\u02d9</mo></mover><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mrow><mstyle displaystyle=\"false\"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mover accent=\"true\"><mi>x</mi><mo>\u02d9</mo></mover><mo>-</mo><mrow><mi>F</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mo>\u22c5</mo><mi>\u03ba</mi></mrow><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mover accent=\"true\"><mi>x</mi><mo>\u02d9</mo></mover><mo>-</mo><mrow><mi>F</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.06648.tex", "nexttext": "\nwhich indicates the fraction of time spent \nat position $x$, within the biased ensemble.  We also define\n\n", "itemtype": "equation", "pos": 10286, "prevtext": "\nis a Lagrangian density that describes the (unbiased) model (\\ref{equ:dx}); \n$\\pi_0(x)$ is the initial condition for the trajectories, that can be arbitrary and which we take to be the stationary probability distribution of the unbiased model in the numerical examples.\nAlso, $\\kappa=B B^T$ where the notation $B^T$ indicates a matrix transpose~\\cite{footnoteinvertible}.\n\nNormalised averages with respect to $P_h$ are denoted by $\\langle \\cdot \\rangle_h$ and we use these averages \nto characterise the rare trajectories associated with deviations of $\\Lambda(\\tau)$ from $\\overline{\\Lambda}$, for the model in Eq.~\\eqref{equ:dx}.\nWe define the scaled cumulant generating function (CGF):\n$G(h) = \\lim_{\\tau \\rightarrow \\infty} \\tau^{-1} \\log  \\langle  {\\mathrm{e}}^{ \\tau h \\Lambda (\\tau)} \\rangle_0 $.\n\nIn the limit of large $\\tau$, the probability distribution of $\\Lambda(\\tau)$ satisfies a large deviation principle, and can\nbe obtained by a Legendre transformation of $G(h)$~\\cite{Touchette,Dembo_Zeitouni}. In the same limit, for a given deviation $\\Lambda$ from $\\overline{\\Lambda}$, there exists a bias $h^\\star(\\Lambda)$ for which \n$\\langle \\cdot \\rangle_{h^\\star(\\Lambda)}$ is equivalent to a \nconditional average over trajectories with $\\Lambda(\\tau) = \\Lambda$ \\cite{HTouchette_equivalence}. \n\n\n\n\n\n\n\n\n\n\n\\begin{figure}\n\\centering\n\n\n\n\n\n\n\n\\includegraphics[width=1\\columnwidth]{TrajectoryAll-Aux_dd1hh1NN4}\n\\caption{ \\label{Wholetrajectoryonedx_m1k0a1b1hm1dd01N100Step01} \n(a) Trajectories $x^a(t)$ generated by population dynamics at fixed total population~$N_c=4$ for the model system described in the main text ($\\epsilon=1,h=1$). \n\nAt certain times, some copies of the system are removed ($\\times$) and others are duplicated~($\\circ$). \n(b) Representative sample paths $\\tilde x_a(t)$ for the distribution $P_h[X]$, derived from those in (a) by keeping only trajectories surviving up to final time $\\tau=30$.}\n\n\\label{fig:traj}\n\\end{figure}\n\n\n\n\n\n\n\n\\emph{Population dynamics method} -- There are several computational methods that allow evaluation of averages with respect to $P_h$~\\cite{Populationdynamics,Populationdynamics3,Chandler,Nemoto_Sasa_PRL}.\nIn the population dynamics method~\\cite{Populationdynamics}, one considers $N_c$ copies (or clones) of the system.  \nThese clones evolve independently as a function of the time $t$, except that (for $h>0$) clones with small $\\Lambda(t)$ are periodically removed from the system, while clones with large $\\Lambda(t)$ are duplicated,\nto maintain a constant population.\nThe algorithm is described fully in Supplemental Material (SM)~\\cite{SM}.\nThis method biases the system towards the rare events of interest.  \nFor sufficiently large $N_c$ (and large enough $\\tau$), \nthe method provides accurate estimates of $G(h)$ and it generates sample paths consistent with the biased distribution $P_h$.  \n\nThe operation of the method\nis illustrated in Fig.~\\ref{fig:traj} for a one-dimensional model of a particle in a quartic potential.\n\n\n\nFig.~\\ref{fig:traj}(a) shows four copies of the system that evolve in time, except that\nsome trajectory segments stop and others branch, as the cloning operates.  Fig.~\\ref{fig:traj}(b) shows four\nrepresentative trajectories (sample paths) for the distribution $P_h[X]$, which have been reconstructed from panel (a),\nby tracing backwards in time from the clones that survived up to the final time~$\\tau$.\n\n\n\n\\emph{Sampling errors within population dynamics} -- \n\n\nThe accuracy of the population dynamics is limited by issues originating from clone multiplicity, as we now explain.\nConsider the distribution \n\n", "index": 5, "text": "\\begin{equation}\np_{\\rm ave}(x) = \\lim_{\\tau \\rightarrow \\infty } \\Big\\langle  \\tau^{-1}\\! \\int _{0}^{\\tau} \\delta(x_t - x) {\\mathrm{d}} t   \\Big\\rangle_h,\n\n\\label{avep}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"p_{\\rm ave}(x)=\\lim_{\\tau\\rightarrow\\infty}\\Big{\\langle}\\tau^{-1}\\!\\int_{0}^{%&#10;\\tau}\\delta(x_{t}-x){\\mathrm{d}}t\\Big{\\rangle}_{h},\\par&#10;\" display=\"block\"><mrow><mrow><mrow><msub><mi>p</mi><mi>ave</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munder><mo movablelimits=\"false\">lim</mo><mrow><mi>\u03c4</mi><mo>\u2192</mo><mi mathvariant=\"normal\">\u221e</mi></mrow></munder><mo>\u2061</mo><msub><mrow><mo maxsize=\"160%\" minsize=\"160%\">\u27e8</mo><mrow><mpadded width=\"-1.7pt\"><msup><mi>\u03c4</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mpadded><mo>\u2062</mo><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mi>\u03c4</mi></msubsup><mrow><mi>\u03b4</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>x</mi><mi>t</mi></msub><mo>-</mo><mi>x</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>d</mo><mi>t</mi></mrow></mrow></mrow></mrow><mo maxsize=\"160%\" minsize=\"160%\">\u27e9</mo></mrow><mi>h</mi></msub></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.06648.tex", "nexttext": "\nwhich indicates the fraction of trajectories for which the particle's final position is $x$.  For the stationary state of the dynamics~\\eqref{equ:dx}, which corresponds to $h=0$, time-translational\ninvariance ensures that $p_{\\rm ave} = p_{\\rm end}$.  However, this is not the case for biased ensembles where $h\\neq0$, as illustrated in~\\cite{Populationdynamics,garrahan2}.  \n\n\n\n\n\nThe population dynamics method provides estimates of both $p_{\\rm ave}$ and $p_{\\rm end}$. \nLet the position of clone $a$ at time $t$ be $x^a(t)$, with $a=1\\dots N_c$.  Recalling Fig.~\\ref{fig:traj}(a), note that the functions $x^a(t)$ are not continuous in time and do not represent sample paths for the distribution $P_h[X]$.\nTo construct sample paths, which we denote by ${\\tilde x}^a(t)$, we trace backwards in time from\nthe clones that survive up to $\\tau$, as shown in Fig.~\\ref{fig:traj}(b).  There are still $N_c$ paths ${\\tilde x}^a$, but these overlap, particularly at early times.  The multiplicity $m_a(t)$ of $\\tilde x^a(t)$ is the number of its descendants at the final time $\\tau$.\nWith these definitions, one arrives at statistical estimators for distributions: $p_{\\rm end}(x) \\approx (1/N_c)\\sum_{a=1}^{N_c}\\delta (x-x^a(t))$, \nand $ p_{\\rm ave}(x) \\approx (1/N_c)\\sum_{a=1}^{N_c} \\delta (x-{\\tilde x}^a(t))$ in their stationary regime \\cite{SM}.  These approximate equalities become exact in the limit $N_c\\to\\infty$, in which the population dynamics gives exact results.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFrom the estimators of $p_{\\rm ave}$ and $p_{\\rm end}$ provided above, \n\none sees that the typical multiplicity of a clone with position $x$\nis $p_{\\rm ave}(x)/p_{\\rm end}(x)$.  If this ratio is large, then the population dynamics requires many clones, in order to obtain accurate results.\n\n\nTo see this, define $x^*={\\operatorname{arg\\,max}}_x [p_{\\rm ave}(x)]$ as the most likely value of $x$, within the distribution $p_{\\rm ave}$.  The population dynamics requires that the typical multiplicity of a clone with position $x^*$ should be of order $m^*=p_{\\rm ave}(x^*)/p_{\\rm end}(x^*)$. This clearly cannot be achieved unless $N_c \\gtrsim m^*$, which provides an estimate of the number of clones required for accurate results.  If this condition is not satisfied, the population dynamics algorithm suffers from large {\\it systematic errors}, which cannot be eliminated by merely running the algorithm several times.  We also note that if typical clone multiplicities $m_a$ are large, the number of \\emph{independent} clones within the population is suppressed by a factor of order $m_a$, which leads to large \\emph{statistical (random) errors} in the algorithm.\n\n\n\n\n\n\n\n\n\n\n\n\n\\emph{Controlled dynamics} -- To resolve this problem, we introduce a ``control strategy'', which modifies the original\nmodel (\\ref{equ:dx}), in order to make the rare events of interest more likely. (These large deviation problems have dual representations in terms of optimal control problems~\\cite{jack15-epj,chetrite15-jstat,fleming92,hartmann12,kappen13}, which provide a natural interpretation of the method presented here.)\n\n\n\n\nThe modified model is\n\n", "itemtype": "equation", "pos": 10576, "prevtext": "\nwhich indicates the fraction of time spent \nat position $x$, within the biased ensemble.  We also define\n\n", "index": 7, "text": "\\begin{equation}\np_{\\rm end}(x) = \\lim_{\\tau \\rightarrow \\infty } \\left\\langle \\delta(x_\\tau-x)  \\right\\rangle_h,\n\n\\label{endp}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"p_{\\rm end}(x)=\\lim_{\\tau\\rightarrow\\infty}\\left\\langle\\delta(x_{\\tau}-x)%&#10;\\right\\rangle_{h},\\par&#10;\" display=\"block\"><mrow><mrow><mrow><msub><mi>p</mi><mi>end</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munder><mo movablelimits=\"false\">lim</mo><mrow><mi>\u03c4</mi><mo>\u2192</mo><mi mathvariant=\"normal\">\u221e</mi></mrow></munder><mo>\u2061</mo><msub><mrow><mo>\u27e8</mo><mrow><mi>\u03b4</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>x</mi><mi>\u03c4</mi></msub><mo>-</mo><mi>x</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u27e9</mo></mrow><mi>h</mi></msub></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.06648.tex", "nexttext": "\nwhere $w(x)$ is a controlling force which we write as $w(x) = h \\kappa \\lambda_c(x)    - \\kappa \\nabla V(x)$, where $V$ acts as a potential.\nThen~\\cite{SM},\naverages with respect to the biased distribution $P_h$ can be rewritten as averages with respect to this modified dynamics, but with a bias on a different observable $\\Lambda^w$,\nwhich replaces $\\Lambda$.  That is,\n\n\n", "itemtype": "equation", "pos": 13862, "prevtext": "\nwhich indicates the fraction of trajectories for which the particle's final position is $x$.  For the stationary state of the dynamics~\\eqref{equ:dx}, which corresponds to $h=0$, time-translational\ninvariance ensures that $p_{\\rm ave} = p_{\\rm end}$.  However, this is not the case for biased ensembles where $h\\neq0$, as illustrated in~\\cite{Populationdynamics,garrahan2}.  \n\n\n\n\n\nThe population dynamics method provides estimates of both $p_{\\rm ave}$ and $p_{\\rm end}$. \nLet the position of clone $a$ at time $t$ be $x^a(t)$, with $a=1\\dots N_c$.  Recalling Fig.~\\ref{fig:traj}(a), note that the functions $x^a(t)$ are not continuous in time and do not represent sample paths for the distribution $P_h[X]$.\nTo construct sample paths, which we denote by ${\\tilde x}^a(t)$, we trace backwards in time from\nthe clones that survive up to $\\tau$, as shown in Fig.~\\ref{fig:traj}(b).  There are still $N_c$ paths ${\\tilde x}^a$, but these overlap, particularly at early times.  The multiplicity $m_a(t)$ of $\\tilde x^a(t)$ is the number of its descendants at the final time $\\tau$.\nWith these definitions, one arrives at statistical estimators for distributions: $p_{\\rm end}(x) \\approx (1/N_c)\\sum_{a=1}^{N_c}\\delta (x-x^a(t))$, \nand $ p_{\\rm ave}(x) \\approx (1/N_c)\\sum_{a=1}^{N_c} \\delta (x-{\\tilde x}^a(t))$ in their stationary regime \\cite{SM}.  These approximate equalities become exact in the limit $N_c\\to\\infty$, in which the population dynamics gives exact results.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFrom the estimators of $p_{\\rm ave}$ and $p_{\\rm end}$ provided above, \n\none sees that the typical multiplicity of a clone with position $x$\nis $p_{\\rm ave}(x)/p_{\\rm end}(x)$.  If this ratio is large, then the population dynamics requires many clones, in order to obtain accurate results.\n\n\nTo see this, define $x^*={\\operatorname{arg\\,max}}_x [p_{\\rm ave}(x)]$ as the most likely value of $x$, within the distribution $p_{\\rm ave}$.  The population dynamics requires that the typical multiplicity of a clone with position $x^*$ should be of order $m^*=p_{\\rm ave}(x^*)/p_{\\rm end}(x^*)$. This clearly cannot be achieved unless $N_c \\gtrsim m^*$, which provides an estimate of the number of clones required for accurate results.  If this condition is not satisfied, the population dynamics algorithm suffers from large {\\it systematic errors}, which cannot be eliminated by merely running the algorithm several times.  We also note that if typical clone multiplicities $m_a$ are large, the number of \\emph{independent} clones within the population is suppressed by a factor of order $m_a$, which leads to large \\emph{statistical (random) errors} in the algorithm.\n\n\n\n\n\n\n\n\n\n\n\n\n\\emph{Controlled dynamics} -- To resolve this problem, we introduce a ``control strategy'', which modifies the original\nmodel (\\ref{equ:dx}), in order to make the rare events of interest more likely. (These large deviation problems have dual representations in terms of optimal control problems~\\cite{jack15-epj,chetrite15-jstat,fleming92,hartmann12,kappen13}, which provide a natural interpretation of the method presented here.)\n\n\n\n\nThe modified model is\n\n", "index": 9, "text": "\\begin{equation}\n\\dot{x}_t = F(x_t) + w(x_t) + B(x_t) \\xi_t,\n\\label{modifiedsystemdef}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"\\dot{x}_{t}=F(x_{t})+w(x_{t})+B(x_{t})\\xi_{t},\" display=\"block\"><mrow><mrow><msub><mover accent=\"true\"><mi>x</mi><mo>\u02d9</mo></mover><mi>t</mi></msub><mo>=</mo><mrow><mrow><mi>F</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mi>B</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>\u03be</mi><mi>t</mi></msub></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.06648.tex", "nexttext": "\nwith $P_w[X] = \\pi_0(x_0) \\exp\\!\\Big[\\!-\\!\\!\\int_0^\\tau\\!\\!\\! {\\cal L}^w(x_t,\\dot{x}_t)  {\\mathrm{d}} t + h \\tau \\Lambda^w(\\tau) \\Big]$,\n\n\n\n\n\n\n\n\nwhere ${\\cal L}^w$ is obtained by replacing $F\\mapsto F+w$ in~\\eqref{eq:Lagrangian}.  Also $\\Lambda^w = \\frac{1}{\\tau}\\int_0^\\tau \\lambda^w(x_t) {\\mathrm{d}} t$,  with\n$ \n\\lambda^w = \\lambda_{\\rm d}  +\\frac 1h[ (F+w/2)\\cdot \\kappa^{-1} w - \\tfrac{1}{2} \\mathrm{Tr}( H_V \\kappa) ],\n$ \n\n\n\nwhere $H_V$ is a Hessian matrix with elements $(\\partial^2 V/\\partial x_i \\partial x_j)$.\n\nAverages with respect to $P_w$ are denoted by $\\langle \\cdot \\rangle_w$,\nand can be calculated using the population dynamics method with the modified model~(\\ref{modifiedsystemdef}).  \n\nPhysically, (\\ref{equ:phw}) says that rare events for the system (\\ref{equ:dx}) have an alternative characterisation as \nrare events for the controlled system (\\ref{modifiedsystemdef}). More precisely,   \nfrom (\\ref{equ:phw}), the averages $\\langle \\cdot \\rangle_h$ and $\\langle \\cdot \\rangle_w$\nare not equal, but their associated probability distributions differ only through boundary terms at initial and final times. \nFor large $\\tau$, we focus on properties far from initial and final times, in which case\nthe averages  $\\langle \\cdot \\rangle_h$ and $\\langle \\cdot \\rangle_w$ are equivalent. \n \nThis equivalence implies that $p_{\\rm ave} = p_{\\rm ave}^{w}$,\nwhere $p_{\\rm ave}^{w}$ is defined as in (\\ref{avep}) but for the controlled population dynamics.  \nOn the other hand, the end-time distribution $p_{\\text{end}}^w$ for the controlled dynamics differs from its uncontrolled counterpart as\n$p_{\\rm end}^{w} \\propto p_{\\rm end} {\\mathrm{e}}^{-V(x)}$, as read from~\\eqref{equ:phw}~\\cite{SM}. \nThus the control $w$ allows $p_{\\rm end}^w$ to be varied, while always keeping $p_{\\rm ave}^w$ constant.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\emph{Optimal control} -- These results apply for any control force $w$, but a (unique)\n optimal choice $w^*$ can be defined by the condition $p_{\\rm ave}^{w^*}=p_{\\rm end}^{w^*}$. \n This choice implies that $\\lambda^w(x)$ is independent of $x$~\\cite{SM}, so that there is no cloning or deletion of clones in the resulting population dynamics algorithm. \nThe optimally-controlled process~\\cite{jack15-epj,chetrite15-jstat,fleming92,hartmann12,kappen13} generates directly the path measure $P_h$, up to the corrections given in~(\\ref{equ:phw})~\\cite{Evans,JackSollich,NemotoSasa2,maes08,Chetrite_Touchette2}.  \n\n\n\\emph{Iteration and feedback} -- Based on these results we now introduce an iterative strategy for solving the original rare event problem (see~\\cite{Nemoto_Sasa_PRL} for a similar idea).  Starting with some (non-optimal) control $w$, and its corresponding potential $V$,\nwe use population dynamics to generate sample paths from $P_w$.  \nFrom the definition of the optimal force ($p_{\\rm end}^{w^*} = p_{\\rm ave}^{w^*}$) and the relations between $p_{\\rm end, ave}^w$ and $p_{\\rm end, ave}$, we obtain\n\n", "itemtype": "equation", "pos": 14337, "prevtext": "\nwhere $w(x)$ is a controlling force which we write as $w(x) = h \\kappa \\lambda_c(x)    - \\kappa \\nabla V(x)$, where $V$ acts as a potential.\nThen~\\cite{SM},\naverages with respect to the biased distribution $P_h$ can be rewritten as averages with respect to this modified dynamics, but with a bias on a different observable $\\Lambda^w$,\nwhich replaces $\\Lambda$.  That is,\n\n\n", "index": 11, "text": "\\begin{equation}\nP_h[X] = P_w[X] {\\mathrm{e}}^{ V(x_\\tau) - V(x_0)} \n\\label{equ:phw}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"P_{h}[X]=P_{w}[X]{\\mathrm{e}}^{V(x_{\\tau})-V(x_{0})}\" display=\"block\"><mrow><mrow><msub><mi>P</mi><mi>h</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>X</mi><mo stretchy=\"false\">]</mo></mrow></mrow><mo>=</mo><mrow><msub><mi>P</mi><mi>w</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>X</mi><mo stretchy=\"false\">]</mo></mrow><mo>\u2062</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mrow><mi>V</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>\u03c4</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mi>V</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></msup></mrow></mrow></math>", "type": "latex"}, {"file": "1601.06648.tex", "nexttext": "\nwhere $V^*$ is the potential $V$ corresponding to the optimal control $w^*$.   \nSince all terms on the left-hand side of (\\ref{equ:pwv}) can be measured from the population dynamics, this allows an estimate of $V^*$,\nand hence of $w^*$.  The population dynamics calculation is then repeated, using this estimated $w^*$ as the new control $w$~\\cite{SM}.  On iteration of this scheme, one expects that $V$ approaches $V^*$, so Eq.~(\\ref{equ:pwv}) means that $p_{\\rm end}^w$  converges to $p_{\\rm ave}^w$.  Thus, in the population\ndynamics,\nthe typical clone multiplicities $m_a(t)$ decrease as the method is iterated,\nimproving the sampling problems discussed above.  This method, which generates sample paths from $P_h$,\n is similar to multicanonical methods such as Wang-Landau sampling~\\cite{Wang_Landau1} which generate sample configurations from equilibrium distributions.\n \n\n\\begin{figure}\n\\centering\n\n\n\n\n\\includegraphics[width=\\columnwidth]{dd1hh1-w-wo-FeedbackSeveralN}\n\\caption{\\label{kappa01ComputationalEfficiencyFeedback} \nDistributions $p_{\\rm ave}(x)$ for the simple model described in the text, calculated (a) from the standard population dynamics method and (b) from the controlled population dynamics with iteration-and-feedback. \n\nWe take $\\epsilon = 1$ and $ h=1$, with a various different numbers of clones $N_c$. \nThe exact distribution $p_{\\rm ave}(x)$ is shown as a black line.  The convergence with respect to $N_c$ is improved significantly by the iteration-and-feedback method.\n\n}\n\\label{fig:pave}\n\\end{figure}\n\n\n{\\it Numerical example.}---We apply this method to a model of diffusion \nin a quartic potential, as introduced in Fig.~\\ref{fig:traj}.\nThat is, $F(x)=-x ^3$ and $B(x) = \\sqrt{2\\epsilon}$, where $\\epsilon$ is the noise strength (or temperature).\nWe take $\\lambda_{\\rm c}=0$ and $\\lambda_{\\rm d}=x(x+1)$.  For $h<0$ the distribution $P_h$ is concentrated on trajectories with small values of $\\lambda_{\\rm d}$,\nwhich tend to\nlocalise near $x\\approx-\\frac12$.   \nHere we focus on the case $h>0$, which leads to unusually large values of $\\lambda_{\\rm d}$. Those can be realised either for $x>0$ or\n$x<0$ but at large $\\tau$ this rare event is almost always realised by trajectories that have $x>0$, as in Fig.~\\ref{fig:traj}.\n\nThis simple problem can be solved\nexactly in the zero-noise limit~\\cite{SM}.\n\nTo implement the iteration-and-feedback method, we parameterise the control potential as a quartic polynomial $V(x) = c_1 x + c_2 x^2 + c_3 x^3 + c_4 x^4$.  \nFor the first iteration of the method we take $V=0$.\nFig.~\\ref{fig:pave} shows estimates of the distribution $p_{\\rm ave}$ obtained using the original cloning method, compared with the results obtained\nusing three iterations of the control-with-feedback procedure proposed here, for $h=1,\\epsilon=1$ and $\\tau=36000/N_c$.  We decrease $\\tau$ with increasing $N_c$ so we work\nat fixed computational cost~\\cite{footnoteProcedure}. \nFig.~\\ref{fig:pave} shows that the number of clones required to obtain convergence to the exact result \nis much reduced using the cloning-with-control method. \n\n\n\n\n\n\n\nIn the weak-noise limit $\\epsilon \\rightarrow 0$, one can see this advantage more clearly.\nIn this limit, it is natural to consider a rescaled cumulant generating function $\\tilde G(\\tilde h) \\equiv \\epsilon G(h)$ with $\\tilde h \\equiv h \\epsilon$~\\cite{footnoteWhyScaling}. Fig.~\\ref{fig:NtGh}(a) shows numerical results for this function, as $\\epsilon$ is reduced.  The normal population dynamics  converges very poorly below a certain value of $\\epsilon$. (The green vertical line shows the value $\\epsilon$ for which $p_{\\rm end}(x^*)\\sim {\\mathrm{e}}^{-1}$ \\cite{footnoteRelationofValidityCondition}). However, the controlled population dynamics does not\nfail at small $\\epsilon$ because it maintains $p^w_{\\rm end} \\approx p_{\\text{ave}}^w$~\\cite{footnotecitation_anneaing}.\n\n\n\nFinally, we consider \\emph{statistical} errors.  Fig.~\\ref{fig:NtGh}(b) shows \nthe number of distinct clone positions in the population, $\\tilde{N}_c(t)$. \nAgain, the cloning-with-control method performs better than the original method, in that it averages over a larger sample of distinct positions, reducing the statistical errors.  \nThe method yields the function $G(h)$, which specifies the probabilities of rare events; it also generates sample paths from $P_h(X)$.  Finally, the optimal control provides a simple \\emph{physical} strategy for promoting the rare events of interest in this illustrative model system.\n\n\n\n\n\\begin{figure}\n\\centering\n\n\n\n\n\\includegraphics[width=\\columnwidth]{comparisons-controlled-non-controlled}\n\\caption{\n(a) Estimates of $\\tilde G(\\tilde h=1)$, as $\\epsilon$ is varied.   We compare results from\nthe normal population dynamics and from the control-with-feedback method. \nThe analytical result for $\\lim_{\\epsilon \\rightarrow 0} \\tilde G(\\tilde h)$  is shown as a dashed line.  \n\nThe standard method fails at small $\\epsilon$ but the control-with-feedback method converges\nto the correct value.\n\n(b) Number of distinct clones $\\tilde N_c(t)$, comparing the standard and the controlled population dynamics. \n\nThe larger values of $\\tilde N_c(t)$ obtained with the control-with-feedback method lead to smaller statistical uncertainties in the results.\n\n}\n\\label{fig:NtGh}\n\\end{figure}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\emph{Outlook} -- We have shown that the performance of the population dynamics algorithm for sampling large deviations~\\cite{Populationdynamics} can be improved by introducing a controlling force $w$.  Given the optimal choice for this force, the rare events of interest in large deviation theory\ncan be characterised as typical trajectories of the controlled system. \nIn complex systems with many degrees of freedom it is likely that the optimal $w$ cannot be determined exactly, but even non-optimal controls can still\nsignificantly improve both the statistical and the systematic errors associated with the population dynamics method.  (Note that the results of Fig.~\\ref{fig:NtGh} used a quartic approximation to $V$ which do not perfectly capture the optimal control $V^*$ \\cite{SM}.)  It is straightforward to\nimprove existing population dynamics codes to include this approach: we expect that it will significantly expand the range of systems for which\nnumerical calculations can be performed, including open quantum systems~\\cite{Garrahanquantum,QuantumGarrahan}, or more complex molecular dynamics models than\nthose considered so far~\\cite{Hedges,speck12}.\n\n\\begin{acknowledgments}\nThe authors are grateful for support Fondation Sciences Math\\'ematiques de Paris -- EOTP NEMOT15RPO, PEPS LABS and LAABS Inphyniti CNRS project.\nThe research leading to these results has received funding from the European Research Council under the European Union's seventh Framework Programme (FP7/2007-2013 Grant Agreement No.~616811) (F.~Bouchet and T.~Nemoto)\n\\end{acknowledgments}\n\n\n\\begin{thebibliography}{99}\n\n\n\n\n\n\\bibitem{auer01}\nS.~Auer and D.~Frenkel, Nature {\\bf 409}, 6823 (2001).\n\\bibitem{sear07}\nR.~P.~Sear, J. Phys.: Cond. Matt. {\\bf 19}, 033101(2007).\n\n\n\n\n \n\\bibitem{ren05}\n\nW.~Ren, E.~Vanden-Eijnden, P.~Maragakis and W. E, J. Chem. Phys. {\\bf 123}, 134109 (2005).\n\n\\bibitem{VKS}\nM. Berhanu, {\\it et al}., Europhys. Lett. {\\bf 77}, 59001 (2007).\n\n\\bibitem{BouchetSimonnet}\nF. Bouchet, and E. Simonnet, Phys. Rev. Lett. {\\bf 102}, 094504 (2009).\n\n\n\n\n\n\\bibitem{ClimateExtremes}\nD. R. Easterling, G. A. Meehl, C. Parmesan, S. A. Changnon, T. R. Karl, L. O. Mearns, Science, {\\bf 289}, 2068 (2000).\n\n\n\n\\bibitem{Populationdynamics}\nC. Giardin\\`a, J. Kurchan, and L. Peliti, Phys. Rev. Lett. {\\bf 96}, 120603 (2006).\n\n\\bibitem{TailleurKurchan}\nJ. Tailleur, and J. Kurchan, Nature Physics, {\\bf 3}, 203 (2007).\n\n\n\\bibitem{Splittingmethod}\nP. L. Ecuyer, V. Demers, and B. Tuffin, Proceedings of the 2006 Winter Simulation Conference, 137, (2006).\n\n\n\\bibitem{FFS1}\nR. J. Allen, P. B. Warren, and P. R. ten Wolde, Phys.\nRev. Lett. {\\bf 94}, 018104 (2005).\n\n\n\n\n\n\n\n\\bibitem{Chandler}\nP. G. Bolhuis, D. Chandler, C. Dellago, and P. L.\nGeissler, Annu. Rev. Phys. Chem. {\\bf 53}, 291 (2002).\n\n\n\\bibitem{Nemoto_Sasa_PRL}\nT. Nemoto and S.-i. Sasa, Phys. Rev. Lett. {\\bf 112}, 090602 (2014).\n\n\n\n\n\\bibitem{DMC} J. B. Anderson,\n J. Chem. Phys {\\bf 63}, 1499 (1975).\n\n\\bibitem{Aldous} D. Aldous and U. Vazirani,\n\nin Proc. 35th IEEE Sympos. on Foundations of Computer Science (1994).\n\n\\bibitem{Grassberger} P. Grassberger,\n\nComp. Phys. Comm. \\textbf{147} 64 (2002).\n\n\n\n\\bibitem{Garnier}\nP. Del Moral, and J. Garnier, The Annals of Applied Probability, {\\bf 15}, 2496 (2005).\n\n\n\n\\bibitem{Lelievre}\nF. C\\'{e}rou, A. Guyader, T. Leli\\`evre and D. Pommier, J. Chem. Phys. {\\bf 134} 054108 (2011).\n\n\\bibitem{Rolland}\nJ. Rolland, F. Bouchet and E. Simonnet, J. Stat. Phys. {\\bf 162}, 277 (2016).\n\n\n\n\n\n\n\\bibitem{Touchette}\nH. Touchette, Phys. Rep. {\\bf 478}, 1, (2009).\n\\bibitem{Dembo_Zeitouni}\nA. Dembo and O. Zeitouni, {\\it Large deviations techniques and applications} (Springer, New York, 1998).\n\n\n\n\n\n\n\n\n\n\\bibitem{Hedges}\nL. O. Hedges, R. L. Jack, J. P. Garrahan and D. Chandler, Science {\\bf 323} 1309 (2009).\n\n\n\n\\bibitem{picciani11}\nM.~Picciani, M.~Ath\\`enes,J.~Kurchan and J.~Tailleur, J. Chem. Phys.\\textbf{ 135} 034108 (2011).\n\n\\bibitem{weber13}\nJ.~K.~Weber, R.~L.~Jack and V.~S.~Pande, J. Am. Chem. Soc. {\\bf 135}, 5501 (2013).\n\\bibitem{mey14}\nA.~S.~J.~S.~Mey, P.~L.~Geissler and J.~P.~Garrahan, Phys. Rev. E {\\bf 89}, 032109 (2014).\n\n\n\\bibitem{hurtado14}\nP.~I.~Hurtado, C.~P.~Espigares, J.~J.~del Pozo, P.~L.~Garrido,\nJ. Stat. Phys. {\\bf 154}, 214 (2014).\n\\bibitem{derrida07}\nB. Derrida, J. Stat. Mech. 2007, P07023 (2007).\n\\bibitem{hurtado09}\nP.~I.~Hurtado and P.~L.~Garrido,\nJ. Stat. Mech. (2009) P02032\n\n\n\n\\bibitem{Berg_Neuhaus1}\nB. A. Berg and T. Neuhaus, Physics Letters B {\\bf 267}, 249 (1991).\n\n\n\n\n\n\\bibitem{Wang_Landau1}\nF. Wang and D.P. Landau, Phys. Rev. Lett. {\\bf 86}, 2050 (2001).\n\n\n\n\n\\bibitem{footnoteinteraction}\nAll the results presented here can be generalised\nto models with $n$ interacting particles, by replacing $d\\to nd$ and including interaction forces in $F(x)$.  Markov jump\nprocesses are also workable.\n\n\\bibitem{Gardiner}\nC. W. Gardiner, {\\it Handbook of Stochastic Methods for Physics, Chemistry, and the Natural Sciences} (Springer-Verlag, Berlin, 1983).\n\n\n\\bibitem{lebowitz99}\nJ.~L.~Lebowitz and H.~Spohn, J. Stat. Phys. {\\bf 95}, 333 (1999).\n\n\n\\bibitem{lecomte07jsp}\nV.~Lecomte, C.~Appert-Roland and F. van Wijland, J. Stat. Phys. {\\bf 127}, 51 (2007).\n\n\n\\bibitem{garrahan07}\nJ.~P.~Garrahan, R.~L.~Jack, V.~Lecomte, E.~Pitard, K.~van~Duijvendijk and F.~van~Wijland,\nPhys. Rev. Lett. {\\bf 98}, 195702 (2007).\n\n\n\\bibitem{bodineau05}\nT. Bodineau and  B. Derrida, \nPhys. Rev. E {\\bf 72}, 066110 (2005). \n\n\\bibitem{footnoteinvertible}\nThe matrix $\\kappa$ is assumed to be invertible but the generalization to non-invertible $\\kappa$ is direct.\n\n\n\\bibitem{HTouchette_equivalence}\nH. Touchette, J. Stat. Phys. {\\bf 159}, 987 (2015).\n\n\n\n\\bibitem{Populationdynamics3}\nV. Lecomte and J. Tailleur, J. Stat. Mech. (2007) P03004.\n\n\n\n\n\\bibitem{SM}\nSee Supplemental Material.\n\n\\bibitem{garrahan2}\nJ. P. Garrahan, R. L. Jack, V. Lecomte, E. Pitard, K. van Duijvendijk, and F. van Wijland,\nJ. Phys. A {\\bf 42}, 075007 (2009).\n\n\n\n\n\n\n\n\\bibitem{jack15-epj}\nR. L. Jack and P. Sollich, Eur. Phys. J: Special Topics {\\bf 224}, 2351 (2015).\n\n\\bibitem{chetrite15-jstat}\nR. Chetrite and H. Touchette, J. Stat. Mech. {\\bf 2015} P12001, (2015).\n\n\\bibitem{fleming92}\nW.~H.~Fleming, \\emph{Stochastic control and large deviations}, \nin \\emph{Future Tendencies in Computer Science, Control and Applied Mathematics}, pages 291-300\n(Springer, Berlin, 1992).\n\n\\bibitem{hartmann12}\nC.~Hartmann and C.~Sch\\\"{u}tte, J. Stat. Mech. (2012), P11004\n\\bibitem{kappen13}\nV.~Y.~Chernyak, M.~Chertkov, J.~Bierkens and H.~J.~Kappen, \nJ. Phys. A {\\bf 47}, 022001 (2013).\n\n\n\n\n\n\\bibitem{Evans}\nR. M. L. Evans, Phys. Rev. Lett. {\\bf 92}, 150601 (2004).\n\\bibitem{JackSollich}\nR. L. Jack and P. Sollich, Prog. Theor. Phys. Suppl. {\\bf 184}, 304 (2010).\n\n\n\\bibitem{NemotoSasa2}\nT. Nemoto and S.-i. Sasa, Phys. Rev. E {\\bf 84}, 061113 (2011).\n\n\n\n\\bibitem{maes08}\nC.~Maes and K.~Netocny, EPL {\\bf 82}, 30003 (2008).\n\n\\bibitem{Chetrite_Touchette2}\nR. Chetrite and H. Touchette, Ann. Henri Poincare {\\bf 16}, 2005, (2015).\n\n\n\n\\bibitem{footnoteProcedure}\nMore precisely, we divide this time interval $\\tau$ into several bins, where each of which is sufficiently large to obtain $p_{\\rm ave}$. The estimated $p_{\\rm ave}$ is the average of them. See \\cite{SM} for the detail.\n\n\\bibitem{footnoteWhyScaling}\nIn the weak-noise limit $\\epsilon\\to0$, the dynamics of the \nsystem runs increasingly slowly so it is necessary to rescale either the time variable or (equivalently) the biasing field $h$ like this. \nIndeed, this scaled CGF, and also $p_{\\rm end}$, $p_{\\rm ave}$, \nhave a well-defined limit as $\\epsilon\\to0$ (at fixed $\\tilde h$). The function $\\tilde G$ is singular at $\\tilde h=0$, indicating a dynamical phase transition~\\cite{SM}.  \n\n\n\n\n\n\n\n\n\n\n\n\n\\bibitem{footnoteRelationofValidityCondition}\nThis condition is (roughly) equivalent to the relation $N_c  \\sim m^*$ that is used for accuracy-criterion of the population dynamics method (See paragraph {\\it Sampling errors within population dynamics}). \n\n\n\n\\bibitem{footnotecitation_anneaing}\nThe numerical calculations exploit an ``annealing procedure'' in which\n$\\epsilon$ is reduced in steps of size\n$\\delta\\epsilon=0.01$, with the best estimate of $w^*$ from the each step being used as the first guess for $w^*$ \nin the subsequent step.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\bibitem{Garrahanquantum}\nJuan P. Garrahan and Igor Lesanovsky, Phys. Rev. Lett. \\textbf{104}, 160601 (2010).\n\n\\bibitem{QuantumGarrahan}\nJames M. Hickey, Sam Genway, Igor Lesanovsky, and Juan P. Garrahan\nPhys. Rev. A \\textbf{86}, 063824 (2012).\n\n\\bibitem{speck12}\nT. Speck, A. Malins and C.~P.~Royall, Phys. Rev. Lett. {\\bf 109}, 195703 (2012).\n\n\n\n\n\n\n\\end{thebibliography}\n\n\n\n\\includepdf[pages={{},1,{},2,{},3,{},4,{},5,{},6,{},7,{},8,{},9,{},10,{},11,{},12}]{Supplement10b.pdf}\n\n\n", "itemtype": "equation", "pos": 17387, "prevtext": "\nwith $P_w[X] = \\pi_0(x_0) \\exp\\!\\Big[\\!-\\!\\!\\int_0^\\tau\\!\\!\\! {\\cal L}^w(x_t,\\dot{x}_t)  {\\mathrm{d}} t + h \\tau \\Lambda^w(\\tau) \\Big]$,\n\n\n\n\n\n\n\n\nwhere ${\\cal L}^w$ is obtained by replacing $F\\mapsto F+w$ in~\\eqref{eq:Lagrangian}.  Also $\\Lambda^w = \\frac{1}{\\tau}\\int_0^\\tau \\lambda^w(x_t) {\\mathrm{d}} t$,  with\n$ \n\\lambda^w = \\lambda_{\\rm d}  +\\frac 1h[ (F+w/2)\\cdot \\kappa^{-1} w - \\tfrac{1}{2} \\mathrm{Tr}( H_V \\kappa) ],\n$ \n\n\n\nwhere $H_V$ is a Hessian matrix with elements $(\\partial^2 V/\\partial x_i \\partial x_j)$.\n\nAverages with respect to $P_w$ are denoted by $\\langle \\cdot \\rangle_w$,\nand can be calculated using the population dynamics method with the modified model~(\\ref{modifiedsystemdef}).  \n\nPhysically, (\\ref{equ:phw}) says that rare events for the system (\\ref{equ:dx}) have an alternative characterisation as \nrare events for the controlled system (\\ref{modifiedsystemdef}). More precisely,   \nfrom (\\ref{equ:phw}), the averages $\\langle \\cdot \\rangle_h$ and $\\langle \\cdot \\rangle_w$\nare not equal, but their associated probability distributions differ only through boundary terms at initial and final times. \nFor large $\\tau$, we focus on properties far from initial and final times, in which case\nthe averages  $\\langle \\cdot \\rangle_h$ and $\\langle \\cdot \\rangle_w$ are equivalent. \n \nThis equivalence implies that $p_{\\rm ave} = p_{\\rm ave}^{w}$,\nwhere $p_{\\rm ave}^{w}$ is defined as in (\\ref{avep}) but for the controlled population dynamics.  \nOn the other hand, the end-time distribution $p_{\\text{end}}^w$ for the controlled dynamics differs from its uncontrolled counterpart as\n$p_{\\rm end}^{w} \\propto p_{\\rm end} {\\mathrm{e}}^{-V(x)}$, as read from~\\eqref{equ:phw}~\\cite{SM}. \nThus the control $w$ allows $p_{\\rm end}^w$ to be varied, while always keeping $p_{\\rm ave}^w$ constant.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\emph{Optimal control} -- These results apply for any control force $w$, but a (unique)\n optimal choice $w^*$ can be defined by the condition $p_{\\rm ave}^{w^*}=p_{\\rm end}^{w^*}$. \n This choice implies that $\\lambda^w(x)$ is independent of $x$~\\cite{SM}, so that there is no cloning or deletion of clones in the resulting population dynamics algorithm. \nThe optimally-controlled process~\\cite{jack15-epj,chetrite15-jstat,fleming92,hartmann12,kappen13} generates directly the path measure $P_h$, up to the corrections given in~(\\ref{equ:phw})~\\cite{Evans,JackSollich,NemotoSasa2,maes08,Chetrite_Touchette2}.  \n\n\n\\emph{Iteration and feedback} -- Based on these results we now introduce an iterative strategy for solving the original rare event problem (see~\\cite{Nemoto_Sasa_PRL} for a similar idea).  Starting with some (non-optimal) control $w$, and its corresponding potential $V$,\nwe use population dynamics to generate sample paths from $P_w$.  \nFrom the definition of the optimal force ($p_{\\rm end}^{w^*} = p_{\\rm ave}^{w^*}$) and the relations between $p_{\\rm end, ave}^w$ and $p_{\\rm end, ave}$, we obtain\n\n", "index": 13, "text": "\\begin{equation}\n\\frac{p^w_{\\rm end}(x)  }{ p^w_{\\rm ave}(x) } {\\mathrm{e}}^{V(x)} = {\\mathrm{e}}^{V^*(x)}\n\\label{equ:pwv}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"\\frac{p^{w}_{\\rm end}(x)}{p^{w}_{\\rm ave}(x)}{\\mathrm{e}}^{V(x)}={\\mathrm{e}}^%&#10;{V^{*}(x)}\" display=\"block\"><mrow><mrow><mfrac><mrow><msubsup><mi>p</mi><mi>end</mi><mi>w</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msubsup><mi>p</mi><mi>ave</mi><mi>w</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac><mo>\u2062</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mi>V</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></msup></mrow><mo>=</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><msup><mi>V</mi><mo>*</mo></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></msup></mrow></math>", "type": "latex"}]