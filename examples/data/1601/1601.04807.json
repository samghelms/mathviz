[{"file": "1601.04807.tex", "nexttext": " holds for sufficiently large $q$ and arbitrary $\\epsilon>0$. We also prove \n", "itemtype": "equation", "pos": -1, "prevtext": "\n\\begin{CJK*}{GBK}{song}\n\n\n\\title{Separating hash families: A Johnson-type bound and new constructions}\n\\author{\nChong Shangguan$^{\\text{a}}$, Gennian Ge$^{\\text{b,c,}}$\\thanks{Corresponding author. Email address: gnge@zju.edu.cn. Research  supported by the National Natural Science Foundation of China under Grant Nos. 61171198, 11431003 and 61571310, the Importation and Development of High-Caliber Talents Project of Beijing Municipal Institutions, and the  Scientific and Technological Innovation Capacity  Enhancement  Program of Beijing Municipal Institutions.\n}\n\\\\\n\\footnotesize $^{\\text{a}}$ School of Mathematical Sciences, Zhejiang University, Hangzhou 310027, Zhejiang, China.\\\\\n\\footnotesize $^{\\text{b}}$ School of Mathematical Sciences, Capital Normal University, Beijing 100048, China\\\\\n\\footnotesize $^{\\text{c}}$ Beijing Center for Mathematics and Information\nInterdisciplinary Sciences,\nBeijing 100048, China\\\\\n}\n\\maketitle\n\n\\begin{abstract}\n    Separating hash families are useful combinatorial structures which are generalizations of many well-studied objects in combinatorics, cryptography and coding theory.\n    In this paper, using tools from graph theory and additive number theory, we solve several open problems and conjectures concerning bounds and constructions for separating hash families.\n\n    Firstly, we discover that the cardinality of a separating hash family satisfies a Johnson-type inequality. As a result, we obtain a new upper bound, which is superior to all previous ones.\n\n    Secondly, we present a construction for an infinite class of perfect hash families. It is based on the Hamming graphs in coding theory and generalizes many constructions that appeared before. It provides an affirmative answer to both Bazrafshan-Trung's open problem on separating hash families and Alon-Stav's conjecture on parent-identifying codes.\n\n    Thirdly, let $p_t(N,q)$ denote the maximal cardinality of a $t$-perfect hash family of length $N$ over an alphabet of size $q$. Walker II and Colbourn conjectured that $p_3(3,q)=o(q^2)$. We verify this conjecture by proving $q^{2-o(1)}<p_3(3,q)=o(q^2)$. Our proof can be viewed as an application of Ruzsa-Szemer{\\'e}di's (6,3)-theorem. We also prove $q^{2-o(1)}<p_4(4,q)=o(q^2)$. Two new notions in graph theory and additive number theory, namely rainbow cycles and $R$-sum-free sets, are introduced to prove this result. These two bounds support a question of Blackburn, Etzion, Stinson and Zaverucha.\n\n    Finally, we establish a bridge between perfect hash families and hypergraph Tur{\\'a}n problems. This connection has not been noticed before. As a consequence, many new results and problems arise.\n\\end{abstract}\n\n{\\it Keywords:} separating hash family, perfect hash family, Johnson-type bound, rainbow cycle, $R$-sum-free set.\n\n{\\it Mathematics subject classifications:} 05B30, 94A60, 68R05, 94B60\n\n\\section{Introduction}\n\n\n\n Separating hash families are useful combinatorial structures introduced by Stinson, Wei and Chen \\cite{ST08}. They are generalizations of many combinatorial objects, for example, perfect hash families, frameproof codes and codes with the identifiable parent property.\n\n     Let us begin with some definitions.\n\n   \\begin{definition}\n\n     Let $X$ and $Y$ be sets of cardinalities $n$ and $q$, respectively. We call a set ${\\mathcal}{F}$ of $N$ functions $f:X\\rightarrow Y$ an $(N;n,q)$-hash family.\n\n   \\end{definition}\n\n   \\begin{definition}\n\n     Let $f:X\\rightarrow Y$ be a function, and let pairwise disjoint subsets $C_1,C_2,\\ldots,C_t{\\subseteq} X$. We say that $f$ separates $C_1,C_2,\\ldots,C_t$ if $f(C_1),\\ldots,f(C_t)$ are pairwise disjoint. In particular, we say that $f$ separates a subset $C{\\subseteq} X$ if $f(C){\\subseteq} Y$ has $|C|$ distinct values.\n\n   \\end{definition}\n\n   \\begin{definition}\n\n     Let $X$ and $Y$ be sets of cardinalities $n$ and $q$, respectively, and let ${\\mathcal}{F}$ be an $(N;n,q)$-hash family of functions from $X$ to $Y$. We say that ${\\mathcal}{F}$ is an $(N;n,q,\\{w_1,\\ldots,w_t\\})$-separating hash family (which we will also denote as an $SHF(N;n,q,\\{w_1,\\ldots,w_t\\})$) if it satisfies the following property: for all pairwise disjoint subsets $C_1,C_2,\\ldots,C_t{\\subseteq} X$ with $|C_i|=w_i$ for $1\\le i\\le t$, there exists at least one function $f\\in{\\mathcal}{F}$ that separates $C_1,C_2,\\ldots,C_t$. We call the multiset $\\{w_1,\\ldots,w_t\\}$ the type of this separating hash family.\n\n   \\end{definition}\n\n    For a positive integer $q$, we denote $[q]$ for the set $\\{1,\\ldots,q\\}$. Without loss of generality, we may fix the alphabet set $Y$ to be the set of first $q$ positive integers. And for the sake of simplicity, we set $u=\\sum_{i=1}^{t} w_i$ throughout this paper. To avoid trivial cases, we assume that $n>q$, $q\\ge t\\ge 2$ and $u\\le n$.\n\n    The concept of separating hash families was first introduced in the special case $t=2$ by Stinson, Trung and Wei \\cite{secure} and then generalized by Stinson, Wei and Chen \\cite{ST08}. This notion has relations with many well-studied objects in combinatorics, cryptography and coding theory, see \\cite{blackburn08,ST08} for a detailed introduction. We will summarise some objects in which we are interested.\n\n     \\begin{itemize}\n      \\item If $w_1=w_2=\\cdots w_t=1$, an $SHF(N;n,q,\\{1,\\ldots,1\\})$ is known as a $t$-{\\it perfect hash family}, which will be denoted as $PHF(N;n,q,t)$.\n            Perfect hash families are basic combinatorial structures and have important applications in cryptography \\cite{cyr1,cry2,ST01,secure}, database management \\cite{data1}, circuit design \\cite{circuit} and the design of deterministic analogues of probabilistic algorithms \\cite{alog}.\n\n      \\item If $t=2$ with $w_1=1$ and $w_2=w$, an $SHF(N;n,q,\\{1,w\\})$ is known as a $w$-{\\it frameproof code}. \n            The frameproof code is a kind of fingerprinting codes and has applications in the protection of copyrighted materials. See \\cite{BL03,fpc1,ST01,fpc2} for results on frameproof codes.\n\n      \\item Codes with the {\\it identifiable parent property} (or 2-$IPP$ codes) are separating hash families which are simultaneously of type $\\{1,1,1\\}$ and\n            $\\{2,2\\}$, see \\cite{ippa,ippe,ippc,ippd,ipp}.\n\n     \\end{itemize}\n\n      Bounds and constructions for separating hash families are central problems in this research area. Given positive integers $N$, $q$ and $w_1,\\ldots,w_t$,\n      people are interested in how large the cardinality $n$ of the preimage set $X$ can be. We use $C(N,q,\\{w_1,\\ldots,w_t\\})$ to denote this maximal cardinality.\n\n      By a method known as grouping coordinates, the problem of bounding $C(N,q,\\{w_1,\\ldots,w_t\\})$ can be reduced to bounding $C(u-1,q,\\{w_1,\\ldots,w_t\\})$, since it has been observed in \\cite{Trung2011,blackburn08,ST08} that $C(N,q,\\{w_1,\\ldots,w_t\\})\\le C(u-1,q^{\\lceil N/u-1\\rceil},\\{w_1,\\ldots,w_t\\})$.\n\n     In the literature, researchers are seeking for the minimal positive real number $\\gamma$ such that $C(u-1,q,\\{w_1,\\ldots,w_t\\})\\le\\gamma q$ holds for arbitrary $q$. The reader is referred to \\cite{Trung2011,blackburn08,ST01,secure,ST08} for the attempts that have been made. In 2008, Stinson, Wei and Chen \\cite{ST08} proved $C(3,q,\\{1,1,2\\})\\le3q+2-2\\sqrt{3m+1}$ and $C(3,q,\\{2,2\\})\\le 4q-3$ for two special cases. In the same year, Blackburn, Etizon, Stinson and Zaverucha \\cite{blackburn08} proved $C(u-1,q,\\{w_1,\\ldots,w_t\\})\\le(w_1w_2+u-w_1-w_2) q$, where $w_1,w_2\\le w_i$ for $3\\le i\\le t$. In 2011, Bazrafshan and Trung \\cite{Trung2011} proved the following theorem:\n\n     \\begin{theorem} {\\rm(\\cite{Trung2011})}\\label{shf0}\n        $C(u-1,q,\\{w_1,\\ldots,w_t\\})\\le(u-1)q.$\n     \\end{theorem}\n\n     \\noindent Moreover, they suspected that (see Question \\ref{trung}) $\\gamma=u-1$ is the minimal real number such that above bound holds for arbitrary $q$.\n\n     We improve Theorem \\ref{shf0} in various aspects, including some tighter bounds and asymptotically optimal constructions. The novelty of our work is that we develop two new approaches to study bounds and constructions for codes and hash families with the separating property. We will explain them in detail in the conclusion section of this paper.\n\n     We state our main results as follows.\n\n    \\subsection{Separating hash families}\n\n    Following the steps of previous papers \\cite{Trung2011,blackburn08,ST08}, we discover an important property for separating hash families that the growth of $C(N,q,\\{w_1,\\ldots,w_t\\})$ satisfies a Johnson-type inequality. Roughly speaking, $C(N,q,\\{w_1,...,w_t\\})\\le q^l+\\max\\{u-1,C(N-l,q,\\{w_1-1,...,w_t\\})\\}$ holds for every positive integer $l$ (see Lemma \\ref{technical} below). As a result, we obtain the following new upper bound for separating hash families which is the best known one.\n\n    \\begin{theorem} \\label{recusivebd}\n        Suppose there exists an $SHF(N;n,q,\\{w_1,\\ldots,w_t\\})$. Let $u=\\sum_{i=1}^t w_i$ and let $1\\le r\\le u-1$ be the positive integer such that $N\\equiv r \\pmod{u-1}$.\n        If $C(\\lfloor N/(u-1)\\rfloor,q,\\{w_1,\\ldots,w_t\\})\\ge u$, then it holds that $n\\le rq^{\\lceil N/(u-1)\\rceil}+(u-1-r)q^{\\lfloor N/(u-1)\\rfloor}$.\n    \\end{theorem}\n\n    \n      A novelty of our proof is that we avoid the use of the grouping coordinates method, which has appeared in all previous proofs. The constraint $C(\\lfloor N/(u-1)\\rfloor,q,\\{w_1,\\ldots,w_t\\})\\ge u$ can be omitted when $N\\ge u-1$ and $q\\ge u$.\n\n     For the coefficient $\\gamma$ defined in Theorem \\ref{shf0}, the authors of \\cite{Trung2011} posed the following question:\n\n    \\begin{question} \\label{trung} {\\rm(\\cite{Trung2011})}\n        Is there any type $\\{w_1,\\ldots,w_t\\}$ for which the constant $(u-1)$ in Theorem \\ref{shf0} can be replaced by another constant strictly smaller than $(u-1)$?\n    \\end{question}\n\n    We give a negative answer to their question by presenting the following construction:\n\n    \\begin{theorem}\\label{const}\n        There exists a $PHF(N;Nq^{N-1},q^{N-1}+(N-1)q^{N-2},N+1)$ for any integer $q\\ge 2$ and $N\\ge 2$.\n    \\end{theorem}\n\n    To see that our construction is actually a negative answer to Question \\ref{trung}, one just needs to notice that a $u$-perfect hash family is also $\\{w_1,\\ldots,w_t\\}$-separating for arbitrary $\\sum_{i=1}^t w_i=u$. If we set $N=u-1$ then our construction implies the existence of an $SHF(u-1;n,q,\\{w_1,\\ldots,w_t\\})$ such that $\\lim_{q\\rightarrow\\infty}{\\frac}{n}{q}=u-1$ holds for arbitrary $\\sum_{i=1}^t w_i=u$. Therefore, the constant $\\gamma$ can never be less than $u-1$.\n\n    \\subsection{Codes with the identifiable parent property}\n\n    We have mentioned 2-IPP codes before and the notion was generalized to codes with the $t$-identifiable parent property ($t$-IPP codes) in \\cite{ST01}. The definition is postponed to Section 2 for the sake of saving space.\n\n    Let $i_t(N,q)$ denote the maximal cardinality of a $t$-IPP code of length $N$ over an alphabet of size $q$. Let $v=\\lfloor(t/2+1)^2\\rfloor$. One can verify that $i_t(N,q)\\le i_t(v-1,q^{{\\lceil} N/(v-1){\\rceil}})$ (just as the case for separating hash families). Thus the problem of bounding $i_t(N,q)$ can be reduced to bounding $i_t(v-1,q)$. Alon and Stav \\cite{ippc} proved that $i_t(v-1,q)\\le (v-1)q$, and they conjectured:\n\n    \\begin{conjecture}\\label{alonstav}{\\rm(\\cite{ippc})}\n        There are constructions showing that $(v-1)$ is the best constant in the inequality $i_t(v-1,q)\\le(v-1)q.$\n    \\end{conjecture}\n\n    Our Theorem \\ref{const} not only answers Question \\ref{trung} but also verifies this conjecture, since it was observed in \\cite{ippc,ST01} that a $v$-perfect hash family also satisfies the $t$-identifiable parent property.\n\n    \\subsection{Perfect hash families}\n\n    As claimed in \\cite{blackburn08}, the exponent ${\\lceil} N/(u-1){\\rceil}$ in the bound of Theorem \\ref{recusivebd} is realistic. We can understand this in two aspects. On one hand, a probabilistic construction of Blackburn \\cite{perfect2} showed that for any fixed $u$ and any positive real number $\\delta$ such that $\\delta<N/(u-1)$, there exists a $PHF(N;\\lfloor q^{\\delta}\\rfloor,q,u)$ whenever $q$ is sufficiently large. On the other hand, let $p_t(N,q)$ denote the maximal cardinality of a $PHF(N;n,q,t)$, it was respectively observed in \\cite{ippc,perfecthasing,nilli} that $p_u(N,q)\\ge (c_uq)^{N/(u-1)}$ holds for some constant $c_u$. So we can conclude that the exponent ${\\lceil} N/(u-1){\\rceil}$ is tight when $(u-1)|N$.\n\n    But the problem becomes much more difficult when $(u-1)\\nmid N$. For a long time, people do not know whether the exponent is tight. Even for the smallest case, $u=3$ and $N=3$, Walker II and Colbourn \\cite{N=3t=3} posed the following conjecture:\n\n    \\begin{conjecture} \\label{walker}{\\rm(\\cite{N=3t=3})}\n        $p_3(3,q)=o(q^2).$\n    \\end{conjecture}\n    \\noindent Note that Theorem \\ref{recusivebd} shows $p_3(3,q)=O(q^2)$. A recent paper \\cite{fuji2015perfect} showed that $p_3(3,q)=\\Omega(q^{5/3})$. Results from finite geometry were used to construct such families. There is still a huge gap between the upper and lower bounds.\n    For general types of separating hash families, Blackburn et al. \\cite{blackburn08} asked a similar question:\n\n    \\begin{question}\\label{nmid}{\\rm(\\cite{blackburn08})}\n        Let $N$ and $w_i$ be fixed integers. If $(u-1)\\nmid N$, then for sufficiently large $q$ and arbitrary small $\\epsilon>0$, does there exist an $SHF(N;n,q,\\{w_1,\\ldots,w_t\\})$ such that $n\\ge q^{\\lceil N/(u-1)\\rceil-\\epsilon}?$\n    \\end{question}\n\n     We prove Conjecture \\ref{walker} in Section 5 (see Theorems \\ref{p_3(3,q)=f_3(3q,6,3)+O(q)} and \\ref{optimal3} below). We find that perfect hash families are closely related to a hypergraph Tur{\\'a}n problem. With some transformations, Walker II-Colbourn's conjecture can be proved by a direct application of the famous (6,3)-theorem of Ruzsa and Szemer{\\'e}di \\cite{RS}. In fact, we show \n", "index": 1, "text": "$$q^{2-\\epsilon}<p_3(3,q)=o(q^2)$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"q^{2-\\epsilon}&lt;p_{3}(3,q)=o(q^{2})\" display=\"block\"><mrow><msup><mi>q</mi><mrow><mn>2</mn><mo>-</mo><mi>\u03f5</mi></mrow></msup><mo>&lt;</mo><mrow><msub><mi>p</mi><mn>3</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>3</mn><mo>,</mo><mi>q</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mi>o</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>q</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": " (see Theorem \\ref{optimal4} below). Two new notions in graph theory and additive number theory, namely rainbow cycles and $R$-sum-free sets, are introduced to prove this result. One can see that these two bounds suggest that there may be a positive answer to Question \\ref{nmid}.\n\n     \\subsection{Organization}\n\n    The rest of this paper is organised as follows. Section 2 is for some preparations. Theorem \\ref{recusivebd} is proved in Section 3 and Theorem \\ref{const} is proved in Section 4. The subsequent sections will focus on perfect hash families. We prove $q^{2-o(1)}<p_3(3,q)=o(q^2)$ in Section 5. As an application of the Johnson-type bound, this result will be extended to $p_t(t,q)$ and related separating hash families. We prove $q^{2-o(1)}<p_4(4,q)=o(q^2)$ in Section 6. In Section 7 we will build the connection between perfect hash families and a class of hypergraph Tur{\\'a}n problems. Section 8 is about some concluding remarks and open problems.\n\n    \\section{Preliminaries}\n\n    In this section, we will introduce some notations and terminology. We will also introduce some simple lemmas that will be used in the subsequent sections.\n\n    \\subsection{Separating hash families and IPP codes}\n\n    The matrix representation of a separating hash family is very useful when discussing its properties. An $(N;n,q)$-hash family can be described as an $N\\times n$ matrix on $q$ symbols, which will be usually denoted as $M$. The rows of $M$ correspond to the functions in the hash family and the columns of $M$ correspond to the elements of $X$.\n    The entry of $M$ in row $f\\in{\\mathcal}{F}$ and column $x\\in X$ is just $f(x)\\in Y.$ We denote the entry of $M$ as $M(f,x)$ for $f\\in{\\mathcal}{F}$, $x\\in X$ or $M(i,j)$ for $1\\le i\\le N$, $1\\le j\\le n$.\n\n    The matrix representation of an $SHF(N;n,q,\\{w_1,\\ldots,w_t\\})$ satisfies the following property: given disjoint sets of columns $C_1,\\ldots,C_t$, where $|C_i|=w_i$ for $1\\le i\\le t$, there exists a row $r$ of $M$ such that\n    \n", "itemtype": "equation", "pos": -1, "prevtext": " holds for sufficiently large $q$ and arbitrary $\\epsilon>0$. We also prove \n", "index": 3, "text": "$$q^{2-\\epsilon}<p_4(4,q)=o(q^2)$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"q^{2-\\epsilon}&lt;p_{4}(4,q)=o(q^{2})\" display=\"block\"><mrow><msup><mi>q</mi><mrow><mn>2</mn><mo>-</mo><mi>\u03f5</mi></mrow></msup><mo>&lt;</mo><mrow><msub><mi>p</mi><mn>4</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>4</mn><mo>,</mo><mi>q</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mi>o</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>q</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n    \\noindent for all $i\\neq j$. We say row $r$ separates a subset of columns $C{\\subseteq} X$ if $\\{M(r,x):x\\in C\\}$ has exactly $|C|$ distinct values in $Y$. The column $x$ of $M$ will be written as a $q$-ary vector of length $N$, $x=(x(1),x(2),\\ldots,x(N))$, where $x(i)\\in [q]$ for $i\\in[N]$. For a subset $L$ of the rows of $M$, the coordinates of $x$ restricted to $L$ give a word of length $|L|$, which is denoted as $x|_{L}=(x(i_1),x(i_2),\\ldots,x(i_{|L|}))$, where $i_j,~1\\le j\\le |L|$ are the row indices. We say a column $x\\in X$ of $M$ has a unique coordinate $i$ if for any other column $y\\in X$, $y\\neq x$, it holds that $y(i)\\neq x(i)$. If there is no confusion, we will not distinguish between a hash family and its representation matrix.\n\n    Next we will introduce the definition of IPP codes.\n\n    Let ${\\mathcal}{C}{\\subseteq} Y^N$ be a code of length $N$ and let $D{\\subseteq}{\\mathcal}{C}$ be a set of codewords. The set of descendants of $D$, denoted as $desc(D)$, is defined by\n\n    \n", "itemtype": "equation", "pos": 16051, "prevtext": " (see Theorem \\ref{optimal4} below). Two new notions in graph theory and additive number theory, namely rainbow cycles and $R$-sum-free sets, are introduced to prove this result. One can see that these two bounds suggest that there may be a positive answer to Question \\ref{nmid}.\n\n     \\subsection{Organization}\n\n    The rest of this paper is organised as follows. Section 2 is for some preparations. Theorem \\ref{recusivebd} is proved in Section 3 and Theorem \\ref{const} is proved in Section 4. The subsequent sections will focus on perfect hash families. We prove $q^{2-o(1)}<p_3(3,q)=o(q^2)$ in Section 5. As an application of the Johnson-type bound, this result will be extended to $p_t(t,q)$ and related separating hash families. We prove $q^{2-o(1)}<p_4(4,q)=o(q^2)$ in Section 6. In Section 7 we will build the connection between perfect hash families and a class of hypergraph Tur{\\'a}n problems. Section 8 is about some concluding remarks and open problems.\n\n    \\section{Preliminaries}\n\n    In this section, we will introduce some notations and terminology. We will also introduce some simple lemmas that will be used in the subsequent sections.\n\n    \\subsection{Separating hash families and IPP codes}\n\n    The matrix representation of a separating hash family is very useful when discussing its properties. An $(N;n,q)$-hash family can be described as an $N\\times n$ matrix on $q$ symbols, which will be usually denoted as $M$. The rows of $M$ correspond to the functions in the hash family and the columns of $M$ correspond to the elements of $X$.\n    The entry of $M$ in row $f\\in{\\mathcal}{F}$ and column $x\\in X$ is just $f(x)\\in Y.$ We denote the entry of $M$ as $M(f,x)$ for $f\\in{\\mathcal}{F}$, $x\\in X$ or $M(i,j)$ for $1\\le i\\le N$, $1\\le j\\le n$.\n\n    The matrix representation of an $SHF(N;n,q,\\{w_1,\\ldots,w_t\\})$ satisfies the following property: given disjoint sets of columns $C_1,\\ldots,C_t$, where $|C_i|=w_i$ for $1\\le i\\le t$, there exists a row $r$ of $M$ such that\n    \n", "index": 5, "text": "$$\\{M(r,x):~x\\in C_i\\}\\cap\\{M(r,x):~x\\in C_j\\}=\\emptyset$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"\\{M(r,x):~{}x\\in C_{i}\\}\\cap\\{M(r,x):~{}x\\in C_{j}\\}=\\emptyset\" display=\"block\"><mrow><mrow><mrow><mo stretchy=\"false\">{</mo><mrow><mi>M</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>r</mi><mo>,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo rspace=\"5.8pt\">:</mo><mrow><mi>x</mi><mo>\u2208</mo><msub><mi>C</mi><mi>i</mi></msub></mrow><mo stretchy=\"false\">}</mo></mrow><mo>\u2229</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mi>M</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>r</mi><mo>,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo rspace=\"5.8pt\">:</mo><mrow><mi>x</mi><mo>\u2208</mo><msub><mi>C</mi><mi>j</mi></msub></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><mo>=</mo><mi mathvariant=\"normal\">\u2205</mi></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n\n    \\noindent A set $D{\\subseteq}{\\mathcal}{C}$ is said to be a parent set of a word $d\\in Y^N$ if $d\\in desc(D)$. For $d\\in Y^N$, let ${\\mathcal}{P}_t(d)$ denote the collection of parent sets of $d$ such that $|D|\\le t$ and $D{\\subseteq}{\\mathcal}{C}$. Then we call ${\\mathcal}{C}{\\subseteq} Y^N$ a $t$-IPP code if for all $d\\in Y^N$, either ${\\mathcal}{P}_t(d)=\\emptyset$ or\n\n    \n", "itemtype": "equation", "pos": 17117, "prevtext": "\n    \\noindent for all $i\\neq j$. We say row $r$ separates a subset of columns $C{\\subseteq} X$ if $\\{M(r,x):x\\in C\\}$ has exactly $|C|$ distinct values in $Y$. The column $x$ of $M$ will be written as a $q$-ary vector of length $N$, $x=(x(1),x(2),\\ldots,x(N))$, where $x(i)\\in [q]$ for $i\\in[N]$. For a subset $L$ of the rows of $M$, the coordinates of $x$ restricted to $L$ give a word of length $|L|$, which is denoted as $x|_{L}=(x(i_1),x(i_2),\\ldots,x(i_{|L|}))$, where $i_j,~1\\le j\\le |L|$ are the row indices. We say a column $x\\in X$ of $M$ has a unique coordinate $i$ if for any other column $y\\in X$, $y\\neq x$, it holds that $y(i)\\neq x(i)$. If there is no confusion, we will not distinguish between a hash family and its representation matrix.\n\n    Next we will introduce the definition of IPP codes.\n\n    Let ${\\mathcal}{C}{\\subseteq} Y^N$ be a code of length $N$ and let $D{\\subseteq}{\\mathcal}{C}$ be a set of codewords. The set of descendants of $D$, denoted as $desc(D)$, is defined by\n\n    \n", "index": 7, "text": "$$desc(D)=\\{d\\in Y^N:for~all~i\\in\\{1,2,\\ldots,N\\},~d(i)=x(i)~for~some~x\\in D\\}.$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m1\" class=\"ltx_Math\" alttext=\"desc(D)=\\{d\\in Y^{N}:for~{}all~{}i\\in\\{1,2,\\ldots,N\\},~{}d(i)=x(i)~{}for~{}%&#10;some~{}x\\in D\\}.\" display=\"block\"><mrow><mrow><mrow><mi>d</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>s</mi><mo>\u2062</mo><mi>c</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>D</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mi>d</mi><mo>\u2208</mo><msup><mi>Y</mi><mi>N</mi></msup></mrow><mo>:</mo><mrow><mrow><mrow><mi>f</mi><mo>\u2062</mo><mi>o</mi><mo>\u2062</mo><mpadded width=\"+3.3pt\"><mi>r</mi></mpadded><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>l</mi><mo>\u2062</mo><mpadded width=\"+3.3pt\"><mi>l</mi></mpadded><mo>\u2062</mo><mi>i</mi></mrow><mo>\u2208</mo><mrow><mo stretchy=\"false\">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><mi>N</mi><mo stretchy=\"false\">}</mo></mrow></mrow><mo rspace=\"5.8pt\">,</mo><mrow><mrow><mi>d</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mi>x</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo rspace=\"5.8pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>f</mi><mo>\u2062</mo><mi>o</mi><mo>\u2062</mo><mpadded width=\"+3.3pt\"><mi>r</mi></mpadded><mo>\u2062</mo><mi>s</mi><mo>\u2062</mo><mi>o</mi><mo>\u2062</mo><mi>m</mi><mo>\u2062</mo><mpadded width=\"+3.3pt\"><mi>e</mi></mpadded><mo>\u2062</mo><mi>x</mi></mrow><mo>\u2208</mo><mi>D</mi></mrow></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n\n    \\subsection{Graph theory}\n\n    We will use the notion of Hamming graphs when constructing perfect hash families in Section 4. Let $k$ and $q$ be positive integers, the Hamming graph (see \\cite{algcomb} for details) $H(k,q)$ has the set of all $k$-tuples from an alphabet of $q$ symbols as its vertex set, and two $k$-tuples are adjacent if and only if they differ in exactly one coordinate position. This graph is also known as the $q$-ary hypercube of dimension $k$. Here we will fix this $q$-symbol alphabet set to be $[q]$.\n\n    When speaking about a hypergraph we mean a pair ${\\mathcal}{G}=(V({\\mathcal}{G}),E({\\mathcal}{G}))$, where the vertex set $V({\\mathcal}{G})$ is identified as the set of first integers $[n]$ and the edge set $E({\\mathcal}{G})$ is identified as a collection of subsets of $[n]$. ${\\mathcal}{G}$ is said to be linear if for all distinct $A,B\\in E({\\mathcal}{G})$ it holds that $|A \\cap B|\\le1$. We say ${\\mathcal}{G}$ is $r$-uniform if $|A|=r$ for all $A\\in E({\\mathcal}{G})$.\n\n    An $r$-uniform hypergraph ${\\mathcal}{G}$ is $r$-partite if its vertex set $V({\\mathcal}{G})$ can be colored in $r$ colors in such a way that no edge of ${\\mathcal}{G}$ contains two vertices of the same color. In such a coloring, the color classes of $V({\\mathcal}{G})$, the sets of all vertices of the same color, are called parts of ${\\mathcal}{G}$. In this paper we mainly concern $r$-uniform $r$-partite hypergraphs with equal part size $q$. We will see later that the edge set of such hypergraph is equivalent to an $r\\times|E({\\mathcal}{G})|$ matrix over a $q$-symbol alphabet.\n\n    Given a set ${\\mathcal}{H}$ of $r$-uniform hypergraphs, an ${\\mathcal}{H}$-free $r$-uniform hypergraph is a graph containing none of the members of ${\\mathcal}{H}$. The Tur{\\'a}n number $ex_r(n,{\\mathcal}{H})$ denotes the maximum number of edges in an ${\\mathcal}{H}$-free $r$-uniform hypergraph on $n$ vertices. In this paper, we will talk about several hypergraph Tur{\\'a}n problems.\n\n    Brown, Erd{\\H{o}}s and S{\\'o}s \\cite{bes1,bes2} introduced the function $f_r(n,v,e)$ to denote the maximum number of edges in an $r$-uniform hypergraph on $n$ vertices which does not contain $e$ edges spanned by $v$ vertices. In other words, in such hypergraphs the size of the union of arbitrary $e$ edges is at least $v+1$. These hypergraphs are called $G(v,e)$-free (more precisely, $G_r(v,e)$-free). The famous (6,3)-theorem of Ruzsa and Szemer{\\'e}di \\cite{RS} pointed out that\n\n    \n", "itemtype": "equation", "pos": 17582, "prevtext": "\n\n    \\noindent A set $D{\\subseteq}{\\mathcal}{C}$ is said to be a parent set of a word $d\\in Y^N$ if $d\\in desc(D)$. For $d\\in Y^N$, let ${\\mathcal}{P}_t(d)$ denote the collection of parent sets of $d$ such that $|D|\\le t$ and $D{\\subseteq}{\\mathcal}{C}$. Then we call ${\\mathcal}{C}{\\subseteq} Y^N$ a $t$-IPP code if for all $d\\in Y^N$, either ${\\mathcal}{P}_t(d)=\\emptyset$ or\n\n    \n", "index": 9, "text": "$$\\cap_{D\\in{\\mathcal}{P}_t(d)} D\\neq\\emptyset.$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m1\" class=\"ltx_Math\" alttext=\"\\cap_{D\\in{\\mathcal{}}{P}_{t}(d)}D\\neq\\emptyset.\" display=\"block\"><mrow><mrow><mrow><msub><mo>\u2229</mo><mrow><mi>D</mi><mo>\u2208</mo><mrow><msub><mi>P</mi><mi>t</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>d</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></msub><mi>D</mi></mrow><mo>\u2260</mo><mi mathvariant=\"normal\">\u2205</mi></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n    \n\n    \\noindent This was extended by Alon and Shapira \\cite{t=3} to\n\n    \n", "itemtype": "equation", "pos": 20116, "prevtext": "\n\n    \\subsection{Graph theory}\n\n    We will use the notion of Hamming graphs when constructing perfect hash families in Section 4. Let $k$ and $q$ be positive integers, the Hamming graph (see \\cite{algcomb} for details) $H(k,q)$ has the set of all $k$-tuples from an alphabet of $q$ symbols as its vertex set, and two $k$-tuples are adjacent if and only if they differ in exactly one coordinate position. This graph is also known as the $q$-ary hypercube of dimension $k$. Here we will fix this $q$-symbol alphabet set to be $[q]$.\n\n    When speaking about a hypergraph we mean a pair ${\\mathcal}{G}=(V({\\mathcal}{G}),E({\\mathcal}{G}))$, where the vertex set $V({\\mathcal}{G})$ is identified as the set of first integers $[n]$ and the edge set $E({\\mathcal}{G})$ is identified as a collection of subsets of $[n]$. ${\\mathcal}{G}$ is said to be linear if for all distinct $A,B\\in E({\\mathcal}{G})$ it holds that $|A \\cap B|\\le1$. We say ${\\mathcal}{G}$ is $r$-uniform if $|A|=r$ for all $A\\in E({\\mathcal}{G})$.\n\n    An $r$-uniform hypergraph ${\\mathcal}{G}$ is $r$-partite if its vertex set $V({\\mathcal}{G})$ can be colored in $r$ colors in such a way that no edge of ${\\mathcal}{G}$ contains two vertices of the same color. In such a coloring, the color classes of $V({\\mathcal}{G})$, the sets of all vertices of the same color, are called parts of ${\\mathcal}{G}$. In this paper we mainly concern $r$-uniform $r$-partite hypergraphs with equal part size $q$. We will see later that the edge set of such hypergraph is equivalent to an $r\\times|E({\\mathcal}{G})|$ matrix over a $q$-symbol alphabet.\n\n    Given a set ${\\mathcal}{H}$ of $r$-uniform hypergraphs, an ${\\mathcal}{H}$-free $r$-uniform hypergraph is a graph containing none of the members of ${\\mathcal}{H}$. The Tur{\\'a}n number $ex_r(n,{\\mathcal}{H})$ denotes the maximum number of edges in an ${\\mathcal}{H}$-free $r$-uniform hypergraph on $n$ vertices. In this paper, we will talk about several hypergraph Tur{\\'a}n problems.\n\n    Brown, Erd{\\H{o}}s and S{\\'o}s \\cite{bes1,bes2} introduced the function $f_r(n,v,e)$ to denote the maximum number of edges in an $r$-uniform hypergraph on $n$ vertices which does not contain $e$ edges spanned by $v$ vertices. In other words, in such hypergraphs the size of the union of arbitrary $e$ edges is at least $v+1$. These hypergraphs are called $G(v,e)$-free (more precisely, $G_r(v,e)$-free). The famous (6,3)-theorem of Ruzsa and Szemer{\\'e}di \\cite{RS} pointed out that\n\n    \n", "index": 11, "text": "\\begin{equation}\\label{1}\n        \\begin{aligned}\n            n^{2-o(1)}<f_3(n,6,3)=o(n^2).\n        \\end{aligned}\n    \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1X.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle n^{2-o(1)}&lt;f_{3}(n,6,3)=o(n^{2}).\" display=\"inline\"><mrow><mrow><msup><mi>n</mi><mrow><mn>2</mn><mo>-</mo><mrow><mi>o</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></msup><mo>&lt;</mo><mrow><msub><mi>f</mi><mn>3</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>n</mi><mo>,</mo><mn>6</mn><mo>,</mo><mn>3</mn><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mi>o</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n\n    \n\n    \\noindent These bounds will be used when considering problems about perfect hash families in the sequel. For more results on Tur{\\'a}n problems of this type, see \\cite{Furediconst} and the references therein.\n\n    The definitions of $f_r(n,v,e)$ can be restricted to the case for $r$-uniform $r$-partite hypergraphs with equal part size $q$. We use $f_r^*(q,v,e)$ to denote the corresponding formula. Note that $f_r^*(q,v,e)\\le f_r(rq,v,e)$.\n\n    In the literature, there are several definitions of hypergraph cycles. The one we use in this paper was introduced by Berge \\cite{hypercycle2,hypercycle1}. For $k\\ge2$, a cycle in a hypergraph ${\\mathcal}{G}$ is an alternating sequence of vertices and edges of the form $v_1,E_1,v_2,E_2,\\ldots,v_k,E_k,v_1$ such that\n\n    \\begin{itemize}\n      \\item [(a)]$v_1,v_2,\\ldots,v_k$ are distinct vertices of ${\\mathcal}{G}$,\n      \\item [(b)]$E_1,E_2,\\ldots,E_k$ are distinct edges of ${\\mathcal}{G}$,\n      \\item [(c)]$v_i,v_{i+1}\\in E_i$ for $1\\le i\\le k-1$ and $v_k,v_1\\in E_k$.\n    \\end{itemize}\n\n   \\noindent A $k$-cycle is called linear if the following two additional conditions hold\n   \\begin{itemize}\n     \\item [(d)]$|E_i\\cap E_j|\\neq\\emptyset$ if and only if $|i-j|\\le 1$ or $\\{i,j\\}=\\{1,k\\}$,\n     \\item [(e)]$|E_i\\cap E_{i+1}|=1$ for $1\\le i\\le k-1$ and $|E_k\\cap E_1|=1$.\n   \\end{itemize}\n\n    Next we will introduce the definition of rainbow cycles. Note that in the literature ``rainbow cycles\" always stand for edge-colorings, but in this paper we consider rainbow cycles due to vertex colorings. Given a hypergraph ${\\mathcal}{G}$ and a vertex-coloring of ${\\mathcal}{G}$, a subgraph ${\\mathcal}{H}{\\subseteq}{\\mathcal}{G}$ is called a rainbow subgraph of ${\\mathcal}{G}$ if all joint vertices in ${\\mathcal}{H}$ have different colors. In other words, for arbitrary distinct vertices $x,y\\in\\{A\\cap B:A,B\\in E({\\mathcal}{H})\\}$, $x$ and $y$ are colored by different colors. This definition is most meaningful when discussing linear hypergraphs. Let ${\\mathcal}{G}$ be an $r$-uniform $r$-partite linear hypergraph, a linear $k$-cycle $v_1,E_1,v_2,E_2,\\ldots,v_k,E_k,v_1$ is said to be a rainbow cycle of ${\\mathcal}{G}$ if $v_1,\\ldots,v_k$ locate in different parts of $V({\\mathcal}{G})$. For $r$-partite graphs, a rainbow $k$-cycle exists only if $k\\le r$.\n\n    Let ${\\mathcal}{G}$ be an $r$-uniform $r$-partite linear hypergraph with equal part size $q$. Assume that ${\\mathcal}{G}$ can not have rainbow cycles, then we use $g_r^*(q)$ to denote the maximal number of edges that can be contained in ${\\mathcal}{G}$. Lemma \\ref{rainbow1} shows that hypergraphs with large $g_r^*(q)$ can be used to construct good perfect hash families.\n\n    \\subsection{Additive number theory}\n        It has been showed in \\cite{ippe,Furediconst} that tools from additive number theory can be used to construct codes with some specified properties. We will introduce some notions from additive number theory.\n\n        Assume $m_1,m_2,m_3\\in M{\\subseteq}[q]$ and $c_1,c_2$ are positive integers such that $c_1+c_2\\le r$, we call the set $M$ $r$-sum-free if the equation \n", "itemtype": "equation", "pos": 20326, "prevtext": "\n    \n\n    \\noindent This was extended by Alon and Shapira \\cite{t=3} to\n\n    \n", "index": 13, "text": "\\begin{equation}\\label{2}\n        \\begin{aligned}\n            n^{k-o(1)}<f_r(n,3(r-k)+k+1,3)=o(n^k).\n        \\end{aligned}\n    \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2X.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle n^{k-o(1)}&lt;f_{r}(n,3(r-k)+k+1,3)=o(n^{k}).\" display=\"inline\"><mrow><mrow><msup><mi>n</mi><mrow><mi>k</mi><mo>-</mo><mrow><mi>o</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></msup><mo>&lt;</mo><mrow><msub><mi>f</mi><mi>r</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>n</mi><mo>,</mo><mrow><mrow><mn>3</mn><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>r</mi><mo>-</mo><mi>k</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mo>,</mo><mn>3</mn><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mi>o</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mi>k</mi></msup><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": " has no solution except the one with $m_1=m_2=m_3$. A result proved by Erd{\\H{o}}s, Frankl and R$\\ddot{o}$dl \\cite{erdos2} and Ruzsa \\cite{ruzsa} will be needed.\n\n        \\begin{lemma}{\\rm(\\cite{erdos2,ruzsa})}\\label{additive}\n        For arbitrary positive integer $r$ there exists a $\\gamma_r>0$ such that for any integer $q$, one can find an $r$-sum-free subset $M{\\subseteq}[q]$ with $|M|>qe^{-\\gamma_r\\sqrt{\\log q}}$.\n        \\end{lemma}\n\n        \\noindent Note that the case $r_1=r_2=1$ was originally proved by Behrend \\cite{Behrend}.\n\n        A linear equation with integer coefficients \n", "itemtype": "equation", "pos": -1, "prevtext": "\n\n    \n\n    \\noindent These bounds will be used when considering problems about perfect hash families in the sequel. For more results on Tur{\\'a}n problems of this type, see \\cite{Furediconst} and the references therein.\n\n    The definitions of $f_r(n,v,e)$ can be restricted to the case for $r$-uniform $r$-partite hypergraphs with equal part size $q$. We use $f_r^*(q,v,e)$ to denote the corresponding formula. Note that $f_r^*(q,v,e)\\le f_r(rq,v,e)$.\n\n    In the literature, there are several definitions of hypergraph cycles. The one we use in this paper was introduced by Berge \\cite{hypercycle2,hypercycle1}. For $k\\ge2$, a cycle in a hypergraph ${\\mathcal}{G}$ is an alternating sequence of vertices and edges of the form $v_1,E_1,v_2,E_2,\\ldots,v_k,E_k,v_1$ such that\n\n    \\begin{itemize}\n      \\item [(a)]$v_1,v_2,\\ldots,v_k$ are distinct vertices of ${\\mathcal}{G}$,\n      \\item [(b)]$E_1,E_2,\\ldots,E_k$ are distinct edges of ${\\mathcal}{G}$,\n      \\item [(c)]$v_i,v_{i+1}\\in E_i$ for $1\\le i\\le k-1$ and $v_k,v_1\\in E_k$.\n    \\end{itemize}\n\n   \\noindent A $k$-cycle is called linear if the following two additional conditions hold\n   \\begin{itemize}\n     \\item [(d)]$|E_i\\cap E_j|\\neq\\emptyset$ if and only if $|i-j|\\le 1$ or $\\{i,j\\}=\\{1,k\\}$,\n     \\item [(e)]$|E_i\\cap E_{i+1}|=1$ for $1\\le i\\le k-1$ and $|E_k\\cap E_1|=1$.\n   \\end{itemize}\n\n    Next we will introduce the definition of rainbow cycles. Note that in the literature ``rainbow cycles\" always stand for edge-colorings, but in this paper we consider rainbow cycles due to vertex colorings. Given a hypergraph ${\\mathcal}{G}$ and a vertex-coloring of ${\\mathcal}{G}$, a subgraph ${\\mathcal}{H}{\\subseteq}{\\mathcal}{G}$ is called a rainbow subgraph of ${\\mathcal}{G}$ if all joint vertices in ${\\mathcal}{H}$ have different colors. In other words, for arbitrary distinct vertices $x,y\\in\\{A\\cap B:A,B\\in E({\\mathcal}{H})\\}$, $x$ and $y$ are colored by different colors. This definition is most meaningful when discussing linear hypergraphs. Let ${\\mathcal}{G}$ be an $r$-uniform $r$-partite linear hypergraph, a linear $k$-cycle $v_1,E_1,v_2,E_2,\\ldots,v_k,E_k,v_1$ is said to be a rainbow cycle of ${\\mathcal}{G}$ if $v_1,\\ldots,v_k$ locate in different parts of $V({\\mathcal}{G})$. For $r$-partite graphs, a rainbow $k$-cycle exists only if $k\\le r$.\n\n    Let ${\\mathcal}{G}$ be an $r$-uniform $r$-partite linear hypergraph with equal part size $q$. Assume that ${\\mathcal}{G}$ can not have rainbow cycles, then we use $g_r^*(q)$ to denote the maximal number of edges that can be contained in ${\\mathcal}{G}$. Lemma \\ref{rainbow1} shows that hypergraphs with large $g_r^*(q)$ can be used to construct good perfect hash families.\n\n    \\subsection{Additive number theory}\n        It has been showed in \\cite{ippe,Furediconst} that tools from additive number theory can be used to construct codes with some specified properties. We will introduce some notions from additive number theory.\n\n        Assume $m_1,m_2,m_3\\in M{\\subseteq}[q]$ and $c_1,c_2$ are positive integers such that $c_1+c_2\\le r$, we call the set $M$ $r$-sum-free if the equation \n", "index": 15, "text": "$$c_1m_1+c_2m_2=(c_1+c_2)m_3$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex6.m1\" class=\"ltx_Math\" alttext=\"c_{1}m_{1}+c_{2}m_{2}=(c_{1}+c_{2})m_{3}\" display=\"block\"><mrow><mrow><mrow><msub><mi>c</mi><mn>1</mn></msub><mo>\u2062</mo><msub><mi>m</mi><mn>1</mn></msub></mrow><mo>+</mo><mrow><msub><mi>c</mi><mn>2</mn></msub><mo>\u2062</mo><msub><mi>m</mi><mn>2</mn></msub></mrow></mrow><mo>=</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>c</mi><mn>1</mn></msub><mo>+</mo><msub><mi>c</mi><mn>2</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>m</mi><mn>3</mn></msub></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": " in the unknowns $x_i$ is homogeneous if $\\sum_{i=1}^k a_i=0$. We say that $M{\\subseteq}[q]$ has no nontrivial solution to above equation, if whenever $m_i\\in M$ and $\\sum_{i=1}^k a_im_i=0$, it follows that all $m_i$'s are equal. Note that if $M$ has no nontrivial solution to above function, then the same holds for any shift $(M+x)\\cap[q]$ with $x\\in\\mathbb{Z}$, where $M+x:=\\{m+x:m\\in M\\}$. This property suggests that one can use probabilistic method to construct sets with no nontrivial solution to a system of homogeneous linear equations. Note that this definition of the nontrivial solution is a simplification of the original one of Ruzsa \\cite{ruzsa}.\n\n        Now we will generalize the definition of the $r$-sum-free set. Given a set $R=\\{b_1,\\ldots,b_r\\}$ of $r$ distinct nonnegative integers. A set $M$ is said to be $R$-sum-free if for any $3\\le k\\le r$ and any $k$-element subset $S=\\{b_{j_1},b_{j_2},\\ldots,b_{j_k}\\}{\\subseteq} R$, the equation\n        \n", "itemtype": "equation", "pos": -1, "prevtext": " has no solution except the one with $m_1=m_2=m_3$. A result proved by Erd{\\H{o}}s, Frankl and R$\\ddot{o}$dl \\cite{erdos2} and Ruzsa \\cite{ruzsa} will be needed.\n\n        \\begin{lemma}{\\rm(\\cite{erdos2,ruzsa})}\\label{additive}\n        For arbitrary positive integer $r$ there exists a $\\gamma_r>0$ such that for any integer $q$, one can find an $r$-sum-free subset $M{\\subseteq}[q]$ with $|M|>qe^{-\\gamma_r\\sqrt{\\log q}}$.\n        \\end{lemma}\n\n        \\noindent Note that the case $r_1=r_2=1$ was originally proved by Behrend \\cite{Behrend}.\n\n        A linear equation with integer coefficients \n", "index": 17, "text": "$$\\sum_{i=1}^k a_ix_i=0$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex7.m1\" class=\"ltx_Math\" alttext=\"\\sum_{i=1}^{k}a_{i}x_{i}=0\" display=\"block\"><mrow><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>\u2062</mo><msub><mi>x</mi><mi>i</mi></msub></mrow></mrow><mo>=</mo><mn>0</mn></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": " has no solution in $M$ except the trivial one $m_1=m_2=\\cdots=m_k$. The rank of $R$ is defined to be the maximal difference between the elements of $R$:\n        \n", "itemtype": "equation", "pos": -1, "prevtext": " in the unknowns $x_i$ is homogeneous if $\\sum_{i=1}^k a_i=0$. We say that $M{\\subseteq}[q]$ has no nontrivial solution to above equation, if whenever $m_i\\in M$ and $\\sum_{i=1}^k a_im_i=0$, it follows that all $m_i$'s are equal. Note that if $M$ has no nontrivial solution to above function, then the same holds for any shift $(M+x)\\cap[q]$ with $x\\in\\mathbb{Z}$, where $M+x:=\\{m+x:m\\in M\\}$. This property suggests that one can use probabilistic method to construct sets with no nontrivial solution to a system of homogeneous linear equations. Note that this definition of the nontrivial solution is a simplification of the original one of Ruzsa \\cite{ruzsa}.\n\n        Now we will generalize the definition of the $r$-sum-free set. Given a set $R=\\{b_1,\\ldots,b_r\\}$ of $r$ distinct nonnegative integers. A set $M$ is said to be $R$-sum-free if for any $3\\le k\\le r$ and any $k$-element subset $S=\\{b_{j_1},b_{j_2},\\ldots,b_{j_k}\\}{\\subseteq} R$, the equation\n        \n", "index": 19, "text": "$$(b_{j_2}-b_{j_1})m_1+(b_{j_3}-b_{j_2})m_2+\\cdots+(b_{j_k}-b_{j_{k-1}})m_{k-1}+(b_{j_1}-b_{j_k})m_k=0$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex8.m1\" class=\"ltx_Math\" alttext=\"(b_{j_{2}}-b_{j_{1}})m_{1}+(b_{j_{3}}-b_{j_{2}})m_{2}+\\cdots+(b_{j_{k}}-b_{j_{%&#10;k-1}})m_{k-1}+(b_{j_{1}}-b_{j_{k}})m_{k}=0\" display=\"block\"><mrow><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>b</mi><msub><mi>j</mi><mn>2</mn></msub></msub><mo>-</mo><msub><mi>b</mi><msub><mi>j</mi><mn>1</mn></msub></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>m</mi><mn>1</mn></msub></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>b</mi><msub><mi>j</mi><mn>3</mn></msub></msub><mo>-</mo><msub><mi>b</mi><msub><mi>j</mi><mn>2</mn></msub></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>m</mi><mn>2</mn></msub></mrow><mo>+</mo><mi mathvariant=\"normal\">\u22ef</mi><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>b</mi><msub><mi>j</mi><mi>k</mi></msub></msub><mo>-</mo><msub><mi>b</mi><msub><mi>j</mi><mrow><mi>k</mi><mo>-</mo><mn>1</mn></mrow></msub></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>m</mi><mrow><mi>k</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>b</mi><msub><mi>j</mi><mn>1</mn></msub></msub><mo>-</mo><msub><mi>b</mi><msub><mi>j</mi><mi>k</mi></msub></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>m</mi><mi>k</mi></msub></mrow></mrow><mo>=</mo><mn>0</mn></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n\n        We are interested in $R$-sum-free sets $M{\\subseteq}[q]$ with relatively small rank, namely, $r(R)=o(q^{\\epsilon})$ for arbitrary $\\epsilon>0$. Lemma \\ref{rainbow2} shows that  $R$-sum-free sets can be used to construct hypergraphs with large $g_r^*(q)$.\n\n\n        \\subsection{Some lemmas}\n\n     \n        \n        \n          \n          \n          \n          \n        \n     \n\n\n\n\n    The following lemma is a variant of a result of Erd{\\\"o}s and Kleitman \\cite{erdos-kleitman}.\n\n    \\begin{lemma}\\label{erdos-kleitman}\n        Every $r$-uniform hypergraph ${\\mathcal}{G}$ contains an $r$-uniform $r$-partite hypergraph ${\\mathcal}{H}$ with equal part size $q$ or $q+1$ such that\n        \n", "itemtype": "equation", "pos": 25475, "prevtext": " has no solution in $M$ except the trivial one $m_1=m_2=\\cdots=m_k$. The rank of $R$ is defined to be the maximal difference between the elements of $R$:\n        \n", "index": 21, "text": "$$r(R)=\\max_{1\\le i<j\\le r} |b_i-b_j|.$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex9.m1\" class=\"ltx_Math\" alttext=\"r(R)=\\max_{1\\leq i&lt;j\\leq r}|b_{i}-b_{j}|.\" display=\"block\"><mrow><mrow><mrow><mi>r</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>R</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munder><mi>max</mi><mrow><mn>1</mn><mo>\u2264</mo><mi>i</mi><mo>&lt;</mo><mi>j</mi><mo>\u2264</mo><mi>r</mi></mrow></munder><mo>\u2061</mo><mrow><mo stretchy=\"false\">|</mo><mrow><msub><mi>b</mi><mi>i</mi></msub><mo>-</mo><msub><mi>b</mi><mi>j</mi></msub></mrow><mo stretchy=\"false\">|</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n    \\end{lemma}\n\n    \\begin{proof}\n        Let $|V({\\mathcal}{G})|=n$, take $q$ to be the integer such that $rq\\le n<r(q+1)$. We only prove the lemma for $n=rq$, otherwise we can set the part size of the desired subgraph to be $q+1$. It suffices to find a partition $\\pi$ of $V({\\mathcal}{G})$ with $\\pi=\\{B_1,\\ldots,B_r\\}$ and $|B_i|=q$ for $1\\le i\\le r$, such that ${\\mathcal}{F}_{\\pi}=\\{A\\in E({\\mathcal}{G}):|A\\cap B_i|=1~for~all~1\\le i\\le r\\}$ contains the desired number of edges. Let $P({\\mathcal}{G})$ denote the collection of all appropriate partitions of $V({\\mathcal}{G})$. Let us count the number of the pairs\n        $N:=|\\{(A,\\pi):A\\in E({\\mathcal}{G}),~\\pi\\in P({\\mathcal}{G}),~|A\\cap B_i|=1~for~every~B_i\\in\\pi\\}|$. One can compute that any $A\\in E({\\mathcal}{G})$ is contained in ${\\frac}{|P({\\mathcal}{G})|\\cdot q^r}{\\binom{rq}{r}}$ members of $P({\\mathcal}{G})$ satisfying the desired property. Therefore, by double counting, there exists a $\\pi\\in P({\\mathcal}{G})$ such that ${\\mathcal}{F}_{\\pi}$ contains at least\n\n        \n", "itemtype": "equation", "pos": 26210, "prevtext": "\n\n        We are interested in $R$-sum-free sets $M{\\subseteq}[q]$ with relatively small rank, namely, $r(R)=o(q^{\\epsilon})$ for arbitrary $\\epsilon>0$. Lemma \\ref{rainbow2} shows that  $R$-sum-free sets can be used to construct hypergraphs with large $g_r^*(q)$.\n\n\n        \\subsection{Some lemmas}\n\n     \n        \n        \n          \n          \n          \n          \n        \n     \n\n\n\n\n    The following lemma is a variant of a result of Erd{\\\"o}s and Kleitman \\cite{erdos-kleitman}.\n\n    \\begin{lemma}\\label{erdos-kleitman}\n        Every $r$-uniform hypergraph ${\\mathcal}{G}$ contains an $r$-uniform $r$-partite hypergraph ${\\mathcal}{H}$ with equal part size $q$ or $q+1$ such that\n        \n", "index": 23, "text": "$${\\frac}{E({\\mathcal}{H})}{E({\\mathcal}{G})}\\ge{\\frac}{r!}{r^r}.$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex10.m1\" class=\"ltx_Math\" alttext=\"{\\frac{}}{E({\\mathcal{}}{H})}{E({\\mathcal{}}{G})}\\geq{\\frac{}}{r!}{r^{r}}.\" display=\"block\"><mrow><mrow><mrow><mfrac><mi/><mrow><mi>E</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>H</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac><mo>\u2062</mo><mi>E</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>G</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2265</mo><mrow><mfrac><mi/><mrow><mi>r</mi><mo lspace=\"0pt\" rspace=\"3.5pt\">!</mo></mrow></mfrac><mo>\u2062</mo><msup><mi>r</mi><mi>r</mi></msup></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n\n        \\noindent members of $E({\\mathcal}{G})$. Then this specified $\\pi$ will induce an $r$-uniform $r$-partite hypergraph ${\\mathcal}{H}$ containing the desired number of edges.\n    \\end{proof}\n\n    This lemma implies that for any $r$-uniform hypergraph ${\\mathcal}{G}$ with sufficiently large $|V({\\mathcal}{G})|$, there exists an $r$-partite subgraph ${\\mathcal}{H}{\\subseteq}{\\mathcal}{G}$ such that $|E({\\mathcal}{H})|$ and $|E({\\mathcal}{G})|$ are of the same order of magnitude. In other words, one can infer $f_r(rq,v,e)=\\Theta(f_r^*(q,v,e))$ by Lemma \\ref{erdos-kleitman}.\n\n    Another simple lemma will be used.\n\n    \\begin{lemma}\\label{treelemma}\n        Suppose $G$ is a finite graph with $n$ vertices. If $G$ has no cycles, then $G$ can have at most $n-1$ edges.\n     \\end{lemma}\n\n    \\begin{proof}\n       $G$ must have a vertex with degree one since every path in $G$ is finite and must have an end point. Choose a vertex in $G$ with degree one, then the statement follows trivially by applying induction on $|V|$.\n    \\end{proof}\n\n    With some reformulations, one can combine Lemma 3.2 and Corollary 3.3 of Alon, Fischer and Szegedy \\cite{ippe} to prove the following result:\n\n        \\begin{lemma}{\\rm(\\cite{ippe})}\\label{t=4p=4}\n            There exists a set $M{\\subseteq}\\{0,1,\\ldots,{\\lfloor} (q-1)/(\\mu+5){\\rfloor}\\}$ satisfying \n", "itemtype": "equation", "pos": 27323, "prevtext": "\n    \\end{lemma}\n\n    \\begin{proof}\n        Let $|V({\\mathcal}{G})|=n$, take $q$ to be the integer such that $rq\\le n<r(q+1)$. We only prove the lemma for $n=rq$, otherwise we can set the part size of the desired subgraph to be $q+1$. It suffices to find a partition $\\pi$ of $V({\\mathcal}{G})$ with $\\pi=\\{B_1,\\ldots,B_r\\}$ and $|B_i|=q$ for $1\\le i\\le r$, such that ${\\mathcal}{F}_{\\pi}=\\{A\\in E({\\mathcal}{G}):|A\\cap B_i|=1~for~all~1\\le i\\le r\\}$ contains the desired number of edges. Let $P({\\mathcal}{G})$ denote the collection of all appropriate partitions of $V({\\mathcal}{G})$. Let us count the number of the pairs\n        $N:=|\\{(A,\\pi):A\\in E({\\mathcal}{G}),~\\pi\\in P({\\mathcal}{G}),~|A\\cap B_i|=1~for~every~B_i\\in\\pi\\}|$. One can compute that any $A\\in E({\\mathcal}{G})$ is contained in ${\\frac}{|P({\\mathcal}{G})|\\cdot q^r}{\\binom{rq}{r}}$ members of $P({\\mathcal}{G})$ satisfying the desired property. Therefore, by double counting, there exists a $\\pi\\in P({\\mathcal}{G})$ such that ${\\mathcal}{F}_{\\pi}$ contains at least\n\n        \n", "index": 25, "text": "$${\\frac}{|E({\\mathcal}{G})|\\cdot|P({\\mathcal}{G})|\\cdot q^r/\\binom{rq}{r}}{|P({\\mathcal}{G})|}={\\frac}{|E({\\mathcal}{G})|\\cdot q^r}{\\binom{rq}{r}}$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex11.m1\" class=\"ltx_Math\" alttext=\"{\\frac{}}{|E({\\mathcal{}}{G})|\\cdot|P({\\mathcal{}}{G})|\\cdot q^{r}/\\binom{rq}{%&#10;r}}{|P({\\mathcal{}}{G})|}={\\frac{}}{|E({\\mathcal{}}{G})|\\cdot q^{r}}{\\binom{rq%&#10;}{r}}\" display=\"block\"><mrow><mrow><mfrac><mi/><mrow><mrow><mrow><mo stretchy=\"false\">|</mo><mrow><mi>E</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>G</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">|</mo></mrow><mo>\u22c5</mo><mrow><mo stretchy=\"false\">|</mo><mrow><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>G</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">|</mo></mrow><mo>\u22c5</mo><msup><mi>q</mi><mi>r</mi></msup></mrow><mo>/</mo><mrow><mo>(</mo><mfrac linethickness=\"0pt\"><mrow><mi>r</mi><mo>\u2062</mo><mi>q</mi></mrow><mi>r</mi></mfrac><mo>)</mo></mrow></mrow></mfrac><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mrow><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>G</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">|</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mi/><mrow><mrow><mo stretchy=\"false\">|</mo><mrow><mi>E</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>G</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">|</mo></mrow><mo>\u22c5</mo><msup><mi>q</mi><mi>r</mi></msup></mrow></mfrac><mo>\u2062</mo><mrow><mo>(</mo><mfrac linethickness=\"0pt\"><mrow><mi>r</mi><mo>\u2062</mo><mi>q</mi></mrow><mi>r</mi></mfrac><mo>)</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": " such that $M$ has no non-trivial solution to all the following equations\n\n        \n", "itemtype": "equation", "pos": -1, "prevtext": "\n\n        \\noindent members of $E({\\mathcal}{G})$. Then this specified $\\pi$ will induce an $r$-uniform $r$-partite hypergraph ${\\mathcal}{H}$ containing the desired number of edges.\n    \\end{proof}\n\n    This lemma implies that for any $r$-uniform hypergraph ${\\mathcal}{G}$ with sufficiently large $|V({\\mathcal}{G})|$, there exists an $r$-partite subgraph ${\\mathcal}{H}{\\subseteq}{\\mathcal}{G}$ such that $|E({\\mathcal}{H})|$ and $|E({\\mathcal}{G})|$ are of the same order of magnitude. In other words, one can infer $f_r(rq,v,e)=\\Theta(f_r^*(q,v,e))$ by Lemma \\ref{erdos-kleitman}.\n\n    Another simple lemma will be used.\n\n    \\begin{lemma}\\label{treelemma}\n        Suppose $G$ is a finite graph with $n$ vertices. If $G$ has no cycles, then $G$ can have at most $n-1$ edges.\n     \\end{lemma}\n\n    \\begin{proof}\n       $G$ must have a vertex with degree one since every path in $G$ is finite and must have an end point. Choose a vertex in $G$ with degree one, then the statement follows trivially by applying induction on $|V|$.\n    \\end{proof}\n\n    With some reformulations, one can combine Lemma 3.2 and Corollary 3.3 of Alon, Fischer and Szegedy \\cite{ippe} to prove the following result:\n\n        \\begin{lemma}{\\rm(\\cite{ippe})}\\label{t=4p=4}\n            There exists a set $M{\\subseteq}\\{0,1,\\ldots,{\\lfloor} (q-1)/(\\mu+5){\\rfloor}\\}$ satisfying \n", "index": 27, "text": "$$ |M|\\ge qe^{-\\gamma(\\log q)^{3/4}}$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex12.m1\" class=\"ltx_Math\" alttext=\"|M|\\geq qe^{-\\gamma(\\log q)^{3/4}}\" display=\"block\"><mrow><mrow><mo stretchy=\"false\">|</mo><mi>M</mi><mo stretchy=\"false\">|</mo></mrow><mo>\u2265</mo><mrow><mi>q</mi><mo>\u2062</mo><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>log</mi><mo>\u2061</mo><mi>q</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mn>3</mn><mo>/</mo><mn>4</mn></mrow></msup></mrow></mrow></msup></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n        \\noindent where $\\gamma$ is a constant and $\\mu={\\lceil} 2^{\\sqrt{\\log q}}{\\rceil}$.\n        \\end{lemma}\n\n        \\begin{proof}[Sketch of the proof]\n            Using the technique introduced in the proof of Lemma 3.2 of \\cite{ippe}, for $1\\le i\\le7$, one can prove that there exists a set\n            $M_i{\\subseteq}\\{0,1,\\ldots,{\\lfloor} (q-1)/(\\mu+5){\\rfloor}\\}$ and a constant $\\gamma_i$ satisfying \n", "itemtype": "equation", "pos": 28948, "prevtext": " such that $M$ has no non-trivial solution to all the following equations\n\n        \n", "index": 29, "text": "\\begin{equation}\\label{3}\n          \\left\\{\n            \\begin{aligned}\n                &2m_1+3m_2+\\mu m_3-(\\mu+5)m_4&=0\\\\\n                &5m_1+(\\mu+3)m_2-3m_3-(\\mu+5)m_4&=0\\\\\n                &5m_1+\\mu m_2-2m_3-(\\mu+3)m_4&=0\\\\\n                &2m_1+3m_2-5m_3 &=0\\\\\n                &5m_1+\\mu m_2-(\\mu+5)m_3 &=0\\\\\n                &2m_1+(\\mu+3)m_2-(\\mu+5)m_3 &=0\\\\\n                &3m_1+\\mu m_2-(\\mu+3)m_3 &=0\\\\\n            \\end{aligned}\n          \\right.\n        \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"\\left\\{\\begin{aligned} &amp;\\displaystyle 2m_{1}+3m_{2}+\\mu m_{3}-(\\mu+5)m_{4}&amp;%&#10;\\hskip 10.0pt=0\\\\&#10;&amp;\\displaystyle 5m_{1}+(\\mu+3)m_{2}-3m_{3}-(\\mu+5)m_{4}&amp;\\hskip 10.0pt=0\\\\&#10;&amp;\\displaystyle 5m_{1}+\\mu m_{2}-2m_{3}-(\\mu+3)m_{4}&amp;\\hskip 10.0pt=0\\\\&#10;&amp;\\displaystyle 2m_{1}+3m_{2}-5m_{3}&amp;\\hskip 10.0pt=0\\\\&#10;&amp;\\displaystyle 5m_{1}+\\mu m_{2}-(\\mu+5)m_{3}&amp;\\hskip 10.0pt=0\\\\&#10;&amp;\\displaystyle 2m_{1}+(\\mu+3)m_{2}-(\\mu+5)m_{3}&amp;\\hskip 10.0pt=0\\\\&#10;&amp;\\displaystyle 3m_{1}+\\mu m_{2}-(\\mu+3)m_{3}&amp;\\hskip 10.0pt=0\\\\&#10;\\end{aligned}\\right.\" display=\"block\"><mrow><mo>{</mo><mtable columnspacing=\"0pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd/><mtd columnalign=\"left\"><mrow><mrow><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>m</mi><mn>1</mn></msub></mrow><mo>+</mo><mrow><mn>3</mn><mo>\u2062</mo><msub><mi>m</mi><mn>2</mn></msub></mrow><mo>+</mo><mrow><mi>\u03bc</mi><mo>\u2062</mo><msub><mi>m</mi><mn>3</mn></msub></mrow></mrow><mo>-</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03bc</mi><mo>+</mo><mn>5</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>m</mi><mn>4</mn></msub></mrow></mrow></mtd><mtd columnalign=\"left\"><mrow><mi/><mo lspace=\"12.5pt\">=</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mrow><mrow><mn>5</mn><mo>\u2062</mo><msub><mi>m</mi><mn>1</mn></msub></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03bc</mi><mo>+</mo><mn>3</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>m</mi><mn>2</mn></msub></mrow></mrow><mo>-</mo><mrow><mn>3</mn><mo>\u2062</mo><msub><mi>m</mi><mn>3</mn></msub></mrow><mo>-</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03bc</mi><mo>+</mo><mn>5</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>m</mi><mn>4</mn></msub></mrow></mrow></mtd><mtd columnalign=\"left\"><mrow><mi/><mo lspace=\"12.5pt\">=</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mrow><mrow><mn>5</mn><mo>\u2062</mo><msub><mi>m</mi><mn>1</mn></msub></mrow><mo>+</mo><mrow><mi>\u03bc</mi><mo>\u2062</mo><msub><mi>m</mi><mn>2</mn></msub></mrow></mrow><mo>-</mo><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>m</mi><mn>3</mn></msub></mrow><mo>-</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03bc</mi><mo>+</mo><mn>3</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>m</mi><mn>4</mn></msub></mrow></mrow></mtd><mtd columnalign=\"left\"><mrow><mi/><mo lspace=\"12.5pt\">=</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mrow><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>m</mi><mn>1</mn></msub></mrow><mo>+</mo><mrow><mn>3</mn><mo>\u2062</mo><msub><mi>m</mi><mn>2</mn></msub></mrow></mrow><mo>-</mo><mrow><mn>5</mn><mo>\u2062</mo><msub><mi>m</mi><mn>3</mn></msub></mrow></mrow></mtd><mtd columnalign=\"left\"><mrow><mi/><mo lspace=\"12.5pt\">=</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mrow><mrow><mn>5</mn><mo>\u2062</mo><msub><mi>m</mi><mn>1</mn></msub></mrow><mo>+</mo><mrow><mi>\u03bc</mi><mo>\u2062</mo><msub><mi>m</mi><mn>2</mn></msub></mrow></mrow><mo>-</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03bc</mi><mo>+</mo><mn>5</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>m</mi><mn>3</mn></msub></mrow></mrow></mtd><mtd columnalign=\"left\"><mrow><mi/><mo lspace=\"12.5pt\">=</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mrow><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>m</mi><mn>1</mn></msub></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03bc</mi><mo>+</mo><mn>3</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>m</mi><mn>2</mn></msub></mrow></mrow><mo>-</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03bc</mi><mo>+</mo><mn>5</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>m</mi><mn>3</mn></msub></mrow></mrow></mtd><mtd columnalign=\"left\"><mrow><mi/><mo lspace=\"12.5pt\">=</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mrow><mrow><mn>3</mn><mo>\u2062</mo><msub><mi>m</mi><mn>1</mn></msub></mrow><mo>+</mo><mrow><mi>\u03bc</mi><mo>\u2062</mo><msub><mi>m</mi><mn>2</mn></msub></mrow></mrow><mo>-</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03bc</mi><mo>+</mo><mn>3</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>m</mi><mn>3</mn></msub></mrow></mrow></mtd><mtd columnalign=\"left\"><mrow><mi/><mo lspace=\"12.5pt\">=</mo><mn>0</mn></mrow></mtd></mtr></mtable></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": " such that $M_i$ has no nontrivial solution to the $i$-th equation in the above system. In order to prove the existence of the set $M$ which has no nontrivial solution to all equations, we can apply a probabilistic method. Take six integers $x_i$ such that $-{\\lfloor} (q-1)/(\\mu+5){\\rfloor}\\le x_i\\le {\\lfloor} (q-1)/(\\mu+5){\\rfloor}$, $2\\le i\\le 7$, randomly, uniformly and independently. $M=M_1\\cap(M_2+x_2)\\cap\\cdots\\cap(M_7+x_7)$ has no nontrivial solution to any of the above equations. Since $M_i+x_i\\in[-{\\lfloor} (q-1)/(\\mu+5){\\rfloor},2{\\lfloor} (q-1)/(\\mu+5){\\rfloor}]$ for each $2\\le i\\le 7$, then one can compute that every $m\\in M_1$ has probability at least $e^{-\\sum_{i=2}^7 \\gamma_i(\\log q)^{3/4}}$ to lie in the intersection. Therefore, the result follows from the linearity of the expectation, where $|M|\\ge qe^{-\\gamma(\\log q)^{3/4}}$ with $\\gamma\\le\\sum_{i=1}^7 \\gamma_i$.\n        \\end{proof}\n\n    \\section{A Johnson-type upper bound}\n\n   The aim of this section is to establish a Johnson-type bound for separating hash families and we will use it to prove Theorem \\ref{recusivebd}. To establish this bound, the idea is to delete some rows and corresponding carefully chosen columns from the representation matrix of the separating hash family. Our goal is to show the remaining submatrix satisfies some weaker separating property. This is also where the name ``Johnson-type bound\" comes from. Note that we always use $M$ to denote the representation matrix of a separating hash family.\n\n    \\begin{lemma} \\label{technical}\n        Let $1\\le l\\le N$ be a positive integer, then it holds that $C(N,q,\\{w_1,...,w_t\\})\\le q^l+\\max\\{u-1,C(N-l,q,\\{w_1-1,...,w_t\\})\\}$. In fact, in the right hand side of the inequality we can choose the minus of 1 to be after arbitrary $w_i,~1\\le i\\le t$.\n    \\end{lemma}\n\n  \\begin{proof}\n      Choose arbitrary $l$ rows of $M$ and let $L$ denote the collection of these chosen rows. Denote ${\\mathcal}{A}{\\subseteq} Y^l$ the maximal collection of columns whose restrictions to $L$ are all distinct (we just choose one column if there are several columns with the same restrictions to $L$). It is easy to see $|{\\mathcal}{A}|\\le q^l$ since there are at most $q^l$ distinct words of length $l$. Delete these $l$ rows and the columns contained in ${\\mathcal}{A}$ from $M$. Let $M'$ denote the remaining submatrix. Then $M'$ is a $q$-ary $(N-l)\\times(n-|{\\mathcal}{A}|)$ matrix. If $n-|{\\mathcal}{A}|\\le u-1$, we are done. Otherwise it suffices to show $M'$ is a representation matrix of a separating hash family of type $\\{w_1,\\ldots,w_i-1,\\ldots,w_t\\}$ for arbitrary $1\\le i\\le t$.\n\n      Assume the contrary, $M'$ is not $\\{w_1,\\ldots,w_i-1,\\ldots,w_t\\}$-separating for some $1\\le i\\le t$. Without loss of generality, we set $i=1$. Then there exist $t$ subsets $C_1,\\ldots,C_t$ of the columns of $M'$ with $|C_1|=w_1-1$ and $|C_i|=w_i$ for $2\\le i\\le t$, such that no row of $M'$ can separate $C_1,\\ldots,C_t$. Let $c$ be an arbitrary column of $C_2$ and let $c'$ be a column in ${\\mathcal}{A}$ such that $c'|_{L}=c|_{L}$. Such $c'\\in{\\mathcal}{A}$ must exist by our definition of ${\\mathcal}{A}$. Consequently, no row can separate $C_1\\cup\\{c'\\},C_2,\\ldots,C_t$ in the original matrix $M$, which contradicts the fact that $M$ is $\\{w_1,\\ldots,w_t\\}$-separating. Thus $M'$ satisfies the desired separating property and the lemma follows from $n-|{\\mathcal}{A}|\\le C(N-l,q,\\{w_1-1,...,w_t\\}$ and $|{\\mathcal}{A}|\\le q^l$.\n \\end{proof}\n\n    \\begin{remark}\n        This lemma is obviously an extension of Lemma 2 of \\cite{Trung2011}. We think this Johnson-type bound is very interesting and important since it points out the information hidden in the structure of separating hash families.\n    \\end{remark}\n\n    As the first application of Lemma \\ref{technical}, we will use it to prove Theorem \\ref{recusivebd}.\n    \n        \n        \n    \n    Note that we can omit the constraint $C(\\lfloor N/(u-1)\\rfloor,q,\\{w_1,\\ldots,w_t\\})\\ge u$ in the theorem by introducing a maximum term in the expression of the upper bound (just as the case in Lemma \\ref{technical}). And $C(\\lfloor N/(u-1)\\rfloor,q,\\{w_1,\\ldots,w_t\\})\\ge u$ always holds for $N\\ge u-1$ and sufficiently large $q$, for example, $q\\ge u$.\n\n  \\begin{proof}[\\textbf{Proof of Theorem \\ref{recusivebd}}]\n      One can verify that $N=r\\lceil N/(u-1)\\rceil+(u-1-r)\\lfloor N/(u-1)\\rfloor$. We apply Lemma \\ref{technical} repeatedly for $u-1$ times, in which $l$ is chosen to be $\\lceil N/(u-1)\\rceil$ ($r$ times) and $\\lfloor N/(u-1)\\rfloor$ ($u-1-r$ times), respectively. \n      The theorem follows from a simple fact that $C(0,q,\\{1\\})=0$.\n \\end{proof}\n\n     \\begin{remark}\n        It is not hard to see our bound is an improvement of Theorem \\ref{shf0}, and hence an improvement of \\cite{Trung2011,blackburn08}. One can see $\\lceil N/(u-1)\\rceil$ is the best exponential term that can be obtained by our method, since to reduce the exponential term, one should reduce the maximum value of $l$ involved in the deletions. In other words, we should find a finer partition of $[N]$ and hence more deletion rounds are needed. However, at most $(u-1)$ deletion rounds can be used, because $C(N,q,\\{w_1,\\ldots,w_t\\})$ can be arbitrary large if $t=1$ and $N>0$.\n     \\end{remark}\n\n     \\begin{remark}\n        Since the frameproof code is a special class of separating hash families, it is not surprising to see our bound contains Theorem 1 of \\cite{BL03} as a special case. By Constructions 2 and 3 in \\cite{BL03}, one can find that Theorem \\ref{recusivebd} is asymptotically optimal when $q\\ge N$, $\\{w_1,\\ldots,w_t\\}=\\{1,w\\}$, $N\\equiv 1 \\pmod{w}$, or $q=\\Omega(N^2)$, $\\{w_1,\\ldots,w_t\\}=\\{1,2\\}$. The following section presents a construction which shows Theorem \\ref{recusivebd} is also asymptotically optimal when $N=u-1$.\n     \\end{remark}\n\n\n\n\\section{A construction for $t$-perfect hash families with $t-1$ rows}\n\n    The aim of this section is to present a construction for $PHF(N;Nq^{N-1},q^{N-1}+(N-1)q^{N-2},N+1)$ for arbitrary positive integer $q\\ge2$ and $N\\ge 2$.\n\n    One nice feature of our construction is that it is a generalization of many previous ones. When $N=2$, the construction of $PHF(2;2q,q+1,3)$ has appeared in \\cite{N=2first,N=3t=3}. And when $N=3$, the construction of $PHF(3;3q^2,q^2+2q,4)$ has appeared in numerous papers, for example, Hollmann et al. \\cite{ipp}, Blackburn \\cite{BL03perfect}, Stinson et al. \\cite{ST08} and Bazrafshan et al. \\cite{Trung2011}.\n\n\n   Let us begin with $N=3$ as a simple example to illustrate our idea.\n\n    \\begin{example}{\\rm(\\cite{Trung2011,BL03perfect,ipp,ST08})}\n        There exists a $PHF(3;3q^2,q^2+2q,4)$ for any integer $q\\ge 2$.\n    \\end{example}\n\n     \\begin{proof}\n        We first construct a $3\\times q^2$ submatrix, in which the alphabet set is the $(q^2+2q)$-element set defined as $\\{(x,y),(x,0),(0,y):1\\le x,y\\le q,~x,y\\in\\mathbb{Z} \\}$,\n\n        \\begin{center}\n        $\\left(\n            \\begin{array}{cccccccccccccccccccccccccccccccc}\n              (1,1) & (1,2) & \\cdots & (1,q) & (2,1) & \\cdots & (2,q) & \\cdots & (q,1) & \\cdots & (q,q) \\\\\n              (0,1) & (0,2) & \\cdots & (0,q) & (0,1) & \\cdots & (0,q) & \\cdots & (0,1) & \\cdots & (0,q) \\\\\n              (1,0) & (1,0) & \\cdots & (1,0) & (2,0) & \\cdots & (2,0) & \\cdots & (q,0) & \\cdots & (q,0) \\\\\n            \\end{array}\n        \\right)$.\n        \\end{center}\n\n        \\noindent We denote the three rows of this submatrix as $A_0,~A_1,~A_2$, respectively.\n        Then the representation matrix of the desired perfect hash family can be presented as follows:\n\n        \\begin{center}\n        $\\left(\n              \\begin{array}{ccc}\n                A_0 & A_2 & A_1 \\\\\n                A_1 & A_0 & A_2 \\\\\n                A_2 & A_1 & A_0 \\\\\n              \\end{array}\n        \\right).$\n        \\end{center}\n\n        \\noindent We can easily see it is a $3\\times 3q^2$ matrix over an alphabet of size $q^2+2q$. One can verify (or see the proof of Theorem \\ref{const} below) that it is indeed a representation matrix of a 4-perfect hash family.\n    \\end{proof}\n\n\n     In the above matrix $A_0$ acts like an identity map that preserves each element in $\\{(x,y):1\\le x,y \\le q,~x,y\\in\\mathbb{Z}\\}$, while $A_i$, $i=1,~2$, acts like a projection that projects the $i$-th entry of $(x,y)$ to zero. Actually, the idea behind this simple construction can be generalized.\n\n     \n\n     Recall the definition of the Hamming graphs in Section 2. Take a $q$-ary hypercube ${\\mathcal}{A}$ of dimension $k$, then $|{\\mathcal}{A}|=q^k$. For $1\\leq i\\le k$ and arbitrary $\\alpha=(\\alpha(1),\\ldots,\\alpha(k))\\in{\\mathcal}{A}$, define $\\pi_i$ to be the map that sets $\\alpha(i)$ into zero but preserves all other coordinates of $\\alpha$. We say $\\pi_i$ separates a set $S{\\subseteq}{\\mathcal}{A}$ if $\\pi_i(\\alpha)\\neq\\pi_i(\\beta)$ for arbitrary distinct $\\alpha,~\\beta\\in S$. Proposition 1 of \\cite{BL03perfect} establishes an important property of these maps. We present the proof here for the sake of reader's convenience.\n\n    \\begin{lemma}{\\rm(\\cite{BL03perfect})}{\\label{construction}}\n        Let $S{\\subseteq}{\\mathcal}{A}$ be an arbitrary $t$-element subset with $t\\le k$, then $S$ is separated by at least $k-t+1$ of the functions $\\pi_1,\\ldots,\\pi_k$.\n    \\end{lemma}\n\n    \\begin{proof}\n        Assume the contrary. Without loss of generality, let $S=\\{\\alpha_1,\\ldots,\\alpha_t\\}$ and let $\\pi_1,\\ldots,\\pi_t$ be the $t$ functions which can not separate $S$. Define a colored graph $G=(V,E)$ by $V=S$ and connect $\\alpha,\\beta\\in V$ by an edge of color $i$ if $\\pi_i(\\alpha)=\\pi_i(\\beta)$. Note that graph $G$ is a subgraph of a Hamming graph. Since $\\pi_1,\\ldots,\\pi_t$ can not separate $S$, then for every $i\\in[t]$, there exist $1\\le j<l\\le t$ such that $\\pi_i(\\alpha_j)=\\pi_i(\\alpha_l)$. So $G$ contains a subgraph $G^{'}=(V,E^{'})$ with $t$ vertices and $t$ edges of distinct colors. By Lemma \\ref{treelemma} we can deduce that $G^{'}$ contains a cycle which can be denoted as $(\\alpha_1,\\alpha_2,\\ldots,\\alpha_c)$, where $c$ is an integer such that $1\\leq c\\leq t$.\n\n        We are done if we can show such cycle must not exist. Assume that the edge between $\\alpha_1$ and $\\alpha_2$ is colored by the $i$-th color. Then $\\alpha_1$ and $\\alpha_2$ must differ in their $i$-th coordinate. Since every edge in this cycle is of distinct color and every pair of connected vertices differ in exactly one coordinate, then for every $j\\in\\{2,3,\\ldots,c\\}$, $\\alpha_j$ and $\\alpha_{j+1}$ must agree in their $i$-th coordinate. In particular, $\\alpha_{c+1}$ is recognised as $\\alpha_1$, which implies that $\\alpha_2(i)=\\alpha_3(i)=\\ldots=\\alpha_c(i)=\\alpha_1(i)$. Thus the desired contradiction follows.\n    \\end{proof}\n\n    The following lemma is an easy consequence of above lemma.\n\n    \\begin{lemma}\\label{lastlemma}\n        Let $\\pi_i~(1\\le i\\le k)$ be the functions defined as above and let $\\pi_0$ denote the identity map which satisfies $\\pi_0(\\alpha)=\\alpha$ for every $\\alpha\\in{\\mathcal}{A}$. Suppose $S{\\subseteq}{\\mathcal}{A}$ is a $t$-element subset with $t\\le k+1$, then at most $t-1$ of the functions $\\pi_0,\\pi_1,\\ldots,\\pi_k$ can not separate $S$.\n    \\end{lemma}\n\n    \\begin{proof}\n        Apply Lemma \\ref{construction} and remember the fact that $\\pi_0$ separates every subset of ${\\mathcal}{A}$.\n    \\end{proof}\n\n    \n\n     \n        \n    \n\n    Now we can prove Theorem \\ref{const}.\n\n    \\begin{proof}[\\textbf{Proof of Theorem \\ref{const}}]\n\n        Take a $q$-ary hypercube ${\\mathcal}{A}$ of dimension $N-1$. Obviously $|{\\mathcal}{A}|=q^{N-1}$. Let $\\pi_0,\\pi_1,\\ldots,\\pi_{N-1}$ be the maps defined as above. Then our desired perfect hash family can be represented as the following matrix\n\n        \\begin{center}\n\n        $\\left(\n          \\begin{array}{ccccc}\n            \\pi_0({\\mathcal}{A})     & \\pi_{N-1}({\\mathcal}{A}) & \\cdots & \\cdots & \\pi_1({\\mathcal}{A}) \\\\\n            \\pi_1({\\mathcal}{A})     & \\pi_0({\\mathcal}{A})     & \\cdots & \\cdots & \\pi_2({\\mathcal}{A}) \\\\\n            \\vdots       & \\vdots       & \\ddots &        & \\vdots   \\\\\n            \\vdots       & \\vdots       &        & \\ddots & \\vdots   \\\\\n            \\pi_{N-1}({\\mathcal}{A}) & \\pi_{N-2}({\\mathcal}{A}) & \\cdots & \\cdots & \\pi_0({\\mathcal}{A}) \\\\\n          \\end{array}\n        \\right)$,\n\n        \\end{center}\n\n        \\noindent where for every $0\\le i\\le N-1$, $\\pi_i({\\mathcal}{A}):=(\\pi_i(\\alpha))_{\\alpha\\in{\\mathcal}{A}}$ is a $1\\times|{\\mathcal}{A}|$ submatrix. Denote this representation matrix as $M$, then $M$ is an $N\\times Nq^{N-1}$ matrix. Let $Y=\\cup_{i=0}^{N-1}\\pi_i({\\mathcal}{A})$ denote the alphabet set. It is not hard to see $|\\{\\pi_0(\\alpha):\\alpha\\in{\\mathcal}{A}\\}|=q^{N-1}$ and $|\\{\\pi_i(\\alpha):\\alpha\\in{\\mathcal}{A}\\}|=q^{N-2}$ for every $1\\le i\\le N-1$. Then one can verify that $|Y|=q^{N-1}+(N-1)q^{N-2}$. Thus we can conclude that $M$ is the representation matrix of an $(N;Nq^{N-1},q^{N-1}+(N-1)q^{N-2})$-hash family.\n\n        Now it remains to verify that this hash family is indeed an $(N+1)$-perfect hash family. Consider $M$ as the  concatenation of $N$ column patterns denoted as $(C_1|C_2|\\cdots|C_N)$ with $|C_1|=|C_2|=\\cdots=|C_N|=q^{N-1}$. Take an arbitrary $(N+1)$-subset $S$ of the columns of $M$. We are going to show that there must exist a row of $M$ that separates $S$. If $S{\\subseteq} C_i$ for some $1\\le i\\le N$, then the $i$-th row of $C_i$, which corresponds to $\\pi_0$, can separate $S$, since $\\pi_0(\\alpha)\\neq\\pi_0(\\beta)$ for arbitrary distinct $\\alpha,~\\beta\\in{\\mathcal}{A}$. Otherwise, let $C_{i_1},\\ldots,C_{i_j}$ be the column patterns which have non-empty intersection with $S$, where $j\\ge 2$ is a positive integer. For $1\\le l\\le j$, denote $C_{i_l}\\cap S=S_l$. Then $\\sum_{l=1}^{j}|S_l|=N+1$ and $|S_l|\\le N$ for every $l$. By Lemma \\ref{lastlemma}, at most $|S_l|-1$ rows of $C_{i_l}$ can not separate $S_l$. Since $\\sum_{l=1}^{j}(|S_l|-1)=N+1-l\\le N+1-2=N-1<N$, then there must exist a row of $(C_1|C_2|\\cdots|C_N)$ that separates $\\cup_{i=1}^{l} S_l=S$.\n\n\n    \\end{proof}\n\n    \\begin{remark}\n        Our construction has an important property that it satisfies\n\n        \n", "itemtype": "equation", "pos": -1, "prevtext": "\n        \\noindent where $\\gamma$ is a constant and $\\mu={\\lceil} 2^{\\sqrt{\\log q}}{\\rceil}$.\n        \\end{lemma}\n\n        \\begin{proof}[Sketch of the proof]\n            Using the technique introduced in the proof of Lemma 3.2 of \\cite{ippe}, for $1\\le i\\le7$, one can prove that there exists a set\n            $M_i{\\subseteq}\\{0,1,\\ldots,{\\lfloor} (q-1)/(\\mu+5){\\rfloor}\\}$ and a constant $\\gamma_i$ satisfying \n", "index": 31, "text": "$$ |M_i|\\ge qe^{-\\gamma_i(\\log q)^{3/4}}$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex13.m1\" class=\"ltx_Math\" alttext=\"|M_{i}|\\geq qe^{-\\gamma_{i}(\\log q)^{3/4}}\" display=\"block\"><mrow><mrow><mo stretchy=\"false\">|</mo><msub><mi>M</mi><mi>i</mi></msub><mo stretchy=\"false\">|</mo></mrow><mo>\u2265</mo><mrow><mi>q</mi><mo>\u2062</mo><msup><mi>e</mi><mrow><mo>-</mo><mrow><msub><mi>\u03b3</mi><mi>i</mi></msub><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>log</mi><mo>\u2061</mo><mi>q</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mn>3</mn><mo>/</mo><mn>4</mn></mrow></msup></mrow></mrow></msup></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n\n        \\noindent and hence it is asymptotically optimal since we have $p_{N+1}(N,q)\\le Nq$ by Theorem \\ref{recusivebd}. Note that a $u$-perfect hash family is $\\{w_1,\\ldots,w_t\\}$-separating for arbitrary $w_i$ such that $w_i\\ge1$ and $\\sum_{i=1}^t w_i=u$. Theorems \\ref{recusivebd} and \\ref{const} can be combined to show\n\n        \n", "itemtype": "equation", "pos": 44044, "prevtext": " such that $M_i$ has no nontrivial solution to the $i$-th equation in the above system. In order to prove the existence of the set $M$ which has no nontrivial solution to all equations, we can apply a probabilistic method. Take six integers $x_i$ such that $-{\\lfloor} (q-1)/(\\mu+5){\\rfloor}\\le x_i\\le {\\lfloor} (q-1)/(\\mu+5){\\rfloor}$, $2\\le i\\le 7$, randomly, uniformly and independently. $M=M_1\\cap(M_2+x_2)\\cap\\cdots\\cap(M_7+x_7)$ has no nontrivial solution to any of the above equations. Since $M_i+x_i\\in[-{\\lfloor} (q-1)/(\\mu+5){\\rfloor},2{\\lfloor} (q-1)/(\\mu+5){\\rfloor}]$ for each $2\\le i\\le 7$, then one can compute that every $m\\in M_1$ has probability at least $e^{-\\sum_{i=2}^7 \\gamma_i(\\log q)^{3/4}}$ to lie in the intersection. Therefore, the result follows from the linearity of the expectation, where $|M|\\ge qe^{-\\gamma(\\log q)^{3/4}}$ with $\\gamma\\le\\sum_{i=1}^7 \\gamma_i$.\n        \\end{proof}\n\n    \\section{A Johnson-type upper bound}\n\n   The aim of this section is to establish a Johnson-type bound for separating hash families and we will use it to prove Theorem \\ref{recusivebd}. To establish this bound, the idea is to delete some rows and corresponding carefully chosen columns from the representation matrix of the separating hash family. Our goal is to show the remaining submatrix satisfies some weaker separating property. This is also where the name ``Johnson-type bound\" comes from. Note that we always use $M$ to denote the representation matrix of a separating hash family.\n\n    \\begin{lemma} \\label{technical}\n        Let $1\\le l\\le N$ be a positive integer, then it holds that $C(N,q,\\{w_1,...,w_t\\})\\le q^l+\\max\\{u-1,C(N-l,q,\\{w_1-1,...,w_t\\})\\}$. In fact, in the right hand side of the inequality we can choose the minus of 1 to be after arbitrary $w_i,~1\\le i\\le t$.\n    \\end{lemma}\n\n  \\begin{proof}\n      Choose arbitrary $l$ rows of $M$ and let $L$ denote the collection of these chosen rows. Denote ${\\mathcal}{A}{\\subseteq} Y^l$ the maximal collection of columns whose restrictions to $L$ are all distinct (we just choose one column if there are several columns with the same restrictions to $L$). It is easy to see $|{\\mathcal}{A}|\\le q^l$ since there are at most $q^l$ distinct words of length $l$. Delete these $l$ rows and the columns contained in ${\\mathcal}{A}$ from $M$. Let $M'$ denote the remaining submatrix. Then $M'$ is a $q$-ary $(N-l)\\times(n-|{\\mathcal}{A}|)$ matrix. If $n-|{\\mathcal}{A}|\\le u-1$, we are done. Otherwise it suffices to show $M'$ is a representation matrix of a separating hash family of type $\\{w_1,\\ldots,w_i-1,\\ldots,w_t\\}$ for arbitrary $1\\le i\\le t$.\n\n      Assume the contrary, $M'$ is not $\\{w_1,\\ldots,w_i-1,\\ldots,w_t\\}$-separating for some $1\\le i\\le t$. Without loss of generality, we set $i=1$. Then there exist $t$ subsets $C_1,\\ldots,C_t$ of the columns of $M'$ with $|C_1|=w_1-1$ and $|C_i|=w_i$ for $2\\le i\\le t$, such that no row of $M'$ can separate $C_1,\\ldots,C_t$. Let $c$ be an arbitrary column of $C_2$ and let $c'$ be a column in ${\\mathcal}{A}$ such that $c'|_{L}=c|_{L}$. Such $c'\\in{\\mathcal}{A}$ must exist by our definition of ${\\mathcal}{A}$. Consequently, no row can separate $C_1\\cup\\{c'\\},C_2,\\ldots,C_t$ in the original matrix $M$, which contradicts the fact that $M$ is $\\{w_1,\\ldots,w_t\\}$-separating. Thus $M'$ satisfies the desired separating property and the lemma follows from $n-|{\\mathcal}{A}|\\le C(N-l,q,\\{w_1-1,...,w_t\\}$ and $|{\\mathcal}{A}|\\le q^l$.\n \\end{proof}\n\n    \\begin{remark}\n        This lemma is obviously an extension of Lemma 2 of \\cite{Trung2011}. We think this Johnson-type bound is very interesting and important since it points out the information hidden in the structure of separating hash families.\n    \\end{remark}\n\n    As the first application of Lemma \\ref{technical}, we will use it to prove Theorem \\ref{recusivebd}.\n    \n        \n        \n    \n    Note that we can omit the constraint $C(\\lfloor N/(u-1)\\rfloor,q,\\{w_1,\\ldots,w_t\\})\\ge u$ in the theorem by introducing a maximum term in the expression of the upper bound (just as the case in Lemma \\ref{technical}). And $C(\\lfloor N/(u-1)\\rfloor,q,\\{w_1,\\ldots,w_t\\})\\ge u$ always holds for $N\\ge u-1$ and sufficiently large $q$, for example, $q\\ge u$.\n\n  \\begin{proof}[\\textbf{Proof of Theorem \\ref{recusivebd}}]\n      One can verify that $N=r\\lceil N/(u-1)\\rceil+(u-1-r)\\lfloor N/(u-1)\\rfloor$. We apply Lemma \\ref{technical} repeatedly for $u-1$ times, in which $l$ is chosen to be $\\lceil N/(u-1)\\rceil$ ($r$ times) and $\\lfloor N/(u-1)\\rfloor$ ($u-1-r$ times), respectively. \n      The theorem follows from a simple fact that $C(0,q,\\{1\\})=0$.\n \\end{proof}\n\n     \\begin{remark}\n        It is not hard to see our bound is an improvement of Theorem \\ref{shf0}, and hence an improvement of \\cite{Trung2011,blackburn08}. One can see $\\lceil N/(u-1)\\rceil$ is the best exponential term that can be obtained by our method, since to reduce the exponential term, one should reduce the maximum value of $l$ involved in the deletions. In other words, we should find a finer partition of $[N]$ and hence more deletion rounds are needed. However, at most $(u-1)$ deletion rounds can be used, because $C(N,q,\\{w_1,\\ldots,w_t\\})$ can be arbitrary large if $t=1$ and $N>0$.\n     \\end{remark}\n\n     \\begin{remark}\n        Since the frameproof code is a special class of separating hash families, it is not surprising to see our bound contains Theorem 1 of \\cite{BL03} as a special case. By Constructions 2 and 3 in \\cite{BL03}, one can find that Theorem \\ref{recusivebd} is asymptotically optimal when $q\\ge N$, $\\{w_1,\\ldots,w_t\\}=\\{1,w\\}$, $N\\equiv 1 \\pmod{w}$, or $q=\\Omega(N^2)$, $\\{w_1,\\ldots,w_t\\}=\\{1,2\\}$. The following section presents a construction which shows Theorem \\ref{recusivebd} is also asymptotically optimal when $N=u-1$.\n     \\end{remark}\n\n\n\n\\section{A construction for $t$-perfect hash families with $t-1$ rows}\n\n    The aim of this section is to present a construction for $PHF(N;Nq^{N-1},q^{N-1}+(N-1)q^{N-2},N+1)$ for arbitrary positive integer $q\\ge2$ and $N\\ge 2$.\n\n    One nice feature of our construction is that it is a generalization of many previous ones. When $N=2$, the construction of $PHF(2;2q,q+1,3)$ has appeared in \\cite{N=2first,N=3t=3}. And when $N=3$, the construction of $PHF(3;3q^2,q^2+2q,4)$ has appeared in numerous papers, for example, Hollmann et al. \\cite{ipp}, Blackburn \\cite{BL03perfect}, Stinson et al. \\cite{ST08} and Bazrafshan et al. \\cite{Trung2011}.\n\n\n   Let us begin with $N=3$ as a simple example to illustrate our idea.\n\n    \\begin{example}{\\rm(\\cite{Trung2011,BL03perfect,ipp,ST08})}\n        There exists a $PHF(3;3q^2,q^2+2q,4)$ for any integer $q\\ge 2$.\n    \\end{example}\n\n     \\begin{proof}\n        We first construct a $3\\times q^2$ submatrix, in which the alphabet set is the $(q^2+2q)$-element set defined as $\\{(x,y),(x,0),(0,y):1\\le x,y\\le q,~x,y\\in\\mathbb{Z} \\}$,\n\n        \\begin{center}\n        $\\left(\n            \\begin{array}{cccccccccccccccccccccccccccccccc}\n              (1,1) & (1,2) & \\cdots & (1,q) & (2,1) & \\cdots & (2,q) & \\cdots & (q,1) & \\cdots & (q,q) \\\\\n              (0,1) & (0,2) & \\cdots & (0,q) & (0,1) & \\cdots & (0,q) & \\cdots & (0,1) & \\cdots & (0,q) \\\\\n              (1,0) & (1,0) & \\cdots & (1,0) & (2,0) & \\cdots & (2,0) & \\cdots & (q,0) & \\cdots & (q,0) \\\\\n            \\end{array}\n        \\right)$.\n        \\end{center}\n\n        \\noindent We denote the three rows of this submatrix as $A_0,~A_1,~A_2$, respectively.\n        Then the representation matrix of the desired perfect hash family can be presented as follows:\n\n        \\begin{center}\n        $\\left(\n              \\begin{array}{ccc}\n                A_0 & A_2 & A_1 \\\\\n                A_1 & A_0 & A_2 \\\\\n                A_2 & A_1 & A_0 \\\\\n              \\end{array}\n        \\right).$\n        \\end{center}\n\n        \\noindent We can easily see it is a $3\\times 3q^2$ matrix over an alphabet of size $q^2+2q$. One can verify (or see the proof of Theorem \\ref{const} below) that it is indeed a representation matrix of a 4-perfect hash family.\n    \\end{proof}\n\n\n     In the above matrix $A_0$ acts like an identity map that preserves each element in $\\{(x,y):1\\le x,y \\le q,~x,y\\in\\mathbb{Z}\\}$, while $A_i$, $i=1,~2$, acts like a projection that projects the $i$-th entry of $(x,y)$ to zero. Actually, the idea behind this simple construction can be generalized.\n\n     \n\n     Recall the definition of the Hamming graphs in Section 2. Take a $q$-ary hypercube ${\\mathcal}{A}$ of dimension $k$, then $|{\\mathcal}{A}|=q^k$. For $1\\leq i\\le k$ and arbitrary $\\alpha=(\\alpha(1),\\ldots,\\alpha(k))\\in{\\mathcal}{A}$, define $\\pi_i$ to be the map that sets $\\alpha(i)$ into zero but preserves all other coordinates of $\\alpha$. We say $\\pi_i$ separates a set $S{\\subseteq}{\\mathcal}{A}$ if $\\pi_i(\\alpha)\\neq\\pi_i(\\beta)$ for arbitrary distinct $\\alpha,~\\beta\\in S$. Proposition 1 of \\cite{BL03perfect} establishes an important property of these maps. We present the proof here for the sake of reader's convenience.\n\n    \\begin{lemma}{\\rm(\\cite{BL03perfect})}{\\label{construction}}\n        Let $S{\\subseteq}{\\mathcal}{A}$ be an arbitrary $t$-element subset with $t\\le k$, then $S$ is separated by at least $k-t+1$ of the functions $\\pi_1,\\ldots,\\pi_k$.\n    \\end{lemma}\n\n    \\begin{proof}\n        Assume the contrary. Without loss of generality, let $S=\\{\\alpha_1,\\ldots,\\alpha_t\\}$ and let $\\pi_1,\\ldots,\\pi_t$ be the $t$ functions which can not separate $S$. Define a colored graph $G=(V,E)$ by $V=S$ and connect $\\alpha,\\beta\\in V$ by an edge of color $i$ if $\\pi_i(\\alpha)=\\pi_i(\\beta)$. Note that graph $G$ is a subgraph of a Hamming graph. Since $\\pi_1,\\ldots,\\pi_t$ can not separate $S$, then for every $i\\in[t]$, there exist $1\\le j<l\\le t$ such that $\\pi_i(\\alpha_j)=\\pi_i(\\alpha_l)$. So $G$ contains a subgraph $G^{'}=(V,E^{'})$ with $t$ vertices and $t$ edges of distinct colors. By Lemma \\ref{treelemma} we can deduce that $G^{'}$ contains a cycle which can be denoted as $(\\alpha_1,\\alpha_2,\\ldots,\\alpha_c)$, where $c$ is an integer such that $1\\leq c\\leq t$.\n\n        We are done if we can show such cycle must not exist. Assume that the edge between $\\alpha_1$ and $\\alpha_2$ is colored by the $i$-th color. Then $\\alpha_1$ and $\\alpha_2$ must differ in their $i$-th coordinate. Since every edge in this cycle is of distinct color and every pair of connected vertices differ in exactly one coordinate, then for every $j\\in\\{2,3,\\ldots,c\\}$, $\\alpha_j$ and $\\alpha_{j+1}$ must agree in their $i$-th coordinate. In particular, $\\alpha_{c+1}$ is recognised as $\\alpha_1$, which implies that $\\alpha_2(i)=\\alpha_3(i)=\\ldots=\\alpha_c(i)=\\alpha_1(i)$. Thus the desired contradiction follows.\n    \\end{proof}\n\n    The following lemma is an easy consequence of above lemma.\n\n    \\begin{lemma}\\label{lastlemma}\n        Let $\\pi_i~(1\\le i\\le k)$ be the functions defined as above and let $\\pi_0$ denote the identity map which satisfies $\\pi_0(\\alpha)=\\alpha$ for every $\\alpha\\in{\\mathcal}{A}$. Suppose $S{\\subseteq}{\\mathcal}{A}$ is a $t$-element subset with $t\\le k+1$, then at most $t-1$ of the functions $\\pi_0,\\pi_1,\\ldots,\\pi_k$ can not separate $S$.\n    \\end{lemma}\n\n    \\begin{proof}\n        Apply Lemma \\ref{construction} and remember the fact that $\\pi_0$ separates every subset of ${\\mathcal}{A}$.\n    \\end{proof}\n\n    \n\n     \n        \n    \n\n    Now we can prove Theorem \\ref{const}.\n\n    \\begin{proof}[\\textbf{Proof of Theorem \\ref{const}}]\n\n        Take a $q$-ary hypercube ${\\mathcal}{A}$ of dimension $N-1$. Obviously $|{\\mathcal}{A}|=q^{N-1}$. Let $\\pi_0,\\pi_1,\\ldots,\\pi_{N-1}$ be the maps defined as above. Then our desired perfect hash family can be represented as the following matrix\n\n        \\begin{center}\n\n        $\\left(\n          \\begin{array}{ccccc}\n            \\pi_0({\\mathcal}{A})     & \\pi_{N-1}({\\mathcal}{A}) & \\cdots & \\cdots & \\pi_1({\\mathcal}{A}) \\\\\n            \\pi_1({\\mathcal}{A})     & \\pi_0({\\mathcal}{A})     & \\cdots & \\cdots & \\pi_2({\\mathcal}{A}) \\\\\n            \\vdots       & \\vdots       & \\ddots &        & \\vdots   \\\\\n            \\vdots       & \\vdots       &        & \\ddots & \\vdots   \\\\\n            \\pi_{N-1}({\\mathcal}{A}) & \\pi_{N-2}({\\mathcal}{A}) & \\cdots & \\cdots & \\pi_0({\\mathcal}{A}) \\\\\n          \\end{array}\n        \\right)$,\n\n        \\end{center}\n\n        \\noindent where for every $0\\le i\\le N-1$, $\\pi_i({\\mathcal}{A}):=(\\pi_i(\\alpha))_{\\alpha\\in{\\mathcal}{A}}$ is a $1\\times|{\\mathcal}{A}|$ submatrix. Denote this representation matrix as $M$, then $M$ is an $N\\times Nq^{N-1}$ matrix. Let $Y=\\cup_{i=0}^{N-1}\\pi_i({\\mathcal}{A})$ denote the alphabet set. It is not hard to see $|\\{\\pi_0(\\alpha):\\alpha\\in{\\mathcal}{A}\\}|=q^{N-1}$ and $|\\{\\pi_i(\\alpha):\\alpha\\in{\\mathcal}{A}\\}|=q^{N-2}$ for every $1\\le i\\le N-1$. Then one can verify that $|Y|=q^{N-1}+(N-1)q^{N-2}$. Thus we can conclude that $M$ is the representation matrix of an $(N;Nq^{N-1},q^{N-1}+(N-1)q^{N-2})$-hash family.\n\n        Now it remains to verify that this hash family is indeed an $(N+1)$-perfect hash family. Consider $M$ as the  concatenation of $N$ column patterns denoted as $(C_1|C_2|\\cdots|C_N)$ with $|C_1|=|C_2|=\\cdots=|C_N|=q^{N-1}$. Take an arbitrary $(N+1)$-subset $S$ of the columns of $M$. We are going to show that there must exist a row of $M$ that separates $S$. If $S{\\subseteq} C_i$ for some $1\\le i\\le N$, then the $i$-th row of $C_i$, which corresponds to $\\pi_0$, can separate $S$, since $\\pi_0(\\alpha)\\neq\\pi_0(\\beta)$ for arbitrary distinct $\\alpha,~\\beta\\in{\\mathcal}{A}$. Otherwise, let $C_{i_1},\\ldots,C_{i_j}$ be the column patterns which have non-empty intersection with $S$, where $j\\ge 2$ is a positive integer. For $1\\le l\\le j$, denote $C_{i_l}\\cap S=S_l$. Then $\\sum_{l=1}^{j}|S_l|=N+1$ and $|S_l|\\le N$ for every $l$. By Lemma \\ref{lastlemma}, at most $|S_l|-1$ rows of $C_{i_l}$ can not separate $S_l$. Since $\\sum_{l=1}^{j}(|S_l|-1)=N+1-l\\le N+1-2=N-1<N$, then there must exist a row of $(C_1|C_2|\\cdots|C_N)$ that separates $\\cup_{i=1}^{l} S_l=S$.\n\n\n    \\end{proof}\n\n    \\begin{remark}\n        Our construction has an important property that it satisfies\n\n        \n", "index": 33, "text": "$$\\lim_{q\\rightarrow\\infty}{\\frac}{Nq^{N-1}}{q^{N-1}+(N-1)q^{N-2}}=N$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex14.m1\" class=\"ltx_Math\" alttext=\"\\lim_{q\\rightarrow\\infty}{\\frac{}}{Nq^{N-1}}{q^{N-1}+(N-1)q^{N-2}}=N\" display=\"block\"><mrow><mrow><mrow><munder><mo movablelimits=\"false\">lim</mo><mrow><mi>q</mi><mo>\u2192</mo><mi mathvariant=\"normal\">\u221e</mi></mrow></munder><mo>\u2061</mo><mrow><mfrac><mi/><mrow><mi>N</mi><mo>\u2062</mo><msup><mi>q</mi><mrow><mi>N</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow></mfrac><mo>\u2062</mo><msup><mi>q</mi><mrow><mi>N</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>N</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msup><mi>q</mi><mrow><mi>N</mi><mo>-</mo><mn>2</mn></mrow></msup></mrow></mrow><mo>=</mo><mi>N</mi></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n\n        \\noindent which gives a negative answer to Question \\ref{trung}. Furthermore, taking into account the fact that any $(\\lfloor(t/2+1)^2\\rfloor)$-perfect hash family is also a $t$-IPP code, one can see that our construction also confirms the validity of Conjecture \\ref{alonstav}.\n    \\end{remark}\n\n    \\begin{remark}\n        It is worth mentioning that Proposition 2 of \\cite{BL03perfect} (an unpublished paper) also noticed that $\\lim_{q\\rightarrow\\infty}{\\frac}{p_u(u-1,q)}{q}=u-1$. The author used an optimization method and no explicit construction was given in that paper.\n        \n    \\end{remark}\n\n    The proof of Lemma \\ref{construction} also leads to a conclusion on Hamming graphs, which we think may be of independent interest.\n\n    \\begin{corollary}\\label{hamming}\n        Color the edges of $H(k,q)$ with $k$ colors such that the edge $(\\alpha,\\beta)$ is colored by color $i$ if $\\alpha$ and $\\beta$ differ in their $i$-th coordinate. Then $H(k,q)$ contains no cycles with pairwise distinct colors.\n     \\end{corollary}\n\n\\section{Perfect hash families of strength three with three rows}\n\n    Constructions for perfect hash families can induce constructions for corresponding separating hash families. And with the aid of Lemma \\ref{technical}, upper bounds for perfect hash families can also induce upper bounds for related separating hash families. Therefore, from this section we will focus on perfect hash families.\n\n   We have mentioned in Section 1 that if $(u-1)\\nmid N$, it is very difficult to determine whether the exponent ${\\lceil} N/(u-1){\\rceil}$ in Theorem \\ref{recusivebd} is tight. In the following two sections we will handle two small cases in such problems, namely, $N=u=3$ and $N=u=4$. When $N=3$ and $u=3$, the corresponding separating hash families only have two alternative types, namely, $\\{1,2\\}$-separating and 3-perfect hashing. Bazrafshan and Trung  \\cite{trung2014} proved that $C(3,q,\\{1,2\\})\\le q^2$ and an $SHF(3;q^2,q,\\{1,2\\})$ does exist for $q\\ge2$. Walker II and Colbourn \\cite{N=3t=3} conjectured that $p_3(3,q)=o(q^2)$. In this section, we will verify this conjecture by proving $q^{2-o(1)}<p_3(3,q)=o(q^2)$. Furthermore, the upper bound is extended to $p_t(t,q)$ and $C(u,q,\\{w_1,\\ldots,w_t\\})$ with $\\sum_{i=1}^t w_i=u$.\n\n   \n\n  Let us begin with a simple lemma. Note that we will not distinguish between a perfect hash family and its representation matrix.\n\n  \\begin{lemma}\\label{uniquelemma}\n     Let $X$ denote the column set (words) of a $PHF(N;n,q,t)$. Then by deleting at most $Nq$ words from $X$, we can get a subset $X^{*}{\\subseteq} X$ such that no word in $X^{*}$ has a unique coordinate in $X^{*}$.\n  \\end{lemma}\n\n  \\begin{proof}\n    We use a greedy algorithm to construct $X^{*}$. Delete $x_1$ from $X$ if $x_1$ has a unique coordinate in $X$. Denote $X_1=X-\\{x_1\\}$. In general, if $x_{i+1}\\in X_i$ has a unique coordinate in $X_i$, we delete $x_{i+1}$ from $X_i$ and then denote $X_{i+1}=X_i-\\{x_{i+1}\\}$. Continue this procedure until we get an $X^{*}$ with no words containing a unique coordinate in it. At most $Nq$ words will be deleted from $X$ since we can delete any symbol $y\\in[q]$ at most one time for any coordinate $i\\in[N]$.\n  \\end{proof}\n\n  Since all perfect hash families being considered in the following are of size at least $q^{1+\\epsilon}$ for some positive constant $\\epsilon$, then the deletion of at most $Nq$ words from $X$ can be neglected. Let $PHF^*(N;n,q,t)$ denote the perfect hash family (obtained from $PHF(N;n,q,t)$) such that no word in it contains a unique coordinate. We use $p_t^*(N,q)$ to denote the corresponding maximal cardinality.\n\n  \\begin{lemma}\\label{linear}\n    In a $PHF^*(t;n,q,t)$, any two words can agree with at most one coordinate.\n  \\end{lemma}\n\n  \\begin{proof}\n    Assume the contrary, then the following submatrix is contained in the representation matrix of such $PHF^*(t;n,q,t)$\n\n     \n", "itemtype": "equation", "pos": 44449, "prevtext": "\n\n        \\noindent and hence it is asymptotically optimal since we have $p_{N+1}(N,q)\\le Nq$ by Theorem \\ref{recusivebd}. Note that a $u$-perfect hash family is $\\{w_1,\\ldots,w_t\\}$-separating for arbitrary $w_i$ such that $w_i\\ge1$ and $\\sum_{i=1}^t w_i=u$. Theorems \\ref{recusivebd} and \\ref{const} can be combined to show\n\n        \n", "index": 35, "text": "$$\\lim_{q\\rightarrow\\infty}{\\frac}{C(u-1,q,\\{w_1,\\ldots,w_t\\})}{q}=u-1,$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex15.m1\" class=\"ltx_Math\" alttext=\"\\lim_{q\\rightarrow\\infty}{\\frac{}}{C(u-1,q,\\{w_{1},\\ldots,w_{t}\\})}{q}=u-1,\" display=\"block\"><mrow><mrow><mrow><munder><mo movablelimits=\"false\">lim</mo><mrow><mi>q</mi><mo>\u2192</mo><mi mathvariant=\"normal\">\u221e</mi></mrow></munder><mo>\u2061</mo><mrow><mfrac><mi/><mrow><mi>C</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>u</mi><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mi>q</mi><mo>,</mo><mrow><mo stretchy=\"false\">{</mo><msub><mi>w</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><msub><mi>w</mi><mi>t</mi></msub><mo stretchy=\"false\">}</mo></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac><mo>\u2062</mo><mi>q</mi></mrow></mrow><mo>=</mo><mrow><mi>u</mi><mo>-</mo><mn>1</mn></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n\n     \\noindent where in each row, the two bold coordinates are equal. $\\alpha_1,\\alpha_2$ are two words such that $\\alpha_1(i)=\\alpha_2(i)$ for $i=1,2$ and since $\\alpha_1$ has no unique coordinates, there exist $\\alpha_3,\\ldots,\\alpha_t$ such that $\\alpha_j(j)=\\alpha_1(j)$ for each $3\\le j\\le t$. Therefore, no row of the submatrix can separate $\\{\\alpha_1,\\ldots,\\alpha_t\\}$, violating the $t$-perfect hashing property.\n  \\end{proof}\n\n  The following two observations are very useful.\n\n  \\vspace{10pt}\n\n    \\textbf{Observation 1.} On one hand, any $N\\times n$ $q$-ary matrix $M$ can be viewed as an $N$-uniform $N$-partite hypergraph ${\\mathcal}{G}=(V({\\mathcal}{G}),E({\\mathcal}{G}))$ with equal part size $q$, where the vertex set is defined as $V({\\mathcal}{G})=\\cup_{i=1}^N V_i$, $V_i=\\{(i,j):1\\le j\\le q\\}$ for $1\\le i\\le N$, and the edge set is defined as $E({\\mathcal}{G})=\\{\\{(i,x(i))\\}_{i=1}^N:x=\\{x(i)\\}_{i=1}^N~is~a~column~of~M\\}$.\n\n    \n  \\vspace{10pt}\n\n    \\textbf{Observation 2.} On the other hand, given an $N$-uniform $N$-partite hypergraph ${\\mathcal}{G}=(V({\\mathcal}{G}),E({\\mathcal}{G}))$ with equal part size $q$. We can regard $E({\\mathcal}{G})$ as some $N\\times|E({\\mathcal}{G})|$ $q$-ary matrix $M$. Note that $V({\\mathcal}{G})$ can be partitioned into $N$ pairwise disjoint sets with size $q$. We can set $V_i=\\{(i,j):1\\le j\\le q\\}$ for $1\\le i\\le N$, where the first coordinate $i$ corresponds to the $i$-th part $V_i$ and the second coordinate $j$ corresponds to the $j$-th vertex in $V_i$. Then the matrix $M$ is formed by setting its column set as $\\{x=\\{x(i)\\}_{i=1}^N:\\{(i,x(i))\\}_{i=1}^N\\in E({\\mathcal}{G})\\}$. Such $M$ is said to be the representation matrix of $E({\\mathcal}{G})$.\n\n  \\vspace{10pt}\n\n   These two observations establish a bridge between $q$-ary matrices and multipartite hypergraphs. Recall the definition of $f_r^*(n,v,e)$ in Section 2.\n\n  \\begin{lemma}\\label{f3*=p3*}\n    $f_3^*(q,6,3)=p_3^*(3,q).$\n  \\end{lemma}\n\n  \\begin{proof}\n\n  It is not hard to see that a $PHF^*(3;n,q,3)$ exists if and only if the following configuration is not contained in its representation matrix\n\n  \n", "itemtype": "equation", "pos": 48439, "prevtext": "\n\n        \\noindent which gives a negative answer to Question \\ref{trung}. Furthermore, taking into account the fact that any $(\\lfloor(t/2+1)^2\\rfloor)$-perfect hash family is also a $t$-IPP code, one can see that our construction also confirms the validity of Conjecture \\ref{alonstav}.\n    \\end{remark}\n\n    \\begin{remark}\n        It is worth mentioning that Proposition 2 of \\cite{BL03perfect} (an unpublished paper) also noticed that $\\lim_{q\\rightarrow\\infty}{\\frac}{p_u(u-1,q)}{q}=u-1$. The author used an optimization method and no explicit construction was given in that paper.\n        \n    \\end{remark}\n\n    The proof of Lemma \\ref{construction} also leads to a conclusion on Hamming graphs, which we think may be of independent interest.\n\n    \\begin{corollary}\\label{hamming}\n        Color the edges of $H(k,q)$ with $k$ colors such that the edge $(\\alpha,\\beta)$ is colored by color $i$ if $\\alpha$ and $\\beta$ differ in their $i$-th coordinate. Then $H(k,q)$ contains no cycles with pairwise distinct colors.\n     \\end{corollary}\n\n\\section{Perfect hash families of strength three with three rows}\n\n    Constructions for perfect hash families can induce constructions for corresponding separating hash families. And with the aid of Lemma \\ref{technical}, upper bounds for perfect hash families can also induce upper bounds for related separating hash families. Therefore, from this section we will focus on perfect hash families.\n\n   We have mentioned in Section 1 that if $(u-1)\\nmid N$, it is very difficult to determine whether the exponent ${\\lceil} N/(u-1){\\rceil}$ in Theorem \\ref{recusivebd} is tight. In the following two sections we will handle two small cases in such problems, namely, $N=u=3$ and $N=u=4$. When $N=3$ and $u=3$, the corresponding separating hash families only have two alternative types, namely, $\\{1,2\\}$-separating and 3-perfect hashing. Bazrafshan and Trung  \\cite{trung2014} proved that $C(3,q,\\{1,2\\})\\le q^2$ and an $SHF(3;q^2,q,\\{1,2\\})$ does exist for $q\\ge2$. Walker II and Colbourn \\cite{N=3t=3} conjectured that $p_3(3,q)=o(q^2)$. In this section, we will verify this conjecture by proving $q^{2-o(1)}<p_3(3,q)=o(q^2)$. Furthermore, the upper bound is extended to $p_t(t,q)$ and $C(u,q,\\{w_1,\\ldots,w_t\\})$ with $\\sum_{i=1}^t w_i=u$.\n\n   \n\n  Let us begin with a simple lemma. Note that we will not distinguish between a perfect hash family and its representation matrix.\n\n  \\begin{lemma}\\label{uniquelemma}\n     Let $X$ denote the column set (words) of a $PHF(N;n,q,t)$. Then by deleting at most $Nq$ words from $X$, we can get a subset $X^{*}{\\subseteq} X$ such that no word in $X^{*}$ has a unique coordinate in $X^{*}$.\n  \\end{lemma}\n\n  \\begin{proof}\n    We use a greedy algorithm to construct $X^{*}$. Delete $x_1$ from $X$ if $x_1$ has a unique coordinate in $X$. Denote $X_1=X-\\{x_1\\}$. In general, if $x_{i+1}\\in X_i$ has a unique coordinate in $X_i$, we delete $x_{i+1}$ from $X_i$ and then denote $X_{i+1}=X_i-\\{x_{i+1}\\}$. Continue this procedure until we get an $X^{*}$ with no words containing a unique coordinate in it. At most $Nq$ words will be deleted from $X$ since we can delete any symbol $y\\in[q]$ at most one time for any coordinate $i\\in[N]$.\n  \\end{proof}\n\n  Since all perfect hash families being considered in the following are of size at least $q^{1+\\epsilon}$ for some positive constant $\\epsilon$, then the deletion of at most $Nq$ words from $X$ can be neglected. Let $PHF^*(N;n,q,t)$ denote the perfect hash family (obtained from $PHF(N;n,q,t)$) such that no word in it contains a unique coordinate. We use $p_t^*(N,q)$ to denote the corresponding maximal cardinality.\n\n  \\begin{lemma}\\label{linear}\n    In a $PHF^*(t;n,q,t)$, any two words can agree with at most one coordinate.\n  \\end{lemma}\n\n  \\begin{proof}\n    Assume the contrary, then the following submatrix is contained in the representation matrix of such $PHF^*(t;n,q,t)$\n\n     \n", "index": 37, "text": "$$\\left(\n          \\begin{array}{cccccc}\n            \\bm{\\alpha_1(1)} & \\bm{\\alpha_2(1)} & *         & *      & *      & * \\\\\n            \\bm{\\alpha_1(2)} & \\bm{\\alpha_2(2)} & *         & *      & *      & * \\\\\n            \\bm{\\alpha_1(3)} & *         & \\bm{\\alpha_3(3)} & *      & *      & * \\\\\n            \\vdots    & *         & *         & \\ddots & *      & * \\\\\n            \\vdots    & *         & *         & *      & \\ddots & * \\\\\n            \\bm{\\alpha_1(t)} & *         & *         & *      & *      & \\bm{\\alpha_t(t)} \\\\\n          \\end{array}\n        \\right),$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex16.m1\" class=\"ltx_Math\" alttext=\"\\left(\\begin{array}[]{cccccc}\\bm{\\alpha_{1}(1)}&amp;\\bm{\\alpha_{2}(1)}&amp;*&amp;*&amp;*&amp;*\\\\&#10;\\bm{\\alpha_{1}(2)}&amp;\\bm{\\alpha_{2}(2)}&amp;*&amp;*&amp;*&amp;*\\\\&#10;\\bm{\\alpha_{1}(3)}&amp;*&amp;\\bm{\\alpha_{3}(3)}&amp;*&amp;*&amp;*\\\\&#10;\\vdots&amp;*&amp;*&amp;\\ddots&amp;*&amp;*\\\\&#10;\\vdots&amp;*&amp;*&amp;*&amp;\\ddots&amp;*\\\\&#10;\\bm{\\alpha_{1}(t)}&amp;*&amp;*&amp;*&amp;*&amp;\\bm{\\alpha_{t}(t)}\\\\&#10;\\end{array}\\right),\" display=\"block\"><mrow><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfcf</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mn>\ud835\udfcf</mn><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfd0</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mn>\ud835\udfcf</mn><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfcf</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mn>\ud835\udfd0</mn><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfd0</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mn>\ud835\udfd0</mn><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfcf</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mn>\ud835\udfd1</mn><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfd1</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mn>\ud835\udfd1</mn><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22f1</mi></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22f1</mi></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfcf</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mi>\ud835\udc95</mi><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mi>\ud835\udc95</mi></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mi>\ud835\udc95</mi><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd></mtr></mtable><mo>)</mo></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n\n  We call this configuration a triangle since these three columns have no identical coordinates and every pair of columns have exactly one common coordinate. On one hand, note that in a triangle three edges (columns) are spanned by six points, thus $f_3^*(q,6,3)\\le p_3^*(3,q)$ is obvious since if a 3-uniform 3-partite hypergraph (with equal part size $q$) is $G(6,3)$-free, then it does not contain a triangle in its representation matrix. On the other hand, if some three columns of a $PHF^*(3;n,q,3)$ contain at most six points, then either there exists a pair of two columns having two coordinates in common or these three columns form a triangle. Both cases are forbidden in a $PHF^*(3;n,q,3)$. Therefore, it holds that $p_3^*(3,q)\\le f_3^*(q,6,3)$ and hence our lemma follows.\n  \\end{proof}\n\n  \\begin{theorem}\\label{p_3(3,q)=f_3(3q,6,3)+O(q)}\n    $p_3(3,q)=f_3(3q,6,3)+O(q)$ and hence for arbitrary $\\epsilon>0$, $q^{2-\\epsilon}<p_3(3,q)=o(q^2)$ holds for sufficiently large $q$.\n  \\end{theorem}\n\n  \\begin{proof}\n    Apply Lemmas \\ref{erdos-kleitman}, \\ref{uniquelemma}, \\ref{f3*=p3*} and inequality (\\ref{1}).\n  \\end{proof}\n\n  As the second application of Lemma \\ref{technical}, the upper bound of $p_3(3,q)$ can be extended to $p_t(t,q)$ and $C(u,q,\\{w_1,\\ldots,w_t\\})$.\n  \\begin{corollary}\\label{cccc}\n    $C(u,q,\\{w_1,\\ldots,w_t\\})=o(q^2)$ for any $t\\ge 3$ and $\\sum_{i=1}^t w_i=u$. In particular, $p_t(t,q)=o(q^2)$ for any $t\\ge 3.$\n  \\end{corollary}\n\n  \\begin{proof}\n    Apply Lemma \\ref{technical} and Theorem \\ref{p_3(3,q)=f_3(3q,6,3)+O(q)}.\n  \\end{proof}\n\n  \\begin{remark}\n    One can also prove $p_t(t,q)=o(q^2)$ by applying the graph removal lemma \\cite{graphremoval}, see \\cite{ippe,ippc} for examples of applications of graph removal lemma in such problems. Here our proof applying Lemma \\ref{technical} is much simpler. When $1+w\\le q$, it was shown in \\cite{trung2014} that $C(1+w,q,\\{1,w\\})\\le q^2$. And for any prime power $q$, there exists an $SHF(w+1;q^2,q,\\{1,w\\})$. Therefore, for $C(u,q,\\{w_1,\\ldots,w_t\\})$ with $t=2$, we can not determine whether $C(w_1+w_2,q,\\{w_1,w_2\\})=\\Omega(q^2)$ or $C(w_1+w_2,q,\\{w_1,w_2\\})=o(q^2)$. It is an interesting problem to determine the right order of the magnitude of $C(w_1+w_2,q,\\{w_1,w_2\\})$.\n  \\end{remark}\n\n  Although we can get the lower bound $q^{2-\\epsilon}$ by a direct application of the (6,3)-theorem and Lemma \\ref{erdos-kleitman}, we prefer a construction which provides the explicit cardinality. A method introduced in Section 3 of \\cite{Furediconst} can be used to construct such $q$-ary codes of length $N$. Our method is similar to that one except some transformations which will be mentioned later.\n\n  Given integers $q\\ge N\\ge 2$, $M{\\subseteq}\\{0,1,\\ldots,q-1\\}$, we define an $N$-uniform $N$-partite hypergraph ${\\mathcal}{G}_M$ (whose edge set can be viewed as the representation matrix of our desired code) as follows. The vertex set $V({\\mathcal}{G}_M)$ is defined to be\n\n  \n", "itemtype": "equation", "pos": 51145, "prevtext": "\n\n     \\noindent where in each row, the two bold coordinates are equal. $\\alpha_1,\\alpha_2$ are two words such that $\\alpha_1(i)=\\alpha_2(i)$ for $i=1,2$ and since $\\alpha_1$ has no unique coordinates, there exist $\\alpha_3,\\ldots,\\alpha_t$ such that $\\alpha_j(j)=\\alpha_1(j)$ for each $3\\le j\\le t$. Therefore, no row of the submatrix can separate $\\{\\alpha_1,\\ldots,\\alpha_t\\}$, violating the $t$-perfect hashing property.\n  \\end{proof}\n\n  The following two observations are very useful.\n\n  \\vspace{10pt}\n\n    \\textbf{Observation 1.} On one hand, any $N\\times n$ $q$-ary matrix $M$ can be viewed as an $N$-uniform $N$-partite hypergraph ${\\mathcal}{G}=(V({\\mathcal}{G}),E({\\mathcal}{G}))$ with equal part size $q$, where the vertex set is defined as $V({\\mathcal}{G})=\\cup_{i=1}^N V_i$, $V_i=\\{(i,j):1\\le j\\le q\\}$ for $1\\le i\\le N$, and the edge set is defined as $E({\\mathcal}{G})=\\{\\{(i,x(i))\\}_{i=1}^N:x=\\{x(i)\\}_{i=1}^N~is~a~column~of~M\\}$.\n\n    \n  \\vspace{10pt}\n\n    \\textbf{Observation 2.} On the other hand, given an $N$-uniform $N$-partite hypergraph ${\\mathcal}{G}=(V({\\mathcal}{G}),E({\\mathcal}{G}))$ with equal part size $q$. We can regard $E({\\mathcal}{G})$ as some $N\\times|E({\\mathcal}{G})|$ $q$-ary matrix $M$. Note that $V({\\mathcal}{G})$ can be partitioned into $N$ pairwise disjoint sets with size $q$. We can set $V_i=\\{(i,j):1\\le j\\le q\\}$ for $1\\le i\\le N$, where the first coordinate $i$ corresponds to the $i$-th part $V_i$ and the second coordinate $j$ corresponds to the $j$-th vertex in $V_i$. Then the matrix $M$ is formed by setting its column set as $\\{x=\\{x(i)\\}_{i=1}^N:\\{(i,x(i))\\}_{i=1}^N\\in E({\\mathcal}{G})\\}$. Such $M$ is said to be the representation matrix of $E({\\mathcal}{G})$.\n\n  \\vspace{10pt}\n\n   These two observations establish a bridge between $q$-ary matrices and multipartite hypergraphs. Recall the definition of $f_r^*(n,v,e)$ in Section 2.\n\n  \\begin{lemma}\\label{f3*=p3*}\n    $f_3^*(q,6,3)=p_3^*(3,q).$\n  \\end{lemma}\n\n  \\begin{proof}\n\n  It is not hard to see that a $PHF^*(3;n,q,3)$ exists if and only if the following configuration is not contained in its representation matrix\n\n  \n", "index": 39, "text": "$$\\left(\n    \\begin{array}{ccc}\n      a & * & a \\\\\n      b & b & * \\\\\n      * & c & c \\\\\n    \\end{array}\n  \\right).$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex17.m1\" class=\"ltx_Math\" alttext=\"\\left(\\begin{array}[]{ccc}a&amp;*&amp;a\\\\&#10;b&amp;b&amp;*\\\\&#10;*&amp;c&amp;c\\\\&#10;\\end{array}\\right).\" display=\"block\"><mrow><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mi>a</mi></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mi>a</mi></mtd></mtr><mtr><mtd columnalign=\"center\"><mi>b</mi></mtd><mtd columnalign=\"center\"><mi>b</mi></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mi>c</mi></mtd><mtd columnalign=\"center\"><mi>c</mi></mtd></mtr></mtable><mo>)</mo></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n\n  \n\n  \\noindent It is easy to see $|V({\\mathcal}{G}_M)|=Nq$. For each $j\\in[N]$, we use $V_j=\\{(j,y):y\\in\\mathbb{Z}_q\\}$ to denote the vertex set of the $j$-th part of $V({\\mathcal}{G})$. For integers $0\\le y,~m\\le q$, the hyperedge of ${\\mathcal}{G}$ is defined to be the $N$-element set \n", "itemtype": "equation", "pos": 54227, "prevtext": "\n\n  We call this configuration a triangle since these three columns have no identical coordinates and every pair of columns have exactly one common coordinate. On one hand, note that in a triangle three edges (columns) are spanned by six points, thus $f_3^*(q,6,3)\\le p_3^*(3,q)$ is obvious since if a 3-uniform 3-partite hypergraph (with equal part size $q$) is $G(6,3)$-free, then it does not contain a triangle in its representation matrix. On the other hand, if some three columns of a $PHF^*(3;n,q,3)$ contain at most six points, then either there exists a pair of two columns having two coordinates in common or these three columns form a triangle. Both cases are forbidden in a $PHF^*(3;n,q,3)$. Therefore, it holds that $p_3^*(3,q)\\le f_3^*(q,6,3)$ and hence our lemma follows.\n  \\end{proof}\n\n  \\begin{theorem}\\label{p_3(3,q)=f_3(3q,6,3)+O(q)}\n    $p_3(3,q)=f_3(3q,6,3)+O(q)$ and hence for arbitrary $\\epsilon>0$, $q^{2-\\epsilon}<p_3(3,q)=o(q^2)$ holds for sufficiently large $q$.\n  \\end{theorem}\n\n  \\begin{proof}\n    Apply Lemmas \\ref{erdos-kleitman}, \\ref{uniquelemma}, \\ref{f3*=p3*} and inequality (\\ref{1}).\n  \\end{proof}\n\n  As the second application of Lemma \\ref{technical}, the upper bound of $p_3(3,q)$ can be extended to $p_t(t,q)$ and $C(u,q,\\{w_1,\\ldots,w_t\\})$.\n  \\begin{corollary}\\label{cccc}\n    $C(u,q,\\{w_1,\\ldots,w_t\\})=o(q^2)$ for any $t\\ge 3$ and $\\sum_{i=1}^t w_i=u$. In particular, $p_t(t,q)=o(q^2)$ for any $t\\ge 3.$\n  \\end{corollary}\n\n  \\begin{proof}\n    Apply Lemma \\ref{technical} and Theorem \\ref{p_3(3,q)=f_3(3q,6,3)+O(q)}.\n  \\end{proof}\n\n  \\begin{remark}\n    One can also prove $p_t(t,q)=o(q^2)$ by applying the graph removal lemma \\cite{graphremoval}, see \\cite{ippe,ippc} for examples of applications of graph removal lemma in such problems. Here our proof applying Lemma \\ref{technical} is much simpler. When $1+w\\le q$, it was shown in \\cite{trung2014} that $C(1+w,q,\\{1,w\\})\\le q^2$. And for any prime power $q$, there exists an $SHF(w+1;q^2,q,\\{1,w\\})$. Therefore, for $C(u,q,\\{w_1,\\ldots,w_t\\})$ with $t=2$, we can not determine whether $C(w_1+w_2,q,\\{w_1,w_2\\})=\\Omega(q^2)$ or $C(w_1+w_2,q,\\{w_1,w_2\\})=o(q^2)$. It is an interesting problem to determine the right order of the magnitude of $C(w_1+w_2,q,\\{w_1,w_2\\})$.\n  \\end{remark}\n\n  Although we can get the lower bound $q^{2-\\epsilon}$ by a direct application of the (6,3)-theorem and Lemma \\ref{erdos-kleitman}, we prefer a construction which provides the explicit cardinality. A method introduced in Section 3 of \\cite{Furediconst} can be used to construct such $q$-ary codes of length $N$. Our method is similar to that one except some transformations which will be mentioned later.\n\n  Given integers $q\\ge N\\ge 2$, $M{\\subseteq}\\{0,1,\\ldots,q-1\\}$, we define an $N$-uniform $N$-partite hypergraph ${\\mathcal}{G}_M$ (whose edge set can be viewed as the representation matrix of our desired code) as follows. The vertex set $V({\\mathcal}{G}_M)$ is defined to be\n\n  \n", "index": 41, "text": "$$V({\\mathcal}{G}_M):=\\{(j,y):j\\in[N],~y\\in\\mathbb{Z}_q\\}.$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex18.m1\" class=\"ltx_Math\" alttext=\"V({\\mathcal{}}{G}_{M}):=\\{(j,y):j\\in[N],~{}y\\in\\mathbb{Z}_{q}\\}.\" display=\"block\"><mrow><mrow><mrow><mi>V</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>G</mi><mi>M</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>:=</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mo stretchy=\"false\">(</mo><mi>j</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><mo>:</mo><mrow><mrow><mi>j</mi><mo>\u2208</mo><mrow><mo stretchy=\"false\">[</mo><mi>N</mi><mo stretchy=\"false\">]</mo></mrow></mrow><mo rspace=\"5.8pt\">,</mo><mrow><mi>y</mi><mo>\u2208</mo><msub><mi>\u2124</mi><mi>q</mi></msub></mrow></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n\n  \\noindent where ${\\mathcal}{B}:=\\{b_1,\\ldots,b_{N}\\}{\\subseteq}\\{0,1,\\ldots,q-1\\}$ is an undetermined $N$-element set and the second coordinates $y+b_im$ are taken modulo $q$. We call ${\\mathcal}{B}$ the tangent set of $A(y,m)$. $A(y,m)$ can also be viewed as a $q$-ary word of length $N$. If $q$ is a prime, one can verify that\n\n  \n", "itemtype": "equation", "pos": 54578, "prevtext": "\n\n  \n\n  \\noindent It is easy to see $|V({\\mathcal}{G}_M)|=Nq$. For each $j\\in[N]$, we use $V_j=\\{(j,y):y\\in\\mathbb{Z}_q\\}$ to denote the vertex set of the $j$-th part of $V({\\mathcal}{G})$. For integers $0\\le y,~m\\le q$, the hyperedge of ${\\mathcal}{G}$ is defined to be the $N$-element set \n", "index": 43, "text": "$$A(y,m)=\\{(1,y+b_1m),(2,y+b_2m),\\ldots,(N,y+b_{N}m)\\},$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex19.m1\" class=\"ltx_Math\" alttext=\"A(y,m)=\\{(1,y+b_{1}m),(2,y+b_{2}m),\\ldots,(N,y+b_{N}m)\\},\" display=\"block\"><mrow><mrow><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>m</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo>,</mo><mrow><mi>y</mi><mo>+</mo><mrow><msub><mi>b</mi><mn>1</mn></msub><mo>\u2062</mo><mi>m</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mn>2</mn><mo>,</mo><mrow><mi>y</mi><mo>+</mo><mrow><msub><mi>b</mi><mn>2</mn></msub><mo>\u2062</mo><mi>m</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mi>N</mi><mo>,</mo><mrow><mi>y</mi><mo>+</mo><mrow><msub><mi>b</mi><mi>N</mi></msub><mo>\u2062</mo><mi>m</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": " \\noindent holds for $(y,m)\\neq (y',m')$ by solving a system of two congruence equations.\n\n  From now on, we fix the size of the alphabet set $q$ to be a prime or the prime nearest to it. For a subset $M{\\subseteq}\\{0,1,\\ldots,q-1\\}$, we set \n", "itemtype": "equation", "pos": -1, "prevtext": "\n\n  \\noindent where ${\\mathcal}{B}:=\\{b_1,\\ldots,b_{N}\\}{\\subseteq}\\{0,1,\\ldots,q-1\\}$ is an undetermined $N$-element set and the second coordinates $y+b_im$ are taken modulo $q$. We call ${\\mathcal}{B}$ the tangent set of $A(y,m)$. $A(y,m)$ can also be viewed as a $q$-ary word of length $N$. If $q$ is a prime, one can verify that\n\n  \n", "index": 45, "text": "\\begin{equation}\\label{primeq}\n    \\begin{aligned}\n  |A(y,m)\\cap A(y',m')|\\le 1\n    \\end{aligned}\n  \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4X.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle|A(y,m)\\cap A(y^{\\prime},m^{\\prime})|\\leq 1\" display=\"inline\"><mrow><mrow><mo stretchy=\"false\">|</mo><mrow><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>m</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2229</mo><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>y</mi><mo>\u2032</mo></msup><mo>,</mo><msup><mi>m</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">|</mo></mrow><mo>\u2264</mo><mn>1</mn></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n\n  \\noindent to be the edge set of our desired hypergraph, where the set $M$ is determined by the subgraphs that needed to be forbidden (these subgraphs can also be viewed as the configurations that needed to be forbidden in the desired code). Obviously $|E({\\mathcal}{G}_M)|=q|M|$ and by (\\ref{primeq}) we can verify that ${\\mathcal}{G}_M$ is also linear.\n\n  Now, we are going to choose appropriate ${\\mathcal}{B}$ and $M$ according to the properties of our desired codes. For example, to construct a 3-perfect hash family with three rows, we first set $N=3$ and then choose ${\\mathcal}{B}=\\{0,1,2\\}$, where $b_i=i-1$ for $1\\le i\\le 3  $. Therefore, to show this specified ${\\mathcal}{G}_M$ can indeed induce a $PHF^*(3,n,q,3)$, by Lemma \\ref{f3*=p3*} we only need to guarantee that $E({\\mathcal}{G})$ is triangle-free, since it is already linear (we have set $q$ to be a prime). We claim that it suffices to choose $M{\\subseteq}\\{0,1,\\ldots,{\\lfloor} (q-1)/2{\\rfloor}\\}$ to be a $2$-sum-free set such that the equation $m_1+m_2=2m_3$ has no solution except $m_1=m_2=m_3$.\n\n\n  \\begin{theorem}\\label{optimal3}\n    There exists a constant $\\gamma$ such that $p_3(3,q)>q^2e^{-\\gamma\\sqrt{\\log q}}$.\n  \\end{theorem}\n\n  \\begin{proof}\n    It suffices to show ${\\mathcal}{G}_M$ contains no triangles for arbitrary 2-sum-free set $M{\\subseteq}\\{0,1,\\ldots,{\\lfloor} (q-1)/2{\\rfloor}\\}$. If otherwise, assume that $\\{A(y_i,m_i)\\in{\\mathcal}{G}_M$:~$1\\le i\\le 3\\}$ forms a triangle. One can verify that the vertices of this triangle must locate on different parts of $V_1,V_2,V_3$. Thus we can assume that\n\n    \n", "itemtype": "equation", "pos": 55327, "prevtext": " \\noindent holds for $(y,m)\\neq (y',m')$ by solving a system of two congruence equations.\n\n  From now on, we fix the size of the alphabet set $q$ to be a prime or the prime nearest to it. For a subset $M{\\subseteq}\\{0,1,\\ldots,q-1\\}$, we set \n", "index": 47, "text": "$$E({\\mathcal}{G}_M):=\\{A(y,m):y\\in\\mathbb{Z}_q,~m\\in M\\}$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex20.m1\" class=\"ltx_Math\" alttext=\"E({\\mathcal{}}{G}_{M}):=\\{A(y,m):y\\in\\mathbb{Z}_{q},~{}m\\in M\\}\" display=\"block\"><mrow><mrow><mi>E</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>G</mi><mi>M</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>:=</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>m</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>:</mo><mrow><mrow><mi>y</mi><mo>\u2208</mo><msub><mi>\u2124</mi><mi>q</mi></msub></mrow><mo rspace=\"5.8pt\">,</mo><mrow><mi>m</mi><mo>\u2208</mo><mi>M</mi></mrow></mrow><mo stretchy=\"false\">}</mo></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n\n   \\noindent where $\\{j_1,j_2,j_3\\}=\\{1,2,3\\}$ and $a_1,a_2,a_3$ are some positive integers. Then the following three equations hold simultaneously\n\n    \n", "itemtype": "equation", "pos": 56989, "prevtext": "\n\n  \\noindent to be the edge set of our desired hypergraph, where the set $M$ is determined by the subgraphs that needed to be forbidden (these subgraphs can also be viewed as the configurations that needed to be forbidden in the desired code). Obviously $|E({\\mathcal}{G}_M)|=q|M|$ and by (\\ref{primeq}) we can verify that ${\\mathcal}{G}_M$ is also linear.\n\n  Now, we are going to choose appropriate ${\\mathcal}{B}$ and $M$ according to the properties of our desired codes. For example, to construct a 3-perfect hash family with three rows, we first set $N=3$ and then choose ${\\mathcal}{B}=\\{0,1,2\\}$, where $b_i=i-1$ for $1\\le i\\le 3  $. Therefore, to show this specified ${\\mathcal}{G}_M$ can indeed induce a $PHF^*(3,n,q,3)$, by Lemma \\ref{f3*=p3*} we only need to guarantee that $E({\\mathcal}{G})$ is triangle-free, since it is already linear (we have set $q$ to be a prime). We claim that it suffices to choose $M{\\subseteq}\\{0,1,\\ldots,{\\lfloor} (q-1)/2{\\rfloor}\\}$ to be a $2$-sum-free set such that the equation $m_1+m_2=2m_3$ has no solution except $m_1=m_2=m_3$.\n\n\n  \\begin{theorem}\\label{optimal3}\n    There exists a constant $\\gamma$ such that $p_3(3,q)>q^2e^{-\\gamma\\sqrt{\\log q}}$.\n  \\end{theorem}\n\n  \\begin{proof}\n    It suffices to show ${\\mathcal}{G}_M$ contains no triangles for arbitrary 2-sum-free set $M{\\subseteq}\\{0,1,\\ldots,{\\lfloor} (q-1)/2{\\rfloor}\\}$. If otherwise, assume that $\\{A(y_i,m_i)\\in{\\mathcal}{G}_M$:~$1\\le i\\le 3\\}$ forms a triangle. One can verify that the vertices of this triangle must locate on different parts of $V_1,V_2,V_3$. Thus we can assume that\n\n    \n", "index": 49, "text": "\\begin{equation*}\n    \\left\\{\n    \\begin{aligned}\n      A(y_1,m_1)&\\cap A(y_2,m_2)=\\{(j_2,a_2)\\}\\\\\n      A(y_2,m_2)&\\cap A(y_3,m_3)=\\{(j_3,a_3)\\}\\\\\n      A(y_3,m_3)&\\cap A(y_1,m_1)=\\{(j_1,a_1)\\}\\\\\n    \\end{aligned}\n    \\right.\n    \\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex21.m1\" class=\"ltx_Math\" alttext=\"\\left\\{\\begin{aligned} \\displaystyle A(y_{1},m_{1})&amp;\\displaystyle\\cap A(y_{2},%&#10;m_{2})=\\{(j_{2},a_{2})\\}\\\\&#10;\\displaystyle A(y_{2},m_{2})&amp;\\displaystyle\\cap A(y_{3},m_{3})=\\{(j_{3},a_{3})%&#10;\\}\\\\&#10;\\displaystyle A(y_{3},m_{3})&amp;\\displaystyle\\cap A(y_{1},m_{1})=\\{(j_{1},a_{1})%&#10;\\}\\\\&#10;\\end{aligned}\\right.\" display=\"block\"><mrow><mo>{</mo><mtable columnspacing=\"0pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"right\"><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><msub><mi>m</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mo>\u2229</mo><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mn>2</mn></msub><mo>,</mo><msub><mi>m</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>=</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>j</mi><mn>2</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">}</mo></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mn>2</mn></msub><mo>,</mo><msub><mi>m</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mo>\u2229</mo><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mn>3</mn></msub><mo>,</mo><msub><mi>m</mi><mn>3</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>=</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>j</mi><mn>3</mn></msub><mo>,</mo><msub><mi>a</mi><mn>3</mn></msub><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">}</mo></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mn>3</mn></msub><mo>,</mo><msub><mi>m</mi><mn>3</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mo>\u2229</mo><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><msub><mi>m</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>=</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>j</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">}</mo></mrow></mrow></mtd></mtr></mtable></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n\n  \\noindent  Because of the symmetry of a triangle, we can always assume that $j_1<j_2<j_3$. By a simple elimination we can infer \n", "itemtype": "equation", "pos": 57390, "prevtext": "\n\n   \\noindent where $\\{j_1,j_2,j_3\\}=\\{1,2,3\\}$ and $a_1,a_2,a_3$ are some positive integers. Then the following three equations hold simultaneously\n\n    \n", "index": 51, "text": "\\begin{equation*}\n    \\left\\{\n    \\begin{aligned}\n      y_1+(j_2-1)m_1&\\equiv y_2+(j_2-1)m_2~\\pmod{q}\\\\\n      y_2+(j_3-1)m_2&\\equiv y_3+(j_3-1)m_3~\\pmod{q}\\\\\n      y_3+(j_1-1)m_3&\\equiv y_1+(j_1-1)m_1~\\pmod{q}.\\\\\n    \\end{aligned}\n    \\right.\n    \\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex22.m1\" class=\"ltx_Math\" alttext=\"\\left\\{\\begin{aligned} \\displaystyle y_{1}+(j_{2}-1)m_{1}&amp;\\displaystyle\\equiv y%&#10;_{2}+(j_{2}-1)m_{2}~{}\\pmod{q}\\\\&#10;\\displaystyle y_{2}+(j_{3}-1)m_{2}&amp;\\displaystyle\\equiv y_{3}+(j_{3}-1)m_{3}~{}%&#10;\\pmod{q}\\\\&#10;\\displaystyle y_{3}+(j_{1}-1)m_{3}&amp;\\displaystyle\\equiv y_{1}+(j_{1}-1)m_{1}~{}%&#10;\\pmod{q}.\\\\&#10;\\end{aligned}\\right.\" display=\"block\"><mrow><mo>{</mo><mtable columnspacing=\"0pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"right\"><mrow><msub><mi>y</mi><mn>1</mn></msub><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>j</mi><mn>2</mn></msub><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>m</mi><mn>1</mn></msub></mrow></mrow></mtd><mtd columnalign=\"left\"><mrow><mi/><mo>\u2261</mo><mrow><mrow><msub><mi>y</mi><mn>2</mn></msub><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>j</mi><mn>2</mn></msub><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mpadded width=\"+3.3pt\"><msub><mi>m</mi><mn>2</mn></msub></mpadded></mrow></mrow><mspace width=\"veryverythickmathspace\"/><mrow><mo lspace=\"8.1pt\" stretchy=\"false\">(</mo><mrow><mo movablelimits=\"false\">mod</mo><mi>q</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mrow><msub><mi>y</mi><mn>2</mn></msub><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>j</mi><mn>3</mn></msub><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>m</mi><mn>2</mn></msub></mrow></mrow></mtd><mtd columnalign=\"left\"><mrow><mi/><mo>\u2261</mo><mrow><mrow><msub><mi>y</mi><mn>3</mn></msub><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>j</mi><mn>3</mn></msub><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mpadded width=\"+3.3pt\"><msub><mi>m</mi><mn>3</mn></msub></mpadded></mrow></mrow><mspace width=\"veryverythickmathspace\"/><mrow><mo lspace=\"8.1pt\" stretchy=\"false\">(</mo><mrow><mo movablelimits=\"false\">mod</mo><mi>q</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mrow><msub><mi>y</mi><mn>3</mn></msub><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>m</mi><mn>3</mn></msub></mrow></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mi/><mo>\u2261</mo><mrow><mrow><msub><mi>y</mi><mn>1</mn></msub><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mpadded width=\"+3.3pt\"><msub><mi>m</mi><mn>1</mn></msub></mpadded></mrow></mrow><mspace width=\"veryverythickmathspace\"/><mrow><mo lspace=\"8.1pt\" stretchy=\"false\">(</mo><mrow><mo movablelimits=\"false\">mod</mo><mi>q</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></mtd></mtr></mtable></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": " or simply \n", "itemtype": "equation", "pos": -1, "prevtext": "\n\n  \\noindent  Because of the symmetry of a triangle, we can always assume that $j_1<j_2<j_3$. By a simple elimination we can infer \n", "index": 53, "text": "$$(j_2-j_1)m_1+(j_3-j_2)m_2\\equiv(j_3-j_1)m_3\\pmod{q},$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex23.m1\" class=\"ltx_Math\" alttext=\"(j_{2}-j_{1})m_{1}+(j_{3}-j_{2})m_{2}\\equiv(j_{3}-j_{1})m_{3}\\pmod{q},\" display=\"block\"><mrow><mrow><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>j</mi><mn>2</mn></msub><mo>-</mo><msub><mi>j</mi><mn>1</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>m</mi><mn>1</mn></msub></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>j</mi><mn>3</mn></msub><mo>-</mo><msub><mi>j</mi><mn>2</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>m</mi><mn>2</mn></msub></mrow></mrow><mo>\u2261</mo><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>j</mi><mn>3</mn></msub><mo>-</mo><msub><mi>j</mi><mn>1</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>m</mi><mn>3</mn></msub></mrow><mspace width=\"veryverythickmathspace\"/><mrow><mo lspace=\"8.1pt\" stretchy=\"false\">(</mo><mrow><mo movablelimits=\"false\">mod</mo><mi>q</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": " This implies $m_1+m_2=2m_3$ since $m_i\\le{\\lfloor} (q-1)/2{\\rfloor}$ for all $1\\le i\\le3$, which contradicts the fact that $M$ is 2-sum-free. By Lemma \\ref{additive} there exists a 2-sum-free set $M$ with $|M|>qe^{-\\gamma\\sqrt{\\log q}}$ for some constant $\\gamma$. Therefore, it follows that $|E({\\mathcal}{G}_M)|=q|M|>|M|>q^2e^{-\\gamma\\sqrt{\\log q}}$.\n  \\end{proof}\n\n  \\section{Perfect hash families of strength four with four rows}\n\n   It is much more complicated to construct 4-perfect hash families such that $p_4(4,q)>q^{2-o(1)}$. We will use the notion of rainbow cycles and $R$-sum-free sets defined in Section 2. In fact, we are going to prove the following result:\n\n   \\begin{lemma}\\label{rainbow1}\n        $g_t^*(q)=p_t^*(t,q)$.\n   \\end{lemma}\n\n   \\begin{proof}\n        \n        First we are going to show that any $PHF^*(t;n,q,t)$ can induce a $t$-uniform $t$-partite linear hypergraph ${\\mathcal}{G}$ containing no rainbow cycles. Let $M$ denote the representation matrix of the hash family, then $M$ can also be viewed as the representation matrix of $E({\\mathcal}{G})$ by Observation 1. $M$ (resp. $E({\\mathcal}{G})$) is already linear by Lemma \\ref{linear}. It suffices to show $M$ (resp. $E({\\mathcal}{G})$) contains no rainbow cycles. Assume otherwise, the columns (resp. hyperedges) of $M$ (resp. $E({\\mathcal}{G})$) indexed by $\\alpha_1,\\ldots,\\alpha_k$ form a rainbow $k$-cycle $v_1,\\alpha_1,v_2,\\alpha_2,\\ldots,v_k,\\alpha_k,v_1$ with $k\\le t$.\n        By Observation 1, the $i$-th part of $V({\\mathcal}{G})$ can be defined as $V_i=\\{(i,j):~j\\in[q]\\}$, where the first coordinate corresponds to the $i$-th row of $M$ and the second coordinate corresponds to the $j$-th element in $[q]$. Without loss of generality, we can assume that $v_i$ is from the $i$-th part of the vertex set. Then it holds that $\\alpha_i(i)=\\alpha_{i+1}(i)$ for $1\\le i\\le k-1$ and $\\alpha_k(k)=\\alpha_1(k)$. The following submatrix induced by such $k$-cycle is contained in $M$:\n\n\n        \n", "itemtype": "equation", "pos": -1, "prevtext": " or simply \n", "index": 55, "text": "$$m_1+m_2\\equiv2m_3\\pmod{q}.$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex24.m1\" class=\"ltx_Math\" alttext=\"m_{1}+m_{2}\\equiv 2m_{3}\\pmod{q}.\" display=\"block\"><mrow><mrow><mrow><msub><mi>m</mi><mn>1</mn></msub><mo>+</mo><msub><mi>m</mi><mn>2</mn></msub></mrow><mo>\u2261</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>m</mi><mn>3</mn></msub></mrow><mspace width=\"veryverythickmathspace\"/><mrow><mo lspace=\"8.1pt\" stretchy=\"false\">(</mo><mrow><mo movablelimits=\"false\">mod</mo><mi>q</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n\n   \\noindent where in each row, the two bold coordinates are equal. Note that in this matrix, the columns represent the hyperedges and the coordinates in each column represent the vertices contained in the corresponding hyperedge. It is easy to see none of the first $k$ rows of $M$ can separate $\\{\\alpha_1,\\ldots,\\alpha_k\\}$. Note that no column of $M$ has unique coordinates, then there exist $\\alpha_{k+1},\\ldots,\\alpha_t$ such that $\\alpha_j(j)=\\alpha_1(j)$ for $k+1\\le j\\le t$, which can also be depicted by\n\n   \n", "itemtype": "equation", "pos": 59866, "prevtext": " This implies $m_1+m_2=2m_3$ since $m_i\\le{\\lfloor} (q-1)/2{\\rfloor}$ for all $1\\le i\\le3$, which contradicts the fact that $M$ is 2-sum-free. By Lemma \\ref{additive} there exists a 2-sum-free set $M$ with $|M|>qe^{-\\gamma\\sqrt{\\log q}}$ for some constant $\\gamma$. Therefore, it follows that $|E({\\mathcal}{G}_M)|=q|M|>|M|>q^2e^{-\\gamma\\sqrt{\\log q}}$.\n  \\end{proof}\n\n  \\section{Perfect hash families of strength four with four rows}\n\n   It is much more complicated to construct 4-perfect hash families such that $p_4(4,q)>q^{2-o(1)}$. We will use the notion of rainbow cycles and $R$-sum-free sets defined in Section 2. In fact, we are going to prove the following result:\n\n   \\begin{lemma}\\label{rainbow1}\n        $g_t^*(q)=p_t^*(t,q)$.\n   \\end{lemma}\n\n   \\begin{proof}\n        \n        First we are going to show that any $PHF^*(t;n,q,t)$ can induce a $t$-uniform $t$-partite linear hypergraph ${\\mathcal}{G}$ containing no rainbow cycles. Let $M$ denote the representation matrix of the hash family, then $M$ can also be viewed as the representation matrix of $E({\\mathcal}{G})$ by Observation 1. $M$ (resp. $E({\\mathcal}{G})$) is already linear by Lemma \\ref{linear}. It suffices to show $M$ (resp. $E({\\mathcal}{G})$) contains no rainbow cycles. Assume otherwise, the columns (resp. hyperedges) of $M$ (resp. $E({\\mathcal}{G})$) indexed by $\\alpha_1,\\ldots,\\alpha_k$ form a rainbow $k$-cycle $v_1,\\alpha_1,v_2,\\alpha_2,\\ldots,v_k,\\alpha_k,v_1$ with $k\\le t$.\n        By Observation 1, the $i$-th part of $V({\\mathcal}{G})$ can be defined as $V_i=\\{(i,j):~j\\in[q]\\}$, where the first coordinate corresponds to the $i$-th row of $M$ and the second coordinate corresponds to the $j$-th element in $[q]$. Without loss of generality, we can assume that $v_i$ is from the $i$-th part of the vertex set. Then it holds that $\\alpha_i(i)=\\alpha_{i+1}(i)$ for $1\\le i\\le k-1$ and $\\alpha_k(k)=\\alpha_1(k)$. The following submatrix induced by such $k$-cycle is contained in $M$:\n\n\n        \n", "index": 57, "text": "$$\\left(\n         \\begin{array}{ccccccccccc}\n           \\bm{\\alpha_1(1)}   & \\bm{\\alpha_2(1)} & \\alpha_3(1)      & \\alpha_4(1)      &        &  \\alpha_{k-1}(1)  & \\alpha_k(1)          \\\\\n           \\alpha_1(2)        & \\bm{\\alpha_2(2)} & \\bm{\\alpha_3(2)} & \\alpha_4(2)      &        &  \\alpha_{k-1}(2)  & \\alpha_k(2)          \\\\\n           \\alpha_1(3)        &                  & \\bm{\\alpha_3(3)} & \\bm{\\alpha_4(3)} &        &  \\alpha_{k-1}(3)  & \\alpha_k(3)          \\\\\n           \\vdots             &                  &                  & \\ddots           &        &      \\vdots       & \\vdots               \\\\\n           \\vdots             &                  &                  &                  & \\ddots & \\bm{\\alpha_{k-1}(k-1)}&\\bm{\\alpha_k(k-1)} \\\\\n           \\bm{\\alpha_1(k)}   &                  &                  &                  &        & & \\bm{\\alpha_k(k)}        \\\\\n         \\end{array}\n       \\right),$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex25.m1\" class=\"ltx_Math\" alttext=\"\\left(\\begin{array}[]{ccccccccccc}\\bm{\\alpha_{1}(1)}&amp;\\bm{\\alpha_{2}(1)}&amp;\\alpha%&#10;_{3}(1)&amp;\\alpha_{4}(1)&amp;&amp;\\alpha_{k-1}(1)&amp;\\alpha_{k}(1)\\\\&#10;\\alpha_{1}(2)&amp;\\bm{\\alpha_{2}(2)}&amp;\\bm{\\alpha_{3}(2)}&amp;\\alpha_{4}(2)&amp;&amp;\\alpha_{k-1%&#10;}(2)&amp;\\alpha_{k}(2)\\\\&#10;\\alpha_{1}(3)&amp;&amp;\\bm{\\alpha_{3}(3)}&amp;\\bm{\\alpha_{4}(3)}&amp;&amp;\\alpha_{k-1}(3)&amp;\\alpha_{%&#10;k}(3)\\\\&#10;\\vdots&amp;&amp;&amp;\\ddots&amp;&amp;\\vdots&amp;\\vdots\\\\&#10;\\vdots&amp;&amp;&amp;&amp;\\ddots&amp;\\bm{\\alpha_{k-1}(k-1)}&amp;\\bm{\\alpha_{k}(k-1)}\\\\&#10;\\bm{\\alpha_{1}(k)}&amp;&amp;&amp;&amp;&amp;&amp;\\bm{\\alpha_{k}(k)}\\\\&#10;\\end{array}\\right),\" display=\"block\"><mrow><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfcf</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mn>\ud835\udfcf</mn><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfd0</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mn>\ud835\udfcf</mn><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mn>3</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mn>4</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd/><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mrow><mi>k</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd/><mtd/><mtd/><mtd/></mtr><mtr><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfd0</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mn>\ud835\udfd0</mn><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfd1</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mn>\ud835\udfd0</mn><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mn>4</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd/><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mrow><mi>k</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd/><mtd/><mtd/><mtd/></mtr><mtr><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>3</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd/><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfd1</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mn>\ud835\udfd1</mn><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfd2</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mn>\ud835\udfd1</mn><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd/><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mrow><mi>k</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>3</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>3</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd/><mtd/><mtd/><mtd/></mtr><mtr><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd/><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22f1</mi></mtd><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd/><mtd/><mtd/><mtd/></mtr><mtr><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd/><mtd/><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22f1</mi></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mrow><mi>\ud835\udc8c</mi><mo mathvariant=\"bold\">-</mo><mn>\ud835\udfcf</mn></mrow></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mrow><mi>\ud835\udc8c</mi><mo mathvariant=\"bold\">-</mo><mn>\ud835\udfcf</mn></mrow><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mi>\ud835\udc8c</mi></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mrow><mi>\ud835\udc8c</mi><mo mathvariant=\"bold\">-</mo><mn>\ud835\udfcf</mn></mrow><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd/><mtd/><mtd/><mtd/></mtr><mtr><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfcf</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mi>\ud835\udc8c</mi><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd/><mtd/><mtd/><mtd/><mtd/><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mi>\ud835\udc8c</mi></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mi>\ud835\udc8c</mi><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd/><mtd/><mtd/><mtd/></mtr></mtable><mo>)</mo></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n\n   \\noindent Therefore, the left $t-k$ rows of $M$ can not separate $\\{\\alpha_1,\\alpha_{k+1},\\ldots,\\alpha_t\\}$. So we can conclude that no row of $M$ can separate $\\{\\alpha_1,\\ldots,\\alpha_t\\}$, violating the $t$-perfect hashing property.\n\n   It remains to show that any $t$-uniform $t$-partite linear hypergraph (with equal part size $q$) ${\\mathcal}{G}$ without rainbow cycles can induce a $PHF^*(t;n,q,t)$ such that $n=|E({\\mathcal}{G})|$. We also use $M$ to denote the representation matrix of $E({\\mathcal}{G})$. We claim that if there exists a $t\\times t$ submatrix $T$ of $M$ such that no row can separate it, then the hypergraph induced by $T$ will contain a rainbow $k$-cycle with $k\\le t$.\n\n   We will argue by induction on $t$. The case $t=3$ has been proved in Lemma \\ref{f3*=p3*}. Assume the statement is true for $t-1$. Take a $t\\times t$ matrix $T$ with columns indexed by $C=\\{\\alpha_1,\\ldots,\\alpha_t\\}$ and rows indexed by $R=\\{r_1,\\ldots,r_t\\}$ such that no row can separate $C$. We denote $C_i=C-\\{\\alpha_i\\}$ and $R_i=R-\\{r_i\\}$ for each $1\\le i\\le t$. Furthermore, we use $T_{ij}$ to denote the $(t-1)\\times(t-1)$ submatrix formed by $R_i$ and $C_j$. Then for any submatrix $T_{ij}$, there must exist a row that separates all columns of $T_{ij}$ since otherwise $T_{ij}$ contains a rainbow $k$-cycle with $k\\le t-1$ by the induction hypothesis.\n\n   Without loss of generality, assume $r_1$ separates $C_t$. Note that this row can not separate $C$, so we can assume further that $\\alpha_t(1)=\\alpha_1(1)$. Then consider $T_{11}$, there exists a row in $R-\\{r_1\\}$ that separates $C-\\{\\alpha_1\\}$. We can set this row to be $r_2$. Similarly, there exists $2\\le j\\le t$ such that $\\alpha_1(2)=\\alpha_j(2)$ since $r_2$ can not separate $C$. Then $j\\neq t$ since $\\alpha_1$ and $\\alpha_t$ have already agreed on one coordinate, say, $\\alpha_t(1)=\\alpha_1(1)$. Assume that $\\alpha_1(2)=\\alpha_2(2)$. Now consider $T_{22}$, then there exists a row in $R-\\{r_2\\}$ that separates $C-\\{\\alpha_2\\}$. Note that this row can not be $r_1$ since $\\alpha_1$ and $\\alpha_t$ agree on their first coordinate. We can set this row to be $r_3$. For the same reason, there exists $j\\in[t],j\\neq2$ such that $\\alpha_2(3)=\\alpha_j(3)$. Then $j\\neq 1$ since it already holds $\\alpha_1(2)=\\alpha_2(2)$. If $j=t$, we are done since $\\{\\alpha_1,\\alpha_2,\\alpha_t\\}$ forms a rainbow 3-cycle. So we can set $j=3$.\n\n   The above discussion can be depicted by the following matrix:\n\n    \n", "itemtype": "equation", "pos": 61307, "prevtext": "\n\n   \\noindent where in each row, the two bold coordinates are equal. Note that in this matrix, the columns represent the hyperedges and the coordinates in each column represent the vertices contained in the corresponding hyperedge. It is easy to see none of the first $k$ rows of $M$ can separate $\\{\\alpha_1,\\ldots,\\alpha_k\\}$. Note that no column of $M$ has unique coordinates, then there exist $\\alpha_{k+1},\\ldots,\\alpha_t$ such that $\\alpha_j(j)=\\alpha_1(j)$ for $k+1\\le j\\le t$, which can also be depicted by\n\n   \n", "index": 59, "text": "$$\\left(\n          \\begin{array}{cccccc}\n            \\bm{\\alpha_1(k+1)} & \\bm{\\alpha_{k+1}(k+1)} & *         & *      & *      & * \\\\\n            \\bm{\\alpha_1(k+2)} & *         & \\bm{\\alpha_{k+2}(k+2)} & *      & *      & * \\\\\n            \\vdots    & *         & *         & \\ddots & *      & * \\\\\n            \\vdots    & *         & *         & *      & \\ddots & * \\\\\n            \\bm{\\alpha_1(t)} & *         & *         & *      & *      & \\bm{\\alpha_t(t)} \\\\\n          \\end{array}\n        \\right).$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex26.m1\" class=\"ltx_Math\" alttext=\"\\left(\\begin{array}[]{cccccc}\\bm{\\alpha_{1}(k+1)}&amp;\\bm{\\alpha_{k+1}(k+1)}&amp;*&amp;*&amp;*%&#10;&amp;*\\\\&#10;\\bm{\\alpha_{1}(k+2)}&amp;*&amp;\\bm{\\alpha_{k+2}(k+2)}&amp;*&amp;*&amp;*\\\\&#10;\\vdots&amp;*&amp;*&amp;\\ddots&amp;*&amp;*\\\\&#10;\\vdots&amp;*&amp;*&amp;*&amp;\\ddots&amp;*\\\\&#10;\\bm{\\alpha_{1}(t)}&amp;*&amp;*&amp;*&amp;*&amp;\\bm{\\alpha_{t}(t)}\\\\&#10;\\end{array}\\right).\" display=\"block\"><mrow><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfcf</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mrow><mi>\ud835\udc8c</mi><mo mathvariant=\"bold\">+</mo><mn>\ud835\udfcf</mn></mrow><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mrow><mi>\ud835\udc8c</mi><mo mathvariant=\"bold\">+</mo><mn>\ud835\udfcf</mn></mrow></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mrow><mi>\ud835\udc8c</mi><mo mathvariant=\"bold\">+</mo><mn>\ud835\udfcf</mn></mrow><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfcf</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mrow><mi>\ud835\udc8c</mi><mo mathvariant=\"bold\">+</mo><mn>\ud835\udfd0</mn></mrow><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mrow><mi>\ud835\udc8c</mi><mo mathvariant=\"bold\">+</mo><mn>\ud835\udfd0</mn></mrow></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mrow><mi>\ud835\udc8c</mi><mo mathvariant=\"bold\">+</mo><mn>\ud835\udfd0</mn></mrow><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22f1</mi></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22f1</mi></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfcf</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mi>\ud835\udc95</mi><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mi>\ud835\udc95</mi></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mi>\ud835\udc95</mi><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd></mtr></mtable><mo>)</mo></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n\n   \\noindent where in each row, the two bold coordinates are equal. We continue this procedure for $T_{i,i}$ with $i\\ge3$. By our choice, for all $1\\le j\\le i$, in row $r_j$ it holds that $\\alpha_{j-1}(j)=\\alpha_j(j)$ ($\\alpha_0$ is recognised as $\\alpha_t$). Thus no row in $\\{r_1,\\ldots,r_{i}\\}$ can separate $T_{i,i}$. We can always assume that $r_{i+1}\\in R-\\{r_i\\}$ is the row that separates $C-\\{\\alpha_i\\}$. Then there exists a $j\\in[t],j\\neq i$ such that $\\alpha_i(i+1)=\\alpha_j(i+1)$ since $r_{i+1}$ can not separate the whole $C$. Obviously, $j\\neq i-1$. If $j\\in\\{1,\\ldots,i-2\\}$ or $j=t$, then such choice of $j$ will induce a rainbow $(i-j+1)$-cycle formed by $\\{\\alpha_j,\\ldots,\\alpha_i\\}$\n\n   \n", "itemtype": "equation", "pos": 64288, "prevtext": "\n\n   \\noindent Therefore, the left $t-k$ rows of $M$ can not separate $\\{\\alpha_1,\\alpha_{k+1},\\ldots,\\alpha_t\\}$. So we can conclude that no row of $M$ can separate $\\{\\alpha_1,\\ldots,\\alpha_t\\}$, violating the $t$-perfect hashing property.\n\n   It remains to show that any $t$-uniform $t$-partite linear hypergraph (with equal part size $q$) ${\\mathcal}{G}$ without rainbow cycles can induce a $PHF^*(t;n,q,t)$ such that $n=|E({\\mathcal}{G})|$. We also use $M$ to denote the representation matrix of $E({\\mathcal}{G})$. We claim that if there exists a $t\\times t$ submatrix $T$ of $M$ such that no row can separate it, then the hypergraph induced by $T$ will contain a rainbow $k$-cycle with $k\\le t$.\n\n   We will argue by induction on $t$. The case $t=3$ has been proved in Lemma \\ref{f3*=p3*}. Assume the statement is true for $t-1$. Take a $t\\times t$ matrix $T$ with columns indexed by $C=\\{\\alpha_1,\\ldots,\\alpha_t\\}$ and rows indexed by $R=\\{r_1,\\ldots,r_t\\}$ such that no row can separate $C$. We denote $C_i=C-\\{\\alpha_i\\}$ and $R_i=R-\\{r_i\\}$ for each $1\\le i\\le t$. Furthermore, we use $T_{ij}$ to denote the $(t-1)\\times(t-1)$ submatrix formed by $R_i$ and $C_j$. Then for any submatrix $T_{ij}$, there must exist a row that separates all columns of $T_{ij}$ since otherwise $T_{ij}$ contains a rainbow $k$-cycle with $k\\le t-1$ by the induction hypothesis.\n\n   Without loss of generality, assume $r_1$ separates $C_t$. Note that this row can not separate $C$, so we can assume further that $\\alpha_t(1)=\\alpha_1(1)$. Then consider $T_{11}$, there exists a row in $R-\\{r_1\\}$ that separates $C-\\{\\alpha_1\\}$. We can set this row to be $r_2$. Similarly, there exists $2\\le j\\le t$ such that $\\alpha_1(2)=\\alpha_j(2)$ since $r_2$ can not separate $C$. Then $j\\neq t$ since $\\alpha_1$ and $\\alpha_t$ have already agreed on one coordinate, say, $\\alpha_t(1)=\\alpha_1(1)$. Assume that $\\alpha_1(2)=\\alpha_2(2)$. Now consider $T_{22}$, then there exists a row in $R-\\{r_2\\}$ that separates $C-\\{\\alpha_2\\}$. Note that this row can not be $r_1$ since $\\alpha_1$ and $\\alpha_t$ agree on their first coordinate. We can set this row to be $r_3$. For the same reason, there exists $j\\in[t],j\\neq2$ such that $\\alpha_2(3)=\\alpha_j(3)$. Then $j\\neq 1$ since it already holds $\\alpha_1(2)=\\alpha_2(2)$. If $j=t$, we are done since $\\{\\alpha_1,\\alpha_2,\\alpha_t\\}$ forms a rainbow 3-cycle. So we can set $j=3$.\n\n   The above discussion can be depicted by the following matrix:\n\n    \n", "index": 61, "text": "$$\\left(\n     \\begin{array}{ccccccccccccccccc}\n       \\bm{\\alpha_1(1)} & \\alpha_2(1) & \\alpha_3(1) & \\alpha_4(1) & \\cdots & \\cdots & \\alpha_{t-1}(1) & \\bm{\\alpha_t(1)} \\\\\n       \\bm{\\alpha_1(2)} & \\bm{\\alpha_2(2)} & \\alpha_3(2) & \\alpha_4(2) & \\cdots & \\cdots & \\alpha_{t-1}(2) & \\alpha_t(2) \\\\\n       \\alpha_1(3) & \\bm{\\alpha_2(3)} & \\bm{\\alpha_3(3)} & \\alpha_4(3) & \\cdots & \\cdots & \\alpha_{t-1}(3) & \\alpha_t(3) \\\\\n       \\alpha_1(4) & \\alpha_2(4) & \\bm{\\alpha_3(4)} & \\bm{\\alpha_4(4)} & \\cdots & \\cdots & \\alpha_{t-1}(4) & \\alpha_t(4) \\\\\n                   &             &             &   \\ddots    &        &        &                 &              \\\\\n                   &             &             &             & \\ddots &        &                 &              \\\\\n       \\alpha_1(i-1) & \\cdots & \\bm{\\alpha_{i-2}(i-1)}  &\\bm{\\alpha_{i-1}(i-1)} & & \\cdots & \\cdots & \\alpha_t(i+1) \\\\\n       \\alpha_1(i) & \\cdots & &  \\bm{\\alpha_{i-1}(i)} & \\bm{\\alpha_{i}(i)} &  &  \\cdots&  \\alpha_t(i+1) \\\\\n       \\alpha_1(i+1) & \\cdots & &  & \\bm{\\alpha_{i}(i+1)} & \\bm{\\alpha_{i+1}(i+1)} & \\cdots & \\alpha_t(i+1) \\\\\n                   &             &             &   \\ddots    &        &        &                 &              \\\\\n                   &             &             &             & \\ddots &        &                 &              \\\\\n     \\end{array}\n   \\right),$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex27.m1\" class=\"ltx_Math\" alttext=\"\\left(\\begin{array}[]{ccccccccccccccccc}\\bm{\\alpha_{1}(1)}&amp;\\alpha_{2}(1)&amp;%&#10;\\alpha_{3}(1)&amp;\\alpha_{4}(1)&amp;\\cdots&amp;\\cdots&amp;\\alpha_{t-1}(1)&amp;\\bm{\\alpha_{t}(1)}\\\\&#10;\\bm{\\alpha_{1}(2)}&amp;\\bm{\\alpha_{2}(2)}&amp;\\alpha_{3}(2)&amp;\\alpha_{4}(2)&amp;\\cdots&amp;%&#10;\\cdots&amp;\\alpha_{t-1}(2)&amp;\\alpha_{t}(2)\\\\&#10;\\alpha_{1}(3)&amp;\\bm{\\alpha_{2}(3)}&amp;\\bm{\\alpha_{3}(3)}&amp;\\alpha_{4}(3)&amp;\\cdots&amp;%&#10;\\cdots&amp;\\alpha_{t-1}(3)&amp;\\alpha_{t}(3)\\\\&#10;\\alpha_{1}(4)&amp;\\alpha_{2}(4)&amp;\\bm{\\alpha_{3}(4)}&amp;\\bm{\\alpha_{4}(4)}&amp;\\cdots&amp;%&#10;\\cdots&amp;\\alpha_{t-1}(4)&amp;\\alpha_{t}(4)\\\\&#10;&amp;&amp;&amp;\\ddots&amp;&amp;&amp;&amp;\\\\&#10;&amp;&amp;&amp;&amp;\\ddots&amp;&amp;&amp;\\\\&#10;\\alpha_{1}(i-1)&amp;\\cdots&amp;\\bm{\\alpha_{i-2}(i-1)}&amp;\\bm{\\alpha_{i-1}(i-1)}&amp;&amp;\\cdots&amp;%&#10;\\cdots&amp;\\alpha_{t}(i+1)\\\\&#10;\\alpha_{1}(i)&amp;\\cdots&amp;&amp;\\bm{\\alpha_{i-1}(i)}&amp;\\bm{\\alpha_{i}(i)}&amp;&amp;\\cdots&amp;\\alpha_{%&#10;t}(i+1)\\\\&#10;\\alpha_{1}(i+1)&amp;\\cdots&amp;&amp;&amp;\\bm{\\alpha_{i}(i+1)}&amp;\\bm{\\alpha_{i+1}(i+1)}&amp;\\cdots&amp;%&#10;\\alpha_{t}(i+1)\\\\&#10;&amp;&amp;&amp;\\ddots&amp;&amp;&amp;&amp;\\\\&#10;&amp;&amp;&amp;&amp;\\ddots&amp;&amp;&amp;\\\\&#10;\\end{array}\\right),\" display=\"block\"><mrow><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfcf</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mn>\ud835\udfcf</mn><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mn>3</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mn>4</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mrow><mi>t</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mi>\ud835\udc95</mi></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mn>\ud835\udfcf</mn><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/></mtr><mtr><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfcf</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mn>\ud835\udfd0</mn><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfd0</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mn>\ud835\udfd0</mn><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mn>3</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mn>4</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mrow><mi>t</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mi>t</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/></mtr><mtr><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>3</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfd0</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mn>\ud835\udfd1</mn><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfd1</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mn>\ud835\udfd1</mn><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mn>4</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>3</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mrow><mi>t</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>3</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mi>t</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>3</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/></mtr><mtr><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>4</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>4</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfd1</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mn>\ud835\udfd2</mn><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfd2</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mn>\ud835\udfd2</mn><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mrow><mi>t</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>4</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mi>t</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>4</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/></mtr><mtr><mtd/><mtd/><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22f1</mi></mtd><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/></mtr><mtr><mtd/><mtd/><mtd/><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22f1</mi></mtd><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/></mtr><mtr><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>i</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mrow><mi>\ud835\udc8a</mi><mo mathvariant=\"bold\">-</mo><mn>\ud835\udfd0</mn></mrow></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mrow><mi>\ud835\udc8a</mi><mo mathvariant=\"bold\">-</mo><mn>\ud835\udfcf</mn></mrow><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mrow><mi>\ud835\udc8a</mi><mo mathvariant=\"bold\">-</mo><mn>\ud835\udfcf</mn></mrow></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mrow><mi>\ud835\udc8a</mi><mo mathvariant=\"bold\">-</mo><mn>\ud835\udfcf</mn></mrow><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mi>t</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/></mtr><mtr><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd/><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mrow><mi>\ud835\udc8a</mi><mo mathvariant=\"bold\">-</mo><mn>\ud835\udfcf</mn></mrow></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mi>\ud835\udc8a</mi><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mi>\ud835\udc8a</mi></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mi>\ud835\udc8a</mi><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mi>t</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/></mtr><mtr><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd/><mtd/><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mi>\ud835\udc8a</mi></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mrow><mi>\ud835\udc8a</mi><mo mathvariant=\"bold\">+</mo><mn>\ud835\udfcf</mn></mrow><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mrow><mi>\ud835\udc8a</mi><mo mathvariant=\"bold\">+</mo><mn>\ud835\udfcf</mn></mrow></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mrow><mi>\ud835\udc8a</mi><mo mathvariant=\"bold\">+</mo><mn>\ud835\udfcf</mn></mrow><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\u03b1</mi><mi>t</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/></mtr><mtr><mtd/><mtd/><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22f1</mi></mtd><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/></mtr><mtr><mtd/><mtd/><mtd/><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22f1</mi></mtd><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/></mtr></mtable><mo>)</mo></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n\n   \\noindent or a rainbow $(i+1)$-cycle formed by $\\{\\alpha_1,\\ldots,\\alpha_i,\\alpha_t\\}$\n\n       \n", "itemtype": "equation", "pos": 66368, "prevtext": "\n\n   \\noindent where in each row, the two bold coordinates are equal. We continue this procedure for $T_{i,i}$ with $i\\ge3$. By our choice, for all $1\\le j\\le i$, in row $r_j$ it holds that $\\alpha_{j-1}(j)=\\alpha_j(j)$ ($\\alpha_0$ is recognised as $\\alpha_t$). Thus no row in $\\{r_1,\\ldots,r_{i}\\}$ can separate $T_{i,i}$. We can always assume that $r_{i+1}\\in R-\\{r_i\\}$ is the row that separates $C-\\{\\alpha_i\\}$. Then there exists a $j\\in[t],j\\neq i$ such that $\\alpha_i(i+1)=\\alpha_j(i+1)$ since $r_{i+1}$ can not separate the whole $C$. Obviously, $j\\neq i-1$. If $j\\in\\{1,\\ldots,i-2\\}$ or $j=t$, then such choice of $j$ will induce a rainbow $(i-j+1)$-cycle formed by $\\{\\alpha_j,\\ldots,\\alpha_i\\}$\n\n   \n", "index": 63, "text": "$$\\left(\n          \\begin{array}{cccccccccc}\n                \\bm{\\alpha_j(j+1)} & \\bm{\\alpha_{j+1}(j+1)} & * &  & *  &  *    \\\\\n                * & \\bm{\\alpha_{j+1}(j+2)} & \\bm{\\alpha_{j+2}(j+2)} &  & * &  *    \\\\\n                \\vdots & \\vdots & \\vdots & \\ddots &  &  \\vdots   \\\\\n                \\vdots & \\vdots & \\vdots &  & \\ddots &    \\vdots \\\\\n                \\\\\n              * & * & * &  & \\bm{\\alpha_{i-1}(i)} & \\bm{\\alpha_i(i)}  \\\\\n                \\bm{\\alpha_j(i+1)} & * & * &  & * & \\bm{\\alpha_{i}(i+1)}   \\\\\n          \\end{array}\n    \\right)$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex28.m1\" class=\"ltx_Math\" alttext=\"\\left(\\begin{array}[]{cccccccccc}\\bm{\\alpha_{j}(j+1)}&amp;\\bm{\\alpha_{j+1}(j+1)}&amp;*%&#10;&amp;&amp;*&amp;*\\\\&#10;*&amp;\\bm{\\alpha_{j+1}(j+2)}&amp;\\bm{\\alpha_{j+2}(j+2)}&amp;&amp;*&amp;*\\\\&#10;\\vdots&amp;\\vdots&amp;\\vdots&amp;\\ddots&amp;&amp;\\vdots\\\\&#10;\\vdots&amp;\\vdots&amp;\\vdots&amp;&amp;\\ddots&amp;\\vdots\\\\&#10;\\\\&#10;*&amp;*&amp;*&amp;&amp;\\bm{\\alpha_{i-1}(i)}&amp;\\bm{\\alpha_{i}(i)}\\\\&#10;\\bm{\\alpha_{j}(i+1)}&amp;*&amp;*&amp;&amp;*&amp;\\bm{\\alpha_{i}(i+1)}\\\\&#10;\\end{array}\\right)\" display=\"block\"><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mi>\ud835\udc8b</mi></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mrow><mi>\ud835\udc8b</mi><mo mathvariant=\"bold\">+</mo><mn>\ud835\udfcf</mn></mrow><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mrow><mi>\ud835\udc8b</mi><mo mathvariant=\"bold\">+</mo><mn>\ud835\udfcf</mn></mrow></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mrow><mi>\ud835\udc8b</mi><mo mathvariant=\"bold\">+</mo><mn>\ud835\udfcf</mn></mrow><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd/><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd/><mtd/><mtd/><mtd/></mtr><mtr><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mrow><mi>\ud835\udc8b</mi><mo mathvariant=\"bold\">+</mo><mn>\ud835\udfcf</mn></mrow></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mrow><mi>\ud835\udc8b</mi><mo mathvariant=\"bold\">+</mo><mn>\ud835\udfd0</mn></mrow><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mrow><mi>\ud835\udc8b</mi><mo mathvariant=\"bold\">+</mo><mn>\ud835\udfd0</mn></mrow></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mrow><mi>\ud835\udc8b</mi><mo mathvariant=\"bold\">+</mo><mn>\ud835\udfd0</mn></mrow><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd/><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd/><mtd/><mtd/><mtd/></mtr><mtr><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22f1</mi></mtd><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd/><mtd/><mtd/><mtd/></mtr><mtr><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22f1</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd/><mtd/><mtd/><mtd/></mtr><mtr><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/></mtr><mtr><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd/><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mrow><mi>\ud835\udc8a</mi><mo mathvariant=\"bold\">-</mo><mn>\ud835\udfcf</mn></mrow></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mi>\ud835\udc8a</mi><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mi>\ud835\udc8a</mi></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mi>\ud835\udc8a</mi><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd/><mtd/><mtd/><mtd/></mtr><mtr><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mi>\ud835\udc8b</mi></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mrow><mi>\ud835\udc8a</mi><mo mathvariant=\"bold\">+</mo><mn>\ud835\udfcf</mn></mrow><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd/><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mi>\ud835\udc8a</mi></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mrow><mi>\ud835\udc8a</mi><mo mathvariant=\"bold\">+</mo><mn>\ud835\udfcf</mn></mrow><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd/><mtd/><mtd/><mtd/></mtr></mtable><mo>)</mo></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n\n    \\noindent If neither of above cases holds, we can always assume that $j=i+1$ and continue this procedure.\n\n    This procedure will end when it comes to $T_{t-1,t-1}$ with $\\alpha_{t-1}(t)=\\alpha_t(t)$. Then $\\{\\alpha_1,\\ldots,\\alpha_t\\}$ will form a rainbow $t$-cycle and our desired contradiction follows.\n   \\end{proof}\n\n  We can use a similar method as that of the previous section to construct 4-perfect hash family with four rows. However, we can not simply take ${\\mathcal}{B}=\\{0,1,2,3\\}$ since such choice will lead to an equation \n", "itemtype": "equation", "pos": 67023, "prevtext": "\n\n   \\noindent or a rainbow $(i+1)$-cycle formed by $\\{\\alpha_1,\\ldots,\\alpha_i,\\alpha_t\\}$\n\n       \n", "index": 65, "text": "$$\\left(\n           \\begin{array}{cccccccc}\n             \\bm{\\alpha_1(1)} & * & * &  &  &  & \\cdots & \\bm{\\alpha_t(1)} \\\\\n             \\bm{\\alpha_1(2)} & \\bm{\\alpha_2(2)} & * &  &  &  & \\cdots & * \\\\\n             * & \\bm{\\alpha_2(3)} & \\bm{\\alpha_3(3)} &  & &  & \\cdots & * \\\\\n             \\vdots & \\vdots &  & \\ddots &  & & \\cdots & \\vdots \\\\\n             \\vdots & \\vdots & \\vdots &  & \\ddots &  & \\cdots & \\vdots \\\\\n             \\\\\n             * & * & * &  & \\bm{\\alpha_{i-1}(i)} & \\bm{\\alpha_i(i)} &  & * \\\\\n             * & * & * &  &  & \\bm{\\alpha_i(i+1)} & \\cdots & \\bm{\\alpha_t(i+1)} \\\\\n           \\end{array}\n         \\right).$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex29.m1\" class=\"ltx_Math\" alttext=\"\\left(\\begin{array}[]{cccccccc}\\bm{\\alpha_{1}(1)}&amp;*&amp;*&amp;&amp;&amp;&amp;\\cdots&amp;\\bm{\\alpha_{t}%&#10;(1)}\\\\&#10;\\bm{\\alpha_{1}(2)}&amp;\\bm{\\alpha_{2}(2)}&amp;*&amp;&amp;&amp;&amp;\\cdots&amp;*\\\\&#10;*&amp;\\bm{\\alpha_{2}(3)}&amp;\\bm{\\alpha_{3}(3)}&amp;&amp;&amp;&amp;\\cdots&amp;*\\\\&#10;\\vdots&amp;\\vdots&amp;&amp;\\ddots&amp;&amp;&amp;\\cdots&amp;\\vdots\\\\&#10;\\vdots&amp;\\vdots&amp;\\vdots&amp;&amp;\\ddots&amp;&amp;\\cdots&amp;\\vdots\\\\&#10;\\\\&#10;*&amp;*&amp;*&amp;&amp;\\bm{\\alpha_{i-1}(i)}&amp;\\bm{\\alpha_{i}(i)}&amp;&amp;*\\\\&#10;*&amp;*&amp;*&amp;&amp;&amp;\\bm{\\alpha_{i}(i+1)}&amp;\\cdots&amp;\\bm{\\alpha_{t}(i+1)}\\\\&#10;\\end{array}\\right).\" display=\"block\"><mrow><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfcf</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mn>\ud835\udfcf</mn><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd/><mtd/><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mi>\ud835\udc95</mi></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mn>\ud835\udfcf</mn><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfcf</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mn>\ud835\udfd0</mn><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfd0</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mn>\ud835\udfd0</mn><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd/><mtd/><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfd0</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mn>\ud835\udfd1</mn><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mn>\ud835\udfd1</mn></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mn>\ud835\udfd1</mn><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd/><mtd/><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22f1</mi></mtd><mtd/><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd></mtr><mtr><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22f1</mi></mtd><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ee</mi></mtd></mtr><mtr><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/></mtr><mtr><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd/><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mrow><mi>\ud835\udc8a</mi><mo mathvariant=\"bold\">-</mo><mn>\ud835\udfcf</mn></mrow></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mi>\ud835\udc8a</mi><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mi>\ud835\udc8a</mi></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mi>\ud835\udc8a</mi><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd/><mtd columnalign=\"center\"><mo>*</mo></mtd></mtr><mtr><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd columnalign=\"center\"><mo>*</mo></mtd><mtd/><mtd/><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mi>\ud835\udc8a</mi></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mrow><mi>\ud835\udc8a</mi><mo mathvariant=\"bold\">+</mo><mn>\ud835\udfcf</mn></mrow><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22ef</mi></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\ud835\udf36</mi><mi>\ud835\udc95</mi></msub><mo>\u2062</mo><mrow><mo mathvariant=\"bold\" stretchy=\"false\">(</mo><mrow><mi>\ud835\udc8a</mi><mo mathvariant=\"bold\">+</mo><mn>\ud835\udfcf</mn></mrow><mo mathvariant=\"bold\" stretchy=\"false\">)</mo></mrow></mrow></mtd></mtr></mtable><mo>)</mo></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": " whose solution is not easy to determine as suggested by Ruzsa \\cite{ruzsa}. In order to show $p_4(4,q)>q^{2-o(1)}$, we should choose ${\\mathcal}{B}$ more carefully. Recall that we have set $q$ to be a prime.\n\n \\begin{lemma}\\label{rainbow2}\n     Let $R=\\{b_1,\\ldots,b_{r}\\}{\\subseteq}\\{0,\\ldots,q-1\\}$ be an $r$-element subset with rank $r(R)$. If $M{\\subseteq}\\{0,1,\\ldots,\\lfloor (q-1)/r(R)\\rfloor\\}$ is an $R$-sum-free set, then the hypergraph defined by \n", "itemtype": "equation", "pos": -1, "prevtext": "\n\n    \\noindent If neither of above cases holds, we can always assume that $j=i+1$ and continue this procedure.\n\n    This procedure will end when it comes to $T_{t-1,t-1}$ with $\\alpha_{t-1}(t)=\\alpha_t(t)$. Then $\\{\\alpha_1,\\ldots,\\alpha_t\\}$ will form a rainbow $t$-cycle and our desired contradiction follows.\n   \\end{proof}\n\n  We can use a similar method as that of the previous section to construct 4-perfect hash family with four rows. However, we can not simply take ${\\mathcal}{B}=\\{0,1,2,3\\}$ since such choice will lead to an equation \n", "index": 67, "text": "$$2m_1+2m_2-3m_3-m_4=0,$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex30.m1\" class=\"ltx_Math\" alttext=\"2m_{1}+2m_{2}-3m_{3}-m_{4}=0,\" display=\"block\"><mrow><mrow><mrow><mrow><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>m</mi><mn>1</mn></msub></mrow><mo>+</mo><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>m</mi><mn>2</mn></msub></mrow></mrow><mo>-</mo><mrow><mn>3</mn><mo>\u2062</mo><msub><mi>m</mi><mn>3</mn></msub></mrow><mo>-</mo><msub><mi>m</mi><mn>4</mn></msub></mrow><mo>=</mo><mn>0</mn></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": " where $A(y,m)=\\{(i,y+b_im):b_i\\in R\\}$, is an $r$-uniform $r$-partite linear hypergraph containing no rainbow cycles.\n  \\end{lemma}\n\n  \\begin{proof}\n    First it is easy to see ${\\mathcal}{G}_M$ is $r$-uniform and $r$-partite with $V({\\mathcal}{G}_M)=\\cup_{j=1}^r V_j$, where $V_j=\\{(j,y):y\\in\\mathbb{Z}_q\\}$, $1\\le j\\le N$. To see ${\\mathcal}{G}_M$ is also linear, one just needs to notice that if $|A(y,m)\\cap A(y',m')|\\ge2$, then there are $b_1,b_2\\in R$, $b_1\\neq b_2$ such that\n\n    \n", "itemtype": "equation", "pos": -1, "prevtext": " whose solution is not easy to determine as suggested by Ruzsa \\cite{ruzsa}. In order to show $p_4(4,q)>q^{2-o(1)}$, we should choose ${\\mathcal}{B}$ more carefully. Recall that we have set $q$ to be a prime.\n\n \\begin{lemma}\\label{rainbow2}\n     Let $R=\\{b_1,\\ldots,b_{r}\\}{\\subseteq}\\{0,\\ldots,q-1\\}$ be an $r$-element subset with rank $r(R)$. If $M{\\subseteq}\\{0,1,\\ldots,\\lfloor (q-1)/r(R)\\rfloor\\}$ is an $R$-sum-free set, then the hypergraph defined by \n", "index": 69, "text": "$$E({\\mathcal}{G}_M)=\\{A(y,m):y\\in\\mathbb{Z}_q,~m\\in M\\},$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex31.m1\" class=\"ltx_Math\" alttext=\"E({\\mathcal{}}{G}_{M})=\\{A(y,m):y\\in\\mathbb{Z}_{q},~{}m\\in M\\},\" display=\"block\"><mrow><mrow><mrow><mi>E</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>G</mi><mi>M</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>m</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>:</mo><mrow><mrow><mi>y</mi><mo>\u2208</mo><msub><mi>\u2124</mi><mi>q</mi></msub></mrow><mo rspace=\"5.8pt\">,</mo><mrow><mi>m</mi><mo>\u2208</mo><mi>M</mi></mrow></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n    \\noindent Then we can infer $(b_1-b_2)(m-m')\\equiv 0 \\pmod{q}$, which is a contradiction with $q$ prime.\n\n    Now it remains to show that ${\\mathcal}{G}_M$ indeed contains no rainbow cycles. Assume the contrary, it contains a rainbow $k$-cycle with $k\\le r$, denoted by $v_1,A(y_1,m_1),v_2,A(y_2,m_2),\\ldots,v_k,A(y_k,m_k),v_1$, where $v_i\\in V_{j_i}$ and $j_{i_1}\\neq j_{i_2}$ for $i_1\\neq i_2$ by the definition of a rainbow cycle. The following $k$ equations hold simultaneously:\n\n    \n", "itemtype": "equation", "pos": 69236, "prevtext": " where $A(y,m)=\\{(i,y+b_im):b_i\\in R\\}$, is an $r$-uniform $r$-partite linear hypergraph containing no rainbow cycles.\n  \\end{lemma}\n\n  \\begin{proof}\n    First it is easy to see ${\\mathcal}{G}_M$ is $r$-uniform and $r$-partite with $V({\\mathcal}{G}_M)=\\cup_{j=1}^r V_j$, where $V_j=\\{(j,y):y\\in\\mathbb{Z}_q\\}$, $1\\le j\\le N$. To see ${\\mathcal}{G}_M$ is also linear, one just needs to notice that if $|A(y,m)\\cap A(y',m')|\\ge2$, then there are $b_1,b_2\\in R$, $b_1\\neq b_2$ such that\n\n    \n", "index": 71, "text": "\\begin{equation*}\n    \\left\\{\n        \\begin{aligned}\n            y+b_1m &\\equiv y'+b_1m' \\pmod{q}\\\\\n            y+b_2m &\\equiv y'+b_2m' \\pmod{q}.\\\\\n        \\end{aligned}\n    \\right.\n    \\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex32.m1\" class=\"ltx_Math\" alttext=\"\\left\\{\\begin{aligned} \\displaystyle y+b_{1}m&amp;\\displaystyle\\equiv y^{\\prime}+b%&#10;_{1}m^{\\prime}\\pmod{q}\\\\&#10;\\displaystyle y+b_{2}m&amp;\\displaystyle\\equiv y^{\\prime}+b_{2}m^{\\prime}\\pmod{q}.%&#10;\\\\&#10;\\end{aligned}\\right.\" display=\"block\"><mrow><mo>{</mo><mtable columnspacing=\"0pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"right\"><mrow><mi>y</mi><mo>+</mo><mrow><msub><mi>b</mi><mn>1</mn></msub><mo>\u2062</mo><mi>m</mi></mrow></mrow></mtd><mtd columnalign=\"left\"><mrow><mi/><mo>\u2261</mo><mrow><mrow><msup><mi>y</mi><mo>\u2032</mo></msup><mo>+</mo><mrow><msub><mi>b</mi><mn>1</mn></msub><mo>\u2062</mo><msup><mi>m</mi><mo>\u2032</mo></msup></mrow></mrow><mspace width=\"veryverythickmathspace\"/><mrow><mo lspace=\"8.1pt\" stretchy=\"false\">(</mo><mrow><mo movablelimits=\"false\">mod</mo><mi>q</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mrow><mi>y</mi><mo>+</mo><mrow><msub><mi>b</mi><mn>2</mn></msub><mo>\u2062</mo><mi>m</mi></mrow></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mi/><mo>\u2261</mo><mrow><mrow><msup><mi>y</mi><mo>\u2032</mo></msup><mo>+</mo><mrow><msub><mi>b</mi><mn>2</mn></msub><mo>\u2062</mo><msup><mi>m</mi><mo>\u2032</mo></msup></mrow></mrow><mspace width=\"veryverythickmathspace\"/><mrow><mo lspace=\"8.1pt\" stretchy=\"false\">(</mo><mrow><mo movablelimits=\"false\">mod</mo><mi>q</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></mtd></mtr></mtable></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n    \\noindent By a simple elimination, one can infer\n    \n", "itemtype": "equation", "pos": 69931, "prevtext": "\n    \\noindent Then we can infer $(b_1-b_2)(m-m')\\equiv 0 \\pmod{q}$, which is a contradiction with $q$ prime.\n\n    Now it remains to show that ${\\mathcal}{G}_M$ indeed contains no rainbow cycles. Assume the contrary, it contains a rainbow $k$-cycle with $k\\le r$, denoted by $v_1,A(y_1,m_1),v_2,A(y_2,m_2),\\ldots,v_k,A(y_k,m_k),v_1$, where $v_i\\in V_{j_i}$ and $j_{i_1}\\neq j_{i_2}$ for $i_1\\neq i_2$ by the definition of a rainbow cycle. The following $k$ equations hold simultaneously:\n\n    \n", "index": 73, "text": "\\begin{equation*}\n    \\left\\{\n        \\begin{aligned}\n           y_1+b_{j_2}m_1 &\\equiv &y_2+b_{j_2}m_2 \\pmod{q}\\\\\n           y_2+b_{j_3}m_2 &\\equiv &y_3+b_{j_3}m_3 \\pmod{q}\\\\\n           \\vdots &              \\\\\n           y_{k-1}+b_{j_k}m_{k-1} &\\equiv &y_k+b_{j_k}m_k \\pmod{q}\\\\\n           y_k+b_{j_1}m_k &\\equiv &y_1+b_{j_1}m_1 \\pmod{q}.\\\\\n        \\end{aligned}\n    \\right.\n    \\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex33.m1\" class=\"ltx_Math\" alttext=\"\\left\\{\\begin{aligned} \\displaystyle y_{1}+b_{j_{2}}m_{1}&amp;\\displaystyle\\equiv&amp;%&#10;\\hskip 10.0pty_{2}+b_{j_{2}}m_{2}\\pmod{q}\\\\&#10;\\displaystyle y_{2}+b_{j_{3}}m_{2}&amp;\\displaystyle\\equiv&amp;\\hskip 10.0pty_{3}+b_{j%&#10;_{3}}m_{3}\\pmod{q}\\\\&#10;\\displaystyle\\vdots&amp;\\\\&#10;\\displaystyle y_{k-1}+b_{j_{k}}m_{k-1}&amp;\\displaystyle\\equiv&amp;\\hskip 10.0pty_{k}+%&#10;b_{j_{k}}m_{k}\\pmod{q}\\\\&#10;\\displaystyle y_{k}+b_{j_{1}}m_{k}&amp;\\displaystyle\\equiv&amp;\\hskip 10.0pty_{1}+b_{j%&#10;_{1}}m_{1}\\pmod{q}.\\\\&#10;\\end{aligned}\\right.\" display=\"block\"><mrow><mo>{</mo><mtable columnspacing=\"0pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"right\"><mrow><msub><mi>y</mi><mn>1</mn></msub><mo>+</mo><mrow><msub><mi>b</mi><msub><mi>j</mi><mn>2</mn></msub></msub><mo>\u2062</mo><msub><mi>m</mi><mn>1</mn></msub></mrow></mrow></mtd><mtd columnalign=\"left\"><mo>\u2261</mo></mtd><mtd columnalign=\"left\"><mrow><mrow><msub><mpadded lspace=\"10pt\" width=\"+10pt\"><mi>y</mi></mpadded><mn>2</mn></msub><mo>+</mo><mrow><msub><mi>b</mi><msub><mi>j</mi><mn>2</mn></msub></msub><mo>\u2062</mo><msub><mi>m</mi><mn>2</mn></msub></mrow></mrow><mspace width=\"veryverythickmathspace\"/><mrow><mo lspace=\"8.1pt\" stretchy=\"false\">(</mo><mrow><mo movablelimits=\"false\">mod</mo><mi>q</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mrow><msub><mi>y</mi><mn>2</mn></msub><mo>+</mo><mrow><msub><mi>b</mi><msub><mi>j</mi><mn>3</mn></msub></msub><mo>\u2062</mo><msub><mi>m</mi><mn>2</mn></msub></mrow></mrow></mtd><mtd columnalign=\"left\"><mo>\u2261</mo></mtd><mtd columnalign=\"left\"><mrow><mrow><msub><mpadded lspace=\"10pt\" width=\"+10pt\"><mi>y</mi></mpadded><mn>3</mn></msub><mo>+</mo><mrow><msub><mi>b</mi><msub><mi>j</mi><mn>3</mn></msub></msub><mo>\u2062</mo><msub><mi>m</mi><mn>3</mn></msub></mrow></mrow><mspace width=\"veryverythickmathspace\"/><mrow><mo lspace=\"8.1pt\" stretchy=\"false\">(</mo><mrow><mo movablelimits=\"false\">mod</mo><mi>q</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mi mathvariant=\"normal\">\u22ee</mi></mtd><mtd/></mtr><mtr><mtd columnalign=\"right\"><mrow><msub><mi>y</mi><mrow><mi>k</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>+</mo><mrow><msub><mi>b</mi><msub><mi>j</mi><mi>k</mi></msub></msub><mo>\u2062</mo><msub><mi>m</mi><mrow><mi>k</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow></mrow></mtd><mtd columnalign=\"left\"><mo>\u2261</mo></mtd><mtd columnalign=\"left\"><mrow><mrow><msub><mpadded lspace=\"10pt\" width=\"+10pt\"><mi>y</mi></mpadded><mi>k</mi></msub><mo>+</mo><mrow><msub><mi>b</mi><msub><mi>j</mi><mi>k</mi></msub></msub><mo>\u2062</mo><msub><mi>m</mi><mi>k</mi></msub></mrow></mrow><mspace width=\"veryverythickmathspace\"/><mrow><mo lspace=\"8.1pt\" stretchy=\"false\">(</mo><mrow><mo movablelimits=\"false\">mod</mo><mi>q</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mrow><msub><mi>y</mi><mi>k</mi></msub><mo>+</mo><mrow><msub><mi>b</mi><msub><mi>j</mi><mn>1</mn></msub></msub><mo>\u2062</mo><msub><mi>m</mi><mi>k</mi></msub></mrow></mrow></mtd><mtd columnalign=\"left\"><mo>\u2261</mo></mtd><mtd columnalign=\"left\"><mrow><mrow><mrow><msub><mpadded lspace=\"10pt\" width=\"+10pt\"><mi>y</mi></mpadded><mn>1</mn></msub><mo>+</mo><mrow><msub><mi>b</mi><msub><mi>j</mi><mn>1</mn></msub></msub><mo>\u2062</mo><msub><mi>m</mi><mn>1</mn></msub></mrow></mrow><mspace width=\"veryverythickmathspace\"/><mrow><mo lspace=\"8.1pt\" stretchy=\"false\">(</mo><mrow><mo movablelimits=\"false\">mod</mo><mi>q</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>.</mo></mrow></mtd></mtr></mtable></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n    \\noindent or\n    \n", "itemtype": "equation", "pos": 70385, "prevtext": "\n    \\noindent By a simple elimination, one can infer\n    \n", "index": 75, "text": "$$(b_{j_2}-b_{j_1})m_1+(b_{j_3}-b_{j_2})m_2+\\cdots+(b_{j_k}-b_{j{k-1}})m_{k-1}+(b_{j_1}-b_{j_k})m_k\\equiv 0 \\pmod{q},$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex34.m1\" class=\"ltx_Math\" alttext=\"(b_{j_{2}}-b_{j_{1}})m_{1}+(b_{j_{3}}-b_{j_{2}})m_{2}+\\cdots+(b_{j_{k}}-b_{j{k%&#10;-1}})m_{k-1}+(b_{j_{1}}-b_{j_{k}})m_{k}\\equiv 0\\pmod{q},\" display=\"block\"><mrow><mrow><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>b</mi><msub><mi>j</mi><mn>2</mn></msub></msub><mo>-</mo><msub><mi>b</mi><msub><mi>j</mi><mn>1</mn></msub></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>m</mi><mn>1</mn></msub></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>b</mi><msub><mi>j</mi><mn>3</mn></msub></msub><mo>-</mo><msub><mi>b</mi><msub><mi>j</mi><mn>2</mn></msub></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>m</mi><mn>2</mn></msub></mrow><mo>+</mo><mi mathvariant=\"normal\">\u22ef</mi><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>b</mi><msub><mi>j</mi><mi>k</mi></msub></msub><mo>-</mo><msub><mi>b</mi><mrow><mrow><mi>j</mi><mo>\u2062</mo><mi>k</mi></mrow><mo>-</mo><mn>1</mn></mrow></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>m</mi><mrow><mi>k</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>b</mi><msub><mi>j</mi><mn>1</mn></msub></msub><mo>-</mo><msub><mi>b</mi><msub><mi>j</mi><mi>k</mi></msub></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>m</mi><mi>k</mi></msub></mrow></mrow><mo>\u2261</mo><mrow><mn>0</mn><mspace width=\"veryverythickmathspace\"/><mrow><mo lspace=\"8.1pt\" stretchy=\"false\">(</mo><mrow><mo movablelimits=\"false\">mod</mo><mi>q</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n    \\noindent since $m_i\\le{\\lfloor}(q-1)/r(R){\\rfloor}$ for each $1\\le i\\le k$, which implies $m_1=\\cdots=m_k$ taking into account the fact that $M$ is $R$-sum-free. Thus $y_1=\\cdots=y_k$, which is a contradiction. Therefore, we can conclude that ${\\mathcal}{G}_M$ contains no rainbow cycles.\n  \\end{proof}\n\n  Lemmas \\ref{rainbow1} and \\ref{rainbow2} suggest that we can use tools from additive number theory to construct good perfect hash families. As discussed before Theorem \\ref{optimal3}, we use ${\\mathcal}{B}$ to denote the set of tangents of $A(y,m)$. To construct $PHF^*(4;n,q,4)$, we take ${\\mathcal}{B}=\\{0,2,5,\\mu+5\\}$, where $b_0=0,b_1=2,b_2=5$ and $b_3=\\mu+5$ with $\\mu={\\lceil} 2^{\\sqrt{\\log q}}{\\rceil}$. Note that $\\mu=o(q^{\\epsilon})$ for arbitrary small constant $\\epsilon>0$. By previous lemmas, our goal is to construct a ${\\mathcal}{B}$-sum-free subset $M$ of $\\mathbb{Z}_q$ with sufficiently large cardinality.\n  The desired hyperedge $A(y,m)$ is defined to be\n  \n\n  \n", "itemtype": "equation", "pos": 70526, "prevtext": "\n    \\noindent or\n    \n", "index": 77, "text": "$$(b_{j_2}-b_{j_1})m_1+(b_{j_3}-b_{j_2})m_2+\\cdots+(b_{j_k}-b_{j{k-1}})m_{k-1}+(b_{j_1}-b_{j_k})m_k=0,$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex35.m1\" class=\"ltx_Math\" alttext=\"(b_{j_{2}}-b_{j_{1}})m_{1}+(b_{j_{3}}-b_{j_{2}})m_{2}+\\cdots+(b_{j_{k}}-b_{j{k%&#10;-1}})m_{k-1}+(b_{j_{1}}-b_{j_{k}})m_{k}=0,\" display=\"block\"><mrow><mrow><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>b</mi><msub><mi>j</mi><mn>2</mn></msub></msub><mo>-</mo><msub><mi>b</mi><msub><mi>j</mi><mn>1</mn></msub></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>m</mi><mn>1</mn></msub></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>b</mi><msub><mi>j</mi><mn>3</mn></msub></msub><mo>-</mo><msub><mi>b</mi><msub><mi>j</mi><mn>2</mn></msub></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>m</mi><mn>2</mn></msub></mrow><mo>+</mo><mi mathvariant=\"normal\">\u22ef</mi><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>b</mi><msub><mi>j</mi><mi>k</mi></msub></msub><mo>-</mo><msub><mi>b</mi><mrow><mrow><mi>j</mi><mo>\u2062</mo><mi>k</mi></mrow><mo>-</mo><mn>1</mn></mrow></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>m</mi><mrow><mi>k</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>b</mi><msub><mi>j</mi><mn>1</mn></msub></msub><mo>-</mo><msub><mi>b</mi><msub><mi>j</mi><mi>k</mi></msub></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>m</mi><mi>k</mi></msub></mrow></mrow><mo>=</mo><mn>0</mn></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n\n  \\noindent The following lemma (together with Lemma \\ref{rainbow2}) shows that if we choose $M$ as the set defined in Lemma \\ref{t=4p=4}, then the corresponding $E({\\mathcal}{G}_M)$ contains no rainbow cycles.\n\n  \\begin{lemma}\\label{norainbowcycles1}\n    Choose $M$ as the set defined in Lemma \\ref{t=4p=4} and let ${\\mathcal}{B}$ be the 4-element set defined above, then $M$ is ${\\mathcal}{B}$-sum-free.\n  \\end{lemma}\n\n  \\begin{proof}\n    Note that $M$ has no nontrivial solution to all equations in (\\ref{3}), then one can verify this lemma directly by definition.\n  \\end{proof}\n\n  \\begin{lemma}\\label{norainbowcycles2}\n    The hypergraph defined by \n", "itemtype": "equation", "pos": 71622, "prevtext": "\n    \\noindent since $m_i\\le{\\lfloor}(q-1)/r(R){\\rfloor}$ for each $1\\le i\\le k$, which implies $m_1=\\cdots=m_k$ taking into account the fact that $M$ is $R$-sum-free. Thus $y_1=\\cdots=y_k$, which is a contradiction. Therefore, we can conclude that ${\\mathcal}{G}_M$ contains no rainbow cycles.\n  \\end{proof}\n\n  Lemmas \\ref{rainbow1} and \\ref{rainbow2} suggest that we can use tools from additive number theory to construct good perfect hash families. As discussed before Theorem \\ref{optimal3}, we use ${\\mathcal}{B}$ to denote the set of tangents of $A(y,m)$. To construct $PHF^*(4;n,q,4)$, we take ${\\mathcal}{B}=\\{0,2,5,\\mu+5\\}$, where $b_0=0,b_1=2,b_2=5$ and $b_3=\\mu+5$ with $\\mu={\\lceil} 2^{\\sqrt{\\log q}}{\\rceil}$. Note that $\\mu=o(q^{\\epsilon})$ for arbitrary small constant $\\epsilon>0$. By previous lemmas, our goal is to construct a ${\\mathcal}{B}$-sum-free subset $M$ of $\\mathbb{Z}_q$ with sufficiently large cardinality.\n  The desired hyperedge $A(y,m)$ is defined to be\n  \n\n  \n", "index": 79, "text": "\\begin{equation}\\label{Aym}\n    A(y,m)=\\{(1,y),(2,y+2m),(3,y+5m),(4,y+(\\mu+5)m)\\}.\n  \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"A(y,m)=\\{(1,y),(2,y+2m),(3,y+5m),(4,y+(\\mu+5)m)\\}.\" display=\"block\"><mrow><mrow><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>m</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mn>2</mn><mo>,</mo><mrow><mi>y</mi><mo>+</mo><mrow><mn>2</mn><mo>\u2062</mo><mi>m</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mn>3</mn><mo>,</mo><mrow><mi>y</mi><mo>+</mo><mrow><mn>5</mn><mo>\u2062</mo><mi>m</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>,</mo><mrow><mo stretchy=\"false\">(</mo><mn>4</mn><mo>,</mo><mrow><mi>y</mi><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03bc</mi><mo>+</mo><mn>5</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>m</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": " has no rainbow cycles, where $M$ is the set defined in Lemma \\ref{t=4p=4} and $A(y,m)$ is defined in (\\ref{Aym}).\n  \\end{lemma}\n\n  \\begin{proof}\n    Apply Lemmas \\ref{rainbow2} and \\ref{norainbowcycles1} and note that $r({\\mathcal}{B})=\\mu+5$.\n  \\end{proof}\n\n   \\begin{theorem}\\label{optimal4}\n    There exists a constant $\\gamma$ such that $p_4(4,q)>q^2e^{-\\gamma(\\log q)^{3/4}}$.\n  \\end{theorem}\n\n  \\begin{proof}\n    Apply Lemmas \\ref{t=4p=4}, \\ref{rainbow1} and \\ref{norainbowcycles2}. Then the theorem follows from\n    \n", "itemtype": "equation", "pos": -1, "prevtext": "\n\n  \\noindent The following lemma (together with Lemma \\ref{rainbow2}) shows that if we choose $M$ as the set defined in Lemma \\ref{t=4p=4}, then the corresponding $E({\\mathcal}{G}_M)$ contains no rainbow cycles.\n\n  \\begin{lemma}\\label{norainbowcycles1}\n    Choose $M$ as the set defined in Lemma \\ref{t=4p=4} and let ${\\mathcal}{B}$ be the 4-element set defined above, then $M$ is ${\\mathcal}{B}$-sum-free.\n  \\end{lemma}\n\n  \\begin{proof}\n    Note that $M$ has no nontrivial solution to all equations in (\\ref{3}), then one can verify this lemma directly by definition.\n  \\end{proof}\n\n  \\begin{lemma}\\label{norainbowcycles2}\n    The hypergraph defined by \n", "index": 81, "text": "$${\\mathcal}{G}_M=\\{A(y,m):y\\in\\mathbb{Z}_q,~m\\in M\\},$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex36.m1\" class=\"ltx_Math\" alttext=\"{\\mathcal{}}{G}_{M}=\\{A(y,m):y\\in\\mathbb{Z}_{q},~{}m\\in M\\},\" display=\"block\"><mrow><mrow><msub><mi>G</mi><mi>M</mi></msub><mo>=</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>m</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>:</mo><mrow><mrow><mi>y</mi><mo>\u2208</mo><msub><mi>\u2124</mi><mi>q</mi></msub></mrow><mo rspace=\"5.8pt\">,</mo><mrow><mi>m</mi><mo>\u2208</mo><mi>M</mi></mrow></mrow><mo stretchy=\"false\">}</mo></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n  \\end{proof}\n\n  \\begin{remark}\\label{conditions}\n    In the above construction of $PHF^*(4,n,q,4)$, we choose the tangent set ${\\mathcal}{B}$ of the hyperedge $A(y,m)$ to be ${\\mathcal}{B}=\\{0,2,5,\\mu+5\\}$ with $\\mu={\\lceil} 2^{\\sqrt{\\log q}}{\\rceil}$. This choice of ${\\mathcal}{B}$ has appeared in \\cite{ippe}, where the authors used such ${\\mathcal}{B}$ to construct 2-IPP codes. In this paper we choose the same ${\\mathcal}{B}$ as they did since in this way we can save the space for proving Lemma \\ref{t=4p=4}. Actually, when $|R|=4$ there are many choices of ${\\mathcal}{B}$ satisfying the following conditions\n    \\begin{itemize}\n      \\item [(a)] $M{\\subseteq}\\{0,1,\\ldots,{\\lfloor}(q-1)/r(R){\\rfloor}\\}$ is $R$-sum-free,\n      \\item [(b)] $|M|>q^{1-o(1)}$,\n      \\item [(c)] $r(R)=o(q^{\\epsilon})$ for arbitrary small $\\epsilon>0$.\n    \\end{itemize}\n    \\noindent However, for $|R|\\ge5$, we do not know whether such ${\\mathcal}{B}$ exists.\n  \\end{remark}\n\n\\section{Connections to hypergraph Tur{\\'a}n problems}\n\n    In this section we will study perfect hash families in view of hypergraph Tur{\\'a}n problems.\n\n    \\begin{theorem}\\label{general}\n       For arbitrary positive integers $t,N,q$, it holds that $f_N^*(q,tN-N,t)\\le p_t(N,q)$. Furthermore, ${\\frac}{N!}{N^N}f_N(Nq,tN-N,t)\\le p_t(N,q)$.\n    \\end{theorem}\n    \\begin{proof}\n        By Lemma \\ref{erdos-kleitman}, it suffices to prove the first statement of the theorem. Recall that if a hypergraph ${\\mathcal}{G}$ is $N$-uniform $N$-partite with equal part size $q$, then $E({\\mathcal}{G})$ can be represented by an $N\\times|E({\\mathcal}{G})|$ $q$-ary matrix $M$. If ${\\mathcal}{G}$ is $G(tN-N,t)$-free, then given any collection of $t$ edges $S{\\subseteq} E({\\mathcal}{G})$, it is not hard to verify that in its representation matrix there must exist a row that separates $S$, since otherwise $S$ can contain at most $tN-N$ vertices, violating the fact that ${\\mathcal}{G}$ is $G(tN-N,t)$-free. Therefore, $M$ can be viewed as the representation matrix of the desired perfect hash family.\n    \\end{proof}\n\n    A direct application of Theorem \\ref{general} gives the following result.\n\n    \\begin{corollary}\\label{cccccccccccccccccccc}\n        If $2\\nmid N$, then for arbitrary $\\epsilon>0$, it holds that $p_3(N,q)>q^{{\\lceil} N/2{\\rceil}-\\epsilon}$.\n    \\end{corollary}\n\n    \\begin{proof}\n        This corollary follows from the inequality (\\ref{2}), $n^{k-o(1)}<f_r(n,3(r-k)+k+1,3)=o(n^k)$.\n        Set $N=2k-1$ and $t=3$, by Theorem \\ref{general} one can infer\n        \n", "itemtype": "equation", "pos": 72956, "prevtext": " has no rainbow cycles, where $M$ is the set defined in Lemma \\ref{t=4p=4} and $A(y,m)$ is defined in (\\ref{Aym}).\n  \\end{lemma}\n\n  \\begin{proof}\n    Apply Lemmas \\ref{rainbow2} and \\ref{norainbowcycles1} and note that $r({\\mathcal}{B})=\\mu+5$.\n  \\end{proof}\n\n   \\begin{theorem}\\label{optimal4}\n    There exists a constant $\\gamma$ such that $p_4(4,q)>q^2e^{-\\gamma(\\log q)^{3/4}}$.\n  \\end{theorem}\n\n  \\begin{proof}\n    Apply Lemmas \\ref{t=4p=4}, \\ref{rainbow1} and \\ref{norainbowcycles2}. Then the theorem follows from\n    \n", "index": 83, "text": "$$p_4(4,q)\\ge p_4^*(4,q)=g_4^*(q)\\ge|E({\\mathcal}{G}_M)|=q|M|>q^2e^{-\\gamma(\\log q)^{3/4}}.$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex37.m1\" class=\"ltx_Math\" alttext=\"p_{4}(4,q)\\geq p_{4}^{*}(4,q)=g_{4}^{*}(q)\\geq|E({\\mathcal{}}{G}_{M})|=q|M|&gt;q^%&#10;{2}e^{-\\gamma(\\log q)^{3/4}}.\" display=\"block\"><mrow><mrow><mrow><msub><mi>p</mi><mn>4</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>4</mn><mo>,</mo><mi>q</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2265</mo><mrow><msubsup><mi>p</mi><mn>4</mn><mo>*</mo></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>4</mn><mo>,</mo><mi>q</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><msubsup><mi>g</mi><mn>4</mn><mo>*</mo></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>q</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2265</mo><mrow><mo stretchy=\"false\">|</mo><mrow><mi>E</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>G</mi><mi>M</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">|</mo></mrow><mo>=</mo><mrow><mi>q</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mi>M</mi><mo stretchy=\"false\">|</mo></mrow></mrow><mo>&gt;</mo><mrow><msup><mi>q</mi><mn>2</mn></msup><mo>\u2062</mo><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>log</mi><mo>\u2061</mo><mi>q</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mn>3</mn><mo>/</mo><mn>4</mn></mrow></msup></mrow></mrow></msup></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04807.tex", "nexttext": "\n    \\end{proof}\n\n\\section{Concluding remarks}\n\nIn this paper we mainly study codes and hash families with the separating property. Several open problems and conjectures concerning the upper or lower bounds are solved. Our two essential methods to study these objects can be summarized as follows.\n\nThe first method is to discover the structural information hidden in the separating property. As an example, our Johnson-type bound (Lemma \\ref{technical}) is used to establish Theorem \\ref{recusivebd} and Corollary \\ref{cccc}.\n\nThe second one is that we establish a bridge between perfect hash families, graph theory and additive number theory. For example, we solve Conjecture \\ref{walker} by considering a related hypergraph Tur{\\'a}n problem. We also showed that tools from additive number theory can be used to construct good perfect hash families. As a result, Theorems \\ref{optimal3}, \\ref{optimal4} and Corollary \\ref{cccccccccccccccccccc} suggest that there may exist a positive answer to Question \\ref{nmid}.\n\nBesides these two new methods, we think our construction in Section 4 is very interesting since it generalizes many previous ones. Further generalizations of our method are expected.\n\nAs a conclusion, we would like to mention several open problems which we think are interesting.\n\n\n\\vspace{10pt}\n\n\n    \n\n\n\n\\textbf{Open Problem 1.}\n    If $2\\nmid N$, Corollary \\ref{cccccccccccccccccccc} shows that $p_3(N,q)>q^{{\\lceil} N/2{\\rceil}-o(1)}$. Determine whether $p_3(N,q)=o(q^{{\\lceil} N/2{\\rceil}})$ or $p_3(N,q)=\\Theta(q^{{\\lceil} N/2{\\rceil}})$.\n\n\\vspace{10pt}\n\n\\textbf{Open Problem 2.}\n   For $r$-uniform $r$-partite linear hypergraph without rainbow cycles, we have proved that $g_r^*(q)=o(q^2)$ and $g_i^*(q)>q^{2-o(1)}$ for $i=3,4$. Then does it hold that $g_r^*(q)>q^{2-o(1)}$ for all $r\\ge3$?\n\\vspace{10pt}\n\n\\textbf{Open Problem 3.}\n    For arbitrary $r\\ge3$, does there exist an $r$-element set $R$ and $M{\\subseteq}[q]$ such that the conditions in Remark \\ref{conditions} are satisfied? Note that the question is true when $r=3,4$.\n\\vspace{10pt}\n\n\\textbf{Open Problem 4.}\n    It has been shown in Theorem \\ref{general} that $p_t(N,q)\\ge f_N^*(q,tN-N,t)$. Then does there exist an upper bound for $p_t(N,q)$ only using $f_N^*(q,v,t)$?\n\n\n\n\\bibliographystyle{plain}\n\\bibliography{shf}\n\n\\end{CJK*}\n\n", "itemtype": "equation", "pos": 75593, "prevtext": "\n  \\end{proof}\n\n  \\begin{remark}\\label{conditions}\n    In the above construction of $PHF^*(4,n,q,4)$, we choose the tangent set ${\\mathcal}{B}$ of the hyperedge $A(y,m)$ to be ${\\mathcal}{B}=\\{0,2,5,\\mu+5\\}$ with $\\mu={\\lceil} 2^{\\sqrt{\\log q}}{\\rceil}$. This choice of ${\\mathcal}{B}$ has appeared in \\cite{ippe}, where the authors used such ${\\mathcal}{B}$ to construct 2-IPP codes. In this paper we choose the same ${\\mathcal}{B}$ as they did since in this way we can save the space for proving Lemma \\ref{t=4p=4}. Actually, when $|R|=4$ there are many choices of ${\\mathcal}{B}$ satisfying the following conditions\n    \\begin{itemize}\n      \\item [(a)] $M{\\subseteq}\\{0,1,\\ldots,{\\lfloor}(q-1)/r(R){\\rfloor}\\}$ is $R$-sum-free,\n      \\item [(b)] $|M|>q^{1-o(1)}$,\n      \\item [(c)] $r(R)=o(q^{\\epsilon})$ for arbitrary small $\\epsilon>0$.\n    \\end{itemize}\n    \\noindent However, for $|R|\\ge5$, we do not know whether such ${\\mathcal}{B}$ exists.\n  \\end{remark}\n\n\\section{Connections to hypergraph Tur{\\'a}n problems}\n\n    In this section we will study perfect hash families in view of hypergraph Tur{\\'a}n problems.\n\n    \\begin{theorem}\\label{general}\n       For arbitrary positive integers $t,N,q$, it holds that $f_N^*(q,tN-N,t)\\le p_t(N,q)$. Furthermore, ${\\frac}{N!}{N^N}f_N(Nq,tN-N,t)\\le p_t(N,q)$.\n    \\end{theorem}\n    \\begin{proof}\n        By Lemma \\ref{erdos-kleitman}, it suffices to prove the first statement of the theorem. Recall that if a hypergraph ${\\mathcal}{G}$ is $N$-uniform $N$-partite with equal part size $q$, then $E({\\mathcal}{G})$ can be represented by an $N\\times|E({\\mathcal}{G})|$ $q$-ary matrix $M$. If ${\\mathcal}{G}$ is $G(tN-N,t)$-free, then given any collection of $t$ edges $S{\\subseteq} E({\\mathcal}{G})$, it is not hard to verify that in its representation matrix there must exist a row that separates $S$, since otherwise $S$ can contain at most $tN-N$ vertices, violating the fact that ${\\mathcal}{G}$ is $G(tN-N,t)$-free. Therefore, $M$ can be viewed as the representation matrix of the desired perfect hash family.\n    \\end{proof}\n\n    A direct application of Theorem \\ref{general} gives the following result.\n\n    \\begin{corollary}\\label{cccccccccccccccccccc}\n        If $2\\nmid N$, then for arbitrary $\\epsilon>0$, it holds that $p_3(N,q)>q^{{\\lceil} N/2{\\rceil}-\\epsilon}$.\n    \\end{corollary}\n\n    \\begin{proof}\n        This corollary follows from the inequality (\\ref{2}), $n^{k-o(1)}<f_r(n,3(r-k)+k+1,3)=o(n^k)$.\n        Set $N=2k-1$ and $t=3$, by Theorem \\ref{general} one can infer\n        \n", "index": 85, "text": "$$p_3(N,q)\\ge p_3^*(N,q)\\ge f_N^*(q,3N-N,3)\\ge{\\frac}{N!}{N^N}f_N(Nq,3N-N,3)>{\\frac}{N!}{N^N}(Nq)^{{\\lceil} N/2{\\rceil}-o(1)}.$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex38.m1\" class=\"ltx_Math\" alttext=\"p_{3}(N,q)\\geq p_{3}^{*}(N,q)\\geq f_{N}^{*}(q,3N-N,3)\\geq{\\frac{}}{N!}{N^{N}}f%&#10;_{N}(Nq,3N-N,3)&gt;{\\frac{}}{N!}{N^{N}}(Nq)^{{\\lceil}N/2{\\rceil}-o(1)}.\" display=\"block\"><mrow><mrow><mrow><msub><mi>p</mi><mn>3</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>N</mi><mo>,</mo><mi>q</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2265</mo><mrow><msubsup><mi>p</mi><mn>3</mn><mo>*</mo></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>N</mi><mo>,</mo><mi>q</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2265</mo><mrow><msubsup><mi>f</mi><mi>N</mi><mo>*</mo></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>q</mi><mo>,</mo><mrow><mrow><mn>3</mn><mo>\u2062</mo><mi>N</mi></mrow><mo>-</mo><mi>N</mi></mrow><mo>,</mo><mn>3</mn><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2265</mo><mrow><mfrac><mi/><mrow><mi>N</mi><mo lspace=\"0pt\" rspace=\"3.5pt\">!</mo></mrow></mfrac><mo>\u2062</mo><msup><mi>N</mi><mi>N</mi></msup><mo>\u2062</mo><msub><mi>f</mi><mi>N</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>N</mi><mo>\u2062</mo><mi>q</mi></mrow><mo>,</mo><mrow><mrow><mn>3</mn><mo>\u2062</mo><mi>N</mi></mrow><mo>-</mo><mi>N</mi></mrow><mo>,</mo><mn>3</mn><mo stretchy=\"false\">)</mo></mrow></mrow><mo>&gt;</mo><mrow><mfrac><mi/><mrow><mi>N</mi><mo lspace=\"0pt\" rspace=\"3.5pt\">!</mo></mrow></mfrac><mo>\u2062</mo><msup><mi>N</mi><mi>N</mi></msup><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>N</mi><mo>\u2062</mo><mi>q</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mrow><mo stretchy=\"false\">\u2308</mo><mrow><mi>N</mi><mo>/</mo><mn>2</mn></mrow><mo stretchy=\"false\">\u2309</mo></mrow><mo>-</mo><mrow><mi>o</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></msup></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}]