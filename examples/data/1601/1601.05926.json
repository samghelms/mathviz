[{"file": "1601.05926.tex", "nexttext": "\n\n\\noindent\nThe combination of all SDMs provides a structure representation that is\nsensitive to compact and marginally resolved features and to structural\npatterns that are much larger than the full width at half maximum (FWHM) of the\ninstrumental point spread function (PSF) in the image.\n\nA well approximated estimate of the uncertainty on the SSP position can be\nderived\nfollowing \\cite{fomalont_e_1999}:\n\n", "itemtype": "equation", "pos": 10304, "prevtext": " \n\n\\title{Detection of multiple velocity components\\\\ in partially overlapping\nemitting regions}\n\n\\author{F. Mertens\\inst{1}\n        \\and\n        A.~P. Lobanov\\inst{1,2}\n        }\n\n\\institute{Max-Planck-Institut f\\\"ur Radioastronomie,\n          Auf dem H\\\"ugel 69, 53121 Bonn, Germany\n          \\and\n          Institut f\\\"ur Experimentalphysik, Universit\\\"at Hamburg, \n          Luruper Chaussee 149, 22761 Hamburg, Germany\n          }\n\n\\date{}\n\n\\abstract\n\n\n{Velocity measurements made from multiple-epoch astronomical images of evolving objects\n  with optically thin continuum emission (e.g. as relativistic jets or\n  expanding supernova shells) may be confused as a result of the overlap\n  of semi-transparent features moving at different speeds.}\n\n{Multi-scale wavelet decomposition can be effectively applied  to\n  identify and track such overlapping features, provided that their\n  respective structural responses can be separated over the spatial\n  scales used for the decomposition.}\n\n{We developed a new method that combines the stacked\n  cross-correlation with the wavelet-based image\nsegmentation and evaluation (WISE) technique of decomposition of\n  two-dimensional structures, to separate and track dominant spatial responses of overlapping\n  evolving features.}\n\n{The method is tested on a set of simulated images of a stratified\n  relativistic jet, demonstrating the robust detection of both the faster\n  spine and the slower sheath speeds. The method is applied to\n  mutliple-epoch images from the MOJAVE survey, revealing two\n  different superluminal streams inside the jet in 3C\\,273 and the acceleration of\n  the flow in 3C\\,120.}\n\n{The method can be applied to densely monitored objects with composite\n  structural evolution such as the parsec-scale jet in M\\,87 or\n  heavily resolved expanding supernova shells.}\n\n\\keywords{methods: data analysis -- galaxies: jets -- galaxies: individual: 3C\\,120 -- galaxies: individual: 3C\\,273}\n\n\\maketitle\n\n\\section{Introduction}\n\nImages of various astronomical objects, such as relativistic jets or\nsupernova shells, display dynamically evolving, optically thin\ncontinuum emission, which is likely to feature partially overlapping\nsemi-transparent emitting regions with different kinematic and\nstructural properties.  In this situation, analysis of structural\nevolution of the emitting material often becomes\ndifficult and inconclusive.  The ensuing ambiguity of interpretation\nof the structural changes can be resolved in some cases with the help\nof spectroscopic measurements~\\citep[e.g.][]{guillard_turbulent_2012}. \n\nHowever, the application of spectroscopy is limited to objects with\nsubstantial line emission that can be kinematically associated with\nthe same material that emits the continuum emission. No such\nassociation can be made in objects dominated by the continuum: for\ninstance in objects in which the continuum is generated in a\nrelativistic plasma. Radio emission from extragalactic jets presents\na strong example of such a setting. Optically thin synchrotron emission\nand prominent transverse stratification of the flow are expected to be\nfound in jets as a direct consequence of the jet formation mechanism\n\\citep{sol_twoflow_1989,gracia_magnetic_2005,komissarov_magnetic_2007}\nor as a result of shocks \\citep{lobanov_spectral_1999,lobanov_dualfrequency_2006} and\ninstability development\n\\citep{lobanov_vsop_1998,lobanov_cosmic_2001,perucho_role_2006,perucho_physical_2007a,perucho_s5_2012}.\nObservational measurements of the flow stratification in relativistic\njets are critically needed to understand the physical processes\ngoverning the dynamics of the emitting plasma\n\\citep[cf.][]{lobanov_a_2003,hardee_modeling_2005,walker_vlba_2008,mertens_longitudinal_2014}.\n\nWavelet decomposition has been applied in a number of works to\nanalyse the structure of extended objects in astronomical images \\citep[cf.][]\n{starck_astronomical_2006}. The wavelet-based image\nsegmentation and evaluation (WISE) algorithm developed for determining\ntwo-dimensional velocity fields \\citep{mertens_waveletbased_2015} can\nalso be used to differentiate between structural components dominating\nat different spatial scales. The principal feasibility for WISE to\ndetect multiple velocity components has already been demonstrated\n\\citep{mertens_waveletbased_2015}. In this paper, we extend this\ncapability to partially overlapping optically thin regions, by\ncombining the WISE approach with stacked-cross-correlation (SCC)\n\\citep[cf.][]{fuhrmann_detection_2014}.\n\nThe basic approach for applying SCC to\nthe detection of multiple velocity components is introduced in\nSect.~\\ref{sc:scc} and tested on simulated images containing two\noverlapping optically thin streams. In Sect.~\\ref{sc:app}, the SCC\nmethod is applied to MOJAVE data on the jets in 3C\\,120 and 3C\\,273,\nrevealing the complexity of the kinematic parameters of these\noutflows. Further potential applications of the method are discussed\nin Sect.~\\ref{sc:discuss}.\n\nThroughout this paper, we adopt a cosmology of \n$H_0 = 71\\ {\\ensuremath{\\, \\mathrm{{km\\ s^{-1}\\ Mpc^{-1}}}}}$, $\\Omega_M = 0.27$ and $\\Omega_\\Lambda =\n0.73$~\\citep{lister_mojave_2013}.\n\n\\section{Stacked cross-correlation for detection of multiple velocity components}\n\\label{sc:scc}\n\nThe WISE algorithm combines segmented wavelet decomposition (SWD) and multi-scale\ncross-correlation (MCC) to provide robust identification and tracking of\nstructural patterns in astronomical images. The SWD algorithm provides a\nstructural representation of astronomical images with exceptional sensitivity\nfor identifying compact and marginally resolved features as well as large scale\nstructural patterns. The SWD decomposition delivers a set of two-dimensional\nsignificant structural patterns (SSP), which are identified at each scale of the\nwavelet decomposition. Tracking of these SSP detected in multiple-epoch images\nis performed with a MCC algorithm. It combines structural information on\ndifferent scales of the wavelet decomposition and provides a robust and reliable\ncross-identification of related SSP.  \\cite{mertens_waveletbased_2015} provide a\nfull description of the method.\n\nInitial results of application of WISE have indicated that the method can\ndiscriminate overlapping features with different velocities\n\\citep{mertens_waveletbased_2015}. The successful detection of multiple velocity\ncomponents has however remained challenging and prone to an increasing failure\nrate at low signal-to-noise ratios. This deficiency can be alleviated with the\nuse of stacked cross-correlation.\n\nThe displacement of a single SSP can be inferred from the location of the\nmaximum of the cross-correlation obtained for this SSP between two given epochs.\nIn optically thin objects with  complex and stratified three-dimensional\nstructures, the resulting cross-correlation map may contain several peaks\ncorresponding to several potential displacements. The \nMCC procedure resolves the\npotential ambiguity of interpretation of these peaks by combining the\ndisplacements found at different scales of the wavelet decomposition and\ndetermining the group motion of causally connected SSP.\n\nA different approach can be adopted if the stratification is\nhomogeneous over an extended region (e.g. one is dealing with two\nlarge-scale flows with different but constant velocities) and/or if\nseveral observations of the same steady stratified flow are available. In\nthis case, it is possible to detect two or more main velocity\ncomponents, corresponding to different layers of the flow consistently\nover an extended region and across several scales of the SWD, and the\ncross-correlation response of several SSP may be joined or\nstacked. The basic outline of the resulting stacking cross-correlation\nalgorithm is illustrated in Fig.~\\ref{fig:scc_scheme}.\n\n\\begin{figure}\n    \\centering\n    \\includegraphics{materiel/scc_schema_bw_v2.pdf}\n    \\caption[Stacked cross-correlation analysis of simulated of jet.]\n    {Simplified scheme of the stacked cross-correlation (SCC) algorithm for\ndetermining multiple velocity components. The SCC combines the SSP identified at\ndifferent scales of the SWD and (in case of more than two images analysed)\ndifferent pairs of epochs. }\n  \\label{fig:scc_scheme}\n\\end{figure}\n\nThe SWD provides scale-dependent models (SDM) of the target image by identifying\nSSP at each wavelet scale. The SCC algorithm combines the information contained\nin the scale-dependent models of two images (reference and target image) in the\nfollowing way:\n\n\\begin{itemize}\n\n\\item[1.]~The SWD is used to identify sets of SSP in both images at\n  different scales of the wavelet decomposition.\n\n\\item[2.]~The SSPs of the reference image are cross-correlated with\n  the target image.\n\n\\item[3.]~The cross-correlation results for all SSP, all\n  scales, and (in case of more than two images analysed) different\n  pairs of epochs are stacked together and normalized.\n\n\\end{itemize}\n\n\\noindent\nThis procedure yields a two-dimensional distribution of the cumulative\ncorrelation coefficients, with peaks corresponding to different\nvelocity components. The significance and uncertainty of each of these\npeaks can be evaluated using Monte Carlo simulations.\n\n\n\\subsection{Segmented wavelet decomposition}\n\\label{sect:swd}\n\nThe SWD used at the first step of the SCC algorithm comprises the following\nsteps to describe an image structure with a set of\nSSP~\\citep{mertens_waveletbased_2015}:\n\n\\begin{itemize}\n\\item[1.]~A wavelet transform is performed on an image $I$  by\ndecomposing the image into a set of $J$ sub-bands (scales), $w_{j}$,\n  and estimating the residual image noise (variable across the image).\n\n\\item[2.]~At each sub-band, statistically significant wavelet\n  coefficients are extracted from the decomposition by thresholding\n  them against the image noise.\n\n\\item[3.]~The significant coefficients are examined for local maxima,\n  and a subset of the local maxima satisfying composite detection\n  criteria is identified. This subset defines the locations of SSP in\n  the image.\n\n\\item[4.]~Two-dimensional boundaries of the SSP are defined \n  by the watershed segmentation using the feature\n  locations as initial markers.\n\n\\end{itemize} \n\n\\noindent\nThe resulting SDM representation of an image at the\nscale $j$ is derived as a group of SSP as\n\n", "index": 1, "text": "\\begin{equation}\n S_{j} = \\{s_{j, i}: i=1,...,N_\\mathrm{SSP,j}\\}\\,.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"S_{j}=\\{s_{j,i}:i=1,...,N_{\\mathrm{SSP,j}}\\}\\,.\" display=\"block\"><mrow><mrow><msub><mi>S</mi><mi>j</mi></msub><mo>=</mo><mrow><mo stretchy=\"false\">{</mo><msub><mi>s</mi><mrow><mi>j</mi><mo>,</mo><mi>i</mi></mrow></msub><mo>:</mo><mrow><mi>i</mi><mo>=</mo><mrow><mn>1</mn><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><msub><mi>N</mi><mrow><mi>SSP</mi><mo>,</mo><mi mathvariant=\"normal\">j</mi></mrow></msub></mrow></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">}</mo></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05926.tex", "nexttext": "\n\n\\noindent\nwhere $b_x$ and $b_y$ are the beam size along the x and y coordinate, respectively,\nassuming an elliptical PSF, which is approximately the case for application to\nVLBA maps, and $\\mathrm{SNR }$ is the signal-to-noise ratio of the SSP.\n\n\\subsection{Stacked cross-correlation}\n\\label{sect:scc}\n\nTo detect structural changes between the reference and target images, each\nsingle SSP $s_{j, i}$ identified on a scale $j$ of the reference image is \ncross-correlated with the target image. For this purpose, a zero-mean cross-correlation, insensitive to both the image intensity offset and scale change, is\nused and is defined as\nfollows~\\citep{giachetti_matching_2000,mertens_waveletbased_2015}:\n\n", "itemtype": "equation", "pos": 10795, "prevtext": "\n\n\\noindent\nThe combination of all SDMs provides a structure representation that is\nsensitive to compact and marginally resolved features and to structural\npatterns that are much larger than the full width at half maximum (FWHM) of the\ninstrumental point spread function (PSF) in the image.\n\nA well approximated estimate of the uncertainty on the SSP position can be\nderived\nfollowing \\cite{fomalont_e_1999}:\n\n", "index": 3, "text": "\\begin{equation}\n\\label{eq:feature_pos_error}\n\\sigma_x = \\frac{b_x}{\\sqrt{2}\\ \\mathrm{SNR}},\\ \\sigma_y = \\frac{b_y}{\\sqrt{2}\\ \\mathrm{SNR}} \n,\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"\\sigma_{x}=\\frac{b_{x}}{\\sqrt{2}\\ \\mathrm{SNR}},\\ \\sigma_{y}=\\frac{b_{y}}{%&#10;\\sqrt{2}\\ \\mathrm{SNR}},\" display=\"block\"><mrow><mrow><mrow><msub><mi>\u03c3</mi><mi>x</mi></msub><mo>=</mo><mfrac><msub><mi>b</mi><mi>x</mi></msub><mrow><mpadded width=\"+5pt\"><msqrt><mn>2</mn></msqrt></mpadded><mo>\u2062</mo><mi>SNR</mi></mrow></mfrac></mrow><mo rspace=\"7.5pt\">,</mo><mrow><msub><mi>\u03c3</mi><mi>y</mi></msub><mo>=</mo><mfrac><msub><mi>b</mi><mi>y</mi></msub><mrow><mpadded width=\"+5pt\"><msqrt><mn>2</mn></msqrt></mpadded><mo>\u2062</mo><mi>SNR</mi></mrow></mfrac></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05926.tex", "nexttext": "\nwhere $a$ and $b$ the two images to cross-correlate.\n\n\\noindent The cross-correlation $\\gamma_{i, j, t}$ between an SSP $i$ detected\nat scale $j$ of reference epoch $t$, and target epoch $t + 1$ is then written as\n\n", "itemtype": "equation", "pos": 11653, "prevtext": "\n\n\\noindent\nwhere $b_x$ and $b_y$ are the beam size along the x and y coordinate, respectively,\nassuming an elliptical PSF, which is approximately the case for application to\nVLBA maps, and $\\mathrm{SNR }$ is the signal-to-noise ratio of the SSP.\n\n\\subsection{Stacked cross-correlation}\n\\label{sect:scc}\n\nTo detect structural changes between the reference and target images, each\nsingle SSP $s_{j, i}$ identified on a scale $j$ of the reference image is \ncross-correlated with the target image. For this purpose, a zero-mean cross-correlation, insensitive to both the image intensity offset and scale change, is\nused and is defined as\nfollows~\\citep{giachetti_matching_2000,mertens_waveletbased_2015}:\n\n", "index": 5, "text": "\\begin{equation}\nC_\\mathrm{ZNCC}(a, b) = \\frac{\\sum \\overline{a_i} \\overline{b_i\n}}{\\sqrt{\\sum \\overline{a_i }^2 \\sum \\overline{b_i }^2}}\\,,\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"C_{\\mathrm{ZNCC}}(a,b)=\\frac{\\sum\\overline{a_{i}}\\overline{b_{i}}}{\\sqrt{\\sum%&#10;\\overline{a_{i}}^{2}\\sum\\overline{b_{i}}^{2}}}\\,,\" display=\"block\"><mrow><mrow><mrow><msub><mi>C</mi><mi>ZNCC</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mpadded width=\"+1.7pt\"><mfrac><mrow><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><mover accent=\"true\"><msub><mi>a</mi><mi>i</mi></msub><mo>\u00af</mo></mover><mo>\u2062</mo><mover accent=\"true\"><msub><mi>b</mi><mi>i</mi></msub><mo>\u00af</mo></mover></mrow></mrow><msqrt><mrow><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><msup><mover accent=\"true\"><msub><mi>a</mi><mi>i</mi></msub><mo>\u00af</mo></mover><mn>2</mn></msup><mo>\u2062</mo><mrow><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><msup><mover accent=\"true\"><msub><mi>b</mi><mi>i</mi></msub><mo>\u00af</mo></mover><mn>2</mn></msup></mrow></mrow></mrow></msqrt></mfrac></mpadded></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05926.tex", "nexttext": "\n\nIn order to reduce the adverse impact of the image noise on the calculation, we\nconsider here only prominent peaks $p$ above a certain threshold $\\kappa$\n(typically, 0.6--0.8) and model them as two-dimensional Gaussian shapes $g(p,\n\\sigma)$ with the width $\\sigma$ corresponding to the error of the displacement\n(typically a fraction of the beam size). Additionally, if the total set of\nanalysed images consists of multiple epochs with inhomogeneous time intervals\nbetween the successive epochs, an additional linear transformation $\\mathbf\n{V_t}$ that converts displacement to velocity needs to be applied so that all\ncross-correlation results can be stacked together. The resulting modified cross-correlation coefficient is then defined as \n\n", "itemtype": "equation", "pos": 12022, "prevtext": "\nwhere $a$ and $b$ the two images to cross-correlate.\n\n\\noindent The cross-correlation $\\gamma_{i, j, t}$ between an SSP $i$ detected\nat scale $j$ of reference epoch $t$, and target epoch $t + 1$ is then written as\n\n", "index": 7, "text": "\\begin{equation} \\gamma_{i, j, t} =\nC_\\mathrm{ZNCC}(s^{t}_{j, i}, w_j^{t+1}) .\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"\\gamma_{i,j,t}=C_{\\mathrm{ZNCC}}(s^{t}_{j,i},w_{j}^{t+1}).\" display=\"block\"><mrow><mrow><msub><mi>\u03b3</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>=</mo><mrow><msub><mi>C</mi><mi>ZNCC</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msubsup><mi>s</mi><mrow><mi>j</mi><mo>,</mo><mi>i</mi></mrow><mi>t</mi></msubsup><mo>,</mo><msubsup><mi>w</mi><mi>j</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05926.tex", "nexttext": " \n\n\\noindent where $P = \\{p\\}$ is the group of local maxima of $\\gamma_{i, j, t}$,\nwhich are above threshold $\\kappa$.\n\nFinally, combining all the SSP identified at different scales of the SWD and\nacross different\nepochs, we define the stack cross-correlation as\n\n", "itemtype": "equation", "pos": -1, "prevtext": "\n\nIn order to reduce the adverse impact of the image noise on the calculation, we\nconsider here only prominent peaks $p$ above a certain threshold $\\kappa$\n(typically, 0.6--0.8) and model them as two-dimensional Gaussian shapes $g(p,\n\\sigma)$ with the width $\\sigma$ corresponding to the error of the displacement\n(typically a fraction of the beam size). Additionally, if the total set of\nanalysed images consists of multiple epochs with inhomogeneous time intervals\nbetween the successive epochs, an additional linear transformation $\\mathbf\n{V_t}$ that converts displacement to velocity needs to be applied so that all\ncross-correlation results can be stacked together. The resulting modified cross-correlation coefficient is then defined as \n\n", "index": 9, "text": "\\begin{equation} \\tilde{\\gamma}_{i,\nj, t} = \\sum_{p \\in P}{\\gamma_{i, j, t}(p) g(\\mathbf{V_t}p, \\mathbf{V_t}\\sigma)}\n,\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"\\tilde{\\gamma}_{i,j,t}=\\sum_{p\\in P}{\\gamma_{i,j,t}(p)g(\\mathbf{V_{t}}p,%&#10;\\mathbf{V_{t}}\\sigma)},\" display=\"block\"><mrow><mrow><msub><mover accent=\"true\"><mi>\u03b3</mi><mo stretchy=\"false\">~</mo></mover><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>p</mi><mo>\u2208</mo><mi>P</mi></mrow></munder><mrow><msub><mi>\u03b3</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>p</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>g</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc15</mi><mi>\ud835\udc2d</mi></msub><mo>\u2062</mo><mi>p</mi></mrow><mo>,</mo><mrow><msub><mi>\ud835\udc15</mi><mi>\ud835\udc2d</mi></msub><mo>\u2062</mo><mi>\u03c3</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05926.tex", "nexttext": "\n\n\\noindent where $N^{t}_{\\mathrm{SSP,j}}$ are the number of SSP identified at scale\n$j$ of the SWD in the image of epoch $t$. The complete procedure yields a \ntwo-dimensional representation of the global correlation between all images\nanalysed with peaks corresponding to the main displacement/velocity components.\n\n\\subsection{Significance of detected velocity components}\n\\label{sect:scc_significance}\n\nTo ensure robust identification of different velocity components, we need to\ndetermine the significance of individual maxima found using the stacked cross-correlation. If the cross-correlation is obtained from multiple epoch data,\nbootstrapping can be applied to determine the probability for a given\ncorrelation coefficient to  result from an inadequate sampling. The\nbootstrapping consists of computing test SCCs for a large number of trials\n(typically 1000) in which the individual epochs are randomly shuffled. The\nconfidence interval (CI) for each velocity components can then be calculated\nfrom the mean and standard deviation of the test SCCs. For the velocities\ncorresponding to small displacements (typically, below 1/2 the beam size), the\nmean coefficient of the shuffled sets are overestimated and corrected CI\n have to be computed in this case by adding a small shift (1/5 the beam\nsize) to the images.\n\n\\subsection{Uncertainty on the velocity components}\n\\label{sect:scc_error}\n\n\\begin{figure*}\n    \\centering\n    \\includegraphics{materiel/gncc_simu_full_v4.pdf}\n    \\caption[Stacked cross-correlation analysis of simulated jet.]\n    {Stacked cross-correlation analysis of simulated images of a spine-sheath\n      (``two-fluid'') jet with two constant velocity components (left)\n      and a jet with random velocity field (right). For each test, a total of\n      ten epochs are simulated. The\n      resulting cross-correlation map is shown in greyscale in the\n      respective top panel. The bottom panels shows the derived\n      significance of the velocity components obtained. The\n      significance is measured along the slice corresponding to the\n      zero transverse speed. For the\n      stratified spine-sheath flow on the left, the SCC successfully\n      identifies the velocities of the two layers with a significance\n      of $\\ge 5\\,\\sigma$. For the jet on the right with the random\n      velocity field, no peak with a significance greater than\n      $2\\,\\sigma$ is found.  }\n    \\label{fig:gncc_simu_full}\n\\end{figure*}\n\nAn estimate of the uncertainty of a significant velocity component can\nbe obtained from Monte Carlo simulations. A large number of test SCCs are\nagain computed, this time with all the SSP randomly shifted by an\namount derived from a normal distribution with a standard deviation\nset by the uncertainty on the SSP location (see\nsect.~\\ref{sect:swd}). \n\n\n\n\nIt should be noted that for this measure to be valid, the\ndistribution of shifts must be Gaussian with the\nmean corresponding to the velocity component identified with the SCC.\n\n\n\\subsection{Testing the SCC method}\n\\label{sc:tests}\n\nTo test the performance of the SCC method, two sets of simulated images of a\ncompact jet are prepared, following the prescription developed for testing the\nWISE method \\citep{mertens_waveletbased_2015}. The first set features a \n``two-fluid'' jet with a faster inner spine and a slower outer sheath. In the second\nset, random velocity distribution is simulated. Images at multiple epochs are\ngenerated for each set with structural displacements introduced accordingly.\nThe SCC is then computed for all consecutive image pairs. Examples of the\nresulting cross-correlation map is shown in the top panels of\nFig.~\\ref{fig:gncc_simu_full}. Peaks in the map are then located by searching\nfor local maxima.  A 2D Gaussian is fitted to a small box with dimensions equal to the beam size\naround each local maximum found  to obtain sub-pixel precision on the peak location. The significance of each peak and its\nassociated velocity error are determined following the procedures introduced in\nsect~\\ref{sect:scc_significance} and sect~\\ref{sect:scc_error}.\n\nFor the two-fluid scenario, the jet is simulated with one group of features\npropagating with $\\Delta x_1 = 5$\\,px, $\\Delta y_1 = 0$\\,px between each pair of\nimages, and a second group of features evolving with $\\Delta x_2 = 20$\\,px,\n$\\Delta y_2 = 0$\\,px between each pair of images (with $x$ and $y$ describing\nthe longitudinal and transverse dimensions, respectively). Noise is added to the\nsimulated displacements with $\\sigma_x = \\sigma_y = 2$\\,px or 1/5 of the beam\nsize, which is set to 10\\,px in all simulated images. Thus the faster jet\ncomponent moves by twice the beam size and the slower jet component moves by half the\nbeam size between each two consecutive epochs\n\nA total of ten epochs is generated and SCC is computed in a region that\nextends over 10 beam sizes longitudinally. The SCC includes the scales 1, 2, and\n3 of the SWD decomposition, producing a total of 264 SSP identified in the jet\nover all epochs. Results of this test are shown in the left panels of\nFig.~\\ref{fig:gncc_simu_full}. The SCC velocity map obtained in simulation\nshows two prominent peaks at velocities corresponding to the two simulated\ndisplacements. No other peaks are found. For the first peak, a displacement of\n$\\Delta x_1 = 4.5 \\pm 0.4$\\,px and a significance of $11.4\\,\\sigma$ is found.\nFor the second peak, we measure $\\Delta x_1 = 20.5 \\pm 0.8$\\,px with a\nsignificance of $6.7\\,\\sigma$. As a cross check, we confirm that for both peaks\nthe distribution of displacements found in the test SCC used to measure the\nuncertainties is Gaussian with mean value corresponding to the formal\ndisplacements. These results are in excellent agreement with the simulated\ndisplacements. The uncertainties of the displacement detection are improved by a\nfactor of 3 to 4 in comparison with a similar test performed using the WISE\nanalysis \\citep[Sect.~5.3.2 in][]{mertens_waveletbased_2015}.\n\nIn the second simulated set, jet images are produced without any\nsignificant regular velocity component. To achieve this, we simulate a\nsingle group of features with random displacements drawn from a\nuniform distribution $0\\, \\mathrm{px} \\le \\Delta_x \\le 40\\,\n\\mathrm{px}$ and $-5\\, \\mathrm{px} \\le \\Delta_y \\le 5\\,\n\\mathrm{px}$ between each pair of images. A similar procedure as described for\nthe first test is\nthen applied to determine the locations and the significance\nof the correlation peaks. The results are shown in the right panels of\nFig.~\\ref{fig:gncc_simu_full}. No peaks are found with significance\nexceeding $2\\,\\sigma$, which is compatible with the simulated random\ndisplacements.\nThese tests demonstrate the robustness of the SCC method for\nidentifying multiple velocity components manifested by partially\noverlapping regions of the flow.\n\n\\section{Applications to astronomical images}\n\\label{sc:app}\n\nAfter testing the SCC on simulated data, we have applied it to several\nimage sequences obtained as part of the MOJAVE\\footnote{Monitoring of\n  jets in active galactic nuclei with VLBA Experiments} long-term\nmonitoring program of extragalactic jets with Very Large Baseline\nInterferometry (VLBI) observations \\citep[][and references\ntherein]{lister_mojave_2013}. The particular focus of this analysis\nwas made on prominent radio jets in the quasar 3C\\,273 and the radio\ngalaxy 3C\\,120.\n\n\\subsection{Stratification in the jet of 3C\\,273}\n\nThe jet in 3C\\,273 is transversely resolved in the MOJAVE\nimages. Stratification of the flow has been previously suggested for\nthis jet \\citep{lobanov_cosmic_2001,perucho_role_2006} and a large range of\napparent speeds has been reported at similar core separation based on\nthe analysis of the MOJAVE data\n\\citep{lister_mojave_2013,savolainen_multifrequency_2006}.\n\nThe SCC has been performed on the entire MOJAVE data for 3C\\,273\ncomprising 69 images obtained in the 1996--2010 period. The average\nbeam (PSF) is $0.5\\,\\mathrm{mas}\\times 1.0$\\,mas in these images.  The WISE\ndecomposition was performed using four wavelet scales with the finest\nscale of $0.2$\\,mas (scale 1, corresponding to one fifth of the beam). \n\nThe SCC results are shown in Fig.~\\ref{fig:3c273_stratification}, indicating a\nsystematically higher speed of $\\beta_\\mathrm{app} \\sim 9$\\,c, detected at the\ntwo larger scales (scale 3 and 4) compared to the slower apparent speed of\n$\\beta_\\mathrm{app} \\sim 7.5$\\,c measured at the smaller scales (scale 1 and 2).\nThe position angle distribution of the SSP identified at the larger and smaller\nscales (Fig.~\\ref{fig:3c273_pa_frequency_1_6mas}) indicates that the faster\nmoving SSP are concentrated towards the central spine of the flow, while the\nslower moving SSP tend to be found in the outer layers of the flow. This may be\nindicative of  jet stratification, which results from either true transverse\nvelocity distribution in the flow or produced by fast shocks or disturbances\ntraveling through a slower underlying flow.\n\nWe note that the average apparent velocity of all components identified by the\nMOJAVE team in this source is $\\beta_\\mathrm{app} \\sim 8$\\,c (with a standard\ndeviation of $\\sim 3$\\,c), which is similar to the average of the large- and\nsmall-scale velocity obtained from the SCC analysis. The SCC was thus able to\nsingle out in this source the two major superluminal streams responsible for the\nlarge velocity discrepancy found by the MOJAVE team and to assign them to\nstructure of different scales.\n\\begin{figure}\n    \\centering\n    \\includegraphics{materiel/3c273_stratification_v4.pdf}\n    \\caption\n    {SCC analysis of the jet in 3C 273. The analysis is performed in three\n      different regions in the jet: between 1 and 6 mas, 6 and 11 mas,\n      11 and 16 mas. The SSP detected at larger scales (scales 3\n      and 4, corresponding to 0.8\\,and 1.6\\,mas) of the SWD\n      decomposition are\n      found to be on average\n      faster than SSP detected at smaller scale (scales 1 and\n      2, corresponding to 0.2\\,and 0.4\\,mas).}\n    \\label{fig:3c273_stratification}\n\\end{figure}\n\n\\begin{figure}\n    \\centering\n    \\includegraphics{materiel/3c273_pa_frequency_1_6mas_v4.pdf}\n    \\caption\n    {Analysis of the position angle of the SSP detected in the inner 6\\,mas\nregion of the jet in 3C\\,273 on small scales (scales 1 and 2) compared to that\ndetected at larger scales (scales 3 and 4). The comparison indicates that\nthe slower SSP detected on scales 1 and 2 are predominantly located in the outer\npart of the jet, while the faster SSP detected on scales 3 and 4 are concentrated\ntowards the centre of the flow.}\n    \\label{fig:3c273_pa_frequency_1_6mas}\n\\end{figure}\n\n\\subsection{Acceleration in the jet of 3C\\,120}\n\nThe analysis of the jet in 3C\\,120 comprises the total of 87 MOJAVE images\ncovering the period of 1996--2010. The average beam of the MOJAVE images is $0.5\n\\,\\mathrm{mas}\\times 1.2$\\,mas. The SWD decomposition was performed using four\nwavelet scales\nranging between 0.2\\,mas (scale 1) and 1.6\\,mas (scale 4). The SCC result does\nnot reveal any statistically different velocity components, nor does comparing\n SCC results individually on small- and large-scale structure.\nContrary to 3C\\,273, the jet in 3C\\,120 is not transversally resolved in the\nMOJAVE images, which limit the possibility of detecting the flow stratification.\nHowever, the high precision of the SCC measurement can be used in this case to\ntrack the evolution of the flow speed with distance from the core.\n\n\nWe computed the SCC individually for ten regions of the jet between a distance\nfrom the core from 0.5 mas to 10.5 mas with a bin size of 1 mas. The result of\nthis analysis (Fig.~\\ref{fig:3c120_acceleration}) reveals a significant flow acceleration from $\\beta_\n{\\mathrm {app}} = 4.0\\,\\mathrm{c}\n\\pm 0.2$\\,c at $z_{\\mathrm{obs}} = 1$\\,mas to $\\beta_{\\mathrm{app}} = 6.0\\,\\mathrm{c}\\pm\n0.4$\\,c at $z_{\\mathrm{obs}} = 7$\\,mas, followed by an apparent deceleration of\nthe flow.\n\nA similar analysis can be achieved using the results from the WISE analysis of\nthe source performed in~\\cite{mertens_waveletbased_2015}. Apparent velocities of\neach component detected in this study is obtained at several distances from the\ncore (DFC), between 1\\,mas and 10\\,mas with a step of 1\\, mas, via linear fitting\nof the component separation with time taking into account only the features 2\nmas before and 2 mas after the DFC. An average apparent velocity is then\nobtained for each DFC. The result is over-plotted in\nFig.~\\ref{fig:3c120_acceleration} in orange, and we found it to be comparable to\nthe result obtained from the SCC analysis, proving the robustness of this last\nmethod.\n\nThe observed apparent acceleration can be intrinsic flow acceleration or the\ngeometrical effect of a decreasing viewing angle due for example to the jet\nbending. We estimate that for a Lorentz factor of 6, a decrease in viewing angle\nof $\\sim 15 \\degree$ would be required to increase the apparent speed\nfrom 4\\,c to 6\\,c. While the jet in 3C\\,120 is known to display a significant\nbending at large scales~\\citep{benson_200_1984_mod}, only a slight jet direction\nchanges is observed at the scale of our analysis, and we can thus discard\napparent acceleration due to geometrical effects. There is also strong evidence\nthat flow acceleration can extend to a distance of few parsec from the\ncore~\\citep{homan_mojave_2015}.\n\nUsing a viewing angle of $15\n\\degree$~\\citep{agudo_recollimation_2012,hardee_modeling_2005}, the evolution of\nthe Lorentz factor with distance from the core can be described by a power-law\nfunction $\\gamma = a z^ {k}$ with $k \\sim 0.3$. Magnetic jet\nacceleration~\\citep{vlahakis_theory_2015} or thermal/pressure induced\nacceleration~\\citep{georganopoulos_viewing_1998} would require an initial linear\nacceleration phase with $\\gamma \\propto z$ for a conical jet like that in\n3C\\,120. The acceleration profile that we observe is hence more likely the\nmanifestation of a late-phase, slower, magnetic acceleration at which stage the\nPoynting flux conversion starts to saturate~\\citep{lyubarsky_asymptotic_2009}.\n\n\\begin{figure}\n    \\centering\n    \\includegraphics{materiel/3c120_acceleration_v3.pdf}\n    \\caption\n    {SCC analysis of the jet in 3C 120. The lack of transverse\n      resolution in the MOJAVE images only warrants probing the\n      longitudinal velocity distribution. Significant acceleration is\n      detected up to a distance from the core of 7 mas, which is comparable to\n      the\n      acceleration detected from WISE analysis of the source.}\n    \\label{fig:3c120_acceleration}\n\\end{figure}\n\n\\section{Discussion}\n\\label{sc:discuss}\n\nStacked cross-correlation (SCC) introduced in this paper can be\napplied to recover multiple velocity components from partially\noverlapping emitting regions. The SCC extends and expands the\nmulti-scale cross-correlation (MCC) approach originally introduced for the\nWISE analysis of astronomical images\n\\citep{mertens_waveletbased_2015}. While the MCC can partially recover\noverlapping displacements in different SSP identified by WISE, the SCC\nprovides a fully statistical approach for robust identification of\nmultiple velocity components, which also includes  evaluation of statistical \nsignificance and estimation of uncertainty for each velocity component.\n\nThe SCC analysis of the transversely resolved jet in 3C\\,273 reveals\ntwo statistically significant velocity components corresponding to jet\nplasma propagating at apparent superluminal speeds of $\\sim 7.5\\,c$\nand $\\sim 9\\,c$. These two speeds may reflect the transverse\nstratification of the flow. They may also be explained in a framework\nof faster shock or plasma disturbances traveling through a slower\nunderlying flow.\n\nIn 3C\\,120, the lack of transverse resolution in the MOJAVE data has\nlimited the SCC analysis to the longitudinal dimension of the flow. In\nthis setting, the SCC results have been found to be consistent with\nthe kinematic properties of the flow recovered previously using the\nWISE analysis of the same data.\n\nThe method that we introduce  can be applied to sources with\ncomposite structural evolution for which we have sufficient epochs of\nobservation, and the criteria is the ability to obtain velocity components with\nstatistically significant SCC coefficients. An ideal candidate for this analysis\nwould be the sub-parsec scale of the jet in M87 for which flow stratification\nhas already been suggested~\\citep{mertens_longitudinal_2014}.\n\n\\begin{acknowledgements}\nThis research has made use of data from the MOJAVE database that is \nmaintained by the MOJAVE team \\citep{lister_mojave_2009}. FM was supported for this\nresearch through a stipend from the International Max Planck Research School (IMPRS) for Astronomy and Astrophysics at the Universities of Bonn and Cologne.\n\\end{acknowledgements}\n\n\\bibliographystyle{aa}\n\\bibliography{biblio}\n\n\n", "itemtype": "equation", "pos": 13254, "prevtext": " \n\n\\noindent where $P = \\{p\\}$ is the group of local maxima of $\\gamma_{i, j, t}$,\nwhich are above threshold $\\kappa$.\n\nFinally, combining all the SSP identified at different scales of the SWD and\nacross different\nepochs, we define the stack cross-correlation as\n\n", "index": 11, "text": "\\begin{equation}\nC_\\mathrm{SCC} = \\frac{\\sum_{t}\\sum_{j}\\sum_{i}\\tilde{\\gamma}_{i, j, t}}\n{\\sum_{t}\\sum_{j}N^{t}_{\\mathrm{SSP,j}}}\n,\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"C_{\\mathrm{SCC}}=\\frac{\\sum_{t}\\sum_{j}\\sum_{i}\\tilde{\\gamma}_{i,j,t}}{\\sum_{t%&#10;}\\sum_{j}N^{t}_{\\mathrm{SSP,j}}},\" display=\"block\"><mrow><mrow><msub><mi>C</mi><mi>SCC</mi></msub><mo>=</mo><mfrac><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mi>t</mi></msub><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mi>j</mi></msub><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mi>i</mi></msub><msub><mover accent=\"true\"><mi>\u03b3</mi><mo stretchy=\"false\">~</mo></mover><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>t</mi></mrow></msub></mrow></mrow></mrow><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mi>t</mi></msub><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mi>j</mi></msub><msubsup><mi>N</mi><mrow><mi>SSP</mi><mo>,</mo><mi mathvariant=\"normal\">j</mi></mrow><mi>t</mi></msubsup></mrow></mrow></mfrac></mrow><mo>,</mo></mrow></math>", "type": "latex"}]