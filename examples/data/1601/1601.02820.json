[{"file": "1601.02820.tex", "nexttext": "\nwith $0<q<1$ and $\\beta>0$ the shape parameters.\nA similar definition can be given on the support $1,2,\\ldots$. In this case, $F(y; q, \\beta)=1-q^{y^\\beta}$, for $y=1,2,\\ldots$. Comparing this cdf with that of a continuous Weibull distribution with parameters $\\alpha$ and $\\gamma$, one can see that there is a direct correspondence between $\\beta$ and $\\gamma$, whereas $q$ in the discrete case corresponds to $\\exp(-\\alpha)$ in the continuous case \\citep{khan89}.\n\nGiven the form of the cumulative distribution function, the discrete Weibull distribution has the following probability mass function:\n", "itemtype": "equation", "pos": 7093, "prevtext": "\n\n\n\\begin{frontmatter}\n\n\\title{A new Bayesian regression model for counts in medicine}\n\n\n\n\\author[label1]{Hamed Haselimashhadi}\n\\author[label1]{Veronica Vinciotti\\corref{cor1}}\n\\author[label1]{Keming Yu}\n\n\n\\cortext[cor1]{Department of Mathematics, 208 John Crank Building, UB83PH Middlesex, UK; veronica.vinciotti@brunel.ac.uk; tel: +44 (0)1895267469}\n\\address[label1]{Department of Mathematics, Brunel University London, UB8 3PH Uxbridge, UK}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\begin{abstract}\nDiscrete data are collected in many application areas and are often characterised by highly skewed and power-lawlike distributions. An example of this, which is considered in this paper, is the number of visits to a specialist, often taken as a measure of demand in healthcare. A discrete Weibull regression model was recently proposed for regression problems with a discrete response and it was shown to possess two important features: the ability to capture over and under-dispersion simultaneously and a closed-form analytical expression of the quantiles of the conditional distribution. In this paper, we propose the first Bayesian implementation of a discrete Weibull regression model. The implementation considers a novel parameterization, where both parameters of the discrete Weibull distribution can be made dependent on the predictors. In addition, prior distributions can be imposed that encourage parameter shrinkage and that lead to variable selection. As with Bayesian procedures, the full posterior distribution of the parameters is returned, from which credible intervals can be readily calculated. A simulation study and the analysis of four real datasets of medical records show promises for the wide applicability of this approach to the analysis of count data. The method is implemented in the R package {\\tt BDWreg}.\n\\end{abstract}\n\n\\begin{keyword}\nDiscrete Weibull\\sep  Bayesian\\sep  Regularized likelihood\n\\end{keyword}\n\n\\end{frontmatter}\n\n\n\n\n\n\n\n\n\\section{Introduction}\n\nData in the form of counts appear in many application areas, from medicine, social and natural sciences to econometrics, finance and industry \\citep{cameron2013regression}. In medicine, two examples of this are the length of stay in hospital, commonly used as an indicator of the quality of care and planning capacity within a hospital \\citep{atienza08,carter14},  and the number of visits to a specialist \\citep{machado05}, often taken as a measure of demand in healthcare. Other examples are high-throughput genomic data generated by next generation sequencing experiments \\citep{ozsolak11, bao14, robinson08} or lifetime data, such as the number of cycles before a machine breaks down \\citep{nakagawa75}.\n\nSimilarly to Weibull regression, which is widely used in lifetime data analysis and survival analysis for continuous response variables, \\cite{kalktawi15} have recently proposed a regression model for a discrete response based on the discrete Weibull distribution. A number of studies have found a good fit of this distribution in comparison with other distributions for count data \\citep{bracquemond03,englehardt11,lai13}. In the context of regression, \\cite{kalktawi15} show two important features of a discrete Weibull distribution that make this a valuable alternative to the more traditional Poisson and Negative Binomial distributions and their extensions, such as Poisson mixtures \\citep{hougaard97}, Poisson-Tweedie \\citep{esnaola13}, zero-inflated regression\\citep{lam06} and COMPoisson \\citep{sellers10}: the ability to capture over and under-dispersion simultaneously and a closed-form analytical expression of the quantiles of the conditional distribution.\n\nIn \\cite{kalktawi15}, maximum likelihood is used for the estimation of the parameters. This is in general the most common approach for parameter estimation in regression analysis of counts, due to a lack of simple and efficient algorithms for posterior computation \\citep{zhou12}. Among the contributions to Bayesian estimation of discrete regression models, \\cite{el1973bayesian} consider the case of Poisson regression, \\cite{zhou12} provide an efficient Bayesian implementation of negative Binomial regression, \\cite{mohebbi2014disease} develop Bayesian estimation for a Poisson and negative Binomial regression with a conditional autoregressive correlation structure whereas \\cite{angers2003bayesian,ghosh2006bayesian,neelon2010bayesian,liu2012bayesian} study zero-inflated Poisson regression. In this paper, we contribute to this literature, by providing the first Bayesian approach for parameter estimation in discrete Weibull regression. For the choice of prior distributions, we consider both the case of non-informative priors and the case of Laplace priors with a hyper penalty parameter. The choice of Laplace priors induces parameter shrinkage \\citep{park2008bayesian,kyung2010penalized}, and, with the use of Bayesian credible intervals, leads to variable selection, similar to alternative approaches such as spike and slab priors \\citep{ishwaran2005spike}.\n\nThe aim of this paper is two-fold. Firstly, we highlight the role that the discrete Weibull distribution has in modelling count data from a variety of applications, beyond its current limited use to lifetime data. We particularly emphasize applications in the medical domain, using several  datasets of medical records. Secondly,  we present a novel Bayesian regression model for counts based on the assumption of a discrete Weibull conditional distribution. The remainder of this paper is organized as follows. Section (\\ref{sec:regression}) describes the discrete Weibull regression model, with a more general parametrization as that presented in \\citep{kalktawi15}. Section (\\ref{dw-model-fitting}) describes Bayesian parameter estimation for a discrete Weibull regression model. Section (\\ref{DW:simulation}) presents an extensive simulation study, whereas Section (\\ref{empirical data in medicine}) shows the analysis of real data via Bayesian discrete regression model and a comparison with existing approaches. Finally, we draw some conclusions in Section (\\ref{Conclusion and discussion}).\n\n\n\n\n\\section{Discrete Weibull regression}\\label{sec:regression}\n\n\\subsection{Discrete Weibull distribution}\n\nThe discrete Weibull distribution was introduced by  \\cite{nakagawa75}, as a discretized form of a continuous Weibull distribution, similarly to the geometric distribution, which is the discretized form of the exponential distribution, and the negative Binomial, which is the discrete alternative of a Gamma distribution. In some papers, this is referred to as a type I discrete Weibull, as two other distributions were subsequently defined. \\cite{bracquemond03} review the three different distributions and point out the advantages of using the type I distribution: it has an unbounded support, differently to the type II distribution, and it has a more straightforward interpretation, differently to the type III distribution.\n\nIf a random variable $Y$ follows a (type I) discrete Weibull distribution, then  the cumulative distribution function of $Y$ is given by\n", "index": 1, "text": "\n\\[F(y; q, \\beta)=  \\left\\{\n  \\begin{array}{ll}\n     1-q^{(y+1)^{\\beta}} & \\quad \\textrm{if} \\,\\, y = 0, 1, 2, \\ldots \\mbox{(jump points)}\\\\\n     0 & \\quad \\textrm{if} \\,\\, y < 0\n   \\end{array} \\right.\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"F(y;q,\\beta)=\\left\\{\\begin{array}[]{ll}1-q^{(y+1)^{\\beta}}&amp;\\quad\\textrm{if}\\,%&#10;\\,y=0,1,2,\\ldots\\mbox{(jump points)}\\\\&#10;0&amp;\\quad\\textrm{if}\\,\\,y&lt;0\\end{array}\\right.\" display=\"block\"><mrow><mrow><mi>F</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo>;</mo><mi>q</mi><mo>,</mo><mi>\u03b2</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo>{</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><mn>1</mn><mo>-</mo><msup><mi>q</mi><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>y</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mi>\u03b2</mi></msup></msup></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mpadded lspace=\"10pt\" width=\"+13.4pt\"><mtext>if</mtext></mpadded><mo>\u2062</mo><mi>y</mi></mrow><mo>=</mo><mrow><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mrow><mi mathvariant=\"normal\">\u2026</mi><mo>\u2062</mo><mtext>(jump points)</mtext></mrow></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mn>0</mn></mtd><mtd columnalign=\"left\"><mrow><mrow><mpadded lspace=\"10pt\" width=\"+13.4pt\"><mtext>if</mtext></mpadded><mo>\u2062</mo><mi>y</mi></mrow><mo>&lt;</mo><mn>0</mn></mrow></mtd></mtr></mtable><mi/></mrow></mrow></math>", "type": "latex"}, {"file": "1601.02820.tex", "nexttext": "\nwith $q$ and $\\beta$ denoting the shape parameters. Throughout the paper, we will refer to this distribution as DW$(q,\\beta)$.\n\n\\subsection{Inference for Discrete Weibull: Existing Approaches}\n\n\\cite{khan89} derive estimators of the parameters  $q$ and $\\beta$ using the method of moments and a new method which they call the method of proportions, and they find a good performance for the latter.\nLet $Y_1,\\ldots,Y_n$ be a random sample from a DW$(q,\\beta)$ distribution and denote $Z=\\sum_{i=1}^n I(Y_i=0)$ and $U=\\sum_{i=1}^n I(Y_i=1)$. Using the method of proportions, the following estimators of $q$ and $\\beta$ are proposed:\n\\begin{eqnarray*}\n\\hat q &=& 1-\\dfrac{Z}{n}\\\\\n\\hat \\beta &=& \\ln \\Big[\\ln\\Big(1-\\dfrac{Z}{n}-\\dfrac{U}{n}\\Big)/\\ln\\Big(1-\\dfrac{Z}{n}\\Big)\\Big]/\\ln(2).\n\\end{eqnarray*}\nThese estimators use only the zeros and ones in the sample. \\cite{santos13} derive an improved estimator of $\\beta$, by taking all observations into account. In particular, let $d_m$ be the maximum observed value of $Y$ and let $k=d_m-1$. If $d_m>2$, then the following improved estimator is proposed:\n", "itemtype": "equation", "pos": 7898, "prevtext": "\nwith $0<q<1$ and $\\beta>0$ the shape parameters.\nA similar definition can be given on the support $1,2,\\ldots$. In this case, $F(y; q, \\beta)=1-q^{y^\\beta}$, for $y=1,2,\\ldots$. Comparing this cdf with that of a continuous Weibull distribution with parameters $\\alpha$ and $\\gamma$, one can see that there is a direct correspondence between $\\beta$ and $\\gamma$, whereas $q$ in the discrete case corresponds to $\\exp(-\\alpha)$ in the continuous case \\citep{khan89}.\n\nGiven the form of the cumulative distribution function, the discrete Weibull distribution has the following probability mass function:\n", "index": 3, "text": "\n\\[p(y; q,\\beta)=q^{y^{\\beta}}-q^{(y+1)^{\\beta}},\\,\\,\\  y=0, 1, 2, ...\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"p(y;q,\\beta)=q^{y^{\\beta}}-q^{(y+1)^{\\beta}},\\,\\,\\ y=0,1,2,...\" display=\"block\"><mrow><mrow><mrow><mi>p</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo>;</mo><mi>q</mi><mo>,</mo><mi>\u03b2</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><msup><mi>q</mi><msup><mi>y</mi><mi>\u03b2</mi></msup></msup><mo>-</mo><msup><mi>q</mi><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>y</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mi>\u03b2</mi></msup></msup></mrow></mrow><mo rspace=\"10.9pt\">,</mo><mrow><mi>y</mi><mo>=</mo><mrow><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.02820.tex", "nexttext": "\nwhere $\\hat{F}$ denotes the empirical cdf. When $d_m=2$, this estimator is equivalent to the one from \\cite{khan89}. Note that in both cases, no estimates of $\\beta$ can be obtained when $\\hat q =1$, i.e. there are no zero counts in the observed data, or $\\hat q =0$, i.e. all counts are zero. However, in other cases, the estimators perform relatively well, particularly in the case of small sample sizes, as we have checked with a simulation study (not shown here).\n\n\\cite{kulasekera94} considers maximum likelihood for the estimation of $q$ and $\\beta$. The likelihood function for a discrete Weibull sample is given by:\n", "itemtype": "equation", "pos": 9071, "prevtext": "\nwith $q$ and $\\beta$ denoting the shape parameters. Throughout the paper, we will refer to this distribution as DW$(q,\\beta)$.\n\n\\subsection{Inference for Discrete Weibull: Existing Approaches}\n\n\\cite{khan89} derive estimators of the parameters  $q$ and $\\beta$ using the method of moments and a new method which they call the method of proportions, and they find a good performance for the latter.\nLet $Y_1,\\ldots,Y_n$ be a random sample from a DW$(q,\\beta)$ distribution and denote $Z=\\sum_{i=1}^n I(Y_i=0)$ and $U=\\sum_{i=1}^n I(Y_i=1)$. Using the method of proportions, the following estimators of $q$ and $\\beta$ are proposed:\n\\begin{eqnarray*}\n\\hat q &=& 1-\\dfrac{Z}{n}\\\\\n\\hat \\beta &=& \\ln \\Big[\\ln\\Big(1-\\dfrac{Z}{n}-\\dfrac{U}{n}\\Big)/\\ln\\Big(1-\\dfrac{Z}{n}\\Big)\\Big]/\\ln(2).\n\\end{eqnarray*}\nThese estimators use only the zeros and ones in the sample. \\cite{santos13} derive an improved estimator of $\\beta$, by taking all observations into account. In particular, let $d_m$ be the maximum observed value of $Y$ and let $k=d_m-1$. If $d_m>2$, then the following improved estimator is proposed:\n", "index": 5, "text": "\n\\[\\hat \\beta = \\dfrac{1}{k}\\sum_{d=1}^k\\ln \\Big[\\ln\\Big(1-\\hat{F}(d)\\Big)/\\ln(\\hat q)\\Big]/\\ln(d+1),\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"\\hat{\\beta}=\\dfrac{1}{k}\\sum_{d=1}^{k}\\ln\\Big{[}\\ln\\Big{(}1-\\hat{F}(d)\\Big{)}/%&#10;\\ln(\\hat{q})\\Big{]}/\\ln(d+1),\" display=\"block\"><mrow><mrow><mover accent=\"true\"><mi>\u03b2</mi><mo stretchy=\"false\">^</mo></mover><mo>=</mo><mrow><mfrac><mn>1</mn><mi>k</mi></mfrac><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>d</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><mrow><mrow><mi>ln</mi><mo>\u2061</mo><mrow><mo maxsize=\"160%\" minsize=\"160%\">[</mo><mrow><mrow><mi>ln</mi><mo>\u2061</mo><mrow><mo maxsize=\"160%\" minsize=\"160%\">(</mo><mrow><mn>1</mn><mo>-</mo><mrow><mover accent=\"true\"><mi>F</mi><mo stretchy=\"false\">^</mo></mover><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>d</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo maxsize=\"160%\" minsize=\"160%\">)</mo></mrow></mrow><mo>/</mo><mrow><mi>ln</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mi>q</mi><mo stretchy=\"false\">^</mo></mover><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo maxsize=\"160%\" minsize=\"160%\">]</mo></mrow></mrow><mo>/</mo><mrow><mi>ln</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>d</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02820.tex", "nexttext": "\nthe maximum of which can be found numerically.\n\nThere is no explicit work in the literature for building confidence intervals for discrete Weibull parameters, although standard asymptotic likelihood and bootstrap approaches can be used. The Bayesian approach that we devise in this paper will lead naturally to credible intervals for the parameters.\n\n\n\\subsection{Regression via a discrete Weibull}\n\nLet $Y$ be the response variable with possible values $0,1, \\ldots$, and let $X_1,\\ldots,X_{p}$ be $p$ covariates.\nWe assume that the conditional distribution of $Y$ given $X$ follows a DW distribution with parameters $q$ and $\\beta$. There are a number of possible choices to link the parameters $q$ and $\\beta$ to the  covariates. In particular, we propose the following link functions:\n\\begin{enumerate}\n\t\\item $q$ dependent on $X$ via\n\t\n", "itemtype": "equation", "pos": 9798, "prevtext": "\nwhere $\\hat{F}$ denotes the empirical cdf. When $d_m=2$, this estimator is equivalent to the one from \\cite{khan89}. Note that in both cases, no estimates of $\\beta$ can be obtained when $\\hat q =1$, i.e. there are no zero counts in the observed data, or $\\hat q =0$, i.e. all counts are zero. However, in other cases, the estimators perform relatively well, particularly in the case of small sample sizes, as we have checked with a simulation study (not shown here).\n\n\\cite{kulasekera94} considers maximum likelihood for the estimation of $q$ and $\\beta$. The likelihood function for a discrete Weibull sample is given by:\n", "index": 7, "text": "\n\\[L(q, \\beta) = \\prod_{i=1}^n \\Big(q^{y_i^{\\beta}}-q^{(y_i+1)^{\\beta}}\\Big),\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m1\" class=\"ltx_Math\" alttext=\"L(q,\\beta)=\\prod_{i=1}^{n}\\Big{(}q^{y_{i}^{\\beta}}-q^{(y_{i}+1)^{\\beta}}\\Big{)},\" display=\"block\"><mrow><mrow><mrow><mi>L</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>q</mi><mo>,</mo><mi>\u03b2</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u220f</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo maxsize=\"160%\" minsize=\"160%\">(</mo><mrow><msup><mi>q</mi><msubsup><mi>y</mi><mi>i</mi><mi>\u03b2</mi></msubsup></msup><mo>-</mo><msup><mi>q</mi><msup><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mi>\u03b2</mi></msup></msup></mrow><mo maxsize=\"160%\" minsize=\"160%\">)</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02820.tex", "nexttext": "\n\twhere  $X=(1 \\: X_1 \\ldots X_{p})$ and $\\boldsymbol{\\theta}=(\\theta_0 \\ldots \\theta_{p})'$.\n\n\t\\item $\\beta$ dependent on $X$ via\n\t\n", "itemtype": "equation", "pos": 10718, "prevtext": "\nthe maximum of which can be found numerically.\n\nThere is no explicit work in the literature for building confidence intervals for discrete Weibull parameters, although standard asymptotic likelihood and bootstrap approaches can be used. The Bayesian approach that we devise in this paper will lead naturally to credible intervals for the parameters.\n\n\n\\subsection{Regression via a discrete Weibull}\n\nLet $Y$ be the response variable with possible values $0,1, \\ldots$, and let $X_1,\\ldots,X_{p}$ be $p$ covariates.\nWe assume that the conditional distribution of $Y$ given $X$ follows a DW distribution with parameters $q$ and $\\beta$. There are a number of possible choices to link the parameters $q$ and $\\beta$ to the  covariates. In particular, we propose the following link functions:\n\\begin{enumerate}\n\t\\item $q$ dependent on $X$ via\n\t\n", "index": 9, "text": "\\begin{align*} \n    & \\log(-\\log(q))=X \\boldsymbol{\\theta} \\:\\: \\mbox{or}\\\\\n\t & \\log\\Big(\\frac{q}{1-q}\\Big)=X \\boldsymbol{\\theta},\\\\\n\t\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\log(-\\log(q))=X\\boldsymbol{\\theta}\\&gt;\\&gt;\\mbox{or}\" display=\"inline\"><mrow><mrow><mi>log</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mrow><mi>log</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>q</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mi>X</mi><mo>\u2062</mo><mpadded width=\"+4.4pt\"><mi>\ud835\udf3d</mi></mpadded><mo>\u2062</mo><mtext>or</mtext></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex6.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\log\\Big{(}\\frac{q}{1-q}\\Big{)}=X\\boldsymbol{\\theta},\" display=\"inline\"><mrow><mrow><mrow><mi>log</mi><mo>\u2061</mo><mrow><mo maxsize=\"160%\" minsize=\"160%\">(</mo><mstyle displaystyle=\"true\"><mfrac><mi>q</mi><mrow><mn>1</mn><mo>-</mo><mi>q</mi></mrow></mfrac></mstyle><mo maxsize=\"160%\" minsize=\"160%\">)</mo></mrow></mrow><mo>=</mo><mrow><mi>X</mi><mo>\u2062</mo><mi>\ud835\udf3d</mi></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02820.tex", "nexttext": "\n\twhere $\\boldsymbol{\\gamma}=(\\gamma_0 \\: \\gamma_1 \\ldots \\gamma_{p})'$.\n\\end{enumerate}\nThe first parametrization was proposed by \\citep{kalktawi15}, in line with the link function used in continuous Weibull regression. In this paper, we consider one additional parametrization for $q$ via a logit link function, which has proved to be rather effective for statistical inference, and a link also between the second parameter $\\beta$ and the covariates, in order to capture more complex dependencies.\n\n\n\\section{Bayesian inference for discrete Weibull regression}\\label{dw-model-fitting}\n\nIn this section, we discuss Bayesian estimation of the regression parameters $\\boldsymbol{\\theta}=(\\theta_0\\ldots\\theta_{p})'$ and $\\boldsymbol{\\gamma}=(\\gamma_0\\ldots\\gamma_{p})'$. The advantage of choosing Bayesian approaches over classical maximum likelihood inference is two-fold. Firstly, the possibility of taking  prior information into account and, secondly, the procedure returns automatically credible intervals for all parameters.\n\nGiven $n$ observations $y_i$ and $(x_{i1},\\ldots,x_{i{p}})$, $i=1,\\ldots,n$, for  the response $Y$ and the covariates $X$, respectively, and letting $x_i$  be the row vector $x_i=(1,x_{i1},\\ldots,x_{ip})$, the likelihood for the most general case is given by\n\n", "itemtype": "equation", "pos": 10996, "prevtext": "\n\twhere  $X=(1 \\: X_1 \\ldots X_{p})$ and $\\boldsymbol{\\theta}=(\\theta_0 \\ldots \\theta_{p})'$.\n\n\t\\item $\\beta$ dependent on $X$ via\n\t\n", "index": 11, "text": "\\begin{align*} \n\t\\log(\\beta)= X\\boldsymbol{\\gamma},\n\t\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex8.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\log(\\beta)=X\\boldsymbol{\\gamma},\" display=\"inline\"><mrow><mrow><mrow><mi>log</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b2</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mi>X</mi><mo>\u2062</mo><mi>\ud835\udf38</mi></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02820.tex", "nexttext": "\n\nWe consider different prior distributions on $\\boldsymbol{\\theta}$ and $\\boldsymbol{\\gamma}$. Unfortunately, in the context of discrete Weibull regression, there are no conjugate priors. However, we will show in the simulation study how an uninformative prior achieves an acceptable rate of mixing as well as  comparable estimation to maximum likelihood. In addition, we consider a prior on the regression coefficients that encourages sparsity. In particular, we consider a Laplace prior for $\\theta$ and $\\gamma$, of the form\n\n", "itemtype": "equation", "pos": 12352, "prevtext": "\n\twhere $\\boldsymbol{\\gamma}=(\\gamma_0 \\: \\gamma_1 \\ldots \\gamma_{p})'$.\n\\end{enumerate}\nThe first parametrization was proposed by \\citep{kalktawi15}, in line with the link function used in continuous Weibull regression. In this paper, we consider one additional parametrization for $q$ via a logit link function, which has proved to be rather effective for statistical inference, and a link also between the second parameter $\\beta$ and the covariates, in order to capture more complex dependencies.\n\n\n\\section{Bayesian inference for discrete Weibull regression}\\label{dw-model-fitting}\n\nIn this section, we discuss Bayesian estimation of the regression parameters $\\boldsymbol{\\theta}=(\\theta_0\\ldots\\theta_{p})'$ and $\\boldsymbol{\\gamma}=(\\gamma_0\\ldots\\gamma_{p})'$. The advantage of choosing Bayesian approaches over classical maximum likelihood inference is two-fold. Firstly, the possibility of taking  prior information into account and, secondly, the procedure returns automatically credible intervals for all parameters.\n\nGiven $n$ observations $y_i$ and $(x_{i1},\\ldots,x_{i{p}})$, $i=1,\\ldots,n$, for  the response $Y$ and the covariates $X$, respectively, and letting $x_i$  be the row vector $x_i=(1,x_{i1},\\ldots,x_{ip})$, the likelihood for the most general case is given by\n\n", "index": 13, "text": "\\begin{equation*}\n\n\tl(\\boldsymbol{\\theta},\\boldsymbol{\\gamma}|X,Y) = \\prod_{i=1}^n\n\t \\bigg( (\\frac{e^{x_i\\boldsymbol{\\theta}}}{1+e^{x_i\\boldsymbol{\\theta}}})^{{y}^{x_i\\boldsymbol{\\gamma}}}\n\t-\n\t (\\frac{e^{x_i\\boldsymbol{\\theta}}}{1+e^{x_i\\boldsymbol{\\theta}}})^{{(y+1)}^{x_i\\boldsymbol{\\gamma}}} \\bigg).\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex9.m1\" class=\"ltx_Math\" alttext=\"\\par&#10; l(\\boldsymbol{\\theta},\\boldsymbol{\\gamma}|X,Y)=\\prod_{i=1}^{n}\\bigg{(}(%&#10;\\frac{e^{x_{i}\\boldsymbol{\\theta}}}{1+e^{x_{i}\\boldsymbol{\\theta}}})^{{y}^{x_{%&#10;i}\\boldsymbol{\\gamma}}}-(\\frac{e^{x_{i}\\boldsymbol{\\theta}}}{1+e^{x_{i}%&#10;\\boldsymbol{\\theta}}})^{{(y+1)}^{x_{i}\\boldsymbol{\\gamma}}}\\bigg{)}.\" display=\"block\"><mrow><mi>l</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf3d</mi><mo>,</mo><mi>\ud835\udf38</mi><mo stretchy=\"false\">|</mo><mi>X</mi><mo>,</mo><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow><mo>=</mo><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u220f</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo maxsize=\"210%\" minsize=\"210%\">(</mo><msup><mrow><mo stretchy=\"false\">(</mo><mfrac><msup><mi>e</mi><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>\u2062</mo><mi>\ud835\udf3d</mi></mrow></msup><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>\u2062</mo><mi>\ud835\udf3d</mi></mrow></msup></mrow></mfrac><mo stretchy=\"false\">)</mo></mrow><msup><mi>y</mi><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>\u2062</mo><mi>\ud835\udf38</mi></mrow></msup></msup><mo>-</mo><msup><mrow><mo stretchy=\"false\">(</mo><mfrac><msup><mi>e</mi><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>\u2062</mo><mi>\ud835\udf3d</mi></mrow></msup><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>\u2062</mo><mi>\ud835\udf3d</mi></mrow></msup></mrow></mfrac><mo stretchy=\"false\">)</mo></mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>y</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>\u2062</mo><mi>\ud835\udf38</mi></mrow></msup></msup><mo maxsize=\"210%\" minsize=\"210%\">)</mo></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02820.tex", "nexttext": "\nFor a given choice of $\\lambda$ and $\\tau$, maximising the posterior probability under these priors corresponds to maximising the $L_1$ penalised log-likelihood\n\n", "itemtype": "equation", "pos": 13199, "prevtext": "\n\nWe consider different prior distributions on $\\boldsymbol{\\theta}$ and $\\boldsymbol{\\gamma}$. Unfortunately, in the context of discrete Weibull regression, there are no conjugate priors. However, we will show in the simulation study how an uninformative prior achieves an acceptable rate of mixing as well as  comparable estimation to maximum likelihood. In addition, we consider a prior on the regression coefficients that encourages sparsity. In particular, we consider a Laplace prior for $\\theta$ and $\\gamma$, of the form\n\n", "index": 15, "text": "\\begin{align*}\np(\\boldsymbol{\\theta}|\\lambda) & =\\frac{\\lambda}{2}e^{-\\lambda|\\boldsymbol{\\theta}|},\\qquad \\lambda>0,\\\\\np(\\boldsymbol{\\gamma}|\\tau) & =\\frac{\\tau}{2}e^{-\\tau|\\boldsymbol{\\gamma}|},\\qquad \\tau >0.\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex10.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle p(\\boldsymbol{\\theta}|\\lambda)\" display=\"inline\"><mrow><mi>p</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf3d</mi><mo stretchy=\"false\">|</mo><mi>\u03bb</mi><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex10.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\frac{\\lambda}{2}e^{-\\lambda|\\boldsymbol{\\theta}|},\\qquad\\lambda%&#10;&gt;0,\" display=\"inline\"><mrow><mrow><mrow><mi/><mo>=</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mi>\u03bb</mi><mn>2</mn></mfrac></mstyle><mo>\u2062</mo><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi>\u03bb</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udf3d</mi><mo stretchy=\"false\">|</mo></mrow></mrow></mrow></msup></mrow></mrow><mo rspace=\"22.5pt\">,</mo><mrow><mi>\u03bb</mi><mo>&gt;</mo><mn>0</mn></mrow></mrow><mo>,</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex11.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle p(\\boldsymbol{\\gamma}|\\tau)\" display=\"inline\"><mrow><mi>p</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf38</mi><mo stretchy=\"false\">|</mo><mi>\u03c4</mi><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex11.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\frac{\\tau}{2}e^{-\\tau|\\boldsymbol{\\gamma}|},\\qquad\\tau&gt;0.\" display=\"inline\"><mrow><mrow><mrow><mi/><mo>=</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mi>\u03c4</mi><mn>2</mn></mfrac></mstyle><mo>\u2062</mo><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi>\u03c4</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udf38</mi><mo stretchy=\"false\">|</mo></mrow></mrow></mrow></msup></mrow></mrow><mo rspace=\"22.5pt\">,</mo><mrow><mi>\u03c4</mi><mo>&gt;</mo><mn>0</mn></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02820.tex", "nexttext": "\nas in the traditional lasso approach \\citep{park2008bayesian,tibshirani1996regression}.\nWe further assume a Gamma(a,b) hyper prior for both $\\lambda$ and $\\tau$, leading to the posterior distribution\n\n", "itemtype": "equation", "pos": 13585, "prevtext": "\nFor a given choice of $\\lambda$ and $\\tau$, maximising the posterior probability under these priors corresponds to maximising the $L_1$ penalised log-likelihood\n\n", "index": 17, "text": "\\begin{align*}\n\\log l(\\boldsymbol{\\theta},\\boldsymbol{\\gamma}|X,Y) -\\lambda\\sum_{j=1}^{p} |\\theta_j|-\\tau\\sum_{k=1}^{p} |\\gamma_k|,\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex12.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\log l(\\boldsymbol{\\theta},\\boldsymbol{\\gamma}|X,Y)-\\lambda\\sum_{%&#10;j=1}^{p}|\\theta_{j}|-\\tau\\sum_{k=1}^{p}|\\gamma_{k}|,\" display=\"inline\"><mrow><mi>log</mi><mi>l</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf3d</mi><mo>,</mo><mi>\ud835\udf38</mi><mo stretchy=\"false\">|</mo><mi>X</mi><mo>,</mo><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow><mo>-</mo><mi>\u03bb</mi><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover></mstyle><mo stretchy=\"false\">|</mo><msub><mi>\u03b8</mi><mi>j</mi></msub><mo stretchy=\"false\">|</mo><mo>-</mo><mi>\u03c4</mi><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover></mstyle><mo stretchy=\"false\">|</mo><msub><mi>\u03b3</mi><mi>k</mi></msub><mo stretchy=\"false\">|</mo><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02820.tex", "nexttext": "\n\n\nAs Gibbs sampling is not possible, we choose a Metropolis-Hastings sampling~\\citep{hastings1970monte} to draw samples from the full conditional posterior and we provide an implementation in the R package \\texttt{BDWreg}. From the posterior distribution, the mode of the marginal densities can be used as point estimate of the parameters, whereas the whole distribution is used for building credible intervals. In the case of Laplace priors, the inclusion or not of zero in the Highest Posterior Density (HPD) interval  is used for variable selection. MCMC samplers have been used before in the continuous Weibull regression context by \\cite{newcombe2014weibull}, which utilizes a Reversible Jump MCMC, and \\cite{soliman2012modified} which uses a hybrid method consisting of Metropolis-Hastings and Gibbs sampler to estimate parameters in a three parameters continuous Weibull distribution. Moreover,~\\citep{polpo2009statistical} make use of a Metropolis-Hasting sampler to make inference for a continuous two-parameters Weibull distribution in a censoring framework.\n\n\n\\section{Simulations study}\\label{DW:simulation}\nIn this section, we perform a simulation study where we show the effectiveness of the Bayesian estimation procedure, both in the case of data drawn from a DW regression model and in the case of model misspecification, where the generating model is that of Poisson or Negative Binomial (NB). Finally, we test the use of Laplace priors in a variable selection scenario.\n\n\\subsection{Simulation from a DW regression model}\n\nTable (\\ref{ch3:table1}) shows six configurations of parameters used in the simulation, where we consider the two link functions for $q$ and the link function for $\\beta$ described in Section (\\ref{sec:regression}), i.e. imposing a linear model on ${\\text{logit}}(q)$ or $\\log(-\\log(q))$, and on $\\log(\\beta)$.\n\\small\n\\begin{table}[!htp]\n\t\\caption{The configuration of DW regression models used in the simulation.\\label{ch3:table1}}\n\t\\centering\n\\resizebox{\\linewidth}{!}{\n\t\\begin{tabular}{lll}\n\t\t\\hline  \\textbf{Model} & \t\\multicolumn{2}{c}{\\textbf{True Parameters}}\\\\\n\t\t\t\\hline  $DW(q,\\beta$) \t\t& $q =.41$\t& $\\beta=1.1$\\\\\n\t\t\t\\hline  $DW(q,reg\\beta$) \t&\t$q=.8$\t& \t $\\gamma_0 =.1$ , \t$\\gamma_1=-.15$ , $\\gamma_2=.5$\t\\\\\n\t\t\t\\hline  ${\\text{logit}}:DW(regQ,\\beta$)\t\t& $\\theta_0 =.4$ , \t$\\theta_1=-.1$ , $\\theta_2=.34$\t&  \t$\\beta=.7$\\\\\n\t\t\t\\hline  ${\\text{logit}}:DW(regQ,reg\\beta$)\t& $\\theta_0 =.4$ , \t$\\theta_1=-.1$ , $\\theta_2=.34$\t&   \t $\\gamma_0 =.1$ ,\t $\\gamma_1=-.15$ , $\\gamma_2=.5$  \\\\\n\t\t\t\\hline  ${\\text{log-log}}:DW(regQ,\\beta$)\t\t& $\\theta_0 =.4$ , \t$\\theta_1=-.1$ , $\\theta_2=.34$\t&  \t$\\beta=.7$  \\\\\n\t\t\t\\hline  ${\\text{log-log}}:DW(regQ,reg\\beta$)\t& $\\theta_0 =.4$ , \t$\\theta_1=-.1$ , $\\theta_2=.34$\t&   \t $\\gamma_0 =.1$ ,\t $\\gamma_1=-.15$ , $\\gamma_2=.5$\\\\\n\t\t\t\\hline\t\t\n\t\\end{tabular}}\n\\end{table}\n\\normalsize\nFor cases 2 to 6, we generate the three predictors uniformly in the interval $[0,1.5]$ and we simulate 500 observations. For the Bayesian estimation of the parameters, we use non-informative priors and make use of a Metropolis-Hastings algorithm with an independent Gaussian proposal to draw samples from the posterior. The scale of the proposal is adjusted so that a recommended acceptance rate lies in $(22,25)\\%$~\\citep{bedard2008optimal}. We consider 25,000 iterations of the sampler and use the first $25\\%$ of the data as burn-in.\n\nFigure (\\ref{fig:summary_case1}) shows the posterior distribution of the parameters and the chain convergence in the first case, when no exogenous variables are present. Similar plots are obtained for the other cases. Figure (\\ref{fig:case1234 HPDI}) shows the marginal densities of the parameters and the 95\\% HPD interval for all six cases, as well as the maximum likelihood point estimate and the true value of the parameters. Overall, the plots show convergence of the chain and accurate estimation of the parameters.\n\\normalsize\n\\begin{figure}[ht]\n\\centering\n\\includegraphics[width=\\linewidth]{summary_case1.pdf}\n\\caption{Marginal densities and chain convergence for $q$ (top) and $\\beta$ (bottom), for  case 1  where there are no exogenous variables in model.}\n\\label{fig:summary_case1}\n\\end{figure}\n\\begin{figure}[!hp]\n\\centering\n\\includegraphics[width=.75\\linewidth]{case12.pdf}\n\\includegraphics[width=.75\\linewidth]{case34.pdf}\n\\includegraphics[width=.75\\linewidth]{case56.pdf}\n\\caption{Marginal densities and 95\\% high probability density interval  for cases 1-6 in Table (\\ref{ch3:table1}).}\n\\label{fig:case1234 HPDI}\n\\end{figure}\n\n\\subsection{Simulation from a Poisson and NB regression model}\n\nThe aim of this section is to test the fitting of a DW regression model to data generated from a Poisson and NB regression. To this end, we design two experiments using two explanatory variables, $X=(X_1,X_2)$, and $n=500$ data points. We simulate data for the predictors from uniform distributions, namely $X_1\\sim U(0,1)$ and $X_2\\sim U(0,1.5)$. We fix the intercept and the regression parameters to $\\alpha=( -0.5,4.3,-2.2)$, with values chosen to cover a wide range of shapes for the target distribution. Then, in the first experiment, we assume that the conditional distribution of $Y$ given $X$ is ${\\rm Poisson}(e^{X\\alpha})$, whereas in the second experiment, we assume it to be a NB distribution with mean $\\mu=e^{X\\alpha}$ and variance $\\mu + \\mu^2/\\theta$ with $\\theta = 4.5$. Figures (\\ref{fig:DW_SIM}) shows the conditional distribution fitted by $DW(regQ,\\beta)$ for a fixed value of $x_1=0.5$ and sliding values of $x_2$ in the $[0,0.7]$ interval. \n The figure shows how the estimation improves as the mean of the target distribution decreases, both for Bayesian and frequentist approaches. In addition, the ${\\text{logit}}$ link shows a better fit compared to the ${\\text{log-log}}$ link in both Poisson and NB  experiments. For the frequentist estimation, we use the R package \\texttt{DWreg}.\n\\begin{figure}[!hp]\n\\centering\n\\includegraphics[width=\\linewidth]{regQ_POISSON_DW_SIM.pdf}\n\\includegraphics[width=\\linewidth]{regQ_NB_DW_SIM.pdf}\n\\caption{Fitting Poisson (top) and NB (bottom) simulated data by $DW(regQ,\\beta)$ for a range of values of $x_2$ and fixed $x_1 = 0.5$. The plots show the true conditional pmf (black) together with the conditional pmf fitted by the Bayesian DW  model proposed in this paper, with the ${\\text{logit}}(q)$ (red) and ${\\text{log-log}}(q)$ (blue) links, and by the corresponding frequentist approaches (green and light blue, respectively).}\n\\label{fig:DW_SIM}\n\\end{figure}\n\n\\subsection{Simulation on Variable Selection}\nIn this simulation, we show the performance of DW regression for variable selection. To this end, we generate $50$ parameters  uniformly in the $[-0.5,0.5]$ interval. Without loss of generality we assume that $75\\%$ of the parameters, 37 out of 50,  are zero and the rest are non-zero. We simulate $500$ observations for each predictor from a $U(0,1.5)$ distribution, and the response variable from a DW distribution using a logit link for $q$ or the log link for $\\beta$. Similar results are obtained with the ${\\text{log-log}}$ link function. For parameter estimation, we keep the average rate of acceptance  in the $(20,30) \\%$ interval for the total of $50,000$ iterations. Variable selection is performed by considering the 95\\% HPD interval for each parameter.\n\nTable (\\ref{ch3:High-dimentional simulations}) shows the performance of the method in terms of selection of variables. In particular, the table reports the True Negative Rate (TNR), Recall $\\Big(\\dfrac{\\rm{TP}}{\\rm{TP}+\\rm{FN}}\\Big)$, Precision $\\Big(\\dfrac{\\rm{TP}}{\\rm{TP}+\\rm{FP}}\\Big)$ and $F_1$ score $\\Big(\\dfrac{2\\rm{TP}}{2\\rm{TP}+\\rm{FN}+\\rm{FP}}\\Big)$, averaged over 20 simulations. The table shows a good performance overall, particularly for the $BDW(regQ,\\beta$) models. The model with the $\\log(\\beta)$ link does not perform very well when $q$ decreases, i.e. when the number of zeros in the sample increases. In these cases, the models show a low recall, that is a high false negative rate.\n\\begin{table}[!hpt]\n\t\\caption{Performance of BDW with Laplace priors. Variables are selected based on  the 95\\% HPD interval and the selection is compared with the truth on the basis of True Negative Rate (TNR), recall, precision and $F_1$ score.\\label{ch3:High-dimentional simulations}}\n\t\\centering\n\t\\resizebox{0.85\\linewidth}{!}{\n\n\t\\begin{tabular}{lllccccccc}\n\t\\hline \\textbf{} & \\textbf{Model}\t&& \\textbf{TNR} \t& \\textbf{Recall} \t & \\textbf{Precision} &  \\textbf{$\\boldsymbol{F_1}$}\\\\\n\\hline &  $BDW(regQ,\\beta=.1$) \t&    \t&  93\\%\t\t \t&  90\\%\t&  \t93\\% & 91\\%\\\\\n\t & $BDW(regQ,\\beta=.8$) \t \t&  \t\t&  95\\%\t\t&  89\\%\t&  95\\% & 92\\% \t\\\\\n\t& $BDW(regQ,\\beta=1.6$)  \t\t&\t\t&  93\\%\t&  91\\%\t&   93\\% & 92\\%\t\\\\\n\\hline\n\t& $BDW(regQ,reg\\beta$) \t&   \t\t&  97\\%\t &  68\\%\t& 96\\% & 79\\%\t\\\\\n\\hline\n\t& $BDW(q=.85,reg\\beta$) &   \t\t&  90\\%\t\t &  92\\%\t&  91\\% & 91\\%\t\t\\\\\n\t & $BDW(q=.50,reg\\beta$) \t \t&   \t\t&  93\\%\t\t &  37\\%\t\t& \t84\\% & 52\\%\t\\\\\n\n\t\\hline\n\t\\end{tabular}\n\n\t}\n\\end{table}\n\n\n\\section{Analysis of counts in medicine}\\label{empirical data in medicine}\n\nIn this section, we show the performance of the Bayesian discrete Weibull regression model on real datasets from the medical domain. We compare the proposed model with the Bayesian Poisson (BPoisson) and Bayesian Negative Binomial (BNB) models on the basis of a number of commonly used criteria: Bayesian Information Criteria (BIC)~\\citep{dayton2003model}, Akaike Information Criteria (AIC)~\\citep{dayton2003model}, Deviance Information Criterion (DIC)~\\citep{spiegelhalter2002bayesian}, Quasi-likelihood Information Criteria (QIC)~\\citep{pan2001akaike}, Consistent AIC (CAIC)~\\citep{bozdogan1987model}, Bayesian Predictive Information Criterion (BPIC)~\\citep{ando2007bayesian} and  the Prior Predictive Density (PPD) used in the Bayes factor~\\citep{kass1993bayes}.\n\n\\subsection{Comparison with Bayesian generalised linear models} \\label{sec:Analysis of medical data}\n\nTo show the ability of BDW to estimate parameters in the presence of  under-dispersion, over-dispersion and excessive zeros in count data, we choose  the following three medical datasets:\n\\begin{enumerate}\n\\item The data on inhaler usage from \\cite{grunwald2011statistical}, with 5209 observations. The response is the daily counts of inhalers usage, whereas the covariates are  humidity, barometric pressure, daily temperature, air particles level. The data show under-dispersion \\citep{kalktawi15}.\n\\item The German health survey dataset available in the R package \\texttt{COUNT} under the name \\texttt{badhealth}, with 1127 observations. The response is the number of visits to doctors and the predictors are whether the patient claims to be in bad health or not, and the age of the patient. The data show over-dispersion \\citep{kalktawi15}.\n\\item The German health registry dataset available in the R package \\texttt{COUNT} under the name \\texttt{rwm}, with 27326 observations. The response is the number of visits to doctors and the predictors are age, years of education and household yearly income. The data show over-dispersion with a relatively large number of zeros (37\\%) \\citep{kalktawi15}.\n\\end{enumerate}\n\nWe fit a BDW model with an uninformative prior on the regression parameters, 35000 iterations for the Metropolis-Hastings algorithm and an acceptance rate in the $(20,30)\\%$ interval. For the case of BPoisson and BNB regression, we make use of  the \\texttt{MCMCpack} R package~\\citep{martin2011mcmcpack} with the same configurations. Table \\ref{tb:RealData-Uninformative} shows a comparison of the models on the three datasets. We only report the results of the BDW(regQ,$\\beta$) models and, of these, the {\\text{logit}}(q) link shows superior performance. In all cases, the BDW model has the same or better performance than both Poisson and negative Binomial. This was found also by \\citep{kalktawi15}, where a frequentist approach was used and the comparison was made also with additional models such as COM-Poisson and hurdle/zero-inflated models.\n\n\\begin{table}[hp!]\n\t\\centering\n\t\\caption{Comparison of Bayesian DW, Poisson  and Negative Binomial on three datasets and under a number of information criteria. (*) denotes the minimum value.\\label{tb:RealData-Uninformative}\n\n\t}\n\t\\resizebox{\\linewidth}{!}{\n\t\\begin{tabular}{lllllllll}\n    \\hline \\textbf{Model} & \\textbf{AIC} & \\textbf{BIC}  & \\textbf{CAIC} & \\textbf{QIC} & \\textbf{DIC} & \\textbf{BPIC} & \\textbf{log(PPD)} & \\textbf{df}\\\\\n\t\\hline \\multicolumn{9}{l}{\\textbf{Inhaler Use (under-dispersed)}}\\\\\n\t\\hline  ${\\text{log-log}}:BDW$&  13497.22  &  13536.57 & 13542.57 & 2.59* & 13487.63 & 13493.88 & -6745.93 & 6\\\\\n\t\\hline  ${\\text{logit}}:BDW$& 13494.19*  &  13533.54* & 13539.54* & 2.59* & 13484.92* & 13490.49* & -6739.41* & 6\\\\\n\t\\hline  BPoisson &   14009.01  &  14041.80 & 14046.80 & 2.69 & 13822.54 & 13734.31 & -6960.64 & 5\\\\\n\t\\hline  BNB\t   &  \t 13952.85  &  13992.33 & 13998.20 & 2.68 & 13771.0 & 13686.47& -6960.81 & 6   \\\\\n    \\hline \\multicolumn{9}{l}{\\textbf{German Health Survey (over-dispersed)}}\\\\\n  \t\\hline  ${\\text{log-log}}:BDW$ & \t4478.9  &  4499.0 & 4502.0 & 3.98 & 4474.60 & 4478.33 & -2245.75 & 4\\\\\n\t\\hline  ${\\text{logit}}:BDW$&   4475.2*\t&  4495.3* & 4449.3* & 3.97* & 4474.16* & 4477.70* & -2242.23* & 4\\\\\n\t\\hline  BPoisson\t& \t5638.9\t&  5654.02 & 5656.10 & 5.01 & 5638.14 & 5641.18 & -2826.88 & 3\\\\\n\t\\hline  BNB\t\t& \t4475.9\t&  4495.9 & 4499.97 & 3.97* & 4474.66 & 4478.10 & -2243.87 & 4\\\\\n    \\hline \\multicolumn{9}{l}{\\textbf{German Health Registry (excessive zeros)}}\\\\\n    \\hline  ${\\text{log-log}}:BDW$& 120340.1& 120381.2\t& 120386.2\t& 4.4* & 120334.6 & 120339.2 &  -60187.6 & 5\\\\\n    \\hline  ${\\text{logit}}:BDW$&  120339.2*& 120380.3*\t& 120385.3*\t&4.4*&  120327.0* & 120331.9* &  -60181.8* & 5\\\\\n    \\hline  BPoisson &  209636.4\t& 209669.2\t& 209673.2\t& 7.7& \t209635.8 & 209639.6 & -104836.7 & 4\\\\\n    \\hline  BNB\t\t&  120658.7\t& 120708.0\t& 120714.0\t& 4.4*& 129125.8\t & 133365.3 & -60344.0  & 5\\\\\n    \\hline\n\t\\end{tabular}\n\t}\n\t\n \\end{table}\n\n\n\\subsection{Comparison with Bayesian penalised regression}\n\n In this section, we compare the performance of BDW to BPoisson and BNB regression for variable selection on a dataset with several variables. In particular, we consider the multivariate data of \\cite{machado05}. The data consist of 5096 observations from the 1985 wave of the German Socioeconomic Panel. As in \\cite{machado05}, we measure the demand in healthcare by the number of visits to a specialist (except gynecology or pedriatics) in the last quarter. The 20 covariates are listed in full in Table A.1 of \\cite{machado05} and are the same considered in this paper. This is an extreme example of excessive zeros as the response variable contains 67.82\\% of zeros.\n\n We fit a BDW model with  a Laplace prior on the regression parameters and a Gamma(2,1) hyper-prior on the shrinkage parameters. We consider 175000 iterations for the MCMC routine and similar configurations for the Bayesian Poisson and NB models. We also extend the comparison by including frequentist $L_1$ regularized models. In particular, we use the \\texttt{glmnet} package~\\citep{friedman2010regularization} to fit regularized Poisson regression and the \\texttt{glm.nb} R function to fit regularized negative Binomial regression. In both cases, the penalty parameter is chosen by BIC. According to the results in Table (\\ref{ch3:table3}), $DW(regQ,\\beta)$ with the ${\\text{log-log}}$ link achieves overall the best performance compared with the others BDW models and with NB and Poisson models.\n\n\\begin{table}[!hpt]\n\t\\caption{Comparison of BDW with Bayesian and regularized NB and Poisson on the number of visits to a specialist dataset of \\cite{machado05}. ($*$) denotes the minimum value, whereas df is the number of non-zero coefficients. For the Bayesian models, these are based on the 95\\% HPD interval.\\label{ch3:table3}}\n\t\\centering\n\t\\resizebox{\\linewidth}{!}{\n\t\\begin{tabular}{clcccccccc}\n\t\t \\hline\t& \\textbf{Model}& \\textbf{AIC} & \\textbf{BIC} &\t\\textbf{CAIC} &  \\textbf{QIC} & \\textbf{DIC}  & \\textbf{BPIC} \t & \\textbf{log(PPD)}  &\t \\textbf{df}$$\\\\\n\t\t\\hline  \t\t& {\\text{logit}}:BDW(regQ,$\\beta$)\t\t& 12720.4\t & \t12864.2 & \t2.5* & \t12886.2 & \t12710.8\t & 12731.5 & \t-6392.3 & \t11\\\\\n\t\t\n\t\t\\hline  \t\t& {\\text{log-log}}:BDW(regQ,$\\beta$)\t\t& 12698.5*\t & \t 12842.3* & \t 2.5* & \t12864.3* & \t12693.3* & \t12713.6* & \t-6383.3* & \t11\\\\\n\t\t\n\t\t\\hline  \t\t& BDW(q,reg$\\beta$)\t\t& 13256.0\t & \t13399.8 & \t2.6\t & \t13421.8\t & \t13250.4\t & \t13270.3\t & \t-6665.8\t & \t6 \\\\\n\t\t\\hline  \t\t& BPoisson& 21588.2\t & \t21705.8\t & \t 4.2 & 21723.8 &  \t21594.6\t & \t21615.8\t\t & \t-10832.6\t\t & \t17\\\\\n\t\t\\hline  \t\t& BNB& 12867.3\t & \t12939.2\t & 2.5* &12950.2  & \t12838.3\t & \t12834.8\t\t & \t-6452.3\t\t & 11\\\\\n\t\n\t\t\\hline  \t\t& Poisson (glmnet)& 21571.1\t & \t21706.1\t & \t4.2 & \t21724.1\t & \t-\t\t & \t-\t\t & -\t\t & \t17\\\\\n\t\t\\hline  \t\t& NB (glm.nb)& 12839.3\t & \t12911.2\t & \t2.5* & \t12922.6\t & \t-\t\t & \t-\t\t & -\t\t & \t12\\\\\n\t\t\\hline\n\t\t\t \t\n\t\\end{tabular} \n\t}\n\\end{table}\n\\normalsize\n\nFigure (\\ref{fig:Visiting_specialist_QregVsBreg}) shows the marginal densities of the parameters for the $DW(regQ,\\beta)$ with the ${\\text{log-log}}$ link. Highlighted in red are those variables that are found to be significant based on the 95\\% HPD interval. The selection is overall in accordance with the results obtained by \\cite{machado05} using a jittering approach, with variables such as gender, chronic complaints, sick leave and disability found to be significant, and other variables like unemployment, private insurance and those related to job characteristics, such as heavy labor, stress, variety on job, self-determined and control found not to be significant. Figure \\ref{fig:CC_density_plot} shows the effect of the variable chronic complaints on the conditional distribution, suggesting that the probability of a large number of visits is higher for the case of chronic complaints than for the case of no complaints. Table (\\ref{significant_variables_in_TNVTS}) further compares the selection of variables with those selected by Poisson and NB regression models. Overall, there is high agreement between BDW and NB, with the exception of the variable control which is found significant by NB (both in the Bayesian and frequentist estimation) but not by DW. Poisson and BPoisson tend to select many more variables.\n\n\\begin{figure}[hpt!]\n\t\\centering\n\t\n\t\\includegraphics[width=\\linewidth ]{Visiting_specialist_Qreg-loglog.pdf}\n\t\\caption{Marginal densities of the parameters for the  $BDW(regQ,\\beta)$ model with {\\text{log-log}}(q) link on the number of visits to a specialist dataset. The red lines are for the cases where the $95\\%$ HDP interval does not contain zero (significant variable). Green dotted lines for the opposite.}\n\t\\label{fig:Visiting_specialist_QregVsBreg}\n\\end{figure}\n\n\\begin{table}[!ht]\n\t\\caption{Significant covariates that are selected by $BDW(regQ,\\beta)$ with {\\text{log-log}} link, Bayesian and regularized $NB$ and $Poisson$ regression models for the number of visits to a specialist dataset. An $(*)$ indicates a non-zero coefficient.}\n\t\\centering\n\t\\resizebox{\\linewidth}{!}{\n\n\t\\begin{tabular}{lccccc}\n\t\\textbf{Variable} \t& \\textbf{BDW(regQ,$\\beta$)}& \\textbf{NB} \t&  \\textbf{BNB} & \\textbf{Poisson}  & \\textbf{BPoisson}\\\\\n\t\\hline\n\t\n\t \t Sex\t\t\t\t\t\t & \t*\t\t&\t\t*\t\t&\t*\t& * &*\\\\ \n\t Marital status\t \t\t\t\t & \t*\t\t&\t\t*\t\t&\t*\t& * &*\\\\ \n\t Age\t \t\t\t\t\t\t & \t \t\t\t&\t\t\t\t&\t\t&* & \\\\ \n\t HH-income\t\t\t\t\t\t & \t \t\t\t&\t\t\t\t&\t\t&*& *\\\\ \n\t Chronic complaints\t\t\t\t & \t*\t\t&\t\t*\t\t&\t*\t&* & * \\\\ \n\tPrivate insurance\t \t\t\t & \t  \t\t\t&\t\t\t\t&\t\t& & \\\\ \n\t Education\t \t\t\t\t \t & \t \t\t\t&\t\t\t\t&\t\t&*&\\\\ \n\t Physically heavy labour\t\t & \t \t\t\t&\t\t\t\t&\t\t&*&*\\\\ \n\t Stress\t \t\t\t\t\t\t & \t \t\t\t&\t\t\t\t&\t\t&*&* \\\\ \n\t \t Variety on job\t \t\t\t  \t & \t \t\t\t&\t\t\t\t&\t\t&*&*\\\\ \n\t\t Self-determined\t\t\t\t & \t \t\t\t&\t\t\t\t&\t\t&&\\\\ \n\t\t Control\t \t\t\t\t \t & \t \t\t\t&\t\t*\t\t&\t*\t&*&*\\\\ \n\t \t Population < 5000\t\t\t\t & \t* \t\t&\t\t*\t\t&\t*\t&*&*\\\\ \n\t Population 5000-20000\t\t\t & \t* \t\t&\t\t*\t\t&\t*\t&*&*\\\\ \n\t \t Population 20000-100000\t\t & \t* \t\t&\t\t*\t\t&\t*\t&*&*\\\\ \n\t \t Physician density\t \t\t\t & \t \t\t\t&\t\t\t\t&\t\t&& *\\\\ \n\t \t Months of unemployment\t\t\t & \t \t\t\t&\t\t\t\t&\t*\t&&*\\\\ \n\t\t Hospitalized > 7 days\t\t\t & \t* \t\t&\t\t*\t\t&\t*\t&*&*\\\\ \n\t\t Sick Leave > 14 days\t \t\t & \t* \t\t&\t\t*\t\t&\t*\t&*&*\\\\ \n\t \t Degree of disability > 20\t  \t & \t* \t\t&\t\t*\t\t&\t *\t&*&*\\\\ \n\t\\hline\n\t\\end{tabular} \n\t}\n\t\\label{significant_variables_in_TNVTS}\n\\end{table}\n\\normalsize\n\n\\begin{figure}[tph!]\n\\centering\n\\includegraphics[width=0.8\\linewidth]{CC_density_plot}\n\\caption{Effect of the variable Chronic Complaints on the conditional distribution for\nthe healthcare data, when all other variables are held constant.}\n\\label{fig:CC_density_plot}\n\\end{figure}\n\n\\section{Conclusion}\\label{Conclusion and discussion}\nIn this paper we have proposed a novel Bayesian regression model for count data, by assuming a discrete Weibull conditional distribution. We have shown the applicability of this method to count data from the medical domain. In particular, we analyse datasets on the number of visits to doctors/specialists, a quantity that is often used as an indicator of healthcare demand. The response variable in the examples considered is discrete and is characterized by a skewed distribution, making the whole conditional distribution of interest and not only the conditional mean.\n\nWe have tested the inference procedure on simulated and real data with various characteristics, such as under-dispersion, over-dispersion and excess of zeros.  Overall, we have found a good performance of the method in comparison with Poisson and NB regression models, on the basis of a number of information criteria and of the selection of influential variables. The method is implemented in the R package \\texttt{BDWreg}, which is available in CRAN. Future work will explore an extension of the approach proposed in this paper to more flexible DW regression models, such as zero-inflated, multilevel and mixture DW models, in a similar spirit to the existing models for continuous responses \\citep{dunson07}.\n\n\n\n\\bibliographystyle{elsarticle-harv} \n\\bibliography{reference}\n\n", "itemtype": "equation", "pos": 13930, "prevtext": "\nas in the traditional lasso approach \\citep{park2008bayesian,tibshirani1996regression}.\nWe further assume a Gamma(a,b) hyper prior for both $\\lambda$ and $\\tau$, leading to the posterior distribution\n\n", "index": 19, "text": "\\begin{align*}\np(\\boldsymbol{\\theta},\\boldsymbol{\\gamma}|Y,X)  \\propto l(\\boldsymbol{\\theta},\\boldsymbol{\\gamma}|Y,X) \\times p(\\boldsymbol{\\theta}|\\lambda) \\times p(\\boldsymbol{\\gamma}|\\tau) \\times p(\\lambda) \\times p(\\tau).\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex13.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle p(\\boldsymbol{\\theta},\\boldsymbol{\\gamma}|Y,X)\\propto l(%&#10;\\boldsymbol{\\theta},\\boldsymbol{\\gamma}|Y,X)\\times p(\\boldsymbol{\\theta}|%&#10;\\lambda)\\times p(\\boldsymbol{\\gamma}|\\tau)\\times p(\\lambda)\\times p(\\tau).\" display=\"inline\"><mrow><mi>p</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf3d</mi><mo>,</mo><mi>\ud835\udf38</mi><mo stretchy=\"false\">|</mo><mi>Y</mi><mo>,</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u221d</mo><mi>l</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf3d</mi><mo>,</mo><mi>\ud835\udf38</mi><mo stretchy=\"false\">|</mo><mi>Y</mi><mo>,</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u00d7</mo><mi>p</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf3d</mi><mo stretchy=\"false\">|</mo><mi>\u03bb</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u00d7</mo><mi>p</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf38</mi><mo stretchy=\"false\">|</mo><mi>\u03c4</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u00d7</mo><mi>p</mi><mrow><mo stretchy=\"false\">(</mo><mi>\u03bb</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u00d7</mo><mi>p</mi><mrow><mo stretchy=\"false\">(</mo><mi>\u03c4</mi><mo stretchy=\"false\">)</mo></mrow><mo>.</mo></mrow></math>", "type": "latex"}]