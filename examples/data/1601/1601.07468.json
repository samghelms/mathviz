[{"file": "1601.07468.tex", "nexttext": "\nAt the receiver, a combining vector  ${\\mathbf{w}}_u, u=1, ..., U$ is used to combine the signal from the $u$th user. Defining ${\\mathbf{W}}=\\left[{\\mathbf{w}}_1, ..., {\\mathbf{w}}_U\\right]$, the received signal after processing is\n\n", "itemtype": "equation", "pos": 6745, "prevtext": "\n\t\n\\title{Massive MIMO Combining with Switches}\n\\author{Ahmed Alkhateeb, Young-Han Nam, Jianzhong (Charlie) Zhang, and Robert W. Heath, Jr.\\thanks{Ahmed Alkhateeb and Robert W. Heath Jr. are with The University of Texas at Austin (Email: aalkhateeb, rheath@utexas.edu). Young-Han Nam and Jianzhong (Charlie) Zhang are with Samsung Research America-Dallas (Email: younghan.n, jianzhong.z@samsung.com).} \\thanks{This work was done while the first author was with Samsung Research America-Dallas. The Authors at the University of Texas at Austin are supported in part by the National Science Foundation under Grant No. 1319556.}}\n\n\\maketitle\n\n\n\n\\begin{abstract}\n\tMassive multiple-input multiple-output (MIMO) is expected to play a central role in future wireless systems. The deployment of large antenna arrays at the base station and the mobile users offers  multiplexing and beamforming gains that boost system spectral efficiency. Unfortunately, the high cost and power consumption of components like analog-to-digital converters makes assigning an RF chain per antenna and applying typical fully digital precoding/combining solutions difficult. In this paper, a novel architecture for massive MIMO receivers, consisting of arrays of switches and constant (non-tunable) phase shifters, is proposed. This architecture applies a quasi-coherent combining in the RF domain to reduce the number of required RF chains. An algorithm that designs the RF combining for this architecture is developed and analyzed. Results show that the proposed massive MIMO combining model can achieve a comparable performance to the fully-digital receiver architecture in single-user and multi-user massive MIMO setups.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n\tMassive MIMO, switches-based hybrid combining, quasi-coherent combining. \n\\end{IEEEkeywords}\n\n\n\\section{Introduction} \\label{sec:Intro}\nMassive MIMO offers large multiplexing and array gain, making it an attractive technology for next generation cellular systems \\cite{Boccardi2014}. The hardware and power requirements of the typical MIMO systems that allocate a complete RF chain per antenna become a limiting factor for the practical implementation of these systems. This paper proposes a new architecture for massive MIMO receivers that requires a small number of RF chains and low-power RF hardware components, while performing close to fully-digital solutions.\n\n\nTo reduce power consumption, hybrid analog/digital precoding architectures, which use a small number of RF chains and divide the precoding/combining processing between RF and baseband domains, have been proposed for large-scale MIMO systems \\cite{ElAyach2014,Alkhateeb2014b,Zeng2014,Brady2013,Mendez-Rial2015}. The RF precoding circuit can be implemented using networks of variable phase shifters \\cite{ElAyach2014,Alkhateeb2014b}, or lens antennas \\cite{Zeng2014,Brady2013}. To further reduce power consumption, a hybrid architecture that uses switches instead of phase shifters has been proposed in \\cite{Mendez-Rial2015}. The architecture in \\cite{Mendez-Rial2015}, though, assumes that each RF chain connects only to one antenna and relies on antenna subset selection to design the RF precoders. This reduces the array gain since fewer antennas are active compared to other hybrid precoding solutions \\cite{ElAyach2014,Alkhateeb2014b}.\n\n\n\nIn this paper, we propose a new architecture for massive MIMO receivers based on RF antenna switches and constant (non-tunable and pre-designed for the frequency band of interest) phase shifters, which are attractive components due to their low power consumption \\cite{Mendez-Rial2015,Ahn2009}. Further, as the proposed architecture applies a quasi-coherent combining in the RF domain, it requires much smaller number of RF chains compared with the number of antennas. For this architecture, we develop a low-complexity algorithm that designs the combining matrix in polynomial time in terms of the number of antennas. The performance of the proposed architecture and developed algorithm is analyzed for both single-user and multi-user massive MIMO systems. Although the analytical results in this letter are derived for the proposed architecture, they can also be applied to evaluate the performance of conventional hybrid precoding architectures with quantized phase shifters. Numerical simulations verify the analytical results and show that the proposed architecture achieves a comparable performance to fully-digital solutions and phase-shifters based hybrid architectures.\n\n\n\\textbf{Notation:} we use the following notation: ${\\mathbf{A}}$ is a matrix, ${\\mathbf{a}}$ is a vector, $a$ is a scalar, and ${\\mathcal{A}}$ is a set. ${\\mathbf{A}}^\\mathrm{T}$, ${\\mathbf{A}}^*$ are its transpose and conjugate transpose, respectively. ${\\mathbf{a}}_n$ is $n$th element of ${\\mathbf{a}}$. $[{\\mathbf{A}}]_{n,m}$ is the element at the $n$th row and $m$th column of ${\\mathbf{A}}$.\n\n\\section{System Model}\\label{sec:Model}\nConsider the massive MIMO system model depicted in {Fig.}~\\ref{{fig:Model}}, where a massive MIMO basestation (BS) receiver with $N$ antennas is serving $U$ users in an uplink massive MIMO transmission.  The receiver is assumed to employ a number of RF chains $N_\\mathrm{RF} \\geq U$. Further, for simplicity of exposition, we assume that the BS uses only $U$ (out of the $N_\\mathrm{RF}$) RF chains to simultaneously serve the $U$ users. Each RF chain is connected to all the antennas via a network of switches and constant phase shifters.\n\n\nIn this paper, we focus on uplink transmission. Let ${\\mathbf{H}}$ denote the $N \\times U$ channel matrix that gathers the channel vectors of the $U$ users as ${\\mathbf{H}}=\\left[{\\mathbf{h}}_1, ..., {\\mathbf{h}}_U \\right]$, and let ${\\mathbf{s}}$ represent the  transmitted symbols from the $U$ users, such that ${\\mathbb{E}}\\left[s_u s_u^*\\right] = {1}$. As this paper focuses on the achievable performance of the proposed transceiver architecture in {Fig.}~\\ref{{fig:Model}} compared with fully-digital solutions, we assume for simplicity of exposition that perfect power control has already been performed, canceling the large-scale fading effects, such that $P$  represents the average received signal power from all users.  Further, we adopt a narrowband massive MIMO channel model in this paper where an IID channel matrix is assumed, with $\\left[{\\mathbf{H}}\\right]_{n,u} \\sim \\mathcal{CN}\\left(0,1\\right)$. This assumption is made to simplify the analysis. The proposed architecture and algorithm in this paper, though, can be applied to more  general channel statistics. If ${\\mathbf{n}} \\sim \\mathcal{CN}\\left(\\boldsymbol{0}, \\sigma^2 {\\mathbf{I}}\\right)$ represents the noise vector, then the discrete-time received signal is\n\n", "index": 1, "text": "\\begin{equation}\n{\\mathbf{r}}=\\sqrt{P} {\\mathbf{H}} {\\mathbf{s}}+ {\\mathbf{n}}.\n\\label{eq:rec_signal}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"{\\mathbf{r}}=\\sqrt{P}{\\mathbf{H}}{\\mathbf{s}}+{\\mathbf{n}}.\" display=\"block\"><mrow><mrow><mi>\ud835\udc2b</mi><mo>=</mo><mrow><mrow><msqrt><mi>P</mi></msqrt><mo>\u2062</mo><mi>\ud835\udc07\ud835\udc2c</mi></mrow><mo>+</mo><mi>\ud835\udc27</mi></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.07468.tex", "nexttext": "\nAs the combining matrix ${\\mathbf{W}}$ is implemented with switches and constant phase shifters, the elements of this matrix are subject to a constant modulus constraint. Further, as only $N_\\mathrm{Q}$ constant phase shifts are possible, the combining vector of each user $u$ can be written as ${\\mathbf{w}}_u={\\mathbf{S}}_u {\\mathbf{p}}$, where ${\\mathbf{p}}=[1, e^{-j\\frac{2 \\pi}{N_\\mathrm{Q}}}, ..., e^{-j\\frac{(N_\\mathrm{Q}-1)2 \\pi}{N_\\mathrm{Q}}}{\\vphantom{AA}]}^\\mathrm{T}$, and ${\\mathbf{S}}_u \\in {\\mathcal{B}}^{N \\times N_\\mathrm{Q}}$ is a binary switching matrix. To ensure that each antenna is switched to only one phase shifter per RF chain, the switching matrix ${\\mathbf{S}}_u$ is subject to the constraint $\\sum_{q=1}^{N_\\mathrm{Q}} \\left[{\\mathbf{S}}_u\\right]_{n,q}=1$. Note that the model in \\eqref{eq:signal_transmitted} and the performance analysis in {Section}~\\ref{{sec:Performance}} do not assume any baseband combining processing. Additional combining, though, can be done in the baseband to further improve the performance as will be shown in {Section}~\\ref{{sec:Results}}.\n\n\\begin{figure} [t]\n\\centerline{\\includegraphics[width=\\linewidth]{Heath_WCL2016-001_fig1.pdf}\n}\n\\caption{A block diagram of the proposed switches-based massive MIMO receiver with $N$ antennas, $N_\\mathrm{RF}$ RF chains, and $N_\\mathrm{Q}$ constant (non-tunable) phase shifters per RF chain.}\n\\label{fig:Model}\n\\end{figure}\n\n\\begin{algorithm} [!t]                     \n\t\\caption{Quasi-Coherent Switch Combining}          \n\t\\label{alg:SCAP}                           \n\t\\begin{algorithmic} \n\t\t\\State \\textbf{Initialization:} $\\phi_q=\\frac{(2 q-1) \\pi }{N_\\mathrm{Q}}, q=1, ..., N_\\mathrm{Q}$\n\t\t\\For {$u, u=1, ..., U$}\n\t\t\\State ${\\mathcal{S}}_q^u=\\phi$, ${\\mathbf{S}}_u=\\boldsymbol{0}$\n\t\t\\For {$n, n=1,...,N$ }\n\t\t\\State $q^\\star = \\displaystyle{\\arg \\hspace{-12pt} \\min_{q=1, ..., N_\\mathrm{Q}}} \\left(\\angle{h_{u,n}}\\right)_{\\left[0,2 \\pi\\right]} - \\phi_q$\n\t\t\\State $ {\\mathcal{S}}_{q^\\star}^u = {\\mathcal{S}}_{q^\\star}^u \\cup \\left\\{n\\right\\}$, $\\left[{\\mathbf{S}}_u\\right]_{n,q^\\star}=1$\n\t\t\\EndFor\n\t\t\\EndFor\t\n\t\\end{algorithmic}\n\\end{algorithm}\n\n\\section{Quasi-Coherent Combining Algorithm} \\label{sec:Proposal}\n\nConsidering the system model in Section \\ref{sec:Model}, the signal-to-interference-plus-noise ratio ($\\mathsf{SINR}_u$) of user $u$ is\n\n", "itemtype": "equation", "pos": 7094, "prevtext": "\nAt the receiver, a combining vector  ${\\mathbf{w}}_u, u=1, ..., U$ is used to combine the signal from the $u$th user. Defining ${\\mathbf{W}}=\\left[{\\mathbf{w}}_1, ..., {\\mathbf{w}}_U\\right]$, the received signal after processing is\n\n", "index": 3, "text": "\\begin{equation}\n{\\mathbf{y}}=\\sqrt{P} {\\mathbf{W}}^* {\\mathbf{H}} {\\mathbf{s}}+ {\\mathbf{W}}^* {\\mathbf{n}}.\n\\label{eq:signal_transmitted}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"{\\mathbf{y}}=\\sqrt{P}{\\mathbf{W}}^{*}{\\mathbf{H}}{\\mathbf{s}}+{\\mathbf{W}}^{*}%&#10;{\\mathbf{n}}.\" display=\"block\"><mrow><mrow><mi>\ud835\udc32</mi><mo>=</mo><mrow><mrow><msqrt><mi>P</mi></msqrt><mo>\u2062</mo><msup><mi>\ud835\udc16</mi><mo>*</mo></msup><mo>\u2062</mo><mi>\ud835\udc07\ud835\udc2c</mi></mrow><mo>+</mo><mrow><msup><mi>\ud835\udc16</mi><mo>*</mo></msup><mo>\u2062</mo><mi>\ud835\udc27</mi></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.07468.tex", "nexttext": "\n\nThe objective of our design for the combining matrix ${\\mathbf{W}}$ is to maximize the system sum rate. Taking into consideration the hardware constraints on the combining matrix implementation, this design problem can be formulated as\n\n", "itemtype": "equation", "pos": 9596, "prevtext": "\nAs the combining matrix ${\\mathbf{W}}$ is implemented with switches and constant phase shifters, the elements of this matrix are subject to a constant modulus constraint. Further, as only $N_\\mathrm{Q}$ constant phase shifts are possible, the combining vector of each user $u$ can be written as ${\\mathbf{w}}_u={\\mathbf{S}}_u {\\mathbf{p}}$, where ${\\mathbf{p}}=[1, e^{-j\\frac{2 \\pi}{N_\\mathrm{Q}}}, ..., e^{-j\\frac{(N_\\mathrm{Q}-1)2 \\pi}{N_\\mathrm{Q}}}{\\vphantom{AA}]}^\\mathrm{T}$, and ${\\mathbf{S}}_u \\in {\\mathcal{B}}^{N \\times N_\\mathrm{Q}}$ is a binary switching matrix. To ensure that each antenna is switched to only one phase shifter per RF chain, the switching matrix ${\\mathbf{S}}_u$ is subject to the constraint $\\sum_{q=1}^{N_\\mathrm{Q}} \\left[{\\mathbf{S}}_u\\right]_{n,q}=1$. Note that the model in \\eqref{eq:signal_transmitted} and the performance analysis in {Section}~\\ref{{sec:Performance}} do not assume any baseband combining processing. Additional combining, though, can be done in the baseband to further improve the performance as will be shown in {Section}~\\ref{{sec:Results}}.\n\n\\begin{figure} [t]\n\\centerline{\\includegraphics[width=\\linewidth]{Heath_WCL2016-001_fig1.pdf}\n}\n\\caption{A block diagram of the proposed switches-based massive MIMO receiver with $N$ antennas, $N_\\mathrm{RF}$ RF chains, and $N_\\mathrm{Q}$ constant (non-tunable) phase shifters per RF chain.}\n\\label{fig:Model}\n\\end{figure}\n\n\\begin{algorithm} [!t]                     \n\t\\caption{Quasi-Coherent Switch Combining}          \n\t\\label{alg:SCAP}                           \n\t\\begin{algorithmic} \n\t\t\\State \\textbf{Initialization:} $\\phi_q=\\frac{(2 q-1) \\pi }{N_\\mathrm{Q}}, q=1, ..., N_\\mathrm{Q}$\n\t\t\\For {$u, u=1, ..., U$}\n\t\t\\State ${\\mathcal{S}}_q^u=\\phi$, ${\\mathbf{S}}_u=\\boldsymbol{0}$\n\t\t\\For {$n, n=1,...,N$ }\n\t\t\\State $q^\\star = \\displaystyle{\\arg \\hspace{-12pt} \\min_{q=1, ..., N_\\mathrm{Q}}} \\left(\\angle{h_{u,n}}\\right)_{\\left[0,2 \\pi\\right]} - \\phi_q$\n\t\t\\State $ {\\mathcal{S}}_{q^\\star}^u = {\\mathcal{S}}_{q^\\star}^u \\cup \\left\\{n\\right\\}$, $\\left[{\\mathbf{S}}_u\\right]_{n,q^\\star}=1$\n\t\t\\EndFor\n\t\t\\EndFor\t\n\t\\end{algorithmic}\n\\end{algorithm}\n\n\\section{Quasi-Coherent Combining Algorithm} \\label{sec:Proposal}\n\nConsidering the system model in Section \\ref{sec:Model}, the signal-to-interference-plus-noise ratio ($\\mathsf{SINR}_u$) of user $u$ is\n\n", "index": 5, "text": "\\begin{equation}\n\\mathsf{SINR}_u=\\frac{P \\left|{\\mathbf{w}}_u^* {\\mathbf{h}}_u\\right|^2}{P \\sum_{\\ell \\neq u}^{U} \\left|{\\mathbf{w}}_u^* {\\mathbf{h}}_\\ell\\right|^2+\\sigma^2 \\left\\|{\\mathbf{w}}_u\\right\\|^2}. \\label{eq:SINR}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"\\mathsf{SINR}_{u}=\\frac{P\\left|{\\mathbf{w}}_{u}^{*}{\\mathbf{h}}_{u}\\right|^{2}%&#10;}{P\\sum_{\\ell\\neq u}^{U}\\left|{\\mathbf{w}}_{u}^{*}{\\mathbf{h}}_{\\ell}\\right|^{%&#10;2}+\\sigma^{2}\\left\\|{\\mathbf{w}}_{u}\\right\\|^{2}}.\" display=\"block\"><mrow><mrow><msub><mi>\ud835\uddb2\ud835\udda8\ud835\uddad\ud835\uddb1</mi><mi>u</mi></msub><mo>=</mo><mfrac><mrow><mi>P</mi><mo>\u2062</mo><msup><mrow><mo>|</mo><mrow><msubsup><mi>\ud835\udc30</mi><mi>u</mi><mo>*</mo></msubsup><mo>\u2062</mo><msub><mi>\ud835\udc21</mi><mi>u</mi></msub></mrow><mo>|</mo></mrow><mn>2</mn></msup></mrow><mrow><mrow><mi>P</mi><mo>\u2062</mo><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><mi mathvariant=\"normal\">\u2113</mi><mo>\u2260</mo><mi>u</mi></mrow><mi>U</mi></msubsup><msup><mrow><mo>|</mo><mrow><msubsup><mi>\ud835\udc30</mi><mi>u</mi><mo>*</mo></msubsup><mo>\u2062</mo><msub><mi>\ud835\udc21</mi><mi mathvariant=\"normal\">\u2113</mi></msub></mrow><mo>|</mo></mrow><mn>2</mn></msup></mrow></mrow><mo>+</mo><mrow><msup><mi>\u03c3</mi><mn>2</mn></msup><mo>\u2062</mo><msup><mrow><mo>\u2225</mo><msub><mi>\ud835\udc30</mi><mi>u</mi></msub><mo>\u2225</mo></mrow><mn>2</mn></msup></mrow></mrow></mfrac></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.07468.tex", "nexttext": "\n\nwhere the first constraint is due to the use of switches and the second constraint is due to the restriction imposed on each antenna to be connected to exactly one switch. The problem in \\eqref{eq:Opt} represents a non-coherent combining problem with combining vectors ${\\mathbf{w}}_u={\\mathbf{S}}_u {\\mathbf{p}}, u=1, ..., U$ taken form a quantized space. Finding the optimal solution requires an exhaustive search over all $\\left(N_\\mathrm{Q}\\right)^{N_\\mathrm{RF} N} $ possible solutions. For large antenna systems, the complexity will likely be too high to directly implement the exhaustive search. Targeting a low-complexity solution, we propose Algorithm \\ref{alg:SCAP} that greedily designs the switch selection matrices $\\left\\{{\\mathbf{S}}_u\\right\\}_{u=1}^{U}$ in polynomial time in terms of the number of antennas.\n\nAlgorithm \\ref{alg:SCAP} can be summarized as follows. For each user $u$, the angle of the $n$th channel element $\\left[{\\mathbf{h}}_u\\right]_{n}$, $n=1, 2, ..., N$, is compared with the quantization angles $\\frac{(2 q-1) \\pi }{ N_\\mathrm{Q}}, q=1, ..., N_\\mathrm{Q}$. The $n$th antenna switch then selects the constant phase shifter from ${\\mathbf{p}}$ that corresponds to the closest quantization angle. Physically, this means that Algorithm 1 partitions the entries of each channel vector ${\\mathbf{h}}_u$ into $N_\\mathrm{Q}$ sets based on the phases of the complex vectors representing the entries of ${\\mathbf{h}}_u$. This partitioning is done such that the $q$th set, $q=1, 2, ..., N_\\mathrm{Q}$, contains the entries whose phases are in $[\\left(q-1\\right)\\frac{2 \\pi}{N_\\mathrm{Q}}, q\\frac{2 \\pi}{N_\\mathrm{Q}}]$. This is implemented using the switches as each set of them selects one of the $N_\\mathrm{Q}$ phase shifters. Each set of channel entries are then rotated in the complex plane to the first phase sector, $\\left[0, \\frac{2 \\pi}{N_\\mathrm{Q}}\\right]$, using the phase shifters before combining the channel sets together. Therefore, Algorithm \\ref{alg:SCAP} combines the channel elements quasi-coherently as the phase differences between all the channel entries after switching and rotation are less than $\\frac{2 \\pi}{N_\\mathrm{Q}}$.  \nDespite its low-complexity, Algorithm \\ref{alg:SCAP} can achieve good performance compared with the fully-digital high-complexity solution, as will be shown in the next section.\n\n\n\n\\section{Performance Analysis} \\label{sec:Performance}\nIn this section, we analyze the performance of the proposed algorithm and receiver architecture in massive MIMO systems.\n\n\\subsection{Single User Systems}\n\\begingroup\n\\allowdisplaybreaks\n\\begin{theorem} For single-user systems, if $\\mathsf{SNR}_u^\\mathrm{MRC}$ denotes the achievable SNR with maximum ratio combining (MRC) and fully-digital receiver, and $\\mathsf{SNR}_u^\\mathrm{SC}$ denotes the achievable SNR with Algorithm \\ref{alg:SCAP} and the receiver in {Fig.}~\\ref{{fig:Model}}, then\n\t\n", "itemtype": "equation", "pos": 10071, "prevtext": "\n\nThe objective of our design for the combining matrix ${\\mathbf{W}}$ is to maximize the system sum rate. Taking into consideration the hardware constraints on the combining matrix implementation, this design problem can be formulated as\n\n", "index": 7, "text": "\\begin{align}\n\\left\\{{\\mathbf{S}}_u^\\star\\right\\}_{u=1}^U  = & \\arg\\max \\ \\ \\sum_{u=1}^{U}  \\log_2\\left(1+\\mathsf{SINR}_u\\right) \\nonumber\\\\\n& \\mathrm{s.t.} \\hspace{23 pt}  \\left[{\\mathbf{S}}_u\\right]_{n,q} \\in \\left\\{0,1\\right\\}, \\ \\ \\forall u,n,q, \\label{eq:Opt}\\\\\n& \\hspace{35pt}  \\sum_{q=1}^{N_\\mathrm{Q}} \\left[{\\mathbf{S}}_u\\right]_{n,q}  = 1, \\nonumber\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\left\\{{\\mathbf{S}}_{u}^{\\star}\\right\\}_{u=1}^{U}=\" display=\"inline\"><mrow><msubsup><mrow><mo>{</mo><msubsup><mi>\ud835\udc12</mi><mi>u</mi><mo>\u22c6</mo></msubsup><mo>}</mo></mrow><mrow><mi>u</mi><mo>=</mo><mn>1</mn></mrow><mi>U</mi></msubsup><mo>=</mo><mi/></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\arg\\max\\ \\ \\sum_{u=1}^{U}\\log_{2}\\left(1+\\mathsf{SINR}_{u}\\right)\" display=\"inline\"><mrow><mrow><mi>arg</mi><mo>\u2061</mo><mi>max</mi></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003</mo><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>u</mi><mo>=</mo><mn>1</mn></mrow><mi>U</mi></munderover></mstyle><mrow><msub><mi>log</mi><mn>2</mn></msub><mo>\u2061</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><msub><mi>\ud835\uddb2\ud835\udda8\ud835\uddad\ud835\uddb1</mi><mi>u</mi></msub></mrow><mo>)</mo></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\mathrm{s.t.}\\hskip 23.0pt\\left[{\\mathbf{S}}_{u}\\right]_{n,q}\\in%&#10;\\left\\{0,1\\right\\},\\ \\ \\forall u,n,q,\" display=\"inline\"><mrow><mi mathvariant=\"normal\">s</mi><mo>.</mo><mi mathvariant=\"normal\">t</mi><mo>.</mo><mo mathvariant=\"italic\" separator=\"true\">\u2003\u2003\u2005</mo><msub><mrow><mo>[</mo><msub><mi>\ud835\udc12</mi><mi>u</mi></msub><mo>]</mo></mrow><mrow><mi>n</mi><mo>,</mo><mi>q</mi></mrow></msub><mo>\u2208</mo><mrow><mo>{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>}</mo></mrow><mo rspace=\"12.5pt\">,</mo><mo>\u2200</mo><mi>u</mi><mo>,</mo><mi>n</mi><mo>,</mo><mi>q</mi><mo>,</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\\sum_{q=1}^{N_{\\mathrm{Q}}}\\left[{\\mathbf{S}}_{u}%&#10;\\right]_{n,q}=1,\" display=\"inline\"><mrow><mrow><mrow><mi>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0</mi><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>q</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mi mathvariant=\"normal\">Q</mi></msub></munderover></mstyle><msub><mrow><mo>[</mo><msub><mi>\ud835\udc12</mi><mi>u</mi></msub><mo>]</mo></mrow><mrow><mi>n</mi><mo>,</mo><mi>q</mi></mrow></msub></mrow></mrow><mo>=</mo><mn>1</mn></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.07468.tex", "nexttext": "\n\t\\label{thm:SNR}\n\\end{theorem}\n\\begin{proof} See Appendix \\ref{app:SNR}\n\\end{proof}\n\nThis result means that around $65.6\\%$ of the MRC SNR gain, with fully-digital hardware, can be achieved with the proposed algorithm and receiver architecture using only $N_\\mathrm{Q}=4$ constant phase shifters. This result is also verified by numerical simulation as will be discussed in {Section}~\\ref{{sec:Results}}.\n\\endgroup\n\\subsection{Multi-User Systems}\nThe previous results can also be extended to multi-user systems, as captured by the following proposition.\n\\begin{proposition} The achievable SINR of Algorithm \\ref{alg:SCAP} with the massive MIMO receiver in {Section}~\\ref{{sec:Model}} converges almost surely to $\\frac{N}{U} \\frac{N_\\mathrm{Q}^2}{4 \\pi} \\sin^2\\left(\\frac{\\pi}{N_\\mathrm{Q}}\\right)$  as $N, U \\to \\infty$ and $\\frac{N}{U}$ is a constant ratio, i.e.,\n\n", "itemtype": "equation", "pos": 13352, "prevtext": "\n\nwhere the first constraint is due to the use of switches and the second constraint is due to the restriction imposed on each antenna to be connected to exactly one switch. The problem in \\eqref{eq:Opt} represents a non-coherent combining problem with combining vectors ${\\mathbf{w}}_u={\\mathbf{S}}_u {\\mathbf{p}}, u=1, ..., U$ taken form a quantized space. Finding the optimal solution requires an exhaustive search over all $\\left(N_\\mathrm{Q}\\right)^{N_\\mathrm{RF} N} $ possible solutions. For large antenna systems, the complexity will likely be too high to directly implement the exhaustive search. Targeting a low-complexity solution, we propose Algorithm \\ref{alg:SCAP} that greedily designs the switch selection matrices $\\left\\{{\\mathbf{S}}_u\\right\\}_{u=1}^{U}$ in polynomial time in terms of the number of antennas.\n\nAlgorithm \\ref{alg:SCAP} can be summarized as follows. For each user $u$, the angle of the $n$th channel element $\\left[{\\mathbf{h}}_u\\right]_{n}$, $n=1, 2, ..., N$, is compared with the quantization angles $\\frac{(2 q-1) \\pi }{ N_\\mathrm{Q}}, q=1, ..., N_\\mathrm{Q}$. The $n$th antenna switch then selects the constant phase shifter from ${\\mathbf{p}}$ that corresponds to the closest quantization angle. Physically, this means that Algorithm 1 partitions the entries of each channel vector ${\\mathbf{h}}_u$ into $N_\\mathrm{Q}$ sets based on the phases of the complex vectors representing the entries of ${\\mathbf{h}}_u$. This partitioning is done such that the $q$th set, $q=1, 2, ..., N_\\mathrm{Q}$, contains the entries whose phases are in $[\\left(q-1\\right)\\frac{2 \\pi}{N_\\mathrm{Q}}, q\\frac{2 \\pi}{N_\\mathrm{Q}}]$. This is implemented using the switches as each set of them selects one of the $N_\\mathrm{Q}$ phase shifters. Each set of channel entries are then rotated in the complex plane to the first phase sector, $\\left[0, \\frac{2 \\pi}{N_\\mathrm{Q}}\\right]$, using the phase shifters before combining the channel sets together. Therefore, Algorithm \\ref{alg:SCAP} combines the channel elements quasi-coherently as the phase differences between all the channel entries after switching and rotation are less than $\\frac{2 \\pi}{N_\\mathrm{Q}}$.  \nDespite its low-complexity, Algorithm \\ref{alg:SCAP} can achieve good performance compared with the fully-digital high-complexity solution, as will be shown in the next section.\n\n\n\n\\section{Performance Analysis} \\label{sec:Performance}\nIn this section, we analyze the performance of the proposed algorithm and receiver architecture in massive MIMO systems.\n\n\\subsection{Single User Systems}\n\\begingroup\n\\allowdisplaybreaks\n\\begin{theorem} For single-user systems, if $\\mathsf{SNR}_u^\\mathrm{MRC}$ denotes the achievable SNR with maximum ratio combining (MRC) and fully-digital receiver, and $\\mathsf{SNR}_u^\\mathrm{SC}$ denotes the achievable SNR with Algorithm \\ref{alg:SCAP} and the receiver in {Fig.}~\\ref{{fig:Model}}, then\n\t\n", "index": 9, "text": "\\begin{equation}\n\t\\lim_{N \\to \\infty} \\frac{\\mathsf{SNR}_u^\\mathrm{SC}}{\\mathsf{SNR}_u^\\mathrm{MRC}} \\xrightarrow{\\text{a.s.}} \\frac{N_\\mathrm{Q}^2}{4 \\pi} \\sin^2\\left(\\frac{\\pi}{N_\\mathrm{Q}}\\right).\n\t\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"\\lim_{N\\to\\infty}\\frac{\\mathsf{SNR}_{u}^{\\mathrm{SC}}}{\\mathsf{SNR}_{u}^{%&#10;\\mathrm{MRC}}}\\xrightarrow{\\text{a.s.}}\\frac{N_{\\mathrm{Q}}^{2}}{4\\pi}\\sin^{2}%&#10;\\left(\\frac{\\pi}{N_{\\mathrm{Q}}}\\right).\" display=\"block\"><mrow><mrow><mrow><munder><mo movablelimits=\"false\">lim</mo><mrow><mi>N</mi><mo>\u2192</mo><mi mathvariant=\"normal\">\u221e</mi></mrow></munder><mo>\u2061</mo><mfrac><msubsup><mi>\ud835\uddb2\ud835\uddad\ud835\uddb1</mi><mi>u</mi><mi>SC</mi></msubsup><msubsup><mi>\ud835\uddb2\ud835\uddad\ud835\uddb1</mi><mi>u</mi><mi>MRC</mi></msubsup></mfrac></mrow><mover accent=\"true\"><mo>\u2192</mo><mtext>a.s.</mtext></mover><mrow><mfrac><msubsup><mi>N</mi><mi mathvariant=\"normal\">Q</mi><mn>2</mn></msubsup><mrow><mn>4</mn><mo>\u2062</mo><mi>\u03c0</mi></mrow></mfrac><mo>\u2062</mo><mrow><msup><mi>sin</mi><mn>2</mn></msup><mo>\u2061</mo><mrow><mo>(</mo><mfrac><mi>\u03c0</mi><msub><mi>N</mi><mi mathvariant=\"normal\">Q</mi></msub></mfrac><mo>)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.07468.tex", "nexttext": "\n\\label{prop:SINR}\n\\end{proposition}\n\n\\begin{figure} [t]\n\t\\centerline{\n\t\t\\includegraphics[width=1.02\\linewidth]{Heath_WCL2016-001_fig2.pdf}\n\t}\n\t\\caption{Ratio between the achievable SNR of the proposed algorithm and receiver architecture and the MRC SNR converges to the derived analytical limit in Theorem \\ref{thm:SNR} as $N \\to \\infty$.}\n\t\\label{fig:BF}\n\\end{figure}\n\n\\begin{proof} \n\tThe $\\mathsf{SINR}_u$ of user $u$ can be written as in \\eqref{eq:SINR}. To prove that $\\mathsf{SINR}$ converges almost surely to $\\frac{N}{U} \\frac{N_\\mathrm{Q}^2}{4 \\pi} \\sin^2\\left(\\frac{\\pi}{N_\\mathrm{Q}}\\right)$, it is sufficient to prove the following\n\t\n", "itemtype": "equation", "pos": 14434, "prevtext": "\n\t\\label{thm:SNR}\n\\end{theorem}\n\\begin{proof} See Appendix \\ref{app:SNR}\n\\end{proof}\n\nThis result means that around $65.6\\%$ of the MRC SNR gain, with fully-digital hardware, can be achieved with the proposed algorithm and receiver architecture using only $N_\\mathrm{Q}=4$ constant phase shifters. This result is also verified by numerical simulation as will be discussed in {Section}~\\ref{{sec:Results}}.\n\\endgroup\n\\subsection{Multi-User Systems}\nThe previous results can also be extended to multi-user systems, as captured by the following proposition.\n\\begin{proposition} The achievable SINR of Algorithm \\ref{alg:SCAP} with the massive MIMO receiver in {Section}~\\ref{{sec:Model}} converges almost surely to $\\frac{N}{U} \\frac{N_\\mathrm{Q}^2}{4 \\pi} \\sin^2\\left(\\frac{\\pi}{N_\\mathrm{Q}}\\right)$  as $N, U \\to \\infty$ and $\\frac{N}{U}$ is a constant ratio, i.e.,\n\n", "index": 11, "text": "\\begin{equation}\n\t\\lim_{\\substack{N,U \\to \\infty \\\\ \\frac{U}{N}=\\text{constant}}} \\mathsf{SINR}_u^\\mathrm{SC} \\xrightarrow{\\text{a.s.}} \\frac{N}{U} \\frac{N_\\mathrm{Q}^2}{4 \\pi} \\sin^2\\left(\\frac{\\pi}{N_\\mathrm{Q}}\\right). \n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"\\lim_{\\begin{subarray}{c}N,U\\to\\infty\\\\&#10;\\frac{U}{N}=\\text{constant}\\end{subarray}}\\mathsf{SINR}_{u}^{\\mathrm{SC}}%&#10;\\xrightarrow{\\text{a.s.}}\\frac{N}{U}\\frac{N_{\\mathrm{Q}}^{2}}{4\\pi}\\sin^{2}%&#10;\\left(\\frac{\\pi}{N_{\\mathrm{Q}}}\\right).\" display=\"block\"><mrow><mrow><mrow><munder><mo movablelimits=\"false\">lim</mo><mtable class=\"ltx_align_c\" rowspacing=\"0.0pt\"><mtr><mtd><mrow><mrow><mi>N</mi><mo>,</mo><mi>U</mi></mrow><mo>\u2192</mo><mi mathvariant=\"normal\">\u221e</mi></mrow></mtd></mtr><mtr><mtd><mrow><mfrac><mi>U</mi><mi>N</mi></mfrac><mo>=</mo><mtext>constant</mtext></mrow></mtd></mtr></mtable></munder><mo>\u2061</mo><msubsup><mi>\ud835\uddb2\ud835\udda8\ud835\uddad\ud835\uddb1</mi><mi>u</mi><mi>SC</mi></msubsup></mrow><mover accent=\"true\"><mo>\u2192</mo><mtext>a.s.</mtext></mover><mrow><mfrac><mi>N</mi><mi>U</mi></mfrac><mo>\u2062</mo><mfrac><msubsup><mi>N</mi><mi mathvariant=\"normal\">Q</mi><mn>2</mn></msubsup><mrow><mn>4</mn><mo>\u2062</mo><mi>\u03c0</mi></mrow></mfrac><mo>\u2062</mo><mrow><msup><mi>sin</mi><mn>2</mn></msup><mo>\u2061</mo><mrow><mo>(</mo><mfrac><mi>\u03c0</mi><msub><mi>N</mi><mi mathvariant=\"normal\">Q</mi></msub></mfrac><mo>)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.07468.tex", "nexttext": "\n\tThe first limit in \\eqref{eq:Lim1} is proved in Theorem \\ref{thm:SNR}. To prove the limit in \\eqref{eq:Lim2}, we first note that given the combining vectors design in Algorithm \\ref{alg:SCAP}, we have $\\left\\|{\\mathbf{w}}_u^* {\\mathbf{h}}_\\ell\\right\\|^2 \\sim \\text{Exp}(N), \\forall \\ell \\neq u$ (proof is omitted for space limitation). Then, by applying the law of large numbers, we reach \\eqref{eq:Lim2}.\n\\end{proof}\n\nUsing Proposition \\ref{prop:SINR},  we can characterize the achievable rate  with the proposed transceiver architecture as shown in the following corollary.\n\n\\begin{corollary} The achievable rate  Algorithm \\ref{alg:SCAP} with the massive MIMO receiver in {Section}~\\ref{{sec:Model}} converges almost surely to $\\log_2\\left(1+\\frac{N}{U} \\frac{N_\\mathrm{Q}^2}{4 \\pi} \\sin^2\\left(\\frac{\\pi}{N_\\mathrm{Q}}\\right)\\right)$  as $N, U \\to \\infty$ and $\\frac{N}{U}$ is a constant ratio.\n\\label{cor:Rate}\n\\end{corollary}\n\nThe proof of Corollary \\ref{cor:Rate} follows directly from the $\\mathsf{SINR}$ result in Proposition \\ref{prop:SINR}  by using the dominated convergence and the continuous mapping theorems \\cite{Hoydis2013}.\n\n\n\\section{Simulation Results} \\label{sec:Results}\nTo verify these results by numerical simulations, {Fig.}~\\ref{{fig:BF}} shows the ratio of the achievable SNR with the proposed architecture and combining algorithm over the optimal MRC SNR when only user $u$ is served. {Fig.}~\\ref{{fig:BF}} illustrates that this ratio approaches the derived $\\frac{N_\\mathrm{Q}^2}{4 \\pi} \\sin^2\\left(\\frac{\\pi}{N_\\mathrm{Q}}\\right) $ approximation result in Theorem \\ref{thm:SNR} as the number of receive antennas increases.\n\n\\begin{figure} [t]\n\t\\centerline{\n\t\t\\includegraphics[width=1.01\\linewidth]{Heath_WCL2016-001_fig3.pdf}\n\t}\n\t\\caption{The per-user achievable rate of the proposed receiver architecture is compared with the fully-digital, phase-shifers based hybrid precoding, and antenna-selection architectures for different combining solutions, assuming a system with $N=64$ antennas and  $U=3$ users.}\n\t\\label{fig:Rate}\n\\end{figure}\n\nIn {Fig.}~\\ref{{fig:Rate}}, the achievable rate of the switches-based hybrid  architecture in {Fig.}~\\ref{{fig:Model}} is compared with the fully-digital, antenna selection, and phase-shifters based hybrid receivers in a multi-user setting with $N=64$ antennas, and $U=3$ users. Combining is assumed to be done with either matched-filtering or zero-forcing. For the switches-based and phase-shifters based hybrid architectures, we adopt the zero-forcing solution in \\cite{Alkhateeb2014b}, in which analog combining vectors are designed per user (similar to that in {Section}~\\ref{{sec:Proposal}}) and zero-forcing is then done in the baseband based on the effective channels. For the antenna-selection solutions, we assume the receiver selects the best $U$ antennas that maximize the achievable rate subject to the matched-filter or zero-forcing solution via an exhaustive search over all antenna subset combinations. To account for the possible SNR degradation in the different receiver architectures, we penalized the SNR of each receiver with its noise figure (NF). We assumed receivers use LNA's of $22$ dB gain, and $5$ dB NF, and mixers of $12$ dB NF. The power dividers, combiners, and switches in the hybrid architectures are assumed to be implemented through cascaded stages using two-ports building blocks. The NF of each combining/dividing stage is $1$dB and each switching stage is $1.5$ dB. Phase shifters with $4$ dB NF are assumed to be accompanied by VGAs of $4$ dB NF to compensate for their gains. These NF values are collected from various references for RF components operating at $2-5$ GHz frequency.\nWith these values, the composite NF of the fully-digital and antenna-selection receivers is $5.1$ dB, while that of phase-shifters based and switched based hybrid architectures are $5.7$ dB, and $7.2$ dB, respectively. {Fig.}~\\ref{{fig:Rate}} shows that the performance of the switches-based architecture is close to the fully-digital solution with good gain over the antenna selection architecture thanks to the higher array gain. Finally, the architecture with switches is shown to have a small loss compared to that with phase shifters. In terms of power consumption, though, the main difference between those two hybrid architectures is that the one with phase shifters requires $N \\times N_\\mathrm{RF}=192$ controllable phase shifters, while that with switches requires only $N_\\mathrm{RF} \\times N_Q=12$ constant phase shifters. The other power consumption circuits like that activating the switches are similar in the two hybrid architectures. Note also that the receiver calibration techniques for the two architectures are expected to be similar, as they both can realize the same combining matrices. It is worth mentioning here that this initial study did not consider other factors like switches isolation and speed, whose impacts on the performance need to be investigated for a refined conclusion about the different architectures. \n\n\\section{Conclusion}\nIn this paper, we proposed a receiver architecture for massive MIMO systems based on antenna switching. For this architecture, we developed and analyzed a quasi-coherent RF combining algorithm. Results showed that the proposed receiver can achieve at least a $\\frac{N^2_\\mathrm{Q}}{4 \\pi} \\sin^2\\left(\\frac{\\pi}{N_\\mathrm{Q}}\\right)$ of the optimal maximum-ratio combining gain with $N_Q$ constant phase shifters. Results also illustrated that the achievable rate with the proposed receiver architecture is comparable to the fully-digital solutions in multi-user massive MIMO systems. For future research, it would be interesting to investigate the performance of the proposed architecture incorporating the impact of practical factors like switches imperfect isolation, switching speed, and more detailed insertion losses.\n\n\n\\appendices\n\\section{}\\label{app:SNR}\n\\begin{proof}[Proof of Theorem \\ref{thm:SNR}]\n\tDefine $\\rho=\\frac{P}{\\sigma^2}$, the SNR of the MRC with fully-digital receiver is $\\mathsf{SNR}_u^{\\text{MRC}}= \\rho \\sum_{n=1}^{N} |h_{u,n}|^2$.\n\t \n\t As the \\textit{favorable} massive MIMO propagation conditions hold for our channel model \\cite{Ashikhmin2012}, $\\lim_{N \\to \\infty}\\frac{1}{N} \\mathsf{SNR}_u^{\\text{MRC}} \\xrightarrow{\\text{a.s.}} \\rho$.\n\t\n\tNow, considering Algorithm \\ref{alg:SCAP} for the receiver in {Fig.}~\\ref{{fig:Model}}, the achieved SNR with $N_\\mathrm{Q}$ phase shifters is $\\mathsf{SNR}_u^\\mathrm{SC}=\\frac{\\rho \\left|{\\mathbf{w}}_u^* {\\mathbf{h}}_u\\right|^2}{\\left\\|{\\mathbf{w}}_u\\right\\|^2}$.\n\t\n\tThe desired signal power term can be expanded as\n\t\n", "itemtype": "equation", "pos": 15316, "prevtext": "\n\\label{prop:SINR}\n\\end{proposition}\n\n\\begin{figure} [t]\n\t\\centerline{\n\t\t\\includegraphics[width=1.02\\linewidth]{Heath_WCL2016-001_fig2.pdf}\n\t}\n\t\\caption{Ratio between the achievable SNR of the proposed algorithm and receiver architecture and the MRC SNR converges to the derived analytical limit in Theorem \\ref{thm:SNR} as $N \\to \\infty$.}\n\t\\label{fig:BF}\n\\end{figure}\n\n\\begin{proof} \n\tThe $\\mathsf{SINR}_u$ of user $u$ can be written as in \\eqref{eq:SINR}. To prove that $\\mathsf{SINR}$ converges almost surely to $\\frac{N}{U} \\frac{N_\\mathrm{Q}^2}{4 \\pi} \\sin^2\\left(\\frac{\\pi}{N_\\mathrm{Q}}\\right)$, it is sufficient to prove the following\n\t\n", "index": 13, "text": "\\begin{align}\n\t\\lim_{N \\to \\infty}\\frac{1}{N^2}\\left|{\\mathbf{w}}_u^* {\\mathbf{h}}_u\\right|^2 & \\xrightarrow{\\text{a.s.}} \\frac{N_\\mathrm{Q}^2}{4 \\pi} \\sin^2\\left(\\frac{\\pi}{N_\\mathrm{Q}}\\right) \\label{eq:Lim1}\\\\\n\t\\lim_{\\substack{N,U \\to \\infty \\\\ \\frac{U}{N}=\\text{constant}}} \\frac{1}{N^2}\\sum_{\\ell \\neq u}^{U} \\left|{\\mathbf{w}}_u^* {\\mathbf{h}}_\\ell\\right|^2 &  \\xrightarrow{\\text{a.s.}} \\frac{U}{N}   \\label{eq:Lim2}\n\t\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\lim_{N\\to\\infty}\\frac{1}{N^{2}}\\left|{\\mathbf{w}}_{u}^{*}{%&#10;\\mathbf{h}}_{u}\\right|^{2}\" display=\"inline\"><mrow><munder><mo movablelimits=\"false\">lim</mo><mrow><mi>N</mi><mo>\u2192</mo><mi mathvariant=\"normal\">\u221e</mi></mrow></munder><mo>\u2061</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><msup><mi>N</mi><mn>2</mn></msup></mfrac></mstyle><mo>\u2062</mo><msup><mrow><mo>|</mo><mrow><msubsup><mi>\ud835\udc30</mi><mi>u</mi><mo>*</mo></msubsup><mo>\u2062</mo><msub><mi>\ud835\udc21</mi><mi>u</mi></msub></mrow><mo>|</mo></mrow><mn>2</mn></msup></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\xrightarrow{\\text{a.s.}}\\frac{N_{\\mathrm{Q}}^{2}}{4\\pi}\\sin^{2}%&#10;\\left(\\frac{\\pi}{N_{\\mathrm{Q}}}\\right)\" display=\"inline\"><mrow><mi/><mover accent=\"true\"><mo>\u2192</mo><mtext>a.s.</mtext></mover><mrow><mstyle displaystyle=\"true\"><mfrac><msubsup><mi>N</mi><mi mathvariant=\"normal\">Q</mi><mn>2</mn></msubsup><mrow><mn>4</mn><mo>\u2062</mo><mi>\u03c0</mi></mrow></mfrac></mstyle><mo>\u2062</mo><mrow><msup><mi>sin</mi><mn>2</mn></msup><mo>\u2061</mo><mrow><mo>(</mo><mstyle displaystyle=\"true\"><mfrac><mi>\u03c0</mi><msub><mi>N</mi><mi mathvariant=\"normal\">Q</mi></msub></mfrac></mstyle><mo>)</mo></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\lim_{\\begin{subarray}{c}N,U\\to\\infty\\\\&#10;\\frac{U}{N}=\\text{constant}\\end{subarray}}\\frac{1}{N^{2}}\\sum_{\\ell\\neq u}^{U}%&#10;\\left|{\\mathbf{w}}_{u}^{*}{\\mathbf{h}}_{\\ell}\\right|^{2}\" display=\"inline\"><mrow><munder><mo movablelimits=\"false\">lim</mo><mtable class=\"ltx_align_c\" rowspacing=\"0.0pt\"><mtr><mtd><mrow><mrow><mi>N</mi><mo>,</mo><mi>U</mi></mrow><mo>\u2192</mo><mi mathvariant=\"normal\">\u221e</mi></mrow></mtd></mtr><mtr><mtd><mrow><mfrac><mi>U</mi><mi>N</mi></mfrac><mo>=</mo><mtext>constant</mtext></mrow></mtd></mtr></mtable></munder><mo>\u2061</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><msup><mi>N</mi><mn>2</mn></msup></mfrac></mstyle><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi mathvariant=\"normal\">\u2113</mi><mo>\u2260</mo><mi>u</mi></mrow><mi>U</mi></munderover></mstyle><msup><mrow><mo>|</mo><mrow><msubsup><mi>\ud835\udc30</mi><mi>u</mi><mo>*</mo></msubsup><mo>\u2062</mo><msub><mi>\ud835\udc21</mi><mi mathvariant=\"normal\">\u2113</mi></msub></mrow><mo>|</mo></mrow><mn>2</mn></msup></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\xrightarrow{\\text{a.s.}}\\frac{U}{N}\" display=\"inline\"><mrow><mi/><mover accent=\"true\"><mo>\u2192</mo><mtext>a.s.</mtext></mover><mstyle displaystyle=\"true\"><mfrac><mi>U</mi><mi>N</mi></mfrac></mstyle></mrow></math>", "type": "latex"}, {"file": "1601.07468.tex", "nexttext": "\n\t\n\twhere $\\bar{\\theta}^{q}_{u,n}=\\theta_{u,n}-\\frac{2 \\pi (q-1)}{N_\\mathrm{Q}}$. Now, we use the law of large numbers to get $\\lim_{N \\to \\infty} \\frac{1}{N^2} \\left\\|{\\mathbf{w}}_u^* {\\mathbf{h}}_u\\right\\|^2  \\xrightarrow{\\text{a.s.}}$\n\t\n", "itemtype": "equation", "pos": 22403, "prevtext": "\n\tThe first limit in \\eqref{eq:Lim1} is proved in Theorem \\ref{thm:SNR}. To prove the limit in \\eqref{eq:Lim2}, we first note that given the combining vectors design in Algorithm \\ref{alg:SCAP}, we have $\\left\\|{\\mathbf{w}}_u^* {\\mathbf{h}}_\\ell\\right\\|^2 \\sim \\text{Exp}(N), \\forall \\ell \\neq u$ (proof is omitted for space limitation). Then, by applying the law of large numbers, we reach \\eqref{eq:Lim2}.\n\\end{proof}\n\nUsing Proposition \\ref{prop:SINR},  we can characterize the achievable rate  with the proposed transceiver architecture as shown in the following corollary.\n\n\\begin{corollary} The achievable rate  Algorithm \\ref{alg:SCAP} with the massive MIMO receiver in {Section}~\\ref{{sec:Model}} converges almost surely to $\\log_2\\left(1+\\frac{N}{U} \\frac{N_\\mathrm{Q}^2}{4 \\pi} \\sin^2\\left(\\frac{\\pi}{N_\\mathrm{Q}}\\right)\\right)$  as $N, U \\to \\infty$ and $\\frac{N}{U}$ is a constant ratio.\n\\label{cor:Rate}\n\\end{corollary}\n\nThe proof of Corollary \\ref{cor:Rate} follows directly from the $\\mathsf{SINR}$ result in Proposition \\ref{prop:SINR}  by using the dominated convergence and the continuous mapping theorems \\cite{Hoydis2013}.\n\n\n\\section{Simulation Results} \\label{sec:Results}\nTo verify these results by numerical simulations, {Fig.}~\\ref{{fig:BF}} shows the ratio of the achievable SNR with the proposed architecture and combining algorithm over the optimal MRC SNR when only user $u$ is served. {Fig.}~\\ref{{fig:BF}} illustrates that this ratio approaches the derived $\\frac{N_\\mathrm{Q}^2}{4 \\pi} \\sin^2\\left(\\frac{\\pi}{N_\\mathrm{Q}}\\right) $ approximation result in Theorem \\ref{thm:SNR} as the number of receive antennas increases.\n\n\\begin{figure} [t]\n\t\\centerline{\n\t\t\\includegraphics[width=1.01\\linewidth]{Heath_WCL2016-001_fig3.pdf}\n\t}\n\t\\caption{The per-user achievable rate of the proposed receiver architecture is compared with the fully-digital, phase-shifers based hybrid precoding, and antenna-selection architectures for different combining solutions, assuming a system with $N=64$ antennas and  $U=3$ users.}\n\t\\label{fig:Rate}\n\\end{figure}\n\nIn {Fig.}~\\ref{{fig:Rate}}, the achievable rate of the switches-based hybrid  architecture in {Fig.}~\\ref{{fig:Model}} is compared with the fully-digital, antenna selection, and phase-shifters based hybrid receivers in a multi-user setting with $N=64$ antennas, and $U=3$ users. Combining is assumed to be done with either matched-filtering or zero-forcing. For the switches-based and phase-shifters based hybrid architectures, we adopt the zero-forcing solution in \\cite{Alkhateeb2014b}, in which analog combining vectors are designed per user (similar to that in {Section}~\\ref{{sec:Proposal}}) and zero-forcing is then done in the baseband based on the effective channels. For the antenna-selection solutions, we assume the receiver selects the best $U$ antennas that maximize the achievable rate subject to the matched-filter or zero-forcing solution via an exhaustive search over all antenna subset combinations. To account for the possible SNR degradation in the different receiver architectures, we penalized the SNR of each receiver with its noise figure (NF). We assumed receivers use LNA's of $22$ dB gain, and $5$ dB NF, and mixers of $12$ dB NF. The power dividers, combiners, and switches in the hybrid architectures are assumed to be implemented through cascaded stages using two-ports building blocks. The NF of each combining/dividing stage is $1$dB and each switching stage is $1.5$ dB. Phase shifters with $4$ dB NF are assumed to be accompanied by VGAs of $4$ dB NF to compensate for their gains. These NF values are collected from various references for RF components operating at $2-5$ GHz frequency.\nWith these values, the composite NF of the fully-digital and antenna-selection receivers is $5.1$ dB, while that of phase-shifters based and switched based hybrid architectures are $5.7$ dB, and $7.2$ dB, respectively. {Fig.}~\\ref{{fig:Rate}} shows that the performance of the switches-based architecture is close to the fully-digital solution with good gain over the antenna selection architecture thanks to the higher array gain. Finally, the architecture with switches is shown to have a small loss compared to that with phase shifters. In terms of power consumption, though, the main difference between those two hybrid architectures is that the one with phase shifters requires $N \\times N_\\mathrm{RF}=192$ controllable phase shifters, while that with switches requires only $N_\\mathrm{RF} \\times N_Q=12$ constant phase shifters. The other power consumption circuits like that activating the switches are similar in the two hybrid architectures. Note also that the receiver calibration techniques for the two architectures are expected to be similar, as they both can realize the same combining matrices. It is worth mentioning here that this initial study did not consider other factors like switches isolation and speed, whose impacts on the performance need to be investigated for a refined conclusion about the different architectures. \n\n\\section{Conclusion}\nIn this paper, we proposed a receiver architecture for massive MIMO systems based on antenna switching. For this architecture, we developed and analyzed a quasi-coherent RF combining algorithm. Results showed that the proposed receiver can achieve at least a $\\frac{N^2_\\mathrm{Q}}{4 \\pi} \\sin^2\\left(\\frac{\\pi}{N_\\mathrm{Q}}\\right)$ of the optimal maximum-ratio combining gain with $N_Q$ constant phase shifters. Results also illustrated that the achievable rate with the proposed receiver architecture is comparable to the fully-digital solutions in multi-user massive MIMO systems. For future research, it would be interesting to investigate the performance of the proposed architecture incorporating the impact of practical factors like switches imperfect isolation, switching speed, and more detailed insertion losses.\n\n\n\\appendices\n\\section{}\\label{app:SNR}\n\\begin{proof}[Proof of Theorem \\ref{thm:SNR}]\n\tDefine $\\rho=\\frac{P}{\\sigma^2}$, the SNR of the MRC with fully-digital receiver is $\\mathsf{SNR}_u^{\\text{MRC}}= \\rho \\sum_{n=1}^{N} |h_{u,n}|^2$.\n\t \n\t As the \\textit{favorable} massive MIMO propagation conditions hold for our channel model \\cite{Ashikhmin2012}, $\\lim_{N \\to \\infty}\\frac{1}{N} \\mathsf{SNR}_u^{\\text{MRC}} \\xrightarrow{\\text{a.s.}} \\rho$.\n\t\n\tNow, considering Algorithm \\ref{alg:SCAP} for the receiver in {Fig.}~\\ref{{fig:Model}}, the achieved SNR with $N_\\mathrm{Q}$ phase shifters is $\\mathsf{SNR}_u^\\mathrm{SC}=\\frac{\\rho \\left|{\\mathbf{w}}_u^* {\\mathbf{h}}_u\\right|^2}{\\left\\|{\\mathbf{w}}_u\\right\\|^2}$.\n\t\n\tThe desired signal power term can be expanded as\n\t\n", "index": 15, "text": "\\begin{align}\n\t\\left|{\\mathbf{w}}_u^* {\\mathbf{h}}_u\\right|^2&=\\left|\\sum_{n} w_{u,n} h_{u,n}\\right|^2\n\t=\\left|\\sum_{q=1}^{N_\\mathrm{Q}}{\\sum_{n \\in {\\mathcal{S}}_q} {h_{u,n} e^{- j \\frac{(q-1) 2 \\pi }{N_\\mathrm{Q}}} }}\\right|^2, \\nonumber \\\\\n\t&\\hspace{-40pt}= \\left|\\sum_{q=1}^{N_\\mathrm{Q}}{\\sum_{n \\in {\\mathcal{S}}_q} {\\left|h_{u,n}\\right| \\cos\\left(\\bar{\\theta}^{q}_{u,n}\\right) }}\\right|^2 + \\left| \\sum_{q=1}^{N_\\mathrm{Q}}{\\sum_{n \\in {\\mathcal{S}}_q} {\\left|h_{u,n}\\right| \\sin\\left(\\bar{\\theta}^{q}_{u,n}\\right) }}\\right|^2\n\t\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\left|{\\mathbf{w}}_{u}^{*}{\\mathbf{h}}_{u}\\right|^{2}\" display=\"inline\"><msup><mrow><mo>|</mo><mrow><msubsup><mi>\ud835\udc30</mi><mi>u</mi><mo>*</mo></msubsup><mo>\u2062</mo><msub><mi>\ud835\udc21</mi><mi>u</mi></msub></mrow><mo>|</mo></mrow><mn>2</mn></msup></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\left|\\sum_{n}w_{u,n}h_{u,n}\\right|^{2}=\\left|\\sum_{q=1}^{N_{%&#10;\\mathrm{Q}}}{\\sum_{n\\in{\\mathcal{S}}_{q}}{h_{u,n}e^{-j\\frac{(q-1)2\\pi}{N_{%&#10;\\mathrm{Q}}}}}}\\right|^{2},\" display=\"inline\"><mrow><mrow><mi/><mo>=</mo><msup><mrow><mo>|</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mi>n</mi></munder></mstyle><mrow><msub><mi>w</mi><mrow><mi>u</mi><mo>,</mo><mi>n</mi></mrow></msub><mo>\u2062</mo><msub><mi>h</mi><mrow><mi>u</mi><mo>,</mo><mi>n</mi></mrow></msub></mrow></mrow><mo>|</mo></mrow><mn>2</mn></msup><mo>=</mo><msup><mrow><mo>|</mo><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>q</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mi mathvariant=\"normal\">Q</mi></msub></munderover></mstyle><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>\u2208</mo><msub><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcae</mi><mi>q</mi></msub></mrow></munder></mstyle><mrow><msub><mi>h</mi><mrow><mi>u</mi><mo>,</mo><mi>n</mi></mrow></msub><mo>\u2062</mo><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi>j</mi><mo>\u2062</mo><mfrac><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>q</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mn>2</mn><mo>\u2062</mo><mi>\u03c0</mi></mrow><msub><mi>N</mi><mi mathvariant=\"normal\">Q</mi></msub></mfrac></mrow></mrow></msup></mrow></mrow></mrow><mo>|</mo></mrow><mn>2</mn></msup></mrow><mo>,</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\left|\\sum_{q=1}^{N_{\\mathrm{Q}}}{\\sum_{n\\in{\\mathcal{S}}_{q}}{%&#10;\\left|h_{u,n}\\right|\\cos\\left(\\bar{\\theta}^{q}_{u,n}\\right)}}\\right|^{2}+\\left%&#10;|\\sum_{q=1}^{N_{\\mathrm{Q}}}{\\sum_{n\\in{\\mathcal{S}}_{q}}{\\left|h_{u,n}\\right|%&#10;\\sin\\left(\\bar{\\theta}^{q}_{u,n}\\right)}}\\right|^{2}\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mrow><mrow><mo>|</mo><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>q</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mi mathvariant=\"normal\">Q</mi></msub></munderover></mstyle><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>\u2208</mo><msub><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcae</mi><mi>q</mi></msub></mrow></munder></mstyle></mrow><mo>|</mo></mrow><mo>\u2062</mo><msub><mi>h</mi><mrow><mi>u</mi><mo>,</mo><mi>n</mi></mrow></msub><mo>\u2062</mo><msup><mrow><mo>|</mo><mrow><mi>cos</mi><mo>\u2061</mo><mrow><mo>(</mo><msubsup><mover accent=\"true\"><mi>\u03b8</mi><mo stretchy=\"false\">\u00af</mo></mover><mrow><mi>u</mi><mo>,</mo><mi>n</mi></mrow><mi>q</mi></msubsup><mo>)</mo></mrow></mrow><mo>|</mo></mrow><mn>2</mn></msup></mrow><mo>+</mo><mrow><mrow><mo>|</mo><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>q</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mi mathvariant=\"normal\">Q</mi></msub></munderover></mstyle><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>\u2208</mo><msub><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcae</mi><mi>q</mi></msub></mrow></munder></mstyle></mrow><mo>|</mo></mrow><mo>\u2062</mo><msub><mi>h</mi><mrow><mi>u</mi><mo>,</mo><mi>n</mi></mrow></msub><mo>\u2062</mo><msup><mrow><mo>|</mo><mrow><mi>sin</mi><mo>\u2061</mo><mrow><mo>(</mo><msubsup><mover accent=\"true\"><mi>\u03b8</mi><mo stretchy=\"false\">\u00af</mo></mover><mrow><mi>u</mi><mo>,</mo><mi>n</mi></mrow><mi>q</mi></msubsup><mo>)</mo></mrow></mrow><mo>|</mo></mrow><mn>2</mn></msup></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.07468.tex", "nexttext": " \n\t\n\twhere this follows by noting that $\\bar{\\theta}_{u,n}^{q} \\in \\left[0, \\frac{2 \\pi}{N_\\mathrm{Q}}\\right], \\forall n, u, q$. The almost sure convergence follows directly by noting that the massive MIMO favorable conditions hold for the adopted model with $|h_{u,n}|$ Rayleigh distributed and ${\\theta}_{u,n}$  uniformly distributed \\cite{Ashikhmin2012}. Leveraging the independence between $|h_{u,n}|$ and $\\theta_{u,n}$, we reach $\\lim_{N \\to \\infty} \\frac{1}{N^2} \\left\\|{\\mathbf{w}}_u^* {\\mathbf{h}}_u\\right\\|^2  \\xrightarrow{\\text{a.s.}} $\n\t\n", "itemtype": "equation", "pos": -1, "prevtext": "\n\t\n\twhere $\\bar{\\theta}^{q}_{u,n}=\\theta_{u,n}-\\frac{2 \\pi (q-1)}{N_\\mathrm{Q}}$. Now, we use the law of large numbers to get $\\lim_{N \\to \\infty} \\frac{1}{N^2} \\left\\|{\\mathbf{w}}_u^* {\\mathbf{h}}_u\\right\\|^2  \\xrightarrow{\\text{a.s.}}$\n\t\n", "index": 17, "text": "\\begin{align}\n\t&  \\left({\\mathbb{E}}\\left[\\left|h_{u,n}\\right| \\cos(\\theta_{u,n})\\left| \\theta_{u,n} \\sim {\\mathcal{U}} \\left(0, \\frac{2 \\pi}{N_\\mathrm{Q}}  \\right) \\right. \\right] \\right)^2\\nonumber\\\\\n\t&  +\\left({\\mathbb{E}}\\left[\\left|h_{u,n}\\right| \\sin(\\theta_{u,n})\\left| \\theta_{u,n} \\sim {\\mathcal{U}} \\left(0, \\frac{2 \\pi}{N_\\mathrm{Q}} \\right) \\right. \\right]\\right)^2, \n\t\\label{eq:12}\n\t\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\left({\\mathbb{E}}\\left[\\left|h_{u,n}\\right|\\cos(\\theta_{u,n})%&#10;\\left|\\theta_{u,n}\\sim{\\mathcal{U}}\\left(0,\\frac{2\\pi}{N_{\\mathrm{Q}}}\\right)%&#10;\\right.\\right]\\right)^{2}\" display=\"inline\"><msup><mrow><mo>(</mo><mi>\ud835\udd3c</mi><mrow><mo>[</mo><mo>|</mo><msub><mi>h</mi><mrow><mi>u</mi><mo>,</mo><mi>n</mi></mrow></msub><mo>|</mo><mi>cos</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03b8</mi><mrow><mi>u</mi><mo>,</mo><mi>n</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><mo>|</mo><msub><mi>\u03b8</mi><mrow><mi>u</mi><mo>,</mo><mi>n</mi></mrow></msub><mo>\u223c</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcb0</mi><mrow><mo>(</mo><mn>0</mn><mo>,</mo><mstyle displaystyle=\"true\"><mfrac><mrow><mn>2</mn><mo>\u2062</mo><mi>\u03c0</mi></mrow><msub><mi>N</mi><mi mathvariant=\"normal\">Q</mi></msub></mfrac></mstyle><mo>)</mo></mrow><mo>]</mo></mrow><mo>)</mo></mrow><mn>2</mn></msup></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E10.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle+\\left({\\mathbb{E}}\\left[\\left|h_{u,n}\\right|\\sin(\\theta_{u,n})%&#10;\\left|\\theta_{u,n}\\sim{\\mathcal{U}}\\left(0,\\frac{2\\pi}{N_{\\mathrm{Q}}}\\right)%&#10;\\right.\\right]\\right)^{2},\" display=\"inline\"><mrow><mo>+</mo><msup><mrow><mo>(</mo><mi>\ud835\udd3c</mi><mrow><mo>[</mo><mo>|</mo><msub><mi>h</mi><mrow><mi>u</mi><mo>,</mo><mi>n</mi></mrow></msub><mo>|</mo><mi>sin</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03b8</mi><mrow><mi>u</mi><mo>,</mo><mi>n</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><mo>|</mo><msub><mi>\u03b8</mi><mrow><mi>u</mi><mo>,</mo><mi>n</mi></mrow></msub><mo>\u223c</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcb0</mi><mrow><mo>(</mo><mn>0</mn><mo>,</mo><mstyle displaystyle=\"true\"><mfrac><mrow><mn>2</mn><mo>\u2062</mo><mi>\u03c0</mi></mrow><msub><mi>N</mi><mi mathvariant=\"normal\">Q</mi></msub></mfrac></mstyle><mo>)</mo></mrow><mo>]</mo></mrow><mo>)</mo></mrow><mn>2</mn></msup><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.07468.tex", "nexttext": "\n\t\n\twhere (a) follows from the distributions of $|h_{u,n}|$ and $\\theta_{u,n}$, and (b) is by using the trigonometric identities. Finally, we note that $\\left\\|{\\mathbf{w}}_u\\right\\|^2=N$ given the adopted switching based receiver architecture. Hence, we reach \n\t\n", "itemtype": "equation", "pos": 24144, "prevtext": " \n\t\n\twhere this follows by noting that $\\bar{\\theta}_{u,n}^{q} \\in \\left[0, \\frac{2 \\pi}{N_\\mathrm{Q}}\\right], \\forall n, u, q$. The almost sure convergence follows directly by noting that the massive MIMO favorable conditions hold for the adopted model with $|h_{u,n}|$ Rayleigh distributed and ${\\theta}_{u,n}$  uniformly distributed \\cite{Ashikhmin2012}. Leveraging the independence between $|h_{u,n}|$ and $\\theta_{u,n}$, we reach $\\lim_{N \\to \\infty} \\frac{1}{N^2} \\left\\|{\\mathbf{w}}_u^* {\\mathbf{h}}_u\\right\\|^2  \\xrightarrow{\\text{a.s.}} $\n\t\n", "index": 19, "text": "\\begin{align}\n\t&   \\left({\\mathbb{E}}\\left[\\left|h_{u,n}\\right|  \\right]\\right)^2 \\left({\\mathbb{E}}\\left[\\cos(\\theta_{u,n})\\left| \\theta_{u,n} \\sim {\\mathcal{U}} \\left(0, \\frac{2 \\pi}{N_\\mathrm{Q}} \\right. \\right) \\right] \\right)^2\\nonumber \\\\ & +\\left({\\mathbb{E}}\\left[\\left|h_{u,n}\\right|  \\right]\\right)^2 \\left({\\mathbb{E}}\\left[\\sin(\\theta_{u,n})\\left| \\theta_{u,n} \\sim {\\mathcal{U}} \\left(0, \\frac{2 \\pi}{N_\\mathrm{Q}} \\right) \\right. \\right]\\right)^2 \\\\\n\t& \\stackrel{(a)}{=} \\frac{N_\\mathrm{Q}^2}{16 \\pi} \\left(  \\sin^2\\left(\\frac{2 \\pi}{N_\\mathrm{Q}}\\right) + \\left(1-\\cos\\left(\\frac{2 \\pi}{N_\\mathrm{Q}}\\right)\\right)^2 \\right), \\\\\n\t& \\stackrel{(b)}{=} \\frac{N_\\mathrm{Q}^2}{4 \\pi}  \\sin^2\\left(\\frac{ \\pi}{N_\\mathrm{Q}}\\right),\n\t\\label{eq:15}\n\t\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\left({\\mathbb{E}}\\left[\\left|h_{u,n}\\right|\\right]\\right)^{2}%&#10;\\left({\\mathbb{E}}\\left[\\cos(\\theta_{u,n})\\left|\\theta_{u,n}\\sim{\\mathcal{U}}%&#10;\\left(0,\\frac{2\\pi}{N_{\\mathrm{Q}}}\\right.\\right)\\right]\\right)^{2}\" display=\"inline\"><mrow><msup><mrow><mo>(</mo><mi>\ud835\udd3c</mi><mrow><mo>[</mo><mo>|</mo><msub><mi>h</mi><mrow><mi>u</mi><mo>,</mo><mi>n</mi></mrow></msub><mo>|</mo><mo>]</mo></mrow><mo>)</mo></mrow><mn>2</mn></msup><msup><mrow><mo>(</mo><mi>\ud835\udd3c</mi><mrow><mo>[</mo><mi>cos</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03b8</mi><mrow><mi>u</mi><mo>,</mo><mi>n</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><mo>|</mo><msub><mi>\u03b8</mi><mrow><mi>u</mi><mo>,</mo><mi>n</mi></mrow></msub><mo>\u223c</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcb0</mi><mrow><mo>(</mo><mn>0</mn><mo>,</mo><mstyle displaystyle=\"true\"><mfrac><mrow><mn>2</mn><mo>\u2062</mo><mi>\u03c0</mi></mrow><msub><mi>N</mi><mi mathvariant=\"normal\">Q</mi></msub></mfrac></mstyle><mo>)</mo></mrow><mo>]</mo></mrow><mo>)</mo></mrow><mn>2</mn></msup></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E11.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle+\\left({\\mathbb{E}}\\left[\\left|h_{u,n}\\right|\\right]\\right)^{2}%&#10;\\left({\\mathbb{E}}\\left[\\sin(\\theta_{u,n})\\left|\\theta_{u,n}\\sim{\\mathcal{U}}%&#10;\\left(0,\\frac{2\\pi}{N_{\\mathrm{Q}}}\\right)\\right.\\right]\\right)^{2}\" display=\"inline\"><mrow><mo>+</mo><msup><mrow><mo>(</mo><mi>\ud835\udd3c</mi><mrow><mo>[</mo><mo>|</mo><msub><mi>h</mi><mrow><mi>u</mi><mo>,</mo><mi>n</mi></mrow></msub><mo>|</mo><mo>]</mo></mrow><mo>)</mo></mrow><mn>2</mn></msup><msup><mrow><mo>(</mo><mi>\ud835\udd3c</mi><mrow><mo>[</mo><mi>sin</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03b8</mi><mrow><mi>u</mi><mo>,</mo><mi>n</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><mo>|</mo><msub><mi>\u03b8</mi><mrow><mi>u</mi><mo>,</mo><mi>n</mi></mrow></msub><mo>\u223c</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcb0</mi><mrow><mo>(</mo><mn>0</mn><mo>,</mo><mstyle displaystyle=\"true\"><mfrac><mrow><mn>2</mn><mo>\u2062</mo><mi>\u03c0</mi></mrow><msub><mi>N</mi><mi mathvariant=\"normal\">Q</mi></msub></mfrac></mstyle><mo>)</mo></mrow><mo>]</mo></mrow><mo>)</mo></mrow><mn>2</mn></msup></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E12.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\stackrel{(a)}{=}\\frac{N_{\\mathrm{Q}}^{2}}{16\\pi}\\left(\\sin^{2}%&#10;\\left(\\frac{2\\pi}{N_{\\mathrm{Q}}}\\right)+\\left(1-\\cos\\left(\\frac{2\\pi}{N_{%&#10;\\mathrm{Q}}}\\right)\\right)^{2}\\right),\" display=\"inline\"><mrow><mrow><mi/><mover><mo movablelimits=\"false\">=</mo><mrow><mo maxsize=\"142%\" minsize=\"142%\">(</mo><mi mathsize=\"142%\">a</mi><mo maxsize=\"142%\" minsize=\"142%\">)</mo></mrow></mover><mrow><mstyle displaystyle=\"true\"><mfrac><msubsup><mi>N</mi><mi mathvariant=\"normal\">Q</mi><mn>2</mn></msubsup><mrow><mn>16</mn><mo>\u2062</mo><mi>\u03c0</mi></mrow></mfrac></mstyle><mo>\u2062</mo><mrow><mo>(</mo><mrow><mrow><msup><mi>sin</mi><mn>2</mn></msup><mo>\u2061</mo><mrow><mo>(</mo><mstyle displaystyle=\"true\"><mfrac><mrow><mn>2</mn><mo>\u2062</mo><mi>\u03c0</mi></mrow><msub><mi>N</mi><mi mathvariant=\"normal\">Q</mi></msub></mfrac></mstyle><mo>)</mo></mrow></mrow><mo>+</mo><msup><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><mrow><mi>cos</mi><mo>\u2061</mo><mrow><mo>(</mo><mstyle displaystyle=\"true\"><mfrac><mrow><mn>2</mn><mo>\u2062</mo><mi>\u03c0</mi></mrow><msub><mi>N</mi><mi mathvariant=\"normal\">Q</mi></msub></mfrac></mstyle><mo>)</mo></mrow></mrow></mrow><mo>)</mo></mrow><mn>2</mn></msup></mrow><mo>)</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E13.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\stackrel{(b)}{=}\\frac{N_{\\mathrm{Q}}^{2}}{4\\pi}\\sin^{2}\\left(%&#10;\\frac{\\pi}{N_{\\mathrm{Q}}}\\right),\" display=\"inline\"><mrow><mrow><mi/><mover><mo movablelimits=\"false\">=</mo><mrow><mo maxsize=\"142%\" minsize=\"142%\">(</mo><mi mathsize=\"142%\">b</mi><mo maxsize=\"142%\" minsize=\"142%\">)</mo></mrow></mover><mrow><mstyle displaystyle=\"true\"><mfrac><msubsup><mi>N</mi><mi mathvariant=\"normal\">Q</mi><mn>2</mn></msubsup><mrow><mn>4</mn><mo>\u2062</mo><mi>\u03c0</mi></mrow></mfrac></mstyle><mo>\u2062</mo><mrow><msup><mi>sin</mi><mn>2</mn></msup><mo>\u2061</mo><mrow><mo>(</mo><mstyle displaystyle=\"true\"><mfrac><mi>\u03c0</mi><msub><mi>N</mi><mi mathvariant=\"normal\">Q</mi></msub></mfrac></mstyle><mo>)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.07468.tex", "nexttext": "\n\twhich completes the proof.\n\\end{proof}\n\n\n\n\\bibliographystyle{IEEEtran}\n\n\\begin{thebibliography}{1}\n\t\\providecommand{\\url}[1]{#1}\n\t\\csname url@samestyle\\endcsname\n\t\\providecommand{\\newblock}{\\relax}\n\t\\providecommand{\\bibinfo}[2]{#2}\n\t\\providecommand{\\BIBentrySTDinterwordspacing}{\\spaceskip=0pt\\relax}\n\t\\providecommand{\\BIBentryALTinterwordstretchfactor}{4}\n\t\\providecommand{\\BIBentryALTinterwordspacing}{\\spaceskip=\\fontdimen2\\font plus\n\t\t\\BIBentryALTinterwordstretchfactor\\fontdimen3\\font minus\n\t\t\\fontdimen4\\font\\relax}\n\t\\providecommand{\\BIBforeignlanguage}[2]{{\n\t\t\t\\expandafter\\ifx\\csname l@#1\\endcsname\\relax\n\t\t\t\\typeout{** WARNING: IEEEtran.bst: No hyphenation pattern has been}\n\t\t\t\\typeout{** loaded for the language `#1'. Using the pattern for}\n\t\t\t\\typeout{** the default language instead.}\n\t\t\t\\else\n\t\t\t\\language=\\csname l@#1\\endcsname\n\t\t\t\\fi\n\t\t\t#2}}\n\t\\providecommand{\\BIBdecl}{\\relax}\n\t\\BIBdecl\n\t\n\t\\bibitem{Boccardi2014}\n\tF.~Boccardi, R.~Heath, A.~Lozano, T.~Marzetta, and P.~Popovski, ``Five\n\tdisruptive technology directions for {5G},'' \\emph{IEEE Comm. Mag.}, vol.~52,\n\tno.~2, pp. 74--80, Feb. 2014.\n\t\n\t\\bibitem{ElAyach2014}\n\tO.~El~Ayach, S.~Rajagopal, S.~Abu-Surra, Z.~Pi, and R.~Heath, ``Spatially\n\tsparse precoding in millimeter wave {MIMO} systems,'' \\emph{IEEE Trans. on\n\t\tWireless Commun.}, vol.~13, no.~3, pp. 1499--1513, Mar. 2014.\n\t\n\t\\bibitem{Alkhateeb2014b}\n\tA.~Alkhateeb, G.~Leus, and R.~Heath, ``Limited feedback hybrid precoding for\n\tmulti-user millimeter wave systems,'' \\emph{IEEE Trans. on Wireless Commun.},\n\tvol.~14, no.~11, pp. 6481--6494, Nov. 2015.\n\t\n\t\\bibitem{Zeng2014}\n\tY.~Zeng, R.~Zhang, and Z.~N. Chen, ``Electromagnetic lens-focusing antenna\n\tenabled massive {MIMO}: Performance improvement and cost reduction,''\n\t\\emph{IEEE Jour. on Select. Areas in Commun.}, vol.~32, no.~6, pp.\n\t1194--1206, June 2014.\n\t\n\t\\bibitem{Brady2013}\n\tJ.~Brady, N.~Behdad, and A.~Sayeed, ``Beamspace {MIMO} for millimeter-wave\n\tcommunications: System architecture, modeling, analysis, and measurements,''\n\t\\emph{IEEE Trans. on Ant. and Propag.}, vol.~61, no.~7, pp. 3814--3827, July\n\t2013.\n\t\n\t\\bibitem{Mendez-Rial2015}\n\tR.~M{\\'e}ndez-Rial, C.~Rusu, A.~Alkhateeb, N.~Gonz{\\'a}lez-Prelcic, and R.~W.\n\tHeath~Jr, ``Channel estimation and hybrid combining for mmwave: Phase\n\tshifters or switches?'' in \\emph{Info. Theory and App. Workshop}, 2015.\n\t\n\t\\bibitem{Ahn2009}\n\tM.~Ahn, H.-W. Kim, C.-H. Lee, and J.~Laskar, ``A 1.8-{GHz} 33-{dBm} {P}\n\t0.1-{dB} {CMOS} {T/R} switch using stacked {FETs} with feed-forward\n\tcapacitors in a floated well structure,'' \\emph{IEEE Transactions on\n\t\tMicrowave Theory and Techniques}, vol.~57, no.~11, pp. 2661--2670, Nov. 2009.\n\t\n\t\\bibitem{Hoydis2013}\n\tJ.~Hoydis, S.~ten Brink, and M.~Debbah, ``Massive {MIMO} in the {UL/DL} of\n\tcellular networks: How many antennas do we need?'' \\emph{IEEE Jour. on\n\t\tSelect. Areas in Commun.}, vol.~31, no.~2, pp. 160--171, Feb. 2013.\n\t\n\t\\bibitem{Ashikhmin2012}\n\tA.~Ashikhmin and T.~Marzetta, ``Pilot contamination precoding in multi-cell\n\tlarge scale antenna systems,'' in \\emph{IEEE Int. Symp. on Info. Theo.}, July\n\t2012, pp. 1137--1141.\n\t\n\\end{thebibliography}\n\n", "itemtype": "equation", "pos": 25175, "prevtext": "\n\t\n\twhere (a) follows from the distributions of $|h_{u,n}|$ and $\\theta_{u,n}$, and (b) is by using the trigonometric identities. Finally, we note that $\\left\\|{\\mathbf{w}}_u\\right\\|^2=N$ given the adopted switching based receiver architecture. Hence, we reach \n\t\n", "index": 21, "text": "\\begin{equation}\n\t\\lim_{N \\to \\infty} \\frac{1}{N}\\mathsf{SNR}_u^\\mathrm{SC} \\xrightarrow{\\text{a.s.}} \\frac{N_\\mathrm{Q}^2}{4 \\pi} \\sin^2\\left(\\frac{\\pi}{N_\\mathrm{Q}}\\right) \\rho,\n\t\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14.m1\" class=\"ltx_Math\" alttext=\"\\lim_{N\\to\\infty}\\frac{1}{N}\\mathsf{SNR}_{u}^{\\mathrm{SC}}\\xrightarrow{\\text{a%&#10;.s.}}\\frac{N_{\\mathrm{Q}}^{2}}{4\\pi}\\sin^{2}\\left(\\frac{\\pi}{N_{\\mathrm{Q}}}%&#10;\\right)\\rho,\" display=\"block\"><mrow><mrow><mrow><munder><mo movablelimits=\"false\">lim</mo><mrow><mi>N</mi><mo>\u2192</mo><mi mathvariant=\"normal\">\u221e</mi></mrow></munder><mo>\u2061</mo><mrow><mfrac><mn>1</mn><mi>N</mi></mfrac><mo>\u2062</mo><msubsup><mi>\ud835\uddb2\ud835\uddad\ud835\uddb1</mi><mi>u</mi><mi>SC</mi></msubsup></mrow></mrow><mover accent=\"true\"><mo>\u2192</mo><mtext>a.s.</mtext></mover><mrow><mfrac><msubsup><mi>N</mi><mi mathvariant=\"normal\">Q</mi><mn>2</mn></msubsup><mrow><mn>4</mn><mo>\u2062</mo><mi>\u03c0</mi></mrow></mfrac><mo>\u2062</mo><mrow><msup><mi>sin</mi><mn>2</mn></msup><mo>\u2061</mo><mrow><mo>(</mo><mfrac><mi>\u03c0</mi><msub><mi>N</mi><mi mathvariant=\"normal\">Q</mi></msub></mfrac><mo>)</mo></mrow></mrow><mo>\u2062</mo><mi>\u03c1</mi></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}]