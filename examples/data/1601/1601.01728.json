[{"file": "1601.01728.tex", "nexttext": "\n\n\\noindent\nwhere:\n\n\\begin{itemize}\n  \\item $T$ is the set of time periods - as in \\cite{BaCo11}, we consider hours in a day, so we have $T = \\{1,2,\\ldots,24\\}$;\n  \\item $p = (p_1, p_2, \\ldots, p_{|T|}) \\in \\mathbb{R}^{|T|}_+$ is a non-negative decision vector, which includes one variable $p_{t} \\geq 0$\n\t    for each period $t \\in T$ to represent the energy offered in $t$;\n  \\item $\\lambda_{t}$ is the realized market price in period $t \\in T$;\n  \\item $c_t(p_{t})$ is the cost of generating $p_{t}$ in period $t \\in T$, possibly including the so called \\emph{Start Up Costs} (SUC);\n  \\item $P$ is the feasible set of solutions of the problem, containing all vectors $p$ that satisfy the technical constraints of the unit,\n\t\t\t\tnamely minimum and maximum generation output, ramp limits and minimum up and down time.\n\t\t\t\tWe provide a complete description of $P$ in Appendix \\ref{sec:appendixRefForm}.\n        \n\\end{itemize}\n\n\n\n\n\n\n\\noindent\n\\textbf{Remark.}\nIn Appendix \\ref{sec:appendixRefForm}, we model the cost function $c_t(p_{t})$ as a quadratic function. In our case, EOP-MIP thus becomes a \\emph{Mixed Integer Quadratic Programming (MIQP) problem}.\n\nWe note that in literature it is also common to adopt piecewise linear approximations of the quadratic cost function, as done, for example, in \\cite{BaCo11}, thus making EOP-MIP a \\emph{Mixed Integer Linear Programming} (MILP) problem.\n\\\\\n\nWe stress that all the considerations that we make in the next section about defining a robust counterpart for the MIQP version of EOP can be immediately extended to the piecewise linear version considered in \\cite{BaCo11}.\n\n\n\\smallskip\n\\noindent\nIn the next section, we discuss how to consider the uncertainty of market price in the EOP and we detail a revised and refined robust optimization method that overcomes the limits of the Bar-Con.\n\n\n\n\n\\section{A review of the Baringo-Conejo robust offering approach}\n\\label{sec:BarCon}\n\n\nIn this section, we review the Bar-Con robust optimization-based method and we point out how its computational efficiency can be improved by reducing the size of the robust counterpart. Furthermore, we illustrate how offering curves built according to Bar-Con can lead to suboptimal and even infeasible accepted offers. As first step, we review basic concepts from Robust Optimization and $\\Gamma$-Robsutness.\n\n\\subsection{A concise introduction to Robust Optimization}\n\nUntil this section, we have considered a \\emph{deterministic} version of the EOP where we have assumed that the market prices $\\lambda_{t}$, $\\forall t \\in T$ are exactly known when the problem is solved. However, this assumption does not hold in practice: in competitive energy markets, the hourly prices result from the combination of demands and offers whose precise values are not known in advance. The prices $\\lambda_{t}$ are thus \\emph{uncertain}, i.e. their values are not deterministically known when the EOP is solved, and the price-taker commonly possesses just an estimate of them (e.g., an average value derived from historical market price data, or some other form of prediction).\n\nThe presence of uncertain data in the EOP is very tricky:\nthe price-taker could solve the EOP-MIP referring to the estimates of hourly prices, thus getting solutions that are optimal with respect to such estimates; however, the estimates will be in general (sensibly) different from the actual prices occurring in the market, so that supposedly optimal solutions may reveal to be \\emph{heavily sub-optimal}. This fact can be clarified by a simple consideration: if we solve the EOP-MIP using estimates of values $\\bar{\\lambda}_{t}$ lower than the actual market prices, then we generate less energy than it would be ideal with the real prices, obtaining a lower profit. On the other hand, if we overestimate the actual market prices, we could turn on generation units and generate energy when it is not convenient to do so, facing overproduction and losses.\n\nMore in general, the presence of data uncertainty is a source of issues in any optimization problem and neglecting it is well known to have very bad consequences: as we have exemplified above, solutions supposed to be optimal may turn out to be heavily suboptimal and, even worse, solutions supposed to be feasible may instead reveal to violate feasibility constraints, thus resulting in decisions that cannot be implemented in practice. For an exhaustive introduction to the issues arising in optimization under data uncertainty, we refer the reader to the book \\cite{BeElNe09}.\n\n\nIn the last decade, RO has known a wide success as a modern methodology to manage data uncertainty in optimization problems, thanks especially to its accessibility and computational tractability. We refer the reader to \\cite{BeElNe09} and \\cite{BeBrCa11} for an exhaustive introduction to theory and applications of RO.\n\\\\\nRO is essentially based on the following principles:\n\n\\begin{itemize}\n    \\item the \\emph{actual value} of an uncertain coefficient of the problem is unknown. However, the decision maker is supposed to possess a reasonable reference for the unknown actual value. This reference is called \\emph{nominal value} and could be, for example, the expected value of a random variable. The actual value equals the sum of the nominal value and of an unknown deviation;\n  \\item the decision maker defines an \\emph{uncertainty set}. This set characterizes the deviations of coefficients w.r.t. their nominal values, against which the decision maker wants to be protected;\n  \\item the decision maker derives and solves a \\emph{robust counterpart} of its problem: this is a modified version of the original optimization problem that only considers robust feasible solutions, i.e. feasible solutions that are protected against all the deviations of the uncertainty set.\n      An \\emph{optimal robust solution} is a feasible solution\n      granting the best objective value under the worst data deviations;\n  \\item protection against deviations comes at a cost: the so-called \\emph{price of robustness} \\cite{BeSi04}. This is a deterioration in the optimal value of a problem that the decision maker must face in order to ensure protection. Uncertainty sets granting higher protection entail in general a higher price of robustness.\n\\end{itemize}\n\n\\noindent\nOver the years, many models have been proposed to represent uncertainty sets in RO (see \\cite{BeBrCa11} for an overview). Among them, one of the most successful has been the $\\Gamma$-Robustness model (\\emph{$\\Gamma$-Rob}) proposed by Bertsimas and Sim \\cite{BeSi04}, which has been also adopted in Bar-Con. We  thoroughly review the adaption of $\\Gamma$-Rob in Bar-Con in the next subsection.\nHere, we just recall the essence of this classical and widely used robust optimization model. Given an uncertain constraint of the problem including $n$ uncertain coefficients of which we know the nominal value and the maximum deviation w.r.t. the nominal value, $\\Gamma$-Rob provides for an elegant theory to define a robust counterpart for an uncertainty set imposing full protection against at most $0 \\leq \\Gamma \\leq n$ coefficients deviating from their nominal value. The  $\\Gamma$-Rob counterpart has the desirable property of entailing a ``contained'' increase in the number of constraints and variables of the problems (more formally, the counterpart is \\emph{compact}) and of maintaining the features of the original problem (e.g., an uncertain MILP problem has a MILP $\\Gamma$-Rob counterpart, whereas an uncertain MIQP has a MIQP $\\Gamma$-Rob counterpart).\n\nThe parameter $\\Gamma$ controls the robustness: for $\\Gamma=0$ no protection is imposed and no price of robustness occurs; for increasing $\\Gamma$, the protection and the price of robustness increase, until for $\\Gamma=n$ the highest protection is reached.  This informal description is detailed in the next paragraph with reference to the EOP.\n\n\n\\subsection{The Robust Optimization approach by Baringo and Conejo}\n\\label{SubSect:BaringoConejoApproach}\n\nIn this section, we provide a description of the main features of the Bar-Con, which are relevant to highlight its limits and derive our improved method. For a full description of the method, we refer the reader to \\cite{BaCo11}. The Bar-Con assumes that in every hour $t \\in T$ the actual market price $\\lambda_{t}$ lies in a known range, i.e. $\\lambda_{t} \\in [\\lambda_{t}^{\\min}, \\lambda_{t}^{\\max}]$, and a-priori defines an elementary market price shortfall equal to $\\delta \\hspace{0.05cm} (\\lambda_{t}^{\\max} - \\lambda_{t}^{\\min})$ with $0 \\leq \\delta \\leq 1$. Then, it proposes to compute the hourly offering curves by solving a sequence of $1,\\ldots, K$ robust counterparts of the original problem and in the generic k-th robust counterpart:\n\n\\begin{enumerate}\n  \\item the market price in each hour is supposed to lie in the interval\n    \n", "itemtype": "equation", "pos": 11432, "prevtext": "\n\n\\title{Revisiting the use of Robust Optimization\\\\for optimal energy offering under price uncertainty}\n\n\n\n\n\n\n\n\n\n\n\n\\author{Fabio~D'Andreagiovanni$^{*}$, \n        Giovanni~Felici, \n        and~Fabrizio~Lacalandra,\n\\thanks{F.~D'Andreagiovanni is with: the Dept. of Mathematical Optimization, Zuse Institute Berlin (ZIB), Takustr. 7, 14195 Berlin, Germany; the DFG Research Center MATHEON, Technical University Berlin and the Einstein Center for Mathematics (ECMath), Strasse des 17 Juni, 10623 Berlin, Germany, e-mail: d.andreagiovanni@zib.de.}\n\\thanks{G.~Felici and F.~D'Andreagiovanni are with the Institute for System Analysis and Computer Science ``A. Ruberti'', National Research Council of Italy (IASI-CNR), via dei Taurini 19, 00185 Roma, Italy, e-mail: felici@iasi.cnr.it.}\n\\thanks{F.~Lacalandra is with Quantek s.r.l., via G. Marconi 3, 40122 Bologna, Italy, e-mail: fabrizio.lacalandra@quantek.it}\n\\thanks{Manuscript received Month DD, YYYY; revised Month DD, YYYY.}\n\\\\\n$^{* \\;}$First Author}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\markboth{Journal of \\LaTeX\\ Class Files,~Vol.~xx, No.~x, Month~xxxx}\n{Shell \\MakeLowercase{\\textit{et al.}}: Bare Demo of IEEEtran.cls for Journals}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\maketitle\n\n\n\n\\begin{abstract}\nWe propose a new Robust Optimization method for the energy offering problem of a price-taker generating company that wants to build offering curves for its generation units, in order to maximize its profit while taking into account the uncertainty of market price.\nOur investigations have been motivated by a review of another Robust Optimization method \nproposed in \\cite{BaCo11}, which entails the solution of a sequence of robust optimization problems imposing full protection and defined over a sequence of nested subintervals of market prices:\n\nthis method presents a number of drawbacks that may sensibly limit its application and computational efficiency in practice and that may expose a company to the risk of presenting offering curves resulting into suboptimal or even infeasible accepted offers. To tackle all such issues, our method provides for solving one single robust counterpart, considering an intermediate level of protection between null and full protection, and for making energy offers at zero price, practically eliminating the risk of non-acceptance. Computational results on instances provided by our industrial partners show that our new method grants a great improvement in profit.\n\\end{abstract}\n\n\n\\begin{IEEEkeywords}\nEnergy Offering, Price-taker, Price Uncertainty, Robust Optimization, Mixed Integer Quadratic Programming.\n\\end{IEEEkeywords}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\IEEEpeerreviewmaketitle\n\n\n\n\\section{Introduction}\n\n\\IEEEPARstart{W}{e} consider the decision problem of a price-taker generating company that operates in a competitive electricity market and wants to select energy offering strategies for its (few) units, in order to maximize the profit while taking into account market price uncertainty. For an introduction to offering in competitive electricity markets, we refer the reader to \\cite{DaWe00} and \\cite{KwFr12}.\n\nA major challenge in energy offering is represented by tackling uncertainty of market prices: hourly prices forming in the market are not known in advance to companies, which must therefore take offering decisions by making some assumption about future price realizations.\nConsidering price uncertainty in mathematical optimization models is essential and neglecting it may have very negative consequences and lead to bad offering decisions and losses.\nSince the seminal work \\cite{Da93}, which analyzes the mathematical consequences of passing from regulated to competitive markets,\nseveral approaches have thus been developed for addressing price uncertainty. We refer the reader to the surveys \\cite{LiShQu11} and \\cite{TaEtAl15} for a thorough review of related works.\n\nOur main reference for the present work is represented by a \\emph{Robust Optimization} method for energy offering introduced by Baringo and Conejo in \\cite{BaCo11}. In the remainder of the paper, we will denote such method by \\emph{Bar-Con}.\nBar-Con constitutes a recent and relevant reference in literature that builds offering curves by solving a sequence of \\emph{(robust) mixed integer linear programming problems}, defined on the basis of a sequence of nested subintervals of market prices. The robust problems follow the well-established $\\Gamma$-Robustness model introduced by Bertsimas and Sim  \\cite{BeSi04}.\nHowever, Bar-Con presents a number of issues that may sensibly limit its application in practice and expose a company to the risk of building curves that may result in infeasible and suboptimal accepted offers (see Section \\ref{sec:BarCon} for our detailed review). Though Bar-Con has been widely cited in other works, we stress that, to the best of our knowledge, so far \\emph{no work} available in literature has ever pointed out these issues and tried to overcome them.\n\n\\noindent\nIn this paper, our main original contributions are the following:\n\n\\begin{enumerate}\n   \\item we review the Robust Optimization method proposed by Baringo and Conejo in \\cite{BaCo11} highlighting some drawbacks. Specifically, we highlight that:\n   \\begin{itemize}\n   \\item\n\t\tsince Bar-Con imposes full protection against price deviations, the computation of robust optimal solutions does not require to solve robust counterparts including additional \t\t \n\t\tvariables and constraints, as specified by $\\Gamma$-Robustness \\cite{BeSi04}. We show that the optimal robust solutions corresponding with full protection can be simply obtained by \t\t\n\t\tsolving the original problem with modified price coefficients in the objective function.\n       \n       This simple observation allows to greatly improve the computational efficiency of the method;\n   \\item\n\t\toffering curves built according to Bar-Con may imply the acceptance of \\emph{infeasible} and \\emph{suboptimal} offers (e.g., accepted offers may violate ramp limits of the generation \t \n\t\tunits, thus being not implementable in practice).\n       \n       This is a consequence of building offering curves by merging robust optimal solutions obtained for distinct assumptions about price realizations, as we detail in Subsection\n\t\t\t \\ref{subsec:riskInfeasibilitySuboptimality}.\nMoreover, the\nmethod concretely exposes the producer to the\nrisk that offers are not accepted;\n\n   \\end{itemize}\n\n   \n   \\item \twe propose a revised method for energy offering under price-uncertainty through Robust Optimization. Our original approach is able to overcome the limits of \\emph{Bar-Con} and \t \n\t\t\t\t\tis more computational efficient since it provides for the solution of \\emph{only one} $\\Gamma$-robust counterpart, based on hourly reference price and price deviations \t\t\t \n\t\t\t\t\tderived from historical data.\nOur method is more in line with the spirit of $\\Gamma$-robustness, reducing the price of robustness by not dealing with extreme conservatism, but addressing intermediate and more rational cases.\nA distinctive feature of our approach is to make all selling offers at \\emph{zero price}, following the spirit of a pure price-taker that wants to minimize the probability of non-acceptance. Indeed, in current years the growth in zero marginal cost renewable sources has somehow changed the price shape during the hours in day-ahead market. This leads to the risk that in some hours the price falls below the marginal cost of classic fossil fueled power plants, such as Combined Cycle Gas Turbine (CCGT). This risk is however managed by means of the robust approach proposed;\n   \\item we prove the effectiveness of our revised method on realistic problem instances, considering fossil-fuel power plants and\n       \n       referring to price data from the Italian day ahead energy market. \t\t Computational tests show that our approach can greatly improve the total profit of the price-taker by considering intermediate level of protection (\\emph{in-between} null and full protection).\n\\end{enumerate}\n\n\n\\smallskip\n\n\\noindent\nWe developed a new method based on Robust Optimization (RO) to exploit the advantages of RO over more traditional optimization under uncertainty approaches, like Stochastic Programming\n(see \\cite{BeElNe09} and \\cite{BeBrCa11} for a thorough discussions).\nComputational tractability is in particular a major advantage of RO, deriving from taking into account data uncertainty in a deterministic way, which allows to tackle the so-called ``curse of dimensionality'', typical of\n\napproaches like Stochastic Programming. Such advantages contributed to the wide success of RO in many application fields, including power system optimization, over the last decade (see \\cite{TaEtAl15} for an overview).\n\nBesides RO, several other approaches have been proposed over time for tackling price uncertainty in energy offering. Here, we recall just a few main ones, referring the reader to \\cite{LiShQu11} for a recent exhaustive survey.\nIn \\cite{CoEtAl04} and \\cite{YaSh04}, the price uncertainty is considered in the guise of an objective function that combines the two conflicting objectives of  maximizing profit and minimizing risk through risk tolerance parameters. To reduce the influence of the risk parameters, whose setting may result tricky, \\cite{Ja05} proposes to measure risk through conditional value-at-risk. Other works propose to use forecasting techniques to estimate the uncertain prices in the objective function (e.g., \\cite{CoEtAl02}). Finally, another distinct body of literature relies on defining sets of price scenarios and following Stochastic Programming approaches\n(e.g., \\cite{DeEtAl03}, \\cite{HrEtAl13}, \\cite{LiShLi07}).\n\n\\smallskip\n\\noindent\nThe paper is organized as follows: in Section \\ref{sec:powerOffering}, we introduce the energy offering problem and present an optimization model for it. In Section \\ref{sec:BarCon}, we review the Bar-Con method, pointing out its limits. In Section \\ref{sec:revisedOffering}, we introduce our revised method based on RO. Finally, in Section \\ref{sec:computations}, we present computational results for realistic instances.\n\n\n\n\n\\section{The Energy Offering Problem}\n\\label{sec:powerOffering}\n\nWe focus the attention on a generation company that wants to maximize its profit by choosing the output of its generation units in each hour. We assume that the company is a \\emph{price-taker}, i.e. it is not able to influence the market price by its generation decisions. An important consequence of this assumption is that the \\emph{multi-unit} decision problem can be decomposed into \\emph{multiple single-unit} problems, as noted in \\cite{BaCo11}.\nIn a more formal way, we can state the single-unit decision problem as follows:\n\n\\begin{Definition}[Energy Offering Problem - EOP]\nGiven a planning horizon including multiple time periods, the market price in each period and a single generation unit characterized by a set of technical constraints and a generation cost, the \\emph{Energy Offering Problem (EOP)} consists in establishing the energy to produce and offer in the market for the unit in each period, in order to maximize the total profit over the time horizon, while satisfying the technical constraints.\n\\end{Definition}\n\n\n\\medskip\nThe EOP is an optimization problem that can be modelled as the following \\emph{Mixed Integer Programming} problem, which includes continuous and discrete decision variables and which we denote by EOP-MIP\n\n\n\n", "index": 1, "text": "\\begin{align}\n\\max\n&\n\\sum_{t \\in T} \\lambda_{t} p_{t} - c_{t} (p_{t})\n&&\n\\mbox{(EOP-MIP)}\n\\nonumber\n\\\\\n&\np \\in P \\; ,\n&&\n\n\\nonumber\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\max\" display=\"inline\"><mi>max</mi></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\sum_{t\\in T}\\lambda_{t}p_{t}-c_{t}(p_{t})\" display=\"inline\"><mrow><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>t</mi><mo>\u2208</mo><mi>T</mi></mrow></munder></mstyle><mrow><msub><mi>\u03bb</mi><mi>t</mi></msub><mo>\u2062</mo><msub><mi>p</mi><mi>t</mi></msub></mrow></mrow><mo>-</mo><mrow><msub><mi>c</mi><mi>t</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>p</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle p\\in P\\;,\" display=\"inline\"><mrow><mrow><mi>p</mi><mo>\u2208</mo><mpadded width=\"+2.8pt\"><mi>P</mi></mpadded></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01728.tex", "nexttext": "\n    where $d_{t}^k = G^k  (\\lambda_{t}^{\\max} - \\lambda_{t}^{\\min}) =  (k - 1) [\\delta (\\lambda_{t}^{\\max} - \\lambda_{t}^{\\min})]$ is the \\emph{maximum price deviation} in $t$ at iteration $k$. Such deviation\n\ncauses the overall deviation interval $[\\lambda_{t}^{\\max} - d_{t}^k, \\hspace{0.1cm} \\lambda_{t}^{\\max}]$ to become wider as the iteration $k$ increases. We remark that \\cite{BaCo11} just refers to the coefficient $G^k$ and does not use its equivalent form $(k - 1) \\delta$ that we adopt here to highlight the role of the iteration index $k$ in the product;\n\n  \\item data uncertainty in the problem is modelled through $\\Gamma$-Robustness and\n  the k-th robust counterpart has the following form:\n  \n\\begin{eqnarray}\n\\max\n&&\n\\sum_{t \\in T} \\left[ \\lambda_{t}^{\\max} p_{t} - c_{t} (p_{t}) \\right] - \\Gamma z - \\sum_{t \\in T} q_{t}\n\\nonumber\n\\\\\n&&\nz + q_{t} \\geq d_{t}^k y_{t}\n\\hspace{0.70cm}\nt \\in T\n\\nonumber\n\\\\\n&&\nz \\geq 0\n\\nonumber\n\\\\\n&&\nq_{t} \\geq 0\n\\hspace{1.80cm}\nt \\in T\n\\nonumber\n\\\\\n&&\np_{t} \\leq y_{t}\n\\hspace{1.65cm}\nt \\in T\n\\label{linkingConstraints-BarCon}\n\\\\\n&&\np \\in P\n\n\n\\nonumber\n\\end{eqnarray}\n\nwith $\\Gamma$ set equal to the number of periods $|T|$.\n\n\\item offering curves for each period are built merging the $K$ optimal robust solutions: the optimal robust solution of the k-th counterpart specifies the generation output $p_t^k$ to be offered at price $\\lambda_{t}^{\\max} - d_t^k$. For each period $t \\in T$, the merging of prices and generation volumes for all the iterations $k \\in K$ defines a non-decreasing offering curve.\n\\end{enumerate}\n\n\\noindent\nIn the next paragraphs, we review the Bar-Con approach highlighting its limits, which may severely reduce the advantages of using it in practice. We first show by a few simple observations that the robust counterpart can be greatly simplified. Specifically, we show that: i) the variables $y_t$, $t \\in T$ and the constraints $\\eqref{linkingConstraints-BarCon}$ are not necessary in the robust counterpart; ii) the robust counterpart can be just defined as a modified version of the original problem EOP-MIP and the robust auxiliary variables $q_t$, $z$ are actually not necessary.\nSecondly, we show that offering curves defined according to the Bar-Con method may lead to infeasible and suboptimal accepted offers.\n\n\nLast but not least, we note that this approach provides for building stepwise offering curves with a high number of steps and would thus result not adequate for many markets, where the number of steps that define a curve is bounded (for example, in the day ahead Italian Energy Market the limit is 4, see \\cite{GME_website}).\n\n\n\\subsection{Reducing the size of the robust counterpart}\n\\label{subsec:reducingSize}\n\nAs first step of our review of Bar-Con, we show that the robust counterpart does not need the auxiliary variables $y_t$ and the additional constraints linking $y_t$ and $p_t$. We show this referring to the canonical passages used in \\cite{BeSi04} to get the $\\Gamma$-robust counterpart of an optimization problem.\nWe first rewrite the robust version of EOP-MIP at iteration $k$ as:\n\n\n", "itemtype": "equation", "pos": 20443, "prevtext": "\n\n\\noindent\nwhere:\n\n\\begin{itemize}\n  \\item $T$ is the set of time periods - as in \\cite{BaCo11}, we consider hours in a day, so we have $T = \\{1,2,\\ldots,24\\}$;\n  \\item $p = (p_1, p_2, \\ldots, p_{|T|}) \\in \\mathbb{R}^{|T|}_+$ is a non-negative decision vector, which includes one variable $p_{t} \\geq 0$\n\t    for each period $t \\in T$ to represent the energy offered in $t$;\n  \\item $\\lambda_{t}$ is the realized market price in period $t \\in T$;\n  \\item $c_t(p_{t})$ is the cost of generating $p_{t}$ in period $t \\in T$, possibly including the so called \\emph{Start Up Costs} (SUC);\n  \\item $P$ is the feasible set of solutions of the problem, containing all vectors $p$ that satisfy the technical constraints of the unit,\n\t\t\t\tnamely minimum and maximum generation output, ramp limits and minimum up and down time.\n\t\t\t\tWe provide a complete description of $P$ in Appendix \\ref{sec:appendixRefForm}.\n        \n\\end{itemize}\n\n\n\n\n\n\n\\noindent\n\\textbf{Remark.}\nIn Appendix \\ref{sec:appendixRefForm}, we model the cost function $c_t(p_{t})$ as a quadratic function. In our case, EOP-MIP thus becomes a \\emph{Mixed Integer Quadratic Programming (MIQP) problem}.\n\nWe note that in literature it is also common to adopt piecewise linear approximations of the quadratic cost function, as done, for example, in \\cite{BaCo11}, thus making EOP-MIP a \\emph{Mixed Integer Linear Programming} (MILP) problem.\n\\\\\n\nWe stress that all the considerations that we make in the next section about defining a robust counterpart for the MIQP version of EOP can be immediately extended to the piecewise linear version considered in \\cite{BaCo11}.\n\n\n\\smallskip\n\\noindent\nIn the next section, we discuss how to consider the uncertainty of market price in the EOP and we detail a revised and refined robust optimization method that overcomes the limits of the Bar-Con.\n\n\n\n\n\\section{A review of the Baringo-Conejo robust offering approach}\n\\label{sec:BarCon}\n\n\nIn this section, we review the Bar-Con robust optimization-based method and we point out how its computational efficiency can be improved by reducing the size of the robust counterpart. Furthermore, we illustrate how offering curves built according to Bar-Con can lead to suboptimal and even infeasible accepted offers. As first step, we review basic concepts from Robust Optimization and $\\Gamma$-Robsutness.\n\n\\subsection{A concise introduction to Robust Optimization}\n\nUntil this section, we have considered a \\emph{deterministic} version of the EOP where we have assumed that the market prices $\\lambda_{t}$, $\\forall t \\in T$ are exactly known when the problem is solved. However, this assumption does not hold in practice: in competitive energy markets, the hourly prices result from the combination of demands and offers whose precise values are not known in advance. The prices $\\lambda_{t}$ are thus \\emph{uncertain}, i.e. their values are not deterministically known when the EOP is solved, and the price-taker commonly possesses just an estimate of them (e.g., an average value derived from historical market price data, or some other form of prediction).\n\nThe presence of uncertain data in the EOP is very tricky:\nthe price-taker could solve the EOP-MIP referring to the estimates of hourly prices, thus getting solutions that are optimal with respect to such estimates; however, the estimates will be in general (sensibly) different from the actual prices occurring in the market, so that supposedly optimal solutions may reveal to be \\emph{heavily sub-optimal}. This fact can be clarified by a simple consideration: if we solve the EOP-MIP using estimates of values $\\bar{\\lambda}_{t}$ lower than the actual market prices, then we generate less energy than it would be ideal with the real prices, obtaining a lower profit. On the other hand, if we overestimate the actual market prices, we could turn on generation units and generate energy when it is not convenient to do so, facing overproduction and losses.\n\nMore in general, the presence of data uncertainty is a source of issues in any optimization problem and neglecting it is well known to have very bad consequences: as we have exemplified above, solutions supposed to be optimal may turn out to be heavily suboptimal and, even worse, solutions supposed to be feasible may instead reveal to violate feasibility constraints, thus resulting in decisions that cannot be implemented in practice. For an exhaustive introduction to the issues arising in optimization under data uncertainty, we refer the reader to the book \\cite{BeElNe09}.\n\n\nIn the last decade, RO has known a wide success as a modern methodology to manage data uncertainty in optimization problems, thanks especially to its accessibility and computational tractability. We refer the reader to \\cite{BeElNe09} and \\cite{BeBrCa11} for an exhaustive introduction to theory and applications of RO.\n\\\\\nRO is essentially based on the following principles:\n\n\\begin{itemize}\n    \\item the \\emph{actual value} of an uncertain coefficient of the problem is unknown. However, the decision maker is supposed to possess a reasonable reference for the unknown actual value. This reference is called \\emph{nominal value} and could be, for example, the expected value of a random variable. The actual value equals the sum of the nominal value and of an unknown deviation;\n  \\item the decision maker defines an \\emph{uncertainty set}. This set characterizes the deviations of coefficients w.r.t. their nominal values, against which the decision maker wants to be protected;\n  \\item the decision maker derives and solves a \\emph{robust counterpart} of its problem: this is a modified version of the original optimization problem that only considers robust feasible solutions, i.e. feasible solutions that are protected against all the deviations of the uncertainty set.\n      An \\emph{optimal robust solution} is a feasible solution\n      granting the best objective value under the worst data deviations;\n  \\item protection against deviations comes at a cost: the so-called \\emph{price of robustness} \\cite{BeSi04}. This is a deterioration in the optimal value of a problem that the decision maker must face in order to ensure protection. Uncertainty sets granting higher protection entail in general a higher price of robustness.\n\\end{itemize}\n\n\\noindent\nOver the years, many models have been proposed to represent uncertainty sets in RO (see \\cite{BeBrCa11} for an overview). Among them, one of the most successful has been the $\\Gamma$-Robustness model (\\emph{$\\Gamma$-Rob}) proposed by Bertsimas and Sim \\cite{BeSi04}, which has been also adopted in Bar-Con. We  thoroughly review the adaption of $\\Gamma$-Rob in Bar-Con in the next subsection.\nHere, we just recall the essence of this classical and widely used robust optimization model. Given an uncertain constraint of the problem including $n$ uncertain coefficients of which we know the nominal value and the maximum deviation w.r.t. the nominal value, $\\Gamma$-Rob provides for an elegant theory to define a robust counterpart for an uncertainty set imposing full protection against at most $0 \\leq \\Gamma \\leq n$ coefficients deviating from their nominal value. The  $\\Gamma$-Rob counterpart has the desirable property of entailing a ``contained'' increase in the number of constraints and variables of the problems (more formally, the counterpart is \\emph{compact}) and of maintaining the features of the original problem (e.g., an uncertain MILP problem has a MILP $\\Gamma$-Rob counterpart, whereas an uncertain MIQP has a MIQP $\\Gamma$-Rob counterpart).\n\nThe parameter $\\Gamma$ controls the robustness: for $\\Gamma=0$ no protection is imposed and no price of robustness occurs; for increasing $\\Gamma$, the protection and the price of robustness increase, until for $\\Gamma=n$ the highest protection is reached.  This informal description is detailed in the next paragraph with reference to the EOP.\n\n\n\\subsection{The Robust Optimization approach by Baringo and Conejo}\n\\label{SubSect:BaringoConejoApproach}\n\nIn this section, we provide a description of the main features of the Bar-Con, which are relevant to highlight its limits and derive our improved method. For a full description of the method, we refer the reader to \\cite{BaCo11}. The Bar-Con assumes that in every hour $t \\in T$ the actual market price $\\lambda_{t}$ lies in a known range, i.e. $\\lambda_{t} \\in [\\lambda_{t}^{\\min}, \\lambda_{t}^{\\max}]$, and a-priori defines an elementary market price shortfall equal to $\\delta \\hspace{0.05cm} (\\lambda_{t}^{\\max} - \\lambda_{t}^{\\min})$ with $0 \\leq \\delta \\leq 1$. Then, it proposes to compute the hourly offering curves by solving a sequence of $1,\\ldots, K$ robust counterparts of the original problem and in the generic k-th robust counterpart:\n\n\\begin{enumerate}\n  \\item the market price in each hour is supposed to lie in the interval\n    \n", "index": 3, "text": "$$[\\lambda_{t}^{\\max} - d_{t}^k, \\hspace{0.2cm} \\lambda_{t}^{\\max}]\n    $$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"[\\lambda_{t}^{\\max}-d_{t}^{k},\\hskip 5.690551pt\\lambda_{t}^{\\max}]\" display=\"block\"><mrow><mo stretchy=\"false\">[</mo><mrow><msubsup><mi>\u03bb</mi><mi>t</mi><mi>max</mi></msubsup><mo>-</mo><msubsup><mi>d</mi><mi>t</mi><mi>k</mi></msubsup></mrow><mo rspace=\"8.2pt\">,</mo><msubsup><mi>\u03bb</mi><mi>t</mi><mi>max</mi></msubsup><mo stretchy=\"false\">]</mo></mrow></math>", "type": "latex"}, {"file": "1601.01728.tex", "nexttext": "\n\n\\noindent\nwhere the additional term $- DEV_k (\\Gamma,p)$ represent the worst reduction that the objective function may experience. Such term is defined for a power vector $p$, when at most $\\Gamma$ hourly prices deviate from their reference value $\\lambda_t$ at iteration $k$. The value $DEV_k (\\Gamma,p)$ corresponds to the optimal value of the following binary program:\n\n\n", "itemtype": "equation", "pos": 23618, "prevtext": "\n    where $d_{t}^k = G^k  (\\lambda_{t}^{\\max} - \\lambda_{t}^{\\min}) =  (k - 1) [\\delta (\\lambda_{t}^{\\max} - \\lambda_{t}^{\\min})]$ is the \\emph{maximum price deviation} in $t$ at iteration $k$. Such deviation\n\ncauses the overall deviation interval $[\\lambda_{t}^{\\max} - d_{t}^k, \\hspace{0.1cm} \\lambda_{t}^{\\max}]$ to become wider as the iteration $k$ increases. We remark that \\cite{BaCo11} just refers to the coefficient $G^k$ and does not use its equivalent form $(k - 1) \\delta$ that we adopt here to highlight the role of the iteration index $k$ in the product;\n\n  \\item data uncertainty in the problem is modelled through $\\Gamma$-Robustness and\n  the k-th robust counterpart has the following form:\n  \n\\begin{eqnarray}\n\\max\n&&\n\\sum_{t \\in T} \\left[ \\lambda_{t}^{\\max} p_{t} - c_{t} (p_{t}) \\right] - \\Gamma z - \\sum_{t \\in T} q_{t}\n\\nonumber\n\\\\\n&&\nz + q_{t} \\geq d_{t}^k y_{t}\n\\hspace{0.70cm}\nt \\in T\n\\nonumber\n\\\\\n&&\nz \\geq 0\n\\nonumber\n\\\\\n&&\nq_{t} \\geq 0\n\\hspace{1.80cm}\nt \\in T\n\\nonumber\n\\\\\n&&\np_{t} \\leq y_{t}\n\\hspace{1.65cm}\nt \\in T\n\\label{linkingConstraints-BarCon}\n\\\\\n&&\np \\in P\n\n\n\\nonumber\n\\end{eqnarray}\n\nwith $\\Gamma$ set equal to the number of periods $|T|$.\n\n\\item offering curves for each period are built merging the $K$ optimal robust solutions: the optimal robust solution of the k-th counterpart specifies the generation output $p_t^k$ to be offered at price $\\lambda_{t}^{\\max} - d_t^k$. For each period $t \\in T$, the merging of prices and generation volumes for all the iterations $k \\in K$ defines a non-decreasing offering curve.\n\\end{enumerate}\n\n\\noindent\nIn the next paragraphs, we review the Bar-Con approach highlighting its limits, which may severely reduce the advantages of using it in practice. We first show by a few simple observations that the robust counterpart can be greatly simplified. Specifically, we show that: i) the variables $y_t$, $t \\in T$ and the constraints $\\eqref{linkingConstraints-BarCon}$ are not necessary in the robust counterpart; ii) the robust counterpart can be just defined as a modified version of the original problem EOP-MIP and the robust auxiliary variables $q_t$, $z$ are actually not necessary.\nSecondly, we show that offering curves defined according to the Bar-Con method may lead to infeasible and suboptimal accepted offers.\n\n\nLast but not least, we note that this approach provides for building stepwise offering curves with a high number of steps and would thus result not adequate for many markets, where the number of steps that define a curve is bounded (for example, in the day ahead Italian Energy Market the limit is 4, see \\cite{GME_website}).\n\n\n\\subsection{Reducing the size of the robust counterpart}\n\\label{subsec:reducingSize}\n\nAs first step of our review of Bar-Con, we show that the robust counterpart does not need the auxiliary variables $y_t$ and the additional constraints linking $y_t$ and $p_t$. We show this referring to the canonical passages used in \\cite{BeSi04} to get the $\\Gamma$-robust counterpart of an optimization problem.\nWe first rewrite the robust version of EOP-MIP at iteration $k$ as:\n\n\n", "index": 5, "text": "\\begin{align}\n\\max\n&\n\\sum_{t \\in T} \\left[ \\lambda_{t}^{\\max} p_{t} - c_{t} (p_{t}) \\right] - DEV_k (\\Gamma,p)\n&&\n\\nonumber\n\\\\\n&\np \\in P\n&&\n\\nonumber\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\max\" display=\"inline\"><mi>max</mi></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\sum_{t\\in T}\\left[\\lambda_{t}^{\\max}p_{t}-c_{t}(p_{t})\\right]-%&#10;DEV_{k}(\\Gamma,p)\" display=\"inline\"><mrow><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>t</mi><mo>\u2208</mo><mi>T</mi></mrow></munder></mstyle><mrow><mo>[</mo><mrow><mrow><msubsup><mi>\u03bb</mi><mi>t</mi><mi>max</mi></msubsup><mo>\u2062</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo>-</mo><mrow><msub><mi>c</mi><mi>t</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>p</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>]</mo></mrow></mrow><mo>-</mo><mrow><mi>D</mi><mo>\u2062</mo><mi>E</mi><mo>\u2062</mo><msub><mi>V</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">\u0393</mi><mo>,</mo><mi>p</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle p\\in P\" display=\"inline\"><mrow><mi>p</mi><mo>\u2208</mo><mi>P</mi></mrow></math>", "type": "latex"}, {"file": "1601.01728.tex", "nexttext": "\n\nIn this problem, 1) a binary variable $w_{t}$ is equal to 1 if the price in hour $t$ deviates from its nominal value and experiences the worst deviation $d_{t}^k p_{t}$, whereas it is equal to 0 otherwise; 2) the single constraint imposes an upper bound $0 \\leq \\Gamma \\leq |T|$ on the number of hours whose prices may deviate; 3) the objective function maximizes the deviation from the nominal value for a given output $p_t$, $t \\in T$.\n\nThe robust version of EOP-MIP with $DEV_k (\\Gamma,p)$ presents an inner maximization problem which includes the products $p_{t} \\hspace{0.1cm} w_{t}$ of decision variables. However, this is not a real issue since, as proved in \\cite{BeSi04}, such non-linearities can be linearized leading to a compact robust counterpart.\n\nFirst, we note that for a fixed vector $p_t$, the value $DEV_k (\\Gamma,p)$  is equal to the optimal value of its \\emph{linear relaxation}:\n\n\n", "itemtype": "equation", "pos": 24154, "prevtext": "\n\n\\noindent\nwhere the additional term $- DEV_k (\\Gamma,p)$ represent the worst reduction that the objective function may experience. Such term is defined for a power vector $p$, when at most $\\Gamma$ hourly prices deviate from their reference value $\\lambda_t$ at iteration $k$. The value $DEV_k (\\Gamma,p)$ corresponds to the optimal value of the following binary program:\n\n\n", "index": 7, "text": "\\begin{align}\nDEV_k (\\Gamma,p) = \\max\n&\n\\sum_{t \\in T} (d_{t}^k p_{t}) \\hspace{0.1cm} w_{t}\n&&\n\\nonumber\n\\\\\n&\n\\sum_{t \\in T } w_{t} \\leq \\Gamma\n&&\n\\nonumber\n\\\\\n&\nw_{t} \\in \\{0,1\\}\n&&\nt \\in T \\; .\n\\nonumber\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex6.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle DEV_{k}(\\Gamma,p)=\\max\" display=\"inline\"><mrow><mrow><mi>D</mi><mo>\u2062</mo><mi>E</mi><mo>\u2062</mo><msub><mi>V</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">\u0393</mi><mo>,</mo><mi>p</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mi>max</mi></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex6.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\sum_{t\\in T}(d_{t}^{k}p_{t})\\hskip 2.845276ptw_{t}\" display=\"inline\"><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>t</mi><mo>\u2208</mo><mi>T</mi></mrow></munder></mstyle><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msubsup><mi>d</mi><mi>t</mi><mi>k</mi></msubsup><mo>\u2062</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo rspace=\"5.3pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>w</mi><mi>t</mi></msub></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex7.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\sum_{t\\in T}w_{t}\\leq\\Gamma\" display=\"inline\"><mrow><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>t</mi><mo>\u2208</mo><mi>T</mi></mrow></munder></mstyle><msub><mi>w</mi><mi>t</mi></msub></mrow><mo>\u2264</mo><mi mathvariant=\"normal\">\u0393</mi></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex8.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle w_{t}\\in\\{0,1\\}\" display=\"inline\"><mrow><msub><mi>w</mi><mi>t</mi></msub><mo>\u2208</mo><mrow><mo stretchy=\"false\">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">}</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex8.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle t\\in T\\;.\" display=\"inline\"><mrow><mrow><mi>t</mi><mo>\u2208</mo><mpadded width=\"+2.8pt\"><mi>T</mi></mpadded></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01728.tex", "nexttext": "\n\n\\noindent\nWe can then define the \\emph{dual problem} of the previous linear program, i.e.:\n\n\n", "itemtype": "equation", "pos": 25275, "prevtext": "\n\nIn this problem, 1) a binary variable $w_{t}$ is equal to 1 if the price in hour $t$ deviates from its nominal value and experiences the worst deviation $d_{t}^k p_{t}$, whereas it is equal to 0 otherwise; 2) the single constraint imposes an upper bound $0 \\leq \\Gamma \\leq |T|$ on the number of hours whose prices may deviate; 3) the objective function maximizes the deviation from the nominal value for a given output $p_t$, $t \\in T$.\n\nThe robust version of EOP-MIP with $DEV_k (\\Gamma,p)$ presents an inner maximization problem which includes the products $p_{t} \\hspace{0.1cm} w_{t}$ of decision variables. However, this is not a real issue since, as proved in \\cite{BeSi04}, such non-linearities can be linearized leading to a compact robust counterpart.\n\nFirst, we note that for a fixed vector $p_t$, the value $DEV_k (\\Gamma,p)$  is equal to the optimal value of its \\emph{linear relaxation}:\n\n\n", "index": 9, "text": "\\begin{align}\nDEV (\\Gamma,p) = \\max\n&\n\\sum_{t \\in T} (d_{t}^k p_{t}) \\hspace{0.1cm} w_{t}\n&&\n\\nonumber\n\\mbox{(DEV-primal)}\n\\\\\n&\n\\sum_{t \\in T } w_{t} \\leq \\Gamma\n&&\n\\nonumber\n\\\\\n&\n0 \\leq w_{t} \\leq 1\n&&\nt \\in T \\; .\n\\nonumber\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex9.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle DEV(\\Gamma,p)=\\max\" display=\"inline\"><mrow><mrow><mi>D</mi><mo>\u2062</mo><mi>E</mi><mo>\u2062</mo><mi>V</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">\u0393</mi><mo>,</mo><mi>p</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mi>max</mi></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex9.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\sum_{t\\in T}(d_{t}^{k}p_{t})\\hskip 2.845276ptw_{t}\" display=\"inline\"><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>t</mi><mo>\u2208</mo><mi>T</mi></mrow></munder></mstyle><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msubsup><mi>d</mi><mi>t</mi><mi>k</mi></msubsup><mo>\u2062</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo rspace=\"5.3pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>w</mi><mi>t</mi></msub></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex10.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\sum_{t\\in T}w_{t}\\leq\\Gamma\" display=\"inline\"><mrow><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>t</mi><mo>\u2208</mo><mi>T</mi></mrow></munder></mstyle><msub><mi>w</mi><mi>t</mi></msub></mrow><mo>\u2264</mo><mi mathvariant=\"normal\">\u0393</mi></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex11.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle 0\\leq w_{t}\\leq 1\" display=\"inline\"><mrow><mn>0</mn><mo>\u2264</mo><msub><mi>w</mi><mi>t</mi></msub><mo>\u2264</mo><mn>1</mn></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex11.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle t\\in T\\;.\" display=\"inline\"><mrow><mrow><mi>t</mi><mo>\u2208</mo><mpadded width=\"+2.8pt\"><mi>T</mi></mpadded></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01728.tex", "nexttext": "\n\n\\noindent\nSince DEV-primal is feasible and bounded, by strong duality also its dual problem DEV-dual is feasible and bounded and their optimal values coincide. We can then substitute the term $DEV_k (\\Gamma,p)$ in our original robust counterpart with the dual problem as follows:\n\n\n", "itemtype": "equation", "pos": 25606, "prevtext": "\n\n\\noindent\nWe can then define the \\emph{dual problem} of the previous linear program, i.e.:\n\n\n", "index": 11, "text": "\\begin{align}\n\\min\n\\hspace{0.2cm}\n&\n\\Gamma z + \\sum_{t \\in T} q_{t}\n&&\n\\mbox{(DEV-dual)}\n\\nonumber\n\\\\\n&\nz + q_{t} \\geq d_{t}^k p_{t}\n&&\nt \\in T\n\\nonumber\n\\\\\n&\nz \\geq 0\n&&\n\\nonumber\n\\\\\n&\nq_{t} \\geq 0\n&&\nt \\in T \\; .\n\\nonumber\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex12.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\min\" display=\"inline\"><mi>min</mi></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex12.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\Gamma z+\\sum_{t\\in T}q_{t}\" display=\"inline\"><mrow><mrow><mi mathvariant=\"normal\">\u0393</mi><mo>\u2062</mo><mi>z</mi></mrow><mo>+</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>t</mi><mo>\u2208</mo><mi>T</mi></mrow></munder></mstyle><msub><mi>q</mi><mi>t</mi></msub></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex13.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle z+q_{t}\\geq d_{t}^{k}p_{t}\" display=\"inline\"><mrow><mrow><mi>z</mi><mo>+</mo><msub><mi>q</mi><mi>t</mi></msub></mrow><mo>\u2265</mo><mrow><msubsup><mi>d</mi><mi>t</mi><mi>k</mi></msubsup><mo>\u2062</mo><msub><mi>p</mi><mi>t</mi></msub></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex13.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle t\\in T\" display=\"inline\"><mrow><mi>t</mi><mo>\u2208</mo><mi>T</mi></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex14.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle z\\geq 0\" display=\"inline\"><mrow><mi>z</mi><mo>\u2265</mo><mn>0</mn></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex15.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle q_{t}\\geq 0\" display=\"inline\"><mrow><msub><mi>q</mi><mi>t</mi></msub><mo>\u2265</mo><mn>0</mn></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex15.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle t\\in T\\;.\" display=\"inline\"><mrow><mrow><mi>t</mi><mo>\u2208</mo><mpadded width=\"+2.8pt\"><mi>T</mi></mpadded></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01728.tex", "nexttext": "\n\nIn contrast to the first robust counterpart including the term $DEV (\\Gamma,p)$, this robust counterpart does not include the inner maximization problem and the product of variables. Additionally, the increase in size due to the presence of the additional dualization variables and constraints (\\ref{Rob-EOP_dualCnstr}-\\ref{Rob-EOP_dualVar2}) is ``contained'': the formulation is indeed \\emph{compact}, i.e. its size is polynomial in the size of the input.\n\nWe emphasize that the adopted dualization procedure is nothing but the standard one associated with $\\Gamma$-Rob and proposed in \\cite{BeSi04}. As evident, it does not need the presence of the auxiliary variables $y_{t}$ and of the constraints $p_t \\leq y_t$. The size of the robust counterpart is thus reduced by eliminating $|T|$ constraints and $|T|$ decision variables. The elimination of these variables ancd constraints represents  an advantage for solving the problem for any commercial optimization solver.\n\n\nTo conclude, we note that when EOP-MIP includes a quadratic cost function and is thus an MIQP, Rob-EOP is an MIQP, whereas when EOP-MIP includes a piecewise linear cost function and is thus an MILP, Rob-EOP is an MILP.\n\n\n\n\n\\subsection{Full robustness as a cost-modified nominal problem}\n\\label{subsec:fullRobustness}\n\nThe linear and compact robust counterpart Rob-EOP depends upon the parameter $\\Gamma$, which indicates the number of price coefficients against the deviation of which the decision maker wants to be protected. In the case of EOP, $\\Gamma$ corresponds with daily hours and can range from 0 to 24.\nWhen $\\Gamma \\in \\{ 1, \\ldots, 23\\}$, a robust optimal solution can be obtained by solving Rob-EOP.\nWhen instead $\\Gamma = 0$ or $\\Gamma = 24$, we are considering extreme cases: if $\\Gamma = 0$, then no hourly price is assumed to deviate, there is no protection, and we get the original deterministic problem; in contrast, if $\\Gamma = 24$, then all the coefficients are assumed to deviate, we get full protection, and we do not need to solve Rob-EOP. Here, we stress that it is indeed just sufficient to consider the following problem:\n\n\n", "itemtype": "equation", "pos": 26125, "prevtext": "\n\n\\noindent\nSince DEV-primal is feasible and bounded, by strong duality also its dual problem DEV-dual is feasible and bounded and their optimal values coincide. We can then substitute the term $DEV_k (\\Gamma,p)$ in our original robust counterpart with the dual problem as follows:\n\n\n", "index": 13, "text": "\\begin{align}\n\\max\n&\n\\sum_{t \\in T} \\left[ \\lambda_{t}^{\\max} p_{t} - c_{t} (p_{t}) \\right] - \\Gamma z - \\sum_{t \\in T} q_{t}\n&&\n\\mbox{(Rob-EOP)}\n\\nonumber\n\\\\\n&\nz + q_{t} \\geq d_{t}^k p_{t}\n&&\nt \\in T\n\\label{Rob-EOP_dualCnstr}\n\\\\\n&\nz \\geq 0\n&&\n\\label{Rob-EOP_dualVar1}\n\\\\\n&\nq_{t} \\geq 0\n&&\nt \\in T\n\\label{Rob-EOP_dualVar2}\n\\\\\n&\np \\in P \\; .\n&&\n\\nonumber\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex16.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\max\" display=\"inline\"><mi>max</mi></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex16.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\sum_{t\\in T}\\left[\\lambda_{t}^{\\max}p_{t}-c_{t}(p_{t})\\right]-%&#10;\\Gamma z-\\sum_{t\\in T}q_{t}\" display=\"inline\"><mrow><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>t</mi><mo>\u2208</mo><mi>T</mi></mrow></munder></mstyle><mrow><mo>[</mo><mrow><mrow><msubsup><mi>\u03bb</mi><mi>t</mi><mi>max</mi></msubsup><mo>\u2062</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo>-</mo><mrow><msub><mi>c</mi><mi>t</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>p</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>]</mo></mrow></mrow><mo>-</mo><mrow><mi mathvariant=\"normal\">\u0393</mi><mo>\u2062</mo><mi>z</mi></mrow><mo>-</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>t</mi><mo>\u2208</mo><mi>T</mi></mrow></munder></mstyle><msub><mi>q</mi><mi>t</mi></msub></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle z+q_{t}\\geq d_{t}^{k}p_{t}\" display=\"inline\"><mrow><mrow><mi>z</mi><mo>+</mo><msub><mi>q</mi><mi>t</mi></msub></mrow><mo>\u2265</mo><mrow><msubsup><mi>d</mi><mi>t</mi><mi>k</mi></msubsup><mo>\u2062</mo><msub><mi>p</mi><mi>t</mi></msub></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle t\\in T\" display=\"inline\"><mrow><mi>t</mi><mo>\u2208</mo><mi>T</mi></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle z\\geq 0\" display=\"inline\"><mrow><mi>z</mi><mo>\u2265</mo><mn>0</mn></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle q_{t}\\geq 0\" display=\"inline\"><mrow><msub><mi>q</mi><mi>t</mi></msub><mo>\u2265</mo><mn>0</mn></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle t\\in T\" display=\"inline\"><mrow><mi>t</mi><mo>\u2208</mo><mi>T</mi></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex17.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle p\\in P\\;.\" display=\"inline\"><mrow><mrow><mi>p</mi><mo>\u2208</mo><mpadded width=\"+2.8pt\"><mi>P</mi></mpadded></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01728.tex", "nexttext": "\n\n\\noindent\nwhich is a version of EOP that considers the worst price $\\lambda_{t}^{\\max} - d_{t}^k$ that  may occur at iteration $k$ in every hour. Since Bar-Con imposes $\\Gamma = 24$ in each of the $k$ robust counterparts (see the algorithm flowchart of Figure 2 in \\cite{BaCo11}), then the use of the dualization procedure of $\\Gamma$-Rob can be completely avoided. The worst-case robust counterpart Worst-EOP thus eliminates the need for the dualization variables and constraints (\\ref{Rob-EOP_dualCnstr}-\\ref{Rob-EOP_dualVar2}), reducing the size of the counterpart by $|T|+1$ variables and $|T|$ constraints. This has the effect of improving the efficiency of the branch-and-cut-based solution process implemented by commercial optimization solvers.\n\n\n\\subsection{Risk of building offering curves leading to infeasible and suboptimal offers}\n\\label{subsec:riskInfeasibilitySuboptimality}\n\nThe offering curves built according to Bar-Con are obtained merging $K > 0$ robust optimal solutions obtained for $K$ distinct configurations of the prices over the 24-hour horizon, as we explained in Section \\ref{SubSect:BaringoConejoApproach}.\n\nMerging optimal solutions concretely exposes the generating company to the risk of building offering curves that may result into \\emph{infeasible} and\n\\emph{suboptimal} accepted offers. We illustrate this fact by a simple realistic example, defined with our industrial partners.\n\n\\smallskip\n\\noindent\n\\textbf{Example 1}. We consider the status and the output of a generation unit in a time interval made up of 3 consecutive hours that we conventionally denote by indices $t = 1,2,3$, assuming that in an initial reference hour $t = 0$ the unit is off and the  output is null (i.e., $p_0 = 0$). The generation unit has a minimum power output of 160 MW and a capacity of 440 MW with a startup ramp limit of 160 MW/h and ramp-up limit of 55 MW/h. The production cost is expressed by a quadratic function of the power output that ranges from a value of 8768 EUR for the minimum output\n\nto 25848 EUR for the maximum output.\n\n\nReferring to real prices of the Italian energy market, we assume that the maximum price observed in the 3 hours are $\\lambda^{\\max}_1 = 54$, $\\lambda^{\\max}_2 = 55$, $\\lambda^{\\max}_3 = 61$ (in EUR/MWh). These prices define a market price configuration that we denote by C1. Following the approach Bar-Con, from C1 we can define two other price configurations C2 and C3, by reducing the prices of C1 by 1 and 2 EUR respectively (see Table \\ref{table:prices})\n\nWe then solve the robust counterpart Worst-EOP corresponding with full protection $\\Gamma = 24$, obtaining the robust optimal outputs shown in Table \\ref{table:output}. While for the maximum price configuration C1, the optimal choice is to ramp up to the maximum in each period, when the prices decrease it is instead optimal to keep turned off the unit for an increasing number of hours: for C2, the unit is kept off in hour 1, whereas for C3 it is kept off in hours 1 and 2.\nFollowing Bar-Con, the robust optimal solution leads to the definition of the hourly offering curves shown in Table \\ref{table:offeringCurves}, where each curve is actually a 3-step function with each step associated with a pair (price, offered output).\n\n\\begin{table}\n\\caption{Hourly price configurations}\n\\label{table:prices}\n\\small\n\\begin{center}\n\\begin{tabular}{c c c c}\n\\hline\nConfiguration  & $\\lambda_1$ \t& $\\lambda_2$ & $\\lambda_3$\n\\\\ [2pt]\n\\hline\nC1 \t&  \t54\t&  \t55\t& \t61\\\\\nC2 \t&  \t53\t&  \t54\t& \t60\\\\\nC3 \t&  \t52\t&  \t53\t& \t59\\\\\n\\hline\n\\end{tabular}\n\\end{center}\n\\end{table}\n\n\\begin{table}\n\\caption{Robust optimal output and profit for each price configuration}\n\\label{table:output}\n\\small\n\\begin{center}\n\\begin{tabular}{c c c c c}\n\\hline\nConfiguration  & $p_1$ \t& $p_2$ & $p_3$ & Total profit\n\\\\ [2pt]\n\\hline\nC1 \t&  \t160\t&  \t215\t& \t270 & 1498\\\\\nC2 \t&  \t0\t&  \t160\t& \t215 & 1020\\\\\nC3 \t&  \t0\t&  \t0\t& \t160 & 672\\\\\n\\hline\n\\end{tabular}\n\\end{center}\n\\end{table}\n\n\n\\begin{table}\n\\caption{Hourly offering curves}\n\\label{table:offeringCurves}\n\\small\n\\begin{center}\n\\begin{tabular}{c c c c}\n\\hline\nt  & Step 1 & Step 2 & Step 3\n\\\\ [2pt]\n\\hline\n1 \t&  \t(0, 52)\t&  \t(0, 53)\t&  (160, 54)\\\\\n2 \t&  \t(0, 53)\t&  \t(160, 54)\t& (215, 55)\\\\\n3 \t&  \t(160, 59)\t&  \t(215, 60)\t& (270, 61)\\\\\n\\hline\n\\end{tabular}\n\\end{center}\n\\end{table}\n\n\nSince the price-taker specifies the minimum selling price for a given quantity, it may happen that offering curves will not be (entirely) accepted, thus leading to generation plans that violate the ramp constraints over consecutive hours. Referring to Table \\ref{table:offeringCurves}, this happens, for example, if the actual price occurring in the three hours are $52$, $53$ and $61$, respectively: in this case, in hour t=1 and t=2 the market operator ``accepts'' the 0 quantity offers of the price-taker, while in hour t=3 it accepts the offer equal to 270 MWh. Since the unit of the price taker cannot ramp from 0 to 270 in 1 hour, the offering is evidently infeasible in practice.\n\nAnother issue with Bar-Con is represented by the risk of suboptimality of offering. This issue again derives from the fact that Bar-Con provides for specifying a minimum price that is requested to sell a specific output. To illustrate the risk of suboptimality, we suppose that the actual prices occurring in the three hours are $54$, $53$, and $59$: the accepted offers of the price-taker are in this case $(160, 0, 160)$. This solution is feasible w.r.t. the ramp constraints. However, it is associated with a total profit of 544 EUR, that is sensibly lower than the optimal profit of 672 EUR that would be obtained for the optimal production equal to (0, 0, 160). In this case, the suboptimality derives from turning on the unit\nin $t=1$, action that would not be taken in an optimal solution. \n\n\n\n\n\\section{A revised $\\Gamma$-robustness approach for energy offering}\n\\label{sec:revisedOffering}\n\n\nIn this section, we illustrate our new method for energy offering, which tackles the drawbacks of Bar-Con that we have highlighted previously. Our method presents three main advantages:\n\n\\begin{enumerate}\n  \\item it properly manages the risk of defining offers that are not accepted in the market;\n  \\item it tackles the issue of defining offering curves that result into infeasible and suboptimal accepted offers;\n  \\item it is in line with the spirit of Robust Optimization and $\\Gamma$-Robustness, according to which full protection (i.e., $\\Gamma = 24$ as in Bar-Con) should be avoided (see \\cite{BeElNe09,BeBrCa11}); computationally,  our method indicates that intermediate protection (i.e., $0 < \\Gamma < 24$) guarantees higher profits.\n\\end{enumerate}\n\n\\noindent\nTo achieve this, we propose three strategies unified in a new robust optimization method: \n\n\\begin{enumerate}\n  \\item all our offers are made at \\emph{zero price} (i.e., we do not require a minimum positive price for selling energy), so that the offers will be always less or equal than the market clearing price (under the assumption that we operate in an energy market where negative prices are not allowed and the lowest feasible price is 0 -  such as in the Italian Energy Market \\cite{GME_website}). The risk of non acceptance bidding at zero price thus becomes negligible;\n  \\item we compute a single $\\Gamma$-robust optimal solution referring to one single price configuration derived from historical data. So we avoid the infeasibility and suboptimality issues associated with merging distinct robust optimal solutions obtained for multiple price configurations;\n  \\item we define the single robust optimal solution by solving the robust counterpart with $\\Gamma$ such that $0 < \\Gamma < 24$, so to avoid the excessive conservatism associated with full protection.\n\\end{enumerate}\n\nThe robust counterpart that we adopt differs from that of Bar-Con concerning the nominal prices and the worst price deviations used in it, which we define by using realizations of the market price occurred in previous days. To this end, we suppose that for each $t \\in T$ we have a number $I>0$ of observed past realizations of the price $\\lambda_t^{i}$ with $i = 1,\\ldots,I$. Without loss of generality, we assume that these values are sorted in non-decreasing order, i.e. $\\lambda_t^{i} \\leq \\lambda_t^{i+1}$ for $i = 1,\\ldots,I-1$. The assumption of possessing past price realizations is fully realistic, since hourly prices are typically promptly disclosed by the market operator.\nUsing these past realizations, we define:\n\n\\begin{itemize}\n  \\item the \\emph{nominal price} $\\lambda_t^{\\text{NOM}}$ for each $t \\in T$ as the average value of past observations in $t$, namely:\n      \n", "itemtype": "equation", "pos": 28618, "prevtext": "\n\nIn contrast to the first robust counterpart including the term $DEV (\\Gamma,p)$, this robust counterpart does not include the inner maximization problem and the product of variables. Additionally, the increase in size due to the presence of the additional dualization variables and constraints (\\ref{Rob-EOP_dualCnstr}-\\ref{Rob-EOP_dualVar2}) is ``contained'': the formulation is indeed \\emph{compact}, i.e. its size is polynomial in the size of the input.\n\nWe emphasize that the adopted dualization procedure is nothing but the standard one associated with $\\Gamma$-Rob and proposed in \\cite{BeSi04}. As evident, it does not need the presence of the auxiliary variables $y_{t}$ and of the constraints $p_t \\leq y_t$. The size of the robust counterpart is thus reduced by eliminating $|T|$ constraints and $|T|$ decision variables. The elimination of these variables ancd constraints represents  an advantage for solving the problem for any commercial optimization solver.\n\n\nTo conclude, we note that when EOP-MIP includes a quadratic cost function and is thus an MIQP, Rob-EOP is an MIQP, whereas when EOP-MIP includes a piecewise linear cost function and is thus an MILP, Rob-EOP is an MILP.\n\n\n\n\n\\subsection{Full robustness as a cost-modified nominal problem}\n\\label{subsec:fullRobustness}\n\nThe linear and compact robust counterpart Rob-EOP depends upon the parameter $\\Gamma$, which indicates the number of price coefficients against the deviation of which the decision maker wants to be protected. In the case of EOP, $\\Gamma$ corresponds with daily hours and can range from 0 to 24.\nWhen $\\Gamma \\in \\{ 1, \\ldots, 23\\}$, a robust optimal solution can be obtained by solving Rob-EOP.\nWhen instead $\\Gamma = 0$ or $\\Gamma = 24$, we are considering extreme cases: if $\\Gamma = 0$, then no hourly price is assumed to deviate, there is no protection, and we get the original deterministic problem; in contrast, if $\\Gamma = 24$, then all the coefficients are assumed to deviate, we get full protection, and we do not need to solve Rob-EOP. Here, we stress that it is indeed just sufficient to consider the following problem:\n\n\n", "index": 15, "text": "\\begin{align}\n\\max\n&\n\\sum_{t \\in T} \\left(\\lambda_{t}^{\\max} - d_{t}^k \\right) - c_{t} (p_{t})\n&&\n\\mbox{(Worst-EOP)}\n\\nonumber\n\\\\\n&\np \\in P \\; ,\n&&\n\\nonumber\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex18.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\max\" display=\"inline\"><mi>max</mi></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex18.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\sum_{t\\in T}\\left(\\lambda_{t}^{\\max}-d_{t}^{k}\\right)-c_{t}(p_{t})\" display=\"inline\"><mrow><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>t</mi><mo>\u2208</mo><mi>T</mi></mrow></munder></mstyle><mrow><mo>(</mo><mrow><msubsup><mi>\u03bb</mi><mi>t</mi><mi>max</mi></msubsup><mo>-</mo><msubsup><mi>d</mi><mi>t</mi><mi>k</mi></msubsup></mrow><mo>)</mo></mrow></mrow><mo>-</mo><mrow><msub><mi>c</mi><mi>t</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>p</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex19.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle p\\in P\\;,\" display=\"inline\"><mrow><mrow><mi>p</mi><mo>\u2208</mo><mpadded width=\"+2.8pt\"><mi>P</mi></mpadded></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01728.tex", "nexttext": "\n  \\item the \\emph{worst deviation} $d_t$ used in each $t \\in T$ as the difference\n      \n", "itemtype": "equation", "pos": 37438, "prevtext": "\n\n\\noindent\nwhich is a version of EOP that considers the worst price $\\lambda_{t}^{\\max} - d_{t}^k$ that  may occur at iteration $k$ in every hour. Since Bar-Con imposes $\\Gamma = 24$ in each of the $k$ robust counterparts (see the algorithm flowchart of Figure 2 in \\cite{BaCo11}), then the use of the dualization procedure of $\\Gamma$-Rob can be completely avoided. The worst-case robust counterpart Worst-EOP thus eliminates the need for the dualization variables and constraints (\\ref{Rob-EOP_dualCnstr}-\\ref{Rob-EOP_dualVar2}), reducing the size of the counterpart by $|T|+1$ variables and $|T|$ constraints. This has the effect of improving the efficiency of the branch-and-cut-based solution process implemented by commercial optimization solvers.\n\n\n\\subsection{Risk of building offering curves leading to infeasible and suboptimal offers}\n\\label{subsec:riskInfeasibilitySuboptimality}\n\nThe offering curves built according to Bar-Con are obtained merging $K > 0$ robust optimal solutions obtained for $K$ distinct configurations of the prices over the 24-hour horizon, as we explained in Section \\ref{SubSect:BaringoConejoApproach}.\n\nMerging optimal solutions concretely exposes the generating company to the risk of building offering curves that may result into \\emph{infeasible} and\n\\emph{suboptimal} accepted offers. We illustrate this fact by a simple realistic example, defined with our industrial partners.\n\n\\smallskip\n\\noindent\n\\textbf{Example 1}. We consider the status and the output of a generation unit in a time interval made up of 3 consecutive hours that we conventionally denote by indices $t = 1,2,3$, assuming that in an initial reference hour $t = 0$ the unit is off and the  output is null (i.e., $p_0 = 0$). The generation unit has a minimum power output of 160 MW and a capacity of 440 MW with a startup ramp limit of 160 MW/h and ramp-up limit of 55 MW/h. The production cost is expressed by a quadratic function of the power output that ranges from a value of 8768 EUR for the minimum output\n\nto 25848 EUR for the maximum output.\n\n\nReferring to real prices of the Italian energy market, we assume that the maximum price observed in the 3 hours are $\\lambda^{\\max}_1 = 54$, $\\lambda^{\\max}_2 = 55$, $\\lambda^{\\max}_3 = 61$ (in EUR/MWh). These prices define a market price configuration that we denote by C1. Following the approach Bar-Con, from C1 we can define two other price configurations C2 and C3, by reducing the prices of C1 by 1 and 2 EUR respectively (see Table \\ref{table:prices})\n\nWe then solve the robust counterpart Worst-EOP corresponding with full protection $\\Gamma = 24$, obtaining the robust optimal outputs shown in Table \\ref{table:output}. While for the maximum price configuration C1, the optimal choice is to ramp up to the maximum in each period, when the prices decrease it is instead optimal to keep turned off the unit for an increasing number of hours: for C2, the unit is kept off in hour 1, whereas for C3 it is kept off in hours 1 and 2.\nFollowing Bar-Con, the robust optimal solution leads to the definition of the hourly offering curves shown in Table \\ref{table:offeringCurves}, where each curve is actually a 3-step function with each step associated with a pair (price, offered output).\n\n\\begin{table}\n\\caption{Hourly price configurations}\n\\label{table:prices}\n\\small\n\\begin{center}\n\\begin{tabular}{c c c c}\n\\hline\nConfiguration  & $\\lambda_1$ \t& $\\lambda_2$ & $\\lambda_3$\n\\\\ [2pt]\n\\hline\nC1 \t&  \t54\t&  \t55\t& \t61\\\\\nC2 \t&  \t53\t&  \t54\t& \t60\\\\\nC3 \t&  \t52\t&  \t53\t& \t59\\\\\n\\hline\n\\end{tabular}\n\\end{center}\n\\end{table}\n\n\\begin{table}\n\\caption{Robust optimal output and profit for each price configuration}\n\\label{table:output}\n\\small\n\\begin{center}\n\\begin{tabular}{c c c c c}\n\\hline\nConfiguration  & $p_1$ \t& $p_2$ & $p_3$ & Total profit\n\\\\ [2pt]\n\\hline\nC1 \t&  \t160\t&  \t215\t& \t270 & 1498\\\\\nC2 \t&  \t0\t&  \t160\t& \t215 & 1020\\\\\nC3 \t&  \t0\t&  \t0\t& \t160 & 672\\\\\n\\hline\n\\end{tabular}\n\\end{center}\n\\end{table}\n\n\n\\begin{table}\n\\caption{Hourly offering curves}\n\\label{table:offeringCurves}\n\\small\n\\begin{center}\n\\begin{tabular}{c c c c}\n\\hline\nt  & Step 1 & Step 2 & Step 3\n\\\\ [2pt]\n\\hline\n1 \t&  \t(0, 52)\t&  \t(0, 53)\t&  (160, 54)\\\\\n2 \t&  \t(0, 53)\t&  \t(160, 54)\t& (215, 55)\\\\\n3 \t&  \t(160, 59)\t&  \t(215, 60)\t& (270, 61)\\\\\n\\hline\n\\end{tabular}\n\\end{center}\n\\end{table}\n\n\nSince the price-taker specifies the minimum selling price for a given quantity, it may happen that offering curves will not be (entirely) accepted, thus leading to generation plans that violate the ramp constraints over consecutive hours. Referring to Table \\ref{table:offeringCurves}, this happens, for example, if the actual price occurring in the three hours are $52$, $53$ and $61$, respectively: in this case, in hour t=1 and t=2 the market operator ``accepts'' the 0 quantity offers of the price-taker, while in hour t=3 it accepts the offer equal to 270 MWh. Since the unit of the price taker cannot ramp from 0 to 270 in 1 hour, the offering is evidently infeasible in practice.\n\nAnother issue with Bar-Con is represented by the risk of suboptimality of offering. This issue again derives from the fact that Bar-Con provides for specifying a minimum price that is requested to sell a specific output. To illustrate the risk of suboptimality, we suppose that the actual prices occurring in the three hours are $54$, $53$, and $59$: the accepted offers of the price-taker are in this case $(160, 0, 160)$. This solution is feasible w.r.t. the ramp constraints. However, it is associated with a total profit of 544 EUR, that is sensibly lower than the optimal profit of 672 EUR that would be obtained for the optimal production equal to (0, 0, 160). In this case, the suboptimality derives from turning on the unit\nin $t=1$, action that would not be taken in an optimal solution. \n\n\n\n\n\\section{A revised $\\Gamma$-robustness approach for energy offering}\n\\label{sec:revisedOffering}\n\n\nIn this section, we illustrate our new method for energy offering, which tackles the drawbacks of Bar-Con that we have highlighted previously. Our method presents three main advantages:\n\n\\begin{enumerate}\n  \\item it properly manages the risk of defining offers that are not accepted in the market;\n  \\item it tackles the issue of defining offering curves that result into infeasible and suboptimal accepted offers;\n  \\item it is in line with the spirit of Robust Optimization and $\\Gamma$-Robustness, according to which full protection (i.e., $\\Gamma = 24$ as in Bar-Con) should be avoided (see \\cite{BeElNe09,BeBrCa11}); computationally,  our method indicates that intermediate protection (i.e., $0 < \\Gamma < 24$) guarantees higher profits.\n\\end{enumerate}\n\n\\noindent\nTo achieve this, we propose three strategies unified in a new robust optimization method: \n\n\\begin{enumerate}\n  \\item all our offers are made at \\emph{zero price} (i.e., we do not require a minimum positive price for selling energy), so that the offers will be always less or equal than the market clearing price (under the assumption that we operate in an energy market where negative prices are not allowed and the lowest feasible price is 0 -  such as in the Italian Energy Market \\cite{GME_website}). The risk of non acceptance bidding at zero price thus becomes negligible;\n  \\item we compute a single $\\Gamma$-robust optimal solution referring to one single price configuration derived from historical data. So we avoid the infeasibility and suboptimality issues associated with merging distinct robust optimal solutions obtained for multiple price configurations;\n  \\item we define the single robust optimal solution by solving the robust counterpart with $\\Gamma$ such that $0 < \\Gamma < 24$, so to avoid the excessive conservatism associated with full protection.\n\\end{enumerate}\n\nThe robust counterpart that we adopt differs from that of Bar-Con concerning the nominal prices and the worst price deviations used in it, which we define by using realizations of the market price occurred in previous days. To this end, we suppose that for each $t \\in T$ we have a number $I>0$ of observed past realizations of the price $\\lambda_t^{i}$ with $i = 1,\\ldots,I$. Without loss of generality, we assume that these values are sorted in non-decreasing order, i.e. $\\lambda_t^{i} \\leq \\lambda_t^{i+1}$ for $i = 1,\\ldots,I-1$. The assumption of possessing past price realizations is fully realistic, since hourly prices are typically promptly disclosed by the market operator.\nUsing these past realizations, we define:\n\n\\begin{itemize}\n  \\item the \\emph{nominal price} $\\lambda_t^{\\text{NOM}}$ for each $t \\in T$ as the average value of past observations in $t$, namely:\n      \n", "index": 17, "text": "$$\n      \\lambda_t^{\\text{NOM}} \\hspace{0.1cm} = \\hspace{0.1cm}\n      \\lambda_t^{\\text{AVG}} \\hspace{0.1cm} = \\hspace{0.1cm}\n      \\frac{1}{I} \\hspace{0.1cm} \\sum_{i = 1}^{I} \\lambda_t^{i}\n      $$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex20.m1\" class=\"ltx_Math\" alttext=\"\\lambda_{t}^{\\text{NOM}}\\hskip 2.845276pt=\\hskip 2.845276pt\\lambda_{t}^{\\text{%&#10;AVG}}\\hskip 2.845276pt=\\hskip 2.845276pt\\frac{1}{I}\\hskip 2.845276pt\\sum_{i=1}%&#10;^{I}\\lambda_{t}^{i}\" display=\"block\"><mrow><mpadded width=\"+2.8pt\"><msubsup><mi>\u03bb</mi><mi>t</mi><mtext>NOM</mtext></msubsup></mpadded><mo rspace=\"5.3pt\">=</mo><mpadded width=\"+2.8pt\"><msubsup><mi>\u03bb</mi><mi>t</mi><mtext>AVG</mtext></msubsup></mpadded><mo rspace=\"5.3pt\">=</mo><mrow><mpadded width=\"+2.8pt\"><mfrac><mn>1</mn><mi>I</mi></mfrac></mpadded><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>I</mi></munderover><msubsup><mi>\u03bb</mi><mi>t</mi><mi>i</mi></msubsup></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.01728.tex", "nexttext": "\n      where $\\lambda_t^{J+1}$ is the smallest price observation obtained after excluding the $0 \\leq J < I$ smallest  observations (since we have assumed that observations are sorted in non-decreasing order, this means that we are excluding observations $\\lambda_t^{i}$ with $i = 1, \\ldots, J$ and the worst ``significative'' observation is then $\\lambda_t^{J+1}$).\n\\end{itemize}\n\nWe note that any other predictive procedure to obtain nominal prices and deviation can be considered in our framework as a plug-in strategy.\nFor instance, one could use a Machine Learning approach or a simulation model.\nWe note that this choice of the nominal value has been inspired by a practice that we have observed among power systems professionals: offering  decisions are taken considering the average price for each hour in a previous time horizon. Also, the choice of excluding a number of the worst price realizations, commonly referred to as {\\it trimming}, is widely use in practice for the management of outliers in distributions, and has been suggested and validated by our industrial partners.\n\n\n\\noindent\nOur reference robust counterpart then becomes:\n\n\n", "itemtype": "equation", "pos": 37724, "prevtext": "\n  \\item the \\emph{worst deviation} $d_t$ used in each $t \\in T$ as the difference\n      \n", "index": 19, "text": "$$\n      d_t \\hspace{0.1cm} = \\lambda_t^{\\text{AVG}} - \\hspace{0.1cm} \\lambda_t^{J+1}\n      $$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex21.m1\" class=\"ltx_Math\" alttext=\"d_{t}\\hskip 2.845276pt=\\lambda_{t}^{\\text{AVG}}-\\hskip 2.845276pt\\lambda_{t}^{%&#10;J+1}\" display=\"block\"><mrow><mpadded width=\"+2.8pt\"><msub><mi>d</mi><mi>t</mi></msub></mpadded><mo>=</mo><mrow><msubsup><mi>\u03bb</mi><mi>t</mi><mtext>AVG</mtext></msubsup><mo rspace=\"5.3pt\">-</mo><msubsup><mi>\u03bb</mi><mi>t</mi><mrow><mi>J</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mrow></mrow></math>", "type": "latex"}, {"file": "1601.01728.tex", "nexttext": "\n\n\\noindent\nwhich is the canonical $\\Gamma$-Robustness counterpart that we have derived in Section\n\\ref{SubSect:BaringoConejoApproach}, except for the setting of the nominal price and the worst price deviation.\n\n\nOur new method provides for solving a single time the robust counterpart MOD-Rob-EOP, by making one single assumption about the price configuration. The obtained robust optimal solution is then used for establishing our offering in the market as we detail in Algorithm \\ref{ALGrobustOffering}.\n\n\\begin{algorithm}\n\\caption{{\\sc $\\Gamma$-Offering}}\n\\label{ALGrobustOffering}\n\\begin{algorithmic}[1]\n\n    \\Require\n        Past hourly price realizations $\\lambda_t^{i}$,\n        $\\forall i = 1,\\ldots,I$, $\\forall t \\in T$;\n        number $J$ of smallest price realizations to exclude;\n        protection parameter $\\Gamma:$ $0 \\leq \\Gamma \\leq 24$\n    \n    \n    \\Ensure Hourly power quantities $p_t^{\\star}$ to be offered at zero price\n    \n    \\State Compute the average hourly prices $\\lambda_t^{\\text{AVG}}$ $\\forall t \\in T$, using observations $\\lambda_t^{i}$\n    \n    \n    \\State Solve the robust counterpart MOD-Rob-EOP for $\\Gamma$ using:\n    \\begin{itemize}\n      \\item $\\lambda_t^{\\text{AVG}}$ as nominal value $\\forall t \\in T$\n      \\item the difference $\\lambda_t^{\\text{AVG}} - \\lambda_t^{J+1}$ as worst  deviation $\\forall t \\in T$\n    \\end{itemize}\n    \\State Let $p^{\\star}$ be a robust optimal output vector for MOD-Rob-EOP, then $p_t^{\\star}$ is the quantity to be offered in the market at zero price in each period $t \\in T$\n\n\\end{algorithmic}\n\\end{algorithm}\n\n\nA critical difference of our new method formalized through the algorithm $\\Gamma$-Offering is that we solve one single $\\Gamma$-robust counterpart defined for one single assumption on prices. This is in contrast to Bar-Con where a large number of $\\Gamma$-robust counterparts is provided to be solved (in the experimental section of \\cite{BaCo11}, the number of solved counterparts is $k = 100$).\n\nAs we comment in the following section, the solution of the robust counterpart can be made almost instantaneously, thus making our new method fully suitable for being used in the daily offering decision process of a price-taker company.\n\n\n\n\\section{Computational results}\n\\label{sec:computations}\n\nWe assessed the performance of our new method for robust energy offering by considering a set of 45 instances provided by our industrial partners.\nThe 45 instances are based on 15 generation units of different size and features located in three distinct price zones of Italy. The capacity of the units ranges from about 100 to 1250 MW.\nThe price coefficients used in the robust counterparts are derived from real prices occurred in the Italian day-ahead Market (\\emph{Mercato del Giorno Prima (MGP)} \\cite{GME_website}) from January 1st to December 31st 2014.\n\nOur computational tests have\none major objective: showing that the solution of a robust counterpart imposing a (small) intermediate level of protection can grant a very big improvement in profit with respect to the robust counterparts imposing null and full protection (i.e., the strategy that we have observed among professionals and the strategy protecting against the worst price deviation in each hour, resembling the protection imposed by Bar-Con).\nWe note that in our experiments we do not use the method Bar-Con as a benchmark, because of its limits that we have highlighted in Section \\ref{SubSect:BaringoConejoApproach}\n\nand that concretely expose a company to the risk of suboptimal and infeasible accepted offers.\n\nWe performed all the experiments on a 2.70 GHz machine with 8 GB. The code was written in the C/C++ programming language and the optimization problems were solved by IBM ILOG CPLEX 12.5 interfaced with the code through Concert Technology. We stress that solving MOD-Rob-EOP to optimality does not constitute at all a challenge for CPLEX: for all instances and for all the values of $\\Gamma$, CPLEX is able to return an optimal solution within 1 second, making the method fully suitable for daily energy offering.\n\nFor each generation unit and each hour $t \\in T$, the average price $\\lambda_t^{\\text{AVG}}$ and the worst deviation $\\lambda_t^{\\text{AVG}} - \\lambda_t^{J+1}$ are defined considering 20 realizations of prices occurring in hour $t$ and in the price zone of the unit, in a time window of 4 consecutive weeks excluding Saturdays and Sundays. We consider three percentage of exclusions of the smallest price realizations: 0, 10 and 20\\%. This leads to respectively exclude the smallest $J = \\{0, 2, 4\\}$ realizations.\n\nIncreasing $J$ corresponds with considering a less risk-adverse price-taker that neglects a higher number of extreme deviations.\nSuch data are used as input for defining the robust counterpart for the 4-week time window, whose optimal robust solution is evaluated in the week following the 4 weeks of the window (excluding again Saturday and Sunday), as we explain in the next paragraph.\nThe overall (4+1)-week time window that we consider\n\nis shifted by 1 week through the entire 2014,\n\nfrom the first week of January till the last week of November. This gives raise to 24 time windows that we denote by $W = \\{1,2,\\ldots,24\\}$.\n\nFor each of the 15 units, we solve one robust counterpart Mod-Rob-EOP for each value of $J \\in \\{0, 2, 4\\}$, value of $\\Gamma \\in \\{0,1,\\ldots,24\\}$ and time window $W \\in \\{1,2,\\ldots,24\\}$, obtaining a robust optimal output $p^{\\star}(J,\\Gamma,W)$ (note that here we highlight the dependency of $p^{\\star}$ upon the values of $J$ and $\\Gamma$ and the window W). The vector $p^{\\star}(J,\\Gamma,W)$ specifies our \\emph{zero-price} energy offering for the unit in the test week of window $W$. We evaluate the performance of each $p^{\\star}(J,\\Gamma,W)$ in the test week of $W$ as follows:\n\nin each hour $t \\in T$ of each day, $p^{\\star}_t(J,\\Gamma,W)$ is offered giving a total profit over the week that we denote by $\\pi(J,\\Gamma,W)$. We then sum such profit over all the 24 time windows in 2014 getting a total yearly profit equal to $\\pi(J,\\Gamma) = \\sum_W \\pi(J,\\Gamma,W)$.\n\nThe complete results of our computational tests are presented in Table \\ref{table:results}, where we denote by $\\Gamma_{BEST}$ the value of $\\Gamma$ that grants the highest profit for a given generation unit and value of $J$ for a window. In the table, \\emph{ID} identifies the generation unit (we note that the size of the units increases as the ID increases) and \\emph{\\%Ex} is the percentage of price realizations that are excluded from the input data of the instance. The following four columns\n$\\Delta \\pi$, $\\Delta \\pi \\%$ for $\\Gamma_{BEST}$ w.r.t. $\\Gamma_0$\nand $\\Delta \\pi$, $\\Delta \\pi \\%$ for $\\Gamma_{BEST}$ w.r.t. $\\Gamma_{24}$\nreport the absolute (in euros) and the percentage increase that the robust optimal solution obtained for $\\Gamma_{BEST}$ grants with respect to $\\Gamma = 0$ and $\\Gamma = 24$, respectively.\n\nWe stress that for all instances, $\\Gamma_{BEST}$  assumes a small value between 1 and 4 and \\emph{never} coincides with $0$ (i.e., no protection) and $24$ (i.e., full protection).\nThis has a profound impact when comparing the profit of $\\Gamma_{BEST}$ to that of $\\Gamma_{24}$ (reported in the 5th and 6th column of Table \\ref{table:results}): setting $\\Gamma = 24$ and thus imposing protection against the worst price deviation  in each hour leads to extremely conservative solutions that dramatically decrease the profit obtainable by $\\Gamma_{BEST}$. The reduction in profit happens in all 90 but 3 cases and ranges from about $100\\,000$ to even more than 10 millions of euros. The over-conservatism is particularly evident when comparing the best robust profit to that obtained for full protection (column $\\Gamma_{BEST}$ w.r.t. $\\Gamma_{24}$): in the case of instances corresponding to units of higher capacity (i.e, U11 - U15), $\\Gamma_{BEST}$ grants an increase in profit that in most cases is of several millions, reaching a peak of 12 millions for instance U12 and $J = 0$. This clearly indicates through experiments a cardinal fact associated with the theory of $\\Gamma$-Robustness: imposing full protection and thus setting $\\Gamma$ to the highest possible value should be absolutely avoided since it generally entails protection against extreme unlikely cases at the cost of an extremely high price of robustness.\nIn contrast, as we showed trough the computational results, small values of $\\Gamma$ are able to guarantee protection against price uncertainty, while ensuring extremely satisfying level of profits.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\begin{table}\n\\caption{Computational results}\n\\label{table:results}\n\\small\n\\begin{center}\n\\begin{tabular}{cc|rr|rr}\n\n\n\n\n\\hline\n &  \t& \\multicolumn{2}{c|}{\\boldmath$\\Gamma_{BEST} \\mbox{ \\textbf{w.r.t.} } \\Gamma_0$}\n& \\multicolumn{2}{c}{\\boldmath$\\Gamma_{BEST} \\mbox{ \\textbf{w.r.t.} } \\Gamma_{24}$}\n\\\\\n\\textbf{ID} & $\\textbf{\\%Ex}$ \t& $\\Delta \\pi (EUR)$ \t& $\\Delta \\pi \\%$\n& $\\Delta \\pi (EUR)$ &  $\\Delta \\pi \\%$\n\\\\ [2pt]\n\\hline\n \t&  \t0   &  + 40,400     &  + 5.8 &  + 213,731   & + 40.5   \\\\\nU1 \t&  \t10  &  + 44,350     &  + 6.3 &  + 183,161   & + 32.5   \\\\\n \t&  \t20  &  + 41,922     &  + 6.0 &  + 152,608   & + 25.8   \\\\\n\\hline\n \t&  \t0     & + 23,395   &   + 5.0 &  + 333,543   & + 212.1\\\\\nU2 \t&  \t10    & + 46,064   &   + 9.9 &  + 234,371   & + 84.0\\\\\n \t&  \t20    & + 42,072   &   + 9.0 &  + 218,607   & + 75.2\\\\\n\\hline\n  \t&  \t0     & - 1,383   &   - 0.1 &  + 1,984,511   & + 47.6\\\\\nU3 \t&  \t10    & + 88,980  &   + 1.4 &  + 1,031,466   & + 19.8\\\\\n \t&  \t20    & + 105,253 &   + 1.7 &  + 627,146    &  + 11.1\\\\\n\\hline\n  \t&  \t0    & + 43,246  &    + 6.3 &  + 255,124    & + 53.5\\\\\nU4 \t&  \t10   & + 57,387  &    + 8.3 &  + 181,357    & + 32.1\\\\\n \t&  \t20   & + 51,615  &    + 7.5 &  + 148,635    & + 25.1\\\\\n\\hline\n  \t&  \t0    & + 15,454  &    + 3.6 &   + 340,568    & + 319.0\\\\\nU5 \t&  \t10   & + 45,328  &    + 10.5 &  + 240,506    & + 101.6\\\\\n \t&  \t20   & + 45,331  &    + 10.5 &  + 199,407    & + 71.8\\\\\n\\hline\n  \t&  \t0    & + 14,274  &    + 5.3 &   + 2,030,185    & + 44.9\\\\\nU6 \t&  \t10   & + 91,766  &    + 10.6 &  + 1,117,143    & + 20.2\\\\\n \t&  \t20   & + 152,707  &   + 11.8 &  + 675,172    & + 11.2\\\\\n\\hline\n  \t&  \t0    & + 307,691  &    + 5.7 &   + 1,312,795   & + 30.1\\\\\nU7 \t&  \t10   & + 268,509  &    + 5.0 &   + 909,989    & + 19.3\\\\\n \t&  \t20   & + 195,207  &    + 3.6 &   + 792,081    & + 16.6\\\\\n\\hline\n  \t&  \t0    & + 465,184  &    + 12.6 &   + 1,295,788   & + 45.4\\\\\nU8 \t&  \t10   & + 492,569  &    + 13.4 &   + 1,052,153   & + 33.7\\\\\n \t&  \t20   & + 387,576  &    + 10.5 &   + 888,434    & + 27.9\\\\\n\\hline\n  \t&  \t0    & - 179,097  &    - 0.5 &   + 8,606,256   & + 35.5\\\\\nU9 \t&  \t10   & + 249,549  &    + 0.8 &   + 4,586,552   & + 16.0\\\\\n \t&  \t20   & + 253,872  &    + 0.8 &   + 3,008,977   & + 9.9\\\\\n\\hline\n  \t&  \t0    & + 579,613  &    + 11.7 &   + 1,711,145  & + 44.8\\\\\nU10 &  \t10   & + 662,118  &    + 13.4 &   + 870,430   & + 18.3\\\\\n \t&  \t20   & + 502,539  &    + 10.1 &   + 594,417   & + 12.2\\\\\n\\hline\n  \t&  \t0    & + 612,087  &    + 19.6 &   + 2,471,071  & + 196.0\\\\\nU11 &  \t10   & + 465,015  &    + 14.9 &   + 1,270,815   & + 54.9\\\\\n \t&  \t20   & + 534,280  &    + 17.1 &   + 788,373   & + 27.5\\\\\n\\hline\n  \t&  \t0    & + 23,936  &    + 0.1 &   + 12,397,480  & + 49.4\\\\\nU12 &  \t10   & + 409,220  &    + 1.1 &  + 4,751,122   & + 14.3\\\\\n \t&  \t20   & + 438,452  &    + 1.2 &  + 3,506,378   & + 10.2\\\\\n\\hline\n  \t&  \t0    & + 111,222  &    + 0.3 &  + 8,244,776  & + 33.6\\\\\nU13 &  \t10   & + 421,917  &    + 1.3 &  + 4,577,802  & + 16.0\\\\\n \t&  \t20   & + 479,953  &    + 1.5 &  + 1,809,060  & + 5.8\\\\\n\\hline\n  \t&  \t0    & + 231,532  &    + 6.1 &   + 2,103,904  & + 111.0\\\\\nU14 &  \t10   & + 391,966  &    + 10.4 &  + 1,184,917  & + 39.8\\\\\n \t&  \t20   & + 485,693  &    + 12.9 &  + 494,986   & + 13.2\\\\\n\\hline\n  \t&  \t0    & -  76,685  &   - 0.2 &   + 11,622,839  & + 49.5\\\\\nU15 &  \t10   & + 524,424  &   + 1.5 &  + 5,459,972   & + 18.1\\\\\n \t&  \t20   & + 442,970  &   + 1.3 &  + 3,175,312   & + 9.8\\\\\n\\hline\n\\end{tabular}\n\\end{center}\n\\end{table}\n\n\n\n\\section{Conclusions}\n\nWe have presented a new Robust Optimization method for tackling price uncertainty in  energy offering for a price-taker generating company operating in a competitive energy market. Our investigations have been motivated by a review of a Robust Optimization method based on $\\Gamma$-Robustness for price-uncertain energy offering proposed in \\cite{BaCo11}:\n\nthough being an important reference in literature, this method presents a number of issues that may sensibly limit its application in practice and that concretely expose a company to the risk of presenting offering curves resulting into suboptimal and even infeasible accepted offers. To tackle all such issues, we have proposed an alternative $\\Gamma$-Robust Optimization method that requires to solve one single robust counterpart, considering an intermediate level of protection between null and full protection, and to make energy offers at zero price, practically eliminating the risk of non-acceptance. Computational results on a set of instances provided by our industrial partners show that our method is able to grant a very high increase in the profit with respect to solutions obtained by a strategy that we have observed among professionals and to solutions obtained by imposing full protection against price deviations.\nAs a future direction of investigations, we intend to study the adaption of alternative Robust Optimization models that grant a better representation of price uncertainty, such as Multiband Robustness, a refinement and generalization of $\\Gamma$-Robustness that exploits histogram-like uncertainty sets (see e.g., \\cite{BaEtAl14,BuDA12a}). A better modeling of the uncertain price data would lead indeed to further reduction in the conservatism of robust solutions, and thus increases in the profit, while not reducing protection against price deviations.\n\n\n\n\\section*{Acknowledgments}\n\n\\noindent\nThis first author was partially supported by the \\emph{Einstein Center for Mathematics Berlin} (ECMath) through Project MI4 (ROUAN) and by the \\emph{German Federal Ministry of Education and Research} (BMBF) through Project VINO and Project \\emph{ROBUKOM} \\cite{BaEtAl14}.\nThe first author was also partially supported by the COST Action TD1207 and\nwould like to acknowledge networking support by the COST Action TD1207.\n\n\\appendices\n\n\\section{Reference formulation} \\label{sec:appendixRefForm}\n\n\\noindent\nThe set of feasible power solutions $P$ is described by the mixed integer quadratic programming problem introduced below, using the following set of constants and variables characterizing the considered single generation unit.\n\n\\noindent\nConstants:\n\n\\begin{itemize}\n  \\item $\\lambda_t$ market price in period $t \\in T$;\n  \\item $a, b \\geq 0$ coefficients of the quadratic and linear term of the quadratic function expressing generation cost;\n  \\item $c^{F}$ fixed cost of generation in one single period;\n  \\item $c^{SU}_\\tau$ startup cost after $\\tau$ consecutive periods of turned-off status;\n  \\item $P^{\\min}, P^{\\max}$ minimum and maximum power output;\n  \\item $R^{\\nearrow}, R^{\\searrow}$ ramp-up and ramp-down limits;\n  \\item $R^{SU}, R^{SD}$ startup and shutdown ramp limits;\n  \\item $U_{i}, D_{i}$ minimum up and down time.\n\\end{itemize}\n\n\\noindent\nDecision variables:\n\n\\begin{itemize}\n  \\item $p_{t} \\geq 0$ - power output variable for period $t \\in T$;\n    \\item $suc_{t} \\geq 0$ - startup cost variable for period $t \\in T$;\n  \\item $u_{t}  \\in \\{0,1\\}$ - status variable for period $t \\in T$. A variable $u_{t}$ is equal to 1 if the unit is \\emph{on} in period $t$ and 0 if the unit is \\emph{off});\n  \\item $v_{t} \\in \\{0,1\\}$ - startup variable for period $t \\in T$. A variable $v_{t}$ is equal to 1 if the unit is \\emph{turned on} in period $t$ and 0 otherwise;\n  \\item $w_{t} \\in \\{0,1\\}$ - shutdown variable for period $t \\in T$. A variable $w_{t}$ is equal to 1 if the unit is \\emph{turned off} in period $t$ and 0 otherwise.\n\\end{itemize}\n\n\\noindent\nWe formulate the unit commitment problem as follows:\n\n\n", "itemtype": "equation", "pos": 38969, "prevtext": "\n      where $\\lambda_t^{J+1}$ is the smallest price observation obtained after excluding the $0 \\leq J < I$ smallest  observations (since we have assumed that observations are sorted in non-decreasing order, this means that we are excluding observations $\\lambda_t^{i}$ with $i = 1, \\ldots, J$ and the worst ``significative'' observation is then $\\lambda_t^{J+1}$).\n\\end{itemize}\n\nWe note that any other predictive procedure to obtain nominal prices and deviation can be considered in our framework as a plug-in strategy.\nFor instance, one could use a Machine Learning approach or a simulation model.\nWe note that this choice of the nominal value has been inspired by a practice that we have observed among power systems professionals: offering  decisions are taken considering the average price for each hour in a previous time horizon. Also, the choice of excluding a number of the worst price realizations, commonly referred to as {\\it trimming}, is widely use in practice for the management of outliers in distributions, and has been suggested and validated by our industrial partners.\n\n\n\\noindent\nOur reference robust counterpart then becomes:\n\n\n", "index": 21, "text": "\\begin{align}\n\\max\n&\n\\sum_{t \\in T} \\left[ \\lambda_t^{\\text{AVG}} p_{t} - c_{t} (p_{t}) \\right] - \\Gamma z - \\sum_{t \\in T} q_{t}\n&&\n\n\\text{(MOD-Rob-EOP)}\n\\nonumber\n\\\\\n&\nz + q_{t} \\geq (\\lambda_t^{\\text{AVG}} - \\lambda_t^{J+1}) \\hspace{0.1cm} p_{t}\n&&\nt \\in T\n\\nonumber\n\\\\\n&\nz \\geq 0\n&&\n\\nonumber\n\\\\\n&\nq_{t} \\geq 0\n&&\nt \\in T\n\\nonumber\n\\\\\n&\np \\in P \\; ,\n&&\n\\nonumber\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex22.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\max\" display=\"inline\"><mi>max</mi></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex22.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\sum_{t\\in T}\\left[\\lambda_{t}^{\\text{AVG}}p_{t}-c_{t}(p_{t})%&#10;\\right]-\\Gamma z-\\sum_{t\\in T}q_{t}\" display=\"inline\"><mrow><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>t</mi><mo>\u2208</mo><mi>T</mi></mrow></munder></mstyle><mrow><mo>[</mo><mrow><mrow><msubsup><mi>\u03bb</mi><mi>t</mi><mtext>AVG</mtext></msubsup><mo>\u2062</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo>-</mo><mrow><msub><mi>c</mi><mi>t</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>p</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>]</mo></mrow></mrow><mo>-</mo><mrow><mi mathvariant=\"normal\">\u0393</mi><mo>\u2062</mo><mi>z</mi></mrow><mo>-</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>t</mi><mo>\u2208</mo><mi>T</mi></mrow></munder></mstyle><msub><mi>q</mi><mi>t</mi></msub></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex23.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle z+q_{t}\\geq(\\lambda_{t}^{\\text{AVG}}-\\lambda_{t}^{J+1})\\hskip 2.%&#10;845276ptp_{t}\" display=\"inline\"><mrow><mrow><mi>z</mi><mo>+</mo><msub><mi>q</mi><mi>t</mi></msub></mrow><mo>\u2265</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msubsup><mi>\u03bb</mi><mi>t</mi><mtext>AVG</mtext></msubsup><mo>-</mo><msubsup><mi>\u03bb</mi><mi>t</mi><mrow><mi>J</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mrow><mo rspace=\"5.3pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>p</mi><mi>t</mi></msub></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex23.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle t\\in T\" display=\"inline\"><mrow><mi>t</mi><mo>\u2208</mo><mi>T</mi></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex24.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle z\\geq 0\" display=\"inline\"><mrow><mi>z</mi><mo>\u2265</mo><mn>0</mn></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex25.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle q_{t}\\geq 0\" display=\"inline\"><mrow><msub><mi>q</mi><mi>t</mi></msub><mo>\u2265</mo><mn>0</mn></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex25.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle t\\in T\" display=\"inline\"><mrow><mi>t</mi><mo>\u2208</mo><mi>T</mi></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex26.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle p\\in P\\;,\" display=\"inline\"><mrow><mrow><mi>p</mi><mo>\u2208</mo><mpadded width=\"+2.8pt\"><mi>P</mi></mpadded></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01728.tex", "nexttext": "\n\n\nThe objective function aims at maximizing the total profit of the unit over the time horizon, obtained as the sum of the difference of the total revenue and the total cost in each time period. The total cost of generation in one period is equal to the sum of the quadratic cost function plus the startup cost. The constraints \\eqref{MILP-SUCConstraint} express the linking between the startup cost variables and the status of the generation unit multiplied by the corresponding startup constants. The constraints \\eqref{MILP-variableBoundPowerConstraint} are variable bound constraints connecting the power output variables to the the status variable in each time period. The ramp-up and start-up limits and the ramp limits at startup and shutdown are respectively imposed by the constraints \\eqref{MILP-RampUpConstraint} and \\eqref{MILP-RampDownConstraint}. The constraints \\eqref{MILP-MinUpTimeConstraint} and \\eqref{MILP-MinDownTimeConstraint} impose the minimum up and down time of each unit.\nFinally, (\\ref{MILP-PowerVar}-\\ref{MILP-shutdownVar}) declare the decision variables of the problem.\n\nIn comparison to the formulation used in \\cite{BaCo11}, our reference formulation contains two main modeling and polyhedral refinements:\na) we consider a quadratic cost function $c_t(p_{t})$, which provides a refined representation of the production costs w.r.t. the linear\napproximation adopted in \\cite{BaCo11}; b) we consider a stronger formulation of the problem, which uses the inequalities providing a complete and compact description of the convex hull of the minimum up and down times of a unit (introduced in \\cite{RaTa05}).\n\nWe are aware that in literature there exist further ways for strengthening other families of unit commitment constraints (for example, the ramp constraints - see \\cite{TaEtAl15} for an overview) and refined linear representation of the quadratic cost function (e.g., by perspective cuts \\cite{FraEtAl09l03}). However, since we can solve (\\ref{MILP-objFunction}-\\ref{MILP-shutdownVar}) practically instantaneously, such refinements resulted not necessary and we decided to not include them.\n\n\n\n\n\n\n\n\n\n\\ifCLASSOPTIONcaptionsoff\n  \\newpage\n\\fi\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\begin{thebibliography}{1}\n\n\\bibitem{BaCo11}\nL.~Baringo, A.~J. Conejo: \\emph{Offering Strategy Via Robust Optimization}, IEEE Trans. Power Syst. 26 (3), 418-425, 2011\n\n\\bibitem{BaEtAl14}\nT. Bauschert, C. B\\\"using, F. D'Andreagiovanni, A.M.C.A. Koster, M. Kutschka, U. Steglich:: \\emph{Network Planning under Demand Uncertainty with Robust Optimization}. IEEE Comm. Mag. 52 (2), 178-185, 2014, DOI: 10.1109/MCOM.2014.6736760\n\n\\bibitem{BeElNe09} A.~Ben-Tal, L.~El Ghaoui, A.~Nemirovski: \\emph{Robust Optimization}, Heidelberg, Germany: Springer, 2009\n\n\\bibitem{BeBrCa11} D.~Bertsimas, D.~Brown, C.~Caramanis: \\emph{Theory and Applications of Robust Optimization}, SIAM Review 53 (3), 464-501, 2011\n\n\\bibitem{BeSi04} D.~Bertsimas, M.~Sim: \\emph{The Price of Robustness}, Oper. Res. 52 (1), 35-53, 2004\n\n\\bibitem{BuDA12a} C. B\\\"using, , F.D'Andreagiovanni: New Results about Multi-band Uncertainty in Robust Optimization. In: Klasing, R. (ed.) Experimental Algorithms - SEA 2012, LNCS, vol. 7276, pp. 63-74. Springer, Heidelberg, 2012, DOI: 10.1007/978-3-642-30850-5\\_7\n\n\\bibitem{CoEtAl02} A.J. Conejo, F.J. Nogales, J.M. Arroyo: Price-taker bidding strategy under price uncertainty. IEEE Trans. Power Syst. 17 (4), 1081-1088, 2002\n\n\\bibitem{CoEtAl04} A.J. Conejo, F.J. Nogales, J.M. Arroyo, R. Garcia-Bertrand: \\emph{Risk-Constrained Self-Scheduling of a Thermal Power Producer}. IEEE Trans. Power Syst. 19 (3), 1569-1574, 2004\n\n\\bibitem{CPLEX} IBM ILOG CPLEX: http://www-01.ibm.com/software/integration/ optimization/cplex-optimizer\n\n\\bibitem{Da93} A. David: \\emph{Competitive bidding in electricity supply}. Proc. Inst. Elect. Eng., Gen., Transm., Distrib. C, 140 (5), 421-426, 1993\n\n\\bibitem{DaWe00} A.K. Davin, F. Wen: \\emph{Strategic bidding in competitive electricity markets: a literature survey}. Proc. IEEE Power Eng. Soc. 4, 2168-2173, 2000\n\n\\bibitem{DeEtAl03}\nM. Denton, A. Palmer, R. Masiello, P. Skantze: \\emph{Managing market risk in energy}. IEEE Trans. Power Syst. 18 (2), 494-502, 2003\n\n\\bibitem{FraEtAl09l03}\nA. {Frangioni}, C. {Gentile}, F. {Lacalandra}: \\emph{Tighter Approximated MILP Formulations for Unit Commitment Problems}. IEEE Trans. Power Syst. 24 (1), 105-113, 2009\n\n\\bibitem{GME_website} Gestore Mercati Energetici.\nhttp://www.mercatoelettrico.org/en/\n\n\n\n\n\n\\bibitem{GoBa04}\nV. Gountis, A. Bakirtzis: \\emph{Bidding strategies for electricity producers\nin a competitive electricity marketplace}. IEEE Trans. Power\nSyst. 19 (1), 356-365, 2004\n\n\\bibitem{HrEtAl13}\nH. Pand\u009eic, J.M. Morales, A.J. Conejo, I. Kuzle:\n\\emph{Offering model for a virtual power plant based on stochastic programming}.\nJ. Appl. Energy 105, 282-292, 2013\n\n\\bibitem{Ja05} R. Jab: \\emph{Robust self-scheduling under price uncertainty using conditional value-at-risk}. IEEE Trans. Power Syst. 20 (4), 1852-1858, 2005\n\n\\bibitem{KwFr12} R.H. Kwon, D. Frances: \\emph{Optimization-Based Bidding in Day-Ahead Electricity Auction Markets: A Review of Models for Power Producers}.  In: Sorokin, A. et al. (eds.) Handbook of Networks in Power Systems, pp. 41-59. Springer, Heidelberg, 2012\n\n\\bibitem{LiShLi07}\nT. Li, M. Shahidehpour, Z. Li:\n\\emph{Risk-Constrained Bidding Strategy With Stochastic Unit Commitment}.\nIEEE Trans. Power Syst. 22 (1), 449-458, 2007\n\n\\bibitem{LiShQu11}\nG. Li, J. Shi, X. Qu: \\emph{Modeling methods for GenCo bidding strategy optimization in the liberalized electricity spot market \u0096 A state-of-the-art review}. Energy\n36 (8), 4686-4700, 2011\n\n\\bibitem{RaTa05}\nRajan, D., Takriti, S.: \\emph{Minimum up/down polytopes of the unit commitment problem with start-up costs}. IBM Research Report RC23628, 2005\n\n\n\n\n\\bibitem{TaEtAl15}\nM. Tahanan, W. van Ackooij, A. Frangioni, F. Lacalandra:\n\\emph{Large-scale Unit Commitment under uncertainty}.\n4OR 13 (2), 115-171, 2015\n\n\\bibitem{YaSh04}\nH. Yamin, S. Shahidehpour: \\emph{Risk and profit in self-scheduling for\ngencos}. IEEE Trans. Power Syst. 19 (4), 2104-2106, 2004\n\n\\end{thebibliography}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n", "itemtype": "equation", "pos": 55425, "prevtext": "\n\n\\noindent\nwhich is the canonical $\\Gamma$-Robustness counterpart that we have derived in Section\n\\ref{SubSect:BaringoConejoApproach}, except for the setting of the nominal price and the worst price deviation.\n\n\nOur new method provides for solving a single time the robust counterpart MOD-Rob-EOP, by making one single assumption about the price configuration. The obtained robust optimal solution is then used for establishing our offering in the market as we detail in Algorithm \\ref{ALGrobustOffering}.\n\n\\begin{algorithm}\n\\caption{{\\sc $\\Gamma$-Offering}}\n\\label{ALGrobustOffering}\n\\begin{algorithmic}[1]\n\n    \\Require\n        Past hourly price realizations $\\lambda_t^{i}$,\n        $\\forall i = 1,\\ldots,I$, $\\forall t \\in T$;\n        number $J$ of smallest price realizations to exclude;\n        protection parameter $\\Gamma:$ $0 \\leq \\Gamma \\leq 24$\n    \n    \n    \\Ensure Hourly power quantities $p_t^{\\star}$ to be offered at zero price\n    \n    \\State Compute the average hourly prices $\\lambda_t^{\\text{AVG}}$ $\\forall t \\in T$, using observations $\\lambda_t^{i}$\n    \n    \n    \\State Solve the robust counterpart MOD-Rob-EOP for $\\Gamma$ using:\n    \\begin{itemize}\n      \\item $\\lambda_t^{\\text{AVG}}$ as nominal value $\\forall t \\in T$\n      \\item the difference $\\lambda_t^{\\text{AVG}} - \\lambda_t^{J+1}$ as worst  deviation $\\forall t \\in T$\n    \\end{itemize}\n    \\State Let $p^{\\star}$ be a robust optimal output vector for MOD-Rob-EOP, then $p_t^{\\star}$ is the quantity to be offered in the market at zero price in each period $t \\in T$\n\n\\end{algorithmic}\n\\end{algorithm}\n\n\nA critical difference of our new method formalized through the algorithm $\\Gamma$-Offering is that we solve one single $\\Gamma$-robust counterpart defined for one single assumption on prices. This is in contrast to Bar-Con where a large number of $\\Gamma$-robust counterparts is provided to be solved (in the experimental section of \\cite{BaCo11}, the number of solved counterparts is $k = 100$).\n\nAs we comment in the following section, the solution of the robust counterpart can be made almost instantaneously, thus making our new method fully suitable for being used in the daily offering decision process of a price-taker company.\n\n\n\n\\section{Computational results}\n\\label{sec:computations}\n\nWe assessed the performance of our new method for robust energy offering by considering a set of 45 instances provided by our industrial partners.\nThe 45 instances are based on 15 generation units of different size and features located in three distinct price zones of Italy. The capacity of the units ranges from about 100 to 1250 MW.\nThe price coefficients used in the robust counterparts are derived from real prices occurred in the Italian day-ahead Market (\\emph{Mercato del Giorno Prima (MGP)} \\cite{GME_website}) from January 1st to December 31st 2014.\n\nOur computational tests have\none major objective: showing that the solution of a robust counterpart imposing a (small) intermediate level of protection can grant a very big improvement in profit with respect to the robust counterparts imposing null and full protection (i.e., the strategy that we have observed among professionals and the strategy protecting against the worst price deviation in each hour, resembling the protection imposed by Bar-Con).\nWe note that in our experiments we do not use the method Bar-Con as a benchmark, because of its limits that we have highlighted in Section \\ref{SubSect:BaringoConejoApproach}\n\nand that concretely expose a company to the risk of suboptimal and infeasible accepted offers.\n\nWe performed all the experiments on a 2.70 GHz machine with 8 GB. The code was written in the C/C++ programming language and the optimization problems were solved by IBM ILOG CPLEX 12.5 interfaced with the code through Concert Technology. We stress that solving MOD-Rob-EOP to optimality does not constitute at all a challenge for CPLEX: for all instances and for all the values of $\\Gamma$, CPLEX is able to return an optimal solution within 1 second, making the method fully suitable for daily energy offering.\n\nFor each generation unit and each hour $t \\in T$, the average price $\\lambda_t^{\\text{AVG}}$ and the worst deviation $\\lambda_t^{\\text{AVG}} - \\lambda_t^{J+1}$ are defined considering 20 realizations of prices occurring in hour $t$ and in the price zone of the unit, in a time window of 4 consecutive weeks excluding Saturdays and Sundays. We consider three percentage of exclusions of the smallest price realizations: 0, 10 and 20\\%. This leads to respectively exclude the smallest $J = \\{0, 2, 4\\}$ realizations.\n\nIncreasing $J$ corresponds with considering a less risk-adverse price-taker that neglects a higher number of extreme deviations.\nSuch data are used as input for defining the robust counterpart for the 4-week time window, whose optimal robust solution is evaluated in the week following the 4 weeks of the window (excluding again Saturday and Sunday), as we explain in the next paragraph.\nThe overall (4+1)-week time window that we consider\n\nis shifted by 1 week through the entire 2014,\n\nfrom the first week of January till the last week of November. This gives raise to 24 time windows that we denote by $W = \\{1,2,\\ldots,24\\}$.\n\nFor each of the 15 units, we solve one robust counterpart Mod-Rob-EOP for each value of $J \\in \\{0, 2, 4\\}$, value of $\\Gamma \\in \\{0,1,\\ldots,24\\}$ and time window $W \\in \\{1,2,\\ldots,24\\}$, obtaining a robust optimal output $p^{\\star}(J,\\Gamma,W)$ (note that here we highlight the dependency of $p^{\\star}$ upon the values of $J$ and $\\Gamma$ and the window W). The vector $p^{\\star}(J,\\Gamma,W)$ specifies our \\emph{zero-price} energy offering for the unit in the test week of window $W$. We evaluate the performance of each $p^{\\star}(J,\\Gamma,W)$ in the test week of $W$ as follows:\n\nin each hour $t \\in T$ of each day, $p^{\\star}_t(J,\\Gamma,W)$ is offered giving a total profit over the week that we denote by $\\pi(J,\\Gamma,W)$. We then sum such profit over all the 24 time windows in 2014 getting a total yearly profit equal to $\\pi(J,\\Gamma) = \\sum_W \\pi(J,\\Gamma,W)$.\n\nThe complete results of our computational tests are presented in Table \\ref{table:results}, where we denote by $\\Gamma_{BEST}$ the value of $\\Gamma$ that grants the highest profit for a given generation unit and value of $J$ for a window. In the table, \\emph{ID} identifies the generation unit (we note that the size of the units increases as the ID increases) and \\emph{\\%Ex} is the percentage of price realizations that are excluded from the input data of the instance. The following four columns\n$\\Delta \\pi$, $\\Delta \\pi \\%$ for $\\Gamma_{BEST}$ w.r.t. $\\Gamma_0$\nand $\\Delta \\pi$, $\\Delta \\pi \\%$ for $\\Gamma_{BEST}$ w.r.t. $\\Gamma_{24}$\nreport the absolute (in euros) and the percentage increase that the robust optimal solution obtained for $\\Gamma_{BEST}$ grants with respect to $\\Gamma = 0$ and $\\Gamma = 24$, respectively.\n\nWe stress that for all instances, $\\Gamma_{BEST}$  assumes a small value between 1 and 4 and \\emph{never} coincides with $0$ (i.e., no protection) and $24$ (i.e., full protection).\nThis has a profound impact when comparing the profit of $\\Gamma_{BEST}$ to that of $\\Gamma_{24}$ (reported in the 5th and 6th column of Table \\ref{table:results}): setting $\\Gamma = 24$ and thus imposing protection against the worst price deviation  in each hour leads to extremely conservative solutions that dramatically decrease the profit obtainable by $\\Gamma_{BEST}$. The reduction in profit happens in all 90 but 3 cases and ranges from about $100\\,000$ to even more than 10 millions of euros. The over-conservatism is particularly evident when comparing the best robust profit to that obtained for full protection (column $\\Gamma_{BEST}$ w.r.t. $\\Gamma_{24}$): in the case of instances corresponding to units of higher capacity (i.e, U11 - U15), $\\Gamma_{BEST}$ grants an increase in profit that in most cases is of several millions, reaching a peak of 12 millions for instance U12 and $J = 0$. This clearly indicates through experiments a cardinal fact associated with the theory of $\\Gamma$-Robustness: imposing full protection and thus setting $\\Gamma$ to the highest possible value should be absolutely avoided since it generally entails protection against extreme unlikely cases at the cost of an extremely high price of robustness.\nIn contrast, as we showed trough the computational results, small values of $\\Gamma$ are able to guarantee protection against price uncertainty, while ensuring extremely satisfying level of profits.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\begin{table}\n\\caption{Computational results}\n\\label{table:results}\n\\small\n\\begin{center}\n\\begin{tabular}{cc|rr|rr}\n\n\n\n\n\\hline\n &  \t& \\multicolumn{2}{c|}{\\boldmath$\\Gamma_{BEST} \\mbox{ \\textbf{w.r.t.} } \\Gamma_0$}\n& \\multicolumn{2}{c}{\\boldmath$\\Gamma_{BEST} \\mbox{ \\textbf{w.r.t.} } \\Gamma_{24}$}\n\\\\\n\\textbf{ID} & $\\textbf{\\%Ex}$ \t& $\\Delta \\pi (EUR)$ \t& $\\Delta \\pi \\%$\n& $\\Delta \\pi (EUR)$ &  $\\Delta \\pi \\%$\n\\\\ [2pt]\n\\hline\n \t&  \t0   &  + 40,400     &  + 5.8 &  + 213,731   & + 40.5   \\\\\nU1 \t&  \t10  &  + 44,350     &  + 6.3 &  + 183,161   & + 32.5   \\\\\n \t&  \t20  &  + 41,922     &  + 6.0 &  + 152,608   & + 25.8   \\\\\n\\hline\n \t&  \t0     & + 23,395   &   + 5.0 &  + 333,543   & + 212.1\\\\\nU2 \t&  \t10    & + 46,064   &   + 9.9 &  + 234,371   & + 84.0\\\\\n \t&  \t20    & + 42,072   &   + 9.0 &  + 218,607   & + 75.2\\\\\n\\hline\n  \t&  \t0     & - 1,383   &   - 0.1 &  + 1,984,511   & + 47.6\\\\\nU3 \t&  \t10    & + 88,980  &   + 1.4 &  + 1,031,466   & + 19.8\\\\\n \t&  \t20    & + 105,253 &   + 1.7 &  + 627,146    &  + 11.1\\\\\n\\hline\n  \t&  \t0    & + 43,246  &    + 6.3 &  + 255,124    & + 53.5\\\\\nU4 \t&  \t10   & + 57,387  &    + 8.3 &  + 181,357    & + 32.1\\\\\n \t&  \t20   & + 51,615  &    + 7.5 &  + 148,635    & + 25.1\\\\\n\\hline\n  \t&  \t0    & + 15,454  &    + 3.6 &   + 340,568    & + 319.0\\\\\nU5 \t&  \t10   & + 45,328  &    + 10.5 &  + 240,506    & + 101.6\\\\\n \t&  \t20   & + 45,331  &    + 10.5 &  + 199,407    & + 71.8\\\\\n\\hline\n  \t&  \t0    & + 14,274  &    + 5.3 &   + 2,030,185    & + 44.9\\\\\nU6 \t&  \t10   & + 91,766  &    + 10.6 &  + 1,117,143    & + 20.2\\\\\n \t&  \t20   & + 152,707  &   + 11.8 &  + 675,172    & + 11.2\\\\\n\\hline\n  \t&  \t0    & + 307,691  &    + 5.7 &   + 1,312,795   & + 30.1\\\\\nU7 \t&  \t10   & + 268,509  &    + 5.0 &   + 909,989    & + 19.3\\\\\n \t&  \t20   & + 195,207  &    + 3.6 &   + 792,081    & + 16.6\\\\\n\\hline\n  \t&  \t0    & + 465,184  &    + 12.6 &   + 1,295,788   & + 45.4\\\\\nU8 \t&  \t10   & + 492,569  &    + 13.4 &   + 1,052,153   & + 33.7\\\\\n \t&  \t20   & + 387,576  &    + 10.5 &   + 888,434    & + 27.9\\\\\n\\hline\n  \t&  \t0    & - 179,097  &    - 0.5 &   + 8,606,256   & + 35.5\\\\\nU9 \t&  \t10   & + 249,549  &    + 0.8 &   + 4,586,552   & + 16.0\\\\\n \t&  \t20   & + 253,872  &    + 0.8 &   + 3,008,977   & + 9.9\\\\\n\\hline\n  \t&  \t0    & + 579,613  &    + 11.7 &   + 1,711,145  & + 44.8\\\\\nU10 &  \t10   & + 662,118  &    + 13.4 &   + 870,430   & + 18.3\\\\\n \t&  \t20   & + 502,539  &    + 10.1 &   + 594,417   & + 12.2\\\\\n\\hline\n  \t&  \t0    & + 612,087  &    + 19.6 &   + 2,471,071  & + 196.0\\\\\nU11 &  \t10   & + 465,015  &    + 14.9 &   + 1,270,815   & + 54.9\\\\\n \t&  \t20   & + 534,280  &    + 17.1 &   + 788,373   & + 27.5\\\\\n\\hline\n  \t&  \t0    & + 23,936  &    + 0.1 &   + 12,397,480  & + 49.4\\\\\nU12 &  \t10   & + 409,220  &    + 1.1 &  + 4,751,122   & + 14.3\\\\\n \t&  \t20   & + 438,452  &    + 1.2 &  + 3,506,378   & + 10.2\\\\\n\\hline\n  \t&  \t0    & + 111,222  &    + 0.3 &  + 8,244,776  & + 33.6\\\\\nU13 &  \t10   & + 421,917  &    + 1.3 &  + 4,577,802  & + 16.0\\\\\n \t&  \t20   & + 479,953  &    + 1.5 &  + 1,809,060  & + 5.8\\\\\n\\hline\n  \t&  \t0    & + 231,532  &    + 6.1 &   + 2,103,904  & + 111.0\\\\\nU14 &  \t10   & + 391,966  &    + 10.4 &  + 1,184,917  & + 39.8\\\\\n \t&  \t20   & + 485,693  &    + 12.9 &  + 494,986   & + 13.2\\\\\n\\hline\n  \t&  \t0    & -  76,685  &   - 0.2 &   + 11,622,839  & + 49.5\\\\\nU15 &  \t10   & + 524,424  &   + 1.5 &  + 5,459,972   & + 18.1\\\\\n \t&  \t20   & + 442,970  &   + 1.3 &  + 3,175,312   & + 9.8\\\\\n\\hline\n\\end{tabular}\n\\end{center}\n\\end{table}\n\n\n\n\\section{Conclusions}\n\nWe have presented a new Robust Optimization method for tackling price uncertainty in  energy offering for a price-taker generating company operating in a competitive energy market. Our investigations have been motivated by a review of a Robust Optimization method based on $\\Gamma$-Robustness for price-uncertain energy offering proposed in \\cite{BaCo11}:\n\nthough being an important reference in literature, this method presents a number of issues that may sensibly limit its application in practice and that concretely expose a company to the risk of presenting offering curves resulting into suboptimal and even infeasible accepted offers. To tackle all such issues, we have proposed an alternative $\\Gamma$-Robust Optimization method that requires to solve one single robust counterpart, considering an intermediate level of protection between null and full protection, and to make energy offers at zero price, practically eliminating the risk of non-acceptance. Computational results on a set of instances provided by our industrial partners show that our method is able to grant a very high increase in the profit with respect to solutions obtained by a strategy that we have observed among professionals and to solutions obtained by imposing full protection against price deviations.\nAs a future direction of investigations, we intend to study the adaption of alternative Robust Optimization models that grant a better representation of price uncertainty, such as Multiband Robustness, a refinement and generalization of $\\Gamma$-Robustness that exploits histogram-like uncertainty sets (see e.g., \\cite{BaEtAl14,BuDA12a}). A better modeling of the uncertain price data would lead indeed to further reduction in the conservatism of robust solutions, and thus increases in the profit, while not reducing protection against price deviations.\n\n\n\n\\section*{Acknowledgments}\n\n\\noindent\nThis first author was partially supported by the \\emph{Einstein Center for Mathematics Berlin} (ECMath) through Project MI4 (ROUAN) and by the \\emph{German Federal Ministry of Education and Research} (BMBF) through Project VINO and Project \\emph{ROBUKOM} \\cite{BaEtAl14}.\nThe first author was also partially supported by the COST Action TD1207 and\nwould like to acknowledge networking support by the COST Action TD1207.\n\n\\appendices\n\n\\section{Reference formulation} \\label{sec:appendixRefForm}\n\n\\noindent\nThe set of feasible power solutions $P$ is described by the mixed integer quadratic programming problem introduced below, using the following set of constants and variables characterizing the considered single generation unit.\n\n\\noindent\nConstants:\n\n\\begin{itemize}\n  \\item $\\lambda_t$ market price in period $t \\in T$;\n  \\item $a, b \\geq 0$ coefficients of the quadratic and linear term of the quadratic function expressing generation cost;\n  \\item $c^{F}$ fixed cost of generation in one single period;\n  \\item $c^{SU}_\\tau$ startup cost after $\\tau$ consecutive periods of turned-off status;\n  \\item $P^{\\min}, P^{\\max}$ minimum and maximum power output;\n  \\item $R^{\\nearrow}, R^{\\searrow}$ ramp-up and ramp-down limits;\n  \\item $R^{SU}, R^{SD}$ startup and shutdown ramp limits;\n  \\item $U_{i}, D_{i}$ minimum up and down time.\n\\end{itemize}\n\n\\noindent\nDecision variables:\n\n\\begin{itemize}\n  \\item $p_{t} \\geq 0$ - power output variable for period $t \\in T$;\n    \\item $suc_{t} \\geq 0$ - startup cost variable for period $t \\in T$;\n  \\item $u_{t}  \\in \\{0,1\\}$ - status variable for period $t \\in T$. A variable $u_{t}$ is equal to 1 if the unit is \\emph{on} in period $t$ and 0 if the unit is \\emph{off});\n  \\item $v_{t} \\in \\{0,1\\}$ - startup variable for period $t \\in T$. A variable $v_{t}$ is equal to 1 if the unit is \\emph{turned on} in period $t$ and 0 otherwise;\n  \\item $w_{t} \\in \\{0,1\\}$ - shutdown variable for period $t \\in T$. A variable $w_{t}$ is equal to 1 if the unit is \\emph{turned off} in period $t$ and 0 otherwise.\n\\end{itemize}\n\n\\noindent\nWe formulate the unit commitment problem as follows:\n\n\n", "index": 23, "text": "\\begin{align}\n\\max\n&\n\\sum_{t \\in T}\n\\left\\{\n\\lambda_t p_t\n-\n    \\left[\n        a  \\left( p_t \\right)^2\n        + b \\hspace{0.1cm}  p_t\n        + c^{F}  u_t\n        + suc_{t}\n    \\right]\n\\right\\}\n&&\n\\label{MILP-objFunction}\n\\\\\n&\nsuc_t \\geq c^{SU}_\\tau \\left( u_{t} - \\sum_{k = 1}^{\\tau} u_{t-k} \\right)\n\\qquad t \\in T\n\\label{MILP-SUCConstraint}\n\\\\\n&\nP^{\\min} \\hspace{0.1cm} u_{t} \\leq p_{t} \\leq P^{\\max} \\hspace{0.1cm} u_{t}\n\\qquad t \\in T\n\\label{MILP-variableBoundPowerConstraint}\n\\\\\n&\np_{t} \\leq p_{t-1} + R^{\\nearrow} u_{t}\n+ \\left(R^{SU} - R^{\\nearrow}\\right) v_{t}\n\\qquad\nt \\in T\n\\label{MILP-RampUpConstraint}\n\\\\\n&\np_{t} \\geq p_{t-1} - R^{\\searrow} u_{t-1}\n+ \\left(R^{\\searrow} - R^{SD} \\right) w_{t}\n\\hspace{0.4cm}\nt \\in T\n\\label{MILP-RampDownConstraint}\n\\\\\n&\n\\sum_{\\tau = t - U + 1}^{t} v_{\\tau} \\leq u_{t}\n\\qquad\nt \\in \\{U + 1, \\ldots, |T|\\}\n\\label{MILP-MinUpTimeConstraint}\n\\\\\n&\n\\sum_{\\tau = t - D + 1}^{t} w_{\\tau} \\leq 1-  u_{t}\n\\qquad\nt \\in \\{D + 1, \\ldots, |T|\\}\n\\label{MILP-MinDownTimeConstraint}\n\\\\\n&\nw_{t} = v_{t} + u_{t-1} - u_{t}\n\\qquad\nt \\in T\n\\label{MILP-VWConstraint}\n\\\\\n&\np_{t} \\geq 0\n\\qquad\nt \\in T\n\\label{MILP-PowerVar}\n\\\\\n&\nsuc_{t} \\geq 0\n\\qquad\nt \\in T\n\\label{MILP-SUCVar}\n\\\\\n&\nu_{t} \\in \\{0,1\\}\n\\qquad\nt \\in T\n\\label{MILP-statusVar}\n\\\\\n&\nv_{t} \\in \\{0,1\\}\n\\qquad\nt \\in T\n\\label{MILP-startupVar}\n\\\\\n&\nw_{t} \\in \\{0,1\\}\n\\qquad\nt \\in T\n\\label{MILP-shutdownVar}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\max\" display=\"inline\"><mi>max</mi></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\sum_{t\\in T}\\left\\{\\lambda_{t}p_{t}-\\left[a\\left(p_{t}\\right)^{2%&#10;}+b\\hskip 2.845276ptp_{t}+c^{F}u_{t}+suc_{t}\\right]\\right\\}\" display=\"inline\"><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>t</mi><mo>\u2208</mo><mi>T</mi></mrow></munder></mstyle><mrow><mo>{</mo><mrow><mrow><msub><mi>\u03bb</mi><mi>t</mi></msub><mo>\u2062</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo>-</mo><mrow><mo>[</mo><mrow><mrow><mi>a</mi><mo>\u2062</mo><msup><mrow><mo>(</mo><msub><mi>p</mi><mi>t</mi></msub><mo>)</mo></mrow><mn>2</mn></msup></mrow><mo>+</mo><mrow><mpadded width=\"+2.8pt\"><mi>b</mi></mpadded><mo>\u2062</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo>+</mo><mrow><msup><mi>c</mi><mi>F</mi></msup><mo>\u2062</mo><msub><mi>u</mi><mi>t</mi></msub></mrow><mo>+</mo><mrow><mi>s</mi><mo>\u2062</mo><mi>u</mi><mo>\u2062</mo><msub><mi>c</mi><mi>t</mi></msub></mrow></mrow><mo>]</mo></mrow></mrow><mo>}</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle suc_{t}\\geq c^{SU}_{\\tau}\\left(u_{t}-\\sum_{k=1}^{\\tau}u_{t-k}%&#10;\\right)\\qquad t\\in T\" display=\"inline\"><mrow><mrow><mrow><mi>s</mi><mo>\u2062</mo><mi>u</mi><mo>\u2062</mo><msub><mi>c</mi><mi>t</mi></msub></mrow><mo>\u2265</mo><mrow><msubsup><mi>c</mi><mi>\u03c4</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>U</mi></mrow></msubsup><mo>\u2062</mo><mrow><mo>(</mo><mrow><msub><mi>u</mi><mi>t</mi></msub><mo>-</mo><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>\u03c4</mi></munderover></mstyle><msub><mi>u</mi><mrow><mi>t</mi><mo>-</mo><mi>k</mi></mrow></msub></mrow></mrow><mo>)</mo></mrow></mrow></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003\u2003</mo><mrow><mi>t</mi><mo>\u2208</mo><mi>T</mi></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle P^{\\min}\\hskip 2.845276ptu_{t}\\leq p_{t}\\leq P^{\\max}\\hskip 2.84%&#10;5276ptu_{t}\\qquad t\\in T\" display=\"inline\"><mrow><mrow><mrow><mpadded width=\"+2.8pt\"><msup><mi>P</mi><mi>min</mi></msup></mpadded><mo>\u2062</mo><msub><mi>u</mi><mi>t</mi></msub></mrow><mo>\u2264</mo><msub><mi>p</mi><mi>t</mi></msub><mo>\u2264</mo><mrow><mpadded width=\"+2.8pt\"><msup><mi>P</mi><mi>max</mi></msup></mpadded><mo>\u2062</mo><msub><mi>u</mi><mi>t</mi></msub></mrow></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003\u2003</mo><mrow><mi>t</mi><mo>\u2208</mo><mi>T</mi></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle p_{t}\\leq p_{t-1}+R^{\\nearrow}u_{t}+\\left(R^{SU}-R^{\\nearrow}%&#10;\\right)v_{t}\\qquad t\\in T\" display=\"inline\"><mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo>\u2264</mo><mrow><msub><mi>p</mi><mrow><mi>t</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>+</mo><mrow><msup><mi>R</mi><mo>\u2197</mo></msup><mo>\u2062</mo><msub><mi>u</mi><mi>t</mi></msub></mrow><mo>+</mo><mrow><mrow><mo>(</mo><mrow><msup><mi>R</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>U</mi></mrow></msup><mo>-</mo><msup><mi>R</mi><mo>\u2197</mo></msup></mrow><mo>)</mo></mrow><mo>\u2062</mo><msub><mi>v</mi><mi>t</mi></msub></mrow></mrow></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003\u2003</mo><mrow><mi>t</mi><mo>\u2208</mo><mi>T</mi></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle p_{t}\\geq p_{t-1}-R^{\\searrow}u_{t-1}+\\left(R^{\\searrow}-R^{SD}%&#10;\\right)w_{t}\\hskip 11.381102ptt\\in T\" display=\"inline\"><mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo>\u2265</mo><mrow><mrow><msub><mi>p</mi><mrow><mi>t</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>-</mo><mrow><msup><mi>R</mi><mo>\u2198</mo></msup><mo>\u2062</mo><msub><mi>u</mi><mrow><mi>t</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow></mrow><mo>+</mo><mrow><mrow><mo>(</mo><mrow><msup><mi>R</mi><mo>\u2198</mo></msup><mo>-</mo><msup><mi>R</mi><mrow><mi>S</mi><mo>\u2062</mo><mi>D</mi></mrow></msup></mrow><mo>)</mo></mrow><mo>\u2062</mo><msub><mi>w</mi><mi>t</mi></msub></mrow></mrow></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003</mo><mrow><mi>t</mi><mo>\u2208</mo><mi>T</mi></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\sum_{\\tau=t-U+1}^{t}v_{\\tau}\\leq u_{t}\\qquad t\\in\\{U+1,\\ldots,|T|\\}\" display=\"inline\"><mrow><mrow><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>\u03c4</mi><mo>=</mo><mrow><mrow><mi>t</mi><mo>-</mo><mi>U</mi></mrow><mo>+</mo><mn>1</mn></mrow></mrow><mi>t</mi></munderover></mstyle><msub><mi>v</mi><mi>\u03c4</mi></msub></mrow><mo>\u2264</mo><msub><mi>u</mi><mi>t</mi></msub></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003\u2003</mo><mrow><mi>t</mi><mo>\u2208</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mi>U</mi><mo>+</mo><mn>1</mn></mrow><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><mrow><mo stretchy=\"false\">|</mo><mi>T</mi><mo stretchy=\"false\">|</mo></mrow><mo stretchy=\"false\">}</mo></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E10.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\sum_{\\tau=t-D+1}^{t}w_{\\tau}\\leq 1-u_{t}\\qquad t\\in\\{D+1,\\ldots,%&#10;|T|\\}\" display=\"inline\"><mrow><mrow><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>\u03c4</mi><mo>=</mo><mrow><mrow><mi>t</mi><mo>-</mo><mi>D</mi></mrow><mo>+</mo><mn>1</mn></mrow></mrow><mi>t</mi></munderover></mstyle><msub><mi>w</mi><mi>\u03c4</mi></msub></mrow><mo>\u2264</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>u</mi><mi>t</mi></msub></mrow></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003\u2003</mo><mrow><mi>t</mi><mo>\u2208</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mi>D</mi><mo>+</mo><mn>1</mn></mrow><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><mrow><mo stretchy=\"false\">|</mo><mi>T</mi><mo stretchy=\"false\">|</mo></mrow><mo stretchy=\"false\">}</mo></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E11.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle w_{t}=v_{t}+u_{t-1}-u_{t}\\qquad t\\in T\" display=\"inline\"><mrow><mrow><msub><mi>w</mi><mi>t</mi></msub><mo>=</mo><mrow><mrow><msub><mi>v</mi><mi>t</mi></msub><mo>+</mo><msub><mi>u</mi><mrow><mi>t</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow><mo>-</mo><msub><mi>u</mi><mi>t</mi></msub></mrow></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003\u2003</mo><mrow><mi>t</mi><mo>\u2208</mo><mi>T</mi></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E12.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle p_{t}\\geq 0\\qquad t\\in T\" display=\"inline\"><mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo>\u2265</mo><mn>0</mn></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003\u2003</mo><mrow><mi>t</mi><mo>\u2208</mo><mi>T</mi></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E13.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle suc_{t}\\geq 0\\qquad t\\in T\" display=\"inline\"><mrow><mrow><mrow><mi>s</mi><mo>\u2062</mo><mi>u</mi><mo>\u2062</mo><msub><mi>c</mi><mi>t</mi></msub></mrow><mo>\u2265</mo><mn>0</mn></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003\u2003</mo><mrow><mi>t</mi><mo>\u2208</mo><mi>T</mi></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle u_{t}\\in\\{0,1\\}\\qquad t\\in T\" display=\"inline\"><mrow><mrow><msub><mi>u</mi><mi>t</mi></msub><mo>\u2208</mo><mrow><mo stretchy=\"false\">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">}</mo></mrow></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003\u2003</mo><mrow><mi>t</mi><mo>\u2208</mo><mi>T</mi></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E15.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle v_{t}\\in\\{0,1\\}\\qquad t\\in T\" display=\"inline\"><mrow><mrow><msub><mi>v</mi><mi>t</mi></msub><mo>\u2208</mo><mrow><mo stretchy=\"false\">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">}</mo></mrow></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003\u2003</mo><mrow><mi>t</mi><mo>\u2208</mo><mi>T</mi></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E16.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle w_{t}\\in\\{0,1\\}\\qquad t\\in T\" display=\"inline\"><mrow><mrow><msub><mi>w</mi><mi>t</mi></msub><mo>\u2208</mo><mrow><mo stretchy=\"false\">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">}</mo></mrow></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003\u2003</mo><mrow><mi>t</mi><mo>\u2208</mo><mi>T</mi></mrow></mrow></math>", "type": "latex"}]