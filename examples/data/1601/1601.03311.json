[{"file": "1601.03311.tex", "nexttext": "\nThat is, it is the minimum imbalance for all sets in $\\mathcal{S}$, over all possible two-colorings $\\chi$.\n\nDiscrepancy is a widely studied topic and has applications to many areas in mathematics and computer science. For more background we refer the reader to the books \\cite{Chazelle,Mat99,Panorama}. In particular, discrepancy is closely related to the problem of rounding  fractional solutions of a linear system of equations to integral ones \\cite{LSV,R12}, and is widely studied in approximation algorithms and optimization.\n\nUntil recently, most of the results in discrepancy were based on non-algorithmic approaches \n\nand hence were not directly useful for algorithmic applications. \nHowever, in the last few years there has been remarkable progress in our understanding of the algorithmic aspects of discrepancy \\cite{B10,CNN11,LM12,Ro14,HSS14,ES14,NT15}. In particular, we can now match or even improve upon all known applications of the widely used partial-coloring method \\cite{Spencer85,Mat99} in discrepancy.\nThis has led to several other new results in approximation algorithms \\cite{R13,BCKL14,BN15,NTZ13}.\n\n\n\n\\paragraph{Sparse Set Systems:} \nDespite the algorithmic progress, one prominent question that has remained open is to match the known non-constructive bounds on discrepancy for low degree or sparse set systems. These systems are parametrized by $t$, that denotes the maximum number of sets that contain any element.\n Beck and Fiala \\cite{BF81} proved, using an algorithmic iterated rounding approach, that any such set system has discrepancy at most $2t-1$. They also conjectured that the discrepancy in this case is $O(t^{1/2})$. Despite much effort, this remains an elusive open question.\n\nThe best known result in this direction is due to Banaszczyk \\cite{B97}, who proved a discrepancy bound of $O((t \\log n)^{1/2})$. Unlike most results in discrepancy that are based on the partial-coloring method,\nBanaszczyk's proof is based on a very different and elegant convex geometric argument, and it is not known how to make it algorithmic.\nPrior to Banaszczyk's result, the best known non-algorithmic bound\\footnote{Throughout this paper we will assume that $t \\geq \\log^2 n$, to avoid taking minimum with the $O(t)$ bound every time.}  was $O(t^{1/2} \\log n)$ \\cite{Srin97}, based on the partial-coloring method. This bound was made algorithmic in \\cite{B10}.\nThe question of matching Banaszczyk's bound algorithmically and several related variants of the problem have received a lot of attention in recent years \\cite{N13,B13,ES14,EL15}.\n\nThe regime where the above questions are most interesting is perhaps when $t=\\log^{\\beta} n$ for some moderate value of $\\beta$. \nIf particular, if $\\beta < 1$, then the $O(t)$ Beck-Fiala bound already beats the $O((t \\log n)^{1/2})$ bound of Banaszczyk. On the other hand, if $\\beta = 1/\\epsilon$ for some small $\\epsilon$, then the partial coloring bound already gives $O(t^{1/2} \\log n) = O(t^{1/2+\\epsilon})$, and becomes asymptotically close to the conjectured $O(t^{1/2})$ bound.\n\n\n\\subsection{Our Results}\nIn this paper we give new algorithmic results that improve upon the previously known algorithmic bounds for the Beck-Fiala problem in various ways.\n\nOur first result is the following:\n\\begin{thm} \n\\label{thm:main}\nGiven any $t$-sparse set system on $n$ elements, \nthere is an efficient algorithm that with high probability, finds a coloring where each set $S \\in \\mathcal{S}$ incurs an  \n$O((t \\log n \\log |S|)^{1/2})$ discrepancy.\n\nIn particular, this gives an $O((t \\log n \\log s)^{1/2})$ discrepancy coloring, where $s$ is the size of the largest set in the system.\n\\end{thm} \n\n\nThis bound is never worse than the previous $O(t^{1/2} \\log n)$ algorithmic bound, and essentially matches Banaszczyk's bound if all sets have size $\\textrm{poly}(t)$.\nPreviously, bounds better than  $O(t^{1/2} \\log n)$ were known only for a very restricted range of $s$.\nIn particular, an $O((s \\log t)^{1/2})$ (algorithmic) bound follows by a direct application of the Lov\\'{a}sz Local Lemma (LLL). \n\nThis gives an improvement over previous algorithmic bounds for $s \\ll \\min(t \\log^2 n,t^2)$, but is much worse even for moderately larger values of $s$ such as $s=t^{10}$. It is unclear how to avoid the $s^{1/2}$ loss with LLL-based approaches\\footnote{For a set of size $s$, a random coloring incurs $\\Omega(s^{1/2})$ discrepancy with probability almost $1$.}, and the problem of improving upon the $O(t^{1/2}\\log n)$ bound was open even for the case of $s=t^2$.\n\nAs a concrete example to summarize the status of the known bounds: for $t = O(\\log^2 n)$ and $s = t^2=O(\\log^4 n)$, the conjectured Beck-Fiala bound is $O(\\log n)$,  the best known non-constructive bound is $O(\\log^{3/2} n)$, all previous algorithms incur $\\Omega(\\log^2 n)$ discrepancy, and Theorem \\ref{thm:main} above  achieves $\\tilde{O}(\\log^{3/2}n)$ where $\\tilde{O}(\\cdot)$ hides $\\textrm{poly}(\\log \\log n)$ factors.\n\n\n\n\n\n\nThe algorithm is based on a random walk based approach, similar to that in \\cite{B10}, where each step of the walk is guided by a solution to a semidefinite program (SDP). However, as we describe in Section \\ref{s:overview}, the previous partial coloring based approaches seem inherently incapable of improving upon the $O(t^{1/2} \\log n)$ bound (in fact this is true even for $s=t$, where LLL based techniques perform much better). Moreover, the previous approaches also cannot give a size-sensitive discrepancy bound for each set $S$, as in Theorem \\ref{thm:main}. \nA key new idea of our algorithm is to add some extra constraints to the SDP which ensure that {\\em every} large enough set makes enough ``progress\" towards getting colored, and to use a result of Nikolov \\cite{N13} to argue the feasibility of this SDP. \nRoughly, these constraints ensure that a set of size $|S|$ incurs an $O(\\sqrt{t})$ discrepancy in expectation for only $O(\\log |S|)$ phases. \nWe give an overview of the algorithm in Section \\ref{s:alg} after defining the relevant background in Section \\ref{s:prel}.\n\n\n\n\n\n\nWhile Theorem \\ref{thm:main} does not give anything new directly if $s$ is arbitrarily large, our method is quite versatile and readily lends to many extensions. \nThese can be used to match or almost match Banaszczyk's bound in many cases even when $s$ is arbitrary.\nThese are discussed in Theorems \\ref{thm:ext1}, \\ref{thm:ext2} and their corollaries  below.\n\n\n\n\n\n\\begin{thm}\n\\label{thm:ext1}\nFor $i=1,\\ldots,\\log n$, let $m_i$ denote the number of sets in $\\mathcal{S}$ with size in $(2^{i-1},2^{i}]$. Call these class-$i$ sets.\nThen, there is an algorithm that finds a coloring with discrepancy $O((t i (\\log m_i+\\log\\log n))^{1/2})$ for each class-$i$ set.\n\\end{thm}\n\nThe bound above  refines Theorem \\ref{thm:main} (which follows as $m_i \\leq n$ for each $i$) and can lead to substantially improved bounds when the number of large  sets is not too high.\nRecall that in general we can assume that $m_i$ is not too large, as by a standard linear algebraic argument \\cite{BF81}, one can assume that $n \\leq m$ which implies that \nthe average row size is also at most $t$ and that $m_i \\leq nt/2^{i-1}$ for every $i$.\nThe following corollary of Theorem \\ref{thm:ext1} shows that if the system satisfies\nthe stronger bound of $m_i \\leq n^{(\\log^{O(1)}t)/i}$ instead, then one can essentially match Banaszczyk's bound.\n\n\\begin{cor}\n\\label{cor1}\nIf the number of class-$i$ sets is at most $ n^{(\\log^{O(1)}t)/i}$, then there is an algorithm that finds an $\\tilde{O}((t \\log n)^{1/2})$ discrepancy coloring, where $\\tilde{O}(\\cdot)$ hides $\\mbox{poly}(\\log {t}\\log\\log {n})$ factors.\n\\end{cor}\n\n\n\n\n\n \n\n\n\n\nTheorem \\ref{thm:main} also extends to the more general setting of the Koml\\'{o}s conjecture (defined in Section \\ref{s:prel}) where the matrix entries can be arbitrary reals instead of only $0$-$1$. For this setting, Banaszczyk's result \\cite{B97} implies an $O(\\log^{1/2} n)$ non-constructive bound.\n\\begin{thm}\n\\label{thm:kom}\nGiven a matrix $A$ with $n$ columns such that the $\\ell_2$-norm of any column is at most $1$, then there is an algorithm to find a coloring where each row $j$ incurs a discrepancy of\n$O( (\\log n \\log s_j)^{1/2})$, where $s_j$ is the $\\ell_1$-norm of row $j$.\n\\end{thm}\n\n\n\n\n\nThe following extension of Theorem \\ref{thm:kom} allows further flexibility in choosing different weights $w_j$ for rows to allow improved bounds in many cases. \n\n\n\n\n\n\\begin{thm}\n\\label{thm:ext2}\nSuppose there is a reweighting of the rows $j$ with non-negative weights $w_j$ such that the $\\ell_2$-norm of any column is at most $\\beta$, then \nthe  algorithm gets a discrepancy of  $O(\\beta(\\log n\\log (w_j s_j))^{1/2}/w_j)$   for each row  $j$.\n\\end{thm}\n\nThe following corollary of Theorem \\ref{thm:ext2} shows that Banaszczyk's bound can be almost matched algorithmically if the sparsity of set system decreases suitably when restricted to very large sets, i.e.~no element lies essentially in only very large sets.\n\n\\begin{cor}\n\\label{cor2}\nGiven a $t$-sparse set system with the property that each element lies in $O(t/i^{1+\\epsilon})$ \nsets of size more than $t 2^{i-1}$ for each $i\\geq 1$, for some fixed $\\epsilon>0$, then there is an algorithm to find an $O((t \\log n \\log t)^{1/2})$ discrepancy coloring.\n\\end{cor}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\section{Preliminaries}\n\\label{s:prel}\nWe describe some of the basic concepts that we will need.\n\n\\subsection{Vector Discrepancy}\nIf $A$ is the $m\\times n$ incidence matrix of the set-system $(V,\\mathcal{S})$ with rows corresponding to the sets $S_1,\\ldots,S_m$ and columns to the elements $[n]\\footnote{We use $[n]$ to denote the set \\{1,2,\\ldots,n\\}.}$, then we can write the discrepancy of $A$ as \n", "itemtype": "equation", "pos": 2209, "prevtext": "\n\n\\title{Improved Algorithmic Bounds for Discrepancy of Sparse Set Systems}\n\n\\author{Nikhil Bansal\n\\thanks{Department of Mathematics and Computer Science, Eindhoven University of Technology, Netherlands.  \nEmail:\n\\href{mailto:n.bansal@tue.nl}{n.bansal@tue.nl}.\nSupported by a NWO Vidi grant 639.022.211 and an ERC consolidator grant 617951.}\n\\and\nShashwat Garg\\thanks{Department of Mathematics and Computer Science, Eindhoven University of Technology, Netherlands.  \nEmail:\n\\href{mailto:s.garg@tue.nl}{s.garg@tue.nl}.\nSupported by the Netherlands\u0092 Organisation for Scientific Research (NWO) under project no.~022.005.025.\n}\n}\n\n\\maketitle\n\n\\begin{abstract}\nWe consider the problem of finding a low discrepancy coloring for sparse set systems where each element lies in at most $t$ sets. We give an algorithm that finds a coloring with discrepancy \n$O((t \\log n \\log s)^{1/2})$ where $s$ is the maximum cardinality of a set. \nThis improves upon the previous constructive bound of $O(t^{1/2} \\log n)$ based on algorithmic variants of the partial coloring method, and for small $s$ (e.g.~$s=\\textrm{poly}(t)$) comes close to  \nthe non-constructive  $O((t \\log n)^{1/2})$ bound due to Banaszczyk. Previously, no algorithmic results better than $O(t^{1/2}\\log n)$  were known even for $s = O(t^2)$.\nOur method is quite robust and we give several refinements and extensions. \nFor example, the coloring we obtain satisfies the stronger size-sensitive property that each set $S$ in the set system incurs an $O((t \\log n \\log |S|)^{1/2})$ discrepancy. \nAnother variant can be used to essentially match Banaszczyk's bound for a wide class of instances even where $s$ is arbitrarily large. \nFinally, these results also extend directly to the more general Koml\\'{o}s setting. \n\\end{abstract}\n\n\n\n\\section{Introduction}\nLet $(V,\\mathcal{S})$ be a finite set system, with $V=\\{1,\\ldots,n\\}$ and $\\mathcal{S} = \\{S_1,\\ldots,S_m\\}$ a collection of subsets of $V$. For a two-coloring $\\chi: V  \\rightarrow \\{-1,1\\}$, the discrepancy of $\\chi$ for a set $S$  is defined as $ \\chi(S) =  |\\sum_{j\\in S} \\chi(j) |$ and measures the imbalance from an even-split for $S$.\nThe discrepancy of the system $(V,\\mathcal{S})$ is defined as \n", "index": 1, "text": "\n\\[ {\\mathrm{disc}}(\\mathcal{S}) = \\min_{\\chi:V \\rightarrow \\{-1,1\\}} \\max_{S \\in \\mathcal{S}} \\chi(S). \\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"{\\mathrm{disc}}(\\mathcal{S})=\\min_{\\chi:V\\rightarrow\\{-1,1\\}}\\max_{S\\in%&#10;\\mathcal{S}}\\chi(S).\" display=\"block\"><mrow><mrow><mrow><mi>disc</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcae</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><munder><mi>min</mi><mrow><mi>\u03c7</mi><mo>:</mo><mrow><mi>V</mi><mo>\u2192</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mn>1</mn><mo stretchy=\"false\">}</mo></mrow></mrow></mrow></munder><mo>\u2061</mo><mrow><munder><mi>max</mi><mrow><mi>S</mi><mo>\u2208</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcae</mi></mrow></munder><mo>\u2061</mo><mi>\u03c7</mi></mrow></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>S</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.03311.tex", "nexttext": "\nThe above definition of discrepancy generalizes to any matrix $A$ with real entries.\nLet us index the rows of $A$ by $j$ and the columns by $i$.\nIf we relax the entries $x_i$ to be unit vectors ${v}_i$ in ${\\mathbb{R}}^n$ instead of $\\pm 1$, we obtain the relaxation\n", "itemtype": "equation", "pos": 12024, "prevtext": "\nThat is, it is the minimum imbalance for all sets in $\\mathcal{S}$, over all possible two-colorings $\\chi$.\n\nDiscrepancy is a widely studied topic and has applications to many areas in mathematics and computer science. For more background we refer the reader to the books \\cite{Chazelle,Mat99,Panorama}. In particular, discrepancy is closely related to the problem of rounding  fractional solutions of a linear system of equations to integral ones \\cite{LSV,R12}, and is widely studied in approximation algorithms and optimization.\n\nUntil recently, most of the results in discrepancy were based on non-algorithmic approaches \n\nand hence were not directly useful for algorithmic applications. \nHowever, in the last few years there has been remarkable progress in our understanding of the algorithmic aspects of discrepancy \\cite{B10,CNN11,LM12,Ro14,HSS14,ES14,NT15}. In particular, we can now match or even improve upon all known applications of the widely used partial-coloring method \\cite{Spencer85,Mat99} in discrepancy.\nThis has led to several other new results in approximation algorithms \\cite{R13,BCKL14,BN15,NTZ13}.\n\n\n\n\\paragraph{Sparse Set Systems:} \nDespite the algorithmic progress, one prominent question that has remained open is to match the known non-constructive bounds on discrepancy for low degree or sparse set systems. These systems are parametrized by $t$, that denotes the maximum number of sets that contain any element.\n Beck and Fiala \\cite{BF81} proved, using an algorithmic iterated rounding approach, that any such set system has discrepancy at most $2t-1$. They also conjectured that the discrepancy in this case is $O(t^{1/2})$. Despite much effort, this remains an elusive open question.\n\nThe best known result in this direction is due to Banaszczyk \\cite{B97}, who proved a discrepancy bound of $O((t \\log n)^{1/2})$. Unlike most results in discrepancy that are based on the partial-coloring method,\nBanaszczyk's proof is based on a very different and elegant convex geometric argument, and it is not known how to make it algorithmic.\nPrior to Banaszczyk's result, the best known non-algorithmic bound\\footnote{Throughout this paper we will assume that $t \\geq \\log^2 n$, to avoid taking minimum with the $O(t)$ bound every time.}  was $O(t^{1/2} \\log n)$ \\cite{Srin97}, based on the partial-coloring method. This bound was made algorithmic in \\cite{B10}.\nThe question of matching Banaszczyk's bound algorithmically and several related variants of the problem have received a lot of attention in recent years \\cite{N13,B13,ES14,EL15}.\n\nThe regime where the above questions are most interesting is perhaps when $t=\\log^{\\beta} n$ for some moderate value of $\\beta$. \nIf particular, if $\\beta < 1$, then the $O(t)$ Beck-Fiala bound already beats the $O((t \\log n)^{1/2})$ bound of Banaszczyk. On the other hand, if $\\beta = 1/\\epsilon$ for some small $\\epsilon$, then the partial coloring bound already gives $O(t^{1/2} \\log n) = O(t^{1/2+\\epsilon})$, and becomes asymptotically close to the conjectured $O(t^{1/2})$ bound.\n\n\n\\subsection{Our Results}\nIn this paper we give new algorithmic results that improve upon the previously known algorithmic bounds for the Beck-Fiala problem in various ways.\n\nOur first result is the following:\n\\begin{thm} \n\\label{thm:main}\nGiven any $t$-sparse set system on $n$ elements, \nthere is an efficient algorithm that with high probability, finds a coloring where each set $S \\in \\mathcal{S}$ incurs an  \n$O((t \\log n \\log |S|)^{1/2})$ discrepancy.\n\nIn particular, this gives an $O((t \\log n \\log s)^{1/2})$ discrepancy coloring, where $s$ is the size of the largest set in the system.\n\\end{thm} \n\n\nThis bound is never worse than the previous $O(t^{1/2} \\log n)$ algorithmic bound, and essentially matches Banaszczyk's bound if all sets have size $\\textrm{poly}(t)$.\nPreviously, bounds better than  $O(t^{1/2} \\log n)$ were known only for a very restricted range of $s$.\nIn particular, an $O((s \\log t)^{1/2})$ (algorithmic) bound follows by a direct application of the Lov\\'{a}sz Local Lemma (LLL). \n\nThis gives an improvement over previous algorithmic bounds for $s \\ll \\min(t \\log^2 n,t^2)$, but is much worse even for moderately larger values of $s$ such as $s=t^{10}$. It is unclear how to avoid the $s^{1/2}$ loss with LLL-based approaches\\footnote{For a set of size $s$, a random coloring incurs $\\Omega(s^{1/2})$ discrepancy with probability almost $1$.}, and the problem of improving upon the $O(t^{1/2}\\log n)$ bound was open even for the case of $s=t^2$.\n\nAs a concrete example to summarize the status of the known bounds: for $t = O(\\log^2 n)$ and $s = t^2=O(\\log^4 n)$, the conjectured Beck-Fiala bound is $O(\\log n)$,  the best known non-constructive bound is $O(\\log^{3/2} n)$, all previous algorithms incur $\\Omega(\\log^2 n)$ discrepancy, and Theorem \\ref{thm:main} above  achieves $\\tilde{O}(\\log^{3/2}n)$ where $\\tilde{O}(\\cdot)$ hides $\\textrm{poly}(\\log \\log n)$ factors.\n\n\n\n\n\n\nThe algorithm is based on a random walk based approach, similar to that in \\cite{B10}, where each step of the walk is guided by a solution to a semidefinite program (SDP). However, as we describe in Section \\ref{s:overview}, the previous partial coloring based approaches seem inherently incapable of improving upon the $O(t^{1/2} \\log n)$ bound (in fact this is true even for $s=t$, where LLL based techniques perform much better). Moreover, the previous approaches also cannot give a size-sensitive discrepancy bound for each set $S$, as in Theorem \\ref{thm:main}. \nA key new idea of our algorithm is to add some extra constraints to the SDP which ensure that {\\em every} large enough set makes enough ``progress\" towards getting colored, and to use a result of Nikolov \\cite{N13} to argue the feasibility of this SDP. \nRoughly, these constraints ensure that a set of size $|S|$ incurs an $O(\\sqrt{t})$ discrepancy in expectation for only $O(\\log |S|)$ phases. \nWe give an overview of the algorithm in Section \\ref{s:alg} after defining the relevant background in Section \\ref{s:prel}.\n\n\n\n\n\n\nWhile Theorem \\ref{thm:main} does not give anything new directly if $s$ is arbitrarily large, our method is quite versatile and readily lends to many extensions. \nThese can be used to match or almost match Banaszczyk's bound in many cases even when $s$ is arbitrary.\nThese are discussed in Theorems \\ref{thm:ext1}, \\ref{thm:ext2} and their corollaries  below.\n\n\n\n\n\n\\begin{thm}\n\\label{thm:ext1}\nFor $i=1,\\ldots,\\log n$, let $m_i$ denote the number of sets in $\\mathcal{S}$ with size in $(2^{i-1},2^{i}]$. Call these class-$i$ sets.\nThen, there is an algorithm that finds a coloring with discrepancy $O((t i (\\log m_i+\\log\\log n))^{1/2})$ for each class-$i$ set.\n\\end{thm}\n\nThe bound above  refines Theorem \\ref{thm:main} (which follows as $m_i \\leq n$ for each $i$) and can lead to substantially improved bounds when the number of large  sets is not too high.\nRecall that in general we can assume that $m_i$ is not too large, as by a standard linear algebraic argument \\cite{BF81}, one can assume that $n \\leq m$ which implies that \nthe average row size is also at most $t$ and that $m_i \\leq nt/2^{i-1}$ for every $i$.\nThe following corollary of Theorem \\ref{thm:ext1} shows that if the system satisfies\nthe stronger bound of $m_i \\leq n^{(\\log^{O(1)}t)/i}$ instead, then one can essentially match Banaszczyk's bound.\n\n\\begin{cor}\n\\label{cor1}\nIf the number of class-$i$ sets is at most $ n^{(\\log^{O(1)}t)/i}$, then there is an algorithm that finds an $\\tilde{O}((t \\log n)^{1/2})$ discrepancy coloring, where $\\tilde{O}(\\cdot)$ hides $\\mbox{poly}(\\log {t}\\log\\log {n})$ factors.\n\\end{cor}\n\n\n\n\n\n \n\n\n\n\nTheorem \\ref{thm:main} also extends to the more general setting of the Koml\\'{o}s conjecture (defined in Section \\ref{s:prel}) where the matrix entries can be arbitrary reals instead of only $0$-$1$. For this setting, Banaszczyk's result \\cite{B97} implies an $O(\\log^{1/2} n)$ non-constructive bound.\n\\begin{thm}\n\\label{thm:kom}\nGiven a matrix $A$ with $n$ columns such that the $\\ell_2$-norm of any column is at most $1$, then there is an algorithm to find a coloring where each row $j$ incurs a discrepancy of\n$O( (\\log n \\log s_j)^{1/2})$, where $s_j$ is the $\\ell_1$-norm of row $j$.\n\\end{thm}\n\n\n\n\n\nThe following extension of Theorem \\ref{thm:kom} allows further flexibility in choosing different weights $w_j$ for rows to allow improved bounds in many cases. \n\n\n\n\n\n\\begin{thm}\n\\label{thm:ext2}\nSuppose there is a reweighting of the rows $j$ with non-negative weights $w_j$ such that the $\\ell_2$-norm of any column is at most $\\beta$, then \nthe  algorithm gets a discrepancy of  $O(\\beta(\\log n\\log (w_j s_j))^{1/2}/w_j)$   for each row  $j$.\n\\end{thm}\n\nThe following corollary of Theorem \\ref{thm:ext2} shows that Banaszczyk's bound can be almost matched algorithmically if the sparsity of set system decreases suitably when restricted to very large sets, i.e.~no element lies essentially in only very large sets.\n\n\\begin{cor}\n\\label{cor2}\nGiven a $t$-sparse set system with the property that each element lies in $O(t/i^{1+\\epsilon})$ \nsets of size more than $t 2^{i-1}$ for each $i\\geq 1$, for some fixed $\\epsilon>0$, then there is an algorithm to find an $O((t \\log n \\log t)^{1/2})$ discrepancy coloring.\n\\end{cor}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\section{Preliminaries}\n\\label{s:prel}\nWe describe some of the basic concepts that we will need.\n\n\\subsection{Vector Discrepancy}\nIf $A$ is the $m\\times n$ incidence matrix of the set-system $(V,\\mathcal{S})$ with rows corresponding to the sets $S_1,\\ldots,S_m$ and columns to the elements $[n]\\footnote{We use $[n]$ to denote the set \\{1,2,\\ldots,n\\}.}$, then we can write the discrepancy of $A$ as \n", "index": 3, "text": "\n\\[ {\\mathrm{disc}}(A)= \\min_{x \\in \\{-1,1\\}^n} \\|Ax\\|_\\infty \\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"{\\mathrm{disc}}(A)=\\min_{x\\in\\{-1,1\\}^{n}}\\|Ax\\|_{\\infty}\" display=\"block\"><mrow><mrow><mi>disc</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>A</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munder><mi>min</mi><mrow><mi>x</mi><mo>\u2208</mo><msup><mrow><mo stretchy=\"false\">{</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mn>1</mn><mo stretchy=\"false\">}</mo></mrow><mi>n</mi></msup></mrow></munder><mo>\u2062</mo><msub><mrow><mo>\u2225</mo><mrow><mi>A</mi><mo>\u2062</mo><mi>x</mi></mrow><mo>\u2225</mo></mrow><mi mathvariant=\"normal\">\u221e</mi></msub></mrow></mrow></math>", "type": "latex"}, {"file": "1601.03311.tex", "nexttext": "\nWe refer to this as the vector discrepancy of $A$. The vector discrepancy can be computed efficiently (to arbitrarily high accuracy) by solving the following semidefinite program (SDP) and doing a binary search on $\\lambda$.  \n\\begin{eqnarray*}\n  \\|\\sum_{i }A_{ji} v_i \\|_2^2 & \\leq &  \\lambda^2 \\qquad  \\forall j\\in [m]\\\\\n   \\|v_i \\|_2^2 & = &  1  \\qquad \\forall i \\in [n]\n  \\end{eqnarray*}\n\n\\paragraph{Koml\\'{o}s Conjecture:}\nThe following conjecture generalizes the Beck-Fiala conjecture. \n\\begin{conj}[Koml\\'{o}s] Any matrix $A$ with columns of $\\ell_2$-norm at most $1$ has discrepancy $O(1)$. \n\\end{conj}\nThe Beck-Fiala conjecture follows by scaling the columns of the incidence matrix $A$ by $\\sqrt{t}$. While the best known bound for the Koml\\'{o}s setting \nis $O(\\log^{1/2} n)$ \\cite{B97},\nNikolov \\cite{N13} showed that the Koml\\'{o}s conjecture holds for vector colorings. In particular, he showed the following result:\n\\begin{thm}[\\cite{N13}]\n\\label{thm:sasho}\nFor any $m\\times n$ matrix $A$ with columns of $\\ell_2$-norm at most $1$, ${\\mathrm{vecdisc}}(A) \\leq 1$.\n\n\\end{thm}\nAs pointed out to us by Raghu Meka, an easy proof of ${\\mathrm{vecdisc}}(A) \\leq O(1)$ also follows\nfrom Banaszczyk's result \\cite{B97}.\n\n\\subsection {Martingales}\nLet $X_1,X_2,\\ldots,X_n$ be a sequence of independent random variables on some probability space, and let \n$Y_t$ be a function of $X_1,\\ldots,X_t$. The sequence \n$Y_0,Y_1,Y_2,\\ldots,Y_n$ is called a martingale with respect to the sequence $X_1,\\ldots,X_n$ if for all $t \\in [n]$, \n${\\mathbb{E}}[|Y_t|]$ is finite and ${\\mathbb{E}}[Y_t| X_1,X_2,...,X_{t-1}]= Y_{t-1}$. We will use ${\\mathbb{E}}_{t-1}[Y_t]$ to denote ${\\mathbb{E}}[Y_t | X_1,X_2,...,X_{t-1}]$.\n\n\n\nWe will need the following martingale concentration inequality.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\begin{thm}[Freedman \\cite{Freedman}]\n\\label{thm:freedman}\nLet $Y_1,\\ldots,Y_n$ be a martingale with respect to $X_1,\\ldots,X_n$ such that \n$|Y_t - Y_{t-1}| \\leq M$ for all $t$, and let $W_t = \\sum_{j=1}^t {\\mathbb{E}}_{j-1}[(Y_j - Y_{j-1})^2] = \\sum_{j=1}^t\n\\textrm{Var}[Y_j|X_{1},\\ldots,X_{j-1}]$.\nThen for all $\\lambda \\geq 0$  and $\\sigma^2 \\geq 0$, we have \n", "itemtype": "equation", "pos": 12355, "prevtext": "\nThe above definition of discrepancy generalizes to any matrix $A$ with real entries.\nLet us index the rows of $A$ by $j$ and the columns by $i$.\nIf we relax the entries $x_i$ to be unit vectors ${v}_i$ in ${\\mathbb{R}}^n$ instead of $\\pm 1$, we obtain the relaxation\n", "index": 5, "text": "\n\\[ {\\mathrm{vecdisc}}(A) = \\min_{{v}_1,\\ldots,{v}_n \\in S^{n-1}} \\max_{j=1}^m \\|\\sum_{i=1}^n A_{ji} {v}_i \\|_2. \\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"{\\mathrm{vecdisc}}(A)=\\min_{{v}_{1},\\ldots,{v}_{n}\\in S^{n-1}}\\max_{j=1}^{m}\\|%&#10;\\sum_{i=1}^{n}A_{ji}{v}_{i}\\|_{2}.\" display=\"block\"><mrow><mrow><mrow><mi>vecdisc</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>A</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><munder><mi>min</mi><mrow><mrow><msub><mi>v</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><msub><mi>v</mi><mi>n</mi></msub></mrow><mo>\u2208</mo><msup><mi>S</mi><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow></munder><mo>\u2061</mo><munderover><mi>max</mi><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover></mrow><mo>\u2062</mo><msub><mrow><mo>\u2225</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><msub><mi>A</mi><mrow><mi>j</mi><mo>\u2062</mo><mi>i</mi></mrow></msub><mo>\u2062</mo><msub><mi>v</mi><mi>i</mi></msub></mrow></mrow><mo>\u2225</mo></mrow><mn>2</mn></msub></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.03311.tex", "nexttext": " \n\\end{thm}\n\n\n\\section{The Main Result}\n\\label{s:alg}\nIn this section we describe the main algorithm and prove Theorem \\ref{thm:main}. \n\n\\subsection{High-level Overview}\n\\label{s:overview}\n The algorithm has a similar structure to previous random walk based approaches.\nThe algorithm starts with the coloring $x_0=0^n$ at time $0$, and at each time step $k$, updates the coloring at time $k-1$ by adding a small increment. This increment is determined by solving an appropriate SDP.\nIf a variable reaches $-1$ or $1$ it is frozen, and its value is not updated any more. The variables that are not frozen are called alive.\n\n\n\n\\paragraph{Limitations of partial coloring based approaches:}\nHowever, the previous algorithms based on these approaches are only able to give a discrepancy of $O(t^{1/2} \\log n)$ for the following reason. Roughly speaking, the execution of the algorithm can be divided into $O(\\log n)$ phases. In each phase, about half the variables get frozen, and the updates of the coloring at each time step are chosen so that each set incurs an expected discrepancy of $O(\\sqrt{t})$ during a phase.\nSo after $O(\\log n)$ phases each set incurs an expected discrepancy of $O((t \\log n)^{1/2})$, and to bound the maximum discrepancy, one then takes a union bound over the $m$ sets and loses an additional $\\log^{1/2} m\\approx \\log^{1/2} n$ factor.\n\nIf one could show a stronger statement that in each phase, the number of alive variables for {\\em every} set\nreduces by a constant factor, then each set $S_j$ would get colored in at most $O(\\log |S_j|)$ phases, and the expected discrepancy for a set would be $O((t \\log |S_j|)^{1/2}$  (instead of the $O((t \\log n)^{1/2})$ previously). Theorem \\ref{thm:main} would then follow after losing another $\\log^{1/2} n$ factor for the union bound over the sets. \n\nHowever, the property that every set reduces in size is non-trivial to guarantee. For example, even in the non-constructive partial coloring based methods \\cite{Mat99}, in each partial coloring step (i.e.~a phase) one can only guarantee that half the remaining variables (globally) get colored, and there could be several sets that incur $\\Omega(\\sqrt{t})$ discrepancy even though very few of their elements get colored. In particular, these methods incur an $O(t^{1/2} \\log n)$ discrepancy even if all the sets are of size $t$.\n\n\\paragraph{New idea:}\nThe main idea of our algorithm is to add additional SDP constraints, given by (\\ref{sdp2}), that we call the energy constraints that ensure that the ``energy\" of {\\em each} (large enough) set increases significantly in each phase. \nThis can be used to show that for each set $S\\in \\mathcal{S}$, essentially all of its elements will get colored in $O(\\log |S|)$ phases. \nIn contrast, the previous algorithms only ensured a global energy constraint over all the variables to measure progress of the algorithm. Moreover, the feasibility\nproblem for this SDP can be viewed as a vector discrepancy problem for another matrix where the $\\ell_2$-norm remains $O(1)$. Theorem \\ref{thm:sasho} then guarantees feasibility.\nThe main technical part of the analysis is to show that these new energy constraints are sufficient to guarantee the progress property for each set.\n\nTheorems \\ref{thm:main} and \\ref{thm:kom} follows quite directly from the above approach. The extensions in theorems \\ref{thm:ext1} and \\ref{thm:ext2} also follow the general approach above, but use some additional flexibility in the approach to trade off and balance the different parameters.\n\n\n\n\\subsection{Algorithm}\n\nWe will index time by $k$.\nLet $x_k\\in [-1,1]^n$ denote the coloring at the end of time step $k$. During the algorithm,\nvariables which get set to at least $(1-1/n)$ in absolute value are called frozen and their values are not changed any more. The remaining variables are called alive. We denote by $A(k)$ the set of alive variables at the end of time step $k$. Initially all variables are alive. Let $\\gamma = n^{-2}$, and let $T= (10/\\gamma^2) \\log n$.\n\n\n\n\n\n\\begin{enumerate}\n\\item Initialize $x_0(i) =0$ for all $i\\in [n]$ and $A(0)=\\{1,2,...,n\\}$. \n\n\\item  For each time step $k=1,2,\\ldots, T$ repeat the following:\n\\begin{enumerate}\n\n\\item \\label{apx:step1}\n Find a feasible solution to the following semidefinite program:\n\\begin{eqnarray}\n\\label{sdp1}  \\|\\sum_{i \\in S_j} v_i\\|_2^2 & \\leq &  \\ 2t \\qquad  \\textrm{for each set }  S_j\\\\\n\\label{sdp2}  \\| \\sum_{i\\in S_j}x_{k-1}(i) v_i\\|_2^2  & \\leq & \\ 2t \\qquad \\textrm{for each set } S_j\\\\\n   \\|v_i\\|_2^2 & = &  1  \\qquad \\forall i \\in A(k-1) \\nonumber \\\\\n   \\| v_i\\|_2^2 & = & 0  \\qquad \\forall i \\notin A(k-1) \\nonumber\n  \\end{eqnarray}\n\\item \n\\label{apx:round}\nConstruct $\\gamma_k \\in \\mathbb{R}^n$ as follows: \nlet $r \\in {\\mathbb{R}}^n$ be a random $\\pm 1$ vector, obtained by setting each coordinate $r(i)$ independently to $-1$ or $1$ with probability $1/2$.\n\n\nFor each $i \\in [n]$, let $\\gamma_k(i) = \\gamma \\langle r,v_i \\rangle.$\nUpdate $x_k = x_{k-1} + \\gamma_k$. \n\n\n\n\\item\n\\label{apx:rnd}\n Initialize $A(k)=A(k-1)$.\n\nFor each $i$, if $x_k(i)\\geq 1-1/n$ or  $x_k(i) \\leq -1+1/n$, update $A(k) = A(k) \\setminus \\{i\\}$.\n\\end{enumerate}\n\\item \n\\label{stp3}\nGenerate the final coloring as follows.\nSet $x_T(i)=1$ if $x_T(i)\\geq 1-1/n$ and set $x_T(i)=-1$ if $x_T(i) \\leq -1+1/n$.\nIf $i \\in A(T)$, set $x_T(i)$ arbitrarily to $\\pm 1$. \n\\end{enumerate}\n\n\n\\subsection{Analysis}\n\n\nWe begin with some simple observations.\n\n\\begin{lemma}\n The SDP is feasible at each time step $k$.\n\\end{lemma} \n\\begin{proof}\nConsider the incidence matrix $A$ of the set system. \nFor each row $A_j$ of  $A$ corresponding to $S_j$, we add another row \n$A'_j = A_j\\textrm{ diag}(x_{k-1})$, where $\\textrm{diag}(x_{k-1}) $ is the $n\\times n$ diagonal matrix with the $(i,i)$ entry\n$x_{k-1}(i)$. In other words, $A'$ is obtained by scaling the $i$-th column of $A$ by $x_{k-1}(i)$.\nAs $|x_{k-1}(i)|\\le 1$ for each $i$, the $\\ell_2$-norm of this augmented matrix $A\\cup A'$ is at most $\\sqrt{2t}$.\n\nAs the SDP in the algorithm above corresponds to finding a vector coloring (restricted to the alive elements) \nwith discrepancy $\\sqrt{2t}$ for the $2m \\times n$ augmented matrix $A \\cup A'$, Theorem \\ref{thm:sasho} implies that it has a feasible solution. \n\\end{proof}\n\n\n\n\n\n\n\n\\begin{lemma}\n\\label{lem:tri}\nFor any vector $v \\in {\\mathbb{R}}^n$ and a random $\\pm 1$ vector $r \\in {\\mathbb{R}}^n$,  ${\\mathbb{E}}[\\langle r,v\\rangle^2] = \\|v\\|_2^2$   \nand $|\\langle r,v\\rangle | \\leq \\sqrt{n}\\|v\\|_2$.\n\\end{lemma}\n\\begin{proof}\nWriting $v$ in terms of its coordinates $v=(v(1),\\ldots,v(n))$,  \n", "itemtype": "equation", "pos": -1, "prevtext": "\nWe refer to this as the vector discrepancy of $A$. The vector discrepancy can be computed efficiently (to arbitrarily high accuracy) by solving the following semidefinite program (SDP) and doing a binary search on $\\lambda$.  \n\\begin{eqnarray*}\n  \\|\\sum_{i }A_{ji} v_i \\|_2^2 & \\leq &  \\lambda^2 \\qquad  \\forall j\\in [m]\\\\\n   \\|v_i \\|_2^2 & = &  1  \\qquad \\forall i \\in [n]\n  \\end{eqnarray*}\n\n\\paragraph{Koml\\'{o}s Conjecture:}\nThe following conjecture generalizes the Beck-Fiala conjecture. \n\\begin{conj}[Koml\\'{o}s] Any matrix $A$ with columns of $\\ell_2$-norm at most $1$ has discrepancy $O(1)$. \n\\end{conj}\nThe Beck-Fiala conjecture follows by scaling the columns of the incidence matrix $A$ by $\\sqrt{t}$. While the best known bound for the Koml\\'{o}s setting \nis $O(\\log^{1/2} n)$ \\cite{B97},\nNikolov \\cite{N13} showed that the Koml\\'{o}s conjecture holds for vector colorings. In particular, he showed the following result:\n\\begin{thm}[\\cite{N13}]\n\\label{thm:sasho}\nFor any $m\\times n$ matrix $A$ with columns of $\\ell_2$-norm at most $1$, ${\\mathrm{vecdisc}}(A) \\leq 1$.\n\n\\end{thm}\nAs pointed out to us by Raghu Meka, an easy proof of ${\\mathrm{vecdisc}}(A) \\leq O(1)$ also follows\nfrom Banaszczyk's result \\cite{B97}.\n\n\\subsection {Martingales}\nLet $X_1,X_2,\\ldots,X_n$ be a sequence of independent random variables on some probability space, and let \n$Y_t$ be a function of $X_1,\\ldots,X_t$. The sequence \n$Y_0,Y_1,Y_2,\\ldots,Y_n$ is called a martingale with respect to the sequence $X_1,\\ldots,X_n$ if for all $t \\in [n]$, \n${\\mathbb{E}}[|Y_t|]$ is finite and ${\\mathbb{E}}[Y_t| X_1,X_2,...,X_{t-1}]= Y_{t-1}$. We will use ${\\mathbb{E}}_{t-1}[Y_t]$ to denote ${\\mathbb{E}}[Y_t | X_1,X_2,...,X_{t-1}]$.\n\n\n\nWe will need the following martingale concentration inequality.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\begin{thm}[Freedman \\cite{Freedman}]\n\\label{thm:freedman}\nLet $Y_1,\\ldots,Y_n$ be a martingale with respect to $X_1,\\ldots,X_n$ such that \n$|Y_t - Y_{t-1}| \\leq M$ for all $t$, and let $W_t = \\sum_{j=1}^t {\\mathbb{E}}_{j-1}[(Y_j - Y_{j-1})^2] = \\sum_{j=1}^t\n\\textrm{Var}[Y_j|X_{1},\\ldots,X_{j-1}]$.\nThen for all $\\lambda \\geq 0$  and $\\sigma^2 \\geq 0$, we have \n", "index": 7, "text": "\n\\[ \\Pr[|Y_n - Y_0| \\geq \\lambda \\textrm{ and } W_n \\leq \\sigma^2]\\le 2 \\exp\\left(-\\frac{\\lambda^2}{2 (\\sigma^2 + M \\lambda/3)} \\right). \\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m1\" class=\"ltx_Math\" alttext=\"\\Pr[|Y_{n}-Y_{0}|\\geq\\lambda\\textrm{ and }W_{n}\\leq\\sigma^{2}]\\leq 2\\exp\\left(%&#10;-\\frac{\\lambda^{2}}{2(\\sigma^{2}+M\\lambda/3)}\\right).\" display=\"block\"><mrow><mrow><mrow><mi>Pr</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mrow><mo stretchy=\"false\">|</mo><mrow><msub><mi>Y</mi><mi>n</mi></msub><mo>-</mo><msub><mi>Y</mi><mn>0</mn></msub></mrow><mo stretchy=\"false\">|</mo></mrow><mo>\u2265</mo><mrow><mi>\u03bb</mi><mo>\u2062</mo><mtext>\u00a0and\u00a0</mtext><mo>\u2062</mo><msub><mi>W</mi><mi>n</mi></msub></mrow><mo>\u2264</mo><msup><mi>\u03c3</mi><mn>2</mn></msup></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mo>\u2264</mo><mrow><mn>2</mn><mo>\u2062</mo><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo>(</mo><mrow><mo>-</mo><mfrac><msup><mi>\u03bb</mi><mn>2</mn></msup><mrow><mn>2</mn><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mi>\u03c3</mi><mn>2</mn></msup><mo>+</mo><mrow><mrow><mi>M</mi><mo>\u2062</mo><mi>\u03bb</mi></mrow><mo>/</mo><mn>3</mn></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mrow><mo>)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.03311.tex", "nexttext": "\nwhere the last equality uses that ${\\mathbb{E}}[r(i)r(j)]=0$ for $i \\neq j$  and ${\\mathbb{E}}[r(i)^2]=1$.\n\nThe second part follows by Cauchy-Schwarz inequality, as $|\\langle r,v\\rangle | \\leq \\|r\\|_2 \\|v\\|_2 = \\sqrt{n}\\|v\\|_2$.\n\\end{proof}\n\n\n\n\nThis implies the following.\n\n\\begin{obs}\nAs $\\|v_i\\| \\leq 1$, $|\\gamma \\langle r,v_i \\rangle |\\leq \\gamma\\sqrt{n} \\|v_i\\|_2 \\leq 1/n$, the rounding in step \\ref{stp3} affects the discrepancy of any set by at most $n \\cdot (1/n)=1$. So we can ignore this rounding error.\nMoreover, $|\\gamma \\langle r,v_i \\rangle | \\leq 1/n$ also implies that no $x_k(i)$ goes out of the range $[-1,1]$ during any step of the algorithm.\n\\end{obs}\n\n\n\n\nLet us divide the execution of the algorithm into $ p=10\\log n$ phases each consisting of $L:=1/\\gamma^2$ time steps.\nThe following lemma says that the discrepancy added in a few phases cannot be too large.\n\n\n\\begin{lemma}\n\\label{lem:initial-disc}\nFix a set $S\\in\\mathcal{S}$ and some $\\ell \\in [p]$. \n\nThen, for any $ 0 \\leq \\beta  \\leq  1/(\\gamma\\sqrt{n}) = n^{3/2}$, the discrepancy of $S$, $disc(S)$, after $\\ell$ phases satisfies\n", "itemtype": "equation", "pos": 21350, "prevtext": " \n\\end{thm}\n\n\n\\section{The Main Result}\n\\label{s:alg}\nIn this section we describe the main algorithm and prove Theorem \\ref{thm:main}. \n\n\\subsection{High-level Overview}\n\\label{s:overview}\n The algorithm has a similar structure to previous random walk based approaches.\nThe algorithm starts with the coloring $x_0=0^n$ at time $0$, and at each time step $k$, updates the coloring at time $k-1$ by adding a small increment. This increment is determined by solving an appropriate SDP.\nIf a variable reaches $-1$ or $1$ it is frozen, and its value is not updated any more. The variables that are not frozen are called alive.\n\n\n\n\\paragraph{Limitations of partial coloring based approaches:}\nHowever, the previous algorithms based on these approaches are only able to give a discrepancy of $O(t^{1/2} \\log n)$ for the following reason. Roughly speaking, the execution of the algorithm can be divided into $O(\\log n)$ phases. In each phase, about half the variables get frozen, and the updates of the coloring at each time step are chosen so that each set incurs an expected discrepancy of $O(\\sqrt{t})$ during a phase.\nSo after $O(\\log n)$ phases each set incurs an expected discrepancy of $O((t \\log n)^{1/2})$, and to bound the maximum discrepancy, one then takes a union bound over the $m$ sets and loses an additional $\\log^{1/2} m\\approx \\log^{1/2} n$ factor.\n\nIf one could show a stronger statement that in each phase, the number of alive variables for {\\em every} set\nreduces by a constant factor, then each set $S_j$ would get colored in at most $O(\\log |S_j|)$ phases, and the expected discrepancy for a set would be $O((t \\log |S_j|)^{1/2}$  (instead of the $O((t \\log n)^{1/2})$ previously). Theorem \\ref{thm:main} would then follow after losing another $\\log^{1/2} n$ factor for the union bound over the sets. \n\nHowever, the property that every set reduces in size is non-trivial to guarantee. For example, even in the non-constructive partial coloring based methods \\cite{Mat99}, in each partial coloring step (i.e.~a phase) one can only guarantee that half the remaining variables (globally) get colored, and there could be several sets that incur $\\Omega(\\sqrt{t})$ discrepancy even though very few of their elements get colored. In particular, these methods incur an $O(t^{1/2} \\log n)$ discrepancy even if all the sets are of size $t$.\n\n\\paragraph{New idea:}\nThe main idea of our algorithm is to add additional SDP constraints, given by (\\ref{sdp2}), that we call the energy constraints that ensure that the ``energy\" of {\\em each} (large enough) set increases significantly in each phase. \nThis can be used to show that for each set $S\\in \\mathcal{S}$, essentially all of its elements will get colored in $O(\\log |S|)$ phases. \nIn contrast, the previous algorithms only ensured a global energy constraint over all the variables to measure progress of the algorithm. Moreover, the feasibility\nproblem for this SDP can be viewed as a vector discrepancy problem for another matrix where the $\\ell_2$-norm remains $O(1)$. Theorem \\ref{thm:sasho} then guarantees feasibility.\nThe main technical part of the analysis is to show that these new energy constraints are sufficient to guarantee the progress property for each set.\n\nTheorems \\ref{thm:main} and \\ref{thm:kom} follows quite directly from the above approach. The extensions in theorems \\ref{thm:ext1} and \\ref{thm:ext2} also follow the general approach above, but use some additional flexibility in the approach to trade off and balance the different parameters.\n\n\n\n\\subsection{Algorithm}\n\nWe will index time by $k$.\nLet $x_k\\in [-1,1]^n$ denote the coloring at the end of time step $k$. During the algorithm,\nvariables which get set to at least $(1-1/n)$ in absolute value are called frozen and their values are not changed any more. The remaining variables are called alive. We denote by $A(k)$ the set of alive variables at the end of time step $k$. Initially all variables are alive. Let $\\gamma = n^{-2}$, and let $T= (10/\\gamma^2) \\log n$.\n\n\n\n\n\n\\begin{enumerate}\n\\item Initialize $x_0(i) =0$ for all $i\\in [n]$ and $A(0)=\\{1,2,...,n\\}$. \n\n\\item  For each time step $k=1,2,\\ldots, T$ repeat the following:\n\\begin{enumerate}\n\n\\item \\label{apx:step1}\n Find a feasible solution to the following semidefinite program:\n\\begin{eqnarray}\n\\label{sdp1}  \\|\\sum_{i \\in S_j} v_i\\|_2^2 & \\leq &  \\ 2t \\qquad  \\textrm{for each set }  S_j\\\\\n\\label{sdp2}  \\| \\sum_{i\\in S_j}x_{k-1}(i) v_i\\|_2^2  & \\leq & \\ 2t \\qquad \\textrm{for each set } S_j\\\\\n   \\|v_i\\|_2^2 & = &  1  \\qquad \\forall i \\in A(k-1) \\nonumber \\\\\n   \\| v_i\\|_2^2 & = & 0  \\qquad \\forall i \\notin A(k-1) \\nonumber\n  \\end{eqnarray}\n\\item \n\\label{apx:round}\nConstruct $\\gamma_k \\in \\mathbb{R}^n$ as follows: \nlet $r \\in {\\mathbb{R}}^n$ be a random $\\pm 1$ vector, obtained by setting each coordinate $r(i)$ independently to $-1$ or $1$ with probability $1/2$.\n\n\nFor each $i \\in [n]$, let $\\gamma_k(i) = \\gamma \\langle r,v_i \\rangle.$\nUpdate $x_k = x_{k-1} + \\gamma_k$. \n\n\n\n\\item\n\\label{apx:rnd}\n Initialize $A(k)=A(k-1)$.\n\nFor each $i$, if $x_k(i)\\geq 1-1/n$ or  $x_k(i) \\leq -1+1/n$, update $A(k) = A(k) \\setminus \\{i\\}$.\n\\end{enumerate}\n\\item \n\\label{stp3}\nGenerate the final coloring as follows.\nSet $x_T(i)=1$ if $x_T(i)\\geq 1-1/n$ and set $x_T(i)=-1$ if $x_T(i) \\leq -1+1/n$.\nIf $i \\in A(T)$, set $x_T(i)$ arbitrarily to $\\pm 1$. \n\\end{enumerate}\n\n\n\\subsection{Analysis}\n\n\nWe begin with some simple observations.\n\n\\begin{lemma}\n The SDP is feasible at each time step $k$.\n\\end{lemma} \n\\begin{proof}\nConsider the incidence matrix $A$ of the set system. \nFor each row $A_j$ of  $A$ corresponding to $S_j$, we add another row \n$A'_j = A_j\\textrm{ diag}(x_{k-1})$, where $\\textrm{diag}(x_{k-1}) $ is the $n\\times n$ diagonal matrix with the $(i,i)$ entry\n$x_{k-1}(i)$. In other words, $A'$ is obtained by scaling the $i$-th column of $A$ by $x_{k-1}(i)$.\nAs $|x_{k-1}(i)|\\le 1$ for each $i$, the $\\ell_2$-norm of this augmented matrix $A\\cup A'$ is at most $\\sqrt{2t}$.\n\nAs the SDP in the algorithm above corresponds to finding a vector coloring (restricted to the alive elements) \nwith discrepancy $\\sqrt{2t}$ for the $2m \\times n$ augmented matrix $A \\cup A'$, Theorem \\ref{thm:sasho} implies that it has a feasible solution. \n\\end{proof}\n\n\n\n\n\n\n\n\\begin{lemma}\n\\label{lem:tri}\nFor any vector $v \\in {\\mathbb{R}}^n$ and a random $\\pm 1$ vector $r \\in {\\mathbb{R}}^n$,  ${\\mathbb{E}}[\\langle r,v\\rangle^2] = \\|v\\|_2^2$   \nand $|\\langle r,v\\rangle | \\leq \\sqrt{n}\\|v\\|_2$.\n\\end{lemma}\n\\begin{proof}\nWriting $v$ in terms of its coordinates $v=(v(1),\\ldots,v(n))$,  \n", "index": 9, "text": "\n\\[ {\\mathbb{E}}[\\langle r,v\\rangle^2] =  {\\mathbb{E}} [(\\sum_i  r(i) v(i) )^2]  = \\sum_{i,j} {\\mathbb{E}}[r(i)r(j)] v(i)v(j)  = \\|v\\|_2^2 \\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m1\" class=\"ltx_Math\" alttext=\"{\\mathbb{E}}[\\langle r,v\\rangle^{2}]={\\mathbb{E}}[(\\sum_{i}r(i)v(i))^{2}]=\\sum%&#10;_{i,j}{\\mathbb{E}}[r(i)r(j)]v(i)v(j)=\\|v\\|_{2}^{2}\" display=\"block\"><mrow><mrow><mi>\ud835\udd3c</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><msup><mrow><mo stretchy=\"false\">\u27e8</mo><mi>r</mi><mo>,</mo><mi>v</mi><mo stretchy=\"false\">\u27e9</mo></mrow><mn>2</mn></msup><mo stretchy=\"false\">]</mo></mrow></mrow><mo>=</mo><mrow><mi>\ud835\udd3c</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mi>i</mi></munder><mrow><mi>r</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>v</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup><mo stretchy=\"false\">]</mo></mrow></mrow><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></munder><mrow><mi>\ud835\udd3c</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mi>r</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>r</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>j</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">]</mo></mrow><mo>\u2062</mo><mi>v</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>v</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>j</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>=</mo><msubsup><mrow><mo>\u2225</mo><mi>v</mi><mo>\u2225</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow></math>", "type": "latex"}, {"file": "1601.03311.tex", "nexttext": "\n\\end{lemma}\n\\begin{proof}\nLet $Y_k = {\\mathrm{disc}}_{k}(S)$ denote the discrepancy of $S$ after time $k$. Then, $Y_k = Y_{k-1} + \\gamma \\langle r^k, \\sum_{i \\in S} v^k_i\\rangle$, where $r^k$ denotes the random $\\pm 1$ vector at time $k$ and $v_i^k$ is the vector for $i$ in the SDP solution at time $k$.\nAs ${\\mathbb{E}}[r^k,v]=0$ for any vector $v$ and the $r^k$ are independent, $Y_k$ forms a martingale with respect to $r^1,r^2\\ldots$.\n\nSo we can apply Theorem \\ref{thm:freedman}. By the SDP constraint \\eqref{sdp1} we can bound,\n", "itemtype": "equation", "pos": 22603, "prevtext": "\nwhere the last equality uses that ${\\mathbb{E}}[r(i)r(j)]=0$ for $i \\neq j$  and ${\\mathbb{E}}[r(i)^2]=1$.\n\nThe second part follows by Cauchy-Schwarz inequality, as $|\\langle r,v\\rangle | \\leq \\|r\\|_2 \\|v\\|_2 = \\sqrt{n}\\|v\\|_2$.\n\\end{proof}\n\n\n\n\nThis implies the following.\n\n\\begin{obs}\nAs $\\|v_i\\| \\leq 1$, $|\\gamma \\langle r,v_i \\rangle |\\leq \\gamma\\sqrt{n} \\|v_i\\|_2 \\leq 1/n$, the rounding in step \\ref{stp3} affects the discrepancy of any set by at most $n \\cdot (1/n)=1$. So we can ignore this rounding error.\nMoreover, $|\\gamma \\langle r,v_i \\rangle | \\leq 1/n$ also implies that no $x_k(i)$ goes out of the range $[-1,1]$ during any step of the algorithm.\n\\end{obs}\n\n\n\n\nLet us divide the execution of the algorithm into $ p=10\\log n$ phases each consisting of $L:=1/\\gamma^2$ time steps.\nThe following lemma says that the discrepancy added in a few phases cannot be too large.\n\n\n\\begin{lemma}\n\\label{lem:initial-disc}\nFix a set $S\\in\\mathcal{S}$ and some $\\ell \\in [p]$. \n\nThen, for any $ 0 \\leq \\beta  \\leq  1/(\\gamma\\sqrt{n}) = n^{3/2}$, the discrepancy of $S$, $disc(S)$, after $\\ell$ phases satisfies\n", "index": 11, "text": "\n\\[ \\Pr[{\\mathrm{disc}}(S) \\geq  \\beta \\sqrt{2 t \\ell} ] \\leq 2 \\exp(- \\beta^2/3) \\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex6.m1\" class=\"ltx_Math\" alttext=\"\\Pr[{\\mathrm{disc}}(S)\\geq\\beta\\sqrt{2t\\ell}]\\leq 2\\exp(-\\beta^{2}/3)\" display=\"block\"><mrow><mrow><mi>Pr</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mrow><mi>disc</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>S</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2265</mo><mrow><mi>\u03b2</mi><mo>\u2062</mo><msqrt><mrow><mn>2</mn><mo>\u2062</mo><mi>t</mi><mo>\u2062</mo><mi mathvariant=\"normal\">\u2113</mi></mrow></msqrt></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mo>\u2264</mo><mrow><mn>2</mn><mo>\u2062</mo><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mrow><msup><mi>\u03b2</mi><mn>2</mn></msup><mo>/</mo><mn>3</mn></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.03311.tex", "nexttext": "\n\nSimilarly, by Lemma \\ref{lem:tri} ,\n", "itemtype": "equation", "pos": 23221, "prevtext": "\n\\end{lemma}\n\\begin{proof}\nLet $Y_k = {\\mathrm{disc}}_{k}(S)$ denote the discrepancy of $S$ after time $k$. Then, $Y_k = Y_{k-1} + \\gamma \\langle r^k, \\sum_{i \\in S} v^k_i\\rangle$, where $r^k$ denotes the random $\\pm 1$ vector at time $k$ and $v_i^k$ is the vector for $i$ in the SDP solution at time $k$.\nAs ${\\mathbb{E}}[r^k,v]=0$ for any vector $v$ and the $r^k$ are independent, $Y_k$ forms a martingale with respect to $r^1,r^2\\ldots$.\n\nSo we can apply Theorem \\ref{thm:freedman}. By the SDP constraint \\eqref{sdp1} we can bound,\n", "index": 13, "text": "\n\\[ M\\le |\\gamma \\langle r^k, \\sum_{i \\in S} v^k_i\\rangle| \\leq \\gamma \\|r^k\\|_2 \\|\\sum_{i \\in S} v^k_i\\|_2 \\leq  \\gamma n^{1/2} \\cdot \\sqrt{2t} \\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex7.m1\" class=\"ltx_Math\" alttext=\"M\\leq|\\gamma\\langle r^{k},\\sum_{i\\in S}v^{k}_{i}\\rangle|\\leq\\gamma\\|r^{k}\\|_{2%&#10;}\\|\\sum_{i\\in S}v^{k}_{i}\\|_{2}\\leq\\gamma n^{1/2}\\cdot\\sqrt{2t}\" display=\"block\"><mrow><mi>M</mi><mo>\u2264</mo><mrow><mo stretchy=\"false\">|</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">\u27e8</mo><msup><mi>r</mi><mi>k</mi></msup><mo>,</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>\u2208</mo><mi>S</mi></mrow></munder><msubsup><mi>v</mi><mi>i</mi><mi>k</mi></msubsup></mrow><mo stretchy=\"false\">\u27e9</mo></mrow></mrow><mo stretchy=\"false\">|</mo></mrow><mo>\u2264</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><msub><mrow><mo>\u2225</mo><msup><mi>r</mi><mi>k</mi></msup><mo>\u2225</mo></mrow><mn>2</mn></msub><mo>\u2062</mo><msub><mrow><mo>\u2225</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>\u2208</mo><mi>S</mi></mrow></munder><msubsup><mi>v</mi><mi>i</mi><mi>k</mi></msubsup></mrow><mo>\u2225</mo></mrow><mn>2</mn></msub></mrow><mo>\u2264</mo><mrow><mrow><mi>\u03b3</mi><mo>\u2062</mo><msup><mi>n</mi><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow></msup></mrow><mo>\u22c5</mo><msqrt><mrow><mn>2</mn><mo>\u2062</mo><mi>t</mi></mrow></msqrt></mrow></mrow></math>", "type": "latex"}, {"file": "1601.03311.tex", "nexttext": "  \nThis implies that $W_k \\leq 2 kt \\gamma^2$ for all $k$.  Applying Freedman's inequality from Theorem \\ref{thm:freedman} with these bounds on $M$ and $W_k$, we obtain\n\n\\begin{eqnarray*}\n \\Pr[{\\mathrm{disc}}_{\\ell L}(S) \\geq   \\beta \\sqrt{2 t \\ell} ] & \\leq & 2 \\exp \\left( -\\frac{\\beta^2 2t \\ell }{2 (W_{\\ell L} + M \\beta \\sqrt{2t \\ell}/3) } \\right) \\\\\n& \\leq  & \n 2 \\exp\\left(- \\frac{2 t \\ell \\beta^2}{2 (2\\ell L t \\gamma^2 + \\gamma \\beta \\sqrt{2nt} \\sqrt{2t \\ell} /3)} \\right) \\\\\n& \\leq &  2 \\exp\\left(- \\frac{\\beta^2}{(2 + \\gamma \\beta \\sqrt{n})} \\right)  \\leq 2 \\exp(-\\beta^2/3).\n\\end{eqnarray*}\n\nThe last step uses that $\\beta \\gamma \\sqrt{n} \\leq  1$. \n\\end{proof}\n\nFor a set $S$, let $A_S(k)$ denote the number of alive elements in set $S$ at the end of time step $k$.\n\\begin{defn}[Energy Deficit]\nFor a set $S\\in\\mathcal{S}$ and given a coloring $x_k$ at the end of time $k$, the {\\em energy deficit} of $S$ is defined as \n $D_S(k) = \\sum_{i \\in S} (1-x_k^2(i))$.\n\\end{defn}\n\nInitially at time $k=0$, the energy deficit of any set $S\\in\\mathcal{S}$ is $|S|$, and is always non-negative. We also note the following.\n\n\\begin{lemma} \n\\label{l:dsas}\nFor any set $S\\in\\mathcal{S}$ and time $k$, it holds that the number of alive elements $ A_S(k) \\geq D_S(k) -2 $.\n\\end{lemma}\n\\begin{proof}\nAny frozen element can contribute at most  $1- (1-1/n)^2 \\leq 2/n$ to the energy deficit. Moreover, since each alive alive element can contribute at most $1$, $D_S(k) \\leq A_S(k) + n \\cdot (2/n)$ and the result follows.  \n\\end{proof}\n\n\nWe now come to the  key part of the proof, which shows that for each large enough set, its energy deficit decreases substantially in each phase, with sufficiently high probability. \n\n\n\n\n\\begin{thm}\n\\label{thm:winwin}\nFix a set $S\\in\\mathcal{S}$ and a time $k$. For any $\\lambda \\geq 0$, \n\nwith probability at least $1-4\\exp(-\\lambda^2/100t)$, it holds that\n\n", "itemtype": "equation", "pos": -1, "prevtext": "\n\nSimilarly, by Lemma \\ref{lem:tri} ,\n", "index": 15, "text": "\n\\[{\\mathbb{E}}_{k-1}[(Y_k-Y_{k-1})^2] = {\\mathbb{E}}[\\gamma^2  \\langle r^k, \\sum_{i \\in S} v^k_i\\rangle^2] = \\gamma^2 \\|\\sum_{i \\in S} v^k_i \\|_2^2 \\leq 2 t \\gamma^2. \\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex8.m1\" class=\"ltx_Math\" alttext=\"{\\mathbb{E}}_{k-1}[(Y_{k}-Y_{k-1})^{2}]={\\mathbb{E}}[\\gamma^{2}\\langle r^{k},%&#10;\\sum_{i\\in S}v^{k}_{i}\\rangle^{2}]=\\gamma^{2}\\|\\sum_{i\\in S}v^{k}_{i}\\|_{2}^{2%&#10;}\\leq 2t\\gamma^{2}.\" display=\"block\"><mrow><mrow><mrow><msub><mi>\ud835\udd3c</mi><mrow><mi>k</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>Y</mi><mi>k</mi></msub><mo>-</mo><msub><mi>Y</mi><mrow><mi>k</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup><mo stretchy=\"false\">]</mo></mrow></mrow><mo>=</mo><mrow><mi>\ud835\udd3c</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><msup><mi>\u03b3</mi><mn>2</mn></msup><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">\u27e8</mo><msup><mi>r</mi><mi>k</mi></msup><mo>,</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>\u2208</mo><mi>S</mi></mrow></munder><msubsup><mi>v</mi><mi>i</mi><mi>k</mi></msubsup></mrow><mo stretchy=\"false\">\u27e9</mo></mrow><mn>2</mn></msup></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mo>=</mo><mrow><msup><mi>\u03b3</mi><mn>2</mn></msup><mo>\u2062</mo><msubsup><mrow><mo>\u2225</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>\u2208</mo><mi>S</mi></mrow></munder><msubsup><mi>v</mi><mi>i</mi><mi>k</mi></msubsup></mrow><mo>\u2225</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mo>\u2264</mo><mrow><mn>2</mn><mo>\u2062</mo><mi>t</mi><mo>\u2062</mo><msup><mi>\u03b3</mi><mn>2</mn></msup></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.03311.tex", "nexttext": "\n\\end{thm}\n\nAs shown in the corollary below, this theorem implies that a set $S$ shrinks to size $O(\\lambda)$ in $O(\\log |S|)$ phases with high probability. While these results are stated for general $\\lambda$ (which is useful for the extensions later), the reader may think of $\\lambda = O((t \\log n)^{1/2})$.\n\n\n\n\n\n\\begin{cor}\n\\label{cor:sixteen}\nFix a set $S\\in\\mathcal{S}$ and $\\lambda \\ge 1$. Let $\\ell = 1+ 3\\log (|S|/\\lambda)$. Then, \n\n\n", "itemtype": "equation", "pos": 25464, "prevtext": "  \nThis implies that $W_k \\leq 2 kt \\gamma^2$ for all $k$.  Applying Freedman's inequality from Theorem \\ref{thm:freedman} with these bounds on $M$ and $W_k$, we obtain\n\n\\begin{eqnarray*}\n \\Pr[{\\mathrm{disc}}_{\\ell L}(S) \\geq   \\beta \\sqrt{2 t \\ell} ] & \\leq & 2 \\exp \\left( -\\frac{\\beta^2 2t \\ell }{2 (W_{\\ell L} + M \\beta \\sqrt{2t \\ell}/3) } \\right) \\\\\n& \\leq  & \n 2 \\exp\\left(- \\frac{2 t \\ell \\beta^2}{2 (2\\ell L t \\gamma^2 + \\gamma \\beta \\sqrt{2nt} \\sqrt{2t \\ell} /3)} \\right) \\\\\n& \\leq &  2 \\exp\\left(- \\frac{\\beta^2}{(2 + \\gamma \\beta \\sqrt{n})} \\right)  \\leq 2 \\exp(-\\beta^2/3).\n\\end{eqnarray*}\n\nThe last step uses that $\\beta \\gamma \\sqrt{n} \\leq  1$. \n\\end{proof}\n\nFor a set $S$, let $A_S(k)$ denote the number of alive elements in set $S$ at the end of time step $k$.\n\\begin{defn}[Energy Deficit]\nFor a set $S\\in\\mathcal{S}$ and given a coloring $x_k$ at the end of time $k$, the {\\em energy deficit} of $S$ is defined as \n $D_S(k) = \\sum_{i \\in S} (1-x_k^2(i))$.\n\\end{defn}\n\nInitially at time $k=0$, the energy deficit of any set $S\\in\\mathcal{S}$ is $|S|$, and is always non-negative. We also note the following.\n\n\\begin{lemma} \n\\label{l:dsas}\nFor any set $S\\in\\mathcal{S}$ and time $k$, it holds that the number of alive elements $ A_S(k) \\geq D_S(k) -2 $.\n\\end{lemma}\n\\begin{proof}\nAny frozen element can contribute at most  $1- (1-1/n)^2 \\leq 2/n$ to the energy deficit. Moreover, since each alive alive element can contribute at most $1$, $D_S(k) \\leq A_S(k) + n \\cdot (2/n)$ and the result follows.  \n\\end{proof}\n\n\nWe now come to the  key part of the proof, which shows that for each large enough set, its energy deficit decreases substantially in each phase, with sufficiently high probability. \n\n\n\n\n\\begin{thm}\n\\label{thm:winwin}\nFix a set $S\\in\\mathcal{S}$ and a time $k$. For any $\\lambda \\geq 0$, \n\nwith probability at least $1-4\\exp(-\\lambda^2/100t)$, it holds that\n\n", "index": 17, "text": "\\begin{equation}\n\\label{key:eq} \nD_S(k+L) \\leq  D_S(k) -  A_S(k+L) + \\lambda.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"D_{S}(k+L)\\leq D_{S}(k)-A_{S}(k+L)+\\lambda.\" display=\"block\"><mrow><mrow><mrow><msub><mi>D</mi><mi>S</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>k</mi><mo>+</mo><mi>L</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2264</mo><mrow><mrow><mrow><msub><mi>D</mi><mi>S</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><msub><mi>A</mi><mi>S</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>k</mi><mo>+</mo><mi>L</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><mi>\u03bb</mi></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.03311.tex", "nexttext": "\nThat is, the probability that $S$ has more than $2\\lambda + 2$ alive elements after $\\ell$ phases is at most \n$16\\log n \\exp(-\\lambda^2/100t)$.\n\\end{cor}\n\\begin{proof}\nLet us apply Theorem \\ref{thm:winwin} at $k=0,L, \\ldots, (\\ell-1)L$. Then, with probability at least $1-4\\ell \\exp(-\\lambda^2/100t) \\geq 1- 16 \\log n \\exp(-\\lambda^2/100t)$, we can assume that \\eqref{key:eq}  holds at each of these steps. Let us condition on this event.\nIf $A_S(\\ell L) \\geq 2\\lambda+2$, then for each of the time steps $k=0,L,\\ldots,(\\ell-2)L$, \n\n\\begin{eqnarray*} D_S(k+L) & \\le &  D_S(k)- A_S(k+L) + \\lambda \\\\\n                           & \\le & D_S(k) - A_S(k+L)/2 - 1  \\qquad (\\textrm{as } \\lambda \\leq A_S(\\ell L)/2 -1 \\leq A_S(k+L)/2 -1)\\\\ \n                           & \\leq &  D_S(k) - D_S(k+L)/2  \\qquad \\qquad (\\textrm{By Lemma }\\ref{l:dsas})\n\\end{eqnarray*}\nThis implies that $D_S((\\ell-1) L ) \\leq D_S(0) (3/2)^{-\\ell+1} \\leq \\lambda$.\nHowever, applying \\eqref{key:eq} again at $k=(\\ell-1)L$ gives that \n", "itemtype": "equation", "pos": 25998, "prevtext": "\n\\end{thm}\n\nAs shown in the corollary below, this theorem implies that a set $S$ shrinks to size $O(\\lambda)$ in $O(\\log |S|)$ phases with high probability. While these results are stated for general $\\lambda$ (which is useful for the extensions later), the reader may think of $\\lambda = O((t \\log n)^{1/2})$.\n\n\n\n\n\n\\begin{cor}\n\\label{cor:sixteen}\nFix a set $S\\in\\mathcal{S}$ and $\\lambda \\ge 1$. Let $\\ell = 1+ 3\\log (|S|/\\lambda)$. Then, \n\n\n", "index": 19, "text": "\n\\[ \\Pr \\left[ A_S (\\ell L)   \\geq 2\\lambda + 2 \\right] \\leq 16 \\log n \\exp\\left(-\\frac{\\lambda^2}{100t} \\right). \\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex9.m1\" class=\"ltx_Math\" alttext=\"\\Pr\\left[A_{S}(\\ell L)\\geq 2\\lambda+2\\right]\\leq 16\\log n\\exp\\left(-\\frac{%&#10;\\lambda^{2}}{100t}\\right).\" display=\"block\"><mrow><mrow><mrow><mi>Pr</mi><mo>\u2061</mo><mrow><mo>[</mo><mrow><mrow><msub><mi>A</mi><mi>S</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">\u2113</mi><mo>\u2062</mo><mi>L</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2265</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>\u03bb</mi></mrow><mo>+</mo><mn>2</mn></mrow></mrow><mo>]</mo></mrow></mrow><mo>\u2264</mo><mrow><mn>16</mn><mo>\u2062</mo><mrow><mi>log</mi><mo>\u2061</mo><mrow><mi>n</mi><mo>\u2062</mo><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo>(</mo><mrow><mo>-</mo><mfrac><msup><mi>\u03bb</mi><mn>2</mn></msup><mrow><mn>100</mn><mo>\u2062</mo><mi>t</mi></mrow></mfrac></mrow><mo>)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.03311.tex", "nexttext": "\n which contradicts that the energy deficit is always non-negative.   \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\end{proof}\n\n\n\nBefore we prove theorem \\ref{thm:winwin}, let us first see how this implies Theorem \\ref{thm:main}. \n\n\n\\bigskip\n\n\n\\noindent{\\em Proof  (Theorem \\ref{thm:main}).}\n\nApplying corollary \\ref{cor:sixteen} with $\\lambda = 20 (t \\log n)^{1/2}$, it follows that a set $S_j$ reduces to size \nat most $O((t \\log n)^{1/2})$ in at most $1+3(\\log |S_j|)$ phases with probability at least $1- 16\\log n \\exp(-\\lambda^2/100t) \\geq 1-1/n^3$.\nBy a union bound, this holds for all the (at most $nt$) sets with probability at least $1-1/n$.\n\n\nBy Lemma \\ref{lem:initial-disc} with $\\beta = 4 \\log^{1/2} n$ and  $\\ell_j=1+3 \\log |S_j|$, the discrepancy $S_j$ during the first $\\ell_j$ phases is at most $ O(\\beta (t\\ell_j)^{1/2}) = O((t \\log n \\log |S_j|)^{1/2})$ with probability $1-O(n^{-5})$. \nWhen $S_j$ has fewer than $\\lambda = O((t \\log n)^{1/2})$ alive elements, it is {\\em safe} and can incur at most $\\lambda$ additional discrepancy during the rest of the algorithm. Taking a union bound over all the sets gives the result.\n{\\hfill$\\qed$\\bigskip}\n\nWe now prove Theorem \\ref{thm:winwin}.\n\n\\bigskip\n\n\\noindent{\\em Proof (Theorem \\ref{thm:winwin}.)}\nLet $v_i^h$ denote the vector $v_i$ in the SDP solution at time step $h$,  and let $r^h$ denote the random vector at time $h$.\nLet $\\Delta_S(h):= D_S(h)-D_S(h-1)$ denote the change in energy deficit of $S$ at time $h$. Then,\n\\begin{eqnarray}\n\\Delta_S(h) & = &   \\sum_{i \\in S} (x_{h-1}(i)^2 - x_{h}(i)^2 ) =\n              \\sum_{i \\in S} (x_{h-1}(i)^2 - (x_{h-1}(i) + \\gamma \\langle r^h,v_i^h \\rangle )^2 ) \\nonumber \\\\\n\t\t\t\t\t\t& = &   - 2\\gamma \\langle r^h, \\sum_{i\\in S}x_{h-1}(i) v_i^h \\rangle - \\sum_{i\\in S} \\gamma^2 \\langle r^h,v_i^h\\rangle^2  \n\t\t\t\t\t\t\\label{eq:energy}\n\\end{eqnarray}\n\n\n\n\nLet us denote the first and second terms on the right hand side of \\eqref{eq:energy} by\n", "itemtype": "equation", "pos": 27115, "prevtext": "\nThat is, the probability that $S$ has more than $2\\lambda + 2$ alive elements after $\\ell$ phases is at most \n$16\\log n \\exp(-\\lambda^2/100t)$.\n\\end{cor}\n\\begin{proof}\nLet us apply Theorem \\ref{thm:winwin} at $k=0,L, \\ldots, (\\ell-1)L$. Then, with probability at least $1-4\\ell \\exp(-\\lambda^2/100t) \\geq 1- 16 \\log n \\exp(-\\lambda^2/100t)$, we can assume that \\eqref{key:eq}  holds at each of these steps. Let us condition on this event.\nIf $A_S(\\ell L) \\geq 2\\lambda+2$, then for each of the time steps $k=0,L,\\ldots,(\\ell-2)L$, \n\n\\begin{eqnarray*} D_S(k+L) & \\le &  D_S(k)- A_S(k+L) + \\lambda \\\\\n                           & \\le & D_S(k) - A_S(k+L)/2 - 1  \\qquad (\\textrm{as } \\lambda \\leq A_S(\\ell L)/2 -1 \\leq A_S(k+L)/2 -1)\\\\ \n                           & \\leq &  D_S(k) - D_S(k+L)/2  \\qquad \\qquad (\\textrm{By Lemma }\\ref{l:dsas})\n\\end{eqnarray*}\nThis implies that $D_S((\\ell-1) L ) \\leq D_S(0) (3/2)^{-\\ell+1} \\leq \\lambda$.\nHowever, applying \\eqref{key:eq} again at $k=(\\ell-1)L$ gives that \n", "index": 21, "text": "\n\\[D_S(\\ell L) \\leq D_S((\\ell-1)L -A_S(\\ell L) + \\lambda  \\leq \\lambda -  (2 \\lambda +2) + \\lambda < 0\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex10.m1\" class=\"ltx_Math\" alttext=\"D_{S}(\\ell L)\\leq D_{S}((\\ell-1)L-A_{S}(\\ell L)+\\lambda\\leq\\lambda-(2\\lambda+2%&#10;)+\\lambda&lt;0\" display=\"block\"><mrow><msub><mi>D</mi><mi>S</mi></msub><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">\u2113</mi><mi>L</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2264</mo><msub><mi>D</mi><mi>S</mi></msub><mrow><mo stretchy=\"false\">(</mo><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">\u2113</mi><mo>-</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><mi>L</mi><mo>-</mo><msub><mi>A</mi><mi>S</mi></msub><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">\u2113</mi><mi>L</mi><mo stretchy=\"false\">)</mo></mrow><mo>+</mo><mi>\u03bb</mi><mo>\u2264</mo><mi>\u03bb</mi><mo>-</mo><mrow><mo stretchy=\"false\">(</mo><mn>2</mn><mi>\u03bb</mi><mo>+</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow><mo>+</mo><mi>\u03bb</mi><mo>&lt;</mo><mn>0</mn></mrow></mrow></math>", "type": "latex"}, {"file": "1601.03311.tex", "nexttext": " \nWe need to show that with probability at least $1-4\\exp(-\\lambda^2/100 t)$,\n", "itemtype": "equation", "pos": -1, "prevtext": "\n which contradicts that the energy deficit is always non-negative.   \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\end{proof}\n\n\n\nBefore we prove theorem \\ref{thm:winwin}, let us first see how this implies Theorem \\ref{thm:main}. \n\n\n\\bigskip\n\n\n\\noindent{\\em Proof  (Theorem \\ref{thm:main}).}\n\nApplying corollary \\ref{cor:sixteen} with $\\lambda = 20 (t \\log n)^{1/2}$, it follows that a set $S_j$ reduces to size \nat most $O((t \\log n)^{1/2})$ in at most $1+3(\\log |S_j|)$ phases with probability at least $1- 16\\log n \\exp(-\\lambda^2/100t) \\geq 1-1/n^3$.\nBy a union bound, this holds for all the (at most $nt$) sets with probability at least $1-1/n$.\n\n\nBy Lemma \\ref{lem:initial-disc} with $\\beta = 4 \\log^{1/2} n$ and  $\\ell_j=1+3 \\log |S_j|$, the discrepancy $S_j$ during the first $\\ell_j$ phases is at most $ O(\\beta (t\\ell_j)^{1/2}) = O((t \\log n \\log |S_j|)^{1/2})$ with probability $1-O(n^{-5})$. \nWhen $S_j$ has fewer than $\\lambda = O((t \\log n)^{1/2})$ alive elements, it is {\\em safe} and can incur at most $\\lambda$ additional discrepancy during the rest of the algorithm. Taking a union bound over all the sets gives the result.\n{\\hfill$\\qed$\\bigskip}\n\nWe now prove Theorem \\ref{thm:winwin}.\n\n\\bigskip\n\n\\noindent{\\em Proof (Theorem \\ref{thm:winwin}.)}\nLet $v_i^h$ denote the vector $v_i$ in the SDP solution at time step $h$,  and let $r^h$ denote the random vector at time $h$.\nLet $\\Delta_S(h):= D_S(h)-D_S(h-1)$ denote the change in energy deficit of $S$ at time $h$. Then,\n\\begin{eqnarray}\n\\Delta_S(h) & = &   \\sum_{i \\in S} (x_{h-1}(i)^2 - x_{h}(i)^2 ) =\n              \\sum_{i \\in S} (x_{h-1}(i)^2 - (x_{h-1}(i) + \\gamma \\langle r^h,v_i^h \\rangle )^2 ) \\nonumber \\\\\n\t\t\t\t\t\t& = &   - 2\\gamma \\langle r^h, \\sum_{i\\in S}x_{h-1}(i) v_i^h \\rangle - \\sum_{i\\in S} \\gamma^2 \\langle r^h,v_i^h\\rangle^2  \n\t\t\t\t\t\t\\label{eq:energy}\n\\end{eqnarray}\n\n\n\n\nLet us denote the first and second terms on the right hand side of \\eqref{eq:energy} by\n", "index": 23, "text": "\\[T_h:=  - 2\\gamma \\langle r^h, \\sum_{i\\in S}x_{h-1}(i) v_i^h \\rangle  \\quad \\textrm{ and } \\quad  R_h:=  - \\sum_{i\\in S} \\gamma^2 \\langle r^h,v_i^h\\rangle^2  \\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex11.m1\" class=\"ltx_Math\" alttext=\"T_{h}:=-2\\gamma\\langle r^{h},\\sum_{i\\in S}x_{h-1}(i)v_{i}^{h}\\rangle\\quad%&#10;\\textrm{ and }\\quad R_{h}:=-\\sum_{i\\in S}\\gamma^{2}\\langle r^{h},v_{i}^{h}%&#10;\\rangle^{2}\" display=\"block\"><mrow><mrow><msub><mi>T</mi><mi>h</mi></msub><mo>:=</mo><mrow><mrow><mo>-</mo><mrow><mn>2</mn><mo>\u2062</mo><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">\u27e8</mo><msup><mi>r</mi><mi>h</mi></msup><mo>,</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>\u2208</mo><mi>S</mi></mrow></munder><mrow><msub><mi>x</mi><mrow><mi>h</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msubsup><mi>v</mi><mi>i</mi><mi>h</mi></msubsup></mrow></mrow><mo stretchy=\"false\">\u27e9</mo></mrow></mrow></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003</mo><mtext>\u00a0and\u00a0</mtext></mrow></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003</mo><mrow><msub><mi>R</mi><mi>h</mi></msub><mo>:=</mo><mrow><mo>-</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>\u2208</mo><mi>S</mi></mrow></munder><mrow><msup><mi>\u03b3</mi><mn>2</mn></msup><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">\u27e8</mo><msup><mi>r</mi><mi>h</mi></msup><mo>,</mo><msubsup><mi>v</mi><mi>i</mi><mi>h</mi></msubsup><mo stretchy=\"false\">\u27e9</mo></mrow><mn>2</mn></msup></mrow></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.03311.tex", "nexttext": "\n\n\nTo do this, we will show that $T_h$ is a martingale with small variance (this is where the SDP constraints \\eqref{sdp2} will be used), and that $\\sum_{h=k+1}^{k+L} R_h$ is almost deterministic (its variance can be made arbitrarily small by making $\\gamma$ small) with ${\\mathbb{E}}[ \\sum_{h=k+1}^{k+L} R_h] \\leq - A_S(k+L)$.\n\n\n\n\n\n\n\nLet $Y_h = \\sum_{h'=1}^h T_{k +h'}$ and $X_h = r^{k+h}$. Then $Y_0=0$ and  $Y_1,\\ldots,Y_L$ form a martingale with respect to $X_1,\\ldots,X_L$. \nThis is the same martingale as in the proof of Lemma \\ref{lem:initial-disc}, except that it is multiplied by a factor of $-2$.\nSo applying Freedman's inequality as in the proof of Lemma \\ref{lem:initial-disc} with $\\ell=1$ gives  \n", "itemtype": "equation", "pos": 29371, "prevtext": " \nWe need to show that with probability at least $1-4\\exp(-\\lambda^2/100 t)$,\n", "index": 25, "text": "\n\\[ D_S(k+L) - D_S(k) =  \\sum_{h=k+1}^{k+L}\\Delta_S(h) =\\sum_{h=k+1}^{k+L} (T_h + R_h)\\leq - A_S(k+L) + \\lambda.\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex12.m1\" class=\"ltx_Math\" alttext=\"D_{S}(k+L)-D_{S}(k)=\\sum_{h=k+1}^{k+L}\\Delta_{S}(h)=\\sum_{h=k+1}^{k+L}(T_{h}+R%&#10;_{h})\\leq-A_{S}(k+L)+\\lambda.\" display=\"block\"><mrow><mrow><mrow><mrow><msub><mi>D</mi><mi>S</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>k</mi><mo>+</mo><mi>L</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><msub><mi>D</mi><mi>S</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>=</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>h</mi><mo>=</mo><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></mrow><mrow><mi>k</mi><mo>+</mo><mi>L</mi></mrow></munderover><mrow><msub><mi mathvariant=\"normal\">\u0394</mi><mi>S</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>h</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>=</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>h</mi><mo>=</mo><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></mrow><mrow><mi>k</mi><mo>+</mo><mi>L</mi></mrow></munderover><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>T</mi><mi>h</mi></msub><mo>+</mo><msub><mi>R</mi><mi>h</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2264</mo><mrow><mrow><mo>-</mo><mrow><msub><mi>A</mi><mi>S</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>k</mi><mo>+</mo><mi>L</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><mi>\u03bb</mi></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.03311.tex", "nexttext": "\nChoosing $\\beta = \\lambda/(4\\sqrt{2t})$ gives\n\n", "itemtype": "equation", "pos": 30195, "prevtext": "\n\n\nTo do this, we will show that $T_h$ is a martingale with small variance (this is where the SDP constraints \\eqref{sdp2} will be used), and that $\\sum_{h=k+1}^{k+L} R_h$ is almost deterministic (its variance can be made arbitrarily small by making $\\gamma$ small) with ${\\mathbb{E}}[ \\sum_{h=k+1}^{k+L} R_h] \\leq - A_S(k+L)$.\n\n\n\n\n\n\n\nLet $Y_h = \\sum_{h'=1}^h T_{k +h'}$ and $X_h = r^{k+h}$. Then $Y_0=0$ and  $Y_1,\\ldots,Y_L$ form a martingale with respect to $X_1,\\ldots,X_L$. \nThis is the same martingale as in the proof of Lemma \\ref{lem:initial-disc}, except that it is multiplied by a factor of $-2$.\nSo applying Freedman's inequality as in the proof of Lemma \\ref{lem:initial-disc} with $\\ell=1$ gives  \n", "index": 27, "text": "\n\\[ \\Pr[|Y_L| \\geq 2\\beta \\sqrt{2t }] \\leq 2 \\exp(-\\beta^2/3).\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex13.m1\" class=\"ltx_Math\" alttext=\"\\Pr[|Y_{L}|\\geq 2\\beta\\sqrt{2t}]\\leq 2\\exp(-\\beta^{2}/3).\" display=\"block\"><mrow><mrow><mrow><mi>Pr</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mrow><mo stretchy=\"false\">|</mo><msub><mi>Y</mi><mi>L</mi></msub><mo stretchy=\"false\">|</mo></mrow><mo>\u2265</mo><mrow><mn>2</mn><mo>\u2062</mo><mi>\u03b2</mi><mo>\u2062</mo><msqrt><mrow><mn>2</mn><mo>\u2062</mo><mi>t</mi></mrow></msqrt></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mo>\u2264</mo><mrow><mn>2</mn><mo>\u2062</mo><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mrow><msup><mi>\u03b2</mi><mn>2</mn></msup><mo>/</mo><mn>3</mn></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.03311.tex", "nexttext": "\n\nWe now bound $\\sum_h R_h$. \nLet $Z'_h = \\sum_{h'=1}^h R_{k +h'}$, and define the martingale \n\n", "itemtype": "equation", "pos": 30306, "prevtext": "\nChoosing $\\beta = \\lambda/(4\\sqrt{2t})$ gives\n\n", "index": 29, "text": "\\begin{equation}\n\\label{eq:29} \n \\Pr[ |Y_L| \\geq \\lambda/2 ] \\leq 2 \\exp(-\\lambda^2/96t). \n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"\\Pr[|Y_{L}|\\geq\\lambda/2]\\leq 2\\exp(-\\lambda^{2}/96t).\" display=\"block\"><mrow><mrow><mrow><mi>Pr</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mrow><mo stretchy=\"false\">|</mo><msub><mi>Y</mi><mi>L</mi></msub><mo stretchy=\"false\">|</mo></mrow><mo>\u2265</mo><mrow><mi>\u03bb</mi><mo>/</mo><mn>2</mn></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mo>\u2264</mo><mrow><mn>2</mn><mo>\u2062</mo><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mrow><mrow><msup><mi>\u03bb</mi><mn>2</mn></msup><mo>/</mo><mn>96</mn></mrow><mo>\u2062</mo><mi>t</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.03311.tex", "nexttext": "\n with respect to $X_1,\\ldots,X_h$ (this is the standard Doob decomposition of $Z'_h$). \n \n We now apply Freedman's inequality to $Z_h$. By \\eqref{eq:doob}\n", "itemtype": "equation", "pos": 30506, "prevtext": "\n\nWe now bound $\\sum_h R_h$. \nLet $Z'_h = \\sum_{h'=1}^h R_{k +h'}$, and define the martingale \n\n", "index": 31, "text": "\\begin{equation}\n\\label{eq:doob}\n Z_h = Z'_h - \\sum_{h'=1}^h {\\mathbb{E}}_{h'-1}[Z'_{h'}-Z'_{h'-1}]  = Z'_h - \\sum_{h'=1}^h {\\mathbb{E}}_{h'-1}[R_{k+h'}]\n \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"Z_{h}=Z^{\\prime}_{h}-\\sum_{h^{\\prime}=1}^{h}{\\mathbb{E}}_{h^{\\prime}-1}[Z^{%&#10;\\prime}_{h^{\\prime}}-Z^{\\prime}_{h^{\\prime}-1}]=Z^{\\prime}_{h}-\\sum_{h^{\\prime%&#10;}=1}^{h}{\\mathbb{E}}_{h^{\\prime}-1}[R_{k+h^{\\prime}}]\" display=\"block\"><mrow><msub><mi>Z</mi><mi>h</mi></msub><mo>=</mo><mrow><msubsup><mi>Z</mi><mi>h</mi><mo>\u2032</mo></msubsup><mo>-</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><msup><mi>h</mi><mo>\u2032</mo></msup><mo>=</mo><mn>1</mn></mrow><mi>h</mi></munderover><mrow><msub><mi>\ud835\udd3c</mi><mrow><msup><mi>h</mi><mo>\u2032</mo></msup><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><msubsup><mi>Z</mi><msup><mi>h</mi><mo>\u2032</mo></msup><mo>\u2032</mo></msubsup><mo>-</mo><msubsup><mi>Z</mi><mrow><msup><mi>h</mi><mo>\u2032</mo></msup><mo>-</mo><mn>1</mn></mrow><mo>\u2032</mo></msubsup></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow></mrow><mo>=</mo><mrow><msubsup><mi>Z</mi><mi>h</mi><mo>\u2032</mo></msubsup><mo>-</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><msup><mi>h</mi><mo>\u2032</mo></msup><mo>=</mo><mn>1</mn></mrow><mi>h</mi></munderover><mrow><msub><mi>\ud835\udd3c</mi><mrow><msup><mi>h</mi><mo>\u2032</mo></msup><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><msub><mi>R</mi><mrow><mi>k</mi><mo>+</mo><msup><mi>h</mi><mo>\u2032</mo></msup></mrow></msub><mo stretchy=\"false\">]</mo></mrow></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.03311.tex", "nexttext": " and thus $M \\leq 2\\gamma^2 n^2$.    \nMoreover using the trivial bound  ${\\mathbb{E}}_{h-1}[(Z_h - Z_{h-1})^2 ] \\leq M^2 = 4\\gamma^4 n^4$, we obtain that total variance $W_L \\leq L M^2 = 4\\gamma^2 n^4 = 4$. By Freedman's inequality with $\\lambda \\leq n$, we get\n\n", "itemtype": "equation", "pos": -1, "prevtext": "\n with respect to $X_1,\\ldots,X_h$ (this is the standard Doob decomposition of $Z'_h$). \n \n We now apply Freedman's inequality to $Z_h$. By \\eqref{eq:doob}\n", "index": 33, "text": "\n\\[|Z_h - Z_{h-1}|  =  |R_{k+h} - {\\mathbb{E}}_{h-1}[R_{k+h}]| \\leq 2|R_{k+h}| \\leq 2\\gamma^2n|S| \\leq 2\\gamma^2 n^2.\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex14.m1\" class=\"ltx_Math\" alttext=\"|Z_{h}-Z_{h-1}|=|R_{k+h}-{\\mathbb{E}}_{h-1}[R_{k+h}]|\\leq 2|R_{k+h}|\\leq 2%&#10;\\gamma^{2}n|S|\\leq 2\\gamma^{2}n^{2}.\" display=\"block\"><mrow><mrow><mrow><mo stretchy=\"false\">|</mo><mrow><msub><mi>Z</mi><mi>h</mi></msub><mo>-</mo><msub><mi>Z</mi><mrow><mi>h</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow><mo stretchy=\"false\">|</mo></mrow><mo>=</mo><mrow><mo stretchy=\"false\">|</mo><mrow><msub><mi>R</mi><mrow><mi>k</mi><mo>+</mo><mi>h</mi></mrow></msub><mo>-</mo><mrow><msub><mi>\ud835\udd3c</mi><mrow><mi>h</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><msub><mi>R</mi><mrow><mi>k</mi><mo>+</mo><mi>h</mi></mrow></msub><mo stretchy=\"false\">]</mo></mrow></mrow></mrow><mo stretchy=\"false\">|</mo></mrow><mo>\u2264</mo><mrow><mn>2</mn><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><msub><mi>R</mi><mrow><mi>k</mi><mo>+</mo><mi>h</mi></mrow></msub><mo stretchy=\"false\">|</mo></mrow></mrow><mo>\u2264</mo><mrow><mn>2</mn><mo>\u2062</mo><msup><mi>\u03b3</mi><mn>2</mn></msup><mo>\u2062</mo><mi>n</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mi>S</mi><mo stretchy=\"false\">|</mo></mrow></mrow><mo>\u2264</mo><mrow><mn>2</mn><mo>\u2062</mo><msup><mi>\u03b3</mi><mn>2</mn></msup><mo>\u2062</mo><msup><mi>n</mi><mn>2</mn></msup></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.03311.tex", "nexttext": "\n\n By Lemma \\ref{lem:tri} for each $h \\in [k+1,k+L]$,  \n\n", "itemtype": "equation", "pos": 31211, "prevtext": " and thus $M \\leq 2\\gamma^2 n^2$.    \nMoreover using the trivial bound  ${\\mathbb{E}}_{h-1}[(Z_h - Z_{h-1})^2 ] \\leq M^2 = 4\\gamma^4 n^4$, we obtain that total variance $W_L \\leq L M^2 = 4\\gamma^2 n^4 = 4$. By Freedman's inequality with $\\lambda \\leq n$, we get\n\n", "index": 35, "text": "\\begin{equation}\n\\label{eq:30}\n \\Pr [ Z_L > \\lambda/2 ]  \\leq  2 \\exp( -\\lambda^2 / 8(W_L + M\\lambda/6))  \\leq 2\\exp(- \\lambda^2/40) \\leq 2\\exp(- \\lambda^2/40t).\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"\\Pr[Z_{L}&gt;\\lambda/2]\\leq 2\\exp(-\\lambda^{2}/8(W_{L}+M\\lambda/6))\\leq 2\\exp(-%&#10;\\lambda^{2}/40)\\leq 2\\exp(-\\lambda^{2}/40t).\" display=\"block\"><mrow><mrow><mrow><mi>Pr</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">[</mo><mrow><msub><mi>Z</mi><mi>L</mi></msub><mo>&gt;</mo><mrow><mi>\u03bb</mi><mo>/</mo><mn>2</mn></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mo>\u2264</mo><mrow><mn>2</mn><mo>\u2062</mo><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mrow><mrow><msup><mi>\u03bb</mi><mn>2</mn></msup><mo>/</mo><mn>8</mn></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>W</mi><mi>L</mi></msub><mo>+</mo><mrow><mrow><mi>M</mi><mo>\u2062</mo><mi>\u03bb</mi></mrow><mo>/</mo><mn>6</mn></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>\u2264</mo><mrow><mn>2</mn><mo>\u2062</mo><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mrow><msup><mi>\u03bb</mi><mn>2</mn></msup><mo>/</mo><mn>40</mn></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>\u2264</mo><mrow><mn>2</mn><mo>\u2062</mo><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mrow><mrow><msup><mi>\u03bb</mi><mn>2</mn></msup><mo>/</mo><mn>40</mn></mrow><mo>\u2062</mo><mi>t</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.03311.tex", "nexttext": " \nSo we can bound $\\sum_{h'=1}^h R_{k +h'}$ as\n\\begin{eqnarray}\n\\sum_{h'=1}^h R_{k +h'} & = &  Z'_L = Z_L + \\sum_{h'=1}^L {\\mathbb{E}}_{h'-1} [R_{k+h'}] \\nonumber \\\\\n & \\leq &   Z_L  - L \\gamma^2 A_S(k+L) =  Z_L  -A_S(k+L). \\label{eq:31}\n\\end{eqnarray}\nThis gives that\n\\begin{eqnarray*}\n\\Pr[ \\sum_{h=k+1}^{k+L} (T_h+R_h) \\geq - A_S(k+L) + \\lambda ] & = &   \\Pr[ Y_L+Z_L^\\prime\\geq - A_S(k+L) + \\lambda] \\\\\n& \\leq  &\\Pr[ Y_L+Z_L \\geq \\lambda]   \\qquad \\textrm{(by \\eqref{eq:31})}\\\\                                      \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t& \\leq &  \\Pr[ |Y_L| \\geq \\lambda/2]  + \\Pr[ Z_L \\geq \\lambda/2] \\\\  \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t& \\leq &  4 \\exp(-\\lambda^2/100t) \\qquad \\textrm{(by \\eqref{eq:29} and \\eqref{eq:30}) }\n\\end{eqnarray*}\n\n{\\hfill$\\qed$}\n\n\n\n\\section{Extensions}\n\\label{s:ext}\n\nWe now describe the various extensions. The first extension is to the Koml\\'{o}s setting.\n\n\\bigskip\n\n\\noindent{\\bf Theorem \\ref{thm:kom} (restated):} {\\em\nGiven a matrix $A$ with $n$ columns such that the $\\ell_2$-norm of any column is at most $1$, then there is an algorithm to find a coloring where each row $j$ incurs a discrepancy of\n$O( (\\log n \\log s_j)^{1/2})$, where $s_j$ is the $\\ell_1$-norm of row $j$.\n}\n\n\\medskip\n\nThe proof follows along the same lines as before, and only needs a modification in the definition of the energy deficit. We describe the relevant differences.\n\n\\begin{proof}(Sketch)\nFor the Koml\\'{o}s setting, we replace the SDP constraints \\eqref{sdp1} by $\\|\\sum_{i} a_{ji} v_i \\|^2 \\leq 2t $ and the constraints \\eqref{sdp2} by  $\\| \\sum_{i} |a_{ji}| x_{k-1}(i) v_i \\|^2 \\leq 2t$  (note the absolute value in the second set of constraints) where $a_{ji}$ denotes the $(j,i)^{th}$ element of $A$. \nTo use the latter constraint,\nwe define the energy deficit for row $j$ at time $k$ as  $D_j(k) =s_j  - \\sum_{i} |a_{ji}| x_{k}(i)^2$. \nThe energy deficit is always non-negative and is $s_j$ at time $k=0$. \nWe also define $A_j(k)$ now as the $\\ell_1$-norm of row $j$ restricted to the alive variables. This gives that,\n", "itemtype": "equation", "pos": -1, "prevtext": "\n\n By Lemma \\ref{lem:tri} for each $h \\in [k+1,k+L]$,  \n\n", "index": 37, "text": "\\[ {\\mathbb{E}}[R_h] =  -\\gamma^2\\sum_{i\\in S}  \\|v_i^h\\|^2 =  -\\gamma^2A_S(h-1) \\leq  -\\gamma^2A_S(k+L).  \\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex15.m1\" class=\"ltx_Math\" alttext=\"{\\mathbb{E}}[R_{h}]=-\\gamma^{2}\\sum_{i\\in S}\\|v_{i}^{h}\\|^{2}=-\\gamma^{2}A_{S}%&#10;(h-1)\\leq-\\gamma^{2}A_{S}(k+L).\" display=\"block\"><mrow><mrow><mrow><mi>\ud835\udd3c</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><msub><mi>R</mi><mi>h</mi></msub><mo stretchy=\"false\">]</mo></mrow></mrow><mo>=</mo><mrow><mo>-</mo><mrow><msup><mi>\u03b3</mi><mn>2</mn></msup><mo>\u2062</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>\u2208</mo><mi>S</mi></mrow></munder><msup><mrow><mo>\u2225</mo><msubsup><mi>v</mi><mi>i</mi><mi>h</mi></msubsup><mo>\u2225</mo></mrow><mn>2</mn></msup></mrow></mrow></mrow><mo>=</mo><mrow><mo>-</mo><mrow><msup><mi>\u03b3</mi><mn>2</mn></msup><mo>\u2062</mo><msub><mi>A</mi><mi>S</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>h</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>\u2264</mo><mrow><mo>-</mo><mrow><msup><mi>\u03b3</mi><mn>2</mn></msup><mo>\u2062</mo><msub><mi>A</mi><mi>S</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>k</mi><mo>+</mo><mi>L</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.03311.tex", "nexttext": "\nExactly as in the proof of Theorem \\ref{thm:winwin}, the energy constraints of the SDP ensure that the first term behaves as a martingale with deviation in each step  $O(\\gamma t^{1/2})$. Similarly the second term causes the deficit to decrease in expectation by at least \n$\\gamma^2 \\sum_{i \\in A_j(k)} |a_{ji}| \\langle r^k,v^k_i\\rangle^2$, which exactly as before, gives us the required decrease when the $\\ell_1$-norm of the alive variables in higher than our threshold $O(\\lambda)$.\n\\end{proof}\n\n\nThe next extension follows by using the flexibility in choosing the $\\lambda$'s differently for different sets.\n\n\\bigskip \n\n\\noindent{\\bf Theorem \\ref{thm:ext1} (restated):} {\\em\nFor $i=1,\\ldots,\\log n$, let $m_i$ denote the number of sets in $\\mathcal{S}$ with size in $(2^{i-1},2^{i}]$. Call these class-$i$ sets.\nThen there is an algorithm that with probability at least $1-1/\\log n$ finds a coloring with discrepancy $O((ti ( \\log m_i+\\log\\log n))^{1/2})$ for each class-$i$ set.\n}\n\n\\medskip\n\n\\begin{proof}\nFor class-$i$ sets $S$, we set $\\lambda_i = 20 (t (\\log m_i + \\log \\log n))^{1/2}$.\nThen by Corollary \\ref{cor:sixteen}, the probability that a class-$i$  set does not become smaller than $2 \\lambda_i$ in $3\\log 2^i =3i$ phases is at most $16/(m_i^4 \\log^3 n)$. \nBy a union bound over all the sets in class $i$, and over all the $\\log n$ choices of $i$, each set decreases to a size at most $2\\lambda_i$ after $O(i)$ phases with probability at least $1-1/(2\\log n)$.\n\n\n \n \nUsing lemma \\ref{lem:initial-disc} with $\\beta=3 (\\log m_i+\\log\\log n)^{1/2}$, probability that a class-$i$ set $S$ gets discrepancy more than $3 (6 \\cdot ti(\\log m_i + \\log\\log n))^{1/2}$ in the first $3i$ phases is at most $2/(m_i^3\\log^3 n)$. Taking a union bound over all the $m_i$ sets in class $i$ and over all the  $\\log n$ choices of $i$, we get that each set gets discrepancy $O((ti(\\log m_i+\\log\\log n))^{1/2})$ in the first $3i$ phases with probability at least $1-1/(2\\log n)$.\n \nTogether, this implies that with probability at least $1-1/\\log n$, the discrepancy for every class-$i$ set is $O((ti ( \\log m_i+\\log\\log n))^{1/2})$.\n\\end{proof}\n\nCorollary \\ref{cor1} follows directly by plugging the bounds on $m_i$ above.\n\nFor theorem \\ref{thm:ext2}, we use another flexibility that we can reweight the rows of incidence matrix of the set system. In particular, if we scale the row $j$ by $w_j$ and still require the (weighted) vector discrepancy to be $\\sqrt{t}$, then this implies a $\\sqrt{t}/w_j$ discrepancy  on the original row. As long as this reweighting does not affect the $\\ell_2$-norms by too much, the previous bounds and analysis still goes through, while allowing us to get \ntighter bounds on selected rows.  In particular we have the following.\n\n\\bigskip \n\n\\noindent{\\bf Theorem \\ref{thm:ext2} (restated):} {\\em\n\n\nSuppose there is a reweighting of the rows $j$ with non-negative weights $w_j$ such that the $\\ell_2$-norm of any column is at most $\\beta$, then \nthe algorithm gets a discrepancy of  $O(\\beta(\\log n \\log (w_j s_j))^{1/2}/w_j)$ for each row $j$.\n}\n\n\\begin{proof}(Sketch) \nThe proof follows directly from Theorem \\ref{thm:kom}. We work with the incidence matrix of reweighted system, and then translate the bounds back to the original system.\n\\end{proof}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCorollary \\ref{cor2} follows from Theorem \\ref{thm:ext2} as follows.\n\n\\begin{proof}(Corollary \\ref{cor2})\nCall a set a class-$i$ set for $i=1,\\ldots,\\log n$, if its size lies in the range $[t 2^{i-1},t2^{i})$.\nWe choose $w_i = \\sqrt{i+\\log t}$ for class $i$ sets, and $w_i=1$ for sets of size less than $t$. Fix some element $v$, and let $m_{\\geq i}$ denote the number of sets in classes $i$ or more that contain $v$. Then, the squared $\\ell_2$-norm of columns in the weighted incidence matrix is at most \n \n", "itemtype": "equation", "pos": 33573, "prevtext": " \nSo we can bound $\\sum_{h'=1}^h R_{k +h'}$ as\n\\begin{eqnarray}\n\\sum_{h'=1}^h R_{k +h'} & = &  Z'_L = Z_L + \\sum_{h'=1}^L {\\mathbb{E}}_{h'-1} [R_{k+h'}] \\nonumber \\\\\n & \\leq &   Z_L  - L \\gamma^2 A_S(k+L) =  Z_L  -A_S(k+L). \\label{eq:31}\n\\end{eqnarray}\nThis gives that\n\\begin{eqnarray*}\n\\Pr[ \\sum_{h=k+1}^{k+L} (T_h+R_h) \\geq - A_S(k+L) + \\lambda ] & = &   \\Pr[ Y_L+Z_L^\\prime\\geq - A_S(k+L) + \\lambda] \\\\\n& \\leq  &\\Pr[ Y_L+Z_L \\geq \\lambda]   \\qquad \\textrm{(by \\eqref{eq:31})}\\\\                                      \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t& \\leq &  \\Pr[ |Y_L| \\geq \\lambda/2]  + \\Pr[ Z_L \\geq \\lambda/2] \\\\  \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t& \\leq &  4 \\exp(-\\lambda^2/100t) \\qquad \\textrm{(by \\eqref{eq:29} and \\eqref{eq:30}) }\n\\end{eqnarray*}\n\n{\\hfill$\\qed$}\n\n\n\n\\section{Extensions}\n\\label{s:ext}\n\nWe now describe the various extensions. The first extension is to the Koml\\'{o}s setting.\n\n\\bigskip\n\n\\noindent{\\bf Theorem \\ref{thm:kom} (restated):} {\\em\nGiven a matrix $A$ with $n$ columns such that the $\\ell_2$-norm of any column is at most $1$, then there is an algorithm to find a coloring where each row $j$ incurs a discrepancy of\n$O( (\\log n \\log s_j)^{1/2})$, where $s_j$ is the $\\ell_1$-norm of row $j$.\n}\n\n\\medskip\n\nThe proof follows along the same lines as before, and only needs a modification in the definition of the energy deficit. We describe the relevant differences.\n\n\\begin{proof}(Sketch)\nFor the Koml\\'{o}s setting, we replace the SDP constraints \\eqref{sdp1} by $\\|\\sum_{i} a_{ji} v_i \\|^2 \\leq 2t $ and the constraints \\eqref{sdp2} by  $\\| \\sum_{i} |a_{ji}| x_{k-1}(i) v_i \\|^2 \\leq 2t$  (note the absolute value in the second set of constraints) where $a_{ji}$ denotes the $(j,i)^{th}$ element of $A$. \nTo use the latter constraint,\nwe define the energy deficit for row $j$ at time $k$ as  $D_j(k) =s_j  - \\sum_{i} |a_{ji}| x_{k}(i)^2$. \nThe energy deficit is always non-negative and is $s_j$ at time $k=0$. \nWe also define $A_j(k)$ now as the $\\ell_1$-norm of row $j$ restricted to the alive variables. This gives that,\n", "index": 39, "text": "\n\\[D_j(k)-D_j(k-1) = -2 \\gamma \\sum_i |a_{ji}| \\langle r^k,x_{k-1}(i) v^k_i \\rangle  - \\gamma^2 \\sum_i |a_{ji}| \\langle r^k,v^k_i\\rangle^2.\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex16.m1\" class=\"ltx_Math\" alttext=\"D_{j}(k)-D_{j}(k-1)=-2\\gamma\\sum_{i}|a_{ji}|\\langle r^{k},x_{k-1}(i)v^{k}_{i}%&#10;\\rangle-\\gamma^{2}\\sum_{i}|a_{ji}|\\langle r^{k},v^{k}_{i}\\rangle^{2}.\" display=\"block\"><mrow><mrow><mrow><mrow><msub><mi>D</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><msub><mi>D</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>k</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>=</mo><mrow><mrow><mo>-</mo><mrow><mn>2</mn><mo>\u2062</mo><mi>\u03b3</mi><mo>\u2062</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mi>i</mi></munder><mrow><mrow><mo stretchy=\"false\">|</mo><msub><mi>a</mi><mrow><mi>j</mi><mo>\u2062</mo><mi>i</mi></mrow></msub><mo stretchy=\"false\">|</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">\u27e8</mo><msup><mi>r</mi><mi>k</mi></msup><mo>,</mo><mrow><msub><mi>x</mi><mrow><mi>k</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msubsup><mi>v</mi><mi>i</mi><mi>k</mi></msubsup></mrow><mo stretchy=\"false\">\u27e9</mo></mrow></mrow></mrow></mrow></mrow><mo>-</mo><mrow><msup><mi>\u03b3</mi><mn>2</mn></msup><mo>\u2062</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mi>i</mi></munder><mrow><mrow><mo stretchy=\"false\">|</mo><msub><mi>a</mi><mrow><mi>j</mi><mo>\u2062</mo><mi>i</mi></mrow></msub><mo stretchy=\"false\">|</mo></mrow><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">\u27e8</mo><msup><mi>r</mi><mi>k</mi></msup><mo>,</mo><msubsup><mi>v</mi><mi>i</mi><mi>k</mi></msubsup><mo stretchy=\"false\">\u27e9</mo></mrow><mn>2</mn></msup></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.03311.tex", "nexttext": "\n\twhere we use that $m_{\\geq i} \\leq O(t/i^{1+\\epsilon})$ for any element $v$.\n\t\t\nApplying theorem \\ref{thm:ext2}, we obtain that weighted discrepancy for a class-$i$ set is $O( (t (i+\\log t) \\log n)^{1/2})$ and thus the actual discrepancy is $O((t (i+\\log t) \\log n)^{1/2}/w_i) = O((t \\log n)^{1/2})$. For sets of size at most $t$ the discrepancy is $O((t\\log n\\log t)^{1/2})$.\n\\end{proof}\n\n\n\n\n\n\n\n\n\t\n\n\n\n\nWe remark that there are lots of additional flexibility in the approach that we did not use in the extensions above. These could be helpful in some other special instances, and hopefully perhaps even for the general Beck-Fiala problem. For example, we can choose the weights $w_i$ adaptively over time for sets that become dangerous (i.e.~incur much more discrepancy than expected), as was done in \\cite{B10} to obtain the bounds for Spencer's result \\cite{Spencer85}, provided not too many sets become dangerous. Another observation is that the concentration of energy deficit is so strong for the sets of size $\\Omega(t \\log n)^{1/2}$, that we can essentially assume that the number of alive variables in a set decreases deterministically by a constant factor in each phase.\nOnce the residual size of a set falls below $O((t \\log n)^{1/2})$, we can simply discard it from the set system (as is done in iterated rounding, as it can only incur $O( (t \\log n)^{1/2})$ discrepancy henceforth). So what really matters at any time in the algorithm is the bound on the $\\ell_2$-norm of any column of this reduced system, rather than the $\\ell_2$-norm of columns in the original system. This reduction in the $\\ell_2$-norm can potentially be used to tradeoff the high discrepancy   \nincurred by some sets. \n\n\n\\section*{Acknowledgements}\nWe would like to thank Thomas Rothvoss for a thorough reading and for several useful comments, leading to a cleaner presentation of the paper.\n\n\\bibliographystyle{alpha}\n\\bibliography{refr}\n\n\n", "itemtype": "equation", "pos": 37516, "prevtext": "\nExactly as in the proof of Theorem \\ref{thm:winwin}, the energy constraints of the SDP ensure that the first term behaves as a martingale with deviation in each step  $O(\\gamma t^{1/2})$. Similarly the second term causes the deficit to decrease in expectation by at least \n$\\gamma^2 \\sum_{i \\in A_j(k)} |a_{ji}| \\langle r^k,v^k_i\\rangle^2$, which exactly as before, gives us the required decrease when the $\\ell_1$-norm of the alive variables in higher than our threshold $O(\\lambda)$.\n\\end{proof}\n\n\nThe next extension follows by using the flexibility in choosing the $\\lambda$'s differently for different sets.\n\n\\bigskip \n\n\\noindent{\\bf Theorem \\ref{thm:ext1} (restated):} {\\em\nFor $i=1,\\ldots,\\log n$, let $m_i$ denote the number of sets in $\\mathcal{S}$ with size in $(2^{i-1},2^{i}]$. Call these class-$i$ sets.\nThen there is an algorithm that with probability at least $1-1/\\log n$ finds a coloring with discrepancy $O((ti ( \\log m_i+\\log\\log n))^{1/2})$ for each class-$i$ set.\n}\n\n\\medskip\n\n\\begin{proof}\nFor class-$i$ sets $S$, we set $\\lambda_i = 20 (t (\\log m_i + \\log \\log n))^{1/2}$.\nThen by Corollary \\ref{cor:sixteen}, the probability that a class-$i$  set does not become smaller than $2 \\lambda_i$ in $3\\log 2^i =3i$ phases is at most $16/(m_i^4 \\log^3 n)$. \nBy a union bound over all the sets in class $i$, and over all the $\\log n$ choices of $i$, each set decreases to a size at most $2\\lambda_i$ after $O(i)$ phases with probability at least $1-1/(2\\log n)$.\n\n\n \n \nUsing lemma \\ref{lem:initial-disc} with $\\beta=3 (\\log m_i+\\log\\log n)^{1/2}$, probability that a class-$i$ set $S$ gets discrepancy more than $3 (6 \\cdot ti(\\log m_i + \\log\\log n))^{1/2}$ in the first $3i$ phases is at most $2/(m_i^3\\log^3 n)$. Taking a union bound over all the $m_i$ sets in class $i$ and over all the  $\\log n$ choices of $i$, we get that each set gets discrepancy $O((ti(\\log m_i+\\log\\log n))^{1/2})$ in the first $3i$ phases with probability at least $1-1/(2\\log n)$.\n \nTogether, this implies that with probability at least $1-1/\\log n$, the discrepancy for every class-$i$ set is $O((ti ( \\log m_i+\\log\\log n))^{1/2})$.\n\\end{proof}\n\nCorollary \\ref{cor1} follows directly by plugging the bounds on $m_i$ above.\n\nFor theorem \\ref{thm:ext2}, we use another flexibility that we can reweight the rows of incidence matrix of the set system. In particular, if we scale the row $j$ by $w_j$ and still require the (weighted) vector discrepancy to be $\\sqrt{t}$, then this implies a $\\sqrt{t}/w_j$ discrepancy  on the original row. As long as this reweighting does not affect the $\\ell_2$-norms by too much, the previous bounds and analysis still goes through, while allowing us to get \ntighter bounds on selected rows.  In particular we have the following.\n\n\\bigskip \n\n\\noindent{\\bf Theorem \\ref{thm:ext2} (restated):} {\\em\n\n\nSuppose there is a reweighting of the rows $j$ with non-negative weights $w_j$ such that the $\\ell_2$-norm of any column is at most $\\beta$, then \nthe algorithm gets a discrepancy of  $O(\\beta(\\log n \\log (w_j s_j))^{1/2}/w_j)$ for each row $j$.\n}\n\n\\begin{proof}(Sketch) \nThe proof follows directly from Theorem \\ref{thm:kom}. We work with the incidence matrix of reweighted system, and then translate the bounds back to the original system.\n\\end{proof}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCorollary \\ref{cor2} follows from Theorem \\ref{thm:ext2} as follows.\n\n\\begin{proof}(Corollary \\ref{cor2})\nCall a set a class-$i$ set for $i=1,\\ldots,\\log n$, if its size lies in the range $[t 2^{i-1},t2^{i})$.\nWe choose $w_i = \\sqrt{i+\\log t}$ for class $i$ sets, and $w_i=1$ for sets of size less than $t$. Fix some element $v$, and let $m_{\\geq i}$ denote the number of sets in classes $i$ or more that contain $v$. Then, the squared $\\ell_2$-norm of columns in the weighted incidence matrix is at most \n \n", "index": 41, "text": "\\[ t + \\sum_{i=1}^{\\log n} w_i^2 (m_{\\geq i} - m_{\\geq i+1}) = t +  \\sum_{i=1}^{\\log n} (w_i^2-w_{i-1}^2) (m_{\\geq i}) \\leq \n\tt + \\sum_{i=1}^{\\log n} m_{\\geq i} = O(t) \\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex17.m1\" class=\"ltx_Math\" alttext=\"t+\\sum_{i=1}^{\\log n}w_{i}^{2}(m_{\\geq i}-m_{\\geq i+1})=t+\\sum_{i=1}^{\\log n}(%&#10;w_{i}^{2}-w_{i-1}^{2})(m_{\\geq i})\\leq t+\\sum_{i=1}^{\\log n}m_{\\geq i}=O(t)\" display=\"block\"><mrow><mrow><mi>t</mi><mo>+</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>log</mi><mo>\u2061</mo><mi>n</mi></mrow></munderover><mrow><msubsup><mi>w</mi><mi>i</mi><mn>2</mn></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>m</mi><mrow><mi/><mo>\u2265</mo><mi>i</mi></mrow></msub><mo>-</mo><msub><mi>m</mi><mrow><mi/><mo>\u2265</mo><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></mrow></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>=</mo><mrow><mi>t</mi><mo>+</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>log</mi><mo>\u2061</mo><mi>n</mi></mrow></munderover><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msubsup><mi>w</mi><mi>i</mi><mn>2</mn></msubsup><mo>-</mo><msubsup><mi>w</mi><mrow><mi>i</mi><mo>-</mo><mn>1</mn></mrow><mn>2</mn></msubsup></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>m</mi><mrow><mi/><mo>\u2265</mo><mi>i</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>\u2264</mo><mrow><mi>t</mi><mo>+</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>log</mi><mo>\u2061</mo><mi>n</mi></mrow></munderover><msub><mi>m</mi><mrow><mi/><mo>\u2265</mo><mi>i</mi></mrow></msub></mrow></mrow><mo>=</mo><mrow><mi>O</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></math>", "type": "latex"}]