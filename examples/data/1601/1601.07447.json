[{"file": "1601.07447.tex", "nexttext": "\n\nWe are interested in computing the Bayes factor that quantifies the amount of phylogenetic evidence in support of the palaeontological age range for each fossil. In this case $H_1$ is the hypothesis that the true fossil age is within the given paleontological age range, and $H_2$ is the alternative hypothesis that the true fossil age is outside the palaeontological range. \n\nThe model $M$ consists of two parts, $M=(M_\\mathcal{T},M_m)$. The model $M_\\mathcal{T}$ specifies the tree generation process  giving rise to the number of observed samples and sampling times. The model $M_m$ specifies the morphological evolution along the tree giving rise to the morphological characters for the samples. The data $D=(D_\\mathcal{T},D_m)$ is the number of samples together with the sampling times ($D_\\mathcal{T}$) and  the morphological characters for each sample ($D_m$). \n\n\nFor caclulating the Bayes factor, the probabilities $p(H_1|D,M)$ and $p(H_2|D,M)$ are obtained directly from the MCMC output.\nIt remains to calculate the probabilities $p(H_1|M)$ and $p(H_2|M)$.\nSince $H_1$ and $H_2$ are independent of $M_m$, we have \n", "itemtype": "equation", "pos": 11605, "prevtext": "\n\n\n\n\\bigskip\n\\medskip\n\\begin{center}\n\n\\noindent{\\Large \\bf Bayesian phylogenetic estimation of fossil ages} \n\n\\bigskip\n\n\\noindent {\\normalsize \\sc  Alexei J.\\ Drummond$^{1,2}$ and Tanja Stadler$^{2,3}$}\\\\\n\\noindent {\\small \\it \n$^1$Department of Computer Science, University of Auckland, Auckland, 1010, New Zealand;\\\\\n$^2$Department of Biosystems Science \\& Engineering, Eidgen\\\"{o}ssische Technische Hochschule Z\\\"{u}rich, 4058 Basel, Switzerland;\\\\\n$^3$Swiss Institute of Bioinformatics (SIB), Switzerland.}\n\\end{center}\n\\medskip\n\\noindent{\\bf Corresponding author:} Alexei J. Drummond, Department of Computer Science, University of \nAuckland, 38 Princes Street, Auckland, 1010, New Zealand; E-mail: alexei@cs.auckland.ac.nz\\\\\n\n\n\\abstract{\nRecent advances have allowed for both morphological fossil evidence and molecular sequences to be integrated into a single combined inference of divergence dates under the rule of Bayesian probability. \nIn particular the fossilized birth-death tree prior and the Lewis-MK model of evolution of discrete morphological change allow for the estimation of both divergence times and phylogenetic relationships between fossil and extant taxa. \nWe exploit this statistical framework to investigate the internal consistency of these models by estimating the phylogenetic age of each fossil in turn, within two rich and well-characterized data sets of fossil and extant species.\nWe find that we can accurately estimate the age of individual fossils based only on phylogenetic evidence. \nIn fact in the two data sets we analyze the {\\em phylogenetic age} of a fossil species is on average  $< 2$ My from the midpoint age of the geological strata from which it was excavated. \nThe high level of internal consistency found in our analyses provides strong evidence that the Bayesian statistical model employed is a good fit for both the geological and morphological data, and provides striking evidence from real data that the framework used can accurately model the evolution of discrete morphological traits coded from fossil and extant taxa. \nWe anticipate that this approach will have diverse applications beyond divergence time dating, including dating fossils that are temporally unconstrained, testing the ``morphological clock'', \nand for uncovering potential model misspecification and/or data errors when controversial phylogenetic hypotheses are obtained based on combined divergence dating analyses.\n}\n\n\\section*{Introduction}\n\n\n\n\n\n\n\nContention between palaeontologists and molecular biologists over which data provides the most accurate inferences about evolutionary history has previously fostered an adversarial relationship between the two fields \\autocite{Donoghue2007}. \nAlthough there has indeed been much controversy surrounding apparent discrepancies between palaeontological and molecular phylogenetic inferences \\autocite{BromhamPenny2003} it is also clear that fossil and molecular data both produce broadly concordant views of evolutionary history \\autocite{BentonAyala2003}. \n\n\n\n\nThe continual improvement of models and methods for statistical phylogenetic inference from molecular sequence data is well documented \\autocite[e.g.][]{Felsenstein2004,Yang2014}, and in recent years it is arguably the case that molecular phylogenetics has taken primacy over the fossil record in providing a timescale for evolutionary history \\autocite{Donoghue2007}. \nNevertheless molecular phylogenetic inference of evolutionary timescales relies critically on calibration by the fossil record \\autocite{Donoghue2007}.\n\n\n\n\nTraditionally the practice has been to use one or more fossils as ``node calibrations'' by associating their geologically-derived age to a particular divergence in a molecular phylogeny. The age of the fossil is determined either by radiometric aging of strata above and/or below the fossil, or more commonly by biostratigraphy. \nThe difficulty lies in determining the appropriate ancestral divergence in the molecular phylogeny to associate the fossil with and the details of how this should be achieved within a full statistical inference framework \\autocite{Ho2009, Heled2012, HeledDrummond2015}.\nOnce achieved, node calibration confers age estimates to the remaining ancestral divergences in the phylogenetic tree by the assumption of a strict or relaxed molecular clock \\autocite{Thorne1998,thorne2005,yang2006,Drummond2006,drummond2010}. \n\nIt may be less widely appreciated by molecular evolutionary biologists that the statistical phylogenetic revolution in molecular evolution has also been mirrored in the increasing application of statistical phylogenetic reasoning in macroevolutionary and systematic studies of the fossil record \\autocite[e.g.][]{Foote1996,huelsenbeck1997maximum, tavare2002using, WagnerMarcot2013}. \n\nHere we extend this tradition of applying phylogenetic reasoning to the fossil record by focusing on the question of what phylogenetic inference techniques can tell us about the ``phylogenetic age'' of a fossil, based solely on its morphological characteristics and through them, its phylogenetic and temporal relationships with a set of reference fossils.\n\n\n\n\nThe phylogenetic estimation of the age of a taxon based on its molecular sequence has been previously described \\autocite{drummond2002computational,shapiro2011bayesian} and applied to both ancient subfossil remains and rapidly evolving viral taxa. \nFor example, this technique has been successfully employed to estimate the age of human subfossil remains based on an ancient mitochondrial genome sequence \\autocite{meyer2014mitochondrial}. \nThe same technique has also been used to estimate the age of viral samples based on molecular sequence data \\autocite[e.g.][]{gray2013evolutionary}.\n\nWe extend this approach into the realm of discrete morphological evolution by presenting a statistical model of evolution that generates an expectation on the distribution of fossils, their morphological characters. \nThis model has been previously presented in the context of divergence time dating \\autocite{gavr2014,gavryushkina2015bayesian}. \nIt is distinct from alternative divergence time dating approaches in that it provides an explicit treatment of the temporal information contained in fossil remains, whether or not related molecular sequence data is available. \nThis leads to an estimate of the age of the most recent common ancestor of a group of fossil and extant taxa. A key difference between this approach and earlier approaches to tip-calibrated ``total-evidence'' dating \\autocite{Ronq2012} is the admission of a probability that each fossil taxon may represent a sampled ancestor of one or more taxa  in the tree \\textcite{gavr2014}.\nWe exploit this framework to attempt the estimation of the phylogenetic age of individual fossils based solely on morphological data and their phylogenetic affinities to related taxa of known age. \nThe method is applied to two rich and well-characterized morphological data sets: (i) \n\n19 extant penguins and 36 fossil relatives \\autocite{ksepka2010,ksepka2012}, (ii) a sample of nine extant canids and 123 fossil relatives \\autocite{Slater2015}.\n\n\\section*{Methods}\n\n\\textcite{gavryushkina2015bayesian} described a ``total-evidence'' approach \\autocite[implemented in BEAST2;][]{Beast2} for phylogenetic estimation of time-trees that employs both fossil and molecular sequence data as equal partners under the rule of probability. \nWe extend their work further by investigating the consistency between the estimated phylogenetic age of a fossil and the corresponding fossil age range determined by geological and biostratigraphic evidence. \nThe model of time-tree phylogeny employed is the so-called fossilized birth-death process \\autocite{Heath2014}, which forms a prior probability distribution on the space of sampled-ancestor trees \\autocite{Gavr2013}.\n\nA previous study described how a set of fossils with discrete morphological characters could be used to estimate a time-tree. \nHere we additionally allow for one or more of the fossils to have broad uninformative priors on their age. \nThis allows for the age of some of the fossils to be estimated solely based on their morphological characters and the phylogenetic affinities of their morphology to other fossils with known ages in the time-tree. \nWe refer to this estimate of a fossil's age as its {\\em phylogenetic age}. \nIn estimating each of the fossils' phylogenetic ages in turn, two questions can be answered: (i) How much information about an individual fossil's age is available from phylogenetic analysis of morphological data alone, and (ii) What is the level of phylogenetic evidence in support of the palaeontological age range for a fossil.\nThese two questions are investigated using two morphological data sets, one of 36 fossil penguins and their extant relatives \\autocite{ksepka2010,ksepka2012,gavryushkina2015bayesian}, and one of 123 canid fossils and their extant relatives \\autocite{Slater2015}.\n\n\\subsection*{Estimating the phylogenetic ages of penguin fossils}\n\n\nFor each of the 36 penguin fossils in turn we performed a separate Bayesian phylogenetic analysis in which the focal fossil's palaeontological age constraints were replaced by \nthe fossilized birth-death process prior as described below.  \nFor the choices of morphological substitution model and tree prior we followed \\textcite{gavryushkina2015bayesian} and considered two of her modelling combinations. \nThe first was {M1}{} in which a strict clock and the simplest model of morphological substitution was assumed \\autocite{Lewis2001}.\nWe also employed {M8}{} from \\textcite{gavryushkina2015bayesian} which involved a more complex model assuming a relaxed clock model \\autocite{Drummond2006}, partitioning of the sites into groups of equal state count and an additional parameter for gamma-distributed rate variation across sites \\autocite{yang:1994ma}.\n\n\\subsection*{Estimating the phylogenetic ages of Canid fossils}\n\nThe second data set that we investigated was a morphological data matrix of 132 canid species \\autocite[9 extant and 123 fossil;][]{Slater2015}. \nThe 9 extant species represent about 25\\% of the extant canid species and include representatives of four genera (6 {\\em Canis}, 1 {\\em Cuon}, 1 {\\em Lycaon}, 1 {\\em Urocyon}) and both tribes (8 Canini, 1 Vulpini). \nFor this data set we did not have a geological age range for each fossil. Instead we used the point estimates for each fossil species' geological age that were employed by the author of the original study.\n\nWe applied the M1 model to this data set assuming a fixed geological age for each taxon. Unlike the original study \\autocite{Slater2015} we did not apply any other constraints or priors on ancestral divergence times beyond the ages of the included fossils. \nAs with the penguin data set we also performed an analysis for each of the 123 canid fossils in turn. Since we can't calculate Bayes factors without a fossil age range (see following section) we simply used the same priors on macroevolutionary parameters as employed by \\textcite{gavryushkina2015bayesian} in their {M1}{} model except with an upper limit on the origin of $T_\\text{max} = 80$. To estimate the phylogenetic age of the focal fossil we sampled its age under the fossilized birth-death prior in the range $(0,T_\\text{max})$ Mya.\n\n\n\\subsection*{Computing the phylogenetic evidence for an age range}\n\nThe Bayes factor ($BF$) computes the evidence for one hypothesis ($H_1$) over another ($H_2$) as the ratio of the marginal probability of the data under each of the two hypotheses and a model $M$, \n\n\n", "index": 1, "text": "\\begin{equation}\nBF = \\frac{p(D|H_1,M)}{p(D|H_2,M)} = \\frac{p(H_1|D,M)}{p(H_2|D,M)}\\frac{p(H_2|M)}{p(H_1|M)}.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"BF=\\frac{p(D|H_{1},M)}{p(D|H_{2},M)}=\\frac{p(H_{1}|D,M)}{p(H_{2}|D,M)}\\frac{p(%&#10;H_{2}|M)}{p(H_{1}|M)}.\" display=\"block\"><mrow><mrow><mrow><mi>B</mi><mo>\u2062</mo><mi>F</mi></mrow><mo>=</mo><mfrac><mrow><mi>p</mi><mrow><mo stretchy=\"false\">(</mo><mi>D</mi><mo stretchy=\"false\">|</mo><msub><mi>H</mi><mn>1</mn></msub><mo>,</mo><mi>M</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mi>p</mi><mrow><mo stretchy=\"false\">(</mo><mi>D</mi><mo stretchy=\"false\">|</mo><msub><mi>H</mi><mn>2</mn></msub><mo>,</mo><mi>M</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac><mo>=</mo><mrow><mfrac><mrow><mi>p</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>H</mi><mn>1</mn></msub><mo stretchy=\"false\">|</mo><mi>D</mi><mo>,</mo><mi>M</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mi>p</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>H</mi><mn>2</mn></msub><mo stretchy=\"false\">|</mo><mi>D</mi><mo>,</mo><mi>M</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac><mo>\u2062</mo><mfrac><mrow><mi>p</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>H</mi><mn>2</mn></msub><mo stretchy=\"false\">|</mo><mi>M</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mi>p</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>H</mi><mn>1</mn></msub><mo stretchy=\"false\">|</mo><mi>M</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.07447.tex", "nexttext": "\n\nOne way to determine $p(H_1|M_\\mathcal{T})$ would be to simulate trees under the model $M_\\mathcal{T}$ and record the fraction of sampling times  within a given  paleontological age range. However, such a simulation approach turns out to be very time-consuming, and the procedure below provided a much faster evaluation of $p(H_1|M_\\mathcal{T})$.\n\nWe  will now derive some analytic results for evaluating $p(H_1|M_\\mathcal{T})$. In our case, the model $M_\\mathcal{T}$ is the fossilized birth-death process with priors on its parameters. Using the parameterization in \\textcite{gavryushkina2015bayesian}, the parameters are the time of the start of the process $T$, the net diversification rate $d$ (= speciation rate - extinction rate), the turnover $r$ (= extinction rate / speciation rate) and the sampling probability $s$ (=sampling rate / (extinction rate + sampling rate)).\nWe derive the probability density of sampling a fossil at time $t$ in the past, given the model $M_\\mathcal{T}$. This probability density will allow us to directly determine $p(H_1|M_\\mathcal{T})$.\n\nFor a given $T$, $d$, $r$ and $s$, the probability density of sampling a fossil at time $t$, given the process does not go extinct for time $T$, is,\n\n", "itemtype": "equation", "pos": 12853, "prevtext": "\n\nWe are interested in computing the Bayes factor that quantifies the amount of phylogenetic evidence in support of the palaeontological age range for each fossil. In this case $H_1$ is the hypothesis that the true fossil age is within the given paleontological age range, and $H_2$ is the alternative hypothesis that the true fossil age is outside the palaeontological range. \n\nThe model $M$ consists of two parts, $M=(M_\\mathcal{T},M_m)$. The model $M_\\mathcal{T}$ specifies the tree generation process  giving rise to the number of observed samples and sampling times. The model $M_m$ specifies the morphological evolution along the tree giving rise to the morphological characters for the samples. The data $D=(D_\\mathcal{T},D_m)$ is the number of samples together with the sampling times ($D_\\mathcal{T}$) and  the morphological characters for each sample ($D_m$). \n\n\nFor caclulating the Bayes factor, the probabilities $p(H_1|D,M)$ and $p(H_2|D,M)$ are obtained directly from the MCMC output.\nIt remains to calculate the probabilities $p(H_1|M)$ and $p(H_2|M)$.\nSince $H_1$ and $H_2$ are independent of $M_m$, we have \n", "index": 3, "text": "$$\\frac{p(H_2|M)}{p(H_1|M)}=\\frac{p(H_2|M_\\mathcal{T})}{p(H_1|M_\\mathcal{T})}=\\frac{1-p(H_1|M_\\mathcal{T})}{p(H_1|M_\\mathcal{T})}.$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"\\frac{p(H_{2}|M)}{p(H_{1}|M)}=\\frac{p(H_{2}|M_{\\mathcal{T}})}{p(H_{1}|M_{%&#10;\\mathcal{T}})}=\\frac{1-p(H_{1}|M_{\\mathcal{T}})}{p(H_{1}|M_{\\mathcal{T}})}.\" display=\"block\"><mrow><mrow><mfrac><mrow><mi>p</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>H</mi><mn>2</mn></msub><mo stretchy=\"false\">|</mo><mi>M</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mi>p</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>H</mi><mn>1</mn></msub><mo stretchy=\"false\">|</mo><mi>M</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>p</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>H</mi><mn>2</mn></msub><mo stretchy=\"false\">|</mo><msub><mi>M</mi><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcaf</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mi>p</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>H</mi><mn>1</mn></msub><mo stretchy=\"false\">|</mo><msub><mi>M</mi><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcaf</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac><mo>=</mo><mfrac><mrow><mn>1</mn><mo>-</mo><mi>p</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>H</mi><mn>1</mn></msub><mo stretchy=\"false\">|</mo><msub><mi>M</mi><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcaf</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mi>p</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>H</mi><mn>1</mn></msub><mo stretchy=\"false\">|</mo><msub><mi>M</mi><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcaf</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.07447.tex", "nexttext": "\nwith $\\psi=\\frac{s}{1-s} \\frac{rd}{1-r}$ being the sampling rate, and $p_i(t;d,r)$ being the probabiltiy of a single lineage producing $i$ surviving lineages at time $t$.\nThe equation above calculates the required probability: The left term conditions on survival of the process ($1-p_0(T;d,r)$). Then we calculate the probability to have $k$ lineages at time $t$ before the present $( p_k(T-t;d,r))$, multiply by the sampling rate $k \\psi$, and weight by the probability that at least one lineage of the $k$ lineages survives to the present $ (1-p_0(t;d,r)^k)$. This expression is then summed over $k=1,\\ldots, \\infty$.\n\nWe simplify, using the equations for $p_i(t;d,r)$ given in \\autocite{kendall1948}, to obtain,\n\\begin{eqnarray*}\np(t|T,d,r,s) &=& \\frac{1}{1-p_0(T;d,r)}  \\psi p_1(T-t|d,r) \\\\ & & \\times \\left[  \\frac{1}{(1-p_0(T-t|d,r)/r)^2} - \\frac{p_0(t|d,r)}{(1-p_0(t|d,r) p_0(T-t|d,r)/r)^2}  \\right]\\\\\n&=&  \\psi  \\left[ \\frac{e^{d(T-t)}}{1-p_0(T;d,r)} - \\frac{p_0(T|d,r)-p_0(T-t|d,r)}{(1-p_0(T-t|d,r))(1-p_0(t|d,r))} \\right],\n\\end{eqnarray*}\nwith $p_0(t|d,r) = \\frac{1-e^{-d*t}}{1/r - e^{-d*t}}$.\n\nNext, we need to evaluate $p(t|M_\\mathcal{T}) = \\int_{T,d,r,s} p(t|T,d,r,s) p(T) p(d) p(r) p(s)$ with $p(T), p(d), p(r)$ and $p(s)$ being the prior distributions for the parameters. This is done by sampling parameters from the prior distributions, and then evaluating $p(t|T,d,r,s)$. \n\n\\begin{figure}\n\\includegraphics[width=12cm]{priors.pdf}\n\\caption{\\label{hist8_older}Probability density for the sampling times under the fossilized birth-death process. The dot-dashed line uses priors on the parameters as in \\textcite{gavryushkina2015bayesian}. \nThe solid line uses the new prior with implicit assumptions on $T$ and $s$, the dashed line results from only assuming the implicit prior on $T$, the dotted line results from only assuming the  implicit prior on $s$. \n(Since the dashed, dotted and dot-dashed lines are governed by rare parameter combinations leading to huge trees and huge sample sizes, these lines are very sensitive to drawing another rare event, and thus need to be taken with some caution).}\n\\label{Fig:Prior}\n\\end{figure}\n\nWe determined $p(t|M_\\mathcal{T})$ for the prior distributions as in \\textcite{gavryushkina2015bayesian}, \n\n", "itemtype": "equation", "pos": 14214, "prevtext": "\n\nOne way to determine $p(H_1|M_\\mathcal{T})$ would be to simulate trees under the model $M_\\mathcal{T}$ and record the fraction of sampling times  within a given  paleontological age range. However, such a simulation approach turns out to be very time-consuming, and the procedure below provided a much faster evaluation of $p(H_1|M_\\mathcal{T})$.\n\nWe  will now derive some analytic results for evaluating $p(H_1|M_\\mathcal{T})$. In our case, the model $M_\\mathcal{T}$ is the fossilized birth-death process with priors on its parameters. Using the parameterization in \\textcite{gavryushkina2015bayesian}, the parameters are the time of the start of the process $T$, the net diversification rate $d$ (= speciation rate - extinction rate), the turnover $r$ (= extinction rate / speciation rate) and the sampling probability $s$ (=sampling rate / (extinction rate + sampling rate)).\nWe derive the probability density of sampling a fossil at time $t$ in the past, given the model $M_\\mathcal{T}$. This probability density will allow us to directly determine $p(H_1|M_\\mathcal{T})$.\n\nFor a given $T$, $d$, $r$ and $s$, the probability density of sampling a fossil at time $t$, given the process does not go extinct for time $T$, is,\n\n", "index": 5, "text": "$$p(t|T,d,r,s) = \\frac{1}{1-p_0(T;d,r)} \\sum_{k=1}^\\infty k \\psi p_k(T-t;d,r) (1-p_0(t;d,r)^k)$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"p(t|T,d,r,s)=\\frac{1}{1-p_{0}(T;d,r)}\\sum_{k=1}^{\\infty}k\\psi p_{k}(T-t;d,r)(1%&#10;-p_{0}(t;d,r)^{k})\" display=\"block\"><mrow><mi>p</mi><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">|</mo><mi>T</mi><mo>,</mo><mi>d</mi><mo>,</mo><mi>r</mi><mo>,</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>-</mo><mrow><msub><mi>p</mi><mn>0</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>T</mi><mo>;</mo><mi>d</mi><mo>,</mo><mi>r</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mfrac><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi mathvariant=\"normal\">\u221e</mi></munderover><mi>k</mi><mi>\u03c8</mi><msub><mi>p</mi><mi>k</mi></msub><mrow><mo stretchy=\"false\">(</mo><mi>T</mi><mo>-</mo><mi>t</mi><mo>;</mo><mi>d</mi><mo>,</mo><mi>r</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo>-</mo><msub><mi>p</mi><mn>0</mn></msub><msup><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo>;</mo><mi>d</mi><mo>,</mo><mi>r</mi><mo stretchy=\"false\">)</mo></mrow><mi>k</mi></msup><mo stretchy=\"false\">)</mo></mrow></mrow></math>", "type": "latex"}, {"file": "1601.07447.tex", "nexttext": " This prior specification leads to a distribution of sampling time with almost all probability mass close to the present (Figure \\ref{Fig:Prior}, dot-dashed line). Thus, essentially $p(H_1|M_\\mathcal{T})=0$  which leads to a huge Bayes Factor. This means we always reject $H_2$, but not because we necessarily agree with the paleontological age range, but because our model has no prior weight for the paleontological age range.\n\nInspection of our prior identifies two problems: (i) If we draw a large   $T$ and large $d$, we obtain very large trees with arbitrary many species close to the present, thus we have most of the sampling times close to the present. (ii) If we draw $r$ and $s$ close to 1, then we obtain a very large per-lineage  sampling rate $\\psi=\\frac{s}{1-s} \\frac{rd}{1-r}$. Thus these parameter combinations govern the probability density curve and cause again most prior weight to be close to the present.\n\nWe thus assumed new prior distributions. The net diversification rate $d: lognorm(-3.5,0.5)$ was chosen with a  smaller standard deviation which avoids  too much weight on very fast growing trees. The turnover $r: Unif(0,1)$ was set as before. \n\nFor $s$ we assume an implicit prior: we assume $lognorm(-2,1)$ for $\\psi$, and \n", "itemtype": "equation", "pos": -1, "prevtext": "\nwith $\\psi=\\frac{s}{1-s} \\frac{rd}{1-r}$ being the sampling rate, and $p_i(t;d,r)$ being the probabiltiy of a single lineage producing $i$ surviving lineages at time $t$.\nThe equation above calculates the required probability: The left term conditions on survival of the process ($1-p_0(T;d,r)$). Then we calculate the probability to have $k$ lineages at time $t$ before the present $( p_k(T-t;d,r))$, multiply by the sampling rate $k \\psi$, and weight by the probability that at least one lineage of the $k$ lineages survives to the present $ (1-p_0(t;d,r)^k)$. This expression is then summed over $k=1,\\ldots, \\infty$.\n\nWe simplify, using the equations for $p_i(t;d,r)$ given in \\autocite{kendall1948}, to obtain,\n\\begin{eqnarray*}\np(t|T,d,r,s) &=& \\frac{1}{1-p_0(T;d,r)}  \\psi p_1(T-t|d,r) \\\\ & & \\times \\left[  \\frac{1}{(1-p_0(T-t|d,r)/r)^2} - \\frac{p_0(t|d,r)}{(1-p_0(t|d,r) p_0(T-t|d,r)/r)^2}  \\right]\\\\\n&=&  \\psi  \\left[ \\frac{e^{d(T-t)}}{1-p_0(T;d,r)} - \\frac{p_0(T|d,r)-p_0(T-t|d,r)}{(1-p_0(T-t|d,r))(1-p_0(t|d,r))} \\right],\n\\end{eqnarray*}\nwith $p_0(t|d,r) = \\frac{1-e^{-d*t}}{1/r - e^{-d*t}}$.\n\nNext, we need to evaluate $p(t|M_\\mathcal{T}) = \\int_{T,d,r,s} p(t|T,d,r,s) p(T) p(d) p(r) p(s)$ with $p(T), p(d), p(r)$ and $p(s)$ being the prior distributions for the parameters. This is done by sampling parameters from the prior distributions, and then evaluating $p(t|T,d,r,s)$. \n\n\\begin{figure}\n\\includegraphics[width=12cm]{priors.pdf}\n\\caption{\\label{hist8_older}Probability density for the sampling times under the fossilized birth-death process. The dot-dashed line uses priors on the parameters as in \\textcite{gavryushkina2015bayesian}. \nThe solid line uses the new prior with implicit assumptions on $T$ and $s$, the dashed line results from only assuming the implicit prior on $T$, the dotted line results from only assuming the  implicit prior on $s$. \n(Since the dashed, dotted and dot-dashed lines are governed by rare parameter combinations leading to huge trees and huge sample sizes, these lines are very sensitive to drawing another rare event, and thus need to be taken with some caution).}\n\\label{Fig:Prior}\n\\end{figure}\n\nWe determined $p(t|M_\\mathcal{T})$ for the prior distributions as in \\textcite{gavryushkina2015bayesian}, \n\n", "index": 7, "text": "$$T: Unif(0,160), d: lognorm(-3.5,1.5), r: Unif(0,1), s: Unif(0,1).$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"T:Unif(0,160),d:lognorm(-3.5,1.5),r:Unif(0,1),s:Unif(0,1).\" display=\"block\"><mrow><mrow><mi>T</mi><mo>:</mo><mrow><mrow><mi>U</mi><mo>\u2062</mo><mi>n</mi><mo>\u2062</mo><mi>i</mi><mo>\u2062</mo><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>160</mn><mo stretchy=\"false\">)</mo></mrow></mrow><mo>,</mo><mi>d</mi></mrow><mo>:</mo><mrow><mrow><mi>l</mi><mo>\u2062</mo><mi>o</mi><mo>\u2062</mo><mi>g</mi><mo>\u2062</mo><mi>n</mi><mo>\u2062</mo><mi>o</mi><mo>\u2062</mo><mi>r</mi><mo>\u2062</mo><mi>m</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mn>3.5</mn></mrow><mo>,</mo><mn>1.5</mn><mo stretchy=\"false\">)</mo></mrow></mrow><mo>,</mo><mi>r</mi></mrow><mo>:</mo><mrow><mrow><mi>U</mi><mo>\u2062</mo><mi>n</mi><mo>\u2062</mo><mi>i</mi><mo>\u2062</mo><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mrow><mo>,</mo><mi>s</mi></mrow><mo>:</mo><mrow><mi>U</mi><mo>\u2062</mo><mi>n</mi><mo>\u2062</mo><mi>i</mi><mo>\u2062</mo><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.07447.tex", "nexttext": " (with extinction rate $\\mu = r d /(1-r)$). This avoids very high sampling rates.\n\nFor $T$, we also assume an implicit prior. We assume a uniform distribution on $[1,100]$ for the number of present day species, $N$. In expectation, we have $N=  \\frac{e^{d T}}{1-p_0(T)}$ species after time $T$. This leads to \n", "itemtype": "equation", "pos": -1, "prevtext": " This prior specification leads to a distribution of sampling time with almost all probability mass close to the present (Figure \\ref{Fig:Prior}, dot-dashed line). Thus, essentially $p(H_1|M_\\mathcal{T})=0$  which leads to a huge Bayes Factor. This means we always reject $H_2$, but not because we necessarily agree with the paleontological age range, but because our model has no prior weight for the paleontological age range.\n\nInspection of our prior identifies two problems: (i) If we draw a large   $T$ and large $d$, we obtain very large trees with arbitrary many species close to the present, thus we have most of the sampling times close to the present. (ii) If we draw $r$ and $s$ close to 1, then we obtain a very large per-lineage  sampling rate $\\psi=\\frac{s}{1-s} \\frac{rd}{1-r}$. Thus these parameter combinations govern the probability density curve and cause again most prior weight to be close to the present.\n\nWe thus assumed new prior distributions. The net diversification rate $d: lognorm(-3.5,0.5)$ was chosen with a  smaller standard deviation which avoids  too much weight on very fast growing trees. The turnover $r: Unif(0,1)$ was set as before. \n\nFor $s$ we assume an implicit prior: we assume $lognorm(-2,1)$ for $\\psi$, and \n", "index": 9, "text": "$$s=\\psi/(\\mu+\\psi)$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m1\" class=\"ltx_Math\" alttext=\"s=\\psi/(\\mu+\\psi)\" display=\"block\"><mrow><mi>s</mi><mo>=</mo><mrow><mi>\u03c8</mi><mo>/</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03bc</mi><mo>+</mo><mi>\u03c8</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.07447.tex", "nexttext": "\nOverall, this prior produces a sampling time distribution where old sampling times have a non-negligable weight (Figure \\ref{Fig:Prior}, solid line). \nThe choice of an implicit prior for both $T$ and $s$ was important: only specifying the implicit prior on $T$ yields the dashed line in Figure \\ref{Fig:Prior}, while only specifying the implicit prior on $s$ yields the dotted line in Figure \\ref{Fig:Prior}.\nWe used this new prior for our  analyses and the Bayes Factor calculation.\n\nChanging to our new prior has immense impact on the Bayes factor analysis, but in our case has a minor effect on the posterior distribution of trees / parameters compared to using the prior in  \\textcite{gavryushkina2015bayesian}.\nThis investigation of the prior distribution on trees and sampling times highlights that whenever using Bayes factors to test a hypothesis, we have to first investigate what our prior on the hypothesis is. In our example, the  prior from \\textcite{gavryushkina2015bayesian} seemed reasonable for the parameters specified, however this prior puts a negligible weight on hypothesis $H_1$ for older fossils.\n\n\nWe want to note that the stepping stone sampling approach \\autocite{Xie2011}\n\n to calculate Bayes factors would not have been possible in our case:  In stepping stone sampling the $D_\\mathcal{T}$ is treated as part of the model, not part of the data. However, using a birth-death model, the sampling times are part of the data. The approach was valid when choosing a  coalescent tree prior, as in that case sampling times are conditioned upon (and thus can be seen as part of the model) rather than being modelled (and thus are a realisation of the model which means they are data).\nIn general, even if stepping stone approaches are appropriate, we recommend to investigate $P(H_1|M)$ to investigate the prior assumption on the hypothesis to be tested. Such an investigation reveals if the cause of a high (or low) Bayes factor is due to the prior or due to signal in the data.\n\n\\section*{Results}\n\n\\subsection*{Penguins conform well to a strict morphological clock}\nAlthough {M1}{} is a very simple model, the phylogenetic age estimates for the penguin fossils were remarkably consistent with their palaeontological age ranges. \nFigure \\ref{fig:phyloAgeVsGeoAge}a plots the geological age and range against the phylogenetic age estimates. The points in this plot have $R^2 = 0.903$. \nThe median error (difference between the phylogenetic median and the geological median) is 1.96 Myr. A summary of the individual estimates are tabulated in Table \\ref{fossilTable1}.\n\nAs judged by Bayes factors, only one fossil exhibited strong evidence (i.e. $\\text{log BF} < -3.0$) that the phylogenetic age was inconsistent with the geological age range. The log BF for {\\em Paraptenodytes antarcticus} was -3.4. In fact the majority of the fossils (23/36 = 64\\%) had strong positive evidence for the geological age range (i.e. $\\text{log BF} > 3.0$).\nLikewise, if we consider only the posterior probability that the fossil is in the geological age range then three of the 36 fossils has a posterior probability $< 0.05$, suggesting low posterior support for the phylogenetic age being within the palaeontological age range.\nThese three fossils were {\\em Madrynornis mirandus}, {\\em Paraptenodytes antarcticus} and {\\em Sphenicus muizoni} with posterior probabilities that the phylogenetic age is in the palaeontological range of 0.007, 0.001 and 0.001 respectively. \nAll other fossils have posterior probabilities of $> 0.05$ of their age being in the palaeontological range. \nIt is worth noting that the absolute discrepancy in the ages are still quite moderate for the three fossils with low posterior probabilities, with {\\em M. mirandus}: 6.3Myr vs 10Myr (phylogenetic age versus palaeontological age), {\\em P. antarcticus}: 29.9 vs 22, {\\em S. muizoni}: 5.2 vs 9.1. \nThe small posterior probabilities are partially caused in these cases because the corresponding palaeontological age range is narrow, apparently suggesting very precise geological knowledge of the ages of these three fossils.\n\n\\subsection*{Relaxing the clock, site partitions, rate variation among sites}\n\n{M8}{} was the best-fitting model for the penguin data set according to the analysis of \\textcite{gavryushkina2015bayesian}. \nAs with {M1}{} this model produced phylogenetic age estimates that were very concordant with the geological age ranges of the fossils (Figure \\ref{fig:phyloAgeVsGeoAge}b), with an overall $R^2 = 0.924$. The median error was 2.05 Myr across all 36 fossils. \nIn this analysis none of the fossils exhibited any evidence (i.e. $\\text{log BF} < 0.0$) that the phylogenetic age was inconsistent with the geological age range. \nHowever if we consider the posterior probability that the fossil is in the geological age range then five of the 36 fossils had a posterior probability $< 0.05$ for {M8}{}, suggesting low posterior support for the phylogenetic age being within the palaeontological age range. \nThese five fossils were {\\em Madrynornis mirandus}, {\\em Paraptenodytes antarcticus}, {\\em Perudyptes devriesi}, {\\em Sphenicus muizoni} and {\\em Waimanu manneringi} with posterior probabilities that the phylogenetic age is in the palaeontological range of 0.035, 0.018, 0.046, 0.004, 0.037 respectively. \nAll other fossils have posterior probabilities of $> 0.05$ of their age being in the palaeontological range. \nAgain the absolute discrepancy in the ages are quite moderate for the five fossils with low posterior probabilities, with {\\em M. mirandus}: 6.7Myr vs 10Myr (phylogenetic age versus palaeontological age), {\\em P. antarcticus}: 28.0 vs 22, {\\em P. devriesi}: 49.0 vs 40, {\\em S. muizoni}: 5.1 vs 9.1 and {\\em W. manneringi}: 56.7 vs 61.05. \nA summary of all the individual estimates are tabulated in Table \\ref{fossilTable8}. \nThe individual marginal posterior distributions of phylogenetic age under {M8}{} and the corresponding geological range are shown in Figures \\ref{hist8_younger} and \\ref{hist8_older}.\n\n\n\\begin{figure}\n\\includegraphics{Figure1.pdf}\n\\caption{\\label{fig:phyloAgeVsGeoAge}\nThe Bayesian phylogenetic age estimate (median of marginal posterior) for each of the 36 penguin fossils plotted against their palaeontological age estimates, under two alternative site and molecular clock models. \nThe palaeontological age estimates are represented by the mid-point of the range and the upper and lower limits. \nThe Bayesian estimates are represented by the median of the marginal posterior distribution and the upper and lower limits of the 95\\% HPD interval. \nThe blue line shows the $x=y$. If the vertical line doesn't cross $x=y$, then the midpoint of the geological range is not in the phylogenetic 95\\% HPD. \nIf the horizontal line doesn't cross $x=y$, then the median phylogenetic estimate is not contained in the palaeontological age range. \nThe three labelled fossils have posterior probability of less than 0.05 for their age being within the palaeontological age interval.\n\n}\n\\end{figure}\n\n\\begin{figure}\n\\includegraphics[width=5in]{Figure2.pdf}\n\\caption{A plot of the number of non-ambiguous morphological sites for the taxon against the precision of the phylogenetic age for (a) {M1}{} and (b) {M8}{} (i.e. the precision is 1/variance in the marginal posterior distribution of the age).}\n\\end{figure}\n\n\\begin{figure}\n\\includegraphics[width=6in]{8_fossilDatingHist_younger.pdf}\n\\caption{\\label{hist8_younger}Marginal posterior density plots for the phylogenetic age estimate of each of the 18 penguin fossils younger than 30 Myr using {M8}{}. Red boxes are the superimposed age ranges derived from geological data.}\n\\end{figure}\n\n\\begin{figure}\n\\includegraphics[width=6in]{8_fossilDatingHist_older.pdf}\n\\caption{\\label{hist8_older}Marginal posterior density plots for the phylogenetic age estimate of each of the 18 penguin fossils older than 30 Myr using {M8}{}. Red boxes are the superimposed age ranges derived from geological data.}\n\\end{figure}\n\n\n\n\\subsection*{Comparison of simple and complex model results}\n\nOverall the results of analyzing the penguin data set with the M1 and M8 models were strikingly concordant. \nFigure \\ref{fig:compareM1M8} shows four regressions between the two models: (a) Regression of estimated phylogenetic age of {M1}{} against {M8}{}, (b) Regression of the error in the phylogenetic age estimate of {M1}{} against {M8}{} (c) Regression of posterior probability of palaeontological range of {M1}{} against {M8}{}, (d) Regression of Bayes factor (BF) for palaeontological range of {M1}{} against {M8}{}. \n\nUnder {M8}{} all fossils have positive evidence for their geological age range, whereas under {M1}{} there are a handful of fossils with negative evidence for the corresponding geological age range. Furthermore, assuming the median geological age is the truth, the variance in the phylogenetic estimation error of the fossil ages is larger under {M1}{} than under {M8}{}.\n\nThis evidence, along with the previous result that {M8}{} has a higher marginal likelihood than {M1}{} \\autocite{gavryushkina2015bayesian} suggests that the relaxed model is overall a better fit to the data. \n\n\\begin{figure}\n\\includegraphics{Figure_comparison.pdf}\n\\caption{\\label{fig:compareM1M8}\nComparison of {M1}{} against {M8}{}. (a) Estimated phylogenetic age of {M1}{} against {M8}{} with $x=y$ line (blue), (b) Regression of error in estimated phylogenetic age of {M1}{} against {M8}{}, (c) Regression of posterior probability of palaeontological range of {M1}{} against {M8}{}, (d) Regression of Bayes factor (BF) for palaeontological range of {M1}{} against {M8}{}.}\n\\end{figure}\n\n\n\n\\begin{table}[ht]\n\\centering\n\\begin{tabular}{rrrrrrrr}\n  \\hline\n & post & BF & phylo age & lower & upper & error & ESS \\\\ \n  \\hline\nAnthropornis grandis & 0.93 & 82.30 & 38.3 & 32.6 & 43.9 & 4.96 & 2118 \\\\ \n  Anthropornis nordenskjoeldi & 0.89 & 45.82 & 37.8 & 31.4 & 43.9 & 5.44 & 2694 \\\\ \n  Archaeospheniscus lopdelli & 0.50 & 20.20 & 26.4 & 21.1 & 30.8 & 1.61 & 2500 \\\\ \n  Archaeospheniscus lowei & 0.51 & 20.49 & 27.6 & 21.1 & 33.6 & 0.35 & 2076 \\\\ \n  Burnside Palaeudyptes & 0.54 & 51.19 & 36.5 & 33.2 & 39.8 & 0.69 & 2039 \\\\ \n  Delphinornis arctowskii & 0.49 & 13.95 & 36.6 & 20.2 & 48.2 & 0.86 & 328 \\\\ \n  Delphinornis gracilis & 0.27 & 5.54 & 43.1 & 33.3 & 51.4 & 5.61 & 1092 \\\\ \n  Delphinornis larseni & 0.91 & 58.87 & 39.9 & 31.3 & 49.8 & 3.38 & 955 \\\\ \n  Delphinornis wimani & 0.14 & 0.98 & 26.4 & 18.1 & 40.0 & 16.89 & 207 \\\\ \n  Duntroonornis parvus & 0.82 & 37.62 & 25.5 & 18.5 & 31.1 & 0.37 & 2113 \\\\ \n  Eretiscus tonnii & 0.47 & 10.24 & 15.9 & 10.4 & 20.5 & 2.59 & 3350 \\\\ \n  Icadyptes salasi & 0.18 & 15.19 & 34.7 & 31.3 & 37.6 & 1.71 & 2931 \\\\ \n  Inkayacu paracasensis & 0.38 & 42.57 & 35.8 & 32.3 & 38.6 & 0.68 & 3215 \\\\ \n  Kairuku grebneffi & 0.65 & 37.25 & 29.3 & 25.6 & 32.5 & 1.25 & 3506 \\\\ \n  Kairuku waitaki & 0.60 & 29.66 & 29.4 & 25.4 & 33.6 & 1.44 & 2653 \\\\ \n  Madrynornis mirandus & 0.01 & 0.58 & 6.3 & 2.3 & 9.4 & 3.68 & 2581 \\\\ \n  Marambiornis exilis & 0.70 & 34.56 & 38.7 & 31.8 & 46.2 & 1.20 & 3868 \\\\ \n  Marplesornis novaezealandiae & 0.37 & 1.81 & 16.6 & 12.3 & 20.0 & 5.96 & 3716 \\\\ \n  Mesetaornis polaris & 0.69 & 32.69 & 38.8 & 31.2 & 45.9 & 1.26 & 3963 \\\\ \n  Pachydyptes ponderosus & 0.30 & 28.76 & 36.1 & 32.4 & 39.1 & 0.86 & 2916 \\\\ \n  Palaeeudyptes antarcticus & 0.16 & 3.79 & 36.9 & 29.7 & 42.6 & 4.58 & 1499 \\\\ \n  Palaeeudyptes gunnari & 0.88 & 40.55 & 37.5 & 32.1 & 41.7 & 6.50 & 906 \\\\ \n  Palaeeudyptes klekowskii & 0.86 & 37.53 & 37.5 & 32.0 & 42.0 & 5.71 & 724 \\\\ \n  Palaeospheniscus bergi & 0.92 & 43.18 & 18.3 & 14.2 & 22.3 & 2.99 & 1243 \\\\ \n  Palaeospheniscus biloculata & 0.74 & 32.16 & 17.8 & 13.4 & 21.9 & 0.73 & 1186 \\\\ \n  Palaeospheniscus patagonicus & 0.92 & 124.83 & 18.4 & 15.6 & 21.4 & 0.09 & 1366 \\\\ \n  Paraptenodytes antarcticus & 0.00 & 0.03 & 29.9 & 26.1 & 33.3 & 7.89 & 2140 \\\\ \n  Perudyptes devriesi & 0.11 & 3.66 & 45.7 & 38.9 & 52.4 & 5.68 & 1528 \\\\ \n  Platydyptes marplesi & 0.78 & 36.73 & 24.3 & 20.5 & 27.8 & 2.21 & 4507 \\\\ \n  Platydyptes novaezealandiae & 0.49 & 22.80 & 23.6 & 18.1 & 28.2 & 0.88 & 6141 \\\\ \n  Pygoscelis grandis & 0.79 & 20.88 & 5.4 & 1.2 & 10.1 & 0.15 & 2160 \\\\ \n  Spheniscus megaramphus & 0.60 & 16.86 & 6.8 & 3.5 & 9.6 & 1.36 & 1278 \\\\ \n  Spheniscus muizoni & 0.00 & 0.25 & 5.2 & 2.4 & 7.7 & 3.95 & 5732 \\\\ \n  Spheniscus urbinai & 0.85 & 52.29 & 7.7 & 4.8 & 10.1 & 0.05 & 1033 \\\\ \n  Waimanu manneringi & 0.06 & 12.17 & 57.6 & 51.9 & 63.2 & 3.42 & 4185 \\\\ \n  Waimanu tuatahi & 0.43 & 31.03 & 60.6 & 54.8 & 66.0 & 2.34 & 3867 \\\\ \n   \\hline\n\\end{tabular}\n\\caption{Summary of results for 36 fossil penguins under Model 1. {\\em post} is the posterior probability that the phylogenetic age is within the paleaontological age range. {\\em BF} is the bayes factor in support of the palaeontogical age. {\\em phylo age} is the phylogenetic estimate of the age, along with the upper and lower of the corresponding 95\\% HPD credible interval. {\\em error} is the difference in millions of years between the phylogenetic point estimate of the fossil's age and the mean of it's paleaontological age range. {\\em ESS} is the estimated effective sample size for the phylogenetic age estimate.} \n\\label{fossilTable1}\n\\end{table}\n\n\n\n\n\\begin{table}[ht]\n\\centering\n\\begin{tabular}{rrrrrrrr}\n  \\hline\n & post & BF & phylo age & lower & upper & error & ESS \\\\ \n  \\hline\nAnthropornis grandis & 0.92 & 69.90 & 38.2 & 31.9 & 48.0 & 5.08 & 234 \\\\ \n  Anthropornis nordenskjoeldi & 0.91 & 61.86 & 37.9 & 31.9 & 45.5 & 5.39 & 302 \\\\ \n  Archaeospheniscus lopdelli & 0.58 & 27.05 & 27.2 & 22.1 & 32.0 & 0.81 & 1227 \\\\ \n  Archaeospheniscus lowei & 0.53 & 22.35 & 27.8 & 21.1 & 33.5 & 0.24 & 1134 \\\\ \n  Burnside Palaeudyptes & 0.54 & 52.95 & 36.6 & 32.2 & 40.1 & 0.63 & 699 \\\\ \n  Delphinornis arctowskii & 0.31 & 6.49 & 43.8 & 32.5 & 53.8 & 6.33 & 122 \\\\ \n  Delphinornis gracilis & 0.17 & 3.01 & 45.3 & 36.0 & 54.7 & 7.76 & 421 \\\\ \n  Delphinornis larseni & 0.96 & 130.06 & 40.1 & 33.2 & 50.1 & 3.20 & 470 \\\\ \n  Delphinornis wimani & 0.79 & 21.56 & 36.6 & 23.9 & 45.7 & 6.64 & 167 \\\\ \n  Duntroonornis parvus & 0.80 & 34.45 & 26.4 & 19.5 & 32.6 & 0.59 & 524 \\\\ \n  Eretiscus tonnii & 0.55 & 13.92 & 16.5 & 11.1 & 21.9 & 1.97 & 851 \\\\ \n  Icadyptes salasi & 0.24 & 22.50 & 35.0 & 30.1 & 38.8 & 1.50 & 680 \\\\ \n  Inkayacu paracasensis & 0.33 & 34.59 & 36.1 & 31.0 & 39.6 & 0.34 & 757 \\\\ \n  Kairuku grebneffi & 0.67 & 41.06 & 29.0 & 24.8 & 33.0 & 0.96 & 2022 \\\\ \n  Kairuku waitaki & 0.61 & 30.82 & 29.2 & 24.8 & 34.3 & 1.24 & 1233 \\\\ \n  Madrynornis mirandus & 0.03 & 2.81 & 6.7 & 1.7 & 11.9 & 3.31 & 626 \\\\ \n  Marambiornis exilis & 0.75 & 43.68 & 38.8 & 32.6 & 47.1 & 1.32 & 639 \\\\ \n  Marplesornis novaezealandiae & 0.48 & 2.83 & 15.9 & 5.8 & 20.4 & 5.28 & 333 \\\\ \n  Mesetaornis polaris & 0.74 & 41.45 & 38.8 & 32.3 & 47.1 & 1.27 & 514 \\\\ \n  Pachydyptes ponderosus & 0.28 & 26.40 & 33.9 & 28.6 & 37.6 & 1.32 & 1438 \\\\ \n  Palaeeudyptes antarcticus & 0.19 & 4.85 & 36.4 & 29.9 & 43.1 & 4.13 & 333 \\\\ \n  Palaeeudyptes gunnari & 0.89 & 43.82 & 37.8 & 32.1 & 42.0 & 6.21 & 269 \\\\ \n  Palaeeudyptes klekowskii & 0.85 & 33.30 & 37.4 & 31.3 & 41.9 & 5.89 & 387 \\\\ \n  Palaeospheniscus bergi & 0.97 & 120.25 & 18.1 & 14.7 & 21.4 & 2.73 & 596 \\\\ \n  Palaeospheniscus biloculata & 0.79 & 43.49 & 17.7 & 13.9 & 21.6 & 0.84 & 595 \\\\ \n  Palaeospheniscus patagonicus & 0.87 & 74.30 & 17.8 & 14.6 & 21.0 & 0.66 & 565 \\\\ \n  Paraptenodytes antarcticus & 0.02 & 0.63 & 28.0 & 23.2 & 32.8 & 6.03 & 1238 \\\\ \n  Perudyptes devriesi & 0.05 & 1.37 & 49.0 & 40.7 & 57.2 & 9.03 & 432 \\\\ \n  Platydyptes marplesi & 0.79 & 38.30 & 24.2 & 20.6 & 27.6 & 2.28 & 1704 \\\\ \n  Platydyptes novaezealandiae & 0.58 & 32.98 & 24.4 & 20.3 & 28.7 & 0.13 & 1530 \\\\ \n  Pygoscelis grandis & 0.81 & 25.11 & 4.6 & 0.7 & 8.2 & 0.96 & 1631 \\\\ \n  Spheniscus megaramphus & 0.71 & 26.71 & 7.8 & 3.9 & 11.0 & 0.33 & 753 \\\\ \n  Spheniscus muizoni & 0.00 & 0.95 & 5.1 & 1.9 & 8.7 & 3.98 & 1574 \\\\ \n  Spheniscus urbinai & 0.55 & 11.77 & 9.4 & 5.3 & 12.0 & 1.70 & 586 \\\\ \n  Waimanu manneringi & 0.04 & 7.16 & 56.7 & 50.6 & 61.8 & 4.38 & 1939 \\\\ \n  Waimanu tuatahi & 0.43 & 31.52 & 60.4 & 53.2 & 65.5 & 2.13 & 2157 \\\\ \n   \\hline\n\\end{tabular}\n\\caption{Summary of results for 36 fossil penguins under Model 8. {\\em post} is the posterior probability that the phylogenetic age is within the paleaontological age range. {\\em BF} is the bayes factor in support of the palaeontogical age. {\\em phylo age} is the phylogenetic estimate of the age, along with the upper and lower of the corresponding 95\\% HPD credible interval. {\\em error} is the difference in millions of years between the phylogenetic point estimate of the fossil's age and the mean of it's paleaontological age range. {\\em ESS} is the estimated effective sample size for the phylogenetic age estimate.} \n\\label{fossilTable8}\n\\end{table}\n\n\n\\subsection*{Canids conform well to a morphological clock}\n\nThe canid data set shows remarkably good consistency between palaeontological ages and phylogenetic ages, even with the simple strict morphological clock model ({M1}{}).\nThe $R^2 = 0.901$ between the phylogenetic and palaeontological ages (see Figure \\ref{fig:canidMorphVsGeo}). \nOnly 16 out of 123 fossils (13\\%) don't have the paleontological age in the credible interval of the phylogenetic age and there are no extreme outliers. \nThe median error is $1.66$My, which is even more accurate than the penguin data set.\nThis data set contains half as many morphological characters as does the penguin data set (122 versus $245$) but despite that the individual age estimates have more precision \n\n\n(median HPD range = 6.5 My for canids as opposed to 9.6My for penguins).\n\n\\begin{figure}\n\\includegraphics{1c_phyloAgeVsGeoAge.pdf}\n\\caption{\\label{fig:canidMorphVsGeo}\nThe Bayesian phylogenetic age estimate (median and credible interval of marginal posterior) for each of the 123 canid fossils plotted against their palaeontological age point estimates, under a strict morphological clock model {M1}{}. \nThe Bayesian estimates are represented by the median of the marginal posterior distribution and the upper and lower limits of the 99\\% HPD interval. Blue line shows the $x=y$. \nIf the vertical line doesn't cross $x=y$, then the geological age is not in the credible interval of the phylogenetic age. The 16 fossils for which this is the case are labelled.}\n\n\\end{figure}\n\n\\begin{figure}\n\\includegraphics[width=15cm]{1_canids-1440516016976-tree5001.pdf}\n\\caption{\\label{fig:canidTree} A sample from the posterior distribution of an analysis of the canid data set, showing two main clades, one containing the extant taxa and another constituted entirely of extinct fossil species.}\n\\end{figure}\n\n\\section*{Discussion}\n\nIn this paper we have demonstrated that even a small number of morphological characters (some of the fossils had as few as 7 morphological traits coded) can be used in the context of a rich fossil reference data set, to provide an accurate and precise age of the fossil based on a phylogenetic model. \nWe found that although a strict morphological clock does a surprisingly good job of estimated fossil ages, there is evidence that phylogenetic estimation of fossil ages is improved by a model that includes a relaxed morphological clock. \nWe found that fossil estimates were both slightly more accurate and more precise on average in the canid data set. \nThis may suggest that the larger reference set of fossils in the canid data set (122 versus 35) more than makes up for the smaller number of characters (122 versus 245) with regards to accuracy and precision of fossil age estimates.\n\nThere are a diverse array of potential applications for this methodology. \nThe most obvious is the estimation of dates for fossils that are temporally unconstrained, either due to poor knowledge of the age of the sediments in which it was found or a complete lack of provenance data (e.g. a recent fossil described as a `four-legged snake' has excited controversy for a lack of provenance\\footnote{See \\url{http://news.sciencemag.org/paleontology/2015/07/four-legged-snake-fossil-stuns-scientists-and-ignites-controversy}}). \nIt can also be used a way of testing the ``morphological clock'' and to discover potential problems in the data by identifying outlier fossils with respect to model fit. \nThe median error in age estimates for the two data sets investigated were 2 My and 1.6 My respectively, using either a very simple or more complex models of discrete morphological change. \nIn all cases we used the new fossilized birth-death tree prior, which is a crucial ingredient in allowing for the estimating of fossil ages under a birth-death tree prior. \n\nFuture work may investigate in a more systematic fashion how the amount of morphological data available for a new fossil and the number of related reference fossils of known age affect the accuracy of the phylogenetic estimate of a fossil's age.\n\nIn the mean time we anticipate that this approach will help to promote the application of a consistent probabilistic framework to consider both molecular and fossil evidence. Our results are encouraging in suggesting that the statistical models presented are adequate for inference of phylogenetic time-trees from morphological fossil data.\n\n\\section*{Availability}\n\nAll BEAST2 xml input files and R analysis scripts required to reproduce the results in this paper are available at \\url{https://github.com/alexeid/fossilDating}.\n\n\\section*{Acknowledgements}\n\nThe authors would like to thank Daniel Ksepka and Graeme T. Lloyd for insightful comments and suggestions on early drafts of this manuscript. AJD and TS were partially funded by Marsden grant UOA1324 from the Royal Society of New Zealand (\\url{http://www.royalsociety.org.nz/programme?s/funds/marsden/awards/2013-awards/}). AJD was funded by a Rutherford Discovery Fellowship from the Royal Society of New Zealand (\\url{http://www.royalsociety.org.nz}).  TS was supported in part by the European Research Council under the 7th Framework Programme of the European Commission (PhyPD; grant agreement 335529). AJD and TS also thank ETH Z\\\"{u}rich for funding.\n\n\\printbibliography\n\n\n\n", "itemtype": "equation", "pos": 18220, "prevtext": " (with extinction rate $\\mu = r d /(1-r)$). This avoids very high sampling rates.\n\nFor $T$, we also assume an implicit prior. We assume a uniform distribution on $[1,100]$ for the number of present day species, $N$. In expectation, we have $N=  \\frac{e^{d T}}{1-p_0(T)}$ species after time $T$. This leads to \n", "index": 11, "text": "$$T=\\log((1-r)N +r)/d.$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m1\" class=\"ltx_Math\" alttext=\"T=\\log((1-r)N+r)/d.\" display=\"block\"><mrow><mrow><mi>T</mi><mo>=</mo><mrow><mrow><mi>log</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>-</mo><mi>r</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>N</mi></mrow><mo>+</mo><mi>r</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>/</mo><mi>d</mi></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}]