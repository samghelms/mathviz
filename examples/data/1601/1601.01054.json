[{"file": "1601.01054.tex", "nexttext": "\nwhere $f_{ij} (S_{ij})$ is the flow (demand) from link $i$ to $j$.\nThis equality means that if, for instance, off-ramp~1 is jammed\npreventing traffic from coming in, \nthere will be no flow of traffic to mainline~2 and off-ramp~3 either.\nThis is in contrast to the fact that if congestion on off-ramp~1 spilled back\nonto the mainline, only one lane in Figure~\\ref{fig-simo} would\nbe blocked (with some knock-on effects in the adjacent lane if drivers\nwere trying to enter the leftmost lane).\nMore generally, FIFO imposes that a jam in any of the output links will block the\nflow to all output links.\nTransportation engineers find that for certain junctions the\nFIFO requirement is too strict to be realistic for this reason.\n\nSome authors (see for example \\citet{bliemer07} or \\citet{shiomi2015})\nhave suggested modeling each lane as a separate link to alleviate this\nproblem, similar to the network in Figure~\\ref{fig:seperateLanes} (in\nthe Figure, the rectangular shape of the node signifies nothing, it \nis only stretched to fit all the input and output links). The demand $S_1$\nand supply $R_2$ are split across the link lanes. This model\nresolves the unrealistic spillback problem: congestion in off-ramps~1 or~3\nwill only spill back to the links that are sending demand to an off-ramp;\nnamely, the links representing the adjacent lanes. However, this approach\nhas its own drawbacks. First and most obviously, it greatly complicates the\nsize and dimensionality of the model, making every node in a two-or-more\nlane road a merge and diverge. Secondly, it invites the question of how to\nassign commodity traffic across link lanes, and provide a model for weaving or\nlane-change behavior, questions that are abstracted away in the ``more macro''\nmacroscopic model of Figure~\\ref{fig:seperateLanes}.\n\nFigure~\\ref{fig:intermediate} shows an intermediate approach - the sending link\n$S_1$ in Figure~\\ref{fig-simo} is split upstream of the off-ramps, at the leftmost node\nin Figure~\\ref{fig:intermediate}.\nThe top and bottom links exiting this leftmost node represent the left and right lanes in\nFigure~\\ref{fig-simo}, and carry all exiting vehicles, as well as the vehicles that\ntake the left or right lanes but do not exit. The middle link then represents the middle\nthree lanes. The non-exiting vehicles rejoin the same link at the rightmost node.\nThis model limits the problems raised by separating each lane into a separate link\nlike in the network of Figure~\\ref{fig:seperateLanes}.\nThis approach does not fully eliminate the unrealistic spillback problem, as heavy\nspillback that congests the ``left lane'' or ``right lane'' link will still spill back\ninto link $S_1$. Splitting the link apart earlier would give us more room to avoid\nthe unrealistic spillback, but if we go too far upstream we can end up back at the network of\nFigure~\\ref{fig:seperateLanes}.\n\nAt this point it may appear that we have found ourselves modeling between Scylla and Charybdis: keeping the network at manageable simplicity invites unrealistic spillback behavior, while preventing the overly aggressive spillback causes the network to explode in size. In Section \\ref{sec_node_model} we present a method to overcome this dilemma, and will revisit this example in the context of our proposed solution in Section \\ref{subsec_simo}.\nOur method is relatively simple: it relies only on the lane geometry in junctions like in Figure~\\ref{fig-simo}.\n\n\n\\subsection{The logit traffic assignment model}\nAs mentioned in Section~\\ref{sec_intro}, the logit traffic assignment rule is\na regression-based approach for determining the route\nchoice proportions among a population.\nA typical logit model states that commodity $c$'s split ratio from input link $i$ to \noutput link $j$ is given by\n\n", "itemtype": "equation", "pos": 18337, "prevtext": "\n\\maketitle\n\n\n\\begin{abstract}\nThis paper discusses first order node models for macroscopic multi-commodity traffic simulation. There are two parts: (1) input-output flow computation based on input demand, input link priorities, split ratios that define how incoming flow is distributed between output links, and output supply; and (2) a traffic assignment algorithm for the case when split ratios are not known a priori or are only partially known.\n\nInput link priorities define how output supply is distributed between incoming flows. We deal with arbitrary input link priorities. Also, in this node model we specifically address the issue of the First-In-First-Out (FIFO) rule: in the case of one of the output links being overly congested the FIFO rule may be too restrictive, blocking the flow to other outputs and causing unreasonable spillback. We relax the FIFO rule through a parametrization that describes how output links influence each other and allows tuning the model to anything between full FIFO and no FIFO.\n\nIn the existing research the prevailing approach to local traffic assignment is to use a mode choice (logit or probit) model. In this paper we discuss the shortcomings of the logit model and introduce a nonparametric route choice algorithm that produces split ratios based only on link demands and supplies.\n\nAll methods in this paper are presented for multi-commodity traffic flows.\n\\end{abstract}\n\n\n{\\bf Keywords}: macroscopic first order traffic model, first order node model,\nmulti-commodity traffic, dynamic traffic assignment, dynamic network loading\n\n\\section{Introduction}\\label{sec_intro}\n\\defcitealias{csmps}{Caltrans, 2015}\n\nTraffic simulation models are vital tools for traffic engineers and practitioners. As in other disciplines focusing on complex systems, such as climate or population dynamics, traffic models have helped to deepen our understanding of traffic behavior. They are widely used in transportation planning projects in which capital investments must be justified with simulation-based studies~\\citepalias{csmps}. Recently, with the increased interest in Integrated Corridor Management (ICM) and Decision Support Systems (DSS), traffic models have also found a new role in real-time operations management. In both the planning and ICM/DSS contexts, the models have steadily grown larger - such as highway plans that append adjacent arterial networks or managed lanes~\\citep{floridaDOT2013} - and more complex - such as integration of new ``smart'' vehicle and communications technologies into real-time ICM.\n\nTraffic models are typically divided into three categories based on their level of abstraction. At the most granular level, microscopic models simulate the motion and behavior of individual vehicles. At the other extreme, macroscopic models describe the evolution of traffic density and buildup and breakdown of congestion along the lineal direction of a road; these models are based on the ``kinematic wave'' abstraction of traffic as a fluid flow. Mesoscopic traffic models occupy the intermediate space. This paper focuses on the ``node model'' portion of first-order macroscopic models, where the state of the road is fully determined by the vehicle density along its length. Of the three, the highly-abstracted macroscopic models unsurprisingly have the lowest computational cost.\n\nA macroscopic model is said to consist of a ``link'' model and a ``node'' model. A link model describes the evolution through time of the traffic flow along homogeneous sections of road.\nIndividual links are taken to have constant vehicle density $\\rho$ along their length\\footnote{Some authors use an alternative terminology of the macroscopic model elements, recalling the original terms used by~\\citet{daganzo94}. In this alternative description, links may not have homogeneous density, but may instead be further divided into smaller lengths of road called cells, which themselves have homogeneous density. These cells would be equivalent to links in our terminology.},\nand the link model describes, as a function of its current density, both the amount of vehicles trying to exit the link (called the sending function $S(\\rho)$, or \\emph{demand}) and the amount of vehicles that the link is able to accept (called the receiving function $R(\\rho)$, or \\emph{supply}) over the next simulation timestep.\nA traffic model may contain multiple classes of vehicles that share the road, and each class may have their own sending functions.\nSeparate vehicle classes are often called ``commodities.''\nExogenous to the link and node models are the so-called \\emph{turning} or \\emph{split ratios}, which define the driver behavior at the junction - the ratios of vehicles of each commodity that take each of the available movements.\nNodes join the links, and the node model computes the set of flows through a node for each commodity as a function of its incoming links' sending functions and its outgoing links' receiving functions.\n\nOf course, while a macroscopic model may be fast relative to more granular meso- and microscopic models, their computational needs are affected with the growth of network size and complexity.\nHigh computational cost can be exacerbated in modern ICM applications, as well.\nMany real-time traffic state estimation techniques follow an \\emph{ensemble method} approach, where many simulations describing different possible events are processed simultaneously (see e.g.~\\citet{work2009trafficmodel},~\\citet{pf}).\nICM decision-making can follow a similar approach, with multiple simulations being performed at a plan-evaluation step to project traffic outcomes under a range of possible future demands.\n\nWhile the computational complexities stemming from links have been well-studied, node models can be sources of computational costs as well.\nThese costs emerge when one models a network with many junctions multi-input our multi-output junctions, that is, a junction where more than two links enter or exit.\nWe adopt the term ``high-dimensional'' to describe these sorts of networks, to avoid ambiguity with similar terms such as ``large,'' which may also describe networks with many long roads and not many junctions.\nThis paper draws on the authors' experience in creating models for high-dimensional networks that describe a freeway, adjacent managed lanes (such as high-occupancy vehicle (HOV) lanes or tolled lanes), and/or the surrounding arterial grid for ICM purposes.\nWe will discuss how modern node models can exacerbate computational complexity in high-dimensional networks by creating a dilemma between model accuracy and number of links; thankfully, this tradeoff can be overcome in a simple manner, as we will detail in Section~\\ref{sec_node_model}.\n\nData needs can also be prohibitive in large and high dimensional networks.\nSimilar to link models, node models have parameters that must be learned from data.\nIn particular, the widely-used ``logit''~\\citep{mcfadden_conditional_1973} method for determining driver route choice at junctions learns a statistical model for drivers' route selection as a function of a route state (e.g., the expected route travel time).\nWhen one needs a route choice model for many nodes, the data needs can be prohibitive, or their collection infeasible.\nArterial networks with many junctions may not have necessary penetration of sensors.\nWe present a parameter-free route choice model to overcome problems arising from this dearth of driver behavior data in Section~\\ref{sec_sr_assignment}.\n\n\\section{Common junction models and their drawbacks}\\label{sec_node_review}\n\\subsection{Node models}\n\\label{subsec_node_review}\n\nThe traffic node problem is defined on a junction of $M$ input links, indexed by $i$,\nand $N$ output links, indexed by $j$, with $C$ vehicle commodities, indexed by $c$.\nAs mentioned above, in first-order traffic models, the node model is said to\nconsist of the mechanism by which incoming links' per-commodity demands $S_i^c$, split ratios\n$\\beta_{ij}^c$ (which define the portion of vehicles of commodity $c$ in link $i$ that wish\nto exit to link $j$), and outgoing\nlinks' supplies $R_j$ are resolved to produce throughflows $f_{ij}^c$. During simulation\nof a traffic network, the link and node models are dynamically evaluated at each timestep,\nso the quantities $S_i^c$, $R_j$, $\\beta_{ij}^c$, and $f_{ij}^c$ are in fact time-dependent. \nIn general,\nthe parameters of the link and node models may be time-varying as well. To simplify the\nnotation, in this paper we consider the node model evaluation in each timestep as an\nisolated problem, and omit any temporal notation.\n\nThe node problem's\nhistory begins with the original formulation of discretized first-order traffic flow\nmodels~\\citep{daganzo95a}. There have been many developments in the node model theory\nsince, but we will reflect only on some more recent results.\nWe can divide the node model literature into pre- and\npost~\\citet{tampere11} epochs. \\cite{tampere11} drew from the literature several\nearlier-proposed node model requirements to develop a set of necessary\nconditions for first-order node models that they call the ``general class of first-order node models.''\nTo review, these conditions are:\n\\begin{enumerate}\n\t\\item Applicability to general numbers of input links $M$ and\n\toutput links $N$. In the case of multi-commodity flow, this requirement\n\talso extends to general numbers of commodities $c$.\n\t\n\t\\item Maximization of the total flow through the node.\n\tMathematically, this may be expressed as $\\max \\sum_{i,j,c} f_{ij}^c$.\n\tAccording to~\\citet{tampere11}, this means that\n\t``each flow should be actively restricted by one of the constraints,\n\totherwise it would increase until it hits some constraint''.\n\tWhen a node model is formulated as a constrained optimization problem,\n\tits solution will automatically satisfy this requirement.\n\tHowever, what this requirement really means is that constraints should be\n\tstated \\emph{correctly} and not be overly simplified and, thus,\n\toverly restrictive for the sake of convenient problem formulation.\n\tSee the literature review in \\citet{tampere11} for examples of node models\n\tthat inadvertently do not maximize node throughput by oversimplifying their\n\trequirements. \\label{item:maxFlow}\n\t\n\t\\item Non-negativity of all input-output flows. Mathematically, $f_{ij}^c \\ge 0$\n\tfor all $i,j,c$.\n\t\n\t\\item Flow conservation: Total flow entering the node must be equal to total flow\n\texiting the node. Mathematically, $\\sum_i f_{ij}^c = \\sum_j f_{ij}^c$ for all $c$.\n\t\\item Satisfaction of demand and supply constraints. Mathematically, $\\sum_j f_{ij}^c \\le S_i^c$ and $\\sum_i f_{ij}^c \\le R_j$.\n\t\n\t\\item Satisfaction of the first-in-first-out (FIFO) constraint: if a single\n\tdestination $j$ for a given $i$ is not able to accept all demand\n\tfrom $i$ to $j$, all flows from $i$ are also constrained. This requirement is\n\tsometimes called ``conservation of turning fractions'' (CTF). Mathematically,\n\t$f_{ij}^c / \\sum_i f_{ij}^c = \\beta_{ij}^c$.\n\t\n\tWe believe that in some situations, the FIFO constraint may be too restrictive.\n\tIt should not be completely eliminated, however, but must be relaxed through\n\ta parametrization. We will revisit this point in the following Section.\n\t\n\t\\item Satisfaction of the invariance principle.\n\tIf the flow from some input link $i$ is restricted by the available output\n\tsupply, this input link enters a congested regime.\n\tThis creates a queue in this input link and causes its demand $S_i$ to jump\n\tto capacity $F_i$ in an infinitesimal time, and therefore,\n\ta node model should yield solutions that are invariant to replacing $S_i$ with\n\t$C_i$ when flow from input link $i$ is supply constrained~\\citep{lebacque05}.\n\\end{enumerate}\n\nThis paper concerns multi-commodity traffic, which is unaddressed in the preceding\nlist. To address multi-commodity traffic, we add another requirement,\n\\begin{enumerate}\n\\item[8.] Supply restrictions on a flow from any given input link are\nimposed on commodity components of this flow proportionally to their \npresence in this link.\n\\end{enumerate}\nAs opposed to the first seven, we do not view requirement 8\nas a general principle. \nRather, we list it here as a rule that we follow throughout this paper.\nOther modelers may decide another method to\ndistribute supply restrictions across commodities, should there be\nevidence that spillback affects different vehicles classes in a link\nat different rates.\n\nIn addition to the above numbered requirements, two additional elements are required\nto define a node model. The first is a rule for the portioning of output link supplies\n$R_j$ among the input links. Following~\\citet{gentile07}, in~\\citet{tampere11} it was \nproposed to allocate supply for incoming flows proportionally to input link capacities,\nwhich we will denote $F_i$.\n\nThe second necessary element is a redistribution of ``leftover supply.'' Following the\ninitial partitioning of supplies $R_j$, if one or more of the supply-receiving input links\ndoes not fill its allocated supply,\nsome rule must redistribute the difference to other input links who may still fill it.\nThis second element is meant to model the selfish behavior of drivers to take any space\navailable, and ties in closely with requirement \\ref{item:maxFlow} above.\n\\citet{tampere11} referred to these two elements collectively as a ``supply\nconstraint interaction rule'' (SCIR).\n\nMentioned as an optional addition by \\citet{tampere11} are ``node supply constraints.''\nWhat is meant by these are supply quantities internal to the node, in addition\nto link supplies $R_j$. These node supplies are meant to model ``shared resources''\nthat multiple movements may make use of: each movement $i,j$ through the node may\nor may not consume\nan amount of a node supply proportional to $\\sum_c f_{ij}^c$. A node supply being\nfully consumed would constrain these flows in a manner analogous to the link\nsupplies. The obvious example of such a ``shared resource'' node supply is green\ntime at a signalized intersection; see \\citet{tampere11} for further discussion\nof this example. In \\citet{corthout_non-unique_2012} it was noted that these \nnode supplies may lead to non-unique solutions. We will not make use of these\nnode supplies in the remainder of this paper.\n\nThe \\citet{tampere11} requirements invite the modeler to design supply portioning\nand/or redistribution rules that, in some sense, model traffic behavior, add them \nto the numbered requirements, and create new node models. Recall that \\citet{tampere11}\nsuggested portioning the supplies $R_j$ proportionally to the input links capacities $F_i$.\n\\citet{gibb_model_2011} suggested a supply portioning rule based on a so-called\n``capacity-consumption equivalence,'' which states, qualitatively, that movements\ninto a supply-constrained output link $j'$ are characterized by drivers from individual\ninput links $i$ taking their movements $i,j'$ one after the other in turn. The supply\nportioning rule thus says that the input links $i$, where drivers spend more time\nwaiting for entry into congested links $j$, are assigned less supply from all links,\nincluding those not in congestion.\n\n\\citet{smits_family_2015} argue that the quantities of interest in the node model\nproblem should not be the flows $f_{ij}^c$, but rather the quantities\n$1/ ( \\sum_c f_{ij}^c)$, which are equal to the amount of time (relative to the\nsimulation timestep) that a vehicle needs to make movement $i,j$ through the node.\nThey claim that this quantity is measurable in the field, and good node models\nwould produce flows that emulate observed movement times. They review the node\nmodels proposed in \\citet{tampere11} and \\citet{gibb_model_2011} in this\nre-parametrization and present others with different supply portioning and\nredistribution rules.\n\nIt is important to note that the node model in\n\\citet{gibb_model_2011} and the so-called ``equal delay at outlink'' model of\n\\citet{smits_family_2015} define their supply portioning and redistribution\nrules \\emph{implicitly}. A consequence is that their solutions must be found\nthrough an fixed-point iterative procedure, whose iterations-until-convergence\nare potentially unbounded (this point was originally raised by \\citet{smits_family_2015}).\nOn the other hand, the capacity-proportional node model of\n\\citet{tampere11} and ``single server'' model of \\citet{smits_family_2015} \nare examples of \\emph{explicit} supply portioning rules.\n\nFor our purposes, we will focus on node models\nwith explicit supply portioning and redistribution rules.\n\nWhile \\citet{tampere11} used the capacity-proportional supply portioning rule,\nwe will slightly generalize this to admit arbitrary per-input link priorities\n$p_i$ in the spirit of \\citet{daganzo95a}.\n\n\\subsection{Implications of the FIFO flow rule}\nWe noted in Section~\\ref{subsec_node_review} that the FIFO, or ``conservation of\nturning fractions'' rule in the \\citet{tampere11} node requirements may be\ntoo restrictive. Consider the example junction depicted in Figure \\ref{fig-simo}.\nIt depicts a five-lane freeway with left and right exits. The natural network representation\nof this junction would have one node with one input link, with demand $R_1$,\nand three output links, with supplies $R_1$, $R_2$, and $R_3$, similar to\nFigure~\\ref{fig:1to3}.\n\n\\begin{figure}[htb]\n\\centering\n\\includegraphics[width=4in]{./Figures/simo.png}\n\\caption{A node with one input and three output links, where\ncongestion in output links~1 and~3 only partially affects\nflow into output link~2, while congestion in link~2 affects\nflows into output links~1 and~3 in full, and output links~1\nand~3 do not affect each other.}\n\\label{fig-simo}\n\\end{figure}\n\n\\begin{figure}\n\\centering\n\t\\begin{subfigure}[b]{.3\\textwidth}\n\t\t\\includegraphics[width=\\textwidth]{./Figures/1to3}\n\t\t\\caption{}\n\t\t\\label{fig:1to3}\n\t\\end{subfigure} \\quad\n\t\\begin{subfigure}[b]{.3\\textwidth}\n\t\t\t\\includegraphics[width=\\textwidth]{./Figures/seperateLanes}\n\t\t\t\\caption{}\n\t\t\t\\label{fig:seperateLanes}\n\t\\end{subfigure} \\quad\n\t\\begin{subfigure}[b]{.3\\textwidth}\n\t\t\t\\includegraphics[width=\\textwidth]{./Figures/intermediate}\n\t\t\t\\caption{}\n\t\t\t\\label{fig:intermediate}\n\t\\end{subfigure}\n\t\\caption{Three network representation of the junction in Figure~\\ref{fig-simo}.}\n\t\\label{fig:networks}\n\\end{figure}\n\nHere, the FIFO constraint translates into:\n", "index": 1, "text": "\n\\[\n\\frac{f_{11}}{S_{11}} =\n\\frac{f_{12}}{S_{12}} =\n\\frac{f_{13}}{S_{13}},\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"\\frac{f_{11}}{S_{11}}=\\frac{f_{12}}{S_{12}}=\\frac{f_{13}}{S_{13}},\" display=\"block\"><mrow><mrow><mfrac><msub><mi>f</mi><mn>11</mn></msub><msub><mi>S</mi><mn>11</mn></msub></mfrac><mo>=</mo><mfrac><msub><mi>f</mi><mn>12</mn></msub><msub><mi>S</mi><mn>12</mn></msub></mfrac><mo>=</mo><mfrac><msub><mi>f</mi><mn>13</mn></msub><msub><mi>S</mi><mn>13</mn></msub></mfrac></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nwhere $x$ is some state variable (for example, route lengths,\ncosts, travel times, etc.) and $J_{ij} (\\cdot)$ is a real-valued utility\nfunction for movement $i,j$. The function\n\n", "itemtype": "equation", "pos": 22176, "prevtext": "\nwhere $f_{ij} (S_{ij})$ is the flow (demand) from link $i$ to $j$.\nThis equality means that if, for instance, off-ramp~1 is jammed\npreventing traffic from coming in, \nthere will be no flow of traffic to mainline~2 and off-ramp~3 either.\nThis is in contrast to the fact that if congestion on off-ramp~1 spilled back\nonto the mainline, only one lane in Figure~\\ref{fig-simo} would\nbe blocked (with some knock-on effects in the adjacent lane if drivers\nwere trying to enter the leftmost lane).\nMore generally, FIFO imposes that a jam in any of the output links will block the\nflow to all output links.\nTransportation engineers find that for certain junctions the\nFIFO requirement is too strict to be realistic for this reason.\n\nSome authors (see for example \\citet{bliemer07} or \\citet{shiomi2015})\nhave suggested modeling each lane as a separate link to alleviate this\nproblem, similar to the network in Figure~\\ref{fig:seperateLanes} (in\nthe Figure, the rectangular shape of the node signifies nothing, it \nis only stretched to fit all the input and output links). The demand $S_1$\nand supply $R_2$ are split across the link lanes. This model\nresolves the unrealistic spillback problem: congestion in off-ramps~1 or~3\nwill only spill back to the links that are sending demand to an off-ramp;\nnamely, the links representing the adjacent lanes. However, this approach\nhas its own drawbacks. First and most obviously, it greatly complicates the\nsize and dimensionality of the model, making every node in a two-or-more\nlane road a merge and diverge. Secondly, it invites the question of how to\nassign commodity traffic across link lanes, and provide a model for weaving or\nlane-change behavior, questions that are abstracted away in the ``more macro''\nmacroscopic model of Figure~\\ref{fig:seperateLanes}.\n\nFigure~\\ref{fig:intermediate} shows an intermediate approach - the sending link\n$S_1$ in Figure~\\ref{fig-simo} is split upstream of the off-ramps, at the leftmost node\nin Figure~\\ref{fig:intermediate}.\nThe top and bottom links exiting this leftmost node represent the left and right lanes in\nFigure~\\ref{fig-simo}, and carry all exiting vehicles, as well as the vehicles that\ntake the left or right lanes but do not exit. The middle link then represents the middle\nthree lanes. The non-exiting vehicles rejoin the same link at the rightmost node.\nThis model limits the problems raised by separating each lane into a separate link\nlike in the network of Figure~\\ref{fig:seperateLanes}.\nThis approach does not fully eliminate the unrealistic spillback problem, as heavy\nspillback that congests the ``left lane'' or ``right lane'' link will still spill back\ninto link $S_1$. Splitting the link apart earlier would give us more room to avoid\nthe unrealistic spillback, but if we go too far upstream we can end up back at the network of\nFigure~\\ref{fig:seperateLanes}.\n\nAt this point it may appear that we have found ourselves modeling between Scylla and Charybdis: keeping the network at manageable simplicity invites unrealistic spillback behavior, while preventing the overly aggressive spillback causes the network to explode in size. In Section \\ref{sec_node_model} we present a method to overcome this dilemma, and will revisit this example in the context of our proposed solution in Section \\ref{subsec_simo}.\nOur method is relatively simple: it relies only on the lane geometry in junctions like in Figure~\\ref{fig-simo}.\n\n\n\\subsection{The logit traffic assignment model}\nAs mentioned in Section~\\ref{sec_intro}, the logit traffic assignment rule is\na regression-based approach for determining the route\nchoice proportions among a population.\nA typical logit model states that commodity $c$'s split ratio from input link $i$ to \noutput link $j$ is given by\n\n", "index": 3, "text": "\\begin{equation}\n\t\\beta_{ij}^c = \\frac{\\exp (J_{ij} (x))}{\\sum_{j'=1}^N \\exp (J_{ij'} (x))} \\label{eq:logit}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"\\beta_{ij}^{c}=\\frac{\\exp(J_{ij}(x))}{\\sum_{j^{\\prime}=1}^{N}\\exp(J_{ij^{%&#10;\\prime}}(x))}\" display=\"block\"><mrow><msubsup><mi>\u03b2</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow><mi>c</mi></msubsup><mo>=</mo><mfrac><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>J</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><msup><mi>j</mi><mo>\u2032</mo></msup><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>J</mi><mrow><mi>i</mi><mo>\u2062</mo><msup><mi>j</mi><mo>\u2032</mo></msup></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mfrac></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nis often called the softmax function. It serves to ``squash'' the $N$ real-valued utility functions\nin~\\eqref{eq:logit} to the $N$-dimensional simplex \n$[0,1]^N = \\left\\{ \\beta_i \\in {\\cal R}^N : 0 \\leq \\beta_{ij} \\leq 1 \\forall j \\in  \\left\\{ 1, \\dots, N \\right\\}, \\sum_{j=1}^N \\beta_{j} = 1 \\right\\}$.\nWhen the $J_{ij}(\\cdot)$ are all linear or affine in their $x_j$, this becomes the multinomial logistic\nregression generalized linear model~\\citep{GLM}.\n\nIf instead~\\eqref{eq:logit} is modified to read\n\n", "itemtype": "equation", "pos": 22477, "prevtext": "\nwhere $x$ is some state variable (for example, route lengths,\ncosts, travel times, etc.) and $J_{ij} (\\cdot)$ is a real-valued utility\nfunction for movement $i,j$. The function\n\n", "index": 5, "text": "\\begin{equation}\n\t\\sigma: {\\cal R}^K \\to [0,1]^K; \\quad \\sigma(z)_j = \\frac{ \\exp( z_j )}{ \\sum_{k=1}^K \\exp( z_k ) }\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"\\sigma:{\\cal R}^{K}\\to[0,1]^{K};\\quad\\sigma(z)_{j}=\\frac{\\exp(z_{j})}{\\sum_{k=%&#10;1}^{K}\\exp(z_{k})}\" display=\"block\"><mrow><mi>\u03c3</mi><mo>:</mo><mrow><mrow><msup><mi class=\"ltx_font_mathcaligraphic\">\u211b</mi><mi>K</mi></msup><mo>\u2192</mo><msup><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><mi>K</mi></msup></mrow><mo rspace=\"12.5pt\">;</mo><mrow><mrow><mi>\u03c3</mi><mo>\u2062</mo><msub><mrow><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo></mrow><mi>j</mi></msub></mrow><mo>=</mo><mfrac><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nthe only argument to the functions $J_{ij}^c(\\cdot)$ is the route-specific data\n$x_j$. This approach relies on an assumption that the utility of each lane is independent of\nall other lane states $x_j$,\ne.g., if the functions $J_{ij}^c(\\cdot)$ in~\\eqref{eq:logit} are linear in $x$, then~\\eqref{eq:indepLanes} assumes\nthat the coefficients of all $J_{ij}^c(\\cdot)$ for all elements of $x$ not in $x_j$ are zero. \nRoute choice models in the transportation literature often use this formulation (a useful overview can be found in \\citet{bliemer_impact_2008}). Although the route\nchoice literature often refers to~\\eqref{eq:indepLanes} as the ``multinomial logit model,''~\\eqref{eq:indepLanes}\nis more properly known as the ``conditional logit model''~\\citep{mcfadden_conditional_1973}, with ``multinomial logit\nmodel'' reserved for the general case~\\eqref{eq:logit}.\n\nThe logit route choice model is a statistical model: The $C \\cdot N$ sets of parameters, one for each $J_{ij}^c(\\cdot)$, are meant to be learned from data.\nThese data take the form of input-output pairs $( \\beta_{ij}^c, x_j)$, i.e. observed link states $x_j$ paired with their caused split ratios $\\beta_{ij}^c$. In the use of a statistical model, the usual caveats must be kept in mind. \nIn addition, it is desired that the data collected span much of the space of possible states $x_j$, or at least those subspaces the modeler would wish to query during simulation. Training a logit model with data from subspace of $x_j$, then querying in another subspace of $x_j$, is a statistical extrapolation, which is of course risky and unpredictable.\n\nThe continued development and use of the logit model is a testament to its predictive power when sufficient data is available. If studying a single intersection, collecting, analyzing, and storing enough data may be challenging but feasible. For a large or high-dimensional network, the task may be more onerous or unrealistically expensive. In a planning, prediction, or ICM scenario, it may in fact be impossible: one could not collect data from certain network states if the states or infrastructure under consideration are in fact the counterfactual.\n\nIn addition, the fact that the logit model describes route choice in terms of utility means that its parameters have no physical meaning, precluding making any sort of ``sanity check.'' This means that hand-tuning the parameters of $J_{ij}^c(\\cdot)$ to produce realistic results in the absence of sufficient data is not easy. In a related problem, the abstraction of route utility can lead to a ``black-boxing'' of the workings of the model. Observed irregularities in simulation behavior can be difficult to track down to the erroneous model parameters or components. These problems, of course, are only exacerbated when the network becomes high-dimensional, with many parameters.\n\nOne useful approach to apply the logit model in high-dimensional settings may be estimation of the utility functions $J_{ij}^c$ on a data-rich link or junction, then transplanting these parameters to a similar, but poorly-instrumented, link. The hypothesis would be that their utility functions are similar.\nUnfortunately, we have some evidence for the instability of the logit model in these extrapolation scenarios from a study in a context of varying sets of available routes by~\\citet{bliemer_impact_2008}.\nThey found that many basic and extended logit models are fragile in these situations.\nIf one considers a junction with relevant and irrelevant routes (irrelevant, in this context, means that their utility values $J_{ij}^c$ are small relative to the relevant routes), it turns out that calibrating the model with data collected while the irrelevant routes exist, then querying it without the irrelevant routes (or vice versa) will produce incorrect values of $\\beta_{ij}^c$. This means that the utility functions $J_{ij}^c$ may in fact not be independent of other output link states.\n\nThe example used by~\\citet{bliemer_impact_2008} did not feature the a transplanting of model parameters.\nRather, the calibration and querying steps were on the same network; the irrelevant routes were highly circuitous.\nStill, it is evidence that logit parameters are not, in general, reusable across junctions that have different routes to choose from\\footnote{\\citet{bliemer_impact_2008} did find that one extended logit model performed adequately in recreating the proper $\\beta$. However, this model also encodes the length of road overlap between routes. We would not expect that parameters learned from one junction, then transplanted to another junction with different route overlap structures, would provide good prediction accuracy.}.\n\nWhat is to be done, then?\nIn Section \\ref{sec_sr_assignment} we present an alternative route choice algorithm for high-dimensional or data-deficient networks.\nOur algorithm is myopic to the node and agnostic to the link state: it only attempts to balance demand-supply ratios $R/S$ across nodes. Our algorithm is inspired by classic integral control, which has historically been applied to ``black-box'' problems with success.\n\n\\section{A node model for dimensionality management}\\label{sec_node_model}\nOur notation for the node model problem has been introduced above.\nWe summarize it here:\n\\begin{itemize}\n\\item $M$ --- number of input links;\n\\item $i$ --- index of an input link ($i=1,\\dots,M$);\n\\item $N$ --- number of output links;\n\\item $j$ --- index of an output link ($j=1,\\dots,N$);\n\\item $C$ --- number of commodities;\n\\item $c$ --- index of a commodity ($c=1,\\dots,C$);\n\\item $S_i^c$ --- how much traffic of commodity $c$ input $i$ wants to send\n(demand or sending function), $S_i=\\sum_{c=1}^C S_i^c$;\n\\item $p_i$ --- input link priority;\n\\item $R_j$ --- how much traffic output $j$ can receive\n(supply or receive function);\n\\item $\\beta_{ij}^c\\in[0, 1]$ --- split ratios that distribute traffic\nof a given commodity $c$ coming from input link $i$ between\noutput links, $\\sum_{j=1}^N\\beta_{ij}^c=1$;\n\\item $S_{ij}^c = \\beta_{ij}^c S_i^c$ --- oriented demand for commodity\n$c$ from input link $i$ to output link $j$,\n$S_{ij}=\\sum_{c=1}^C S_{ij}^c$;\n\\item $f_{ij}^c$ --- input-output flows that the node model computes,\n$f_{ij}=\\sum_{c=1}^C f_{ij}^c$.\n\\end{itemize}\n\n\nThis Section is organized as follows.\nWe start by describing the merge problem --- the multi-input-single-output\n(MISO) node in Section~\\ref{subsec_miso} to explain the concept of input \nlink priorities.\nThen, we propose a way of relaxing the FIFO\ncondition and explain it in the case of a single-input-multi-output (SIMO) node\nin Section~\\ref{subsec_simo}.\nFinally, in Section~\\ref{subsec_mimo_relaxed} we proceed to the\ngeneral multi-input-multi-output (MIMO) node putting all the concepts\ntogether.\n\n\n\n\n\n\n\n\n\n\n\\subsection{Multiple-Input-Single-Output (MISO) Node: Explaining Input Priorities}\\label{subsec_miso}\nTo better explain the meaning of input link priorities,\nwe start by considering a node with $M$ input links and 1 output link.\nThe number of vehicles of type $c$ that input link $i$ wants to send is $S_i^c$.\nThe flow entering from input link $i$ has priority $p_i\\geq 0$.\nHere $i=1,\\dots,M$ and $c=1,\\dots,C$.\nThe output link can receive $R_1$ vehicles.\n\nCasting the computation of input-output flows $f_{i1}^c$ as a mathematical\nprogramming problem, we arrive at:\n\n", "itemtype": "equation", "pos": 23116, "prevtext": "\nis often called the softmax function. It serves to ``squash'' the $N$ real-valued utility functions\nin~\\eqref{eq:logit} to the $N$-dimensional simplex \n$[0,1]^N = \\left\\{ \\beta_i \\in {\\cal R}^N : 0 \\leq \\beta_{ij} \\leq 1 \\forall j \\in  \\left\\{ 1, \\dots, N \\right\\}, \\sum_{j=1}^N \\beta_{j} = 1 \\right\\}$.\nWhen the $J_{ij}(\\cdot)$ are all linear or affine in their $x_j$, this becomes the multinomial logistic\nregression generalized linear model~\\citep{GLM}.\n\nIf instead~\\eqref{eq:logit} is modified to read\n\n", "index": 7, "text": "\\begin{equation}\n\t\\beta_{ij} = \\frac{\\exp (J_{ij}^c (x_j))}{\\sum_{j'=1}^N \\exp (J_{ij'}^c (x_j'))}, \\label{eq:indepLanes}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"\\beta_{ij}=\\frac{\\exp(J_{ij}^{c}(x_{j}))}{\\sum_{j^{\\prime}=1}^{N}\\exp(J_{ij^{%&#10;\\prime}}^{c}(x_{j}^{\\prime}))},\" display=\"block\"><mrow><mrow><msub><mi>\u03b2</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msubsup><mi>J</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow><mi>c</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><msup><mi>j</mi><mo>\u2032</mo></msup><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msubsup><mi>J</mi><mrow><mi>i</mi><mo>\u2062</mo><msup><mi>j</mi><mo>\u2032</mo></msup></mrow><mi>c</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msubsup><mi>x</mi><mi>j</mi><mo>\u2032</mo></msubsup><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mfrac></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nsubject to:\n\\begin{eqnarray}\n& & f_{i1}^c \\geq 0, \\;\\; i=1,\\dots,M, \\; c=1,\\dots,C \\;\\;\n\\mbox{ --- non-negativity constraint};\n\\label{miso_nonnegativity_constraint} \\\\\n& & f_{i1}^c \\leq S_i^c, \\;\\; i=1,\\dots,M, \\; c=1,\\dots,C \\;\\;\n\\mbox{ --- demand constraint};\n\\label{miso_demand_constrint} \\\\\n& & \\sum_{i=1}^M f_{i1} \\leq R_1 \\;\\;\n\\mbox{ --- supply constraint};\n\\label{miso_supply_constraint} \\\\\n& & \\frac{f_{i1}^c}{f_{i1}} =\n\\frac{S_{i}^c}{S_{i}}, \\;\\;\ni = 1,\\dots,M,\\; c=1,\\dots,C,\n\\;\\; \\mbox{ --- proportionality constraint for commodity flows};\n\\label{miso_proportionality_constraint}\\\\\n& & \\left.\\begin{array}{cl}\n\\mbox{(a)} &\np_{i''} f_{i'1} = p_{i'} f_{i''1} \\;\\;\n\\forall i',i'', \\mbox{ such that }\nf_{i'1}<S_{i'}, \\;\nf_{i''1}<S_{i''}, \\\\\n\\mbox{(b)} & \n\\mbox{If } f_{i1} < S_i, \\mbox{ then }\nf_{i1} \\geq \\frac{p_i}{\\sum_{i'=1}^M p_{i'}} R_1. \n\\end{array}\\right\\} \\;\\; \\mbox{ --- priority constraint}.\n\\label{miso_priority_constraint}\n\\end{eqnarray}\nConstraint~\\eqref{miso_proportionality_constraint} defines how \npotential restrictions imposed on full input-output flows are\ntranslated to individual commodities.\nIn this paper we assume that any restriction on the\n$i$-to-$1$ flow applies to commodity flows proportionally to\ntheir contribution to the demand.\nCertainly, other schemes of distributing the input-output flow\nrestrictions between commodity flows may exist:\ne.g., selected commodities may have a preferential status\nthat always allows them to travel first.\nThose alternative schemes, however, are beyond the scope of this paper.\n\nLet us discuss priority constraint~\\eqref{miso_priority_constraint}\nin more detail.\nIt should be interpreted as follows.\nInput links $i=1,\\dots,M$, fall into two categories:\n(1) those whose flow is restricted by the allocated supply of\nthe output link; and\n(2) those whose demand is satisfied by the supply allocated for them\nin the output link.\nPriorities define how supply in the output link is allocated for input flows.\nCondition~\\eqref{miso_priority_constraint}(a)\nsays that flows from input links of category 1 are allocated\nproportionally to their priorities.\nCondition~\\eqref{miso_priority_constraint}(b)\nensures that input\nflows of category 2 do not take up more output supply than was\nallocated for them in cases where category 1 is non-empty.\nThe inequality\nin condition~\\eqref{miso_priority_constraint}(b) becomes an\nequality when category 2 is empty.\n\nThere is a special case, when some input link priorities are\nequal to $0$.\nIf there exists input link $\\hat{\\imath}$, such that\n$p_{\\hat{\\imath}}=0$, while $f_{\\hat{\\imath}1}>0$, then,\ndue to condition~\\eqref{miso_priority_constraint}(a),\nall input links with non-zero priorities are in category 2.\nThus, if category 1 contains only input links with zero priorities,\none should evaluate condition~\\eqref{miso_priority_constraint}(a)\nwith arbitrary positive, but \\emph{equal}, priorities: $p_{i'}=p_{i''}>0$.\n\nIf the priorities $p_i$ are proportional to send functions\n$S_i$, $i=1,\\dots,M$,\\footnote{Here we assume that\n$S_i >0$, $i=1,\\dots,M$.} \nthen condition~\\eqref{miso_priority_constraint} can be written as an equality\nconstraint:\n\n", "itemtype": "equation", "pos": 30599, "prevtext": "\nthe only argument to the functions $J_{ij}^c(\\cdot)$ is the route-specific data\n$x_j$. This approach relies on an assumption that the utility of each lane is independent of\nall other lane states $x_j$,\ne.g., if the functions $J_{ij}^c(\\cdot)$ in~\\eqref{eq:logit} are linear in $x$, then~\\eqref{eq:indepLanes} assumes\nthat the coefficients of all $J_{ij}^c(\\cdot)$ for all elements of $x$ not in $x_j$ are zero. \nRoute choice models in the transportation literature often use this formulation (a useful overview can be found in \\citet{bliemer_impact_2008}). Although the route\nchoice literature often refers to~\\eqref{eq:indepLanes} as the ``multinomial logit model,''~\\eqref{eq:indepLanes}\nis more properly known as the ``conditional logit model''~\\citep{mcfadden_conditional_1973}, with ``multinomial logit\nmodel'' reserved for the general case~\\eqref{eq:logit}.\n\nThe logit route choice model is a statistical model: The $C \\cdot N$ sets of parameters, one for each $J_{ij}^c(\\cdot)$, are meant to be learned from data.\nThese data take the form of input-output pairs $( \\beta_{ij}^c, x_j)$, i.e. observed link states $x_j$ paired with their caused split ratios $\\beta_{ij}^c$. In the use of a statistical model, the usual caveats must be kept in mind. \nIn addition, it is desired that the data collected span much of the space of possible states $x_j$, or at least those subspaces the modeler would wish to query during simulation. Training a logit model with data from subspace of $x_j$, then querying in another subspace of $x_j$, is a statistical extrapolation, which is of course risky and unpredictable.\n\nThe continued development and use of the logit model is a testament to its predictive power when sufficient data is available. If studying a single intersection, collecting, analyzing, and storing enough data may be challenging but feasible. For a large or high-dimensional network, the task may be more onerous or unrealistically expensive. In a planning, prediction, or ICM scenario, it may in fact be impossible: one could not collect data from certain network states if the states or infrastructure under consideration are in fact the counterfactual.\n\nIn addition, the fact that the logit model describes route choice in terms of utility means that its parameters have no physical meaning, precluding making any sort of ``sanity check.'' This means that hand-tuning the parameters of $J_{ij}^c(\\cdot)$ to produce realistic results in the absence of sufficient data is not easy. In a related problem, the abstraction of route utility can lead to a ``black-boxing'' of the workings of the model. Observed irregularities in simulation behavior can be difficult to track down to the erroneous model parameters or components. These problems, of course, are only exacerbated when the network becomes high-dimensional, with many parameters.\n\nOne useful approach to apply the logit model in high-dimensional settings may be estimation of the utility functions $J_{ij}^c$ on a data-rich link or junction, then transplanting these parameters to a similar, but poorly-instrumented, link. The hypothesis would be that their utility functions are similar.\nUnfortunately, we have some evidence for the instability of the logit model in these extrapolation scenarios from a study in a context of varying sets of available routes by~\\citet{bliemer_impact_2008}.\nThey found that many basic and extended logit models are fragile in these situations.\nIf one considers a junction with relevant and irrelevant routes (irrelevant, in this context, means that their utility values $J_{ij}^c$ are small relative to the relevant routes), it turns out that calibrating the model with data collected while the irrelevant routes exist, then querying it without the irrelevant routes (or vice versa) will produce incorrect values of $\\beta_{ij}^c$. This means that the utility functions $J_{ij}^c$ may in fact not be independent of other output link states.\n\nThe example used by~\\citet{bliemer_impact_2008} did not feature the a transplanting of model parameters.\nRather, the calibration and querying steps were on the same network; the irrelevant routes were highly circuitous.\nStill, it is evidence that logit parameters are not, in general, reusable across junctions that have different routes to choose from\\footnote{\\citet{bliemer_impact_2008} did find that one extended logit model performed adequately in recreating the proper $\\beta$. However, this model also encodes the length of road overlap between routes. We would not expect that parameters learned from one junction, then transplanted to another junction with different route overlap structures, would provide good prediction accuracy.}.\n\nWhat is to be done, then?\nIn Section \\ref{sec_sr_assignment} we present an alternative route choice algorithm for high-dimensional or data-deficient networks.\nOur algorithm is myopic to the node and agnostic to the link state: it only attempts to balance demand-supply ratios $R/S$ across nodes. Our algorithm is inspired by classic integral control, which has historically been applied to ``black-box'' problems with success.\n\n\\section{A node model for dimensionality management}\\label{sec_node_model}\nOur notation for the node model problem has been introduced above.\nWe summarize it here:\n\\begin{itemize}\n\\item $M$ --- number of input links;\n\\item $i$ --- index of an input link ($i=1,\\dots,M$);\n\\item $N$ --- number of output links;\n\\item $j$ --- index of an output link ($j=1,\\dots,N$);\n\\item $C$ --- number of commodities;\n\\item $c$ --- index of a commodity ($c=1,\\dots,C$);\n\\item $S_i^c$ --- how much traffic of commodity $c$ input $i$ wants to send\n(demand or sending function), $S_i=\\sum_{c=1}^C S_i^c$;\n\\item $p_i$ --- input link priority;\n\\item $R_j$ --- how much traffic output $j$ can receive\n(supply or receive function);\n\\item $\\beta_{ij}^c\\in[0, 1]$ --- split ratios that distribute traffic\nof a given commodity $c$ coming from input link $i$ between\noutput links, $\\sum_{j=1}^N\\beta_{ij}^c=1$;\n\\item $S_{ij}^c = \\beta_{ij}^c S_i^c$ --- oriented demand for commodity\n$c$ from input link $i$ to output link $j$,\n$S_{ij}=\\sum_{c=1}^C S_{ij}^c$;\n\\item $f_{ij}^c$ --- input-output flows that the node model computes,\n$f_{ij}=\\sum_{c=1}^C f_{ij}^c$.\n\\end{itemize}\n\n\nThis Section is organized as follows.\nWe start by describing the merge problem --- the multi-input-single-output\n(MISO) node in Section~\\ref{subsec_miso} to explain the concept of input \nlink priorities.\nThen, we propose a way of relaxing the FIFO\ncondition and explain it in the case of a single-input-multi-output (SIMO) node\nin Section~\\ref{subsec_simo}.\nFinally, in Section~\\ref{subsec_mimo_relaxed} we proceed to the\ngeneral multi-input-multi-output (MIMO) node putting all the concepts\ntogether.\n\n\n\n\n\n\n\n\n\n\n\\subsection{Multiple-Input-Single-Output (MISO) Node: Explaining Input Priorities}\\label{subsec_miso}\nTo better explain the meaning of input link priorities,\nwe start by considering a node with $M$ input links and 1 output link.\nThe number of vehicles of type $c$ that input link $i$ wants to send is $S_i^c$.\nThe flow entering from input link $i$ has priority $p_i\\geq 0$.\nHere $i=1,\\dots,M$ and $c=1,\\dots,C$.\nThe output link can receive $R_1$ vehicles.\n\nCasting the computation of input-output flows $f_{i1}^c$ as a mathematical\nprogramming problem, we arrive at:\n\n", "index": 9, "text": "\\begin{equation}\n\\max\\left(\\sum_{i=1}^M\\sum_{c=1}^C f_{i1}^c\\right), \\label{miso_objective}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"\\max\\left(\\sum_{i=1}^{M}\\sum_{c=1}^{C}f_{i1}^{c}\\right),\" display=\"block\"><mrow><mrow><mi>max</mi><mo>\u2061</mo><mrow><mo>(</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></munderover><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><msubsup><mi>f</mi><mrow><mi>i</mi><mo>\u2062</mo><mn>1</mn></mrow><mi>c</mi></msubsup></mrow></mrow><mo>)</mo></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nand the optimization\nproblem~\\eqref{miso_objective}-\\eqref{miso_priority_constraint}\nturns into a \\emph{linear program} (LP).\n\n{\\bf Remark.}\nNote that constraint~\\eqref{miso_demand_proportional} cannot be trivially extended\nto the MIMO node by replacing subindex $1$,\nwhere it denotes the output, with subindex $j$.\nDoing that, as is evident from~\\cite{bliemer07}, indeed leads to a convenient\noptimization problem formulation,\nbut sacrifices the flow maximization objective of the\nnode model, as was pointed out in~\\citet{tampere11},\nreducing the feasibility set more than necessary.\n\nFor arbitrary priorities \nwith $M=2$, condition~\\eqref{miso_priority_constraint} becomes:\n\\begin{eqnarray}\n& & f_{11} \\leq\n\\max\\left\\{\\frac{p_1}{p_1+p_2}R_1,\\; R_1- S_2\\right\\};\n\\label{miso_2in_priority_constraint_1} \\\\\n& & f_{21} \\leq\n\\max\\left\\{\\frac{p_2}{p_1+p_2}R_1,\\; R_1- S_1\\right\\}.\n\\label{miso_2in_priority_constraint_2}\n\\end{eqnarray}\nTo give a hint how more complicated\nconstraint~\\eqref{miso_priority_constraint} becomes\nas $M$ increases,\nlet us write it out for $M=3$:\n\n", "itemtype": "equation", "pos": 33859, "prevtext": "\nsubject to:\n\\begin{eqnarray}\n& & f_{i1}^c \\geq 0, \\;\\; i=1,\\dots,M, \\; c=1,\\dots,C \\;\\;\n\\mbox{ --- non-negativity constraint};\n\\label{miso_nonnegativity_constraint} \\\\\n& & f_{i1}^c \\leq S_i^c, \\;\\; i=1,\\dots,M, \\; c=1,\\dots,C \\;\\;\n\\mbox{ --- demand constraint};\n\\label{miso_demand_constrint} \\\\\n& & \\sum_{i=1}^M f_{i1} \\leq R_1 \\;\\;\n\\mbox{ --- supply constraint};\n\\label{miso_supply_constraint} \\\\\n& & \\frac{f_{i1}^c}{f_{i1}} =\n\\frac{S_{i}^c}{S_{i}}, \\;\\;\ni = 1,\\dots,M,\\; c=1,\\dots,C,\n\\;\\; \\mbox{ --- proportionality constraint for commodity flows};\n\\label{miso_proportionality_constraint}\\\\\n& & \\left.\\begin{array}{cl}\n\\mbox{(a)} &\np_{i''} f_{i'1} = p_{i'} f_{i''1} \\;\\;\n\\forall i',i'', \\mbox{ such that }\nf_{i'1}<S_{i'}, \\;\nf_{i''1}<S_{i''}, \\\\\n\\mbox{(b)} & \n\\mbox{If } f_{i1} < S_i, \\mbox{ then }\nf_{i1} \\geq \\frac{p_i}{\\sum_{i'=1}^M p_{i'}} R_1. \n\\end{array}\\right\\} \\;\\; \\mbox{ --- priority constraint}.\n\\label{miso_priority_constraint}\n\\end{eqnarray}\nConstraint~\\eqref{miso_proportionality_constraint} defines how \npotential restrictions imposed on full input-output flows are\ntranslated to individual commodities.\nIn this paper we assume that any restriction on the\n$i$-to-$1$ flow applies to commodity flows proportionally to\ntheir contribution to the demand.\nCertainly, other schemes of distributing the input-output flow\nrestrictions between commodity flows may exist:\ne.g., selected commodities may have a preferential status\nthat always allows them to travel first.\nThose alternative schemes, however, are beyond the scope of this paper.\n\nLet us discuss priority constraint~\\eqref{miso_priority_constraint}\nin more detail.\nIt should be interpreted as follows.\nInput links $i=1,\\dots,M$, fall into two categories:\n(1) those whose flow is restricted by the allocated supply of\nthe output link; and\n(2) those whose demand is satisfied by the supply allocated for them\nin the output link.\nPriorities define how supply in the output link is allocated for input flows.\nCondition~\\eqref{miso_priority_constraint}(a)\nsays that flows from input links of category 1 are allocated\nproportionally to their priorities.\nCondition~\\eqref{miso_priority_constraint}(b)\nensures that input\nflows of category 2 do not take up more output supply than was\nallocated for them in cases where category 1 is non-empty.\nThe inequality\nin condition~\\eqref{miso_priority_constraint}(b) becomes an\nequality when category 2 is empty.\n\nThere is a special case, when some input link priorities are\nequal to $0$.\nIf there exists input link $\\hat{\\imath}$, such that\n$p_{\\hat{\\imath}}=0$, while $f_{\\hat{\\imath}1}>0$, then,\ndue to condition~\\eqref{miso_priority_constraint}(a),\nall input links with non-zero priorities are in category 2.\nThus, if category 1 contains only input links with zero priorities,\none should evaluate condition~\\eqref{miso_priority_constraint}(a)\nwith arbitrary positive, but \\emph{equal}, priorities: $p_{i'}=p_{i''}>0$.\n\nIf the priorities $p_i$ are proportional to send functions\n$S_i$, $i=1,\\dots,M$,\\footnote{Here we assume that\n$S_i >0$, $i=1,\\dots,M$.} \nthen condition~\\eqref{miso_priority_constraint} can be written as an equality\nconstraint:\n\n", "index": 11, "text": "\\begin{equation}\n\\frac{f_{11}}{S_1} = \\dots =\n\\frac{f_{i1}}{S_i} = \\dots =\n\\frac{f_{M1}}{S_M},\n\\label{miso_demand_proportional}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"\\frac{f_{11}}{S_{1}}=\\dots=\\frac{f_{i1}}{S_{i}}=\\dots=\\frac{f_{M1}}{S_{M}},\" display=\"block\"><mrow><mrow><mfrac><msub><mi>f</mi><mn>11</mn></msub><msub><mi>S</mi><mn>1</mn></msub></mfrac><mo>=</mo><mi mathvariant=\"normal\">\u2026</mi><mo>=</mo><mfrac><msub><mi>f</mi><mrow><mi>i</mi><mo>\u2062</mo><mn>1</mn></mrow></msub><msub><mi>S</mi><mi>i</mi></msub></mfrac><mo>=</mo><mi mathvariant=\"normal\">\u2026</mi><mo>=</mo><mfrac><msub><mi>f</mi><mrow><mi>M</mi><mo>\u2062</mo><mn>1</mn></mrow></msub><msub><mi>S</mi><mi>M</mi></msub></mfrac></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\n\n", "itemtype": "equation", "pos": 35070, "prevtext": "\nand the optimization\nproblem~\\eqref{miso_objective}-\\eqref{miso_priority_constraint}\nturns into a \\emph{linear program} (LP).\n\n{\\bf Remark.}\nNote that constraint~\\eqref{miso_demand_proportional} cannot be trivially extended\nto the MIMO node by replacing subindex $1$,\nwhere it denotes the output, with subindex $j$.\nDoing that, as is evident from~\\cite{bliemer07}, indeed leads to a convenient\noptimization problem formulation,\nbut sacrifices the flow maximization objective of the\nnode model, as was pointed out in~\\citet{tampere11},\nreducing the feasibility set more than necessary.\n\nFor arbitrary priorities \nwith $M=2$, condition~\\eqref{miso_priority_constraint} becomes:\n\\begin{eqnarray}\n& & f_{11} \\leq\n\\max\\left\\{\\frac{p_1}{p_1+p_2}R_1,\\; R_1- S_2\\right\\};\n\\label{miso_2in_priority_constraint_1} \\\\\n& & f_{21} \\leq\n\\max\\left\\{\\frac{p_2}{p_1+p_2}R_1,\\; R_1- S_1\\right\\}.\n\\label{miso_2in_priority_constraint_2}\n\\end{eqnarray}\nTo give a hint how more complicated\nconstraint~\\eqref{miso_priority_constraint} becomes\nas $M$ increases,\nlet us write it out for $M=3$:\n\n", "index": 13, "text": "\\begin{equation}\nf_{11} \\leq\n\\max\\left\\{\n\\frac{p_1}{\\sum_{i=1}^3 p_i}R_1,\n\\frac{p_1}{p_1+p_2}\\left(R_1-S_3\\right), \n\\frac{p_1}{p_1+p_3}\\left(R_1-S_2\\right), \nR_1-\\sum_{i=2,3} S_i\n\\right\\}; \\label{miso_3in_priority_constraint_1} \\\\\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"f_{11}\\leq\\max\\left\\{\\frac{p_{1}}{\\sum_{i=1}^{3}p_{i}}R_{1},\\frac{p_{1}}{p_{1}%&#10;+p_{2}}\\left(R_{1}-S_{3}\\right),\\frac{p_{1}}{p_{1}+p_{3}}\\left(R_{1}-S_{2}%&#10;\\right),R_{1}-\\sum_{i=2,3}S_{i}\\right\\};\\\\&#10;\" display=\"block\"><mrow><mrow><msub><mi>f</mi><mn>11</mn></msub><mo>\u2264</mo><mrow><mi>max</mi><mo>\u2061</mo><mrow><mo>{</mo><mrow><mfrac><msub><mi>p</mi><mn>1</mn></msub><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>3</mn></msubsup><msub><mi>p</mi><mi>i</mi></msub></mrow></mfrac><mo>\u2062</mo><msub><mi>R</mi><mn>1</mn></msub></mrow><mo>,</mo><mrow><mfrac><msub><mi>p</mi><mn>1</mn></msub><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>+</mo><msub><mi>p</mi><mn>2</mn></msub></mrow></mfrac><mo>\u2062</mo><mrow><mo>(</mo><mrow><msub><mi>R</mi><mn>1</mn></msub><mo>-</mo><msub><mi>S</mi><mn>3</mn></msub></mrow><mo>)</mo></mrow></mrow><mo>,</mo><mrow><mfrac><msub><mi>p</mi><mn>1</mn></msub><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>+</mo><msub><mi>p</mi><mn>3</mn></msub></mrow></mfrac><mo>\u2062</mo><mrow><mo>(</mo><mrow><msub><mi>R</mi><mn>1</mn></msub><mo>-</mo><msub><mi>S</mi><mn>2</mn></msub></mrow><mo>)</mo></mrow></mrow><mo>,</mo><mrow><msub><mi>R</mi><mn>1</mn></msub><mo>-</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mrow><mn>2</mn><mo>,</mo><mn>3</mn></mrow></mrow></munder><msub><mi>S</mi><mi>i</mi></msub></mrow></mrow><mo>}</mo></mrow></mrow></mrow><mo>;</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\n\n", "itemtype": "equation", "pos": 35316, "prevtext": "\n\n", "index": 15, "text": "\\begin{equation}\nf_{21} \\leq\n\\max\\left\\{\n\\frac{p_2}{\\sum_{i=1}^3 p_i}R_1,\n\\frac{p_2}{p_1+p_2}\\left(R_1- S_3\\right), \n\\frac{p_2}{p_2+p_3}\\left(R_1- S_1\\right), \nR_1-\\sum_{i=1,3} S_i\n\\right\\}; \\label{miso_3in_priority_constraint_2}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"f_{21}\\leq\\max\\left\\{\\frac{p_{2}}{\\sum_{i=1}^{3}p_{i}}R_{1},\\frac{p_{2}}{p_{1}%&#10;+p_{2}}\\left(R_{1}-S_{3}\\right),\\frac{p_{2}}{p_{2}+p_{3}}\\left(R_{1}-S_{1}%&#10;\\right),R_{1}-\\sum_{i=1,3}S_{i}\\right\\};\" display=\"block\"><mrow><mrow><msub><mi>f</mi><mn>21</mn></msub><mo>\u2264</mo><mrow><mi>max</mi><mo>\u2061</mo><mrow><mo>{</mo><mrow><mfrac><msub><mi>p</mi><mn>2</mn></msub><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>3</mn></msubsup><msub><mi>p</mi><mi>i</mi></msub></mrow></mfrac><mo>\u2062</mo><msub><mi>R</mi><mn>1</mn></msub></mrow><mo>,</mo><mrow><mfrac><msub><mi>p</mi><mn>2</mn></msub><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>+</mo><msub><mi>p</mi><mn>2</mn></msub></mrow></mfrac><mo>\u2062</mo><mrow><mo>(</mo><mrow><msub><mi>R</mi><mn>1</mn></msub><mo>-</mo><msub><mi>S</mi><mn>3</mn></msub></mrow><mo>)</mo></mrow></mrow><mo>,</mo><mrow><mfrac><msub><mi>p</mi><mn>2</mn></msub><mrow><msub><mi>p</mi><mn>2</mn></msub><mo>+</mo><msub><mi>p</mi><mn>3</mn></msub></mrow></mfrac><mo>\u2062</mo><mrow><mo>(</mo><mrow><msub><mi>R</mi><mn>1</mn></msub><mo>-</mo><msub><mi>S</mi><mn>1</mn></msub></mrow><mo>)</mo></mrow></mrow><mo>,</mo><mrow><msub><mi>R</mi><mn>1</mn></msub><mo>-</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mrow><mn>1</mn><mo>,</mo><mn>3</mn></mrow></mrow></munder><msub><mi>S</mi><mi>i</mi></msub></mrow></mrow><mo>}</mo></mrow></mrow></mrow><mo>;</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nAs we can see, right hand sides of \ninequalities~\\eqref{miso_3in_priority_constraint_1}-\\eqref{miso_3in_priority_constraint_3}\ncontain known quantities, and so for arbitrary priorities,\nproblem~\\eqref{miso_objective}-\\eqref{miso_priority_constraint} is also an LP.\nFor general $M$, however, building constraint~\\eqref{miso_priority_constraint}\nrequires a somewhat involved algorithm.\nInstead, we present the algorithm for computing input-output flows\n$f_{i1}^c$ that solves the maximization\nproblem~\\eqref{miso_objective}-\\eqref{miso_priority_constraint}.\n\\begin{enumerate}\n\\item Initialize:\n\\begin{eqnarray*}\n{\\tilde{R}}_1(0) & := & R_1; \\\\\nU(0) & := & \\left\\{1,\\dots,M\\right\\}; \\\\\nk & := & 0.\n\\end{eqnarray*}\n$U(k)$ is the set of unprocessed input links:\ninput links whose input-output flows have not been assigned yet.\n\n\\item Check that at least one of the unprocessed input links has\nnonzero priority, otherwise, assign equal positive priorities\nto all the unprocessed input links:\n", "itemtype": "equation", "pos": 35561, "prevtext": "\n\n", "index": 17, "text": "\\begin{equation}\nf_{31} \\leq\n\\max\\left\\{\n\\frac{p_3}{\\sum_{i=1}^3 p_i}R_1,\n\\frac{p_3}{p_1+p_3}\\left(R_1- S_2\\right), \n\\frac{p_3}{p_2+p_3}\\left(R_1- S_1\\right), \nR_1-\\sum_{i=1,2} S_i\n\\right\\}.\\label{miso_3in_priority_constraint_3}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m1\" class=\"ltx_Math\" alttext=\"f_{31}\\leq\\max\\left\\{\\frac{p_{3}}{\\sum_{i=1}^{3}p_{i}}R_{1},\\frac{p_{3}}{p_{1}%&#10;+p_{3}}\\left(R_{1}-S_{2}\\right),\\frac{p_{3}}{p_{2}+p_{3}}\\left(R_{1}-S_{1}%&#10;\\right),R_{1}-\\sum_{i=1,2}S_{i}\\right\\}.\" display=\"block\"><mrow><mrow><msub><mi>f</mi><mn>31</mn></msub><mo>\u2264</mo><mrow><mi>max</mi><mo>\u2061</mo><mrow><mo>{</mo><mrow><mfrac><msub><mi>p</mi><mn>3</mn></msub><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>3</mn></msubsup><msub><mi>p</mi><mi>i</mi></msub></mrow></mfrac><mo>\u2062</mo><msub><mi>R</mi><mn>1</mn></msub></mrow><mo>,</mo><mrow><mfrac><msub><mi>p</mi><mn>3</mn></msub><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>+</mo><msub><mi>p</mi><mn>3</mn></msub></mrow></mfrac><mo>\u2062</mo><mrow><mo>(</mo><mrow><msub><mi>R</mi><mn>1</mn></msub><mo>-</mo><msub><mi>S</mi><mn>2</mn></msub></mrow><mo>)</mo></mrow></mrow><mo>,</mo><mrow><mfrac><msub><mi>p</mi><mn>3</mn></msub><mrow><msub><mi>p</mi><mn>2</mn></msub><mo>+</mo><msub><mi>p</mi><mn>3</mn></msub></mrow></mfrac><mo>\u2062</mo><mrow><mo>(</mo><mrow><msub><mi>R</mi><mn>1</mn></msub><mo>-</mo><msub><mi>S</mi><mn>1</mn></msub></mrow><mo>)</mo></mrow></mrow><mo>,</mo><mrow><msub><mi>R</mi><mn>1</mn></msub><mo>-</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mrow><mn>1</mn><mo>,</mo><mn>2</mn></mrow></mrow></munder><msub><mi>S</mi><mi>i</mi></msub></mrow></mrow><mo>}</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nwhere $|U(k)|$ denotes the number of elements in set $U(k)$.\n\n\\item Define the set of input links\nthat want to send fewer vehicles than their allocated supply\nand whose flows are still undetermined:\n", "itemtype": "equation", "pos": 36790, "prevtext": "\nAs we can see, right hand sides of \ninequalities~\\eqref{miso_3in_priority_constraint_1}-\\eqref{miso_3in_priority_constraint_3}\ncontain known quantities, and so for arbitrary priorities,\nproblem~\\eqref{miso_objective}-\\eqref{miso_priority_constraint} is also an LP.\nFor general $M$, however, building constraint~\\eqref{miso_priority_constraint}\nrequires a somewhat involved algorithm.\nInstead, we present the algorithm for computing input-output flows\n$f_{i1}^c$ that solves the maximization\nproblem~\\eqref{miso_objective}-\\eqref{miso_priority_constraint}.\n\\begin{enumerate}\n\\item Initialize:\n\\begin{eqnarray*}\n{\\tilde{R}}_1(0) & := & R_1; \\\\\nU(0) & := & \\left\\{1,\\dots,M\\right\\}; \\\\\nk & := & 0.\n\\end{eqnarray*}\n$U(k)$ is the set of unprocessed input links:\ninput links whose input-output flows have not been assigned yet.\n\n\\item Check that at least one of the unprocessed input links has\nnonzero priority, otherwise, assign equal positive priorities\nto all the unprocessed input links:\n", "index": 19, "text": "\n\\[\n{\\tilde{p}}_i(k) = \\left\\{\\begin{array}{ll}\np_i, &\n\\mbox{ if there exists } i'\\in U(k):\\; p_{i'} > 0,\\\\\n\\frac{1}{|U(k)|}, &\n\\mbox{ otherwise},\n\\end{array}\\right.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"{\\tilde{p}}_{i}(k)=\\left\\{\\begin{array}[]{ll}p_{i},&amp;\\mbox{ if there exists }i^%&#10;{\\prime}\\in U(k):\\;p_{i^{\\prime}}&gt;0,\\\\&#10;\\frac{1}{|U(k)|},&amp;\\mbox{ otherwise},\\end{array}\\right.\" display=\"block\"><mrow><mrow><msub><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">~</mo></mover><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo>{</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><msub><mi>p</mi><mi>i</mi></msub><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mrow><mrow><mtext>\u00a0if there exists\u00a0</mtext><mo>\u2062</mo><msup><mi>i</mi><mo>\u2032</mo></msup></mrow><mo>\u2208</mo><mrow><mi>U</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo rspace=\"5.3pt\">:</mo><mrow><msub><mi>p</mi><msup><mi>i</mi><mo>\u2032</mo></msup></msub><mo>&gt;</mo><mn>0</mn></mrow></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mrow><mfrac><mn>1</mn><mrow><mo stretchy=\"false\">|</mo><mrow><mi>U</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">|</mo></mrow></mfrac><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mtext>\u00a0otherwise</mtext><mo>,</mo></mrow></mtd></mtr></mtable><mi/></mrow></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\n\\begin{itemize}\n\\item If ${\\tilde{U}}(k) \\neq\\emptyset$, assign:\n\\begin{eqnarray*}\nf_{i1}^c & = & S_i^c, \\;\\;\\; i\\in{\\tilde{U}}(k); \\\\\n{\\tilde{R}}_1(k+1) & = & {\\tilde{R}}_1(k) - \\sum_{i\\in{\\tilde{U}}}\\sum_{c=1}^C f_{i1}^c; \\\\\nU(k+1) & = & U(k) \\setminus {\\tilde{U}}(k).\n\\end{eqnarray*}\n\\item Else, assign:\n\\begin{eqnarray*}\nf_{i1}^c & = & S_i^c \\frac{{\\tilde{p}}_i(k)}{\\sum_{i'\\in U(k)}{\\tilde{p}}_{i'}(k)}\n\\frac{{\\tilde{R}}_1(k)}{S_i},\n\\;\\;\\; i\\in U(k); \\\\\nU(k+1) & = & \\emptyset .\n\\end{eqnarray*}\n\\end{itemize}\n\n\\item If $U(k+1)=\\emptyset$, then stop.\n\n\\item Set $k:=k+1$, and return to step 2.\n\\end{enumerate}\n\nThis algorithm finishes after no more than $M$ iterations, and\nin the special case of $M=2$ it reduces to\n\\begin{eqnarray}\nf_{11}^c & = & \\min\\left\\{S_1^c, \\;\\; S_1^c\\frac{\\max\\left\\{\n\\frac{p_1}{p_1+p_2}R_1, \\;\\; R_1-S_2\\right\\}}{S_1}\\right\\};\n\\label{eq_merge_21_1}\\\\\nf_{21}^c & = & \\min\\left\\{S_2^c, \\;\\; S_2^c\\frac{\\max\\left\\{\n\\frac{p_2}{p_1+p_2}R_1, \\;\\; R_1-S_1\\right\\}}{S_2}\\right\\}.\n\\label{eq_merge_21_2}\n\\end{eqnarray}\n\nThe following theorem can be trivially proved,\nand we leave the proof to the reader.\nFurther, in Section~\\ref{subsec_mimo_relaxed}, it will become clear\nthat this theorem is a special case of a more general statement.\n\\begin{theo}\nThe input-output flow computation algorithm constructs the\nunique solution of the maximization\nproblem~\\eqref{miso_objective}-\\eqref{miso_priority_constraint}.\n\\label{theo_miso_optimal}\n\\end{theo}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\subsection{Single-Input-Multiple-Output (SIMO) Node: Relaxing FIFO Condition}\n\\label{subsec_simo}\nRecall our discussion of Figures~\\ref{fig-simo} and~\\ref{fig:networks}, and\nthe unrealistic spillback problems created by the FIFO condition.\nA more realistic model would allow to specify how output\nflows at any given junction can affect each other.\nIn the context of our example, we could say that \ncongestion in off-ramp~1 affects mainline flow in lane~1,\ncongestion in off-ramp~3 affects mainline flow in lanes~4 and~5\n(see striped areas in Figure~\\ref{fig-simo}), while\ntraffic flow in lanes~2 and~3 of the mainline output link is\nnot affected by the traffic state in output links~1 and~3.\nAdditionally, we can say that congestion in the mainline output~2\naffects flows directed to both off-ramps in full, \nwhile the traffic state in each of the off-ramps does not influence\nthe flow directed to the other off-ramp.\n\nTo formally describe the mutual influence of output links,\nwe introduce \\emph{mutual restriction intervals}\n${\\bm{\\eta}}_{j'j}= [y,z]\\subseteq[0,1]$.\nThese parameters can be interpreted as follows:\n\\begin{itemize}\n\\item ${\\bm{\\eta}}_{j'j}=[0,1]$ --- congestion in the output link $j'$\naffects flow directed to the output link $j$ in full.\nThis is equivalent to the FIFO condition.\nObviously, ${\\bm{\\eta}}_{jj}\\equiv[0,1]$.\n\\item ${\\bm{\\eta}}_{j'j}=[0,0]$ (or any other interval of zero length) --- traffic\nstate in the output link $j'$\ndoes not influence the flow directed to the output link $j$.\nThis is equivalent to no FIFO restriction.\n\\item ${\\bm{\\eta}}_{j'j}=[y,z]\\subset [0,1]$ --- traffic state in the output link\n$j'$ affects a $|{\\bm{\\eta}}_{j'j}|=z-y$ portion of the flow directed to the output\nlink $j$.\nMoreover, we specify this influence as an interval, not just a scalar,\nto capture the summary effect of multiple output links that may restrict\nflow to the output link $j$ --- how, will be explained shortly.\n\\end{itemize}\n\nFor our example in Figure~\\ref{fig-simo}, the mutual restriction intervals\ntake the form of a $3\\times 3$ interval matrix:\n", "itemtype": "equation", "pos": 37157, "prevtext": "\nwhere $|U(k)|$ denotes the number of elements in set $U(k)$.\n\n\\item Define the set of input links\nthat want to send fewer vehicles than their allocated supply\nand whose flows are still undetermined:\n", "index": 21, "text": "\n\\[\n{\\tilde{U}}(k) = \\left\\{i\\in U(k):\\; \\sum_{c=1}^C S_i^c\\leq{\\tilde{p}}_i(k)\n\\frac{{\\tilde{R}}_1(k)}{\\sum_{i'\\in U(k)}{\\tilde{p}}_{i'}(k)} \\right\\}.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"{\\tilde{U}}(k)=\\left\\{i\\in U(k):\\;\\sum_{c=1}^{C}S_{i}^{c}\\leq{\\tilde{p}}_{i}(k%&#10;)\\frac{{\\tilde{R}}_{1}(k)}{\\sum_{i^{\\prime}\\in U(k)}{\\tilde{p}}_{i^{\\prime}}(k%&#10;)}\\right\\}.\" display=\"block\"><mrow><mrow><mrow><mover accent=\"true\"><mi>U</mi><mo stretchy=\"false\">~</mo></mover><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo>{</mo><mrow><mi>i</mi><mo>\u2208</mo><mrow><mi>U</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo rspace=\"5.3pt\">:</mo><mrow><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><msubsup><mi>S</mi><mi>i</mi><mi>c</mi></msubsup></mrow><mo>\u2264</mo><mrow><msub><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">~</mo></mover><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mfrac><mrow><msub><mover accent=\"true\"><mi>R</mi><mo stretchy=\"false\">~</mo></mover><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><msup><mi>i</mi><mo>\u2032</mo></msup><mo>\u2208</mo><mrow><mi>U</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></msub><mrow><msub><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">~</mo></mover><msup><mi>i</mi><mo>\u2032</mo></msup></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow><mo>}</mo></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nSuppose, $\\frac{R_1}{S_{11}}<\\frac{R_3}{S_{13}}<1\\leq\\frac{R_2}{S_{12}}$.\nIn other words, demand for output links~1 and~3 exceeds the available supply\nwith output link~1 being more restrictive, while the demand directed\nto the output link~2 can be satisfied.\nSince output links~1 and~3 do not affect each other, we get:\n", "itemtype": "equation", "pos": 40884, "prevtext": "\n\\begin{itemize}\n\\item If ${\\tilde{U}}(k) \\neq\\emptyset$, assign:\n\\begin{eqnarray*}\nf_{i1}^c & = & S_i^c, \\;\\;\\; i\\in{\\tilde{U}}(k); \\\\\n{\\tilde{R}}_1(k+1) & = & {\\tilde{R}}_1(k) - \\sum_{i\\in{\\tilde{U}}}\\sum_{c=1}^C f_{i1}^c; \\\\\nU(k+1) & = & U(k) \\setminus {\\tilde{U}}(k).\n\\end{eqnarray*}\n\\item Else, assign:\n\\begin{eqnarray*}\nf_{i1}^c & = & S_i^c \\frac{{\\tilde{p}}_i(k)}{\\sum_{i'\\in U(k)}{\\tilde{p}}_{i'}(k)}\n\\frac{{\\tilde{R}}_1(k)}{S_i},\n\\;\\;\\; i\\in U(k); \\\\\nU(k+1) & = & \\emptyset .\n\\end{eqnarray*}\n\\end{itemize}\n\n\\item If $U(k+1)=\\emptyset$, then stop.\n\n\\item Set $k:=k+1$, and return to step 2.\n\\end{enumerate}\n\nThis algorithm finishes after no more than $M$ iterations, and\nin the special case of $M=2$ it reduces to\n\\begin{eqnarray}\nf_{11}^c & = & \\min\\left\\{S_1^c, \\;\\; S_1^c\\frac{\\max\\left\\{\n\\frac{p_1}{p_1+p_2}R_1, \\;\\; R_1-S_2\\right\\}}{S_1}\\right\\};\n\\label{eq_merge_21_1}\\\\\nf_{21}^c & = & \\min\\left\\{S_2^c, \\;\\; S_2^c\\frac{\\max\\left\\{\n\\frac{p_2}{p_1+p_2}R_1, \\;\\; R_1-S_1\\right\\}}{S_2}\\right\\}.\n\\label{eq_merge_21_2}\n\\end{eqnarray}\n\nThe following theorem can be trivially proved,\nand we leave the proof to the reader.\nFurther, in Section~\\ref{subsec_mimo_relaxed}, it will become clear\nthat this theorem is a special case of a more general statement.\n\\begin{theo}\nThe input-output flow computation algorithm constructs the\nunique solution of the maximization\nproblem~\\eqref{miso_objective}-\\eqref{miso_priority_constraint}.\n\\label{theo_miso_optimal}\n\\end{theo}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\subsection{Single-Input-Multiple-Output (SIMO) Node: Relaxing FIFO Condition}\n\\label{subsec_simo}\nRecall our discussion of Figures~\\ref{fig-simo} and~\\ref{fig:networks}, and\nthe unrealistic spillback problems created by the FIFO condition.\nA more realistic model would allow to specify how output\nflows at any given junction can affect each other.\nIn the context of our example, we could say that \ncongestion in off-ramp~1 affects mainline flow in lane~1,\ncongestion in off-ramp~3 affects mainline flow in lanes~4 and~5\n(see striped areas in Figure~\\ref{fig-simo}), while\ntraffic flow in lanes~2 and~3 of the mainline output link is\nnot affected by the traffic state in output links~1 and~3.\nAdditionally, we can say that congestion in the mainline output~2\naffects flows directed to both off-ramps in full, \nwhile the traffic state in each of the off-ramps does not influence\nthe flow directed to the other off-ramp.\n\nTo formally describe the mutual influence of output links,\nwe introduce \\emph{mutual restriction intervals}\n${\\bm{\\eta}}_{j'j}= [y,z]\\subseteq[0,1]$.\nThese parameters can be interpreted as follows:\n\\begin{itemize}\n\\item ${\\bm{\\eta}}_{j'j}=[0,1]$ --- congestion in the output link $j'$\naffects flow directed to the output link $j$ in full.\nThis is equivalent to the FIFO condition.\nObviously, ${\\bm{\\eta}}_{jj}\\equiv[0,1]$.\n\\item ${\\bm{\\eta}}_{j'j}=[0,0]$ (or any other interval of zero length) --- traffic\nstate in the output link $j'$\ndoes not influence the flow directed to the output link $j$.\nThis is equivalent to no FIFO restriction.\n\\item ${\\bm{\\eta}}_{j'j}=[y,z]\\subset [0,1]$ --- traffic state in the output link\n$j'$ affects a $|{\\bm{\\eta}}_{j'j}|=z-y$ portion of the flow directed to the output\nlink $j$.\nMoreover, we specify this influence as an interval, not just a scalar,\nto capture the summary effect of multiple output links that may restrict\nflow to the output link $j$ --- how, will be explained shortly.\n\\end{itemize}\n\nFor our example in Figure~\\ref{fig-simo}, the mutual restriction intervals\ntake the form of a $3\\times 3$ interval matrix:\n", "index": 23, "text": "\n\\[\n\\left(\\begin{array}{ccc}\n[0, 1] & \\left[0, \\frac{1}{5}\\right] & [0, 0] \\\\\n\n[0, 1] & [0, 1] & [0, 1] \\\\\n\n[0, 0] & \\left[\\frac{3}{5}, 1\\right] & [0, 1]\n\\end{array}\\right).\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m1\" class=\"ltx_Math\" alttext=\"\\left(\\begin{array}[]{ccc}[0,1]&amp;\\left[0,\\frac{1}{5}\\right]&amp;[0,0]\\\\&#10;\\par&#10;[0,1]&amp;[0,1]&amp;[0,1]\\\\&#10;\\par&#10;[0,0]&amp;\\left[\\frac{3}{5},1\\right]&amp;[0,1]\\end{array}\\right).\" display=\"block\"><mrow><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow></mtd><mtd columnalign=\"center\"><mrow><mo>[</mo><mn>0</mn><mo>,</mo><mfrac><mn>1</mn><mn>5</mn></mfrac><mo>]</mo></mrow></mtd><mtd columnalign=\"center\"><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy=\"false\">]</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow></mtd><mtd columnalign=\"center\"><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow></mtd><mtd columnalign=\"center\"><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy=\"false\">]</mo></mrow></mtd><mtd columnalign=\"center\"><mrow><mo>[</mo><mfrac><mn>3</mn><mn>5</mn></mfrac><mo>,</mo><mn>1</mn><mo>]</mo></mrow></mtd><mtd columnalign=\"center\"><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow></mtd></mtr></mtable><mo>)</mo></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nFlow $f_{12}$ is partially restricted by both output links~1 and~3:\n", "itemtype": "equation", "pos": 41380, "prevtext": "\nSuppose, $\\frac{R_1}{S_{11}}<\\frac{R_3}{S_{13}}<1\\leq\\frac{R_2}{S_{12}}$.\nIn other words, demand for output links~1 and~3 exceeds the available supply\nwith output link~1 being more restrictive, while the demand directed\nto the output link~2 can be satisfied.\nSince output links~1 and~3 do not affect each other, we get:\n", "index": 25, "text": "\n\\[\nf_{11} = R_1 \\;\\;\\; \\mbox{ and } \\;\\;\\; f_{13} = R_3.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m1\" class=\"ltx_Math\" alttext=\"f_{11}=R_{1}\\;\\;\\;\\mbox{ and }\\;\\;\\;f_{13}=R_{3}.\" display=\"block\"><mrow><mrow><msub><mi>f</mi><mn>11</mn></msub><mo>=</mo><mrow><mpadded width=\"+8.4pt\"><msub><mi>R</mi><mn>1</mn></msub></mpadded><mo>\u2062</mo><mpadded width=\"+8.4pt\"><mtext>\u00a0and\u00a0</mtext></mpadded><mo>\u2062</mo><msub><mi>f</mi><mn>13</mn></msub></mrow><mo>=</mo><msub><mi>R</mi><mn>3</mn></msub></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nwhere $|{\\bm{\\eta}}_{12}|$ and $|{\\bm{\\eta}}_{32}|$ denote lengths of intervals\n${\\bm{\\eta}}_{12}$ and ${\\bm{\\eta}}_{32}$ respectively.\nIn this expression for $f_{12}$ the first term represents the unrestricted\nportion of flow (lanes~2 and~3);\nthe second term represents the portion of flow restricted by the output~1\n(lane~1); and\nthe third term represents the portion of flow restricted by the output~3\n(lanes~4 and~5).\nThe expression for $f_{12}$ can be rewritten as:\n", "itemtype": "equation", "pos": 41508, "prevtext": "\nFlow $f_{12}$ is partially restricted by both output links~1 and~3:\n", "index": 27, "text": "\n\\[\nf_{12} = \\left(1 - |{\\bm{\\eta}}_{12}| - |{\\bm{\\eta}}_{32}|\\right)S_{12} +\n\\frac{R_1}{S_{11}}|{\\bm{\\eta}}_{12}|S_{12} +\n\\frac{R_3}{S_{13}}|{\\bm{\\eta}}_{32}|S_{12},\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex6.m1\" class=\"ltx_Math\" alttext=\"f_{12}=\\left(1-|{\\bm{\\eta}}_{12}|-|{\\bm{\\eta}}_{32}|\\right)S_{12}+\\frac{R_{1}}%&#10;{S_{11}}|{\\bm{\\eta}}_{12}|S_{12}+\\frac{R_{3}}{S_{13}}|{\\bm{\\eta}}_{32}|S_{12},\" display=\"block\"><mrow><mrow><msub><mi>f</mi><mn>12</mn></msub><mo>=</mo><mrow><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><mrow><mo stretchy=\"false\">|</mo><msub><mi>\ud835\udf3c</mi><mn>12</mn></msub><mo stretchy=\"false\">|</mo></mrow><mo>-</mo><mrow><mo stretchy=\"false\">|</mo><msub><mi>\ud835\udf3c</mi><mn>32</mn></msub><mo stretchy=\"false\">|</mo></mrow></mrow><mo>)</mo></mrow><mo>\u2062</mo><msub><mi>S</mi><mn>12</mn></msub></mrow><mo>+</mo><mrow><mfrac><msub><mi>R</mi><mn>1</mn></msub><msub><mi>S</mi><mn>11</mn></msub></mfrac><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><msub><mi>\ud835\udf3c</mi><mn>12</mn></msub><mo stretchy=\"false\">|</mo></mrow><mo>\u2062</mo><msub><mi>S</mi><mn>12</mn></msub></mrow><mo>+</mo><mrow><mfrac><msub><mi>R</mi><mn>3</mn></msub><msub><mi>S</mi><mn>13</mn></msub></mfrac><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><msub><mi>\ud835\udf3c</mi><mn>32</mn></msub><mo stretchy=\"false\">|</mo></mrow><mo>\u2062</mo><msub><mi>S</mi><mn>12</mn></msub></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nwhich corresponds to the striped area in Figure~\\ref{fig-f12}(a),\nwhile the second and the third terms of the right hand side\ncorrespond to the areas of the grayed out rectangles that represent\nrestrictions imposed on flow $f_{12}$ by outputs~1 and~3 respectively.\n\n\\begin{figure}[htb]\n\\centering\n\\includegraphics[width=6in]{./Figures/f12.png}\n\\caption{Computing $f_{12}$ for the 1-input-3-output node example\nwith $\\frac{R_1}{S_{11}}<\\frac{R_3}{S_{13}}<1\\leq\\frac{R_2}{S_{12}}$,\n${\\bm{\\eta}}_{13}={\\bm{\\eta}}_{31}=[0,0]$, ${\\bm{\\eta}}_{32}=\\left[\\frac{3}{5}, 1\\right]$\nand two cases for $\\eta_{12}$:\n(a) $\\eta_{12}=\\left[0, \\frac{1}{5}\\right]$;\n(b) $\\eta_{12}=\\left[\\frac{4}{5}, 1\\right]$.}\n\\label{fig-f12}\n\\end{figure}\n\nWe come to an important point of why we use intervals, not just scalars,\nto represent mutual restrictions of output links.\nSuppose, in our example ${\\bm{\\eta}}_{12} = \\left[\\frac{4}{5}, 1\\right]$.\nThen, restrictions from outputs~1 and~3 imposed on flow $f_{12}$ would\noverlap, and their summary effect would be smaller.\nThe intuition is that if traffic in lane~5 of the mainline output is\nalready restricted by the output~1, then the output~3 cannot do anything\nmore to restrict the flow in lane~5, it can only restrict flow in lane~4\nof the mainline output.\nThus, the expression for $f_{12}$ in this case will be:\n", "itemtype": "equation", "pos": 42148, "prevtext": "\nwhere $|{\\bm{\\eta}}_{12}|$ and $|{\\bm{\\eta}}_{32}|$ denote lengths of intervals\n${\\bm{\\eta}}_{12}$ and ${\\bm{\\eta}}_{32}$ respectively.\nIn this expression for $f_{12}$ the first term represents the unrestricted\nportion of flow (lanes~2 and~3);\nthe second term represents the portion of flow restricted by the output~1\n(lane~1); and\nthe third term represents the portion of flow restricted by the output~3\n(lanes~4 and~5).\nThe expression for $f_{12}$ can be rewritten as:\n", "index": 29, "text": "\n\\[\nf_{12} = S_{12} - \n\\left(1 - \\frac{R_1}{S_{11}}\\right)|{\\bm{\\eta}}_{12}|S_{12} -\n\\left(1 - \\frac{R_3}{S_{13}}\\right)|{\\bm{\\eta}}_{32}|S_{12},\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex7.m1\" class=\"ltx_Math\" alttext=\"f_{12}=S_{12}-\\left(1-\\frac{R_{1}}{S_{11}}\\right)|{\\bm{\\eta}}_{12}|S_{12}-%&#10;\\left(1-\\frac{R_{3}}{S_{13}}\\right)|{\\bm{\\eta}}_{32}|S_{12},\" display=\"block\"><mrow><mrow><msub><mi>f</mi><mn>12</mn></msub><mo>=</mo><mrow><msub><mi>S</mi><mn>12</mn></msub><mo>-</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><mfrac><msub><mi>R</mi><mn>1</mn></msub><msub><mi>S</mi><mn>11</mn></msub></mfrac></mrow><mo>)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><msub><mi>\ud835\udf3c</mi><mn>12</mn></msub><mo stretchy=\"false\">|</mo></mrow><mo>\u2062</mo><msub><mi>S</mi><mn>12</mn></msub></mrow><mo>-</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><mfrac><msub><mi>R</mi><mn>3</mn></msub><msub><mi>S</mi><mn>13</mn></msub></mfrac></mrow><mo>)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><msub><mi>\ud835\udf3c</mi><mn>32</mn></msub><mo stretchy=\"false\">|</mo></mrow><mo>\u2062</mo><msub><mi>S</mi><mn>12</mn></msub></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nwhere the second term of the right hand side corresponds\nto the restriction imposed by the output~1, as before, and\nthe third term corresponds to the \\emph{additional} restrictive effect\nimposed by the output~3.\nThis expression is illustrated by Figure~\\ref{fig-f12}(b).\n\nDefine:\n\n", "itemtype": "equation", "pos": 43633, "prevtext": "\nwhich corresponds to the striped area in Figure~\\ref{fig-f12}(a),\nwhile the second and the third terms of the right hand side\ncorrespond to the areas of the grayed out rectangles that represent\nrestrictions imposed on flow $f_{12}$ by outputs~1 and~3 respectively.\n\n\\begin{figure}[htb]\n\\centering\n\\includegraphics[width=6in]{./Figures/f12.png}\n\\caption{Computing $f_{12}$ for the 1-input-3-output node example\nwith $\\frac{R_1}{S_{11}}<\\frac{R_3}{S_{13}}<1\\leq\\frac{R_2}{S_{12}}$,\n${\\bm{\\eta}}_{13}={\\bm{\\eta}}_{31}=[0,0]$, ${\\bm{\\eta}}_{32}=\\left[\\frac{3}{5}, 1\\right]$\nand two cases for $\\eta_{12}$:\n(a) $\\eta_{12}=\\left[0, \\frac{1}{5}\\right]$;\n(b) $\\eta_{12}=\\left[\\frac{4}{5}, 1\\right]$.}\n\\label{fig-f12}\n\\end{figure}\n\nWe come to an important point of why we use intervals, not just scalars,\nto represent mutual restrictions of output links.\nSuppose, in our example ${\\bm{\\eta}}_{12} = \\left[\\frac{4}{5}, 1\\right]$.\nThen, restrictions from outputs~1 and~3 imposed on flow $f_{12}$ would\noverlap, and their summary effect would be smaller.\nThe intuition is that if traffic in lane~5 of the mainline output is\nalready restricted by the output~1, then the output~3 cannot do anything\nmore to restrict the flow in lane~5, it can only restrict flow in lane~4\nof the mainline output.\nThus, the expression for $f_{12}$ in this case will be:\n", "index": 31, "text": "\n\\[\nf_{12} = S_{12} - \n\\left(1 - \\frac{R_1}{S_{11}}\\right)|{\\bm{\\eta}}_{12}|S_{12} -\n\\left(1 - \\frac{R_3}{S_{13}}\\right)\\left(|{\\bm{\\eta}}_{32}| - |{\\bm{\\eta}}_{12}|\\right)S_{12},\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex8.m1\" class=\"ltx_Math\" alttext=\"f_{12}=S_{12}-\\left(1-\\frac{R_{1}}{S_{11}}\\right)|{\\bm{\\eta}}_{12}|S_{12}-%&#10;\\left(1-\\frac{R_{3}}{S_{13}}\\right)\\left(|{\\bm{\\eta}}_{32}|-|{\\bm{\\eta}}_{12}|%&#10;\\right)S_{12},\" display=\"block\"><mrow><mrow><msub><mi>f</mi><mn>12</mn></msub><mo>=</mo><mrow><msub><mi>S</mi><mn>12</mn></msub><mo>-</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><mfrac><msub><mi>R</mi><mn>1</mn></msub><msub><mi>S</mi><mn>11</mn></msub></mfrac></mrow><mo>)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><msub><mi>\ud835\udf3c</mi><mn>12</mn></msub><mo stretchy=\"false\">|</mo></mrow><mo>\u2062</mo><msub><mi>S</mi><mn>12</mn></msub></mrow><mo>-</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><mfrac><msub><mi>R</mi><mn>3</mn></msub><msub><mi>S</mi><mn>13</mn></msub></mfrac></mrow><mo>)</mo></mrow><mo>\u2062</mo><mrow><mo>(</mo><mrow><mrow><mo stretchy=\"false\">|</mo><msub><mi>\ud835\udf3c</mi><mn>32</mn></msub><mo stretchy=\"false\">|</mo></mrow><mo>-</mo><mrow><mo stretchy=\"false\">|</mo><msub><mi>\ud835\udf3c</mi><mn>12</mn></msub><mo stretchy=\"false\">|</mo></mrow></mrow><mo>)</mo></mrow><mo>\u2062</mo><msub><mi>S</mi><mn>12</mn></msub></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nwhere `$\\times$' denotes a Cartesian product.\nThe Cartesian product of the two intervals gives us\na rectangle ${\\cal Q}_{j'j}$.\nIn Figure~\\ref{fig-f12} ${\\cal Q}_{12}$ and ${\\cal Q}_{32}$ represent the grayed out\nrectangles.\n\nDenote ${\\cal A}(\\cdot)$ an area of a two-dimensional shape.\nThen, the expressions for flow $f_{12}$ for different values of ${\\bm{\\eta}}_{12}$\nin our example can be replaced with a single, more general formula:\n", "itemtype": "equation", "pos": 44096, "prevtext": "\nwhere the second term of the right hand side corresponds\nto the restriction imposed by the output~1, as before, and\nthe third term corresponds to the \\emph{additional} restrictive effect\nimposed by the output~3.\nThis expression is illustrated by Figure~\\ref{fig-f12}(b).\n\nDefine:\n\n", "index": 33, "text": "\\begin{equation}\n{\\cal Q}_{j'j} = {\\bm{\\eta}}_{j'j}\\times \\left[\\frac{f_{1j'}}{S_{1j'}}S_{1j}, S_{1j}\\right],\n\\label{eq-rectangle-q-simo}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m1\" class=\"ltx_Math\" alttext=\"{\\cal Q}_{j^{\\prime}j}={\\bm{\\eta}}_{j^{\\prime}j}\\times\\left[\\frac{f_{1j^{%&#10;\\prime}}}{S_{1j^{\\prime}}}S_{1j},S_{1j}\\right],\" display=\"block\"><mrow><mrow><msub><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcac</mi><mrow><msup><mi>j</mi><mo>\u2032</mo></msup><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>=</mo><mrow><msub><mi>\ud835\udf3c</mi><mrow><msup><mi>j</mi><mo>\u2032</mo></msup><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u00d7</mo><mrow><mo>[</mo><mrow><mfrac><msub><mi>f</mi><mrow><mn>1</mn><mo>\u2062</mo><msup><mi>j</mi><mo>\u2032</mo></msup></mrow></msub><msub><mi>S</mi><mrow><mn>1</mn><mo>\u2062</mo><msup><mi>j</mi><mo>\u2032</mo></msup></mrow></msub></mfrac><mo>\u2062</mo><msub><mi>S</mi><mrow><mn>1</mn><mo>\u2062</mo><mi>j</mi></mrow></msub></mrow><mo>,</mo><msub><mi>S</mi><mrow><mn>1</mn><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>]</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\n\n\nNow, we are ready to formulate the optimization problem for the \ngeneral SIMO node with $N$ output links and $C$ commodities:\n\n", "itemtype": "equation", "pos": 44686, "prevtext": "\nwhere `$\\times$' denotes a Cartesian product.\nThe Cartesian product of the two intervals gives us\na rectangle ${\\cal Q}_{j'j}$.\nIn Figure~\\ref{fig-f12} ${\\cal Q}_{12}$ and ${\\cal Q}_{32}$ represent the grayed out\nrectangles.\n\nDenote ${\\cal A}(\\cdot)$ an area of a two-dimensional shape.\nThen, the expressions for flow $f_{12}$ for different values of ${\\bm{\\eta}}_{12}$\nin our example can be replaced with a single, more general formula:\n", "index": 35, "text": "\n\\[\nf_{12} = S_{12} - {\\cal A}\\left({\\cal Q}_{12}\\cup{\\cal Q}_{32}\\right).\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex9.m1\" class=\"ltx_Math\" alttext=\"f_{12}=S_{12}-{\\cal A}\\left({\\cal Q}_{12}\\cup{\\cal Q}_{32}\\right).\" display=\"block\"><mrow><mrow><msub><mi>f</mi><mn>12</mn></msub><mo>=</mo><mrow><msub><mi>S</mi><mn>12</mn></msub><mo>-</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udc9c</mi><mo>\u2062</mo><mrow><mo>(</mo><mrow><msub><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcac</mi><mn>12</mn></msub><mo>\u222a</mo><msub><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcac</mi><mn>32</mn></msub></mrow><mo>)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nsubject to:\n\\begin{eqnarray}\n& & f_{1j}^c \\geq 0, \\;\\; j=1,\\dots,N, \\; c=1,\\dots,C \\;\n\\mbox{ --- non-negativity constraint};\n\\label{simo_nonnegativity_constraint} \\\\\n& & f_{1j}^c \\leq S_{1j}^c, \\;\\; j=1,\\dots,N, \\; \nc=1,\\dots,C \\; \\mbox{ --- demand constraint};\n\\label{simo_demand_constraint} \\\\\n& & f_{1j} \\leq R_j, \\;\\; j=1,\\dots,N \\;\n\\mbox{ --- supply constraint};\n\\label{simo_supply_constraint} \\\\\n& & \\frac{f_{ij}^c}{f_{1j}} =\n\\frac{S_{1j}^c}{S_{1j}}, \\;\\;\nj=1,\\dots,N, \\; c=1,\\dots,C \\;\\; \\mbox{ --- proportionality constraint for}\\nonumber \\\\\n& & \\mbox{commodity flows};\n\\label{simo_proportionality_constraint}\\\\\n& & f_{1j} \\leq S_{ij} - {\\cal A}\\left(\\bigcup_{j'\\neq j}Q_{j'j}\\right), \\;\\;\nj=1, \\dots, N \\;\n\\mbox{ --- relaxed FIFO constraint}.\n\\label{simo_rfifo_constraint}\n\\end{eqnarray}\nFor SIMO nodes with full FIFO, constraint~\\eqref{simo_rfifo_constraint}\ntogether with the supply constraint~\\eqref{simo_supply_constraint}\ntranslates into:\n\n", "itemtype": "equation", "pos": 44892, "prevtext": "\n\n\nNow, we are ready to formulate the optimization problem for the \ngeneral SIMO node with $N$ output links and $C$ commodities:\n\n", "index": 37, "text": "\\begin{equation}\n\\max\\left(\\sum_{j=1}^N\\sum_{c=1}^C f_{1j}^c\\right),\n\\label{simo_objective}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E10.m1\" class=\"ltx_Math\" alttext=\"\\max\\left(\\sum_{j=1}^{N}\\sum_{c=1}^{C}f_{1j}^{c}\\right),\" display=\"block\"><mrow><mrow><mi>max</mi><mo>\u2061</mo><mrow><mo>(</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><msubsup><mi>f</mi><mrow><mn>1</mn><mo>\u2062</mo><mi>j</mi></mrow><mi>c</mi></msubsup></mrow></mrow><mo>)</mo></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nwhere\n\n", "itemtype": "equation", "pos": 45952, "prevtext": "\nsubject to:\n\\begin{eqnarray}\n& & f_{1j}^c \\geq 0, \\;\\; j=1,\\dots,N, \\; c=1,\\dots,C \\;\n\\mbox{ --- non-negativity constraint};\n\\label{simo_nonnegativity_constraint} \\\\\n& & f_{1j}^c \\leq S_{1j}^c, \\;\\; j=1,\\dots,N, \\; \nc=1,\\dots,C \\; \\mbox{ --- demand constraint};\n\\label{simo_demand_constraint} \\\\\n& & f_{1j} \\leq R_j, \\;\\; j=1,\\dots,N \\;\n\\mbox{ --- supply constraint};\n\\label{simo_supply_constraint} \\\\\n& & \\frac{f_{ij}^c}{f_{1j}} =\n\\frac{S_{1j}^c}{S_{1j}}, \\;\\;\nj=1,\\dots,N, \\; c=1,\\dots,C \\;\\; \\mbox{ --- proportionality constraint for}\\nonumber \\\\\n& & \\mbox{commodity flows};\n\\label{simo_proportionality_constraint}\\\\\n& & f_{1j} \\leq S_{ij} - {\\cal A}\\left(\\bigcup_{j'\\neq j}Q_{j'j}\\right), \\;\\;\nj=1, \\dots, N \\;\n\\mbox{ --- relaxed FIFO constraint}.\n\\label{simo_rfifo_constraint}\n\\end{eqnarray}\nFor SIMO nodes with full FIFO, constraint~\\eqref{simo_rfifo_constraint}\ntogether with the supply constraint~\\eqref{simo_supply_constraint}\ntranslates into:\n\n", "index": 39, "text": "\\begin{equation}\nf_{1j} \\leq S_{1j} - \\left(1 - \\frac{f_{1j^\\ast}}{S_{1j^\\ast}}\\right)S_{1j} =\n\\frac{f_{1j^\\ast}}{S_{1j^\\ast}}S_{1j},\n\\label{simo_fifo_constraint}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E11.m1\" class=\"ltx_Math\" alttext=\"f_{1j}\\leq S_{1j}-\\left(1-\\frac{f_{1j^{\\ast}}}{S_{1j^{\\ast}}}\\right)S_{1j}=%&#10;\\frac{f_{1j^{\\ast}}}{S_{1j^{\\ast}}}S_{1j},\" display=\"block\"><mrow><mrow><msub><mi>f</mi><mrow><mn>1</mn><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2264</mo><mrow><msub><mi>S</mi><mrow><mn>1</mn><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>-</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><mfrac><msub><mi>f</mi><mrow><mn>1</mn><mo>\u2062</mo><msup><mi>j</mi><mo>\u2217</mo></msup></mrow></msub><msub><mi>S</mi><mrow><mn>1</mn><mo>\u2062</mo><msup><mi>j</mi><mo>\u2217</mo></msup></mrow></msub></mfrac></mrow><mo>)</mo></mrow><mo>\u2062</mo><msub><mi>S</mi><mrow><mn>1</mn><mo>\u2062</mo><mi>j</mi></mrow></msub></mrow></mrow><mo>=</mo><mrow><mfrac><msub><mi>f</mi><mrow><mn>1</mn><mo>\u2062</mo><msup><mi>j</mi><mo>\u2217</mo></msup></mrow></msub><msub><mi>S</mi><mrow><mn>1</mn><mo>\u2062</mo><msup><mi>j</mi><mo>\u2217</mo></msup></mrow></msub></mfrac><mo>\u2062</mo><msub><mi>S</mi><mrow><mn>1</mn><mo>\u2062</mo><mi>j</mi></mrow></msub></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nand, since we are solving the flow maximization problem,\n\\eqref{simo_fifo_constraint} can be replaced with the equality constraint:\n\n", "itemtype": "equation", "pos": 46136, "prevtext": "\nwhere\n\n", "index": 41, "text": "\\begin{equation}\nj^\\ast = \\arg\\min_j\\frac{R_{j^\\ast}}{S_{1j^\\ast}},\n\\label{simo_restrictive_output}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E12.m1\" class=\"ltx_Math\" alttext=\"j^{\\ast}=\\arg\\min_{j}\\frac{R_{j^{\\ast}}}{S_{1j^{\\ast}}},\" display=\"block\"><mrow><mrow><msup><mi>j</mi><mo>\u2217</mo></msup><mo>=</mo><mrow><mi>arg</mi><mo>\u2061</mo><mrow><munder><mi>min</mi><mi>j</mi></munder><mo>\u2061</mo><mfrac><msub><mi>R</mi><msup><mi>j</mi><mo>\u2217</mo></msup></msub><msub><mi>S</mi><mrow><mn>1</mn><mo>\u2062</mo><msup><mi>j</mi><mo>\u2217</mo></msup></mrow></msub></mfrac></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\n\nFor SIMO nodes with no FIFO, ${\\cal A}\\left(\\bigcup_{j'\\neq j}{\\cal Q}_{j'j}\\right)=0$,\nwhich simplifies~\\eqref{simo_rfifo_constraint} to the demand constraint,\nand thus, constraint~\\eqref{simo_rfifo_constraint} can be omitted. \n\n\nNext, we present the algorithm for solving the flow\nmaximization problem~\\eqref{simo_objective}-\\eqref{simo_rfifo_constraint}.\n\\begin{enumerate}\n\\item Initialize:\n\\begin{eqnarray*}\n{\\tilde{S}}_{1j}^c(0) & := & S_{1j}^c; \\\\\n{\\tilde{S}}_{1j}(0) & := & S_{1j};\\\\\n{\\tilde{\\bm{\\eta}}}_j(0) & = & [0, 0]; \\\\\nV(0) & := & \\{1, \\dots, N\\}; \\\\\nk & := & 0; \\\\\n& & j=1, \\dots, N, \\;\\;\\; c = 1, \\dots, C.\n\\end{eqnarray*}\n\n\\item If $V(k) = \\emptyset$, stop.\n\n\\item For all output links $j\\in V(k)$, find flow reduction factors:\n\n", "itemtype": "equation", "pos": 46383, "prevtext": "\nand, since we are solving the flow maximization problem,\n\\eqref{simo_fifo_constraint} can be replaced with the equality constraint:\n\n", "index": 43, "text": "\\begin{equation}\nf_{1j} = \\frac{f_{1j^\\ast}}{S_{1j^\\ast}}S_{1j}.\n\\label{simo_fifo_constraint_eq}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E13.m1\" class=\"ltx_Math\" alttext=\"f_{1j}=\\frac{f_{1j^{\\ast}}}{S_{1j^{\\ast}}}S_{1j}.\" display=\"block\"><mrow><mrow><msub><mi>f</mi><mrow><mn>1</mn><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>=</mo><mrow><mfrac><msub><mi>f</mi><mrow><mn>1</mn><mo>\u2062</mo><msup><mi>j</mi><mo>\u2217</mo></msup></mrow></msub><msub><mi>S</mi><mrow><mn>1</mn><mo>\u2062</mo><msup><mi>j</mi><mo>\u2217</mo></msup></mrow></msub></mfrac><mo>\u2062</mo><msub><mi>S</mi><mrow><mn>1</mn><mo>\u2062</mo><mi>j</mi></mrow></msub></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nand find the most restrictive output link out of the remaining ones:\n\n", "itemtype": "equation", "pos": 47241, "prevtext": "\n\nFor SIMO nodes with no FIFO, ${\\cal A}\\left(\\bigcup_{j'\\neq j}{\\cal Q}_{j'j}\\right)=0$,\nwhich simplifies~\\eqref{simo_rfifo_constraint} to the demand constraint,\nand thus, constraint~\\eqref{simo_rfifo_constraint} can be omitted. \n\n\nNext, we present the algorithm for solving the flow\nmaximization problem~\\eqref{simo_objective}-\\eqref{simo_rfifo_constraint}.\n\\begin{enumerate}\n\\item Initialize:\n\\begin{eqnarray*}\n{\\tilde{S}}_{1j}^c(0) & := & S_{1j}^c; \\\\\n{\\tilde{S}}_{1j}(0) & := & S_{1j};\\\\\n{\\tilde{\\bm{\\eta}}}_j(0) & = & [0, 0]; \\\\\nV(0) & := & \\{1, \\dots, N\\}; \\\\\nk & := & 0; \\\\\n& & j=1, \\dots, N, \\;\\;\\; c = 1, \\dots, C.\n\\end{eqnarray*}\n\n\\item If $V(k) = \\emptyset$, stop.\n\n\\item For all output links $j\\in V(k)$, find flow reduction factors:\n\n", "index": 45, "text": "\\begin{equation}\n\\alpha_j(k) = \\frac{R_j}{{\\tilde{S}}_{1j}(k)},\n\\label{simo-reduction-factors}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14.m1\" class=\"ltx_Math\" alttext=\"\\alpha_{j}(k)=\\frac{R_{j}}{{\\tilde{S}}_{1j}(k)},\" display=\"block\"><mrow><mrow><mrow><msub><mi>\u03b1</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mfrac><msub><mi>R</mi><mi>j</mi></msub><mrow><msub><mover accent=\"true\"><mi>S</mi><mo stretchy=\"false\">~</mo></mover><mrow><mn>1</mn><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\n\\begin{itemize}\n\\item If $\\alpha_{j^\\ast(k)}(k) \\geq 1$, then assign:\n\\begin{eqnarray}\nf_{1j}^c & = & {\\tilde{S}}_{1j}^c(k), \\;\\; \\forall j\\in V(k), \\;\\; c=1,\\dots, C; \n\\label{simo-freeflow}\\\\\nV(k+1) & = & \\emptyset. \\nonumber\n\\end{eqnarray}\n\\item Else, assign:\n\\begin{eqnarray}\n{\\tilde{S}}_{1j^\\ast}^c(k+1) & = & \\alpha_{j^\\ast}(k){\\tilde{S}}_{1j}^c(k), \\;\\; c=1,\\dots,C; \n\\label{simo-step3-1} \\\\\n{\\tilde{S}}_{1j}^c(k+1) & = & \\frac{{\\tilde{S}}_{1j}(k+1)}{S_{1j}}S_{1j}^c, \\;\\; \nj\\in V(k)\\setminus\\{j^\\ast\\}, \\;\\; c=1,\\dots, C, \\label{simo-step3-2} \\\\\n& & \\mbox{ where } \\nonumber \\\\\n{\\tilde{S}}_{1j}(k+1) & = & {\\tilde{S}}_{1j}(k) - \nS_{1j}\\left(|{\\bm{\\eta}}_{j^\\ast j}| - |{\\tilde{\\bm{\\eta}}}_j(k)\\cap{\\bm{\\eta}}_{j^\\ast j}|\\right)\n\\left( 1 - \\frac{\\sum_{c=1}^C{\\tilde{S}}_{1j^\\ast}^c(k+1)}{S_{1j^\\ast}} \\right),\n\\label{simo-step3-3} \\\\\n{\\tilde{\\bm{\\eta}}}_j(k+1) & = & {\\tilde{\\bm{\\eta}}}_j(k) \\cup {\\bm{\\eta}}_{j^\\ast j}, \\;\\;\nj\\in V(k); \\nonumber \\\\\nf_{1j}^c & = & {\\tilde{S}}_{ij}^c(k+1), \\;\\;\nj:~{\\tilde{\\bm{\\eta}}}_j(k+1)=[0,1], \\;\\;\nc=1,\\dots, C;\n\\label{simo-step3-4} \\\\\nV(k+1) & = & V(k)\\setminus\\{j:~{\\tilde{\\bm{\\eta}}}_j(k+1)=[0,1]\\}, \\nonumber\n\\end{eqnarray}\nwhere $|{\\tilde{\\bm{\\eta}}}_j(k)\\cap{\\bm{\\eta}}_{j^\\ast j}|$ denotes the measure of the\ninterval intersection.\\footnote{This set may be disjoint.}\n\\end{itemize}\n\n\\item Set $k := k+1$ and return to step~2.\n\\end{enumerate}\nThis algorithm takes no more than $N$ iterations to complete.\n\nFinally, we state the result of this Section as a theorem.\n\\begin{theo}\nThe SIMO input-output flow computation algorithm constructs the\nunique solution of the maximization\nproblem~\\eqref{simo_objective}-\\eqref{simo_rfifo_constraint}.\n\\label{theo_simo_optimal}\n\\end{theo}\n\n{\\bf Remark.}\nNote that in the case of multiple input links\nmutual restriction intervals are to be\nspecified per input link.\nThis can be justified by the following example.\nIn the node representing an intersection\nwith 2 input and 3 output links,\nshown in Figure~\\ref{fig-intersection},\nconsider the influence of the output link 5\non the output link 4.\nIf vehicles enter links 4 and 5 from link 1, then\nit is reasonable to assume that once link 5 is jammed\nand cannot accept any vehicles, there is no flow\nfrom 1 to 4 either. \nIn other words, ${\\bm{\\eta}}_{54}^1=[0, 1]$.\nOn the other hand, if vehicles arrive from link 2,\nblockage of the output link 5 may hinder, but not \nnecessarily prevent, traffic from flowing into the output\nlink 4, and so ${\\bm{\\eta}}_{54}^2=[1-\\epsilon, 1]$, with some\n$0< \\epsilon<1$.\nSo, from now on we will write ${\\bm{\\eta}}_{j'j}^i$\nand ${\\cal Q}_{j'j}^i$with index $i$\nidentifying the input link.\n\n\\begin{figure}[htb]\n\\centering\n\\includegraphics[width=1.5in]{./Figures/intersection.jpg}\n\\caption{Intersection node.}\n\\label{fig-intersection}\n\\end{figure}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\subsection{Multiple-Input-Multiple-Output (MIMO) Node}\\label{subsec_mimo_relaxed}\nTo formally state the flow maximization problem for the MIMO node,\nwe need to extend the MISO optimization\nproblem~\\eqref{miso_objective}-\\eqref{miso_priority_constraint}\nand the SIMO optimization \nproblem~\\eqref{simo_objective}-\\eqref{simo_rfifo_constraint}.\nWhile the generalization of the objective~\\eqref{miso_objective},\n\\eqref{simo_objective} and\nconstraints~\\eqref{miso_nonnegativity_constraint}-\\eqref{miso_proportionality_constraint},\n\\eqref{simo_nonnegativity_constraint}-\\eqref{simo_proportionality_constraint}\nis straight forward,\nextending the priority constraint~\\eqref{miso_priority_constraint}\nand the relaxed FIFO constraint~\\eqref{simo_rfifo_constraint} to\nthe MIMO case requires a little more work.\n\n\\begin{df}\nIf for a given input link $i$ whose demand cannot be satisfied\n($\\sum_{j=1}^N f_{ij} < S_i$), there exists\nat least one output link $j^\\ast$, such that: (1) $S_{ij^\\ast}>0$; and\n(2) $p_{i'j^\\ast}f_{ij^\\ast} \\geq p_{ij^\\ast}f_{i'j^\\ast}$ \nfor any $i'\\neq i$,\nwe say that such output $j^\\ast$ is \\emph{restricting}\nfor input $i$.\n\\label{def-restrictive-output}\n\\end{df}\nIf the output $j^\\ast$ is restricting for input links $i'$ and $i''$,\nthen, according to this definition,\n$p_{i''j^\\ast} f_{i'j^\\ast} = p_{i'j^\\ast} f_{i''j^\\ast}$.\n\nDefine the set of restricting outputs for input link $i$:\n\n", "itemtype": "equation", "pos": 47420, "prevtext": "\nand find the most restrictive output link out of the remaining ones:\n\n", "index": 47, "text": "\\begin{equation}\nj^\\ast(k) = \\arg\\min_{j\\in V(k)} \\alpha_j(k).\n\\label{simo-most-restrictive}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E15.m1\" class=\"ltx_Math\" alttext=\"j^{\\ast}(k)=\\arg\\min_{j\\in V(k)}\\alpha_{j}(k).\" display=\"block\"><mrow><mrow><mrow><msup><mi>j</mi><mo>\u2217</mo></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>arg</mi><mo>\u2061</mo><mrow><munder><mi>min</mi><mrow><mi>j</mi><mo>\u2208</mo><mrow><mi>V</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></munder><mo>\u2061</mo><msub><mi>\u03b1</mi><mi>j</mi></msub></mrow></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\n\nNow we can formulate the flow maximization problem for the general\nMIMO node:\n\n", "itemtype": "equation", "pos": 51762, "prevtext": "\n\\begin{itemize}\n\\item If $\\alpha_{j^\\ast(k)}(k) \\geq 1$, then assign:\n\\begin{eqnarray}\nf_{1j}^c & = & {\\tilde{S}}_{1j}^c(k), \\;\\; \\forall j\\in V(k), \\;\\; c=1,\\dots, C; \n\\label{simo-freeflow}\\\\\nV(k+1) & = & \\emptyset. \\nonumber\n\\end{eqnarray}\n\\item Else, assign:\n\\begin{eqnarray}\n{\\tilde{S}}_{1j^\\ast}^c(k+1) & = & \\alpha_{j^\\ast}(k){\\tilde{S}}_{1j}^c(k), \\;\\; c=1,\\dots,C; \n\\label{simo-step3-1} \\\\\n{\\tilde{S}}_{1j}^c(k+1) & = & \\frac{{\\tilde{S}}_{1j}(k+1)}{S_{1j}}S_{1j}^c, \\;\\; \nj\\in V(k)\\setminus\\{j^\\ast\\}, \\;\\; c=1,\\dots, C, \\label{simo-step3-2} \\\\\n& & \\mbox{ where } \\nonumber \\\\\n{\\tilde{S}}_{1j}(k+1) & = & {\\tilde{S}}_{1j}(k) - \nS_{1j}\\left(|{\\bm{\\eta}}_{j^\\ast j}| - |{\\tilde{\\bm{\\eta}}}_j(k)\\cap{\\bm{\\eta}}_{j^\\ast j}|\\right)\n\\left( 1 - \\frac{\\sum_{c=1}^C{\\tilde{S}}_{1j^\\ast}^c(k+1)}{S_{1j^\\ast}} \\right),\n\\label{simo-step3-3} \\\\\n{\\tilde{\\bm{\\eta}}}_j(k+1) & = & {\\tilde{\\bm{\\eta}}}_j(k) \\cup {\\bm{\\eta}}_{j^\\ast j}, \\;\\;\nj\\in V(k); \\nonumber \\\\\nf_{1j}^c & = & {\\tilde{S}}_{ij}^c(k+1), \\;\\;\nj:~{\\tilde{\\bm{\\eta}}}_j(k+1)=[0,1], \\;\\;\nc=1,\\dots, C;\n\\label{simo-step3-4} \\\\\nV(k+1) & = & V(k)\\setminus\\{j:~{\\tilde{\\bm{\\eta}}}_j(k+1)=[0,1]\\}, \\nonumber\n\\end{eqnarray}\nwhere $|{\\tilde{\\bm{\\eta}}}_j(k)\\cap{\\bm{\\eta}}_{j^\\ast j}|$ denotes the measure of the\ninterval intersection.\\footnote{This set may be disjoint.}\n\\end{itemize}\n\n\\item Set $k := k+1$ and return to step~2.\n\\end{enumerate}\nThis algorithm takes no more than $N$ iterations to complete.\n\nFinally, we state the result of this Section as a theorem.\n\\begin{theo}\nThe SIMO input-output flow computation algorithm constructs the\nunique solution of the maximization\nproblem~\\eqref{simo_objective}-\\eqref{simo_rfifo_constraint}.\n\\label{theo_simo_optimal}\n\\end{theo}\n\n{\\bf Remark.}\nNote that in the case of multiple input links\nmutual restriction intervals are to be\nspecified per input link.\nThis can be justified by the following example.\nIn the node representing an intersection\nwith 2 input and 3 output links,\nshown in Figure~\\ref{fig-intersection},\nconsider the influence of the output link 5\non the output link 4.\nIf vehicles enter links 4 and 5 from link 1, then\nit is reasonable to assume that once link 5 is jammed\nand cannot accept any vehicles, there is no flow\nfrom 1 to 4 either. \nIn other words, ${\\bm{\\eta}}_{54}^1=[0, 1]$.\nOn the other hand, if vehicles arrive from link 2,\nblockage of the output link 5 may hinder, but not \nnecessarily prevent, traffic from flowing into the output\nlink 4, and so ${\\bm{\\eta}}_{54}^2=[1-\\epsilon, 1]$, with some\n$0< \\epsilon<1$.\nSo, from now on we will write ${\\bm{\\eta}}_{j'j}^i$\nand ${\\cal Q}_{j'j}^i$with index $i$\nidentifying the input link.\n\n\\begin{figure}[htb]\n\\centering\n\\includegraphics[width=1.5in]{./Figures/intersection.jpg}\n\\caption{Intersection node.}\n\\label{fig-intersection}\n\\end{figure}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\subsection{Multiple-Input-Multiple-Output (MIMO) Node}\\label{subsec_mimo_relaxed}\nTo formally state the flow maximization problem for the MIMO node,\nwe need to extend the MISO optimization\nproblem~\\eqref{miso_objective}-\\eqref{miso_priority_constraint}\nand the SIMO optimization \nproblem~\\eqref{simo_objective}-\\eqref{simo_rfifo_constraint}.\nWhile the generalization of the objective~\\eqref{miso_objective},\n\\eqref{simo_objective} and\nconstraints~\\eqref{miso_nonnegativity_constraint}-\\eqref{miso_proportionality_constraint},\n\\eqref{simo_nonnegativity_constraint}-\\eqref{simo_proportionality_constraint}\nis straight forward,\nextending the priority constraint~\\eqref{miso_priority_constraint}\nand the relaxed FIFO constraint~\\eqref{simo_rfifo_constraint} to\nthe MIMO case requires a little more work.\n\n\\begin{df}\nIf for a given input link $i$ whose demand cannot be satisfied\n($\\sum_{j=1}^N f_{ij} < S_i$), there exists\nat least one output link $j^\\ast$, such that: (1) $S_{ij^\\ast}>0$; and\n(2) $p_{i'j^\\ast}f_{ij^\\ast} \\geq p_{ij^\\ast}f_{i'j^\\ast}$ \nfor any $i'\\neq i$,\nwe say that such output $j^\\ast$ is \\emph{restricting}\nfor input $i$.\n\\label{def-restrictive-output}\n\\end{df}\nIf the output $j^\\ast$ is restricting for input links $i'$ and $i''$,\nthen, according to this definition,\n$p_{i''j^\\ast} f_{i'j^\\ast} = p_{i'j^\\ast} f_{i''j^\\ast}$.\n\nDefine the set of restricting outputs for input link $i$:\n\n", "index": 49, "text": "\\begin{equation}\nW_i = \\left\\{j^\\ast: \\;\\; S_{ij^\\ast} >0; \\;\\;\np_{i'j^\\ast}f_{ij^\\ast} \\geq p_{ij^\\ast}f_{i'j^\\ast},\\;\\;\n\\forall i'\\neq i\\right\\}.\n\\label{eq-restricting-output-set}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E16.m1\" class=\"ltx_Math\" alttext=\"W_{i}=\\left\\{j^{\\ast}:\\;\\;S_{ij^{\\ast}}&gt;0;\\;\\;p_{i^{\\prime}j^{\\ast}}f_{ij^{%&#10;\\ast}}\\geq p_{ij^{\\ast}}f_{i^{\\prime}j^{\\ast}},\\;\\;\\forall i^{\\prime}\\neq i%&#10;\\right\\}.\" display=\"block\"><mrow><mrow><msub><mi>W</mi><mi>i</mi></msub><mo>=</mo><mrow><mo>{</mo><msup><mi>j</mi><mo>\u2217</mo></msup><mo rspace=\"8.1pt\">:</mo><mrow><mrow><msub><mi>S</mi><mrow><mi>i</mi><mo>\u2062</mo><msup><mi>j</mi><mo>\u2217</mo></msup></mrow></msub><mo>&gt;</mo><mn>0</mn></mrow><mo rspace=\"8.1pt\">;</mo><mrow><mrow><mrow><msub><mi>p</mi><mrow><msup><mi>i</mi><mo>\u2032</mo></msup><mo>\u2062</mo><msup><mi>j</mi><mo>\u2217</mo></msup></mrow></msub><mo>\u2062</mo><msub><mi>f</mi><mrow><mi>i</mi><mo>\u2062</mo><msup><mi>j</mi><mo>\u2217</mo></msup></mrow></msub></mrow><mo>\u2265</mo><mrow><msub><mi>p</mi><mrow><mi>i</mi><mo>\u2062</mo><msup><mi>j</mi><mo>\u2217</mo></msup></mrow></msub><mo>\u2062</mo><msub><mi>f</mi><mrow><msup><mi>i</mi><mo>\u2032</mo></msup><mo>\u2062</mo><msup><mi>j</mi><mo>\u2217</mo></msup></mrow></msub></mrow></mrow><mo rspace=\"8.1pt\">,</mo><mrow><mrow><mo>\u2200</mo><msup><mi>i</mi><mo>\u2032</mo></msup></mrow><mo>\u2260</mo><mi>i</mi></mrow></mrow></mrow><mo>}</mo></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nsubject to:\n\\begin{eqnarray}\n& & f_{ij}^c \\geq 0, \\;\\; i=1,\\dots,M, \\; j=1,\\dots,N, \\; c=1,\\dots,C \\;\n\\mbox{ --- non-negativity constraint};\n\\label{mimo_nonnegativity_constraint} \\\\\n& & f_{ij}^c \\leq S_{ij}^c, \\;\\; i=1,\\dots,M, \\; j=1,\\dots,N, \\; \nc=1,\\dots,C \\; \\mbox{ --- demand constraint};\n\\label{mimo_demand_constraint} \\\\\n& & \\sum_{i=1}^M f_{ij} \\leq R_j, \\;\\; j=1,\\dots,N \\;\n\\mbox{ --- supply constraint};\n\\label{mimo_supply_constraint} \\\\\n& & \\frac{f_{ij}^c}{f_{ij}} =\n\\frac{S_{ij}^c}{S_{ij}}, \\;\\; i = 1,\\dots,M,\\;\nj=1,\\dots,N, c=1,\\dots,C \\;\\; \\mbox{ --- proportionality constraint}\\nonumber \\\\\n& & \\mbox{for commodity flows};\n\\label{mimo_proportionality_constraint}\\\\\n& & \\left.\\begin{array}{cl}\n\\mbox{(a)} &\n\\mbox{For each input link $i$, such that } \\\\\n& \\sum_{j=1}^N f_{ij} <  S_i, \\;\\; W_i\\neq\\emptyset; \\\\\n\\mbox{(b)} &\n\\mbox{For each input link $i$, such that $W_i\\neq\\emptyset$,} \\\\\n& f_{ij} \\geq \\frac{p_{ij}}{\\sum_{i'=1}^M p_{i'j}} R_j,\n\\;\\; \\forall j\\in W_i.\n\\end{array}\\right\\} \\mbox{ --- priority constraint};\n\\label{mimo_priority_constraint}\\\\\n& & f_{ij} \\leq S_{ij} - {\\cal A}\\left(\\bigcup_{j'\\in W_i\\setminus\\{j\\}}{\\cal Q}_{j'j}^i \\right),\n\\;\\; i=1,\\dots,M, \\; j=1,\\dots,N \\;\\;\n\\mbox{ --- relaxed FIFO} \\nonumber \\\\\n& & \\mbox{ constraint}.\n\\label{mimo_rfifo_constraint}\n\\end{eqnarray}\nConstraint~\\eqref{mimo_priority_constraint} generalizes the\nMISO priority constraint~\\eqref{miso_priority_constraint}.\nFor each output link $j$, $j=1,\\dots,N$, \nflows $\\sum_{c=1}^C f_{ij}^c$ fall into two categories:\n(1) restricted by \\emph{this} output link; and\n(2) not restricted by \\emph{this} output link.\nCondition~\\eqref{mimo_priority_constraint}(a) states that \nif the flow from an input $i$ is supply-constrained, there\ndo exist output links $j$, such that flows $f_{ij}$\nare of category~1;\nand for a given output $j$, input-output flows of category~1 are allocated\nproportionally to their priorities.\nFor every output link $j$, $j=1,\\dots,N$, \ncondition~\\eqref{mimo_priority_constraint}(b) ensures that\ninput-output flows of category~2 \ndo not take up more output supply than was allocated for them when category 1\nis non-empty.\nFor a SIMO ($M=1$) node, where there is no competition between input flows,\nconstraint~\\eqref{mimo_priority_constraint} is satisfied automatically.\n\nConstraint~\\eqref{mimo_rfifo_constraint} generalizes the SIMO\nrelaxed FIFO constraint~\\eqref{simo_rfifo_constraint}.\nHere,\n\n", "itemtype": "equation", "pos": 52038, "prevtext": "\n\nNow we can formulate the flow maximization problem for the general\nMIMO node:\n\n", "index": 51, "text": "\\begin{equation}\n\\max\\left(\\sum_{i=1}^M\\sum_{j=1}^N\\sum_{c=1}^C f_{ij}^c\\right),\n\\label{mimo_objective}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E17.m1\" class=\"ltx_Math\" alttext=\"\\max\\left(\\sum_{i=1}^{M}\\sum_{j=1}^{N}\\sum_{c=1}^{C}f_{ij}^{c}\\right),\" display=\"block\"><mrow><mrow><mi>max</mi><mo>\u2061</mo><mrow><mo>(</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></munderover><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><msubsup><mi>f</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow><mi>c</mi></msubsup></mrow></mrow></mrow><mo>)</mo></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nwhich is a generalization of~\\eqref{eq-rectangle-q-simo}, and ${\\cal A}(\\cdot)$ denotes the area\nof a two-dimensional object.\nFor MIMO nodes with full FIFO, constraint~\\eqref{mimo_rfifo_constraint}\ntogether with the supply constraint~\\eqref{mimo_supply_constraint}\ntranslates to:\n\n", "itemtype": "equation", "pos": 54578, "prevtext": "\nsubject to:\n\\begin{eqnarray}\n& & f_{ij}^c \\geq 0, \\;\\; i=1,\\dots,M, \\; j=1,\\dots,N, \\; c=1,\\dots,C \\;\n\\mbox{ --- non-negativity constraint};\n\\label{mimo_nonnegativity_constraint} \\\\\n& & f_{ij}^c \\leq S_{ij}^c, \\;\\; i=1,\\dots,M, \\; j=1,\\dots,N, \\; \nc=1,\\dots,C \\; \\mbox{ --- demand constraint};\n\\label{mimo_demand_constraint} \\\\\n& & \\sum_{i=1}^M f_{ij} \\leq R_j, \\;\\; j=1,\\dots,N \\;\n\\mbox{ --- supply constraint};\n\\label{mimo_supply_constraint} \\\\\n& & \\frac{f_{ij}^c}{f_{ij}} =\n\\frac{S_{ij}^c}{S_{ij}}, \\;\\; i = 1,\\dots,M,\\;\nj=1,\\dots,N, c=1,\\dots,C \\;\\; \\mbox{ --- proportionality constraint}\\nonumber \\\\\n& & \\mbox{for commodity flows};\n\\label{mimo_proportionality_constraint}\\\\\n& & \\left.\\begin{array}{cl}\n\\mbox{(a)} &\n\\mbox{For each input link $i$, such that } \\\\\n& \\sum_{j=1}^N f_{ij} <  S_i, \\;\\; W_i\\neq\\emptyset; \\\\\n\\mbox{(b)} &\n\\mbox{For each input link $i$, such that $W_i\\neq\\emptyset$,} \\\\\n& f_{ij} \\geq \\frac{p_{ij}}{\\sum_{i'=1}^M p_{i'j}} R_j,\n\\;\\; \\forall j\\in W_i.\n\\end{array}\\right\\} \\mbox{ --- priority constraint};\n\\label{mimo_priority_constraint}\\\\\n& & f_{ij} \\leq S_{ij} - {\\cal A}\\left(\\bigcup_{j'\\in W_i\\setminus\\{j\\}}{\\cal Q}_{j'j}^i \\right),\n\\;\\; i=1,\\dots,M, \\; j=1,\\dots,N \\;\\;\n\\mbox{ --- relaxed FIFO} \\nonumber \\\\\n& & \\mbox{ constraint}.\n\\label{mimo_rfifo_constraint}\n\\end{eqnarray}\nConstraint~\\eqref{mimo_priority_constraint} generalizes the\nMISO priority constraint~\\eqref{miso_priority_constraint}.\nFor each output link $j$, $j=1,\\dots,N$, \nflows $\\sum_{c=1}^C f_{ij}^c$ fall into two categories:\n(1) restricted by \\emph{this} output link; and\n(2) not restricted by \\emph{this} output link.\nCondition~\\eqref{mimo_priority_constraint}(a) states that \nif the flow from an input $i$ is supply-constrained, there\ndo exist output links $j$, such that flows $f_{ij}$\nare of category~1;\nand for a given output $j$, input-output flows of category~1 are allocated\nproportionally to their priorities.\nFor every output link $j$, $j=1,\\dots,N$, \ncondition~\\eqref{mimo_priority_constraint}(b) ensures that\ninput-output flows of category~2 \ndo not take up more output supply than was allocated for them when category 1\nis non-empty.\nFor a SIMO ($M=1$) node, where there is no competition between input flows,\nconstraint~\\eqref{mimo_priority_constraint} is satisfied automatically.\n\nConstraint~\\eqref{mimo_rfifo_constraint} generalizes the SIMO\nrelaxed FIFO constraint~\\eqref{simo_rfifo_constraint}.\nHere,\n\n", "index": 53, "text": "\\begin{equation}\n\t{\\cal Q}_{j'j}^i = {\\bm{\\eta}}_{j'j}\\times \\left[\\frac{f_{ij'}}{S_{ij'}}S_{ij}, S_{ij}\\right], \\label{eq-rectangle-q-mimo}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E18.m1\" class=\"ltx_Math\" alttext=\"{\\cal Q}_{j^{\\prime}j}^{i}={\\bm{\\eta}}_{j^{\\prime}j}\\times\\left[\\frac{f_{ij^{%&#10;\\prime}}}{S_{ij^{\\prime}}}S_{ij},S_{ij}\\right],\" display=\"block\"><mrow><mrow><msubsup><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcac</mi><mrow><msup><mi>j</mi><mo>\u2032</mo></msup><mo>\u2062</mo><mi>j</mi></mrow><mi>i</mi></msubsup><mo>=</mo><mrow><msub><mi>\ud835\udf3c</mi><mrow><msup><mi>j</mi><mo>\u2032</mo></msup><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u00d7</mo><mrow><mo>[</mo><mrow><mfrac><msub><mi>f</mi><mrow><mi>i</mi><mo>\u2062</mo><msup><mi>j</mi><mo>\u2032</mo></msup></mrow></msub><msub><mi>S</mi><mrow><mi>i</mi><mo>\u2062</mo><msup><mi>j</mi><mo>\u2032</mo></msup></mrow></msub></mfrac><mo>\u2062</mo><msub><mi>S</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub></mrow><mo>,</mo><msub><mi>S</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>]</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nand, since we are solving the flow maximization problem,\n\\eqref{mimo_fifo_constraint} can be replaced with the equality constraint:\n\n", "itemtype": "equation", "pos": 55014, "prevtext": "\nwhich is a generalization of~\\eqref{eq-rectangle-q-simo}, and ${\\cal A}(\\cdot)$ denotes the area\nof a two-dimensional object.\nFor MIMO nodes with full FIFO, constraint~\\eqref{mimo_rfifo_constraint}\ntogether with the supply constraint~\\eqref{mimo_supply_constraint}\ntranslates to:\n\n", "index": 55, "text": "\\begin{equation}\nf_{ij}\\leq\\min_{j'\\in W_i}\\left\\{\\frac{f_{ij'}}{S_{ij'}}\\right\\}S_{ij},\n\\label{mimo_fifo_constraint}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E19.m1\" class=\"ltx_Math\" alttext=\"f_{ij}\\leq\\min_{j^{\\prime}\\in W_{i}}\\left\\{\\frac{f_{ij^{\\prime}}}{S_{ij^{%&#10;\\prime}}}\\right\\}S_{ij},\" display=\"block\"><mrow><mrow><msub><mi>f</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2264</mo><mrow><mrow><munder><mi>min</mi><mrow><msup><mi>j</mi><mo>\u2032</mo></msup><mo>\u2208</mo><msub><mi>W</mi><mi>i</mi></msub></mrow></munder><mo>\u2061</mo><mrow><mo>{</mo><mfrac><msub><mi>f</mi><mrow><mi>i</mi><mo>\u2062</mo><msup><mi>j</mi><mo>\u2032</mo></msup></mrow></msub><msub><mi>S</mi><mrow><mi>i</mi><mo>\u2062</mo><msup><mi>j</mi><mo>\u2032</mo></msup></mrow></msub></mfrac><mo>}</mo></mrow></mrow><mo>\u2062</mo><msub><mi>S</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nFor MIMO nodes with no FIFO and for MISO ($N=1$) nodes,\n${\\cal A}\\left(\\bigcup_{j'\\in W_i\\setminus\\{j\\}}{\\cal Q}_{j'j}^i\\right) = 0$,\nand thus, constraint~\\eqref{mimo_rfifo_constraint} degenerates into the\ndemand constraint.\n\n\nNext, we present the algorithm that solves the flow maximization \nproblem~\\eqref{mimo_objective}-\\eqref{mimo_rfifo_constraint}\n\\begin{enumerate}\n\\item Initialize:\n\\begin{eqnarray*}\n{\\tilde{R}}_j(0) & := & R; \\\\\nU_j(0) & := & U_j; \\\\\n{\\tilde{S}}_{ij}^c(0) & := & S_{ij}^c; \\\\\n{\\tilde{S}}_{ij}(0) & := & \\sum_{c=1}^C {\\tilde{S}}_{ij}^c(0);\\\\\n{\\tilde{\\bm{\\eta}}}_j^i(0) & := & [0, 0]; \\\\\nk & := & 0; \\\\\n& & i = 1,\\dots,M, \\;\\;\\; j = 1,\\dots,N, \\;\\;\\; c = 1,\\dots,C.\n\\end{eqnarray*}\n\n\\item Define the set of output links that still need processing:\n", "itemtype": "equation", "pos": 55279, "prevtext": "\nand, since we are solving the flow maximization problem,\n\\eqref{mimo_fifo_constraint} can be replaced with the equality constraint:\n\n", "index": 57, "text": "\\begin{equation}\nf_{ij}=\\min_{j^\\ast\\in W_i}\\frac{f_{ij^\\ast}}{S_{ij^\\ast}}S_{ij}.\n\\label{mimo_fifo_constraint2}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E20.m1\" class=\"ltx_Math\" alttext=\"f_{ij}=\\min_{j^{\\ast}\\in W_{i}}\\frac{f_{ij^{\\ast}}}{S_{ij^{\\ast}}}S_{ij}.\" display=\"block\"><mrow><mrow><msub><mi>f</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>=</mo><mrow><munder><mi>min</mi><mrow><msup><mi>j</mi><mo>\u2217</mo></msup><mo>\u2208</mo><msub><mi>W</mi><mi>i</mi></msub></mrow></munder><mo>\u2061</mo><mrow><mfrac><msub><mi>f</mi><mrow><mi>i</mi><mo>\u2062</mo><msup><mi>j</mi><mo>\u2217</mo></msup></mrow></msub><msub><mi>S</mi><mrow><mi>i</mi><mo>\u2062</mo><msup><mi>j</mi><mo>\u2217</mo></msup></mrow></msub></mfrac><mo>\u2062</mo><msub><mi>S</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nIf $V(k) = \\emptyset$, stop.\n\n\\item Check that at least one of the unprocessed input links has\nnonzero priority, otherwise, assign equal positive priorities\nto all the unprocessed input links:\n\n", "itemtype": "equation", "pos": 56178, "prevtext": "\nFor MIMO nodes with no FIFO and for MISO ($N=1$) nodes,\n${\\cal A}\\left(\\bigcup_{j'\\in W_i\\setminus\\{j\\}}{\\cal Q}_{j'j}^i\\right) = 0$,\nand thus, constraint~\\eqref{mimo_rfifo_constraint} degenerates into the\ndemand constraint.\n\n\nNext, we present the algorithm that solves the flow maximization \nproblem~\\eqref{mimo_objective}-\\eqref{mimo_rfifo_constraint}\n\\begin{enumerate}\n\\item Initialize:\n\\begin{eqnarray*}\n{\\tilde{R}}_j(0) & := & R; \\\\\nU_j(0) & := & U_j; \\\\\n{\\tilde{S}}_{ij}^c(0) & := & S_{ij}^c; \\\\\n{\\tilde{S}}_{ij}(0) & := & \\sum_{c=1}^C {\\tilde{S}}_{ij}^c(0);\\\\\n{\\tilde{\\bm{\\eta}}}_j^i(0) & := & [0, 0]; \\\\\nk & := & 0; \\\\\n& & i = 1,\\dots,M, \\;\\;\\; j = 1,\\dots,N, \\;\\;\\; c = 1,\\dots,C.\n\\end{eqnarray*}\n\n\\item Define the set of output links that still need processing:\n", "index": 59, "text": "\n\\[ V(k) = \\left\\{j: \\; U_j(k) \\neq \\emptyset\\right\\}. \\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex10.m1\" class=\"ltx_Math\" alttext=\"V(k)=\\left\\{j:\\;U_{j}(k)\\neq\\emptyset\\right\\}.\" display=\"block\"><mrow><mrow><mrow><mi>V</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo>{</mo><mi>j</mi><mo rspace=\"5.3pt\">:</mo><mrow><mrow><msub><mi>U</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2260</mo><mi mathvariant=\"normal\">\u2205</mi></mrow><mo>}</mo></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nwhere $\\left|\\bigcup_{j\\in V(k)} U_j(k)\\right|$ denotes the number\nof elements in the union $\\bigcup_{j\\in V(k)} U_j(k)$;\nand for each output link $j\\in V(k)$ and input link $i\\in U_j(k)$\ncompute oriented priority:\n\n", "itemtype": "equation", "pos": 56429, "prevtext": "\nIf $V(k) = \\emptyset$, stop.\n\n\\item Check that at least one of the unprocessed input links has\nnonzero priority, otherwise, assign equal positive priorities\nto all the unprocessed input links:\n\n", "index": 61, "text": "\\begin{equation}\n{\\tilde{p}}_i(k) = \\left\\{\\begin{array}{ll}\np_i, &\n\\mbox{ if there exists } i' \\in \\bigcup_{j\\in V(k)} U_j(k):\\;\np_{i'} > 0, \\\\\n\\frac{1}{\\left|\\bigcup_{j\\in V(k)}U_j(k)\\right|}, &\n\\mbox{ otherwise},\n\\end{array}\\right.\n\\label{eq_nonzero_priorities}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E21.m1\" class=\"ltx_Math\" alttext=\"{\\tilde{p}}_{i}(k)=\\left\\{\\begin{array}[]{ll}p_{i},&amp;\\mbox{ if there exists }i^%&#10;{\\prime}\\in\\bigcup_{j\\in V(k)}U_{j}(k):\\;p_{i^{\\prime}}&gt;0,\\\\&#10;\\frac{1}{\\left|\\bigcup_{j\\in V(k)}U_{j}(k)\\right|},&amp;\\mbox{ otherwise},\\end{%&#10;array}\\right.\" display=\"block\"><mrow><mrow><msub><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">~</mo></mover><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo>{</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><msub><mi>p</mi><mi>i</mi></msub><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mrow><mrow><mtext>\u00a0if there exists\u00a0</mtext><mo>\u2062</mo><msup><mi>i</mi><mo>\u2032</mo></msup></mrow><mo>\u2208</mo><mrow><munder><mo largeop=\"true\" mathsize=\"160%\" movablelimits=\"false\" stretchy=\"false\" symmetric=\"true\">\u22c3</mo><mrow><mi>j</mi><mo>\u2208</mo><mrow><mi>V</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></munder><mrow><msub><mi>U</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo rspace=\"5.3pt\">:</mo><mrow><msub><mi>p</mi><msup><mi>i</mi><mo>\u2032</mo></msup></msub><mo>&gt;</mo><mn>0</mn></mrow></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mrow><mfrac><mn>1</mn><mrow><mo>|</mo><mrow><msub><mo largeop=\"true\" mathsize=\"160%\" stretchy=\"false\" symmetric=\"true\">\u22c3</mo><mrow><mi>j</mi><mo>\u2208</mo><mrow><mi>V</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></msub><mrow><msub><mi>U</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>|</mo></mrow></mfrac><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mtext>\u00a0otherwise</mtext><mo>,</mo></mrow></mtd></mtr></mtable><mi/></mrow></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\n\n\\item For each $j\\in V(k)$, compute factors:\n\n", "itemtype": "equation", "pos": 56924, "prevtext": "\nwhere $\\left|\\bigcup_{j\\in V(k)} U_j(k)\\right|$ denotes the number\nof elements in the union $\\bigcup_{j\\in V(k)} U_j(k)$;\nand for each output link $j\\in V(k)$ and input link $i\\in U_j(k)$\ncompute oriented priority:\n\n", "index": 63, "text": "\\begin{equation}\n{\\tilde{p}}_{ij}(k) = {\\tilde{p}}_i(k) \\frac{\\sum_{c=1}^C S_{ij}^c}{\\sum_{c=1}^C S_i^c}.\n\\label{eq_oriented_priorities}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E22.m1\" class=\"ltx_Math\" alttext=\"{\\tilde{p}}_{ij}(k)={\\tilde{p}}_{i}(k)\\frac{\\sum_{c=1}^{C}S_{ij}^{c}}{\\sum_{c=%&#10;1}^{C}S_{i}^{c}}.\" display=\"block\"><mrow><mrow><mrow><msub><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">~</mo></mover><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><msub><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">~</mo></mover><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mfrac><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></msubsup><msubsup><mi>S</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow><mi>c</mi></msubsup></mrow><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></msubsup><msubsup><mi>S</mi><mi>i</mi><mi>c</mi></msubsup></mrow></mfrac></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nand find the smallest of these factors:\n\n", "itemtype": "equation", "pos": 57122, "prevtext": "\n\n\\item For each $j\\in V(k)$, compute factors:\n\n", "index": 65, "text": "\\begin{equation}\na_j(k) = \\frac{{\\tilde{R}}_j(k)}{\\sum_{i\\in U_j(k)}{\\tilde{p}}_{ij}(k)},\n\\label{eq_aj_factors}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E23.m1\" class=\"ltx_Math\" alttext=\"a_{j}(k)=\\frac{{\\tilde{R}}_{j}(k)}{\\sum_{i\\in U_{j}(k)}{\\tilde{p}}_{ij}(k)},\" display=\"block\"><mrow><mrow><mrow><msub><mi>a</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mfrac><mrow><msub><mover accent=\"true\"><mi>R</mi><mo stretchy=\"false\">~</mo></mover><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>\u2208</mo><mrow><msub><mi>U</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></msub><mrow><msub><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">~</mo></mover><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mfrac></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nThe link $j^\\ast$ has the most restricted supply of\nall output links.\n\n\\item Define the set of input links,\nwhose demand does not exceed the allocated supply:\n", "itemtype": "equation", "pos": 57289, "prevtext": "\nand find the smallest of these factors:\n\n", "index": 67, "text": "\\begin{equation}\na_{j^\\ast}(k) = \\min_{j\\in V(k)} a_j(k).\n\\label{eq_aj_min}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E24.m1\" class=\"ltx_Math\" alttext=\"a_{j^{\\ast}}(k)=\\min_{j\\in V(k)}a_{j}(k).\" display=\"block\"><mrow><mrow><mrow><msub><mi>a</mi><msup><mi>j</mi><mo>\u2217</mo></msup></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><munder><mi>min</mi><mrow><mi>j</mi><mo>\u2208</mo><mrow><mi>V</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></munder><mo>\u2061</mo><msub><mi>a</mi><mi>j</mi></msub></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\n\\begin{itemize}\n\\item If ${\\tilde{U}}(k) \\neq \\emptyset$, then for all output links $j\\in V(k)$ assign:\n\\begin{eqnarray}\nf_{ij}^c & = & {\\tilde{S}}_{ij}^c(k), \\;\\;\\; i\\in{\\tilde{U}}(k),\\;\\; c=1,\\dots,C; \\label{eq_mimo_relaxed_freeflow} \\\\\n{\\tilde{R}}_j(k+1) & = & {\\tilde{R}}_j(k) - \\sum_{i\\in{\\tilde{U}}(k)} f_{ij}; \\nonumber \\\\\nU_j(k+1) & = & U_j(k) \\setminus {\\tilde{U}}(k).  \\nonumber\n\\end{eqnarray}\n\\item Else, for all input links $i\\in U_{j^\\ast}(k)$,\noutput links $j\\in V(k)$ and commodities $c=1,\\dots,C$, assign:\n\\begin{eqnarray}\n{\\tilde{S}}_{ij^\\ast}^c(k+1) & = & {\\tilde{S}}_{ij^\\ast}^c(k)\n\\frac{{\\tilde{p}}_{ij^\\ast}(k)a_{j^\\ast}(k)}{{\\tilde{S}}_{ij^\\ast}(k)},\n\\;\\;\\; c=1,\\dots,C;\n\\label{eq_mimo_relaxed_step5_1} \\\\\n{\\tilde{S}}_{ij}^c(k+1) & = & {\\tilde{S}}_{ij}^c(k)\\frac{{\\tilde{S}}_{ij}(k+1)}{{\\tilde{S}}_{ij}(k)},\n\\;\\; i\\in U_j(k)\\cap U_{j^\\ast}(k), \\;\\; j\\in V(k)\\setminus\\{j^\\ast\\},\n\\label{eq_mimo_relaxed_step5_2} \\\\\n\\mbox{ where} & & \\nonumber \\\\\n{\\tilde{S}}_{ij}(k+1) & = & {\\tilde{S}}_{ij}(k) -\nS_{ij}\\left(|{\\bm{\\eta}}_{j^\\ast j}^i| - |{\\tilde{\\bm{\\eta}}}_j^i(k)\\cap{\\bm{\\eta}}_{j^\\ast j}^i| \\right)\n\\left( 1 - \\frac{\\sum_{c=1}^C {\\tilde{S}}_{ij^\\ast}^c(k+1)}{S_{ij^\\ast}} \\right);\n\\label{eq_mimo_relaxed_step5_3} \\\\\n{\\tilde{S}}_{ij}^c(k+1) & = & {\\tilde{S}}_{ij}^c(k), \\;\\;\\;\ni \\not\\in U_j(k)\\cap U_{j^\\ast}(k);\\nonumber \\\\\n{\\tilde{\\bm{\\eta}}}_j^i(k+1) & = & {\\tilde{\\bm{\\eta}}}_j^i(k) \\cup {\\bm{\\eta}}_{j^\\ast j}^i; \\nonumber \\\\\nf_{ij}^c & = & {\\tilde{S}}_{ij}^c(k+1), \\nonumber \\\\\n& & i\\in U_j(k)\\cap U_{j^\\ast}(k), \\; j\\in V(k): \\;\n{\\tilde{\\bm{\\eta}}}_j^i(k+1)=[0,1], \\; c=1,\\dots,C;\n\\label{eq_mimo_relaxed_step5_4} \\\\\n{\\tilde{R}}_j(k+1) & = & {\\tilde{R}}_j(k) -\n\\sum_{i\\in U_{j^\\ast}(k):{\\bm{\\eta}}_j^i(k+1)=[0,1]} \\; f_{ij}; \\nonumber\\\\\nU_j(k+1) & = & U_j(k) \\setminus \\left\\{i\\in U_{j^\\ast}(k):\\;\n{\\tilde{\\bm{\\eta}}}_j^i(k+1)=[0,1]\\right\\}. \\nonumber\n\\end{eqnarray}\n\\end{itemize}\n\n\\item Set $k:=k+1$, and return to step 2.\n\\end{enumerate}\n\nThis algorithm takes no more than $(M+N-2)$ iterations to complete.\n\nThe following lemma states that in the case of $N=1$,\nthe MIMO algorithm produces exactly the same result as the MISO\nalgorithm described in Section \\ref{subsec_miso}.\n\\begin{lemma}\nThe MISO algorithm is a special case of the MIMO algorithm with $N=1$.\n\\label{lemma_mimo}\n\\end{lemma}\n\\begin{proof}\nThe proof follows from the fact that for $N=1$,\nformulae (\\ref{eq_aj_factors})-(\\ref{eq_aj_min}) result in\n$a_{j^\\ast}(k) = a_1(k)=\\frac{{\\tilde{R}}_{1}(k)}{\\sum_{i\\in U_1(k)}{\\tilde{p}}_i(k)}$ and $j^\\ast = 1$.\n\\end{proof}\n\nThe following lemma states that in the case $M=1$, the MIMO algorithm\nwith relaxed FIFO condition produces exactly the same result as the \nSIMO algorithm with relaxed FIFO condition described in\nSection~\\ref{subsec_simo}.\n\\begin{lemma}\nThe SIMO algorithm with relaxed FIFO condition is a special case of the MIMO\nalgorithm with $M=1$.\n\\label{lemma_mimo_simo}\n\\end{lemma}\n\\begin{proof}\nThe proof follows from the fact that\nfor $M=1$, factors $a_j(k)$, defined in~\\eqref{eq_aj_factors}, reduce to:\n", "itemtype": "equation", "pos": 57538, "prevtext": "\nThe link $j^\\ast$ has the most restricted supply of\nall output links.\n\n\\item Define the set of input links,\nwhose demand does not exceed the allocated supply:\n", "index": 69, "text": "\n\\[\n{\\tilde{U}}(k) = \\left\\{i\\in U_{j^\\ast}(k):\\;\n\\left( \\sum_{j\\in V(k)} {\\tilde{S}}_{ij}(k) \\right) \\leq {\\tilde{p}}_i(k)a_{j^\\ast}(k)\\right\\}.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex11.m1\" class=\"ltx_Math\" alttext=\"{\\tilde{U}}(k)=\\left\\{i\\in U_{j^{\\ast}}(k):\\;\\left(\\sum_{j\\in V(k)}{\\tilde{S}}%&#10;_{ij}(k)\\right)\\leq{\\tilde{p}}_{i}(k)a_{j^{\\ast}}(k)\\right\\}.\" display=\"block\"><mrow><mrow><mrow><mover accent=\"true\"><mi>U</mi><mo stretchy=\"false\">~</mo></mover><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo>{</mo><mrow><mi>i</mi><mo>\u2208</mo><mrow><msub><mi>U</mi><msup><mi>j</mi><mo>\u2217</mo></msup></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo rspace=\"5.3pt\">:</mo><mrow><mrow><mo>(</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>j</mi><mo>\u2208</mo><mrow><mi>V</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></munder><mrow><msub><mover accent=\"true\"><mi>S</mi><mo stretchy=\"false\">~</mo></mover><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>)</mo></mrow><mo>\u2264</mo><mrow><msub><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">~</mo></mover><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>a</mi><msup><mi>j</mi><mo>\u2217</mo></msup></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>}</mo></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nand\n", "itemtype": "equation", "pos": 60744, "prevtext": "\n\\begin{itemize}\n\\item If ${\\tilde{U}}(k) \\neq \\emptyset$, then for all output links $j\\in V(k)$ assign:\n\\begin{eqnarray}\nf_{ij}^c & = & {\\tilde{S}}_{ij}^c(k), \\;\\;\\; i\\in{\\tilde{U}}(k),\\;\\; c=1,\\dots,C; \\label{eq_mimo_relaxed_freeflow} \\\\\n{\\tilde{R}}_j(k+1) & = & {\\tilde{R}}_j(k) - \\sum_{i\\in{\\tilde{U}}(k)} f_{ij}; \\nonumber \\\\\nU_j(k+1) & = & U_j(k) \\setminus {\\tilde{U}}(k).  \\nonumber\n\\end{eqnarray}\n\\item Else, for all input links $i\\in U_{j^\\ast}(k)$,\noutput links $j\\in V(k)$ and commodities $c=1,\\dots,C$, assign:\n\\begin{eqnarray}\n{\\tilde{S}}_{ij^\\ast}^c(k+1) & = & {\\tilde{S}}_{ij^\\ast}^c(k)\n\\frac{{\\tilde{p}}_{ij^\\ast}(k)a_{j^\\ast}(k)}{{\\tilde{S}}_{ij^\\ast}(k)},\n\\;\\;\\; c=1,\\dots,C;\n\\label{eq_mimo_relaxed_step5_1} \\\\\n{\\tilde{S}}_{ij}^c(k+1) & = & {\\tilde{S}}_{ij}^c(k)\\frac{{\\tilde{S}}_{ij}(k+1)}{{\\tilde{S}}_{ij}(k)},\n\\;\\; i\\in U_j(k)\\cap U_{j^\\ast}(k), \\;\\; j\\in V(k)\\setminus\\{j^\\ast\\},\n\\label{eq_mimo_relaxed_step5_2} \\\\\n\\mbox{ where} & & \\nonumber \\\\\n{\\tilde{S}}_{ij}(k+1) & = & {\\tilde{S}}_{ij}(k) -\nS_{ij}\\left(|{\\bm{\\eta}}_{j^\\ast j}^i| - |{\\tilde{\\bm{\\eta}}}_j^i(k)\\cap{\\bm{\\eta}}_{j^\\ast j}^i| \\right)\n\\left( 1 - \\frac{\\sum_{c=1}^C {\\tilde{S}}_{ij^\\ast}^c(k+1)}{S_{ij^\\ast}} \\right);\n\\label{eq_mimo_relaxed_step5_3} \\\\\n{\\tilde{S}}_{ij}^c(k+1) & = & {\\tilde{S}}_{ij}^c(k), \\;\\;\\;\ni \\not\\in U_j(k)\\cap U_{j^\\ast}(k);\\nonumber \\\\\n{\\tilde{\\bm{\\eta}}}_j^i(k+1) & = & {\\tilde{\\bm{\\eta}}}_j^i(k) \\cup {\\bm{\\eta}}_{j^\\ast j}^i; \\nonumber \\\\\nf_{ij}^c & = & {\\tilde{S}}_{ij}^c(k+1), \\nonumber \\\\\n& & i\\in U_j(k)\\cap U_{j^\\ast}(k), \\; j\\in V(k): \\;\n{\\tilde{\\bm{\\eta}}}_j^i(k+1)=[0,1], \\; c=1,\\dots,C;\n\\label{eq_mimo_relaxed_step5_4} \\\\\n{\\tilde{R}}_j(k+1) & = & {\\tilde{R}}_j(k) -\n\\sum_{i\\in U_{j^\\ast}(k):{\\bm{\\eta}}_j^i(k+1)=[0,1]} \\; f_{ij}; \\nonumber\\\\\nU_j(k+1) & = & U_j(k) \\setminus \\left\\{i\\in U_{j^\\ast}(k):\\;\n{\\tilde{\\bm{\\eta}}}_j^i(k+1)=[0,1]\\right\\}. \\nonumber\n\\end{eqnarray}\n\\end{itemize}\n\n\\item Set $k:=k+1$, and return to step 2.\n\\end{enumerate}\n\nThis algorithm takes no more than $(M+N-2)$ iterations to complete.\n\nThe following lemma states that in the case of $N=1$,\nthe MIMO algorithm produces exactly the same result as the MISO\nalgorithm described in Section \\ref{subsec_miso}.\n\\begin{lemma}\nThe MISO algorithm is a special case of the MIMO algorithm with $N=1$.\n\\label{lemma_mimo}\n\\end{lemma}\n\\begin{proof}\nThe proof follows from the fact that for $N=1$,\nformulae (\\ref{eq_aj_factors})-(\\ref{eq_aj_min}) result in\n$a_{j^\\ast}(k) = a_1(k)=\\frac{{\\tilde{R}}_{1}(k)}{\\sum_{i\\in U_1(k)}{\\tilde{p}}_i(k)}$ and $j^\\ast = 1$.\n\\end{proof}\n\nThe following lemma states that in the case $M=1$, the MIMO algorithm\nwith relaxed FIFO condition produces exactly the same result as the \nSIMO algorithm with relaxed FIFO condition described in\nSection~\\ref{subsec_simo}.\n\\begin{lemma}\nThe SIMO algorithm with relaxed FIFO condition is a special case of the MIMO\nalgorithm with $M=1$.\n\\label{lemma_mimo_simo}\n\\end{lemma}\n\\begin{proof}\nThe proof follows from the fact that\nfor $M=1$, factors $a_j(k)$, defined in~\\eqref{eq_aj_factors}, reduce to:\n", "index": 71, "text": "\n\\[\na_j(k) = \\frac{R_j {\\tilde{S}}_1(k)}{{\\tilde{S}}_{1j}(k)},\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex12.m1\" class=\"ltx_Math\" alttext=\"a_{j}(k)=\\frac{R_{j}{\\tilde{S}}_{1}(k)}{{\\tilde{S}}_{1j}(k)},\" display=\"block\"><mrow><mrow><mrow><msub><mi>a</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mfrac><mrow><msub><mi>R</mi><mi>j</mi></msub><mo>\u2062</mo><msub><mover accent=\"true\"><mi>S</mi><mo stretchy=\"false\">~</mo></mover><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msub><mover accent=\"true\"><mi>S</mi><mo stretchy=\"false\">~</mo></mover><mrow><mn>1</mn><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\n\\end{proof}\n\nThe main result of this Section can be stated as the following theorem.\n\\begin{theo}\n  Given a set of input links $i \\in 1,\\dots,M$, output links $j \\in 1,\\dots,N$,\n  commodities $c \\in 1,\\dots,C$, priorities $p_i$, split ratios $\\beta_i$, and\n  mutual restriction coefficients $\\{ \\eta_{j,j'}^i \\}$, the \n  algorithm of Section~\\ref{subsec_mimo_relaxed} obtains the\n  unique solution of the optimization \n  problem~\\eqref{mimo_objective}-\\eqref{mimo_rfifo_constraint}.\n\\label{theo_mimo_relaxed_optimal}\n\\end{theo}\n\\begin{proof}\n  The priority constraint~\\eqref{mimo_priority_constraint}\n  makes this optimization problem non-convex, except in the\n  special cases mentioned in Section~\\ref{subsec_miso}.\n  In fact, we conjecture that\n  in the MIMO case, both with and without relaxation of the FIFO constraint,\n  there is no way to verify a solution faster than re-solving the\n  problem~\\eqref{mimo_objective}-\\eqref{mimo_rfifo_constraint}.\n  Thus, we will prove optimality\n  by showing that as our algorithm proceeds through iterations, it\n  constructs the unique optimal solution.\n   \n  We may decompose the problem into finding the $M \\cdot N \\cdot C$ interrelated quantities\n  $\\{f_{ij}^c\\}$. The $C$ flows for each $(i,j)$ are further constrained by our\n  commodity flow proportionality constraint~\\eqref{mimo_proportionality_constraint};\n  solving for one of $\\{f_{ij}^1,\\dots,f_{ij}^C\\}$ also finds them all. Our\n  task then becomes finding optimal values for each of $M \\cdot N$ subsets\n  $\\{f_{ij}^1,\\dots,f_{ij}^C\\}$. Our algorithm finds at least one of these $M \\cdot N$\n  subsets per iteration $k$. The assignments\n  are done by either equation~\\eqref{eq_mimo_relaxed_freeflow} or\n  equation~\\eqref{eq_mimo_relaxed_step5_4}.\n  Over iterations, subsets are assigned to build up the unique optimum solution.\n  We can show that each subset assigned is optimal; that is, at least one of the\n  constraints is tight.\n  \n  Consider formulae~\\eqref{eq_mimo_relaxed_step5_3}-\\eqref{eq_mimo_relaxed_step5_4},\n  our implementation of the relaxed FIFO constraint. In step 5 of our algorithm,\n  we identify a single output link as $j^\\ast$. The minimization in this step picks\n  out a single link as the most restrictive of all output links. By the relaxed\n  FIFO construction, all $i\\in U_{j^\\ast}$ will feel a relaxed FIFO effect\n  instigated by $j^\\ast$ as the most restrictive link. For a generic\n  $j \\neq j^\\ast$, equation~\\eqref{eq_mimo_relaxed_step5_3} enforces the\n  relaxed FIFO constraint by decaying the oriented demand ${\\tilde{S}}_{ij}$. In fact, this\n  modified oriented\n  demand acts as a proxy for the relaxed FIFO constraint. Since a $f_{ij}^c$ that\n  is restricted by relaxed FIFO will, by construction, never obtain $f_{ij}^c=S_{ij}^c$,\n  the running quantity ${\\tilde{S}}_{ij}^c(k)$ represents an ``effective'' oriented demand\n  after application of relaxed FIFO. A flow that is not constrained by relaxed FIFO\n  will nevertheless not exceed its demand, as ${\\tilde{S}}_{ij}^c(0) = S_{ij}^c$, and ${\\tilde{S}}_{ij}^c(k)$\n  only decreases across $k$ as relaxed FIFO constraints are considered\n  (ensuring compliance with the demand constraint~\\eqref{mimo_demand_constraint}).\n  On the other hand, if it turns out that a flow is found\n  $f_{ij}^c={\\tilde{S}}_{ij}^c(k) \\leq S_{ij}^c$ for some $k$, then this flow value may have an\n  some constraint imposed by relaxed FIFO.\n\n  Flows assigned by equation~\\eqref{eq_mimo_relaxed_step5_4} for $j \\neq j^\\ast$ are\n  constrained by a relaxed FIFO constraint~\\eqref{mimo_rfifo_constraint}. To see this,\n  note that\n  \n", "itemtype": "equation", "pos": 60813, "prevtext": "\nand\n", "index": 73, "text": "\n\\[\nj^\\ast = \\arg\\min_{j\\in V(k)}\n\\frac{R_j {\\tilde{S}}_1(k)}{{\\tilde{S}}_{1j}(k)}\n= \\arg\\min_{j\\in V(k)}\\frac{R_j}{{\\tilde{S}}_{1j}(k)}.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex13.m1\" class=\"ltx_Math\" alttext=\"j^{\\ast}=\\arg\\min_{j\\in V(k)}\\frac{R_{j}{\\tilde{S}}_{1}(k)}{{\\tilde{S}}_{1j}(k%&#10;)}=\\arg\\min_{j\\in V(k)}\\frac{R_{j}}{{\\tilde{S}}_{1j}(k)}.\" display=\"block\"><mrow><mrow><msup><mi>j</mi><mo>\u2217</mo></msup><mo>=</mo><mrow><mi>arg</mi><mo>\u2061</mo><mrow><munder><mi>min</mi><mrow><mi>j</mi><mo>\u2208</mo><mrow><mi>V</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></munder><mo>\u2061</mo><mfrac><mrow><msub><mi>R</mi><mi>j</mi></msub><mo>\u2062</mo><msub><mover accent=\"true\"><mi>S</mi><mo stretchy=\"false\">~</mo></mover><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msub><mover accent=\"true\"><mi>S</mi><mo stretchy=\"false\">~</mo></mover><mrow><mn>1</mn><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mrow></mrow><mo>=</mo><mrow><mi>arg</mi><mo>\u2061</mo><mrow><munder><mi>min</mi><mrow><mi>j</mi><mo>\u2208</mo><mrow><mi>V</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></munder><mo>\u2061</mo><mfrac><msub><mi>R</mi><mi>j</mi></msub><mrow><msub><mover accent=\"true\"><mi>S</mi><mo stretchy=\"false\">~</mo></mover><mrow><mn>1</mn><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\n  where, recall, ${\\cal Q}_{j'j}^i$ is defined by~\\eqref{eq-rectangle-q-mimo}. As applied in\n  \\eqref{eq_mimo_relaxed_step5_3}, $j'=j^\\ast$ always, and\n  $f_{ij^\\ast}^c = {\\tilde{S}}_{ij^\\ast}^c$ by~\\eqref{eq_mimo_relaxed_step5_4}.\n  \n  For a union of two rectangles ${\\cal Q}_{j'j}^i$ and ${\\cal Q}_{j''j}^i$, we have\n  \n", "itemtype": "equation", "pos": 64546, "prevtext": "\n\\end{proof}\n\nThe main result of this Section can be stated as the following theorem.\n\\begin{theo}\n  Given a set of input links $i \\in 1,\\dots,M$, output links $j \\in 1,\\dots,N$,\n  commodities $c \\in 1,\\dots,C$, priorities $p_i$, split ratios $\\beta_i$, and\n  mutual restriction coefficients $\\{ \\eta_{j,j'}^i \\}$, the \n  algorithm of Section~\\ref{subsec_mimo_relaxed} obtains the\n  unique solution of the optimization \n  problem~\\eqref{mimo_objective}-\\eqref{mimo_rfifo_constraint}.\n\\label{theo_mimo_relaxed_optimal}\n\\end{theo}\n\\begin{proof}\n  The priority constraint~\\eqref{mimo_priority_constraint}\n  makes this optimization problem non-convex, except in the\n  special cases mentioned in Section~\\ref{subsec_miso}.\n  In fact, we conjecture that\n  in the MIMO case, both with and without relaxation of the FIFO constraint,\n  there is no way to verify a solution faster than re-solving the\n  problem~\\eqref{mimo_objective}-\\eqref{mimo_rfifo_constraint}.\n  Thus, we will prove optimality\n  by showing that as our algorithm proceeds through iterations, it\n  constructs the unique optimal solution.\n   \n  We may decompose the problem into finding the $M \\cdot N \\cdot C$ interrelated quantities\n  $\\{f_{ij}^c\\}$. The $C$ flows for each $(i,j)$ are further constrained by our\n  commodity flow proportionality constraint~\\eqref{mimo_proportionality_constraint};\n  solving for one of $\\{f_{ij}^1,\\dots,f_{ij}^C\\}$ also finds them all. Our\n  task then becomes finding optimal values for each of $M \\cdot N$ subsets\n  $\\{f_{ij}^1,\\dots,f_{ij}^C\\}$. Our algorithm finds at least one of these $M \\cdot N$\n  subsets per iteration $k$. The assignments\n  are done by either equation~\\eqref{eq_mimo_relaxed_freeflow} or\n  equation~\\eqref{eq_mimo_relaxed_step5_4}.\n  Over iterations, subsets are assigned to build up the unique optimum solution.\n  We can show that each subset assigned is optimal; that is, at least one of the\n  constraints is tight.\n  \n  Consider formulae~\\eqref{eq_mimo_relaxed_step5_3}-\\eqref{eq_mimo_relaxed_step5_4},\n  our implementation of the relaxed FIFO constraint. In step 5 of our algorithm,\n  we identify a single output link as $j^\\ast$. The minimization in this step picks\n  out a single link as the most restrictive of all output links. By the relaxed\n  FIFO construction, all $i\\in U_{j^\\ast}$ will feel a relaxed FIFO effect\n  instigated by $j^\\ast$ as the most restrictive link. For a generic\n  $j \\neq j^\\ast$, equation~\\eqref{eq_mimo_relaxed_step5_3} enforces the\n  relaxed FIFO constraint by decaying the oriented demand ${\\tilde{S}}_{ij}$. In fact, this\n  modified oriented\n  demand acts as a proxy for the relaxed FIFO constraint. Since a $f_{ij}^c$ that\n  is restricted by relaxed FIFO will, by construction, never obtain $f_{ij}^c=S_{ij}^c$,\n  the running quantity ${\\tilde{S}}_{ij}^c(k)$ represents an ``effective'' oriented demand\n  after application of relaxed FIFO. A flow that is not constrained by relaxed FIFO\n  will nevertheless not exceed its demand, as ${\\tilde{S}}_{ij}^c(0) = S_{ij}^c$, and ${\\tilde{S}}_{ij}^c(k)$\n  only decreases across $k$ as relaxed FIFO constraints are considered\n  (ensuring compliance with the demand constraint~\\eqref{mimo_demand_constraint}).\n  On the other hand, if it turns out that a flow is found\n  $f_{ij}^c={\\tilde{S}}_{ij}^c(k) \\leq S_{ij}^c$ for some $k$, then this flow value may have an\n  some constraint imposed by relaxed FIFO.\n\n  Flows assigned by equation~\\eqref{eq_mimo_relaxed_step5_4} for $j \\neq j^\\ast$ are\n  constrained by a relaxed FIFO constraint~\\eqref{mimo_rfifo_constraint}. To see this,\n  note that\n  \n", "index": 75, "text": "\\begin{equation}\n  {\\cal A}( {\\cal Q}_{j'j}^i) = \\left| \\eta_{j'j}^i \\right| \\left( 1 - \\frac{\\sum_c f_{ij'}^c}{S_{ij'}} \\right) S_{ij}\n  \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E25.m1\" class=\"ltx_Math\" alttext=\"{\\cal A}({\\cal Q}_{j^{\\prime}j}^{i})=\\left|\\eta_{j^{\\prime}j}^{i}\\right|\\left(%&#10;1-\\frac{\\sum_{c}f_{ij^{\\prime}}^{c}}{S_{ij^{\\prime}}}\\right)S_{ij}\" display=\"block\"><mrow><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udc9c</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msubsup><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcac</mi><mrow><msup><mi>j</mi><mo>\u2032</mo></msup><mo>\u2062</mo><mi>j</mi></mrow><mi>i</mi></msubsup><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mo>|</mo><msubsup><mi>\u03b7</mi><mrow><msup><mi>j</mi><mo>\u2032</mo></msup><mo>\u2062</mo><mi>j</mi></mrow><mi>i</mi></msubsup><mo>|</mo></mrow><mo>\u2062</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><mfrac><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mi>c</mi></msub><msubsup><mi>f</mi><mrow><mi>i</mi><mo>\u2062</mo><msup><mi>j</mi><mo>\u2032</mo></msup></mrow><mi>c</mi></msubsup></mrow><msub><mi>S</mi><mrow><mi>i</mi><mo>\u2062</mo><msup><mi>j</mi><mo>\u2032</mo></msup></mrow></msub></mfrac></mrow><mo>)</mo></mrow><mo>\u2062</mo><msub><mi>S</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub></mrow></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\n  and\n  \n", "itemtype": "equation", "pos": 65020, "prevtext": "\n  where, recall, ${\\cal Q}_{j'j}^i$ is defined by~\\eqref{eq-rectangle-q-mimo}. As applied in\n  \\eqref{eq_mimo_relaxed_step5_3}, $j'=j^\\ast$ always, and\n  $f_{ij^\\ast}^c = {\\tilde{S}}_{ij^\\ast}^c$ by~\\eqref{eq_mimo_relaxed_step5_4}.\n  \n  For a union of two rectangles ${\\cal Q}_{j'j}^i$ and ${\\cal Q}_{j''j}^i$, we have\n  \n", "index": 77, "text": "\\begin{equation}\n\t  {\\cal A} \\left( {\\cal Q}_{j'j}^i \\cup {\\cal Q}_{j''j}^i \\right) = {\\cal A} \\left({\\cal Q}_{j'j}^i \\right)\n\t  + {\\cal A} \\left( {\\cal Q}_{j''j}^i \\right) - {\\cal A} \\left({\\cal Q}_{j'j}^i \\cap {\\cal Q}_{j''j}^i \\right)\n\t  \\label{eq-mimo-union}\n  \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E26.m1\" class=\"ltx_Math\" alttext=\"{\\cal A}\\left({\\cal Q}_{j^{\\prime}j}^{i}\\cup{\\cal Q}_{j^{\\prime\\prime}j}^{i}%&#10;\\right)={\\cal A}\\left({\\cal Q}_{j^{\\prime}j}^{i}\\right)+{\\cal A}\\left({\\cal Q}%&#10;_{j^{\\prime\\prime}j}^{i}\\right)-{\\cal A}\\left({\\cal Q}_{j^{\\prime}j}^{i}\\cap{%&#10;\\cal Q}_{j^{\\prime\\prime}j}^{i}\\right)\" display=\"block\"><mrow><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udc9c</mi><mo>\u2062</mo><mrow><mo>(</mo><mrow><msubsup><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcac</mi><mrow><msup><mi>j</mi><mo>\u2032</mo></msup><mo>\u2062</mo><mi>j</mi></mrow><mi>i</mi></msubsup><mo>\u222a</mo><msubsup><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcac</mi><mrow><msup><mi>j</mi><mi>\u2032\u2032</mi></msup><mo>\u2062</mo><mi>j</mi></mrow><mi>i</mi></msubsup></mrow><mo>)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udc9c</mi><mo>\u2062</mo><mrow><mo>(</mo><msubsup><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcac</mi><mrow><msup><mi>j</mi><mo>\u2032</mo></msup><mo>\u2062</mo><mi>j</mi></mrow><mi>i</mi></msubsup><mo>)</mo></mrow></mrow><mo>+</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udc9c</mi><mo>\u2062</mo><mrow><mo>(</mo><msubsup><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcac</mi><mrow><msup><mi>j</mi><mi>\u2032\u2032</mi></msup><mo>\u2062</mo><mi>j</mi></mrow><mi>i</mi></msubsup><mo>)</mo></mrow></mrow></mrow><mo>-</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udc9c</mi><mo>\u2062</mo><mrow><mo>(</mo><mrow><msubsup><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcac</mi><mrow><msup><mi>j</mi><mo>\u2032</mo></msup><mo>\u2062</mo><mi>j</mi></mrow><mi>i</mi></msubsup><mo>\u2229</mo><msubsup><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcac</mi><mrow><msup><mi>j</mi><mi>\u2032\u2032</mi></msup><mo>\u2062</mo><mi>j</mi></mrow><mi>i</mi></msubsup></mrow><mo>)</mo></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\n  Note that $j^\\sharp$ as defined in~\\eqref{eq-mimo-jsharp} is the less-restricted of the\n  two output links $j'$ and $j''$. This means that in the context of our algorithm, since\n  the most-restricted link $j^\\ast$ is picked at each iteration, subsequent links $j^\\ast$\n  at later iterations will always be less restricted then those in previous iterations.\n  Equation~\\eqref{eq_mimo_relaxed_step5_3} thus takes the union (with the subtraction\n  of the intersection) as done in \\eqref{eq-mimo-union}-\\eqref{eq-mimo-jsharp}, and\n  incorporates the relaxed FIFO constraint~\\eqref{mimo_rfifo_constraint}.\n  \n  Now consider equations~\\eqref{eq_mimo_relaxed_step5_1} and\n  \\eqref{eq_mimo_relaxed_step5_4}, which apply in the special case where $j=j^\\ast$.  have\n    \n", "itemtype": "equation", "pos": 65308, "prevtext": "\n  and\n  \n", "index": 79, "text": "\\begin{equation}\n\t  {\\cal A} \\left( {\\cal Q}_{j'j}^i \\cap {\\cal Q}_{j''j}^i \\right) = \\left( \\left| \\eta_{j'j}^i \\cap\n\t  \\eta_{j''j}^i \\right| \\right)\n\t  \\min_{j^\\sharp \\in \\{j',j''\\}} \\left( 1 - \\frac{\\sum_c f_{ij^\\sharp}^c}{S_{ij^\\sharp}} \\right) S_{ij}. \\label{eq-mimo-jsharp}\n  \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E27.m1\" class=\"ltx_Math\" alttext=\"{\\cal A}\\left({\\cal Q}_{j^{\\prime}j}^{i}\\cap{\\cal Q}_{j^{\\prime\\prime}j}^{i}%&#10;\\right)=\\left(\\left|\\eta_{j^{\\prime}j}^{i}\\cap\\eta_{j^{\\prime\\prime}j}^{i}%&#10;\\right|\\right)\\min_{j^{\\sharp}\\in\\{j^{\\prime},j^{\\prime\\prime}\\}}\\left(1-\\frac%&#10;{\\sum_{c}f_{ij^{\\sharp}}^{c}}{S_{ij^{\\sharp}}}\\right)S_{ij}.\" display=\"block\"><mrow><mrow><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udc9c</mi><mo>\u2062</mo><mrow><mo>(</mo><mrow><msubsup><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcac</mi><mrow><msup><mi>j</mi><mo>\u2032</mo></msup><mo>\u2062</mo><mi>j</mi></mrow><mi>i</mi></msubsup><mo>\u2229</mo><msubsup><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcac</mi><mrow><msup><mi>j</mi><mi>\u2032\u2032</mi></msup><mo>\u2062</mo><mi>j</mi></mrow><mi>i</mi></msubsup></mrow><mo>)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mo>(</mo><mrow><mo>|</mo><mrow><msubsup><mi>\u03b7</mi><mrow><msup><mi>j</mi><mo>\u2032</mo></msup><mo>\u2062</mo><mi>j</mi></mrow><mi>i</mi></msubsup><mo>\u2229</mo><msubsup><mi>\u03b7</mi><mrow><msup><mi>j</mi><mi>\u2032\u2032</mi></msup><mo>\u2062</mo><mi>j</mi></mrow><mi>i</mi></msubsup></mrow><mo>|</mo></mrow><mo>)</mo></mrow><mo>\u2062</mo><mrow><munder><mi>min</mi><mrow><msup><mi>j</mi><mi mathvariant=\"normal\">\u266f</mi></msup><mo>\u2208</mo><mrow><mo stretchy=\"false\">{</mo><msup><mi>j</mi><mo>\u2032</mo></msup><mo>,</mo><msup><mi>j</mi><mi>\u2032\u2032</mi></msup><mo stretchy=\"false\">}</mo></mrow></mrow></munder><mo>\u2061</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><mfrac><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mi>c</mi></msub><msubsup><mi>f</mi><mrow><mi>i</mi><mo>\u2062</mo><msup><mi>j</mi><mi mathvariant=\"normal\">\u266f</mi></msup></mrow><mi>c</mi></msubsup></mrow><msub><mi>S</mi><mrow><mi>i</mi><mo>\u2062</mo><msup><mi>j</mi><mi mathvariant=\"normal\">\u266f</mi></msup></mrow></msub></mfrac></mrow><mo>)</mo></mrow></mrow><mo>\u2062</mo><msub><mi>S</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\n  so all the flows into link $j^\\ast$ take up all available supply. These\n  flows are thus constrained by the supply constraint,~\\eqref{mimo_supply_constraint}.\n\\end{proof}\n\n\\begin{cor}\nTheorems~\\ref{theo_miso_optimal}\nand~\\ref{theo_simo_optimal} follow from the\nTheorem~\\ref{theo_mimo_relaxed_optimal} as special cases.\n\\end{cor}\n\n\\begin{remark}\nNote that setting the priorities equal to input link capacities, $p_i = F_i$, and all\nrestriction intervals $\\eta_{j'j}^i = [0,1]$, we recover the original node model and \nalgorithm of \\citet{tampere11}.\n\\end{remark}\n\n\n\\section{Stable and nonparametric traffic assignment}\\label{sec_sr_assignment}\nIn this section we consider a MIMO node with $M$ input links, $N$ output links\nand $C$ commodities, where some of the split ratios $\\beta_{ij}^c$\nare not defined a priori and must be computed as functions\nof the input demand $S_i^c$, priorities $p_i$ and the output supply $R_j$,\n$i=1,\\dots,M$, $j=1,\\dots,N$ and $c=1,\\dots,C$.\nThis may occur if the modeler chooses to let drivers at a node select\na route to their destination in response to changing conditions;\na specific example of such a node is given in an example\ndescribing an interchange between a freeway\nand a managed lane to be discussed after presentation of the\nalgorithm.\nHere we present the algorithm for computing undefined split ratios\nbased on the following definitions and assumptions:\n\\begin{itemize}\n\\item Define the set of commodity movements, for which split ratios\nare known, as ${\\cal B}=\\left\\{\\left\\{i,j,c\\right\\}: \\; \\beta_{ij}^c \\in [0,1]\\right\\}$,\nand the set of commodity movements, for which split ratios are to be\ncomputed, as ${\\overline{{\\cal B}}}=\\left\\{\\left\\{i,j,c\\right\\}: \\; \\beta_{ij}^c \\mbox{ are unknown}\\right\\}$.\n\n\\item For a given input link $i$ and commodity $c$ such that $S_i^c=0$,\nassume that all split ratios are known: $\\{i,j,c\\}\\in{\\cal B}$.\\footnote{If split\nratios were undefined in this case, they could be assigned arbitrarily.}\n\n\\item Define the set of output links, for which there exist unknown\nsplit ratios, as $V=\\left\\{j: \\; \\exists \\left\\{i,j,c\\right\\}\\in{\\overline{{\\cal B}}}\\right\\}$.\n\n\\item Assuming that for a given input link $i$ and commodity $c$\nsplit ratios must sum up to 1, define the unassigned portion\nof flow by ${\\overline{\\beta}}_i^c=1-\\sum_{j:\\{i,j,c\\}\\in{\\cal B}}\\beta_{ij}^c$.\n\n\\item For a given input link $i$ and commodity $c$ such that there exist\n$\\{i,j,c\\}\\in{\\overline{{\\cal B}}}$, assume ${\\overline{\\beta}}_i^c>0$, otherwise the\nundefined split ratios can be trivially set to 0.\n\n\\item For every output link $j\\in V$, define the set of input links\nthat have an unassigned demand portion directed toward this output link,\nby $U_j=\\left\\{i: \\; \\exists\\left\\{i,j,c\\right\\}\\in{\\overline{{\\cal B}}}\\right\\}$.\n\n\\item For a given input link $i$ and commodity $c$ define the set\nof output links, split ratios for which are to be computed by\n$V_i^c = \\left\\{j: \\; \\exists i\\in U_j\\right\\}$,\nand assume that if nonempty, this set contains at least two elements,\notherwise a single split ratio can be trivially set to ${\\overline{\\beta}}_i^c$.\n\n\\item Assume that input link priorities are nonnegative, $p_i\\geq 0$,\n\t$i=1,\\dots,M$, and $\\sum_{i=1}^M p_i = 1$. Note that, although in\n\tsection~\\ref{sec_node_model} we did not require the input priorities\n\tto sum to one, in this section we assume this normalization is done\n\tto simplify the notation.\n\n\\item Define the set of input links with zero priority:\n$U_{zp} = \\left\\{i:\\;p_i=0\\right\\}$.\nTo avoid dealing with zero input priorities, perform regularization:\n\n", "itemtype": "equation", "pos": 66367, "prevtext": "\n  Note that $j^\\sharp$ as defined in~\\eqref{eq-mimo-jsharp} is the less-restricted of the\n  two output links $j'$ and $j''$. This means that in the context of our algorithm, since\n  the most-restricted link $j^\\ast$ is picked at each iteration, subsequent links $j^\\ast$\n  at later iterations will always be less restricted then those in previous iterations.\n  Equation~\\eqref{eq_mimo_relaxed_step5_3} thus takes the union (with the subtraction\n  of the intersection) as done in \\eqref{eq-mimo-union}-\\eqref{eq-mimo-jsharp}, and\n  incorporates the relaxed FIFO constraint~\\eqref{mimo_rfifo_constraint}.\n  \n  Now consider equations~\\eqref{eq_mimo_relaxed_step5_1} and\n  \\eqref{eq_mimo_relaxed_step5_4}, which apply in the special case where $j=j^\\ast$.  have\n    \n", "index": 81, "text": "\\begin{align*}\n      \\sum_{c=1}^C \\sum_{i \\in U_{j^\\ast}(k)} f_{ij^\\ast}^c &= \\sum_{c=1}^C \\sum_{i \\in U_{j^\\ast}(k)} {\\tilde{S}}_{ij^\\ast}(k) \\frac{{\\tilde{p}}_{ij^\\ast}(k) a_{j^\\ast}(k)}{\\sum_{c'=1}^C {\\tilde{S}}_{ij^\\ast}^{c'}(k)} \\\\\n      &= \\sum_{i \\in U_{j^\\ast}(k)} {\\tilde{p}}_{ij^\\ast}(k) a_{j^\\ast}(k) \\\\\n      &= \\left( \\sum_{i \\in U_{j^\\ast}(k)} {\\tilde{p}}_{ij^\\ast}(k) \\right) \\frac{{\\tilde{R}}_{j^\\ast}(k)}{\\sum_{i \\in U_{j^\\ast}(k)} {\\tilde{p}}_{ij^\\ast}(k)} \\\\\n      &= {\\tilde{R}}_{j^\\ast}(k),\n    \\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex14.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\sum_{c=1}^{C}\\sum_{i\\in U_{j^{\\ast}}(k)}f_{ij^{\\ast}}^{c}\" display=\"inline\"><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover></mstyle><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>\u2208</mo><mrow><msub><mi>U</mi><msup><mi>j</mi><mo>\u2217</mo></msup></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></munder></mstyle><msubsup><mi>f</mi><mrow><mi>i</mi><mo>\u2062</mo><msup><mi>j</mi><mo>\u2217</mo></msup></mrow><mi>c</mi></msubsup></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex14.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\sum_{c=1}^{C}\\sum_{i\\in U_{j^{\\ast}}(k)}{\\tilde{S}}_{ij^{\\ast}}%&#10;(k)\\frac{{\\tilde{p}}_{ij^{\\ast}}(k)a_{j^{\\ast}}(k)}{\\sum_{c^{\\prime}=1}^{C}{%&#10;\\tilde{S}}_{ij^{\\ast}}^{c^{\\prime}}(k)}\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover></mstyle><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>\u2208</mo><mrow><msub><mi>U</mi><msup><mi>j</mi><mo>\u2217</mo></msup></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></munder></mstyle><mrow><msub><mover accent=\"true\"><mi>S</mi><mo stretchy=\"false\">~</mo></mover><mrow><mi>i</mi><mo>\u2062</mo><msup><mi>j</mi><mo>\u2217</mo></msup></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mstyle displaystyle=\"true\"><mfrac><mrow><msub><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">~</mo></mover><mrow><mi>i</mi><mo>\u2062</mo><msup><mi>j</mi><mo>\u2217</mo></msup></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>a</mi><msup><mi>j</mi><mo>\u2217</mo></msup></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><msup><mi>c</mi><mo>\u2032</mo></msup><mo>=</mo><mn>1</mn></mrow><mi>C</mi></msubsup><mrow><msubsup><mover accent=\"true\"><mi>S</mi><mo stretchy=\"false\">~</mo></mover><mrow><mi>i</mi><mo>\u2062</mo><msup><mi>j</mi><mo>\u2217</mo></msup></mrow><msup><mi>c</mi><mo>\u2032</mo></msup></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex15.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\sum_{i\\in U_{j^{\\ast}}(k)}{\\tilde{p}}_{ij^{\\ast}}(k)a_{j^{\\ast}%&#10;}(k)\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>\u2208</mo><mrow><msub><mi>U</mi><msup><mi>j</mi><mo>\u2217</mo></msup></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></munder></mstyle><mrow><msub><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">~</mo></mover><mrow><mi>i</mi><mo>\u2062</mo><msup><mi>j</mi><mo>\u2217</mo></msup></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>a</mi><msup><mi>j</mi><mo>\u2217</mo></msup></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex16.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\left(\\sum_{i\\in U_{j^{\\ast}}(k)}{\\tilde{p}}_{ij^{\\ast}}(k)%&#10;\\right)\\frac{{\\tilde{R}}_{j^{\\ast}}(k)}{\\sum_{i\\in U_{j^{\\ast}}(k)}{\\tilde{p}}%&#10;_{ij^{\\ast}}(k)}\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mrow><mo>(</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>\u2208</mo><mrow><msub><mi>U</mi><msup><mi>j</mi><mo>\u2217</mo></msup></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></munder></mstyle><mrow><msub><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">~</mo></mover><mrow><mi>i</mi><mo>\u2062</mo><msup><mi>j</mi><mo>\u2217</mo></msup></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>)</mo></mrow><mo>\u2062</mo><mstyle displaystyle=\"true\"><mfrac><mrow><msub><mover accent=\"true\"><mi>R</mi><mo stretchy=\"false\">~</mo></mover><msup><mi>j</mi><mo>\u2217</mo></msup></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>\u2208</mo><mrow><msub><mi>U</mi><msup><mi>j</mi><mo>\u2217</mo></msup></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></msub><mrow><msub><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">~</mo></mover><mrow><mi>i</mi><mo>\u2062</mo><msup><mi>j</mi><mo>\u2217</mo></msup></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex17.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle={\\tilde{R}}_{j^{\\ast}}(k),\" display=\"inline\"><mrow><mrow><mi/><mo>=</mo><mrow><msub><mover accent=\"true\"><mi>R</mi><mo stretchy=\"false\">~</mo></mover><msup><mi>j</mi><mo>\u2217</mo></msup></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nwhere $|U_{zp}|$ denotes the number of elements in set $U_{zp}$.\nExpression~\\eqref{priority_regularization} implies that the regularized\ninput priority ${\\tilde{p}}_i$ consists of two parts:\n(1) the original input priority $p_i$ normalized to the portion of \ninput links with nonzero priorities; and\n(2) uniform distribution among $M$ input links, $\\frac{1}{M}$, \nnormalized to the portion of input links with zero priorities.\n\nNote that ${\\tilde{p}}_i\\geq 0$, $i=1,\\dots,M$, and $\\sum_{i=1}^M {\\tilde{p}}_i = 1$.\n\\end{itemize}\n\nThe algorithm for distributing ${\\overline{\\beta}}_i^c$ among the commodity movements\nin ${\\overline{{\\cal B}}}$, that is assigning values to the a priori unknown split ratios,\naims at maintaining output links as uniformly occupied as possible.\nIt is described next.\n\n\\begin{enumerate}\n\\item Initialize:\n\\begin{eqnarray*}\n{\\tilde{\\beta}}_{ij}^c(0) & := & \\left\\{\\begin{array}{ll}\n\\beta_{ij}^c, & \\mbox{ if } \\{i,j,c\\}\\in{\\cal B},\\\\\n0, & \\mbox{ otherwise};\\end{array}\\right. \\\\\n{\\overline{\\beta}}_i^c(0) & := & {\\overline{\\beta}}_i^c; \\\\\n{\\tilde{U}}_j(0) & = &  U_j; \\\\\n{\\tilde{V}}(0) & = & V; \\\\\nk & := & 0,\n\\end{eqnarray*}\nHere ${\\tilde{U}}_j(k)$ is the remaining set of input links with some unassigned demand,\nwhich may be directed to output link $j$; and\n${\\tilde{V}}(k)$ is the remaining set of output links, to which the still unassigned\ndemand may be directed.\n\n\\item If ${\\tilde{V}}(k)=\\emptyset$, stop.\nThe sought-for split ratios are $\\left\\{{\\tilde{\\beta}}_{ij}^c(k)\\right\\}$,\n$i=1,\\dots,M$, $j=1,\\dots,N$, $c=1,\\dots,C$.\n\n\\item Calculate the remaining unallocated demand:\n", "itemtype": "equation", "pos": 70481, "prevtext": "\n  so all the flows into link $j^\\ast$ take up all available supply. These\n  flows are thus constrained by the supply constraint,~\\eqref{mimo_supply_constraint}.\n\\end{proof}\n\n\\begin{cor}\nTheorems~\\ref{theo_miso_optimal}\nand~\\ref{theo_simo_optimal} follow from the\nTheorem~\\ref{theo_mimo_relaxed_optimal} as special cases.\n\\end{cor}\n\n\\begin{remark}\nNote that setting the priorities equal to input link capacities, $p_i = F_i$, and all\nrestriction intervals $\\eta_{j'j}^i = [0,1]$, we recover the original node model and \nalgorithm of \\citet{tampere11}.\n\\end{remark}\n\n\n\\section{Stable and nonparametric traffic assignment}\\label{sec_sr_assignment}\nIn this section we consider a MIMO node with $M$ input links, $N$ output links\nand $C$ commodities, where some of the split ratios $\\beta_{ij}^c$\nare not defined a priori and must be computed as functions\nof the input demand $S_i^c$, priorities $p_i$ and the output supply $R_j$,\n$i=1,\\dots,M$, $j=1,\\dots,N$ and $c=1,\\dots,C$.\nThis may occur if the modeler chooses to let drivers at a node select\na route to their destination in response to changing conditions;\na specific example of such a node is given in an example\ndescribing an interchange between a freeway\nand a managed lane to be discussed after presentation of the\nalgorithm.\nHere we present the algorithm for computing undefined split ratios\nbased on the following definitions and assumptions:\n\\begin{itemize}\n\\item Define the set of commodity movements, for which split ratios\nare known, as ${\\cal B}=\\left\\{\\left\\{i,j,c\\right\\}: \\; \\beta_{ij}^c \\in [0,1]\\right\\}$,\nand the set of commodity movements, for which split ratios are to be\ncomputed, as ${\\overline{{\\cal B}}}=\\left\\{\\left\\{i,j,c\\right\\}: \\; \\beta_{ij}^c \\mbox{ are unknown}\\right\\}$.\n\n\\item For a given input link $i$ and commodity $c$ such that $S_i^c=0$,\nassume that all split ratios are known: $\\{i,j,c\\}\\in{\\cal B}$.\\footnote{If split\nratios were undefined in this case, they could be assigned arbitrarily.}\n\n\\item Define the set of output links, for which there exist unknown\nsplit ratios, as $V=\\left\\{j: \\; \\exists \\left\\{i,j,c\\right\\}\\in{\\overline{{\\cal B}}}\\right\\}$.\n\n\\item Assuming that for a given input link $i$ and commodity $c$\nsplit ratios must sum up to 1, define the unassigned portion\nof flow by ${\\overline{\\beta}}_i^c=1-\\sum_{j:\\{i,j,c\\}\\in{\\cal B}}\\beta_{ij}^c$.\n\n\\item For a given input link $i$ and commodity $c$ such that there exist\n$\\{i,j,c\\}\\in{\\overline{{\\cal B}}}$, assume ${\\overline{\\beta}}_i^c>0$, otherwise the\nundefined split ratios can be trivially set to 0.\n\n\\item For every output link $j\\in V$, define the set of input links\nthat have an unassigned demand portion directed toward this output link,\nby $U_j=\\left\\{i: \\; \\exists\\left\\{i,j,c\\right\\}\\in{\\overline{{\\cal B}}}\\right\\}$.\n\n\\item For a given input link $i$ and commodity $c$ define the set\nof output links, split ratios for which are to be computed by\n$V_i^c = \\left\\{j: \\; \\exists i\\in U_j\\right\\}$,\nand assume that if nonempty, this set contains at least two elements,\notherwise a single split ratio can be trivially set to ${\\overline{\\beta}}_i^c$.\n\n\\item Assume that input link priorities are nonnegative, $p_i\\geq 0$,\n\t$i=1,\\dots,M$, and $\\sum_{i=1}^M p_i = 1$. Note that, although in\n\tsection~\\ref{sec_node_model} we did not require the input priorities\n\tto sum to one, in this section we assume this normalization is done\n\tto simplify the notation.\n\n\\item Define the set of input links with zero priority:\n$U_{zp} = \\left\\{i:\\;p_i=0\\right\\}$.\nTo avoid dealing with zero input priorities, perform regularization:\n\n", "index": 83, "text": "\\begin{equation}\n{\\tilde{p}}_i = p_i\\left(1-\\frac{|U_{zp}|}{M}\\right)+ \\frac{1}{M}\\frac{|U_{zp}|}{M}=\np_i\\frac{M-|U_{zp}|}{M} + \\frac{|U_{zp}|}{M^2},\n\\label{priority_regularization}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E28.m1\" class=\"ltx_Math\" alttext=\"{\\tilde{p}}_{i}=p_{i}\\left(1-\\frac{|U_{zp}|}{M}\\right)+\\frac{1}{M}\\frac{|U_{zp%&#10;}|}{M}=p_{i}\\frac{M-|U_{zp}|}{M}+\\frac{|U_{zp}|}{M^{2}},\" display=\"block\"><mrow><mrow><msub><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">~</mo></mover><mi>i</mi></msub><mo>=</mo><mrow><mrow><msub><mi>p</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><mfrac><mrow><mo stretchy=\"false\">|</mo><msub><mi>U</mi><mrow><mi>z</mi><mo>\u2062</mo><mi>p</mi></mrow></msub><mo stretchy=\"false\">|</mo></mrow><mi>M</mi></mfrac></mrow><mo>)</mo></mrow></mrow><mo>+</mo><mrow><mfrac><mn>1</mn><mi>M</mi></mfrac><mo>\u2062</mo><mfrac><mrow><mo stretchy=\"false\">|</mo><msub><mi>U</mi><mrow><mi>z</mi><mo>\u2062</mo><mi>p</mi></mrow></msub><mo stretchy=\"false\">|</mo></mrow><mi>M</mi></mfrac></mrow></mrow><mo>=</mo><mrow><mrow><msub><mi>p</mi><mi>i</mi></msub><mo>\u2062</mo><mfrac><mrow><mi>M</mi><mo>-</mo><mrow><mo stretchy=\"false\">|</mo><msub><mi>U</mi><mrow><mi>z</mi><mo>\u2062</mo><mi>p</mi></mrow></msub><mo stretchy=\"false\">|</mo></mrow></mrow><mi>M</mi></mfrac></mrow><mo>+</mo><mfrac><mrow><mo stretchy=\"false\">|</mo><msub><mi>U</mi><mrow><mi>z</mi><mo>\u2062</mo><mi>p</mi></mrow></msub><mo stretchy=\"false\">|</mo></mrow><msup><mi>M</mi><mn>2</mn></msup></mfrac></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\n\n\\item For all input-output link pairs\ncalculate oriented demand as introduced in Section~\\ref{sec_node_model}:\n", "itemtype": "equation", "pos": 72290, "prevtext": "\nwhere $|U_{zp}|$ denotes the number of elements in set $U_{zp}$.\nExpression~\\eqref{priority_regularization} implies that the regularized\ninput priority ${\\tilde{p}}_i$ consists of two parts:\n(1) the original input priority $p_i$ normalized to the portion of \ninput links with nonzero priorities; and\n(2) uniform distribution among $M$ input links, $\\frac{1}{M}$, \nnormalized to the portion of input links with zero priorities.\n\nNote that ${\\tilde{p}}_i\\geq 0$, $i=1,\\dots,M$, and $\\sum_{i=1}^M {\\tilde{p}}_i = 1$.\n\\end{itemize}\n\nThe algorithm for distributing ${\\overline{\\beta}}_i^c$ among the commodity movements\nin ${\\overline{{\\cal B}}}$, that is assigning values to the a priori unknown split ratios,\naims at maintaining output links as uniformly occupied as possible.\nIt is described next.\n\n\\begin{enumerate}\n\\item Initialize:\n\\begin{eqnarray*}\n{\\tilde{\\beta}}_{ij}^c(0) & := & \\left\\{\\begin{array}{ll}\n\\beta_{ij}^c, & \\mbox{ if } \\{i,j,c\\}\\in{\\cal B},\\\\\n0, & \\mbox{ otherwise};\\end{array}\\right. \\\\\n{\\overline{\\beta}}_i^c(0) & := & {\\overline{\\beta}}_i^c; \\\\\n{\\tilde{U}}_j(0) & = &  U_j; \\\\\n{\\tilde{V}}(0) & = & V; \\\\\nk & := & 0,\n\\end{eqnarray*}\nHere ${\\tilde{U}}_j(k)$ is the remaining set of input links with some unassigned demand,\nwhich may be directed to output link $j$; and\n${\\tilde{V}}(k)$ is the remaining set of output links, to which the still unassigned\ndemand may be directed.\n\n\\item If ${\\tilde{V}}(k)=\\emptyset$, stop.\nThe sought-for split ratios are $\\left\\{{\\tilde{\\beta}}_{ij}^c(k)\\right\\}$,\n$i=1,\\dots,M$, $j=1,\\dots,N$, $c=1,\\dots,C$.\n\n\\item Calculate the remaining unallocated demand:\n", "index": 85, "text": "\n\\[\n{\\overline{S}}_i^c(k) = {\\overline{\\beta}}_i^c(k) S_i^c, \\;\\;\\; i=1,\\dots,M, \\;\\; c=1,\\dots,C.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex18.m1\" class=\"ltx_Math\" alttext=\"{\\overline{S}}_{i}^{c}(k)={\\overline{\\beta}}_{i}^{c}(k)S_{i}^{c},\\;\\;\\;i=1,%&#10;\\dots,M,\\;\\;c=1,\\dots,C.\" display=\"block\"><mrow><mrow><mrow><mrow><msubsup><mover accent=\"true\"><mi>S</mi><mo>\u00af</mo></mover><mi>i</mi><mi>c</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><msubsup><mover accent=\"true\"><mi>\u03b2</mi><mo>\u00af</mo></mover><mi>i</mi><mi>c</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msubsup><mi>S</mi><mi>i</mi><mi>c</mi></msubsup></mrow></mrow><mo rspace=\"10.9pt\">,</mo><mrow><mrow><mi>i</mi><mo>=</mo><mrow><mn>1</mn><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><mi>M</mi></mrow></mrow><mo rspace=\"8.1pt\">,</mo><mrow><mi>c</mi><mo>=</mo><mrow><mn>1</mn><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><mi>C</mi></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\n\n\\item For all input-output link pairs calculate oriented priorities:\n\\begin{eqnarray}\n{\\tilde{p}}_{ij}(k) & = & {\\tilde{p}}_i\\frac{\\sum_{c=1}^C \\gamma_{ij}^c S_i^c}{\n\\sum_{c=1}^C S_i^c}\n\\label{eq_oriented_priorities_undefined_sr1} \\\\\n\\mbox{with} & & \\nonumber \\\\\n\\gamma_{ij}^c(k) & = & \\left\\{\\begin{array}{ll}\n\\beta_{ij}^c, & \\mbox{ if split ratio is defined a priori: }\n\\{i,j,c\\}\\in{\\cal B}, \\\\\n{\\tilde{\\beta}}_{ij}^c(k) + \\frac{{\\overline{\\beta}}_i^c(k)}{|V_i^c|}, &\n\\mbox{ otherwise},\\end{array}\\right.\n\\label{eq_oriented_priorities_undefined_sr2}\n\\end{eqnarray}\nwhere $|V_i^c|$ denotes the number of elements in the set $V_i^c$.\nComparing the\nexpression~\\eqref{eq_oriented_priorities_undefined_sr1}-\\eqref{eq_oriented_priorities_undefined_sr2}\nwith~\\eqref{eq_oriented_priorities}, one can see that \nsplit ratios ${\\tilde{\\beta}}_{ij}^c(k)$, which are not fully defined yet,\nare complemented with a fraction of ${\\overline{\\beta}}_i^c(k)$ inversely proportional\nto the number of output links among which the flow of commodity $c$\nfrom input link $i$ can be distributed.\n\nNote that in this step we are using \\emph{regularized} priorities ${\\tilde{p}}_i$\nas opposed to the original $p_i$, $i=1,\\dots,M$.\nThis is done to ensure that inputs with $p_i=0$ are not ignored\nin the split ratio assignment.\n\n\\item Find the largest oriented demand-supply ratio:\n", "itemtype": "equation", "pos": 72503, "prevtext": "\n\n\\item For all input-output link pairs\ncalculate oriented demand as introduced in Section~\\ref{sec_node_model}:\n", "index": 87, "text": "\n\\[ {\\tilde{S}}_{ij}^c(k) = {\\tilde{\\beta}}_{ij}^c(k) S_i^c. \\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex19.m1\" class=\"ltx_Math\" alttext=\"{\\tilde{S}}_{ij}^{c}(k)={\\tilde{\\beta}}_{ij}^{c}(k)S_{i}^{c}.\" display=\"block\"><mrow><mrow><mrow><msubsup><mover accent=\"true\"><mi>S</mi><mo stretchy=\"false\">~</mo></mover><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow><mi>c</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><msubsup><mover accent=\"true\"><mi>\u03b2</mi><mo stretchy=\"false\">~</mo></mover><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow><mi>c</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msubsup><mi>S</mi><mi>i</mi><mi>c</mi></msubsup></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\n\n\\item Define the set of all output links, where the minimum of\nthe oriented demand-supply ratio is achieved:\n", "itemtype": "equation", "pos": 73922, "prevtext": "\n\n\\item For all input-output link pairs calculate oriented priorities:\n\\begin{eqnarray}\n{\\tilde{p}}_{ij}(k) & = & {\\tilde{p}}_i\\frac{\\sum_{c=1}^C \\gamma_{ij}^c S_i^c}{\n\\sum_{c=1}^C S_i^c}\n\\label{eq_oriented_priorities_undefined_sr1} \\\\\n\\mbox{with} & & \\nonumber \\\\\n\\gamma_{ij}^c(k) & = & \\left\\{\\begin{array}{ll}\n\\beta_{ij}^c, & \\mbox{ if split ratio is defined a priori: }\n\\{i,j,c\\}\\in{\\cal B}, \\\\\n{\\tilde{\\beta}}_{ij}^c(k) + \\frac{{\\overline{\\beta}}_i^c(k)}{|V_i^c|}, &\n\\mbox{ otherwise},\\end{array}\\right.\n\\label{eq_oriented_priorities_undefined_sr2}\n\\end{eqnarray}\nwhere $|V_i^c|$ denotes the number of elements in the set $V_i^c$.\nComparing the\nexpression~\\eqref{eq_oriented_priorities_undefined_sr1}-\\eqref{eq_oriented_priorities_undefined_sr2}\nwith~\\eqref{eq_oriented_priorities}, one can see that \nsplit ratios ${\\tilde{\\beta}}_{ij}^c(k)$, which are not fully defined yet,\nare complemented with a fraction of ${\\overline{\\beta}}_i^c(k)$ inversely proportional\nto the number of output links among which the flow of commodity $c$\nfrom input link $i$ can be distributed.\n\nNote that in this step we are using \\emph{regularized} priorities ${\\tilde{p}}_i$\nas opposed to the original $p_i$, $i=1,\\dots,M$.\nThis is done to ensure that inputs with $p_i=0$ are not ignored\nin the split ratio assignment.\n\n\\item Find the largest oriented demand-supply ratio:\n", "index": 89, "text": "\n\\[\n\\mu^+(k) = \\max_j\\max_i\n\\frac{\\sum_{c=1}^C {\\tilde{S}}_{ij}^c(k)}{{\\tilde{p}}_{ij}(k)R_j}\\sum_{i\\in U_j}{\\tilde{p}}_{ij}(k).\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex20.m1\" class=\"ltx_Math\" alttext=\"\\mu^{+}(k)=\\max_{j}\\max_{i}\\frac{\\sum_{c=1}^{C}{\\tilde{S}}_{ij}^{c}(k)}{{%&#10;\\tilde{p}}_{ij}(k)R_{j}}\\sum_{i\\in U_{j}}{\\tilde{p}}_{ij}(k).\" display=\"block\"><mrow><mrow><mrow><msup><mi>\u03bc</mi><mo>+</mo></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><munder><mi>max</mi><mi>j</mi></munder><mo>\u2061</mo><mrow><munder><mi>max</mi><mi>i</mi></munder><mo>\u2061</mo><mfrac><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></msubsup><mrow><msubsup><mover accent=\"true\"><mi>S</mi><mo stretchy=\"false\">~</mo></mover><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow><mi>c</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mrow><msub><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">~</mo></mover><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>R</mi><mi>j</mi></msub></mrow></mfrac></mrow></mrow><mo>\u2062</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>\u2208</mo><msub><mi>U</mi><mi>j</mi></msub></mrow></munder><mrow><msub><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">~</mo></mover><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nand from this set pick the output link $j^-$ with the smallest\noutput demand-supply ratio (when there are multiple\nminimizing output links, any of the minimizing output links\nmay be chosen as $j^-$):\n", "itemtype": "equation", "pos": 74163, "prevtext": "\n\n\\item Define the set of all output links, where the minimum of\nthe oriented demand-supply ratio is achieved:\n", "index": 91, "text": "\n\\[\nY(k) = \\arg\\min_{j\\in{\\tilde{V}}(k)}\\min_{i\\in{\\tilde{U}}_j(k)}\n\\frac{\\sum_{c=1}^C {\\tilde{S}}_{ij}^c(k)}{{\\tilde{p}}_{ij}(k)R_j}\n\\sum_{i\\in U_j}{\\tilde{p}}_{ij}(k),\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex21.m1\" class=\"ltx_Math\" alttext=\"Y(k)=\\arg\\min_{j\\in{\\tilde{V}}(k)}\\min_{i\\in{\\tilde{U}}_{j}(k)}\\frac{\\sum_{c=1%&#10;}^{C}{\\tilde{S}}_{ij}^{c}(k)}{{\\tilde{p}}_{ij}(k)R_{j}}\\sum_{i\\in U_{j}}{%&#10;\\tilde{p}}_{ij}(k),\" display=\"block\"><mrow><mrow><mrow><mi>Y</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>arg</mi><mo>\u2061</mo><mrow><munder><mi>min</mi><mrow><mi>j</mi><mo>\u2208</mo><mrow><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></munder><mo>\u2061</mo><mrow><munder><mi>min</mi><mrow><mi>i</mi><mo>\u2208</mo><mrow><msub><mover accent=\"true\"><mi>U</mi><mo stretchy=\"false\">~</mo></mover><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></munder><mo>\u2061</mo><mfrac><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></msubsup><mrow><msubsup><mover accent=\"true\"><mi>S</mi><mo stretchy=\"false\">~</mo></mover><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow><mi>c</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mrow><msub><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">~</mo></mover><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>R</mi><mi>j</mi></msub></mrow></mfrac></mrow></mrow></mrow><mo>\u2062</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>\u2208</mo><msub><mi>U</mi><mi>j</mi></msub></mrow></munder><mrow><msub><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">~</mo></mover><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\n\n\\item Define the set of all input links, where the minimum of\nthe oriented demand-supply ratio for the output link $j^-$ is achieved:\n", "itemtype": "equation", "pos": 74535, "prevtext": "\nand from this set pick the output link $j^-$ with the smallest\noutput demand-supply ratio (when there are multiple\nminimizing output links, any of the minimizing output links\nmay be chosen as $j^-$):\n", "index": 93, "text": "\n\\[\nj^- = \\arg\\min_{j\\in Y(k)}\n\\frac{\\sum_{i=1}^M\\sum_{c=1}^C{\\tilde{S}}_{ij}^c(k)}{R_j}.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex22.m1\" class=\"ltx_Math\" alttext=\"j^{-}=\\arg\\min_{j\\in Y(k)}\\frac{\\sum_{i=1}^{M}\\sum_{c=1}^{C}{\\tilde{S}}_{ij}^{%&#10;c}(k)}{R_{j}}.\" display=\"block\"><mrow><mrow><msup><mi>j</mi><mo>-</mo></msup><mo>=</mo><mrow><mi>arg</mi><mo>\u2061</mo><mrow><munder><mi>min</mi><mrow><mi>j</mi><mo>\u2208</mo><mrow><mi>Y</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></munder><mo>\u2061</mo><mfrac><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></msubsup><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></msubsup><mrow><msubsup><mover accent=\"true\"><mi>S</mi><mo stretchy=\"false\">~</mo></mover><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow><mi>c</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><msub><mi>R</mi><mi>j</mi></msub></mfrac></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\nand from this set pick the input link $i^-$ and commodity $c^-$\nwith the smallest remaining unallocated demand:\n", "itemtype": "equation", "pos": 74762, "prevtext": "\n\n\\item Define the set of all input links, where the minimum of\nthe oriented demand-supply ratio for the output link $j^-$ is achieved:\n", "index": 95, "text": "\n\\[\nW_{j^-}(k) = \\arg\\min_{i\\in{\\tilde{U}}_{j^-}(k)}\n\\frac{\\sum_{c=1}^C {\\tilde{S}}_{ij^-}^c(k)}{{\\tilde{p}}_{ij^-}(k)R_{j^-}}\n\\sum_{i\\in U_{j^-}}{\\tilde{p}}_{ij^-}(k),\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex23.m1\" class=\"ltx_Math\" alttext=\"W_{j^{-}}(k)=\\arg\\min_{i\\in{\\tilde{U}}_{j^{-}}(k)}\\frac{\\sum_{c=1}^{C}{\\tilde{%&#10;S}}_{ij^{-}}^{c}(k)}{{\\tilde{p}}_{ij^{-}}(k)R_{j^{-}}}\\sum_{i\\in U_{j^{-}}}{%&#10;\\tilde{p}}_{ij^{-}}(k),\" display=\"block\"><mrow><mrow><mrow><msub><mi>W</mi><msup><mi>j</mi><mo>-</mo></msup></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>arg</mi><mo>\u2061</mo><mrow><munder><mi>min</mi><mrow><mi>i</mi><mo>\u2208</mo><mrow><msub><mover accent=\"true\"><mi>U</mi><mo stretchy=\"false\">~</mo></mover><msup><mi>j</mi><mo>-</mo></msup></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></munder><mo>\u2061</mo><mfrac><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></msubsup><mrow><msubsup><mover accent=\"true\"><mi>S</mi><mo stretchy=\"false\">~</mo></mover><mrow><mi>i</mi><mo>\u2062</mo><msup><mi>j</mi><mo>-</mo></msup></mrow><mi>c</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mrow><msub><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">~</mo></mover><mrow><mi>i</mi><mo>\u2062</mo><msup><mi>j</mi><mo>-</mo></msup></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>R</mi><msup><mi>j</mi><mo>-</mo></msup></msub></mrow></mfrac></mrow></mrow><mo>\u2062</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>\u2208</mo><msub><mi>U</mi><msup><mi>j</mi><mo>-</mo></msup></msub></mrow></munder><mrow><msub><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">~</mo></mover><mrow><mi>i</mi><mo>\u2062</mo><msup><mi>j</mi><mo>-</mo></msup></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\n\n\\item Define the smallest oriented demand-supply ratio:\n", "itemtype": "equation", "pos": 75045, "prevtext": "\nand from this set pick the input link $i^-$ and commodity $c^-$\nwith the smallest remaining unallocated demand:\n", "index": 97, "text": "\n\\[\n\\{i^-, c^-\\} = \\arg\\min_{\\begin{array}{c}\ni\\in W_{j^-}(k),\\\\\nc:{\\overline{\\beta}}_{i^-}^c(k)>0\\end{array}} {\\overline{S}}_i^c(k).\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex24.m1\" class=\"ltx_Math\" alttext=\"\\{i^{-},c^{-}\\}=\\arg\\min_{\\begin{array}[]{c}i\\in W_{j^{-}}(k),\\\\&#10;c:{\\overline{\\beta}}_{i^{-}}^{c}(k)&gt;0\\end{array}}{\\overline{S}}_{i}^{c}(k).\" display=\"block\"><mrow><mrow><mrow><mo stretchy=\"false\">{</mo><msup><mi>i</mi><mo>-</mo></msup><mo>,</mo><msup><mi>c</mi><mo>-</mo></msup><mo stretchy=\"false\">}</mo></mrow><mo>=</mo><mrow><mrow><mi>arg</mi><mo>\u2061</mo><mrow><munder><mi>min</mi><mtable rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><mrow><mi>i</mi><mo>\u2208</mo><mrow><msub><mi>W</mi><msup><mi>j</mi><mo>-</mo></msup></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><mi>c</mi><mo>:</mo><mrow><mrow><msubsup><mover accent=\"true\"><mi>\u03b2</mi><mo>\u00af</mo></mover><msup><mi>i</mi><mo>-</mo></msup><mi>c</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>&gt;</mo><mn>0</mn></mrow></mrow></mtd></mtr></mtable></munder><mo>\u2061</mo><msubsup><mover accent=\"true\"><mi>S</mi><mo>\u00af</mo></mover><mi>i</mi><mi>c</mi></msubsup></mrow></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.01054.tex", "nexttext": "\n\\begin{itemize}\n\\item If $\\mu^-(k) = \\mu^+(k)$, which means that the oriented demand\nis perfectly balanced among the output links, \ndistribute the unassigned demand proportionally\nto the allocated supply:\n\\begin{eqnarray}\n{\\tilde{\\beta}}_{i^-j}^{c^-}(k+1) & = & {\\tilde{\\beta}}_{i^-j}^{c^-}(k) + \n\\frac{{\\tilde{p}}_{i^-j}(k)R_j}{\\sum_{j'\\in{\\tilde{V}}_{i^-}^{c^-}(k)}{\\tilde{p}}_{i^-j'}(k)R_{j'}}\n{\\overline{\\beta}}_{i^-}^{c^-}(k), \\;\\;\\; j\\in {\\tilde{V}}_{i^-}^{c^-}(k);\n\\label{eq_sr_assign_1}\\\\\n{\\tilde{\\beta}}_{ij}^{c}(k+1) & = & {\\tilde{\\beta}}_{ij}^{c}(k) \\mbox{ for } \n\\{i,j,c\\}\\neq\\{i^-,j,c^-\\}; \\label{eq_sr_assign_2}\\\\\n{\\overline{\\beta}}_{i^-}^{c^-}(k+1) & = & 0; \\nonumber\\\\\n{\\overline{\\beta}}_i^c(k+1) & = & {\\overline{\\beta}}_i^c(k) \\mbox{ for }\n\\{i,c\\}\\neq\\{i^-,c^-\\}.\\nonumber\n\\end{eqnarray}\n\n\\item Else, assign:\n\\begin{eqnarray}\n\\Delta{\\tilde{\\beta}}_{i^-j^-}^{c^-}(k) & = & \\min\\left\\{{\\overline{\\beta}}_{i^-}^{c^-}(k),\\;\\;\n\\left(\\frac{\\mu^+(k){\\tilde{p}}_{i^-j^-}(k)R_{j^-}}{\n{\\overline{S}}_{i^-}^{c^-}(k) \\sum_{i\\in U_{j^-}}{\\tilde{p}}_{ij^-}(k)} -\n\\frac{\\sum_{c=1}^C{\\tilde{S}}_{i^-j^-}^c(k)}{{\\overline{S}}_{i^-}^{c^-}(k)}\\right)\\right\\};\n\\label{eq_sr_assign_3}\\\\\n{\\tilde{\\beta}}_{i^-j^-}^{c^-}(k+1) & = & {\\tilde{\\beta}}_{i^-j^-}^{c^-}(k) + \n\\Delta{\\tilde{\\beta}}_{i^-j^-}^{c^-}(k);\n\\label{eq_sr_assign_4}\\\\\n{\\tilde{\\beta}}_{ij}^{c}(k+1) & = & {\\tilde{\\beta}}_{ij}^{c}(k) \\mbox{ for }\n\\{i,j,c\\}\\neq\\{i^-,j^-,c^-\\}; \\label{eq_sr_assign_5}\\\\\n{\\overline{\\beta}}_{i^-}^{c^-}(k+1) & = & {\\overline{\\beta}}_{i^-}^{c^-}(k) -\n\\Delta{\\tilde{\\beta}}_{i^-j^-}^{c^-}(k); \\nonumber \\\\\n{\\overline{\\beta}}_i^c(k+1) & = & {\\overline{\\beta}}_i^c(k) \\mbox{ for } \\{i,c\\}\\neq\\{i^-,c^-\\}.\n\\nonumber\n\\end{eqnarray}\n\\end{itemize}\n\n\\item Update sets ${\\tilde{U}}_j(k)$ and ${\\tilde{V}}(k)$:\n\\begin{eqnarray*}\n{\\tilde{U}}_j(k+1) & = & {\\tilde{U}}_j(k) \\setminus \\left\\{i^-: \\;\n{\\overline{\\beta}}_{i^-}^c(k+1) = 0, \\; c=1,\\dots,C\\right\\}, \\;\\;\\; j\\in {\\tilde{V}}(k);\\\\\n{\\tilde{V}}(k+1) & = & {\\tilde{V}}(k) \\setminus \\left\\{j: \\; {\\tilde{U}}_j(k+1)=\\emptyset\\right\\}.\n\\end{eqnarray*}\n\n\\item Set $k := k+1$ and return to step 2.\n\\end{enumerate}\n\n\\begin{figure}[h]\n\\centering\n\\includegraphics[width=1.5in]{./Figures/sr_assignment_example}\n\\caption{Merge-diverge intersection example.}\n\\label{fig-sr_example}\n\\end{figure}\n\n\\textbf{Example.} Consider the node presented in\nFigure~\\ref{fig-sr_example}. The node represents a junction between\ntwo parallel links, or a merge-diverge.\nNodes such as these may be\nused to model locations where drivers can choose to shift between\ntwo parallel roads or lane groups; the canonical example is an\naccess point for a managed lane facility adjacent to a freeway,\nwhere drivers may choose to enter or exit the managed lane.\nThis is an example of a possibly data-poor situation we discussed\nearlier where split ratios can be hard to measure, but it makes sense\nto dynamically model drivers' split ratios in response to local\nconditions.\n\nIn this\nexample, we will say that links 1 and 3 represent a freeway's general\npurpose (GP) lanes, and links 2 and 4 represent a high-occupancy vehicle\n(HOV) lane, open only to a select group of vehicles. The Low-Occupancy\nVehicles (LOVs) and HOVs will be modeled as separate commodities, with\nnotations of $L$ for LOVs and $H$ for HOVs.\n\nSuppose we have input parameters of:\n\n\\begin{tabular}{l l l}\n $\\beta_{14}^L = 0$ & $\\beta_{13}^L = 1$ & \\\\\n $\\beta_{14}^H = ?$ & $\\beta_{13}^H = ?$ & $p_1=\\sfrac{3}{4}$ \\\\\n $\\beta_{23}^H = ?$ & $\\beta_{24}^H = ?$ & $p_2=\\sfrac{1}{4}$ \\\\\n $S_1^L = 500$ & $S_1^H = 100$ & $R_3 = 600$ \\\\\n $S_2^H = 50$ & & $R_4 = 200$ \\\\\n\\end{tabular}\n\nIn words, the LOVs are not allowed to enter the HOV lane; HOVs are allowed,\nbut individual vehicles may or may not choose to do so: both links can\nbring them to their eventual downstream destination so the choice of link\nto take will be made in response to immediate local congestion conditions.\n\nLet us outline how the algorithm would assign split ratios for the HOVs.\n\n\\underline{$k=0:$}\n\t\t$\\begin{aligned}[t]\n\t\t\t\\Delta {\\tilde{\\beta}}_{i^- j^-}^{c^-}(0) &= \\Delta {\\tilde{\\beta}}_{24}^H(0)\n\t\t\t\t= 1 \\\\\n\t\t\t{\\tilde{\\beta}}_{24}^H(1) &= 0 + 1 = 1 \\\\\n\t\t\t{\\overline{\\beta}}_{2}^H(1) &= 1 - 0 = 0\n\t\t\\end{aligned}$\n\n\\underline{$k=1:$}\n$\\begin{aligned}[t]\n\t\t\t\t\\Delta {\\tilde{\\beta}}_{i^- j^-}^{c^-}(1) &= \\Delta {\\tilde{\\beta}}_{14}^H(1)\n\t\t\t\t\t= \\sfrac{1}{3} \\\\\n\t\t\t\t{\\tilde{\\beta}}_{14}^H(2) &= 0 + \\sfrac{1}{3} = \\sfrac{1}{3} \\\\\n\t\t\t\t{\\overline{\\beta}}_{2}^H(2) &= 1 - \\sfrac{1}{3} = \\sfrac{2}{3}\n\t\t\t\\end{aligned}$\n\t\t\t\n\\underline{$k=2:$}\n$\\begin{aligned}[t]\n\t\t\t\t{\\tilde{\\beta}}_{13}^H(3) &= 0.64 \\\\\n\t\t\t\t{\\tilde{\\beta}}_{23}^H(3) &= 0.36 \\\\\n\t\t\t\t{\\overline{\\beta}}_{1}^H(3) &= 0\n\t\t\t\\end{aligned}$\n\n\\underline{$k=3:$}\n\nThe algorithm terminates. The resulting split ratios are\n$\\boldsymbol{ \\beta_{13}^H = 0.64, \\quad\n\t\\beta_{23}^H = 0.36, \\quad \\beta_{24}^H = 1,\n\t\\quad \\beta_{23}^H = 0}$.\n\n\n\\section{Conclusion}\\label{sec_conclusion}\nThis paper discussed several modeling issues that the authors have encountered in\nmacroscopic simulation of large and/or high-dimensional road networks.\nTwo issues, unrealistic spillback behavior and making sensible split\nratios with a dearth of data, were traced back to issues with common\nnode and route choice models. As discussed, the FIFO flow constraint\nshared by all node models in the style of \\citet{tampere11} can cause\noverly aggressive spillback, and the statistical nature of the logit\nmodel means that it cannot be expected to perform well when the data are lacking,\nand ``hand-tuning'' or transferring data can be difficult as well.\n\nWe proposed a generalization of the FIFO flow rule through the use of mutual restriction\nintervals. These intervals allow for a range of relaxations of the FIFO rule,\non a spectrum from no-FIFO to full-FIFO. We also presented an easy graphical\nmethod for calculating flows from supplies and demands. We also presented an\nintegral-control-inspired split ratio assignment algorithm that can produce\nsplit ratios at a node with access only to the local demands and supplies.\nWe have had success in applying this method in situations where no data to\nfit a logit model is available.\n\nThe above mentioned results are presented in the form of constructive\ncomputational algorithms that are readily implementable in\nmacroscopic traffic simulation software.\n\n\n\n\n\\section*{Acknowledgements}\\label{sec_acknowledgement}\nWe would like to express great appreciation to our colleagues\nElena Dorogush and Ajith Muralidharan for sharing ideas,\nRamtin Pedarsani, Brian Phegley and Pravin Varaiya for their\ncritical reading and their help in clarifying some theoretical issues.\n\nThis research was funded by the California Department of Transportation.\n\n\n\\appendix\n\\section{Notation}\\label{app_notation}\n\\begin{longtable}[l]{l p{4.5in} l}\n\tSymbol & Definition & Used in section(s) \\\\\n\t\\hline\n\n\n\t$k$ & Iteration index & \\ref{sec_node_model},\\ref{sec_sr_assignment}\\\\\n\n\n\n\n\t$i$ & Index of links entering a node & \\ref{sec_node_model},\\ref{sec_sr_assignment}\\\\\n\t$M$ & Number of links entering a node & \\ref{sec_node_model},\\ref{sec_sr_assignment}\\\\\n\t$j$ & Index of links exiting a node & \\ref{sec_node_model},\\ref{sec_sr_assignment}\\\\\n\t$N$ & Number of links exiting a node & \\ref{sec_node_model},\\ref{sec_sr_assignment}\\\\\n\n\n\n\n\t$F_l$ & Capacity of link $l$ & \\ref{sec_node_model}\\\\\n\n\n\n\n\n\n\n\n\n\n\t${\\tilde{S}}_l^c(k)$ & Adjusted demand for commodity $c$ of link $l$ as of iteration $k$ & \\ref{sec_node_model} \\\\\n\t$R_l$ & Supply of link $l$ & \\ref{sec_node_model}\\\\\n\t$p_i$ & Priority of input link $i$ & \\ref{sec_node_model},\\ref{sec_sr_assignment} \\\\\n\t$U(k)$ & Set of input links whose flows have yet to be fully determined as of iteration $k$ & \\ref{sec_node_model} \\\\\n\t$V(k)$ & Set of output links whose flows have yet to be fully determined as of iteration $k$ & \\ref{sec_node_model} \\\\\n\t${\\tilde{p}}_i(k)$ & Adjusted priority of link $i$ at iteration $k$ & \\ref{sec_node_model},\\ref{sec_sr_assignment} \\\\\n\t${\\tilde{R}}_j(k)$ & Adjusted supply of link $j$ at iteration $k$ & \\ref{sec_node_model} \\\\\n\t$U_j(k)$ & Set of input links contributing to link $j$ whose flows are undetermined as of iteration $k$ & \\ref{sec_node_model} \\\\\n\t${\\tilde{p}}_{ij}(k)$ & Oriented priority from link $i$ to $j$ at iteration $k$ & \\ref{sec_node_model},\\ref{sec_sr_assignment} \\\\\n\t$a_j(k)$ & Restriction term of link $j$ at iteration $k$ & \\ref{sec_node_model} \\\\\n\t$a_{j^\\ast}(k)$ & Smallest (most restrictive) restriction term at iteration $k$ & \\ref{sec_node_model} \\\\\n\t$\\alpha_j(k)$ & Reduction factor of link $j$ at iteration $k$ & \\ref{sec_node_model} \\\\\n\t${\\tilde{U}}(k)$ & Set of input links whose demand can be fully met by downstream links at iteration $k$& \\ref{sec_node_model} \\\\\n\t${\\cal B}$ & Set of commodity movement triples $(i,j,c)$ whose split ratios are known & \\ref{sec_sr_assignment} \\\\\n\t${\\overline{{\\cal B}}}$ & Set of commodity movement triples $(i,j,c)$ whose split ratios are unknown & \\ref{sec_sr_assignment} \\\\\n\t${\\overline{\\beta}}_i^c$ & Unassigned portion of the split ratios of commodity $c$ from link $i$ & \\ref{sec_sr_assignment} \\\\\n\t${\\overline{S}}_i^c$ & Unassigned demand of commodity $c$ from link $i$ & \\ref{sec_sr_assignment} \\\\\n\t${\\tilde{V}}(k)$ & Set of output links to which unassigned demand may still be assigned as of iteration $k$ & \\ref{sec_sr_assignment} \\\\\n\t$\\mu^{+}(k)$ & Largest oriented demand-supply ratio at iteration $k$ & \\ref{sec_sr_assignment} \\\\\n\t$\\mu^{-}(k)$ & Smallest oriented demand-supply ratio at iteration $k$ & \\ref{sec_sr_assignment} \\\\\n\\end{longtable}\n\n\n\n\n\n\n\\bibliographystyle{abbrvnat}\n\\bibliography{traffic}\n\n\n\n\n", "itemtype": "equation", "pos": 75238, "prevtext": "\n\n\\item Define the smallest oriented demand-supply ratio:\n", "index": 99, "text": "\n\\[\n\\mu^-(k) = \n\\frac{\\sum_{c=1}^C {\\tilde{S}}_{i^-j^-}^c(k)}{{\\tilde{p}}_{i^-j^-}(k)R_{j^-}}\n\\sum_{i\\in U_{j^-}}{\\tilde{p}}_{ij-}(k).\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex25.m1\" class=\"ltx_Math\" alttext=\"\\mu^{-}(k)=\\frac{\\sum_{c=1}^{C}{\\tilde{S}}_{i^{-}j^{-}}^{c}(k)}{{\\tilde{p}}_{i%&#10;^{-}j^{-}}(k)R_{j^{-}}}\\sum_{i\\in U_{j^{-}}}{\\tilde{p}}_{ij-}(k).\" display=\"block\"><mrow><mrow><mrow><msup><mi>\u03bc</mi><mo>-</mo></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></msubsup><mrow><msubsup><mover accent=\"true\"><mi>S</mi><mo stretchy=\"false\">~</mo></mover><mrow><msup><mi>i</mi><mo>-</mo></msup><mo>\u2062</mo><msup><mi>j</mi><mo>-</mo></msup></mrow><mi>c</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mrow><msub><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">~</mo></mover><mrow><msup><mi>i</mi><mo>-</mo></msup><mo>\u2062</mo><msup><mi>j</mi><mo>-</mo></msup></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>R</mi><msup><mi>j</mi><mo>-</mo></msup></msub></mrow></mfrac><mo>\u2062</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>\u2208</mo><msub><mi>U</mi><msup><mi>j</mi><mo>-</mo></msup></msub></mrow></munder><mrow><msub><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">~</mo></mover><mrow><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow><mo>-</mo></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}]