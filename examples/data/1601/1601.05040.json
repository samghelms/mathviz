[{"file": "1601.05040.tex", "nexttext": "\nwhich colors the size $\\delta$ partition class of $K_{\\delta,n-\\delta}$ using an element of $S(\\delta,H)$, and independently colors each vertex of the size $n-\\delta$ partition class using one of the $\\Delta$ common neighbors.\n\nNow let $G$ be a connected $n$-vertex graph with minimum degree $\\delta$. The proof will proceed by iteratively coloring parts of the graph $G$; throughout we use connectivity to always color vertices adjacent to a previously colored vertex (after an initial subset of vertices is colored). This iterative coloring procedure produces an upper bound on $\\hom(G,H)$ which in most cases is smaller than the simple lower bound on $\\hom(K_{\\delta,n-\\delta},H)$. \n\n\n\nSuppose that $G$ has a path of length $k \\geq \\ell$ (with $\\ell$ as given in Lemma \\ref{lem-longpath}). Coloring the path, and then iteratively coloring the remaining vertices --- which each have at most $\\Delta$ possibilities for their color --- we have \n", "itemtype": "equation", "pos": 11140, "prevtext": "\n\n\\maketitle\n\n\\begin{abstract}\nFor graphs $G$ and $H$, an $H$-coloring of $G$ is a map from the vertices of $G$ to the vertices of $H$ that preserves edge adjacency.  We consider the following extremal enumerative question: for a given $H$, which connected $n$-vertex graph with minimum degree $\\delta$ maximizes the number of $H$-colorings?  We show that for non-regular $H$ and sufficiently large $n$, the complete bipartite graph $K_{\\delta,n-\\delta}$ is the unique maximizer.  As a corollary, for non-regular $H$ and sufficiently large $n$ the graph $K_{k,n-k}$ is the unique $k$-connected graph that maximizes the number of $H$-colorings among all $k$-connected graphs.  Finally, we show that this conclusion does not hold for all regular $H$ by exhibiting a connected $n$-vertex graph with minimum degree $\\delta$ which has more $K_{q}$-colorings (for sufficiently large $q$ and $n$) than $K_{\\delta,n-\\delta}$.\n\\end{abstract}\n\n\n\n\n\n\\section{Introduction and statement of results}\n\n\nGiven a simple loopless graph $G = (V(G),E(G))$ and a graph $H = (V(H),E(H))$ without multi-edges but possibly with loops, an \\emph{$H$-coloring} of $G$ is an adjacency preserving map $f:V(G) \\to V(H)$ (i.e., $f$ satisfies $f(v) \\sim_H f(w)$ whenever $v \\sim_G w$). An $H$-coloring of $G$ is also referred to as a \\emph{graph homomorphism} from $G$ to $H$. When $H=H_{\\text{ind}}$, the graph consisting of a single edge and a loop on one endvertex, an $H_{\\text{ind}}$-coloring of a graph $G$ may be identified with an independent set in $G$, and when $H=K_{q}$, the complete unlooped graph on $q$ vertices, a $K_{q}$-coloring of $G$ may be identified with a proper $q$-coloring of $G$.  We let $\\hom(G,H)$ denote the number of $H$-colorings of $G$.\n\nMuch recent work has been done on the following extremal enumerative question: given a family of graphs ${\\mathcal{G}}$ and a graph $H$, which $G \\in {\\mathcal{G}}$ maximizes the quantity $\\hom(G,H)$? For a survey of results and conjectures surrounding questions of this type, see \\cite{Cutler}.  \n\n\nA family relevant to the current paper is the family of bipartite $n$-vertex $d$-regular graphs. Here, Galvin and Tetali \\cite{GalvinTetali} (extending work of Kahn \\cite{Kahn} for independent sets) showed that the graph in this family with the maximum number of $H$-colorings is $\\frac{n}{2d} K_{d,d}$, which consists of $\\frac{n}{2d}$ disjoint copies of the complete bipartite graph $K_{d,d}$. (Note that throughout we assume $n$ is large and $d$ is fixed, and we will assume any necessary divisibility conditions between $d$ and $n$.) When moving to the larger class of \\emph{all} $n$-vertex $d$-regular graphs, for some $H$ the graph $\\frac{n}{2d}K_{d,d}$ still maximizes the number of $H$-colorings (see \\cite{Zhao,Zhao2}) but for other graphs $H$ the graph $\\frac{n}{d+1}K_{d+1}$, which consists of $\\frac{n}{d+1}$ disjoint copies of the complete graph $K_{d+1}$, maximizes the number of $H$-colorings (for example, take $H$ to be the disjoint union of two looped vertices).  Recently Sernau \\cite{Sernau} showed that for certain $H$ there are disjoint copies of other small graphs (in particular, not copies of $K_{d,d}$ or $K_{d+1}$) that maximize the number of $H$-colorings.  \n\nWhat drives some of these results is that the maximizing graph $G$ is obtained by taking the disjoint union of some number of copies of the same fixed small graph.  In particular, the idea in \\cite{Sernau} to find maximizing graphs other than copies of $K_{d+1}$ or $K_{d,d}$ is to find an $H$ and a graph with the smallest number of vertices (more than $d+1$ but less than $2d$) that has a non-zero number of $H$-colorings, and then to let $H'$ be a large number of copies of $H$.  In this way, the $H'$-coloring count is driven by having the largest number of components (each with a non-zero number of $H$-colorings of each component) in an $n$-vertex $d$-regular graph. It is worth noting that $H'$ can be modified to be connected with the maximizing graph remaining the same \\cite{Sernau}. \nWhile there is a single graph having the most number of $H$-colorings within the family of \\emph{bipartite} $n$-vertex $d$-regular graphs for each possible $H$, at this point it is unclear what the smallest list of $n$-vertex $d$-regular graphs is so that for each possible $H$, some graph in the list maximizes the number of $H$-colorings of graphs in the family.  \n\n\n\nAnother natural and related family that has been studied is the family  of $n$-vertex graphs with minimum degree $\\delta$. Here we have complete extremal results for $H_{\\text{ind}}$-colorings \\cite{CutlerRadcliffe}. The extremal question for all other $H$ was investigated for $\\delta = 1$ and $\\delta=2$ in \\cite{Engbers}.  For larger values of $\\delta$, a general answer is still unknown, but as shown in \\cite{Engbers} there is a family of $H$ for which $K_{\\delta,n-\\delta}$ maximizes the number of $H$-colorings for all $\\delta$ when $n$ is sufficiently large.  However, it is not difficult to construct $H$ for which some other graph maximizes the number of $H$-colorings \nfor all $\\delta$. Indeed, as with regular graphs, there are $H'$ for which having a large number of components with a non-zero number of $H$-colorings significantly increases the $H'$-coloring count, and so the connected graph $K_{\\delta,n-\\delta}$ does not maximize the number of $H'$-colorings. \n\nNotice that an $H$-coloring of $G$ requires, by definition, a component of $G$ to be mapped to a component of $H$, and so it is natural to restrict our attention to $n$-vertex graphs with minimum degree $\\delta$ which are connected.  Doing this produces a much more coherent structure of the maximizing graphs for almost all $H$, even large $H$. To describe these results, we now state the degree convention that we will use.\n\n\\begin{convention}\nThe degree of a vertex $v$ is $d(v) = |\\{w: v \\sim w\\}|$.  In particular, a loop on a vertex adds one to the degree.  When considering $H$-colorings of $G$, we let $\\Delta$ denote the maximum degree of a vertex in $H$.\n\\end{convention}\n\nIt was shown in \\cite{Sidorenko} (with a short proof given in \\cite{CsikvariLin}) that in the family of trees the star $K_{1,n-1}$ has the largest number of $H$-colorings for any $H$.  In \\cite{EngbersGalvin}, this tree result is proved for sufficiently large $n$. The proof technique from \\cite{EngbersGalvin} generalizes to a proof for the family of $2$-connected graphs on $n$ vertices, where for sufficiently large $n$ the graph $K_{2,n-2}$ maximizes the number of $H$-colorings for any connected non-regular $H$.   In \\cite{EngbersGalvin}, the authors ask what happens for $k$-connected graphs where $k>2$.  We answer this question for connected non-regular $H$ and sufficiently large $n$.\n\n\\begin{theorem}\\label{thm-main}\nFix $\\delta \\geq 2$.  Let $H$ be connected and non-regular, and let $G$ be an $n$-vertex connected graph with minimum degree at least $\\delta$.  Then there exists a constant $c(\\delta,H)$ so that for $n \\geq c(\\delta,H)$ we have $\\hom(G,H) \\leq \\hom(K_{\\delta,n-\\delta},H)$, with equality if and only if $G = K_{\\delta,n-\\delta}$. \n\\end{theorem}\n\nWhen $\\delta=1$, the theorem is still true (for all $n$) as a corollary to the result for trees \\cite{Sidorenko}. Also, notice that a $k$-connected graph must be connected and have minimum degree at least $k$.   Since $K_{k,n-k}$ is $k$-connected, the following is immediate. \n\n\\begin{corollary}\nFix $k \\geq 2$.  Let $H$ be connected and non-regular, and let $G$ be an $n$-vertex $k$-connected graph.  Then there exists a constant $c(k,H)$ so that for $n \\geq c(k,H)$ we have $\\hom(G,H) \\leq \\hom(K_{k,n-k},H)$, with equality if and only if $G=K_{k,n-k}$.\n\\end{corollary}\n\n\nThe proof of Theorem \\ref{thm-main} uses a stability technique similar to that in \\cite{Engbers} and \\cite{EngbersGalvin}.  In particular, we first show that if a connected $n$-vertex graph with minimum degree $\\delta$ isn't structurally close to $K_{\\delta,n-\\delta}$ (specifically, if it doesn't contain an subgraph isomorphic to $K_{\\delta,bn}$ for some small constant $b$), then it admits fewer $H$-colorings than $K_{\\delta,n-\\delta}$.  If it is structurally close to $K_{\\delta,n-\\delta}$ but isn't $K_{\\delta,n-\\delta}$, then a second argument will show that it again admits fewer $H$-colorings than $K_{\\delta,n-\\delta}$. \n\nIt is shown in \\cite{EngbersGalvin} that when $H=K_4$, for example, $\\hom(C_n,K_4) > \\hom(K_{2,n-2},K_4)$, showing that the result doesn't hold in general when removing the non-regularity restriction on $H$, even for connected $H$.  We also show here that when $H=K_q$ for large enough $q$, there are connected $n$-vertex graphs with minimum degree $\\delta$ with more $K_{q}$-colorings than $K_{\\delta,n-\\delta}$. \n\n\n\\begin{theorem}\\label{thm-cols}\nFix $\\delta \\geq 2$ and $n$ with $(\\delta+1) |n$, and let $H=K_{q}$.  Consider the graph $\\frac{n}{\\delta+1}K_{\\delta+1}$.  Choose one specified vertex in each copy of $K_{\\delta+1}$, form a star on those specified vertices, and let $G$ be the resulting graph. Then for large enough $n$ and for large enough $q$, $\\hom(K_{\\delta,n-\\delta},H) < \\hom(G,H)$.\n\\end{theorem}\n\nWhile the graph $G$ in Theorem \\ref{thm-cols} has more $K_{q}$-colorings than $K_{\\delta,n-\\delta}$, it isn't clear which connected $n$-vertex graph with minimum degree $\\delta$ maximizes the number of $K_{q}$-colorings in this family.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\section{Proofs of Theorems \\ref{thm-main} and \\ref{thm-cols}}\n\nRecall that a loop on a vertex adds one to the degree and that $\\Delta$ refers to the maximum degree of a vertex in $H$. We begin with a few useful lemmas.\n\n\\begin{lemma}\\label{lem-longpath}\nFix $\\delta$. For non-regular connected $H$ there exists a constant $\\ell$ (depending on $\\delta$ and $H$) such that if $k \\geq \\ell$, then $hom(P_k, H) < \\Delta^{k-\\delta}$.\n\\end{lemma}\n\n\\begin{proof}\nThe proof of Lemma 3.1 in \\cite{EngbersGalvin} shows that for non-regular connected $H$ we have $\\hom(P_k,H) \\leq |V(H)|^2 c_1 \\lambda^k$ for some $\\lambda < \\Delta$ (where here $c_1$ and $\\lambda$ are constants depending on $H$).  This implies the result.\n\\end{proof}\n\nFor shorter paths, we have the following, which is Lemma 4.5 from \\cite{EngbersGalvin}.\n\n\\begin{lemma}[\\cite{EngbersGalvin}]\\label{lem-shortpath}\nSuppose $H$ is not the complete looped graph on $\\Delta$ vertices or $K_{\\Delta,\\Delta}$. Then for any two vertices $i$, $j$ of $H$ and for $k \\geq 4$ there are at most $(\\Delta^2-1)\\Delta^{k-4}$ $H$-colorings of $P_k$ that map the initial vertex of that path to $i$ and the terminal vertex to $j$.\n\\end{lemma}\n\nNotice that if $H$ is a non-regular graph, then the conclusion of Lemma \\ref{lem-shortpath} applies. We are now ready to prove Theorem \\ref{thm-main}. \n\n\n\n\n\n\n\n\n\n\n\n\\begin{proof}[Proof of Theorem \\ref{thm-main}]\nLet $\\delta\\geq 2$ be fixed and $H$ be a connected non-regular graph.  Following a definition from \\cite{Engbers}, we let $S(\\delta,H)$ denote the vectors in $V(H)^\\delta$ with the property that the elements of the vector have $\\Delta$ common neighbors in $H$, and let $s(\\delta,H) = |S(\\delta,H)|$.  Then we have the simple lower bound \n", "index": 1, "text": "\n\\[\n\\hom(K_{\\delta,n-\\delta},H) \\geq s(\\delta,H)\\Delta^{n-\\delta} \\geq \\Delta^{n-\\delta},\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"\\hom(K_{\\delta,n-\\delta},H)\\geq s(\\delta,H)\\Delta^{n-\\delta}\\geq\\Delta^{n-%&#10;\\delta},\" display=\"block\"><mrow><mrow><mrow><mi>hom</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>K</mi><mrow><mi>\u03b4</mi><mo>,</mo><mrow><mi>n</mi><mo>-</mo><mi>\u03b4</mi></mrow></mrow></msub><mo>,</mo><mi>H</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2265</mo><mrow><mi>s</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b4</mi><mo>,</mo><mi>H</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msup><mi mathvariant=\"normal\">\u0394</mi><mrow><mi>n</mi><mo>-</mo><mi>\u03b4</mi></mrow></msup></mrow><mo>\u2265</mo><msup><mi mathvariant=\"normal\">\u0394</mi><mrow><mi>n</mi><mo>-</mo><mi>\u03b4</mi></mrow></msup></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05040.tex", "nexttext": "\n Therefore, from now on we assume that the graph $G$ does not have any paths of length $k \\geq \\ell$. \n\nFix any path in $G$ (necessarily of length less than $\\ell$) and $H$-color that path.  Then run the following procedure.\n\\begin{enumerate}\n\t\\item Denote by $C \\subseteq V(G)$ the set of vertices that have already received a color.\n\t\\item Search for a non-trivial component in the induced graph on vertex set $V(G) \\setminus C$.\n\t\\begin{enumerate}\n\t\t\\item If there is a non-trivial component that is a tree, find a maximal path $P$ in that component and iteratively color the vertices of the path $P$ (since $\\delta(G) \\geq 2$, the endpoints of $P$ have a neighbor in $C$).  Then proceed back to step 1.\n\t\t\\item If all non-trivial components are not trees, choose one such component and fix a cycle in the component.  Let $X$ be the graph consisting of the cycle and the shortest path from a vertex on the cycle to a vertex in $C$.  Iteratively color the vertices of $X$ by coloring the path first and then the cycle.  Then proceed back to step 1.\n\t\t\\item If all components are trivial, stop.\n\t\\end{enumerate}\n\\end{enumerate}\n\nNote that since we're assuming that there are no paths of length at least $\\ell$ in $G$, at every iteration of this coloring scheme we color fewer than $\\ell$ previously uncolored vertices.  Furthermore by Lemma \\ref{lem-shortpath} each coloring of $k$ previously uncolored vertices in Step 2 can be done in at most $(\\Delta^2-1)\\Delta^{k-2}$ ways.\n\nIf there are $a$ iterations of this procedure run, then by coloring the remaining vertices using at most $\\Delta$ possible choices for each uncolored vertex, we have\n", "itemtype": "equation", "pos": 12177, "prevtext": "\nwhich colors the size $\\delta$ partition class of $K_{\\delta,n-\\delta}$ using an element of $S(\\delta,H)$, and independently colors each vertex of the size $n-\\delta$ partition class using one of the $\\Delta$ common neighbors.\n\nNow let $G$ be a connected $n$-vertex graph with minimum degree $\\delta$. The proof will proceed by iteratively coloring parts of the graph $G$; throughout we use connectivity to always color vertices adjacent to a previously colored vertex (after an initial subset of vertices is colored). This iterative coloring procedure produces an upper bound on $\\hom(G,H)$ which in most cases is smaller than the simple lower bound on $\\hom(K_{\\delta,n-\\delta},H)$. \n\n\n\nSuppose that $G$ has a path of length $k \\geq \\ell$ (with $\\ell$ as given in Lemma \\ref{lem-longpath}). Coloring the path, and then iteratively coloring the remaining vertices --- which each have at most $\\Delta$ possibilities for their color --- we have \n", "index": 3, "text": "\n\\[\n\\hom(G,H) < \\Delta^{k-\\delta}\\Delta^{n-k} = \\Delta^{n-\\delta} \\leq \\hom(K_{\\delta,n-\\delta},H).\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"\\hom(G,H)&lt;\\Delta^{k-\\delta}\\Delta^{n-k}=\\Delta^{n-\\delta}\\leq\\hom(K_{\\delta,n-%&#10;\\delta},H).\" display=\"block\"><mrow><mrow><mrow><mi>hom</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>G</mi><mo>,</mo><mi>H</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>&lt;</mo><mrow><msup><mi mathvariant=\"normal\">\u0394</mi><mrow><mi>k</mi><mo>-</mo><mi>\u03b4</mi></mrow></msup><mo>\u2062</mo><msup><mi mathvariant=\"normal\">\u0394</mi><mrow><mi>n</mi><mo>-</mo><mi>k</mi></mrow></msup></mrow><mo>=</mo><msup><mi mathvariant=\"normal\">\u0394</mi><mrow><mi>n</mi><mo>-</mo><mi>\u03b4</mi></mrow></msup><mo>\u2264</mo><mrow><mi>hom</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>K</mi><mrow><mi>\u03b4</mi><mo>,</mo><mrow><mi>n</mi><mo>-</mo><mi>\u03b4</mi></mrow></mrow></msub><mo>,</mo><mi>H</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05040.tex", "nexttext": "\nwhenever $a > \\Delta^2 \\left( \\log |V(H)| +  \\delta \\log \\Delta \\right)$.\n\nTherefore, we suppose $a \\leq \\Delta^2 \\left( \\log |V(H)| +  \\delta \\log \\Delta \\right)$.  But then the final output of colored vertices $C \\subseteq V(G)$ upon termination has $|C|$ bounded above by a constant depending on $\\delta$ and $H$, and furthermore $n-|C|$ vertices remain uncolored. Since the procedure terminated, the vertices in $V(G) \\setminus C$ form an independent set, and so in particular each vertex $v \\in V(G) \\setminus C$ has at least $\\delta$ neighbors in the set $C$. By the pigeonhole principle, some set of $\\delta$ vertices (among the set $C$) must have at least $(n-|C|)/\\binom{|C|}{\\delta}$ common neighbors.  In other words, the graphs $G$ for which we do not yet have $\\hom(G,H) < \\hom(K_{\\delta,n-\\delta},H)$ are those which have a (not necessarily induced) subgraph isomorphic to $K_{\\delta,bn}$ for some small constant $b$ (depending on $\\delta$ and $H$). Note that these graphs are ``structurally close'' to $K_{\\delta,n-\\delta}$.\n\nSo, finally, suppose that $G \\neq K_{\\delta,n-\\delta}$ contains $K_{\\delta, bn}$ for some constant $b$ (depending on $\\delta$ and $H$). We will consider two cases: when $G$ does not have an isomorphic copy of $K_{\\delta,n-\\delta}$ as a subgraph, and finally when it does.\n\n\\medskip\n\n\\textbf{$G$ contains no subgraph isomorphic to $K_{\\delta,n-\\delta}$:} Suppose first that $G$ does not contain a subgraph isomorphic to $K_{\\delta,n-\\delta}$.  This means that the size $\\delta$ partition class in $K_{\\delta,bn}$ is not a dominating set.  In particular, the induced subgraph on the vertices outside of the size $\\delta$ partition class must have a non-trivial component.  As before, if some component is a tree, let $X$ be a maximal path in the tree; if all components are not trees, let $X$ be the union of a cycle and a shortest path from a vertex on the cycle to a vertex in the size $\\delta$ partition class.  \n\n\nWith $X$ now defined, we partition the $H$-colorings of $G$ based on whether the colors in the size $\\delta$ partition class form a vector in $S(\\delta,H)$ or not.  \n\nIf they do form a vector in $S(\\delta,H)$, we then color $X$, and then the rest of the graph.  Using Lemma \\ref{lem-shortpath} on $X$, this gives at most\n", "itemtype": "equation", "pos": 13925, "prevtext": "\n Therefore, from now on we assume that the graph $G$ does not have any paths of length $k \\geq \\ell$. \n\nFix any path in $G$ (necessarily of length less than $\\ell$) and $H$-color that path.  Then run the following procedure.\n\\begin{enumerate}\n\t\\item Denote by $C \\subseteq V(G)$ the set of vertices that have already received a color.\n\t\\item Search for a non-trivial component in the induced graph on vertex set $V(G) \\setminus C$.\n\t\\begin{enumerate}\n\t\t\\item If there is a non-trivial component that is a tree, find a maximal path $P$ in that component and iteratively color the vertices of the path $P$ (since $\\delta(G) \\geq 2$, the endpoints of $P$ have a neighbor in $C$).  Then proceed back to step 1.\n\t\t\\item If all non-trivial components are not trees, choose one such component and fix a cycle in the component.  Let $X$ be the graph consisting of the cycle and the shortest path from a vertex on the cycle to a vertex in $C$.  Iteratively color the vertices of $X$ by coloring the path first and then the cycle.  Then proceed back to step 1.\n\t\t\\item If all components are trivial, stop.\n\t\\end{enumerate}\n\\end{enumerate}\n\nNote that since we're assuming that there are no paths of length at least $\\ell$ in $G$, at every iteration of this coloring scheme we color fewer than $\\ell$ previously uncolored vertices.  Furthermore by Lemma \\ref{lem-shortpath} each coloring of $k$ previously uncolored vertices in Step 2 can be done in at most $(\\Delta^2-1)\\Delta^{k-2}$ ways.\n\nIf there are $a$ iterations of this procedure run, then by coloring the remaining vertices using at most $\\Delta$ possible choices for each uncolored vertex, we have\n", "index": 5, "text": "\n\\[\n\\hom(G,H) \\leq |V(H)|(1-\\frac{1}{\\Delta^2})^a\\Delta^n < \\Delta^{n-\\delta} \\leq \\hom(K_{\\delta,n-\\delta},H)\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"\\hom(G,H)\\leq|V(H)|(1-\\frac{1}{\\Delta^{2}})^{a}\\Delta^{n}&lt;\\Delta^{n-\\delta}%&#10;\\leq\\hom(K_{\\delta,n-\\delta},H)\" display=\"block\"><mrow><mrow><mi>hom</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>G</mi><mo>,</mo><mi>H</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2264</mo><mrow><mrow><mo stretchy=\"false\">|</mo><mrow><mi>V</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>H</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">|</mo></mrow><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>-</mo><mfrac><mn>1</mn><msup><mi mathvariant=\"normal\">\u0394</mi><mn>2</mn></msup></mfrac></mrow><mo stretchy=\"false\">)</mo></mrow><mi>a</mi></msup><mo>\u2062</mo><msup><mi mathvariant=\"normal\">\u0394</mi><mi>n</mi></msup></mrow><mo>&lt;</mo><msup><mi mathvariant=\"normal\">\u0394</mi><mrow><mi>n</mi><mo>-</mo><mi>\u03b4</mi></mrow></msup><mo>\u2264</mo><mrow><mi>hom</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>K</mi><mrow><mi>\u03b4</mi><mo>,</mo><mrow><mi>n</mi><mo>-</mo><mi>\u03b4</mi></mrow></mrow></msub><mo>,</mo><mi>H</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.05040.tex", "nexttext": "\n$H$-colorings of $G$ of this type.\n\nIf the colors on the size $\\delta$ partition class do not form a vector in $S(\\delta,H)$, then the at least $bn$ neighbors have at most $\\Delta-1$ possible choices for their color.  Therefore, there are at most\n", "itemtype": "equation", "pos": 16316, "prevtext": "\nwhenever $a > \\Delta^2 \\left( \\log |V(H)| +  \\delta \\log \\Delta \\right)$.\n\nTherefore, we suppose $a \\leq \\Delta^2 \\left( \\log |V(H)| +  \\delta \\log \\Delta \\right)$.  But then the final output of colored vertices $C \\subseteq V(G)$ upon termination has $|C|$ bounded above by a constant depending on $\\delta$ and $H$, and furthermore $n-|C|$ vertices remain uncolored. Since the procedure terminated, the vertices in $V(G) \\setminus C$ form an independent set, and so in particular each vertex $v \\in V(G) \\setminus C$ has at least $\\delta$ neighbors in the set $C$. By the pigeonhole principle, some set of $\\delta$ vertices (among the set $C$) must have at least $(n-|C|)/\\binom{|C|}{\\delta}$ common neighbors.  In other words, the graphs $G$ for which we do not yet have $\\hom(G,H) < \\hom(K_{\\delta,n-\\delta},H)$ are those which have a (not necessarily induced) subgraph isomorphic to $K_{\\delta,bn}$ for some small constant $b$ (depending on $\\delta$ and $H$). Note that these graphs are ``structurally close'' to $K_{\\delta,n-\\delta}$.\n\nSo, finally, suppose that $G \\neq K_{\\delta,n-\\delta}$ contains $K_{\\delta, bn}$ for some constant $b$ (depending on $\\delta$ and $H$). We will consider two cases: when $G$ does not have an isomorphic copy of $K_{\\delta,n-\\delta}$ as a subgraph, and finally when it does.\n\n\\medskip\n\n\\textbf{$G$ contains no subgraph isomorphic to $K_{\\delta,n-\\delta}$:} Suppose first that $G$ does not contain a subgraph isomorphic to $K_{\\delta,n-\\delta}$.  This means that the size $\\delta$ partition class in $K_{\\delta,bn}$ is not a dominating set.  In particular, the induced subgraph on the vertices outside of the size $\\delta$ partition class must have a non-trivial component.  As before, if some component is a tree, let $X$ be a maximal path in the tree; if all components are not trees, let $X$ be the union of a cycle and a shortest path from a vertex on the cycle to a vertex in the size $\\delta$ partition class.  \n\n\nWith $X$ now defined, we partition the $H$-colorings of $G$ based on whether the colors in the size $\\delta$ partition class form a vector in $S(\\delta,H)$ or not.  \n\nIf they do form a vector in $S(\\delta,H)$, we then color $X$, and then the rest of the graph.  Using Lemma \\ref{lem-shortpath} on $X$, this gives at most\n", "index": 7, "text": "\n\\[\ns(\\delta,H) (\\Delta^2-1) \\Delta^{n-\\delta-2}\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m1\" class=\"ltx_Math\" alttext=\"s(\\delta,H)(\\Delta^{2}-1)\\Delta^{n-\\delta-2}\" display=\"block\"><mrow><mi>s</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b4</mi><mo>,</mo><mi>H</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mi mathvariant=\"normal\">\u0394</mi><mn>2</mn></msup><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msup><mi mathvariant=\"normal\">\u0394</mi><mrow><mi>n</mi><mo>-</mo><mi>\u03b4</mi><mo>-</mo><mn>2</mn></mrow></msup></mrow></math>", "type": "latex"}, {"file": "1601.05040.tex", "nexttext": "\n$H$-colorings of $G$ of this type.\n\nPutting these together, we have\n\\begin{eqnarray*}\n\\hom(G,H) &\\leq& s(\\delta,H) (\\Delta^2-1) \\Delta^{n-\\delta-2} + |V(H)|^\\delta \\cdot (\\Delta-1)^{bn} \\Delta^{n-bn}\\\\\n&\\leq& s(\\delta,H) \\Delta^{n-\\delta} - s(\\delta,H)\\Delta^{n-\\delta-2} + |V(H)|^\\delta \\cdot e^{-bn/\\Delta} \\Delta^{n}\\\\\n&<& s(\\delta,H) \\Delta^{n-\\delta}\n\\end{eqnarray*}\nwhere the final inequality holds for all sufficiently large $n$.\n\n\\medskip\n\n\\textbf{$G$ contains a subgraph isomorphic to $K_{\\delta,n-\\delta}$:}\nLastly, suppose that $G$ contains a subgraph isomorphic to $K_{\\delta,n-\\delta}$.  Since $G \\neq K_{\\delta,n-\\delta}$, it suffices to show that adding any edge to $K_{\\delta,n-\\delta}$ strictly decreases the number of $H$-colorings. To this end, we suppose that $G$ is obtained from $K_{\\delta,n-\\delta}$ by the addition of a single edge, and we show that each $H$-coloring of $K_{\\delta,n-\\delta}$ is also an $H$-coloring of $G$ only when $H$ is the complete looped graph. \n\nSuppose that $i$ and $j$ are distinct adjacent vertices of $H$.  Then the mapping that sends the size $\\delta$ partition class of $K_{\\delta,n-\\delta}$ to $i$ and the other partition class to $j$ is an $H$-coloring of $K_{\\delta,n-\\delta}$, and similarly the mapping that sends the size $\\delta$ partition class to $j$ and the other partition class to $i$ is another $H$-coloring of $K_{\\delta,n-\\delta}$.  This is only an $H$-coloring of $G$ if $i$ and $j$ are both looped.  By similar reasoning, if $i$ and $j$ are adjacent in $H$ and $j$ and $k$ are also adjacent in $H$, then $i$ and $k$ must be adjacent.  As $H$ is connected, this implies that $H$ is a fully looped complete graph.  So if $G$ is obtained from $K_{\\delta,n-\\delta}$ by adding an edge and $H$ is non-regular, then $\\hom(G,H) < \\hom(K_{\\delta,n-\\delta},H)$.\n\\end{proof}\n\nWe conclude this section with the proof of Theorem \\ref{thm-cols}.\n\n\\begin{proof}[Proof of Theorem \\ref{thm-cols}]\nLet $H=K_{q}$. First, we find an upper bound on $\\hom(K_{\\delta,n-\\delta},H)$. There are\n", "itemtype": "equation", "pos": 16614, "prevtext": "\n$H$-colorings of $G$ of this type.\n\nIf the colors on the size $\\delta$ partition class do not form a vector in $S(\\delta,H)$, then the at least $bn$ neighbors have at most $\\Delta-1$ possible choices for their color.  Therefore, there are at most\n", "index": 9, "text": "\n\\[\n|V(H)|^\\delta \\cdot (\\Delta-1)^{bn} \\Delta^{n-bn}\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m1\" class=\"ltx_Math\" alttext=\"|V(H)|^{\\delta}\\cdot(\\Delta-1)^{bn}\\Delta^{n-bn}\" display=\"block\"><mrow><mrow><msup><mrow><mo stretchy=\"false\">|</mo><mrow><mi>V</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>H</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">|</mo></mrow><mi>\u03b4</mi></msup><mo>\u22c5</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mi>b</mi><mo>\u2062</mo><mi>n</mi></mrow></msup></mrow><mo>\u2062</mo><msup><mi mathvariant=\"normal\">\u0394</mi><mrow><mi>n</mi><mo>-</mo><mrow><mi>b</mi><mo>\u2062</mo><mi>n</mi></mrow></mrow></msup></mrow></math>", "type": "latex"}, {"file": "1601.05040.tex", "nexttext": "\ncolorings of $K_{\\delta,n-\\delta}$ that use distinct colors on the size $\\delta$ partition class. In a similar way, there are at most\n", "itemtype": "equation", "pos": 18709, "prevtext": "\n$H$-colorings of $G$ of this type.\n\nPutting these together, we have\n\\begin{eqnarray*}\n\\hom(G,H) &\\leq& s(\\delta,H) (\\Delta^2-1) \\Delta^{n-\\delta-2} + |V(H)|^\\delta \\cdot (\\Delta-1)^{bn} \\Delta^{n-bn}\\\\\n&\\leq& s(\\delta,H) \\Delta^{n-\\delta} - s(\\delta,H)\\Delta^{n-\\delta-2} + |V(H)|^\\delta \\cdot e^{-bn/\\Delta} \\Delta^{n}\\\\\n&<& s(\\delta,H) \\Delta^{n-\\delta}\n\\end{eqnarray*}\nwhere the final inequality holds for all sufficiently large $n$.\n\n\\medskip\n\n\\textbf{$G$ contains a subgraph isomorphic to $K_{\\delta,n-\\delta}$:}\nLastly, suppose that $G$ contains a subgraph isomorphic to $K_{\\delta,n-\\delta}$.  Since $G \\neq K_{\\delta,n-\\delta}$, it suffices to show that adding any edge to $K_{\\delta,n-\\delta}$ strictly decreases the number of $H$-colorings. To this end, we suppose that $G$ is obtained from $K_{\\delta,n-\\delta}$ by the addition of a single edge, and we show that each $H$-coloring of $K_{\\delta,n-\\delta}$ is also an $H$-coloring of $G$ only when $H$ is the complete looped graph. \n\nSuppose that $i$ and $j$ are distinct adjacent vertices of $H$.  Then the mapping that sends the size $\\delta$ partition class of $K_{\\delta,n-\\delta}$ to $i$ and the other partition class to $j$ is an $H$-coloring of $K_{\\delta,n-\\delta}$, and similarly the mapping that sends the size $\\delta$ partition class to $j$ and the other partition class to $i$ is another $H$-coloring of $K_{\\delta,n-\\delta}$.  This is only an $H$-coloring of $G$ if $i$ and $j$ are both looped.  By similar reasoning, if $i$ and $j$ are adjacent in $H$ and $j$ and $k$ are also adjacent in $H$, then $i$ and $k$ must be adjacent.  As $H$ is connected, this implies that $H$ is a fully looped complete graph.  So if $G$ is obtained from $K_{\\delta,n-\\delta}$ by adding an edge and $H$ is non-regular, then $\\hom(G,H) < \\hom(K_{\\delta,n-\\delta},H)$.\n\\end{proof}\n\nWe conclude this section with the proof of Theorem \\ref{thm-cols}.\n\n\\begin{proof}[Proof of Theorem \\ref{thm-cols}]\nLet $H=K_{q}$. First, we find an upper bound on $\\hom(K_{\\delta,n-\\delta},H)$. There are\n", "index": 11, "text": "\n\\[\nq(q-1)\\cdots(q-\\delta+1)(q-\\delta)^{n-\\delta}\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex6.m1\" class=\"ltx_Math\" alttext=\"q(q-1)\\cdots(q-\\delta+1)(q-\\delta)^{n-\\delta}\" display=\"block\"><mrow><mi>q</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>q</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi mathvariant=\"normal\">\u22ef</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mi>q</mi><mo>-</mo><mi>\u03b4</mi></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>q</mi><mo>-</mo><mi>\u03b4</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mi>n</mi><mo>-</mo><mi>\u03b4</mi></mrow></msup></mrow></math>", "type": "latex"}, {"file": "1601.05040.tex", "nexttext": "\ncolorings of $K_{\\delta,n-\\delta}$ that have the same color on two or more vertices in the size $\\delta$ partition class. This means that there are at most\n", "itemtype": "equation", "pos": 18895, "prevtext": "\ncolorings of $K_{\\delta,n-\\delta}$ that use distinct colors on the size $\\delta$ partition class. In a similar way, there are at most\n", "index": 13, "text": "\n\\[\n\\delta^2 \\cdot q \\cdot q^{\\delta-2} \\cdot (q-1)^{n-\\delta} \\leq \\delta^2 q^{n-1}\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex7.m1\" class=\"ltx_Math\" alttext=\"\\delta^{2}\\cdot q\\cdot q^{\\delta-2}\\cdot(q-1)^{n-\\delta}\\leq\\delta^{2}q^{n-1}\" display=\"block\"><mrow><mrow><msup><mi>\u03b4</mi><mn>2</mn></msup><mo>\u22c5</mo><mi>q</mi><mo>\u22c5</mo><msup><mi>q</mi><mrow><mi>\u03b4</mi><mo>-</mo><mn>2</mn></mrow></msup><mo>\u22c5</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>q</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mi>n</mi><mo>-</mo><mi>\u03b4</mi></mrow></msup></mrow><mo>\u2264</mo><mrow><msup><mi>\u03b4</mi><mn>2</mn></msup><mo>\u2062</mo><msup><mi>q</mi><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow></mrow></math>", "type": "latex"}, {"file": "1601.05040.tex", "nexttext": "\n$K_{q}$-colorings of $K_{\\delta,n-\\delta}$.\n\nFor the graph $G$, we first color the $K_{\\delta+1}$ containing the center of the star, and then the remaining copies of $K_{\\delta+1}$.  This gives\n\\begin{eqnarray*}\n\\hom(G,K_{q}) &=& q(q-1)\\cdots(q-\\delta)\\left[ (q-1)(q-1)(q-2)\\cdots(q-\\delta)\\right]^{\\frac{n}{\\delta+1} - 1}.\n\n\n\\end{eqnarray*}\nA short calculation of the coefficients of $q^{n-1}$ shows that for sufficiently large $n$, sufficiently large $q$, and $\\delta \\geq 2$ we have $\\hom(K_{\\delta,n-\\delta},K_{q}) < \\hom(G,K_{q})$.\n\\end{proof}\n\n\n\n\n\\section{Concluding Remarks}\n\nHere we highlight a few open questions related to the contents of this paper.  We showed that for sufficiently large $n$ and connected non-regular $H$, the number of $H$-colorings of a connected $n$-vertex graph $G$ with minimum degree $\\delta$ is maximized uniquely when $G=K_{\\delta,n-\\delta}$.  \n\nFirst, it would be interesting to know if this behavior holds for all $n \\geq 2\\delta$, as it does for independent sets \\cite{CutlerRadcliffe}.\n\\begin{question}\nFix a non-regular $H$ and $n\\geq 2\\delta$. Does $K_{\\delta,n-\\delta}$ maximize the number of $H$-colorings over all connected $n$-vertex graphs with minimum degree $\\delta$?\n\\end{question}\nThe behavior for non-trivial regular $H$ is still unknown.\n\\begin{question}\nFix a regular $H$ and $n \\geq 2\\delta$. Which connected $n$-vertex graph with minimum degree $\\delta$ maximizes the number of $H$-colorings?\n\\end{question}\nIn particular, we have the following interesting extremal question for proper $q$-colorings.\n\\begin{question}\nFix $q>2$. Which connected $n$-vertex graph with minimum degree $\\delta$ maximizes the number of proper $q$-colorings?\n\\end{question}\nNote that when $q=2$, any bipartite graph maximizes the number of $K_{q}$-colorings. Investigating what happens when $n<2\\delta$ would also be interesting; notice that in this range all $n$-vertex graphs with minimum degree at least $\\delta$ are connected. The the following question has been answered in the special case of independent sets \\cite{CutlerRadcliffe}.\n\\begin{question}\nFix any $H$, and let $n<2\\delta$.  Which $n$-vertex graph with minimum degree $\\delta$ maximizes the number of $H$-colorings?\n\\end{question}\nWe can ask these questions for the family of all $n$-vertex graphs with minimum degree $\\delta$; answers for some $H$ and sufficiently large $n$ are given in \\cite{Engbers}.\n\\begin{question}\nFix any $H$. Which $n$-vertex graph with minimum degree $\\delta$ maximizes the number of $H$-colorings?\n\\end{question}\n\\begin{question}\nFix $q$. Which $n$-vertex graph with minimum degree $\\delta$ maximizes the number of proper $q$-colorings?\n\\end{question}\nNote that when $q=2$, we seek the $n$-vertex graph with minimum degree $\\delta$ that has the largest number of bipartite components, and so the maximizing graph is $\\frac{n}{2\\delta}K_{\\delta,\\delta}$.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\begin{thebibliography}{10}\n\n\\bibitem{CsikvariLin} P. Csikv\\'ari and Z. Lin, Graph homomorphisms between trees, {\\em Electronic J. Combinatorics} {\\bf 21(4)} (2014), \\#P4.9.\n\n\\bibitem{Cutler} J. Cutler, Coloring graphs with graphs: a survey, {\\em Graph Theory Notes N.Y.} {\\bf 63} (2012), 7-16.\n\n\\bibitem{CutlerRadcliffe} J. Cutler and J. Racliffe, The maximum number of complete graphs in a graph with given maximum degree, {\\em J. Combin. Theory Ser. B} {\\bf 104} (2014), 60-71.\n\n\\bibitem{Engbers} J. Engbers, Extremal $H$-colorings of graphs with fixed minimum degree, {\\em J. Graph Theory} {\\bf 79} (2015) 103--124.\n\n\\bibitem{EngbersGalvin} J. Engbers and D. Galvin, Extremal $H$-colorings of trees and 2-connected graphs, http://arxiv.org/abs/1506.05388.\n\n\n\n\\bibitem{GalvinTetali} D. Galvin and P. Tetali, On weighted graph homomorphisms, {\\em Graphs, Morphisms,\nand Statistical Physics, DIMACS Ser. in Discrete Math. Theoret. Comput.\nSci.} {\\bf 63} (2004), 97-104.\n\n\\bibitem{Kahn} J. Kahn, An entropy approach to the hard-core model on bipartite graphs,\n{\\em Combin. Probab. and Comput.} {\\bf 10} (2001), 219-237.\n\n\\bibitem{Sernau} L. Sernau, Graph operations and upper bounds on graph homomorphism counts, http://arxiv.org/abs/1510.01833.\n\n\\bibitem{Sidorenko} A. Sidorenko, A partially ordered set of functionals corresponding to graphs, {\\em Discrete Math.} {\\bf 131} (1994), 263-277.\n\n\\bibitem{Zhao} Y. Zhao, The number of independent sets in a regular graph, {\\em Combin. Probab. Comput.} {\\bf 19} (2010), 315-320.\n\n\\bibitem{Zhao2} Y. Zhao, The bipartite swapping trick on graph homomorphisms, {\\em SIAM J. Discrete Math} {\\bf 25} (2011), 660-680.\n\\end{thebibliography}\n\n\n\n\n", "itemtype": "equation", "pos": 19138, "prevtext": "\ncolorings of $K_{\\delta,n-\\delta}$ that have the same color on two or more vertices in the size $\\delta$ partition class. This means that there are at most\n", "index": 15, "text": "\n\\[\nq(q-1)\\cdots(q-\\delta+1)(q-\\delta)^{n-\\delta} + \\delta^2 q^{n-1}\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex8.m1\" class=\"ltx_Math\" alttext=\"q(q-1)\\cdots(q-\\delta+1)(q-\\delta)^{n-\\delta}+\\delta^{2}q^{n-1}\" display=\"block\"><mrow><mrow><mi>q</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>q</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi mathvariant=\"normal\">\u22ef</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mi>q</mi><mo>-</mo><mi>\u03b4</mi></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>q</mi><mo>-</mo><mi>\u03b4</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mi>n</mi><mo>-</mo><mi>\u03b4</mi></mrow></msup></mrow><mo>+</mo><mrow><msup><mi>\u03b4</mi><mn>2</mn></msup><mo>\u2062</mo><msup><mi>q</mi><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow></mrow></math>", "type": "latex"}]