[{"file": "1601.00157.tex", "nexttext": "\nwhere $\\Gamma_\\mathrm{a}^+ = \\gamma-{\\mathrm{i}} (\\Delta_\\mathrm{a}+\\delta)$ is the complex detuning of the anti-Stokes field from the populated transition and $\\tau = L/c$ is the cavity roundtrip time. However in an experiment the roundtrip absorption and loss can be inferred from the cavity transmission spectrum \\cite{Munns:2015}. Note that we have neglected decoherence of the spin wave, since this is by assumption slow on the time-scale of the memory interactions. The system (\\ref{Maxwell}) can be solved analytically \\cite{Wu:2010aa}, but in the limit that the interaction with the atoms is weak over the course of a single pass through the cavity, the fields $A_L$, $S_L$ emerging from the interaction at $z=L$ can be related to the amplitudes $S_0$, $A_0$, $B_0$ at $z=0$ by a Taylor expansion,\n\\begin{eqnarray}\n\\nonumber S_L &\\approx& S_0 + L \\partial_z S |_{z=0} \\\\\n\\nonumber &=& e^{-\\kappa_\\mathrm{s}\\tau}S_0 + {\\mathrm{i}} c\\tau \\sqrt{\\frac{d\\gamma}{L}} \\frac{\\Omega}{\\Gamma_\\mathrm{s}} B_0 -\\tau \\partial_t S_0;\\\\\n\\nonumber A_L &\\approx& A_0 + L \\partial_z A |_{z=0}\\\\\n\\label{Taylor} &=& e^{-\\kappa_\\mathrm{a}\\tau}A_0 + {\\mathrm{i}} c\\tau \\sqrt{\\frac{d\\gamma}{L}} \\frac{\\Omega}{\\Gamma_\\mathrm{a}} B_0^\\dagger -\\tau \\partial_t A_0,\n\\end{eqnarray}\nwhere we assumed $|\\kappa_\\mathrm{s,a}|\\tau \\ll 1$ in forming the exponentials. \n\n\\begin{figure}[h]\n\\begin{center}\n\\includegraphics[width=5.5cm]{cavity_memory.png}\n\\caption{(a) We model the dynamics of the cavity-enhanced $\\Lambda$-memory by considering the propagation of Stokes and anti-Stokes fields around a ring cavity through a storage medium comprising an ensemble of $\\Lambda$-type atoms. The boundary conditions imposed by the input/output coupler with amplitude reflectivity $r$ connects the intra-cavity fields to the incident and emitted fields. (b) The cavity resonances are tuned to suppress the density of scattering states (black peaks) at the anti-Stokes frequency with respect to the Stokes frequency. Tuned mid-way between the Stokes and anti-Stokes frequencies, the control field can be resonantly coupled into the cavity in an orthogonal polarisation mode (grey peaks) \\cite{Saunders:2015aa}.}\n\\label{fig:cavity_memory}\n\\end{center}\n\\end{figure}\nTo capture the intra-cavity dynamics we now `close the loop' by imposing as a boundary condition the beam splitter relation at the input-output coupler, with amplitude reflectivity $r$ (assumed real for simplicity),\n\\begin{eqnarray}\n\\nonumber S_0 &=& re^{{\\mathrm{i}} k_\\mathrm{s} L}S_L + t_rS_\\mathrm{in},\\\\\n\\label{bound} A_0 &=& re^{{\\mathrm{i}} k_\\mathrm{a} L}A_L + t_rA_\\mathrm{in},\n\\end{eqnarray}\nwhere $t_r = \\sqrt{1-r^2}$ is the input-output coupler amplitude transmission, $k_\\mathrm{s}$ ($k_\\mathrm{a}$) denotes the signal (anti-Stokes) carrier wavevector, and we have introduced the input field amplitudes $A_\\mathrm{in}$, $S_\\mathrm{in}$ impinging on the cavity from the outside. Substituting the solutions (\\ref{Taylor}) into (\\ref{bound}) we obtain\n\\begin{eqnarray}\n\\nonumber \\partial_t s & = & -\\gamma_\\mathrm{s} s + {\\mathrm{i}} \\sqrt{\\frac{d\\gamma}{\\tau}}\\frac{\\Omega}{\\Gamma_\\mathrm{s}} b + e^{-{\\mathrm{i}} k_\\mathrm{s} L}\\frac{t_r}{r\\sqrt{\\tau}} S_\\mathrm{in}, \\\\\n\\nonumber \\partial_t a & = & -\\gamma_\\mathrm{a} a  + {\\mathrm{i}} \\sqrt{\\frac{d\\gamma}{\\tau}}\\frac{\\Omega}{\\Gamma_\\mathrm{a}} b^\\dagger + e^{-{\\mathrm{i}} k_\\mathrm{a} L}\\frac{t_r}{r\\sqrt{\\tau}} A_\\mathrm{in}, \\\\\n\\label{intra} \\partial_t b & = &  {\\mathrm{i}} \\sqrt{\\frac{d\\gamma}{\\tau}}\\left[ -\\frac{\\Omega^*}{\\Gamma_\\mathrm{s}} s + \\frac{\\Omega}{\\Gamma_\\mathrm{a}}a^\\dagger \\right] - \\left[ \\frac{1}{\\Gamma_\\mathrm{s}}  + \\frac{1}{\\Gamma_\\mathrm{a}^*} \\right] |\\Omega|^2 b,\n\\end{eqnarray}\nwhere we have defined the intra-cavity field-amplitudes $a = \\sqrt{\\tau}A_0$, $s=\\sqrt{\\tau}S_0$, as in \\cite{Raymer:2013aa}, and similarly $b = \\sqrt{L}B_0$, and the resonant and anti-resonant decay rates\n\n", "itemtype": "equation", "pos": 11297, "prevtext": "\n\n\\title{Theory of noise suppression in $\\Lambda$-type quantum memories by means of a cavity}\n\n\\author{J.~Nunn$^1$, S.~Thomas$^{1,2}$, J.~H.~D.~Munns$^{1,2}$, K.~T.~Kaczmarek$^1$, C.~Qiu$^{1,3}$, A.~Feizpour$^{1}$, E.~Poem$^{1}$, B.~Brecht$^{1}$, D.~J.~Saunders$^{1}$, P.~M.~Ledingham$^1$, Dileep~V.~Reddy$^4$, M.~G.~Raymer$^4$, I.~A.~Walmsley$^1$}\n\n\\affiliation{$^{1}$Clarendon Laboratory, University of Oxford, Parks Road, Oxford OX1 3PU, United Kingdom\\\\\n$^{2}$ QOLS, Blackett Laboratory, Imperial College London, London SW7 2BW, UK\\\\\n$^{3}$Department of Physics, Quantum Institute for Light and Atoms, State Key Laboratory of Precision Spectroscopy, East China Normal University, Shanghai 200062, People's Republic of China\\\\\n$^{4}$Oregon Center for Optics, Department of Physics, University of Oregon, Eugene, Oregon 97403, USA\n}\n\n\n\n\\begin{abstract}\nQuantum memories, capable of storing single photons or other quantum states of light, to be retrieved on-demand, offer a route to large-scale quantum information processing with light. A promising class of memories is based on far-off-resonant Raman absorption in ensembles of $\\Lambda$-type atoms. However at room temperature these systems exhibit unwanted four-wave mixing, which is prohibitive for applications at the single-photon level. Here we show how this noise can be suppressed by placing the storage medium inside a moderate-finesse optical cavity, thereby removing the main roadblock hindering this approach to quantum memory.\n\\end{abstract}\n\n\\pacs{42.50.Ex, 42.50.Ct, 42.50.-p}\n\n\n\n\n\n\\maketitle\n\\section{Introduction}\nThe need for low-loss active switching or synchronisation of non-deterministic operations in a linear-optical quantum information processor has emerged over the past few years as a \\emph{sine qua non} for the development of large-scale photonics-based quantum technologies \\cite{Migdall:2002cr,McCusker:2008ve,Nunn:2013aa,Francis-Jones:2015aa,Rohde:2015aa}. Experiments with optical switches are making rapid progress \\cite{Makino:2015aa,Kaneda:2015aa,Meany:2014aa,Mendoza:2015aa}. Quantum memories based on the coherent and reversible absorption of photons in an atomic ensemble are being developed by many groups as an alternative to optical switching \\cite{Bussieres:2013aa,Afzelius:2010aa,Hammerer:2010vn,Simon:2010aa,Lvovsky:2009ve}, with impressive demonstrations of the preservation of quantum correlations and of temporal synchronisation of photons, using cold atoms \\cite{Chen:2006aa} and cold doped crystals \\cite{Bussieres:2014aa}. An important class of memory protocol is based on stimulated two-photon transitions in a $\\Lambda$-type atomic ensemble, where a bright control laser field couples the incident signal photons to a ground-state coherence in the atoms \\cite{Reim:2010kx}. Memories based on electromagnetically-induced transparency (EIT) \\cite{Fleischhauer:2002ph,Choi:2008xi,Kupchak:2015aa} and on far-off-resonant Raman absorption \\cite{Nunn:2007aa,Ding:2015aa,Hosseini:2011zr} both fall into this category, and in the following we will refer to all such memories as \\emph{$\\Lambda$-memories}. $\\Lambda$-memories in cold atoms have successfully stored single photons, but at room-temperature it was found that fluorescence noise \\cite{Manz:2007aa} and four-wave mixing \\cite{Phillips:2008uq} became problematic. Our group recently interfaced a single-photon source with a Raman memory and measured the photon number statistics of the retrieved fields \\cite{Michelberger:2015aa}. There it was found that while fluorescence noise was negligible for off-resonant storage of short pulses, the thermal noise contributed by four-wave mixing destroyed the anti-bunching characteristic of single photons. Four-wave mixing noise is therefore the key roadblock preventing the implementation of $\\Lambda$-memories at room temperature \\cite{Lauk:2013aa,Dabrowski:2014aa}. A number of solutions have been suggested \\cite{Romanov:2015aa,Zhang:2014aa}. We recently demonstrated that four-wave mixing can be suppressed by placing the memory storage medium inside an optical cavity \\cite{Saunders:2015ab}. In this paper we present a theoretical analysis of this method of noise suppression. We show that a moderate-finesse cavity can, under realistic conditions, suppress four-wave mixing noise to a negligible level, while at the same time dramatically reducing the footprint and energy requirements of the memory compared to free-space implementations, and maintaining broadband operation. We also point out that the cavity-enhanced memory is nearly perfectly-temporal-mode-selective \\cite{Reddy:2015aa}, making it an appealing system for chronocyclic encodings of quantum information \\cite{Brecht:2015ac}.\n\n\\section{Four wave mixing in $\\Lambda$-memories}\nAlthough the detailed dynamics in $\\Lambda$-memories differ depending on the protocol employed (EIT, Raman, $\\Lambda$-GEM), all such memories share the same kinematical description, shown in Fig.~\\ref{fig:mem_and_FWM}. That is, an ensemble of $\\Lambda$-type atoms are prepared in one of their two ground states, and then an incident signal field is coupled to the empty storage state by a strong control field tuned into two-photon resonance with the signal. Four-wave mixing arises in this system when the strong control field couples to the ground state and drives off-resonant spontaneous Raman scattering (in the diagram this is anti-Stokes scattering because we have chosen to pump the atoms into the higher of the two ground state levels). The scattered anti-Stokes field is at a different frequency from the signal field and does not directly contribute any noise. But each scattering event is accompanied by one of the atoms switching state from $\\left | \\, {1} \\right \\rangle$ to $\\left | \\, {3} \\right \\rangle$. That is, the scattering spontaneously generates excitations of the ground-state coherence that are indistinguishable from the excitations produced by successful storage of the signal field. When the memory is read-out, these excitations are retrieved as noise. The nomenclature `four-wave mixing' applies because there are four optical fields that coherently interact, even though they may not overlap in time. These are: the control; the anti-Stokes; the control again and finally the retrieved (noisy) signal.\n\n\n\n\\begin{figure}[h]\n\\begin{center}\n\\includegraphics[width=\\columnwidth]{mem_and_FWM.png}\n\\caption{(a) A control field (green) mediates the storage of a signal field (red) in a free-space $\\Lambda$-memory. The control field can drive the spontaneous Raman emission of an anti-Stokes field (blue) that generates a spurious excitation in the memory. (b) Atomic transitions driven in the storage interaction (c) the retrieval interaction. (d) Four-wave mixing noise refers to the retrieval of the spurious excitation generated by the anti-Stokes scattering.}\n\\label{fig:mem_and_FWM}\n\\end{center}\n\\end{figure}\n\n\\section{Model}\nWe now propose and analyse a scheme to inhibit four-wave mixing by using an optical cavity to modify the density of scattering states so that Stokes scattering is enhanced and anti-Stokes scattering is suppressed. That is, we tune the cavity into resonance with the Stokes frequency --- this is also the frequency of the signal to be stored --- whereas we ensure that the anti-Stokes frequency is anti-resonant (Fig.~\\ref{fig:cavity_memory} (b)). Below we introduce a model that shows how four-wave mixing noise is suppressed by this arrangement.\n\nWe consider a $\\Lambda$-memory storage medium with ground state splitting $\\delta$ placed inside a ring cavity \\footnote{The ring geometry simplifies the analysis to follow, but it also has the practical advantage that the intra-cavity fields are running waves without nodes at zero intensity. This ensures that atoms interacting with the fields during read-in do not escape interaction at retrieval by diffusing into the `dark' field nodes during the storage time.} as shown in Fig.~\\ref{fig:cavity_memory} (a). Such a cavity can be successfully described with cavity input-output theory \\cite{Walls:2007aa} and the operation of $\\Lambda$-memories in a cavity has been analysed in this way \\cite{Gorshkov:2007aa}. However, cavity input-output theory is not suited to the description of fields tuned out of resonance with a cavity. To proceed, we instead follow the generalised input-output theory of Raymer and McKinstrie \\cite{Raymer:2013aa} and consider the traveling-wave propagation of the signal (Stokes) field $S$ and the anti-Stokes field $A$ around the ring-cavity. The fields interact with the atomic ensemble in the presence of the control pulse, with Rabi frequency $\\Omega$, according to the linearised Maxwell-Bloch equations, which in the limit of a sufficiently smooth control, such that the excited state $\\left | \\, {2} \\right \\rangle$ can be adiabatically eliminated, take the form \\cite{Phillips:2011aa,Wu:2010aa,Wasilewski:2006th}\n\\begin{eqnarray}\n\\nonumber \\left(c\\partial_z + \\partial_t\\right)S&=&{\\mathrm{i}} c\\sqrt{\\frac{d\\gamma}{L}}\\frac{\\Omega}{\\Gamma_\\mathrm{s}} B -\\kappa_\\mathrm{s}S,  \\\\\n\\nonumber \\left(c\\partial_z + \\partial_t\\right)A&=&{\\mathrm{i}} c\\sqrt{\\frac{d\\gamma}{L}}\\frac{\\Omega}{\\Gamma_\\mathrm{a}} B^\\dagger -\\kappa_\\mathrm{a}A,  \\\\\n\\nonumber \\partial_t B &=& -{\\mathrm{i}} \\sqrt{\\frac{d\\gamma}{L}}\\frac{\\Omega^*}{\\Gamma_\\mathrm{s}}S + {\\mathrm{i}} \\sqrt{\\frac{d\\gamma}{L}}\\frac{\\Omega}{\\Gamma_\\mathrm{a}}A^\\dagger \\\\\n\\label{Maxwell}& & - \\left[ \\frac{1}{\\Gamma_\\mathrm{s}}+\\frac{1}{\\Gamma_\\mathrm{a}^*}\\right]|\\Omega |^2  B,\n\\end{eqnarray}\nwhere the $z$-coordinate parameterises the position along the folded optical path inside the cavity. The system (\\ref{Maxwell}) is to be interpreted as describing the evolution of the slowly varying annihilation operators $S$, $A$ in the Heisenberg picture, with the bosonic spin wave annihilation operator given by $B = \\sum_{j \\in [z,z+\\delta z]}\\left | \\, {1} \\right \\rangle_{\\!j}\\!\\!\\left \\langle {3} \\, \\right |/\\delta z \\sqrt{N/L}$ describing the amplitude of the Raman coherence excited in the $\\Lambda$-memory. The optical and spin wave fields satisfy canonical commutation relations $[S(t,z),S^\\dagger(t',z)]=[A(t,z),A^\\dagger(t',z)]=\\delta(t-t')$, $[B(t,z),B^\\dagger(t,z')]=\\delta(z-z')$. The operator nature of (\\ref{Maxwell}) is key to the analysis of spontaneous four-wave mixing noise. The meanings of the other symbols are as follows. $\\Gamma_\\mathrm{s,a} = \\gamma - {\\mathrm{i}} \\Delta_\\mathrm{s,a}$ denotes the complex detuning of the signal and anti-Stokes fields from the atomic resonance with homogeneous linewidth $\\gamma$. The complex decay rates $\\kappa_\\mathrm{s,a}$ account for dispersion, absorption and other scattering losses as the fields propagate. Strictly the losses in (\\ref{Maxwell}) should be accompanied by Langevin noise operators which maintain the bosonic commutation relations of the field operators, but vacuum noise does not contribute to the signal intensity and can be neglected \\cite{Gorshkov:2007aa}. The signal coupling strength is parameterised by the single-pass resonant optical depth $d$ of the atomic ensemble, with $N$ atoms in the signal beam path of length $L$ \\cite{Gorshkov:2007qm}. Neglecting inhomogeneous broadening (generally valid far from resonance) the absorption and dispersion are given by \n\n", "index": 1, "text": "\\begin{equation}\n\\label{kappas}\n\\kappa_\\mathrm{s} = \\frac{d\\gamma}{\\tau\\Gamma_\\mathrm{s}}\\,;\\qquad \\kappa_\\mathrm{a}=\\frac{d\\gamma}{\\tau\\Gamma_\\mathrm{a}^+},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"\\kappa_{\\mathrm{s}}=\\frac{d\\gamma}{\\tau\\Gamma_{\\mathrm{s}}}\\,;\\qquad\\kappa_{%&#10;\\mathrm{a}}=\\frac{d\\gamma}{\\tau\\Gamma_{\\mathrm{a}}^{+}},\" display=\"block\"><mrow><mrow><mrow><msub><mi>\u03ba</mi><mi mathvariant=\"normal\">s</mi></msub><mo>=</mo><mpadded width=\"+1.7pt\"><mfrac><mrow><mi>d</mi><mo>\u2062</mo><mi>\u03b3</mi></mrow><mrow><mi>\u03c4</mi><mo>\u2062</mo><msub><mi mathvariant=\"normal\">\u0393</mi><mi mathvariant=\"normal\">s</mi></msub></mrow></mfrac></mpadded></mrow><mo rspace=\"22.5pt\">;</mo><mrow><msub><mi>\u03ba</mi><mi mathvariant=\"normal\">a</mi></msub><mo>=</mo><mfrac><mrow><mi>d</mi><mo>\u2062</mo><mi>\u03b3</mi></mrow><mrow><mi>\u03c4</mi><mo>\u2062</mo><msubsup><mi mathvariant=\"normal\">\u0393</mi><mi mathvariant=\"normal\">a</mi><mo>+</mo></msubsup></mrow></mfrac></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.00157.tex", "nexttext": "\nwhere $\\phi_\\mathrm{s,a} = k_\\mathrm{s,a}L - \\Im\\{\\kappa_\\mathrm{s,a}\\}\\tau$ is the cavity roundtrip phase accumulated by the fields, including any dispersion induced by the atomic ensemble, and where the cavity roundtrip amplitude transmission, including any atomic absorption, is given by $\\mu_\\mathrm{s,a} = r e^{-\\Re\\{\\kappa_\\mathrm{s,a}\\}\\tau}$. If there are additional losses due to scattering from surfaces inside the cavity, or partial transmission through cavity mirrors, these can be incorporated into $\\mu_\\mathrm{s,a}$. The system of coupled equations (\\ref{intra}) takes a form that might be written down using cavity input-output theory, except that we are able to treat the dynamics of both the Stokes and anti-Stokes fields, with one being resonant and the other off-resonant with the cavity, as determined by the phases $\\phi_\\mathrm{s,a}$.\n\n\n\\section{Bad cavity limit}\nTo proceed to a solution, we once more invoke the bad cavity approximation, in which the fields impinging on the cavity are much more narrowband than the cavity linewidth \\cite{Gorshkov:2007aa}. Specifically, then, we require that $|\\partial_t s| \\ll |\\gamma_\\mathrm{s} s|$, with commensurate bandwidths for the anti-Stokes and control fields. In this limit, we solve for $s$ and $a$ in terms of $b$ by setting $\\partial_t s = \\partial_t a \\approx 0$, to obtain\n\\begin{eqnarray}\n\\nonumber s&=&{\\mathrm{i}} \\sqrt{\\frac{d\\gamma}{\\tau}}\\frac{\\Omega}{\\Gamma_\\mathrm{s} \\gamma_\\mathrm{s}} b+e^{-{\\mathrm{i}} k_\\mathrm{s} L} \\frac{t_r}{\\gamma_\\mathrm{s} r \\sqrt{\\tau}}S_\\mathrm{in}, \\\\\n\\label{dtzero} a&=&{\\mathrm{i}} \\sqrt{\\frac{d\\gamma}{\\tau}}\\frac{\\Omega}{\\Gamma_\\mathrm{a} \\gamma_\\mathrm{a}} b^\\dagger +e^{-{\\mathrm{i}} k_\\mathrm{a} L} \\frac{t_r}{\\gamma_\\mathrm{a} r \\sqrt{\\tau}}A_\\mathrm{in}, \\\\\n\\nonumber\n \\partial_t b &=&  \\left\\{\\frac{d\\gamma}{\\tau}\\left[ \\frac{1}{\\Gamma_\\mathrm{s}^2 \\gamma_\\mathrm{s}} + \\frac{1}{|\\Gamma_\\mathrm{a}|^2 \\gamma_\\mathrm{a}^*}\\right] -  \\frac{1}{\\Gamma_\\mathrm{s}}  -  \\frac{1}{\\Gamma_\\mathrm{a}^*} \\right\\}|\\Omega|^2 b \\\\\n\\nonumber & & +{\\mathrm{i}} \\frac{t_r\\sqrt{d\\gamma}}{r\\tau}\\left[ \\frac{\\Omega^*}{\\Gamma_\\mathrm{s} \\gamma_\\mathrm{s}} e^{-{\\mathrm{i}} k_\\mathrm{s} L}S_\\mathrm{in} +\\frac{\\Omega}{\\Gamma_\\mathrm{a} \\gamma_\\mathrm{a}^*}e^{{\\mathrm{i}} k_\\mathrm{a} L}A_\\mathrm{in}^\\dagger\\right].\n\\end{eqnarray}\nAt this point, it is convenient to remove the dependence on the temporal shape of the control field by making a coordinate transformation $t \\longrightarrow \\epsilon(t) = \\int_{-\\infty}^t |\\Omega(t')|^2\\,{\\mathrm{d}} t'/W$, with $W$ chosen so that $\\epsilon(\\infty) = 1$. Then we have $\\partial_t = W^{-1}|\\Omega(t)|^2 \\partial_\\epsilon$ \\cite{Nunn:2007aa, Reim:2010kx}. Defining normalised signal and anti-Stokes field amplitudes $\\sigma = s\\sqrt{W}/\\Omega$ and $\\alpha = a\\sqrt{W}/\\Omega$, the system (\\ref{dtzero}) becomes\n\\begin{eqnarray}\n\\nonumber \\sigma&=&c_\\mathrm{s} b +p_\\mathrm{s}\\sigma_\\mathrm{in}, \\\\\n\\nonumber \\alpha&=&c_\\mathrm{a}b^\\dagger +p_\\mathrm{a}\\alpha_\\mathrm{in}, \\\\\n\\nonumber\n \\partial_\\epsilon b &=& f b + g_\\mathrm{s} \\sigma_\\mathrm{in} + g_\\mathrm{a} \\alpha_\\mathrm{in}^\\dagger,\n\\end{eqnarray}\nwhere we pulled the various constants into the coefficients\n\\begin{eqnarray}\n\\nonumber c_\\mathrm{s,a} &=& {\\mathrm{i}} \\sqrt{\\frac{d\\gamma W}{\\tau}}\\frac{1}{\\Gamma_\\mathrm{s,a} \\gamma_\\mathrm{s,a}},\\\\\n\\nonumber  p_\\mathrm{s,a} &=& \\frac{t_re^{-{\\mathrm{i}} k_\\mathrm{s,a} L}}{\\gamma_\\mathrm{s,a}r\\sqrt{\\tau}},\\\\\n\\label{defs} f &=&W\\left[\\frac{d\\gamma}{\\tau} \\left(\\frac{1}{\\Gamma_\\mathrm{s}^2 \\gamma_\\mathrm{s}} + \\frac{1}{|\\Gamma_\\mathrm{a}|^2\\gamma_\\mathrm{a}^*}\\right) - \\frac{1}{\\Gamma_\\mathrm{s}} - \\frac{1}{\\Gamma_\\mathrm{a}^*} \\right],\\\\\n\\nonumber g_\\mathrm{s} &=& {\\mathrm{i}} \\frac{t_r e^{-{\\mathrm{i}} k_\\mathrm{s} L} \\sqrt{d\\gamma W}}{\\Gamma_\\mathrm{s} \\gamma_\\mathrm{s}\\tau r}\\,;\\quad g_\\mathrm{a} = {\\mathrm{i}} \\frac{t_r e^{{\\mathrm{i}} k_\\mathrm{a} L} \\sqrt{d\\gamma W}}{\\Gamma_\\mathrm{a} \\gamma_\\mathrm{a}^*\\tau r}.\n\\end{eqnarray}\nNote that the above transformations are unitary so the operators $\\alpha$, $\\sigma$, $b$ obey the canonical relations $[\\alpha,\\alpha^\\dagger]=[\\sigma,\\sigma^\\dagger]=[b,b^\\dagger]=1$. Solving for $b$ gives\n\\begin{eqnarray}\n\\nonumber b(\\epsilon) &=& b(0)e^{f\\epsilon} + \\int_0^1\\!\\!{\\mathrm{d}} \\epsilon' \\, M_\\mathrm{c}(\\epsilon,\\epsilon')\\Big\\{ g_\\mathrm{s} \\sigma_\\mathrm{in}(\\epsilon') \\\\\n\\label{bsolve} & &\\left.+ g_\\mathrm{a} \\alpha_\\mathrm{in}^\\dagger(\\epsilon')\\right\\},\n\\end{eqnarray}\nwhere we have defined $M_\\mathrm{c}(\\epsilon,\\epsilon') = \\Theta(\\epsilon-\\epsilon')M(\\epsilon,\\epsilon')$ as the causal version of the cavity response function $M(\\epsilon,\\epsilon') = e^{f[\\epsilon-\\epsilon']}$, with $\\Theta$ denoting the Heaviside step-function.\n\nNow we are ready to solve for the outgoing fields emerging from the cavity, using again the beam splitter boundary conditions at the input-output coupler,\n\\begin{eqnarray}\n\\nonumber S_\\mathrm{out}&=& t_re^{{\\mathrm{i}} k_\\mathrm{s}L} S_L-rS_\\mathrm{in}(t),  \\\\\n\\label{out} A_\\mathrm{out}&=& t_re^{{\\mathrm{i}} k_\\mathrm{a}L} A_L-rA_\\mathrm{in}(t).\n\\end{eqnarray}\nIn the limit of weak single-pass coupling, we can approximate (\\ref{Taylor}) by $e^{{\\mathrm{i}} k_\\mathrm{s} L}S_L \\approx e^{{\\mathrm{i}} \\phi_\\mathrm{s}}S_0$, retaining only the phase evolution of the Stokes field as it traverses the cavity \\footnote{Note that re-using the Taylor expansion in (\\ref{Taylor}) actually exacerbates the truncation error of the weak-interaction approximation and gives an incorrect result for (\\ref{outfield}).}.  Substituting this into (\\ref{out}) and using (\\ref{dtzero}), the output field, switching back to the normalised variables $\\sigma_\\mathrm{in,out} = S_\\mathrm{in,out}\\sqrt{W}/\\Omega$, is found to be\n\n\n\n\n\n", "itemtype": "equation", "pos": 15379, "prevtext": "\nwhere $\\Gamma_\\mathrm{a}^+ = \\gamma-{\\mathrm{i}} (\\Delta_\\mathrm{a}+\\delta)$ is the complex detuning of the anti-Stokes field from the populated transition and $\\tau = L/c$ is the cavity roundtrip time. However in an experiment the roundtrip absorption and loss can be inferred from the cavity transmission spectrum \\cite{Munns:2015}. Note that we have neglected decoherence of the spin wave, since this is by assumption slow on the time-scale of the memory interactions. The system (\\ref{Maxwell}) can be solved analytically \\cite{Wu:2010aa}, but in the limit that the interaction with the atoms is weak over the course of a single pass through the cavity, the fields $A_L$, $S_L$ emerging from the interaction at $z=L$ can be related to the amplitudes $S_0$, $A_0$, $B_0$ at $z=0$ by a Taylor expansion,\n\\begin{eqnarray}\n\\nonumber S_L &\\approx& S_0 + L \\partial_z S |_{z=0} \\\\\n\\nonumber &=& e^{-\\kappa_\\mathrm{s}\\tau}S_0 + {\\mathrm{i}} c\\tau \\sqrt{\\frac{d\\gamma}{L}} \\frac{\\Omega}{\\Gamma_\\mathrm{s}} B_0 -\\tau \\partial_t S_0;\\\\\n\\nonumber A_L &\\approx& A_0 + L \\partial_z A |_{z=0}\\\\\n\\label{Taylor} &=& e^{-\\kappa_\\mathrm{a}\\tau}A_0 + {\\mathrm{i}} c\\tau \\sqrt{\\frac{d\\gamma}{L}} \\frac{\\Omega}{\\Gamma_\\mathrm{a}} B_0^\\dagger -\\tau \\partial_t A_0,\n\\end{eqnarray}\nwhere we assumed $|\\kappa_\\mathrm{s,a}|\\tau \\ll 1$ in forming the exponentials. \n\n\\begin{figure}[h]\n\\begin{center}\n\\includegraphics[width=5.5cm]{cavity_memory.png}\n\\caption{(a) We model the dynamics of the cavity-enhanced $\\Lambda$-memory by considering the propagation of Stokes and anti-Stokes fields around a ring cavity through a storage medium comprising an ensemble of $\\Lambda$-type atoms. The boundary conditions imposed by the input/output coupler with amplitude reflectivity $r$ connects the intra-cavity fields to the incident and emitted fields. (b) The cavity resonances are tuned to suppress the density of scattering states (black peaks) at the anti-Stokes frequency with respect to the Stokes frequency. Tuned mid-way between the Stokes and anti-Stokes frequencies, the control field can be resonantly coupled into the cavity in an orthogonal polarisation mode (grey peaks) \\cite{Saunders:2015aa}.}\n\\label{fig:cavity_memory}\n\\end{center}\n\\end{figure}\nTo capture the intra-cavity dynamics we now `close the loop' by imposing as a boundary condition the beam splitter relation at the input-output coupler, with amplitude reflectivity $r$ (assumed real for simplicity),\n\\begin{eqnarray}\n\\nonumber S_0 &=& re^{{\\mathrm{i}} k_\\mathrm{s} L}S_L + t_rS_\\mathrm{in},\\\\\n\\label{bound} A_0 &=& re^{{\\mathrm{i}} k_\\mathrm{a} L}A_L + t_rA_\\mathrm{in},\n\\end{eqnarray}\nwhere $t_r = \\sqrt{1-r^2}$ is the input-output coupler amplitude transmission, $k_\\mathrm{s}$ ($k_\\mathrm{a}$) denotes the signal (anti-Stokes) carrier wavevector, and we have introduced the input field amplitudes $A_\\mathrm{in}$, $S_\\mathrm{in}$ impinging on the cavity from the outside. Substituting the solutions (\\ref{Taylor}) into (\\ref{bound}) we obtain\n\\begin{eqnarray}\n\\nonumber \\partial_t s & = & -\\gamma_\\mathrm{s} s + {\\mathrm{i}} \\sqrt{\\frac{d\\gamma}{\\tau}}\\frac{\\Omega}{\\Gamma_\\mathrm{s}} b + e^{-{\\mathrm{i}} k_\\mathrm{s} L}\\frac{t_r}{r\\sqrt{\\tau}} S_\\mathrm{in}, \\\\\n\\nonumber \\partial_t a & = & -\\gamma_\\mathrm{a} a  + {\\mathrm{i}} \\sqrt{\\frac{d\\gamma}{\\tau}}\\frac{\\Omega}{\\Gamma_\\mathrm{a}} b^\\dagger + e^{-{\\mathrm{i}} k_\\mathrm{a} L}\\frac{t_r}{r\\sqrt{\\tau}} A_\\mathrm{in}, \\\\\n\\label{intra} \\partial_t b & = &  {\\mathrm{i}} \\sqrt{\\frac{d\\gamma}{\\tau}}\\left[ -\\frac{\\Omega^*}{\\Gamma_\\mathrm{s}} s + \\frac{\\Omega}{\\Gamma_\\mathrm{a}}a^\\dagger \\right] - \\left[ \\frac{1}{\\Gamma_\\mathrm{s}}  + \\frac{1}{\\Gamma_\\mathrm{a}^*} \\right] |\\Omega|^2 b,\n\\end{eqnarray}\nwhere we have defined the intra-cavity field-amplitudes $a = \\sqrt{\\tau}A_0$, $s=\\sqrt{\\tau}S_0$, as in \\cite{Raymer:2013aa}, and similarly $b = \\sqrt{L}B_0$, and the resonant and anti-resonant decay rates\n\n", "index": 3, "text": "\\begin{equation}\n\\label{decay} \\gamma_\\mathrm{s,a} = e^{-{\\mathrm{i}} k_\\mathrm{s,a} L}\\frac{1-\\mu_\\mathrm{s,a} e^{{\\mathrm{i}} \\phi_\\mathrm{s,a}}}{r\\tau},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"\\gamma_{\\mathrm{s,a}}=e^{-{\\mathrm{i}}k_{\\mathrm{s,a}}L}\\frac{1-\\mu_{\\mathrm{s%&#10;,a}}e^{{\\mathrm{i}}\\phi_{\\mathrm{s,a}}}}{r\\tau},\" display=\"block\"><mrow><mrow><msub><mi>\u03b3</mi><mrow><mi mathvariant=\"normal\">s</mi><mo>,</mo><mi mathvariant=\"normal\">a</mi></mrow></msub><mo>=</mo><mrow><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi mathvariant=\"normal\">i</mi><mo>\u2062</mo><msub><mi>k</mi><mrow><mi mathvariant=\"normal\">s</mi><mo>,</mo><mi mathvariant=\"normal\">a</mi></mrow></msub><mo>\u2062</mo><mi>L</mi></mrow></mrow></msup><mo>\u2062</mo><mfrac><mrow><mn>1</mn><mo>-</mo><mrow><msub><mi>\u03bc</mi><mrow><mi mathvariant=\"normal\">s</mi><mo>,</mo><mi mathvariant=\"normal\">a</mi></mrow></msub><mo>\u2062</mo><msup><mi>e</mi><mrow><mi mathvariant=\"normal\">i</mi><mo>\u2062</mo><msub><mi>\u03d5</mi><mrow><mi mathvariant=\"normal\">s</mi><mo>,</mo><mi mathvariant=\"normal\">a</mi></mrow></msub></mrow></msup></mrow></mrow><mrow><mi>r</mi><mo>\u2062</mo><mi>\u03c4</mi></mrow></mfrac></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.00157.tex", "nexttext": "\nwhere we have defined the cavity transmission amplitude\n\n", "itemtype": "equation", "pos": 21327, "prevtext": "\nwhere $\\phi_\\mathrm{s,a} = k_\\mathrm{s,a}L - \\Im\\{\\kappa_\\mathrm{s,a}\\}\\tau$ is the cavity roundtrip phase accumulated by the fields, including any dispersion induced by the atomic ensemble, and where the cavity roundtrip amplitude transmission, including any atomic absorption, is given by $\\mu_\\mathrm{s,a} = r e^{-\\Re\\{\\kappa_\\mathrm{s,a}\\}\\tau}$. If there are additional losses due to scattering from surfaces inside the cavity, or partial transmission through cavity mirrors, these can be incorporated into $\\mu_\\mathrm{s,a}$. The system of coupled equations (\\ref{intra}) takes a form that might be written down using cavity input-output theory, except that we are able to treat the dynamics of both the Stokes and anti-Stokes fields, with one being resonant and the other off-resonant with the cavity, as determined by the phases $\\phi_\\mathrm{s,a}$.\n\n\n\\section{Bad cavity limit}\nTo proceed to a solution, we once more invoke the bad cavity approximation, in which the fields impinging on the cavity are much more narrowband than the cavity linewidth \\cite{Gorshkov:2007aa}. Specifically, then, we require that $|\\partial_t s| \\ll |\\gamma_\\mathrm{s} s|$, with commensurate bandwidths for the anti-Stokes and control fields. In this limit, we solve for $s$ and $a$ in terms of $b$ by setting $\\partial_t s = \\partial_t a \\approx 0$, to obtain\n\\begin{eqnarray}\n\\nonumber s&=&{\\mathrm{i}} \\sqrt{\\frac{d\\gamma}{\\tau}}\\frac{\\Omega}{\\Gamma_\\mathrm{s} \\gamma_\\mathrm{s}} b+e^{-{\\mathrm{i}} k_\\mathrm{s} L} \\frac{t_r}{\\gamma_\\mathrm{s} r \\sqrt{\\tau}}S_\\mathrm{in}, \\\\\n\\label{dtzero} a&=&{\\mathrm{i}} \\sqrt{\\frac{d\\gamma}{\\tau}}\\frac{\\Omega}{\\Gamma_\\mathrm{a} \\gamma_\\mathrm{a}} b^\\dagger +e^{-{\\mathrm{i}} k_\\mathrm{a} L} \\frac{t_r}{\\gamma_\\mathrm{a} r \\sqrt{\\tau}}A_\\mathrm{in}, \\\\\n\\nonumber\n \\partial_t b &=&  \\left\\{\\frac{d\\gamma}{\\tau}\\left[ \\frac{1}{\\Gamma_\\mathrm{s}^2 \\gamma_\\mathrm{s}} + \\frac{1}{|\\Gamma_\\mathrm{a}|^2 \\gamma_\\mathrm{a}^*}\\right] -  \\frac{1}{\\Gamma_\\mathrm{s}}  -  \\frac{1}{\\Gamma_\\mathrm{a}^*} \\right\\}|\\Omega|^2 b \\\\\n\\nonumber & & +{\\mathrm{i}} \\frac{t_r\\sqrt{d\\gamma}}{r\\tau}\\left[ \\frac{\\Omega^*}{\\Gamma_\\mathrm{s} \\gamma_\\mathrm{s}} e^{-{\\mathrm{i}} k_\\mathrm{s} L}S_\\mathrm{in} +\\frac{\\Omega}{\\Gamma_\\mathrm{a} \\gamma_\\mathrm{a}^*}e^{{\\mathrm{i}} k_\\mathrm{a} L}A_\\mathrm{in}^\\dagger\\right].\n\\end{eqnarray}\nAt this point, it is convenient to remove the dependence on the temporal shape of the control field by making a coordinate transformation $t \\longrightarrow \\epsilon(t) = \\int_{-\\infty}^t |\\Omega(t')|^2\\,{\\mathrm{d}} t'/W$, with $W$ chosen so that $\\epsilon(\\infty) = 1$. Then we have $\\partial_t = W^{-1}|\\Omega(t)|^2 \\partial_\\epsilon$ \\cite{Nunn:2007aa, Reim:2010kx}. Defining normalised signal and anti-Stokes field amplitudes $\\sigma = s\\sqrt{W}/\\Omega$ and $\\alpha = a\\sqrt{W}/\\Omega$, the system (\\ref{dtzero}) becomes\n\\begin{eqnarray}\n\\nonumber \\sigma&=&c_\\mathrm{s} b +p_\\mathrm{s}\\sigma_\\mathrm{in}, \\\\\n\\nonumber \\alpha&=&c_\\mathrm{a}b^\\dagger +p_\\mathrm{a}\\alpha_\\mathrm{in}, \\\\\n\\nonumber\n \\partial_\\epsilon b &=& f b + g_\\mathrm{s} \\sigma_\\mathrm{in} + g_\\mathrm{a} \\alpha_\\mathrm{in}^\\dagger,\n\\end{eqnarray}\nwhere we pulled the various constants into the coefficients\n\\begin{eqnarray}\n\\nonumber c_\\mathrm{s,a} &=& {\\mathrm{i}} \\sqrt{\\frac{d\\gamma W}{\\tau}}\\frac{1}{\\Gamma_\\mathrm{s,a} \\gamma_\\mathrm{s,a}},\\\\\n\\nonumber  p_\\mathrm{s,a} &=& \\frac{t_re^{-{\\mathrm{i}} k_\\mathrm{s,a} L}}{\\gamma_\\mathrm{s,a}r\\sqrt{\\tau}},\\\\\n\\label{defs} f &=&W\\left[\\frac{d\\gamma}{\\tau} \\left(\\frac{1}{\\Gamma_\\mathrm{s}^2 \\gamma_\\mathrm{s}} + \\frac{1}{|\\Gamma_\\mathrm{a}|^2\\gamma_\\mathrm{a}^*}\\right) - \\frac{1}{\\Gamma_\\mathrm{s}} - \\frac{1}{\\Gamma_\\mathrm{a}^*} \\right],\\\\\n\\nonumber g_\\mathrm{s} &=& {\\mathrm{i}} \\frac{t_r e^{-{\\mathrm{i}} k_\\mathrm{s} L} \\sqrt{d\\gamma W}}{\\Gamma_\\mathrm{s} \\gamma_\\mathrm{s}\\tau r}\\,;\\quad g_\\mathrm{a} = {\\mathrm{i}} \\frac{t_r e^{{\\mathrm{i}} k_\\mathrm{a} L} \\sqrt{d\\gamma W}}{\\Gamma_\\mathrm{a} \\gamma_\\mathrm{a}^*\\tau r}.\n\\end{eqnarray}\nNote that the above transformations are unitary so the operators $\\alpha$, $\\sigma$, $b$ obey the canonical relations $[\\alpha,\\alpha^\\dagger]=[\\sigma,\\sigma^\\dagger]=[b,b^\\dagger]=1$. Solving for $b$ gives\n\\begin{eqnarray}\n\\nonumber b(\\epsilon) &=& b(0)e^{f\\epsilon} + \\int_0^1\\!\\!{\\mathrm{d}} \\epsilon' \\, M_\\mathrm{c}(\\epsilon,\\epsilon')\\Big\\{ g_\\mathrm{s} \\sigma_\\mathrm{in}(\\epsilon') \\\\\n\\label{bsolve} & &\\left.+ g_\\mathrm{a} \\alpha_\\mathrm{in}^\\dagger(\\epsilon')\\right\\},\n\\end{eqnarray}\nwhere we have defined $M_\\mathrm{c}(\\epsilon,\\epsilon') = \\Theta(\\epsilon-\\epsilon')M(\\epsilon,\\epsilon')$ as the causal version of the cavity response function $M(\\epsilon,\\epsilon') = e^{f[\\epsilon-\\epsilon']}$, with $\\Theta$ denoting the Heaviside step-function.\n\nNow we are ready to solve for the outgoing fields emerging from the cavity, using again the beam splitter boundary conditions at the input-output coupler,\n\\begin{eqnarray}\n\\nonumber S_\\mathrm{out}&=& t_re^{{\\mathrm{i}} k_\\mathrm{s}L} S_L-rS_\\mathrm{in}(t),  \\\\\n\\label{out} A_\\mathrm{out}&=& t_re^{{\\mathrm{i}} k_\\mathrm{a}L} A_L-rA_\\mathrm{in}(t).\n\\end{eqnarray}\nIn the limit of weak single-pass coupling, we can approximate (\\ref{Taylor}) by $e^{{\\mathrm{i}} k_\\mathrm{s} L}S_L \\approx e^{{\\mathrm{i}} \\phi_\\mathrm{s}}S_0$, retaining only the phase evolution of the Stokes field as it traverses the cavity \\footnote{Note that re-using the Taylor expansion in (\\ref{Taylor}) actually exacerbates the truncation error of the weak-interaction approximation and gives an incorrect result for (\\ref{outfield}).}.  Substituting this into (\\ref{out}) and using (\\ref{dtzero}), the output field, switching back to the normalised variables $\\sigma_\\mathrm{in,out} = S_\\mathrm{in,out}\\sqrt{W}/\\Omega$, is found to be\n\n\n\n\n\n", "index": 5, "text": "\\begin{equation}\n\\label{outfield}\n\\sigma_\\mathrm{out} = \\frac{{\\mathrm{i}} t_r e^{{\\mathrm{i}} \\phi_\\mathrm{s}}\\sqrt{d\\gamma W}}{\\Gamma_\\mathrm{s} \\gamma_\\mathrm{s}\\tau}b +\\left(\\chi e^{{\\mathrm{i}} \\phi_\\mathrm{s}} -r\\right)\\sigma_\\mathrm{in},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"\\sigma_{\\mathrm{out}}=\\frac{{\\mathrm{i}}t_{r}e^{{\\mathrm{i}}\\phi_{\\mathrm{s}}}%&#10;\\sqrt{d\\gamma W}}{\\Gamma_{\\mathrm{s}}\\gamma_{\\mathrm{s}}\\tau}b+\\left(\\chi e^{{%&#10;\\mathrm{i}}\\phi_{\\mathrm{s}}}-r\\right)\\sigma_{\\mathrm{in}},\" display=\"block\"><mrow><mrow><msub><mi>\u03c3</mi><mi>out</mi></msub><mo>=</mo><mrow><mrow><mfrac><mrow><mi mathvariant=\"normal\">i</mi><mo>\u2062</mo><msub><mi>t</mi><mi>r</mi></msub><mo>\u2062</mo><msup><mi>e</mi><mrow><mi mathvariant=\"normal\">i</mi><mo>\u2062</mo><msub><mi>\u03d5</mi><mi mathvariant=\"normal\">s</mi></msub></mrow></msup><mo>\u2062</mo><msqrt><mrow><mi>d</mi><mo>\u2062</mo><mi>\u03b3</mi><mo>\u2062</mo><mi>W</mi></mrow></msqrt></mrow><mrow><msub><mi mathvariant=\"normal\">\u0393</mi><mi mathvariant=\"normal\">s</mi></msub><mo>\u2062</mo><msub><mi>\u03b3</mi><mi mathvariant=\"normal\">s</mi></msub><mo>\u2062</mo><mi>\u03c4</mi></mrow></mfrac><mo>\u2062</mo><mi>b</mi></mrow><mo>+</mo><mrow><mrow><mo>(</mo><mrow><mrow><mi>\u03c7</mi><mo>\u2062</mo><msup><mi>e</mi><mrow><mi mathvariant=\"normal\">i</mi><mo>\u2062</mo><msub><mi>\u03d5</mi><mi mathvariant=\"normal\">s</mi></msub></mrow></msup></mrow><mo>-</mo><mi>r</mi></mrow><mo>)</mo></mrow><mo>\u2062</mo><msub><mi>\u03c3</mi><mi>in</mi></msub></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.00157.tex", "nexttext": "\n\n\\section{Storage and retrieval}\nWe consider first the field emerging from the cavity when we attempt to store an incident signal. This field will contain both a contribution from the un-stored signal due to the finite efficiency of the storage interaction, and also a contribution from four-wave mixing noise. Assuming for simplicity that the memory is initially prepared with no spin wave excitations \\footnote{For memories based on alkali vapours --- Rb or Cs --- this requires efficient optical pumping of the atomic ensemble into one of the two hyperfine states within its ground state manifold. In practice this is hard to achieve, but fortunately experiments have shown that a small residual population of un-pumped atoms does not significantly affect the operation of the memory \\cite{Michelberger:2015aa}.}, the output field is found from (\\ref{outfield}) and (\\ref{bsolve}) to be\n\\begin{eqnarray}\n\\nonumber \\sigma_{\\mathrm{out},1}(\\epsilon) &=& \\int_0^1 \\!\\!{\\mathrm{d}}\\epsilon' \\, \\Big\\{ M_1(\\epsilon,\\epsilon')\\sigma_{\\mathrm{in},1}(\\epsilon') \\\\\n\\label{out1}& & \\left. + M_\\mathrm{FWM}^{[1]}(\\epsilon,\\epsilon')\\alpha_{\\mathrm{in},1}^\\dagger(\\epsilon')\\right\\},\n\\end{eqnarray}\nwhere we have defined the integral kernels\n\\begin{eqnarray}\n\\nonumber M_1(\\epsilon,\\epsilon') &=& -r e^{{\\mathrm{i}}(\\phi_\\mathrm{s}+k_\\mathrm{s}L)} \\chi C_\\mathrm{s}^2M_\\mathrm{c}(\\epsilon,\\epsilon') \\\\\n\\nonumber & &+\\left(\\chi e^{{\\mathrm{i}} \\phi_\\mathrm{s}}- r\\right) \\delta(\\epsilon-\\epsilon');\\\\\n\\label{kernels1} M_\\mathrm{FWM}^{[1]}(\\epsilon,\\epsilon') &=& -r\\chi  e^{{\\mathrm{i}}(\\phi_\\mathrm{s}+k_\\mathrm{s}L)}C_\\mathrm{s}C_\\mathrm{a}xM_\\mathrm{c}(\\epsilon,\\epsilon'),\n\\end{eqnarray}\n\n\n\n\n\n\nwhere the subscript $1$ indicates fields associated with the storage interaction.\nHere we have introduced the signal and anti-Stokes memory coupling parameters\n\n", "itemtype": "equation", "pos": 21643, "prevtext": "\nwhere we have defined the cavity transmission amplitude\n\n", "index": 7, "text": "$$\n\\chi = \\frac{t_r^2}{1-\\mu_\\mathrm{s} e^{{\\mathrm{i}} \\phi_\\mathrm{s}}}.\n$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"\\chi=\\frac{t_{r}^{2}}{1-\\mu_{\\mathrm{s}}e^{{\\mathrm{i}}\\phi_{\\mathrm{s}}}}.\" display=\"block\"><mrow><mrow><mi>\u03c7</mi><mo>=</mo><mfrac><msubsup><mi>t</mi><mi>r</mi><mn>2</mn></msubsup><mrow><mn>1</mn><mo>-</mo><mrow><msub><mi>\u03bc</mi><mi mathvariant=\"normal\">s</mi></msub><mo>\u2062</mo><msup><mi>e</mi><mrow><mi mathvariant=\"normal\">i</mi><mo>\u2062</mo><msub><mi>\u03d5</mi><mi mathvariant=\"normal\">s</mi></msub></mrow></msup></mrow></mrow></mfrac></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.00157.tex", "nexttext": "\nwith $\\mathcal{C} = d/(1-\\mu_\\mathrm{s}e^{{\\mathrm{i}} \\phi_\\mathrm{s}})$ the cooperativity of the cavity for the signal field, roughly equal to the optical depth of a medium with length $L\\times \\mathcal{F}_\\mathrm{s}/\\pi$, where $\\mathcal{F}_\\mathrm{s}$ is the cavity finesse for the signal field (when the control field $\\Omega$ is not present). Note that the coupling of the anti-Stokes field is multiplied by the \\emph{noise suppression factor}\n\n", "itemtype": "equation", "pos": 23571, "prevtext": "\n\n\\section{Storage and retrieval}\nWe consider first the field emerging from the cavity when we attempt to store an incident signal. This field will contain both a contribution from the un-stored signal due to the finite efficiency of the storage interaction, and also a contribution from four-wave mixing noise. Assuming for simplicity that the memory is initially prepared with no spin wave excitations \\footnote{For memories based on alkali vapours --- Rb or Cs --- this requires efficient optical pumping of the atomic ensemble into one of the two hyperfine states within its ground state manifold. In practice this is hard to achieve, but fortunately experiments have shown that a small residual population of un-pumped atoms does not significantly affect the operation of the memory \\cite{Michelberger:2015aa}.}, the output field is found from (\\ref{outfield}) and (\\ref{bsolve}) to be\n\\begin{eqnarray}\n\\nonumber \\sigma_{\\mathrm{out},1}(\\epsilon) &=& \\int_0^1 \\!\\!{\\mathrm{d}}\\epsilon' \\, \\Big\\{ M_1(\\epsilon,\\epsilon')\\sigma_{\\mathrm{in},1}(\\epsilon') \\\\\n\\label{out1}& & \\left. + M_\\mathrm{FWM}^{[1]}(\\epsilon,\\epsilon')\\alpha_{\\mathrm{in},1}^\\dagger(\\epsilon')\\right\\},\n\\end{eqnarray}\nwhere we have defined the integral kernels\n\\begin{eqnarray}\n\\nonumber M_1(\\epsilon,\\epsilon') &=& -r e^{{\\mathrm{i}}(\\phi_\\mathrm{s}+k_\\mathrm{s}L)} \\chi C_\\mathrm{s}^2M_\\mathrm{c}(\\epsilon,\\epsilon') \\\\\n\\nonumber & &+\\left(\\chi e^{{\\mathrm{i}} \\phi_\\mathrm{s}}- r\\right) \\delta(\\epsilon-\\epsilon');\\\\\n\\label{kernels1} M_\\mathrm{FWM}^{[1]}(\\epsilon,\\epsilon') &=& -r\\chi  e^{{\\mathrm{i}}(\\phi_\\mathrm{s}+k_\\mathrm{s}L)}C_\\mathrm{s}C_\\mathrm{a}xM_\\mathrm{c}(\\epsilon,\\epsilon'),\n\\end{eqnarray}\n\n\n\n\n\n\nwhere the subscript $1$ indicates fields associated with the storage interaction.\nHere we have introduced the signal and anti-Stokes memory coupling parameters\n\n", "index": 9, "text": "\\begin{equation}\n\\label{Cs}\nC_\\mathrm{s,a} = \\frac{\\sqrt{\\mathcal{C}\\gamma W}}{\\Gamma_\\mathrm{s,a}},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"C_{\\mathrm{s,a}}=\\frac{\\sqrt{\\mathcal{C}\\gamma W}}{\\Gamma_{\\mathrm{s,a}}},\" display=\"block\"><mrow><mrow><msub><mi>C</mi><mrow><mi mathvariant=\"normal\">s</mi><mo>,</mo><mi mathvariant=\"normal\">a</mi></mrow></msub><mo>=</mo><mfrac><msqrt><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udc9e</mi><mo>\u2062</mo><mi>\u03b3</mi><mo>\u2062</mo><mi>W</mi></mrow></msqrt><msub><mi mathvariant=\"normal\">\u0393</mi><mrow><mi mathvariant=\"normal\">s</mi><mo>,</mo><mi mathvariant=\"normal\">a</mi></mrow></msub></mfrac></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.00157.tex", "nexttext": "\nThis is the factor that we will aim to minimise by appropriate tuning of the cavity resonances.\n\nWe next consider the retrieval interaction. In this case there is no incident signal field, and the initial spin wave is (neglecting decoherence during storage) given by the excitation generated at read-in, so that the retrieved signal field can be written as\n\n\n\n\n\n\\begin{eqnarray}\n\\nonumber \\sigma_{\\mathrm{out},2}(\\epsilon) &=&\\int_0^1 \\!\\!{\\mathrm{d}}\\epsilon' \\, \\Big\\{ M_2(\\epsilon,\\epsilon')\\sigma_{\\mathrm{in},1}(\\epsilon') \\\\\n\\nonumber & &  + M_\\mathrm{FWM}^{[2]}(\\epsilon,\\epsilon')\\alpha_{\\mathrm{in},1}^\\dagger(\\epsilon')\\\\\n\\label{out1} & & \\left. + M_\\mathrm{FWM}^{[1]}(\\epsilon,\\epsilon')\\alpha_{\\mathrm{in},2}^\\dagger(\\epsilon')\\right\\},\n\\end{eqnarray}\nwhere we have defined the integral kernels\n\\begin{eqnarray}\n\\nonumber M_2 &=& -\\chi r  e^{{\\mathrm{i}}(\\phi_\\mathrm{s}+k_\\mathrm{s}L)}C_\\mathrm{s}^2e^f M;\\\\\n\\label{kernels2} M_\\mathrm{FWM}^{[2]} &=& -\\chi r e^{{\\mathrm{i}}(\\phi_\\mathrm{s}+k_\\mathrm{s}L)} C_\\mathrm{s}C_\\mathrm{a}xe^f M.\n\\end{eqnarray}\nHere we have assume for convenience in simplifying the expressions that the control pulse used to drive the retrieval interaction is identical to the storage control pulse.\n\n\\section{Efficiency and noise}\nThe above expressions provide a means to predict the efficiency of the memory by comparing the expectation values $N_\\mathrm{x} = \\langle \\int_0^1 S_\\mathrm{x}^\\dagger(t)S_\\mathrm{x}(t)\\,{\\mathrm{d}} t \\rangle = \\langle \\int_0^1 \\sigma_\\mathrm{x}^\\dagger(\\epsilon)\\sigma_\\mathrm{x}(\\epsilon)\\,{\\mathrm{d}} \\epsilon \\rangle$ of the input and output intensity operators ($\\mathrm{x}=\\mathrm{in,out},1,2$). Four-wave mixing noise enters via the operators describing the incident anti-Stokes fields, which, although they are in the vacuum state (we do not send in any anti-Stokes light), nonetheless contribute to the intensity because the incident fields are described by creation operators, giving rise to anti-normally-ordered terms. In a noiseless memory one would define the total efficiency $\\eta_\\mathrm{tot, noiseless} = N_{\\mathrm{out},2}/N_{\\mathrm{in},1}$, with commensurate definitions for the storage efficiency $\\eta_\\mathrm{store, noiseless} = 1-N_{\\mathrm{out},1}/N_{\\mathrm{in},1}$ and the retrieval efficiency $\\eta_\\mathrm{ret, noiseless} = \\eta_\\mathrm{tot, noiseless}/\\eta_\\mathrm{store, noiseless}$. For a noisy memory we modify the definition of the total efficiency by subtracting the noise floor $N_{\\mathrm{out},2}|_\\mathrm{no\\;input}$ retrieved from the memory when $N_{\\mathrm{in},1} = 0$ (no incident signal photons):\n\n", "itemtype": "equation", "pos": 24137, "prevtext": "\nwith $\\mathcal{C} = d/(1-\\mu_\\mathrm{s}e^{{\\mathrm{i}} \\phi_\\mathrm{s}})$ the cooperativity of the cavity for the signal field, roughly equal to the optical depth of a medium with length $L\\times \\mathcal{F}_\\mathrm{s}/\\pi$, where $\\mathcal{F}_\\mathrm{s}$ is the cavity finesse for the signal field (when the control field $\\Omega$ is not present). Note that the coupling of the anti-Stokes field is multiplied by the \\emph{noise suppression factor}\n\n", "index": 11, "text": "\\begin{equation}\n\\label{xdef}\nx = \\frac{e^{{\\mathrm{i}} k_\\mathrm{s}L}\\gamma_\\mathrm{s}}{e^{-{\\mathrm{i}} k_\\mathrm{a}L}\\gamma_\\mathrm{a}^*} = \\frac{1-\\mu_\\mathrm{s}e^{{\\mathrm{i}} \\phi_\\mathrm{s}}}{1-\\mu_\\mathrm{a}e^{-{\\mathrm{i}} \\phi_\\mathrm{a}}}.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"x=\\frac{e^{{\\mathrm{i}}k_{\\mathrm{s}}L}\\gamma_{\\mathrm{s}}}{e^{-{\\mathrm{i}}k_%&#10;{\\mathrm{a}}L}\\gamma_{\\mathrm{a}}^{*}}=\\frac{1-\\mu_{\\mathrm{s}}e^{{\\mathrm{i}}%&#10;\\phi_{\\mathrm{s}}}}{1-\\mu_{\\mathrm{a}}e^{-{\\mathrm{i}}\\phi_{\\mathrm{a}}}}.\" display=\"block\"><mrow><mrow><mi>x</mi><mo>=</mo><mfrac><mrow><msup><mi>e</mi><mrow><mi mathvariant=\"normal\">i</mi><mo>\u2062</mo><msub><mi>k</mi><mi mathvariant=\"normal\">s</mi></msub><mo>\u2062</mo><mi>L</mi></mrow></msup><mo>\u2062</mo><msub><mi>\u03b3</mi><mi mathvariant=\"normal\">s</mi></msub></mrow><mrow><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi mathvariant=\"normal\">i</mi><mo>\u2062</mo><msub><mi>k</mi><mi mathvariant=\"normal\">a</mi></msub><mo>\u2062</mo><mi>L</mi></mrow></mrow></msup><mo>\u2062</mo><msubsup><mi>\u03b3</mi><mi mathvariant=\"normal\">a</mi><mo>*</mo></msubsup></mrow></mfrac><mo>=</mo><mfrac><mrow><mn>1</mn><mo>-</mo><mrow><msub><mi>\u03bc</mi><mi mathvariant=\"normal\">s</mi></msub><mo>\u2062</mo><msup><mi>e</mi><mrow><mi mathvariant=\"normal\">i</mi><mo>\u2062</mo><msub><mi>\u03d5</mi><mi mathvariant=\"normal\">s</mi></msub></mrow></msup></mrow></mrow><mrow><mn>1</mn><mo>-</mo><mrow><msub><mi>\u03bc</mi><mi mathvariant=\"normal\">a</mi></msub><mo>\u2062</mo><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi mathvariant=\"normal\">i</mi><mo>\u2062</mo><msub><mi>\u03d5</mi><mi mathvariant=\"normal\">a</mi></msub></mrow></mrow></msup></mrow></mrow></mfrac></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.00157.tex", "nexttext": "\nIn computing these expectation values, it is helpful to adopt matrix notation for the integral kernels, so that for a two-dimensional function $K = K(\\epsilon,\\epsilon')$, we can write $\\int_0^1 K(\\epsilon,\\epsilon')K^*(\\epsilon'',\\epsilon')\\,{\\mathrm{d}} \\epsilon'$ simply as $K K^\\dagger = KK^\\dagger(\\epsilon,\\epsilon'')$, and $\\int_0^1 K(\\epsilon,\\epsilon')\\psi(\\epsilon')\\,{\\mathrm{d}}\\epsilon'$ simply as $K\\left | \\, {\\!\\psi} \\right \\rangle$, where the ket notation is unrelated to the quantum mechanics of the problem, but is used to denote the vectorised version of the function $\\psi(\\epsilon)$. In this notation the trace is given by $\\mathrm{tr}\\left\\{K\\right\\} = \\int_0^1 K(\\epsilon,\\epsilon)\\,{\\mathrm{d}} \\epsilon$. With these preliminaries, we can write the transmitted and retrieved photon numbers, for the case of input coherent state or Fock state signal fields, as\n\n", "itemtype": "equation", "pos": 27017, "prevtext": "\nThis is the factor that we will aim to minimise by appropriate tuning of the cavity resonances.\n\nWe next consider the retrieval interaction. In this case there is no incident signal field, and the initial spin wave is (neglecting decoherence during storage) given by the excitation generated at read-in, so that the retrieved signal field can be written as\n\n\n\n\n\n\\begin{eqnarray}\n\\nonumber \\sigma_{\\mathrm{out},2}(\\epsilon) &=&\\int_0^1 \\!\\!{\\mathrm{d}}\\epsilon' \\, \\Big\\{ M_2(\\epsilon,\\epsilon')\\sigma_{\\mathrm{in},1}(\\epsilon') \\\\\n\\nonumber & &  + M_\\mathrm{FWM}^{[2]}(\\epsilon,\\epsilon')\\alpha_{\\mathrm{in},1}^\\dagger(\\epsilon')\\\\\n\\label{out1} & & \\left. + M_\\mathrm{FWM}^{[1]}(\\epsilon,\\epsilon')\\alpha_{\\mathrm{in},2}^\\dagger(\\epsilon')\\right\\},\n\\end{eqnarray}\nwhere we have defined the integral kernels\n\\begin{eqnarray}\n\\nonumber M_2 &=& -\\chi r  e^{{\\mathrm{i}}(\\phi_\\mathrm{s}+k_\\mathrm{s}L)}C_\\mathrm{s}^2e^f M;\\\\\n\\label{kernels2} M_\\mathrm{FWM}^{[2]} &=& -\\chi r e^{{\\mathrm{i}}(\\phi_\\mathrm{s}+k_\\mathrm{s}L)} C_\\mathrm{s}C_\\mathrm{a}xe^f M.\n\\end{eqnarray}\nHere we have assume for convenience in simplifying the expressions that the control pulse used to drive the retrieval interaction is identical to the storage control pulse.\n\n\\section{Efficiency and noise}\nThe above expressions provide a means to predict the efficiency of the memory by comparing the expectation values $N_\\mathrm{x} = \\langle \\int_0^1 S_\\mathrm{x}^\\dagger(t)S_\\mathrm{x}(t)\\,{\\mathrm{d}} t \\rangle = \\langle \\int_0^1 \\sigma_\\mathrm{x}^\\dagger(\\epsilon)\\sigma_\\mathrm{x}(\\epsilon)\\,{\\mathrm{d}} \\epsilon \\rangle$ of the input and output intensity operators ($\\mathrm{x}=\\mathrm{in,out},1,2$). Four-wave mixing noise enters via the operators describing the incident anti-Stokes fields, which, although they are in the vacuum state (we do not send in any anti-Stokes light), nonetheless contribute to the intensity because the incident fields are described by creation operators, giving rise to anti-normally-ordered terms. In a noiseless memory one would define the total efficiency $\\eta_\\mathrm{tot, noiseless} = N_{\\mathrm{out},2}/N_{\\mathrm{in},1}$, with commensurate definitions for the storage efficiency $\\eta_\\mathrm{store, noiseless} = 1-N_{\\mathrm{out},1}/N_{\\mathrm{in},1}$ and the retrieval efficiency $\\eta_\\mathrm{ret, noiseless} = \\eta_\\mathrm{tot, noiseless}/\\eta_\\mathrm{store, noiseless}$. For a noisy memory we modify the definition of the total efficiency by subtracting the noise floor $N_{\\mathrm{out},2}|_\\mathrm{no\\;input}$ retrieved from the memory when $N_{\\mathrm{in},1} = 0$ (no incident signal photons):\n\n", "index": 13, "text": "\\begin{equation}\n\\label{etatot}\n\\eta_\\mathrm{tot} = \\frac{\\widetilde{N}_{\\mathrm{out},2}}{N_{\\mathrm{in},1}}\\,;\\qquad \\widetilde{N}_{\\mathrm{out},2} = N_{\\mathrm{out},2}-N_{\\mathrm{out},2}|_\\mathrm{no\\;input}.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"\\eta_{\\mathrm{tot}}=\\frac{\\widetilde{N}_{\\mathrm{out},2}}{N_{\\mathrm{in},1}}\\,%&#10;;\\qquad\\widetilde{N}_{\\mathrm{out},2}=N_{\\mathrm{out},2}-N_{\\mathrm{out},2}|_{%&#10;\\mathrm{no\\;input}}.\" display=\"block\"><mrow><mrow><mrow><msub><mi>\u03b7</mi><mi>tot</mi></msub><mo>=</mo><mpadded width=\"+1.7pt\"><mfrac><msub><mover accent=\"true\"><mi>N</mi><mo>~</mo></mover><mrow><mi>out</mi><mo>,</mo><mn>2</mn></mrow></msub><msub><mi>N</mi><mrow><mi>in</mi><mo>,</mo><mn>1</mn></mrow></msub></mfrac></mpadded></mrow><mo rspace=\"22.5pt\">;</mo><mrow><msub><mover accent=\"true\"><mi>N</mi><mo>~</mo></mover><mrow><mi>out</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>=</mo><mrow><msub><mi>N</mi><mrow><mi>out</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>-</mo><msub><mrow><msub><mi>N</mi><mrow><mi>out</mi><mo>,</mo><mn>2</mn></mrow></msub><mo fence=\"true\" stretchy=\"false\">|</mo></mrow><mrow><mpadded width=\"+2.8pt\"><mi>no</mi></mpadded><mo>\u2062</mo><mi>input</mi></mrow></msub></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.00157.tex", "nexttext": "\nwhere we have defined the operators\n\n", "itemtype": "equation", "pos": 28127, "prevtext": "\nIn computing these expectation values, it is helpful to adopt matrix notation for the integral kernels, so that for a two-dimensional function $K = K(\\epsilon,\\epsilon')$, we can write $\\int_0^1 K(\\epsilon,\\epsilon')K^*(\\epsilon'',\\epsilon')\\,{\\mathrm{d}} \\epsilon'$ simply as $K K^\\dagger = KK^\\dagger(\\epsilon,\\epsilon'')$, and $\\int_0^1 K(\\epsilon,\\epsilon')\\psi(\\epsilon')\\,{\\mathrm{d}}\\epsilon'$ simply as $K\\left | \\, {\\!\\psi} \\right \\rangle$, where the ket notation is unrelated to the quantum mechanics of the problem, but is used to denote the vectorised version of the function $\\psi(\\epsilon)$. In this notation the trace is given by $\\mathrm{tr}\\left\\{K\\right\\} = \\int_0^1 K(\\epsilon,\\epsilon)\\,{\\mathrm{d}} \\epsilon$. With these preliminaries, we can write the transmitted and retrieved photon numbers, for the case of input coherent state or Fock state signal fields, as\n\n", "index": 15, "text": "$$\nN_{\\mathrm{out},j} = \\mathrm{tr}\\left\\{ P_j\\right\\},\n$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"N_{\\mathrm{out},j}=\\mathrm{tr}\\left\\{P_{j}\\right\\},\" display=\"block\"><mrow><mrow><msub><mi>N</mi><mrow><mi>out</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>=</mo><mrow><mi>tr</mi><mo>\u2062</mo><mrow><mo>{</mo><msub><mi>P</mi><mi>j</mi></msub><mo>}</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.00157.tex", "nexttext": "\nwith $\\left | \\, {\\varphi_j} \\right \\rangle = M_j\\left | \\, {\\psi_\\mathrm{in}} \\right \\rangle$, and $\\psi_\\mathrm{in}(\\epsilon)$ the mode-function describing the temporal amplitude of the input signal field, normalised so that $\\left\\langle\\, {\\psi_\\mathrm{in}}\\,|\\,{\\psi_\\mathrm{in}}\\,\\right\\rangle=1$. To see how this works, consider the temporal amplitude of the signal field emerging from the storage interaction,\n\n", "itemtype": "equation", "pos": 28222, "prevtext": "\nwhere we have defined the operators\n\n", "index": 17, "text": "\\begin{equation}\n\\label{Ps} P_j = N_\\mathrm{in,1}\\left | \\, {\\varphi_j} \\right \\rangle\\!\\!\\left \\langle {\\varphi_j} \\, \\right | + \\sum_{k=1}^jM_{\\mathrm{FWM}}^{[k]}M_{\\mathrm{FWM}}^{[k]\\dagger},\\\\\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"P_{j}=N_{\\mathrm{in,1}}\\left|\\,{\\varphi_{j}}\\right\\rangle\\!\\!\\left\\langle{%&#10;\\varphi_{j}}\\,\\right|+\\sum_{k=1}^{j}M_{\\mathrm{FWM}}^{[k]}M_{\\mathrm{FWM}}^{[k%&#10;]\\dagger},\\\\&#10;\" display=\"block\"><mrow><mrow><msub><mi>P</mi><mi>j</mi></msub><mo>=</mo><mrow><mrow><msub><mi>N</mi><mrow><mi>in</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo fence=\"true\" rspace=\"4.2pt\">|</mo><msub><mi>\u03c6</mi><mi>j</mi></msub><mo rspace=\"0pt\">\u27e9</mo></mrow><mo>\u2062</mo><mrow><mo>\u27e8</mo><mpadded width=\"+1.7pt\"><msub><mi>\u03c6</mi><mi>j</mi></msub></mpadded><mo fence=\"true\">|</mo></mrow></mrow><mo>+</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>j</mi></munderover><mrow><msubsup><mi>M</mi><mi>FWM</mi><mrow><mo stretchy=\"false\">[</mo><mi>k</mi><mo stretchy=\"false\">]</mo></mrow></msubsup><mo>\u2062</mo><msubsup><mi>M</mi><mi>FWM</mi><mrow><mrow><mo stretchy=\"false\">[</mo><mi>k</mi><mo stretchy=\"false\">]</mo></mrow><mo>\u2063</mo><mo>\u2020</mo></mrow></msubsup></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.00157.tex", "nexttext": "\nwhere $\\psi(\\epsilon) = \\int_0^\\epsilon e^{-f\\epsilon'}\\psi_\\mathrm{in}(\\epsilon')\\,{\\mathrm{d}}\\epsilon'$. The number of photons, including noise due to four-wave mixing, is then found to be\n\n", "itemtype": "equation", "pos": 28852, "prevtext": "\nwith $\\left | \\, {\\varphi_j} \\right \\rangle = M_j\\left | \\, {\\psi_\\mathrm{in}} \\right \\rangle$, and $\\psi_\\mathrm{in}(\\epsilon)$ the mode-function describing the temporal amplitude of the input signal field, normalised so that $\\left\\langle\\, {\\psi_\\mathrm{in}}\\,|\\,{\\psi_\\mathrm{in}}\\,\\right\\rangle=1$. To see how this works, consider the temporal amplitude of the signal field emerging from the storage interaction,\n\n", "index": 19, "text": "$$\n\\varphi_1(\\epsilon) = -r e^{{\\mathrm{i}}(\\phi_\\mathrm{s}+k_\\mathrm{s}L)} \\chi C_\\mathrm{s}^2e^{f\\epsilon}\\psi(\\epsilon) + \\left(\\chi e^{{\\mathrm{i}} \\phi_\\mathrm{s}} -r\\right) \\psi_\\mathrm{in}(\\epsilon),\n$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"\\varphi_{1}(\\epsilon)=-re^{{\\mathrm{i}}(\\phi_{\\mathrm{s}}+k_{\\mathrm{s}}L)}%&#10;\\chi C_{\\mathrm{s}}^{2}e^{f\\epsilon}\\psi(\\epsilon)+\\left(\\chi e^{{\\mathrm{i}}%&#10;\\phi_{\\mathrm{s}}}-r\\right)\\psi_{\\mathrm{in}}(\\epsilon),\" display=\"block\"><mrow><mrow><mrow><msub><mi>\u03c6</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03f5</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mo>-</mo><mrow><mi>r</mi><mo>\u2062</mo><msup><mi>e</mi><mrow><mi mathvariant=\"normal\">i</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\u03d5</mi><mi mathvariant=\"normal\">s</mi></msub><mo>+</mo><mrow><msub><mi>k</mi><mi mathvariant=\"normal\">s</mi></msub><mo>\u2062</mo><mi>L</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msup><mo>\u2062</mo><mi>\u03c7</mi><mo>\u2062</mo><msubsup><mi>C</mi><mi mathvariant=\"normal\">s</mi><mn>2</mn></msubsup><mo>\u2062</mo><msup><mi>e</mi><mrow><mi>f</mi><mo>\u2062</mo><mi>\u03f5</mi></mrow></msup><mo>\u2062</mo><mi>\u03c8</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03f5</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><mrow><mrow><mo>(</mo><mrow><mrow><mi>\u03c7</mi><mo>\u2062</mo><msup><mi>e</mi><mrow><mi mathvariant=\"normal\">i</mi><mo>\u2062</mo><msub><mi>\u03d5</mi><mi mathvariant=\"normal\">s</mi></msub></mrow></msup></mrow><mo>-</mo><mi>r</mi></mrow><mo>)</mo></mrow><mo>\u2062</mo><msub><mi>\u03c8</mi><mi>in</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03f5</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.00157.tex", "nexttext": "\nwhere we have defined $E = \\int_0^1 e^{-\\zeta \\epsilon}\\,{\\mathrm{d}} \\epsilon =  (1-e^{-\\zeta})/\\zeta$, with the dimensionless coupling parameter $\\zeta$ given by\n\\begin{eqnarray}\n\\nonumber \\zeta &=& -(f+f^*)\\\\\n\\nonumber &=&-2r\\Re\\left\\{ C_\\mathrm{s}^2 e^{{\\mathrm{i}} k_\\mathrm{s}L} + C_\\mathrm{a}^{2} x e^{-{\\mathrm{i}} (k_\\mathrm{a}L - 2\\arg \\Gamma_\\mathrm{a})}\n\\right\\}\\\\\n\\label{zetadef} & & + 2W\\Re\\left\\{\\frac{1}{\\Gamma_\\mathrm{s}} + \\frac{1}{\\Gamma_\\mathrm{a}^*}\\right\\}.\n\\end{eqnarray}\nConsidering now the retrieval interaction, the temporal mode emerging from the memory is\n\n", "itemtype": "equation", "pos": 29254, "prevtext": "\nwhere $\\psi(\\epsilon) = \\int_0^\\epsilon e^{-f\\epsilon'}\\psi_\\mathrm{in}(\\epsilon')\\,{\\mathrm{d}}\\epsilon'$. The number of photons, including noise due to four-wave mixing, is then found to be\n\n", "index": 21, "text": "$$\nN_{\\mathrm{out},1} = N_{\\mathrm{in},1}\\left\\langle\\, {\\varphi_1}\\,|\\,{\\varphi_1}\\,\\right\\rangle + |r\\chi C_\\mathrm{s}C_\\mathrm{a}x|^2\\frac{1-E}{\\zeta},\n$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m1\" class=\"ltx_Math\" alttext=\"N_{\\mathrm{out},1}=N_{\\mathrm{in},1}\\left\\langle\\,{\\varphi_{1}}\\,|\\,{\\varphi_{%&#10;1}}\\,\\right\\rangle+|r\\chi C_{\\mathrm{s}}C_{\\mathrm{a}}x|^{2}\\frac{1-E}{\\zeta},\" display=\"block\"><mrow><mrow><msub><mi>N</mi><mrow><mi>out</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>=</mo><mrow><mrow><msub><mi>N</mi><mrow><mi>in</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo rspace=\"4.2pt\">\u27e8</mo><mpadded width=\"+1.7pt\"><msub><mi>\u03c6</mi><mn>1</mn></msub></mpadded><mo rspace=\"4.2pt\" stretchy=\"false\">|</mo><mpadded width=\"+1.7pt\"><msub><mi>\u03c6</mi><mn>1</mn></msub></mpadded><mo>\u27e9</mo></mrow></mrow><mo>+</mo><mrow><msup><mrow><mo stretchy=\"false\">|</mo><mrow><mi>r</mi><mo>\u2062</mo><mi>\u03c7</mi><mo>\u2062</mo><msub><mi>C</mi><mi mathvariant=\"normal\">s</mi></msub><mo>\u2062</mo><msub><mi>C</mi><mi mathvariant=\"normal\">a</mi></msub><mo>\u2062</mo><mi>x</mi></mrow><mo stretchy=\"false\">|</mo></mrow><mn>2</mn></msup><mo>\u2062</mo><mfrac><mrow><mn>1</mn><mo>-</mo><mi>E</mi></mrow><mi>\u03b6</mi></mfrac></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.00157.tex", "nexttext": "\nwhere we have introduced the normalised overlap between the input field and the cavity response, $\\kappa = (e^\\zeta E)^{-1/2} \\psi(1)$. With this definition, when $\\psi_\\mathrm{in}(\\epsilon) \\propto e^{f^*\\epsilon}$, we obtain $\\kappa = 1$. Including the contributions from four-wave mixing, the number of photons retrieved from the memory is found to be\n\n", "itemtype": "equation", "pos": 29996, "prevtext": "\nwhere we have defined $E = \\int_0^1 e^{-\\zeta \\epsilon}\\,{\\mathrm{d}} \\epsilon =  (1-e^{-\\zeta})/\\zeta$, with the dimensionless coupling parameter $\\zeta$ given by\n\\begin{eqnarray}\n\\nonumber \\zeta &=& -(f+f^*)\\\\\n\\nonumber &=&-2r\\Re\\left\\{ C_\\mathrm{s}^2 e^{{\\mathrm{i}} k_\\mathrm{s}L} + C_\\mathrm{a}^{2} x e^{-{\\mathrm{i}} (k_\\mathrm{a}L - 2\\arg \\Gamma_\\mathrm{a})}\n\\right\\}\\\\\n\\label{zetadef} & & + 2W\\Re\\left\\{\\frac{1}{\\Gamma_\\mathrm{s}} + \\frac{1}{\\Gamma_\\mathrm{a}^*}\\right\\}.\n\\end{eqnarray}\nConsidering now the retrieval interaction, the temporal mode emerging from the memory is\n\n", "index": 23, "text": "$$\n\\varphi_2(\\epsilon) = -r e^{{\\mathrm{i}}(\\phi_\\mathrm{s}+k_\\mathrm{s}L)}\\chi C_\\mathrm{s}^2 e^f (e^\\zeta E)^{1/2}\\kappa e^{f\\epsilon},\n$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m1\" class=\"ltx_Math\" alttext=\"\\varphi_{2}(\\epsilon)=-re^{{\\mathrm{i}}(\\phi_{\\mathrm{s}}+k_{\\mathrm{s}}L)}%&#10;\\chi C_{\\mathrm{s}}^{2}e^{f}(e^{\\zeta}E)^{1/2}\\kappa e^{f\\epsilon},\" display=\"block\"><mrow><mrow><mrow><msub><mi>\u03c6</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03f5</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo>-</mo><mrow><mi>r</mi><mo>\u2062</mo><msup><mi>e</mi><mrow><mi mathvariant=\"normal\">i</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\u03d5</mi><mi mathvariant=\"normal\">s</mi></msub><mo>+</mo><mrow><msub><mi>k</mi><mi mathvariant=\"normal\">s</mi></msub><mo>\u2062</mo><mi>L</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msup><mo>\u2062</mo><mi>\u03c7</mi><mo>\u2062</mo><msubsup><mi>C</mi><mi mathvariant=\"normal\">s</mi><mn>2</mn></msubsup><mo>\u2062</mo><msup><mi>e</mi><mi>f</mi></msup><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mi>e</mi><mi>\u03b6</mi></msup><mo>\u2062</mo><mi>E</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow></msup><mo>\u2062</mo><mi>\u03ba</mi><mo>\u2062</mo><msup><mi>e</mi><mrow><mi>f</mi><mo>\u2062</mo><mi>\u03f5</mi></mrow></msup></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.00157.tex", "nexttext": "\nwhere we defined $g(\\zeta)= (1-e^{-\\zeta}E)/\\zeta$. The first term describes the coherent operation of the memory; the second term describes the retrieval of noise photons that are present even when no signal photons are sent into the memory. The efficiency of the memory is seen to be\n\n", "itemtype": "equation", "pos": 30492, "prevtext": "\nwhere we have introduced the normalised overlap between the input field and the cavity response, $\\kappa = (e^\\zeta E)^{-1/2} \\psi(1)$. With this definition, when $\\psi_\\mathrm{in}(\\epsilon) \\propto e^{f^*\\epsilon}$, we obtain $\\kappa = 1$. Including the contributions from four-wave mixing, the number of photons retrieved from the memory is found to be\n\n", "index": 25, "text": "\\begin{equation}\n\\label{Nout2}\nN_{\\mathrm{out},2} = |r\\chi C_\\mathrm{s}|^2 \\left[|C_\\mathrm{s}E\\kappa|^2  N_{\\mathrm{in},1} + |C_\\mathrm{a}x|^2g(\\zeta)\\right],\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m1\" class=\"ltx_Math\" alttext=\"N_{\\mathrm{out},2}=|r\\chi C_{\\mathrm{s}}|^{2}\\left[|C_{\\mathrm{s}}E\\kappa|^{2}%&#10;N_{\\mathrm{in},1}+|C_{\\mathrm{a}}x|^{2}g(\\zeta)\\right],\" display=\"block\"><mrow><mrow><msub><mi>N</mi><mrow><mi>out</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>=</mo><mrow><msup><mrow><mo stretchy=\"false\">|</mo><mrow><mi>r</mi><mo>\u2062</mo><mi>\u03c7</mi><mo>\u2062</mo><msub><mi>C</mi><mi mathvariant=\"normal\">s</mi></msub></mrow><mo stretchy=\"false\">|</mo></mrow><mn>2</mn></msup><mo>\u2062</mo><mrow><mo>[</mo><mrow><mrow><msup><mrow><mo stretchy=\"false\">|</mo><mrow><msub><mi>C</mi><mi mathvariant=\"normal\">s</mi></msub><mo>\u2062</mo><mi>E</mi><mo>\u2062</mo><mi>\u03ba</mi></mrow><mo stretchy=\"false\">|</mo></mrow><mn>2</mn></msup><mo>\u2062</mo><msub><mi>N</mi><mrow><mi>in</mi><mo>,</mo><mn>1</mn></mrow></msub></mrow><mo>+</mo><mrow><msup><mrow><mo stretchy=\"false\">|</mo><mrow><msub><mi>C</mi><mi mathvariant=\"normal\">a</mi></msub><mo>\u2062</mo><mi>x</mi></mrow><mo stretchy=\"false\">|</mo></mrow><mn>2</mn></msup><mo>\u2062</mo><mi>g</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b6</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>]</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.00157.tex", "nexttext": "\nTaking the ratio of the first and second terms in (\\ref{Nout2}) provides the following formula for the signal-to-noise ratio (SNR) of the memory,\n\n", "itemtype": "equation", "pos": 30953, "prevtext": "\nwhere we defined $g(\\zeta)= (1-e^{-\\zeta}E)/\\zeta$. The first term describes the coherent operation of the memory; the second term describes the retrieval of noise photons that are present even when no signal photons are sent into the memory. The efficiency of the memory is seen to be\n\n", "index": 27, "text": "\\begin{equation}\n\\label{eff_1}\n\\eta_\\mathrm{tot} = |r\\chi C_\\mathrm{s}^2E \\kappa|^2.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m1\" class=\"ltx_Math\" alttext=\"\\eta_{\\mathrm{tot}}=|r\\chi C_{\\mathrm{s}}^{2}E\\kappa|^{2}.\" display=\"block\"><mrow><mrow><msub><mi>\u03b7</mi><mi>tot</mi></msub><mo>=</mo><msup><mrow><mo stretchy=\"false\">|</mo><mrow><mi>r</mi><mo>\u2062</mo><mi>\u03c7</mi><mo>\u2062</mo><msubsup><mi>C</mi><mi mathvariant=\"normal\">s</mi><mn>2</mn></msubsup><mo>\u2062</mo><mi>E</mi><mo>\u2062</mo><mi>\u03ba</mi></mrow><mo stretchy=\"false\">|</mo></mrow><mn>2</mn></msup></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.00157.tex", "nexttext": "\nParsing this result from left to right, the SNR increases with the number of incident signal photons, and with the degree to which they overlap with the cavity response, described by $|\\kappa|^2$. The second factor is essentially the ratio of the anti-Stokes and Stokes detunings, which factor is also present in a cavity-less $\\Lambda$-memory. This reflects the fact that low-noise operation can be achieved with detunings much smaller than the splitting between the ground states of the $\\Lambda$-system, as can be realised with EIT in cold atoms \\cite{Chen:2013aa}. The third factor is purely dynamical, but the final factor, proportional to $|x|^{-2}$, represents the noise suppression afforded by the cavity. As should now be clear, minimising $|x|$ by appropriate tuning of the cavity resonances provides a route to low-noise operation of a $\\Lambda$-memory, even at room temperature where large detunings from resonance are necessary.\n\\section{Mode selectivity}\nThe cavity memory interaction is a single-mode interaction. That is to say, the memory stores just a single temporal mode, and a single temporal mode is retrieved from the memory \\cite{Wasilewski:2009aa}. This is clear from the structure of the solution (\\ref{out1}), where the coherent mapping between input and output is described by the Green's function $M_2 \\propto M=e^{f[\\epsilon-\\epsilon']}$, which is a \\emph{separable} function of $\\epsilon$ and $\\epsilon'$. Accordingly the efficiency of the memory is parameterised by the overlap integral $\\kappa$ defined above; any input mode orthogonal to $e^{-f\\epsilon'}$ will not couple to the memory at all. Furthermore, converting back into the ordinary time coordinate, $\\psi_\\mathrm{in}(t) =W^{-1/2} \\Omega(t) \\psi_\\mathrm{in}[ t(\\epsilon) ]$, we observe that the input mode that is stored can be arbitrarily chosen by appropriate shaping of the control field $\\Omega$. The single-mode nature of the cavity memory interaction has been derived previously, albeit without considering four-wave mixing \\cite{Cirac:2004aa,Gorshkov:2007aa}, but here we point out that it is an advantageous feature. The combination of single-mode operation and arbitrary shaping has been dubbed \\emph{temporal mode selectivity}, and is a useful feature for quantum optical information processing, where large-alphabet signals can be demultiplexed by a mode-selective `drop filter' \\cite{Reddy:2013aa}. In fact, the conventional traveling-wave Raman protocol \\cite{Nunn:2007aa, Gorshkov:2007qm} is nearly single-mode \\cite{Nunn:2008oq}, but the mode selectivity degrades at high efficiency --- a phenomenon encountered also in engineering mode-selective frequency conversion \\cite{Eckstein:2011aa}. Recently Reddy \\emph{et al.} showed how to achieve high mode selectivity and high efficiency in frequency conversion by double-passing or multi-passing the active medium, so that each interaction was weak enough to remain effectively single-mode \\cite{Reddy:2013aa}. The perfect mode-selectivity of the cavity memory analysed here can be understood as the multi-pass limit of this approach, where the interaction describing a single pass through the cavity is weak, and therefore separable, whereas the coherent combination of all cavity round-trips provides for arbitrarily high efficiency while retaining temporal mode selectivity.\n\n\n\n\\section{Autocorrelation}\nA key figure of merit for the operation of a quantum memory is the ability to preserve the sub-Poissonian statistics of stored single-photon Fock states. In our recent experiments with a Raman $\\Lambda$-memory without any cavity, we found that although the average number of noise photons generated by four-wave mixing in the absence of an input signal field was low, the effect of four-wave mixing on the photon statistics of the fields retrieved from the memory was dramatic \\cite{Michelberger:2015aa}. To see how the cavity influences the performance of the memory as a component for synchronising photonic quantum information, we compute the $g^{(2)}$ autocorrelation function for the fields emerging from the memory, which can be written as\n\\begin{eqnarray}\n\\nonumber\ng^{(2)}_{\\mathrm{out},j} &=& \\frac{ \\int_0^1\\!\\! \\int_0^1 \\!\\! {\\mathrm{d}} \\epsilon {\\mathrm{d}} \\epsilon' \\left \\langle  \\sigma^\\dagger_{\\mathrm{out},j}(\\epsilon)\\sigma_{\\mathrm{out},j}^\\dagger(\\epsilon') \\sigma_{\\mathrm{out},j}(\\epsilon')\\sigma_{\\mathrm{out},j}(\\epsilon) \\right \\rangle}{\\left[ \\int_0^1 \\!\\!{\\mathrm{d}} \\epsilon'' \\sigma_{\\mathrm{out},j}^\\dagger(\\epsilon'') \\sigma_{\\mathrm{out},j}(\\epsilon'')\\right]^2}\\\\\n\\label{g2}&=& 1 + \\frac{ \\mathrm{tr}\\left\\{P_j^2\\right\\}  - \\left(2-g^{(2)}_\\mathrm{in,1}\\right)N_{\\mathrm{in},1}^2\\left\\langle\\, {\\varphi_j}\\,|\\,{\\varphi_j}\\,\\right\\rangle^2}{N_{\\mathrm{out},j}^2}.\n\\end{eqnarray}\nFor the fields emerging from the storage interaction, we obtain the result\n\\begin{eqnarray}\n\\label{g2out} N_{\\mathrm{out},1}^2\\left[ g^{(2)}_{\\mathrm{out},1}-1\\right] &=&  \\left[g^{(2)}_{\\mathrm{in},1}-1\\right]N_{\\mathrm{in},1}^2 \\left\\langle\\, {\\varphi_1}\\,|\\,{\\varphi_1}\\,\\right\\rangle^2 \\\\\n\\nonumber & & + \\mathrm{tr}\\left\\{ M_\\mathrm{FWM}^{[1]} M_\\mathrm{FWM}^{[1]\\dagger} M_\\mathrm{FWM}^{[1]} M_\\mathrm{FWM}^{[1]\\dagger} \\right\\}\\\\\n\\nonumber & &  + 2 N_{\\mathrm{in},1} \\left \\langle {\\varphi_1} \\, \\right | M_\\mathrm{FWM}^{[1]} M_\\mathrm{FWM}^{[1]\\dagger} \\left | \\, {\\varphi_1} \\right \\rangle,\n\\end{eqnarray}\nwhere the second term evaluates to\n\\begin{eqnarray}\n\\nonumber \\mathrm{tr}\\left\\{ M_\\mathrm{FWM}^{[1]} M_\\mathrm{FWM}^{[1]\\dagger} M_\\mathrm{FWM}^{[1]} M_\\mathrm{FWM}^{[1]\\dagger} \\right\\} &=& |r\\chi C_\\mathrm{s}C_\\mathrm{a}x|^4\\zeta^{-4}\\times \\\\\n\\nonumber & & \\left\\{  4\\zeta (1-E)\\right.\\\\\n\\label{trM}& & \\left. -2\\zeta^2 E -\\Sigma\\right\\},\n\\end{eqnarray}\nwith $\\Sigma = 2e^{-\\zeta}\\left[\\sinh(\\zeta)-\\zeta\\right]$. Of particular interest is the corresponding expression for the $g^{(2)}$ autocorrelation of the fields retrieved from the memory by the readout control pulse, which, after some rather lengthy calculations can be written as,\n\\begin{eqnarray}\n\\nonumber N_{\\mathrm{out},2}^2\\left[ g^{(2)}_{\\mathrm{out},2}-1\\right] &=& |r\\chi C_\\mathrm{s}|^4\\bigg\\{ \\left[g^{(2)}_{\\mathrm{in},1}-1\\right]N_{\\mathrm{in},1}^2 |C_\\mathrm{s} E \\kappa |^4 \\\\\n\\label{g2out} & & + |C_\\mathrm{a}x|^4h(\\zeta)\\\\\n\\nonumber & &  + 2 N_{\\mathrm{in},1} |C_\\mathrm{s}C_\\mathrm{a}x\\kappa|^2 h'(\\zeta)\\bigg\\},\n\\end{eqnarray}\nwhere we defined the functions\n\\begin{eqnarray}\n\\nonumber h(\\zeta)&=& 4\\frac{1-E}{\\zeta^3} -2\\frac{E}{\\zeta^2} + E^4  + \\frac{\\Sigma}{\\zeta^4}(2\\zeta E-1),\\\\\n\\label{hs} h'(\\zeta)&=& E^4 + \\frac{E\\Sigma}{\\zeta^3}.\\end{eqnarray}\nOf particular interest is the case of storing single photon Fock states, for which $g^{(2)}_{\\mathrm{in},1} = 0$, and we obtain\n\\begin{eqnarray}\n\\nonumber g^{(2)}_{\\mathrm{out},2} &=& \\left\\{2N_{\\mathrm{in},1}|\\kappa C_\\mathrm{s}C_\\mathrm{a}x|^2 [E^2g(\\zeta) + h'(\\zeta)]\\right. \\\\\n\\nonumber & & \\left.+ |C_\\mathrm{a}x|^4 \\left[ g(\\zeta)^2 + h(\\zeta)\\right]\\right\\}\\\\\n\\nonumber &&\\times \\left[N_{\\mathrm{in},1}|\\kappa C_\\mathrm{s}E|^2 +|C_\\mathrm{a}x|^2 g(\\zeta)\\right]^{-2}.\n\\end{eqnarray}\nNote that for incident single photons, $N_{\\mathrm{in},1}\\leq 1$ is to be interpreted as the average number of photons per pulse, including any losses prior to the memory. For a heralded photon source \\cite{Spring:2013aa}, $N_{\\mathrm{in},1}$ is therefore the \\emph{heralding efficiency} of the source. \n\nIf we achieve strong noise suppression, so that $|x|^2\\ll N_{\\mathrm{in},1}$, then the autocorrelation can be written as\n\n", "itemtype": "equation", "pos": 31199, "prevtext": "\nTaking the ratio of the first and second terms in (\\ref{Nout2}) provides the following formula for the signal-to-noise ratio (SNR) of the memory,\n\n", "index": 29, "text": "\\begin{equation}\n\\label{SNR}\n\\mathrm{SNR} = N_{\\mathrm{in},1}|\\kappa|^2\\times \\left|\\frac{\\Gamma_\\mathrm{a}}{\\Gamma_\\mathrm{s}}\\right|^2\\times \\frac{E^2}{g(\\zeta)}\\times \\frac{1}{|x|^2}.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E10.m1\" class=\"ltx_Math\" alttext=\"\\mathrm{SNR}=N_{\\mathrm{in},1}|\\kappa|^{2}\\times\\left|\\frac{\\Gamma_{\\mathrm{a}%&#10;}}{\\Gamma_{\\mathrm{s}}}\\right|^{2}\\times\\frac{E^{2}}{g(\\zeta)}\\times\\frac{1}{|%&#10;x|^{2}}.\" display=\"block\"><mrow><mrow><mi>SNR</mi><mo>=</mo><mrow><mrow><msub><mi>N</mi><mrow><mi>in</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">|</mo><mi>\u03ba</mi><mo stretchy=\"false\">|</mo></mrow><mn>2</mn></msup></mrow><mo>\u00d7</mo><msup><mrow><mo>|</mo><mfrac><msub><mi mathvariant=\"normal\">\u0393</mi><mi mathvariant=\"normal\">a</mi></msub><msub><mi mathvariant=\"normal\">\u0393</mi><mi mathvariant=\"normal\">s</mi></msub></mfrac><mo>|</mo></mrow><mn>2</mn></msup><mo>\u00d7</mo><mfrac><msup><mi>E</mi><mn>2</mn></msup><mrow><mi>g</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b6</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac><mo>\u00d7</mo><mfrac><mn>1</mn><msup><mrow><mo stretchy=\"false\">|</mo><mi>x</mi><mo stretchy=\"false\">|</mo></mrow><mn>2</mn></msup></mfrac></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.00157.tex", "nexttext": "\n\n\\section{Weak coupling limit}\nThe expressions for the efficiency, signal-to-noise ratio and autocorrelation simplify in the limit of weak coupling, when $|C_\\mathrm{s,a}|\\ll 1$, so that $\\zeta \\ll 1$. In this limit we obtain, to first order in $\\zeta$ (valid for $\\zeta \\lesssim 0.2$), $E\\rightarrow 1-\\frac{1}{2}\\zeta$, $\\Sigma \\rightarrow \\frac{1}{3}\\zeta^3-\\frac{1}{3}\\zeta^4$, $g(\\zeta)\\rightarrow \\frac{3}{2}-\\frac{7}{6}\\zeta$, $h(\\zeta)\\rightarrow \\frac{11}{6}-\\frac{13}{5}\\zeta$, $h'(\\zeta)\\rightarrow \\frac{4}{3}\n-\\frac{5}{2}\\zeta$. The number of retrieved photons is then given by\n\n", "itemtype": "equation", "pos": 38942, "prevtext": "\nParsing this result from left to right, the SNR increases with the number of incident signal photons, and with the degree to which they overlap with the cavity response, described by $|\\kappa|^2$. The second factor is essentially the ratio of the anti-Stokes and Stokes detunings, which factor is also present in a cavity-less $\\Lambda$-memory. This reflects the fact that low-noise operation can be achieved with detunings much smaller than the splitting between the ground states of the $\\Lambda$-system, as can be realised with EIT in cold atoms \\cite{Chen:2013aa}. The third factor is purely dynamical, but the final factor, proportional to $|x|^{-2}$, represents the noise suppression afforded by the cavity. As should now be clear, minimising $|x|$ by appropriate tuning of the cavity resonances provides a route to low-noise operation of a $\\Lambda$-memory, even at room temperature where large detunings from resonance are necessary.\n\\section{Mode selectivity}\nThe cavity memory interaction is a single-mode interaction. That is to say, the memory stores just a single temporal mode, and a single temporal mode is retrieved from the memory \\cite{Wasilewski:2009aa}. This is clear from the structure of the solution (\\ref{out1}), where the coherent mapping between input and output is described by the Green's function $M_2 \\propto M=e^{f[\\epsilon-\\epsilon']}$, which is a \\emph{separable} function of $\\epsilon$ and $\\epsilon'$. Accordingly the efficiency of the memory is parameterised by the overlap integral $\\kappa$ defined above; any input mode orthogonal to $e^{-f\\epsilon'}$ will not couple to the memory at all. Furthermore, converting back into the ordinary time coordinate, $\\psi_\\mathrm{in}(t) =W^{-1/2} \\Omega(t) \\psi_\\mathrm{in}[ t(\\epsilon) ]$, we observe that the input mode that is stored can be arbitrarily chosen by appropriate shaping of the control field $\\Omega$. The single-mode nature of the cavity memory interaction has been derived previously, albeit without considering four-wave mixing \\cite{Cirac:2004aa,Gorshkov:2007aa}, but here we point out that it is an advantageous feature. The combination of single-mode operation and arbitrary shaping has been dubbed \\emph{temporal mode selectivity}, and is a useful feature for quantum optical information processing, where large-alphabet signals can be demultiplexed by a mode-selective `drop filter' \\cite{Reddy:2013aa}. In fact, the conventional traveling-wave Raman protocol \\cite{Nunn:2007aa, Gorshkov:2007qm} is nearly single-mode \\cite{Nunn:2008oq}, but the mode selectivity degrades at high efficiency --- a phenomenon encountered also in engineering mode-selective frequency conversion \\cite{Eckstein:2011aa}. Recently Reddy \\emph{et al.} showed how to achieve high mode selectivity and high efficiency in frequency conversion by double-passing or multi-passing the active medium, so that each interaction was weak enough to remain effectively single-mode \\cite{Reddy:2013aa}. The perfect mode-selectivity of the cavity memory analysed here can be understood as the multi-pass limit of this approach, where the interaction describing a single pass through the cavity is weak, and therefore separable, whereas the coherent combination of all cavity round-trips provides for arbitrarily high efficiency while retaining temporal mode selectivity.\n\n\n\n\\section{Autocorrelation}\nA key figure of merit for the operation of a quantum memory is the ability to preserve the sub-Poissonian statistics of stored single-photon Fock states. In our recent experiments with a Raman $\\Lambda$-memory without any cavity, we found that although the average number of noise photons generated by four-wave mixing in the absence of an input signal field was low, the effect of four-wave mixing on the photon statistics of the fields retrieved from the memory was dramatic \\cite{Michelberger:2015aa}. To see how the cavity influences the performance of the memory as a component for synchronising photonic quantum information, we compute the $g^{(2)}$ autocorrelation function for the fields emerging from the memory, which can be written as\n\\begin{eqnarray}\n\\nonumber\ng^{(2)}_{\\mathrm{out},j} &=& \\frac{ \\int_0^1\\!\\! \\int_0^1 \\!\\! {\\mathrm{d}} \\epsilon {\\mathrm{d}} \\epsilon' \\left \\langle  \\sigma^\\dagger_{\\mathrm{out},j}(\\epsilon)\\sigma_{\\mathrm{out},j}^\\dagger(\\epsilon') \\sigma_{\\mathrm{out},j}(\\epsilon')\\sigma_{\\mathrm{out},j}(\\epsilon) \\right \\rangle}{\\left[ \\int_0^1 \\!\\!{\\mathrm{d}} \\epsilon'' \\sigma_{\\mathrm{out},j}^\\dagger(\\epsilon'') \\sigma_{\\mathrm{out},j}(\\epsilon'')\\right]^2}\\\\\n\\label{g2}&=& 1 + \\frac{ \\mathrm{tr}\\left\\{P_j^2\\right\\}  - \\left(2-g^{(2)}_\\mathrm{in,1}\\right)N_{\\mathrm{in},1}^2\\left\\langle\\, {\\varphi_j}\\,|\\,{\\varphi_j}\\,\\right\\rangle^2}{N_{\\mathrm{out},j}^2}.\n\\end{eqnarray}\nFor the fields emerging from the storage interaction, we obtain the result\n\\begin{eqnarray}\n\\label{g2out} N_{\\mathrm{out},1}^2\\left[ g^{(2)}_{\\mathrm{out},1}-1\\right] &=&  \\left[g^{(2)}_{\\mathrm{in},1}-1\\right]N_{\\mathrm{in},1}^2 \\left\\langle\\, {\\varphi_1}\\,|\\,{\\varphi_1}\\,\\right\\rangle^2 \\\\\n\\nonumber & & + \\mathrm{tr}\\left\\{ M_\\mathrm{FWM}^{[1]} M_\\mathrm{FWM}^{[1]\\dagger} M_\\mathrm{FWM}^{[1]} M_\\mathrm{FWM}^{[1]\\dagger} \\right\\}\\\\\n\\nonumber & &  + 2 N_{\\mathrm{in},1} \\left \\langle {\\varphi_1} \\, \\right | M_\\mathrm{FWM}^{[1]} M_\\mathrm{FWM}^{[1]\\dagger} \\left | \\, {\\varphi_1} \\right \\rangle,\n\\end{eqnarray}\nwhere the second term evaluates to\n\\begin{eqnarray}\n\\nonumber \\mathrm{tr}\\left\\{ M_\\mathrm{FWM}^{[1]} M_\\mathrm{FWM}^{[1]\\dagger} M_\\mathrm{FWM}^{[1]} M_\\mathrm{FWM}^{[1]\\dagger} \\right\\} &=& |r\\chi C_\\mathrm{s}C_\\mathrm{a}x|^4\\zeta^{-4}\\times \\\\\n\\nonumber & & \\left\\{  4\\zeta (1-E)\\right.\\\\\n\\label{trM}& & \\left. -2\\zeta^2 E -\\Sigma\\right\\},\n\\end{eqnarray}\nwith $\\Sigma = 2e^{-\\zeta}\\left[\\sinh(\\zeta)-\\zeta\\right]$. Of particular interest is the corresponding expression for the $g^{(2)}$ autocorrelation of the fields retrieved from the memory by the readout control pulse, which, after some rather lengthy calculations can be written as,\n\\begin{eqnarray}\n\\nonumber N_{\\mathrm{out},2}^2\\left[ g^{(2)}_{\\mathrm{out},2}-1\\right] &=& |r\\chi C_\\mathrm{s}|^4\\bigg\\{ \\left[g^{(2)}_{\\mathrm{in},1}-1\\right]N_{\\mathrm{in},1}^2 |C_\\mathrm{s} E \\kappa |^4 \\\\\n\\label{g2out} & & + |C_\\mathrm{a}x|^4h(\\zeta)\\\\\n\\nonumber & &  + 2 N_{\\mathrm{in},1} |C_\\mathrm{s}C_\\mathrm{a}x\\kappa|^2 h'(\\zeta)\\bigg\\},\n\\end{eqnarray}\nwhere we defined the functions\n\\begin{eqnarray}\n\\nonumber h(\\zeta)&=& 4\\frac{1-E}{\\zeta^3} -2\\frac{E}{\\zeta^2} + E^4  + \\frac{\\Sigma}{\\zeta^4}(2\\zeta E-1),\\\\\n\\label{hs} h'(\\zeta)&=& E^4 + \\frac{E\\Sigma}{\\zeta^3}.\\end{eqnarray}\nOf particular interest is the case of storing single photon Fock states, for which $g^{(2)}_{\\mathrm{in},1} = 0$, and we obtain\n\\begin{eqnarray}\n\\nonumber g^{(2)}_{\\mathrm{out},2} &=& \\left\\{2N_{\\mathrm{in},1}|\\kappa C_\\mathrm{s}C_\\mathrm{a}x|^2 [E^2g(\\zeta) + h'(\\zeta)]\\right. \\\\\n\\nonumber & & \\left.+ |C_\\mathrm{a}x|^4 \\left[ g(\\zeta)^2 + h(\\zeta)\\right]\\right\\}\\\\\n\\nonumber &&\\times \\left[N_{\\mathrm{in},1}|\\kappa C_\\mathrm{s}E|^2 +|C_\\mathrm{a}x|^2 g(\\zeta)\\right]^{-2}.\n\\end{eqnarray}\nNote that for incident single photons, $N_{\\mathrm{in},1}\\leq 1$ is to be interpreted as the average number of photons per pulse, including any losses prior to the memory. For a heralded photon source \\cite{Spring:2013aa}, $N_{\\mathrm{in},1}$ is therefore the \\emph{heralding efficiency} of the source. \n\nIf we achieve strong noise suppression, so that $|x|^2\\ll N_{\\mathrm{in},1}$, then the autocorrelation can be written as\n\n", "index": 31, "text": "\\begin{equation}\n\\label{g2_low_noise}\ng^{(2)}_{\\mathrm{out},2} = 2\\left[1+\\frac{h'(\\zeta)}{E^2g(\\zeta)}\\right]\\frac{1}{\\mathrm{SNR}}.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E11.m1\" class=\"ltx_Math\" alttext=\"g^{(2)}_{\\mathrm{out},2}=2\\left[1+\\frac{h^{\\prime}(\\zeta)}{E^{2}g(\\zeta)}%&#10;\\right]\\frac{1}{\\mathrm{SNR}}.\" display=\"block\"><mrow><mrow><msubsup><mi>g</mi><mrow><mi>out</mi><mo>,</mo><mn>2</mn></mrow><mrow><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>=</mo><mrow><mn>2</mn><mo>\u2062</mo><mrow><mo>[</mo><mrow><mn>1</mn><mo>+</mo><mfrac><mrow><msup><mi>h</mi><mo>\u2032</mo></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b6</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msup><mi>E</mi><mn>2</mn></msup><mo>\u2062</mo><mi>g</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b6</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mrow><mo>]</mo></mrow><mo>\u2062</mo><mfrac><mn>1</mn><mi>SNR</mi></mfrac></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.00157.tex", "nexttext": "\nwith the efficiency given by\n\n", "itemtype": "equation", "pos": 39682, "prevtext": "\n\n\\section{Weak coupling limit}\nThe expressions for the efficiency, signal-to-noise ratio and autocorrelation simplify in the limit of weak coupling, when $|C_\\mathrm{s,a}|\\ll 1$, so that $\\zeta \\ll 1$. In this limit we obtain, to first order in $\\zeta$ (valid for $\\zeta \\lesssim 0.2$), $E\\rightarrow 1-\\frac{1}{2}\\zeta$, $\\Sigma \\rightarrow \\frac{1}{3}\\zeta^3-\\frac{1}{3}\\zeta^4$, $g(\\zeta)\\rightarrow \\frac{3}{2}-\\frac{7}{6}\\zeta$, $h(\\zeta)\\rightarrow \\frac{11}{6}-\\frac{13}{5}\\zeta$, $h'(\\zeta)\\rightarrow \\frac{4}{3}\n-\\frac{5}{2}\\zeta$. The number of retrieved photons is then given by\n\n", "index": 33, "text": "$$\nN_{\\mathrm{out},2} = |r\\chi C_\\mathrm{s}|^2\\left[N_{\\mathrm{in},1}(1-\\zeta)|C_\\mathrm{s}\\kappa|^2 + \\left(\\frac{3}{2}-\\frac{7}{6}\\zeta\\right)|C_\\mathrm{a} x|^2\\right],\n$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex6.m1\" class=\"ltx_Math\" alttext=\"N_{\\mathrm{out},2}=|r\\chi C_{\\mathrm{s}}|^{2}\\left[N_{\\mathrm{in},1}(1-\\zeta)|%&#10;C_{\\mathrm{s}}\\kappa|^{2}+\\left(\\frac{3}{2}-\\frac{7}{6}\\zeta\\right)|C_{\\mathrm%&#10;{a}}x|^{2}\\right],\" display=\"block\"><mrow><mrow><msub><mi>N</mi><mrow><mi>out</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>=</mo><mrow><msup><mrow><mo stretchy=\"false\">|</mo><mrow><mi>r</mi><mo>\u2062</mo><mi>\u03c7</mi><mo>\u2062</mo><msub><mi>C</mi><mi mathvariant=\"normal\">s</mi></msub></mrow><mo stretchy=\"false\">|</mo></mrow><mn>2</mn></msup><mo>\u2062</mo><mrow><mo>[</mo><mrow><mrow><msub><mi>N</mi><mrow><mi>in</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>-</mo><mi>\u03b6</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">|</mo><mrow><msub><mi>C</mi><mi mathvariant=\"normal\">s</mi></msub><mo>\u2062</mo><mi>\u03ba</mi></mrow><mo stretchy=\"false\">|</mo></mrow><mn>2</mn></msup></mrow><mo>+</mo><mrow><mrow><mo>(</mo><mrow><mfrac><mn>3</mn><mn>2</mn></mfrac><mo>-</mo><mrow><mfrac><mn>7</mn><mn>6</mn></mfrac><mo>\u2062</mo><mi>\u03b6</mi></mrow></mrow><mo>)</mo></mrow><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">|</mo><mrow><msub><mi>C</mi><mi mathvariant=\"normal\">a</mi></msub><mo>\u2062</mo><mi>x</mi></mrow><mo stretchy=\"false\">|</mo></mrow><mn>2</mn></msup></mrow></mrow><mo>]</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.00157.tex", "nexttext": "\nand the signal-to-noise ratio\n\n", "itemtype": "equation", "pos": 39885, "prevtext": "\nwith the efficiency given by\n\n", "index": 35, "text": "$$\n\\eta_\\mathrm{tot} = (1-\\zeta)|r\\chi C_\\mathrm{s}^2 \\kappa |^2,\n$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex7.m1\" class=\"ltx_Math\" alttext=\"\\eta_{\\mathrm{tot}}=(1-\\zeta)|r\\chi C_{\\mathrm{s}}^{2}\\kappa|^{2},\" display=\"block\"><mrow><mrow><msub><mi>\u03b7</mi><mi>tot</mi></msub><mo>=</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>-</mo><mi>\u03b6</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">|</mo><mrow><mi>r</mi><mo>\u2062</mo><mi>\u03c7</mi><mo>\u2062</mo><msubsup><mi>C</mi><mi mathvariant=\"normal\">s</mi><mn>2</mn></msubsup><mo>\u2062</mo><mi>\u03ba</mi></mrow><mo stretchy=\"false\">|</mo></mrow><mn>2</mn></msup></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.00157.tex", "nexttext": "\nThe autocorrelation (again for incident single photons in the high noise-suppression regime) is found to be\n\n", "itemtype": "equation", "pos": 39984, "prevtext": "\nand the signal-to-noise ratio\n\n", "index": 37, "text": "$$\n\\mathrm{SNR} = \\left(\\frac{2}{3}-\\frac{4}{27}\\zeta\\right)N_{\\mathrm{in},1}|\\kappa|^2\\left|\\frac{\\Gamma_\\mathrm{a}}{\\Gamma_\\mathrm{s}}\\right|^2\\frac{1}{|x|^2}.\n$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex8.m1\" class=\"ltx_Math\" alttext=\"\\mathrm{SNR}=\\left(\\frac{2}{3}-\\frac{4}{27}\\zeta\\right)N_{\\mathrm{in},1}|%&#10;\\kappa|^{2}\\left|\\frac{\\Gamma_{\\mathrm{a}}}{\\Gamma_{\\mathrm{s}}}\\right|^{2}%&#10;\\frac{1}{|x|^{2}}.\" display=\"block\"><mrow><mrow><mi>SNR</mi><mo>=</mo><mrow><mrow><mo>(</mo><mrow><mfrac><mn>2</mn><mn>3</mn></mfrac><mo>-</mo><mrow><mfrac><mn>4</mn><mn>27</mn></mfrac><mo>\u2062</mo><mi>\u03b6</mi></mrow></mrow><mo>)</mo></mrow><mo>\u2062</mo><msub><mi>N</mi><mrow><mi>in</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">|</mo><mi>\u03ba</mi><mo stretchy=\"false\">|</mo></mrow><mn>2</mn></msup><mo>\u2062</mo><msup><mrow><mo>|</mo><mfrac><msub><mi mathvariant=\"normal\">\u0393</mi><mi mathvariant=\"normal\">a</mi></msub><msub><mi mathvariant=\"normal\">\u0393</mi><mi mathvariant=\"normal\">s</mi></msub></mfrac><mo>|</mo></mrow><mn>2</mn></msup><mo>\u2062</mo><mfrac><mn>1</mn><msup><mrow><mo stretchy=\"false\">|</mo><mi>x</mi><mo stretchy=\"false\">|</mo></mrow><mn>2</mn></msup></mfrac></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.00157.tex", "nexttext": "\nIn general the control field $\\Omega(t)$ can be shaped so as to achieve $|\\kappa|=1$ and maximise the SNR. In the weak coupling limit the requirement to shape the signal and control pulses is relaxed, because when $|f|\\ll1$ the optimal input mode $e^{f^*\\epsilon}$ is approximately flat. If the signal and control pulse shapes derive from a common source, so that $\\psi_\\mathrm{in}(t)\\propto \\Omega(t)$ and $\\psi_\\mathrm{in}(\\epsilon)=1$, we then achieve $\\kappa = 1-\\frac{3}{2}f - \\frac{1}{4}f^*\\approx 1$.\n\n\\section{Strong coupling}\nOn the other hand it is also instructive to consider the case of very strong coupling, when $\\zeta\\gg1$. In that case we have $E\\rightarrow 1/\\zeta$, $g(\\zeta)\\rightarrow 1/\\zeta$, $\\Sigma \\rightarrow 1$, $h(\\zeta)\\rightarrow 2(\\zeta-1)/\\zeta^4$, $h'(\\zeta)\\rightarrow 2/\\zeta^4$, and the memory efficiency tends to\n\\begin{eqnarray}\n\\nonumber \\eta_\\mathrm{tot}&\\rightarrow&\\left| \\frac{r\\chi C_\\mathrm{s}^2 \\kappa }{\\zeta}\\right|^2  \\\\\n\\label{eff_strong} & =&| r\\chi \\kappa|^2 \\frac{|C_\\mathrm{s}|^4}{\\zeta^2}.\n\\end{eqnarray}\nFor very strong coupling, we find $g^{(2)}_{\\mathrm{out},2} \\longrightarrow 1$, independent of the noise suppression factor $x$. In this case the four-wave mixing gain dominates and the system has effectively become a Raman laser. To remain in the regime where the cavity suppresses the four-wave mixing, we should have $|x|\\ll N_{\\mathrm{in},1}/\\zeta$, in which case from (\\ref{g2_low_noise}) we obtain\n\n", "itemtype": "equation", "pos": 40257, "prevtext": "\nThe autocorrelation (again for incident single photons in the high noise-suppression regime) is found to be\n\n", "index": 39, "text": "\\begin{equation}\n\\label{g2_weak}\ng^{(2)}_{\\mathrm{out},2} = \\left(\\frac{34}{9}-\\frac{14}{81}\\zeta\\right)\\frac{1}{\\mathrm{SNR}}.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E12.m1\" class=\"ltx_Math\" alttext=\"g^{(2)}_{\\mathrm{out},2}=\\left(\\frac{34}{9}-\\frac{14}{81}\\zeta\\right)\\frac{1}{%&#10;\\mathrm{SNR}}.\" display=\"block\"><mrow><mrow><msubsup><mi>g</mi><mrow><mi>out</mi><mo>,</mo><mn>2</mn></mrow><mrow><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>=</mo><mrow><mrow><mo>(</mo><mrow><mfrac><mn>34</mn><mn>9</mn></mfrac><mo>-</mo><mrow><mfrac><mn>14</mn><mn>81</mn></mfrac><mo>\u2062</mo><mi>\u03b6</mi></mrow></mrow><mo>)</mo></mrow><mo>\u2062</mo><mfrac><mn>1</mn><mi>SNR</mi></mfrac></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.00157.tex", "nexttext": "\nHere the autocorrelation rises linearly with the coupling parameter $\\zeta$. To achieve low-noise operation of the memory we therefore seek the smallest coupling strength $\\zeta$ for which the efficiency saturates.\n\n\\section{Comparison with previous results}\nCavity-enhanced $\\Lambda$-memories have been analysed previously \\cite{Gorshkov:2007aa,Dantan:2005aa,He:2009aa}. To compare with those works, we consider the case that there is no four-wave mixing (equivalent to the limit $\\delta \\rightarrow \\infty$ so that $C_\\mathrm{a}=0$), and we assume the signal field to be tuned to the empty-cavity resonance with $k_\\mathrm{s}L = 0$~$\\mathrm{mod}(2\\pi)$. Finally we assume that there are no interface or scattering losses inside the cavity, other than atomic absorption contained in $\\kappa_\\mathrm{s}$. In this case we can express the cooperativity $\\mathcal{C}$ for the signal field in terms of the absorption-free cooperativity $\\mathbb{C} = rd/(1-r)$,\n\n", "itemtype": "equation", "pos": 41865, "prevtext": "\nIn general the control field $\\Omega(t)$ can be shaped so as to achieve $|\\kappa|=1$ and maximise the SNR. In the weak coupling limit the requirement to shape the signal and control pulses is relaxed, because when $|f|\\ll1$ the optimal input mode $e^{f^*\\epsilon}$ is approximately flat. If the signal and control pulse shapes derive from a common source, so that $\\psi_\\mathrm{in}(t)\\propto \\Omega(t)$ and $\\psi_\\mathrm{in}(\\epsilon)=1$, we then achieve $\\kappa = 1-\\frac{3}{2}f - \\frac{1}{4}f^*\\approx 1$.\n\n\\section{Strong coupling}\nOn the other hand it is also instructive to consider the case of very strong coupling, when $\\zeta\\gg1$. In that case we have $E\\rightarrow 1/\\zeta$, $g(\\zeta)\\rightarrow 1/\\zeta$, $\\Sigma \\rightarrow 1$, $h(\\zeta)\\rightarrow 2(\\zeta-1)/\\zeta^4$, $h'(\\zeta)\\rightarrow 2/\\zeta^4$, and the memory efficiency tends to\n\\begin{eqnarray}\n\\nonumber \\eta_\\mathrm{tot}&\\rightarrow&\\left| \\frac{r\\chi C_\\mathrm{s}^2 \\kappa }{\\zeta}\\right|^2  \\\\\n\\label{eff_strong} & =&| r\\chi \\kappa|^2 \\frac{|C_\\mathrm{s}|^4}{\\zeta^2}.\n\\end{eqnarray}\nFor very strong coupling, we find $g^{(2)}_{\\mathrm{out},2} \\longrightarrow 1$, independent of the noise suppression factor $x$. In this case the four-wave mixing gain dominates and the system has effectively become a Raman laser. To remain in the regime where the cavity suppresses the four-wave mixing, we should have $|x|\\ll N_{\\mathrm{in},1}/\\zeta$, in which case from (\\ref{g2_low_noise}) we obtain\n\n", "index": 41, "text": "$$\ng^{(2)}_{\\mathrm{out},2} = \\left|\\frac{\\Gamma_\\mathrm{s}}{\\Gamma_\\mathrm{a}}\\right|^2 \\frac{2 |x|^2 \\zeta}{N_{\\mathrm{in},1}|\\kappa|^2}.\n$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex9.m1\" class=\"ltx_Math\" alttext=\"g^{(2)}_{\\mathrm{out},2}=\\left|\\frac{\\Gamma_{\\mathrm{s}}}{\\Gamma_{\\mathrm{a}}}%&#10;\\right|^{2}\\frac{2|x|^{2}\\zeta}{N_{\\mathrm{in},1}|\\kappa|^{2}}.\" display=\"block\"><mrow><mrow><msubsup><mi>g</mi><mrow><mi>out</mi><mo>,</mo><mn>2</mn></mrow><mrow><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>=</mo><mrow><msup><mrow><mo>|</mo><mfrac><msub><mi mathvariant=\"normal\">\u0393</mi><mi mathvariant=\"normal\">s</mi></msub><msub><mi mathvariant=\"normal\">\u0393</mi><mi mathvariant=\"normal\">a</mi></msub></mfrac><mo>|</mo></mrow><mn>2</mn></msup><mo>\u2062</mo><mfrac><mrow><mn>2</mn><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">|</mo><mi>x</mi><mo stretchy=\"false\">|</mo></mrow><mn>2</mn></msup><mo>\u2062</mo><mi>\u03b6</mi></mrow><mrow><msub><mi>N</mi><mrow><mi>in</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">|</mo><mi>\u03ba</mi><mo stretchy=\"false\">|</mo></mrow><mn>2</mn></msup></mrow></mfrac></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.00157.tex", "nexttext": "\nwhere $\\Gamma_\\mathbb{C} = \\Gamma_\\mathrm{s} + \\mathbb{C}\\gamma$. We also find $\\zeta  = 2W\\gamma (\\mathbb{C}+1)/|\\Gamma_\\mathbb{C}|^2$ and $\\chi = (1+r)\\Gamma_\\mathrm{s}/\\Gamma_\\mathbb{C}$, which upon substitution into (\\ref{eff_strong}) yields the rather elegant result, previously derived by Gorshkov \\cite{Gorshkov:2007aa}, that the optimal storage efficiency in the limit of strong coupling is\n\n", "itemtype": "equation", "pos": 42965, "prevtext": "\nHere the autocorrelation rises linearly with the coupling parameter $\\zeta$. To achieve low-noise operation of the memory we therefore seek the smallest coupling strength $\\zeta$ for which the efficiency saturates.\n\n\\section{Comparison with previous results}\nCavity-enhanced $\\Lambda$-memories have been analysed previously \\cite{Gorshkov:2007aa,Dantan:2005aa,He:2009aa}. To compare with those works, we consider the case that there is no four-wave mixing (equivalent to the limit $\\delta \\rightarrow \\infty$ so that $C_\\mathrm{a}=0$), and we assume the signal field to be tuned to the empty-cavity resonance with $k_\\mathrm{s}L = 0$~$\\mathrm{mod}(2\\pi)$. Finally we assume that there are no interface or scattering losses inside the cavity, other than atomic absorption contained in $\\kappa_\\mathrm{s}$. In this case we can express the cooperativity $\\mathcal{C}$ for the signal field in terms of the absorption-free cooperativity $\\mathbb{C} = rd/(1-r)$,\n\n", "index": 43, "text": "\\begin{equation}\n\\label{Cinterms}\n\\mathcal{C} = \\mathbb{C}\\frac{1}{r}\\frac{\\Gamma_\\mathrm{s}}{\\Gamma_\\mathbb{C}},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E13.m1\" class=\"ltx_Math\" alttext=\"\\mathcal{C}=\\mathbb{C}\\frac{1}{r}\\frac{\\Gamma_{\\mathrm{s}}}{\\Gamma_{\\mathbb{C}%&#10;}},\" display=\"block\"><mrow><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udc9e</mi><mo>=</mo><mrow><mi>\u2102</mi><mo>\u2062</mo><mfrac><mn>1</mn><mi>r</mi></mfrac><mo>\u2062</mo><mfrac><msub><mi mathvariant=\"normal\">\u0393</mi><mi mathvariant=\"normal\">s</mi></msub><msub><mi mathvariant=\"normal\">\u0393</mi><mi>\u2102</mi></msub></mfrac></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.00157.tex", "nexttext": "\nwhich is independent of the detuning $\\Delta_\\mathrm{s}$ and also independent of the control field energy $\\mathcal{E}\\propto W$, provided the control field is strong enough to reach saturation, $\\zeta \\gg 1$. Unit efficiency is achieved with an optically thick ensemble in a high quality cavity with a mode-matched storage interaction such that $|\\kappa|=1$.\n\nIn a real atomic system, four-wave mixing is present, and in that case the maximum noise suppression is achieved when the cavity resonance condition $\\phi_\\mathrm{s} = 0\\mod{2\\pi}$ obtains, which is different to the empty-cavity resonance condition $k_\\mathrm{s}L = 0\\mod{2\\pi}$ because of atomic dispersion. In fact, the resonance condition $\\phi_\\mathrm{s} = 0$ is natural in a real experiment, where the atoms are introduced into the cavity before the signal field is tuned to resonance with the cavity. Any other scattering losses inside the cavity should also be included in the roundtrip amplitude transmission $\\mu_\\mathrm{s}$. Four-wave mixing gain can boost the efficiency (while introducing noise), whereas intra-cavity losses will reduce the efficiency. In general the expression (\\ref{eff_1}) and its strong-coupling limit (\\ref{eff_strong}) can be used to predict the memory performance.\n\n\n\n\n\n\n\n\n\n\\section{Double resonance}\nWe have so far treated the control pulse $\\Omega$ as an external parameter, but the control is an optical field that co-propagates with the signal field around the cavity. As depicted in Fig.~\\ref{fig:cavity_memory} (b) The control field frequency lies between that of the signal and the anti-Stokes field, so it is not immediately obvious how it can be introduced into the cavity: if the free-spectral range of the cavity is adjusted so that resonance is achieved for the Stokes and anti-resonance is achieved for the anti-Stokes field, separated in frequency by $2\\delta$, then the cavity will not be resonant with the control, shifted from the Stokes frequency by $\\delta$. In this connection we briefly mention two solutions. First, the control can be polarised orthogonally to the signal field, and a birefringent cavity can be used to shift the cavity resonance for the control polarisation so as to in-couple the control. Second, the atomic dispersion described by the real parts of $\\kappa_\\mathrm{s,a}$ distorts the regular frequency spacing of the empty-cavity resonances \\cite{Munns:2015,Sabooni:2013aa}, and this distortion can be used to bring signal and control (even co-polarised) into simultaneous resonance, while the anti-Stokes is off-resonant. These or other techniques may be used, which lie beyond the scope of this work. In any case, a resonantly coupled control will benefit from intra-cavity field enhancement,\n\n", "itemtype": "equation", "pos": 43493, "prevtext": "\nwhere $\\Gamma_\\mathbb{C} = \\Gamma_\\mathrm{s} + \\mathbb{C}\\gamma$. We also find $\\zeta  = 2W\\gamma (\\mathbb{C}+1)/|\\Gamma_\\mathbb{C}|^2$ and $\\chi = (1+r)\\Gamma_\\mathrm{s}/\\Gamma_\\mathbb{C}$, which upon substitution into (\\ref{eff_strong}) yields the rather elegant result, previously derived by Gorshkov \\cite{Gorshkov:2007aa}, that the optimal storage efficiency in the limit of strong coupling is\n\n", "index": 45, "text": "\\begin{equation}\n\\label{Gorsh_eff}\n\\eta_\\mathrm{tot} = |\\kappa|^2\\left(\\frac{1+r}{2}\\right)^2\\left[\\frac{\\mathbb{C}}{\\mathbb{C}+1}\\right]^2,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14.m1\" class=\"ltx_Math\" alttext=\"\\eta_{\\mathrm{tot}}=|\\kappa|^{2}\\left(\\frac{1+r}{2}\\right)^{2}\\left[\\frac{%&#10;\\mathbb{C}}{\\mathbb{C}+1}\\right]^{2},\" display=\"block\"><mrow><mrow><msub><mi>\u03b7</mi><mi>tot</mi></msub><mo>=</mo><mrow><msup><mrow><mo stretchy=\"false\">|</mo><mi>\u03ba</mi><mo stretchy=\"false\">|</mo></mrow><mn>2</mn></msup><mo>\u2062</mo><msup><mrow><mo>(</mo><mfrac><mrow><mn>1</mn><mo>+</mo><mi>r</mi></mrow><mn>2</mn></mfrac><mo>)</mo></mrow><mn>2</mn></msup><mo>\u2062</mo><msup><mrow><mo>[</mo><mfrac><mi>\u2102</mi><mrow><mi>\u2102</mi><mo>+</mo><mn>1</mn></mrow></mfrac><mo>]</mo></mrow><mn>2</mn></msup></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.00157.tex", "nexttext": "\nwhere $t_\\Omega$, $\\mu_\\Omega$ are the mirror amplitude transmission and the cavity-roundtrip amplitude transmission for the control mode, with $\\mathcal{F}_\\mathrm{\\Omega}$ the corresponding finesse, and where $\\Omega_0$ is the free-space Rabi frequency. Compared to a free-space memory, without any cavity around the atoms, where $\\Omega$, $\\mathcal{C}$ must be replaced instead by their free-space counterparts $\\Omega_0$, $d$, the cavity memory benefits from a double enhancement in coupling strength, by a factor $\\sim \\mathcal{F}_\\mathrm{s}^2\\mathcal{F}_\\Omega^2/\\pi^2$. This doubly-resonant enhancement enables efficient light storage with fewer atoms and much less control pulse energy $\\mathcal{E}$ than required to run a free-space memory --- and of course four-wave mixing is suppressed in this configuration, which it is not in a free-space memory.\n\n\\section{Bandwidth}\nThe analysis presented here assumes adiabatic following of the atoms driven by the intra-cavity fields, and also adiabatic evolution of the intra-cavity fields driven by the external fields impinging on the cavity. This \\emph{bad cavity} approximation holds when the spectral bandwidth of the external fields is much narrower than the decay rates $\\gamma_\\mathrm{s,a}$ of the intra-cavity fields. Or equivalently the cavity resonance at the signal frequency, with linewidth $\\gamma_\\mathrm{s}$ should be broad compared to the signal pulse bandwidth. The acceptance bandwidth $\\delta_\\mathrm{s}$ of such a memory is therefore limited by the cavity finesse, $\\delta_\\mathrm{s} < a\\Delta_\\mathrm{FSR}/\\mathcal{F}_\\mathrm{s}$, where $a\\sim 0.3$ is a `safety margin' and where $\\Delta_\\mathrm{FSR}$ is the free spectral range of the cavity. Assuming low loss so that $\\mu_\\mathrm{a}\\approx \\mu_\\mathrm{s}\\approx 1$, and the resonance/anti-resonance conditions $\\phi_\\mathrm{s} = 0\\mod{2\\pi}$, $\\phi_\\mathrm{a}=\\pi\\mod{2\\pi}$, we have $x\\approx 2\\pi/\\mathcal{F}_\\mathrm{s}$, and so $\\delta_\\mathrm{s}\\propto x$, which expresses a trade-off between noise suppression and speed of operation. Nonetheless we will show in the next section that it is feasible to operate a moderately broadband memory with good noise suppression in alkali vapour.\n\n\\section{Cavity-enhanced Raman memory}\nHere we consider a specific implementation of a $\\Lambda$-memory in caesium vapour, in the far-off-resonant Raman limit. While our results are valid for adiabatic storage with arbitrary detunings, and also on resonance --- which corresponds to EIT-type $\\Lambda$-memories --- the Raman configuration has the advantage that broadband pulses can be stored at room temperature outside of the Doppler and collisional absorption profile, and the pulse durations $\\sim$ns timescale are sufficiently short that the collisional fluorescence \\cite{Manz:2007aa} and dephasing are negligible during the optical interactions \\cite{Reim:2011ys}. Preliminary experiments have confirmed the operating principles of the cavity-enhanced memory proposed here \\cite{Saunders:2015aa}, and this calculation indicates that a high-performance memory is within reach. We begin by noting the caesium hyperfine splitting of $\\delta=9.2$~GHz $=57.8\\times 10^9$s$^{-1}$. For simplicity consider the proposal, mentioned above, to use a tunable birefringence to in-couple an orthogonally-polarised control field. Neglecting for the moment atomic dispersion, this fixes the free-spectral range of the cavity to $\\Delta_\\mathrm{FSR} = 4\\delta/(2m+1)$, where the integer $m=0,1,2...$ specifies the \\emph{order} of the cavity --- that is, the number of cavity resonances that lie between the signal and anti-Stokes frequencies. The largest operating bandwidth is achieved for the largest free-spectral range, so we consider a zero-order cavity. The cavity roundtrip length is then fixed to be $L = 2\\pi c/\\Delta_\\mathrm{FSR} = 8$~mm, which is much smaller than a comparable free-space memory and could be incorporated `on chip'. The natural linewidth of the Cs D$_2$ line at $\\lambda=852$~nm is $2\\gamma = 5.2$~MHz, but with a buffer gas to extend the storage lifetime the pressure-broadened linewidth could be larger, so we will assume $2\\gamma \\approx 50$~MHz. We then choose a signal detuning of $\\Delta_\\mathrm{s}=5$~GHz, which puts us in the far-off-resonant limit, and which lies sufficiently outside the Doppler profile, $\\sim 500$~MHz at room temperature, that inhomogeneous broadening of the vapour can be neglected. Assuming a temperature of $\\sim70^\\circ$~C, the optical depth --- fixed by the cavity length $L$ and the temperature-dependence of the caesium vapour pressure --- is found to be $d\\approx380$. For a collimated cavity mode the Rayleigh range should be matched to the roundtrip length, which fixes the transverse mode area to $\\mathcal{A} = \\lambda L$. Figure~\\ref{fig:effs_and_g2s_2} shows the efficiency and $g^{(2)}$ autocorrelation function for the storage of single photons heralded with efficiency $N_{\\mathrm{in},1}=0.5$ in such a cavity-enhanced Raman memory, as a function of the energy of the control pulses, for two different input-output coupler reflectivities, and assuming several different levels of intra-cavity loss. We consider ideal mode-matching such that the mode overlap is $|\\kappa| = 1$. The highest asymptotic efficiencies are achieved for a critically coupled memory that maximises $\\chi$, since with strong noise suppression we have $\\eta_\\mathrm{tot} \\leq \\chi^2/4$. For an intracavity roundtrip loss parameterised by $\\mu_\\mathrm{s}/r = \\cos^2 \\theta \\approx 1-\\theta^2$ (for $\\theta\\ll 1$), the optimal reflectivity is $r_\\mathrm{opt} = 1-\\sqrt{2}\\theta$, corresponding to an optimised transmission amplitude $\\chi_\\mathrm{opt}/2 =  (\\sqrt{2}-\\sin \\theta)/(\\sin \\theta + \\sqrt{2}\\cos^2\\theta)\\approx r_\\mathrm{opt}$. For a lossless cavity we have $r_\\mathrm{opt}=\\chi_\\mathrm{opt}/2 = 1$, but in that case the acceptance bandwidth of the memory is zero. In general, then, after minimising intra-cavity losses, the input-output coupler reflectivity should be maximised, subject to achieving the required acceptance bandwidth and noise suppression.\n\n\\begin{figure}[h]\n\\begin{center}\n\\includegraphics[width=10.3cm]{effs_and_g2s_2.png}\n\\vspace{-1.5cm}\n\\caption{The predicted efficiency $\\eta_\\mathrm{tot}$ and autocorrelation $g^{(2)}_{\\mathrm{out},2}$ for the storage of single photons, heralded with efficiency $N_{\\mathrm{in},1} = 0.5$, in a cavity-enhanced Raman memory, as described in the text, with input-output-coupler-reflectivities $r=0.9$ ((a),(b)) and $r=0.95$ ((c),(d)), and a range of intra-cavity roundtrip intensity losses (see legend).}\n\\label{fig:effs_and_g2s_2}\n\\end{center}\n\\end{figure}\n\n\n\nThe cavity linewidth is $1.3$~GHz and $0.6$~GHz for the two cases $r = 0.9$, $r = 0.95$, respectively. The memory acceptance bandwidths are then $\\delta_\\mathrm{s}\\sim 400$~MHz, and $200$~MHz, respectively. These are compatible with cavity-enhanced downconversion sources \\cite{Brecht:2015ab} and would enable the storage of few-ns-duration pulses, suitable for the fastest useful clock-rates, $\\sim$0.1-1~GHz, for electronic synchronisation applications. Finally, the control pulse energies required to saturate the efficiency, on the order of $\\mathcal{E}=10$~pJ are sufficiently low that the memory could be driven by the modulated output of a semiconductor diode laser.\n\n\\section{Conclusion}\nWe have described a method to suppress four-wave mixing noise in a $\\Lambda$-memory by means of a cavity tuned simultaneously into resonance with the signal field to be stored, and into anti-resonance with the field mode that is excited through spontaneous Raman scattering driven by the control field interacting with the populated initial state. We have extended previous analyses of cavity-enhanced $\\Lambda$-memories by explicitly considering the evolution of both the Stokes and anti-Stokes fields, and we have derived analytic formulas for the four-wave mixing noise and --- a key figure of merit for quantum information applications --- the $g^{(2)}$ autocorrelation for the retrieved fields. Our analysis shows that highly efficient and low-noise operation can be simultaneously achieved, and we have presented an example calculation for a memory in Cs vapour which offers the realistic prospect of constructing technically-simple quantum memories for near-infra-red photons, with near-unit efficiency and negligible noise, operated at GHz rates at room temperature in a chip-scale package powered by diode lasers. We are optimistic that technologies of this kind will enable the field of quantum optics to finally escape the `two-photon doldrums' and explore the physics of large quantum systems.\n\n\\acknowledgements\nJN acknowledges W.~S.~Kolthammer and X.-M.~Jin for early discussions. This work was supported by the UK Engineering and Physical Sciences Research Council (EPSRC) through the standard grant EP/J000051/1, the programme grant EP/K034480/1 and the EPSRC Hub for Networked Quantum Information Technologies (NQIT). Additional support came from the EU IP on Quantum Interfaces, Sensors, and Communication based on Entanglement Integrating Project (Q-ESSENCE; 248095), the Air Force Office of Scientific Research: European Office of Aerospace Research \\& Development (AFOSR EOARD; FA8655-09-1-3020), the EU IP SIQS (600645), and EU Marie-Curie Fellowships PIIF-GA-2013-629229 to DJS and PIEF-GA- 2013-627372 to EP. CQ was supported by the China Scholarship Council. JN acknowledges a Royal Society University Research Fellowship. IAW acknowledges an ERC Advanced Grant (MOQUACINO). MGR and DVR acknowledge support from the U.S. National Science Foundation (QIS Program).\n\n\n\n\n\n\n\n\n\n\n\\begin{thebibliography}{10}\n\n\\bibitem{Migdall:2002cr}\nMigdall A, Branning D and Castelletto S, \\emph{Physical Review A},\n  66(5):053805, 2002.\n\n\\bibitem{McCusker:2008ve}\nMcCusker K, Peters N, VanDevender A \\emph{et~al.}, in \\emph{Lasers and\n  Electro-Optics, 2008 and 2008 Conference on Quantum Electronics and Laser\n  Science. CLEO/QELS 2008. Conference on}, pp. 1--2, IEEE, 2008.\n\n\\bibitem{Nunn:2013aa}\nNunn J, Langford N, Kolthammer W \\emph{et~al.}, \\emph{Physical review letters},\n  110(13):133601, 2013.\n\n\\bibitem{Francis-Jones:2015aa}\nFrancis-Jones RJ and Mosley PJ, \\emph{arXiv preprint arXiv:1503.06178}, 2015.\n\n\\bibitem{Rohde:2015aa}\nRohde PP, Helt L, Steel M \\emph{et~al.}, \\emph{arXiv preprint\n  arXiv:1503.03546}, 2015.\n\n\\bibitem{Makino:2015aa}\nMakino K, Hashimoto Y, Yoshikawa Ji \\emph{et~al.}, \\emph{arXiv preprint\n  arXiv:1509.04409}, 2015.\n\n\\bibitem{Kaneda:2015aa}\nKaneda F, Christensen BG, Wong JJ \\emph{et~al.}, \\emph{arXiv preprint\n  arXiv:1507.06052}, 2015.\n\n\\bibitem{Meany:2014aa}\nMeany T, Ngah LA, Collins MJ \\emph{et~al.}, \\emph{Laser \\& Photonics Reviews},\n  8(3):L42, 2014.\n\n\\bibitem{Mendoza:2015aa}\nMendoza GJ, Santagati R, Munns J \\emph{et~al.}, \\emph{arXiv preprint\n  arXiv:1503.01215}, 2015.\n\n\\bibitem{Bussieres:2013aa}\nBussi{\\`e}res F, Sangouard N, Afzelius M \\emph{et~al.}, \\emph{Journal of Modern\n  Optics}, 60(18):1519, 2013.\n\n\\bibitem{Afzelius:2010aa}\nAfzelius M, Chaneli{\\'e}re T, Cone RL \\emph{et~al.}, \\emph{Laser \\& Photonics\n  Reviews}, 4(2):244, 2010.\n\n\\bibitem{Hammerer:2010vn}\nHammerer K, S{\\o}rensen A and Polzik E, \\emph{Reviews of Modern Physics},\n  82(2):1041, 2010.\n\n\\bibitem{Simon:2010aa}\nSimon C, Afzelius M, Appel J \\emph{et~al.}, \\emph{The European Physical Journal\n  D}, 58(1):1, 2010.\n\n\\bibitem{Lvovsky:2009ve}\nLvovsky A, Sanders B and Tittel W, \\emph{Nature Photonics}, 3(12):706, 2009,\n  ISSN 1749-4885.\n\n\\bibitem{Chen:2006aa}\nChen S, Chen YA, Strassel T \\emph{et~al.}, \\emph{Physical review letters},\n  97(17):173004, 2006.\n\n\\bibitem{Bussieres:2014aa}\nBussi{\\`e}res F, Clausen C, Tiranov A \\emph{et~al.}, \\emph{Nature Photonics},\n  8(10):775, 2014.\n\n\\bibitem{Reim:2010kx}\nReim K, Nunn J, Lorenz V \\emph{et~al.}, \\emph{Nature Photonics}, 2010.\n\n\\bibitem{Fleischhauer:2002ph}\nFleischhauer M and Lukin M, \\emph{Physical Review A}, 65(2):22314, 2002.\n\n\\bibitem{Choi:2008xi}\n{Choi} KS, {Deng} H, {Laurat} J \\emph{et~al.}, \\emph{Nature}, 452:67, 2008.\n\n\\bibitem{Kupchak:2015aa}\nKupchak C, Mittiga T, Jordaan B \\emph{et~al.}, \\emph{Scientific reports}, 5,\n  2015.\n\n\\bibitem{Nunn:2007aa}\nNunn J, Walmsley I, Raymer M \\emph{et~al.}, \\emph{Physical Review A},\n  75(1):011401, 2007.\n\n\\bibitem{Ding:2015aa}\nDing DS, Zhang W, Zhou ZY \\emph{et~al.}, \\emph{Nature Photonics}, 9(5):332,\n  2015.\n\n\\bibitem{Hosseini:2011zr}\nHosseini M, Campbell G, Sparkes B \\emph{et~al.}, \\emph{Nature Physics},\n  7(10):795, 2011.\n\n\\bibitem{Manz:2007aa}\nManz S, Fernholz T, Schmiedmayer J \\emph{et~al.}, \\emph{Physical Review A},\n  75(4):040101, 2007.\n\n\\bibitem{Phillips:2008uq}\nPhillips N, Gorshkov A and Novikova I, \\emph{Physical Review A}, 78(2):023801,\n  2008.\n\n\\bibitem{Michelberger:2015aa}\nMichelberger P, Champion T, Sprague M \\emph{et~al.}, \\emph{New Journal of\n  Physics}, 17(4):043006, 2015.\n\n\\bibitem{Lauk:2013aa}\nLauk N, O'Brien C and Fleischhauer M, \\emph{Physical Review A}, 88(1):013823,\n  2013.\n\n\\bibitem{Dabrowski:2014aa}\nDabrowski M, Chrapkiewicz R and Wasilewski W, \\emph{Optics express},\n  22(21):26076, 2014.\n\n\\bibitem{Romanov:2015aa}\nRomanov G, O'Brien C and Novikova I, \\emph{arXiv preprint arXiv:1509.08951},\n  2015.\n\n\\bibitem{Zhang:2014aa}\nZhang K, Guo J, Chen L \\emph{et~al.}, \\emph{Physical Review A}, 90(3):033823,\n  2014.\n\n\\bibitem{Saunders:2015ab}\nSaunders D, Munns J, Champion T \\emph{et~al.}, \\emph{arXiv preprint\n  arXiv:1510.04625}, 2015.\n\n\\bibitem{Reddy:2015aa}\nReddy D, Raymer M and McKinstrie C, \\emph{Physical Review A}, 91(1):012323,\n  2015.\n\n\\bibitem{Brecht:2015ac}\nBrecht B, Reddy DV, Silberhorn C \\emph{et~al.}, \\emph{Phys. Rev. X}, 5:041017,\n  2015.\n\n\\bibitem{Walls:2007aa}\nWalls DF and Milburn GJ, \\emph{Quantum optics}, Springer Science \\& Business\n  Media, 2007.\n\n\\bibitem{Gorshkov:2007aa}\nGorshkov AV, Andr{\\'e} A, Lukin MD \\emph{et~al.}, \\emph{Physical Review A},\n  76(3):033804, 2007.\n\n\\bibitem{Raymer:2013aa}\nRaymer M and McKinstrie C, \\emph{Physical Review A}, 88(4):043819, 2013.\n\n\\bibitem{Phillips:2011aa}\nPhillips NB, Gorshkov AV and Novikova I, \\emph{Physical Review A},\n  83(6):063823, 2011.\n\n\\bibitem{Wu:2010aa}\nWu C, Raymer M, Wang Y \\emph{et~al.}, \\emph{Physical Review A}, 82(5):053834,\n  2010.\n\n\\bibitem{Wasilewski:2006th}\nWasilewski W and Raymer M, \\emph{Physical Review A}, 73(6):63816, 2006.\n\n\\bibitem{Gorshkov:2007qm}\nGorshkov AV, Andre A, Lukin MD \\emph{et~al.}, \\emph{Physical Review A},\n  76:033805, 2007.\n\n\\bibitem{Munns:2015}\net~al M, \\emph{In prep.}, 2015.\n\n\\bibitem{Saunders:2015aa}\nSaunders D, Munns J, Champion T \\emph{et~al.}, \\emph{Submitted}, 2015.\n\n\\bibitem{Chen:2013aa}\nChen YH, Lee MJ, Wang IC \\emph{et~al.}, \\emph{Physical review letters},\n  110(8):083601, 2013.\n\n\\bibitem{Wasilewski:2009aa}\nWasilewski W, Fernholz T, Jensen K \\emph{et~al.}, \\emph{Optics express},\n  17(16):14444, 2009.\n\n\\bibitem{Cirac:2004aa}\nCirac J, Duan L and Zoller P, \\emph{arXiv preprint quant-ph/0405030}, 2004.\n\n\\bibitem{Reddy:2013aa}\nReddy DV, Raymer MG, McKinstrie CJ \\emph{et~al.}, \\emph{Optics express},\n  21(11):13840, 2013.\n\n\\bibitem{Nunn:2008oq}\nNunn J, Reim K, Lee KC \\emph{et~al.}, \\emph{Physical Review Letters},\n  101(26):260502, 2008.\n\n\\bibitem{Eckstein:2011aa}\nEckstein A, Brecht B and Silberhorn C, \\emph{Optics express}, 19(15):13770,\n  2011.\n\n\\bibitem{Spring:2013aa}\nSpring JB, Salter PS, Metcalf BJ \\emph{et~al.}, \\emph{Optics express},\n  21(11):13522, 2013.\n\n\\bibitem{Dantan:2005aa}\nDantan A, Bramati A and Pinard M, \\emph{Physical Review A}, 71(4):043801, 2005.\n\n\\bibitem{He:2009aa}\nHe Q, Reid M, Giacobino E \\emph{et~al.}, \\emph{Physical Review A},\n  79(2):022310, 2009.\n\n\\bibitem{Sabooni:2013aa}\nSabooni M, Li Q, Kr{\\\"o}ll S \\emph{et~al.}, \\emph{Physical review letters},\n  110(13):133604, 2013.\n\n\\bibitem{Reim:2011ys}\nReim K, Michelberger P, Lee K \\emph{et~al.}, \\emph{Physical Review Letters},\n  107(5):53603, 2011.\n\n\\bibitem{Brecht:2015ab}\nBrecht B, Luo KH, Herrmann H \\emph{et~al.}, \\emph{arXiv preprint\n  arXiv:1507.08840}, 2015.\n\n\\end{thebibliography}\n\n\n\n", "itemtype": "equation", "pos": 46383, "prevtext": "\nwhich is independent of the detuning $\\Delta_\\mathrm{s}$ and also independent of the control field energy $\\mathcal{E}\\propto W$, provided the control field is strong enough to reach saturation, $\\zeta \\gg 1$. Unit efficiency is achieved with an optically thick ensemble in a high quality cavity with a mode-matched storage interaction such that $|\\kappa|=1$.\n\nIn a real atomic system, four-wave mixing is present, and in that case the maximum noise suppression is achieved when the cavity resonance condition $\\phi_\\mathrm{s} = 0\\mod{2\\pi}$ obtains, which is different to the empty-cavity resonance condition $k_\\mathrm{s}L = 0\\mod{2\\pi}$ because of atomic dispersion. In fact, the resonance condition $\\phi_\\mathrm{s} = 0$ is natural in a real experiment, where the atoms are introduced into the cavity before the signal field is tuned to resonance with the cavity. Any other scattering losses inside the cavity should also be included in the roundtrip amplitude transmission $\\mu_\\mathrm{s}$. Four-wave mixing gain can boost the efficiency (while introducing noise), whereas intra-cavity losses will reduce the efficiency. In general the expression (\\ref{eff_1}) and its strong-coupling limit (\\ref{eff_strong}) can be used to predict the memory performance.\n\n\n\n\n\n\n\n\n\n\\section{Double resonance}\nWe have so far treated the control pulse $\\Omega$ as an external parameter, but the control is an optical field that co-propagates with the signal field around the cavity. As depicted in Fig.~\\ref{fig:cavity_memory} (b) The control field frequency lies between that of the signal and the anti-Stokes field, so it is not immediately obvious how it can be introduced into the cavity: if the free-spectral range of the cavity is adjusted so that resonance is achieved for the Stokes and anti-resonance is achieved for the anti-Stokes field, separated in frequency by $2\\delta$, then the cavity will not be resonant with the control, shifted from the Stokes frequency by $\\delta$. In this connection we briefly mention two solutions. First, the control can be polarised orthogonally to the signal field, and a birefringent cavity can be used to shift the cavity resonance for the control polarisation so as to in-couple the control. Second, the atomic dispersion described by the real parts of $\\kappa_\\mathrm{s,a}$ distorts the regular frequency spacing of the empty-cavity resonances \\cite{Munns:2015,Sabooni:2013aa}, and this distortion can be used to bring signal and control (even co-polarised) into simultaneous resonance, while the anti-Stokes is off-resonant. These or other techniques may be used, which lie beyond the scope of this work. In any case, a resonantly coupled control will benefit from intra-cavity field enhancement,\n\n", "index": 47, "text": "$$\n\\Omega = \\Omega_0\\frac{t_\\mathrm{\\Omega}}{1-\\mu_\\Omega}\\approx \\Omega_0 \\times \\sqrt{\\frac{2\\mathcal{F}_\\mathrm{\\Omega}}{\\pi}},\n$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex10.m1\" class=\"ltx_Math\" alttext=\"\\Omega=\\Omega_{0}\\frac{t_{\\mathrm{\\Omega}}}{1-\\mu_{\\Omega}}\\approx\\Omega_{0}%&#10;\\times\\sqrt{\\frac{2\\mathcal{F}_{\\mathrm{\\Omega}}}{\\pi}},\" display=\"block\"><mrow><mrow><mi mathvariant=\"normal\">\u03a9</mi><mo>=</mo><mrow><msub><mi mathvariant=\"normal\">\u03a9</mi><mn>0</mn></msub><mo>\u2062</mo><mfrac><msub><mi>t</mi><mi mathvariant=\"normal\">\u03a9</mi></msub><mrow><mn>1</mn><mo>-</mo><msub><mi>\u03bc</mi><mi mathvariant=\"normal\">\u03a9</mi></msub></mrow></mfrac></mrow><mo>\u2248</mo><mrow><msub><mi mathvariant=\"normal\">\u03a9</mi><mn>0</mn></msub><mo>\u00d7</mo><msqrt><mfrac><mrow><mn>2</mn><mo>\u2062</mo><msub><mi class=\"ltx_font_mathcaligraphic\">\u2131</mi><mi mathvariant=\"normal\">\u03a9</mi></msub></mrow><mi>\u03c0</mi></mfrac></msqrt></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}]