[{"file": "1601.05078.tex", "nexttext": "\nTaking the product of such densities yields the joint density of intercoalescent waiting times, and\nthis fact can be exploited to obtain the probability of observing a particular genealogy given a\ndemographic function.\n\n\n\n\\subsection{Skygrid Demographic Model}\n\\par\nThe Skygrid posits that $N_e(t)$ is a piecewise constant function that can change values only at\npre-specified points in time known as ``grid points.''  Let $x_1,\\dots,x_M$ denote the temporal\ngrid points, where $x_1 \\leq x_2 \\leq \\dots \\leq x_{M-1} \\leq x_M$.\nThe $M$ grid points divide the demographic history timeline into $M+1$ intervals so that the\ndemographic function is fully specified by a vector $\\boldsymbol \\theta = (\\theta_1,\\dots,\\theta_{M+1})$\nof values that it assumes on those intervals.  Here, $N_e(t) = \\theta_k$ for $x_{k-1} \\leq t < x_k$,\n$k = 1,\\dots,M$, where it is understood that $x_0 = 0$.  Also, $N_e(t) = \\theta_{M+1}$ for\n$t \\geq x_M$.  Note that $x_M$ is the time furthest back into the past at which the effective\npopulation size can change.  The values of the\ngrid points as well as the number $M$ of total grid points are specified beforehand by the user.\nA typical way to select the grid points is to decide on a resolution $M$,\nlet $x_M$ assume the value furthest back in time for which the data are expected to be informative,\nand space the remaining grid points evenly between $x_0 =0$ and $x_M$.  Alternatively, as\ndiscussed in the next section, grid points can be selected to align with covariate sampling times\nin order to facilitate the modeling of associations between the effective population size\nand external covariates.  \n\n\n\n\\par\nSuppose we have $m$ known genealogies $g_1,\\dots,g_m$ representing the ancestries of samples from\n$m$ separate genetic loci with the same effective population size $N_e(t)$.\n\n\nWe assume \\textit{a priori} that the genealogies are independent given\n$N_e(t)$.  This assumption implies that the genealogies are unlinked which commonly occurs when\nresearchers select loci from whole genome sequences or when recombination is very likely, such as\nbetween genes in retroviruses. \nThe likelihood of the vector $\\textbf g = (g_1,\\dots,g_m)$ of genealogies can then be expressed as\nthe product of likelihoods of individual genealogies:\n\n", "itemtype": "equation", "pos": 13086, "prevtext": "\n\n\n\n\n\n\n\n\n\\bigskip\n\\medskip\n\\begin{center}\n\n\n\\noindent{\\Large \\bf Understanding Past Population Dynamics: Bayesian Coalescent-Based Modeling with Covariates}\n\\bigskip\n\n\n\n\n\n\n\n\\noindent {\\normalsize \\sc \nMandev S. Gill$^1$, Philippe Lemey$^{2}$, Shannon N. Bennett$^{3}$, Roman Biek$^{4}$ \\\\ \nand Marc A. Suchard$^{1,5,6}$}\\[2ex]\n\\noindent {\\small \\it \n$^1$Department of Biostatistics, Jonathan and Karin Fielding School of Public Health, University\n  of California, Los Angeles, United States\\\\\n  $^2$Department of Microbiology and Immunology, Rega Institute, KU Leuven, Leuven, Belgium \\\\\n  $^3$Department of Microbiology, California Academy of Sciences, San Francisco, United States \\\\\n  $^4$Institute of Biodiversity, Animal Health and Comparative Medicine, University of Glasgow,\n  Glasgow, United Kingdom\n  $^5$Department of Biomathematics, David Geffen School of Medicine at UCLA, University of California,\n  Los Angeles, United States \\\\\n  $^6$Department of Human Genetics, David Geffen School of Medicine at UCLA, Universtiy of California,\n  Los Angeles, United States}\\\\\n\\end{center}\n\\medskip\n\n\n\n\n\n\n\\begin{abstract}\nEffective population size characterizes the genetic variability in a population and is a\nparameter of paramount importance in population genetics.  Kingman's coalescent process\nenables inference of past population dynamics directly from molecular sequence data, and\nresearchers have developed a number of flexible coalescent-based models for Bayesian nonparametric\nestimation of the effective population size as a function of time.  Major goals of demographic\nreconstruction include identifying driving factors of\neffective population size, and understanding the association between the effective population size\nand such factors.  Building upon Bayesian nonparametric\ncoalescent-based approaches, we introduce a flexible framework that incorporates time-varying\ncovariates that exploit Gaussian Markov random fields to achieve temporal smoothing of effective population size trajectories.\nTo approximate the posterior distribution, we adapt efficient Markov chain Monte Carlo\nalgorithms designed for highly structured Gaussian models.\nIncorporating covariates into the demographic inference framework enables the modeling\nof associations between the effective population size and covariates while accounting for uncertainty\nin population histories.  Furthermore, it can lead to more precise estimates of population dynamics.\nWe apply our model to four examples.  We reconstruct the demographic history\nof raccoon rabies in North America and find a significant association with the spatiotemporal\nspread of the outbreak.  Next, we examine the effective population size trajectory of\nthe DENV-4 virus in Puerto Rico along with viral isolate count data and find similar cyclic patterns.\nWe compare the population history of the HIV-1 CRF02_AG clade in Cameroon with HIV incidence and\nprevalence data and find that the effective population size is more reflective of incidence rate.\nFinally, we explore the hypothesis that the population dynamics of musk ox during the\nLate Quaternary period were related to climate change.\n\\end{abstract}\n\n\n\n\n\\vspace{1.5in}\n\n\\section{Introduction}\n\nThe effective population size is an abstract\nparameter of fundamental importance in population genetics, evolutionary biology and\ninfectious disease epidemiology.\n\\citet{Wright1931} introduces the\nconcept of effective population size\nas the size of an idealized Fisher-Wright population that gains and loses genetic diversity\nat the same rate as the real population under study.  The Fisher-Wright model is a classic\nforward-time model of reproduction that assumes random mating, no selection or migration, and\nnon-overlapping generations.  Coalescent theory \\citep{Kingman1982b, Kingman1982} provides a probabilistic\nmodel for generating genealogies relating samples of individuals arising from a Fisher-Wright\nmodel of reproduction.  Importantly, the coalescent elucidates the relationship between population genetic\nparameters and ancestry.  In particular, the dynamics of the effective population size greatly inform\nthe shapes of coalescent-generated genealogies.  This opens the door for the inverse problem of coalescent-based\ninference of effective population size trajectories from gene genealogies.\n\\par\nWhile the coalescent was originally developed for constant-size populations,\nextensions that accommodate a variable population size \\citep{Slatkin1991, Griffiths1994, Donnelly1995}\nprovide a basis for estimation of the effective population size as a function of time (also called\nthe demographic function).  Early approaches assumed simple parametric forms for the demographic function, such\nas exponential or logistic growth, and provided maximum likelihood \\citep{Kuhner1998} or Bayesian\n\\citep{Drummond2002} frameworks for estimating the parameters that characterized the parametric forms.\nHowever, \\textit{a} \\textit{priori} parametric assumptions can be quite restrictive, and finding an\nappropriate parametric form for a given demographic history can be time consuming and computationally\nexpensive.  To remedy this, there has been considerable development of nonparametric methods\nto infer past population dynamics.\n\\par\nNonparametric coalescent-based models typically approximate the effective population size as a piecewise\nconstant or linear function.  The methodology has evolved from fast but noisy models based on method of moments\nestimators \\citep{Pybus2000, Strimmer2001}, to a number of flexible Bayesian approaches, including\nmultiple change-point models \\citep{Opgen-Rhein2005, Drummond2005, Heled2008}, and models that employ\nGaussian process-based priors on the population trajectory \\citep{Minin2008, Gill2013, Palacios2013}.\nExtending the basic methodological framework to incorporate a number of\nkey features, including accounting for phylogenetic error \\citep{Drummond2005, Minin2008, Heled2008, Gill2013},\nthe ability to analyze heterochronous data \\citep{Pybus2000, Drummond2005, Minin2008, Heled2008, Gill2013, Palacios2013},\nand simultaneous analysis of multilocus data \\citep{Heled2008, Gill2013} has hastened progress.\n\n\\par\nIn spite of all of these advances, there remains a need for further development of population dynamics inference\nmethodology.  One promising avenue is introduction of covariates into the inference framework.\nA central goal in demographic reconstruction is to gain insights into the association between past\npopulation dynamics and external factors \\citep{Ho2011}.\nFor example, \\citet{Lorenzen2011} combine demographic reconstructions from ancient DNA with species distribution\nmodels and the human fossil record to elucidate how climate and humans impacted the population dynamics\nof woolly rhinoceros, woolly mammoth, wild horse, reindeer, bison and musk ox during\nthe Late Quaternary period.  \\citet{Lorenzen2011} show that changes in megafauna abundance are idiosyncratic, with\ndifferent species (and continental populations within species) responding differently to the effects\nof climate change, human encroachment and habitat redistribution.\n\\citet{Lorenzen2011} identify climate change as the primary explanation behind the extinction of\nEurasian musk ox and woolly rhinoceros, point to a combination of climatic and anthropogenic factors\nas the causes of wild horse and steppe bison decline,\nand observe that reindeer remain largely unaffected by any such factors.\n\n\n\n\n\n\n\n\n\n\nSimilarly, \\citet{Stiller2010} examine whether climatic changes were related to\nthe extinction of the cave bear, and \\citet{Finlay2007} consider the impact of domestication on the\npopulation expansion of bovine species.  Comparison of external factors with past population dynamics\nis also a popular approach in epidemiological studies to explore hypotheses about the spread of viruses\n\\citep{Lemey2003, Faria2014}.\n\\par\nIn addition to the association between past population dynamics and potential driving factors,\nit is of fundamental interest is to assess the association between effective population size and\ncensus population size \\citep{Crandall1999, Liu2008, Volz2009, Palstra2012}.\nFor instance, \\citet{Bazin2006} argue that\nin animals, diversity of mitochondrial DNA (mtDNA) is not reflective of population size, whereas\nallozyme diversity is.  \\citet{Atkinson2008} follow up by examining whether mtDNA diversity\nis a reliable predictor of human population size.  The authors compare Bayesian Skyline \\citep{Drummond2005} effective\npopulation size reconstructions with historical estimates of census population sizes and find concordance between the two\nquantities in terms of relative regional population sizes.\n\\par\nExisting methods for population dynamics inference do not incorporate covariates directly into\nthe model, and associations between the effective population size and potentially related factors\nare typically examined in post hoc fashions that ignore uncertainty in demographic reconstructions.\nWe propose to fill this void by including external time series as covariates in a\ngeneralized linear model framework.  We accomplish this task by building upon the\nthe Bayesian nonparametric Skygrid model of \\citet{Gill2013}.  The Skygrid is a particularly\nwell-suited starting point among nonparametric coalescent-based models.  In most other comparable models,\nthe trajectory change-points must correspond to internal nodes of the genealogy, creating a hurdle\nfor modeling associations with covariates that are measured at fixed times.  The Skygrid\nbypasses such difficulties by allowing users to specify change-points, providing a more natural\nframework for our extension.  Furthermore, the Skygrid's\nGaussian Markov random field (GMRF) smoothing prior is highly generalizable and affords\na straightforward extension to include covariates.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\par\nWe demonstrate the utility of incorporating covariates into demographic inference on four examples.\n\n\nFirst, we find striking similarities between the demographic and spatial expansion of\nraccoon rabies in North America.  Second, we compare and contrast the epidemiological dynamics of dengue\nin Puerto Rico with patterns of viral diversity.  Third, we examine the population history of the\nHIV-1 CRF02\\_AG clade in Cameroon and find that the effective population size is more reflective of\nHIV incidence than prevalence.  Finally, we explore the relationship between musk ox population\ndynamics and climate change during the Late Quaternary period.\n\nOur extension to the Skygrid proves to be a useful framework for\nascertaining the association between effective population size and external covariates while\naccounting for demographic uncertainty.  Furthermore, we show that incorporating covariates\ninto the demographic inference framework can improve estimates of effective population size trajectories,\nincreasing precision and uncovering patterns in the population history that integrate the covariate data\nin addition to the sequence data.\n\n\n\\section{Methods}\n\\subsection{Coalescent Theory}\n\nCoalescent theory forms the basis of our inference framework, and here we review the basic set-up.\nConsider a random sample of $n$ individuals\narising from a classic Fisher-Wright population model of constant size $N_e$.  The coalescent\n\\citep{Kingman1982b, Kingman1982} is a stochastic process that generates genealogies relating such a sample.\nThe process begins at the sampling time of all $n$ individuals, $t = 0$, and proceeds\nbackward in time as $t$ increases, successively\nmerging lineages until all lineages have merged and we have reached the root of\nthe genealogy, which corresponds to the most recent common ancestor (MRCA)\nof the sampled individuals.\nThe merging of lineages is called a coalescent event and\nthere are $n-1$ coalescent events in all.  Let $t_k$ denote the time of the $(n-k)^{\\text{\\small th}}$ coalescent event for $k = 1,\\dots,n-1$\nand $t_n = 0$ denote the sampling time.  Then for $k = 2,\\dots,n$, the waiting time $w_k = t_{k-1}-t_k$\nis exponentially distributed with rate $\\frac{k(k-1)}{2N_e}$.\n\n\\par\nResearchers have extended coalescent theory to model the effects of recombination \\citep{Hudson1983},\npopulation structure \\citep{Notohara1990}, and selection \\citep{Krone1997}.\nWe do not, however, incorporate any of these extensions here.  The relevant extensions for our development\ngeneralize the coalescent to accommodate a variable population size \\citep{Griffiths1994}\nand heterochronous data \\citep{Rodrigo1999b}.\nThe latter occurs when one samples the $n$ individuals at possibility different times.\n\\par\nLet $N_e(t)$ denote the effective population size as a function of time, where time increases into the past.\n\n\nThus, $N_e(0)$ is the effective population size at the most recent sampling time, and $N_e(t')$ is\nthe effective population size $t'$ time units before the most recent sampling time.\nWe also refer to $N_e(t)$ as the ``demographic function'' or ``demographic model.''\n\\citet{Griffiths1994} show that the waiting time $w_k$ between coalescent events\nis given by the conditional density\n\n", "index": 1, "text": "\\begin{equation}\nP(w_k|t_k) =  \\frac{k(k-1)}{2N_e(w_k + t_k)} \\exp \\left[- \\int_{t_k}^{w_k + t_k} \\frac{k(k-1)}{2N_e(t)} dt  \\right] .\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"P(w_{k}|t_{k})=\\frac{k(k-1)}{2N_{e}(w_{k}+t_{k})}\\exp\\left[-\\int_{t_{k}}^{w_{k%&#10;}+t_{k}}\\frac{k(k-1)}{2N_{e}(t)}dt\\right].\" display=\"block\"><mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mi>k</mi></msub><mo stretchy=\"false\">|</mo><msub><mi>t</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>k</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>k</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>N</mi><mi>e</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>w</mi><mi>k</mi></msub><mo>+</mo><msub><mi>t</mi><mi>k</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac><mi>exp</mi><mrow><mo>[</mo><mo>-</mo><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><msub><mi>t</mi><mi>k</mi></msub><mrow><msub><mi>w</mi><mi>k</mi></msub><mo>+</mo><msub><mi>t</mi><mi>k</mi></msub></mrow></msubsup><mfrac><mrow><mi>k</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>k</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>N</mi><mi>e</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac><mi>d</mi><mi>t</mi><mo>]</mo></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05078.tex", "nexttext": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\par\nTo construct the likelihood of genealogy $g_i$, let $t_{0_i}$ be the most recent sampling time of sequences contributing to genealogy $i$ and\n$t_{\\mbox{\\tiny MRCA}_i}$ be the time of the MRCA for locus $i$.\n\n\nLet  $x_{\\alpha_i}$ denote the minimal grid point greater than\nat least one sampling time in the genealogy, and $x_{\\beta_i}$ the greatest grid point less than\nat least one coalescent time.  Let $u_{ik} = [x_{k-1},x_{k}]$, $k = \\alpha_i+1,\\dots,\\beta_i$,\n$u_{i\\alpha_i} = [t_{0_i}, x_{\\alpha_i}]$, and $u_{i(\\beta_i + 1)} = [x_{\\beta_i}, t_{\\mbox{\\tiny MRCA}_i}]$.\nFor each $u_{ik}$ we let $t_{kj}$, $j=1,\\dots,r_k$, denote the ordered times of the grid points and\nsampling and coalescent events in the interval.  With each $t_{kj}$ we associate an indicator\n$\\phi_{kj}$ which takes a value of 1 in the case of a coalescent event and 0 otherwise.  Finally,\nlet $v_{kj}$ denote the number of lineages present in the genealogy in the interval\n$[t_{kj}, t_{k(j+1)}]$.\nFollowing \\citet{Griffiths1994}, the likelihood of observing an interval is\n\\begin{eqnarray}\nP(u_{ik}|\\theta_k) & = & \\prod_{1 \\leq j < r_k: \\phi_{kj}=1} \\frac{v_{kj}(v_{kj}-1)}{2\\theta_k}\n\\prod_{j=1}^{r_k-1} \\exp \\left[-\\frac{v_{kj} (v_{kj}-1)(t_{k(j+1)}-t_{kj})}{2\\theta_k} \\right],\n\\end{eqnarray}\nfor $k = \\alpha_i , \\dots , \\beta_i +1$.\n\nThe product of interval likelihoods (5.3) yields the likelihood of coalescent times given the sampling times\nwith genealogy $g_i$.\nTo obtain the likelihood of the genealogy, however, we must account for the specific lineages\nthat merge and result in coalescent events.\nLet $P_* (u_{ik}|\\theta_k)$ denote $P(u_{ik}|\\theta_k)$ except with factors\nof the form $\\frac{v_{kj}(v_{kj}-1)}{2\\theta_k}$ replaced by $\\frac{2(2-1)}{2\\theta_k} = \\frac{1}{\\theta_k}$.\nThen\n\n", "itemtype": "equation", "pos": 15504, "prevtext": "\nTaking the product of such densities yields the joint density of intercoalescent waiting times, and\nthis fact can be exploited to obtain the probability of observing a particular genealogy given a\ndemographic function.\n\n\n\n\\subsection{Skygrid Demographic Model}\n\\par\nThe Skygrid posits that $N_e(t)$ is a piecewise constant function that can change values only at\npre-specified points in time known as ``grid points.''  Let $x_1,\\dots,x_M$ denote the temporal\ngrid points, where $x_1 \\leq x_2 \\leq \\dots \\leq x_{M-1} \\leq x_M$.\nThe $M$ grid points divide the demographic history timeline into $M+1$ intervals so that the\ndemographic function is fully specified by a vector $\\boldsymbol \\theta = (\\theta_1,\\dots,\\theta_{M+1})$\nof values that it assumes on those intervals.  Here, $N_e(t) = \\theta_k$ for $x_{k-1} \\leq t < x_k$,\n$k = 1,\\dots,M$, where it is understood that $x_0 = 0$.  Also, $N_e(t) = \\theta_{M+1}$ for\n$t \\geq x_M$.  Note that $x_M$ is the time furthest back into the past at which the effective\npopulation size can change.  The values of the\ngrid points as well as the number $M$ of total grid points are specified beforehand by the user.\nA typical way to select the grid points is to decide on a resolution $M$,\nlet $x_M$ assume the value furthest back in time for which the data are expected to be informative,\nand space the remaining grid points evenly between $x_0 =0$ and $x_M$.  Alternatively, as\ndiscussed in the next section, grid points can be selected to align with covariate sampling times\nin order to facilitate the modeling of associations between the effective population size\nand external covariates.  \n\n\n\n\\par\nSuppose we have $m$ known genealogies $g_1,\\dots,g_m$ representing the ancestries of samples from\n$m$ separate genetic loci with the same effective population size $N_e(t)$.\n\n\nWe assume \\textit{a priori} that the genealogies are independent given\n$N_e(t)$.  This assumption implies that the genealogies are unlinked which commonly occurs when\nresearchers select loci from whole genome sequences or when recombination is very likely, such as\nbetween genes in retroviruses. \nThe likelihood of the vector $\\textbf g = (g_1,\\dots,g_m)$ of genealogies can then be expressed as\nthe product of likelihoods of individual genealogies:\n\n", "index": 3, "text": "\\begin{equation}\nP(\\textbf g | \\boldsymbol \\theta) = \\prod_{i=1}^{m} P(g_i|\\boldsymbol \\theta) .\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"P(\\textbf{g}|\\bm{\\theta})=\\prod_{i=1}^{m}P(g_{i}|\\bm{\\theta}).\" display=\"block\"><mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mtext>\ud835\udc20</mtext><mo stretchy=\"false\">|</mo><mi>\ud835\udf3d</mi><mo stretchy=\"false\">)</mo></mrow><mo>=</mo><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u220f</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>g</mi><mi>i</mi></msub><mo stretchy=\"false\">|</mo><mi>\ud835\udf3d</mi><mo stretchy=\"false\">)</mo></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05078.tex", "nexttext": "\n\\par\nWe introduce some notation that will facilitate the derivation of a Gaussian approximation used to\nconstruct a Markov chain Monte Carlo (MCMC) transition kernel.\nIf $c_{ik}$ denotes the number of coalescent events which occur during interval $u_{ik}$, we\ncan write\n\n", "itemtype": "equation", "pos": 17413, "prevtext": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\par\nTo construct the likelihood of genealogy $g_i$, let $t_{0_i}$ be the most recent sampling time of sequences contributing to genealogy $i$ and\n$t_{\\mbox{\\tiny MRCA}_i}$ be the time of the MRCA for locus $i$.\n\n\nLet  $x_{\\alpha_i}$ denote the minimal grid point greater than\nat least one sampling time in the genealogy, and $x_{\\beta_i}$ the greatest grid point less than\nat least one coalescent time.  Let $u_{ik} = [x_{k-1},x_{k}]$, $k = \\alpha_i+1,\\dots,\\beta_i$,\n$u_{i\\alpha_i} = [t_{0_i}, x_{\\alpha_i}]$, and $u_{i(\\beta_i + 1)} = [x_{\\beta_i}, t_{\\mbox{\\tiny MRCA}_i}]$.\nFor each $u_{ik}$ we let $t_{kj}$, $j=1,\\dots,r_k$, denote the ordered times of the grid points and\nsampling and coalescent events in the interval.  With each $t_{kj}$ we associate an indicator\n$\\phi_{kj}$ which takes a value of 1 in the case of a coalescent event and 0 otherwise.  Finally,\nlet $v_{kj}$ denote the number of lineages present in the genealogy in the interval\n$[t_{kj}, t_{k(j+1)}]$.\nFollowing \\citet{Griffiths1994}, the likelihood of observing an interval is\n\\begin{eqnarray}\nP(u_{ik}|\\theta_k) & = & \\prod_{1 \\leq j < r_k: \\phi_{kj}=1} \\frac{v_{kj}(v_{kj}-1)}{2\\theta_k}\n\\prod_{j=1}^{r_k-1} \\exp \\left[-\\frac{v_{kj} (v_{kj}-1)(t_{k(j+1)}-t_{kj})}{2\\theta_k} \\right],\n\\end{eqnarray}\nfor $k = \\alpha_i , \\dots , \\beta_i +1$.\n\nThe product of interval likelihoods (5.3) yields the likelihood of coalescent times given the sampling times\nwith genealogy $g_i$.\nTo obtain the likelihood of the genealogy, however, we must account for the specific lineages\nthat merge and result in coalescent events.\nLet $P_* (u_{ik}|\\theta_k)$ denote $P(u_{ik}|\\theta_k)$ except with factors\nof the form $\\frac{v_{kj}(v_{kj}-1)}{2\\theta_k}$ replaced by $\\frac{2(2-1)}{2\\theta_k} = \\frac{1}{\\theta_k}$.\nThen\n\n", "index": 5, "text": "\\begin{equation}\nP(g_i|\\boldsymbol \\theta) = \\prod_{k=\\alpha_i}^{{\\beta_i}+1} P_* (u_{ik}|\\theta_k).\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"P(g_{i}|\\bm{\\theta})=\\prod_{k=\\alpha_{i}}^{{\\beta_{i}}+1}P_{*}(u_{ik}|\\theta_{%&#10;k}).\" display=\"block\"><mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>g</mi><mi>i</mi></msub><mo stretchy=\"false\">|</mo><mi>\ud835\udf3d</mi><mo stretchy=\"false\">)</mo></mrow><mo>=</mo><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u220f</mo><mrow><mi>k</mi><mo>=</mo><msub><mi>\u03b1</mi><mi>i</mi></msub></mrow><mrow><msub><mi>\u03b2</mi><mi>i</mi></msub><mo>+</mo><mn>1</mn></mrow></munderover><msub><mi>P</mi><mo>*</mo></msub><mrow><mo stretchy=\"false\">(</mo><msub><mi>u</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>k</mi></mrow></msub><mo stretchy=\"false\">|</mo><msub><mi>\u03b8</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05078.tex", "nexttext": "\nwhere the $SS_{ik}$ are appropriate constants.\nRewriting this expression in terms of $\\gamma_k = \\log(\\theta_k)$, we arrive at\n\n", "itemtype": "equation", "pos": 17799, "prevtext": "\n\\par\nWe introduce some notation that will facilitate the derivation of a Gaussian approximation used to\nconstruct a Markov chain Monte Carlo (MCMC) transition kernel.\nIf $c_{ik}$ denotes the number of coalescent events which occur during interval $u_{ik}$, we\ncan write\n\n", "index": 7, "text": "\\begin{equation}\nP(g_i| \\boldsymbol \\theta) = \\prod_{k=\\alpha_i}^{\\beta_i+1} \\left(\\frac{1}{\\theta_k} \\right)^{c_{ik}}\n\\exp \\left[-\\frac{SS_{ik}}{\\theta_k} \\right] ,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"P(g_{i}|\\bm{\\theta})=\\prod_{k=\\alpha_{i}}^{\\beta_{i}+1}\\left(\\frac{1}{\\theta_{%&#10;k}}\\right)^{c_{ik}}\\exp\\left[-\\frac{SS_{ik}}{\\theta_{k}}\\right],\" display=\"block\"><mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>g</mi><mi>i</mi></msub><mo stretchy=\"false\">|</mo><mi>\ud835\udf3d</mi><mo stretchy=\"false\">)</mo></mrow><mo>=</mo><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u220f</mo><mrow><mi>k</mi><mo>=</mo><msub><mi>\u03b1</mi><mi>i</mi></msub></mrow><mrow><msub><mi>\u03b2</mi><mi>i</mi></msub><mo>+</mo><mn>1</mn></mrow></munderover><msup><mrow><mo>(</mo><mfrac><mn>1</mn><msub><mi>\u03b8</mi><mi>k</mi></msub></mfrac><mo>)</mo></mrow><msub><mi>c</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>k</mi></mrow></msub></msup><mi>exp</mi><mrow><mo>[</mo><mo>-</mo><mfrac><mrow><mi>S</mi><mo>\u2062</mo><msub><mi>S</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>k</mi></mrow></msub></mrow><msub><mi>\u03b8</mi><mi>k</mi></msub></mfrac><mo>]</mo></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05078.tex", "nexttext": "\nInvoking conditional independence of genealogies, the likelihood of the vector $\\textbf g$ of genealogies is\n\\begin{eqnarray}\nP(\\textbf g| \\boldsymbol \\gamma) & = & \\prod_{i=1}^m P(g_i| \\boldsymbol \\gamma) \\\\\n& = & \\prod_{i=1}^m \\prod_{k=\\alpha_i}^{\\beta_i+1} \\exp[-\\gamma_k c_{ik} - SS_{ik} e^{-\\gamma_k}] \\\\\n& = & \\exp\n\\left[ \\sum_{k=1}^{M+1} \\left[-\\gamma_k c_k - SS_k e^{-\\gamma_k} \\right]  \\right]\n\\end{eqnarray}\nwhere $c_k = \\sum_{i=1}^{m} c_{ik}$ and $ SS_k = \\sum_{i=1}^{m} SS_{ik}$;\nhere, $c_{ik}=SS_{ik}=0$ if $k \\notin [\\alpha_i,\\beta_i+1]$.\n\n\n\n\\par\nThe Skygrid incorporates the prior assumption that effective population size changes continuously over time\nby placing a GMRF prior on $\\boldsymbol \\gamma$:\n\n", "itemtype": "equation", "pos": 18107, "prevtext": "\nwhere the $SS_{ik}$ are appropriate constants.\nRewriting this expression in terms of $\\gamma_k = \\log(\\theta_k)$, we arrive at\n\n", "index": 9, "text": "\\begin{equation}\nP(g_i|\\boldsymbol \\gamma) = \\prod_{k=\\alpha_i}^{\\beta_i+1} e^{-\\gamma_k c_{ik}} \\exp[-SS_{ik} e^{-\\gamma_k}]\n= \\prod_{k=\\alpha_i}^{\\beta_i+1} \\exp[-\\gamma_k c_{ik} - SS_{ik} e^{-\\gamma_k}].\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"P(g_{i}|\\bm{\\gamma})=\\prod_{k=\\alpha_{i}}^{\\beta_{i}+1}e^{-\\gamma_{k}c_{ik}}%&#10;\\exp[-SS_{ik}e^{-\\gamma_{k}}]=\\prod_{k=\\alpha_{i}}^{\\beta_{i}+1}\\exp[-\\gamma_{%&#10;k}c_{ik}-SS_{ik}e^{-\\gamma_{k}}].\" display=\"block\"><mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>g</mi><mi>i</mi></msub><mo stretchy=\"false\">|</mo><mi>\ud835\udf38</mi><mo stretchy=\"false\">)</mo></mrow><mo>=</mo><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u220f</mo><mrow><mi>k</mi><mo>=</mo><msub><mi>\u03b1</mi><mi>i</mi></msub></mrow><mrow><msub><mi>\u03b2</mi><mi>i</mi></msub><mo>+</mo><mn>1</mn></mrow></munderover><msup><mi>e</mi><mrow><mo>-</mo><mrow><msub><mi>\u03b3</mi><mi>k</mi></msub><mo>\u2062</mo><msub><mi>c</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>k</mi></mrow></msub></mrow></mrow></msup><mi>exp</mi><mrow><mo stretchy=\"false\">[</mo><mo>-</mo><mi>S</mi><msub><mi>S</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>k</mi></mrow></msub><msup><mi>e</mi><mrow><mo>-</mo><msub><mi>\u03b3</mi><mi>k</mi></msub></mrow></msup><mo stretchy=\"false\">]</mo></mrow><mo>=</mo><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u220f</mo><mrow><mi>k</mi><mo>=</mo><msub><mi>\u03b1</mi><mi>i</mi></msub></mrow><mrow><msub><mi>\u03b2</mi><mi>i</mi></msub><mo>+</mo><mn>1</mn></mrow></munderover><mi>exp</mi><mrow><mo stretchy=\"false\">[</mo><mo>-</mo><msub><mi>\u03b3</mi><mi>k</mi></msub><msub><mi>c</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>k</mi></mrow></msub><mo>-</mo><mi>S</mi><msub><mi>S</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>k</mi></mrow></msub><msup><mi>e</mi><mrow><mo>-</mo><msub><mi>\u03b3</mi><mi>k</mi></msub></mrow></msup><mo stretchy=\"false\">]</mo></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05078.tex", "nexttext": "\nThis prior does not inform the overall level of the effective population size, just the smoothness of the\ntrajectory.  One can think of the prior as a first-order unbiased random walk with normal increments.  The precision\nparameter $\\tau$ determines how much differences between adjacent log effective population size values\nare penalized.\n\n\n\n\n\n\nWe assign $\\tau$ a gamma prior:\n\n", "itemtype": "equation", "pos": 19047, "prevtext": "\nInvoking conditional independence of genealogies, the likelihood of the vector $\\textbf g$ of genealogies is\n\\begin{eqnarray}\nP(\\textbf g| \\boldsymbol \\gamma) & = & \\prod_{i=1}^m P(g_i| \\boldsymbol \\gamma) \\\\\n& = & \\prod_{i=1}^m \\prod_{k=\\alpha_i}^{\\beta_i+1} \\exp[-\\gamma_k c_{ik} - SS_{ik} e^{-\\gamma_k}] \\\\\n& = & \\exp\n\\left[ \\sum_{k=1}^{M+1} \\left[-\\gamma_k c_k - SS_k e^{-\\gamma_k} \\right]  \\right]\n\\end{eqnarray}\nwhere $c_k = \\sum_{i=1}^{m} c_{ik}$ and $ SS_k = \\sum_{i=1}^{m} SS_{ik}$;\nhere, $c_{ik}=SS_{ik}=0$ if $k \\notin [\\alpha_i,\\beta_i+1]$.\n\n\n\n\\par\nThe Skygrid incorporates the prior assumption that effective population size changes continuously over time\nby placing a GMRF prior on $\\boldsymbol \\gamma$:\n\n", "index": 11, "text": "\\begin{equation}\nP(\\boldsymbol \\gamma|\\tau) \\propto \\tau^{M/2}  \\exp \\left[-\\frac{\\tau}{2} \\sum_{i=1}^M (\\gamma_{i+1}-\\gamma_i)^2\n\\right] .\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"P(\\bm{\\gamma}|\\tau)\\propto\\tau^{M/2}\\exp\\left[-\\frac{\\tau}{2}\\sum_{i=1}^{M}(%&#10;\\gamma_{i+1}-\\gamma_{i})^{2}\\right].\" display=\"block\"><mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf38</mi><mo stretchy=\"false\">|</mo><mi>\u03c4</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u221d</mo><msup><mi>\u03c4</mi><mrow><mi>M</mi><mo>/</mo><mn>2</mn></mrow></msup><mi>exp</mi><mrow><mo>[</mo><mo>-</mo><mfrac><mi>\u03c4</mi><mn>2</mn></mfrac><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></munderover><msup><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03b3</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>-</mo><msub><mi>\u03b3</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup><mo>]</mo></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05078.tex", "nexttext": "\nIn absence of prior knowledge about the smoothness of the effective population size trajectory,\nwe choose $a = b = 0.001$ so that it is relatively uninformative.\nConditioning on the vector of genealogies, we obtain the posterior distribution\n\n", "itemtype": "equation", "pos": 19581, "prevtext": "\nThis prior does not inform the overall level of the effective population size, just the smoothness of the\ntrajectory.  One can think of the prior as a first-order unbiased random walk with normal increments.  The precision\nparameter $\\tau$ determines how much differences between adjacent log effective population size values\nare penalized.\n\n\n\n\n\n\nWe assign $\\tau$ a gamma prior:\n\n", "index": 13, "text": "\\begin{equation}\nP(\\tau) \\propto \\tau^{a-1} e^{-b \\tau}.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"P(\\tau)\\propto\\tau^{a-1}e^{-b\\tau}.\" display=\"block\"><mrow><mrow><mrow><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c4</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u221d</mo><mrow><msup><mi>\u03c4</mi><mrow><mi>a</mi><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi>b</mi><mo>\u2062</mo><mi>\u03c4</mi></mrow></mrow></msup></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05078.tex", "nexttext": "\n\n\n\n\\subsection{Incorporating Covariates}\n\\par\nWe can incorporate covariates into our inference framework by adopting a generalized linear model (GLM) approach.\nLet $Z_1,\\dots,Z_P$ be a set of $P$ predictors.  Each covariate $Z_j$ is observed or measured at $M+1$ time points,\n$t_1,\\dots,t_M,t_{M+1}$.  \nHere, $t_0=0$ is the most recent sequence sampling time,\n$t_i$ denotes the units of time before $t_0$, and $t_0 < t_1 < \\dots < t_M < t_{M+1}$.\nAlternatively, the covariate may correspond to time intervals\n$[t_0,t_1],\\dots,[t_{M-1},t_M],[t_M,t_{M+1}]$ rather than time points\n(for example, the yearly incidence or prevalence of viral infections).  \nIn any case,\n$Z_{ij}$ denotes covariate $Z_j$ at time point or interval $i$.\nSkygrid grid points are chosen to match up with\nmeasurement times (or measurement interval endpoints): $x_1 = t_1,\\dots,x_M = t_M$.  Then\n$N_e(t) = \\theta_{k}$ for $x_{k-1} \\leq t \\leq x_{k}$, $k = 1,\\dots,M$, and\n$N_e(t) = \\theta_{M+1}$ for $t \\geq x_M$.  In our GLM framework, we model the effective population\nsize on a given interval as a log-linear function of covariates\n\n", "itemtype": "equation", "pos": 19895, "prevtext": "\nIn absence of prior knowledge about the smoothness of the effective population size trajectory,\nwe choose $a = b = 0.001$ so that it is relatively uninformative.\nConditioning on the vector of genealogies, we obtain the posterior distribution\n\n", "index": 15, "text": "\\begin{equation}\nP(\\boldsymbol \\gamma,\\tau | \\textbf g) \\propto P(\\textbf g|\\boldsymbol \\gamma)P(\\boldsymbol \\gamma|\\tau)P(\\tau) .\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m1\" class=\"ltx_Math\" alttext=\"P(\\bm{\\gamma},\\tau|\\textbf{g})\\propto P(\\textbf{g}|\\bm{\\gamma})P(\\bm{\\gamma}|%&#10;\\tau)P(\\tau).\" display=\"block\"><mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf38</mi><mo>,</mo><mi>\u03c4</mi><mo stretchy=\"false\">|</mo><mtext>\ud835\udc20</mtext><mo stretchy=\"false\">)</mo></mrow><mo>\u221d</mo><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mtext>\ud835\udc20</mtext><mo stretchy=\"false\">|</mo><mi>\ud835\udf38</mi><mo stretchy=\"false\">)</mo></mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf38</mi><mo stretchy=\"false\">|</mo><mi>\u03c4</mi><mo stretchy=\"false\">)</mo></mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mi>\u03c4</mi><mo stretchy=\"false\">)</mo></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05078.tex", "nexttext": "\nHere, we can impose temporal dependence by modeling $w = (w_1,\\dots,w_{M+1})$ as a zero-mean Gaussian process.\nAdopting this viewpoint, we propose the following GMRF smoothing prior on $\\boldsymbol \\gamma$:\n\n", "itemtype": "equation", "pos": 21147, "prevtext": "\n\n\n\n\\subsection{Incorporating Covariates}\n\\par\nWe can incorporate covariates into our inference framework by adopting a generalized linear model (GLM) approach.\nLet $Z_1,\\dots,Z_P$ be a set of $P$ predictors.  Each covariate $Z_j$ is observed or measured at $M+1$ time points,\n$t_1,\\dots,t_M,t_{M+1}$.  \nHere, $t_0=0$ is the most recent sequence sampling time,\n$t_i$ denotes the units of time before $t_0$, and $t_0 < t_1 < \\dots < t_M < t_{M+1}$.\nAlternatively, the covariate may correspond to time intervals\n$[t_0,t_1],\\dots,[t_{M-1},t_M],[t_M,t_{M+1}]$ rather than time points\n(for example, the yearly incidence or prevalence of viral infections).  \nIn any case,\n$Z_{ij}$ denotes covariate $Z_j$ at time point or interval $i$.\nSkygrid grid points are chosen to match up with\nmeasurement times (or measurement interval endpoints): $x_1 = t_1,\\dots,x_M = t_M$.  Then\n$N_e(t) = \\theta_{k}$ for $x_{k-1} \\leq t \\leq x_{k}$, $k = 1,\\dots,M$, and\n$N_e(t) = \\theta_{M+1}$ for $t \\geq x_M$.  In our GLM framework, we model the effective population\nsize on a given interval as a log-linear function of covariates\n\n", "index": 17, "text": "\\begin{equation}\n\\gamma_{k} =  \\log \\theta_{k} = \\beta_1 Z_{k1} + \\dots + \\beta_P Z_{kP} + w_k .\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m1\" class=\"ltx_Math\" alttext=\"\\gamma_{k}=\\log\\theta_{k}=\\beta_{1}Z_{k1}+\\dots+\\beta_{P}Z_{kP}+w_{k}.\" display=\"block\"><mrow><mrow><msub><mi>\u03b3</mi><mi>k</mi></msub><mo>=</mo><mrow><mi>log</mi><mo>\u2061</mo><msub><mi>\u03b8</mi><mi>k</mi></msub></mrow><mo>=</mo><mrow><mrow><msub><mi>\u03b2</mi><mn>1</mn></msub><mo>\u2062</mo><msub><mi>Z</mi><mrow><mi>k</mi><mo>\u2062</mo><mn>1</mn></mrow></msub></mrow><mo>+</mo><mi mathvariant=\"normal\">\u2026</mi><mo>+</mo><mrow><msub><mi>\u03b2</mi><mi>P</mi></msub><mo>\u2062</mo><msub><mi>Z</mi><mrow><mi>k</mi><mo>\u2062</mo><mi>P</mi></mrow></msub></mrow><mo>+</mo><msub><mi>w</mi><mi>k</mi></msub></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05078.tex", "nexttext": "\nIn this prior, $\\textbf Z$ is an $(M+1) \\times P$ matrix of covariates and $\\boldsymbol \\beta$ is a $P \\times 1$ vector\nof coefficients representing the effect sizes for the predictors, quantifying their contribution\nto $\\boldsymbol \\gamma$.\nPrecision $\\textbf Q$ is an $(M+1) \\times (M+1)$ tri-diagonal matrix with off-diagonal elements equal to $-1$,\n$Q_{11}=Q_{M+1,M+1} = 1$,  and $Q_{ii} = 2$ for $i=2,\\dots,M$.  Let $\\boldsymbol \\gamma_{-i}$ denote the\nvector obtained by excluding only the $i^{\\text{\\small th}}$ component from vector $\\boldsymbol \\gamma$.  Therefore, conditional\non $\\boldsymbol \\gamma_{-i}$, $\\gamma_i$ depends only on its immediate neighbors.\nLet $\\textbf Z_i$ denote the $i^{\\text{\\small th}}$ row of covariate matrix $\\textbf Z$.\nThe individual components of $\\gamma$ have full conditionals\n\\begin{eqnarray}\n\\gamma_1 | \\boldsymbol \\gamma_{-1} & \\sim & N\\left(\\textbf Z_1' \\boldsymbol \\beta - \\textbf Z_2' \\boldsymbol \\beta + \\gamma_2 , \\frac{1}{\\tau} \\right), \\\\\n\\gamma_i | \\boldsymbol \\gamma_{-i} & \\sim & N\\left(\\textbf Z_i' \\boldsymbol \\beta + \\frac{\\gamma_{i-1} + \\gamma_{i+1} - \\textbf Z_{i-1}' \\boldsymbol \\beta- \\textbf Z_{i+1}' \\boldsymbol \\beta}{2} , \\frac{1}{2\\tau} \\right) \\\\\n& & \\quad \\text{for } i=2,\\dots,M, \\nonumber \\\\\n\\gamma_{M+1} | \\boldsymbol \\gamma_{-(M+1)} & \\sim & N \\left(\\textbf Z_{M+1}' \\boldsymbol \\beta - \\textbf Z_M' \\boldsymbol \\beta+\\gamma_M , \\frac{1}{\\tau} \\right).\n\\end{eqnarray}\nAs in the original Skygrid GMRF prior, the precision parameter $\\tau$ governs the smoothness of the trajectory and is assigned a gamma prior\n\n", "itemtype": "equation", "pos": 21466, "prevtext": "\nHere, we can impose temporal dependence by modeling $w = (w_1,\\dots,w_{M+1})$ as a zero-mean Gaussian process.\nAdopting this viewpoint, we propose the following GMRF smoothing prior on $\\boldsymbol \\gamma$:\n\n", "index": 19, "text": "\\begin{equation}\nP(\\boldsymbol \\gamma| \\textbf Z, \\boldsymbol \\beta,\\tau) \\propto\n\\tau^{M/2} \\exp \\left[-\\frac{\\tau}{2} (\\boldsymbol \\gamma - \\textbf Z \\boldsymbol \\beta)' \\textbf Q (\\boldsymbol \\gamma- \\textbf Z \\boldsymbol \\beta) \\right].\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E10.m1\" class=\"ltx_Math\" alttext=\"P(\\bm{\\gamma}|\\textbf{Z},\\bm{\\beta},\\tau)\\propto\\tau^{M/2}\\exp\\left[-\\frac{%&#10;\\tau}{2}(\\bm{\\gamma}-\\textbf{Z}\\bm{\\beta})^{\\prime}\\textbf{Q}(\\bm{\\gamma}-%&#10;\\textbf{Z}\\bm{\\beta})\\right].\" display=\"block\"><mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf38</mi><mo stretchy=\"false\">|</mo><mtext>\ud835\udc19</mtext><mo>,</mo><mi>\ud835\udf37</mi><mo>,</mo><mi>\u03c4</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u221d</mo><msup><mi>\u03c4</mi><mrow><mi>M</mi><mo>/</mo><mn>2</mn></mrow></msup><mi>exp</mi><mrow><mo>[</mo><mo>-</mo><mfrac><mi>\u03c4</mi><mn>2</mn></mfrac><msup><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf38</mi><mo>-</mo><mtext>\ud835\udc19</mtext><mi>\ud835\udf37</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2032</mo></msup><mtext>\ud835\udc10</mtext><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf38</mi><mo>-</mo><mtext>\ud835\udc19</mtext><mi>\ud835\udf37</mi><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05078.tex", "nexttext": "\nIn absence of prior knowledge about the smoothness of the effective population size trajectory,\nwe choose $a = b = 0.001$ so that it is relatively uninformative.\nConditioning on the vector of genealogies, we obtain the posterior distribution\n\n", "itemtype": "equation", "pos": 19581, "prevtext": "\nThis prior does not inform the overall level of the effective population size, just the smoothness of the\ntrajectory.  One can think of the prior as a first-order unbiased random walk with normal increments.  The precision\nparameter $\\tau$ determines how much differences between adjacent log effective population size values\nare penalized.\n\n\n\n\n\n\nWe assign $\\tau$ a gamma prior:\n\n", "index": 13, "text": "\\begin{equation}\nP(\\tau) \\propto \\tau^{a-1} e^{-b \\tau}.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E11.m1\" class=\"ltx_Math\" alttext=\"P(\\tau)\\propto\\tau^{a-1}e^{-b\\tau}.\" display=\"block\"><mrow><mrow><mrow><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c4</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u221d</mo><mrow><msup><mi>\u03c4</mi><mrow><mi>a</mi><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi>b</mi><mo>\u2062</mo><mi>\u03c4</mi></mrow></mrow></msup></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05078.tex", "nexttext": "\n\n\n\n\n\\subsection{Missing Covariate Data}\n\nIt is important to have a mechanism for dealing with unobserved covariate values.  This is\nparticularly crucial because\nthe population history timeline, which ranges from the most recent sampling time to the time of the\nMRCA, necessitates observations from a wide and \\textit{a} \\textit{priori}\nunknown time span.\n\n\n\nLet $\\textbf Z^{\\text{obs}}$ denote the observed covariate values and\n$\\textbf Z^{\\text{mis}}$ the missing covariate values, so that\n$\\textbf Z = (\\textbf Z^{\\text{obs}}, \\textbf Z^{\\text{mis}})$.  The missing data\ncan be treated as extra unknown parameters in a Bayesian model, and they can be estimated\nprovided that there is a model that links them to the observed data and other model parameters.\nWe have the factorization\n\n", "itemtype": "equation", "pos": 23566, "prevtext": "\nTo complete the model specification, we place a relatively uninformative multivariate normal prior $P(\\boldsymbol \\beta)$ on\nthe coefficients $\\boldsymbol \\beta$.  This yields the posterior\n\n", "index": 23, "text": "\\begin{equation}\nP(\\boldsymbol \\gamma, \\boldsymbol \\beta, \\tau| \\textbf g, \\textbf Z) \\propto\nP(\\textbf g| \\boldsymbol \\gamma) P(\\boldsymbol \\gamma|\\textbf Z,\\boldsymbol \\beta,\\tau) P(\\boldsymbol \\beta) P(\\tau) .\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E12.m1\" class=\"ltx_Math\" alttext=\"P(\\bm{\\gamma},\\bm{\\beta},\\tau|\\textbf{g},\\textbf{Z})\\propto P(\\textbf{g}|\\bm{%&#10;\\gamma})P(\\bm{\\gamma}|\\textbf{Z},\\bm{\\beta},\\tau)P(\\bm{\\beta})P(\\tau).\" display=\"block\"><mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf38</mi><mo>,</mo><mi>\ud835\udf37</mi><mo>,</mo><mi>\u03c4</mi><mo stretchy=\"false\">|</mo><mtext>\ud835\udc20</mtext><mo>,</mo><mtext>\ud835\udc19</mtext><mo stretchy=\"false\">)</mo></mrow><mo>\u221d</mo><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mtext>\ud835\udc20</mtext><mo stretchy=\"false\">|</mo><mi>\ud835\udf38</mi><mo stretchy=\"false\">)</mo></mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf38</mi><mo stretchy=\"false\">|</mo><mtext>\ud835\udc19</mtext><mo>,</mo><mi>\ud835\udf37</mi><mo>,</mo><mi>\u03c4</mi><mo stretchy=\"false\">)</mo></mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf37</mi><mo stretchy=\"false\">)</mo></mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mi>\u03c4</mi><mo stretchy=\"false\">)</mo></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05078.tex", "nexttext": "\nand the marginal density $P(\\boldsymbol \\gamma |\\textbf Z^{\\text{obs}}, \\boldsymbol \\beta, \\tau)$\ncan be recovered by integrating out the missing data.\nAs a starting point, we assume a missing completely at random structure, meaning that the probability that a\ncovariate value is missing is independent of observed trait values and other model\nparameters.  For the priors on missing covariate values in (21), we can\nadopt uniform distributions over plausible ranges.\n\\par\nAlternatively, we can formulate a prior on the missing covariate data that makes use of the\nobserved covariate values.  Here, we focus on a common scenario where covariate $j$ is observed at times\n$x_0, \\dots ,x_{K}$ and unobserved at times $x_{K+1}, \\dots ,x_{M}$.\nThus, we can write\n$\\textbf Z^{\\text{obs}}_j = (Z_{0j},\\dots,Z_{Kj})'$ and $\\textbf Z^{\\text{mis}}_j = (Z_{(K+1)j},\\dots,Z_{Mj})'$.\nWe model the joint distribution of the observed and missing covariate values as multivariate\nnormal,\n\n", "itemtype": "equation", "pos": 24579, "prevtext": "\n\n\n\n\n\\subsection{Missing Covariate Data}\n\nIt is important to have a mechanism for dealing with unobserved covariate values.  This is\nparticularly crucial because\nthe population history timeline, which ranges from the most recent sampling time to the time of the\nMRCA, necessitates observations from a wide and \\textit{a} \\textit{priori}\nunknown time span.\n\n\n\nLet $\\textbf Z^{\\text{obs}}$ denote the observed covariate values and\n$\\textbf Z^{\\text{mis}}$ the missing covariate values, so that\n$\\textbf Z = (\\textbf Z^{\\text{obs}}, \\textbf Z^{\\text{mis}})$.  The missing data\ncan be treated as extra unknown parameters in a Bayesian model, and they can be estimated\nprovided that there is a model that links them to the observed data and other model parameters.\nWe have the factorization\n\n", "index": 25, "text": "\\begin{equation}\nP(\\boldsymbol \\gamma, \\textbf Z^{\\text{mis}} |\\textbf Z^{\\text{obs}}, \\boldsymbol \\beta, \\tau)\n= P(\\boldsymbol \\gamma |\\textbf Z^{\\text{obs}} ,\\textbf Z^{\\text{mis}}, \\boldsymbol \\beta, \\tau)\nP(\\textbf Z^{\\text{mis}} |\\textbf Z^{\\text{obs}}, \\boldsymbol \\beta, \\tau),\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E13.m1\" class=\"ltx_Math\" alttext=\"P(\\bm{\\gamma},\\textbf{Z}^{\\text{mis}}|\\textbf{Z}^{\\text{obs}},\\bm{\\beta},\\tau)%&#10;=P(\\bm{\\gamma}|\\textbf{Z}^{\\text{obs}},\\textbf{Z}^{\\text{mis}},\\bm{\\beta},\\tau%&#10;)P(\\textbf{Z}^{\\text{mis}}|\\textbf{Z}^{\\text{obs}},\\bm{\\beta},\\tau),\" display=\"block\"><mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf38</mi><mo>,</mo><msup><mtext>\ud835\udc19</mtext><mtext>mis</mtext></msup><mo stretchy=\"false\">|</mo><msup><mtext>\ud835\udc19</mtext><mtext>obs</mtext></msup><mo>,</mo><mi>\ud835\udf37</mi><mo>,</mo><mi>\u03c4</mi><mo stretchy=\"false\">)</mo></mrow><mo>=</mo><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf38</mi><mo stretchy=\"false\">|</mo><msup><mtext>\ud835\udc19</mtext><mtext>obs</mtext></msup><mo>,</mo><msup><mtext>\ud835\udc19</mtext><mtext>mis</mtext></msup><mo>,</mo><mi>\ud835\udf37</mi><mo>,</mo><mi>\u03c4</mi><mo stretchy=\"false\">)</mo></mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><msup><mtext>\ud835\udc19</mtext><mtext>mis</mtext></msup><mo stretchy=\"false\">|</mo><msup><mtext>\ud835\udc19</mtext><mtext>obs</mtext></msup><mo>,</mo><mi>\ud835\udf37</mi><mo>,</mo><mi>\u03c4</mi><mo stretchy=\"false\">)</mo></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05078.tex", "nexttext": "\nwhere\n\n", "itemtype": "equation", "pos": 25850, "prevtext": "\nand the marginal density $P(\\boldsymbol \\gamma |\\textbf Z^{\\text{obs}}, \\boldsymbol \\beta, \\tau)$\ncan be recovered by integrating out the missing data.\nAs a starting point, we assume a missing completely at random structure, meaning that the probability that a\ncovariate value is missing is independent of observed trait values and other model\nparameters.  For the priors on missing covariate values in (21), we can\nadopt uniform distributions over plausible ranges.\n\\par\nAlternatively, we can formulate a prior on the missing covariate data that makes use of the\nobserved covariate values.  Here, we focus on a common scenario where covariate $j$ is observed at times\n$x_0, \\dots ,x_{K}$ and unobserved at times $x_{K+1}, \\dots ,x_{M}$.\nThus, we can write\n$\\textbf Z^{\\text{obs}}_j = (Z_{0j},\\dots,Z_{Kj})'$ and $\\textbf Z^{\\text{mis}}_j = (Z_{(K+1)j},\\dots,Z_{Mj})'$.\nWe model the joint distribution of the observed and missing covariate values as multivariate\nnormal,\n\n", "index": 27, "text": "\\begin{equation}\n\\left(\n\\begin{array}{c}\n\\textbf Z^{\\text{obs}}_j \\\\\n\\textbf Z^{\\text{mis}}_j \\\\\n\\end{array}\n\\right)\n\\sim N \\left(\n\\left(\n\\begin{array}{c}\n\\boldsymbol \\mu_1 \\\\\n\\boldsymbol \\mu_2 \\\\\n\\end{array}\n\\right) ,\n\\left(\n\\begin{array}{c c}\n\\textbf P_{11} & \\textbf P_{12} \\\\\n\\textbf P_{21} & \\textbf P_{22} \\\\\n\\end{array}\n\\right)^{-1}\n\\right),\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14.m1\" class=\"ltx_Math\" alttext=\"\\left(\\begin{array}[]{c}\\textbf{Z}^{\\text{obs}}_{j}\\\\&#10;\\textbf{Z}^{\\text{mis}}_{j}\\\\&#10;\\end{array}\\right)\\sim N\\left(\\left(\\begin{array}[]{c}\\bm{\\mu}_{1}\\\\&#10;\\bm{\\mu}_{2}\\\\&#10;\\end{array}\\right),\\left(\\begin{array}[]{c c}\\textbf{P}_{11}&amp;\\textbf{P}_{12}\\\\&#10;\\textbf{P}_{21}&amp;\\textbf{P}_{22}\\\\&#10;\\end{array}\\right)^{-1}\\right),\" display=\"block\"><mrow><mrow><mrow><mo>(</mo><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><msubsup><mtext>\ud835\udc19</mtext><mi>j</mi><mtext>obs</mtext></msubsup></mtd></mtr><mtr><mtd columnalign=\"center\"><msubsup><mtext>\ud835\udc19</mtext><mi>j</mi><mtext>mis</mtext></msubsup></mtd></mtr></mtable><mo>)</mo></mrow><mo>\u223c</mo><mrow><mi>N</mi><mo>\u2062</mo><mrow><mo>(</mo><mrow><mo>(</mo><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><msub><mi>\ud835\udf41</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign=\"center\"><msub><mi>\ud835\udf41</mi><mn>2</mn></msub></mtd></mtr></mtable><mo>)</mo></mrow><mo>,</mo><msup><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><msub><mtext>\ud835\udc0f</mtext><mn>11</mn></msub></mtd><mtd columnalign=\"center\"><msub><mtext>\ud835\udc0f</mtext><mn>12</mn></msub></mtd></mtr><mtr><mtd columnalign=\"center\"><msub><mtext>\ud835\udc0f</mtext><mn>21</mn></msub></mtd><mtd columnalign=\"center\"><msub><mtext>\ud835\udc0f</mtext><mn>22</mn></msub></mtd></mtr></mtable><mo>)</mo></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>)</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05078.tex", "nexttext": "\nis the precision matrix.  To impose a correlation structure that enforces\ndependence between covariate values corresponding to adjacent times, we\nadopt a first-order random walk with full conditionals\n\\begin{eqnarray}\nZ_{0j} | Z_{-0j} & \\sim & N\\left( Z_{1j} , \\frac{1}{\\kappa} \\right), \\\\\nZ_{ij} | Z_{-ij} & \\sim & N\\left(\\frac{Z_{(i-1)j}+Z_{(i+1)j}}{2}, \\frac{1}{2 \\kappa} \\right) \\\\\n& & \\quad \\text{for } i=1,\\dots,M-1, \\nonumber \\\\\nZ_{Mj} | Z_{-Mj} & \\sim & N \\left( Z_{(M-1)j}, \\frac{1}{\\kappa} \\right).\n\\end{eqnarray}\nLet $\\textbf Z^K$ denote a vector of dimension $M-K$ with every entry equal to $Z_{Kj}$.  Then\nthe distribution of missing covariate values conditional on observed covariate values is\n\n", "itemtype": "equation", "pos": 26220, "prevtext": "\nwhere\n\n", "index": 29, "text": "\\begin{equation}\n\\textbf P =\n\\left(\n\\begin{array}{c c}\n\\textbf P_{11} & \\textbf P_{12} \\\\\n\\textbf P_{21} & \\textbf P_{22} \\\\\n\\end{array}\n\\right)\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E15.m1\" class=\"ltx_Math\" alttext=\"\\textbf{P}=\\left(\\begin{array}[]{c c}\\textbf{P}_{11}&amp;\\textbf{P}_{12}\\\\&#10;\\textbf{P}_{21}&amp;\\textbf{P}_{22}\\\\&#10;\\end{array}\\right)\" display=\"block\"><mrow><mtext>\ud835\udc0f</mtext><mo>=</mo><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><msub><mtext>\ud835\udc0f</mtext><mn>11</mn></msub></mtd><mtd columnalign=\"center\"><msub><mtext>\ud835\udc0f</mtext><mn>12</mn></msub></mtd></mtr><mtr><mtd columnalign=\"center\"><msub><mtext>\ud835\udc0f</mtext><mn>21</mn></msub></mtd><mtd columnalign=\"center\"><msub><mtext>\ud835\udc0f</mtext><mn>22</mn></msub></mtd></mtr></mtable><mo>)</mo></mrow></mrow></math>", "type": "latex"}, {"file": "1601.05078.tex", "nexttext": "\nwhere\n\n", "itemtype": "equation", "pos": 27088, "prevtext": "\nis the precision matrix.  To impose a correlation structure that enforces\ndependence between covariate values corresponding to adjacent times, we\nadopt a first-order random walk with full conditionals\n\\begin{eqnarray}\nZ_{0j} | Z_{-0j} & \\sim & N\\left( Z_{1j} , \\frac{1}{\\kappa} \\right), \\\\\nZ_{ij} | Z_{-ij} & \\sim & N\\left(\\frac{Z_{(i-1)j}+Z_{(i+1)j}}{2}, \\frac{1}{2 \\kappa} \\right) \\\\\n& & \\quad \\text{for } i=1,\\dots,M-1, \\nonumber \\\\\nZ_{Mj} | Z_{-Mj} & \\sim & N \\left( Z_{(M-1)j}, \\frac{1}{\\kappa} \\right).\n\\end{eqnarray}\nLet $\\textbf Z^K$ denote a vector of dimension $M-K$ with every entry equal to $Z_{Kj}$.  Then\nthe distribution of missing covariate values conditional on observed covariate values is\n\n", "index": 31, "text": "\\begin{equation}\nP(\\textbf Z^{\\text{mis}}_j | \\textbf Z^{\\text{obs}}_j)\n\\propto \\kappa^{(M-K)/2}\n\\exp \\left(-\\frac{\\kappa}{2}(\\textbf Z^{\\text{mis}}_j  - \\textbf Z^K)'\n \\textbf P_{22} (\\textbf Z^{\\text{mis}}_j  - \\textbf Z^K )\n\\right),\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E16.m1\" class=\"ltx_Math\" alttext=\"P(\\textbf{Z}^{\\text{mis}}_{j}|\\textbf{Z}^{\\text{obs}}_{j})\\propto\\kappa^{(M-K)%&#10;/2}\\exp\\left(-\\frac{\\kappa}{2}(\\textbf{Z}^{\\text{mis}}_{j}-\\textbf{Z}^{K})^{%&#10;\\prime}\\textbf{P}_{22}(\\textbf{Z}^{\\text{mis}}_{j}-\\textbf{Z}^{K})\\right),\" display=\"block\"><mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><msubsup><mtext>\ud835\udc19</mtext><mi>j</mi><mtext>mis</mtext></msubsup><mo stretchy=\"false\">|</mo><msubsup><mtext>\ud835\udc19</mtext><mi>j</mi><mtext>obs</mtext></msubsup><mo stretchy=\"false\">)</mo></mrow><mo>\u221d</mo><msup><mi>\u03ba</mi><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>M</mi><mo>-</mo><mi>K</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>/</mo><mn>2</mn></mrow></msup><mi>exp</mi><mrow><mo>(</mo><mo>-</mo><mfrac><mi>\u03ba</mi><mn>2</mn></mfrac><msup><mrow><mo stretchy=\"false\">(</mo><msubsup><mtext>\ud835\udc19</mtext><mi>j</mi><mtext>mis</mtext></msubsup><mo>-</mo><msup><mtext>\ud835\udc19</mtext><mi>K</mi></msup><mo stretchy=\"false\">)</mo></mrow><mo>\u2032</mo></msup><msub><mtext>\ud835\udc0f</mtext><mn>22</mn></msub><mrow><mo stretchy=\"false\">(</mo><msubsup><mtext>\ud835\udc19</mtext><mi>j</mi><mtext>mis</mtext></msubsup><mo>-</mo><msup><mtext>\ud835\udc19</mtext><mi>K</mi></msup><mo stretchy=\"false\">)</mo></mrow><mo>)</mo></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05078.tex", "nexttext": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\subsection{Markov Chain Monte Carlo Sampling Scheme}\n\\par\nWe use MCMC sampling\nto approximate the posterior\n\n", "itemtype": "equation", "pos": 27345, "prevtext": "\nwhere\n\n", "index": 33, "text": "\\begin{equation}\n\\textbf P_{22} =\n\\left(\n\\begin{array}{c c c c c}\n-1 & 2 & -1 & & \\\\\n& & \\ddots & \\ddots & \\\\\n& & -1 & 2 & -1 \\\\\n& & & -1 & 1 \\\\\n\\end{array}\n\\right).\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E17.m1\" class=\"ltx_Math\" alttext=\"\\textbf{P}_{22}=\\left(\\begin{array}[]{c c c c c}-1&amp;2&amp;-1&amp;&amp;\\\\&#10;&amp;&amp;\\ddots&amp;\\ddots&amp;\\\\&#10;&amp;&amp;-1&amp;2&amp;-1\\\\&#10;&amp;&amp;&amp;-1&amp;1\\\\&#10;\\end{array}\\right).\" display=\"block\"><mrow><mrow><msub><mtext>\ud835\udc0f</mtext><mn>22</mn></msub><mo>=</mo><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>1</mn></mrow></mtd><mtd columnalign=\"center\"><mn>2</mn></mtd><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>1</mn></mrow></mtd><mtd/><mtd/></mtr><mtr><mtd/><mtd/><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22f1</mi></mtd><mtd columnalign=\"center\"><mi mathvariant=\"normal\">\u22f1</mi></mtd><mtd/></mtr><mtr><mtd/><mtd/><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>1</mn></mrow></mtd><mtd columnalign=\"center\"><mn>2</mn></mtd><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>1</mn></mrow></mtd></mtr><mtr><mtd/><mtd/><mtd/><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>1</mn></mrow></mtd><mtd columnalign=\"center\"><mn>1</mn></mtd></mtr></mtable><mo>)</mo></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05078.tex", "nexttext": "\n\n\n\n\n\\subsection{Missing Covariate Data}\n\nIt is important to have a mechanism for dealing with unobserved covariate values.  This is\nparticularly crucial because\nthe population history timeline, which ranges from the most recent sampling time to the time of the\nMRCA, necessitates observations from a wide and \\textit{a} \\textit{priori}\nunknown time span.\n\n\n\nLet $\\textbf Z^{\\text{obs}}$ denote the observed covariate values and\n$\\textbf Z^{\\text{mis}}$ the missing covariate values, so that\n$\\textbf Z = (\\textbf Z^{\\text{obs}}, \\textbf Z^{\\text{mis}})$.  The missing data\ncan be treated as extra unknown parameters in a Bayesian model, and they can be estimated\nprovided that there is a model that links them to the observed data and other model parameters.\nWe have the factorization\n\n", "itemtype": "equation", "pos": 23566, "prevtext": "\nTo complete the model specification, we place a relatively uninformative multivariate normal prior $P(\\boldsymbol \\beta)$ on\nthe coefficients $\\boldsymbol \\beta$.  This yields the posterior\n\n", "index": 23, "text": "\\begin{equation}\nP(\\boldsymbol \\gamma, \\boldsymbol \\beta, \\tau| \\textbf g, \\textbf Z) \\propto\nP(\\textbf g| \\boldsymbol \\gamma) P(\\boldsymbol \\gamma|\\textbf Z,\\boldsymbol \\beta,\\tau) P(\\boldsymbol \\beta) P(\\tau) .\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E18.m1\" class=\"ltx_Math\" alttext=\"P(\\bm{\\gamma},\\bm{\\beta},\\tau|\\textbf{g},\\textbf{Z})\\propto P(\\textbf{g}|\\bm{%&#10;\\gamma})P(\\bm{\\gamma}|\\textbf{Z},\\bm{\\beta},\\tau)P(\\bm{\\beta})P(\\tau).\" display=\"block\"><mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf38</mi><mo>,</mo><mi>\ud835\udf37</mi><mo>,</mo><mi>\u03c4</mi><mo stretchy=\"false\">|</mo><mtext>\ud835\udc20</mtext><mo>,</mo><mtext>\ud835\udc19</mtext><mo stretchy=\"false\">)</mo></mrow><mo>\u221d</mo><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mtext>\ud835\udc20</mtext><mo stretchy=\"false\">|</mo><mi>\ud835\udf38</mi><mo stretchy=\"false\">)</mo></mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf38</mi><mo stretchy=\"false\">|</mo><mtext>\ud835\udc19</mtext><mo>,</mo><mi>\ud835\udf37</mi><mo>,</mo><mi>\u03c4</mi><mo stretchy=\"false\">)</mo></mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf37</mi><mo stretchy=\"false\">)</mo></mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mi>\u03c4</mi><mo stretchy=\"false\">)</mo></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05078.tex", "nexttext": "\nwith $\\boldsymbol \\gamma_{(0)} = \\boldsymbol \\gamma^{(n)}$, the current value of $\\boldsymbol \\gamma$.\nHere,\n\n", "itemtype": "equation", "pos": 30023, "prevtext": "\nTo sample $\\boldsymbol \\gamma$ and $\\tau$, we propose\na fast-mixing, block-updating\nMCMC sampling scheme for GMRFs \\citep{Knorr-Held2002}.\nSuppose we have current parameter values $(\\boldsymbol \\gamma^{(n)}, \\tau^{(n)})$.\nFirst, consider the full conditional density\n\\begin{eqnarray}\nP(\\boldsymbol \\gamma|\\textbf g, \\textbf Z, \\boldsymbol \\beta, \\tau)\n& \\propto &  P(\\textbf g|\\boldsymbol \\gamma)\nP(\\boldsymbol \\gamma|\\textbf Z, \\boldsymbol \\beta, \\tau) \\nonumber \\\\\n& \\propto & \\exp \\left[\\sum_{k=1}^{M+1} (-\\gamma_k c_k - SS_k e^{-\\gamma_k}) \\right]\n \\tau^{M/2} \\exp \\left[-\\frac{\\tau}{2} (\\boldsymbol \\gamma - \\textbf Z \\boldsymbol \\beta)' \\textbf Q\n (\\boldsymbol \\gamma- \\textbf Z \\boldsymbol \\beta) \\right] \\nonumber \\\\\n & = & \\tau^{M/2} \\exp \\left[\n -\\frac{\\tau}{2} (\\boldsymbol \\gamma - \\textbf Z \\boldsymbol \\beta)' \\textbf Q\n (\\boldsymbol \\gamma- \\textbf Z \\boldsymbol \\beta)\n -\\sum_{k=1}^{M+1} (\\gamma_k c_k + SS_k e^{-\\gamma_k}) \\right] \\nonumber \\\\\n & = & \\tau^{M/2} \\exp \\left[\n -\\frac{\\tau}{2} \\boldsymbol \\gamma' \\textbf Q \\boldsymbol \\gamma + (\\textbf Z \\boldsymbol \\beta)' \\tau \\textbf Q \\boldsymbol \\gamma\n -\\sum_{k=1}^{M+1} (\\gamma_k c_k + SS_k e^{-\\gamma_k}) \\right] .\n\\end{eqnarray}\nLet $h_k (\\gamma_k) = (\\gamma_k c_k + SS_k e^{-\\gamma_k})$.  We can approximate each term\n$h_k (\\gamma_k)$ by a second-order Taylor expansion\nabout, say, $\\hat{\\gamma_k}$:\n\\begin{eqnarray}\nh_k (\\gamma_k) & \\approx & h_k (\\hat{\\gamma_k}) + h'_k (\\hat{\\gamma_k})(\\gamma_k - \\hat{\\gamma_k})\n+ \\frac{1}{2} h''_k (\\hat{\\gamma_k})(\\gamma_k - \\hat{\\gamma_k})^2 \\nonumber \\\\\n& = & SS_k e^{-\\hat{\\gamma_k}} \\left(\\frac{1}{2}\\hat{\\gamma_k}^2 + \\hat{\\gamma_k} + 1 \\right) \\nonumber \\\\\n& & + \\left[c_k - SS_k e^{-\\hat{\\gamma_k}} - SS_k e^{-\\hat{\\gamma_k}} \\hat{\\gamma_k}\\right] \\gamma_k\\nonumber \\\\\n& & + \\left[\\frac{1}{2} SS_k e^{-\\hat{\\gamma_k}} \\right] \\gamma^2_k .\n\\end{eqnarray}\nWe center the Taylor expansion about a point\n$\\hat{\\boldsymbol \\gamma} = (\\hat{\\gamma}_1, \\ldots, \\hat{\\gamma}_{M+1})$ obtained iteratively by the Newton-Raphson method:\n\n", "index": 37, "text": "\\begin{equation}\n\\boldsymbol \\gamma_{(n+1)} = \\boldsymbol \\gamma_{(n)} -\n[d^2 f(\\boldsymbol \\gamma_{(n)})]^{-1} (df(\\boldsymbol \\gamma_{(n)}))'\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E19.m1\" class=\"ltx_Math\" alttext=\"\\bm{\\gamma}_{(n+1)}=\\bm{\\gamma}_{(n)}-[d^{2}f(\\bm{\\gamma}_{(n)})]^{-1}(df(\\bm{%&#10;\\gamma}_{(n)}))^{\\prime}\" display=\"block\"><mrow><msub><mi>\ud835\udf38</mi><mrow><mo stretchy=\"false\">(</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></msub><mo>=</mo><mrow><msub><mi>\ud835\udf38</mi><mrow><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow></msub><mo>-</mo><mrow><msup><mrow><mo stretchy=\"false\">[</mo><mrow><msup><mi>d</mi><mn>2</mn></msup><mo>\u2062</mo><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udf38</mi><mrow><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">]</mo></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>d</mi><mo>\u2062</mo><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udf38</mi><mrow><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2032</mo></msup></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.05078.tex", "nexttext": "\nwith\n\n", "itemtype": "equation", "pos": 30291, "prevtext": "\nwith $\\boldsymbol \\gamma_{(0)} = \\boldsymbol \\gamma^{(n)}$, the current value of $\\boldsymbol \\gamma$.\nHere,\n\n", "index": 39, "text": "\\begin{equation}\nf(\\boldsymbol \\gamma) = -\\frac{1}{2} \\boldsymbol \\gamma' \\tau \\textbf Q \\boldsymbol \\gamma\n+ (\\textbf Z \\boldsymbol \\beta)' \\tau \\textbf Q \\boldsymbol \\gamma\n-\\sum_{k=1}^{M+1} (\\gamma_k c_k + SS_k e^{-\\gamma_k})\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E20.m1\" class=\"ltx_Math\" alttext=\"f(\\bm{\\gamma})=-\\frac{1}{2}\\bm{\\gamma}^{\\prime}\\tau\\textbf{Q}\\bm{\\gamma}+(%&#10;\\textbf{Z}\\bm{\\beta})^{\\prime}\\tau\\textbf{Q}\\bm{\\gamma}-\\sum_{k=1}^{M+1}(%&#10;\\gamma_{k}c_{k}+SS_{k}e^{-\\gamma_{k}})\" display=\"block\"><mrow><mrow><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf38</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mrow><mo>-</mo><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>\u2062</mo><msup><mi>\ud835\udf38</mi><mo>\u2032</mo></msup><mo>\u2062</mo><mi>\u03c4</mi><mo>\u2062</mo><mtext>\ud835\udc10</mtext><mo>\u2062</mo><mi>\ud835\udf38</mi></mrow></mrow><mo>+</mo><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mtext>\ud835\udc19</mtext><mo>\u2062</mo><mi>\ud835\udf37</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2032</mo></msup><mo>\u2062</mo><mi>\u03c4</mi><mo>\u2062</mo><mtext>\ud835\udc10</mtext><mo>\u2062</mo><mi>\ud835\udf38</mi></mrow></mrow><mo>-</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>M</mi><mo>+</mo><mn>1</mn></mrow></munderover><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><msub><mi>\u03b3</mi><mi>k</mi></msub><mo>\u2062</mo><msub><mi>c</mi><mi>k</mi></msub></mrow><mo>+</mo><mrow><mi>S</mi><mo>\u2062</mo><msub><mi>S</mi><mi>k</mi></msub><mo>\u2062</mo><msup><mi>e</mi><mrow><mo>-</mo><msub><mi>\u03b3</mi><mi>k</mi></msub></mrow></msup></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.05078.tex", "nexttext": "\nand\n\n", "itemtype": "equation", "pos": 30540, "prevtext": "\nwith\n\n", "index": 41, "text": "\\begin{equation}\ndf(\\boldsymbol \\gamma) = -\\boldsymbol \\gamma' \\tau \\textbf Q\n+ (\\textbf Z \\boldsymbol \\beta)' \\tau \\textbf Q\n- [c_1 - SS_1e^{-\\gamma_1},...,c_{M+1} - SS_{M+1}e^{-\\gamma_{M+1}}]\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E21.m1\" class=\"ltx_Math\" alttext=\"df(\\bm{\\gamma})=-\\bm{\\gamma}^{\\prime}\\tau\\textbf{Q}+(\\textbf{Z}\\bm{\\beta})^{%&#10;\\prime}\\tau\\textbf{Q}-[c_{1}-SS_{1}e^{-\\gamma_{1}},...,c_{M+1}-SS_{M+1}e^{-%&#10;\\gamma_{M+1}}]\" display=\"block\"><mrow><mrow><mi>d</mi><mo>\u2062</mo><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf38</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mrow><mo>-</mo><mrow><msup><mi>\ud835\udf38</mi><mo>\u2032</mo></msup><mo>\u2062</mo><mi>\u03c4</mi><mo>\u2062</mo><mtext>\ud835\udc10</mtext></mrow></mrow><mo>+</mo><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mtext>\ud835\udc19</mtext><mo>\u2062</mo><mi>\ud835\udf37</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2032</mo></msup><mo>\u2062</mo><mi>\u03c4</mi><mo>\u2062</mo><mtext>\ud835\udc10</mtext></mrow></mrow><mo>-</mo><mrow><mo stretchy=\"false\">[</mo><mrow><msub><mi>c</mi><mn>1</mn></msub><mo>-</mo><mrow><mi>S</mi><mo>\u2062</mo><msub><mi>S</mi><mn>1</mn></msub><mo>\u2062</mo><msup><mi>e</mi><mrow><mo>-</mo><msub><mi>\u03b3</mi><mn>1</mn></msub></mrow></msup></mrow></mrow><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><mrow><msub><mi>c</mi><mrow><mi>M</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>-</mo><mrow><mi>S</mi><mo>\u2062</mo><msub><mi>S</mi><mrow><mi>M</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><msup><mi>e</mi><mrow><mo>-</mo><msub><mi>\u03b3</mi><mrow><mi>M</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.05078.tex", "nexttext": "\nReplacing the terms $h_k(\\gamma_k)$ with their Taylor expansions\nyields the following second-order Gaussian approximation to the full conditional\ndensity $P(\\boldsymbol \\gamma|\\textbf g, \\textbf Z, \\boldsymbol \\beta, \\tau)$ :\n\n\n\n", "itemtype": "equation", "pos": 30753, "prevtext": "\nand\n\n", "index": 43, "text": "\\begin{equation}\nd^2 f(\\boldsymbol \\gamma) = -\\tau \\textbf Q - \\mbox{diag}[SS_k e^{-\\gamma_k}].\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E22.m1\" class=\"ltx_Math\" alttext=\"d^{2}f(\\bm{\\gamma})=-\\tau\\textbf{Q}-\\mbox{diag}[SS_{k}e^{-\\gamma_{k}}].\" display=\"block\"><mrow><mrow><mrow><msup><mi>d</mi><mn>2</mn></msup><mo>\u2062</mo><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf38</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mo>-</mo><mrow><mi>\u03c4</mi><mo>\u2062</mo><mtext>\ud835\udc10</mtext></mrow></mrow><mo>-</mo><mrow><mtext>diag</mtext><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mi>S</mi><mo>\u2062</mo><msub><mi>S</mi><mi>k</mi></msub><mo>\u2062</mo><msup><mi>e</mi><mrow><mo>-</mo><msub><mi>\u03b3</mi><mi>k</mi></msub></mrow></msup></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05078.tex", "nexttext": "\n\n\nwhere $\\mbox{Diag}(\\cdot)$ is a diagonal matrix.\n\\par\nStarting from current parameter values $(\\boldsymbol \\gamma^{(n)}, \\tau^{(n)})$,\nwe first generate a candidate value for the\nprecision, $\\tau^* = \\tau^{(n)} f$, where $f$ is drawn from a symmetric proposal distribution with density\n$P(f) \\propto f + \\frac{1}{f}$ defined on $[1/F,F]$.  The tuning constant $F$ controls the distance\nbetween the proposed and current values of the precision.  Next, conditional on $\\tau^*$, we propose\na new state $\\boldsymbol{\\gamma}^*$ using the Gaussian approximation (\\ref{eq:mult}) to the full conditional density\n$P(\\gamma|\\textbf g, \\textbf Z, \\boldsymbol \\beta, \\tau^*)$.\nIn the final step, the candidate state $(\\tau^*,\\boldsymbol \\gamma^*)$ is accepted or rejected according\nto the Metropolis-Hastings ratio \\citep{Metropolis1953, Hastings1970}.\n\n\n\\subsection{Genealogical Uncertainty}\n\\par\nIn our development thus far, we have assumed the genealogies $g_1,\\dots,g_m$ are known and fixed.  However,\nin reality we observe sequence data rather than genealogies.  It is possible to estimate genealogies\nbeforehand from sequence data and then infer the effective population size from fixed genealogies.\nHowever, this ignores the uncertainty associated with phylogenetic reconstruction.  Alternatively,\nwe can jointly infer genealogies and population dynamics from sequence data by combining\nthe estimation procedures into a single Bayesian framework.\n\\par\nWe can think of the aligned sequence data\n$\\textbf Y = (Y_1,\\dots,Y_m)$ for the $m$ loci as arising from continuous-time Markov chain (CTMC) models for molecular character\nsubstitution that act along the hidden genealogies.  Each CTMC depends on a vector of\nmutational parameters $\\Lambda_i$, that include, for example, an overall rate multiplier, relative exchange\nrates among characters and across-site variation specifications.  We let\n$\\boldsymbol \\Lambda = (\\Lambda_1,\\dots,\\Lambda_m)$.\nWe then jointly estimate the genealogies, mutational parameters, precision,\nand vector of effective population sizes through their posterior distribution\n\n", "itemtype": "equation", "pos": 31092, "prevtext": "\nReplacing the terms $h_k(\\gamma_k)$ with their Taylor expansions\nyields the following second-order Gaussian approximation to the full conditional\ndensity $P(\\boldsymbol \\gamma|\\textbf g, \\textbf Z, \\boldsymbol \\beta, \\tau)$ :\n\n\n\n", "index": 45, "text": "\\begin{multline}\n\\label{eq:mult}\nP(\\boldsymbol \\gamma|\\textbf g, \\textbf Z, \\boldsymbol \\beta, \\tau) \\approx\n\\tau^{M/2} \\exp\\left[-\\frac{1}{2} \\boldsymbol \\gamma' [\\tau \\textbf Q + \\mbox{Diag}(SS_k e^{-\\hat{\\gamma_k}}) ]\n\\boldsymbol \\gamma + (\\tau \\textbf Q \\textbf Z \\boldsymbol \\beta)' \\boldsymbol \\gamma \\right. \\\\\n\\left.\n-\\sum_{k=1}^{M+1} (c_k - SS_k e^{-\\hat{\\gamma_k}} - SS_k e^{-\\hat{\\gamma_k}} \\hat{\\gamma_k}) \\gamma_k \\right],\n\\end{multline}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E23.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle P(\\bm{\\gamma}|\\textbf{g},\\textbf{Z},\\bm{\\beta},\\tau)\\approx\\tau^%&#10;{M/2}\\exp\\left[-\\frac{1}{2}\\bm{\\gamma}^{\\prime}[\\tau\\textbf{Q}+\\mbox{Diag}(SS_%&#10;{k}e^{-\\hat{\\gamma_{k}}})]\\bm{\\gamma}+(\\tau\\textbf{Q}\\textbf{Z}\\bm{\\beta})^{%&#10;\\prime}\\bm{\\gamma}\\right.\\\\&#10;\\displaystyle\\left.-\\sum_{k=1}^{M+1}(c_{k}-SS_{k}e^{-\\hat{\\gamma_{k}}}-SS_{k}e%&#10;^{-\\hat{\\gamma_{k}}}\\hat{\\gamma_{k}})\\gamma_{k}\\right],\" display=\"block\"><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf38</mi><mo stretchy=\"false\">|</mo><mtext>\ud835\udc20</mtext><mo>,</mo><mtext>\ud835\udc19</mtext><mo>,</mo><mi>\ud835\udf37</mi><mo>,</mo><mi>\u03c4</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2248</mo><msup><mi>\u03c4</mi><mrow><mi>M</mi><mo>/</mo><mn>2</mn></mrow></msup><mi>exp</mi><mrow><mo>[</mo><mo>-</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><mi>\ud835\udf38</mi><mo>\u2032</mo></msup><mrow><mo stretchy=\"false\">[</mo><mi>\u03c4</mi><mtext>\ud835\udc10</mtext><mo>+</mo><mtext>Diag</mtext><mrow><mo stretchy=\"false\">(</mo><mi>S</mi><msub><mi>S</mi><mi>k</mi></msub><msup><mi>e</mi><mrow><mo>-</mo><mover accent=\"true\"><msub><mi>\u03b3</mi><mi>k</mi></msub><mo stretchy=\"false\">^</mo></mover></mrow></msup><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">]</mo></mrow><mi>\ud835\udf38</mi><mo>+</mo><msup><mrow><mo stretchy=\"false\">(</mo><mi>\u03c4</mi><mrow><mtext>\ud835\udc10</mtext><mtext>\ud835\udc19</mtext></mrow><mi>\ud835\udf37</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2032</mo></msup><mi>\ud835\udf38</mi></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mrow><mo>-</mo><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>M</mi><mo>+</mo><mn>1</mn></mrow></munderover><mrow><mo stretchy=\"false\">(</mo><msub><mi>c</mi><mi>k</mi></msub><mo>-</mo><mi>S</mi><msub><mi>S</mi><mi>k</mi></msub><msup><mi>e</mi><mrow><mo>-</mo><mover accent=\"true\"><msub><mi>\u03b3</mi><mi>k</mi></msub><mo stretchy=\"false\">^</mo></mover></mrow></msup><mo>-</mo><mi>S</mi><msub><mi>S</mi><mi>k</mi></msub><msup><mi>e</mi><mrow><mo>-</mo><mover accent=\"true\"><msub><mi>\u03b3</mi><mi>k</mi></msub><mo stretchy=\"false\">^</mo></mover></mrow></msup><mover accent=\"true\"><msub><mi>\u03b3</mi><mi>k</mi></msub><mo stretchy=\"false\">^</mo></mover><mo stretchy=\"false\">)</mo></mrow><msub><mi>\u03b3</mi><mi>k</mi></msub><mo>]</mo><mo>,</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.05078.tex", "nexttext": "\nHere, the coalescent acts as a prior for the genealogies, and we assume that $\\boldsymbol \\Lambda$ and $\\textbf g$ are\n\\textit{a priori} independent of each other.\nHierarchical models are however available to share information about $\\boldsymbol \\Lambda$ among loci without strictly\nenforcing that they follow the same evolutionary process \\citep{Suchard2003b,Edo-Matas2011}.  We implement our\nmodels in the open-source software program BEAST \\citep{Drummond2012}.  The posterior distribution is approximated\nthrough MCMC methods.  We combine our block-updating scheme for $\\boldsymbol \\gamma$ and $\\tau$ with\nstandard transition kernels available in BEAST to update the other parameters.\n\n\\section{Results}\n\n\n\\subsection{Expansion in Epizootic Rabies Virus}\n\nRabies is a zoonotic disease caused by the rabies virus, and is responsible for over 50,000\nhuman deaths annually.  In \nover 99$\\%$ of human cases, the rabies virus is transmitted by dogs.  However,\nthere are a number of other important rabies reservoirs, such as bats and \nseveral terrestrial carnivore species, including raccoons \\citep{WHORabies}.  Epizootic rabies\namong raccoons was first identified in the U.S. in Florida in the 1940s, and the affected\narea of the subsequent expansion was limited to the southeastern U.S. \n\\citep{Kappus1970}.  A second focus of rabies among raccoons emerged in West Virginia in \nthe late 1970s due to the translocation of raccoons incubating rabies from the southeastern\nU.S.  The virus spread rapidly along the mid-Atlantic coast and northeastern U.S. \nover the following decades, and is\none of the largest documented outbreaks in the history of wildlife rabies \\citep{Childs2000}.  \n\\par     \n\\citet{Biek2007} examine the population dynamics of the rabies epizootic among raccoons in\nthe northeastern U.S. starting in the late 1970s.  In a spatiogenetic\nanalysis, \\citet{Biek2007} compare a coalescent-based Bayesian Skyline estimate \\citep{Drummond2005}\nof the demographic history to the spatial expansion of the epidemic.  \nIn a \\textit{post hoc} approach, the authors find\nvery similar temporal dynamics between the effective population size and the \n15-month moving average of the area (in square kilometers)\nof counties newly affected by the rabies outbreak each month.  The effective \npopulation size exhibits stages of moderate and rapid growth, \nas well as plateau periods with little or no growth.\nPopulation expansion coincides with time periods during which \nthe virus invades new area at a generally increasing rate.  \nOn the other hand, the effective population size shows little, if any, growth\nduring periods when the virus invades new area at a \ndeclining rate.   \nThese trends can be seen in Figure 1, which depicts a Skygrid demographic reconstruction\nfrom sequence data along with \nthe monthly area newly affected by the virus as a solid black line.\nNotably,\n\\citet{Biek2007} demonstrate through their analysis that the largest contribution to the population expansion\ncomes from the wave front, highlighting the degree to which the overall viral dynamics \ndepend on processes at the wave front.\n\\par\nWe build upon the analysis of \\citet{Biek2007} by incorporating the spatiotemporal spread of rabies\ninto the demographic inference model through the Skygrid.  The data consist of 47 sequences\nwith sampling dates between 1982 and 2004.  As a covariate, we initially adopt the 15-month\nmoving average of the log-transformed area of all counties newly affected by the raccoon rabies virus each\nmonth from 1977-1999 \\citep{Biek2007}.  We infer a posterior mean covariate \neffect size of 0.24 with a 95$\\%$ Bayesian credibility interval (BCI) of (-0.77, 1.27), \nimplying that there is not a significant association between the log effective population \nsize and the covariate.  This is not surprising, considering the patterns of growth and \ndecline in the covariate compared with the essentially monotonic trend in the log effective \npopulation size (see Figure 1).\n\\par\nGraphically comparing the rate at which the virus invades new area with population dynamics\nclearly illustrates the relationship between the demographic and spatial expansion of the raccoon\nrabies outbreak.  \nIn modeling the association between the population dynamics and a covariate, however,\nwe relate the covariate to the total effective population size (as opposed to the change in the effective\npopulation size).  In this case, the cumulative affected area is a \nmore suitable covariate than the newly affected area.   \nWe conduct an additional Skygrid analysis and use the log-transform of\nthe cumulative area (in square\nkilometers) of counties affected by raccoon rabies at various time points\nbetween 1977 and 1999 as a covariate.  The area of a county is added to the cumulative total \nfor the month during which rabies is first reported in that county.  There are 175 months\nfor which the cumulative affected area changes, and we specify the grid points to coincide\nwith these change points.\n\n\n\n\n\n\\begin{figure}\n\t\\centering\n\t\n\t\\includegraphics[width=1.0\\textwidth]{newrabiesplot}\n \t\\caption[Demographic history of raccoon rabies epidemic in the northeastern United\n \tStates]{\n \tDemographic history of raccoon rabies epidemic in the northeastern United\n \tStates.\n \tThe black line represents the covariate, the\n \t15-month moving average of the log-transformed area of all counties newly affected by \n \tthe raccoon rabies virus each month.\n \tThe solid red line is the posterior mean\n \tlog effective population size trajectory estimated from sequence data.\n \tThe 95$\\%$ Bayesian credibility interval region for the trajectory is shaded in light red.}\n \t\\label{Fig. 1}\n\\end{figure}\n\n\\begin{figure}\n\t\\centering\n\t\n\t\\includegraphics[width=1.0\\textwidth]{rabiesskygridplotslatest}\n \t\\caption[Demographic history of raccoon rabies epidemic in the northeastern United\n \tStates]{\n \tDemographic history of raccoon rabies epidemic in the northeastern United\n \tStates.\n \tThe black line represents the covariate, the log cumulative area of counties affected\n \tby raccoon rabies virus.\n \tThe solid blue line is the posterior mean log effective population size trajectory\n \tfrom the Skygrid analysis with the covariate, and the solid red line is the posterior mean\n \tlog effective population size trajectory from the Skygrid analysis without the covariate.\n \tThe 95$\\%$ Bayesian credibility interval regions for the trajectories are shaded\n \tin light blue for the analysis that includes the covariate and in light red for the\n \tanalysis without the covariate.\n \tThe overlap between the two Bayesian credibility interval regions is shaded in purple.}\n \t\\label{Fig. 2}\n\\end{figure}\n\n\n\n\n\n\\par\nThe Skygrid analysis with the log cumulative affected area covariate yields a posterior\nmean estimate of 1.30 for the coefficient $\\boldsymbol \\beta$, with a 95$\\%$ BCI\nof (0.18, 2.86), implying a significant, positive association between the effective population\nsize of the raccoon rabies virus and the cumulative area affected by the outbreak.\nSkygrid demographic reconstructions of the epidemic are displayed in Figure 2.  The\nred line is the posterior mean log effective population size trajectory inferred\nusing the Skygrid without incorporation of the covariate.  Its 95$\\%$ BCI region\nis shaded in light red.  The log effective population size trajectory\nfrom the Skygrid analysis with the log cumulative area\ncovariate is represented by the blue line, and its 95$\\%$ BCI region is shaded\nin light blue.  The overlap between the two BCI regions is shaded purple.\nThe log cumulative area affected by the rabies epidemic is depicted as\na solid black line.  Figure 2 shows great correspondence between the temporal dynamics of the demographic and\nspatial expansions.  The period 1977-1984 is marked by a steady increase in effective\npopulation size and a rapid exponential increase in affected area.  This is followed in the\nperiod 1984-1990 by a plateau in effective population size along with a much more modest rate\nof increase for the affected area.  The affected area begins increasing at a greater rate around\n1990 and then plateaus around 1996.  Similary, 1990-1996 marks a stage of demographic expansion,\nculminating in a period of stasis from 1996 on.  The two effective population size curves\nare nearly identical from 1977-1990 and 1996-2004.  From 1990-1996, both effective population size trajectories\nincrease, but the rate of increase is more modest in the Skygrid estimate that incorporates the covariate\ndata.  Notably, the light blue BCI region inferred from the sequence and covariate\ndata is narrower than and virtually entirely contained within the red BCI region inferred only\nfrom the sequence data.  Thus including the covariate in this analysis not only\nyields an estimate consistent with what\nwe infer from the sequence data alone, but also a more precise estimate.\n\n\n\n\n\n\n\n\\subsection{Epidemic Dynamics in Dengue Evolution}\n\n\nDengue is a mosquito-borne viral infection that causes a severe flu-like illness in which potentially lethal syndromes occasionally arise.\nDengue is caused by the dengue virus, DENV, an RNA virus which comes in four antigenically distinct but closely\nrelated serotypes, DENV-1 through DENV-4.\n\\citep{WHODengue}.\nA recent estimate places the worldwide burden of dengue at 390 million infections per\nyear (with 95$\\%$ confidence interval 284-528 million), of which 96 million\n(67-136 million) manifest clinically (with any level of disease severity) \\citep{Bhatt2013}.\n\nDengue is found in tropical and sub-tropical\nclimates throughout the world, mostly in urban and semi-urban areas \\citep{WHODengue}.\n\\par\nDengue incidence records show patterns of periodicity with\noutbreaks every 3-5 years \\citep{Cummings2004, Adams2006, Bennett2010}.\n\n\nStudies have shown that the epidemiological dynamics of dengue transmission in\nPuerto Rico are reflective of changes in the viral effective population size\n\\citep{Bennett2010, Carrington2005}.\n\\citet{Bennett2010} explore the dynamics of DENV-4 in Puerto Rico from 1981-1998.\nBy \\textit{post hoc} comparing dengue isolate counts to effective population size estimates obtained using the Skyride\nmodel \\citep{Minin2008}, \\citet{Bennett2010} show that the pattern of cyclic epidemics is highly\ncorrelated with similar fluctuations in genetic diversity.  We build upon their analysis by\ninferring the effective population size of DENV-4 in Puerto Rico with DENV-4 isolate counts as\na covariate.\n\\par\nWe analyze a data set of 75 DENV-4 sequences, compiled by \\citet{Bennett2003} through\nsequencing randomly selected DENV-4 isolates from\nPuerto Rico from the U.S. Centers for Disease Control\nand Prevention (CDC) sample bank.  The sampling dates include \n\n\\begin{figure}\n\t\\centering\n\t\n\t\\includegraphics[width=1.15\\textwidth]{dengueskygridplotslatest2}\n \t\\caption[Population and epidemiological dynamics of DENV-4 virus in Puerto Rico]\n \t{Population and epidemiological dynamics of DENV-4 virus in Puerto Rico.\n \tThe top plot\n \tdepicts Skygrid effective population size estimates.  See Figure 2 for the legend explanation.\n \t\n \t\n \t\n \t\n \t\n \t\n \t\n \t\n \tThe bars in the bottom plot represent DENV-4 isolate count covariate data.}\n \t\\label{Fig. 3}\n\\end{figure}\n\n\\noindent 1982 ($n=14$), 1986/1987 ($n=19$),\n1992 ($n=15$), 1994 ($n=14$), and 1998 ($n=13$).  The covariate data consist of the number of\nDENV-4 isolates recorded over every 6-month period from 1981-1998.\n\nDENV-4 isolate counts are transformed via the map $x \\mapsto \\log(x+1)$ (this specific logarithmic\ntransformation is chosen to accommodate the transformation of isolate counts of zero).\n\\par\nFigure 3 presents the demographic and epidemiological patterns of DENV-4, with the top plot\nconsisting of Skygrid effective population size estimates and the bottom showing a bar\ngraph of transformed DENV-4 isolate counts.  The blue and red curves in the top plot\ncorrespond to the posterior mean\nlog effective population size trajectories from Skygrid analyses with and without the\nDENV-4 isolate count covariate, respectively.\nThe 95$\\%$ BCI regions for the trajectories are shaded in light blue for the analysis that\nincludes the covariate and in light red for the analysis without the covariate.\nThe overlap between the two BCI regions is shaded in purple.  The demographic\npatterns are generally consistent with the isolate count fluctuations, and suggest\na periodicity of 3-5 years.  This concordance\nis supported by a positive, statistically significant estimate of the coefficient $\\boldsymbol \\beta$\nrelating the effective population size to isolate counts: a posterior mean of 0.90 with\n95$\\%$ BCI (0.36, 1.69).\n\\par\nWhile the two effective population size trajectories are similar, they do have some\nnotable differences.\nThe blue-colored trajectory inferred from both sequence and covariate\ndata closely reflects the DENV-4 isolate count patterns, but\nthe red-colored trajectory inferred entirely from sequence data\ndiverges from the isolate count trends during certain periods.\nFirst, the red trajectory shows a dramatic increase in effective population size in 1981, consistent\nwith a rise in DENV-4 isolates.  However, the red trajectory decreases during 1982 while\nthe DENV-4 isolate counts remain at a high level.\nSecond, the period from late 1986 to late 1988 begins and ends with relative peaks\nin DENV-4 isolates, with a trough\nin between.  By contrast, the red curve reaches a peak during the isolate trough and is on the\ndecline during the late 1988 peak.  Third, the red trajectory shows a trough in the\neffective population size during 1994 that\noccurs about a year before a similar trough in DENV-4 isolates.  These discrepancies\nmay be due to biased sampling in isolate counts and reflect limitations of\nepidemiological surveillance.  Isolate counts are a rough measure of incidence, and their\nerror rates are subject to accurate diagnostic rates by medical personnel, reporting rates,\nand the rate at which suspected cases are submitted for isolation \\citep{Bennett2010}.\nOn the other hand, the epidemiological trends\nare not necessarily incompatible with the effective population size trajectory estimated\nentirely from sequence\ndata when the latter's uncertainty is taken into account.  The blue-colored\ntrajectory inferred from both sequence and isolate count data\ndoes not deviate from the isolate count data in the ways that the red trajectory does.\nHowever, the blue trajectory lies entirely inside the red 95$\\%$ BCI region.\nFurthermore, apart from a 1.5 year period in 1981-82,\nthe blue 95$\\%$ BCI region\nis virtually entirely contained within, and is narrower than, the red 95$\\%$ BCI region.\nTherefore, the Skygrid\nestimate that incorporates the DENV-4 isolate count covariate yields a demographic pattern\nthat reflects epidemiological dynamics, and is more precise than, but not incompatible\nwith, the effective population size estimate inferred only from sequence data.\n\n\n\n\n\n\n\\subsection{Demographic History of the HIV-1 CRF02\\_AG Clade in Cameroon}\n\n\nCirculating recombinant forms (CRFs) are genomes that result from recombination of two\nor more different HIV-1 subtypes and that have been found in at least three epidemiologically\nunrelated individuals.  \nAlthough CRF02\\_AG is globally responsible for only\n7.7$\\%$ of HIV infections \\citep{Hemelaar:2011fk}, it accounts for 60-70$\\%$ of infections\nin Cameroon \\citep{Brennan2008, Powell2010}.\n\\par\nWe investigate the population history of the CRF02\\_AG clade in Cameroon by examining\na multilocus alignment of 336 \\textit{gag}, \\textit{pol}, and \\textit{env} CRF02\\_AG\ngene sequences sampled between 1996 and 2004 from blood donors from Yaounde and Douala \\citep{Brennan2008}.\n\\citet{Faria2011} infer the effective population size from this data set\nwith a parametric piecewise logistic growth-constant demographic\nmodel.  Their results point to a period of exponential growth up until the mid 1990s, at which\npoint the effective population size plateaus.  \\citet{Gill2013} follow up with a\nnonparameteric Skygrid analyis that reveals a monotonic growth in effective population size\nthat peaks around 1997 and is then followed\nby a decline (rather than a plateau) that persists up until the most recent sampling time.\nWe build upon these analyses by introducing two covariates: the yearly prevalence of HIV in\nCameroon among adults ages 18-49, and the yearly HIV incidence rate in Cameroon among\nadults ages 18-49 \\citep{UNAIDS}.  UNAIDS prevalence and incidence estimates for Cameroon\nonly go back to 1990, so we integrate out\nthe missing covariate values as described in Section 2.4 by modeling the covariate values as a first-order\nrandom walk.\n\\par\nFigure 4 depicts the effective population size trajectory along with\nthe HIV prevalence data.  \n\nThe prevalence increases up until\n2000, stays constant for 4 years, and then declines slightly in 2004.  The temporal pattern\nof the prevalence differs markedly from that of the demographic history, and this discordance\nis reflected in the GLM coefficient quantifying the prevalence effect size.  The coefficient has a posterior mean\nof 0.85 with 95$\\%$ BCI (-0.18, 2.03), indicating no significant association between the effective\npopulation size and prevalence.\n\\par\nThe coefficient quantifying the effect size for the incidence rate covariate has a posterior mean\nof 9.20 with 95$\\%$ BCI (1.43, 16.17), implying a significant association between the\npopulation history of the CRF02\\_AG clade and the HIV incidence rate among adults ages 18-49 in\nCameroon.  As shown in Figure 5, the effective population size and incidence rate display\nsimilar dynamics: both increase up until a peak around 1997, then decline.\nThe posterior mean log effective population size\nand 95$\\%$ BCI under the Skygrid model without covariates are\nvirtually the same as the Skygrid estimates that incorporate the incidence data.\nThis is in contrast to the\nprevious examples we've seen, where inclusion of covariates affects effective\npopulation size estimates, and it may reflect the larger amount of sequence data relative\nto covariate data in this example.\n\n\nIt is notable that in this example the effective population size is more reflective\nof incidence than prevalence.  This is in accordance with expectations put forth\nby recent epidemiological modeling of infectious disease dynamics \\citep{Volz2009, Frost2010}.\n\n\n\n\\begin{figure}\n\t\\centering\n\t\\includegraphics[width=1.0\\textwidth]{hivskygridplotsprevlatest}\n \t\\caption[Demographic history of HIV-1 CRF02\\_AG clade in Cameroon with prevalence data.]\n \t{Demographic history of HIV-1 CRF02\\_AG clade in Cameroon.\n \tThe solid black line is the posterior mean log effective population size trajectory,\n \tand its 95$\\%$ Bayesian credibility interval region is shaded in gray.\n \tThe bars represent HIV prevalence estimates for adults of ages 18-49 in Cameroon.\n \t}\n \t\\label{Fig. 4}\n\\end{figure}\n\n\n\\begin{figure}\n\t\\centering\n\t\\includegraphics[width=1.0\\textwidth]{hivskygridplotsinclatest}\n \t\\caption[Demographic history of HIV-1 CRF02\\_AG clade in Cameroon with incidence data.]\n \t{Demographic history of HIV-1 CRF02\\_AG clade in Cameroon.\n \tThe solid black line is the posterior mean log effective population size trajectory,\n \tand its 95$\\%$ Bayesian credibility interval region is shaded in gray.\n \tThe bars represent HIV incidence rate estimates for adults of ages 18-49 in Cameroon.\n \t}\n \t\\label{Fig. 5}\n\\end{figure}\n\n\n\n\n\n\n\\subsection{Population Dynamics of Late Quaternary Musk Ox}\n\nPopulation decline and extinction of\nlarge-bodied mammals characterizes the Late Quaternary period \\citep{Barnosky2004, Lorenzen2011}.  The causes of these\nmegafaunal extinctions remain poorly understood,\nand much of the debate revolves around the impact of climate change and humans\n\\citep{Stuart2004, Lorenzen2011}.  Demographic reconstructions from ancient DNA\nenable clarification of the roles of climatic and anthropogenic factors\nby providing a means to compare demographic patterns\nover geologically significant time scales\nwith paleoclimatic and fossil records\n\n\n\\citep{Shapiro2004, Lorenzen2011}.\n\\par\n\\citet{Campos2010} employ the\nSkyride \\citep{Minin2008} and Bayesian Skyline \\citep{Drummond2005} models to reconstruct\nthe population dynamics\nof musk ox dating back to the late Pleistocene era from ancient DNA sequences.  The musk ox population was\nonce widely distributed in the holarctic ecozone but is now confined to Greenland and the Arctic Archipelago,\nand \\citet{Campos2010} explore potential causes of musk ox population decline.  The authors find that the\narrival of humans into relevant areas did not correspond to changes in musk ox effective population size.\nOn the other hand, \\citet{Campos2010} observe that time intervals during which musk ox populations increase generally\ncorrespond to periods of global climatic cooling, and musk ox populations decline during warmer and\nclimatically unstable periods.  Thus environmental change, as opposed to human presence, emerges as\na more promising candidate as a driving force behind musk ox population dynamics.\n\\par\nWe apply our extended Skygrid model\nto assess the relationship between the population history of musk ox and climate change.\nOxygen isotope records serve as useful proxies for temperature in ancient climate studies.\nHere, we use ice core $\\delta^{18}$O data from the Greenland Ice Core Project (GRIP) \\citep{Johnsen1997, Dansgaard1993, GRIP1993, Grootes1993, Dansgaard1989}.\n$\\delta^{18}$O is a measure of oxygen isotope composition.  In the context of ice core data,\nlower $\\delta^{18}$O values correspond to colder polar temperatures.\nAs a covariate, we adopt a mean $\\delta^{18}$O value, taking the average of\n$\\delta^{18}$O values corresponding to each 3,000-year interval.  The sequence data consist of\n682 bp of the mitochondrial control region, obtained from 149 radiocarbon dated\nspecimens \\citep{Campos2010}.  The ages of the specimens range from the present to 56,900 radiocarbon\n(${}^{14}$C) years before present (YBP).  The sampling locations span the demographic\nrange of ancient musk ox, with samples from the Taimyr Peninsula ($n=54$), the Urals ($n=26$),\nNortheast Siberia ($n=12$), North America ($n=14$) and Greenland ($n=43$).\n\\par\nFigure 6 presents the posterior mean log effective population size trajectory (blue line)\nalong with its 95$\\%$ BCI region shaded in light blue.  The $\\delta^{18}$O covariate\nvalues are represented by the red line. The plot shows\na steady increase in effective population size up until about 60,000 YBP.  During this period,\nthe covariate pattern suggests a general trend of cooling, although there is considerable fluctuation\nin the mean $\\delta^{18}$O values.  The effective population size\nplateaus from 60,000 to 55,000 YBP, then decreases from 55,000 to 40,000 YBP.  During the\naforementioned period of demographic decline, the covariate does not display any clear\ntrends, fluctuating back and forth.  The effective population size increases from about\n40,000 to 25,000 YBP while the $\\delta^{18}$O covariate continues to fluctuate, although it undergoes a net\n\n\\begin{figure}\n\t\\centering\n\t\\includegraphics[width=1.0\\textwidth]{moxplotslatest}\n \t\\caption[Demographic history of ancient musk ox]\n \t{Demographic history of ancient musk ox.\n \tThe axis is labelled according\n \tto years before present.\n \tThe solid blue line is the posterior mean log effective population size trajectory,\n \tand its 95$\\%$ Bayesian credibility interval region is shaded in light blue.\n \tThe solid red line represents the $\\delta^{18}$O covariate.  We do not infer a significant relationship\n \tbetween the effective population size and the covariate.\n \t}\n \t\\label{Fig. 6}\n\\end{figure}\n\n\n\\noindent decrease from the beginning to the end of the phase.  Notably, the musk ox population reaches its\npeak diversity at around\n25,000 YBP, coinciding with the Last Glacial Maximum.\nThe period from 25,000 to 12,000 YBP is marked by a decrease in effective\npopulation size along with a postglacial warming.  \nFinally, a demographic recovery and a very mild decline in the $\\delta^{18}$O covariate \ncharacterize the last 12,000 YBP.  The patterns\nwe note in Figure 6 are consistent with the observations of \\citet{Campos2010}.\nHowever, the GLM coefficient $\\boldsymbol \\beta $ has a posterior mean of\n-0.09 with a 95$\\%$ BCI of (-0.50, 0.35), indicating that there is not a significant association\nbetween the log effective population size and the $\\delta^{18}$O covariate.\nThis is not surprising upon further reflection.  While the net changes in the covariate\nfrom the beginning to the end of the various monotonic phases of the population trajectory lend\nsome support to the hypothesis of a negative relationship between the effective population size\nand $\\delta^{18}$O covariate,\nthe pervasive covariate fluctuations render the relationship insignificant. \n\\par\nThere are more than 5,000 $\\delta^{18}$O measurements in the GRIP data corresponding\nto different time points in the musk ox population history timeline.  Our default\napproach is to specify Skygrid grid points so that the trajectory has as many piecewise constant\nsegments as there are covariate measurement times.  To avoid having an inappropriately large\nnumber of change points, however, we've \nused the average of $\\delta^{18}$O values corresponding to each 3,000-year interval in the\ntimeline as a covariate.  Notably, adopting averages over intervals of \nlengths 1,000, 5,000, or 10,000 years as covariates yields the same basic outcome: the effect size of\nthe covariate is not statistically significant.  \n\\par\nWhile we do not infer a significant association between the log effective population size and\n$\\delta^{18}$O covariate values, this does not rule out climate change as a driving force\nbehind musk ox\npopulation dynamics.  The musk ox is known to be very sensitive to temperature and is not\nable to tolerate high summer temperatures \\citep{Tener1965}.  Using species distribution models,\ndated fossil remains and paleoclimatic data, \\citet{Lorenzen2011}\ndemonstrate a positive correlation between musk ox genetic diversity and its climate-driven\nrange size over the last 50,000 years.\nThe $\\delta^{18}$O data we use here\ndo not account for geographic variability in\ntemperature.\nFurthermore, we have not controlled for any potential confounders, such as range size or\nproportion of range overlap with humans.\nNevertheless, our analysis serves as a precaution against oversimplification\nin the search for explanations of megafaunal population decline and extinctions.\nIncorporating additional covariate data into future studies may reveal a more complete, nuanced story of large mammal population dynamics during the\nLate Quaternary period.\n\n\n\n\n\n\n\n\\section{Discussion}\n\nWe present a novel coalescent-based Bayesian framework for estimation of effective population\nsize dynamics from molecular sequence data and external covariates.  We achieve this\nby extending the popular Skygrid model to incorporate covariates.  In doing so, we retain\nthe key elements of the Skygrid: a flexible, nonparametric demographic model, smoothing\nof the trajectory via a GMRF prior, and accommodation of sequence data from multiple\ngenetic loci.\n\\par\nEffective population size is of fundamental interest in population genetics, infectious\ndisease epidemiology, and conservation biology.  It is crucial to identify explanatory factors,\nand to achieve a greater understanding of the association between the effective population size and\nsuch factors.  In the context of viruses, it is important to assess the relationship\nbetween effective population size and epidemiological dynamics characterizing the number\nof infections and the spatiotemporal spread of an outbreak.  Our extended Skygrid framework\nenables formal testing and characterization of such associations.\n\\par\nWe showcase our methodology in four examples.\n\n\n\nOur analysis of the raccoon rabies epidemic in the northeastern United States uncovers striking similarities\nbetween the viral demographic expansion and the amount of area affected by the outbreak.\nWe reconstruct a cyclic pattern for the effective population size of DENV-4 in Puerto Rico,\ncoinciding with trends in viral isolate count data.  Comparing the population history of the HIV-1\nCRF02\\_AG clade in Cameroon with HIV incidence and prevalence data reveals a greater alignment\nwith the HIV incidence rate than the prevalence rate.  Finally, we consider the role of climate change\nin ancient musk ox population dynamics by using oxygen isotope data from the GRIP ice core as a proxy\nfor temperature.  We do not find a significant association, but our analysis demonstrates the need\nfor a more thorough examination with additional covariates to follow up on previous investigations\nof the causes of ancient megafaunal population dynamics that consider a number of different factors.\n\\par\nSimultaneous inference of the effective population size and its association with covariates enables\nthe uncertainty of the effective population size to be taken into account when assessing the\nassociation.  Post hoc analyses comparing the mean effective population size trajectory with\ncovariates (employing a standard linear regression approach, for example) are possible.  However,\nsuch approaches may erroneously rule out significant associations by overemphasizing incompatibilities\nbetween the covariates and mean population trajectory.  Furthermore, in the case of\nsignificant associations, regression coefficient estimates that disregard demographic uncertainty may have\ninflated precision.\n\\par\nIntegrating covariates into the demographic inference framework not only enables testing and\nquantification of associations with the effective population size, it also\nprovides additional information about past population dynamics.  In two of our four\nexamples, effective population size trajectories inferred from both sequence and covariate data\ndiffer markedly from trajectories inferred only from sequence data.  In the rabies and dengue\nexamples, the estimates based on sequence and covariate data are essentially consistent with\nwith the estimates from the sequence data (in terms of the former having BCI regions almost entirely\ncontained in the BCI regions of the latter), but more precise and more reflective of covariate trends.\n\n\n\n\\par\nOur extension of the Skygrid represents a first step toward a more complete understanding of\npast population dynamics, and the utility of the approach as demonstrated in the real data examples\nis promising.  Our examples have only involved one or two covariates, but our implementation\ncan support a large number of predictors.  \nFurthermore, we plan to equip the Skygrid with efficient variable\nselection procedures to identify optimal subsets of predictors\n\\citep{George1993, Kuo1998, Chipman2001}.  \n\n\nThere is considerable potential for further development.  For example, there is a prominent\ncorrespondence between spatial distribution and genetic diversity in the raccoon rabies example,\nand in previous studies of megafauna species \\citep{Lorenzen2011}.  We envision combining\nthe Skygrid with phylogeographic inference models \\citep{bloomquist2010three} to simultaneously\ninfer the wave-front of a population from sampling location data and use the wave-front as a predictor to model\nthe effective population size. \nAttempts to infer associations between covariates and effective population size dynamics can be hampered\nby a scarcity of covariate data. Fortunately, there may exist measurements of the same covariates\ncorresponding to different, but similar, genetic sequence data sets.\nWe may, for example, have\ndrug treatment data corresponding to several different HIV patients and wish to assess the\nrelationship between the drug and intrahost HIV evolution.  In such a setting, Bayesian\nhierarchical modeling could enable pooling of information from multiple data sets.\n\n\n\n\n\\section*{Acknowledgments}\n\nThe research leading to these results has received funding from the European Research Council \nunder the European Community's Seventh Framework Programme (FP7/2007-2013) under \nGrant Agreement no.~278433-PREDEMICS and ERC Grant agreement no.~260864 and the \nNational Institutes of Health (R01 AI107034, R01 HG006139, R01 LM011827 and 5T32AI007370-24) and the \nNational Science Foundation (DMS 1264153).\nR.B. was supported by NIH grant RO1 AI047498 and the RAPIDD programme of the Science and \nTechnology Directorate of the Department of Homeland Security and NIH Fogarty International Centre.\n\n\n\n\n\n\n\\clearpage\n\n \n\\bibliographystyle{sysbio}\n\n\\bibliography{list_of_references3}\n\n\n", "itemtype": "equation", "pos": 33638, "prevtext": "\n\n\nwhere $\\mbox{Diag}(\\cdot)$ is a diagonal matrix.\n\\par\nStarting from current parameter values $(\\boldsymbol \\gamma^{(n)}, \\tau^{(n)})$,\nwe first generate a candidate value for the\nprecision, $\\tau^* = \\tau^{(n)} f$, where $f$ is drawn from a symmetric proposal distribution with density\n$P(f) \\propto f + \\frac{1}{f}$ defined on $[1/F,F]$.  The tuning constant $F$ controls the distance\nbetween the proposed and current values of the precision.  Next, conditional on $\\tau^*$, we propose\na new state $\\boldsymbol{\\gamma}^*$ using the Gaussian approximation (\\ref{eq:mult}) to the full conditional density\n$P(\\gamma|\\textbf g, \\textbf Z, \\boldsymbol \\beta, \\tau^*)$.\nIn the final step, the candidate state $(\\tau^*,\\boldsymbol \\gamma^*)$ is accepted or rejected according\nto the Metropolis-Hastings ratio \\citep{Metropolis1953, Hastings1970}.\n\n\n\\subsection{Genealogical Uncertainty}\n\\par\nIn our development thus far, we have assumed the genealogies $g_1,\\dots,g_m$ are known and fixed.  However,\nin reality we observe sequence data rather than genealogies.  It is possible to estimate genealogies\nbeforehand from sequence data and then infer the effective population size from fixed genealogies.\nHowever, this ignores the uncertainty associated with phylogenetic reconstruction.  Alternatively,\nwe can jointly infer genealogies and population dynamics from sequence data by combining\nthe estimation procedures into a single Bayesian framework.\n\\par\nWe can think of the aligned sequence data\n$\\textbf Y = (Y_1,\\dots,Y_m)$ for the $m$ loci as arising from continuous-time Markov chain (CTMC) models for molecular character\nsubstitution that act along the hidden genealogies.  Each CTMC depends on a vector of\nmutational parameters $\\Lambda_i$, that include, for example, an overall rate multiplier, relative exchange\nrates among characters and across-site variation specifications.  We let\n$\\boldsymbol \\Lambda = (\\Lambda_1,\\dots,\\Lambda_m)$.\nWe then jointly estimate the genealogies, mutational parameters, precision,\nand vector of effective population sizes through their posterior distribution\n\n", "index": 47, "text": "\\begin{equation}\nP(\\textbf g,\\boldsymbol \\Lambda,\\tau,\\boldsymbol \\gamma | \\textbf Y) \\propto\n\\left[\n\\prod_{i=1}^{m} P(Y_i|g_i,\\Lambda_i)\n\\right]\nP(\\boldsymbol \\Lambda)P(\\textbf g| \\boldsymbol \\gamma)P(\\boldsymbol \\gamma|\\tau)P(\\tau)   .\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E24.m1\" class=\"ltx_Math\" alttext=\"P(\\textbf{g},\\bm{\\Lambda},\\tau,\\bm{\\gamma}|\\textbf{Y})\\propto\\left[\\prod_{i=1}%&#10;^{m}P(Y_{i}|g_{i},\\Lambda_{i})\\right]P(\\bm{\\Lambda})P(\\textbf{g}|\\bm{\\gamma})P%&#10;(\\bm{\\gamma}|\\tau)P(\\tau).\" display=\"block\"><mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mtext>\ud835\udc20</mtext><mo>,</mo><mi>\ud835\udeb2</mi><mo>,</mo><mi>\u03c4</mi><mo>,</mo><mi>\ud835\udf38</mi><mo stretchy=\"false\">|</mo><mtext>\ud835\udc18</mtext><mo stretchy=\"false\">)</mo></mrow><mo>\u221d</mo><mrow><mo>[</mo><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u220f</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo stretchy=\"false\">|</mo><msub><mi>g</mi><mi>i</mi></msub><mo>,</mo><msub><mi mathvariant=\"normal\">\u039b</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udeb2</mi><mo stretchy=\"false\">)</mo></mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mtext>\ud835\udc20</mtext><mo stretchy=\"false\">|</mo><mi>\ud835\udf38</mi><mo stretchy=\"false\">)</mo></mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udf38</mi><mo stretchy=\"false\">|</mo><mi>\u03c4</mi><mo stretchy=\"false\">)</mo></mrow><mi>P</mi><mrow><mo stretchy=\"false\">(</mo><mi>\u03c4</mi><mo stretchy=\"false\">)</mo></mrow><mo>.</mo></mrow></math>", "type": "latex"}]