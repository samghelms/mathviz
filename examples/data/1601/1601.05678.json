[{"file": "1601.05678.tex", "nexttext": "\nwhich usually involves two conflicting objectives. In the above model,\n the leader selects first a vector $x$, \n taking the follower's reaction $y$ into account. In our model, the electricity supplier sets\n  the prices and anticipates an optimal response from the follower. In most situations (this is the case in this paper),\n the lower level problem is convex, for given $x$, and can thus be characterized by its optimality conditions. \n If the solution to the lower level problem is not unique, i.e., the follower is indifferent to two solutions,\n we assume that the one  most favorable to the leader is implemented. This is referred to as the `optimistic'\napproach in the literature, and is justified by the fact that the solution can be made unique through\n an arbitrarily small deviation from the optimal optimistic solution. More details on this model, as well\n as the `pessimistic' (one could say `conservative') alternative, are provided in~\\cite{DMZ14, DKK06}.\n\n\\subsection{Monopoly Pricing}\n\nLet us consider a monopolistic electricity supplier, together with a group of \ncustomers. Once the price decision of the leader has been set, \nthe smart grid automatically schedules the customer's appliances,\nin compliance with the desires of the customer, i.e., it maximizes\ntheir individual utilities.\n\nAt the upper level, the leader strives for a trade-off between revenue and peak load by maximizing\nthe sum of revenue minus a penalty associated with peak consumption. This is achieved by a direct control\nof prices $p^h$, one for each time slot $h \\in {\\mathit{H}}$, and indirect control of the\npeak load $\\Gamma$, which results from the lower level solution. \n\nAt the lower level, the objective function involves two terms, namely \\textit{electricity bill} (EB) and \\textit{inconvenience cost} (IC). For a given price vector set by the leader, each individual customer minimizes weighted sum of EB and IC, which clearly conflicts with the leader's objective. \nTo maximize its utility, customer $n$ selects a power level\n$x_{n,a}^h$ for each appliance $a \\in {\\mathit{A_n}}$ in each time slot $h \\in {\\mathit{T_{n,a}}}$. The variable $x_{n,a}^h$ is continuous, which corresponds to preemptive jobs, and is bounded by $\\beta_{n,a}^{\\max}$, the power\nlimit of that device. Demand $E_{n,a}$ and time window ${\\mathit{T_{n,a}}} = [TW^b_{n,a},TW^e_{n,a}]$ of customer $n \\in {\\mathit{N}}$ for\nappliance $a \\in {\\mathit{A_n}}$ is known and announced by the customer one day ahead. \n\nThroughout the paper, it is assumed that the initial time slot of a time \nwindow is the preferred one, and that a job cannot be performed outside its window, i.e., $x_{n,a}^h$ is defined only for $h \\in {\\mathit{T_{n,a}}}$. Whenever a job is postponed within its window, a penalty that is proportional to \nthe length of the delay, and inversely proportional to the width of the desired time window, is incurred. The latter assumption reflects the fact that customers that specify narrow time windows are likely to be sensitive\nto the delaying of their tasks by the smart grid. More precisely, let $\\lambda_n$ denote the inconvenience coefficient of a customer $n$, where a high value of $\\lambda_n$ is related to a low tolerance to delay. The inconvenience cost of a job $C_{n,a}(h)$ is defined as\n\n\n", "itemtype": "equation", "pos": 11112, "prevtext": "\n\n\\begin{frontmatter}\n\\title{Achieving an optimal trade-off between revenue and energy peak within a smart grid environment}\n\\author[a1]{Sezin Af\\c{s}ar\\corref{cor1}}\n\\ead{sezin.afsar@inria.fr}\n\\author[a1]{Luce Brotcorne}\n\\ead{luce.brotcorne@inria.fr}\n\\author[b]{Patrice Marcotte}\n\\ead{marcotte@iro.umontreal.ca}\n\\author[c]{Gilles Savard}\n\\ead{gilles.savard@polymtl.ca}\n\\address[a1]{Inria Lille-Nord Europe, Team Dolphin, 40 Avenue Halley 59650 Villeneuve d'Ascq, France}\n\\address[b]{DIRO, Universit\\'{e} de Montr\\'{e}al, C.P. 6128, Succursale Centre-Ville, Montr\\'{e}al (QC) H3C 3J7, Canada}\n\\address[c]{D\\'{e}partement de Math\\'{e}matique et G\\'{e}nie Industriel, \\'{E}cole Polytechnique, C.P. 6079, Succursale Centre-Ville, Montr\\'{e}al (QC) H3C 3A7, Canada}\n\\cortext[cor1]{Corresponding author. Tel: +33 59358628}\n\n\\begin{abstract}\nIn this paper, we consider an energy provider whose goal is to simultaneously set revenue-maximizing prices and meet a peak load constraint. The problem is cast within a bilevel setting where the provider acts as a leader (upper level) that takes into account a smart grid (lower level) that minimizes the sum of users' disutilities. The latter bases its\nactions on the hourly prices set by the leader, as well as the preference schedules set by the users for each task. We consider both the monopolistic and competitive situations, and validate numerically the potential of this\napproach to achieve an `optimal' trade-off between three conflicting objectives: revenue, user cost and peak demand.\n\\end{abstract}\n\n\\begin{keyword}\ndemand response, smart grid, day-ahead pricing, demand \nside management, bilevel programming, peak minimization\n\\end{keyword}\n\n\\end{frontmatter}\n\n\\section{Introduction}\nDespite technological advancements that have allowed an increase in energy production, both traditional and green, together with a decrease of consumption in the residential and transportation markets, demand for energy is due to grow at a fast pace in the near future, putting at stress the production and distribution system, as well as the supply-demand balance. Instabilities, that trigger a chain of adverse effects for all energy users, can be mitigated by either investing to maintain a large capacity, at a high cost, or by implementing \\textit{demand side management} (DSM) programs that, through controls at the customer level, make the best use of the current capacity \\cite{M04,W14}. In short, DSM can be characterized by a set of tools for shaping the load curve, through peak clipping, valley filling, load shifting, strategic conservation, strategic load growth and flexible load shape \\cite{G85}. In order to achieve these objectives, several programs have been put in place, such as conservation and energy efficiency programs, fuel substitution, demand response, and residential or commercial load management~\\cite{M04,PD11,LMDB12}. In particular, the problem that consists of adjusting the load curve by taking explicitly into account customer reaction to prices has been addressed in several articles, such as in~\\cite{MRLG10}, where residential load control through real-time\npricing has been considered. Actually, real-time pricing is frequently referred to\nby economists as the most direct and efficient demand response program~\\cite{B05, AE08, SMS15}. \nFor a thorough literature review concerning dynamic pricing, as well as analyses of real cases, the\ninterested reader is referred to~\\cite{BJR02}. \n\nIn the present paper, we focus on peak load minimization through \\textit{load shifting}. The importance of the issue\ncan be illustrated by the example of the United Kingdom, where the minimum load during summer nights is around \n30\\% of the winter peak, while the average load is around 55\\% of the installed generation capacity \\cite{S08}, emphasizing large\nfluctuations in the load curve, with close to half the generation capacity being idle for long periods of time. One foresees that the importance of load shifting will become even more apparent when the market share of plug-in cars (fully electric or hybrid) becomes significant. On average, PHEVs (plug-in electric vehicle) can be driven for 5 miles per kWh \\cite{WZ11} and hence, their intensive use may double the average residential electric load \\cite{MRWJSLG10}, thus putting the network at risk. \n\nIn many countries, base load is produced by coal or nuclear power plants whereas peak load is provided by natural gas, hydro or renewable power. For this reason, electricity production during peak periods is more costly than in\nthe off-peak. Besides, installed production capacity has to be larger than peak load in order to ensure power supply. Since a reduction in peak load induces a decrease of production and capacity cost, it deserves to be analyzed properly. \n\nThe specific issue that this paper addresses is Energy Peak Minimization (EPMP). It involves two decision levels: an energy provider and its customers. These two levels have conflicting objectives. The energy provider is interested in maximizing its revenue, whereas customers try to minimize their total disutility. While many articles have formulated the problem as a Nash game~\\cite{MRWJSLG10,WO02,OW99,HMP00,IGCG10}, the relationship between a company and its customers better fits the leader-follower framework. More precisely, our aim is to integrate demand response explicitly into the decision making process of the energy provider. To this end, we propose a bilevel programming approach. In this setting, the \\textit{leader} integrates within its decision process the reaction of the \\textit{follower}. Once the leader sets his variables, the follower solves an optimization problem, taking the leader's decisions as given. Bilevel programming has been used to tackle several problems including, but \nnot limited to, toll pricing~\\cite{LMS98,BLMS01}, freight tariff setting~\\cite{BLMS00,CLV13}, network design and pricing \\cite{BCMS11,M86,BLMS08,BMS08}, electric utility planning~\\cite{HN92,BJ05}. One should keep in mind that bilevel \nprograms are intrinsically difficult (NP-hard) \\cite{J85,HJS92}. Besides their nonconvex and combinatorial nature, the feasible region of the leader is generally nonconvex, and can be disconnected or empty~\\cite{CMS05}. In the context of EPMP, bilevel programming allows to integrate DSM techniques and demand response within the optimization process of an energy provider.\n\nThe contribution of this paper is twofold. First, we develop a bilevel model for peak minimization of an energy provider, with the aim to achieve an optimal trade-off between revenue and peak power consumption without delaying demand for electricity arbitrarily. The model uses day-ahead real-time pricing and is solved for a global optimum.\nWe also propose a variant of the model that involves competing providers. Next, we analyze the relationship between the energy provider and its customers, where the latter are inter-connected via smart metering devices (automatic energy consumption scheduler \\cite{MRWJSLG10}). In this environment, the customers not only share an energy source, but also communicate with each other via the network of smart meters which forms the smart grid. A detailed survey of smart grid and the associated enabling technologies are provided in \\cite{FMXY12}. In the absence of such technology, it would be difficult for customers to keep track of hourly prices and shift their demand accordingly, \nas well as for the provider to observe the actual demand response to its pricing strategy. Smart meters enable two-way information flow and constitute an important feature of the system, allowing the application of DSM techniques. While it can be argued that metering is more expensive and may be difficult to manage for residential customers, yet it significantly decreases meter reading costs, besides assisting different pricing strategies, and improved technology provides ever easier meter management \\cite{JW12}. Moreover, the smart grid system allows aggregation of residential customers with similar needs and different preferences. Since customers can act as a large client aiming at system optimum, their bargaining power is vastly increased. A survey on demand response and smart grids can be found in~\\cite{S14}. \n\nThe paper is organized as follows. The next section presents the modelling framework. It is followed by experimental results involving different parameters and instances, and a conclusion that points out \nchallenges related to this field of research.\n\\begin{figure}[t]\n\\centering\n\\includegraphics[page=11,scale=0.33]{graphics.pdf}\n\\caption{Residential electricity use in the USA, 2011 \\cite{Report12}}\n\\label{fig:eluse}\n\\end{figure}\n\n\\section{The bilevel models}\nLet us consider a power sharing system involving \na set of customers denoted by $N$, each one equipped with a smart metering device. Each customer $n$ operates a set\n$A_n$ of electric residential appliances, such as air conditioners, radiators, washers, driers,\nrefrigerators, freezers, pool heaters, etc. The appliances can be turned on and off at any time, and their power can be adjusted at any desired level. In the United States, 45\\% of household appliance consumption belongs to that category of preemptive devices (see Fig. \\ref{fig:eluse}), and it follows that their intelligent control may yield a significant decrease in peak consumption.\n\nFor the sake of this study, we adopt a 24-hour planning horizon $H$. Each customer $n$ is characterized by \nits daily demands $E_{n,a}$, as well as time windows ${\\mathit{T_{n,a}}}$ transmitted to the smart meter, one per appliance\n $a\\in A_n$. The set of such devices\nretrieves and transmits data, and thus forms the smart grid. The grid is connected to a power source and receives hourly prices from the electricity supplier, 24 hours in advance. It allows customers to benefit from cooperation. While users are expected to have similar needs with respect to power consumption and task scheduling, some of them might yet be more reluctant to postpone their loads, whereas others are willing to switch to cheaper time slots. Such behavior differences enter the model and are taken into account by the energy provider. Precisely, the population heterogeneity with respect to price perception is captured by an \\textit{inconvenience factor} specific to each customer. \n\nWe emphasize the importance of the smart grid as a middle agent\nthat takes charge of scheduling, since one may not expect\nthe customers to monitor prices in real time, and to optimally schedule their appliances \naccordingly.\n\n\\begin{figure}[t]\n\\centering\n\\includegraphics[scale=1]{smart.pdf}\n\\caption{Bilevel structure}\n\\label{fig:bil}\n\\end{figure}\n\nIn our \\textit{day-ahead pricing} model, the leader applies\nDSM to control and smooth out the load curve.\nTo tackle EPMP, two scenarios are considered: monopolistic and competitive pricing, and these will be detailed in the next two subsections. Both of them fit the bilevel paradigm, which is ideally suited at modelling game-theoretic situations\ninvolving hierarchical players and takes the mathematical form:\n\n\n", "index": 1, "text": "\\begin{equation*}\n\\begin{split}\n\\max_{x \\in X} & \\quad f(x,y) \\\\\n \\text{s.t. } & \\quad y\\in \\arg \\min_{y^\\prime \\in Y(x)} g(x,y^\\prime),\n\\end{split}\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"\\begin{split}\\displaystyle\\max_{x\\in X}&amp;\\displaystyle\\quad f(x,y)\\\\&#10;\\displaystyle\\text{s.t. }&amp;\\displaystyle\\quad y\\in\\arg\\min_{y^{\\prime}\\in Y(x)}%&#10;g(x,y^{\\prime}),\\end{split}\" display=\"block\"><mtable columnspacing=\"0pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"right\"><munder><mi>max</mi><mrow><mi>x</mi><mo>\u2208</mo><mi>X</mi></mrow></munder></mtd><mtd columnalign=\"left\"><mrow><mpadded lspace=\"10pt\" width=\"+10pt\"><mi>f</mi></mpadded><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mtext>s.t.\u00a0</mtext></mtd><mtd columnalign=\"left\"><mrow><mrow><mpadded lspace=\"10pt\" width=\"+10pt\"><mi>y</mi></mpadded><mo>\u2208</mo><mrow><mrow><mi>arg</mi><mo>\u2061</mo><mrow><munder><mi>min</mi><mrow><msup><mi>y</mi><mo>\u2032</mo></msup><mo>\u2208</mo><mrow><mi>Y</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></munder><mo>\u2061</mo><mi>g</mi></mrow></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><msup><mi>y</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>,</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.05678.tex", "nexttext": "\n\nThe bilevel mathematical model of EPMP under monopolistic pricing is then expressed as:\n\n\n", "itemtype": "equation", "pos": 14561, "prevtext": "\nwhich usually involves two conflicting objectives. In the above model,\n the leader selects first a vector $x$, \n taking the follower's reaction $y$ into account. In our model, the electricity supplier sets\n  the prices and anticipates an optimal response from the follower. In most situations (this is the case in this paper),\n the lower level problem is convex, for given $x$, and can thus be characterized by its optimality conditions. \n If the solution to the lower level problem is not unique, i.e., the follower is indifferent to two solutions,\n we assume that the one  most favorable to the leader is implemented. This is referred to as the `optimistic'\napproach in the literature, and is justified by the fact that the solution can be made unique through\n an arbitrarily small deviation from the optimal optimistic solution. More details on this model, as well\n as the `pessimistic' (one could say `conservative') alternative, are provided in~\\cite{DMZ14, DKK06}.\n\n\\subsection{Monopoly Pricing}\n\nLet us consider a monopolistic electricity supplier, together with a group of \ncustomers. Once the price decision of the leader has been set, \nthe smart grid automatically schedules the customer's appliances,\nin compliance with the desires of the customer, i.e., it maximizes\ntheir individual utilities.\n\nAt the upper level, the leader strives for a trade-off between revenue and peak load by maximizing\nthe sum of revenue minus a penalty associated with peak consumption. This is achieved by a direct control\nof prices $p^h$, one for each time slot $h \\in {\\mathit{H}}$, and indirect control of the\npeak load $\\Gamma$, which results from the lower level solution. \n\nAt the lower level, the objective function involves two terms, namely \\textit{electricity bill} (EB) and \\textit{inconvenience cost} (IC). For a given price vector set by the leader, each individual customer minimizes weighted sum of EB and IC, which clearly conflicts with the leader's objective. \nTo maximize its utility, customer $n$ selects a power level\n$x_{n,a}^h$ for each appliance $a \\in {\\mathit{A_n}}$ in each time slot $h \\in {\\mathit{T_{n,a}}}$. The variable $x_{n,a}^h$ is continuous, which corresponds to preemptive jobs, and is bounded by $\\beta_{n,a}^{\\max}$, the power\nlimit of that device. Demand $E_{n,a}$ and time window ${\\mathit{T_{n,a}}} = [TW^b_{n,a},TW^e_{n,a}]$ of customer $n \\in {\\mathit{N}}$ for\nappliance $a \\in {\\mathit{A_n}}$ is known and announced by the customer one day ahead. \n\nThroughout the paper, it is assumed that the initial time slot of a time \nwindow is the preferred one, and that a job cannot be performed outside its window, i.e., $x_{n,a}^h$ is defined only for $h \\in {\\mathit{T_{n,a}}}$. Whenever a job is postponed within its window, a penalty that is proportional to \nthe length of the delay, and inversely proportional to the width of the desired time window, is incurred. The latter assumption reflects the fact that customers that specify narrow time windows are likely to be sensitive\nto the delaying of their tasks by the smart grid. More precisely, let $\\lambda_n$ denote the inconvenience coefficient of a customer $n$, where a high value of $\\lambda_n$ is related to a low tolerance to delay. The inconvenience cost of a job $C_{n,a}(h)$ is defined as\n\n\n", "index": 3, "text": "\\begin{align*}\nC_{n,a}(h) := \\lambda_{n} \\times E_{n,a} \\times& \\frac{h-TW^b_{n,a}}{TW^e_{n,a} - TW^b_{n,a}} \n&\\qquad\\forall n\\in {\\mathit{N}}, \\forall a\\in {\\mathit{A_n}}, \\forall h\\in {\\mathit{T_{n,a}}}.\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle C_{n,a}(h):=\\lambda_{n}\\times E_{n,a}\\times\" display=\"inline\"><mrow><msub><mi>C</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub><mrow><mo stretchy=\"false\">(</mo><mi>h</mi><mo stretchy=\"false\">)</mo></mrow><mo>:=</mo><msub><mi>\u03bb</mi><mi>n</mi></msub><mo>\u00d7</mo><msub><mi>E</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub><mo>\u00d7</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\frac{h-TW^{b}_{n,a}}{TW^{e}_{n,a}-TW^{b}_{n,a}}\" display=\"inline\"><mstyle displaystyle=\"true\"><mfrac><mrow><mi>h</mi><mo>-</mo><mrow><mi>T</mi><mo>\u2062</mo><msubsup><mi>W</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>b</mi></msubsup></mrow></mrow><mrow><mrow><mi>T</mi><mo>\u2062</mo><msubsup><mi>W</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>e</mi></msubsup></mrow><mo>-</mo><mrow><mi>T</mi><mo>\u2062</mo><msubsup><mi>W</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>b</mi></msubsup></mrow></mrow></mfrac></mstyle></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle\\qquad\\forall n\\in{\\mathit{N}},\\forall a\\in{\\mathit{A_{n}}},%&#10;\\forall h\\in{\\mathit{T_{n,a}}}.\" display=\"inline\"><mrow><mrow><mrow><mrow><mi>\u2003\u2003</mi><mo>\u2062</mo><mrow><mo>\u2200</mo><mi>n</mi></mrow></mrow><mo>\u2208</mo><mi>N</mi></mrow><mo>,</mo><mrow><mrow><mrow><mo>\u2200</mo><mi>a</mi></mrow><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow><mo>,</mo><mrow><mrow><mo>\u2200</mo><mi>h</mi></mrow><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05678.tex", "nexttext": "\nwhere the `arg min' operator has been replaced by the expression of the lower level program, to simplify the exposition.\n\nAt the upper level of the above program, Constraint~(\\ref{up1}) forces the variable $\\Gamma$\nto exceed the load in each time slot. Since it is in the interest of the leader\nto minimize peak cost, $\\Gamma$ should match the maximum load. \nConstraint~(\\ref{up2}) sets an upper bound on the prices, and might result\nfrom government regulation or market conditions. Constraint~(\\ref{low1}) is a technical constraint that limits \nthe maximum amount of power that an appliance may consume. For instance, an air conditioner can be used at most at $30^{o}$C for heating and $\\beta_{n,a}^{\\max}$ represents its power consumption at this level. Demand satisfaction is ensured by Constraint~(\\ref{low2}).\n\nAll customers being residential users, it is natural to assume that prices only depend on time slot $h$. Note that if price discrimination were allowed, then the leader's problem would be made much easier from the computational point of view, since it would become user-separable. Unfortunately, in our model, significant modifications of the schedule may arise from a single price change, even for a single slot, thus making the problem non-trivial.\n\nModel MP is a bilinear bilevel model involving continuous variables. Once the leader fixes his decision variables, the lower level objective function becomes linear, and is thus amenable to the classical reformulation as a single level mixed integer program (MIP) proposed by Labb\\'{e} et al.~\\cite{LMS98} for a network pricing problem. In this approach, the lower level's optimality conditions (primal feasibility, dual feasibility, complementary slackness) are linearized and appended to the upper level to yield an equivalent MIP formulation. In other words, the follower's mathematical program is replaced by a set of constraints that ensures the optimality of the lower level for given upper level variables. The dual and primal constraints of the follower define the feasible region of the follower, while complementary slackness constraints ensure optimality. The dual variables corresponding to constraints (\\ref{low1}) and (\\ref{low2}) are denoted as $w_{n,a}^h$ and $v_{n,a}$, respectively, where $w_{n,a}^h$ is defined only for $h\\in {\\mathit{T_{n,a}}}$. The dual constraint corresponding to $x_{n,a}^h$ is expressed as: \n\n\n", "itemtype": "equation", "pos": 14870, "prevtext": "\n\nThe bilevel mathematical model of EPMP under monopolistic pricing is then expressed as:\n\n\n", "index": 5, "text": "\\begin{align}\n\\text{(MP):}\\,\\,\\max_{p, \\Gamma} & \\displaystyle \\sum_{n\\in {\\mathit{N}}} \\sum_{a \\in {\\mathit{A_n}}} \\sum_{h\\in {\\mathit{T_{n,a}}}} p^h x_{n,a}^h - \\kappa \\Gamma&&   \\nonumber\\\\\n\\mbox{s.t. } & \\displaystyle \\Gamma \\geq \\sum_{\\substack{n \\in {\\mathit{N}}, a \\in {\\mathit{A_n}} \\\\ \\text{s.t. } h\\in{\\mathit{T_{n,a}}}}} x_{n,a}^h &&\\forall h \\in {\\mathit{H}} \\label{up1}\\\\\n& \\displaystyle 0 \\leq p^h \\leq p_{\\max}^h &&\\forall h \\in {\\mathit{H}} \\label{up2}\\\\\n\\min_{x} & \\displaystyle \\sum_{n\\in {\\mathit{N}}} \\sum_{a \\in {\\mathit{A_n}}} \\sum_{h\\in {\\mathit{T_{n,a}}}}(p^h + C_{n,a}(h)) x_{n,a}^h &&\\nonumber\\\\\n\\mbox{s.t. } & \\displaystyle 0 \\leq x_{n,a}^h \\leq \\beta_{n,a}^{\\max} &&\\forall {n\\in {\\mathit{N}}}, \\forall a\\in{\\mathit{A_n}}, \\forall h \\in {\\mathit{T_{n,a}}} \\label{low1} \\\\\n& \\displaystyle \\sum_{h \\in {\\mathit{T_{n,a}}}} x_{n,a}^h \\geq E_{n,a} &&\\forall {n\\in {\\mathit{N}}}, \\forall a\\in {\\mathit{A_n}}, \\label{low2}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\text{(MP):}\\,\\,\\max_{p,\\Gamma}\" display=\"inline\"><mrow><mpadded width=\"+3.4pt\"><mtext>(MP):</mtext></mpadded><mo>\u2062</mo><munder><mi>max</mi><mrow><mi>p</mi><mo>,</mo><mi mathvariant=\"normal\">\u0393</mi></mrow></munder></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\displaystyle\\sum_{n\\in{\\mathit{N}}}\\sum_{a\\in{\\mathit{A_{n}}}}%&#10;\\sum_{h\\in{\\mathit{T_{n,a}}}}p^{h}x_{n,a}^{h}-\\kappa\\Gamma\" display=\"inline\"><mrow><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>\u2208</mo><mi>N</mi></mrow></munder></mstyle><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>a</mi><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow></munder></mstyle><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>h</mi><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></munder></mstyle><mrow><msup><mi>p</mi><mi>h</mi></msup><mo>\u2062</mo><msubsup><mi>x</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow></mrow></mrow></mrow><mo>-</mo><mrow><mi>\u03ba</mi><mo>\u2062</mo><mi mathvariant=\"normal\">\u0393</mi></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\displaystyle\\Gamma\\geq\\sum_{\\begin{subarray}{c}n\\in{\\mathit{N}},%&#10;a\\in{\\mathit{A_{n}}}\\\\&#10;\\text{s.t. }h\\in{\\mathit{T_{n,a}}}\\end{subarray}}x_{n,a}^{h}\" display=\"inline\"><mrow><mi mathvariant=\"normal\">\u0393</mi><mo>\u2265</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mtable class=\"ltx_align_c\" rowspacing=\"0.0pt\"><mtr><mtd><mrow><mrow><mi>n</mi><mo>\u2208</mo><mi>N</mi></mrow><mo>,</mo><mrow><mi>a</mi><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mtext>s.t.\u00a0</mtext><mo>\u2062</mo><mi>h</mi></mrow><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></mtd></mtr></mtable></munder></mstyle><msubsup><mi>x</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle\\forall h\\in{\\mathit{H}}\" display=\"inline\"><mrow><mrow><mo>\u2200</mo><mi>h</mi></mrow><mo>\u2208</mo><mi>H</mi></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\displaystyle 0\\leq p^{h}\\leq p_{\\max}^{h}\" display=\"inline\"><mrow><mn>0</mn><mo>\u2264</mo><msup><mi>p</mi><mi>h</mi></msup><mo>\u2264</mo><msubsup><mi>p</mi><mi>max</mi><mi>h</mi></msubsup></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle\\forall h\\in{\\mathit{H}}\" display=\"inline\"><mrow><mrow><mo>\u2200</mo><mi>h</mi></mrow><mo>\u2208</mo><mi>H</mi></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\min_{x}\" display=\"inline\"><munder><mi>min</mi><mi>x</mi></munder></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\displaystyle\\sum_{n\\in{\\mathit{N}}}\\sum_{a\\in{\\mathit{A_{n}}}}%&#10;\\sum_{h\\in{\\mathit{T_{n,a}}}}(p^{h}+C_{n,a}(h))x_{n,a}^{h}\" display=\"inline\"><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>\u2208</mo><mi>N</mi></mrow></munder></mstyle><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>a</mi><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow></munder></mstyle><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>h</mi><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></munder></mstyle><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mi>p</mi><mi>h</mi></msup><mo>+</mo><mrow><msub><mi>C</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>h</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msubsup><mi>x</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\displaystyle 0\\leq x_{n,a}^{h}\\leq\\beta_{n,a}^{\\max}\" display=\"inline\"><mrow><mn>0</mn><mo>\u2264</mo><msubsup><mi>x</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup><mo>\u2264</mo><msubsup><mi>\u03b2</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>max</mi></msubsup></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle\\forall{n\\in{\\mathit{N}}},\\forall a\\in{\\mathit{A_{n}}},\\forall h%&#10;\\in{\\mathit{T_{n,a}}}\" display=\"inline\"><mrow><mrow><mrow><mo>\u2200</mo><mi>n</mi></mrow><mo>\u2208</mo><mi>N</mi></mrow><mo>,</mo><mrow><mrow><mrow><mo>\u2200</mo><mi>a</mi></mrow><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow><mo>,</mo><mrow><mrow><mo>\u2200</mo><mi>h</mi></mrow><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\displaystyle\\sum_{h\\in{\\mathit{T_{n,a}}}}x_{n,a}^{h}\\geq E_{n,a}\" display=\"inline\"><mrow><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>h</mi><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></munder></mstyle><msubsup><mi>x</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow><mo>\u2265</mo><msub><mi>E</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle\\forall{n\\in{\\mathit{N}}},\\forall a\\in{\\mathit{A_{n}}},\" display=\"inline\"><mrow><mrow><mrow><mrow><mo>\u2200</mo><mi>n</mi></mrow><mo>\u2208</mo><mi>N</mi></mrow><mo>,</mo><mrow><mrow><mo>\u2200</mo><mi>a</mi></mrow><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05678.tex", "nexttext": "\n\nComplementary slackness between $x_{n,a}^h$ and the dual constraint takes the form:\n \n\n", "itemtype": "equation", "pos": 18228, "prevtext": "\nwhere the `arg min' operator has been replaced by the expression of the lower level program, to simplify the exposition.\n\nAt the upper level of the above program, Constraint~(\\ref{up1}) forces the variable $\\Gamma$\nto exceed the load in each time slot. Since it is in the interest of the leader\nto minimize peak cost, $\\Gamma$ should match the maximum load. \nConstraint~(\\ref{up2}) sets an upper bound on the prices, and might result\nfrom government regulation or market conditions. Constraint~(\\ref{low1}) is a technical constraint that limits \nthe maximum amount of power that an appliance may consume. For instance, an air conditioner can be used at most at $30^{o}$C for heating and $\\beta_{n,a}^{\\max}$ represents its power consumption at this level. Demand satisfaction is ensured by Constraint~(\\ref{low2}).\n\nAll customers being residential users, it is natural to assume that prices only depend on time slot $h$. Note that if price discrimination were allowed, then the leader's problem would be made much easier from the computational point of view, since it would become user-separable. Unfortunately, in our model, significant modifications of the schedule may arise from a single price change, even for a single slot, thus making the problem non-trivial.\n\nModel MP is a bilinear bilevel model involving continuous variables. Once the leader fixes his decision variables, the lower level objective function becomes linear, and is thus amenable to the classical reformulation as a single level mixed integer program (MIP) proposed by Labb\\'{e} et al.~\\cite{LMS98} for a network pricing problem. In this approach, the lower level's optimality conditions (primal feasibility, dual feasibility, complementary slackness) are linearized and appended to the upper level to yield an equivalent MIP formulation. In other words, the follower's mathematical program is replaced by a set of constraints that ensures the optimality of the lower level for given upper level variables. The dual and primal constraints of the follower define the feasible region of the follower, while complementary slackness constraints ensure optimality. The dual variables corresponding to constraints (\\ref{low1}) and (\\ref{low2}) are denoted as $w_{n,a}^h$ and $v_{n,a}$, respectively, where $w_{n,a}^h$ is defined only for $h\\in {\\mathit{T_{n,a}}}$. The dual constraint corresponding to $x_{n,a}^h$ is expressed as: \n\n\n", "index": 7, "text": "\\begin{align*}\n-w_{n,a}^h + v_{n,a} - p^h \\leq C_{n,a}^h \\qquad\\forall n \\in{\\mathit{N}}, \\forall a\\in{\\mathit{A_n}}, \\forall h \\in {\\mathit{T_{n,a}}}.\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle-w_{n,a}^{h}+v_{n,a}-p^{h}\\leq C_{n,a}^{h}\\qquad\\forall n\\in{%&#10;\\mathit{N}},\\forall a\\in{\\mathit{A_{n}}},\\forall h\\in{\\mathit{T_{n,a}}}.\" display=\"inline\"><mrow><mrow><mrow><mrow><mrow><mrow><mo>-</mo><msubsup><mi>w</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow><mo>+</mo><msub><mi>v</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow><mo>-</mo><msup><mi>p</mi><mi>h</mi></msup></mrow><mo>\u2264</mo><msubsup><mi>C</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003\u2003</mo><mrow><mrow><mrow><mo>\u2200</mo><mi>n</mi></mrow><mo>\u2208</mo><mi>N</mi></mrow><mo>,</mo><mrow><mrow><mrow><mo>\u2200</mo><mi>a</mi></mrow><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow><mo>,</mo><mrow><mrow><mo>\u2200</mo><mi>h</mi></mrow><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05678.tex", "nexttext": "\nand can be linearized using the fact that either $x_{n,a}^h$ or $w_{n,a}^h - v_{n,a} + p^h + C_{n,a}^h$ must be zero. Therefore, by using a sufficient large number $M_1$ and a binary variable $\\psi_{n,a}^h$, one can replace the nonlinear constraint with linear ones ($\\forall n \\in{\\mathit{N}}, \\forall a\\in{\\mathit{A_n}}, \\forall h \\in {\\mathit{T_{n,a}}}$):\n\n\n", "itemtype": "equation", "pos": 18480, "prevtext": "\n\nComplementary slackness between $x_{n,a}^h$ and the dual constraint takes the form:\n \n\n", "index": 9, "text": "\\begin{align*}\nx_{n,a}^h(w_{n,a}^h - v_{n,a} + p^h + C_{n,a}^h)=0 \\qquad \\forall n \\in{\\mathit{N}}, \\forall a\\in{\\mathit{A_n}}, \\forall h \\in {\\mathit{T_{n,a}}}\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex6.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle x_{n,a}^{h}(w_{n,a}^{h}-v_{n,a}+p^{h}+C_{n,a}^{h})=0\\qquad%&#10;\\forall n\\in{\\mathit{N}},\\forall a\\in{\\mathit{A_{n}}},\\forall h\\in{\\mathit{T_{%&#10;n,a}}}\" display=\"inline\"><mrow><mrow><mrow><msubsup><mi>x</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><msubsup><mi>w</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup><mo>-</mo><msub><mi>v</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow><mo>+</mo><msup><mi>p</mi><mi>h</mi></msup><mo>+</mo><msubsup><mi>C</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003\u2003</mo><mrow><mrow><mrow><mo>\u2200</mo><mi>n</mi></mrow><mo>\u2208</mo><mi>N</mi></mrow><mo>,</mo><mrow><mrow><mrow><mo>\u2200</mo><mi>a</mi></mrow><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow><mo>,</mo><mrow><mrow><mo>\u2200</mo><mi>h</mi></mrow><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.05678.tex", "nexttext": "\n \nSimilarly, one linearizes the complementarity between dual variables and primal constraints yielding two groups of constraints. In the mixed integer linear formulation of MP, the follower's primal constraints are\ngiven by (\\ref{mip3}) and (\\ref{mip6}), while the dual constraint is expressed as~(\\ref{mip9}). \nUpon the introduction of binary variables $\\xi_{n,a}^t$, the linearized complementary slackness between Constraint (\\ref{mip3}) and $w_{n,a}^h$ corresponds to (\\ref{mip4}) and (\\ref{mip5}). Similarly, introducing variables $\\epsilon_{n,a}$,\nthe complementarity between Constraint (\\ref{mip6}) and $v_{n,a}$ becomes (\\ref{mip7}) and (\\ref{mip8}). Next,\nintroducing binary variable $\\psi_{n,a}^t$, the complementarity between Constraints (\\ref{mip9}) and $x_{n,a}^h$\nis expressed as (\\ref{mip10}) and (\\ref{mip11}). This yields, due to the presence of identical terms (the {\\it billing cost}) in the objective and the constraints, a linear expression for the leader's objective, and hence the mixed integer program\n\n{\n", "itemtype": "equation", "pos": 19014, "prevtext": "\nand can be linearized using the fact that either $x_{n,a}^h$ or $w_{n,a}^h - v_{n,a} + p^h + C_{n,a}^h$ must be zero. Therefore, by using a sufficient large number $M_1$ and a binary variable $\\psi_{n,a}^h$, one can replace the nonlinear constraint with linear ones ($\\forall n \\in{\\mathit{N}}, \\forall a\\in{\\mathit{A_n}}, \\forall h \\in {\\mathit{T_{n,a}}}$):\n\n\n", "index": 11, "text": "\\begin{align*}\nw_{n,a}^h - v_{n,a} + p^h + C_{n,a}^h &\\leq M_1 (1-\\psi_{n,a}^h) \\\\\nx_{n,a}^h &\\leq M_1 \\psi_{n,a}^h  \\\\\n\\psi_{n,a}^h &\\in \\{0,1\\} .\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex7.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle w_{n,a}^{h}-v_{n,a}+p^{h}+C_{n,a}^{h}\" display=\"inline\"><mrow><mrow><msubsup><mi>w</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup><mo>-</mo><msub><mi>v</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow><mo>+</mo><msup><mi>p</mi><mi>h</mi></msup><mo>+</mo><msubsup><mi>C</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex7.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\leq M_{1}(1-\\psi_{n,a}^{h})\" display=\"inline\"><mrow><mi/><mo>\u2264</mo><mrow><msub><mi>M</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>-</mo><msubsup><mi>\u03c8</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex8.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle x_{n,a}^{h}\" display=\"inline\"><msubsup><mi>x</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex8.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\leq M_{1}\\psi_{n,a}^{h}\" display=\"inline\"><mrow><mi/><mo>\u2264</mo><mrow><msub><mi>M</mi><mn>1</mn></msub><mo>\u2062</mo><msubsup><mi>\u03c8</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex9.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\psi_{n,a}^{h}\" display=\"inline\"><msubsup><mi>\u03c8</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex9.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\in\\{0,1\\}.\" display=\"inline\"><mrow><mrow><mi/><mo>\u2208</mo><mrow><mo stretchy=\"false\">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">}</mo></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05678.tex", "nexttext": "}\n\n\\subsection{Competitive pricing}\nNow, we turn our attention to a framework involving a competitor who declares its prices prior to the leader. The smart grid can now choose between two options for each time slot, that is, demand of each appliance can be either supplied by the leader, by the competitor or even by both of them. Therefore, the smart grid decides how much power will be supplied by the leader and the competitor in each time slot. It is important to emphasize that a customer does \\textit{not} choose a supplier for all of its demand, but rather the grid chooses the \\textit{total amount} of power to be purchased from each supplier.\n\nThe main concern about hour-to-hour selection of electricity supplier is payment calculation and collection. However, in a smart grid environment it is automatically calculated and billed. Therefore, several suppliers may offer prices and the most convenient one would be selected by the smart grid operator.\n\nIn the competitive pricing (CP) setting, the leader must address several issues. In addition to peak minimization and revenue maximization, as well as price ceiling constraints, market shares will only be preserved if its prices are competitive, which significantly reduces the leader's `degrees of freedom'.\n\nIn the following, we assume that competitor prices $\\bar{p}^h$ are fixed, and actually assume the values $p_{\\max}^h$, without loss of generality. If they were higher, then all customers would opt for the leader and the situation would be the same as in model MP. If they were lower, then $p_{\\max}^h$ would be irrelevant, and leader prices would be bounded by $\\bar{p}^h$. We also assume that the inconvenience factors are identical, whether electricity is supplied by the competitor or the leader. Finally, we make the conservative assumption that, whenever customers buy energy from the follower, they are automatically scheduled to their most preferred time slots.\n\nUpon the introduction of continuous variable $\\bar{x}_{n,a}^h$ to represent the amount of power purchased from the competitor, the bilevel program takes the form:\n\n\n", "itemtype": "equation", "pos": -1, "prevtext": "\n \nSimilarly, one linearizes the complementarity between dual variables and primal constraints yielding two groups of constraints. In the mixed integer linear formulation of MP, the follower's primal constraints are\ngiven by (\\ref{mip3}) and (\\ref{mip6}), while the dual constraint is expressed as~(\\ref{mip9}). \nUpon the introduction of binary variables $\\xi_{n,a}^t$, the linearized complementary slackness between Constraint (\\ref{mip3}) and $w_{n,a}^h$ corresponds to (\\ref{mip4}) and (\\ref{mip5}). Similarly, introducing variables $\\epsilon_{n,a}$,\nthe complementarity between Constraint (\\ref{mip6}) and $v_{n,a}$ becomes (\\ref{mip7}) and (\\ref{mip8}). Next,\nintroducing binary variable $\\psi_{n,a}^t$, the complementarity between Constraints (\\ref{mip9}) and $x_{n,a}^h$\nis expressed as (\\ref{mip10}) and (\\ref{mip11}). This yields, due to the presence of identical terms (the {\\it billing cost}) in the objective and the constraints, a linear expression for the leader's objective, and hence the mixed integer program\n\n{\n", "index": 13, "text": "\\begin{align}\n&\\max_{p,\\Gamma, x\\atop w,v,\\psi}-\\sum_{\\begin{subarray}{l} n \\in{\\mathit{N}} \\\\  a\\in{\\mathit{A_n}}\\\\ h \\in {\\mathit{T_{n,a}}} \\end{subarray}} \\beta_{n,a}^{\\max} w_{n,a}^h + \\sum_{\\begin{subarray}{l} n \\in{\\mathit{N}} \\\\ a\\in{\\mathit{A_n}} \\end{subarray}} E_{n,a} v_{n,a}-&&\\sum_{\\begin{subarray}{l} n \\in{\\mathit{N}} \\\\ a\\in{\\mathit{A_n}}\\\\ h \\in {\\mathit{T_{n,a}}} \\end{subarray}}C_{n,a}^h x_{n,a}^h - \\kappa\\Gamma \\label{mof}\\\\\n\\mbox{s.t.}&&& \\nonumber \\\\\n& \\displaystyle \\Gamma \\geq \\sum_{\\begin{subarray}{c}n,a \\\\\\text{s.t.} h\\in {\\mathit{T_{n,a}}} \\end{subarray}} x_{n,a}^h  &&\\forall h \\nonumber\\\\\n &\\displaystyle 0 \\leq p^h \\leq p_{\\max}^h  &&\\forall h \\in {\\mathit{H}} \\nonumber \\\\\n &\\displaystyle 0 \\leq x_{n,a}^h \\leq \\beta_{n,a}^{\\max}  &&\\forall n \\in{\\mathit{N}},  a\\in{\\mathit{A_n}},  h \\in {\\mathit{T_{n,a}}}  \\label{mip3} \\\\\n& \\displaystyle \\sum_{h\\in {\\mathit{T_{n,a}}}} x_{n,a}^h \\geq E_{n,a}  &&\\forall n \\in{\\mathit{N}}, a\\in{\\mathit{A_n}} \\label{mip6} \\\\\n& \\displaystyle -w_{n,a}^h + v_{n,a} - p^h \\leq C_{n,a}^h  &&\\forall n \\in{\\mathit{N}}, a\\in{\\mathit{A_n}},  h \\in {\\mathit{T_{n,a}}} \\label{mip9} \\\\\n& \\displaystyle -x_{n,a}^h + M_3 \\xi_{n,a}^h \\leq M_3 - \\beta_{n,a}^{\\max} &&\\forall n \\in{\\mathit{N}},  a\\in{\\mathit{A_n}},  h \\in {\\mathit{T_{n,a}}}  \\label{mip4} \\\\\n& \\displaystyle w_{n,a}^h - M_3 \\xi_{n,a}^h \\leq 0  && \\forall n \\in{\\mathit{N}},  a\\in{\\mathit{A_n}},  h \\in {\\mathit{T_{n,a}}} \\label{mip5} \\\\\n& \\displaystyle \\sum_{h\\in{\\mathit{T_{n,a}}}} x_{n,a}^h + M_2 \\epsilon_{n,a} \\leq M_2+ E_{n,a}  &&\\forall n \\in{\\mathit{N}},  a\\in{\\mathit{A_n}} \\label{mip7} \\\\\n& \\displaystyle v_{n,a} - M_2 \\epsilon_{n,a} \\leq 0  && \\forall n \\in{\\mathit{N}},  a\\in{\\mathit{A_n}} \\label{mip8} \\\\\n& \\displaystyle w_{n,a}^h - v_{n,a} + p^h + M_1 \\psi_{n,a}^h \\leq M_1 - C_{n,a}^h  &&\\forall n \\in{\\mathit{N}},  a\\in{\\mathit{A_n}}, \\forall h \\in {\\mathit{T_{n,a}}} \\label{mip10} \\\\\n& \\displaystyle x_{n,a}^h - M_1 \\psi_{n,a}^h \\leq 0  &&\\forall n \\in{\\mathit{N}},  a\\in{\\mathit{A_n}},  h \\in {\\mathit{T_{n,a}}} \\label{mip11} \\\\\n& \\displaystyle \\xi_{n,a}^h, \\psi_{n,a}^h \\in \\{0,1\\}; \\,\\, w_{n,a}^h \\geq 0  &&\\forall n \\in{\\mathit{N}}, a\\in{\\mathit{A_n}}, \\forall h \\in {\\mathit{T_{n,a}}} \\nonumber \\\\\n& \\displaystyle  \\epsilon_{n,a} \\in \\{0,1\\}; \\,\\, v_{n,a} \\geq 0  &&\\forall n \\in{\\mathit{N}},  a\\in{\\mathit{A_n}}. \\nonumber\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\max_{p,\\Gamma,x\\atop w,v,\\psi}-\\sum_{\\begin{subarray}{l}n\\in{%&#10;\\mathit{N}}\\\\&#10;a\\in{\\mathit{A_{n}}}\\\\&#10;h\\in{\\mathit{T_{n,a}}}\\end{subarray}}\\beta_{n,a}^{\\max}w_{n,a}^{h}+\\sum_{%&#10;\\begin{subarray}{l}n\\in{\\mathit{N}}\\\\&#10;a\\in{\\mathit{A_{n}}}\\end{subarray}}E_{n,a}v_{n,a}-\" display=\"inline\"><mrow><mrow><munder><mi>max</mi><mfrac linethickness=\"0pt\"><mrow><mi>p</mi><mo>,</mo><mi mathvariant=\"normal\">\u0393</mi><mo>,</mo><mi>x</mi></mrow><mrow><mi>w</mi><mo>,</mo><mi>v</mi><mo>,</mo><mi>\u03c8</mi></mrow></mfrac></munder><mo>-</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mtable class=\"ltx_align_l\" rowspacing=\"0.0pt\"><mtr><mtd><mrow><mi>n</mi><mo>\u2208</mo><mi>N</mi></mrow></mtd></mtr><mtr><mtd><mrow><mi>a</mi><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><mi>h</mi><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></mtd></mtr></mtable></munder></mstyle><mrow><msubsup><mi>\u03b2</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>max</mi></msubsup><mo>\u2062</mo><msubsup><mi>w</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow></mrow></mrow><mo>+</mo><mrow><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mtable class=\"ltx_align_l\" rowspacing=\"0.0pt\"><mtr><mtd><mrow><mi>n</mi><mo>\u2208</mo><mi>N</mi></mrow></mtd></mtr><mtr><mtd><mrow><mi>a</mi><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow></mtd></mtr></mtable></munder></mstyle><mrow><msub><mi>E</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub><mo>\u2062</mo><msub><mi>v</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></mrow><mo>-</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle\\sum_{\\begin{subarray}{l}n\\in{\\mathit{N}}\\\\&#10;a\\in{\\mathit{A_{n}}}\\\\&#10;h\\in{\\mathit{T_{n,a}}}\\end{subarray}}C_{n,a}^{h}x_{n,a}^{h}-\\kappa\\Gamma\" display=\"inline\"><mrow><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mtable class=\"ltx_align_l\" rowspacing=\"0.0pt\"><mtr><mtd><mrow><mi>n</mi><mo>\u2208</mo><mi>N</mi></mrow></mtd></mtr><mtr><mtd><mrow><mi>a</mi><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><mi>h</mi><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></mtd></mtr></mtable></munder></mstyle><mrow><msubsup><mi>C</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup><mo>\u2062</mo><msubsup><mi>x</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow></mrow><mo>-</mo><mrow><mi>\u03ba</mi><mo>\u2062</mo><mi mathvariant=\"normal\">\u0393</mi></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex11.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\displaystyle\\Gamma\\geq\\sum_{\\begin{subarray}{c}n,a\\\\&#10;\\text{s.t.}h\\in{\\mathit{T_{n,a}}}\\end{subarray}}x_{n,a}^{h}\" display=\"inline\"><mrow><mi mathvariant=\"normal\">\u0393</mi><mo>\u2265</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mtable class=\"ltx_align_c\" rowspacing=\"0.0pt\"><mtr><mtd><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mtext>s.t.</mtext><mo>\u2062</mo><mi>h</mi></mrow><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></mtd></mtr></mtable></munder></mstyle><msubsup><mi>x</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex11.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle\\forall h\" display=\"inline\"><mrow><mo>\u2200</mo><mi>h</mi></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex12.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\displaystyle 0\\leq p^{h}\\leq p_{\\max}^{h}\" display=\"inline\"><mrow><mn>0</mn><mo>\u2264</mo><msup><mi>p</mi><mi>h</mi></msup><mo>\u2264</mo><msubsup><mi>p</mi><mi>max</mi><mi>h</mi></msubsup></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex12.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle\\forall h\\in{\\mathit{H}}\" display=\"inline\"><mrow><mrow><mo>\u2200</mo><mi>h</mi></mrow><mo>\u2208</mo><mi>H</mi></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\displaystyle 0\\leq x_{n,a}^{h}\\leq\\beta_{n,a}^{\\max}\" display=\"inline\"><mrow><mn>0</mn><mo>\u2264</mo><msubsup><mi>x</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup><mo>\u2264</mo><msubsup><mi>\u03b2</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>max</mi></msubsup></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle\\forall n\\in{\\mathit{N}},a\\in{\\mathit{A_{n}}},h\\in{\\mathit{T_{n,a%&#10;}}}\" display=\"inline\"><mrow><mrow><mrow><mo>\u2200</mo><mi>n</mi></mrow><mo>\u2208</mo><mi>N</mi></mrow><mo>,</mo><mrow><mrow><mi>a</mi><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow><mo>,</mo><mrow><mi>h</mi><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\displaystyle\\sum_{h\\in{\\mathit{T_{n,a}}}}x_{n,a}^{h}\\geq E_{n,a}\" display=\"inline\"><mrow><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>h</mi><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></munder></mstyle><msubsup><mi>x</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow><mo>\u2265</mo><msub><mi>E</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle\\forall n\\in{\\mathit{N}},a\\in{\\mathit{A_{n}}}\" display=\"inline\"><mrow><mrow><mrow><mo>\u2200</mo><mi>n</mi></mrow><mo>\u2208</mo><mi>N</mi></mrow><mo>,</mo><mrow><mi>a</mi><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\displaystyle-w_{n,a}^{h}+v_{n,a}-p^{h}\\leq C_{n,a}^{h}\" display=\"inline\"><mrow><mrow><mrow><mrow><mo>-</mo><msubsup><mi>w</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow><mo>+</mo><msub><mi>v</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow><mo>-</mo><msup><mi>p</mi><mi>h</mi></msup></mrow><mo>\u2264</mo><msubsup><mi>C</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle\\forall n\\in{\\mathit{N}},a\\in{\\mathit{A_{n}}},h\\in{\\mathit{T_{n,a%&#10;}}}\" display=\"inline\"><mrow><mrow><mrow><mo>\u2200</mo><mi>n</mi></mrow><mo>\u2208</mo><mi>N</mi></mrow><mo>,</mo><mrow><mrow><mi>a</mi><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow><mo>,</mo><mrow><mi>h</mi><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\displaystyle-x_{n,a}^{h}+M_{3}\\xi_{n,a}^{h}\\leq M_{3}-\\beta_{n,a%&#10;}^{\\max}\" display=\"inline\"><mrow><mrow><mrow><mo>-</mo><msubsup><mi>x</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow><mo>+</mo><mrow><msub><mi>M</mi><mn>3</mn></msub><mo>\u2062</mo><msubsup><mi>\u03be</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow></mrow><mo>\u2264</mo><mrow><msub><mi>M</mi><mn>3</mn></msub><mo>-</mo><msubsup><mi>\u03b2</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>max</mi></msubsup></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle\\forall n\\in{\\mathit{N}},a\\in{\\mathit{A_{n}}},h\\in{\\mathit{T_{n,a%&#10;}}}\" display=\"inline\"><mrow><mrow><mrow><mo>\u2200</mo><mi>n</mi></mrow><mo>\u2208</mo><mi>N</mi></mrow><mo>,</mo><mrow><mrow><mi>a</mi><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow><mo>,</mo><mrow><mi>h</mi><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E10.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\displaystyle w_{n,a}^{h}-M_{3}\\xi_{n,a}^{h}\\leq 0\" display=\"inline\"><mrow><mrow><msubsup><mi>w</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup><mo>-</mo><mrow><msub><mi>M</mi><mn>3</mn></msub><mo>\u2062</mo><msubsup><mi>\u03be</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow></mrow><mo>\u2264</mo><mn>0</mn></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E10.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle\\forall n\\in{\\mathit{N}},a\\in{\\mathit{A_{n}}},h\\in{\\mathit{T_{n,a%&#10;}}}\" display=\"inline\"><mrow><mrow><mrow><mo>\u2200</mo><mi>n</mi></mrow><mo>\u2208</mo><mi>N</mi></mrow><mo>,</mo><mrow><mrow><mi>a</mi><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow><mo>,</mo><mrow><mi>h</mi><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E11.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\displaystyle\\sum_{h\\in{\\mathit{T_{n,a}}}}x_{n,a}^{h}+M_{2}%&#10;\\epsilon_{n,a}\\leq M_{2}+E_{n,a}\" display=\"inline\"><mrow><mrow><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>h</mi><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></munder></mstyle><msubsup><mi>x</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow><mo>+</mo><mrow><msub><mi>M</mi><mn>2</mn></msub><mo>\u2062</mo><msub><mi>\u03f5</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></mrow><mo>\u2264</mo><mrow><msub><mi>M</mi><mn>2</mn></msub><mo>+</mo><msub><mi>E</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E11.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle\\forall n\\in{\\mathit{N}},a\\in{\\mathit{A_{n}}}\" display=\"inline\"><mrow><mrow><mrow><mo>\u2200</mo><mi>n</mi></mrow><mo>\u2208</mo><mi>N</mi></mrow><mo>,</mo><mrow><mi>a</mi><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E12.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\displaystyle v_{n,a}-M_{2}\\epsilon_{n,a}\\leq 0\" display=\"inline\"><mrow><mrow><msub><mi>v</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub><mo>-</mo><mrow><msub><mi>M</mi><mn>2</mn></msub><mo>\u2062</mo><msub><mi>\u03f5</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></mrow><mo>\u2264</mo><mn>0</mn></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E12.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle\\forall n\\in{\\mathit{N}},a\\in{\\mathit{A_{n}}}\" display=\"inline\"><mrow><mrow><mrow><mo>\u2200</mo><mi>n</mi></mrow><mo>\u2208</mo><mi>N</mi></mrow><mo>,</mo><mrow><mi>a</mi><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E13.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\displaystyle w_{n,a}^{h}-v_{n,a}+p^{h}+M_{1}\\psi_{n,a}^{h}\\leq M%&#10;_{1}-C_{n,a}^{h}\" display=\"inline\"><mrow><mrow><mrow><msubsup><mi>w</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup><mo>-</mo><msub><mi>v</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow><mo>+</mo><msup><mi>p</mi><mi>h</mi></msup><mo>+</mo><mrow><msub><mi>M</mi><mn>1</mn></msub><mo>\u2062</mo><msubsup><mi>\u03c8</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow></mrow><mo>\u2264</mo><mrow><msub><mi>M</mi><mn>1</mn></msub><mo>-</mo><msubsup><mi>C</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E13.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle\\forall n\\in{\\mathit{N}},a\\in{\\mathit{A_{n}}},\\forall h\\in{%&#10;\\mathit{T_{n,a}}}\" display=\"inline\"><mrow><mrow><mrow><mo>\u2200</mo><mi>n</mi></mrow><mo>\u2208</mo><mi>N</mi></mrow><mo>,</mo><mrow><mrow><mi>a</mi><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow><mo>,</mo><mrow><mrow><mo>\u2200</mo><mi>h</mi></mrow><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\displaystyle x_{n,a}^{h}-M_{1}\\psi_{n,a}^{h}\\leq 0\" display=\"inline\"><mrow><mrow><msubsup><mi>x</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup><mo>-</mo><mrow><msub><mi>M</mi><mn>1</mn></msub><mo>\u2062</mo><msubsup><mi>\u03c8</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow></mrow><mo>\u2264</mo><mn>0</mn></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle\\forall n\\in{\\mathit{N}},a\\in{\\mathit{A_{n}}},h\\in{\\mathit{T_{n,a%&#10;}}}\" display=\"inline\"><mrow><mrow><mrow><mo>\u2200</mo><mi>n</mi></mrow><mo>\u2208</mo><mi>N</mi></mrow><mo>,</mo><mrow><mrow><mi>a</mi><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow><mo>,</mo><mrow><mi>h</mi><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex13.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\displaystyle\\xi_{n,a}^{h},\\psi_{n,a}^{h}\\in\\{0,1\\};\\,\\,w_{n,a}^{%&#10;h}\\geq 0\" display=\"inline\"><mrow><mrow><mrow><msubsup><mi>\u03be</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup><mo>,</mo><msubsup><mi>\u03c8</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow><mo>\u2208</mo><mrow><mo stretchy=\"false\">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">}</mo></mrow></mrow><mo rspace=\"5.9pt\">;</mo><mrow><msubsup><mi>w</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup><mo>\u2265</mo><mn>0</mn></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex13.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle\\forall n\\in{\\mathit{N}},a\\in{\\mathit{A_{n}}},\\forall h\\in{%&#10;\\mathit{T_{n,a}}}\" display=\"inline\"><mrow><mrow><mrow><mo>\u2200</mo><mi>n</mi></mrow><mo>\u2208</mo><mi>N</mi></mrow><mo>,</mo><mrow><mrow><mi>a</mi><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow><mo>,</mo><mrow><mrow><mo>\u2200</mo><mi>h</mi></mrow><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex14.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\displaystyle\\epsilon_{n,a}\\in\\{0,1\\};\\,\\,v_{n,a}\\geq 0\" display=\"inline\"><mrow><mrow><msub><mi>\u03f5</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub><mo>\u2208</mo><mrow><mo stretchy=\"false\">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">}</mo></mrow></mrow><mo rspace=\"5.9pt\">;</mo><mrow><msub><mi>v</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub><mo>\u2265</mo><mn>0</mn></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex14.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle\\forall n\\in{\\mathit{N}},a\\in{\\mathit{A_{n}}}.\" display=\"inline\"><mrow><mrow><mrow><mrow><mo>\u2200</mo><mi>n</mi></mrow><mo>\u2208</mo><mi>N</mi></mrow><mo>,</mo><mrow><mi>a</mi><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05678.tex", "nexttext": "\nwhere Constraint (\\ref{complow1}) is rearranged so that the device limit is not exceeded. Constraint (\\ref{complow2}) includes the amount of energy $\\bar{x}_{n,a}^h$ that is purchased from the competitor, and ensures that demand is satisfied no matter which firm is the provider. \n\nSimilar to the previous model, this program can be expressed as a single level MIP.\nFollowing the previous notation, dual variables $w_{n,a}^h$ and \n$v_{n,a}$ are associated with (\\ref{complow1}) and (\\ref{complow2}), \nrespectively. Next, the primal, dual and complementary slackness constraints of the lower level are\nappended to the upper level, while the strong duality of the lower level is utilized \nto linearize the objective of the leader:\n\n\n", "itemtype": "equation", "pos": 24683, "prevtext": "}\n\n\\subsection{Competitive pricing}\nNow, we turn our attention to a framework involving a competitor who declares its prices prior to the leader. The smart grid can now choose between two options for each time slot, that is, demand of each appliance can be either supplied by the leader, by the competitor or even by both of them. Therefore, the smart grid decides how much power will be supplied by the leader and the competitor in each time slot. It is important to emphasize that a customer does \\textit{not} choose a supplier for all of its demand, but rather the grid chooses the \\textit{total amount} of power to be purchased from each supplier.\n\nThe main concern about hour-to-hour selection of electricity supplier is payment calculation and collection. However, in a smart grid environment it is automatically calculated and billed. Therefore, several suppliers may offer prices and the most convenient one would be selected by the smart grid operator.\n\nIn the competitive pricing (CP) setting, the leader must address several issues. In addition to peak minimization and revenue maximization, as well as price ceiling constraints, market shares will only be preserved if its prices are competitive, which significantly reduces the leader's `degrees of freedom'.\n\nIn the following, we assume that competitor prices $\\bar{p}^h$ are fixed, and actually assume the values $p_{\\max}^h$, without loss of generality. If they were higher, then all customers would opt for the leader and the situation would be the same as in model MP. If they were lower, then $p_{\\max}^h$ would be irrelevant, and leader prices would be bounded by $\\bar{p}^h$. We also assume that the inconvenience factors are identical, whether electricity is supplied by the competitor or the leader. Finally, we make the conservative assumption that, whenever customers buy energy from the follower, they are automatically scheduled to their most preferred time slots.\n\nUpon the introduction of continuous variable $\\bar{x}_{n,a}^h$ to represent the amount of power purchased from the competitor, the bilevel program takes the form:\n\n\n", "index": 15, "text": "\\begin{align}\n\\text{(CP):}\\max_{p, \\Gamma} & \\displaystyle \\sum_{n\\in {\\mathit{N}}} \\sum_{a \\in {\\mathit{A_n}}} \\sum_{h\\in \n{\\mathit{T_{n,a}}}} p^h x_{n,a}^h - \\kappa\\Gamma &&\\nonumber \\\\\n\\mbox{s.t. } & \\displaystyle \\Gamma \\geq \\sum_{\\substack{n \\in {\\mathit{N}}, a \\in {\\mathit{A_n}} \\\\\\text{s.t. } h\\in{\\mathit{T_{n,a}}}}} x_{n,a}^h &&\\forall h \\nonumber \\\\ \n& \\displaystyle 0 \\leq p^h \\leq p_{\\max}^h && \\forall h \\in {\\mathit{H}} \\nonumber \\\\ \n\\min_{x,\\bar{x}} &\\displaystyle \\sum_{n\\in {\\mathit{N}}} \\sum_{a \\in {\\mathit{A_n}}} \\sum_{h\\in {\\mathit{T_{n,a}}}} (p^h+C_{n,a}(h))x_{n,a}^h \\nonumber&&\\\\\n+& \\sum_{n\\in {\\mathit{N}}} \\sum_{a \\in {\\mathit{A_n}}} \\sum_{h\\in {\\mathit{T_{n,a}}}} (\\bar{p}^h+C_{n,a}(h))\\bar{x}_{n,a}^h &&\\nonumber \\\\\n\\mbox{s.t. } & \\displaystyle x_{n,a}^h + \\bar{x}_{n,a}^h \\leq \\beta_{n,a}^{\\max} && \\forall n \\in {\\mathit{N}} ,  a \\in {\\mathit{A_n}},  h \\in {\\mathit{T_{n,a}}} &&\\label{complow1} \\\\\n& \\displaystyle \\sum_{h \\in {\\mathit{T_{n,a}}}}x_{n,a}^h+ \\bar{x}_{n,a}^h \\geq E_{n,a} && \\forall n \\in {\\mathit{N}} ,  \\in {\\mathit{A_n}} \\label{complow2} \\\\\n& \\displaystyle x_{n,a}^h, \\bar{x}_{n,a}^h \\geq 0 &&\\forall n \\in {\\mathit{N}} , a \\in {\\mathit{A_n}},  h \\in {\\mathit{T_{n,a}}}, &&\\label{complow3} \\nonumber\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex15.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\text{(CP):}\\max_{p,\\Gamma}\" display=\"inline\"><mrow><mtext>(CP):</mtext><mo>\u2062</mo><munder><mi>max</mi><mrow><mi>p</mi><mo>,</mo><mi mathvariant=\"normal\">\u0393</mi></mrow></munder></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex15.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\displaystyle\\sum_{n\\in{\\mathit{N}}}\\sum_{a\\in{\\mathit{A_{n}}}}%&#10;\\sum_{h\\in{\\mathit{T_{n,a}}}}p^{h}x_{n,a}^{h}-\\kappa\\Gamma\" display=\"inline\"><mrow><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>\u2208</mo><mi>N</mi></mrow></munder></mstyle><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>a</mi><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow></munder></mstyle><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>h</mi><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></munder></mstyle><mrow><msup><mi>p</mi><mi>h</mi></msup><mo>\u2062</mo><msubsup><mi>x</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow></mrow></mrow></mrow><mo>-</mo><mrow><mi>\u03ba</mi><mo>\u2062</mo><mi mathvariant=\"normal\">\u0393</mi></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex16.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\displaystyle\\Gamma\\geq\\sum_{\\begin{subarray}{c}n\\in{\\mathit{N}},%&#10;a\\in{\\mathit{A_{n}}}\\\\&#10;\\text{s.t. }h\\in{\\mathit{T_{n,a}}}\\end{subarray}}x_{n,a}^{h}\" display=\"inline\"><mrow><mi mathvariant=\"normal\">\u0393</mi><mo>\u2265</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mtable class=\"ltx_align_c\" rowspacing=\"0.0pt\"><mtr><mtd><mrow><mrow><mi>n</mi><mo>\u2208</mo><mi>N</mi></mrow><mo>,</mo><mrow><mi>a</mi><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mtext>s.t.\u00a0</mtext><mo>\u2062</mo><mi>h</mi></mrow><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></mtd></mtr></mtable></munder></mstyle><msubsup><mi>x</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex16.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle\\forall h\" display=\"inline\"><mrow><mo>\u2200</mo><mi>h</mi></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex17.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\displaystyle 0\\leq p^{h}\\leq p_{\\max}^{h}\" display=\"inline\"><mrow><mn>0</mn><mo>\u2264</mo><msup><mi>p</mi><mi>h</mi></msup><mo>\u2264</mo><msubsup><mi>p</mi><mi>max</mi><mi>h</mi></msubsup></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex17.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle\\forall h\\in{\\mathit{H}}\" display=\"inline\"><mrow><mrow><mo>\u2200</mo><mi>h</mi></mrow><mo>\u2208</mo><mi>H</mi></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex18.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\min_{x,\\bar{x}}\" display=\"inline\"><munder><mi>min</mi><mrow><mi>x</mi><mo>,</mo><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u00af</mo></mover></mrow></munder></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex18.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\displaystyle\\sum_{n\\in{\\mathit{N}}}\\sum_{a\\in{\\mathit{A_{n}}}}%&#10;\\sum_{h\\in{\\mathit{T_{n,a}}}}(p^{h}+C_{n,a}(h))x_{n,a}^{h}\" display=\"inline\"><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>\u2208</mo><mi>N</mi></mrow></munder></mstyle><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>a</mi><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow></munder></mstyle><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>h</mi><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></munder></mstyle><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mi>p</mi><mi>h</mi></msup><mo>+</mo><mrow><msub><mi>C</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>h</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msubsup><mi>x</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex19.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle+\" display=\"inline\"><mo>+</mo></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex19.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\sum_{n\\in{\\mathit{N}}}\\sum_{a\\in{\\mathit{A_{n}}}}\\sum_{h\\in{%&#10;\\mathit{T_{n,a}}}}(\\bar{p}^{h}+C_{n,a}(h))\\bar{x}_{n,a}^{h}\" display=\"inline\"><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>\u2208</mo><mi>N</mi></mrow></munder></mstyle><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>a</mi><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow></munder></mstyle><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>h</mi><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></munder></mstyle><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">\u00af</mo></mover><mi>h</mi></msup><mo>+</mo><mrow><msub><mi>C</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>h</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msubsup><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u00af</mo></mover><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E15.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\displaystyle x_{n,a}^{h}+\\bar{x}_{n,a}^{h}\\leq\\beta_{n,a}^{\\max}\" display=\"inline\"><mrow><mrow><msubsup><mi>x</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup><mo>+</mo><msubsup><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u00af</mo></mover><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow><mo>\u2264</mo><msubsup><mi>\u03b2</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>max</mi></msubsup></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E15.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle\\forall n\\in{\\mathit{N}},a\\in{\\mathit{A_{n}}},h\\in{\\mathit{T_{n,a%&#10;}}}\" display=\"inline\"><mrow><mrow><mrow><mo>\u2200</mo><mi>n</mi></mrow><mo>\u2208</mo><mi>N</mi></mrow><mo>,</mo><mrow><mrow><mi>a</mi><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow><mo>,</mo><mrow><mi>h</mi><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E16.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\displaystyle\\sum_{h\\in{\\mathit{T_{n,a}}}}x_{n,a}^{h}+\\bar{x}_{n,%&#10;a}^{h}\\geq E_{n,a}\" display=\"inline\"><mrow><mrow><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>h</mi><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></munder></mstyle><msubsup><mi>x</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow><mo>+</mo><msubsup><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u00af</mo></mover><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow><mo>\u2265</mo><msub><mi>E</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E16.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle\\forall n\\in{\\mathit{N}},\\in{\\mathit{A_{n}}}\" display=\"inline\"><mrow><mo>\u2200</mo><mi>n</mi><mo>\u2208</mo><mi>N</mi><mo>,</mo><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex20.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\displaystyle x_{n,a}^{h},\\bar{x}_{n,a}^{h}\\geq 0\" display=\"inline\"><mrow><mrow><msubsup><mi>x</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup><mo>,</mo><msubsup><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u00af</mo></mover><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow><mo>\u2265</mo><mn>0</mn></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex20.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle\\forall n\\in{\\mathit{N}},a\\in{\\mathit{A_{n}}},h\\in{\\mathit{T_{n,a%&#10;}}},\" display=\"inline\"><mrow><mrow><mrow><mrow><mo>\u2200</mo><mi>n</mi></mrow><mo>\u2208</mo><mi>N</mi></mrow><mo>,</mo><mrow><mrow><mi>a</mi><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow><mo>,</mo><mrow><mi>h</mi><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05678.tex", "nexttext": "\n\nDue to the additional lower level variables $\\bar{x}_{n,a}^h$, \nwe must incorporate additional dual constraints, together\nwith their complementary slackness constraints. These are linearized as in model MP ($\\forall n \\in{\\mathit{N}}, \\forall a \\in {\\mathit{A_n}},\\forall h \\in {\\mathit{T_{n,a}}}$):\n\n\n", "itemtype": "equation", "pos": 26672, "prevtext": "\nwhere Constraint (\\ref{complow1}) is rearranged so that the device limit is not exceeded. Constraint (\\ref{complow2}) includes the amount of energy $\\bar{x}_{n,a}^h$ that is purchased from the competitor, and ensures that demand is satisfied no matter which firm is the provider. \n\nSimilar to the previous model, this program can be expressed as a single level MIP.\nFollowing the previous notation, dual variables $w_{n,a}^h$ and \n$v_{n,a}$ are associated with (\\ref{complow1}) and (\\ref{complow2}), \nrespectively. Next, the primal, dual and complementary slackness constraints of the lower level are\nappended to the upper level, while the strong duality of the lower level is utilized \nto linearize the objective of the leader:\n\n\n", "index": 17, "text": "\\begin{align*}\n\\max &-\\sum_{\\begin{subarray}{l} n \\in{\\mathit{N}} \\\\ a\\in{\\mathit{A_n}}\\\\ h \\in {\\mathit{T_{n,a}}} \\end{subarray}} \\beta_{n,a}^{\\max} w_{n,a}^h + \\sum_{\\begin{subarray}{l} n \\in{\\mathit{N}} \\\\ a\\in{\\mathit{A_n}} \\end{subarray}} E_{n,a} v_{n,a} - \n\\sum_{\\begin{subarray}{l} n \\in{\\mathit{N}} \\\\ a\\in{\\mathit{A_n}}\\\\ h \\in {\\mathit{T_{n,a}}} \\end{subarray}} \\bar{p}^h \\bar{x}_{n,a}^h \\\\\n&-\\sum_{\\begin{subarray}{l} n \\in{\\mathit{N}} \\\\ a\\in{\\mathit{A_n}}\\\\ h \\in {\\mathit{T_{n,a}}} \\end{subarray}} C_{n,a}(h) (x_{n,a}^h +\\bar{x}_{n,a}^h) - \\kappa\\Gamma . \n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex21.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\max\" display=\"inline\"><mi>max</mi></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex21.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle-\\sum_{\\begin{subarray}{l}n\\in{\\mathit{N}}\\\\&#10;a\\in{\\mathit{A_{n}}}\\\\&#10;h\\in{\\mathit{T_{n,a}}}\\end{subarray}}\\beta_{n,a}^{\\max}w_{n,a}^{h}+\\sum_{%&#10;\\begin{subarray}{l}n\\in{\\mathit{N}}\\\\&#10;a\\in{\\mathit{A_{n}}}\\end{subarray}}E_{n,a}v_{n,a}-\\sum_{\\begin{subarray}{l}n%&#10;\\in{\\mathit{N}}\\\\&#10;a\\in{\\mathit{A_{n}}}\\\\&#10;h\\in{\\mathit{T_{n,a}}}\\end{subarray}}\\bar{p}^{h}\\bar{x}_{n,a}^{h}\" display=\"inline\"><mrow><mrow><mrow><mo>-</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mtable class=\"ltx_align_l\" rowspacing=\"0.0pt\"><mtr><mtd><mrow><mi>n</mi><mo>\u2208</mo><mi>N</mi></mrow></mtd></mtr><mtr><mtd><mrow><mi>a</mi><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><mi>h</mi><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></mtd></mtr></mtable></munder></mstyle><mrow><msubsup><mi>\u03b2</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>max</mi></msubsup><mo>\u2062</mo><msubsup><mi>w</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow></mrow></mrow><mo>+</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mtable class=\"ltx_align_l\" rowspacing=\"0.0pt\"><mtr><mtd><mrow><mi>n</mi><mo>\u2208</mo><mi>N</mi></mrow></mtd></mtr><mtr><mtd><mrow><mi>a</mi><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow></mtd></mtr></mtable></munder></mstyle><mrow><msub><mi>E</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub><mo>\u2062</mo><msub><mi>v</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></mrow></mrow><mo>-</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mtable class=\"ltx_align_l\" rowspacing=\"0.0pt\"><mtr><mtd><mrow><mi>n</mi><mo>\u2208</mo><mi>N</mi></mrow></mtd></mtr><mtr><mtd><mrow><mi>a</mi><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><mi>h</mi><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></mtd></mtr></mtable></munder></mstyle><mrow><msup><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">\u00af</mo></mover><mi>h</mi></msup><mo>\u2062</mo><msubsup><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u00af</mo></mover><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex22.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle-\\sum_{\\begin{subarray}{l}n\\in{\\mathit{N}}\\\\&#10;a\\in{\\mathit{A_{n}}}\\\\&#10;h\\in{\\mathit{T_{n,a}}}\\end{subarray}}C_{n,a}(h)(x_{n,a}^{h}+\\bar{x}_{n,a}^{h})%&#10;-\\kappa\\Gamma.\" display=\"inline\"><mrow><mrow><mrow><mo>-</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mtable class=\"ltx_align_l\" rowspacing=\"0.0pt\"><mtr><mtd><mrow><mi>n</mi><mo>\u2208</mo><mi>N</mi></mrow></mtd></mtr><mtr><mtd><mrow><mi>a</mi><mo>\u2208</mo><msub><mi>A</mi><mi>n</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><mi>h</mi><mo>\u2208</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></mtd></mtr></mtable></munder></mstyle><mrow><msub><mi>C</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>h</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msubsup><mi>x</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup><mo>+</mo><msubsup><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u00af</mo></mover><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>-</mo><mrow><mi>\u03ba</mi><mo>\u2062</mo><mi mathvariant=\"normal\">\u0393</mi></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05678.tex", "nexttext": " \n\n\\section{Experimental Results and Interpretation}\n\nIn this section, we demonstrate the applicability of our approach through a number of numerical experiments involving various scenarios. The base case (BC) corresponds to setting all prices at $p_{\\max}$ and\nscheduling all appliances to the preferred time slots. Results of BC, MP and CP models are compared in terms of peak cost, peak load, net revenue, billing and inconvenience costs.\n\nThe scenarios involve 10 customers, each one controlling three preemptive appliances regulated\nby the smart grid. The scheduling horizon is composed of 24 time slots of equal duration. \n\nThe sensitivity of the models are tested with respect to two parameters: peak weight $\\kappa$ and time window width (TWW), which is related to customer flexibility. \n\nTwo key parameters enter the model. First, peak weight $\\kappa$ reflects the importance to decrease peak load for the leader. A higher weight translates into a larger penalty, hence  a higher effort to smooth out the supply curve. Next,\ntime window width (TWW) provides the leader with some flexibility to induce job shifting through price adjustments, and thus indirectly smoothing out the load curve. Sensitivity of the model with respect to both parameters has been assessed, with $\\kappa$ assuming values ranging from 200 to 1000, with increments of 200, and TWW\nincreased by 20\\% or 100\\% with respect to the minimum completion time \n\n", "itemtype": "equation", "pos": -1, "prevtext": "\n\nDue to the additional lower level variables $\\bar{x}_{n,a}^h$, \nwe must incorporate additional dual constraints, together\nwith their complementary slackness constraints. These are linearized as in model MP ($\\forall n \\in{\\mathit{N}}, \\forall a \\in {\\mathit{A_n}},\\forall h \\in {\\mathit{T_{n,a}}}$):\n\n\n", "index": 19, "text": "\\begin{align*}\n-w_{n,a}^h + v_{n,a} &\\leq C_{n,a}^h + \\bar{p}^h  \\\\\n\\bar{x}_{n,a}^h \\times (w_{n,a}^h - v_{n,a} + \\bar{p}^h + C_{n,a}^h) &= 0 .\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex23.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle-w_{n,a}^{h}+v_{n,a}\" display=\"inline\"><mrow><mrow><mo>-</mo><msubsup><mi>w</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow><mo>+</mo><msub><mi>v</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex23.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\leq C_{n,a}^{h}+\\bar{p}^{h}\" display=\"inline\"><mrow><mi/><mo>\u2264</mo><mrow><msubsup><mi>C</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup><mo>+</mo><msup><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">\u00af</mo></mover><mi>h</mi></msup></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex24.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\bar{x}_{n,a}^{h}\\times(w_{n,a}^{h}-v_{n,a}+\\bar{p}^{h}+C_{n,a}^{%&#10;h})\" display=\"inline\"><mrow><msubsup><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">\u00af</mo></mover><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup><mo>\u00d7</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><msubsup><mi>w</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup><mo>-</mo><msub><mi>v</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow><mo>+</mo><msup><mover accent=\"true\"><mi>p</mi><mo stretchy=\"false\">\u00af</mo></mover><mi>h</mi></msup><mo>+</mo><msubsup><mi>C</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>h</mi></msubsup></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex24.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=0.\" display=\"inline\"><mrow><mrow><mi/><mo>=</mo><mn>0</mn></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05678.tex", "nexttext": "\nMCT denotes the minimum number of time slots required to meet demand $E_{n,a}$ if we could set\n all devices at their maximum level $\\beta^{\\max}_{n,a}$. For experimental purposes, 10 instances are randomly generated for each value of $\\kappa$. In order to test TWW, similar jobs are used with different widths of time windows. \n\nIn each scenario, parameters $\\beta^{\\max}_{n,a}$ and $E_{n,a}$ are uniformly generated for customer $n$ and appliance $a$. Then, the early time slot of time window for customer $n$ and appliance $a$, $TW_{n,a}^b$ is generated within 0 and $24-\\ceil*{(1+TWW)\\times MCT}$. The end of time window for customer $n$ and appliance $a$, $TW_{n,a}^e$ takes the value $TW_{n,a}^b+\\ceil*{(1+TWW)\\times MCT}$. For instance, let $\\beta^{\\max}$ and $E$ be equal to 2 and 8, respectively, for a given customer $n$, and appliance $a$. Then, its MCT is 4 hours. If TWW is 1.0, then its time window can start at some time slot in \\{0,\\ldots,16\\} and must end 8 hours later. If TWW is 0.20, then $TW_{n,a}^b$ belongs to the\ninterval \\{0,\\ldots,19\\} and $TW_{n,a}^e$ is $TW_{n,a}^b+5$. \n\nAlthough all customers are residential users, they may have different levels of sensitivity to delay and hence, they may behave differently. Therefore, a random inconvenience coefficient $\\lambda_n$ is generated for each customer~$n$. As mentioned earlier, the inconvenience penalty function $C_{n,a}(h)$ is directly proportional with $\\lambda_n$ and \ndemand $E_{n,a}$, and inversely proportional to time window width. Hence, \nwhen $\\lambda_n$ assumes a low value, customers are less delay-sensitive, \nwhich gives the model more flexibility to find a good schedule. Alternatively, when $\\lambda_n$ assumes a large value, certain time slots become too costly and will almost never be selected. Note that in real life, $\\lambda_n$ can be either selected by customers or a value can be assigned to each customer based on past data.\n\nBoth models are solved with CPLEX version 12.3 on a computer with 2.66 GHz Intel Xeon CPU and 4 GB RAM, \nrunning under the Windows 7 operating system. Whenever an instance could not be solved within\nthe time limit of 4 hours, the best integer solution has been considered. \n\n\\begin{table}[t]\n\\caption{Cost Comparison of models MP and CP on 20\\% TWW instances (BC = 100\\%)}\n\\centering\n{\n\\begin{tabular}{r r r r r r r}\n$\\kappa$ & MP EB & MP IC & MP TC & CP EB & CP IC & CP TC \\\\\n\\\\\n200 & 78.02 & 21.49 & 99.51 & 78.31 & 21.17 & 99.48 \\\\\n400 & 77.15 & 21.59 & 98.74 & 78.01 & 20.13 & 98.14 \\\\\n600 & 75.76 & 21.85 & 97.61 & 77.84 & 18.74 & 96.58 \\\\\n800 & 73.52 & 22.16 & 95.68 & 78.07 & 16.81 & 94.88 \\\\\n1000 & 71.50 & 22.48 & 93.99 & 77.63 & 16.28 & 93.91 \\\\\nAverage & 75.19 & 21.91 & 97.10 & 77.97 & 18.63 & 96.60\n\\end{tabular}\n}\n\\label{tab:cost20}\n\\end{table}\n\n\\begin{table}[t]\n\\caption{Cost Comparison of models MP and CP on 100\\% TWW instances (BC = 100\\%)}\n\\centering\n{\n\\begin{tabular}{r r r r r r r}\n$\\kappa$ & MP EB & MP IC & MP TC & CP EB & CP IC & CP TC \\\\\n\\\\\n200 & 85.12 & 14.16 & 99.28 & 85.25 & 14.06 & 99.30 \\\\ \n400 & 82.87 & 14.55 & 97.42 & 84.05 & 13.90 & 97.95 \\\\\n600 & 80.13 & 15.29 & 95.42 & 84.67 & 12.69 & 97.35 \\\\\n800 & 75.67 & 16.29 & 91.96 & 84.33 & 11.84 & 96.17 \\\\\n1000 & 74.95 & 16.44 & 91.39 & 83.70 & 11.45 & 95.15 \\\\\nAverage & 79.75 & 15.35 & 95.10 & 84.40\t& 12.79 & 97.19\n\\end{tabular}\n}\n\\label{tab:cost100}\n\\end{table}\n\nThe first numerical results are displayed in Tables \\ref{tab:cost20} and \\ref{tab:cost100}.\nThey involve 10 random instances of 30 jobs, in both the monopolistic (MP) and competitive (MC) cases.\nThe user costs are split between electricity bill (EB) and inconvenience cost (IC), both percentages\nbeing relative to the\nbase case (BC). For instance, the first line of Table \\ref{tab:cost20} indicates that in model MP, \nout-of-pocket cost is 78.02\\% and inconvenience cost is 21.49\\% of the total cost \ncorresponding to BC, the total (TC) being 0.5\\% less than in BC, for which\nthe billing cost is the higher. Average values over all parameters and instances are displayed\nin the final row. Models MP and CP results in a 2.9\\% and 3.4\\% total cost reduction, respectively for 20\\% TWW instances and a 4.9\\% and 2.8\\% total cost reduction for 100\\% instances. All values are less than 100\\%, which \nreflects a cost improvement for customers for any peak weight value.\n\nIn comparison with the base case, the leader sets lower prices in order to shift some jobs to the off-peak hours, hence customers' bill is naturally reduced and inconvenience cost is increased. When peak weight $\\kappa$ is large, the leader is willing to give up some revenue in order to achieve a smoother load curve. Hence, \nit lessens the bill as well. Note that EB is lower in model MP than in model CP whereas IC is higher. When the leader is a monopolist, he has to provide service to all customers. However, in the competitive case, it has the option to give up on some load in order to decrease the peak without lowering prices. According to this reasoning, IC increases as $\\kappa$ increases in both tables for model MP, whereas it decreases for model CP. \n\nAlthough the total cost of the follower for 20\\% TWW instances is lower in the presence of competition, it is not the case for 100\\% TWW instances, and there lies an interesting fact. For instance, suppose that peak consists of a light-load and a heavy-load job alongside others, and that they are both required to be shifted in order to decrease the peak. Keeping in mind that the heavy-load job has a high inconvenience cost, the leader would have to decrease the price at least by that amount in the monopolistic case. Then, the light-load job would enjoy a price reduction that is larger than its inconvenience,\nand the total cost would be lower for the light-load job and identical for the heavy one. In contrast, \nthe leader can now give up on the heavy-load job in the competitive case and decrease the price only with respect to the light-load job. Hence, total cost would stay the same for both jobs. This is valid mostly for large time windows, because there are far fewer options for job shifting in 20\\% instances. \n\n\\begin{table}[t]\n\\caption{Comparison of models MP and CP with 20\\% TWW Instances} \n\\centering\n{\n\\begin{tabular}{c r r r r r r}\n & \\multicolumn{2}{c}{Av Comp Time} & \\multicolumn{2}{c}{Av Gap} & \n\\multicolumn{2}{c}{\\# unsolved} \\\\ \n\\multicolumn{1}{c}{($\\kappa$)} & \\multicolumn{1}{c}{MP} & \n\\multicolumn{1}{c}{CP} & \\multicolumn{1}{c}{MP} & \\multicolumn{1}{c}{CP} & \\multicolumn{1}{c}{MP} & \\multicolumn{1}{c}{CP} \\\\ \n\\\\\n200 & 1.10 & 1.20 & 0.00\\% & 0.00\\% & 0 & 0 \\\\ \n400 & 3.10 & 3.50 & 0.00\\% & 0.00\\% & 0 & 0 \\\\ \n600 & 6.80 & 13.10 & 0.00\\% & 0.00\\% & 0 & 0 \\\\ \n800 & 8.90 & 56.60 & 0.00\\% & 0.00\\% & 0 & 0 \\\\ \n1000 & 17.90 & 63.00 & 0.00\\% & 0.00\\% & 0 & 0 \\\\ \n\\end{tabular}\n}\n\\label{tab:comparison}\n\\end{table}\n\n\\begin{table}[t]\n\\caption{Comparison of models MP and CP with 100\\% TWW Instances}\n\\centering\n{\n\\begin{tabular}{c r r r r r r}\n & \\multicolumn{2}{c}{Av Comp Time} & \\multicolumn{2}{c}{Av Gap} & \n\\multicolumn{2}{c}{\\# unsolved} \\\\ \n\\multicolumn{1}{c}{($\\kappa$)} & \\multicolumn{1}{c}{MP} & \n\\multicolumn{1}{c}{CP} & \\multicolumn{1}{c}{MP} & \\multicolumn{1}{c}{CP} & \\multicolumn{1}{c}{MP} & \\multicolumn{1}{c}{CP} \\\\ \n\\\\\n200 & 28.10 & 321.10 & 0.00\\% & 0.00\\% & 0 & 0 \\\\ \n400 & 339.50 & 592.67 & 0.00\\% & 0.55\\% & 0 & 1 \\\\ \n600 & 2040.20 & 1232.88 & 0.00\\% & 3.87\\% & 0 & 2 \\\\ \n800 & 4666.40 & 2350.67 & 0.00\\% & 3.73\\% & 0 & 4 \\\\ \n1000 & 7707.00 & 2034.14 & 0.00\\% & 6.04\\% & 0 & 3 \\\\ \n\\end{tabular}\n}\n\\label{tab:comparison2}\n\\end{table}\n\n\\begin{figure*}[h]\n\\centering\n\\subfigure[Peak Cost for 20\\% TWW Instances\\label{fig:peakcost20}]{\\includegraphics[page=1,width=2.5in]{graphics.pdf}}\\quad\n\\subfigure[Peak Cost for 100\\% TWW Instances\\label{fig:peakcost100}]{\\includegraphics[page=2,width=2.5in]{graphics.pdf}}\n\\caption{Peak Cost Comparison}\n\\label{fig:peakcost}\n\\end{figure*}\n\n\\begin{figure*}[h]\n\\centering\n\\subfigure[Peak Load for 20\\% TWW Instances\\label{fig:peakload20}]{\\includegraphics[page=3,width=2.5in]{graphics.pdf}}\\quad\n\\subfigure[Peak Load for 100\\% TWW Instances\\label{fig:peakload100}]{\\includegraphics[page=4,width=2.5in]{graphics.pdf}}\n\\caption{Peak Load Comparison}\n\\label{fig:peakload}\n\\end{figure*}\n\n\\begin{figure*}[!t]\n\\centering\n\\subfigure[Net Revenue for 20\\% TWW Instances\\label{fig:netrev20}]{\\includegraphics[page=5,width=2.5in]{graphics.pdf}}\\quad\n\\subfigure[Net Revenue for 100\\% TWW Instances\\label{fig:netrev100}]{\\includegraphics[page=6,width=2.5in]{graphics.pdf}}\n\\caption{Net Revenue Comparison}\n\\label{fig:netrev}\n\\end{figure*}\n\nIn Tables \\ref{tab:comparison} and \\ref{tab:comparison2}, the computational results of model MP and CP are \ncompared for 20\\% and 100\\% TWW instances, respectively. Average computing time (in seconds), the average \noptimality gap of unsolved instances, and the number of unsolved instances are presented. \nAs aforementioned, the running time limit is set to 4 hours \n(14~400 seconds) and the values displayed in the tables are the average computation time \nover all instances that could be solved within 4 hours.\n\nIn both tables, the average computation time of both models increases together with peak weight $\\kappa$,\nsince the leader is more willing to modify its prices in order to smooth out\nthe load curve, providing extra room for improvement. The average gaps and number of unsolved instances also support this argument. In addition, one can observe that average computation time is larger in Table~\\ref{tab:comparison2}. Large time windows induce high running times, since there are more options to consider. Another important point is that, on average, model CP takes longer to solve if we include the unsolved instances. This result can be explained by the increased combinatorics,\nthe leader having the additional alternative to provide energy for a job or leave it to the competitor. In accordance with real life, competition makes the decision process more challenging.\n\nPeak cost, peak load and net revenue (objective function value of leader) comparisons of model MP and CP to BC for 20\\% instances are shown in Figures~\\ref{fig:peakcost20}, \\ref{fig:peakload20} and \\ref{fig:netrev20}, respectively. Similar values are shown for 100\\% instances in Figures~\\ref{fig:peakcost100}, \\ref{fig:peakload100} and \\ref{fig:netrev100}. The $x$-axis consists of the peak weight parameter $\\kappa$ and the \n$y$-axis represents the monetary value in Figures~\\ref{fig:peakcost} and \\ref{fig:netrev},\n whereas it represents peak power usage in Figure~\\ref{fig:peakload}. In Figure \\ref{fig:peakcost}, it can be observed that peak costs for models MP and CP increases slower than the peak cost of BC,\nas weight $\\kappa$ increases. Since there is a possibility of \\textit{not} satisfying some of the demand for the leader in model CP, peak load and hence peak cost is lower than in model MP, as expected. In Figures \\ref{fig:peakcost20} and \\ref{fig:peakcost100}, it can be observed that peak cost decreases in model MP when time windows are wide, whereas it does not change much in model CP. In accordance, in Figures \\ref{fig:peakload20} and \\ref{fig:peakload100}, it is clear that peak load decreases in model MP. As a result, net revenue in model MP increases considerably when time windows widen. \n\nWe now turn our attention the the leader's revenue. Average net revenue of BC is dominated by\nthat of model MP, and the latter is dominated by CP. Both bilevel models provide a higher \\textit{net revenue} despite the\ndiscount on some prices. In view of the peak cost constraint, the leader can adjust its\npricing strategy to increase total revenue. Perhaps more surprising, it can benefit from an open market by willingly letting demand flow to the competition, for the sake of meeting the peak constraint. It is important to note that the model behavior is very similar in both the 20\\% and 100\\% instances. On average, model MP provides a 13.71\\% and 24.34\\% net revenue increase with respect to BC on 20\\% and 100\\% TWW instances, respectively. Meanwhile, model CP provides a 38.31\\% and 40.31\\% net revenue increase with respect to BC on 20\\% and 100\\% TWW instances, respectively. \n \n\\begin{figure*}[h]\n\\centering\n\\subfigure[Load distribution of one instance (Model MP)\\label{fig:load100I}]{\\includegraphics[page=7,width=2.5in]{graphics.pdf}}\\quad\n\\subfigure[Load Distribution of an Instance (Model CP)\\label{fig:load100II}]{\\includegraphics[page=8,width=2.5in]{graphics.pdf}}\n\\caption{Load Comparison}\n\\label{fig:load}\n\\end{figure*}\n\n\\begin{figure*}[h]\n\\centering\n\\subfigure[Leader prices of one instance (Model MP)\\label{fig:price100I}]{\\includegraphics[page=9,width=2.5in]{graphics.pdf}}\\quad\n\\subfigure[Leader Prices of an Instance (Model CP)\\label{fig:price100II}]{\\includegraphics[page=10,width=2.5in]{graphics.pdf}}\n\\caption{Price Comparison}\n\\label{fig:price}\n\\end{figure*}\n\nDifferent load shapes are handled differently by the model. If the initial load curve has a single `high' peak, then it attempts to assign attractive prices around the peak to shift some of the load to later periods. However, when there are more than one peak, the shifting issue becomes more complex. Load distributions with respect to different values of $\\kappa$ of an instance under model MP and 100\\% TWW are shown in Figure \\ref{fig:load100I}. When $\\kappa$ is less than~400, the model\nignores the peak at time 12 and focuses on the one at time~10. However, as $\\kappa$ increases, the model tries harder and harder to level the load curve around both peaks. In Figure~\\ref{fig:price100I}, where the corresponding price vectors are displayed, low prices illustrate the effort of the leader to shift jobs around. The magnitude of price reduction escalates as $\\kappa$ increases. Besides, it is again clear that prices around the other peak start moving when $\\kappa$ \nexceeds the value 600. These two graphs provide a better picture of how an energy provider can achieve an optimal trade-off between revenue maximization and peak minimization.\n\nWhen model CP is solved on instances of Figures \\ref{fig:load100I} and \\ref{fig:price100I}, load distribution and prices change as shown in Figures \\ref{fig:load100II} and \\ref{fig:price100II}, respectively. The leader leaves some load to the competition in return for lower peak value. By applying this strategy, it manages to keep prices higher than in the monopolistic case and achieves a smaller generation capacity. It is further observed that the leader tries to decrease peak to the level of the second highest load value (SHL). In order to achieve this, two strategies are exercised: if the time slot following peak hour has small load, then the leader opts for shifting some load to that time slot. Else, if the difference between peak load and SHL is larger than the difference between SHL and the load at the time slot following the peak, then the residual is left to the competition.\n\n\\section{Conclusion}\nMaintaining an efficient supply-demand balance in the residential\nenergy market is a difficult task, due to variability of the demand. In order to guarantee stability during peak periods, providers must install very large capacities, or resort to costly imports. In order to address this issue, we investigated a hierarchical framework where the leader optimizes the weighted sum of revenue and peak penalty, given that the smart grid optimizes customer choice. Since electricity generation requires large investments, both for capacity building and maintenance, it is frequently handled by a private monopolist,\nindependent or not of the state. This corresponds to our first model. However, along with technological developments in the renewable energy generation and PHEVs, one can foresee the advent of smaller players, hence the relevance of our second model.\n\nIn this paper, we have shown that day-ahead energy pricing can be a powerful tool in terms of DSM when a smart grid system is incorporated into the system. A more efficient energy supply system is designed by flattening load curve without requiring a drastic change of habits from customers. By using pricing as a design mechanism, an optimal trade-off between\nrevenue and user cost can be quantified in both a monopolistic and competitive situation. By performing sensitivity with\nrespect to the peak load parameter, insight into efficient regulations could be achieved. \n\nThroughout our study, we have assumed that customers are not competing with each other,\nbut rather behave as a cooperative that devolves the decisions to the smart grid, providing\nthem with bargaining power. Analyzing EPMP under different assumptions, as well as developing \nheuristic algorithms that scale better than exact methods are two issues that will be addressed\nin subsequent works.\n\n\\section*{References}\n\\bibliographystyle{elsarticle-num} \n \\bibliography{elsevier}\n\n", "itemtype": "equation", "pos": 29149, "prevtext": " \n\n\\section{Experimental Results and Interpretation}\n\nIn this section, we demonstrate the applicability of our approach through a number of numerical experiments involving various scenarios. The base case (BC) corresponds to setting all prices at $p_{\\max}$ and\nscheduling all appliances to the preferred time slots. Results of BC, MP and CP models are compared in terms of peak cost, peak load, net revenue, billing and inconvenience costs.\n\nThe scenarios involve 10 customers, each one controlling three preemptive appliances regulated\nby the smart grid. The scheduling horizon is composed of 24 time slots of equal duration. \n\nThe sensitivity of the models are tested with respect to two parameters: peak weight $\\kappa$ and time window width (TWW), which is related to customer flexibility. \n\nTwo key parameters enter the model. First, peak weight $\\kappa$ reflects the importance to decrease peak load for the leader. A higher weight translates into a larger penalty, hence  a higher effort to smooth out the supply curve. Next,\ntime window width (TWW) provides the leader with some flexibility to induce job shifting through price adjustments, and thus indirectly smoothing out the load curve. Sensitivity of the model with respect to both parameters has been assessed, with $\\kappa$ assuming values ranging from 200 to 1000, with increments of 200, and TWW\nincreased by 20\\% or 100\\% with respect to the minimum completion time \n\n", "index": 21, "text": "$$\\hbox{MCT} := \\ceil*{{E_{n,a}}/{\\beta^{\\max}_{n,a}}}.$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex25.m1\" class=\"ltx_Math\" alttext=\"\\hbox{MCT}:=\\ceil*{{E_{n,a}}/{\\beta^{\\max}_{n,a}}}.\" display=\"block\"><mrow><mrow><mtext>MCT</mtext><mo>:=</mo><mrow><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\ceil</mtext></merror><mo>*</mo><msub><mi>E</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow></msub></mrow><mo>/</mo><msubsup><mi>\u03b2</mi><mrow><mi>n</mi><mo>,</mo><mi>a</mi></mrow><mi>max</mi></msubsup></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}]