[{"file": "1601.00747.tex", "nexttext": "\nThe linear response in the expectation values of the same set of operators can be expressed as~\\cite{FetterWalecka1971, PhD-Faassen2005, PhD-Giesbertz2010}\n\n", "itemtype": "equation", "pos": 9438, "prevtext": "\n\n\n\\maketitle\n\n\\begin{abstract}\nIn [J.~Chem.\\ Phys.~\\textbf{143}, 054102 (2015)] I have derived conditions to characterize the kernel of the retarded response function, under the assumption that the initial state is a ground state.\nIn this article I demonstrate its generalization to mixed states (ensembles). To make the proof work, the weights in the ensemble need to be decreasing for increasing energies of the pure states from which the mixed state is constructed. The resulting conditions are not easy to verify, but under the additional assumptions that the ensemble weights are directly related to the energies and that the full spectrum of the Hamiltonian participates in the ensemble, it is shown that potentials only belong to the kernel of the retarded response function if they commute with the initial Hamiltonian. These additional assumptions are valid for thermodynamic ensembles, which makes this result also physically relevant. The conditions on the potentials for the thermodynamic ensembles are much stronger than in the pure state (zero temperature) case, leading to a much less involved kernel when the conditions are applied to the retarded one-body reduced density matrix response function.\n\\end{abstract}\n\n\n\\section{Introduction}\nIn a recent article~\\cite{Giesbertz2015} I generalized the invertibility theorem by Van Leeuwen for the retarded (causal) density response function~\\cite{Leeuwen2001} to the retarded one-body reduced density matrix (1RDM) response function. This is an important step forward for the formal foundations of linear-response time-dependent 1RDM functional theory, since a Runge--Gross type of proof is lacking.\n\nThis generalization is achieved by cutting the proof by Van Leeuwen into two parts. The first part of the proof can be generalized to completely arbitrary retarded response functions, under following two assumptions. The initial (reference) state should be a ground state and the perturbing potential should be Laplace transformable in time. This first part yields a necessary condition which potentials need to satisfy to yield a zero response, i.e.\\ to belong to the kernel of the retarded response function. For non-degenerate ground states this condition is also sufficient, but in the degenerate case an additional sufficiency condition needs to be checked. These conditions depend on the operators for which the retarded response function is considered, e.g.\\ dipoles, magnetization and spin-density. Hence, the second step of the proof consists of inserting the operators under consideration into the conditions and to check to which extend they are satisfied.\n\nIn Ref.~\\cite{Giesbertz2015} I have explicitly worked out these conditions for the reatarded density response function and the 1RDM response function. For non-degenerate ground states the same result as Van Leeuwen was recovered: the density response function is invertible up to a constant shift in the potential. Additionally, I have worked out the case for degenerate response functions, thereby extending the validity of Van Leeuwen's theorem to degenerate ground states. Not surprisingly, the same result was obtained: the density response function is invertible up to a constant. From the Runge--Gross theorem we already know that this holds for analytic potentials~\\cite{RungeGross1984} and even for more general potentials by the work of Ruggenthaler, Penz and Van Leeuwen~\\cite{RuggenthalerLeeuwen2011, RuggenthalerGiesbertzPenz2012, RuggenthalerPenzLeeuwen2015}.\n\nMore interesting results were obtained by working out the invertibility conditions for the 1RDM response function. All symmetry operators which can be expressed as one-body operators belong to the kernel of the 1RDM response function. So apart from the constant potential, also spin-projection operators, $\\hat{{\\boldsymbol{{S}}}}$, belong to the kernel of the 1RDM operator if the Hamiltonian is spin-independent. Likewise, the (angular) momentum operators, $\\hat{{\\boldsymbol{{L}}}}$ and\\slash{}or $-{\\textrm{i}}\\nabla$, are also candidates if the system is rotationally and\\slash{}or translationally invariant. Discrete symmetry operators can only be expressed as one-body operators for non-interacting systems. In most interacting systems, the interaction prevents such a simple expression and more-than-one-body operators are needed to express discrete symmetry operators. Therefore, discrete symmetries are typically of no concern in interacting systems, e.g.\\ the Coulomb interaction.\n\nNot only potentials related to the symmetry of the system possibly lead to no response. Also somewhat `pathological' cases need to be considered which are more related to the structure of the ground state than to any symmetry of the system. These potentials can be revealed by working in the natural orbital (NO) representation. The NOs are defined as the eigenfunctions of the 1RDM and the corresponding eigenvalues are called (natural) occupation numbers, $n_k$. By expanding the ground state in Slater determinants constructed from the NO basis, one can easily find that potentials coupling only completely unoccupied NOs, $n_k = 0$, are also part of the kernel of the 1RDM response function. Likewise in the case of fermions, the potentials coupling the fully occupied NOs, $n_k = 1$, also yield no response in the 1RDM. This result does not come as a surprise, since this freedom to make unitary transformations among the (un)occupied orbitals is often exploited in Hartree--Fock and Kohn--Sham. For systems with a Coulomb interaction it is actually highly unlikely that fully occupied or completely empty NOs exist~\\cite{MorrisonZhouParr1993, Kimball1975, Friesecke2003, GiesbertzLeeuwen2013a, GiesbertzLeeuwen2013b, Giesbertz2014}. In the case of non-interacting systems, one can actually show that potentials coupling degenerate NOs, $n_k = n_l$, also do not lead to a response in the 1RDM. The last case which needs to be mentioned, is the two-electron wave function. Due to its special structure in the NO representation (the NOs only occur once in pairs~\\cite{LowdinShull1956, Kutzelnigg1963, CioslowskiPernalZiesche2002, PhD-Giesbertz2010, RappBricsBauer2014}), special potentials which couple these paired NOs or degenerate pairs also belong to the kernel of the 1RDM response function.\n\nIn this article I will consider a further extension of the invertibility proof from pure states to ensembles as initial condition. This allows us to release the constraint of using a ground state as initial state, though we need to demand that the weights of lower lying states are always larger than the weights of higher lying states in the ensemble. Two necessary and sufficient conditions for the potentials in the kernel of the retarded response function are derived for such ensembles. Unfortunately,  it is hard to make any general statements based on these conditions. If, however, the natural assumption is made that the ensemble weights only depend on the energy, only one of these conditions remains. In the case of the (macro)canonical ensemble, the remaining condition further simplifies to the condition that only potentials which commute with the Hamiltonian belong to the kernel of the response function. Only the symmetry related potentials in the kernel of the 1RDM response function therefore remain at finite temperature.\n\nThe paper has a comparable structure to Ref.~\\cite{Giesbertz2015}. In Sec.~\\ref{sec:necCond} I derive a necessary condition and in Sec.~\\ref{sec:sufCond} an additional sufficiency condition and discuss how it is trivially satisfied if the weights of the ensemble are purely energy related. In Sec.~\\ref{sec:thermoEnsembles} I discuss the implication for the canonical and grand canonical ensembles and show how the kernel of the 1RDM response function is cleaned up when using a finite temperature formalism. In Sec.~\\ref{sec:timeINdependent} I discuss how these results relate to the time-\\emph{in}dependent 1RDM response function and conclude in the last section.\n\n\n\n\n\\section{A necessary condition for potentials in the kernel of the retarded response function}\n\\label{sec:necCond}\nThe invertibility proof for general retarded response functions proceeds in a very analogous manner as for initial ground states~\\cite{Giesbertz2015}. For the sake of clarity, a full exposition of the proof is useful, since at some key-points new conditions need to be imposed for the proof to work and the ensemble weights need to be included. We will start by deriving a necessary condition which potentials in the kernel of the response function need to satisfy. In the next section we will consider to which extend this condition is sufficient.\n\nWe start from a general set of self-adjoint operators or operator densities, $\\{\\hat{Q}_i\\}$, where the index $i$ can perfectly be some multi-index. In the case of operator densities, the index $i$ will be a continuous label and the summations later on should be interpreted as integrals. A typical example would be the density operator, $\\hat{n}({\\mathbf{{r}}})$. Of course, a mixture of is also perfectly allowed, e.g.\\ the spin-density $\\hat{n}({\\mathbf{{x}}})$ where ${\\mathbf{{x}}} {\\coloneqq} {\\mathbf{{r}}}\\sigma$ is a combined space and spin coordinate.\n\nNow we consider perturbations to the system by these operators with strengths $\\delta v_j(t)$, so we consider the following perturbation to the original time-independent Hamiltonian, $\\hat{H}_0$,\n\n", "index": 1, "text": "\\begin{align*}\n\\delta \\hat{V}(t) = \\sum_j\\hat{Q}_j\\delta v_j(t) \\, .\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\delta\\hat{V}(t)=\\sum_{j}\\hat{Q}_{j}\\delta v_{j}(t)\\,.\" display=\"inline\"><mrow><mrow><mrow><mi>\u03b4</mi><mo>\u2062</mo><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">^</mo></mover><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mi>j</mi></munder></mstyle><mrow><msub><mover accent=\"true\"><mi>Q</mi><mo stretchy=\"false\">^</mo></mover><mi>j</mi></msub><mo>\u2062</mo><mi>\u03b4</mi><mo>\u2062</mo><msub><mi>v</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.00747.tex", "nexttext": "\nwhere $\\chi_{ij}(t-t')$ is the retarded linear response function which is readily generalized to initial ensembles as\n\n", "itemtype": "equation", "pos": 9676, "prevtext": "\nThe linear response in the expectation values of the same set of operators can be expressed as~\\cite{FetterWalecka1971, PhD-Faassen2005, PhD-Giesbertz2010}\n\n", "index": 3, "text": "\\begin{align*}\n\\delta Q_i(t) = \\sum_j{\\int^{\\mathrlap{{t}}}_{\\mathrlap{{0}}}\\ud{{t'}}\\,} \\chi_{ij}(t-t')\\delta v_j(t') \\, ,\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\delta Q_{i}(t)=\\sum_{j}{\\int^{\\mathrlap{{t}}}_{\\mathrlap{{0}}}%&#10;\\ud{{t^{\\prime}}}\\,}\\chi_{ij}(t-t^{\\prime})\\delta v_{j}(t^{\\prime})\\,,\" display=\"inline\"><mrow><mrow><mrow><mi>\u03b4</mi><mo>\u2062</mo><msub><mi>Q</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mi>j</mi></munder></mstyle><mrow><mstyle displaystyle=\"true\"><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mpadded width=\"0pt\"><mn>0</mn></mpadded><mpadded width=\"0pt\"><mi>t</mi></mpadded></msubsup></mstyle><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\ud</mtext></merror><mo>\u2062</mo><mpadded width=\"+1.7pt\"><msup><mi>t</mi><mo>\u2032</mo></msup></mpadded><mo>\u2062</mo><msub><mi>\u03c7</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>t</mi><mo>-</mo><msup><mi>t</mi><mo>\u2032</mo></msup></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>\u03b4</mi><mo>\u2062</mo><msub><mi>v</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>t</mi><mo>\u2032</mo></msup><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.00747.tex", "nexttext": "\nwhere $w_L \\geq 0$ are the weights of the the states $\\ket{\\Psi_L}$ in the ensemble and should sum to one.\nIn the definition of the response function, I have used the interaction picture, so $\\hat{Q}_{H_0,i}(t) {\\coloneqq} {\\mathrm{e}}^{{\\textrm{i}}\\hat{H}_0t}\\hat{Q}_i{\\mathrm{e}}^{-{\\textrm{i}}\\hat{H}_0t}$. In other words, the operators are in the Heisenberg representation with respect to the unperturbed Hamiltonian, $H_0$. To make the response function causal (retarded), the definition also includes a Heaviside function, which is defined as\n\n", "itemtype": "equation", "pos": 9931, "prevtext": "\nwhere $\\chi_{ij}(t-t')$ is the retarded linear response function which is readily generalized to initial ensembles as\n\n", "index": 5, "text": "\\begin{align*}\n\\chi_{ij}(t-t') {\\coloneqq} -{\\textrm{i}}\\theta(t - t')\\sum_Lw_L \\brakket{\\Psi_L}{[\\hat{Q}_{H_0,i}(t),\\hat{Q}_{H_0,j}(t')]}{\\Psi_L} \\, ,\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\chi_{ij}(t-t^{\\prime}){\\coloneqq}-{\\textrm{i}}\\theta(t-t^{\\prime%&#10;})\\sum_{L}w_{L}\\brakket{\\Psi_{L}}{[\\hat{Q}_{H_{0},i}(t),\\hat{Q}_{H_{0},j}(t^{%&#10;\\prime})]}{\\Psi_{L}}\\,,\" display=\"inline\"><mrow><mrow><mrow><msub><mi>\u03c7</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>t</mi><mo>-</mo><msup><mi>t</mi><mo>\u2032</mo></msup></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2254</mo><mrow><mo>-</mo><mrow><mtext>i</mtext><mo>\u2062</mo><mi>\u03b8</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>t</mi><mo>-</mo><msup><mi>t</mi><mo>\u2032</mo></msup></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mi>L</mi></munder></mstyle><mrow><msub><mi>w</mi><mi>L</mi></msub><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\brakket</mtext></merror><mo>\u2062</mo><msub><mi mathvariant=\"normal\">\u03a8</mi><mi>L</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><msub><mover accent=\"true\"><mi>Q</mi><mo stretchy=\"false\">^</mo></mover><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>,</mo><mi>i</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>,</mo><mrow><msub><mover accent=\"true\"><mi>Q</mi><mo stretchy=\"false\">^</mo></mover><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>,</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>t</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">]</mo></mrow><mo>\u2062</mo><mpadded width=\"+1.7pt\"><msub><mi mathvariant=\"normal\">\u03a8</mi><mi>L</mi></msub></mpadded></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.00747.tex", "nexttext": "\nThe retarded response function for ensembles can be expressed in its Lehmann representation by inserting a complete set of eigenstates of the unperturbed Hamiltonian, $\\hat{H}_0$, which gives\n\n", "itemtype": "equation", "pos": 10645, "prevtext": "\nwhere $w_L \\geq 0$ are the weights of the the states $\\ket{\\Psi_L}$ in the ensemble and should sum to one.\nIn the definition of the response function, I have used the interaction picture, so $\\hat{Q}_{H_0,i}(t) {\\coloneqq} {\\mathrm{e}}^{{\\textrm{i}}\\hat{H}_0t}\\hat{Q}_i{\\mathrm{e}}^{-{\\textrm{i}}\\hat{H}_0t}$. In other words, the operators are in the Heisenberg representation with respect to the unperturbed Hamiltonian, $H_0$. To make the response function causal (retarded), the definition also includes a Heaviside function, which is defined as\n\n", "index": 7, "text": "\\begin{align*}\n\\theta(x) {\\coloneqq} \\begin{cases}\n1 &\\text{for $x > 0$} \\\\\n0 &\\text{for $x < 0$} \\, .\n\\end{cases}\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\theta(x){\\coloneqq}\\begin{cases}1&amp;\\text{for $x&gt;0$}\\\\&#10;0&amp;\\text{for $x&lt;0$}\\,.\\end{cases}\" display=\"inline\"><mrow><mrow><mi>\u03b8</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2254</mo><mrow><mo>{</mo><mtable columnspacing=\"5pt\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mn>1</mn></mtd><mtd columnalign=\"left\"><mrow><mtext>for\u00a0</mtext><mrow><mi>x</mi><mo>&gt;</mo><mn>0</mn></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mn>0</mn></mtd><mtd columnalign=\"left\"><mrow><mpadded width=\"+1.7pt\"><mrow><mtext>for\u00a0</mtext><mrow><mi>x</mi><mo>&lt;</mo><mn>0</mn></mrow></mrow></mpadded><mo>.</mo></mrow></mtd></mtr></mtable></mrow></mrow></math>", "type": "latex"}, {"file": "1601.00747.tex", "nexttext": "\nwhere $\\Omega_{KL} {\\coloneqq} E_K - E_L$ are (de-)excitation energies of $\\hat{H}_0$ and $q^{KL}_i {\\coloneqq} \\brakket{\\Psi_K}{\\hat{Q}_i}{\\Psi_L}$. With the help of the Lehmann representation of the response function we can write the perturbation in the expectation values as\n\n", "itemtype": "equation", "pos": 10965, "prevtext": "\nThe retarded response function for ensembles can be expressed in its Lehmann representation by inserting a complete set of eigenstates of the unperturbed Hamiltonian, $\\hat{H}_0$, which gives\n\n", "index": 9, "text": "\\begin{align}\\label{eq:Lehmann}\n\\chi_{ij}(t-t') &= {\\textrm{i}}\\theta(t-t')\\sum_{KL}w_L\\,{\\mathrm{e}}^{{\\textrm{i}}\\Omega_{KL}(t-t')}q_j^{LK}q_i^{KL} + \\text{c.c.} \\, ,\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\chi_{ij}(t-t^{\\prime})\" display=\"inline\"><mrow><msub><mi>\u03c7</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>t</mi><mo>-</mo><msup><mi>t</mi><mo>\u2032</mo></msup></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle={\\textrm{i}}\\theta(t-t^{\\prime})\\sum_{KL}w_{L}\\,{\\mathrm{e}}^{{%&#10;\\textrm{i}}\\Omega_{KL}(t-t^{\\prime})}q_{j}^{LK}q_{i}^{KL}+\\text{c.c.}\\,,\" display=\"inline\"><mrow><mrow><mi/><mo>=</mo><mrow><mrow><mtext>i</mtext><mo>\u2062</mo><mi>\u03b8</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>t</mi><mo>-</mo><msup><mi>t</mi><mo>\u2032</mo></msup></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow></munder></mstyle><mrow><mpadded width=\"+1.7pt\"><msub><mi>w</mi><mi>L</mi></msub></mpadded><mo>\u2062</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mtext>i</mtext><mo>\u2062</mo><msub><mi mathvariant=\"normal\">\u03a9</mi><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>t</mi><mo>-</mo><msup><mi>t</mi><mo>\u2032</mo></msup></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msup><mo>\u2062</mo><msubsup><mi>q</mi><mi>j</mi><mrow><mi>L</mi><mo>\u2062</mo><mi>K</mi></mrow></msubsup><mo>\u2062</mo><msubsup><mi>q</mi><mi>i</mi><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow></msubsup></mrow></mrow></mrow><mo>+</mo><mpadded width=\"+1.7pt\"><mtext>c.c.</mtext></mpadded></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.00747.tex", "nexttext": "\nwhere\n\n", "itemtype": "equation", "pos": 11424, "prevtext": "\nwhere $\\Omega_{KL} {\\coloneqq} E_K - E_L$ are (de-)excitation energies of $\\hat{H}_0$ and $q^{KL}_i {\\coloneqq} \\brakket{\\Psi_K}{\\hat{Q}_i}{\\Psi_L}$. With the help of the Lehmann representation of the response function we can write the perturbation in the expectation values as\n\n", "index": 11, "text": "\\begin{align*}\n\\delta Q_i(t) = {\\textrm{i}}\\sum_{KL}w_L\\,{\\int^{\\mathrlap{{t}}}_{\\mathrlap{{0}}}\\ud{{t'}}\\,}\nq_i^{KL}\\,a_{LK}(t'){\\mathrm{e}}^{{\\textrm{i}}\\Omega_{KL}(t-t')} + \\text{c.c.} \\, ,\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\delta Q_{i}(t)={\\textrm{i}}\\sum_{KL}w_{L}\\,{\\int^{\\mathrlap{{t}}%&#10;}_{\\mathrlap{{0}}}\\ud{{t^{\\prime}}}\\,}q_{i}^{KL}\\,a_{LK}(t^{\\prime}){\\mathrm{e%&#10;}}^{{\\textrm{i}}\\Omega_{KL}(t-t^{\\prime})}+\\text{c.c.}\\,,\" display=\"inline\"><mrow><mrow><mrow><mi>\u03b4</mi><mo>\u2062</mo><msub><mi>Q</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mtext>i</mtext><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow></munder></mstyle><mrow><mpadded width=\"+1.7pt\"><msub><mi>w</mi><mi>L</mi></msub></mpadded><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mpadded width=\"0pt\"><mn>0</mn></mpadded><mpadded width=\"0pt\"><mi>t</mi></mpadded></msubsup></mstyle><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\ud</mtext></merror><mo>\u2062</mo><mpadded width=\"+1.7pt\"><msup><mi>t</mi><mo>\u2032</mo></msup></mpadded><mo>\u2062</mo><mpadded width=\"+1.7pt\"><msubsup><mi>q</mi><mi>i</mi><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow></msubsup></mpadded><mo>\u2062</mo><msub><mi>a</mi><mrow><mi>L</mi><mo>\u2062</mo><mi>K</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>t</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mtext>i</mtext><mo>\u2062</mo><msub><mi mathvariant=\"normal\">\u03a9</mi><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>t</mi><mo>-</mo><msup><mi>t</mi><mo>\u2032</mo></msup></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msup></mrow></mrow></mrow></mrow></mrow><mo>+</mo><mpadded width=\"+1.7pt\"><mtext>c.c.</mtext></mpadded></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.00747.tex", "nexttext": "\nThe time-integral has the form of a convolution product, which is readily deconvoluted by taking the Laplace transform\n\n", "itemtype": "equation", "pos": 11636, "prevtext": "\nwhere\n\n", "index": 13, "text": "\\begin{align*}\na_{KL}(t) {\\coloneqq} \\sum_j q_j^{KL}\\delta v_j(t) \\, .\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex6.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle a_{KL}(t){\\coloneqq}\\sum_{j}q_{j}^{KL}\\delta v_{j}(t)\\,.\" display=\"inline\"><mrow><mrow><mrow><msub><mi>a</mi><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2254</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mi>j</mi></munder></mstyle><mrow><msubsup><mi>q</mi><mi>j</mi><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow></msubsup><mo>\u2062</mo><mi>\u03b4</mi><mo>\u2062</mo><msub><mi>v</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.00747.tex", "nexttext": "\nwhere the Laplace transform is defined as\n\n", "itemtype": "equation", "pos": 11839, "prevtext": "\nThe time-integral has the form of a convolution product, which is readily deconvoluted by taking the Laplace transform\n\n", "index": 15, "text": "\\begin{align*}\n{\\operatorname{\\mathcal{L}}}[\\delta Q_i](s) = {\\textrm{i}}\\sum_{KL}w_L\\,q_i^{KL}\\frac{{\\operatorname{\\mathcal{L}}}[a_{LK}](s)}{s - {\\textrm{i}}\\Omega_{KL}} + \\text{c.c.} \\, ,\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex7.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle{\\operatorname{\\mathcal{L}}}[\\delta Q_{i}](s)={\\textrm{i}}\\sum_{%&#10;KL}w_{L}\\,q_{i}^{KL}\\frac{{\\operatorname{\\mathcal{L}}}[a_{LK}](s)}{s-{\\textrm{%&#10;i}}\\Omega_{KL}}+\\text{c.c.}\\,,\" display=\"inline\"><mrow><mrow><mrow><mrow><mo class=\"ltx_font_mathcaligraphic\">\u2112</mo><mo>\u2061</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mi>\u03b4</mi><mo>\u2062</mo><msub><mi>Q</mi><mi>i</mi></msub></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mtext>i</mtext><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow></munder></mstyle><mrow><mpadded width=\"+1.7pt\"><msub><mi>w</mi><mi>L</mi></msub></mpadded><mo>\u2062</mo><msubsup><mi>q</mi><mi>i</mi><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow></msubsup><mo>\u2062</mo><mstyle displaystyle=\"true\"><mfrac><mrow><mrow><mo class=\"ltx_font_mathcaligraphic\">\u2112</mo><mo>\u2061</mo><mrow><mo stretchy=\"false\">[</mo><msub><mi>a</mi><mrow><mi>L</mi><mo>\u2062</mo><mi>K</mi></mrow></msub><mo stretchy=\"false\">]</mo></mrow></mrow><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mi>s</mi><mo>-</mo><mrow><mtext>i</mtext><mo>\u2062</mo><msub><mi mathvariant=\"normal\">\u03a9</mi><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow></msub></mrow></mrow></mfrac></mstyle></mrow></mrow></mrow><mo>+</mo><mpadded width=\"+1.7pt\"><mtext>c.c.</mtext></mpadded></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.00747.tex", "nexttext": "\nTo derive our working condition, we multiply by the Laplace transform of the perturbing potentials, ${\\operatorname{\\mathcal{L}}}[\\delta v_i](s)$ and sum over the remaining index\n\n", "itemtype": "equation", "pos": 12084, "prevtext": "\nwhere the Laplace transform is defined as\n\n", "index": 17, "text": "\\begin{align*}\n{\\operatorname{\\mathcal{L}}} [f](s) {\\coloneqq} {\\int^{\\mathrlap{{\\infty}}}_{\\mathrlap{{0}}}\\ud{{t}}\\,} {\\mathrm{e}}^{-st}f(t) .\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex8.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle{\\operatorname{\\mathcal{L}}}[f](s){\\coloneqq}{\\int^{\\mathrlap{{%&#10;\\infty}}}_{\\mathrlap{{0}}}\\ud{{t}}\\,}{\\mathrm{e}}^{-st}f(t).\" display=\"inline\"><mrow><mrow><mrow><mrow><mo class=\"ltx_font_mathcaligraphic\">\u2112</mo><mo>\u2061</mo><mrow><mo stretchy=\"false\">[</mo><mi>f</mi><mo stretchy=\"false\">]</mo></mrow></mrow><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2254</mo><mrow><mstyle displaystyle=\"true\"><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mpadded width=\"0pt\"><mn>0</mn></mpadded><mpadded width=\"0pt\"><mi mathvariant=\"normal\">\u221e</mi></mpadded></msubsup></mstyle><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\ud</mtext></merror><mo>\u2062</mo><mpadded width=\"+1.7pt\"><mi>t</mi></mpadded><mo>\u2062</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mo>-</mo><mrow><mi>s</mi><mo>\u2062</mo><mi>t</mi></mrow></mrow></msup><mo>\u2062</mo><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.00747.tex", "nexttext": "\nHence, in absence of response we find the following necessary condition\n\n", "itemtype": "equation", "pos": 12420, "prevtext": "\nTo derive our working condition, we multiply by the Laplace transform of the perturbing potentials, ${\\operatorname{\\mathcal{L}}}[\\delta v_i](s)$ and sum over the remaining index\n\n", "index": 19, "text": "\\begin{align*}\n\\sum_i{\\operatorname{\\mathcal{L}}}[\\delta v_i](s)\\,{\\operatorname{\\mathcal{L}}}[\\delta Q_i](s)\n= -2\\sum_{KL}w_L\\,\\frac{\\Omega_{KL}}{s^2 + \\Omega_{KL}^2}\\abs{{\\operatorname{\\mathcal{L}}}[a_{LK}](s)}^2 \\, .\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex9.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\sum_{i}{\\operatorname{\\mathcal{L}}}[\\delta v_{i}](s)\\,{%&#10;\\operatorname{\\mathcal{L}}}[\\delta Q_{i}](s)=-2\\sum_{KL}w_{L}\\,\\frac{\\Omega_{%&#10;KL}}{s^{2}+\\Omega_{KL}^{2}}\\abs{{\\operatorname{\\mathcal{L}}}[a_{LK}](s)}^{2}\\,.\" display=\"inline\"><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mi>i</mi></munder></mstyle><mo class=\"ltx_font_mathcaligraphic\">\u2112</mo><mrow><mo stretchy=\"false\">[</mo><mi>\u03b4</mi><msub><mi>v</mi><mi>i</mi></msub><mo stretchy=\"false\">]</mo></mrow><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo class=\"ltx_font_mathcaligraphic\">\u2112</mo><mrow><mo stretchy=\"false\">[</mo><mi>\u03b4</mi><msub><mi>Q</mi><mi>i</mi></msub><mo stretchy=\"false\">]</mo></mrow><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><mo>=</mo><mo>-</mo><mn>2</mn><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow></munder></mstyle><mpadded width=\"+1.7pt\"><msub><mi>w</mi><mi>L</mi></msub></mpadded><mstyle displaystyle=\"true\"><mfrac><msub><mi mathvariant=\"normal\">\u03a9</mi><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow></msub><mrow><msup><mi>s</mi><mn>2</mn></msup><mo>+</mo><msubsup><mi mathvariant=\"normal\">\u03a9</mi><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow><mn>2</mn></msubsup></mrow></mfrac></mstyle><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\abs</mtext></merror><mo class=\"ltx_font_mathcaligraphic\">\u2112</mo><mrow><mo stretchy=\"false\">[</mo><msub><mi>a</mi><mrow><mi>L</mi><mo>\u2062</mo><mi>K</mi></mrow></msub><mo stretchy=\"false\">]</mo></mrow><mpadded width=\"+1.7pt\"><msup><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></mpadded><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.00747.tex", "nexttext": "\nNote that each $KL$ pair occurs twice in this summation and the terms $K = L$ do not contribute. The necessary condition can therefore be rewritten as\n\n", "itemtype": "equation", "pos": 12725, "prevtext": "\nHence, in absence of response we find the following necessary condition\n\n", "index": 21, "text": "\\begin{align*}\n0 = \\sum_{KL}\\frac{w_L\\Omega_{KL}}{s^2 + \\Omega_{KL}^2}\\abs{{\\operatorname{\\mathcal{L}}}[a_{KL}](s)}^2 \\, .\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex10.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle 0=\\sum_{KL}\\frac{w_{L}\\Omega_{KL}}{s^{2}+\\Omega_{KL}^{2}}\\abs{{%&#10;\\operatorname{\\mathcal{L}}}[a_{KL}](s)}^{2}\\,.\" display=\"inline\"><mrow><mn>0</mn><mo>=</mo><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow></munder></mstyle><mstyle displaystyle=\"true\"><mfrac><mrow><msub><mi>w</mi><mi>L</mi></msub><mo>\u2062</mo><msub><mi mathvariant=\"normal\">\u03a9</mi><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow></msub></mrow><mrow><msup><mi>s</mi><mn>2</mn></msup><mo>+</mo><msubsup><mi mathvariant=\"normal\">\u03a9</mi><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow><mn>2</mn></msubsup></mrow></mfrac></mstyle><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\abs</mtext></merror><mo class=\"ltx_font_mathcaligraphic\">\u2112</mo><mrow><mo stretchy=\"false\">[</mo><msub><mi>a</mi><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow></msub><mo stretchy=\"false\">]</mo></mrow><mpadded width=\"+1.7pt\"><msup><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></mpadded><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.00747.tex", "nexttext": "\nSimilar as in the proof for ground states, we would like to infer that this condition implies that all individual terms need to be zero. To do so, we demand that all individual terms are positive or zero, so we impose the following condition on the ensemble\n\n", "itemtype": "equation", "pos": 13012, "prevtext": "\nNote that each $KL$ pair occurs twice in this summation and the terms $K = L$ do not contribute. The necessary condition can therefore be rewritten as\n\n", "index": 23, "text": "\\begin{align}\\label{eq:nesCond}\n0 = \\sum_{\\crampedclap{K > L}}\\frac{(w_L - w_K)\\Omega_{KL}}{s^2 + \\Omega_{KL}^2}\\abs{{\\operatorname{\\mathcal{L}}}[a_{KL}](s)}^2 \\, .\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle 0=\\sum_{\\mathclap{K&gt;L}}\\frac{(w_{L}-w_{K})\\Omega_{KL}}{s^{2}+%&#10;\\Omega_{KL}^{2}}\\abs{{\\operatorname{\\mathcal{L}}}[a_{KL}](s)}^{2}\\,.\" display=\"inline\"><mrow><mn>0</mn><mo>=</mo><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mpadded lspace=\"-7.9pt\" width=\"0pt\"><mi>K</mi><mo>&gt;</mo><mi>L</mi></mpadded></munder></mstyle><mstyle displaystyle=\"true\"><mfrac><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>w</mi><mi>L</mi></msub><mo>-</mo><msub><mi>w</mi><mi>K</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi mathvariant=\"normal\">\u03a9</mi><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow></msub></mrow><mrow><msup><mi>s</mi><mn>2</mn></msup><mo>+</mo><msubsup><mi mathvariant=\"normal\">\u03a9</mi><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow><mn>2</mn></msubsup></mrow></mfrac></mstyle><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\abs</mtext></merror><mo class=\"ltx_font_mathcaligraphic\">\u2112</mo><mrow><mo stretchy=\"false\">[</mo><msub><mi>a</mi><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow></msub><mo stretchy=\"false\">]</mo></mrow><mpadded width=\"+1.7pt\"><msup><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></mpadded><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.00747.tex", "nexttext": "\nSo that means that for any two states with different energies with $E_K < E_L$, we require $w_K \\geq w_L$. This condition does not yield additional restrictions for degenerate states.\\footnote{Also $(w_L - w_K)\\Omega_{KL} \\leq 0$ would work as a condition on the ensemble. This option  works only for Hamiltonians bounded form above (finite basis), since the highest weight is associated to the highest energy. Further, this option is physically not very sensible, so this case is not explicitly pursued.} Note that the equality is not only satisfied for degenerate states, but also states with equal weights and possibly different energies. States for which the equality holds need a special treatment, so for each state we define\n\n", "itemtype": "equation", "pos": 13447, "prevtext": "\nSimilar as in the proof for ground states, we would like to infer that this condition implies that all individual terms need to be zero. To do so, we demand that all individual terms are positive or zero, so we impose the following condition on the ensemble\n\n", "index": 25, "text": "\\begin{align*}\n(w_L - w_K)\\Omega_{KL} \\geq 0 \\qquad \\text{for all $K$ and $L$} \\, .\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex11.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle(w_{L}-w_{K})\\Omega_{KL}\\geq 0\\qquad\\text{for all $K$ and $L$}\\,.\" display=\"inline\"><mrow><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>w</mi><mi>L</mi></msub><mo>-</mo><msub><mi>w</mi><mi>K</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi mathvariant=\"normal\">\u03a9</mi><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow></msub></mrow><mo>\u2265</mo><mrow><mn>0</mn><mo mathvariant=\"italic\" separator=\"true\">\u2003\u2003</mo><mpadded width=\"+1.7pt\"><mrow><mtext>for all\u00a0</mtext><mi>K</mi><mtext>\u00a0and\u00a0</mtext><mi>L</mi></mrow></mpadded></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.00747.tex", "nexttext": "\nI will refer to this subspace as the `extended degenerate subspace' of the state $K$, since not only states with the same energy belong to it, but also states with the same weight.\n\nArmed with this additional condition on the ensemble let us return to the necessary condition~\\eqref{eq:nesCond}. Since all the individual terms are zero or positive, we find that ${\\operatorname{\\mathcal{L}}}[a_{KL}](s) = 0$ if $L \\notin \\mathcal{D}(K)$. So in the time-domain we find that $a_{KL}(t) = 0$ almost everywhere. The first possibility is that $\\delta v_j(t) = 0$ almost everywhere. Typically one would also require $\\delta v_j(t) \\in C^1[0,T]$ (differentiable up to first order in the time-interval $[0,T]$) to guarantee a physical (strong) solution,\\footnote{In Ref.~\\cite{RuggenthalerPenzLeeuwen2015} it is stated that the condition $\\delta v_j(t) \\in C^1$ can probably be weakened to Lipschitz continuity. This is still sufficient for our argument, since we only need continuity. A milder version of the Schr\u00c3\u00b6dinger equation would allow for more general potentials in some $L^p$ spaces in time~\\cite{PenzRuggenthaler2015, RuggenthalerPenzLeeuwen2015}. In that case, however, potentials which only differ at a set of zero measure would be considered equivalent.} so the term `almost everywhere' is of no importance in physical situations. For more details on the solvability of the time-dependent Schr\u00c3\u00b6dinger equation and in particular when physical (strong) solutions exist, I refer the reader to an excellent exposition by Ruggenthaler, Penz and Van Leeuwen~\\cite{RuggenthalerPenzLeeuwen2015}. This first possibility is the trivial way to have no response (no potential), so is not the solution we are interested in.\n\nThe more interesting possibility is the existence of linear combinations of the operator $\\hat{Q}_j$, \n\n", "itemtype": "equation", "pos": 14276, "prevtext": "\nSo that means that for any two states with different energies with $E_K < E_L$, we require $w_K \\geq w_L$. This condition does not yield additional restrictions for degenerate states.\\footnote{Also $(w_L - w_K)\\Omega_{KL} \\leq 0$ would work as a condition on the ensemble. This option  works only for Hamiltonians bounded form above (finite basis), since the highest weight is associated to the highest energy. Further, this option is physically not very sensible, so this case is not explicitly pursued.} Note that the equality is not only satisfied for degenerate states, but also states with equal weights and possibly different energies. States for which the equality holds need a special treatment, so for each state we define\n\n", "index": 27, "text": "\\begin{align*}\n\\mathcal{D}(K) {\\coloneqq} \\bigl\\{L : (w_L - w_K)\\Omega_{KL} = 0\\bigr\\}\n\\equiv \\bigl\\{L : E_L = E_K \\lor w_L = w_K\\bigr\\} \\, .\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex12.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\mathcal{D}(K){\\coloneqq}\\bigl{\\{}L:(w_{L}-w_{K})\\Omega_{KL}=0%&#10;\\bigr{\\}}\\equiv\\bigl{\\{}L:E_{L}=E_{K}\\lor w_{L}=w_{K}\\bigr{\\}}\\,.\" display=\"inline\"><mrow><mrow><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udc9f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>K</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2254</mo><mrow><mo maxsize=\"120%\" minsize=\"120%\">{</mo><mi>L</mi><mo>:</mo><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>w</mi><mi>L</mi></msub><mo>-</mo><msub><mi>w</mi><mi>K</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi mathvariant=\"normal\">\u03a9</mi><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow></msub></mrow><mo>=</mo><mn>0</mn></mrow><mo maxsize=\"120%\" minsize=\"120%\">}</mo></mrow><mo>\u2261</mo><mrow><mo maxsize=\"120%\" minsize=\"120%\">{</mo><mi>L</mi><mo>:</mo><mrow><msub><mi>E</mi><mi>L</mi></msub><mo>=</mo><mrow><msub><mi>E</mi><mi>K</mi></msub><mo>\u2228</mo><msub><mi>w</mi><mi>L</mi></msub></mrow><mo>=</mo><msub><mi>w</mi><mi>K</mi></msub></mrow><mo maxsize=\"120%\" minsize=\"120%\" rspace=\"4.2pt\">}</mo></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.00747.tex", "nexttext": "\nsuch that $l_n^{LK} = \\brakket{\\Psi_L}{\\hat{L}_n}{\\Psi_K} = 0$ for all pairs $K, L \\notin \\mathcal{D}(K)$. In other words, we should look for operators $\\hat{L}_n$ such that they only give components in the extended degenerate subspace\n\n", "itemtype": "equation", "pos": 16253, "prevtext": "\nI will refer to this subspace as the `extended degenerate subspace' of the state $K$, since not only states with the same energy belong to it, but also states with the same weight.\n\nArmed with this additional condition on the ensemble let us return to the necessary condition~\\eqref{eq:nesCond}. Since all the individual terms are zero or positive, we find that ${\\operatorname{\\mathcal{L}}}[a_{KL}](s) = 0$ if $L \\notin \\mathcal{D}(K)$. So in the time-domain we find that $a_{KL}(t) = 0$ almost everywhere. The first possibility is that $\\delta v_j(t) = 0$ almost everywhere. Typically one would also require $\\delta v_j(t) \\in C^1[0,T]$ (differentiable up to first order in the time-interval $[0,T]$) to guarantee a physical (strong) solution,\\footnote{In Ref.~\\cite{RuggenthalerPenzLeeuwen2015} it is stated that the condition $\\delta v_j(t) \\in C^1$ can probably be weakened to Lipschitz continuity. This is still sufficient for our argument, since we only need continuity. A milder version of the Schr\u00c3\u00b6dinger equation would allow for more general potentials in some $L^p$ spaces in time~\\cite{PenzRuggenthaler2015, RuggenthalerPenzLeeuwen2015}. In that case, however, potentials which only differ at a set of zero measure would be considered equivalent.} so the term `almost everywhere' is of no importance in physical situations. For more details on the solvability of the time-dependent Schr\u00c3\u00b6dinger equation and in particular when physical (strong) solutions exist, I refer the reader to an excellent exposition by Ruggenthaler, Penz and Van Leeuwen~\\cite{RuggenthalerPenzLeeuwen2015}. This first possibility is the trivial way to have no response (no potential), so is not the solution we are interested in.\n\nThe more interesting possibility is the existence of linear combinations of the operator $\\hat{Q}_j$, \n\n", "index": 29, "text": "\\begin{align*}\n\\hat{L}_n = \\sum_j\\hat{Q}_j\\delta v_j^n \\, ,\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex13.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\hat{L}_{n}=\\sum_{j}\\hat{Q}_{j}\\delta v_{j}^{n}\\,,\" display=\"inline\"><mrow><mrow><msub><mover accent=\"true\"><mi>L</mi><mo stretchy=\"false\">^</mo></mover><mi>n</mi></msub><mo>=</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mi>j</mi></munder></mstyle><mrow><msub><mover accent=\"true\"><mi>Q</mi><mo stretchy=\"false\">^</mo></mover><mi>j</mi></msub><mo>\u2062</mo><mi>\u03b4</mi><mo>\u2062</mo><mpadded width=\"+1.7pt\"><msubsup><mi>v</mi><mi>j</mi><mi>n</mi></msubsup></mpadded></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.00747.tex", "nexttext": "\nIf any of such linear combinations exist, they are candidates to belong to the kernel of the retarded response function.\n\n\n\n\\section{Sufficiency}\n\\label{sec:sufCond}\nIn the previous section we have derived a necessary condition~\\eqref{eq:necessaryCondition} for potentials in the kernel of the response function. Suppose that we have found such a potential, we will now check to which extend this condition~\\eqref{eq:necessaryCondition} is also sufficient. We start by rewriting the Lehmann representation of the response function~\\eqref{eq:Lehmann} by retaining only the unique pairs in the sum\n\n", "itemtype": "equation", "pos": 16562, "prevtext": "\nsuch that $l_n^{LK} = \\brakket{\\Psi_L}{\\hat{L}_n}{\\Psi_K} = 0$ for all pairs $K, L \\notin \\mathcal{D}(K)$. In other words, we should look for operators $\\hat{L}_n$ such that they only give components in the extended degenerate subspace\n\n", "index": 31, "text": "\\begin{align}\\label{eq:necessaryCondition}\n\\hat{L}_n\\ket{\\Psi_K} = \\sum_{\\crampedclap{L \\in \\mathcal{D}(K)}}l_n^{LK}\\ket{\\Psi_L} \\, .\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\hat{L}_{n}\\ket{\\Psi_{K}}=\\sum_{\\mathclap{L\\in\\mathcal{D}(K)}}l_{%&#10;n}^{LK}\\ket{\\Psi_{L}}\\,.\" display=\"inline\"><mrow><mrow><mrow><msub><mover accent=\"true\"><mi>L</mi><mo stretchy=\"false\">^</mo></mover><mi>n</mi></msub><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\ket</mtext></merror><mo>\u2062</mo><msub><mi mathvariant=\"normal\">\u03a8</mi><mi>K</mi></msub></mrow><mo>=</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mpadded lspace=\"-15.7pt\" width=\"0pt\"><mi>L</mi><mo>\u2208</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udc9f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>K</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mpadded></munder></mstyle><mrow><msubsup><mi>l</mi><mi>n</mi><mrow><mi>L</mi><mo>\u2062</mo><mi>K</mi></mrow></msubsup><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\ket</mtext></merror><mo>\u2062</mo><mpadded width=\"+1.7pt\"><msub><mi mathvariant=\"normal\">\u03a8</mi><mi>L</mi></msub></mpadded></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.00747.tex", "nexttext": "\nI used here that the $K = L$ terms drop out of the summation. \nIf there exists one or more operators $\\hat{L}_n$ which satisfy~\\eqref{eq:necessaryCondition}, we find that the response is only truly zero if\n\n", "itemtype": "equation", "pos": 17304, "prevtext": "\nIf any of such linear combinations exist, they are candidates to belong to the kernel of the retarded response function.\n\n\n\n\\section{Sufficiency}\n\\label{sec:sufCond}\nIn the previous section we have derived a necessary condition~\\eqref{eq:necessaryCondition} for potentials in the kernel of the response function. Suppose that we have found such a potential, we will now check to which extend this condition~\\eqref{eq:necessaryCondition} is also sufficient. We start by rewriting the Lehmann representation of the response function~\\eqref{eq:Lehmann} by retaining only the unique pairs in the sum\n\n", "index": 33, "text": "\\begin{align*}\n\\chi_{ij}(t-t') \n&= {\\textrm{i}}\\theta(t-t')\\sum_{K > L}(w_L - w_K)\\,{\\mathrm{e}}^{{\\textrm{i}}\\Omega_{KL}(t-t')}q_j^{LK}q_i^{KL} + \\text{c.c.} \\, .\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex14.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\chi_{ij}(t-t^{\\prime})\" display=\"inline\"><mrow><msub><mi>\u03c7</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>t</mi><mo>-</mo><msup><mi>t</mi><mo>\u2032</mo></msup></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex14.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle={\\textrm{i}}\\theta(t-t^{\\prime})\\sum_{K&gt;L}(w_{L}-w_{K})\\,{%&#10;\\mathrm{e}}^{{\\textrm{i}}\\Omega_{KL}(t-t^{\\prime})}q_{j}^{LK}q_{i}^{KL}+\\text{%&#10;c.c.}\\,.\" display=\"inline\"><mrow><mrow><mi/><mo>=</mo><mrow><mrow><mtext>i</mtext><mo>\u2062</mo><mi>\u03b8</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>t</mi><mo>-</mo><msup><mi>t</mi><mo>\u2032</mo></msup></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>K</mi><mo>&gt;</mo><mi>L</mi></mrow></munder></mstyle><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>w</mi><mi>L</mi></msub><mo>-</mo><msub><mi>w</mi><mi>K</mi></msub></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mtext>i</mtext><mo>\u2062</mo><msub><mi mathvariant=\"normal\">\u03a9</mi><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>t</mi><mo>-</mo><msup><mi>t</mi><mo>\u2032</mo></msup></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msup><mo>\u2062</mo><msubsup><mi>q</mi><mi>j</mi><mrow><mi>L</mi><mo>\u2062</mo><mi>K</mi></mrow></msubsup><mo>\u2062</mo><msubsup><mi>q</mi><mi>i</mi><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow></msubsup></mrow></mrow></mrow><mo>+</mo><mpadded width=\"+1.7pt\"><mtext>c.c.</mtext></mpadded></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.00747.tex", "nexttext": "\nNote that due to necessary condition~\\eqref{eq:necessaryCondition}, the sum could be restricted to pairs in their respective extended degenerate subspace.\nSince states with equal weights do not actually contribute to this sum, we can further restrict the summation over pairs which have different weights, so only (energetically) degenerate states can contribute\n\n", "itemtype": "equation", "pos": 17687, "prevtext": "\nI used here that the $K = L$ terms drop out of the summation. \nIf there exists one or more operators $\\hat{L}_n$ which satisfy~\\eqref{eq:necessaryCondition}, we find that the response is only truly zero if\n\n", "index": 35, "text": "\\begin{align*}\n0 = {\\textrm{i}}\\sum_{\\mathclap{L < K \\in \\mathcal{D}(L)}}(w_L - w_K)\\,{\\mathrm{e}}^{{\\textrm{i}}\\Omega_{KL}(t-t')}q_j^{LK}l_n^{KL} + \\text{c.c.} \n\\quad \\forall_j \\, .\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex15.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle 0={\\textrm{i}}\\sum_{\\mathclap{L&lt;K\\in\\mathcal{D}(L)}}(w_{L}-w_{K}%&#10;)\\,{\\mathrm{e}}^{{\\textrm{i}}\\Omega_{KL}(t-t^{\\prime})}q_{j}^{LK}l_{n}^{KL}+%&#10;\\text{c.c.}\\quad\\forall_{j}\\,.\" display=\"inline\"><mrow><mrow><mn>0</mn><mo>=</mo><mrow><mrow><mrow><mtext>i</mtext><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mpadded lspace=\"-21.0pt\" width=\"0pt\"><mi>L</mi><mo>&lt;</mo><mi>K</mi><mo>\u2208</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udc9f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>L</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mpadded></munder></mstyle><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>w</mi><mi>L</mi></msub><mo>-</mo><msub><mi>w</mi><mi>K</mi></msub></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msup><mi mathvariant=\"normal\">e</mi><mrow><mtext>i</mtext><mo>\u2062</mo><msub><mi mathvariant=\"normal\">\u03a9</mi><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>t</mi><mo>-</mo><msup><mi>t</mi><mo>\u2032</mo></msup></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msup><mo>\u2062</mo><msubsup><mi>q</mi><mi>j</mi><mrow><mi>L</mi><mo>\u2062</mo><mi>K</mi></mrow></msubsup><mo>\u2062</mo><msubsup><mi>l</mi><mi>n</mi><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow></msubsup></mrow></mrow></mrow><mo>+</mo><mtext>c.c.</mtext></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003</mo><mpadded width=\"+1.7pt\"><msub><mo>\u2200</mo><mi>j</mi></msub></mpadded></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.00747.tex", "nexttext": "\nwhere we used that $\\Omega_{KL} = 0$ for degenerate states and introduced\n\n", "itemtype": "equation", "pos": 18246, "prevtext": "\nNote that due to necessary condition~\\eqref{eq:necessaryCondition}, the sum could be restricted to pairs in their respective extended degenerate subspace.\nSince states with equal weights do not actually contribute to this sum, we can further restrict the summation over pairs which have different weights, so only (energetically) degenerate states can contribute\n\n", "index": 37, "text": "\\begin{align}\\label{eq:suffiencyCondition}\n0 = {\\textrm{i}}\\sum_{\\mathclap{L < K \\in \\mathcal{D}^r(L)}}(w_L - w_K)q_j^{LK}l_n^{KL} + \\text{c.c.} \n\\quad \\forall_j \\, .\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle 0={\\textrm{i}}\\sum_{\\mathclap{L&lt;K\\in\\mathcal{D}^{r}(L)}}(w_{L}-w%&#10;_{K})q_{j}^{LK}l_{n}^{KL}+\\text{c.c.}\\quad\\forall_{j}\\,.\" display=\"inline\"><mrow><mrow><mn>0</mn><mo>=</mo><mrow><mrow><mrow><mtext>i</mtext><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mpadded lspace=\"-22.5pt\" width=\"0pt\"><mi>L</mi><mo>&lt;</mo><mi>K</mi><mo>\u2208</mo><mrow><msup><mi class=\"ltx_font_mathcaligraphic\">\ud835\udc9f</mi><mi>r</mi></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>L</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mpadded></munder></mstyle><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>w</mi><mi>L</mi></msub><mo>-</mo><msub><mi>w</mi><mi>K</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msubsup><mi>q</mi><mi>j</mi><mrow><mi>L</mi><mo>\u2062</mo><mi>K</mi></mrow></msubsup><mo>\u2062</mo><msubsup><mi>l</mi><mi>n</mi><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow></msubsup></mrow></mrow></mrow><mo>+</mo><mtext>c.c.</mtext></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003</mo><mpadded width=\"+1.7pt\"><msub><mo>\u2200</mo><mi>j</mi></msub></mpadded></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.00747.tex", "nexttext": "\nFrom this form of the sufficiency condition~\\eqref{eq:suffiencyCondition} we can extract two important results. The first result is a generalization of the commutator form for the sufficiency condition~\\cite{Giesbertz2015}. Since for other pairs $L$ and $K \\notin \\mathcal{D}^r(L)$ we have that either $w_L = w_K$ or $l_n^{KL} = 0$, we can put them back into the summation without affecting the result. This yields the following form for the sufficiency condition\n\n", "itemtype": "equation", "pos": 18499, "prevtext": "\nwhere we used that $\\Omega_{KL} = 0$ for degenerate states and introduced\n\n", "index": 39, "text": "\\begin{align*}\n\\mathcal{D}^r(L) {\\coloneqq} \\bigl\\{K : E_K = E_L \\land w_K \\neq w_L\\bigr\\} \\, .\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex16.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\mathcal{D}^{r}(L){\\coloneqq}\\bigl{\\{}K:E_{K}=E_{L}\\land w_{K}%&#10;\\neq w_{L}\\bigr{\\}}\\,.\" display=\"inline\"><mrow><mrow><mrow><msup><mi class=\"ltx_font_mathcaligraphic\">\ud835\udc9f</mi><mi>r</mi></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>L</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2254</mo><mrow><mo maxsize=\"120%\" minsize=\"120%\">{</mo><mi>K</mi><mo>:</mo><mrow><msub><mi>E</mi><mi>K</mi></msub><mo>=</mo><mrow><msub><mi>E</mi><mi>L</mi></msub><mo>\u2227</mo><msub><mi>w</mi><mi>K</mi></msub></mrow><mo>\u2260</mo><msub><mi>w</mi><mi>L</mi></msub></mrow><mo maxsize=\"120%\" minsize=\"120%\" rspace=\"4.2pt\">}</mo></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.00747.tex", "nexttext": "\nNote that this expression correctly reduces to the pure state case if $w_0 = 1$ (so $w_{i>0} = 0$). It will be hard to check this condition for general ensembles.\n\nA more useful result is obtained by noting that if the weights only depend on the energy, $w_K = w(E_K)$, that for degenerate state the weights are equal. This implies that $D^r(K) = \\emptyset$ for any $K$, so the sufficiency condition~\\eqref{eq:suffiencyCondition} is trivially satisfied, since the sum does not run over anything anymore. Hence, condition~\\eqref{eq:necessaryCondition} is for these ensembles not only necessary, but also sufficient. Note that the canonical and the grand canonical ensembles exactly belong this category of ensembles.\n\n\n\n\n\\section{(Grand) Canonical ensembles}\n\\label{sec:thermoEnsembles}\nIn this section we will specialize ourselves to the (grand) canonical ensembles.\nIn the (grand) canonical ensemble all states in the Hilbert space contribute. The only difference between the canonical and grand canonical ensemble is the extend of their Hilbert spaces. In the canonical ensemble the Hilbert space only consists of states with a specific particle number, $N$. In the grand canonical ensemble also states with a different particle number are included, so the full Fock space is taken as the Hilbert space. The number of particles is then regulated via a constant shift in the potential: the chemical potential.\n\nThe most important thing to realise is that all states contribute to response function in the (grand) canonical ensemble, because all weights are non-zero. So the necessary and sufficient condition~\\eqref{eq:necessaryCondition} can only be satisfied if and only if all eigenstates of the unperturbed Hamiltonian $H_0$ can be expressed as eigenstates of the operator $\\hat{L}_n$. This is only the case if the operator $\\hat{L}_n$ commutes with the Hamiltonian.\n\n", "itemtype": "equation", "pos": 19072, "prevtext": "\nFrom this form of the sufficiency condition~\\eqref{eq:suffiencyCondition} we can extract two important results. The first result is a generalization of the commutator form for the sufficiency condition~\\cite{Giesbertz2015}. Since for other pairs $L$ and $K \\notin \\mathcal{D}^r(L)$ we have that either $w_L = w_K$ or $l_n^{KL} = 0$, we can put them back into the summation without affecting the result. This yields the following form for the sufficiency condition\n\n", "index": 41, "text": "\\begin{align}\n0 &= \\sum_{\\mathclap{L,K}}(w_L - w_K)q_i^{LK}l_n^{KL} + \\text{c.c.} \\notag \\\\\n&= \\sum_Kw_K\\brakket[\\big]{\\Psi_K}{\\bigl[\\hat{Q}_i,\\hat{L}_n\\bigr]}{\\Psi_K} = 0 \\qquad \\forall_i \\, .\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex17.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle 0\" display=\"inline\"><mn>0</mn></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex17.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\sum_{\\mathclap{L,K}}(w_{L}-w_{K})q_{i}^{LK}l_{n}^{KL}+\\text{c.c.}\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>L</mi><mo>,</mo><mi>K</mi></mrow></munder></mstyle><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>w</mi><mi>L</mi></msub><mo>-</mo><msub><mi>w</mi><mi>K</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msubsup><mi>q</mi><mi>i</mi><mrow><mi>L</mi><mo>\u2062</mo><mi>K</mi></mrow></msubsup><mo>\u2062</mo><msubsup><mi>l</mi><mi>n</mi><mrow><mi>K</mi><mo>\u2062</mo><mi>L</mi></mrow></msubsup></mrow></mrow><mo>+</mo><mtext>c.c.</mtext></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\sum_{K}w_{K}\\brakket[\\big{]}{\\Psi_{K}}{\\bigl{[}\\hat{Q}_{i},\\hat%&#10;{L}_{n}\\bigr{]}}{\\Psi_{K}}=0\\qquad\\forall_{i}\\,.\" display=\"inline\"><mrow><mrow><mrow><mi/><mo>=</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mi>K</mi></munder></mstyle><mrow><msub><mi>w</mi><mi>K</mi></msub><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\brakket</mtext></merror><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mo maxsize=\"120%\" minsize=\"120%\">]</mo></mrow><mo>\u2062</mo><msub><mi mathvariant=\"normal\">\u03a8</mi><mi>K</mi></msub><mo>\u2062</mo><mrow><mo maxsize=\"120%\" minsize=\"120%\">[</mo><msub><mover accent=\"true\"><mi>Q</mi><mo stretchy=\"false\">^</mo></mover><mi>i</mi></msub><mo>,</mo><msub><mover accent=\"true\"><mi>L</mi><mo stretchy=\"false\">^</mo></mover><mi>n</mi></msub><mo maxsize=\"120%\" minsize=\"120%\">]</mo></mrow><mo>\u2062</mo><msub><mi mathvariant=\"normal\">\u03a8</mi><mi>K</mi></msub></mrow></mrow><mo>=</mo><mn>0</mn></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003\u2003</mo><mpadded width=\"+1.7pt\"><msub><mo>\u2200</mo><mi>i</mi></msub></mpadded></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.00747.tex", "nexttext": "\nNote that this is a much more stringent (and convenient) condition than in the $T=0$ case~\\cite{Giesbertz2015}. In the non-degenerate pure state case, only the ground state needs to be an eigenstate of the operator $\\hat{L}_n$ and the excited states are immaterial. In the degenerate $T = 0$ case, the operator $\\hat{L}_n$ is allowed to create components in the degenerate subspace, but again, the excited states do not play any role.\n\nIn the case of the retarded 1RDM response function, the weaker condition in the $T = 0$ case does give rise to some `pathological' potentials which do not commute with the initial Hamiltonian, $\\hat{H}_0$, as described in the introduction.\nIn the (grand) canonical ensemble case, however, only the potentials related to the symmetries of the Hamiltonian remain due to condition~\\eqref{eq:commuteCond}. In other words, \\emph{all} eigenstates of the initial Hamiltonian should be choosable as eigenfunctions of the operator $\\hat{L}_n$. Hence, the potentials in the kernel of the 1RDM response function for the (grand) canonical ensemble exactly coincide with the symmetry-induced ones of the zero temperature 1RDM response function. Some examples:\n\\begin{itemize}\n\\item Number conserving Hamiltonian: $\\hat{N}$.\n\\item Spin-independent Hamiltonian: $\\hat{{\\boldsymbol{{S}}}}$.\n\\item Linear molecule: $\\hat{L}_z$.\n\\item (Spherical) atoms: $\\hat{{\\boldsymbol{{L}}}}$.\n\\item Homogeneous electron gas: $\\hat{{\\boldsymbol{{L}}}}$ and $\\hat{{\\boldsymbol{{p}}}} {\\coloneqq} -{\\textrm{i}}\\nabla$.\n\\end{itemize}\nThere does not seem to be any difference between the kernels of the 1RDM response function in the canonical and grand canonical ensemble. The only case I can think of is the one-particle case in combination with an interacting Hamiltonian. In the canonical ensemble, only the 1-particle sector of the Fock space is used, so effectively the Hamiltonian is non-interacting. Since there is only one particle, \\emph{all} symmetry operators can be expressed as one-body operators even the discrete ones. In the grand canonical ensemble, also the states with a higher number of particles contribute. For these states, however, the discrete symmetries cannot be expressed as one-body operators. Hence, the discrete symmetries of the system are part of the kernel of the 1RDM response function in the $N=1$ case, only in the canonical ensemble and not in the grand canonical ensemble. Such a situation where the kernel of the retarded 1RDM response differs between the canonical and grand canonical ensembles, seems only to appear when $N = 1$.\n\nThere is one exceptional case I would like to mention in this context, where the broken symmetry due to the interaction is actually a continuous one. This is the so-called Runge--Lenz vector in hydrogenic systems\n\n", "itemtype": "equation", "pos": 21150, "prevtext": "\nNote that this expression correctly reduces to the pure state case if $w_0 = 1$ (so $w_{i>0} = 0$). It will be hard to check this condition for general ensembles.\n\nA more useful result is obtained by noting that if the weights only depend on the energy, $w_K = w(E_K)$, that for degenerate state the weights are equal. This implies that $D^r(K) = \\emptyset$ for any $K$, so the sufficiency condition~\\eqref{eq:suffiencyCondition} is trivially satisfied, since the sum does not run over anything anymore. Hence, condition~\\eqref{eq:necessaryCondition} is for these ensembles not only necessary, but also sufficient. Note that the canonical and the grand canonical ensembles exactly belong this category of ensembles.\n\n\n\n\n\\section{(Grand) Canonical ensembles}\n\\label{sec:thermoEnsembles}\nIn this section we will specialize ourselves to the (grand) canonical ensembles.\nIn the (grand) canonical ensemble all states in the Hilbert space contribute. The only difference between the canonical and grand canonical ensemble is the extend of their Hilbert spaces. In the canonical ensemble the Hilbert space only consists of states with a specific particle number, $N$. In the grand canonical ensemble also states with a different particle number are included, so the full Fock space is taken as the Hilbert space. The number of particles is then regulated via a constant shift in the potential: the chemical potential.\n\nThe most important thing to realise is that all states contribute to response function in the (grand) canonical ensemble, because all weights are non-zero. So the necessary and sufficient condition~\\eqref{eq:necessaryCondition} can only be satisfied if and only if all eigenstates of the unperturbed Hamiltonian $H_0$ can be expressed as eigenstates of the operator $\\hat{L}_n$. This is only the case if the operator $\\hat{L}_n$ commutes with the Hamiltonian.\n\n", "index": 43, "text": "\\begin{align}\\label{eq:commuteCond}\n\\bigl[\\hat{H}_0,\\hat{L}_n\\bigr] = 0 \\, .\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\bigl{[}\\hat{H}_{0},\\hat{L}_{n}\\bigr{]}=0\\,.\" display=\"inline\"><mrow><mrow><mrow><mo maxsize=\"120%\" minsize=\"120%\">[</mo><msub><mover accent=\"true\"><mi>H</mi><mo stretchy=\"false\">^</mo></mover><mn>0</mn></msub><mo>,</mo><msub><mover accent=\"true\"><mi>L</mi><mo stretchy=\"false\">^</mo></mover><mi>n</mi></msub><mo maxsize=\"120%\" minsize=\"120%\">]</mo></mrow><mo>=</mo><mpadded width=\"+1.7pt\"><mn>0</mn></mpadded></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.00747.tex", "nexttext": "\nwhere $Z$ is the atomic number.\nThe Runge--Lenz vector explains the degeneracy between the hydrogenic orbitals with different angular momenta, but the same principle quantum number. So in hydrogenic systems the Runge--Lenz vector will be part of the kernel of the 1RDM response function, if a canonical ensemble is considered as initial state. The Runge--Lenz vector, however, is only a symmetry for one-electron states, because the electron-electron interaction breaks this symmetry (the degeneracy between the $2s$ and $2p$ state is lifted). Since the macro canonical ensemble also includes states with more than one electron, the Runge--Lenz vector will therefore not be part of the kernel of the 1RDM response function for the grand canonical ensemble.\n\nFor completeness, I would like to point out that the same analysis implies that in the case of the density response function, nothing changes when going from the zero temperature to the finite temperature formalism. The only potential in the kernel of the density response function at $T = 0$ is the constant potential~\\cite{Leeuwen2001, Giesbertz2015} for particle number conserving Hamiltonians, $\\bigl[\\hat{H}_0,\\hat{N}\\bigr] = 0$. Since this potential corresponds to a symmetry of the Hamiltonian, this potential will also be the only possible component in the kernel of the density response function at $T > 0$. Hence also at finite temperature the density response function is invertible up to a constant for particle conserving Hamiltonians. The same result has also been obtained in a less general derivation limited only to the finite temperature density response function~\\cite{Pribram-JonesGrabowskiBurke2015}.\n\n\n\n\\section{What about time-independent response functions?}\n\\label{sec:timeINdependent}\nIn Ref.~\\cite{Giesbertz2015} I described how the $T = 0$ results for the time-dependent response function carried over to the time-independent response function for the non-degenerate ground state case. In the ensemble case such a transfer is not possible. The reason is that in the time-dependent response function, only the states are affected by the perturbations and not the weights of the ensemble as reflected by the commutator condition~\\eqref{eq:commuteCond}. So only the initial ensemble is in a thermodynamic equilibrium with the bath and at later times the system is essentially uncoupled from the bath.\n\nOn the contrary, in the time-independent case also perturbations in the weights are taken into account, via their dependence on the energies. Hence, in the time-independent case the response function does not only depend on the perturbation of the eigenstates, but also on the perturbation of the eigenvalues. This additional dependence therefore eliminates all operators from the kernel of the time-independent 1RDM response function for the (grand) canonical ensemble, since the both the eigenstates and eigenvalues need to be unperturbed. Only the number operator would remain for the canonical ensemble, since all states in the corresponding Hilbert space are degenerate with respect to the number operator, i.e.\\ the constant shift (chemical potential) does not affect the canonical ensemble. This result is exactly in agreement with previous work on finite temperature 1RDM functional theory by Van Leeuwen~\\cite{Leeuwen2007} and Baldsiefen~\\cite{BaldsiefenGross2012a, PhD-Baldsiefen2012}.\n\n\n\n\n\n\\section{Conclusion}\nI have further generalized the invertibility proof by van Leeuwen for the density response function~\\cite{Leeuwen2001}. This generalized proof is not only valid for the ground state as initial state, but works for general ensemble in which the weights of higher lying states are smaller than the weights of lower lying states. Two conditions were derived which are necessary and sufficient for a perturbation to yield no response at all. Without additional assumptions on the structure of the ensemble, these conditions are too cumbersome to make general statements. One of these conditions could be eliminated altogether, by requiring that the value of the weights are directly related to the energies of the states. Demanding additionally that all states participate in the ensemble (have a weight strictly larger than zero), the remaining condition simplifies even further to the requirement that potentials can be part of the kernel of the response if and only if they commute with the initial Hamiltonian. In particular for thermodynamic ensembles these assumptions hold.\n\nThat the potentials in the kernel of the response function need to commute with the Hamiltonian for thermodynamic ensembles is a much more stringent condition on these potentials than in the pure state case. This is a significant advantage when investigating the invertibility of the 1RDM response function. In the pure state case (zero temperature) one needs to take many `pathological' potentials into consideration which are related to the structure of the ground state. In finite temperature only potentials related to the symmetries of the system remain and these `pathological' potentials are of no concern anymore. Since such `pathological' potentials were not present in the density response function at zero temperature, the kernel of the density response function is the same in the zero and finite temperature formalism.\n\n\n\n\n\\section*{Acknowledgements}\nThe author would like to thank prof.dr.\\ R.~van Leeuwen for stimulating discussions.\nSupport from the Netherlands Foundation for Research NWO (722.012.013) through a VENI grant is gratefully acknowledged.\n\n\n\n\n\\bibliographystyle{tMPH}\n\\bibliography{bible}\n\n\n\n\n", "itemtype": "equation", "pos": 24027, "prevtext": "\nNote that this is a much more stringent (and convenient) condition than in the $T=0$ case~\\cite{Giesbertz2015}. In the non-degenerate pure state case, only the ground state needs to be an eigenstate of the operator $\\hat{L}_n$ and the excited states are immaterial. In the degenerate $T = 0$ case, the operator $\\hat{L}_n$ is allowed to create components in the degenerate subspace, but again, the excited states do not play any role.\n\nIn the case of the retarded 1RDM response function, the weaker condition in the $T = 0$ case does give rise to some `pathological' potentials which do not commute with the initial Hamiltonian, $\\hat{H}_0$, as described in the introduction.\nIn the (grand) canonical ensemble case, however, only the potentials related to the symmetries of the Hamiltonian remain due to condition~\\eqref{eq:commuteCond}. In other words, \\emph{all} eigenstates of the initial Hamiltonian should be choosable as eigenfunctions of the operator $\\hat{L}_n$. Hence, the potentials in the kernel of the 1RDM response function for the (grand) canonical ensemble exactly coincide with the symmetry-induced ones of the zero temperature 1RDM response function. Some examples:\n\\begin{itemize}\n\\item Number conserving Hamiltonian: $\\hat{N}$.\n\\item Spin-independent Hamiltonian: $\\hat{{\\boldsymbol{{S}}}}$.\n\\item Linear molecule: $\\hat{L}_z$.\n\\item (Spherical) atoms: $\\hat{{\\boldsymbol{{L}}}}$.\n\\item Homogeneous electron gas: $\\hat{{\\boldsymbol{{L}}}}$ and $\\hat{{\\boldsymbol{{p}}}} {\\coloneqq} -{\\textrm{i}}\\nabla$.\n\\end{itemize}\nThere does not seem to be any difference between the kernels of the 1RDM response function in the canonical and grand canonical ensemble. The only case I can think of is the one-particle case in combination with an interacting Hamiltonian. In the canonical ensemble, only the 1-particle sector of the Fock space is used, so effectively the Hamiltonian is non-interacting. Since there is only one particle, \\emph{all} symmetry operators can be expressed as one-body operators even the discrete ones. In the grand canonical ensemble, also the states with a higher number of particles contribute. For these states, however, the discrete symmetries cannot be expressed as one-body operators. Hence, the discrete symmetries of the system are part of the kernel of the 1RDM response function in the $N=1$ case, only in the canonical ensemble and not in the grand canonical ensemble. Such a situation where the kernel of the retarded 1RDM response differs between the canonical and grand canonical ensembles, seems only to appear when $N = 1$.\n\nThere is one exceptional case I would like to mention in this context, where the broken symmetry due to the interaction is actually a continuous one. This is the so-called Runge--Lenz vector in hydrogenic systems\n\n", "index": 45, "text": "\\begin{align*}\n{\\frac{1}{2}}\\bigl(\\hat{{\\boldsymbol{{p}}}} \\wedge \\hat{{\\boldsymbol{{L}}}} - \\hat{{\\boldsymbol{{L}}}} \\wedge \\hat{{\\boldsymbol{{p}}}}\\bigr) - Z\\frac{{\\mathbf{{r}}}}{\\abs{{\\mathbf{{r}}}}} ,\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex18.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle{\\frac{1}{2}}\\bigl{(}\\hat{{\\boldsymbol{{p}}}}\\wedge\\hat{{%&#10;\\boldsymbol{{L}}}}-\\hat{{\\boldsymbol{{L}}}}\\wedge\\hat{{\\boldsymbol{{p}}}}\\bigr%&#10;{)}-Z\\frac{{\\mathbf{{r}}}}{\\abs{{\\mathbf{{r}}}}},\" display=\"inline\"><mrow><mrow><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle><mo>\u2062</mo><mrow><mo maxsize=\"120%\" minsize=\"120%\">(</mo><mrow><mrow><mrow><mover accent=\"true\"><mi>\ud835\udc91</mi><mo stretchy=\"false\">^</mo></mover><mo>\u2227</mo><mover accent=\"true\"><mi>\ud835\udc73</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo>-</mo><mover accent=\"true\"><mi>\ud835\udc73</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo>\u2227</mo><mover accent=\"true\"><mi>\ud835\udc91</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo maxsize=\"120%\" minsize=\"120%\">)</mo></mrow></mrow><mo>-</mo><mrow><mi>Z</mi><mo>\u2062</mo><mstyle displaystyle=\"true\"><mfrac><mi>\ud835\udc2b</mi><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\abs</mtext></merror><mo>\u2062</mo><mi>\ud835\udc2b</mi></mrow></mfrac></mstyle></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}]