[{"file": "1601.06051.tex", "nexttext": "\n\nwhere \n", "itemtype": "equation", "pos": 7209, "prevtext": "\n\\title{Quantitative Quasiperiodicity}\n\\author{Suddhasattwa Das\\footnotemark[1], \\and Yoshitaka Saiki\\footnotemark[2],\n\\and Evelyn Sander\\footnotemark[3], \\and James A Yorke\\footnotemark[4]}\n\\footnotetext[1]{Department of Mathematics, University of Maryland, College Park}\n\\footnotetext[2]{Graduate School of Commerce and Management, Hitotsubashi University}\n\\footnotetext[3]{Department of Mathematical Sciences, George Mason University}\n\\footnotetext[4]{University of Maryland, College Park}\n\\date{\\today}\n\\maketitle\n\n\n\n\\begin{abstract}\n\n{ The Birkhoff Ergodic Theorem concludes that time averages, i.e.,\nBirkhoff averages, $\\Sigma_{n=0}^{N-1} f(x_n)/N$ of a function $f$ along\na length $N$ ergodic trajectory $(x_n)$  of a function $T$ converge to\nthe space average $\\int f d\\mu$, where $\\mu$ is the unique invariant\nprobability measure. \nConvergence of the time average to the space\naverage is slow. We introduce a modified average of $f(x_n)$ by giving\nvery small weights to the ``end'' terms when $n$ is near $0$ or $N-1$.\nWhen $(x_n)$ is a trajectory on a quasiperiodic torus and $f$ and $T$\nare $C^\\infty$, we show that our weighted Birkhoff averages converge\n``super'' fast to $\\int f d\\mu$ with respect to the number of iterates\n$N$,  i.e. with error decaying faster than $N^{-m}$ for every\ninteger $m$. Our goal is to show that our weighted Birkhoff average is a\npowerful computational tool, and this paper illustrates its use for\nseveral examples where the quasiperiodic set is one or two dimensional.\nIn particular, we compute rotation numbers and conjugacies (i.e. changes\nof variables) and their Fourier series, often with 30-digit accuracy.\n}\n\n\\end{abstract}\n\n{\\bf Keywords:} Quasiperiodicity, Birkhoff Ergodic Theorem, Hamiltonian Systems, Rotation Number,  \nKAM Tori.\n\n\\section{Introduction} \nQuasiperiodicity is a key type of observed dynamical behavior in a diverse set of applications. Tori with quasiperiodic motion often persist for small perturbations by the Kolmogorov-Arnold-Moser theory, but such behavior is also observed for non-conservative systems well beyond this restricted regime. We believe that quasiperiodicity is one of only three types of dynamical behaviors occurring in basic sets of typical systems. See~\\cite{sander:yorke:15} for the statement of our formal conjecture of this basic set triumvirate. For example, quasiperiodicity occurs in a system of weakly coupled oscillators, in which there is an invariant smooth attracting torus in phase space with behavior that can be described exclusively by the phase angles of rotation of the system. Indeed, it is the property of the motion being described using only a set of phase angles that always characterizes quasiperiodic behavior. In a now classical set of papers, Newhouse, Ruelle, and Takens demonstrated a route to chaos through a region with quasiperiodic behavior, causing a surge in the study of the motion~\\cite{newhouse:ruelle:takens:78}. There is active current interest in development of a systematic numerical and theoretical approach to bifurcation theory for quasiperiodic systems. Our goal in this paper is to present a fast numerical method for the fast calculation of the limit of Birkhoff averages in quasiperiodic systems, allowing us to compute various key quantities. If $f$ is integrable and the dynamical system is ergodic on the set in which the trajectory lives, then the Birkhoff Ergodic Theorem asserts that the Birkhoff average $ \\Sigma_{n=0}^{N-1} f(x_n)/N $ of a function $f$ along an ergodic trajectory $(x_n)$ converges to the space average $\\int f d\\mu$ as $N\\to\\infty$ for $\\mu$-almost every $x_0$, where $\\mu$ is the unique invariant probability measure. In particular, almost all trajectories with initial point in the ergodic set have the same limit of their Birkhoff averages. We develop a numerical method for calculating the limit of such averages, where instead of weighting the terms $f(x_n)$ in the average equally, we weight the early and late terms of the set $\\{0,\\dots,N-1 \\}$ much less than the terms with $n\\sim N/2$ in the middle. That is, rather than using the equal weighting $(1/N)$ in the Birkhoff average, we use a weighting function $w(n/N)$, which will primarily be the following well known $C^\\infty$ function that we will call the {\\bf exponential weighting function}, $w_{\\exp}(t) = \\exp(1/[t(t-1)])$; see Fig. \\ref{fig:weight_exp}. In a companion paper~\\cite{Das-Yorke}, it is proved that for $C^\\infty$ quasiperiodic systems with a $C^\\infty$ function $f$, any $C^\\infty$ weighting function provides super convergence as $N\\to\\infty$, meaning faster than any polynomial in $N^{-1}$. This super convergence arises from the fact that we are taking advantage of the quasiperiodic nature of the map or flow. In particular, our method uses the underlying structure of a quasiperiodic system, and would not give improved convergence results for chaotic systems. We demonstrate the method and its convergence rate by computing rotation numbers, conjugacies, and their Fourier series in dimensions one and two. We will refer to a one-dimensional quasiperiodic curve as a \\emph{curve}. \n\n\\begin{figure}[t]\n\\centering\n\\includegraphics[width = .5\\textwidth]     {weight_exp.png}\n\\caption{\\textbf{A $C^\\infty$ weight function.} The figure shows the graph of a the function $w(t)$ defined in Eq. \\ref{eqn:weight}. This function plays the role of a temporal weighting for the usual Birkhoff average. That is, rather than using the equal weighting $(1/N)$ in the Birkhoff average, we use the non-uniform weight $w(n/N)$, where $n$ is the iterate number and $N$ is the orbit length. See Eq. \\ref{eqn:QN} for a description of this weighted average.}\n\\label{fig:weight_exp}\n\\end{figure}\n\nOther authors have considered related numerical methods before, in particular~\\cite{seara:villanueva:06, luque:Rot, luque:villanueva:14} which we will compare to our approach when we introduce our method in Section \\ref{sec:methods}. See also~\\cite{Simo1, Simo2, Durand:2002ug,Baesens:1990vj,Broer:1993uv,Vitolo:2011it,Hanssmann:2012jy, Sevryuk:2012dv,Broer:1990ip,Kuznetsov:2015dl}.\n\nWe start by describing our results for a key example of quasiperiodicity: the (circular, planar) restricted three-body problem ({\\bf R3BP}). This is an idealized model of the motion of a planet, a large moon, and an asteroid governed by Newtonian mechanics, in a model studied by Poincar{\\'e}~\\cite{ThreeBody2,ThreeBody1}. In particular, we consider a planar three-body problem consisting of two massive bodies (``planet\" and ``moon\") moving in circles about their center of mass and a third body (``asteroid\") whose mass is infinitesimal, having no effect on the dynamics of the other two.\n\nWe assume that the moon has mass $\\mu$ and the planet mass is $1-\\mu$ where $\\mu = 0.1$, and\nwriting equations in rotating coordinates around the center of mass. Thus the planet remains fixed at $(q_1,p_1) = (-0.1,0)$, and the moon is fixed at $(q_2,p_2)=(0.9,0)$. In these coordinates, the satellite's location and velocity are given by the {\\em generalized position vector} $(q_1,q_2)$ and {\\em generalized velocity vector} $(p_1,p_2)$. The equations of motion are as follows (see \\cite{ThreeBody1}). \n\n\n", "index": 1, "text": "\\begin{equation}\n{\\displaystyle\n\\begin{array}{rcl}\\label{eqn:ThreeBody}\ndq_1/dt &=& p_1+q_2, \\\\\ndq_2/dt &=& p_2-q_1, \\\\\ndp_1/dt &=& p_2- \\mu(q_1-1+\\rho) d_{moon}^{-3} -(1-\\mu)(q_1+ \\mu) d_{planet}^{-3},\\\\\ndp_2/dt &=& -p_1-\\mu q_2 d_{moon}^{-3}-(1-\\mu)q_2 d_{planet}^{-3},\n\\end{array}\n}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"{\\displaystyle\\begin{array}[]{rcl}dq_{1}/dt&amp;=&amp;p_{1}+q_{2},\\\\&#10;dq_{2}/dt&amp;=&amp;p_{2}-q_{1},\\\\&#10;dp_{1}/dt&amp;=&amp;p_{2}-\\mu(q_{1}-1+\\rho)d_{moon}^{-3}-(1-\\mu)(q_{1}+\\mu)d_{planet}^%&#10;{-3},\\\\&#10;dp_{2}/dt&amp;=&amp;-p_{1}-\\mu q_{2}d_{moon}^{-3}-(1-\\mu)q_{2}d_{planet}^{-3},\\end{%&#10;array}}\" display=\"block\"><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"right\"><mrow><mrow><mrow><mi>d</mi><mo>\u2062</mo><msub><mi>q</mi><mn>1</mn></msub></mrow><mo>/</mo><mi>d</mi></mrow><mo>\u2062</mo><mi>t</mi></mrow></mtd><mtd columnalign=\"center\"><mo>=</mo></mtd><mtd columnalign=\"left\"><mrow><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>+</mo><msub><mi>q</mi><mn>2</mn></msub></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mrow><mrow><mrow><mi>d</mi><mo>\u2062</mo><msub><mi>q</mi><mn>2</mn></msub></mrow><mo>/</mo><mi>d</mi></mrow><mo>\u2062</mo><mi>t</mi></mrow></mtd><mtd columnalign=\"center\"><mo>=</mo></mtd><mtd columnalign=\"left\"><mrow><mrow><msub><mi>p</mi><mn>2</mn></msub><mo>-</mo><msub><mi>q</mi><mn>1</mn></msub></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mrow><mrow><mrow><mi>d</mi><mo>\u2062</mo><msub><mi>p</mi><mn>1</mn></msub></mrow><mo>/</mo><mi>d</mi></mrow><mo>\u2062</mo><mi>t</mi></mrow></mtd><mtd columnalign=\"center\"><mo>=</mo></mtd><mtd columnalign=\"left\"><mrow><mrow><msub><mi>p</mi><mn>2</mn></msub><mo>-</mo><mrow><mi>\u03bc</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><msub><mi>q</mi><mn>1</mn></msub><mo>-</mo><mn>1</mn></mrow><mo>+</mo><mi>\u03c1</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msubsup><mi>d</mi><mrow><mi>m</mi><mo>\u2062</mo><mi>o</mi><mo>\u2062</mo><mi>o</mi><mo>\u2062</mo><mi>n</mi></mrow><mrow><mo>-</mo><mn>3</mn></mrow></msubsup></mrow><mo>-</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>-</mo><mi>\u03bc</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>q</mi><mn>1</mn></msub><mo>+</mo><mi>\u03bc</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msubsup><mi>d</mi><mrow><mi>p</mi><mo>\u2062</mo><mi>l</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>n</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>t</mi></mrow><mrow><mo>-</mo><mn>3</mn></mrow></msubsup></mrow></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mrow><mrow><mrow><mi>d</mi><mo>\u2062</mo><msub><mi>p</mi><mn>2</mn></msub></mrow><mo>/</mo><mi>d</mi></mrow><mo>\u2062</mo><mi>t</mi></mrow></mtd><mtd columnalign=\"center\"><mo>=</mo></mtd><mtd columnalign=\"left\"><mrow><mrow><mrow><mo>-</mo><msub><mi>p</mi><mn>1</mn></msub></mrow><mo>-</mo><mrow><mi>\u03bc</mi><mo>\u2062</mo><msub><mi>q</mi><mn>2</mn></msub><mo>\u2062</mo><msubsup><mi>d</mi><mrow><mi>m</mi><mo>\u2062</mo><mi>o</mi><mo>\u2062</mo><mi>o</mi><mo>\u2062</mo><mi>n</mi></mrow><mrow><mo>-</mo><mn>3</mn></mrow></msubsup></mrow><mo>-</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>-</mo><mi>\u03bc</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>q</mi><mn>2</mn></msub><mo>\u2062</mo><msubsup><mi>d</mi><mrow><mi>p</mi><mo>\u2062</mo><mi>l</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>n</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>t</mi></mrow><mrow><mo>-</mo><mn>3</mn></mrow></msubsup></mrow></mrow><mo>,</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.06051.tex", "nexttext": "\nThe following function $H$ is a Hamiltonian for this system\n\n", "itemtype": "equation", "pos": 7517, "prevtext": "\n\nwhere \n", "index": 3, "text": "\n\\[ d_{moon} = ((q_1-1+\\mu)^2+q_2^2)^{0.5} \\mbox{ and } d_{planet} = ((q_1+\\mu)^2+q_2^2)^{0.5}.\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"d_{moon}=((q_{1}-1+\\mu)^{2}+q_{2}^{2})^{0.5}\\mbox{ and }d_{planet}=((q_{1}+\\mu%&#10;)^{2}+q_{2}^{2})^{0.5}.\" display=\"block\"><mrow><mrow><msub><mi>d</mi><mrow><mi>m</mi><mo>\u2062</mo><mi>o</mi><mo>\u2062</mo><mi>o</mi><mo>\u2062</mo><mi>n</mi></mrow></msub><mo>=</mo><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><msub><mi>q</mi><mn>1</mn></msub><mo>-</mo><mn>1</mn></mrow><mo>+</mo><mi>\u03bc</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msubsup><mi>q</mi><mn>2</mn><mn>2</mn></msubsup></mrow><mo stretchy=\"false\">)</mo></mrow><mn>0.5</mn></msup><mo>\u2062</mo><mtext>\u00a0and\u00a0</mtext><mo>\u2062</mo><msub><mi>d</mi><mrow><mi>p</mi><mo>\u2062</mo><mi>l</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>n</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>t</mi></mrow></msub></mrow><mo>=</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>q</mi><mn>1</mn></msub><mo>+</mo><mi>\u03bc</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msubsup><mi>q</mi><mn>2</mn><mn>2</mn></msubsup></mrow><mo stretchy=\"false\">)</mo></mrow><mn>0.5</mn></msup></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.06051.tex", "nexttext": "\nThe terms in the square brackets are resp. the kinetic energy, angular moment, and the potential.\nFor fixed $H$, Poincar{\\'e} reduced this problem to the study of the Poincar{\\'e} return map for a fixed value of $H$, only considering \na discrete trajectory of the values of $(q_1,p_1)$ on the section $q_2=0$ and $dq_2/dt>0$. \nThus we consider a map in two dimensions rather than a flow in four dimensions. \nFig. \\ref{fig:3B3} shows one possible motion of the asteroid for the full flow. The \norbit is spiraling on a torus. The black curve shows the corresponding trajectory on the \nPoincar{\\'e} return map. Fig. \\ref{fig:3B1} shows the Poincar{\\'e} return map \nfor the asteroid for a variety of starting points. \nA variety of orbits are shown, most of which are quasiperiodic invariant curves. \nAn exception is trajectory A in Fig. \\ref{fig:3B_global}(a), which is an invariant recurrent set consisting of $42$\ncurves. Each curve is an invariant quasiperiodic curve under the 42$^{nd}$ iterate of the map. \n\n\nUsing weighted Birkhoff averages to compute the Fourier series coefficients for the conjugacy map, we find that the coefficients  decrease exponentially fast\n(see Fig. \\ref{fig:results_3B}(c)), which is a signature of a real analytic function.\nThe high rate of convergence for the rotation number \nin Fig. \\ref{fig:results_3B}(d) \nsuggests that we have an effective computational method that yields an accuracy that is close to the limit of numeric precision, provided $N$ is sufficiently large. \n\nTo get 30-digit convergence using $B_N$ would require approximately $10^{25}$ times as many iterates.\nIn particular, we have computed trajectories for the Poincar{\\'e} return map using an $8^{th}$\norder Runge-Kutta \nmethod with time step $10^{-5}$, in quadruple precision. \nFig.~\\ref{fig:results_3B}(d) \nis consistent with 30-digit accuracy.\nSections~\\ref{sec:Quasi} and \\ref{sec:methods}\nformally define the computed values given in Table~\\ref{table:summary} for the quasiperiodic orbit of the three-body problem labeled $B_1$ in Fig.~\\ref{fig:3B1}(b).\nHere is a list of what our numerical methods yield for the restricted three-body problem: \n\\begin{enumerate}\n\\item The rotation number is given in Table~\\ref{table:summary}, computed to 30-digit accuracy, and \nFig.~\\ref{fig:results_3B}(d) shows the accuracy plateauing at about 30-digit accuracy.\n\\item We \ncompute 200 terms of the Fourier series, the last 125 of which have magnitude near 0 (i.e., less than $10^{-30}$).\nThere is a conjugacy map $h$ between the \nfirst return map and a pure rotation on the circle. Evaluating the Fourier series allows us to reconstruct the conjugacy map ({\\em cf.} Fig.~\\ref{fig:results_3B}(a)). \n\\item \nThe observed exponential decay of the coefficients in the Fourier series shown in\nFig.~\\ref{fig:results_3B}(c) \nis a signature of analyticity of conjugacy function \n({\\em cf.} Fig.~\\ref{fig:results_3B}(b)). \n\\end{enumerate}\n\n\\begin{figure}[t]\n\\centering\n\\subfigure[ ]{\\includegraphics[width = .48\\textwidth]{ThreeB_global_1.png}}\n\\subfigure[ ]{\\includegraphics[width = .48\\textwidth]{ThreeB_global_2.png}}\n\n\\subfigure[ ]{\\includegraphics[width = .48\\textwidth]{Solvability.png}}\n\\subfigure[ ]{\\includegraphics[width = .48\\textwidth]{ThreeB_B,analyticity,embedding.png}}\n\\caption{ {\\bf Poincar{\\'e}-return map for R3BP.} \\label{fig:3B1}\nThe first three parts of this figure show a projection to the $q_1-p_1$ plane of solutions to the R3BP  in Eq.~(\\ref{eqn:ThreeBody}). The value of the Hamiltonian $H$ for all the curves shown in the figures is the same and $H\\approx -2.63$. Parts (a) and (b) show various quasiperiodic trajectories on the Poincar{\\'e} section $q_2=0$. Note that the planet is fixed at the point $(-0.1,0)$ and the moon at $(0.9,0)$. Thus some trajectories orbit both the planet-moon system and some orbit only the planet or only the moon. Each time the flow hits $q_2=0$ and $dq_2/dt>0$, we plot $(q_1,p_1)$. Each trajectory shown is a quasiperiodic curve. In Part (c), white indicates the region of the $(q_1,p_1)$ plane where the Poincar{\\'e} return map is defined for $H=-2.63$, and gray indicates the region of the plane where the Poincar{\\'e} return map is not defined. Part (c) also shows the trajectory which corresponds to the curve $B_1$. Part (d) shows the norm\nof the coefficients of the Fourier series of the two components ($p_1$ in blue and $q_1$ in black) for the conjugacy map $h$ defined in Eq.~\\ref{eqn:conj}. Due to the Poincar{\\'e} return map, the ambient space is ${\\mathbb{R}}^2$, and the coordinates of the map are $q_1$ and $p_1$.}\n\\label{fig:3B_global}\n\\end{figure}\n\n\\begin{figure}\n\\centering\n\\subfigure[ ]{\\includegraphics[width = .48\\textwidth]{threeb-multi1.png}}\n\\subfigure[ ]{\\includegraphics[width = .48\\textwidth]{threeb-multi2.png}}\n\n\n\\subfigure[ ]{\\includegraphics[width = .48\\textwidth]{threeb-multi4.png}}\n\\subfigure[ ]{\\includegraphics[width = .48\\textwidth]{threeb-multi3.png}}\n\\caption{\\label{fig:3B3}\n{\\bf Torus flow for the R3BP.} \nThis trajectory is the solution of Eq. (\\ref{eqn:ThreeBody}), shown as curve $B_1$ in Fig. \\ref{fig:3B_global}.\nAll four views are of the same two-dimensional quasiperiodic torus lying in $\\mathbb{R}^4$. Each picture consists of the same trajectory spiraling densely on this torus.  We require four different \nviews of this torus because the embedding into three dimensions gives a highly non-intuitive images. The black curve is the set of values of the Poincar{\\'e} return map with $q_2=0$ for this flow torus.}\n\\end{figure}\n\n\\begin{figure}[t]\n\\centering\n\\subfigure[ ]{\\includegraphics[width = .4\\textwidth]{ThreeB_angle_convert.png}}\n\\subfigure[ ]{\\includegraphics[height=.2\\textwidth]{ThreeB_step=1E-5_conjugacy.png}}\n\n\\subfigure[ ]{\\includegraphics[height= .4\\textwidth]{ThreeB_step=1E-5_2_log-linear.png}}\n\\subfigure[ ]{\\includegraphics[height= .4\\textwidth]{ThreeB_step=1E-5_rot_convrg.png}}\n\\caption{\n\\textbf{Quasiperiodicity for the R3BP.} For the quasiperiodic curve $B_1$ from Fig. \\ref{fig:3B1}, part (a) shows the set $B_1$, along with the projection mapping from $x_n$, the $n^{th}$ iterate in the $(q_1,p_1)$ coordinates,  to \nangular coordinate $\\phi_n$. It is parameterized by coordinates $\\phi \\in S^1 \\equiv [0,1)$. Part (b) depicts the periodic part $g(\\theta)$ of the one-dimensional conjugacy map between the quasiperiodic behavior and pure rotation by $\\rho$. See Eq. (\\ref{eqn:g_conjugacy}) for a description of $g(\\theta)$. Part (c) shows the norm of the Fourier coefficients of the conjugacy as a function of index. This exponential decay indicates that the conjugacy function is analytic, up to numerical precision. Part (d) shows the convergence rate\nof the error in the rotation number $\\rho_N$ as a function of the number of iterates $N$. The ``error'' is the difference $|\\rho_N-\\rho_{N^*}|$, where $N^*=400,000$ is large enough so that $\\rho_N$ appears to have converged. The red line is an upper bound for the curve and its exponent indicates the rate of convergence. The step size used for the $8^{th}$ order Runge-Kutta scheme is $10^{-5}$.\n}\n\\label{fig:results_3B}\n\\end{figure}\n\n\n\\begin{table}[t]\n\\begin{center}\n{\\begin{tabular}{ |c | c| c | c | }\n\\hline\n\nExample & Equation & Rotation number(s) & Related Figures \\\\\n\n\\hline\nR3BP & \\ref{eqn:ThreeBody} & $0.063961728757453097164077724400302$ & \\ref{fig:3B1}, \\ref{fig:3B3}, \\ref{fig:results_3B}\\[1pt]\nStandard map & \\ref{eqn:StdMap} & $0.12055272197375513300298164369839$ & \\ref{fig:StdMap_global}, \\ref{fig:StdMap} \\[1pt]\nForced van der Pol oscillator, $F=5$ & \\ref{vdPol_forced} & $0.29206126329199589285577578718959$ & \\ref{fig:vdP_global} \\[1pt]\nForced van der Pol oscillator, $F=15$ & \\ref{vdPol_forced} & $0.37553441113144010884908928083318$ & \\ref{fig:vdP_global} \\[1pt]\nForced van der Pol oscillator, $F=25$ & \\ref{vdPol_forced} & $0.56235370092685056634419221336154$ & \\ref{fig:vdP_global} \\[1pt] \nTwo-dimensional torus & \\ref{eqn:2D_map} & $\\rho_1, \\rho_2$ in Table~\\ref{table} & \\ref{fig:2DMap_overview}, \\ref{fig:mid_circle}, \\ref{2DTorus_results} \\[1pt]\n\\hline\n\\end{tabular}}\n\\end{center}\n\\caption{\\label{table:summary}\n{\\bf Summary of our numerical calculations.} \n}\n\\end{table}\n\nOur paper proceeds as follows: In Section~\\ref{sec:Quasi}, we give the formal\ndefinition of quasiperiodicity, rotation number, and the conjugacy map. \nIn Section~\\ref{sec:methods}, we describe our\nnumerical method in detail. We illustrate our method for \na series of four examples, including an example of a two-dimensionally quasiperiodic map. \nIn all cases, we get fast convergence and are in most cases able to \ngive results with about 30-digit accuracy. For convenience of the reader, \nhave summarized our numerical findings in Table~\\ref{table:summary}. \nFinally, Section~\\ref{sec:conclude} contains our concluding remarks. \n\n\n\n\n\n\\clearpage\n\\section{Quasiperiodicity}\\label{sec:Quasi}\n\nIn the introduction, we described quasiperiodic motion as motion that\ncould be fully understood through a set of angles of rotation. We now\nformalize that idea in the following definition.\n\n\\begin{definition}[Quasiperiodicity]\nFor a dimension $d \\ge 1$, let $\\rho = (\\rho_1,\\rho_2,\\dots, \\rho_d)$ be a rotation vector\nsuch that all $\\rho_k$ are irrational and irrationally related (defined below in Eq. (\\ref{eqn:irratrel})).\nThen the following map $T_{\\vec\\rho}: {\\mathbb{T}^d} \\to {\\mathbb{T}^d}$ is known as a {\\bf pure irrational rotation}:\n\n", "itemtype": "equation", "pos": 7675, "prevtext": "\nThe following function $H$ is a Hamiltonian for this system\n\n", "index": 5, "text": "\\begin{equation}\\label{eqn:Hamiltonian}\nH=[(p_1^2+p_2^2)/2]+[q_2p_1-q_1p_2]-[\\mu~d_{planet}^{-1} + (1-\\mu)~d_{moon}^{-1}].\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"H=[(p_{1}^{2}+p_{2}^{2})/2]+[q_{2}p_{1}-q_{1}p_{2}]-[\\mu~{}d_{planet}^{-1}+(1-%&#10;\\mu)~{}d_{moon}^{-1}].\" display=\"block\"><mrow><mrow><mi>H</mi><mo>=</mo><mrow><mrow><mrow><mo stretchy=\"false\">[</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msubsup><mi>p</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>p</mi><mn>2</mn><mn>2</mn></msubsup></mrow><mo stretchy=\"false\">)</mo></mrow><mo>/</mo><mn>2</mn></mrow><mo stretchy=\"false\">]</mo></mrow><mo>+</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mrow><msub><mi>q</mi><mn>2</mn></msub><mo>\u2062</mo><msub><mi>p</mi><mn>1</mn></msub></mrow><mo>-</mo><mrow><msub><mi>q</mi><mn>1</mn></msub><mo>\u2062</mo><msub><mi>p</mi><mn>2</mn></msub></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mo>-</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mrow><mpadded width=\"+3.3pt\"><mi>\u03bc</mi></mpadded><mo>\u2062</mo><msubsup><mi>d</mi><mrow><mi>p</mi><mo>\u2062</mo><mi>l</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>n</mi><mo>\u2062</mo><mi>e</mi><mo>\u2062</mo><mi>t</mi></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msubsup></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>-</mo><mi>\u03bc</mi></mrow><mo rspace=\"5.8pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msubsup><mi>d</mi><mrow><mi>m</mi><mo>\u2062</mo><mi>o</mi><mo>\u2062</mo><mi>o</mi><mo>\u2062</mo><mi>n</mi></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msubsup></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.06051.tex", "nexttext": "\nA pure rotation is the simplest, albeit least interesting example of a map\nwith quasiperiodicity. Since $T_{\\vec\\rho}$ gives the same values on opposite sides\nof the unit cube, we identify the sides and refer to the domain of the\npure rotation as a {\\bf curve} in one dimension and a {\\bf $d$-torus}\nin  dimension $d>1$. In this paper, we will sometimes refer to the curve as\na 1-torus. We define a general  iterated map $T$ on an ambient space ${\\mathbb{R}}^D$ to be {\\bf quasiperiodic} if either $T$ or some iterate $T^k$ is topologically conjugate to a pure rotation. We will assume $k=1$ in the rest of this description. That is, a map $T$ is quasiperiodic if there is a pure rotation map $T_{\\vec\\rho}$ and an invertible {\\bf conjugacy map} \n(i.e., change of coordinates) \n$h: {\\mathbb{T}^d} \\to {\\mathbb{R}}^D$ such that\n\n", "itemtype": "equation", "pos": 17229, "prevtext": "\nThe terms in the square brackets are resp. the kinetic energy, angular moment, and the potential.\nFor fixed $H$, Poincar{\\'e} reduced this problem to the study of the Poincar{\\'e} return map for a fixed value of $H$, only considering \na discrete trajectory of the values of $(q_1,p_1)$ on the section $q_2=0$ and $dq_2/dt>0$. \nThus we consider a map in two dimensions rather than a flow in four dimensions. \nFig. \\ref{fig:3B3} shows one possible motion of the asteroid for the full flow. The \norbit is spiraling on a torus. The black curve shows the corresponding trajectory on the \nPoincar{\\'e} return map. Fig. \\ref{fig:3B1} shows the Poincar{\\'e} return map \nfor the asteroid for a variety of starting points. \nA variety of orbits are shown, most of which are quasiperiodic invariant curves. \nAn exception is trajectory A in Fig. \\ref{fig:3B_global}(a), which is an invariant recurrent set consisting of $42$\ncurves. Each curve is an invariant quasiperiodic curve under the 42$^{nd}$ iterate of the map. \n\n\nUsing weighted Birkhoff averages to compute the Fourier series coefficients for the conjugacy map, we find that the coefficients  decrease exponentially fast\n(see Fig. \\ref{fig:results_3B}(c)), which is a signature of a real analytic function.\nThe high rate of convergence for the rotation number \nin Fig. \\ref{fig:results_3B}(d) \nsuggests that we have an effective computational method that yields an accuracy that is close to the limit of numeric precision, provided $N$ is sufficiently large. \n\nTo get 30-digit convergence using $B_N$ would require approximately $10^{25}$ times as many iterates.\nIn particular, we have computed trajectories for the Poincar{\\'e} return map using an $8^{th}$\norder Runge-Kutta \nmethod with time step $10^{-5}$, in quadruple precision. \nFig.~\\ref{fig:results_3B}(d) \nis consistent with 30-digit accuracy.\nSections~\\ref{sec:Quasi} and \\ref{sec:methods}\nformally define the computed values given in Table~\\ref{table:summary} for the quasiperiodic orbit of the three-body problem labeled $B_1$ in Fig.~\\ref{fig:3B1}(b).\nHere is a list of what our numerical methods yield for the restricted three-body problem: \n\\begin{enumerate}\n\\item The rotation number is given in Table~\\ref{table:summary}, computed to 30-digit accuracy, and \nFig.~\\ref{fig:results_3B}(d) shows the accuracy plateauing at about 30-digit accuracy.\n\\item We \ncompute 200 terms of the Fourier series, the last 125 of which have magnitude near 0 (i.e., less than $10^{-30}$).\nThere is a conjugacy map $h$ between the \nfirst return map and a pure rotation on the circle. Evaluating the Fourier series allows us to reconstruct the conjugacy map ({\\em cf.} Fig.~\\ref{fig:results_3B}(a)). \n\\item \nThe observed exponential decay of the coefficients in the Fourier series shown in\nFig.~\\ref{fig:results_3B}(c) \nis a signature of analyticity of conjugacy function \n({\\em cf.} Fig.~\\ref{fig:results_3B}(b)). \n\\end{enumerate}\n\n\\begin{figure}[t]\n\\centering\n\\subfigure[ ]{\\includegraphics[width = .48\\textwidth]{ThreeB_global_1.png}}\n\\subfigure[ ]{\\includegraphics[width = .48\\textwidth]{ThreeB_global_2.png}}\n\n\\subfigure[ ]{\\includegraphics[width = .48\\textwidth]{Solvability.png}}\n\\subfigure[ ]{\\includegraphics[width = .48\\textwidth]{ThreeB_B,analyticity,embedding.png}}\n\\caption{ {\\bf Poincar{\\'e}-return map for R3BP.} \\label{fig:3B1}\nThe first three parts of this figure show a projection to the $q_1-p_1$ plane of solutions to the R3BP  in Eq.~(\\ref{eqn:ThreeBody}). The value of the Hamiltonian $H$ for all the curves shown in the figures is the same and $H\\approx -2.63$. Parts (a) and (b) show various quasiperiodic trajectories on the Poincar{\\'e} section $q_2=0$. Note that the planet is fixed at the point $(-0.1,0)$ and the moon at $(0.9,0)$. Thus some trajectories orbit both the planet-moon system and some orbit only the planet or only the moon. Each time the flow hits $q_2=0$ and $dq_2/dt>0$, we plot $(q_1,p_1)$. Each trajectory shown is a quasiperiodic curve. In Part (c), white indicates the region of the $(q_1,p_1)$ plane where the Poincar{\\'e} return map is defined for $H=-2.63$, and gray indicates the region of the plane where the Poincar{\\'e} return map is not defined. Part (c) also shows the trajectory which corresponds to the curve $B_1$. Part (d) shows the norm\nof the coefficients of the Fourier series of the two components ($p_1$ in blue and $q_1$ in black) for the conjugacy map $h$ defined in Eq.~\\ref{eqn:conj}. Due to the Poincar{\\'e} return map, the ambient space is ${\\mathbb{R}}^2$, and the coordinates of the map are $q_1$ and $p_1$.}\n\\label{fig:3B_global}\n\\end{figure}\n\n\\begin{figure}\n\\centering\n\\subfigure[ ]{\\includegraphics[width = .48\\textwidth]{threeb-multi1.png}}\n\\subfigure[ ]{\\includegraphics[width = .48\\textwidth]{threeb-multi2.png}}\n\n\n\\subfigure[ ]{\\includegraphics[width = .48\\textwidth]{threeb-multi4.png}}\n\\subfigure[ ]{\\includegraphics[width = .48\\textwidth]{threeb-multi3.png}}\n\\caption{\\label{fig:3B3}\n{\\bf Torus flow for the R3BP.} \nThis trajectory is the solution of Eq. (\\ref{eqn:ThreeBody}), shown as curve $B_1$ in Fig. \\ref{fig:3B_global}.\nAll four views are of the same two-dimensional quasiperiodic torus lying in $\\mathbb{R}^4$. Each picture consists of the same trajectory spiraling densely on this torus.  We require four different \nviews of this torus because the embedding into three dimensions gives a highly non-intuitive images. The black curve is the set of values of the Poincar{\\'e} return map with $q_2=0$ for this flow torus.}\n\\end{figure}\n\n\\begin{figure}[t]\n\\centering\n\\subfigure[ ]{\\includegraphics[width = .4\\textwidth]{ThreeB_angle_convert.png}}\n\\subfigure[ ]{\\includegraphics[height=.2\\textwidth]{ThreeB_step=1E-5_conjugacy.png}}\n\n\\subfigure[ ]{\\includegraphics[height= .4\\textwidth]{ThreeB_step=1E-5_2_log-linear.png}}\n\\subfigure[ ]{\\includegraphics[height= .4\\textwidth]{ThreeB_step=1E-5_rot_convrg.png}}\n\\caption{\n\\textbf{Quasiperiodicity for the R3BP.} For the quasiperiodic curve $B_1$ from Fig. \\ref{fig:3B1}, part (a) shows the set $B_1$, along with the projection mapping from $x_n$, the $n^{th}$ iterate in the $(q_1,p_1)$ coordinates,  to \nangular coordinate $\\phi_n$. It is parameterized by coordinates $\\phi \\in S^1 \\equiv [0,1)$. Part (b) depicts the periodic part $g(\\theta)$ of the one-dimensional conjugacy map between the quasiperiodic behavior and pure rotation by $\\rho$. See Eq. (\\ref{eqn:g_conjugacy}) for a description of $g(\\theta)$. Part (c) shows the norm of the Fourier coefficients of the conjugacy as a function of index. This exponential decay indicates that the conjugacy function is analytic, up to numerical precision. Part (d) shows the convergence rate\nof the error in the rotation number $\\rho_N$ as a function of the number of iterates $N$. The ``error'' is the difference $|\\rho_N-\\rho_{N^*}|$, where $N^*=400,000$ is large enough so that $\\rho_N$ appears to have converged. The red line is an upper bound for the curve and its exponent indicates the rate of convergence. The step size used for the $8^{th}$ order Runge-Kutta scheme is $10^{-5}$.\n}\n\\label{fig:results_3B}\n\\end{figure}\n\n\n\\begin{table}[t]\n\\begin{center}\n{\\begin{tabular}{ |c | c| c | c | }\n\\hline\n\nExample & Equation & Rotation number(s) & Related Figures \\\\\n\n\\hline\nR3BP & \\ref{eqn:ThreeBody} & $0.063961728757453097164077724400302$ & \\ref{fig:3B1}, \\ref{fig:3B3}, \\ref{fig:results_3B}\\[1pt]\nStandard map & \\ref{eqn:StdMap} & $0.12055272197375513300298164369839$ & \\ref{fig:StdMap_global}, \\ref{fig:StdMap} \\[1pt]\nForced van der Pol oscillator, $F=5$ & \\ref{vdPol_forced} & $0.29206126329199589285577578718959$ & \\ref{fig:vdP_global} \\[1pt]\nForced van der Pol oscillator, $F=15$ & \\ref{vdPol_forced} & $0.37553441113144010884908928083318$ & \\ref{fig:vdP_global} \\[1pt]\nForced van der Pol oscillator, $F=25$ & \\ref{vdPol_forced} & $0.56235370092685056634419221336154$ & \\ref{fig:vdP_global} \\[1pt] \nTwo-dimensional torus & \\ref{eqn:2D_map} & $\\rho_1, \\rho_2$ in Table~\\ref{table} & \\ref{fig:2DMap_overview}, \\ref{fig:mid_circle}, \\ref{2DTorus_results} \\[1pt]\n\\hline\n\\end{tabular}}\n\\end{center}\n\\caption{\\label{table:summary}\n{\\bf Summary of our numerical calculations.} \n}\n\\end{table}\n\nOur paper proceeds as follows: In Section~\\ref{sec:Quasi}, we give the formal\ndefinition of quasiperiodicity, rotation number, and the conjugacy map. \nIn Section~\\ref{sec:methods}, we describe our\nnumerical method in detail. We illustrate our method for \na series of four examples, including an example of a two-dimensionally quasiperiodic map. \nIn all cases, we get fast convergence and are in most cases able to \ngive results with about 30-digit accuracy. For convenience of the reader, \nhave summarized our numerical findings in Table~\\ref{table:summary}. \nFinally, Section~\\ref{sec:conclude} contains our concluding remarks. \n\n\n\n\n\n\\clearpage\n\\section{Quasiperiodicity}\\label{sec:Quasi}\n\nIn the introduction, we described quasiperiodic motion as motion that\ncould be fully understood through a set of angles of rotation. We now\nformalize that idea in the following definition.\n\n\\begin{definition}[Quasiperiodicity]\nFor a dimension $d \\ge 1$, let $\\rho = (\\rho_1,\\rho_2,\\dots, \\rho_d)$ be a rotation vector\nsuch that all $\\rho_k$ are irrational and irrationally related (defined below in Eq. (\\ref{eqn:irratrel})).\nThen the following map $T_{\\vec\\rho}: {\\mathbb{T}^d} \\to {\\mathbb{T}^d}$ is known as a {\\bf pure irrational rotation}:\n\n", "index": 7, "text": "\\begin{equation}\\label{eqn:Pure_rotation}\nT_{\\vec\\rho}(\\theta) = \\vec \\theta + \\vec \\rho \\pmod 1, \\mbox{ where } \\vec \\theta, \\mbox{ has dimension } d, \\mbox{ with each component between } 0 \\mbox{ and } 1. \n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"T_{\\vec{\\rho}}(\\theta)=\\vec{\\theta}+\\vec{\\rho}\\pmod{1},\\mbox{ where }\\vec{%&#10;\\theta},\\mbox{ has dimension }d,\\mbox{ with each component between }0\\mbox{ %&#10;and }1.\" display=\"block\"><mrow><mrow><mrow><msub><mi>T</mi><mover accent=\"true\"><mi>\u03c1</mi><mo stretchy=\"false\">\u2192</mo></mover></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mrow><mover accent=\"true\"><mi>\u03b8</mi><mo stretchy=\"false\">\u2192</mo></mover><mo>+</mo><mover accent=\"true\"><mi>\u03c1</mi><mo stretchy=\"false\">\u2192</mo></mover></mrow><mspace width=\"veryverythickmathspace\"/><mrow><mo lspace=\"8.1pt\" stretchy=\"false\">(</mo><mrow><mo movablelimits=\"false\">mod</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>,</mo><mrow><mtext>\u00a0where\u00a0</mtext><mo>\u2062</mo><mover accent=\"true\"><mi>\u03b8</mi><mo stretchy=\"false\">\u2192</mo></mover></mrow><mo>,</mo><mrow><mtext>\u00a0has dimension\u00a0</mtext><mo>\u2062</mo><mi>d</mi></mrow><mo>,</mo><mrow><mtext>\u00a0with each component between\u00a0</mtext><mo>\u2062</mo><mn>0</mn><mo>\u2062</mo><mtext>\u00a0and\u00a0</mtext><mo>\u2062</mo><mn>1</mn></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.06051.tex", "nexttext": " \nA flow has quasiperiodic behavior if\nits associated Poincar{\\'e} return map has quasiperiodic behavior.\n\nIn all of our examples with $d=1$, we are fortunate that the quasiperiodic\ntorus does not double over itself, meaning that we can \nwrite the conjugacy for the quasiperiodic circle  in polar coordinates $(\\phi(\\theta),r(\\theta))$ \n with respect to a fixed and pre-defined center, where $r$ is uniquely determined by $\\phi$. \n  That is, the projection mapping $P(h) = \\phi$ is smooth and invertible on our quasiperiodic examples, which means we can\nrepresent the conjugacy map as a circle map $V: {\\mathbb{T}^d} \\to {\\mathbb{T}^d}$ where \n\n", "itemtype": "equation", "pos": -1, "prevtext": "\nA pure rotation is the simplest, albeit least interesting example of a map\nwith quasiperiodicity. Since $T_{\\vec\\rho}$ gives the same values on opposite sides\nof the unit cube, we identify the sides and refer to the domain of the\npure rotation as a {\\bf curve} in one dimension and a {\\bf $d$-torus}\nin  dimension $d>1$. In this paper, we will sometimes refer to the curve as\na 1-torus. We define a general  iterated map $T$ on an ambient space ${\\mathbb{R}}^D$ to be {\\bf quasiperiodic} if either $T$ or some iterate $T^k$ is topologically conjugate to a pure rotation. We will assume $k=1$ in the rest of this description. That is, a map $T$ is quasiperiodic if there is a pure rotation map $T_{\\vec\\rho}$ and an invertible {\\bf conjugacy map} \n(i.e., change of coordinates) \n$h: {\\mathbb{T}^d} \\to {\\mathbb{R}}^D$ such that\n\n", "index": 9, "text": "\\begin{equation}\nT(h(\\theta)) = h(T_{\\vec\\rho}(\\theta)). \\label{eqn:conj}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"T(h(\\theta))=h(T_{\\vec{\\rho}}(\\theta)).\" display=\"block\"><mrow><mrow><mrow><mi>T</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>h</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mi>h</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>T</mi><mover accent=\"true\"><mi>\u03c1</mi><mo stretchy=\"false\">\u2192</mo></mover></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.06051.tex", "nexttext": "   \nFor example, in Figure~\\ref{fig:results_3B}(a), the angular coordinate $\\phi$\nfor the quasiperiodic orbit $B_1$ of the restricted three-body\nproblem  is measured from \na point $(q_1,p_1) =(-0.2,0)$.\n\nSince we focus on maps, we restate this definition in\nterms of iterates. Let $(x_n)$ be the forward orbit under $T$, and $( \\theta_n )$ the\nforward orbit under $T_{\\vec\\rho}$. That is, $x_{n+1} = T(x_n)$ and $\\theta_{n+1} = \\theta_n + \\rho \\pmod 1$. \nThen as long as $h(\\theta_0)=h(0)$ (and $V(\\theta_0) = \\phi_0$),\n\n", "itemtype": "equation", "pos": -1, "prevtext": " \nA flow has quasiperiodic behavior if\nits associated Poincar{\\'e} return map has quasiperiodic behavior.\n\nIn all of our examples with $d=1$, we are fortunate that the quasiperiodic\ntorus does not double over itself, meaning that we can \nwrite the conjugacy for the quasiperiodic circle  in polar coordinates $(\\phi(\\theta),r(\\theta))$ \n with respect to a fixed and pre-defined center, where $r$ is uniquely determined by $\\phi$. \n  That is, the projection mapping $P(h) = \\phi$ is smooth and invertible on our quasiperiodic examples, which means we can\nrepresent the conjugacy map as a circle map $V: {\\mathbb{T}^d} \\to {\\mathbb{T}^d}$ where \n\n", "index": 11, "text": "\\begin{equation} \nV(\\theta) = P (h(\\theta)). \\label{eqn:proj}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"V(\\theta)=P(h(\\theta)).\" display=\"block\"><mrow><mrow><mrow><mi>V</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>h</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.06051.tex", "nexttext": "\nSince $V$ is invertible, the map\n\n", "itemtype": "equation", "pos": 19607, "prevtext": "   \nFor example, in Figure~\\ref{fig:results_3B}(a), the angular coordinate $\\phi$\nfor the quasiperiodic orbit $B_1$ of the restricted three-body\nproblem  is measured from \na point $(q_1,p_1) =(-0.2,0)$.\n\nSince we focus on maps, we restate this definition in\nterms of iterates. Let $(x_n)$ be the forward orbit under $T$, and $( \\theta_n )$ the\nforward orbit under $T_{\\vec\\rho}$. That is, $x_{n+1} = T(x_n)$ and $\\theta_{n+1} = \\theta_n + \\rho \\pmod 1$. \nThen as long as $h(\\theta_0)=h(0)$ (and $V(\\theta_0) = \\phi_0$),\n\n", "index": 13, "text": "\\begin{equation}\\label{eqn:conjugacy1D}\nx_n = h(\\theta_n)~\\mbox{ and } \\phi_n = V(\\theta_n)~\\mbox{ for all } n=0,1,2,3,\\ldots \n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"x_{n}=h(\\theta_{n})~{}\\mbox{ and }\\phi_{n}=V(\\theta_{n})~{}\\mbox{ for all }n=0%&#10;,1,2,3,\\ldots\" display=\"block\"><mrow><mrow><msub><mi>x</mi><mi>n</mi></msub><mo>=</mo><mrow><mi>h</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03b8</mi><mi>n</mi></msub><mo rspace=\"5.8pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mtext>\u00a0and\u00a0</mtext><mo>\u2062</mo><msub><mi>\u03d5</mi><mi>n</mi></msub></mrow><mo>=</mo><mrow><mi>V</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03b8</mi><mi>n</mi></msub><mo rspace=\"5.8pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mtext>\u00a0for all\u00a0</mtext><mo>\u2062</mo><mi>n</mi></mrow><mo>=</mo><mn>0</mn></mrow><mo>,</mo><mrow><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi></mrow></mrow></math>", "type": "latex"}, {"file": "1601.06051.tex", "nexttext": "\nis periodic.\n\\end{definition}\n\nFor example in one dimension, a map $T$ restricted to an invariant curve $C$ is\nquasiperiodic if there is a continuous invertible map $h$ from $C$ to the circle $S^1$\nwhich maps $T$ to a pure irrational rotation map. \n\nFor an invertible map $F$ to be quasiperiodic on a curve\n$C$, it is necessary and sufficient that $F$ has a dense trajectory, as\nshown in \\cite{TransCircleHomeo}. In general, a one-time differentiable invertible map on a curve\nwithout periodic points may not be quasiperiodic. However, if we assume\nthat the map $F$ and the curve $C$ are twice continuously\ndifferentiable, then Denjoy~\\cite{VanKampen} showed that these\nconditions are both necessary and sufficient. Furthermore, clearly any\npure irrational rotation map is a real analytic map, but even if we\nassume that a quasiperiodic function is analytic, Arnold showed that the conjugacy map $h$\nmay only be continuous for some atypical rotation number. However, Herman (see \\cite{HermanSeminal}) proved that for \nhomeomorphisms on a circle, most conjugacy maps $h$ are analytic. \nYamaguchi and Tanikawa~\\cite{StdMap1} and Hunt, Khanin, Sinai and Yorke~\\cite{HKSY} show that the critical KAM curve may not be $C^2$. \nThough we have not done it in this paper, our method could be used to get numerical evidence for the differentiability of the critical KAM curve.\n\nWe conjecture that {\\bf if the map is analytic, then almost every quasiperiodic curve having a rotation number that is Diophantine (i.e., far from rational) is real analytic.} \n\n\n\n\\clearpage\n\\section{The ${\\mbox{WB}}_N$ method and its applications}\\label{sec:methods}\nThe Birkhoff Ergodic Theorem says that \nfor a trajectory $(x_n)$ of an ergodic process, the Birkhoff average \n$\\lim_{N \\to\\infty} \\Sigma_{n=0}^{N-1} f(x_n)/N$\nconverges to the space average $\\int f \\; d\\mu$ under mild assumptions.\n For a quasiperiodic set the invariant measure is just Lebesgue measure on the torus using coordinates so that   Eq. \\ref{eqn:Pure_rotation} holds. Then we can write the integral as \n$\\int f(\\theta)d\\theta$.\nOur approach is to modify the average so that for quasiperiodic dynamical systems, we get much faster convergence to the same limit, \n$\\int f(\\theta)d\\theta$.\n\nA function $w:R\\to [0,\\infty)$ will be called a {\\bf$C^\\infty$ weight function} if $w$ is infinitely differentiable and $w>0$ on $(0,1)$ and $= 0$ elsewhere. The example of such a function that we will use in this paper is \ndefined as\n\n", "itemtype": "equation", "pos": 19782, "prevtext": "\nSince $V$ is invertible, the map\n\n", "index": 15, "text": "\\begin{equation}\\label{eqn:g_conjugacy}\ng(\\theta) := V(\\theta)-\\theta\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"g(\\theta):=V(\\theta)-\\theta\" display=\"block\"><mrow><mrow><mi>g</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>:=</mo><mrow><mrow><mi>V</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mi>\u03b8</mi></mrow></mrow></math>", "type": "latex"}, {"file": "1601.06051.tex", "nexttext": " \n\nLet $T$ be quasiperiodic on a $d$-dimensional topological torus, which we denote by ${\\mathbb{T}^d}$.  \nFor $d=1$, ${\\mathbb{T}^d}$ is a curve. For a continuous function $f$ and a $C^\\infty$ quasiperiodic map $T$ \non ${\\mathbb{T}^d}$, let $x_n\\in{\\mathbb{T}^d}$ be such that $x_n = T(x_{n-1})$ for all $n\\ge 1$. We define a {\\bf Weighted Birkhoff (${\\mbox{WB}}_N$) average} \nof $f$ as \n\n", "itemtype": "equation", "pos": -1, "prevtext": "\nis periodic.\n\\end{definition}\n\nFor example in one dimension, a map $T$ restricted to an invariant curve $C$ is\nquasiperiodic if there is a continuous invertible map $h$ from $C$ to the circle $S^1$\nwhich maps $T$ to a pure irrational rotation map. \n\nFor an invertible map $F$ to be quasiperiodic on a curve\n$C$, it is necessary and sufficient that $F$ has a dense trajectory, as\nshown in \\cite{TransCircleHomeo}. In general, a one-time differentiable invertible map on a curve\nwithout periodic points may not be quasiperiodic. However, if we assume\nthat the map $F$ and the curve $C$ are twice continuously\ndifferentiable, then Denjoy~\\cite{VanKampen} showed that these\nconditions are both necessary and sufficient. Furthermore, clearly any\npure irrational rotation map is a real analytic map, but even if we\nassume that a quasiperiodic function is analytic, Arnold showed that the conjugacy map $h$\nmay only be continuous for some atypical rotation number. However, Herman (see \\cite{HermanSeminal}) proved that for \nhomeomorphisms on a circle, most conjugacy maps $h$ are analytic. \nYamaguchi and Tanikawa~\\cite{StdMap1} and Hunt, Khanin, Sinai and Yorke~\\cite{HKSY} show that the critical KAM curve may not be $C^2$. \nThough we have not done it in this paper, our method could be used to get numerical evidence for the differentiability of the critical KAM curve.\n\nWe conjecture that {\\bf if the map is analytic, then almost every quasiperiodic curve having a rotation number that is Diophantine (i.e., far from rational) is real analytic.} \n\n\n\n\\clearpage\n\\section{The ${\\mbox{WB}}_N$ method and its applications}\\label{sec:methods}\nThe Birkhoff Ergodic Theorem says that \nfor a trajectory $(x_n)$ of an ergodic process, the Birkhoff average \n$\\lim_{N \\to\\infty} \\Sigma_{n=0}^{N-1} f(x_n)/N$\nconverges to the space average $\\int f \\; d\\mu$ under mild assumptions.\n For a quasiperiodic set the invariant measure is just Lebesgue measure on the torus using coordinates so that   Eq. \\ref{eqn:Pure_rotation} holds. Then we can write the integral as \n$\\int f(\\theta)d\\theta$.\nOur approach is to modify the average so that for quasiperiodic dynamical systems, we get much faster convergence to the same limit, \n$\\int f(\\theta)d\\theta$.\n\nA function $w:R\\to [0,\\infty)$ will be called a {\\bf$C^\\infty$ weight function} if $w$ is infinitely differentiable and $w>0$ on $(0,1)$ and $= 0$ elsewhere. The example of such a function that we will use in this paper is \ndefined as\n\n", "index": 17, "text": "\\begin{equation}\\label{eqn:weight}\nw(t) :=\\begin{cases}\n\\exp\\left(\\frac{1}{t(t-1)}\\right), & \\mbox{for } t\\in(0,1)\\\\\n0, & \\mbox{for } t\\notin(0,1).\n\\end{cases}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m1\" class=\"ltx_Math\" alttext=\"w(t):=\\begin{cases}\\exp\\left(\\frac{1}{t(t-1)}\\right),&amp;\\mbox{for }t\\in(0,1)\\\\&#10;0,&amp;\\mbox{for }t\\notin(0,1).\\end{cases}\" display=\"block\"><mrow><mrow><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>:=</mo><mrow><mo>{</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo>(</mo><mstyle displaystyle=\"false\"><mfrac><mn>1</mn><mrow><mi>t</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>t</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mstyle><mo>)</mo></mrow></mrow><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mtext>for\u00a0</mtext><mo>\u2062</mo><mi>t</mi></mrow><mo>\u2208</mo><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mrow><mn>0</mn><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mrow><mtext>for\u00a0</mtext><mo>\u2062</mo><mi>t</mi></mrow><mo>\u2209</mo><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mrow><mo>.</mo></mrow></mtd></mtr></mtable></mrow></mrow></math>", "type": "latex"}, {"file": "1601.06051.tex", "nexttext": "\n\nNote that ${\\mbox{WB}}_N(f)$ is indeed an average of the values $f(x_n)$ since $\\sum_{n=0}^{N-1}\\hat{w}_{n,N}=1$.\nIn a companion paper~\\cite{Das-Yorke}, it is shown that  if $f$ and $T$ are $C^\\infty$ \nand $w$ is a $C^\\infty$ weight function, \nthen for every positive integer $m$ there is a constant $C_m >0$ such that\n", "itemtype": "equation", "pos": 22900, "prevtext": " \n\nLet $T$ be quasiperiodic on a $d$-dimensional topological torus, which we denote by ${\\mathbb{T}^d}$.  \nFor $d=1$, ${\\mathbb{T}^d}$ is a curve. For a continuous function $f$ and a $C^\\infty$ quasiperiodic map $T$ \non ${\\mathbb{T}^d}$, let $x_n\\in{\\mathbb{T}^d}$ be such that $x_n = T(x_{n-1})$ for all $n\\ge 1$. We define a {\\bf Weighted Birkhoff (${\\mbox{WB}}_N$) average} \nof $f$ as \n\n", "index": 19, "text": "\\begin{equation}\\label{eqn:QN}\n{\\mbox{WB}}_N(f)(x) :=\\sum_{n=0}^{N-1} \\hat{w}_{n,N}f(x_n),\\mbox{ where }\\hat{w}_{n,N}=\\frac{w(n/N)}{\\Sigma_{j=0}^{N-1}w(j/N)}.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m1\" class=\"ltx_Math\" alttext=\"{\\mbox{WB}}_{N}(f)(x):=\\sum_{n=0}^{N-1}\\hat{w}_{n,N}f(x_{n}),\\mbox{ where }%&#10;\\hat{w}_{n,N}=\\frac{w(n/N)}{\\Sigma_{j=0}^{N-1}w(j/N)}.\" display=\"block\"><mrow><mrow><mrow><mrow><msub><mtext>WB</mtext><mi>N</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>:=</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>-</mo><mn>1</mn></mrow></munderover><mrow><msub><mover accent=\"true\"><mi>w</mi><mo stretchy=\"false\">^</mo></mover><mrow><mi>n</mi><mo>,</mo><mi>N</mi></mrow></msub><mo>\u2062</mo><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>,</mo><mrow><mrow><mtext>\u00a0where\u00a0</mtext><mo>\u2062</mo><msub><mover accent=\"true\"><mi>w</mi><mo stretchy=\"false\">^</mo></mover><mrow><mi>n</mi><mo>,</mo><mi>N</mi></mrow></msub></mrow><mo>=</mo><mfrac><mrow><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>n</mi><mo>/</mo><mi>N</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msubsup><mi mathvariant=\"normal\">\u03a3</mi><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>-</mo><mn>1</mn></mrow></msubsup><mo>\u2062</mo><mi>w</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>j</mi><mo>/</mo><mi>N</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.06051.tex", "nexttext": "\n We refer to the above as {\\bf super-fast} (super polynomial) {\\bf convergence} or {\\bf exponential convergence}.\n\n\nOur numerical method converges fast enough to allow us to obtain high precision values for $\\int f d\\theta$\nwith relatively low computational cost. In particular, by appropriate choices for $f$, \nwe obtain rotation numbers, \nFourier coefficients,  conjugacy reconstructions, and sometimes the Lyapunov exponents, for quasiperiodic\nmaps and flows potentially in any finite dimension. Here we work mainly in dimension \none, with one example in dimension two. \nWe should note that if the ergodic process is chaotic instead of quasiperiodic, our weighted Birkhoff average has no advantage over the Birkhoff average.\n\nWe now show\nhow to apply this general method to computation of specific quantities. We observe that $N$ must be larger for $\\mathbb{T}^2$ than for $\\mathbb{T}^1$, to get a 30-digit accuracy.\n\n\\subsection{Computing a rotation number or rotation vector}\\label{sec:Method_Rot}\n\n\\begin{figure}[t]\n\\centering\n\\subfigure[ ]{\\includegraphics[width = .35\\textwidth]{standard.jpg}}\n\\subfigure[ ]{\\includegraphics[width = .35\\textwidth]{standard2.pdf}}\n\\caption{\n\n{\\bf The standard map.} Part (a) shows a variety of orbits from\ndifferent initial conditions in the standard map $S_1$ defined in\nEq.~(\\ref{eqn:StdMap}). We can see both chaos (shaded area) and\nquasiperiodic orbits under this map. A single curve with quasiperiodic\nbehavior is plotted in part (b). The orbit has initial conditions $(x,\ny) \\approx (-0.607, 2.01)$. That is, if we restrict the map to this\ninvariant curve, then it is topologically conjugate to a pure irrational\nrotation.\n\n}\n\\label{fig:StdMap_global}\n\\end{figure}\n\n\\begin{figure}[t]\n\\centering\n\\subfigure[ ]{\\includegraphics[width = .35\\textwidth]{Conjugacy,StdMap,rho=1_0.png}}\n\\subfigure[ ]{\\includegraphics[width = .35\\textwidth]{Analyticity,StdMap,rho=1_0.png}}\n\\caption{\\textbf{The standard map conjugacy.} \n\nThis figure shows the analysis of the quasiperiodic trajectory in Fig.~\\ref{fig:StdMap_global}. Part (a) depicts the periodic part $g(\\theta)$ of the conjugacy between the quasiperiodic behavior and pure rotation by $\\rho$, measured with respect to the center point $(x,y)=(\\pi,0)$. See Eq. (\\ref{eqn:g_conjugacy}) for a description of $g(\\theta)$. Part (b) shows the decay of the Fourier coefficients. Since the conjugacy is an odd function, the odd-numbered Fourier coefficients are zero and therefore have been omitted from the picture. The decay of the Fourier terms can be bounded from above be an exponential decay, which suggests that the conjugacy is analytic. An orbit of length $N=10^{7}$ is used for these computations. A smaller orbit of length $N=10^6$ does not lead to any significant changes.} \n\\label{fig:StdMap}\n\\end{figure}\n\n\n\\begin{figure}[t]\n\\centering\n\\subfigure[ ]{\\includegraphics[width=.3\\textwidth]{Orbits,vdPol.png}}\n\\subfigure[ ]{\\includegraphics[width = .3\\textwidth]{Conjugacies,vdPol.png}}\n\\subfigure[ ]{\\includegraphics[width = .3\\textwidth]{Analiticities,vdPol.png}}\n\\caption{ {\\bf Forced van der Pol oscillator.} \\label{fig:vdP_global}\n\nPart (a) shows attracting orbits for a number of different forcing values $F$ for the stroboscopic map of the van der Pol flow given in Eq. (\\ref{vdPol_forced}). The plot depicts points $(X,Y) =(x(t_k),x'(t_k))$, where $t_k = 2 k \\pi/0.83, k = 0,1,2,\\dots.$ The chaotic orbit lying inside the cycles corresponds to $F=45.0$. There are stable quasiperiodic orbits shown as curves, which from outermost to innermost correspond to $F=5.0$, $15.0$, $25.0$ and $35.0$ respectively. Part (b) is the periodic part $g(\\theta)$ of the conjugacy (Eq.~(\\ref{eqn:conjugacy1D})) to a pure rotation, measured with respect to the center point $(0,0)$ for $F= 5.0, 15.0, $and $25.0$. Part (c) shows the absolute values of the Fourier coefficients of $g$. Their linear decay as $|k|$ increases in this log-linear plot means the coefficients decay exponentially fast, which is a signature of the analyticity $g$ and hence of the conjugacy to a pure rotation. The decay is exponentially fast up to the resolution of the numerics.\n}\n\\end{figure}\nRecall that every quasiperiodic map is conjugate to a pure rotation $T_\\rho$ by a vector $\\rho = (\\rho_1, \\dots,\\rho_d)$. In our discussion, we assume that the components \nof $\\rho$ are irrational and irrationally related. \nWhen we\nsay that $\\rho_1,\\dots,\\rho_d$ are irrationally related, we mean that\nthere are no integers $k_1,\\dots,k_d $\nand $k_0$ for which\n\n", "itemtype": "equation", "pos": 23393, "prevtext": "\n\nNote that ${\\mbox{WB}}_N(f)$ is indeed an average of the values $f(x_n)$ since $\\sum_{n=0}^{N-1}\\hat{w}_{n,N}=1$.\nIn a companion paper~\\cite{Das-Yorke}, it is shown that  if $f$ and $T$ are $C^\\infty$ \nand $w$ is a $C^\\infty$ weight function, \nthen for every positive integer $m$ there is a constant $C_m >0$ such that\n", "index": 21, "text": "\n\\[\\left| {\\mbox{WB}}_N(f)(\\theta) - \n\\int f(\\theta) d\\theta  \\right| \\le C_m N^{-m} \\mbox{ for every }m.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"\\left|{\\mbox{WB}}_{N}(f)(\\theta)-\\int f(\\theta)d\\theta\\right|\\leq C_{m}N^{-m}%&#10;\\mbox{ for every }m.\" display=\"block\"><mrow><mrow><mrow><mo>|</mo><mrow><mrow><msub><mtext>WB</mtext><mi>N</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>\u03b8</mi></mrow></mrow></mrow></mrow><mo>|</mo></mrow><mo>\u2264</mo><mrow><msub><mi>C</mi><mi>m</mi></msub><mo>\u2062</mo><msup><mi>N</mi><mrow><mo>-</mo><mi>m</mi></mrow></msup><mo>\u2062</mo><mtext>\u00a0for every\u00a0</mtext><mo>\u2062</mo><mi>m</mi></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.06051.tex", "nexttext": "\nunless all $k_i$ are zero.\n\nSince we are only provided with the\nmap $T$ and not with the map $T_{\\rho}$, we need a way of recovering the\nrotation vector $\\rho$ using only a forward trajectory of the map $T$. The\nfollowing definition gives a way of calculating the rotation vector \ndirectly from the original map. In fact, the rotation vector given in the definition\nis valid well beyond the case of a quasiperiodic function. For example, the rotation vector can\ncertainly be rational in one or all of its components. \n\n\\begin{definition}[Rotation vectors.] \nThe rotation vector of a trajectory $(y_n)_{0}^{N-1}$ of a quasiperiodic\nmap $T$ on a $d$-torus is the average rotation traversed by the sequence $d$-vectors\n$(T(y_n) - y_n) = (y_{n+1}-y_n)$. However, a little work needs to be done to formalize this\ndefinition, since even in one dimension there are two choices of how to\ndefine such a difference depending on whether you move clockwise or\ncounterclockwise around the circle, and in higher dimensions there are \nmany choices of coordinates. \nIn order to remove this angle discrepancy, \nwe must make this choice continuously so we associate with torus map $T$ a \ncontinuous map $\t\\tilde{T}$ on the full Euclidean space such that \n\\begin{displaymath}\\label{eqn:q_as_cover}\n\t\\tilde{T}(z) \\pmod 1 = T(z \\pmod 1).\n\\end{displaymath}\nThe map $\t\\tilde{T}$ is called a {\\bf lift} of $T$. \nSince $T$ is invertible, the map  $\t\t\\tilde{T}(z)-z$ has period one in every coordinate direction. \nFor example, the pure rotation $T(\\theta)  = \\theta + \\rho \\pmod 1,$ for $\\theta$ in ${\\mathbb{T}^d}$ has a corresponding \nlift map $\t\\tilde{T}(z) = z + \\rho,$ for $z$ in ${\\mathbb R}^d$. \nOf course if $\\rho$ was $\\sqrt2$, we would have the same map $T$ as for $\\rho = \\sqrt 2 - 1$ so we define $\\tilde T$ using rotation numbers are in $(0,1)$.\nUsing the lift, we now give a formula for the rotation vector for the trajectory $(y_n)$ starting\nat $y_0$: \n\n\n", "itemtype": "equation", "pos": 28021, "prevtext": "\n We refer to the above as {\\bf super-fast} (super polynomial) {\\bf convergence} or {\\bf exponential convergence}.\n\n\nOur numerical method converges fast enough to allow us to obtain high precision values for $\\int f d\\theta$\nwith relatively low computational cost. In particular, by appropriate choices for $f$, \nwe obtain rotation numbers, \nFourier coefficients,  conjugacy reconstructions, and sometimes the Lyapunov exponents, for quasiperiodic\nmaps and flows potentially in any finite dimension. Here we work mainly in dimension \none, with one example in dimension two. \nWe should note that if the ergodic process is chaotic instead of quasiperiodic, our weighted Birkhoff average has no advantage over the Birkhoff average.\n\nWe now show\nhow to apply this general method to computation of specific quantities. We observe that $N$ must be larger for $\\mathbb{T}^2$ than for $\\mathbb{T}^1$, to get a 30-digit accuracy.\n\n\\subsection{Computing a rotation number or rotation vector}\\label{sec:Method_Rot}\n\n\\begin{figure}[t]\n\\centering\n\\subfigure[ ]{\\includegraphics[width = .35\\textwidth]{standard.jpg}}\n\\subfigure[ ]{\\includegraphics[width = .35\\textwidth]{standard2.pdf}}\n\\caption{\n\n{\\bf The standard map.} Part (a) shows a variety of orbits from\ndifferent initial conditions in the standard map $S_1$ defined in\nEq.~(\\ref{eqn:StdMap}). We can see both chaos (shaded area) and\nquasiperiodic orbits under this map. A single curve with quasiperiodic\nbehavior is plotted in part (b). The orbit has initial conditions $(x,\ny) \\approx (-0.607, 2.01)$. That is, if we restrict the map to this\ninvariant curve, then it is topologically conjugate to a pure irrational\nrotation.\n\n}\n\\label{fig:StdMap_global}\n\\end{figure}\n\n\\begin{figure}[t]\n\\centering\n\\subfigure[ ]{\\includegraphics[width = .35\\textwidth]{Conjugacy,StdMap,rho=1_0.png}}\n\\subfigure[ ]{\\includegraphics[width = .35\\textwidth]{Analyticity,StdMap,rho=1_0.png}}\n\\caption{\\textbf{The standard map conjugacy.} \n\nThis figure shows the analysis of the quasiperiodic trajectory in Fig.~\\ref{fig:StdMap_global}. Part (a) depicts the periodic part $g(\\theta)$ of the conjugacy between the quasiperiodic behavior and pure rotation by $\\rho$, measured with respect to the center point $(x,y)=(\\pi,0)$. See Eq. (\\ref{eqn:g_conjugacy}) for a description of $g(\\theta)$. Part (b) shows the decay of the Fourier coefficients. Since the conjugacy is an odd function, the odd-numbered Fourier coefficients are zero and therefore have been omitted from the picture. The decay of the Fourier terms can be bounded from above be an exponential decay, which suggests that the conjugacy is analytic. An orbit of length $N=10^{7}$ is used for these computations. A smaller orbit of length $N=10^6$ does not lead to any significant changes.} \n\\label{fig:StdMap}\n\\end{figure}\n\n\n\\begin{figure}[t]\n\\centering\n\\subfigure[ ]{\\includegraphics[width=.3\\textwidth]{Orbits,vdPol.png}}\n\\subfigure[ ]{\\includegraphics[width = .3\\textwidth]{Conjugacies,vdPol.png}}\n\\subfigure[ ]{\\includegraphics[width = .3\\textwidth]{Analiticities,vdPol.png}}\n\\caption{ {\\bf Forced van der Pol oscillator.} \\label{fig:vdP_global}\n\nPart (a) shows attracting orbits for a number of different forcing values $F$ for the stroboscopic map of the van der Pol flow given in Eq. (\\ref{vdPol_forced}). The plot depicts points $(X,Y) =(x(t_k),x'(t_k))$, where $t_k = 2 k \\pi/0.83, k = 0,1,2,\\dots.$ The chaotic orbit lying inside the cycles corresponds to $F=45.0$. There are stable quasiperiodic orbits shown as curves, which from outermost to innermost correspond to $F=5.0$, $15.0$, $25.0$ and $35.0$ respectively. Part (b) is the periodic part $g(\\theta)$ of the conjugacy (Eq.~(\\ref{eqn:conjugacy1D})) to a pure rotation, measured with respect to the center point $(0,0)$ for $F= 5.0, 15.0, $and $25.0$. Part (c) shows the absolute values of the Fourier coefficients of $g$. Their linear decay as $|k|$ increases in this log-linear plot means the coefficients decay exponentially fast, which is a signature of the analyticity $g$ and hence of the conjugacy to a pure rotation. The decay is exponentially fast up to the resolution of the numerics.\n}\n\\end{figure}\nRecall that every quasiperiodic map is conjugate to a pure rotation $T_\\rho$ by a vector $\\rho = (\\rho_1, \\dots,\\rho_d)$. In our discussion, we assume that the components \nof $\\rho$ are irrational and irrationally related. \nWhen we\nsay that $\\rho_1,\\dots,\\rho_d$ are irrationally related, we mean that\nthere are no integers $k_1,\\dots,k_d $\nand $k_0$ for which\n\n", "index": 23, "text": "\\begin{equation}\\label{eqn:irratrel}\nk_1\\rho_1 + k_2 \\rho_2 + \\dots + k_d \\rho_d \\ne k_0, \n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E10.m1\" class=\"ltx_Math\" alttext=\"k_{1}\\rho_{1}+k_{2}\\rho_{2}+\\dots+k_{d}\\rho_{d}\\neq k_{0},\" display=\"block\"><mrow><mrow><mrow><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>\u2062</mo><msub><mi>\u03c1</mi><mn>1</mn></msub></mrow><mo>+</mo><mrow><msub><mi>k</mi><mn>2</mn></msub><mo>\u2062</mo><msub><mi>\u03c1</mi><mn>2</mn></msub></mrow><mo>+</mo><mi mathvariant=\"normal\">\u2026</mi><mo>+</mo><mrow><msub><mi>k</mi><mi>d</mi></msub><mo>\u2062</mo><msub><mi>\u03c1</mi><mi>d</mi></msub></mrow></mrow><mo>\u2260</mo><msub><mi>k</mi><mn>0</mn></msub></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.06051.tex", "nexttext": "\n\n\\end{definition}\n\nNote that possible rotation vector of a quasiperiodic map on a torus ${\\mathbb{T}^d}$ \ndepends on the coordinates chosen for $T$ and $y_0$. For example,\nfor domain $\\mathbb{T}^2$, the set of pairs $(\\rho_1,\\rho_2)$ possible for a fixed $T$ is dense in \nthe two-torus. See~\\cite{Das-Yorke}. \n\nBased on the above definition, the standard method of computing $\\rho$ from an orbit $(y_n)_{n=0}^{N-1}$ is to calculate the average\n\n", "itemtype": "equation", "pos": 30070, "prevtext": "\nunless all $k_i$ are zero.\n\nSince we are only provided with the\nmap $T$ and not with the map $T_{\\rho}$, we need a way of recovering the\nrotation vector $\\rho$ using only a forward trajectory of the map $T$. The\nfollowing definition gives a way of calculating the rotation vector \ndirectly from the original map. In fact, the rotation vector given in the definition\nis valid well beyond the case of a quasiperiodic function. For example, the rotation vector can\ncertainly be rational in one or all of its components. \n\n\\begin{definition}[Rotation vectors.] \nThe rotation vector of a trajectory $(y_n)_{0}^{N-1}$ of a quasiperiodic\nmap $T$ on a $d$-torus is the average rotation traversed by the sequence $d$-vectors\n$(T(y_n) - y_n) = (y_{n+1}-y_n)$. However, a little work needs to be done to formalize this\ndefinition, since even in one dimension there are two choices of how to\ndefine such a difference depending on whether you move clockwise or\ncounterclockwise around the circle, and in higher dimensions there are \nmany choices of coordinates. \nIn order to remove this angle discrepancy, \nwe must make this choice continuously so we associate with torus map $T$ a \ncontinuous map $\t\\tilde{T}$ on the full Euclidean space such that \n\\begin{displaymath}\\label{eqn:q_as_cover}\n\t\\tilde{T}(z) \\pmod 1 = T(z \\pmod 1).\n\\end{displaymath}\nThe map $\t\\tilde{T}$ is called a {\\bf lift} of $T$. \nSince $T$ is invertible, the map  $\t\t\\tilde{T}(z)-z$ has period one in every coordinate direction. \nFor example, the pure rotation $T(\\theta)  = \\theta + \\rho \\pmod 1,$ for $\\theta$ in ${\\mathbb{T}^d}$ has a corresponding \nlift map $\t\\tilde{T}(z) = z + \\rho,$ for $z$ in ${\\mathbb R}^d$. \nOf course if $\\rho$ was $\\sqrt2$, we would have the same map $T$ as for $\\rho = \\sqrt 2 - 1$ so we define $\\tilde T$ using rotation numbers are in $(0,1)$.\nUsing the lift, we now give a formula for the rotation vector for the trajectory $(y_n)$ starting\nat $y_0$: \n\n\n", "index": 25, "text": "\\begin{equation}\\label{eqn:rot_num_defn}\n\\rho(T,y_0):=\\lim_{N\\rightarrow\\infty} \\frac{1}{N} \\sum_{n=0}^{N-1} \\left( \t\\tilde{T}(y_n)-y_n \\right) .\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E11.m1\" class=\"ltx_Math\" alttext=\"\\rho(T,y_{0}):=\\lim_{N\\rightarrow\\infty}\\frac{1}{N}\\sum_{n=0}^{N-1}\\left(%&#10;\\tilde{T}(y_{n})-y_{n}\\right).\" display=\"block\"><mrow><mrow><mrow><mi>\u03c1</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>T</mi><mo>,</mo><msub><mi>y</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>:=</mo><mrow><munder><mo movablelimits=\"false\">lim</mo><mrow><mi>N</mi><mo>\u2192</mo><mi mathvariant=\"normal\">\u221e</mi></mrow></munder><mo>\u2061</mo><mrow><mfrac><mn>1</mn><mi>N</mi></mfrac><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>-</mo><mn>1</mn></mrow></munderover><mrow><mo>(</mo><mrow><mrow><mover accent=\"true\"><mi>T</mi><mo stretchy=\"false\">~</mo></mover><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><msub><mi>y</mi><mi>n</mi></msub></mrow><mo>)</mo></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.06051.tex", "nexttext": "\nThis method converges slowly, with order of at most $1/N$. However, since Eq. (\\ref{eqn:rot_num_alt}) can be written as a Birkhoff average by writing $f(y_n)=\\tilde{T}(y_n)-y_{n}$, we can apply our method to this function. That is, let $(y_n)_{n=0}^{N-1}$ be an orbit for $\t\\tilde{T}$.\nOur approximation of $\\rho$ is given by the weighted average of $f$,\n\n", "itemtype": "equation", "pos": 30675, "prevtext": "\n\n\\end{definition}\n\nNote that possible rotation vector of a quasiperiodic map on a torus ${\\mathbb{T}^d}$ \ndepends on the coordinates chosen for $T$ and $y_0$. For example,\nfor domain $\\mathbb{T}^2$, the set of pairs $(\\rho_1,\\rho_2)$ possible for a fixed $T$ is dense in \nthe two-torus. See~\\cite{Das-Yorke}. \n\nBased on the above definition, the standard method of computing $\\rho$ from an orbit $(y_n)_{n=0}^{N-1}$ is to calculate the average\n\n", "index": 27, "text": "\\begin{equation}\\label{eqn:rot_num_alt}\n\\rho\\approx\\frac{1}{N} \\sum_{n=0}^{N-1} (\t\\tilde{T}(y_n)-y_n).\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E12.m1\" class=\"ltx_Math\" alttext=\"\\rho\\approx\\frac{1}{N}\\sum_{n=0}^{N-1}(\\tilde{T}(y_{n})-y_{n}).\" display=\"block\"><mrow><mrow><mi>\u03c1</mi><mo>\u2248</mo><mrow><mfrac><mn>1</mn><mi>N</mi></mfrac><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>-</mo><mn>1</mn></mrow></munderover><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mover accent=\"true\"><mi>T</mi><mo stretchy=\"false\">~</mo></mover><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><msub><mi>y</mi><mi>n</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.06051.tex", "nexttext": "\n\n\n\n\\subsection{Three Dynamical Systems}\n{\\bf The standard map.} \nThe standard map is an area preserving map on the two-dimensional torus, often studied as a typical\nexample of analytic twist maps (see \\cite{StdMap1}). It is defined as follows\n\\begin{eqnarray}\\label{eqn:StdMap}\nS_1\n\\left(\n\\begin{array}{c}\nx \\\\\ny\n\\end{array}\n\\right)\n=\n\\left(\n\\begin{array}{c}\nx+y \\\\\ny+  \\alpha \\sin (x+y)\n\\end{array}\n\\right)\n\\pmod{2\\pi}.\n\\end{eqnarray}\n\nIn this paper, we only consider the case $\\alpha=1.0$. \nFig.~\\ref{fig:StdMap_global}(a) shows the\ntrajectories starting at a variety of different initial conditions\nplotted in different colors. The shaded set is a large invariant chaotic set\nwith chaotic behavior, but many other invariant sets consist of\none or more topological circles, on which the system has quasiperiodic\nbehavior. For example, initial condition $(\\pi,1.65)$ yields chaos\nwhile $(\\pi,1.5)$ yields a quasiperiodic trajectory. As is clearly\nthe case here, one-dimensional\nquasiperiodic sets often occur in families for non-linear processes,\nstructured like the rings of an onion. There are typically narrow bands of chaos between quasiperiodic onion rings. Usually these inner rings are differentiable images of the $d$-torus. We have computed the rotation number for one such  standard map orbit shown in the Fig.~\\ref{fig:StdMap_global}(b) using quadruple precision. Its value is given in Table~\\ref{table:summary}.\n\n{\\bf The forced Van der Pol oscillator.} Fig.~\\ref{fig:vdP_global} shows orbits for the time-$2\\pi/0.83$ map of the\nfollowing periodically forced Van der Pol oscillator with nonlinear\ndamping~\\cite{vdPol_forced}\n\n\n", "itemtype": "equation", "pos": 31148, "prevtext": "\nThis method converges slowly, with order of at most $1/N$. However, since Eq. (\\ref{eqn:rot_num_alt}) can be written as a Birkhoff average by writing $f(y_n)=\\tilde{T}(y_n)-y_{n}$, we can apply our method to this function. That is, let $(y_n)_{n=0}^{N-1}$ be an orbit for $\t\\tilde{T}$.\nOur approximation of $\\rho$ is given by the weighted average of $f$,\n\n", "index": 29, "text": "\\begin{equation}\\label{eqn:weighted_rho}\n{\\mbox{WB}}_N (y_{n+1}-y_n) := \\sum\\limits_{n=0}^{N-1} \\hat{w}_{n,N} (y_{n+1}-y_n)\\rightarrow \\rho \\mbox{ as } N \\to\\infty.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E13.m1\" class=\"ltx_Math\" alttext=\"{\\mbox{WB}}_{N}(y_{n+1}-y_{n}):=\\sum\\limits_{n=0}^{N-1}\\hat{w}_{n,N}(y_{n+1}-y%&#10;_{n})\\rightarrow\\rho\\mbox{ as }N\\to\\infty.\" display=\"block\"><mrow><mrow><mrow><msub><mtext>WB</mtext><mi>N</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>-</mo><msub><mi>y</mi><mi>n</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>:=</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>-</mo><mn>1</mn></mrow></munderover><mrow><msub><mover accent=\"true\"><mi>w</mi><mo stretchy=\"false\">^</mo></mover><mrow><mi>n</mi><mo>,</mo><mi>N</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>-</mo><msub><mi>y</mi><mi>n</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>\u2192</mo><mrow><mi>\u03c1</mi><mo>\u2062</mo><mtext>\u00a0as\u00a0</mtext><mo>\u2062</mo><mi>N</mi></mrow><mo>\u2192</mo><mi mathvariant=\"normal\">\u221e</mi></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.06051.tex", "nexttext": "\n\nfor several values of $F$. While the innermost orbit shown is a chaotic attractor, the outer orbits are topological circles with quasiperiodic behavior\\footnote{As with the standard map, we have specified all non-essential parameters rather than stating the most general form of the Van der Pol equation.}. Our computed rotation numbers for the three orbits $F=5.0$, $15.0$, and $25.0$ are given in Table~\\ref{table:summary}. \n\n{\\bf A two-dimensional torus map.} So far, the quasiperiodic sets studied here are closed curves. We now introduce an example of a two-dimensional quasiperiodic torus map on $\\mathbb{T}^2$.  This is a two-dimensional version of Arnold's family of one-dimensional maps (see \\cite{Arnold}). It was originally introduced in two papers~\\cite{Grebogi:83,Grebogi:85}. The map is given by $(T_1,T_2)$ where \n\n\\begin{eqnarray}\nT_1(x,y) = \\left[ x+ \\omega_1 + \\frac{\\epsilon}{2 \\pi} P_1(x,y) \\right] \\pmod 1, \\label{eqn:2D_map} \\\\\nT_2(x,y) = \\left[ y+ \\omega_2 + \\frac{\\epsilon}{2 \\pi} P_2(x,y) \\right] \\pmod 1,\\nonumber\n\\end{eqnarray}\nand $P_i(x,y), i=1,2$ are periodic functions with period one in both variables, defined by:\n", "itemtype": "equation", "pos": 32967, "prevtext": "\n\n\n\n\\subsection{Three Dynamical Systems}\n{\\bf The standard map.} \nThe standard map is an area preserving map on the two-dimensional torus, often studied as a typical\nexample of analytic twist maps (see \\cite{StdMap1}). It is defined as follows\n\\begin{eqnarray}\\label{eqn:StdMap}\nS_1\n\\left(\n\\begin{array}{c}\nx \\\\\ny\n\\end{array}\n\\right)\n=\n\\left(\n\\begin{array}{c}\nx+y \\\\\ny+  \\alpha \\sin (x+y)\n\\end{array}\n\\right)\n\\pmod{2\\pi}.\n\\end{eqnarray}\n\nIn this paper, we only consider the case $\\alpha=1.0$. \nFig.~\\ref{fig:StdMap_global}(a) shows the\ntrajectories starting at a variety of different initial conditions\nplotted in different colors. The shaded set is a large invariant chaotic set\nwith chaotic behavior, but many other invariant sets consist of\none or more topological circles, on which the system has quasiperiodic\nbehavior. For example, initial condition $(\\pi,1.65)$ yields chaos\nwhile $(\\pi,1.5)$ yields a quasiperiodic trajectory. As is clearly\nthe case here, one-dimensional\nquasiperiodic sets often occur in families for non-linear processes,\nstructured like the rings of an onion. There are typically narrow bands of chaos between quasiperiodic onion rings. Usually these inner rings are differentiable images of the $d$-torus. We have computed the rotation number for one such  standard map orbit shown in the Fig.~\\ref{fig:StdMap_global}(b) using quadruple precision. Its value is given in Table~\\ref{table:summary}.\n\n{\\bf The forced Van der Pol oscillator.} Fig.~\\ref{fig:vdP_global} shows orbits for the time-$2\\pi/0.83$ map of the\nfollowing periodically forced Van der Pol oscillator with nonlinear\ndamping~\\cite{vdPol_forced}\n\n\n", "index": 31, "text": "\\begin{equation}\\label{vdPol_forced}\n\\frac{d^2 x}{dt^2}-0.2 \\left( 1-x^2 \\right) \\frac{dx}{dt}+20 x^3=F\\sin \\left(0.83 t \\right),\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14.m1\" class=\"ltx_Math\" alttext=\"\\frac{d^{2}x}{dt^{2}}-0.2\\left(1-x^{2}\\right)\\frac{dx}{dt}+20x^{3}=F\\sin\\left(%&#10;0.83t\\right),\" display=\"block\"><mrow><mrow><mrow><mrow><mfrac><mrow><msup><mi>d</mi><mn>2</mn></msup><mo>\u2062</mo><mi>x</mi></mrow><mrow><mi>d</mi><mo>\u2062</mo><msup><mi>t</mi><mn>2</mn></msup></mrow></mfrac><mo>-</mo><mrow><mn>0.2</mn><mo>\u2062</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msup><mi>x</mi><mn>2</mn></msup></mrow><mo>)</mo></mrow><mo>\u2062</mo><mfrac><mrow><mi>d</mi><mo>\u2062</mo><mi>x</mi></mrow><mrow><mi>d</mi><mo>\u2062</mo><mi>t</mi></mrow></mfrac></mrow></mrow><mo>+</mo><mrow><mn>20</mn><mo>\u2062</mo><msup><mi>x</mi><mn>3</mn></msup></mrow></mrow><mo>=</mo><mrow><mi>F</mi><mo>\u2062</mo><mrow><mi>sin</mi><mo>\u2061</mo><mrow><mo>(</mo><mrow><mn>0.83</mn><mo>\u2062</mo><mi>t</mi></mrow><mo>)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.06051.tex", "nexttext": "\nThe values of all coefficients are given in Table~\\ref{table}. \n\n\\begin{table}[t]\n\\begin{center}\n{\\begin{tabular}{ |c | c| }\n\\hline\nCoefficient & Value \\\\\n\\hline\n$\\epsilon$ & $ 0.4234823$ \\[1pt]\n$\\omega_1$ & $ 0.71151134457776362264681206697006238 $ \\[2pt]\n$\\omega_2$ & $ 0.87735009811261456100917086672849971 $ \\[1pt]\n$a_{1,j}$ & $(-0.268,-0.9106,0.3,-0.04)$ \\[1pt]\n$a_{2,j}$ & $(0.08,-0.56,0.947,-0.4003)$ \\[1pt]\n$b_{1,j}$ & $(0.985,0.504,0.947,0.2334)$ \\[1pt]\n$b_{2,j}$ & $(0.99,0.33,0.29,0.155)$ \\[1pt]\n$r_j$ & $(1,0,1,0)$ \\[1pt]\n$s_j$ & $(0,1,1,-1)$ \\[1pt]\nComputed $\\rho_1$ & $0.718053759982066107095244936117$ \\[1pt]\nComputed $\\rho_2$ & $0.885304666596099792113366824157$ \\[1pt]\n\\hline\n\\end{tabular}}\n\\end{center}\n\\caption{\\label{table}\n{\\bf Coefficients for the torus map.} All values are used in quadruple precision, \nbut in this table the repeated zeros on the end of the number are suppressed.}\n\\end{table}\n\nThis choice of this function is based on~\\cite{Grebogi:83,\nGrebogi:85}. Both papers use the same form of equation, though\nthe constants are close to but not precisely the same as the ones used previously. \nThis is fitting with the point of view advocated by these papers: that the constants should be randomly chosen. Since we\nare using higher precision, we have chosen constants\nthat are irrational to the level of our precision. The forward orbit is\ndense on the torus, and the map is a nonlinear map which exhibits two-dimensional quasiperiodic behavior.\n\nFig.~\\ref{fig:2DMap_overview}(a) depicts iterates of the orbit, indicating that it is\ndense in the torus. We use our weighted Birkhoff average to compute the two Lyapunov exponents, which have super convergence to  \nzero. Fig.~\\ref{fig:2DMap_overview}(b) shows one of them. In terms of method, this is just a matter of changing the function $f$ used in ${\\mbox{WB}}_N$ in Eq. (\\ref{eqn:QN}). \nLikewise, finding rotation numbers in two dimensions uses the same technique as in the one-dimensional case ({\\em cf.} Fig.~\\ref{fig:2DMap_overview}(c)).\nIn all of our calculations, the computation is significantly longer than in dimension one in order\nto get the same accuracy, perhaps because \nin dimension two sufficient coverage by a trajectory \nmay vary like the square of the side length of the domain. \n\n\\begin{figure}[t]\n\\centering\n\\subfigure[ ]{\\includegraphics[height= .3\\textwidth]{orbitontorus.png}}\n\\subfigure[ ]{\\includegraphics[height= .3\\textwidth]{rot1compare.png}}\n\n\\caption{\\textbf{Two-dimensional torus map.} Part (a) shows an\norbit of length $10^{4}$ for the two-dimensional quasiperiodic torus\nmap. The orbit appears to be dense, which is consistent with\nquasiperiodicity. Part (b) shows the convergence rate for the first rotation number for the four different weighting functions. The highest to lowest curves show the convergence rates resp. for the four weighting functions given in\nEq. (\\ref{eqn:weights}), resp. in red, magenta, green, and blue. The black line is an upper bound for the blue curve and its exponent indicates the rate of convergence when using the $C^\\infty$ weight.}\n\n\\label{fig:2DMap_overview}\n\\end{figure}\n\n\\begin{figure}[t]\n\\centering\n\\subfigure[ ]{\\includegraphics[height= .3\\textwidth]{Lyap1.png}}\n\\subfigure[ ]{\\includegraphics[height= .3\\textwidth]{Lyapsum.png}}\n\n\\caption{\\textbf{Lyapunov exponents computed with ${\\mbox{WB}}_N$.}\nThe two Lyapunov exponents of the torus map from Fig.~\\ref{fig:2DMap_overview} are computed using ${\\mbox{WB}}_N$ and we find them to be $0$ up to our numerical accuracy. (a) The computation for the first Lyapunov exponent is shown in blue for up to $10^7$ iterates. The other three curves depict the values attained using the three other weighting functions, using the  same color scheme as in Fig.~\\ref{fig:2DMap_overview}. Part (b) shows the sum of the two Lyapunov exponents  computed via direct computation of the determinant as described in Eq. (\\ref{eqlyapsum}). }\n\n\\label{fig:2DMap_lyap}\n\\end{figure}\n\n\n\n\\begin{figure}[t]\n\\centering\n\\subfigure[ ]{\\includegraphics[height=.4\\textwidth] {weighting.pdf}}\n\\subfigure[ ]{\\includegraphics[height=.4\\textwidth] {Std_map,rot_num_cnvrgnc.png}}\n\\caption{\\textbf{Rate of convergence for different weight functions}. \n\nPart (a) is a plot of three non-constant weighting functions from Eq.\n(\\ref{eqn:weights}) and below $w_{quad}$ (top), $w_{\\sin^2}$ (second),\n$w_{\\exp}$ (lowest). Since only the shape matters, they have been \nrescaled so that each has a peak of approximately $1.0$. Part (b) shows results for the standard map using the same trajectory for each plot. \nFor a given $w$ and a given number of iterates $N$, the rotation number $\\hat{\\rho}$ approximation is calculated for $B_1$ of the R3BP -- all using the same trajectory. The plotted error of the calculation is the difference $|\\rho-\\hat{\\rho}|$ as a function of $N$. The exponential weight function $w_{exp}$ allows ${\\mbox{WB}}_N$ to reach a limit by approximately $N=50,000$ after which it fluctuates by approximately $10^{-30}$. The black line\nindicates the average slope of the bottom-most curve for large $N$ and hence the rate of\nconvergence for the $C^\\infty$ weighted average.}\n\n\\label{fig:mid_circle}\n\\end{figure}\n\n\\begin{figure}[t]\n\\centering\n\\subfigure[ ]{\\includegraphics[width = .46\\textwidth]{reconstruction1.png}}\n\\subfigure[ ]{\\includegraphics[width = .46\\textwidth]{fouriercomp1.pdf}}\n\\caption{\\textbf{Conjugacy for the two-dimensional torus map.} \\label{2DTorus_results}\n\nPart (a) depicts the reconstruction of the periodic part $g$ (see Eq.  \\ref{eqn:g_conjugacy}) of the first component of the \nconjugacy function for the torus map. The surface is colored by height. The surface is created using the Fourier coefficients \nshown in (b). \nThe second conjugacy function is similar but not depicted here. \nPart (b) shows the norm of the Fourier coefficients $|a_{j,k}|$ and $|a_{j,-k}|$, for $0 \\le j,k \\le 100$ \nfor the first component of the conjugacy function from part (a). \n\n}\n\\end{figure}\n\n\n\n{\\bf Convergence rate of} \\boldmath ${\\mbox{WB}}_N$. \\unboldmath In order to illustrate how fast the convergence of our method is as $N\\rightarrow\\infty$, we introduce four different possible choices for the weighting function $w$, depicted in Fig.~\\ref{fig:mid_circle}(a), and compare the convergence results for computing the rotation number for each of these choices of $w$. \n\n\\begin{eqnarray}\nw_{equal}(t) & = & 1\\mbox{ (Birkhoff's choice)}  \\label{eqn:weights} \\\\\nw_{quad}(t) & = & t (1-t)\\nonumber  \\\\\nw_{(\\sin^2)}(t) & = & \\sin^2(\\pi t) \\nonumber \\\\\nw_{\\exp}(t) & = & \\exp\\left({-1}/{(t(1-t))}  \\nonumber  \\right).\n\\end{eqnarray}\nThe weight functions described above are defined to be $0$ outside $(0,1)$ and equal to the specified function inside $(0,1)$. \nRecall that the last function in the list, $w_{\\exp}$, is the function used in our calculations. \nIt is the only one in the list that is $C^\\infty$. The others fail to be $C^\\infty$ at $t=0$ and $t=1$.\nIf we compute with the first choice of $w$, we recover the truncated sum in the definition of the Birkhoff average. To estimate the error, we expect the difference $f(x_{N+1})-f(x_{N})$ to be of order one, implying that \n", "itemtype": "equation", "pos": 34259, "prevtext": "\n\nfor several values of $F$. While the innermost orbit shown is a chaotic attractor, the outer orbits are topological circles with quasiperiodic behavior\\footnote{As with the standard map, we have specified all non-essential parameters rather than stating the most general form of the Van der Pol equation.}. Our computed rotation numbers for the three orbits $F=5.0$, $15.0$, and $25.0$ are given in Table~\\ref{table:summary}. \n\n{\\bf A two-dimensional torus map.} So far, the quasiperiodic sets studied here are closed curves. We now introduce an example of a two-dimensional quasiperiodic torus map on $\\mathbb{T}^2$.  This is a two-dimensional version of Arnold's family of one-dimensional maps (see \\cite{Arnold}). It was originally introduced in two papers~\\cite{Grebogi:83,Grebogi:85}. The map is given by $(T_1,T_2)$ where \n\n\\begin{eqnarray}\nT_1(x,y) = \\left[ x+ \\omega_1 + \\frac{\\epsilon}{2 \\pi} P_1(x,y) \\right] \\pmod 1, \\label{eqn:2D_map} \\\\\nT_2(x,y) = \\left[ y+ \\omega_2 + \\frac{\\epsilon}{2 \\pi} P_2(x,y) \\right] \\pmod 1,\\nonumber\n\\end{eqnarray}\nand $P_i(x,y), i=1,2$ are periodic functions with period one in both variables, defined by:\n", "index": 33, "text": "\n\\[\nP_i(x,y) = \\sum_{j=1}^4 a_{i,j} \\sin (2 \\pi \\alpha_{i,j}), \\mbox{ with } \\alpha_{i,j}= r_j x + s_j y +b_{i,j}.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"P_{i}(x,y)=\\sum_{j=1}^{4}a_{i,j}\\sin(2\\pi\\alpha_{i,j}),\\mbox{ with }\\alpha_{i,%&#10;j}=r_{j}x+s_{j}y+b_{i,j}.\" display=\"block\"><mrow><mrow><mrow><mrow><msub><mi>P</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mn>4</mn></munderover><mrow><msub><mi>a</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><mrow><mi>sin</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mn>2</mn><mo>\u2062</mo><mi>\u03c0</mi><mo>\u2062</mo><msub><mi>\u03b1</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow><mo>,</mo><mrow><mrow><mtext>\u00a0with\u00a0</mtext><mo>\u2062</mo><msub><mi>\u03b1</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub></mrow><mo>=</mo><mrow><mrow><msub><mi>r</mi><mi>j</mi></msub><mo>\u2062</mo><mi>x</mi></mrow><mo>+</mo><mrow><msub><mi>s</mi><mi>j</mi></msub><mo>\u2062</mo><mi>y</mi></mrow><mo>+</mo><msub><mi>b</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.06051.tex", "nexttext": "\nThe choice of a particular starting point also creates a similar uncertainty of order $1/N$. Every function $w$ is always positive  between $0$ and $1$. For all but the first choice, the function vanishes as $t$ approaches $0$ and $1$. In addition, going down the list, increasing number of derivatives of $w$ vanish for $t \\to 0$ and $t\\to 1$, with all derivatives of $w_{\\exp}$ vanishing at $0$ and $1$. We thus expect the effect of the starting and endpoints to decay at the same rate as this number of vanishing derivatives. Indeed, we find that $w_{quad}$ corresponds approximately to order $1/N^2$ convergence, $w_{(\\sin^2)}$ to $1/N^3$ convergence, and $w_{\\exp}$ to convergence faster than any polynomial in $1/N$, i.e., for every integer $m$, there is a constant $C>0$ such that for $N$ sufficiently large, $|{\\mbox{WB}}_Nf-\\int fd\\mu|\\leq CN^{-m}$. Figs.~\\ref{fig:2DMap_overview}(b) and ~\\ref{fig:mid_circle}(b)  show this effect. We have not tried other $C^\\infty$ weight functions.\n\n{\\bf Related methods}. See \\cite{seara:villanueva:06,luque:villanueva:14} for references to earlier methods for computing rotation numbers. In \n\\cite{seara:villanueva:06,luque:villanueva:14}, A. Luque and J.\nVillanueva develop fast methods for obtaining rotation numbers for\nsmooth or analytic functions on a quasiperiodic torus, sometimes with\nquasiperiodic forcing with several rotation numbers. \nThe paper \\cite{luque:villanueva:14} develops a technique to compute rotation numbers (but not other function integrals) with error satisfying $|error| \\le C_p N^{-p}$ for $N\\geq 2^p$ where $C_p$ is a constant. \nTheir method of computation is defined  recursively, with the $p+1^{st}$ method being defined in terms of the $p^{th}$. As $p$ increases the computational complexity increases for fixed $N$. \nIf $\\tau(p,N_p)$ is their computation time when using $N=N_p$, it appears that $\\tau(p,N_p)/N_p\\rightarrow\\infty$ as $p\\rightarrow\\infty$ (and $N_p \\to \\infty)$. \nIn comparison, computation time for our weighted Birkhoff average is simply proportional to $N$ since it requires a sum of $N$ numbers. Fig. 11 from \\cite{luque:villanueva:14} shows the rate of convergence to the rotation number for a quasiperiodic orbit arising from the R3BP.  There, they get 30-digit accuracy for the rotation number using $N\\approx 2,000,000$ trajectory points while we get 30-digit accuracy with $N = 20,000$. The rate of convergence of their method is $\\approx N^{-7.8}$. \nTheir methods were extended in \\cite{luque:RotDeriv} to compute the derivatives of the rotation numbers for 1-parameter families of circle diffeomorphisms, and in \\cite{luque:fourier} to compute the Fourier coefficients of the conjugacy function (i.e. the change of variables between \nthe map and pure rotation).\n\nFor several figures that are log-log plots of estimated errors, there is no single slope that describes the plots. We have drawn a black line as our estimate of  the rate of convergence in the region where N is large and the error is still decreasing. The $O(N^{-slope})$ are based on those lines. Hence our  estimates of error decrease for large N are:\n\\begin{itemize}\n\\item$O(N^{-15.0})$ for R3BP in Fig. \\ref{fig:results_3B}(d).\n\\item$O(N^{-10.0})$  in   Fig. \\ref{fig:2DMap_overview}(b).\n\\item$O(N^{-20.0})$ and $O(N^{-16.7})$ in Figs. \\ref{fig:2DMap_lyap}(a) and (b).\n\\item$O(N^{-8.75})$ in Fig. \\ref{fig:mid_circle}(b).\n\\item $O(N^{-22.0})$ in Fig. \\ref{fig:intrinsic_error}.\n\\item$O(N^{-29.0})$ in Fig. \\ref{fig:circle_rotation}(b).\n\\end{itemize}\n\n\nSeveral variants of the Newton's method have been employed to determine quasiperiodic trajectories in different settings. In \\cite{NumericQuasi3} a variant of Newton's method was applied to locate periodic or quasi-periodic relative satellite motion in a non-linear, non-conservative setting. \n \nA PDE-based approach was taken in \\cite{NumericQuasi4}, where the authors defined an invariance equation which involves partial derivatives. The invariant tori are then computed using finite element methods. See also Section 2 in \\cite{NumericQuasi4} for more references on the numerical computation of invariant tori.\nIn \\cite{luque:KAM}, the authors used an application of the Newton's method to compute elliptical, low dimensional invariant tori in Hamiltonian systems.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\clearpage\n\\subsection\n{Error in the calculation when the true rotation number is known}\n\nIn order to test the error in the calculation of rotation number, \nwe present two examples below where we know the exact rotation number. This allow us to \ndetermine the actual error in the calculation for the ${\\mbox{WB}}_N$ method as $N$ increases. \nIn both cases the error decreases to \nless than $10^{-31}$ and then it grows as $N$ increases, apparently due to accumulated \nround-off error. \n\n{\\bf Example 1.} \nLet $(\\theta_n)$ be an orbit under the pure rotation described in Eq. (\\ref{eqn:Pure_rotation}) for a rotation by $\\rho = \\sqrt 2 -1$. Assume that what we observe is $\\phi$, a perturbed version of $\\theta$, namely, \n\n", "itemtype": "equation", "pos": 41559, "prevtext": "\nThe values of all coefficients are given in Table~\\ref{table}. \n\n\\begin{table}[t]\n\\begin{center}\n{\\begin{tabular}{ |c | c| }\n\\hline\nCoefficient & Value \\\\\n\\hline\n$\\epsilon$ & $ 0.4234823$ \\[1pt]\n$\\omega_1$ & $ 0.71151134457776362264681206697006238 $ \\[2pt]\n$\\omega_2$ & $ 0.87735009811261456100917086672849971 $ \\[1pt]\n$a_{1,j}$ & $(-0.268,-0.9106,0.3,-0.04)$ \\[1pt]\n$a_{2,j}$ & $(0.08,-0.56,0.947,-0.4003)$ \\[1pt]\n$b_{1,j}$ & $(0.985,0.504,0.947,0.2334)$ \\[1pt]\n$b_{2,j}$ & $(0.99,0.33,0.29,0.155)$ \\[1pt]\n$r_j$ & $(1,0,1,0)$ \\[1pt]\n$s_j$ & $(0,1,1,-1)$ \\[1pt]\nComputed $\\rho_1$ & $0.718053759982066107095244936117$ \\[1pt]\nComputed $\\rho_2$ & $0.885304666596099792113366824157$ \\[1pt]\n\\hline\n\\end{tabular}}\n\\end{center}\n\\caption{\\label{table}\n{\\bf Coefficients for the torus map.} All values are used in quadruple precision, \nbut in this table the repeated zeros on the end of the number are suppressed.}\n\\end{table}\n\nThis choice of this function is based on~\\cite{Grebogi:83,\nGrebogi:85}. Both papers use the same form of equation, though\nthe constants are close to but not precisely the same as the ones used previously. \nThis is fitting with the point of view advocated by these papers: that the constants should be randomly chosen. Since we\nare using higher precision, we have chosen constants\nthat are irrational to the level of our precision. The forward orbit is\ndense on the torus, and the map is a nonlinear map which exhibits two-dimensional quasiperiodic behavior.\n\nFig.~\\ref{fig:2DMap_overview}(a) depicts iterates of the orbit, indicating that it is\ndense in the torus. We use our weighted Birkhoff average to compute the two Lyapunov exponents, which have super convergence to  \nzero. Fig.~\\ref{fig:2DMap_overview}(b) shows one of them. In terms of method, this is just a matter of changing the function $f$ used in ${\\mbox{WB}}_N$ in Eq. (\\ref{eqn:QN}). \nLikewise, finding rotation numbers in two dimensions uses the same technique as in the one-dimensional case ({\\em cf.} Fig.~\\ref{fig:2DMap_overview}(c)).\nIn all of our calculations, the computation is significantly longer than in dimension one in order\nto get the same accuracy, perhaps because \nin dimension two sufficient coverage by a trajectory \nmay vary like the square of the side length of the domain. \n\n\\begin{figure}[t]\n\\centering\n\\subfigure[ ]{\\includegraphics[height= .3\\textwidth]{orbitontorus.png}}\n\\subfigure[ ]{\\includegraphics[height= .3\\textwidth]{rot1compare.png}}\n\n\\caption{\\textbf{Two-dimensional torus map.} Part (a) shows an\norbit of length $10^{4}$ for the two-dimensional quasiperiodic torus\nmap. The orbit appears to be dense, which is consistent with\nquasiperiodicity. Part (b) shows the convergence rate for the first rotation number for the four different weighting functions. The highest to lowest curves show the convergence rates resp. for the four weighting functions given in\nEq. (\\ref{eqn:weights}), resp. in red, magenta, green, and blue. The black line is an upper bound for the blue curve and its exponent indicates the rate of convergence when using the $C^\\infty$ weight.}\n\n\\label{fig:2DMap_overview}\n\\end{figure}\n\n\\begin{figure}[t]\n\\centering\n\\subfigure[ ]{\\includegraphics[height= .3\\textwidth]{Lyap1.png}}\n\\subfigure[ ]{\\includegraphics[height= .3\\textwidth]{Lyapsum.png}}\n\n\\caption{\\textbf{Lyapunov exponents computed with ${\\mbox{WB}}_N$.}\nThe two Lyapunov exponents of the torus map from Fig.~\\ref{fig:2DMap_overview} are computed using ${\\mbox{WB}}_N$ and we find them to be $0$ up to our numerical accuracy. (a) The computation for the first Lyapunov exponent is shown in blue for up to $10^7$ iterates. The other three curves depict the values attained using the three other weighting functions, using the  same color scheme as in Fig.~\\ref{fig:2DMap_overview}. Part (b) shows the sum of the two Lyapunov exponents  computed via direct computation of the determinant as described in Eq. (\\ref{eqlyapsum}). }\n\n\\label{fig:2DMap_lyap}\n\\end{figure}\n\n\n\n\\begin{figure}[t]\n\\centering\n\\subfigure[ ]{\\includegraphics[height=.4\\textwidth] {weighting.pdf}}\n\\subfigure[ ]{\\includegraphics[height=.4\\textwidth] {Std_map,rot_num_cnvrgnc.png}}\n\\caption{\\textbf{Rate of convergence for different weight functions}. \n\nPart (a) is a plot of three non-constant weighting functions from Eq.\n(\\ref{eqn:weights}) and below $w_{quad}$ (top), $w_{\\sin^2}$ (second),\n$w_{\\exp}$ (lowest). Since only the shape matters, they have been \nrescaled so that each has a peak of approximately $1.0$. Part (b) shows results for the standard map using the same trajectory for each plot. \nFor a given $w$ and a given number of iterates $N$, the rotation number $\\hat{\\rho}$ approximation is calculated for $B_1$ of the R3BP -- all using the same trajectory. The plotted error of the calculation is the difference $|\\rho-\\hat{\\rho}|$ as a function of $N$. The exponential weight function $w_{exp}$ allows ${\\mbox{WB}}_N$ to reach a limit by approximately $N=50,000$ after which it fluctuates by approximately $10^{-30}$. The black line\nindicates the average slope of the bottom-most curve for large $N$ and hence the rate of\nconvergence for the $C^\\infty$ weighted average.}\n\n\\label{fig:mid_circle}\n\\end{figure}\n\n\\begin{figure}[t]\n\\centering\n\\subfigure[ ]{\\includegraphics[width = .46\\textwidth]{reconstruction1.png}}\n\\subfigure[ ]{\\includegraphics[width = .46\\textwidth]{fouriercomp1.pdf}}\n\\caption{\\textbf{Conjugacy for the two-dimensional torus map.} \\label{2DTorus_results}\n\nPart (a) depicts the reconstruction of the periodic part $g$ (see Eq.  \\ref{eqn:g_conjugacy}) of the first component of the \nconjugacy function for the torus map. The surface is colored by height. The surface is created using the Fourier coefficients \nshown in (b). \nThe second conjugacy function is similar but not depicted here. \nPart (b) shows the norm of the Fourier coefficients $|a_{j,k}|$ and $|a_{j,-k}|$, for $0 \\le j,k \\le 100$ \nfor the first component of the conjugacy function from part (a). \n\n}\n\\end{figure}\n\n\n\n{\\bf Convergence rate of} \\boldmath ${\\mbox{WB}}_N$. \\unboldmath In order to illustrate how fast the convergence of our method is as $N\\rightarrow\\infty$, we introduce four different possible choices for the weighting function $w$, depicted in Fig.~\\ref{fig:mid_circle}(a), and compare the convergence results for computing the rotation number for each of these choices of $w$. \n\n\\begin{eqnarray}\nw_{equal}(t) & = & 1\\mbox{ (Birkhoff's choice)}  \\label{eqn:weights} \\\\\nw_{quad}(t) & = & t (1-t)\\nonumber  \\\\\nw_{(\\sin^2)}(t) & = & \\sin^2(\\pi t) \\nonumber \\\\\nw_{\\exp}(t) & = & \\exp\\left({-1}/{(t(1-t))}  \\nonumber  \\right).\n\\end{eqnarray}\nThe weight functions described above are defined to be $0$ outside $(0,1)$ and equal to the specified function inside $(0,1)$. \nRecall that the last function in the list, $w_{\\exp}$, is the function used in our calculations. \nIt is the only one in the list that is $C^\\infty$. The others fail to be $C^\\infty$ at $t=0$ and $t=1$.\nIf we compute with the first choice of $w$, we recover the truncated sum in the definition of the Birkhoff average. To estimate the error, we expect the difference $f(x_{N+1})-f(x_{N})$ to be of order one, implying that \n", "index": 35, "text": "\n\\[{\\mbox{WB}}_{w_{equal},N+1} - {\\mbox{WB}}_{w_{equal},N} \\sim 1/N.\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m1\" class=\"ltx_Math\" alttext=\"{\\mbox{WB}}_{w_{equal},N+1}-{\\mbox{WB}}_{w_{equal},N}\\sim 1/N.\" display=\"block\"><mrow><mrow><mrow><msub><mtext>WB</mtext><mrow><msub><mi>w</mi><mrow><mi>e</mi><mo>\u2062</mo><mi>q</mi><mo>\u2062</mo><mi>u</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>l</mi></mrow></msub><mo>,</mo><mrow><mi>N</mi><mo>+</mo><mn>1</mn></mrow></mrow></msub><mo>-</mo><msub><mtext>WB</mtext><mrow><msub><mi>w</mi><mrow><mi>e</mi><mo>\u2062</mo><mi>q</mi><mo>\u2062</mo><mi>u</mi><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mi>l</mi></mrow></msub><mo>,</mo><mi>N</mi></mrow></msub></mrow><mo>\u223c</mo><mrow><mn>1</mn><mo>/</mo><mi>N</mi></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.06051.tex", "nexttext": "\nWe use the weighted Birkhoff average as in Eq. (\\ref{eqn:weighted_rho})  (changing $y$ to $\\phi$) to obtain an estimate of the rotation number $\\rho$ from this orbit.\nFig. \\ref{fig:intrinsic_error} shows the results for  $\\alpha=0.1$ and $\\beta= 0.2$ in (a) and for the case  $\\alpha=0.0$ and $\\beta= 0.0$ in (b). \n\n{\\bf Example 2.} Fig. \\ref{fig:circle_rotation}\nshows a geometric version of the  problem from the previous example, and again the error in the rotation number is small. \n\n\n\\begin{figure}[t]\n\\centering\n\\subfigure[ ]{\\includegraphics[width = .48\\textwidth]{Rotnum_fluct_0_1_0_2.png}}\n\\subfigure[ ]{\\includegraphics[width = .48\\textwidth]{Intrinsic_error.png}}\n\\caption{{\\bf Testing how well the ${\\mbox{WB}}_N$ method can determine the rotation number.} Part (a) shows the convergence in the calculation of a known rotation number $\\rho=\\sqrt{2}-1$, for the trajectory $(\\phi_n)=(n\\rho\\mod 1)$ in Eq. (\\ref{eqn:nonlinear_rotation}), with $\\alpha=0.1$, $\\beta=0.2$, and $\\rho=\\sqrt{2}-1$. The error quickly drops to the limit of numerical precision and then  increases slowly as $N$ increases. This increase in the error is apparently due to accumulated round-off error. Part (b) shows the increasing round-off error in the rotation number for the trivial case ($\\alpha=\\beta=0)$, and again the error grows after passing a minimum as $N$ increases. }\n\\label{fig:intrinsic_error}\n\\end{figure}\n\n\\begin{figure}[t]\n\\centering\n\\subfigure[ ]{\\includegraphics[width = .48\\textwidth]{graph-setting-circle-rotation.png}}\n\\subfigure[ ]{\\includegraphics[width = .48\\textwidth]{graph-circle-rotation-err-with-respect-to-N-WB-Normal.png}}\n\\caption{{\\bf The error in the computed value of rotation number when the rotation number is known.} Part (a) shows the geometric configuration of the problem, with a constant rotation vector $\\rho = \\sqrt 2 -1$ about the origin. The trajectory is $(n\\rho \\pmod 1)$, but the observer measures the angle $\\phi$ as seen from its perspective at $P$, which is midway between the center of the circle, $O$, and the circle itself. Part (b) shows the convergence in the rotation number calculation using the simple Birkhoff average (upper graph) and the weighted Birkhoff average ${\\mbox{WB}}_N$ (lower graph), for the trajectory $(\\phi_n)$ described in (a). The error from the rigorous value $\\sqrt 2 -1$ is calculated for several values of number $N$. The weighted Birkhoff average ${\\mbox{WB}}_n(\\phi_{n+1}-\\phi_n)$ reaches 32-digit accuracy by $N=30,000$. }\n\\label{fig:circle_rotation}\n\\end{figure}\n\n\\subsection{Lyapunov exponents computed as a weighted  average}\\label{sec:Lyap}\n\nLyapunov exponents are an important characterization of the dynamics\nresulting from the map $T$. They measure the rate at which nearby\ntrajectories diverge or converge and can be used to distinguish between\nchaos and quasiperiodicity, for example, the existence of a positive\nLyapunov exponent implies chaos, while for quasiperiodic systems, all\nthe Lyapunov exponents are zero. Lyapunov exponents are usually\ncalculated numerically as an average \nof logarithms \nwith all terms weighted equally,\nand the computations are therefore limited by extremely slow convergence\nrates. For quasiperiodic systems we would expect the error in the\nexponents to be $O(1/N)$. For 2-dimensional quasiperiodic systems, the\nLyapunov exponent can be expressed as a weighted average (using ${\\mbox{WB}}_N$) and we observe that we obtain the Lyapunov\nexponents much faster. Fig.~\\ref{fig:2DMap_lyap} shows the convergence rate of the Lyapunov exponents \ncomputed using ${\\mbox{WB}}_N$.\n(We make no claim that we can prove convergence in (a) is super fast.) Using the\nweighted average does not change the limit.  \n\nRecall that given a $d$-manifold $M$ and a map $T:M\\to M$ with an invariant probability measure $\\mu$, Oseledet's multiplicative ergodic theorem (see \\cite{Oseledet_MSR}) states that there exists numbers $\\lambda_1 \\leq\\ldots\\leq \\lambda_d$ such that for $\\mu$-almost every point $x$ and every vector $v$ in the tangent space at $x$, the limit\n\n", "itemtype": "equation", "pos": 46671, "prevtext": "\nThe choice of a particular starting point also creates a similar uncertainty of order $1/N$. Every function $w$ is always positive  between $0$ and $1$. For all but the first choice, the function vanishes as $t$ approaches $0$ and $1$. In addition, going down the list, increasing number of derivatives of $w$ vanish for $t \\to 0$ and $t\\to 1$, with all derivatives of $w_{\\exp}$ vanishing at $0$ and $1$. We thus expect the effect of the starting and endpoints to decay at the same rate as this number of vanishing derivatives. Indeed, we find that $w_{quad}$ corresponds approximately to order $1/N^2$ convergence, $w_{(\\sin^2)}$ to $1/N^3$ convergence, and $w_{\\exp}$ to convergence faster than any polynomial in $1/N$, i.e., for every integer $m$, there is a constant $C>0$ such that for $N$ sufficiently large, $|{\\mbox{WB}}_Nf-\\int fd\\mu|\\leq CN^{-m}$. Figs.~\\ref{fig:2DMap_overview}(b) and ~\\ref{fig:mid_circle}(b)  show this effect. We have not tried other $C^\\infty$ weight functions.\n\n{\\bf Related methods}. See \\cite{seara:villanueva:06,luque:villanueva:14} for references to earlier methods for computing rotation numbers. In \n\\cite{seara:villanueva:06,luque:villanueva:14}, A. Luque and J.\nVillanueva develop fast methods for obtaining rotation numbers for\nsmooth or analytic functions on a quasiperiodic torus, sometimes with\nquasiperiodic forcing with several rotation numbers. \nThe paper \\cite{luque:villanueva:14} develops a technique to compute rotation numbers (but not other function integrals) with error satisfying $|error| \\le C_p N^{-p}$ for $N\\geq 2^p$ where $C_p$ is a constant. \nTheir method of computation is defined  recursively, with the $p+1^{st}$ method being defined in terms of the $p^{th}$. As $p$ increases the computational complexity increases for fixed $N$. \nIf $\\tau(p,N_p)$ is their computation time when using $N=N_p$, it appears that $\\tau(p,N_p)/N_p\\rightarrow\\infty$ as $p\\rightarrow\\infty$ (and $N_p \\to \\infty)$. \nIn comparison, computation time for our weighted Birkhoff average is simply proportional to $N$ since it requires a sum of $N$ numbers. Fig. 11 from \\cite{luque:villanueva:14} shows the rate of convergence to the rotation number for a quasiperiodic orbit arising from the R3BP.  There, they get 30-digit accuracy for the rotation number using $N\\approx 2,000,000$ trajectory points while we get 30-digit accuracy with $N = 20,000$. The rate of convergence of their method is $\\approx N^{-7.8}$. \nTheir methods were extended in \\cite{luque:RotDeriv} to compute the derivatives of the rotation numbers for 1-parameter families of circle diffeomorphisms, and in \\cite{luque:fourier} to compute the Fourier coefficients of the conjugacy function (i.e. the change of variables between \nthe map and pure rotation).\n\nFor several figures that are log-log plots of estimated errors, there is no single slope that describes the plots. We have drawn a black line as our estimate of  the rate of convergence in the region where N is large and the error is still decreasing. The $O(N^{-slope})$ are based on those lines. Hence our  estimates of error decrease for large N are:\n\\begin{itemize}\n\\item$O(N^{-15.0})$ for R3BP in Fig. \\ref{fig:results_3B}(d).\n\\item$O(N^{-10.0})$  in   Fig. \\ref{fig:2DMap_overview}(b).\n\\item$O(N^{-20.0})$ and $O(N^{-16.7})$ in Figs. \\ref{fig:2DMap_lyap}(a) and (b).\n\\item$O(N^{-8.75})$ in Fig. \\ref{fig:mid_circle}(b).\n\\item $O(N^{-22.0})$ in Fig. \\ref{fig:intrinsic_error}.\n\\item$O(N^{-29.0})$ in Fig. \\ref{fig:circle_rotation}(b).\n\\end{itemize}\n\n\nSeveral variants of the Newton's method have been employed to determine quasiperiodic trajectories in different settings. In \\cite{NumericQuasi3} a variant of Newton's method was applied to locate periodic or quasi-periodic relative satellite motion in a non-linear, non-conservative setting. \n \nA PDE-based approach was taken in \\cite{NumericQuasi4}, where the authors defined an invariance equation which involves partial derivatives. The invariant tori are then computed using finite element methods. See also Section 2 in \\cite{NumericQuasi4} for more references on the numerical computation of invariant tori.\nIn \\cite{luque:KAM}, the authors used an application of the Newton's method to compute elliptical, low dimensional invariant tori in Hamiltonian systems.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\clearpage\n\\subsection\n{Error in the calculation when the true rotation number is known}\n\nIn order to test the error in the calculation of rotation number, \nwe present two examples below where we know the exact rotation number. This allow us to \ndetermine the actual error in the calculation for the ${\\mbox{WB}}_N$ method as $N$ increases. \nIn both cases the error decreases to \nless than $10^{-31}$ and then it grows as $N$ increases, apparently due to accumulated \nround-off error. \n\n{\\bf Example 1.} \nLet $(\\theta_n)$ be an orbit under the pure rotation described in Eq. (\\ref{eqn:Pure_rotation}) for a rotation by $\\rho = \\sqrt 2 -1$. Assume that what we observe is $\\phi$, a perturbed version of $\\theta$, namely, \n\n", "index": 37, "text": "\\begin{equation}\\label{eqn:nonlinear_rotation}\n\\phi_{n}=\\theta_n+\\alpha\\cos(2\\pi\\theta_n)+\\beta\\sin(2\\pi\\theta_n),\\mbox{ where }\\theta_n= n\\rho\\pmod 1.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E15.m1\" class=\"ltx_Math\" alttext=\"\\phi_{n}=\\theta_{n}+\\alpha\\cos(2\\pi\\theta_{n})+\\beta\\sin(2\\pi\\theta_{n}),\\mbox%&#10;{ where }\\theta_{n}=n\\rho\\pmod{1}.\" display=\"block\"><mrow><mrow><mrow><msub><mi>\u03d5</mi><mi>n</mi></msub><mo>=</mo><mrow><msub><mi>\u03b8</mi><mi>n</mi></msub><mo>+</mo><mrow><mi>\u03b1</mi><mo>\u2062</mo><mrow><mi>cos</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mn>2</mn><mo>\u2062</mo><mi>\u03c0</mi><mo>\u2062</mo><msub><mi>\u03b8</mi><mi>n</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><mrow><mi>\u03b2</mi><mo>\u2062</mo><mrow><mi>sin</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mn>2</mn><mo>\u2062</mo><mi>\u03c0</mi><mo>\u2062</mo><msub><mi>\u03b8</mi><mi>n</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow><mo>,</mo><mrow><mrow><mtext>\u00a0where\u00a0</mtext><mo>\u2062</mo><msub><mi>\u03b8</mi><mi>n</mi></msub></mrow><mo>=</mo><mrow><mrow><mi>n</mi><mo>\u2062</mo><mi>\u03c1</mi></mrow><mspace width=\"veryverythickmathspace\"/><mrow><mo lspace=\"8.1pt\" stretchy=\"false\">(</mo><mrow><mo movablelimits=\"false\">mod</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.06051.tex", "nexttext": "\nexists and equals one among $\\lambda_1,\\ldots,\\lambda_d$. These numbers are the \\textbf{Lyapunov exponents} of the map. For the rest of the section, we will assume that we have a quasiperiodic orbit $(x_n)$ filling out a 2-dimensional torus $\\mathbb{T}^2$ and therefore $d=2$ and $M=\\mathbb{T}^2$. \n\nOne of the properties of the largest Lyapunov exponent $\\lambda_2$ is that for almost every vector $v$ in the tangent space at $x_0$, the quantity $N^{-1}\\ln\\|DT^{N}(x_0)v\\|$ converges to $\\lambda_2$. Note that this limit can be expressed as an average along the trajectory $(x_n)$ in the following manner:\n", "itemtype": "equation", "pos": 50893, "prevtext": "\nWe use the weighted Birkhoff average as in Eq. (\\ref{eqn:weighted_rho})  (changing $y$ to $\\phi$) to obtain an estimate of the rotation number $\\rho$ from this orbit.\nFig. \\ref{fig:intrinsic_error} shows the results for  $\\alpha=0.1$ and $\\beta= 0.2$ in (a) and for the case  $\\alpha=0.0$ and $\\beta= 0.0$ in (b). \n\n{\\bf Example 2.} Fig. \\ref{fig:circle_rotation}\nshows a geometric version of the  problem from the previous example, and again the error in the rotation number is small. \n\n\n\\begin{figure}[t]\n\\centering\n\\subfigure[ ]{\\includegraphics[width = .48\\textwidth]{Rotnum_fluct_0_1_0_2.png}}\n\\subfigure[ ]{\\includegraphics[width = .48\\textwidth]{Intrinsic_error.png}}\n\\caption{{\\bf Testing how well the ${\\mbox{WB}}_N$ method can determine the rotation number.} Part (a) shows the convergence in the calculation of a known rotation number $\\rho=\\sqrt{2}-1$, for the trajectory $(\\phi_n)=(n\\rho\\mod 1)$ in Eq. (\\ref{eqn:nonlinear_rotation}), with $\\alpha=0.1$, $\\beta=0.2$, and $\\rho=\\sqrt{2}-1$. The error quickly drops to the limit of numerical precision and then  increases slowly as $N$ increases. This increase in the error is apparently due to accumulated round-off error. Part (b) shows the increasing round-off error in the rotation number for the trivial case ($\\alpha=\\beta=0)$, and again the error grows after passing a minimum as $N$ increases. }\n\\label{fig:intrinsic_error}\n\\end{figure}\n\n\\begin{figure}[t]\n\\centering\n\\subfigure[ ]{\\includegraphics[width = .48\\textwidth]{graph-setting-circle-rotation.png}}\n\\subfigure[ ]{\\includegraphics[width = .48\\textwidth]{graph-circle-rotation-err-with-respect-to-N-WB-Normal.png}}\n\\caption{{\\bf The error in the computed value of rotation number when the rotation number is known.} Part (a) shows the geometric configuration of the problem, with a constant rotation vector $\\rho = \\sqrt 2 -1$ about the origin. The trajectory is $(n\\rho \\pmod 1)$, but the observer measures the angle $\\phi$ as seen from its perspective at $P$, which is midway between the center of the circle, $O$, and the circle itself. Part (b) shows the convergence in the rotation number calculation using the simple Birkhoff average (upper graph) and the weighted Birkhoff average ${\\mbox{WB}}_N$ (lower graph), for the trajectory $(\\phi_n)$ described in (a). The error from the rigorous value $\\sqrt 2 -1$ is calculated for several values of number $N$. The weighted Birkhoff average ${\\mbox{WB}}_n(\\phi_{n+1}-\\phi_n)$ reaches 32-digit accuracy by $N=30,000$. }\n\\label{fig:circle_rotation}\n\\end{figure}\n\n\\subsection{Lyapunov exponents computed as a weighted  average}\\label{sec:Lyap}\n\nLyapunov exponents are an important characterization of the dynamics\nresulting from the map $T$. They measure the rate at which nearby\ntrajectories diverge or converge and can be used to distinguish between\nchaos and quasiperiodicity, for example, the existence of a positive\nLyapunov exponent implies chaos, while for quasiperiodic systems, all\nthe Lyapunov exponents are zero. Lyapunov exponents are usually\ncalculated numerically as an average \nof logarithms \nwith all terms weighted equally,\nand the computations are therefore limited by extremely slow convergence\nrates. For quasiperiodic systems we would expect the error in the\nexponents to be $O(1/N)$. For 2-dimensional quasiperiodic systems, the\nLyapunov exponent can be expressed as a weighted average (using ${\\mbox{WB}}_N$) and we observe that we obtain the Lyapunov\nexponents much faster. Fig.~\\ref{fig:2DMap_lyap} shows the convergence rate of the Lyapunov exponents \ncomputed using ${\\mbox{WB}}_N$.\n(We make no claim that we can prove convergence in (a) is super fast.) Using the\nweighted average does not change the limit.  \n\nRecall that given a $d$-manifold $M$ and a map $T:M\\to M$ with an invariant probability measure $\\mu$, Oseledet's multiplicative ergodic theorem (see \\cite{Oseledet_MSR}) states that there exists numbers $\\lambda_1 \\leq\\ldots\\leq \\lambda_d$ such that for $\\mu$-almost every point $x$ and every vector $v$ in the tangent space at $x$, the limit\n\n", "index": 39, "text": "\\begin{equation}\n\\underset{N\\to\\infty}{\\lim}N^{-1}\\ln\\|DT^N(x)v\\|\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E16.m1\" class=\"ltx_Math\" alttext=\"\\underset{N\\to\\infty}{\\lim}N^{-1}\\ln\\|DT^{N}(x)v\\|\" display=\"block\"><mrow><munder accentunder=\"true\"><mo movablelimits=\"false\">lim</mo><mrow><mi>N</mi><mo>\u2192</mo><mi mathvariant=\"normal\">\u221e</mi></mrow></munder><mo>\u2062</mo><msup><mi>N</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><mrow><mi>ln</mi><mo>\u2061</mo><mrow><mo>\u2225</mo><mrow><mi>D</mi><mo>\u2062</mo><msup><mi>T</mi><mi>N</mi></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>v</mi></mrow><mo>\u2225</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.06051.tex", "nexttext": "\nWe obtain the same limit by taking our weighted average instead of a uniformly weighted average as above. We observe (without proof) that for quasiperiodic orbits, we get super-convergence to the same limit by taking a weighted average in the following manner:\n", "itemtype": "equation", "pos": 51580, "prevtext": "\nexists and equals one among $\\lambda_1,\\ldots,\\lambda_d$. These numbers are the \\textbf{Lyapunov exponents} of the map. For the rest of the section, we will assume that we have a quasiperiodic orbit $(x_n)$ filling out a 2-dimensional torus $\\mathbb{T}^2$ and therefore $d=2$ and $M=\\mathbb{T}^2$. \n\nOne of the properties of the largest Lyapunov exponent $\\lambda_2$ is that for almost every vector $v$ in the tangent space at $x_0$, the quantity $N^{-1}\\ln\\|DT^{N}(x_0)v\\|$ converges to $\\lambda_2$. Note that this limit can be expressed as an average along the trajectory $(x_n)$ in the following manner:\n", "index": 41, "text": "\n\\[N^{-1}\\ln\\|DT^n(x_0)v\\|=N^{-1}\\sum_{n=0}^{N-1}\\ln\\|v_n\\|, \\mbox{ where }v_n=DT(x_{n-1})\\frac{v_{n-1}}{\\|v_{n-1}\\|}, v_0=v. \\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m1\" class=\"ltx_Math\" alttext=\"N^{-1}\\ln\\|DT^{n}(x_{0})v\\|=N^{-1}\\sum_{n=0}^{N-1}\\ln\\|v_{n}\\|,\\mbox{ where }v%&#10;_{n}=DT(x_{n-1})\\frac{v_{n-1}}{\\|v_{n-1}\\|},v_{0}=v.\" display=\"block\"><mrow><mrow><mrow><mrow><msup><mi>N</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><mrow><mi>ln</mi><mo>\u2061</mo><mrow><mo>\u2225</mo><mrow><mi>D</mi><mo>\u2062</mo><msup><mi>T</mi><mi>n</mi></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>v</mi></mrow><mo>\u2225</mo></mrow></mrow></mrow><mo>=</mo><mrow><msup><mi>N</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>-</mo><mn>1</mn></mrow></munderover><mrow><mi>ln</mi><mo>\u2061</mo><mrow><mo>\u2225</mo><msub><mi>v</mi><mi>n</mi></msub><mo>\u2225</mo></mrow></mrow></mrow></mrow></mrow><mo>,</mo><mrow><mrow><mrow><mtext>\u00a0where\u00a0</mtext><mo>\u2062</mo><msub><mi>v</mi><mi>n</mi></msub></mrow><mo>=</mo><mrow><mi>D</mi><mo>\u2062</mo><mi>T</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mfrac><msub><mi>v</mi><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></msub><mrow><mo>\u2225</mo><msub><mi>v</mi><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2225</mo></mrow></mfrac></mrow></mrow><mo>,</mo><mrow><msub><mi>v</mi><mn>0</mn></msub><mo>=</mo><mi>v</mi></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.06051.tex", "nexttext": "\n\nSee Chapter 3 from \\cite{ChaosBook} for an explanation of this method.\n\n\nOnce we have calculated $\\lambda_2$, to calculate $\\lambda_1$, we can instead calculate $\\lambda_1+\\lambda_2$, the sum of all the Lyapunov exponents. $\\lambda_1+\\lambda_2$ can be expressed as the Birkhoff average of the function $f_1(x):=\\ln|\\det DT(x)|$. \nNote that $\\det DT(x_n) > 0$ for an orientation preserving map $T$. \nTherefore, we have \n", "itemtype": "equation", "pos": 51969, "prevtext": "\nWe obtain the same limit by taking our weighted average instead of a uniformly weighted average as above. We observe (without proof) that for quasiperiodic orbits, we get super-convergence to the same limit by taking a weighted average in the following manner:\n", "index": 43, "text": "\n\\[\\lambda_2=\\underset{N\\to\\infty}{\\lim}\\sum_{n=0}^{N-1}\\hat{w}_{n,N}\\ \\ln\\|v_n\\|,  \\mbox{ where }v_n=DT(x_{n-1})\\frac{v_{n-1}}{\\|v_{n-1}\\|}, v_0=v.\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex6.m1\" class=\"ltx_Math\" alttext=\"\\lambda_{2}=\\underset{N\\to\\infty}{\\lim}\\sum_{n=0}^{N-1}\\hat{w}_{n,N}\\ \\ln\\|v_{%&#10;n}\\|,\\mbox{ where }v_{n}=DT(x_{n-1})\\frac{v_{n-1}}{\\|v_{n-1}\\|},v_{0}=v.\" display=\"block\"><mrow><mrow><mrow><msub><mi>\u03bb</mi><mn>2</mn></msub><mo>=</mo><mrow><munder accentunder=\"true\"><mo movablelimits=\"false\">lim</mo><mrow><mi>N</mi><mo>\u2192</mo><mi mathvariant=\"normal\">\u221e</mi></mrow></munder><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>-</mo><mn>1</mn></mrow></munderover><mrow><mpadded width=\"+5pt\"><msub><mover accent=\"true\"><mi>w</mi><mo stretchy=\"false\">^</mo></mover><mrow><mi>n</mi><mo>,</mo><mi>N</mi></mrow></msub></mpadded><mo>\u2062</mo><mrow><mi>ln</mi><mo>\u2061</mo><mrow><mo>\u2225</mo><msub><mi>v</mi><mi>n</mi></msub><mo>\u2225</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo>,</mo><mrow><mrow><mrow><mtext>\u00a0where\u00a0</mtext><mo>\u2062</mo><msub><mi>v</mi><mi>n</mi></msub></mrow><mo>=</mo><mrow><mi>D</mi><mo>\u2062</mo><mi>T</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mfrac><msub><mi>v</mi><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></msub><mrow><mo>\u2225</mo><msub><mi>v</mi><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2225</mo></mrow></mfrac></mrow></mrow><mo>,</mo><mrow><msub><mi>v</mi><mn>0</mn></msub><mo>=</mo><mi>v</mi></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.06051.tex", "nexttext": "\nAs mentioned before, the quantity $B_N(f_1)$ converges to  the limit $\\int_X\\ln|\\det DT(x)|d\\mu(x)$ and we can obtain super-convergence to the same limit using the quantity ${\\mbox{WB}}_N(f_1)$ as written below:\n\n", "itemtype": "equation", "pos": 52539, "prevtext": "\n\nSee Chapter 3 from \\cite{ChaosBook} for an explanation of this method.\n\n\nOnce we have calculated $\\lambda_2$, to calculate $\\lambda_1$, we can instead calculate $\\lambda_1+\\lambda_2$, the sum of all the Lyapunov exponents. $\\lambda_1+\\lambda_2$ can be expressed as the Birkhoff average of the function $f_1(x):=\\ln|\\det DT(x)|$. \nNote that $\\det DT(x_n) > 0$ for an orientation preserving map $T$. \nTherefore, we have \n", "index": 45, "text": "\n\\[\\lambda_1+\\lambda_2=\\underset{N\\to\\infty}{\\lim}N^{-1}\\ln|\\det DT^N(x)|=\\underset{N\\to\\infty}{\\lim}B_N(f_1).\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex7.m1\" class=\"ltx_Math\" alttext=\"\\lambda_{1}+\\lambda_{2}=\\underset{N\\to\\infty}{\\lim}N^{-1}\\ln|\\det DT^{N}(x)|=%&#10;\\underset{N\\to\\infty}{\\lim}B_{N}(f_{1}).\" display=\"block\"><mrow><mrow><mrow><msub><mi>\u03bb</mi><mn>1</mn></msub><mo>+</mo><msub><mi>\u03bb</mi><mn>2</mn></msub></mrow><mo>=</mo><mrow><munder accentunder=\"true\"><mo movablelimits=\"false\">lim</mo><mrow><mi>N</mi><mo>\u2192</mo><mi mathvariant=\"normal\">\u221e</mi></mrow></munder><mo>\u2062</mo><msup><mi>N</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><mrow><mi>ln</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">|</mo><mrow><mo movablelimits=\"false\">det</mo><mo>\u2061</mo><mrow><mi>D</mi><mo>\u2062</mo><msup><mi>T</mi><mi>N</mi></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">|</mo></mrow></mrow></mrow><mo>=</mo><mrow><munder accentunder=\"true\"><mo movablelimits=\"false\">lim</mo><mrow><mi>N</mi><mo>\u2192</mo><mi mathvariant=\"normal\">\u221e</mi></mrow></munder><mo>\u2062</mo><msub><mi>B</mi><mi>N</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.06051.tex", "nexttext": "\n\n\n\\clearpage\n\\subsection{Fourier coefficients and change of coordinates reconstruction}\\label{sec:Fourier}\n\nFor a quasiperiodic curve as shown in Fig. \\ref{fig:results_3B}(a), there are two approaches to representing the curve. Firstly, we can write the coordinates $(X,Y)$ as a function of $\\theta\\in S^1$, or secondly, we can reduce the dimension and represent the points on the curve by an angle $\\phi\\in S^1$, that is, $\\phi(X(\\theta),Y(\\theta))$, which is also $V(\\theta)=\\theta+g(\\theta)$. We have shown $g$ in Fig. \\ref{fig:results_3B}(b) and the exponential decay of the norm of the Fourier coefficients in Fig. \\ref{fig:results_3B}(c). To limit the number of graphs in this paper, we have only created the Fourier series for the periodic part $g(\\theta)$.\n\nGiven a continuous periodic map $f:S^1\\rightarrow\\mathbb{R}$, the Fourier series representation of $f$ is the following.\n\n", "itemtype": "equation", "pos": 52864, "prevtext": "\nAs mentioned before, the quantity $B_N(f_1)$ converges to  the limit $\\int_X\\ln|\\det DT(x)|d\\mu(x)$ and we can obtain super-convergence to the same limit using the quantity ${\\mbox{WB}}_N(f_1)$ as written below:\n\n", "index": 47, "text": "\\begin{equation} \\label{eqlyapsum}\n\\lambda_1+\\lambda_2=\\underset{N\\to\\infty}{\\lim}{\\mbox{WB}}_N(f_1)=\\underset{N\\to\\infty}{\\lim}\\sum\\limits_{n=0}^{N-1}\\hat{w}_{n,N}\\ln|\\det DT(x_n)|.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E17.m1\" class=\"ltx_Math\" alttext=\"\\lambda_{1}+\\lambda_{2}=\\underset{N\\to\\infty}{\\lim}{\\mbox{WB}}_{N}(f_{1})=%&#10;\\underset{N\\to\\infty}{\\lim}\\sum\\limits_{n=0}^{N-1}\\hat{w}_{n,N}\\ln|\\det DT(x_{%&#10;n})|.\" display=\"block\"><mrow><mrow><mrow><msub><mi>\u03bb</mi><mn>1</mn></msub><mo>+</mo><msub><mi>\u03bb</mi><mn>2</mn></msub></mrow><mo>=</mo><mrow><munder accentunder=\"true\"><mo movablelimits=\"false\">lim</mo><mrow><mi>N</mi><mo>\u2192</mo><mi mathvariant=\"normal\">\u221e</mi></mrow></munder><mo>\u2062</mo><msub><mtext>WB</mtext><mi>N</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munder accentunder=\"true\"><mo movablelimits=\"false\">lim</mo><mrow><mi>N</mi><mo>\u2192</mo><mi mathvariant=\"normal\">\u221e</mi></mrow></munder><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>-</mo><mn>1</mn></mrow></munderover><mrow><msub><mover accent=\"true\"><mi>w</mi><mo stretchy=\"false\">^</mo></mover><mrow><mi>n</mi><mo>,</mo><mi>N</mi></mrow></msub><mo>\u2062</mo><mrow><mi>ln</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">|</mo><mrow><mo movablelimits=\"false\">det</mo><mo>\u2061</mo><mrow><mi>D</mi><mo>\u2062</mo><mi>T</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">|</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.06051.tex", "nexttext": "\nwhere the coefficient $a_k$ is given by the formula\n\n", "itemtype": "equation", "pos": 53949, "prevtext": "\n\n\n\\clearpage\n\\subsection{Fourier coefficients and change of coordinates reconstruction}\\label{sec:Fourier}\n\nFor a quasiperiodic curve as shown in Fig. \\ref{fig:results_3B}(a), there are two approaches to representing the curve. Firstly, we can write the coordinates $(X,Y)$ as a function of $\\theta\\in S^1$, or secondly, we can reduce the dimension and represent the points on the curve by an angle $\\phi\\in S^1$, that is, $\\phi(X(\\theta),Y(\\theta))$, which is also $V(\\theta)=\\theta+g(\\theta)$. We have shown $g$ in Fig. \\ref{fig:results_3B}(b) and the exponential decay of the norm of the Fourier coefficients in Fig. \\ref{fig:results_3B}(c). To limit the number of graphs in this paper, we have only created the Fourier series for the periodic part $g(\\theta)$.\n\nGiven a continuous periodic map $f:S^1\\rightarrow\\mathbb{R}$, the Fourier series representation of $f$ is the following.\n\n", "index": 49, "text": "\\begin{equation}\\label{eqn:sine_cosine_expansion}\n\\mbox{For every }\\theta\\in S^1,\\ f(\\theta)= \\sum_{k=-\\infty}^\\infty a_k e^{i2\\pi k\\theta},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E18.m1\" class=\"ltx_Math\" alttext=\"\\mbox{For every }\\theta\\in S^{1},\\ f(\\theta)=\\sum_{k=-\\infty}^{\\infty}a_{k}e^{%&#10;i2\\pi k\\theta},\" display=\"block\"><mrow><mrow><mrow><mrow><mtext>For every\u00a0</mtext><mo>\u2062</mo><mi>\u03b8</mi></mrow><mo>\u2208</mo><msup><mi>S</mi><mn>1</mn></msup></mrow><mo rspace=\"7.5pt\">,</mo><mrow><mrow><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>k</mi><mo>=</mo><mrow><mo>-</mo><mi mathvariant=\"normal\">\u221e</mi></mrow></mrow><mi mathvariant=\"normal\">\u221e</mi></munderover><mrow><msub><mi>a</mi><mi>k</mi></msub><mo>\u2062</mo><msup><mi>e</mi><mrow><mi>i</mi><mo>\u2062</mo><mn>2</mn><mo>\u2062</mo><mi>\u03c0</mi><mo>\u2062</mo><mi>k</mi><mo>\u2062</mo><mi>\u03b8</mi></mrow></msup></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.06051.tex", "nexttext": "\n\nIf we only have access to an ergodic orbit $(x_n)$ on a curve, then we cannot use the fast Fourier transform as we only have the function values $f(x_n)$ along a quasiperiodic trajectory, and a rotation number $\\rho$. So instead, we obtain these coefficients using a weighted Birkhoff average on a trajectory\n$(x_n)$ by applying the functional ${\\mbox{WB}}_{N}$. For $k=0$, we find $a_0$ by applying ${\\mbox{WB}}_N$ to the function $1$. Note that for all $k$, $a_{-k}=\\bar{a_{k}}$. For $k>0$, we find $a_k$ as follows. \n\n", "itemtype": "equation", "pos": 54157, "prevtext": "\nwhere the coefficient $a_k$ is given by the formula\n\n", "index": 51, "text": "\\begin{equation}\\label{eqn:a_n}\na_k = \\int_{\\theta\\in S^1} f(\\theta) e^{-i2\\pi k\\theta} d\\theta.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E19.m1\" class=\"ltx_Math\" alttext=\"a_{k}=\\int_{\\theta\\in S^{1}}f(\\theta)e^{-i2\\pi k\\theta}d\\theta.\" display=\"block\"><mrow><mrow><msub><mi>a</mi><mi>k</mi></msub><mo>=</mo><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mi>\u03b8</mi><mo>\u2208</mo><msup><mi>S</mi><mn>1</mn></msup></mrow></msub><mrow><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi>i</mi><mo>\u2062</mo><mn>2</mn><mo>\u2062</mo><mi>\u03c0</mi><mo>\u2062</mo><mi>k</mi><mo>\u2062</mo><mi>\u03b8</mi></mrow></mrow></msup><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>\u03b8</mi></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.06051.tex", "nexttext": "\nBy specifying that $\\theta_0 = 0$\nand using the computed rotation number $\\rho$, we have $\\theta_n = n \\rho$.\nUsing the Fourier coefficients, we can thus reconstruct the periodic part of the change of variables function $g$ (see Eq. (\\ref{eqn:g_conjugacy})). This is depicted for the R3BP in Fig.~\\ref{fig:results_3B}, for the standard map in Fig.~\\ref{fig:StdMap}, for the forced van der Pol equation in Fig.~\\ref{fig:vdP_global}. In all three one-dimensional cases, we depict $|a_k|$ as a function of $k$ for $k\\geq 0$ only, as for all $k$, $|a_{-k}|=|a_k|$.  Our main observation is that the Fourier coefficients decay exponentially; that is, for some positive numbers $\\alpha$ and $\\beta$, in dimension one, the Fourier coefficients satisfy \n\n", "itemtype": "equation", "pos": 54790, "prevtext": "\n\nIf we only have access to an ergodic orbit $(x_n)$ on a curve, then we cannot use the fast Fourier transform as we only have the function values $f(x_n)$ along a quasiperiodic trajectory, and a rotation number $\\rho$. So instead, we obtain these coefficients using a weighted Birkhoff average on a trajectory\n$(x_n)$ by applying the functional ${\\mbox{WB}}_{N}$. For $k=0$, we find $a_0$ by applying ${\\mbox{WB}}_N$ to the function $1$. Note that for all $k$, $a_{-k}=\\bar{a_{k}}$. For $k>0$, we find $a_k$ as follows. \n\n", "index": 53, "text": "\\begin{equation}\\label{eqn:a_n_from_Q}\na_k = {\\mbox{WB}}_{N} (f(\\theta) e^{-i2\\pi k\\theta}) = \\sum_{n=0}^{N-1} f(x_n) e^{-i2\\pi kn\\rho} \\hat{w}_{n,N}.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E20.m1\" class=\"ltx_Math\" alttext=\"a_{k}={\\mbox{WB}}_{N}(f(\\theta)e^{-i2\\pi k\\theta})=\\sum_{n=0}^{N-1}f(x_{n})e^{%&#10;-i2\\pi kn\\rho}\\hat{w}_{n,N}.\" display=\"block\"><mrow><mrow><msub><mi>a</mi><mi>k</mi></msub><mo>=</mo><mrow><msub><mtext>WB</mtext><mi>N</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03b8</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi>i</mi><mo>\u2062</mo><mn>2</mn><mo>\u2062</mo><mi>\u03c0</mi><mo>\u2062</mo><mi>k</mi><mo>\u2062</mo><mi>\u03b8</mi></mrow></mrow></msup></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>-</mo><mn>1</mn></mrow></munderover><mrow><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi>i</mi><mo>\u2062</mo><mn>2</mn><mo>\u2062</mo><mi>\u03c0</mi><mo>\u2062</mo><mi>k</mi><mo>\u2062</mo><mi>n</mi><mo>\u2062</mo><mi>\u03c1</mi></mrow></mrow></msup><mo>\u2062</mo><msub><mover accent=\"true\"><mi>w</mi><mo stretchy=\"false\">^</mo></mover><mrow><mi>n</mi><mo>,</mo><mi>N</mi></mrow></msub></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.06051.tex", "nexttext": "\nThis is characteristic of analytic functions. We therefore state that all of the conjugacy functions that we computed in our examples are effectively analytic, ``effectively'' meaning within the precision of our quadruple precision numerics. \n\nIn two dimensions, the computation of Fourier coefficients is similar, but instead of only having one exponential functions, for each $(j,k)$, we have two linearly independent sets of exponentials. \n", "itemtype": "equation", "pos": 55702, "prevtext": "\nBy specifying that $\\theta_0 = 0$\nand using the computed rotation number $\\rho$, we have $\\theta_n = n \\rho$.\nUsing the Fourier coefficients, we can thus reconstruct the periodic part of the change of variables function $g$ (see Eq. (\\ref{eqn:g_conjugacy})). This is depicted for the R3BP in Fig.~\\ref{fig:results_3B}, for the standard map in Fig.~\\ref{fig:StdMap}, for the forced van der Pol equation in Fig.~\\ref{fig:vdP_global}. In all three one-dimensional cases, we depict $|a_k|$ as a function of $k$ for $k\\geq 0$ only, as for all $k$, $|a_{-k}|=|a_k|$.  Our main observation is that the Fourier coefficients decay exponentially; that is, for some positive numbers $\\alpha$ and $\\beta$, in dimension one, the Fourier coefficients satisfy \n\n", "index": 55, "text": "\\begin{equation}\\label{eqn:Fourier_decay}\n|a_k| \\le \\alpha e^{- \\beta |k|} \\mbox{ for all }k\\in\\mathbb{Z}. \n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E21.m1\" class=\"ltx_Math\" alttext=\"|a_{k}|\\leq\\alpha e^{-\\beta|k|}\\mbox{ for all }k\\in\\mathbb{Z}.\" display=\"block\"><mrow><mrow><mrow><mo stretchy=\"false\">|</mo><msub><mi>a</mi><mi>k</mi></msub><mo stretchy=\"false\">|</mo></mrow><mo>\u2264</mo><mrow><mi>\u03b1</mi><mo>\u2062</mo><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi>\u03b2</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mi>k</mi><mo stretchy=\"false\">|</mo></mrow></mrow></mrow></msup><mo>\u2062</mo><mtext>\u00a0for all\u00a0</mtext><mo>\u2062</mo><mi>k</mi></mrow><mo>\u2208</mo><mi>\u2124</mi></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.06051.tex", "nexttext": "\nWe define $a_{j,k}$ and $a_{j,-k}$ to be the complex-valued coefficients corresponding to these two functions. \n\nThe reconstructed conjugacy function and decay of coefficients for the two-dimensional torus is depicted in Fig.~\\ref{2DTorus_results}(a). The decay of coefficients shown in Fig.~\\ref{2DTorus_results}(b) shows $\\sqrt{j^2 +k^2}$ on the horizontal axis, and $|a_{j,k}|$ on the vertical axis, where both of these coefficients are complex, meaning that $|\\cdot|$ represents the modulus. Again here, the coefficients decay exponentially, though the decay of coefficients is considerably slower in two dimensions. \nThe data set looks quite a lot more crowded in this case, since there are \n$10^4$ coefficients and many different values of $(j,k)$ have almost same values of $\\sqrt{j^2 + k^2}$.\nIn addition, the coefficients $a_{j,k}$ generally converge at different exponential rates. This is why there is a strange looking set consisting of an upper and a lower cloud of data in Fig.~\\ref{2DTorus_results}(b). While more information on the difference between these coefficients is gained by interactively viewing the data in three dimensions, we have not been able to find a satisfactory static flat projection of this data. We feel that in a still image, the data cloud shown conveys the maximum information. \n\nWe end this section by noting a few sources of error in the computation of Fourier coefficients. If the number of iterates $N$ is too small, then we will not have sufficient coverage to get a good approximation of the coefficients, and the problem becomes more acute as the coefficient number $|k|$ grows. If the approximation of the rotation number is not accurate, then we cannot expect the approximations of our Fourier coefficients to be good either, and given an error in the rotation number, there will be an $k_{\\max}$ such that the Fourier coefficients\n$a_k$ with $|k|>k_{\\max}$ cannot be approximated with any reasonable accuracy. A more subtle form of a error comes from the fact that if the frequency we are trying to estimate is close to being commensurate with the rotation number, then we will get unexpectedly insufficient coverage of the space when performing iteration. \nThis last type of error is present in both weighted and unweighted averaging techniques and is related to problems of small divisors. Rather than bog down our discussion here, we comment that this is an inherent problem, but it only comes up for the relatively rare and checkable condition of rotation numbers which are close to rational numbers with small denominators, and that does not apply to any of our rotation numbers. We intend to address this last type of error in more detail in another paper. \n\n\\clearpage\n\n\\section{Concluding remarks}\\label{sec:conclude}\n\nWe have developed a straightforward but effective computational tool for quickly computing a large variety of quantities for quasiperiodic orbits. These quantities include rotation vectors, Fourier reconstruction of conjugacy maps, and in some cases Lyapunov exponents. The methods work well in one and higher dimensions. They are effective using both double and quadruple precision, though we have chosen to do most of our calculations in higher precision to show the full possibilities and quick convergence properties of our method. \n\n\\bigskip \n\n{\\bf Acknowledgments:} \nES was partially supported by NSF grant DMS-1407087. \nYS was partially supported by JSPS KAKENHI grant 26610034.\nJY was partially supported by National Research Initiative Competitive grants 2009-35205-05209 and 2008-04049 from the U.S.D.A.\n\n\n\\clearpage\n\n\n\n\\bibliographystyle{unsrt}\n\\bibliography{Weighted_calc_bibliography,1D_bibliography}\n\n", "itemtype": "equation", "pos": 56267, "prevtext": "\nThis is characteristic of analytic functions. We therefore state that all of the conjugacy functions that we computed in our examples are effectively analytic, ``effectively'' meaning within the precision of our quadruple precision numerics. \n\nIn two dimensions, the computation of Fourier coefficients is similar, but instead of only having one exponential functions, for each $(j,k)$, we have two linearly independent sets of exponentials. \n", "index": 57, "text": "\n\\[ e^{i (j x + k y)} \\mbox{ and } e^{i (j x - k y)}. \\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex8.m1\" class=\"ltx_Math\" alttext=\"e^{i(jx+ky)}\\mbox{ and }e^{i(jx-ky)}.\" display=\"block\"><mrow><mrow><msup><mi>e</mi><mrow><mi>i</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mi>j</mi><mo>\u2062</mo><mi>x</mi></mrow><mo>+</mo><mrow><mi>k</mi><mo>\u2062</mo><mi>y</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msup><mo>\u2062</mo><mtext>\u00a0and\u00a0</mtext><mo>\u2062</mo><msup><mi>e</mi><mrow><mi>i</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mi>j</mi><mo>\u2062</mo><mi>x</mi></mrow><mo>-</mo><mrow><mi>k</mi><mo>\u2062</mo><mi>y</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msup></mrow><mo>.</mo></mrow></math>", "type": "latex"}]