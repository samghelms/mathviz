[{"file": "1601.04880.tex", "nexttext": "\nSee for example Applebaum~\\cite{App}. Here the governing autonomous vector fields \n$V_i\\colon\\mathbb{R}^N\\to\\mathbb{R}^N$ \nare supposed to be smooth and in general non-commuting, and the \ninitial data $y_0\\in L^2(\\Omega,\\mathcal{F}_0,P)$. \nThe $W^i$ for $i=1,\\ldots,d$ are independent Wiener processes, \nand by convention we set $W^0_t=t$. \nThe $J^{i}$ for $i=d+1,\\ldots,\\ell$ are purely discontinuous martingales \nexpressible in the form\n\n", "itemtype": "equation", "pos": 2732, "prevtext": "\n\n\\title{Algebraic Structures and Stochastic Differential Equations driven by L\\'{e}vy processes}\n\\titlerunning{SDEs driven by L\\'{e}vy processes}\n\\author{Charles Curry \\and Kurusch~Ebrahimi--Fard \\and \nSimon J.A.~Malham \\and Anke Wiese}\n\\institute{Charles Curry \\at \nMaxwell Institute for Mathematical Sciences \nand School of Mathematical and Computer Sciences, \nHeriot-Watt University, Edinburgh EH14 4AS, UK.\\\\\n\\emph{Present address:} of Charles Curry \\at\nDepartment of Mathematical Sciences, \nNTNU, 7491 Trondheim, Norway.\\\\\n\\and Kurusch Ebrahimi--Fard \\at\nInstituto de Ciencias Matem\\'{a}ticas, \nConsejo Superior de Investigaciones Cient\\'{i}ficas, \nC/Nicol\\'{a}s Cabrera, no. 13-15, 28049 Madrid, Spain.\\\\\n\\and Simon J.A.~Malham \\at \nMaxwell Institute for Mathematical Sciences \nand School of Mathematical and Computer Sciences, \nHeriot-Watt University, Edinburgh EH14 4AS, UK.\\\\\n\\and Anke Wiese \\at \nMaxwell Institute for Mathematical Sciences \nand School of Mathematical and Computer Sciences, \nHeriot-Watt University, Edinburgh EH14 4AS, UK.\n}\n\n\\date{22nd December 2015}\n\n\\maketitle\n\n\n\n\n\\begin{abstract}\nWe define a new numerical integration scheme for stochastic differential equations \ndriven by L\\'{e}vy processes that has a leading order error coefficient less \nthan that of the scheme of the same strong order of convergence obtained \nby truncating the stochastic Taylor series. This holds for all such equations \nwhere the driving processes possess moments of all orders and the coefficients \nare sufficiently smooth. The results are obtained using the quasi-shuffle algebra \nof multiple iterated integrals of independent L\\'{e}vy processes. \nOur findings generalize recent results concerning equations driven by Wiener processes. \n\\keywords{efficient integrators \\and L\\'{e}vy processes \\and quasi-shuffle algebra}\n\\end{abstract}\n\n\n\n\n\n\n\n\\section{Introduction}\nOur main result is the derivation of a new strong numerical integration scheme \nfor stochastic differential equations driven by independent L\\'{e}vy processes \nwith moments of all orders, where the coefficient functions are sufficiently \nsmooth autonomous vector fields. L\\'{e}vy processes are a class of \nstochastic processes, comprising processes continuous in probability \nand possessing stationary increments, independent of the past. \nThey are examples of stochastic processes with a well \nunderstood structure that incorporate jump discontinuities. \n\nOur setting is a complete, filtered probability space \n$\\bigl(\\Omega,\\mathcal{F},(\\mathcal{F}_t)_{t\\geq0},P\\bigr)$, \nassumed to satisfy the usual hypotheses---see Protter \\cite[p.3]{Pro}. \nDue to the L\\'{e}vy decomposition of a L\\'{e}vy process the equations \nwe consider may be written in the form\n\n", "index": 1, "text": "\\begin{equation*}\ny_t = y_0 + \\sum_{i=0}^d \\int_0^t V_i(y_{s})\\mathrm{d}W^i_s \n+ \\sum_{i=d+1}^{\\ell} \\int_0^t V_i(y_{s_-})\\mathrm{d}J^{i}_s.\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"y_{t}=y_{0}+\\sum_{i=0}^{d}\\int_{0}^{t}V_{i}(y_{s})\\mathrm{d}W^{i}_{s}+\\sum_{i=%&#10;d+1}^{\\ell}\\int_{0}^{t}V_{i}(y_{s_{-}})\\mathrm{d}J^{i}_{s}.\" display=\"block\"><mrow><mrow><msub><mi>y</mi><mi>t</mi></msub><mo>=</mo><mrow><msub><mi>y</mi><mn>0</mn></msub><mo>+</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>d</mi></munderover><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mi>t</mi></msubsup><mrow><msub><mi>V</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>s</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>d</mo><msubsup><mi>W</mi><mi>s</mi><mi>i</mi></msubsup></mrow></mrow></mrow></mrow><mo>+</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mrow><mi>d</mi><mo>+</mo><mn>1</mn></mrow></mrow><mi mathvariant=\"normal\">\u2113</mi></munderover><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mi>t</mi></msubsup><mrow><msub><mi>V</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>y</mi><msub><mi>s</mi><mo>-</mo></msub></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>d</mo><msubsup><mi>J</mi><mi>s</mi><mi>i</mi></msubsup></mrow></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nwhere \n${\\mkern 1.5mu\\overline{\\mkern-1.5mu{Q}\\mkern-1.5mu}\\mkern 1.5mu}^i(\\mathrm{d}v,\\mathrm{d}s)\\coloneqq Q^i(\\mathrm{d}v,\n\\mathrm{d}s)-{\\rho}^i(\\mathrm{d}v)\\mathrm{d}s$.\nThe $Q^i$ are Poisson measures on $\\mathbb{R}\\times\\mathbb{R}_+$ \nwith intensity measures ${\\rho}^i(\\mathrm{d}v) \\mathrm{d}s$, \nwhere the ${\\rho}^i$ are measures on $\\mathbb{R}$ with ${\\rho}^i(0)=0$ \nand $\\int_{\\mathbb{R}} (1\\wedge v^2) {\\rho}^i(\\mathrm{d}v)<\\infty$. \nIntuitively, $Q^i(B,(a,b])$ counts the number of jumps of the \nprocess $J^i$ taking values in the set $B$ in the time interval $(a,b]$, \nwhilst ${\\rho}^i(B)$ measures the expected number of jumps per unit time \nthe process $J^i$ accrues taking values in the set $B$. \nWe assume that the $J^i$ possess moments of all orders. \nL\\'{e}vy processes have many applications, notably in mathematical finance \nfor the construction of models going beyond the Black--Scholes--Merton model \nin incorporating discontinuities in stock prices, \nsee Cont \\& Tankov~\\cite{ConTan} and Barndorff--Nielsen, Mikosch \\& Resnick \\cite{BnMR} \nand the references therein. There are also applications to physical sciences, \nsee for instance Barndorff--Nielsen, Mikosch \\& Resnick \\cite{BnMR}. \nPathwise integrals of L\\'{e}vy processes have recently been constructed \nin the framework of rough paths by Friz \\& Shekhar \\cite{FriShe}.\n\nWe are concerned with strong integration schemes for such L\\'evy-driven \nstochastic differential equations. These schemes are typically derived \nfrom the stochastic Taylor expansion. This is an expression for the flowmap \n$\\varphi_{s,t}\\colon y_s\\mapsto y_t$ as a sum of iterated integrals with an explicit remainder,\nwhich formally can be extended to give an infinite series. \nSee Platen \\& Bruti-Liberati \\cite{PlaBl} for a derivation of the \nstochastic Taylor expansion for L\\'evy-driven stochastic differential equations,\nas well as Platen \\cite{Pla80,Pla82} and Platen \\& Wagner \\cite{PlaWag}. \nFor sufficiently smooth vector fields, integration schemes \nof arbitrary strong order of convergence may be constructed by \ntruncating the series expansion to an appropriate number of terms. \nPlaten \\& Bruti-Liberati~\\cite{PlaBl} show which terms must be retained to \nobtain a strong integration scheme with a given strong order of convergence. \nWe assume hereafter the governing vector fields are sufficiently smooth \nfor the stochastic Taylor expansion to exist. \n\nCombinatorial algebras are a natural setting for the study of relations \namong the iterated integrals appearing in stochastic Taylor expansions. \nIn this paper we focus on the case when the stochastic Taylor expansion can be written in \nseparated form. This means that each term in the stochastic Taylor expansion\ncan be decomposed as the product of a multiple It\\^o integral, containing stochastic\ninformation only, and a composition of associated differential operators, containing\ngeometric information only. In this instance the algebra of integrand-free \nmultiple integrals of the driving processes is of interest alongside \nthe algebra of the associated differential operators. \nCurry, Ebrahimi--Fard, Malham \\& Wiese~\\cite{CEfMW} proved that the \nalgebra of multiple integrals of a minimal family of semimartingales \nis isomorphic to the combinatorial quasi-shuffle algebra of words. A set of L\\'evy\nprocesses represents one example. Indeed Gaines \\cite{Gai} considered the case of \nmultiple iterated integrals of Wiener processes and\nLi \\& Liu \\cite{LiLiu} considered multiple iterated integrals of Wiener processes \nand standard Poisson processes. The quasi-shuffle algebra is an extension of the \nshuffle algebra introduced abstractly, and comprehensively, by Hoffman~\\cite{Hof}. \nThe significance of the shuffle algebra was cemented \nin the work of Eilenberg \\& Maclane~\\cite{EiMac}, Sch\\\"{u}tzenberger \\cite{Sch} \nand Chen \\cite{Che}. See Reutenauer \\cite{Reu} for more details. \n\nOne advantage of abstracting to the quasi-shuffle algebra is that we can immediately \nidentify the minimum set of iterated integrals that need to be simulated to implement \na given accurate strong scheme. This optimizes the total computation time which is dominated\nby the strong simulation of the iterated integrals.\nRadford~\\cite{Rad} proved that the shuffle algebra is generated by Lyndon words. \nThis was extended to the quasi-shuffle algebra by Hoffman~\\cite{Hof}, though it\nhad already been established by Gaines \\cite{Gai} for the case of\nWiener processes and Li \\& Liu \\cite{LiLiu} for the case of\nWiener processes and standard Poisson processes, while Sussmann~\\cite{Suss} had \nconsidered a Hall basis. Hence the set of iterated integrals we need to\nsimulate at any given order are identified by Lyndon words. Having thus optimized the\ntotal computation time associated with a scheme of a given strong order, the focus turns\nto how to minimize the coefficient of the leading order error. \nThis problem was considered by Clark \\cite{Cla} and Newton \\cite{New86,New91} \nfor drift-diffusion equations driven by a single Wiener process; also see\nKloeden \\& Platen~\\cite[Section~13.4]{KloPla}.\nThey derived integration schemes that are asymptotically efficient \nin the sense that the coefficient of the leading order error is minimal \namong all schemes. For Stratonovich stochastic differential equations, \nCastell \\& Gaines \\cite{CasGai95,CasGai96} constructed integration schemes \nusing the Chen-Strichartz exponential Lie series expansion (see Strichartz \\cite{Str}).\nIn the strong order one case for one driving Wiener process, and the strong order\none-half case for two or more driving Wiener processes, their schemes \nare asymptotically efficient in the sense of Clark and Newton.\n\nMalham \\& Wiese \\cite{MalWie} considered the problem of designing \nefficient integrators for Stratonovich drift-diffusion equations driven \nby multiple independent Wiener processes. Here, efficient integrators of\na given order have leading order error which is always less than that for \nthe corresponding stochastic Taylor scheme, independent of the governing vector fields.  \nThey considered a class of strong integration schemes \nwe shall hereafter call map-truncate-invert schemes. These are constructed \nas follows. Given an invertible map \n$f\\colon\\mathrm{Diff}(\\mathbb{R}^N)\\rightarrow\\mathrm{Diff}(\\mathbb{R}^N)$, \nwe expand the series $f(\\varphi)$, truncate according to a chosen grading \nand then apply $f^{-1}$. The case $f=\\log$ corresponds to the \nexponential Lie series integrator of Castell \\& Gaines. \nMalham \\& Wiese \\cite{MalWie} then proved that\nan integration scheme based on the map $f=\\mathrm{sinhlog}$ \nis efficient. These results were obtained in the absence of a drift term \nand extended to incorporate drift in \nEbrahimi--Fard, Lundervold, Malham, Munthe--Kaas \\& Wiese \\cite{EfLMMkW}.\n\nHerein, we study map-truncate-invert schemes for It\\^o\nequations driven by L\\'{e}vy processes. \nWe must consider the algebraic structure of iterated integrals \nwith respect to L\\'{e}vy processes, for which we rely on \nrecent results of Curry, Ebrahimi--Fard, Malham \\& Wiese \\cite{CEfMW}. \nIn this paper, we:\n\n\\begin{enumerate}\n\\item Show the stochastic Taylor series expansion for the flowmap\ncan be written in separated form, i.e.\\/ as a series of terms,\neach of which is decomposable into a multiple It\\^o integral \nand a composition of associated differential operators; \n\\item Describe the class of map-truncate-invert schemes for \nL\\'{e}vy-driven equations and give an algebraic framework for \nencoding and comparing such schemes. These results \ngeneralize those in Malham \\& Wiese \\cite{MalWie} \nand Ebrahimi--Fard \\textit{et al.\\/} \\cite{EfLMMkW};\n\\item Prove truncations according to the word length grading give more \naccurate schemes than approximations of the same order of convergence obtained by \ntruncations according to the mean-square grading;\n\\item Introduce the antisymmetric sign reverse integrator, a new integration scheme for \nL\\'{e}vy-driven equations, represented as half the difference of the \nidentity and sign reverse endomorphisms on the vector space generated by words indexing\nmultiple integrals. This scheme is efficient in the sense that its\nleading order mean-square error is less than that of the corresponding\nstochastic Taylor scheme, independent of the governing vector fields; \n\\item Show how to compute map-truncate-invert schemes in practice, in particular,\nhow to deal with the inversion stage. We call these direct map-truncate-invert schemes.\nIn essence their implementation involves computing the stochastic Taylor expansion to \nthe given order, and then adding a polynomial of the already simulated multiple integrals to \nemulate the map-truncate-invert scheme.\n\\end{enumerate}\n\nThe structure of this paper is as follows. In \\textsection 2, we discuss\nthe stochastic Taylor expansion for L\\'evy-driven equations given in \nPlaten \\& Bruti-Liberati~\\cite{PlaBl}. We show when and how \nwe can represent the stochastic Taylor expansion in separated form.\nIn \\textsection 3, we introduce map-truncate-invert schemes in the context of \nequations driven by L\\'{e}vy processes. We show how to algebraically encode them\nusing the quasi-shuffle convolution endomorphism algebra, thus extending\nthe encoding for drift-diffusion equations in Ebrahimi--Fard et al. \\cite{EfLMMkW}.\nIn \\textsection 4 we undertake a local error analysis of integration schemes\nfor L\\'evy-driven equations. A component of this analysis is\nthe comparison of two gradings, the mean-square grading and the word length grading. \nOur main results are presented in \\textsection 5. We prove that  \nthe antisymmetric sign reverse integrator, an extension of the sinhlog integrator \nof Malham \\& Wiese \\cite{MalWie}, is efficient. \nWe also introduce our direct map-truncate-invert schemes.\nWe demonstrate these with two numerical experiments in \\textsection 6. \nFinally in \\textsection 7 we derive global convergence results \nfrom local error estimates.\n\n\n\\section{Separated stochastic Taylor expansions}\nA stochastic Taylor expansion is an expression for the flowmap as a \nsum of iterated integrals. We write down the stochastic Taylor expansion \nfor L\\'{e}vy-driven equations and show how and when it can be written in separated form. \nRecall the flowmap is defined as the map $\\varphi_{s,t}\\colon y_s\\mapsto y_t$. \nIt acts on sufficiently smooth functions $f\\colon\\mathbb R^N\\to\\mathbb R^N$ \nas the pullback $\\varphi_{s,t}(f(y_s)) \\coloneqq f(y_t)$. \nWe set $\\varphi_t\\coloneqq\\varphi_{0,t}$. It\\^{o}'s formula \n(see for example Applebaum~\\cite[p.~203]{App} or Protter~\\cite[p.~71]{Pro}) implies\n\n", "itemtype": "equation", "pos": 3328, "prevtext": "\nSee for example Applebaum~\\cite{App}. Here the governing autonomous vector fields \n$V_i\\colon\\mathbb{R}^N\\to\\mathbb{R}^N$ \nare supposed to be smooth and in general non-commuting, and the \ninitial data $y_0\\in L^2(\\Omega,\\mathcal{F}_0,P)$. \nThe $W^i$ for $i=1,\\ldots,d$ are independent Wiener processes, \nand by convention we set $W^0_t=t$. \nThe $J^{i}$ for $i=d+1,\\ldots,\\ell$ are purely discontinuous martingales \nexpressible in the form\n\n", "index": 3, "text": "\\begin{equation*}\n J^i_t=\\int_0^t\\int_{\\mathbb{R}}v{\\mkern 1.5mu\\overline{\\mkern-1.5mu{Q}\\mkern-1.5mu}\\mkern 1.5mu}^i(\\mathrm{d}v,\\mathrm{d}s),\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"J^{i}_{t}=\\int_{0}^{t}\\int_{\\mathbb{R}}v{\\mkern 1.5mu \\overline{\\mkern-1.5mu {%&#10;Q}\\mkern-1.5mu }\\mkern 1.5mu }^{i}(\\mathrm{d}v,\\mathrm{d}s),\" display=\"block\"><mrow><mrow><msubsup><mi>J</mi><mi>t</mi><mi>i</mi></msubsup><mo>=</mo><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mi>t</mi></msubsup><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mi>\u211d</mi></msub><mrow><mi>v</mi><mo>\u2062</mo><msup><mover accent=\"true\"><mi>Q</mi><mo>\u00af</mo></mover><mi>i</mi></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">d</mi><mo>\u2062</mo><mi>v</mi></mrow><mo>,</mo><mrow><mi mathvariant=\"normal\">d</mi><mo>\u2062</mo><mi>s</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nwhere for $i=1,\\ldots,\\ell$, the $\\tilde{V}_i$ are operators defined as follows\n\n", "itemtype": "equation", "pos": 14107, "prevtext": "\nwhere \n${\\mkern 1.5mu\\overline{\\mkern-1.5mu{Q}\\mkern-1.5mu}\\mkern 1.5mu}^i(\\mathrm{d}v,\\mathrm{d}s)\\coloneqq Q^i(\\mathrm{d}v,\n\\mathrm{d}s)-{\\rho}^i(\\mathrm{d}v)\\mathrm{d}s$.\nThe $Q^i$ are Poisson measures on $\\mathbb{R}\\times\\mathbb{R}_+$ \nwith intensity measures ${\\rho}^i(\\mathrm{d}v) \\mathrm{d}s$, \nwhere the ${\\rho}^i$ are measures on $\\mathbb{R}$ with ${\\rho}^i(0)=0$ \nand $\\int_{\\mathbb{R}} (1\\wedge v^2) {\\rho}^i(\\mathrm{d}v)<\\infty$. \nIntuitively, $Q^i(B,(a,b])$ counts the number of jumps of the \nprocess $J^i$ taking values in the set $B$ in the time interval $(a,b]$, \nwhilst ${\\rho}^i(B)$ measures the expected number of jumps per unit time \nthe process $J^i$ accrues taking values in the set $B$. \nWe assume that the $J^i$ possess moments of all orders. \nL\\'{e}vy processes have many applications, notably in mathematical finance \nfor the construction of models going beyond the Black--Scholes--Merton model \nin incorporating discontinuities in stock prices, \nsee Cont \\& Tankov~\\cite{ConTan} and Barndorff--Nielsen, Mikosch \\& Resnick \\cite{BnMR} \nand the references therein. There are also applications to physical sciences, \nsee for instance Barndorff--Nielsen, Mikosch \\& Resnick \\cite{BnMR}. \nPathwise integrals of L\\'{e}vy processes have recently been constructed \nin the framework of rough paths by Friz \\& Shekhar \\cite{FriShe}.\n\nWe are concerned with strong integration schemes for such L\\'evy-driven \nstochastic differential equations. These schemes are typically derived \nfrom the stochastic Taylor expansion. This is an expression for the flowmap \n$\\varphi_{s,t}\\colon y_s\\mapsto y_t$ as a sum of iterated integrals with an explicit remainder,\nwhich formally can be extended to give an infinite series. \nSee Platen \\& Bruti-Liberati \\cite{PlaBl} for a derivation of the \nstochastic Taylor expansion for L\\'evy-driven stochastic differential equations,\nas well as Platen \\cite{Pla80,Pla82} and Platen \\& Wagner \\cite{PlaWag}. \nFor sufficiently smooth vector fields, integration schemes \nof arbitrary strong order of convergence may be constructed by \ntruncating the series expansion to an appropriate number of terms. \nPlaten \\& Bruti-Liberati~\\cite{PlaBl} show which terms must be retained to \nobtain a strong integration scheme with a given strong order of convergence. \nWe assume hereafter the governing vector fields are sufficiently smooth \nfor the stochastic Taylor expansion to exist. \n\nCombinatorial algebras are a natural setting for the study of relations \namong the iterated integrals appearing in stochastic Taylor expansions. \nIn this paper we focus on the case when the stochastic Taylor expansion can be written in \nseparated form. This means that each term in the stochastic Taylor expansion\ncan be decomposed as the product of a multiple It\\^o integral, containing stochastic\ninformation only, and a composition of associated differential operators, containing\ngeometric information only. In this instance the algebra of integrand-free \nmultiple integrals of the driving processes is of interest alongside \nthe algebra of the associated differential operators. \nCurry, Ebrahimi--Fard, Malham \\& Wiese~\\cite{CEfMW} proved that the \nalgebra of multiple integrals of a minimal family of semimartingales \nis isomorphic to the combinatorial quasi-shuffle algebra of words. A set of L\\'evy\nprocesses represents one example. Indeed Gaines \\cite{Gai} considered the case of \nmultiple iterated integrals of Wiener processes and\nLi \\& Liu \\cite{LiLiu} considered multiple iterated integrals of Wiener processes \nand standard Poisson processes. The quasi-shuffle algebra is an extension of the \nshuffle algebra introduced abstractly, and comprehensively, by Hoffman~\\cite{Hof}. \nThe significance of the shuffle algebra was cemented \nin the work of Eilenberg \\& Maclane~\\cite{EiMac}, Sch\\\"{u}tzenberger \\cite{Sch} \nand Chen \\cite{Che}. See Reutenauer \\cite{Reu} for more details. \n\nOne advantage of abstracting to the quasi-shuffle algebra is that we can immediately \nidentify the minimum set of iterated integrals that need to be simulated to implement \na given accurate strong scheme. This optimizes the total computation time which is dominated\nby the strong simulation of the iterated integrals.\nRadford~\\cite{Rad} proved that the shuffle algebra is generated by Lyndon words. \nThis was extended to the quasi-shuffle algebra by Hoffman~\\cite{Hof}, though it\nhad already been established by Gaines \\cite{Gai} for the case of\nWiener processes and Li \\& Liu \\cite{LiLiu} for the case of\nWiener processes and standard Poisson processes, while Sussmann~\\cite{Suss} had \nconsidered a Hall basis. Hence the set of iterated integrals we need to\nsimulate at any given order are identified by Lyndon words. Having thus optimized the\ntotal computation time associated with a scheme of a given strong order, the focus turns\nto how to minimize the coefficient of the leading order error. \nThis problem was considered by Clark \\cite{Cla} and Newton \\cite{New86,New91} \nfor drift-diffusion equations driven by a single Wiener process; also see\nKloeden \\& Platen~\\cite[Section~13.4]{KloPla}.\nThey derived integration schemes that are asymptotically efficient \nin the sense that the coefficient of the leading order error is minimal \namong all schemes. For Stratonovich stochastic differential equations, \nCastell \\& Gaines \\cite{CasGai95,CasGai96} constructed integration schemes \nusing the Chen-Strichartz exponential Lie series expansion (see Strichartz \\cite{Str}).\nIn the strong order one case for one driving Wiener process, and the strong order\none-half case for two or more driving Wiener processes, their schemes \nare asymptotically efficient in the sense of Clark and Newton.\n\nMalham \\& Wiese \\cite{MalWie} considered the problem of designing \nefficient integrators for Stratonovich drift-diffusion equations driven \nby multiple independent Wiener processes. Here, efficient integrators of\na given order have leading order error which is always less than that for \nthe corresponding stochastic Taylor scheme, independent of the governing vector fields.  \nThey considered a class of strong integration schemes \nwe shall hereafter call map-truncate-invert schemes. These are constructed \nas follows. Given an invertible map \n$f\\colon\\mathrm{Diff}(\\mathbb{R}^N)\\rightarrow\\mathrm{Diff}(\\mathbb{R}^N)$, \nwe expand the series $f(\\varphi)$, truncate according to a chosen grading \nand then apply $f^{-1}$. The case $f=\\log$ corresponds to the \nexponential Lie series integrator of Castell \\& Gaines. \nMalham \\& Wiese \\cite{MalWie} then proved that\nan integration scheme based on the map $f=\\mathrm{sinhlog}$ \nis efficient. These results were obtained in the absence of a drift term \nand extended to incorporate drift in \nEbrahimi--Fard, Lundervold, Malham, Munthe--Kaas \\& Wiese \\cite{EfLMMkW}.\n\nHerein, we study map-truncate-invert schemes for It\\^o\nequations driven by L\\'{e}vy processes. \nWe must consider the algebraic structure of iterated integrals \nwith respect to L\\'{e}vy processes, for which we rely on \nrecent results of Curry, Ebrahimi--Fard, Malham \\& Wiese \\cite{CEfMW}. \nIn this paper, we:\n\n\\begin{enumerate}\n\\item Show the stochastic Taylor series expansion for the flowmap\ncan be written in separated form, i.e.\\/ as a series of terms,\neach of which is decomposable into a multiple It\\^o integral \nand a composition of associated differential operators; \n\\item Describe the class of map-truncate-invert schemes for \nL\\'{e}vy-driven equations and give an algebraic framework for \nencoding and comparing such schemes. These results \ngeneralize those in Malham \\& Wiese \\cite{MalWie} \nand Ebrahimi--Fard \\textit{et al.\\/} \\cite{EfLMMkW};\n\\item Prove truncations according to the word length grading give more \naccurate schemes than approximations of the same order of convergence obtained by \ntruncations according to the mean-square grading;\n\\item Introduce the antisymmetric sign reverse integrator, a new integration scheme for \nL\\'{e}vy-driven equations, represented as half the difference of the \nidentity and sign reverse endomorphisms on the vector space generated by words indexing\nmultiple integrals. This scheme is efficient in the sense that its\nleading order mean-square error is less than that of the corresponding\nstochastic Taylor scheme, independent of the governing vector fields; \n\\item Show how to compute map-truncate-invert schemes in practice, in particular,\nhow to deal with the inversion stage. We call these direct map-truncate-invert schemes.\nIn essence their implementation involves computing the stochastic Taylor expansion to \nthe given order, and then adding a polynomial of the already simulated multiple integrals to \nemulate the map-truncate-invert scheme.\n\\end{enumerate}\n\nThe structure of this paper is as follows. In \\textsection 2, we discuss\nthe stochastic Taylor expansion for L\\'evy-driven equations given in \nPlaten \\& Bruti-Liberati~\\cite{PlaBl}. We show when and how \nwe can represent the stochastic Taylor expansion in separated form.\nIn \\textsection 3, we introduce map-truncate-invert schemes in the context of \nequations driven by L\\'{e}vy processes. We show how to algebraically encode them\nusing the quasi-shuffle convolution endomorphism algebra, thus extending\nthe encoding for drift-diffusion equations in Ebrahimi--Fard et al. \\cite{EfLMMkW}.\nIn \\textsection 4 we undertake a local error analysis of integration schemes\nfor L\\'evy-driven equations. A component of this analysis is\nthe comparison of two gradings, the mean-square grading and the word length grading. \nOur main results are presented in \\textsection 5. We prove that  \nthe antisymmetric sign reverse integrator, an extension of the sinhlog integrator \nof Malham \\& Wiese \\cite{MalWie}, is efficient. \nWe also introduce our direct map-truncate-invert schemes.\nWe demonstrate these with two numerical experiments in \\textsection 6. \nFinally in \\textsection 7 we derive global convergence results \nfrom local error estimates.\n\n\n\\section{Separated stochastic Taylor expansions}\nA stochastic Taylor expansion is an expression for the flowmap as a \nsum of iterated integrals. We write down the stochastic Taylor expansion \nfor L\\'{e}vy-driven equations and show how and when it can be written in separated form. \nRecall the flowmap is defined as the map $\\varphi_{s,t}\\colon y_s\\mapsto y_t$. \nIt acts on sufficiently smooth functions $f\\colon\\mathbb R^N\\to\\mathbb R^N$ \nas the pullback $\\varphi_{s,t}(f(y_s)) \\coloneqq f(y_t)$. \nWe set $\\varphi_t\\coloneqq\\varphi_{0,t}$. It\\^{o}'s formula \n(see for example Applebaum~\\cite[p.~203]{App} or Protter~\\cite[p.~71]{Pro}) implies\n\n", "index": 5, "text": "\\begin{equation*}\nf(y_t) = f(y_0) + \\sum_{i=0}^d \\int_0^t \\tilde{V}_i\\circ f(y_s) \n\\,\\mathrm{d}W^i_s + \\sum_{i=d+1}^\\ell \\int_0^t \\int_{\\mathbb{R}} \n(\\tilde{V}_{i}\\circ f)(y_{s_-},v) \\,{\\mkern 1.5mu\\overline{\\mkern-1.5mu{Q}\\mkern-1.5mu}\\mkern 1.5mu}^i(\\mathrm{d}v,\\mathrm{d}s),\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"f(y_{t})=f(y_{0})+\\sum_{i=0}^{d}\\int_{0}^{t}\\tilde{V}_{i}\\circ f(y_{s})\\,%&#10;\\mathrm{d}W^{i}_{s}+\\sum_{i=d+1}^{\\ell}\\int_{0}^{t}\\int_{\\mathbb{R}}(\\tilde{V}%&#10;_{i}\\circ f)(y_{s_{-}},v)\\,{\\mkern 1.5mu \\overline{\\mkern-1.5mu {Q}\\mkern-1.5%&#10;mu }\\mkern 1.5mu }^{i}(\\mathrm{d}v,\\mathrm{d}s),\" display=\"block\"><mrow><mrow><mrow><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>d</mi></munderover><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mi>t</mi></msubsup><mrow><mrow><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><mi>i</mi></msub><mo>\u2218</mo><mi>f</mi></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>s</mi></msub><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>d</mo><msubsup><mi>W</mi><mi>s</mi><mi>i</mi></msubsup></mrow></mrow></mrow></mrow><mo>+</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mrow><mi>d</mi><mo>+</mo><mn>1</mn></mrow></mrow><mi mathvariant=\"normal\">\u2113</mi></munderover><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mi>t</mi></msubsup><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mi>\u211d</mi></msub><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><mi>i</mi></msub><mo>\u2218</mo><mi>f</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>y</mi><msub><mi>s</mi><mo>-</mo></msub></msub><mo>,</mo><mi>v</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msup><mover accent=\"true\"><mi>Q</mi><mo>\u00af</mo></mover><mi>i</mi></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">d</mi><mo>\u2062</mo><mi>v</mi></mrow><mo>,</mo><mrow><mi mathvariant=\"normal\">d</mi><mo>\u2062</mo><mi>s</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nand $\\tilde{V}_0$ is the operator defined by \n\n", "itemtype": "equation", "pos": 14481, "prevtext": "\nwhere for $i=1,\\ldots,\\ell$, the $\\tilde{V}_i$ are operators defined as follows\n\n", "index": 7, "text": "\\begin{equation*}\n\\tilde{V}_i\\circ f\\coloneqq\n\\begin{dcases}\n(V_i \\cdot \\nabla) f, & \\mathrm{if}\\quad i=1,\\ldots, d, \\\\\nf\\bigl(\\,\\cdot\\, + v V_{i}(\\,\\cdot\\,)\\bigr) - f(\\,\\cdot\\,),  & \\mathrm{if} \\quad i = d+1,\\ldots,\\ell,\n\\end{dcases}\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m1\" class=\"ltx_Math\" alttext=\"\\tilde{V}_{i}\\circ f\\coloneqq\\begin{dcases}(V_{i}\\cdot\\nabla)f,&amp;\\mathrm{if}%&#10;\\quad i=1,\\ldots,d,\\\\&#10;f\\bigl{(}\\,\\cdot\\,+vV_{i}(\\,\\cdot\\,)\\bigr{)}-f(\\,\\cdot\\,),&amp;\\mathrm{if}\\quad i=%&#10;d+1,\\ldots,\\ell,\\end{dcases}\" display=\"block\"><mrow><mrow><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><mi>i</mi></msub><mo>\u2218</mo><mi>f</mi></mrow><mo>\u2254</mo><mrow><mo>{</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>V</mi><mi>i</mi></msub><mo>\u22c5</mo><mo>\u2207</mo></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>f</mi></mrow><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mrow><mrow><mi>if</mi><mo separator=\"true\">\u2003</mo><mi>i</mi></mrow><mo>=</mo><mn>1</mn></mrow><mo>,</mo><mrow><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><mi>d</mi></mrow></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mrow><mi>f</mi><mrow><mo maxsize=\"120%\" minsize=\"120%\" rspace=\"4.2pt\">(</mo><mo rspace=\"4.2pt\">\u22c5</mo><mo>+</mo><mi>v</mi><msub><mi>V</mi><mi>i</mi></msub><mrow><mo rspace=\"4.2pt\" stretchy=\"false\">(</mo><mo rspace=\"4.2pt\">\u22c5</mo><mo stretchy=\"false\">)</mo></mrow><mo maxsize=\"120%\" minsize=\"120%\">)</mo></mrow><mo>-</mo><mi>f</mi><mrow><mo rspace=\"4.2pt\" stretchy=\"false\">(</mo><mo rspace=\"4.2pt\">\u22c5</mo><mo stretchy=\"false\">)</mo></mrow><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mrow><mrow><mi>if</mi><mo separator=\"true\">\u2003</mo><mi>i</mi></mrow><mo>=</mo><mrow><mi>d</mi><mo>+</mo><mn>1</mn></mrow></mrow><mo>,</mo><mrow><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><mi mathvariant=\"normal\">\u2113</mi></mrow></mrow><mo>,</mo></mrow></mtd></mtr></mtable></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nNote for $i=d+1,\\ldots,\\ell$, the $\\tilde{V}_i$ introduce an \nadditional dependence on a real parameter $v$. The stochastic Taylor expansion \nis derived by expanding the integrands in the L\\'{e}vy-driven equation using It\\^{o}'s formula. \nThis procedure is repeated iteratively, where the iterations are encoded as follows. \nLet $A$ be the alphabet $A \\coloneqq \\{0,1,\\ldots,\\ell\\}$. For any such alphabet,\nwe use $A^*$ to denote the free monoid over $A$---the set of words $w=a_1\\ldots a_m$ \nconstructed from letters $a_i\\in A$. \nWe write $\\mathbbold{1}$ for the empty word. For a given word $w=a_1\\ldots a_m$ \ndefine the operator $\\tilde{V}_w \\coloneqq \\tilde{V}_{a_1} \\circ \\cdots \\circ \\tilde{V}_{a_m}$. \nLet $s(w)$ be the number of letters of $w$ from the subset $\\{d+1,\\ldots,\\ell\\}\\subset A$. \nFor a given integrand $g(t,v)\\colon\\mathbb{R}_+\\times \\mathbb{R}^{s(w)} \\rightarrow \\mathbb{R}^N$, \nwe define the iterated integrals $I_w(t)[g]$ inductively as follows. \nWe write $I_{\\mathbbold{1}}(t)[g] \\coloneqq g(t)$, and\n\n", "itemtype": "equation", "pos": 14778, "prevtext": "\nand $\\tilde{V}_0$ is the operator defined by \n\n", "index": 9, "text": "\\begin{align*}\n\\tilde{V}_0\\circ f\\coloneqq &\\;(V_0 \\cdot \\nabla)f \n+ \\frac{1}{2} \\sum_{i=1}^d \\sum_{j,k=1}^N V_i^j V_i^k \\partial_{x_j}\\partial_{x_k} f \\\\\n&\\;+ \\sum_{i=d+1}^\\ell \\int_{\\mathbb{R}} \\big[ (\\tilde{V}_i\\circ f)(\\cdot,v) \n- v(V_i \\cdot \\nabla)f \\big] \\,{\\rho}^i(\\mathrm{d}v).\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\tilde{V}_{0}\\circ f\\coloneqq\" display=\"inline\"><mrow><mrow><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><mn>0</mn></msub><mo>\u2218</mo><mi>f</mi></mrow><mo>\u2254</mo><mi/></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\;(V_{0}\\cdot\\nabla)f+\\frac{1}{2}\\sum_{i=1}^{d}\\sum_{j,k=1}^{N}V_%&#10;{i}^{j}V_{i}^{k}\\partial_{x_{j}}\\partial_{x_{k}}f\" display=\"inline\"><mrow><mrow><mi mathvariant=\"normal\">\u2004</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>V</mi><mn>0</mn></msub><mo>\u22c5</mo><mo>\u2207</mo></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>f</mi></mrow><mo>+</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle><mo>\u2062</mo><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>d</mi></munderover></mstyle><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mrow><mi>j</mi><mo>,</mo><mi>k</mi></mrow><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover></mstyle><mrow><msubsup><mi>V</mi><mi>i</mi><mi>j</mi></msubsup><mo>\u2062</mo><msubsup><mi>V</mi><mi>i</mi><mi>k</mi></msubsup><mo>\u2062</mo><mrow><mrow><msub><mo>\u2202</mo><msub><mi>x</mi><mi>j</mi></msub></msub><mo>\u2061</mo><msub><mo>\u2202</mo><msub><mi>x</mi><mi>k</mi></msub></msub></mrow><mo>\u2061</mo><mi>f</mi></mrow></mrow></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex6.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\;+\\sum_{i=d+1}^{\\ell}\\int_{\\mathbb{R}}\\big{[}(\\tilde{V}_{i}\\circ&#10;f%&#10;)(\\cdot,v)-v(V_{i}\\cdot\\nabla)f\\big{]}\\,{\\rho}^{i}(\\mathrm{d}v).\" display=\"inline\"><mrow><mrow><mi mathvariant=\"normal\">\u2004</mi><mo>+</mo><mrow><mstyle displaystyle=\"true\"><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mrow><mi>d</mi><mo>+</mo><mn>1</mn></mrow></mrow><mi mathvariant=\"normal\">\u2113</mi></munderover></mstyle><mrow><mstyle displaystyle=\"true\"><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mi>\u211d</mi></msub></mstyle><mrow><mrow><mo maxsize=\"120%\" minsize=\"120%\">[</mo><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><mi>i</mi></msub><mo>\u2218</mo><mi>f</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mo>\u22c5</mo><mo>,</mo><mi>v</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mi>v</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>V</mi><mi>i</mi></msub><mo>\u22c5</mo><mo>\u2207</mo></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>f</mi></mrow></mrow><mo maxsize=\"120%\" minsize=\"120%\" rspace=\"4.2pt\">]</mo></mrow><mo>\u2062</mo><msup><mi>\u03c1</mi><mi>i</mi></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">d</mi><mo>\u2062</mo><mi>v</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nIteratively applying the chain rule generates the following \n(see Platen \\& Bruti-Liberati \\cite{PlaBl}).\n\n\\begin{theorem}[Stochastic Taylor expansion]\\label{th:ST}\nFor a L\\'{e}vy-driven equation the action of the flowmap $\\varphi_t$\non sufficiently smooth functions $f\\colon\\mathbb R^N\\to\\mathbb R^N$ \ncan be expanded as follows \n\n", "itemtype": "equation", "pos": 16104, "prevtext": "\nNote for $i=d+1,\\ldots,\\ell$, the $\\tilde{V}_i$ introduce an \nadditional dependence on a real parameter $v$. The stochastic Taylor expansion \nis derived by expanding the integrands in the L\\'{e}vy-driven equation using It\\^{o}'s formula. \nThis procedure is repeated iteratively, where the iterations are encoded as follows. \nLet $A$ be the alphabet $A \\coloneqq \\{0,1,\\ldots,\\ell\\}$. For any such alphabet,\nwe use $A^*$ to denote the free monoid over $A$---the set of words $w=a_1\\ldots a_m$ \nconstructed from letters $a_i\\in A$. \nWe write $\\mathbbold{1}$ for the empty word. For a given word $w=a_1\\ldots a_m$ \ndefine the operator $\\tilde{V}_w \\coloneqq \\tilde{V}_{a_1} \\circ \\cdots \\circ \\tilde{V}_{a_m}$. \nLet $s(w)$ be the number of letters of $w$ from the subset $\\{d+1,\\ldots,\\ell\\}\\subset A$. \nFor a given integrand $g(t,v)\\colon\\mathbb{R}_+\\times \\mathbb{R}^{s(w)} \\rightarrow \\mathbb{R}^N$, \nwe define the iterated integrals $I_w(t)[g]$ inductively as follows. \nWe write $I_{\\mathbbold{1}}(t)[g] \\coloneqq g(t)$, and\n\n", "index": 11, "text": "\\begin{equation*}\nI_w(t)[g] \\coloneqq \n\\begin{dcases}\n\\int_0^t I_{a_1\\ldots a_{m-1}}(s)[g] \\,\\mathrm{d}W^{a_m}_s, & \\mathrm{if}\\quad a_m = 0,1,\\ldots,d, \\\\\n\\int_0^t \\int_{\\mathbb{R}} I_{a_1\\ldots a_{m-1}}(s_-) \n[g(\\cdot,v)] \\,{\\mkern 1.5mu\\overline{\\mkern-1.5mu{Q}\\mkern-1.5mu}\\mkern 1.5mu}^{a_m}(\\mathrm{d}v,\\mathrm{d}s), \n& \\mathrm{if}\\quad a_m = d+1,\\ldots,\\ell.\n\\end{dcases}\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex7.m1\" class=\"ltx_Math\" alttext=\"I_{w}(t)[g]\\coloneqq\\begin{dcases}\\int_{0}^{t}I_{a_{1}\\ldots a_{m-1}}(s)[g]\\,%&#10;\\mathrm{d}W^{a_{m}}_{s},&amp;\\mathrm{if}\\quad a_{m}=0,1,\\ldots,d,\\\\&#10;\\int_{0}^{t}\\int_{\\mathbb{R}}I_{a_{1}\\ldots a_{m-1}}(s_{-})[g(\\cdot,v)]\\,{%&#10;\\mkern 1.5mu \\overline{\\mkern-1.5mu {Q}\\mkern-1.5mu }\\mkern 1.5mu }^{a_{m}}(%&#10;\\mathrm{d}v,\\mathrm{d}s),&amp;\\mathrm{if}\\quad a_{m}=d+1,\\ldots,\\ell.\\end{dcases}\" display=\"block\"><mrow><mrow><msub><mi>I</mi><mi>w</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>g</mi><mo stretchy=\"false\">]</mo></mrow></mrow><mo>\u2254</mo><mrow><mo>{</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mi>t</mi></msubsup><mrow><msub><mi>I</mi><mrow><msub><mi>a</mi><mn>1</mn></msub><mo>\u2062</mo><mi mathvariant=\"normal\">\u2026</mi><mo>\u2062</mo><msub><mi>a</mi><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>g</mi><mo rspace=\"4.2pt\" stretchy=\"false\">]</mo></mrow><mo>\u2062</mo><mrow><mo>d</mo><msubsup><mi>W</mi><mi>s</mi><msub><mi>a</mi><mi>m</mi></msub></msubsup></mrow></mrow></mrow><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mrow><mrow><mi>if</mi><mo separator=\"true\">\u2003</mo><msub><mi>a</mi><mi>m</mi></msub></mrow><mo>=</mo><mn>0</mn></mrow><mo>,</mo><mrow><mn>1</mn><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><mi>d</mi></mrow></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mrow><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mi>t</mi></msubsup><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mi>\u211d</mi></msub><mrow><msub><mi>I</mi><mrow><msub><mi>a</mi><mn>1</mn></msub><mo>\u2062</mo><mi mathvariant=\"normal\">\u2026</mi><mo>\u2062</mo><msub><mi>a</mi><mrow><mi>m</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mo>-</mo></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mi>g</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mo>\u22c5</mo><mo>,</mo><mi>v</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">]</mo></mrow><mo>\u2062</mo><msup><mover accent=\"true\"><mi>Q</mi><mo>\u00af</mo></mover><msub><mi>a</mi><mi>m</mi></msub></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">d</mi><mo>\u2062</mo><mi>v</mi></mrow><mo>,</mo><mrow><mi mathvariant=\"normal\">d</mi><mo>\u2062</mo><mi>s</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><mrow><mrow><mi>if</mi><mo separator=\"true\">\u2003</mo><msub><mi>a</mi><mi>m</mi></msub></mrow><mo>=</mo><mrow><mi>d</mi><mo>+</mo><mn>1</mn></mrow></mrow><mo>,</mo><mrow><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><mi mathvariant=\"normal\">\u2113</mi></mrow></mrow><mo>.</mo></mrow></mtd></mtr></mtable></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\n\\end{theorem}\n\n\\begin{remark}[Stochastic Taylor expansion convergence]\\label{rmk:lineargrowth}\nFor integration schemes derived from the stochastic Taylor expansion to converge, \nit suffices that the terms $\\tilde{V}_w\\circ f$ included in the expansion, and\nthose at leading order in the remainder, satisfy global Lipschitz \nand linear growth conditions (see Platen \\& Bruti-Liberati \\cite{PlaBl}). \nHereafter we assume these conditions are satisfied.\n\\end{remark}\n\n\\begin{remark}[Platen and Bruti--Liberati form] \nThe stochastic Taylor expansion derived in Platen \\& Bruti-Liberati \\cite{PlaBl}\nis an equivalent though different representation.\nThe equivalence of the expansions is seen from the identity\n\n", "itemtype": "equation", "pos": 16830, "prevtext": "\nIteratively applying the chain rule generates the following \n(see Platen \\& Bruti-Liberati \\cite{PlaBl}).\n\n\\begin{theorem}[Stochastic Taylor expansion]\\label{th:ST}\nFor a L\\'{e}vy-driven equation the action of the flowmap $\\varphi_t$\non sufficiently smooth functions $f\\colon\\mathbb R^N\\to\\mathbb R^N$ \ncan be expanded as follows \n\n", "index": 13, "text": "\\begin{equation*}\n\\varphi_t\\circ f=\\sum_{w\\in A^*} I_w(t)\\bigl[\\tilde{V}_w\\circ f\\bigr].\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex8.m1\" class=\"ltx_Math\" alttext=\"\\varphi_{t}\\circ f=\\sum_{w\\in A^{*}}I_{w}(t)\\bigl{[}\\tilde{V}_{w}\\circ f\\bigr{%&#10;]}.\" display=\"block\"><mrow><mrow><mrow><msub><mi>\u03c6</mi><mi>t</mi></msub><mo>\u2218</mo><mi>f</mi></mrow><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>w</mi><mo>\u2208</mo><msup><mi>A</mi><mo>*</mo></msup></mrow></munder><mrow><msub><mi>I</mi><mi>w</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo maxsize=\"120%\" minsize=\"120%\">[</mo><mrow><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><mi>w</mi></msub><mo>\u2218</mo><mi>f</mi></mrow><mo maxsize=\"120%\" minsize=\"120%\">]</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": " \nThe expression on the left is the encoding employed by Platen and Bruti-Liberati of \nthe jump terms in the stochastic differential equation while our encoding is\nthat on the right. The equivalence is explained as follows. On the left above\n${\\mkern 1.5mu\\overline{\\mkern-1.5mu{Q}\\mkern-1.5mu}\\mkern 1.5mu}$ is a compensated Poisson random measure on \n$\\mathbb{R}^\\ell \\times \\mathbb{R}_+$. \nThe L\\'{e}vy-driven equation may be written in this form, \nwhere $V_{-1}(x,v) = \\sum_{i=1}^{\\ell-d} v_i V_{i+d}(x)$ \nand ${\\mkern 1.5mu\\overline{\\mkern-1.5mu{Q}\\mkern-1.5mu}\\mkern 1.5mu}$ is the compensation of the Poisson random measure $Q$ \ndefined such that \n$Q(B,(a,b]) = \\#\\{\\Delta J^1_s\\in B_1, \\ldots, \\Delta J^\\ell_s \\in B_\\ell\\, \\colon\\;\\; s\\in (a,b]\\}$ \nfor a Borel set $B = B_1\\times\\cdots\\times B_\\ell\\subset\\mathbb{R}^\\ell$ \nbounded away from the origin, i.e.\\/ $0\\notin \\bar{B}$. \nAs independent L\\'{e}vy processes almost surely never jump simultaneously \n(see Cont \\& Tankov \\cite[Theorem 5.3]{ConTan}), the measure\n$Q$ is concentrated on sets of the form \n$0\\times\\cdots\\times 0\\times B_i\\times 0\\times\\cdots\\times 0$ \nwith intensity measure \n${\\rho}(0\\times\\cdots\\times 0\\times B_i\\times 0\\times\\cdots\\times 0)\\mathrm{d}t={\\rho}^i(B_i)\\mathrm{d}t$. \nThe identity above thus follows.\nThe stochastic Taylor expansion given in Platen \\& Bruti-Liberati \\cite{PlaBl} \nis of the same form as the expansion we have given, but where the \nalphabet is instead $\\{-1,0,\\ldots,d\\}$, \nand the operator associated to the letter $-1$ is the multi-dimensional shift \n$\\tilde{V}_{-1}\\colon f(y)\\mapsto f\\bigl(y+V_{-1}(y,v)\\bigr)-f(y)$. \n\\end{remark}\n\nGiven the stochastic Taylor expansion for the flowmap in Theorem~\\ref{th:ST},\nwe now show how we can write it in separated form. One component of the\nseparated form are iterated integrals which are free in the sense of having \nno integrand. We define these abstractly for an arbitrary given alphabet \nfor the moment, the reason for this will be apparent presently.\n\n\\begin{definition}[Free multiple iterated integrals]\nGiven a collection of stochastic processes $\\{Z^{a_i}_t\\}_{a_i\\in\\mathbb{A}}$, \nindexed by a given countable alphabet $\\mathbb{A}$,\nfree multiple iterated integrals take the form\n\n", "itemtype": "equation", "pos": -1, "prevtext": "\n\\end{theorem}\n\n\\begin{remark}[Stochastic Taylor expansion convergence]\\label{rmk:lineargrowth}\nFor integration schemes derived from the stochastic Taylor expansion to converge, \nit suffices that the terms $\\tilde{V}_w\\circ f$ included in the expansion, and\nthose at leading order in the remainder, satisfy global Lipschitz \nand linear growth conditions (see Platen \\& Bruti-Liberati \\cite{PlaBl}). \nHereafter we assume these conditions are satisfied.\n\\end{remark}\n\n\\begin{remark}[Platen and Bruti--Liberati form] \nThe stochastic Taylor expansion derived in Platen \\& Bruti-Liberati \\cite{PlaBl}\nis an equivalent though different representation.\nThe equivalence of the expansions is seen from the identity\n\n", "index": 15, "text": "\\begin{equation*}\n\\int_0^t \\int_{\\mathbb{R}^{\\ell-d}} (\\tilde{V}_{-1}\\circ f)(y_{s_-},v) \n\\,{\\mkern 1.5mu\\overline{\\mkern-1.5mu{Q}\\mkern-1.5mu}\\mkern 1.5mu}(\\mathrm{d}v,\\mathrm{d}s) \n= \\sum_{i=d+1}^\\ell \\int_0^t \\int_{\\mathbb{R}} (\\tilde{V}_i\\circ f)(y_{s_-},v) \n\\,{\\mkern 1.5mu\\overline{\\mkern-1.5mu{Q}\\mkern-1.5mu}\\mkern 1.5mu}^i(\\mathrm{d}v,\\mathrm{d}s).\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex9.m1\" class=\"ltx_Math\" alttext=\"\\int_{0}^{t}\\int_{\\mathbb{R}^{\\ell-d}}(\\tilde{V}_{-1}\\circ f)(y_{s_{-}},v)\\,{%&#10;\\mkern 1.5mu \\overline{\\mkern-1.5mu {Q}\\mkern-1.5mu }\\mkern 1.5mu }(\\mathrm{d}%&#10;v,\\mathrm{d}s)=\\sum_{i=d+1}^{\\ell}\\int_{0}^{t}\\int_{\\mathbb{R}}(\\tilde{V}_{i}%&#10;\\circ f)(y_{s_{-}},v)\\,{\\mkern 1.5mu \\overline{\\mkern-1.5mu {Q}\\mkern-1.5mu }%&#10;\\mkern 1.5mu }^{i}(\\mathrm{d}v,\\mathrm{d}s).\" display=\"block\"><mrow><mrow><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mi>t</mi></msubsup><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><msup><mi>\u211d</mi><mrow><mi mathvariant=\"normal\">\u2113</mi><mo>-</mo><mi>d</mi></mrow></msup></msub><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><mrow><mo>-</mo><mn>1</mn></mrow></msub><mo>\u2218</mo><mi>f</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>y</mi><msub><mi>s</mi><mo>-</mo></msub></msub><mo>,</mo><mi>v</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mover accent=\"true\"><mi>Q</mi><mo>\u00af</mo></mover><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">d</mi><mo>\u2062</mo><mi>v</mi></mrow><mo>,</mo><mrow><mi mathvariant=\"normal\">d</mi><mo>\u2062</mo><mi>s</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>=</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mrow><mi>d</mi><mo>+</mo><mn>1</mn></mrow></mrow><mi mathvariant=\"normal\">\u2113</mi></munderover><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mi>t</mi></msubsup><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mi>\u211d</mi></msub><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><mi>i</mi></msub><mo>\u2218</mo><mi>f</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>y</mi><msub><mi>s</mi><mo>-</mo></msub></msub><mo>,</mo><mi>v</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msup><mover accent=\"true\"><mi>Q</mi><mo>\u00af</mo></mover><mi>i</mi></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">d</mi><mo>\u2062</mo><mi>v</mi></mrow><mo>,</mo><mrow><mi mathvariant=\"normal\">d</mi><mo>\u2062</mo><mi>s</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nwhere $w=a_1\\ldots a_m$ are words in $\\mathbb A^*$. \n\\end{definition}\n\nWe need to augment $\\{W^0,W^1,\\ldots,W^d,J^{d+1},\\ldots,J^\\ell\\}$ \nwith a set of extended driving processes as follows.\nA key component in the characterization of the algebra generated \nby the vector space of free iterated integrals of the driving processes\n$\\{W^0,W^1,\\ldots,W^d, J^{d+1},\\ldots,J^\\ell\\}$ are the compensated power brackets defined for each\n$i \\in \\{d+1, \\ldots,\\, \\ell\\}$ and for $p\\geq 2$ by\n\n", "itemtype": "equation", "pos": 20255, "prevtext": " \nThe expression on the left is the encoding employed by Platen and Bruti-Liberati of \nthe jump terms in the stochastic differential equation while our encoding is\nthat on the right. The equivalence is explained as follows. On the left above\n${\\mkern 1.5mu\\overline{\\mkern-1.5mu{Q}\\mkern-1.5mu}\\mkern 1.5mu}$ is a compensated Poisson random measure on \n$\\mathbb{R}^\\ell \\times \\mathbb{R}_+$. \nThe L\\'{e}vy-driven equation may be written in this form, \nwhere $V_{-1}(x,v) = \\sum_{i=1}^{\\ell-d} v_i V_{i+d}(x)$ \nand ${\\mkern 1.5mu\\overline{\\mkern-1.5mu{Q}\\mkern-1.5mu}\\mkern 1.5mu}$ is the compensation of the Poisson random measure $Q$ \ndefined such that \n$Q(B,(a,b]) = \\#\\{\\Delta J^1_s\\in B_1, \\ldots, \\Delta J^\\ell_s \\in B_\\ell\\, \\colon\\;\\; s\\in (a,b]\\}$ \nfor a Borel set $B = B_1\\times\\cdots\\times B_\\ell\\subset\\mathbb{R}^\\ell$ \nbounded away from the origin, i.e.\\/ $0\\notin \\bar{B}$. \nAs independent L\\'{e}vy processes almost surely never jump simultaneously \n(see Cont \\& Tankov \\cite[Theorem 5.3]{ConTan}), the measure\n$Q$ is concentrated on sets of the form \n$0\\times\\cdots\\times 0\\times B_i\\times 0\\times\\cdots\\times 0$ \nwith intensity measure \n${\\rho}(0\\times\\cdots\\times 0\\times B_i\\times 0\\times\\cdots\\times 0)\\mathrm{d}t={\\rho}^i(B_i)\\mathrm{d}t$. \nThe identity above thus follows.\nThe stochastic Taylor expansion given in Platen \\& Bruti-Liberati \\cite{PlaBl} \nis of the same form as the expansion we have given, but where the \nalphabet is instead $\\{-1,0,\\ldots,d\\}$, \nand the operator associated to the letter $-1$ is the multi-dimensional shift \n$\\tilde{V}_{-1}\\colon f(y)\\mapsto f\\bigl(y+V_{-1}(y,v)\\bigr)-f(y)$. \n\\end{remark}\n\nGiven the stochastic Taylor expansion for the flowmap in Theorem~\\ref{th:ST},\nwe now show how we can write it in separated form. One component of the\nseparated form are iterated integrals which are free in the sense of having \nno integrand. We define these abstractly for an arbitrary given alphabet \nfor the moment, the reason for this will be apparent presently.\n\n\\begin{definition}[Free multiple iterated integrals]\nGiven a collection of stochastic processes $\\{Z^{a_i}_t\\}_{a_i\\in\\mathbb{A}}$, \nindexed by a given countable alphabet $\\mathbb{A}$,\nfree multiple iterated integrals take the form\n\n", "index": 17, "text": "\\begin{equation*}\nI_w(t) \\coloneqq \\int_{0<\\tau_{1}<\\cdots<\\tau_m<t}\n\\,\\mathrm{d}Z^{a_1}_{\\tau_1}\\cdots\\,\\mathrm{d}Z^{a_m}_{\\tau_m},\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex10.m1\" class=\"ltx_Math\" alttext=\"I_{w}(t)\\coloneqq\\int_{0&lt;\\tau_{1}&lt;\\cdots&lt;\\tau_{m}&lt;t}\\,\\mathrm{d}Z^{a_{1}}_{%&#10;\\tau_{1}}\\cdots\\,\\mathrm{d}Z^{a_{m}}_{\\tau_{m}},\" display=\"block\"><mrow><mrow><mrow><msub><mi>I</mi><mi>w</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2254</mo><mrow><mpadded width=\"+1.7pt\"><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mn>0</mn><mo>&lt;</mo><msub><mi>\u03c4</mi><mn>1</mn></msub><mo>&lt;</mo><mi mathvariant=\"normal\">\u22ef</mi><mo>&lt;</mo><msub><mi>\u03c4</mi><mi>m</mi></msub><mo>&lt;</mo><mi>t</mi></mrow></msub></mpadded><mrow><mrow><mo>d</mo><msubsup><mi>Z</mi><msub><mi>\u03c4</mi><mn>1</mn></msub><msub><mi>a</mi><mn>1</mn></msub></msubsup></mrow><mo>\u2062</mo><mpadded width=\"+1.7pt\"><mi mathvariant=\"normal\">\u22ef</mi></mpadded><mo>\u2062</mo><mrow><mo>d</mo><msubsup><mi>Z</mi><msub><mi>\u03c4</mi><mi>m</mi></msub><msub><mi>a</mi><mi>m</mi></msub></msubsup></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nEquivalently we have $J^{i^{(p)}}_t=[J^i]^{(p)}-t\\int_{\\mathbb R} v^p\\,\\rho^i(\\mathrm{d}v)$,\nwhere $[J_t^i]^{(p)}$ is the $p$th order nested quadratic covariation\nbracket of $J_t^i$.\nImportantly, the compensated power brackets have the property that if $J^{i^{(p)}}$ is contained in the\nlinear span of $\\{t,J^i_t,J^{i^{(2)}}_t,\\ldots,J^{i^{(p-1)}}_t\\}$ for some $p\\geq 2$,\nthen $J^{i^{(q)}}$ is also in this linear span for all $q\\geq p$.\nHence inductively for $p\\geq 2$, we augment our family \n$\\{W^0,W^1,\\ldots,W^d, J^{d+1},\\ldots,J^\\ell\\}$ to include the \ncompensated power brackets $J^{i^{(p)}}$ as long as they are not contained in the\nlinear span of $\\bigl\\{t,J^i_t,J^{i^{(2)}}_t,\\ldots,J^{i^{(p-1)}}_t\\bigr\\}$. \nBy doing so, we obtain a possibly infinite family of stochastic processes. \nThe iterated integrals of this extended family\nform the algebra generated by the iterated integrals of our driving processes. \nSee Curry et al.~\\cite{CEfMW} for further details. In summary we define \nour extended alphabet as follows.\n\n\\begin{definition}[Extended alphabet]\nWe define our alphabet $\\mathbb{A}$ to contain the letters $0,1,\\ldots,\\ell$, \nassociated with \n$\\{W^0,W^1,\\ldots,W^d, J^{d+1},\\ldots,J^\\ell\\}$, \nand the additional letters $i^{(p)}$ corresponding to any $J^{i^{(p)}}$ \ncontained in the extended family as described above.\n\\end{definition}\n\n\\begin{definition}[Separated stochastic Taylor expansion]\nThe flowmap for a L\\'{e}vy-driven stochastic differential equation\npossesses a separated stochastic Taylor expansion if it can be written in the form\n\n", "itemtype": "equation", "pos": 20886, "prevtext": "\nwhere $w=a_1\\ldots a_m$ are words in $\\mathbb A^*$. \n\\end{definition}\n\nWe need to augment $\\{W^0,W^1,\\ldots,W^d,J^{d+1},\\ldots,J^\\ell\\}$ \nwith a set of extended driving processes as follows.\nA key component in the characterization of the algebra generated \nby the vector space of free iterated integrals of the driving processes\n$\\{W^0,W^1,\\ldots,W^d, J^{d+1},\\ldots,J^\\ell\\}$ are the compensated power brackets defined for each\n$i \\in \\{d+1, \\ldots,\\, \\ell\\}$ and for $p\\geq 2$ by\n\n", "index": 19, "text": "\\begin{equation*}\nJ^{i^{(p)}}_t\\coloneqq \\int_0^t \\int_{\\mathbb{R}} v^p {\\mkern 1.5mu\\overline{\\mkern-1.5mu{Q}\\mkern-1.5mu}\\mkern 1.5mu}^i(\\mathrm{d}v,\\mathrm{d}s).\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex11.m1\" class=\"ltx_Math\" alttext=\"J^{i^{(p)}}_{t}\\coloneqq\\int_{0}^{t}\\int_{\\mathbb{R}}v^{p}{\\mkern 1.5mu %&#10;\\overline{\\mkern-1.5mu {Q}\\mkern-1.5mu }\\mkern 1.5mu }^{i}(\\mathrm{d}v,\\mathrm%&#10;{d}s).\" display=\"block\"><mrow><mrow><msubsup><mi>J</mi><mi>t</mi><msup><mi>i</mi><mrow><mo stretchy=\"false\">(</mo><mi>p</mi><mo stretchy=\"false\">)</mo></mrow></msup></msubsup><mo>\u2254</mo><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mi>t</mi></msubsup><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mi>\u211d</mi></msub><mrow><msup><mi>v</mi><mi>p</mi></msup><mo>\u2062</mo><msup><mover accent=\"true\"><mi>Q</mi><mo>\u00af</mo></mover><mi>i</mi></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">d</mi><mo>\u2062</mo><mi>v</mi></mrow><mo>,</mo><mrow><mi mathvariant=\"normal\">d</mi><mo>\u2062</mo><mi>s</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nwhere $\\{I_w\\}_{w\\in\\mathbb A^*}$ are the free \niterated integrals associated to the extended driving processes \nand $\\tilde{V}_w = \\tilde{V}_{a_1}\\circ\\cdots\\circ\\tilde{V}_{a_m}$ \nare operators indexed by words that compose associatively.\n\\end{definition}\n\n\\begin{remark}[Separable cases] \nFor $i\\in\\{1,\\ldots,d\\}$ and $j\\in\\{d+1,\\ldots,\\ell\\}$, consider the term\n\n", "itemtype": "equation", "pos": 22633, "prevtext": "\nEquivalently we have $J^{i^{(p)}}_t=[J^i]^{(p)}-t\\int_{\\mathbb R} v^p\\,\\rho^i(\\mathrm{d}v)$,\nwhere $[J_t^i]^{(p)}$ is the $p$th order nested quadratic covariation\nbracket of $J_t^i$.\nImportantly, the compensated power brackets have the property that if $J^{i^{(p)}}$ is contained in the\nlinear span of $\\{t,J^i_t,J^{i^{(2)}}_t,\\ldots,J^{i^{(p-1)}}_t\\}$ for some $p\\geq 2$,\nthen $J^{i^{(q)}}$ is also in this linear span for all $q\\geq p$.\nHence inductively for $p\\geq 2$, we augment our family \n$\\{W^0,W^1,\\ldots,W^d, J^{d+1},\\ldots,J^\\ell\\}$ to include the \ncompensated power brackets $J^{i^{(p)}}$ as long as they are not contained in the\nlinear span of $\\bigl\\{t,J^i_t,J^{i^{(2)}}_t,\\ldots,J^{i^{(p-1)}}_t\\bigr\\}$. \nBy doing so, we obtain a possibly infinite family of stochastic processes. \nThe iterated integrals of this extended family\nform the algebra generated by the iterated integrals of our driving processes. \nSee Curry et al.~\\cite{CEfMW} for further details. In summary we define \nour extended alphabet as follows.\n\n\\begin{definition}[Extended alphabet]\nWe define our alphabet $\\mathbb{A}$ to contain the letters $0,1,\\ldots,\\ell$, \nassociated with \n$\\{W^0,W^1,\\ldots,W^d, J^{d+1},\\ldots,J^\\ell\\}$, \nand the additional letters $i^{(p)}$ corresponding to any $J^{i^{(p)}}$ \ncontained in the extended family as described above.\n\\end{definition}\n\n\\begin{definition}[Separated stochastic Taylor expansion]\nThe flowmap for a L\\'{e}vy-driven stochastic differential equation\npossesses a separated stochastic Taylor expansion if it can be written in the form\n\n", "index": 21, "text": "\\begin{equation*}\n\\varphi_t=\\sum_{w\\in\\mathbb A^*} I_w \\tilde{V}_w,\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex12.m1\" class=\"ltx_Math\" alttext=\"\\varphi_{t}=\\sum_{w\\in\\mathbb{A}^{*}}I_{w}\\tilde{V}_{w},\" display=\"block\"><mrow><mrow><msub><mi>\u03c6</mi><mi>t</mi></msub><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>w</mi><mo>\u2208</mo><msup><mi>\ud835\udd38</mi><mo>*</mo></msup></mrow></munder><mrow><msub><mi>I</mi><mi>w</mi></msub><mo>\u2062</mo><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><mi>w</mi></msub></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nin the general stochastic Taylor expansion.\nThe double integral with respect to the random measure\nis a sum of compensated power bracket processes and thus separable, if the integrand\n$V_i\\big(y_0 + vV_{j}(y_{0})\\big)-V_i(y_0)$ is either a polynomial in the jump size $v$\nor it can be expressed as a power series in $v$. \nWe see how this works in detail presently.\n\\end{remark}\n\n\\begin{remark}[Separated expansion for jump-diffusion equations] \nIn the case of jump-diffusion equations, i.e.\\/ L\\'evy-driven equations for which \nall the discontinuous driving processes $J^i$ are standard Poisson processes, \nthe stochastic Taylor expansion is of the separated form. \nIndeed, as standard Poisson processes have jumps of size one only, \nthe operators $\\tilde{V}_i$ with $i=d+1,\\ldots,\\ell$ do not introduce \na dependence on an additional parameter. The integrands are thus constant \nacross the range of integration, and hence the expansion is separated.\n\\end{remark}\n\nWe can construct a separated stochastic Taylor expansion for the flowmap as follows.\nBy Taylor expansion of the term $f\\bigl(y+vV_i(y)\\bigr)$ \nappearing in the shift $\\tilde{V}_i\\circ f$, we have\n\n", "itemtype": "equation", "pos": 23082, "prevtext": "\nwhere $\\{I_w\\}_{w\\in\\mathbb A^*}$ are the free \niterated integrals associated to the extended driving processes \nand $\\tilde{V}_w = \\tilde{V}_{a_1}\\circ\\cdots\\circ\\tilde{V}_{a_m}$ \nare operators indexed by words that compose associatively.\n\\end{definition}\n\n\\begin{remark}[Separable cases] \nFor $i\\in\\{1,\\ldots,d\\}$ and $j\\in\\{d+1,\\ldots,\\ell\\}$, consider the term\n\n", "index": 23, "text": "\\begin{equation*}\nI_{ji}[(\\tilde{V}_{ji}\\circ {\\mathrm{id}})(y_0)]\n= \\int_0^t \\left(\\int_0^s \\int_{\\mathbb{R}}\n\\Big(V_i\\big(y_0 + vV_{j}(y_{0})\\big)-V_i(y_0)\\Big)\n\\,{\\mkern 1.5mu\\overline{\\mkern-1.5mu{Q}\\mkern-1.5mu}\\mkern 1.5mu}^j(\\mathrm{d}v,\\mathrm{d}\\tau)\\right)\\,\\mathrm{d}W^i_s,\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex13.m1\" class=\"ltx_Math\" alttext=\"I_{ji}[(\\tilde{V}_{ji}\\circ{\\mathrm{id}})(y_{0})]=\\int_{0}^{t}\\left(\\int_{0}^{%&#10;s}\\int_{\\mathbb{R}}\\Big{(}V_{i}\\big{(}y_{0}+vV_{j}(y_{0})\\big{)}-V_{i}(y_{0})%&#10;\\Big{)}\\,{\\mkern 1.5mu \\overline{\\mkern-1.5mu {Q}\\mkern-1.5mu }\\mkern 1.5mu }^%&#10;{j}(\\mathrm{d}v,\\mathrm{d}\\tau)\\right)\\,\\mathrm{d}W^{i}_{s},\" display=\"block\"><mrow><mrow><mrow><msub><mi>I</mi><mrow><mi>j</mi><mo>\u2062</mo><mi>i</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><mrow><mi>j</mi><mo>\u2062</mo><mi>i</mi></mrow></msub><mo>\u2218</mo><mi>id</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mo>=</mo><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mi>t</mi></msubsup><mrow><mrow><mo>(</mo><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mi>s</mi></msubsup><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mi>\u211d</mi></msub><mrow><mrow><mo maxsize=\"160%\" minsize=\"160%\">(</mo><mrow><mrow><msub><mi>V</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo maxsize=\"120%\" minsize=\"120%\">(</mo><mrow><msub><mi>y</mi><mn>0</mn></msub><mo>+</mo><mrow><mi>v</mi><mo>\u2062</mo><msub><mi>V</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo maxsize=\"120%\" minsize=\"120%\">)</mo></mrow></mrow><mo>-</mo><mrow><msub><mi>V</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo maxsize=\"160%\" minsize=\"160%\" rspace=\"4.2pt\">)</mo></mrow><mo>\u2062</mo><msup><mover accent=\"true\"><mi>Q</mi><mo>\u00af</mo></mover><mi>j</mi></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">d</mi><mo>\u2062</mo><mi>v</mi></mrow><mo>,</mo><mrow><mi mathvariant=\"normal\">d</mi><mo>\u2062</mo><mi>\u03c4</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo rspace=\"4.2pt\">)</mo></mrow><mo>\u2062</mo><mrow><mo>d</mo><msubsup><mi>W</mi><mi>s</mi><mi>i</mi></msubsup></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nwhere we write $V_{i}=\\bigl(V_{i}^1,\\ldots, V_{i}^N\\bigr)^{\\mathrm{T}}$ \nand $f=\\bigl(f^1,\\ldots,f^N\\bigr)^{\\mathrm{T}}$. \nWe define the operators $\\tilde{V}_{i^{(m)}}$ by\n\n", "itemtype": "equation", "pos": 24544, "prevtext": "\nin the general stochastic Taylor expansion.\nThe double integral with respect to the random measure\nis a sum of compensated power bracket processes and thus separable, if the integrand\n$V_i\\big(y_0 + vV_{j}(y_{0})\\big)-V_i(y_0)$ is either a polynomial in the jump size $v$\nor it can be expressed as a power series in $v$. \nWe see how this works in detail presently.\n\\end{remark}\n\n\\begin{remark}[Separated expansion for jump-diffusion equations] \nIn the case of jump-diffusion equations, i.e.\\/ L\\'evy-driven equations for which \nall the discontinuous driving processes $J^i$ are standard Poisson processes, \nthe stochastic Taylor expansion is of the separated form. \nIndeed, as standard Poisson processes have jumps of size one only, \nthe operators $\\tilde{V}_i$ with $i=d+1,\\ldots,\\ell$ do not introduce \na dependence on an additional parameter. The integrands are thus constant \nacross the range of integration, and hence the expansion is separated.\n\\end{remark}\n\nWe can construct a separated stochastic Taylor expansion for the flowmap as follows.\nBy Taylor expansion of the term $f\\bigl(y+vV_i(y)\\bigr)$ \nappearing in the shift $\\tilde{V}_i\\circ f$, we have\n\n", "index": 25, "text": "\\begin{equation*}\n(\\tilde{V}_i\\circ f)(y,v)=\\sum_{m\\geq 1}v^m\\tilde{V}_{i^{(m)}} \\circ f(y),\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex14.m1\" class=\"ltx_Math\" alttext=\"(\\tilde{V}_{i}\\circ f)(y,v)=\\sum_{m\\geq 1}v^{m}\\tilde{V}_{i^{(m)}}\\circ f(y),\" display=\"block\"><mrow><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><mi>i</mi></msub><mo>\u2218</mo><mi>f</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo>,</mo><mi>v</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>m</mi><mo>\u2265</mo><mn>1</mn></mrow></munder><mrow><mrow><mrow><msup><mi>v</mi><mi>m</mi></msup><mo>\u2062</mo><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><msup><mi>i</mi><mrow><mo stretchy=\"false\">(</mo><mi>m</mi><mo stretchy=\"false\">)</mo></mrow></msup></msub></mrow><mo>\u2218</mo><mi>f</mi></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nwhere the $i_j\\in\\mathbb N$. \nThe product in $V_{i}^{i_1}\\cdots V_{i}^{i_k}$ is multiplication in $\\mathbb{R}$. \nWe then have \n\n", "itemtype": "equation", "pos": 24825, "prevtext": "\nwhere we write $V_{i}=\\bigl(V_{i}^1,\\ldots, V_{i}^N\\bigr)^{\\mathrm{T}}$ \nand $f=\\bigl(f^1,\\ldots,f^N\\bigr)^{\\mathrm{T}}$. \nWe define the operators $\\tilde{V}_{i^{(m)}}$ by\n\n", "index": 27, "text": "\\begin{equation*}\n\\tilde{V}_{i^{(m)}}\\circ f^j \n\\coloneqq\\sum_{k\\geq1}\\sum_{i_1+\\ldots + i_k = m} \\frac{1}{m!} V_{i}^{i_1}\\cdots V_{i}^{i_k} \n\\frac{\\partial^m f^j}{\\partial y^{i_1}\\cdots \\partial y^{i_k}},\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex15.m1\" class=\"ltx_Math\" alttext=\"\\tilde{V}_{i^{(m)}}\\circ f^{j}\\coloneqq\\sum_{k\\geq 1}\\sum_{i_{1}+\\ldots+i_{k}=%&#10;m}\\frac{1}{m!}V_{i}^{i_{1}}\\cdots V_{i}^{i_{k}}\\frac{\\partial^{m}f^{j}}{%&#10;\\partial y^{i_{1}}\\cdots\\partial y^{i_{k}}},\" display=\"block\"><mrow><mrow><mrow><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><msup><mi>i</mi><mrow><mo stretchy=\"false\">(</mo><mi>m</mi><mo stretchy=\"false\">)</mo></mrow></msup></msub><mo>\u2218</mo><msup><mi>f</mi><mi>j</mi></msup></mrow><mo>\u2254</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>k</mi><mo>\u2265</mo><mn>1</mn></mrow></munder><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mrow><msub><mi>i</mi><mn>1</mn></msub><mo>+</mo><mi mathvariant=\"normal\">\u2026</mi><mo>+</mo><msub><mi>i</mi><mi>k</mi></msub></mrow><mo>=</mo><mi>m</mi></mrow></munder><mrow><mfrac><mn>1</mn><mrow><mi>m</mi><mo lspace=\"0pt\" rspace=\"3.5pt\">!</mo></mrow></mfrac><mo>\u2062</mo><msubsup><mi>V</mi><mi>i</mi><msub><mi>i</mi><mn>1</mn></msub></msubsup><mo>\u2062</mo><mi mathvariant=\"normal\">\u22ef</mi><mo>\u2062</mo><msubsup><mi>V</mi><mi>i</mi><msub><mi>i</mi><mi>k</mi></msub></msubsup><mo>\u2062</mo><mfrac><mrow><msup><mo>\u2202</mo><mi>m</mi></msup><mo>\u2061</mo><msup><mi>f</mi><mi>j</mi></msup></mrow><mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><mrow><msup><mi>y</mi><msub><mi>i</mi><mn>1</mn></msub></msup><mo>\u2062</mo><mi mathvariant=\"normal\">\u22ef</mi></mrow></mrow><mo>\u2062</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><msup><mi>y</mi><msub><mi>i</mi><mi>k</mi></msub></msup></mrow></mrow></mfrac></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nfor $i=d+1,\\ldots,\\ell$. Inserting the above into the relation \n\n", "itemtype": "equation", "pos": 25174, "prevtext": "\nwhere the $i_j\\in\\mathbb N$. \nThe product in $V_{i}^{i_1}\\cdots V_{i}^{i_k}$ is multiplication in $\\mathbb{R}$. \nWe then have \n\n", "index": 29, "text": "\\begin{equation*}\nI_i(t)[(\\tilde{V}_i\\circ f)(\\cdot,v)] \n= \\sum_{m\\geq 1} \\int_0^t \\bigl(\\tilde{V}_{i^{(m)}}\\circ f\\bigr)\\,\\mathrm{d}J^{i^{(m)}}_s,\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex16.m1\" class=\"ltx_Math\" alttext=\"I_{i}(t)[(\\tilde{V}_{i}\\circ f)(\\cdot,v)]=\\sum_{m\\geq 1}\\int_{0}^{t}\\bigl{(}%&#10;\\tilde{V}_{i^{(m)}}\\circ f\\bigr{)}\\,\\mathrm{d}J^{i^{(m)}}_{s},\" display=\"block\"><mrow><mrow><mrow><msub><mi>I</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><mi>i</mi></msub><mo>\u2218</mo><mi>f</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mo>\u22c5</mo><mo>,</mo><mi>v</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>m</mi><mo>\u2265</mo><mn>1</mn></mrow></munder><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mi>t</mi></msubsup><mrow><mrow><mo maxsize=\"120%\" minsize=\"120%\">(</mo><mrow><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><msup><mi>i</mi><mrow><mo stretchy=\"false\">(</mo><mi>m</mi><mo stretchy=\"false\">)</mo></mrow></msup></msub><mo>\u2218</mo><mi>f</mi></mrow><mo maxsize=\"120%\" minsize=\"120%\" rspace=\"4.2pt\">)</mo></mrow><mo>\u2062</mo><mrow><mo>d</mo><msubsup><mi>J</mi><mi>s</mi><msup><mi>i</mi><mrow><mo stretchy=\"false\">(</mo><mi>m</mi><mo stretchy=\"false\">)</mo></mrow></msup></msubsup></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": " \nand iterating gives the separated expansion, \nwhere the operators $\\tilde{V}_a$ are those of \nthe stochastic Taylor expansion for $a\\in\\{0,1,\\ldots,d\\}$, \nand for $a=i^{(m)}$ are given by the $\\tilde{V}_{i^{(m)}}$ defined above.\nWe have thus just established the following result.\n\n\\begin{theorem}[Separated stochastic Taylor expansion: existence]\\label{mark taylor}\nFor a L\\'evy-driven equation suppose the terms $\\tilde V_w\\circ f$ in the stochastic\nTaylor expansion for the flowmap are analytic on $\\mathbb R^N$. Then it can \nbe written in separated form, i.e.\\/ as a separated stochastic Taylor expansion.\n\\end{theorem}\n\n\\begin{remark}[Linear vector fields and linear diffeomorphisms] \nThe separated expansion has a simple form when the governing vector\nfields are linear with constant coefficients and we consider the action of the flowmap \non homogeneous linear diffeomorphisms, say $f(y)=Fy$, where $F=[f_{ij}]$ is \nan $N\\times N$ matrix. The identity map is a special case of such a linear\ndiffeomorphism which generates the solution $y_t$ directly.\nIn this case, the operators in the expansion are given by matrix multiplication. \nWe write $V_i(y) = A^i y$, where $A^i=[a^i_{jk}]$ are constant $N\\times N$ matrices \nand consider the action of the flowmap on linear functions.\nFirst, for $i=1,\\ldots,d$ by direct computation we find $\\tilde{V}_i\\circ f(y)=FA^iy$.\nMoreover, for $i=d+1,\\ldots,\\ell$ the higher order differential operators \n$\\tilde{V}_{i^{(m)}}$ with $m\\geq 2$ vanish due to the linearity, and we obtain \n$(\\tilde{V}_{i}\\circ f)(y,v)=v(V_i\\cdot\\nabla)f(y)=vFA^iy$.\nThe above relation shows in addition that the term in \n$\\tilde{V}_0\\circ f$ involving an integral over the jump sizes vanishes. \nAs the functions we act on are linear, the second order terms of $\\tilde{V}_0$ also vanish. \nWe therefore have $\\tilde{V}_0\\circ f(y) = f(V_0(y)) = FA^0 y$. \nThe operators $\\tilde{V}_i$ act by matrix multiplication. \nIt follows that the operators $\\tilde{V}_w$ act on linear functions \nby matrix multiplication in the reverse order,\n$\\tilde{V}_{a_1\\ldots a_k}\\circ f(y) = F A^{a_k}\\cdots A^{a_1}y$.\n\\end{remark}\n\nHereafter we assume the existence of a separated Taylor expansion for the flowmap, \nand all iterated integrals are free iterated integrals.\n\n\n\\section{Convolution algebras and map-truncate-invert schemes}\\label{sec:convalg}\nWe now introduce a class of numerical integration schemes we call \nmap-truncate-invert schemes and show how they can be encoded algebraically. \nThe algebraic structures arise naturally from the products of iterated integrals \nand the composition of operators appearing in the separated stochastic Taylor expansion. \nConsider the class of numerical integration schemes obtained from \nthe stochastic Taylor expansion by simulating truncations of the expansion \non each subinterval of a uniform discretization of a given time domain $[0,T]$. \n\n\\begin{definition}[Grading function and truncations]\nA grading function $\\mathrm{g}\\colon\\mathbb{A}^*\\rightarrow\\mathbb{N}$ assigns\na positive integer to each non-empty word $w\\in\\mathbb{A}^*$ and zero to the empty word.\nA truncation is specified by a grading function and truncation value $n\\in\\mathbb{N}$. \nWe write $\\pi_{{\\mathrm{g}}=n}$, $\\pi_{{\\mathrm{g}}\\leq n}$ and $\\pi_{{\\mathrm{g}}\\geq n}$ for the projections of $\\mathbb{A}^*$ \nonto the following subsets: \n\\begin{enumerate}\n\\item $\\pi_{{\\mathrm{g}}=n}(\\mathbb{A}^*)\\coloneqq\\{w\\in\\mathbb{A}^*\\colon \\mathrm{g}(w)=n\\}$;\n\\item $\\pi_{{\\mathrm{g}}\\leq n}(\\mathbb{A}^*)\\coloneqq\\{w\\in\\mathbb{A}^*\\colon \\mathrm{g}(w)\\leq n\\}$; and\n\\item $\\pi_{{\\mathrm{g}}\\geq n}(\\mathbb{A}^*)\\coloneqq\\{w\\in\\mathbb{A}^*\\colon \\mathrm{g}(w)\\geq n\\}$.\n\\end{enumerate}\n\\end{definition}\n\nA numerical integration scheme based on the stochastic Taylor expansion is thus \ngiven by successive applications of the approximate flow\n\n", "itemtype": "equation", "pos": -1, "prevtext": "\nfor $i=d+1,\\ldots,\\ell$. Inserting the above into the relation \n\n", "index": 31, "text": "\\begin{equation*}\nI_w(t)\\bigl[\\tilde{V}_w\\circ f\\bigr] \n= I_{a_2\\ldots a_m}(t)\\Big[I_{a_1}(\\cdot)\\big[\\tilde{V}_{a_1}\\circ (\\tilde{V}_{a_2\\ldots a_m}\\circ f)\\big]\\Big]\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex17.m1\" class=\"ltx_Math\" alttext=\"I_{w}(t)\\bigl{[}\\tilde{V}_{w}\\circ f\\bigr{]}=I_{a_{2}\\ldots a_{m}}(t)\\Big{[}I_%&#10;{a_{1}}(\\cdot)\\big{[}\\tilde{V}_{a_{1}}\\circ(\\tilde{V}_{a_{2}\\ldots a_{m}}\\circ&#10;f%&#10;)\\big{]}\\Big{]}\" display=\"block\"><mrow><mrow><msub><mi>I</mi><mi>w</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo maxsize=\"120%\" minsize=\"120%\">[</mo><mrow><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><mi>w</mi></msub><mo>\u2218</mo><mi>f</mi></mrow><mo maxsize=\"120%\" minsize=\"120%\">]</mo></mrow></mrow><mo>=</mo><mrow><msub><mi>I</mi><mrow><msub><mi>a</mi><mn>2</mn></msub><mo>\u2062</mo><mi mathvariant=\"normal\">\u2026</mi><mo>\u2062</mo><msub><mi>a</mi><mi>m</mi></msub></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo maxsize=\"160%\" minsize=\"160%\">[</mo><mrow><msub><mi>I</mi><msub><mi>a</mi><mn>1</mn></msub></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mo>\u22c5</mo><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo maxsize=\"120%\" minsize=\"120%\">[</mo><mrow><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><msub><mi>a</mi><mn>1</mn></msub></msub><mo>\u2218</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><mrow><msub><mi>a</mi><mn>2</mn></msub><mo>\u2062</mo><mi mathvariant=\"normal\">\u2026</mi><mo>\u2062</mo><msub><mi>a</mi><mi>m</mi></msub></mrow></msub><mo>\u2218</mo><mi>f</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo maxsize=\"120%\" minsize=\"120%\">]</mo></mrow></mrow><mo maxsize=\"160%\" minsize=\"160%\">]</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nacross the computational subintervals. \nNow more generally, consider a larger class of numerical schemes that are constructed as follows. \nFor a given invertible map $f\\colon\\mathrm{Diff}(\\mathbb{R}^N)\\rightarrow\\mathrm{Diff}(\\mathbb{R}^N$), \nwe construct a series expansion for $f(\\varphi_t)$ using the stochastic Taylor expansion for $\\varphi_t$. \nWe truncate the series and simulate the retained iterated It\\^o integrals across each\ncomputational subinterval. An integration scheme is obtained by \ncomputing the inverse map $f^{-1}$ of the simulated truncations at each step; \nsee Malham \\& Wiese~\\cite{MalWie} and Ebrahimi--Fard \\textit{et al.\\/ }~\\cite{EfLMMkW}. \nWe now develop an algebraic framework for studying such map-truncate-invert schemes.\n\nThe starting point is the quasi-shuffle algebra of Hoffman~\\cite{Hof}.\nThis gives an explicit description of the algebra of iterated integrals \nof the extended driving processes. Let $\\mathbb{RA}$ denote the \n$\\mathbb{R}$-linear span of $\\mathbb{A}$.\n\n\\begin{definition}[Quasi-shuffle product]\\label{qs defn}\nFor a given alphabet $\\mathbb{A}$, suppose \n$[\\,\\cdot\\,,\\,\\cdot\\,]\\colon\\mathbb{RA} \\otimes \\mathbb{RA} \\rightarrow \\mathbb{RA}$ \nis a commutative, associative product on $\\mathbb{RA}$. \nThe quasi-shuffle product \non $\\mathbb{R}\\langle \\mathbb{A}\\rangle$, which is commutative, \nis generated inductively as follows:\nif $\\mathbbold{1}$ is the empty word then $u*\\mathbbold{1}=\\mathbbold{1}*u=u$ and\n\n", "itemtype": "equation", "pos": 29445, "prevtext": " \nand iterating gives the separated expansion, \nwhere the operators $\\tilde{V}_a$ are those of \nthe stochastic Taylor expansion for $a\\in\\{0,1,\\ldots,d\\}$, \nand for $a=i^{(m)}$ are given by the $\\tilde{V}_{i^{(m)}}$ defined above.\nWe have thus just established the following result.\n\n\\begin{theorem}[Separated stochastic Taylor expansion: existence]\\label{mark taylor}\nFor a L\\'evy-driven equation suppose the terms $\\tilde V_w\\circ f$ in the stochastic\nTaylor expansion for the flowmap are analytic on $\\mathbb R^N$. Then it can \nbe written in separated form, i.e.\\/ as a separated stochastic Taylor expansion.\n\\end{theorem}\n\n\\begin{remark}[Linear vector fields and linear diffeomorphisms] \nThe separated expansion has a simple form when the governing vector\nfields are linear with constant coefficients and we consider the action of the flowmap \non homogeneous linear diffeomorphisms, say $f(y)=Fy$, where $F=[f_{ij}]$ is \nan $N\\times N$ matrix. The identity map is a special case of such a linear\ndiffeomorphism which generates the solution $y_t$ directly.\nIn this case, the operators in the expansion are given by matrix multiplication. \nWe write $V_i(y) = A^i y$, where $A^i=[a^i_{jk}]$ are constant $N\\times N$ matrices \nand consider the action of the flowmap on linear functions.\nFirst, for $i=1,\\ldots,d$ by direct computation we find $\\tilde{V}_i\\circ f(y)=FA^iy$.\nMoreover, for $i=d+1,\\ldots,\\ell$ the higher order differential operators \n$\\tilde{V}_{i^{(m)}}$ with $m\\geq 2$ vanish due to the linearity, and we obtain \n$(\\tilde{V}_{i}\\circ f)(y,v)=v(V_i\\cdot\\nabla)f(y)=vFA^iy$.\nThe above relation shows in addition that the term in \n$\\tilde{V}_0\\circ f$ involving an integral over the jump sizes vanishes. \nAs the functions we act on are linear, the second order terms of $\\tilde{V}_0$ also vanish. \nWe therefore have $\\tilde{V}_0\\circ f(y) = f(V_0(y)) = FA^0 y$. \nThe operators $\\tilde{V}_i$ act by matrix multiplication. \nIt follows that the operators $\\tilde{V}_w$ act on linear functions \nby matrix multiplication in the reverse order,\n$\\tilde{V}_{a_1\\ldots a_k}\\circ f(y) = F A^{a_k}\\cdots A^{a_1}y$.\n\\end{remark}\n\nHereafter we assume the existence of a separated Taylor expansion for the flowmap, \nand all iterated integrals are free iterated integrals.\n\n\n\\section{Convolution algebras and map-truncate-invert schemes}\\label{sec:convalg}\nWe now introduce a class of numerical integration schemes we call \nmap-truncate-invert schemes and show how they can be encoded algebraically. \nThe algebraic structures arise naturally from the products of iterated integrals \nand the composition of operators appearing in the separated stochastic Taylor expansion. \nConsider the class of numerical integration schemes obtained from \nthe stochastic Taylor expansion by simulating truncations of the expansion \non each subinterval of a uniform discretization of a given time domain $[0,T]$. \n\n\\begin{definition}[Grading function and truncations]\nA grading function $\\mathrm{g}\\colon\\mathbb{A}^*\\rightarrow\\mathbb{N}$ assigns\na positive integer to each non-empty word $w\\in\\mathbb{A}^*$ and zero to the empty word.\nA truncation is specified by a grading function and truncation value $n\\in\\mathbb{N}$. \nWe write $\\pi_{{\\mathrm{g}}=n}$, $\\pi_{{\\mathrm{g}}\\leq n}$ and $\\pi_{{\\mathrm{g}}\\geq n}$ for the projections of $\\mathbb{A}^*$ \nonto the following subsets: \n\\begin{enumerate}\n\\item $\\pi_{{\\mathrm{g}}=n}(\\mathbb{A}^*)\\coloneqq\\{w\\in\\mathbb{A}^*\\colon \\mathrm{g}(w)=n\\}$;\n\\item $\\pi_{{\\mathrm{g}}\\leq n}(\\mathbb{A}^*)\\coloneqq\\{w\\in\\mathbb{A}^*\\colon \\mathrm{g}(w)\\leq n\\}$; and\n\\item $\\pi_{{\\mathrm{g}}\\geq n}(\\mathbb{A}^*)\\coloneqq\\{w\\in\\mathbb{A}^*\\colon \\mathrm{g}(w)\\geq n\\}$.\n\\end{enumerate}\n\\end{definition}\n\nA numerical integration scheme based on the stochastic Taylor expansion is thus \ngiven by successive applications of the approximate flow\n\n", "index": 33, "text": "\\begin{equation*}\n\\sum_{w\\in\\pi_{{\\mathrm{g}}\\leq n}(\\mathbb{A}^*)} I_w(t) \\tilde{V}_w\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex18.m1\" class=\"ltx_Math\" alttext=\"\\sum_{w\\in\\pi_{{\\mathrm{g}}\\leq n}(\\mathbb{A}^{*})}I_{w}(t)\\tilde{V}_{w}\" display=\"block\"><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>w</mi><mo>\u2208</mo><mrow><msub><mi>\u03c0</mi><mrow><mi mathvariant=\"normal\">g</mi><mo>\u2264</mo><mi>n</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udd38</mi><mo>*</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></munder><mrow><msub><mi>I</mi><mi>w</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><mi>w</mi></msub></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nfor all words $u,v\\in\\mathbb{A}^*$ and letters $a,b\\in\\mathbb{A}$. \nHere $ua$ denotes the concatenation of $u$ and $a$. \n\\end{definition}\n\n\\begin{remark}[Word-to-integral isomorphism] \nThe word-to-integral map $\\mu\\colon w\\mapsto I_w$ \nis an algebra isomorphism. Here the domain is the vector space \n$\\mathbb{R}\\langle\\mathbb{A}\\rangle$ equipped with the quasi-shuffle product.\nIterated integrals indexed by polynomials are defined by linearity, i.e.\\/ \n$I_{k_u u + k_v v} = k_u I_{u} + k_v I_{v}$,\nfor any two constants $k_u,k_v\\in\\mathbb{R}$ and words $u,v\\in\\mathbb{A}^*$.\nThis was proved in Curry \\textit{et al.\\/}~\\cite{CEfMW}, it had already been\nestablished by Gaines \\cite{Gai} for drift-diffusions\nand by Li \\& Liu \\cite{LiLiu} for jump-diffusions. \n\\end{remark}\n\n\\begin{remark}[Shuffle product]\nThe quasi-shuffle product is a deformation of the shuffle product on \nthe vector space $\\mathbb{R}\\langle \\mathbb{A}\\rangle$ of polynomials \nin the non-commuting variables $\\mathbb{A}$. The deformation is induced \nby an additional product $[\\,\\cdot\\,,\\,\\cdot\\,]$ defined on $\\mathbb{RA}$. \nIf the product $[\\,\\cdot\\,,\\,\\cdot\\,]$ is trivial, \nthe quasi-shuffle product is just the shuffle product. \n\\end{remark}\n\n\\begin{remark}[Quadratic covariation bracket]\nHere we associate the additional product \n$[\\,\\cdot\\,,\\,\\cdot\\,]\\colon\\mathbb{RA}\\otimes\\mathbb{RA}\\rightarrow\\mathbb{RA}$ \nunderlying the quasi-shuffle with the pullback under the word-to-integral map $\\mu$ \nof the quadratic covariation bracket of semimartingales. \nExplicitly, $[0,a]$ is zero for all $a$, and\n$[i^{(p)},j^{(q)}] = \\delta_{ij} \\bigl(\\lambda(i,p,q)\\,\\cdot\\,0 \n+ \\big(1_{\\{d+1,\\ldots,\\ell\\}}(i)\\big)\\,\\cdot\\, i^{(p+q)}\\bigr)$,\nwhere $\\lambda(i,p,q)=1$ if $i\\in\\{1,\\ldots,d\\}$, \nand $\\lambda(i,p,q) = \\int_{\\mathbb{R}} v^{p+q} {\\rho}^i(\\mathrm{d}v)$ if $i\\in\\{d+1,\\ldots,\\ell\\}$. \nThe $0$ refers to the letter $0\\in\\mathbb{A}$, \nand $1_{\\{d+1,\\ldots,\\ell\\}}$ is the indicator function of the set $\\{d+1,\\ldots,\\ell\\}$. \n\\label{rmk:cov}\n\\end{remark}\n\n\\begin{remark}[Word-to-operator homomorphism]\nThe word-to-operator map denoted by $\\kappa\\colon w\\mapsto \\tilde{V}_w$ is an algebra homomorphism. \nHere the domain is $\\mathbb{R}\\langle\\mathbb{A}\\rangle$ equipped with the concatenation product. \nThis follows as $\\mathbb{R}\\langle\\mathbb{A}\\rangle$ equipped with the concatenation product \nis the free associative $\\mathbb{R}$-algebra over $\\mathbb{A}$, see Reutenauer~\\cite{Reu}, \nand each $\\tilde{V}_w$ is given by the associative composition of operators $\\tilde{V}_{a_i}$. \n\\end{remark}\n\nWe write $\\mathbb{R}\\langle\\mathbb{A}\\rangle_*$ for the quasi-shuffle algebra, \notherwise the product on $\\mathbb{R}\\langle\\mathbb{A}\\rangle$ is concatenation. \nThe preceding observations combine to give an encoding \nof integration schemes in the algebra \n$\\mathbb{R}\\langle\\mathbb{A}\\rangle_* \\overline{\\otimes}\\, \\mathbb{R}\\langle\\mathbb{A}\\rangle$, \nwhere $\\overline{\\otimes}$ is the completed tensor product of Reutenauer \\cite[p.~18, 29]{Reu}. \n\n\\begin{proposition}[Algebraic encoding of the flowmap]\\label{prop encoding}\nFor a given L\\'{e}vy-driven equation, the map \n$\\mu\\otimes\\kappa$ is a homomorphism from \n$\\mathbb{R}\\langle\\mathbb{A}\\rangle_* \\overline{\\otimes}\\, \\mathbb{R}\\langle\\mathbb{A}\\rangle$ \nto the tensor product of the algebra of iterated integrals \nof the extended driving processes and the composition algebra \ngenerated by the set of operators $\\tilde{V}_w$. \nMoreover, the flowmap of the equation is the image under $\\mu\\otimes\\kappa$ of the element\n\n", "itemtype": "equation", "pos": 31010, "prevtext": "\nacross the computational subintervals. \nNow more generally, consider a larger class of numerical schemes that are constructed as follows. \nFor a given invertible map $f\\colon\\mathrm{Diff}(\\mathbb{R}^N)\\rightarrow\\mathrm{Diff}(\\mathbb{R}^N$), \nwe construct a series expansion for $f(\\varphi_t)$ using the stochastic Taylor expansion for $\\varphi_t$. \nWe truncate the series and simulate the retained iterated It\\^o integrals across each\ncomputational subinterval. An integration scheme is obtained by \ncomputing the inverse map $f^{-1}$ of the simulated truncations at each step; \nsee Malham \\& Wiese~\\cite{MalWie} and Ebrahimi--Fard \\textit{et al.\\/ }~\\cite{EfLMMkW}. \nWe now develop an algebraic framework for studying such map-truncate-invert schemes.\n\nThe starting point is the quasi-shuffle algebra of Hoffman~\\cite{Hof}.\nThis gives an explicit description of the algebra of iterated integrals \nof the extended driving processes. Let $\\mathbb{RA}$ denote the \n$\\mathbb{R}$-linear span of $\\mathbb{A}$.\n\n\\begin{definition}[Quasi-shuffle product]\\label{qs defn}\nFor a given alphabet $\\mathbb{A}$, suppose \n$[\\,\\cdot\\,,\\,\\cdot\\,]\\colon\\mathbb{RA} \\otimes \\mathbb{RA} \\rightarrow \\mathbb{RA}$ \nis a commutative, associative product on $\\mathbb{RA}$. \nThe quasi-shuffle product \non $\\mathbb{R}\\langle \\mathbb{A}\\rangle$, which is commutative, \nis generated inductively as follows:\nif $\\mathbbold{1}$ is the empty word then $u*\\mathbbold{1}=\\mathbbold{1}*u=u$ and\n\n", "index": 35, "text": "\\begin{equation*}\nua*vb = (u*vb)a + (ua*v)b + (u*v)[a,b],\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex19.m1\" class=\"ltx_Math\" alttext=\"ua*vb=(u*vb)a+(ua*v)b+(u*v)[a,b],\" display=\"block\"><mrow><mrow><mrow><mrow><mrow><mi>u</mi><mo>\u2062</mo><mi>a</mi></mrow><mo>*</mo><mi>v</mi></mrow><mo>\u2062</mo><mi>b</mi></mrow><mo>=</mo><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mi>u</mi><mo>*</mo><mi>v</mi></mrow><mo>\u2062</mo><mi>b</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>a</mi></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mi>u</mi><mo>\u2062</mo><mi>a</mi></mrow><mo>*</mo><mi>v</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>b</mi></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>u</mi><mo>*</mo><mi>v</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy=\"false\">]</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\n\\end{proposition}\n\nTruncations of this abstract series representation in \n$\\mathbb{R}\\langle\\mathbb{A}\\rangle_*\\overline{\\otimes}\\,\\mathbb{R}\\langle\\mathbb{A}\\rangle$ \ngenerate approximations of the flowmap and hence classes \nof stochastic Taylor numerical integration schemes. \nUsing this context, we now construct an abstract representation for \n$f(\\varphi_t)$ for any given map \n$f\\colon\\mathrm{Diff}(\\mathbb R^N)\\to\\mathrm{Diff}(\\mathbb R^N)$ \nwhich is expressible as a power series. \nThe key idea is that $f(\\varphi_t)$ may be rewritten as the image under \n$\\mu\\otimes\\kappa$ of a series $\\sum F(w)\\otimes w$, \nwhere $F\\in\\mathrm{End}(\\mathbb{R}\\langle \\mathbb{A}\\rangle_*)$, \nthe space of $\\mathbb{R}$-linear maps from the quasi-shuffle algebra $\\mathbb{R}\\langle \\mathbb{A}\\rangle_*$ \nto itself; see Malham \\& Wiese~\\cite{MalWie} who established this in the shuffle product context. \nThe explicit form of $F\\in\\mathrm{End}(\\mathbb{R}\\langle \\mathbb{A}\\rangle_*)$ is obtained using the \nconvolution algebra associated to the quasi-shuffle product.\n\n\\begin{definition}[Quasi-shuffle convolution product]\nFor a given quasi-shuffle product $*$ on $\\mathbb{R}\\langle\\mathbb{A}\\rangle_*$, \nthe convolution product $\\star$ of $F$ and $G$ in \n$\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)$ is given by\n\n", "itemtype": "equation", "pos": 34630, "prevtext": "\nfor all words $u,v\\in\\mathbb{A}^*$ and letters $a,b\\in\\mathbb{A}$. \nHere $ua$ denotes the concatenation of $u$ and $a$. \n\\end{definition}\n\n\\begin{remark}[Word-to-integral isomorphism] \nThe word-to-integral map $\\mu\\colon w\\mapsto I_w$ \nis an algebra isomorphism. Here the domain is the vector space \n$\\mathbb{R}\\langle\\mathbb{A}\\rangle$ equipped with the quasi-shuffle product.\nIterated integrals indexed by polynomials are defined by linearity, i.e.\\/ \n$I_{k_u u + k_v v} = k_u I_{u} + k_v I_{v}$,\nfor any two constants $k_u,k_v\\in\\mathbb{R}$ and words $u,v\\in\\mathbb{A}^*$.\nThis was proved in Curry \\textit{et al.\\/}~\\cite{CEfMW}, it had already been\nestablished by Gaines \\cite{Gai} for drift-diffusions\nand by Li \\& Liu \\cite{LiLiu} for jump-diffusions. \n\\end{remark}\n\n\\begin{remark}[Shuffle product]\nThe quasi-shuffle product is a deformation of the shuffle product on \nthe vector space $\\mathbb{R}\\langle \\mathbb{A}\\rangle$ of polynomials \nin the non-commuting variables $\\mathbb{A}$. The deformation is induced \nby an additional product $[\\,\\cdot\\,,\\,\\cdot\\,]$ defined on $\\mathbb{RA}$. \nIf the product $[\\,\\cdot\\,,\\,\\cdot\\,]$ is trivial, \nthe quasi-shuffle product is just the shuffle product. \n\\end{remark}\n\n\\begin{remark}[Quadratic covariation bracket]\nHere we associate the additional product \n$[\\,\\cdot\\,,\\,\\cdot\\,]\\colon\\mathbb{RA}\\otimes\\mathbb{RA}\\rightarrow\\mathbb{RA}$ \nunderlying the quasi-shuffle with the pullback under the word-to-integral map $\\mu$ \nof the quadratic covariation bracket of semimartingales. \nExplicitly, $[0,a]$ is zero for all $a$, and\n$[i^{(p)},j^{(q)}] = \\delta_{ij} \\bigl(\\lambda(i,p,q)\\,\\cdot\\,0 \n+ \\big(1_{\\{d+1,\\ldots,\\ell\\}}(i)\\big)\\,\\cdot\\, i^{(p+q)}\\bigr)$,\nwhere $\\lambda(i,p,q)=1$ if $i\\in\\{1,\\ldots,d\\}$, \nand $\\lambda(i,p,q) = \\int_{\\mathbb{R}} v^{p+q} {\\rho}^i(\\mathrm{d}v)$ if $i\\in\\{d+1,\\ldots,\\ell\\}$. \nThe $0$ refers to the letter $0\\in\\mathbb{A}$, \nand $1_{\\{d+1,\\ldots,\\ell\\}}$ is the indicator function of the set $\\{d+1,\\ldots,\\ell\\}$. \n\\label{rmk:cov}\n\\end{remark}\n\n\\begin{remark}[Word-to-operator homomorphism]\nThe word-to-operator map denoted by $\\kappa\\colon w\\mapsto \\tilde{V}_w$ is an algebra homomorphism. \nHere the domain is $\\mathbb{R}\\langle\\mathbb{A}\\rangle$ equipped with the concatenation product. \nThis follows as $\\mathbb{R}\\langle\\mathbb{A}\\rangle$ equipped with the concatenation product \nis the free associative $\\mathbb{R}$-algebra over $\\mathbb{A}$, see Reutenauer~\\cite{Reu}, \nand each $\\tilde{V}_w$ is given by the associative composition of operators $\\tilde{V}_{a_i}$. \n\\end{remark}\n\nWe write $\\mathbb{R}\\langle\\mathbb{A}\\rangle_*$ for the quasi-shuffle algebra, \notherwise the product on $\\mathbb{R}\\langle\\mathbb{A}\\rangle$ is concatenation. \nThe preceding observations combine to give an encoding \nof integration schemes in the algebra \n$\\mathbb{R}\\langle\\mathbb{A}\\rangle_* \\overline{\\otimes}\\, \\mathbb{R}\\langle\\mathbb{A}\\rangle$, \nwhere $\\overline{\\otimes}$ is the completed tensor product of Reutenauer \\cite[p.~18, 29]{Reu}. \n\n\\begin{proposition}[Algebraic encoding of the flowmap]\\label{prop encoding}\nFor a given L\\'{e}vy-driven equation, the map \n$\\mu\\otimes\\kappa$ is a homomorphism from \n$\\mathbb{R}\\langle\\mathbb{A}\\rangle_* \\overline{\\otimes}\\, \\mathbb{R}\\langle\\mathbb{A}\\rangle$ \nto the tensor product of the algebra of iterated integrals \nof the extended driving processes and the composition algebra \ngenerated by the set of operators $\\tilde{V}_w$. \nMoreover, the flowmap of the equation is the image under $\\mu\\otimes\\kappa$ of the element\n\n", "index": 37, "text": "\\begin{equation*}\n\\sum_{w\\in \\mathbb{A}^*} w\\otimes w.\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex20.m1\" class=\"ltx_Math\" alttext=\"\\sum_{w\\in\\mathbb{A}^{*}}w\\otimes w.\" display=\"block\"><mrow><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>w</mi><mo>\u2208</mo><msup><mi>\ud835\udd38</mi><mo>*</mo></msup></mrow></munder><mrow><mi>w</mi><mo>\u2297</mo><mi>w</mi></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": " \nwhere $\\Delta$ is the deconcatenation coproduct that \nsends a word $w$ to the sum of all its two-partitions $u\\otimes v$,\ni.e.\\/ explicitly for any word $w\\in\\mathbb A^*$ we have \n$\\Delta(w)=\\sum_{uv=w}u\\otimes v$ and \n\n", "itemtype": "equation", "pos": -1, "prevtext": "\n\\end{proposition}\n\nTruncations of this abstract series representation in \n$\\mathbb{R}\\langle\\mathbb{A}\\rangle_*\\overline{\\otimes}\\,\\mathbb{R}\\langle\\mathbb{A}\\rangle$ \ngenerate approximations of the flowmap and hence classes \nof stochastic Taylor numerical integration schemes. \nUsing this context, we now construct an abstract representation for \n$f(\\varphi_t)$ for any given map \n$f\\colon\\mathrm{Diff}(\\mathbb R^N)\\to\\mathrm{Diff}(\\mathbb R^N)$ \nwhich is expressible as a power series. \nThe key idea is that $f(\\varphi_t)$ may be rewritten as the image under \n$\\mu\\otimes\\kappa$ of a series $\\sum F(w)\\otimes w$, \nwhere $F\\in\\mathrm{End}(\\mathbb{R}\\langle \\mathbb{A}\\rangle_*)$, \nthe space of $\\mathbb{R}$-linear maps from the quasi-shuffle algebra $\\mathbb{R}\\langle \\mathbb{A}\\rangle_*$ \nto itself; see Malham \\& Wiese~\\cite{MalWie} who established this in the shuffle product context. \nThe explicit form of $F\\in\\mathrm{End}(\\mathbb{R}\\langle \\mathbb{A}\\rangle_*)$ is obtained using the \nconvolution algebra associated to the quasi-shuffle product.\n\n\\begin{definition}[Quasi-shuffle convolution product]\nFor a given quasi-shuffle product $*$ on $\\mathbb{R}\\langle\\mathbb{A}\\rangle_*$, \nthe convolution product $\\star$ of $F$ and $G$ in \n$\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)$ is given by\n\n", "index": 39, "text": "\\begin{equation*}\nF\\star G \\coloneqq *\\circ(F\\otimes G)\\circ\\Delta,\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex21.m1\" class=\"ltx_Math\" alttext=\"F\\star G\\coloneqq*\\circ(F\\otimes G)\\circ\\Delta,\" display=\"block\"><mrow><mi>F</mi><mo>\u22c6</mo><mi>G</mi><mo>\u2254</mo><mo>*</mo><mo>\u2218</mo><mrow><mo stretchy=\"false\">(</mo><mi>F</mi><mo>\u2297</mo><mi>G</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2218</mo><mi mathvariant=\"normal\">\u0394</mi><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": " \n\\end{definition}\n\nThe quasi-shuffle algebra $\\mathbb{R}\\langle\\mathbb{A}\\rangle_*$ together \nwith the coproduct $\\Delta$ forms a bialgebra, see Hoffman~\\cite{Hof}. \nIn particular, when equipped with the convolution product, \nthe space $\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)$ becomes a unital algebra, \nwhere the unit $\\nu$ is given by the composition of the unit of the quasi-shuffle algebra \nand the counit of the deconcatenation coalgebra, see Abe \\cite{Abe}. \nExplicitly, $\\nu$ is the linear map that sends non-empty words to zero and the empty word to itself. \nWe define the embedding $\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)\n\\rightarrow\\mathbb{R}\\langle\\mathbb{A}\\rangle_*\\overline{\\otimes}\\,\\mathbb{R}\\langle\\mathbb{A}\\rangle$ \nby \n\n", "itemtype": "equation", "pos": -1, "prevtext": " \nwhere $\\Delta$ is the deconcatenation coproduct that \nsends a word $w$ to the sum of all its two-partitions $u\\otimes v$,\ni.e.\\/ explicitly for any word $w\\in\\mathbb A^*$ we have \n$\\Delta(w)=\\sum_{uv=w}u\\otimes v$ and \n\n", "index": 41, "text": "\\begin{equation*}\n\\bigl(F\\star G\\bigr)(w)=\\sum_{uv=w}F(u)*G(v).\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex22.m1\" class=\"ltx_Math\" alttext=\"\\bigl{(}F\\star G\\bigr{)}(w)=\\sum_{uv=w}F(u)*G(v).\" display=\"block\"><mrow><mrow><mrow><mrow><mo maxsize=\"120%\" minsize=\"120%\">(</mo><mrow><mi>F</mi><mo>\u22c6</mo><mi>G</mi></mrow><mo maxsize=\"120%\" minsize=\"120%\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>w</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mrow><mi>u</mi><mo>\u2062</mo><mi>v</mi></mrow><mo>=</mo><mi>w</mi></mrow></munder><mrow><mrow><mrow><mi>F</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>u</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>*</mo><mi>G</mi></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>v</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nThis is an algebra homomorphism for the quasi-shuffle convolution product;\nsee Reutenauer \\cite{Reu}, Curry~\\cite{Cur} \nand Ebrahimi--Fard \\textit{et al.\\/} \\cite{EfMPW2}.\nGiven a power series $f(x)=\\sum_{k\\geq0} c_k x^k$ with $c_k\\in\\mathbb{R}$, \nwe define the convolution power series $F^{\\star}(X) \\coloneqq \\sum_{k\\geq0} c_k X^{\\star k}$, \nwhere the $X^{\\star k}$ are the $k$th convolution powers of \n$X\\in\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)$. \nThe following representation of $f(\\varphi_t)$ is immediate.\n\n\\begin{proposition}[Convolution power series]\\label{conv ps}\nIf $f$ has a power series $f(x)=\\sum_{k\\geq0} c_k x^k$, we have \n\n", "itemtype": "equation", "pos": 37155, "prevtext": " \n\\end{definition}\n\nThe quasi-shuffle algebra $\\mathbb{R}\\langle\\mathbb{A}\\rangle_*$ together \nwith the coproduct $\\Delta$ forms a bialgebra, see Hoffman~\\cite{Hof}. \nIn particular, when equipped with the convolution product, \nthe space $\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)$ becomes a unital algebra, \nwhere the unit $\\nu$ is given by the composition of the unit of the quasi-shuffle algebra \nand the counit of the deconcatenation coalgebra, see Abe \\cite{Abe}. \nExplicitly, $\\nu$ is the linear map that sends non-empty words to zero and the empty word to itself. \nWe define the embedding $\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)\n\\rightarrow\\mathbb{R}\\langle\\mathbb{A}\\rangle_*\\overline{\\otimes}\\,\\mathbb{R}\\langle\\mathbb{A}\\rangle$ \nby \n\n", "index": 43, "text": "\\begin{equation*}\nF\\mapsto \\sum_{w\\in \\mathbb{A}^*} F(w)\\otimes w.\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex23.m1\" class=\"ltx_Math\" alttext=\"F\\mapsto\\sum_{w\\in\\mathbb{A}^{*}}F(w)\\otimes w.\" display=\"block\"><mrow><mrow><mi>F</mi><mo>\u21a6</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>w</mi><mo>\u2208</mo><msup><mi>\ud835\udd38</mi><mo>*</mo></msup></mrow></munder><mrow><mrow><mi>F</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>w</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2297</mo><mi>w</mi></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nIn other words we can represent $f(\\varphi_t)$ by $F^\\star({\\mathrm{id}})$.\nFurthermore, when the power series $f$ has an inverse \n$f^{-1}(x)=\\sum_{k\\geq0} b_k x^k$ with $b_k\\in\\mathbb{R}$, \nthe compositional inverse of the convolution power series for $F$ \nis given by the associated convolution power series $F^{-1}$. \n\\end{proposition}\n\nCombining the algebraic encoding of the flowmap\nin Proposition~\\ref{prop encoding} with \nProposition~\\ref{conv ps}, \nwe construct the map-truncate-invert scheme associated \nto a given power series $f$ as follows.\n\n\\begin{procedure}[Map-truncate-invert scheme]\nLet $f\\colon\\mathrm{Diff}(\\mathbb{R}^N)\\rightarrow\\mathrm{Diff}(\\mathbb{R}^N)$ \nbe an invertible map admitting an expansion as a power series. \nFor a given truncation function $\\pi_{{\\mathrm{g}}\\leq n}$, \nthe associated map-truncate-invert scheme across \na fixed computational interval $[0,t]$ is obtained as follows.\n\\begin{enumerate}\n\\item Construct the series $F^\\star({\\mathrm{id}})$;\n\\item Simulate the truncation $\\pi_{{\\mathrm{g}}\\leq n}\\circ F^\\star({\\mathrm{id}})$ given by\n\n", "itemtype": "equation", "pos": 37890, "prevtext": "\nThis is an algebra homomorphism for the quasi-shuffle convolution product;\nsee Reutenauer \\cite{Reu}, Curry~\\cite{Cur} \nand Ebrahimi--Fard \\textit{et al.\\/} \\cite{EfMPW2}.\nGiven a power series $f(x)=\\sum_{k\\geq0} c_k x^k$ with $c_k\\in\\mathbb{R}$, \nwe define the convolution power series $F^{\\star}(X) \\coloneqq \\sum_{k\\geq0} c_k X^{\\star k}$, \nwhere the $X^{\\star k}$ are the $k$th convolution powers of \n$X\\in\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)$. \nThe following representation of $f(\\varphi_t)$ is immediate.\n\n\\begin{proposition}[Convolution power series]\\label{conv ps}\nIf $f$ has a power series $f(x)=\\sum_{k\\geq0} c_k x^k$, we have \n\n", "index": 45, "text": "\\begin{equation*}\nf\\left(\\sum_{w\\in\\mathbb{A}^*} w\\otimes w\\right) \n=\\sum_{w\\in\\mathbb{A}^*} F^{\\star}({\\mathrm{id}})(w) \\otimes w .\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex24.m1\" class=\"ltx_Math\" alttext=\"f\\left(\\sum_{w\\in\\mathbb{A}^{*}}w\\otimes w\\right)=\\sum_{w\\in\\mathbb{A}^{*}}F^{%&#10;\\star}({\\mathrm{id}})(w)\\otimes w.\" display=\"block\"><mrow><mrow><mrow><mi>f</mi><mo>\u2062</mo><mrow><mo>(</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>w</mi><mo>\u2208</mo><msup><mi>\ud835\udd38</mi><mo>*</mo></msup></mrow></munder><mrow><mi>w</mi><mo>\u2297</mo><mi>w</mi></mrow></mrow><mo>)</mo></mrow></mrow><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>w</mi><mo>\u2208</mo><msup><mi>\ud835\udd38</mi><mo>*</mo></msup></mrow></munder><mrow><mrow><msup><mi>F</mi><mo>\u22c6</mo></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>id</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>w</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2297</mo><mi>w</mi></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\n\\item Compute the approximation $f^{-1}(\\hat{\\sigma}_t)\\circ y_0$.\n\\end{enumerate}\n\\end{procedure}\n\n\\begin{remark}\nIn $\\hat{\\sigma}_t$ in (ii) above: The identity map in $F^{\\star}({\\mathrm{id}})(w)$ is the \nidentity endomorphism in $\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)$,\nwhile the identity map in $\\tilde{V}_w({\\mathrm{id}})$ is the identity diffeomorphism\non $\\mathbb{R}^N$.\n\\end{remark}\n\n\\begin{remark}[Map-truncate-invert endomorphism]\nMap-truncate-invert schemes are realizations \nof the integration scheme associated to the endomorphism \n$F^{-1}\\circ\\pi_{{\\mathrm{g}}\\leq n}\\circ F^{\\star}({\\mathrm{id}})\\in\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle)$. \n\\end{remark}\n\nAn endomorphism which will prove useful in what follows is the augmented ideal projector.\n\n\\begin{definition}[Augmented ideal projector]\nThe augmented ideal projector denoted by ${\\mathfrak{J}}$ is given by ${\\mathfrak{J}}\\coloneqq{\\mathrm{id}}-\\nu$. \nIn other words, it acts as the identity on non-empty words, but sends the empty word to zero. \n\\end{definition}\n\n\\begin{example}[Exponential Lie series]\nRecall from the introduction that the motivating example \nof a map-truncate-invert scheme was the exponential Lie series integrator, \ncorresponding to $f=\\log$. For any endomorphism $X$ that maps the empty word to itself, \n$\\log^{\\star}(X)$ is a power series in $X-\\nu$. \nIn particular, we have \n$\\log^{\\star}({\\mathrm{id}})={\\mathfrak{J}}-{\\mathfrak{J}}^{\\star 2}/2+\\cdots+(-1)^{k+1}{\\mathfrak{J}}^{\\star k}/k+\\cdots$.\n\\end{example}\n\n\\begin{remark} \nFor any word $w$, say of length $k$, we can naturally truncate a series\nin convolutional powers of ${\\mathfrak{J}}$ with real coefficients $c_1$, $c_2$, $c_3$ and so forth, \nto $c_1{\\mathfrak{J}}+c_2{\\mathfrak{J}}^{\\star2}+\\cdots+c_k{\\mathfrak{J}}^{\\star k}$. This is because the action of \n${\\mathfrak{J}}^{\\star(k+1)}$ and subsequent terms in the series is, by convention, \nzero as a word of length $k$ cannot be partitioned into more than $k$ non-empty parts. \n\\end{remark}\n\nThe computation of $f^{-1} (\\hat{\\sigma}_t)$ from $\\hat{\\sigma}_t$ is in general non-trivial. \nFor the exponential Lie series integrator, \nCastell \\& Gaines \\cite{CasGai95,CasGai96} proposed computing $\\exp(\\hat{\\sigma}_t)(y_0)$ \nby numerical approximation of the ordinary differential equation \n$u'=\\hat{\\sigma}_t(u)$, subject to the initial condition $u(0)=y_0$. \nAn approximate solution may then be recovered from $u(1)$. \nFor the sinhlog integrator in the shuffle product context, Malham \\& Wiese \\cite{MalWie} \nshowed that for linear constant coefficient equations, since $\\hat{\\sigma}$ is a square matrix, \nthe approximate flow \n$\\exp\\sinh^{-1}(\\hat{\\sigma}_t)=\\hat{\\sigma}_t+\\bigl({\\mathrm{id}}+\\hat{\\sigma}^2_t\\bigr)^{1/2}$ \nmay be computed using a matrix square root. If the vector fields are nonlinear \nMalham \\& Wiese \\cite{MalWie} suggested expanding the square root to sufficiently  \nhigh degree terms. In \\textsection5 we introduce direct map-truncate-invert schemes\nwhich evaluate $F^{-1}\\circ\\pi_{{\\mathrm{g}}\\leq n}\\circ F^{\\star}({\\mathrm{id}})$ directly and circumvent\nthe step involving the computation of $f^{-1}$ in general.\n\n\n\\section{Endomorphism inner product, gradings and error analysis}\nWe establish convergence and accuracy of integration schemes at an algebraic level. \nWe first define an inner product on the space of endomorphisms corresponding \nto the $L^2$ inner product of the associated approximate flows. \nWe then define the mean-square grading and introduce stochastic Taylor\nschemes of a specific local and then global order. We subsequently consider \nword length grading. We show stochastic Taylor integration schemes of a \ngiven strong order obtained by truncating according to word length are always \nmore accurate than those obtained by truncating according to the mean-square grade. \nWe measure accuracy by the leading order term \nin the $L^2$-norm of the remainder after truncation. To start, to define the \nendomorphism inner product, we require an algebraic encoding of the expectation \nof the iterated integrals.\n\n\\begin{definition}[Expectation map]\\label{expectation}\nFor any word $w\\in\\mathbb{A}^*$, the expectation map \n$E\\colon \\mathbb{R}\\langle\\mathbb{A}\\rangle \\rightarrow \\mathbb{R}[t]$ is defined by\n$E\\colon w\\mapsto t^{|w|}/|w|!$ if $w\\in\\{0\\}^*$ and is zero for all other words. \nHere $|w|$ denotes the length of the word $w$, \n$\\{0\\}^*\\subset\\mathbb{A}^*$ is the free monoid over the letter $0$ \nand $\\mathbb{R}[t]$ is the polynomial ring \nover a single indeterminate $t$ commuting with $\\mathbb{R}$.\n\\end{definition}\n\n\\begin{remark}[Expectation of iterated It\\^o integrals]\nThe expectation map corresponds to the expectation of iterated It\\^o integrals\nas follows. First, integrals indexed by words not ending in the letter $0$ are martingales \nand hence have zero expectation. Second, consider integrals indexed by a word with \nat least one non-zero letter. Fubini's Theorem implies such integrals also have zero expectation; \nsee Protter~\\cite{Pro}. \n\\end{remark}\n\nWe now define an inner product on $\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)$, \nfollowing Ebrahimi--Fard \\textit{et al.\\/ } \\cite{EfLMMkW}.\nSuppose we apply two separate functions to the flowmap which are\ncharacterised by the endomorphisms $F$ and $G$ in \n$\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)$.\nThe stochastic processes generated by these \nfunctions of the flowmap, for given initial data $y_0$, are \n$\\sum_{w\\in\\mathbb A^*} I_{F(w)}\\tilde{V}_w(y_0)$ and $\\sum_{w\\in\\mathbb A^*}I_{G(w)}\\tilde{V}_w(y_0)$.\nOur goal is to define an inner product $\\langle F, G\\rangle$ \non $\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)$ \nwhich matches the $L^2$-inner product of these two vector-valued stochastic processes.\nHowever we would like all of our results to be independent of \nthe initial data $y_0$ and the governing vector fields appearing in the $\\tilde{V}_w$ terms. \nWe achieve this by replacing the vectors $\\tilde{V}_w(y_0)$ \nwith a set of indeterminate \nvectors indexed by words, $\\{\\mathbf{V}_w\\}_{w\\in \\mathbb{A}^*}$. \nWe write $(u,v)$ for the inner product of $\\mathbf{V}_u$ and $\\mathbf{V}_v$, \ni.e.\\/ $(u,v)\\coloneqq \\mathbf{V}_u^{\\mathrm{T}}\\,\\mathbf{V}_{v}$.\nLet $\\mathbf{V}$ denote the infinite square matrix indexed by the words $u,v\\in\\mathbb A^*$\nwith entries $(u,v)$.\n\n\\begin{definition}[Inner product]\\label{inner product 2}\nWe define the inner product of endomorphisms $F$ and $G$ in\n$\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)$ with respect to $\\mathbf{V}$ to be\n\n", "itemtype": "equation", "pos": 39122, "prevtext": "\nIn other words we can represent $f(\\varphi_t)$ by $F^\\star({\\mathrm{id}})$.\nFurthermore, when the power series $f$ has an inverse \n$f^{-1}(x)=\\sum_{k\\geq0} b_k x^k$ with $b_k\\in\\mathbb{R}$, \nthe compositional inverse of the convolution power series for $F$ \nis given by the associated convolution power series $F^{-1}$. \n\\end{proposition}\n\nCombining the algebraic encoding of the flowmap\nin Proposition~\\ref{prop encoding} with \nProposition~\\ref{conv ps}, \nwe construct the map-truncate-invert scheme associated \nto a given power series $f$ as follows.\n\n\\begin{procedure}[Map-truncate-invert scheme]\nLet $f\\colon\\mathrm{Diff}(\\mathbb{R}^N)\\rightarrow\\mathrm{Diff}(\\mathbb{R}^N)$ \nbe an invertible map admitting an expansion as a power series. \nFor a given truncation function $\\pi_{{\\mathrm{g}}\\leq n}$, \nthe associated map-truncate-invert scheme across \na fixed computational interval $[0,t]$ is obtained as follows.\n\\begin{enumerate}\n\\item Construct the series $F^\\star({\\mathrm{id}})$;\n\\item Simulate the truncation $\\pi_{{\\mathrm{g}}\\leq n}\\circ F^\\star({\\mathrm{id}})$ given by\n\n", "index": 47, "text": "\\begin{equation*}\n\\hat{\\sigma}_t\\coloneqq\\sum_{w\\in\\pi_{{\\mathrm{g}}\\leq n}(\\mathbb{A}^*)}I_{F^{\\star}({\\mathrm{id}})(w)}(t) \\tilde{V}_w({\\mathrm{id}}).\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex25.m1\" class=\"ltx_Math\" alttext=\"\\hat{\\sigma}_{t}\\coloneqq\\sum_{w\\in\\pi_{{\\mathrm{g}}\\leq n}(\\mathbb{A}^{*})}I_%&#10;{F^{\\star}({\\mathrm{id}})(w)}(t)\\tilde{V}_{w}({\\mathrm{id}}).\" display=\"block\"><mrow><mrow><msub><mover accent=\"true\"><mi>\u03c3</mi><mo stretchy=\"false\">^</mo></mover><mi>t</mi></msub><mo>\u2254</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>w</mi><mo>\u2208</mo><mrow><msub><mi>\u03c0</mi><mrow><mi mathvariant=\"normal\">g</mi><mo>\u2264</mo><mi>n</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udd38</mi><mo>*</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></munder><mrow><msub><mi>I</mi><mrow><msup><mi>F</mi><mo>\u22c6</mo></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>id</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>w</mi><mo stretchy=\"false\">)</mo></mrow></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><mi>w</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>id</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\n\\end{definition}\n\nAll results we subsequently establish will hold independent of $\\mathbf V$.\n\n\\begin{remark}[Positive definiteness]\nAs the operators $\\tilde{V}_i$ typically include second \n(or higher) order differential operators that send the identity map to zero, \ndistinct endomorphisms may be associated with the same stochastic process. \nFor linear constant coefficient equations for instance, \nthe operators $\\tilde{V}_{i^{(m)}}$ are zero operators for all $m>1$, \nand the stochastic process associated to any endomorphism is trivial if its image lies \nin the two-sided ideal in $\\mathbb{R}\\langle\\mathbb{A\\rangle_*}$ \ngenerated by the letters $i^{(m)}, m>1$. \nTo obtain positive definiteness of the inner product, \nwe pass to the quotient of $\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)$ \nunder the equivalence relation for which endomorphisms yielding the same \nstochastic process are equivalent. Positive definiteness on the quotient space \nfollows by similar arguments to those in Ebrahimi--Fard et al. \\cite{EfLMMkW}. \n\\end{remark}\n\nThe norm, in this quotient space, \nof an endomorphism $F\\in\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)$\nis $\\|F\\|\\coloneqq\\langle F, F\\rangle^{1/2}$.\n\nThe first part of our error analysis uses mean-square grading, \nsee Platen \\& Bruti-Liberati~\\cite{PlaBl}.\n\n\\begin{definition}[Mean-square grading]\nFor any word $w\\in\\mathbb A^*$, the map \n$\\mathrm{g}^{\\mathrm{ms}}\\colon w\\mapsto2\\zeta(w)+\\xi(w)$\nis the mean-square grading,\nwhere $\\zeta(w)$ and $\\xi(w)$ are the number of zero \nand non-zero letters in $w$, respectively.\n\\end{definition}\n\n\\begin{definition}[Reduced words]\nFor a given word $w$ the reduced word $\\mathrm{red}(w)$ is defined as the \nword obtained by deleting any zero letters, and replacing any \nletters of the form $i^{(m)}$ with $i$. \n\\end{definition}\n\n\\begin{example}\nIf $w=010024^{(3)}30$, we have $\\mathrm{red}(w)=1243$. \n\\end{example}\n\nThe following result will be useful in our subsequent error analysis,\nsee Kloeden \\& Platen~\\cite{KloPla}.\n\n\\begin{lemma}[Expectation of products]\\label{MSG lemma}\nLet $\\mathbb{R}\\langle\\mathbb{A}\\rangle_*$ be the quasi-shuffle algebra based on\nthe set of independent L\\'{e}vy processes $\\{t,W^1,\\ldots,W^d,J^{d+1},\\ldots,J^{\\ell}\\}$\nextended by covariation. \nFor any words $u,v\\in\\mathbb{A}^*$, if $\\mathrm{red}(u)=\\mathrm{red}(v)$ then \nthere is a non-zero constant $C=C(u,v)$ such that \n\n", "itemtype": "equation", "pos": 45861, "prevtext": "\n\\item Compute the approximation $f^{-1}(\\hat{\\sigma}_t)\\circ y_0$.\n\\end{enumerate}\n\\end{procedure}\n\n\\begin{remark}\nIn $\\hat{\\sigma}_t$ in (ii) above: The identity map in $F^{\\star}({\\mathrm{id}})(w)$ is the \nidentity endomorphism in $\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)$,\nwhile the identity map in $\\tilde{V}_w({\\mathrm{id}})$ is the identity diffeomorphism\non $\\mathbb{R}^N$.\n\\end{remark}\n\n\\begin{remark}[Map-truncate-invert endomorphism]\nMap-truncate-invert schemes are realizations \nof the integration scheme associated to the endomorphism \n$F^{-1}\\circ\\pi_{{\\mathrm{g}}\\leq n}\\circ F^{\\star}({\\mathrm{id}})\\in\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle)$. \n\\end{remark}\n\nAn endomorphism which will prove useful in what follows is the augmented ideal projector.\n\n\\begin{definition}[Augmented ideal projector]\nThe augmented ideal projector denoted by ${\\mathfrak{J}}$ is given by ${\\mathfrak{J}}\\coloneqq{\\mathrm{id}}-\\nu$. \nIn other words, it acts as the identity on non-empty words, but sends the empty word to zero. \n\\end{definition}\n\n\\begin{example}[Exponential Lie series]\nRecall from the introduction that the motivating example \nof a map-truncate-invert scheme was the exponential Lie series integrator, \ncorresponding to $f=\\log$. For any endomorphism $X$ that maps the empty word to itself, \n$\\log^{\\star}(X)$ is a power series in $X-\\nu$. \nIn particular, we have \n$\\log^{\\star}({\\mathrm{id}})={\\mathfrak{J}}-{\\mathfrak{J}}^{\\star 2}/2+\\cdots+(-1)^{k+1}{\\mathfrak{J}}^{\\star k}/k+\\cdots$.\n\\end{example}\n\n\\begin{remark} \nFor any word $w$, say of length $k$, we can naturally truncate a series\nin convolutional powers of ${\\mathfrak{J}}$ with real coefficients $c_1$, $c_2$, $c_3$ and so forth, \nto $c_1{\\mathfrak{J}}+c_2{\\mathfrak{J}}^{\\star2}+\\cdots+c_k{\\mathfrak{J}}^{\\star k}$. This is because the action of \n${\\mathfrak{J}}^{\\star(k+1)}$ and subsequent terms in the series is, by convention, \nzero as a word of length $k$ cannot be partitioned into more than $k$ non-empty parts. \n\\end{remark}\n\nThe computation of $f^{-1} (\\hat{\\sigma}_t)$ from $\\hat{\\sigma}_t$ is in general non-trivial. \nFor the exponential Lie series integrator, \nCastell \\& Gaines \\cite{CasGai95,CasGai96} proposed computing $\\exp(\\hat{\\sigma}_t)(y_0)$ \nby numerical approximation of the ordinary differential equation \n$u'=\\hat{\\sigma}_t(u)$, subject to the initial condition $u(0)=y_0$. \nAn approximate solution may then be recovered from $u(1)$. \nFor the sinhlog integrator in the shuffle product context, Malham \\& Wiese \\cite{MalWie} \nshowed that for linear constant coefficient equations, since $\\hat{\\sigma}$ is a square matrix, \nthe approximate flow \n$\\exp\\sinh^{-1}(\\hat{\\sigma}_t)=\\hat{\\sigma}_t+\\bigl({\\mathrm{id}}+\\hat{\\sigma}^2_t\\bigr)^{1/2}$ \nmay be computed using a matrix square root. If the vector fields are nonlinear \nMalham \\& Wiese \\cite{MalWie} suggested expanding the square root to sufficiently  \nhigh degree terms. In \\textsection5 we introduce direct map-truncate-invert schemes\nwhich evaluate $F^{-1}\\circ\\pi_{{\\mathrm{g}}\\leq n}\\circ F^{\\star}({\\mathrm{id}})$ directly and circumvent\nthe step involving the computation of $f^{-1}$ in general.\n\n\n\\section{Endomorphism inner product, gradings and error analysis}\nWe establish convergence and accuracy of integration schemes at an algebraic level. \nWe first define an inner product on the space of endomorphisms corresponding \nto the $L^2$ inner product of the associated approximate flows. \nWe then define the mean-square grading and introduce stochastic Taylor\nschemes of a specific local and then global order. We subsequently consider \nword length grading. We show stochastic Taylor integration schemes of a \ngiven strong order obtained by truncating according to word length are always \nmore accurate than those obtained by truncating according to the mean-square grade. \nWe measure accuracy by the leading order term \nin the $L^2$-norm of the remainder after truncation. To start, to define the \nendomorphism inner product, we require an algebraic encoding of the expectation \nof the iterated integrals.\n\n\\begin{definition}[Expectation map]\\label{expectation}\nFor any word $w\\in\\mathbb{A}^*$, the expectation map \n$E\\colon \\mathbb{R}\\langle\\mathbb{A}\\rangle \\rightarrow \\mathbb{R}[t]$ is defined by\n$E\\colon w\\mapsto t^{|w|}/|w|!$ if $w\\in\\{0\\}^*$ and is zero for all other words. \nHere $|w|$ denotes the length of the word $w$, \n$\\{0\\}^*\\subset\\mathbb{A}^*$ is the free monoid over the letter $0$ \nand $\\mathbb{R}[t]$ is the polynomial ring \nover a single indeterminate $t$ commuting with $\\mathbb{R}$.\n\\end{definition}\n\n\\begin{remark}[Expectation of iterated It\\^o integrals]\nThe expectation map corresponds to the expectation of iterated It\\^o integrals\nas follows. First, integrals indexed by words not ending in the letter $0$ are martingales \nand hence have zero expectation. Second, consider integrals indexed by a word with \nat least one non-zero letter. Fubini's Theorem implies such integrals also have zero expectation; \nsee Protter~\\cite{Pro}. \n\\end{remark}\n\nWe now define an inner product on $\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)$, \nfollowing Ebrahimi--Fard \\textit{et al.\\/ } \\cite{EfLMMkW}.\nSuppose we apply two separate functions to the flowmap which are\ncharacterised by the endomorphisms $F$ and $G$ in \n$\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)$.\nThe stochastic processes generated by these \nfunctions of the flowmap, for given initial data $y_0$, are \n$\\sum_{w\\in\\mathbb A^*} I_{F(w)}\\tilde{V}_w(y_0)$ and $\\sum_{w\\in\\mathbb A^*}I_{G(w)}\\tilde{V}_w(y_0)$.\nOur goal is to define an inner product $\\langle F, G\\rangle$ \non $\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)$ \nwhich matches the $L^2$-inner product of these two vector-valued stochastic processes.\nHowever we would like all of our results to be independent of \nthe initial data $y_0$ and the governing vector fields appearing in the $\\tilde{V}_w$ terms. \nWe achieve this by replacing the vectors $\\tilde{V}_w(y_0)$ \nwith a set of indeterminate \nvectors indexed by words, $\\{\\mathbf{V}_w\\}_{w\\in \\mathbb{A}^*}$. \nWe write $(u,v)$ for the inner product of $\\mathbf{V}_u$ and $\\mathbf{V}_v$, \ni.e.\\/ $(u,v)\\coloneqq \\mathbf{V}_u^{\\mathrm{T}}\\,\\mathbf{V}_{v}$.\nLet $\\mathbf{V}$ denote the infinite square matrix indexed by the words $u,v\\in\\mathbb A^*$\nwith entries $(u,v)$.\n\n\\begin{definition}[Inner product]\\label{inner product 2}\nWe define the inner product of endomorphisms $F$ and $G$ in\n$\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)$ with respect to $\\mathbf{V}$ to be\n\n", "index": 49, "text": "\\begin{equation*}\n \\langle F, G\\rangle \\coloneqq \\sum_{u,v\\in \\mathbb{A}^*}E(F(u)*G(v))\\, (u,v).\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex26.m1\" class=\"ltx_Math\" alttext=\"\\langle F,G\\rangle\\coloneqq\\sum_{u,v\\in\\mathbb{A}^{*}}E(F(u)*G(v))\\,(u,v).\" display=\"block\"><mrow><mrow><mrow><mo stretchy=\"false\">\u27e8</mo><mi>F</mi><mo>,</mo><mi>G</mi><mo stretchy=\"false\">\u27e9</mo></mrow><mo>\u2254</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mrow><mi>u</mi><mo>,</mo><mi>v</mi></mrow><mo>\u2208</mo><msup><mi>\ud835\udd38</mi><mo>*</mo></msup></mrow></munder><mrow><mi>E</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mrow><mi>F</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>u</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>*</mo><mi>G</mi></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>v</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\notherwise the expectation of the product $u*v$ is zero.\n\\end{lemma}\n\n\\begin{proof}\nLet $\\langle p,w\\rangle_{\\mathbb{R}\\langle\\mathbb{A}\\rangle}$ denote the \ncoefficient of a given word $w$ in the polynomial $p$. We then have\n\n", "itemtype": "equation", "pos": 48382, "prevtext": "\n\\end{definition}\n\nAll results we subsequently establish will hold independent of $\\mathbf V$.\n\n\\begin{remark}[Positive definiteness]\nAs the operators $\\tilde{V}_i$ typically include second \n(or higher) order differential operators that send the identity map to zero, \ndistinct endomorphisms may be associated with the same stochastic process. \nFor linear constant coefficient equations for instance, \nthe operators $\\tilde{V}_{i^{(m)}}$ are zero operators for all $m>1$, \nand the stochastic process associated to any endomorphism is trivial if its image lies \nin the two-sided ideal in $\\mathbb{R}\\langle\\mathbb{A\\rangle_*}$ \ngenerated by the letters $i^{(m)}, m>1$. \nTo obtain positive definiteness of the inner product, \nwe pass to the quotient of $\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)$ \nunder the equivalence relation for which endomorphisms yielding the same \nstochastic process are equivalent. Positive definiteness on the quotient space \nfollows by similar arguments to those in Ebrahimi--Fard et al. \\cite{EfLMMkW}. \n\\end{remark}\n\nThe norm, in this quotient space, \nof an endomorphism $F\\in\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)$\nis $\\|F\\|\\coloneqq\\langle F, F\\rangle^{1/2}$.\n\nThe first part of our error analysis uses mean-square grading, \nsee Platen \\& Bruti-Liberati~\\cite{PlaBl}.\n\n\\begin{definition}[Mean-square grading]\nFor any word $w\\in\\mathbb A^*$, the map \n$\\mathrm{g}^{\\mathrm{ms}}\\colon w\\mapsto2\\zeta(w)+\\xi(w)$\nis the mean-square grading,\nwhere $\\zeta(w)$ and $\\xi(w)$ are the number of zero \nand non-zero letters in $w$, respectively.\n\\end{definition}\n\n\\begin{definition}[Reduced words]\nFor a given word $w$ the reduced word $\\mathrm{red}(w)$ is defined as the \nword obtained by deleting any zero letters, and replacing any \nletters of the form $i^{(m)}$ with $i$. \n\\end{definition}\n\n\\begin{example}\nIf $w=010024^{(3)}30$, we have $\\mathrm{red}(w)=1243$. \n\\end{example}\n\nThe following result will be useful in our subsequent error analysis,\nsee Kloeden \\& Platen~\\cite{KloPla}.\n\n\\begin{lemma}[Expectation of products]\\label{MSG lemma}\nLet $\\mathbb{R}\\langle\\mathbb{A}\\rangle_*$ be the quasi-shuffle algebra based on\nthe set of independent L\\'{e}vy processes $\\{t,W^1,\\ldots,W^d,J^{d+1},\\ldots,J^{\\ell}\\}$\nextended by covariation. \nFor any words $u,v\\in\\mathbb{A}^*$, if $\\mathrm{red}(u)=\\mathrm{red}(v)$ then \nthere is a non-zero constant $C=C(u,v)$ such that \n\n", "index": 51, "text": "\\begin{equation*}\nE(u*v)=C(u,v)t^{(\\mathrm{g}^{\\mathrm{ms}}(u)+\\mathrm{g}^{\\mathrm{ms}}(v))/2},\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex27.m1\" class=\"ltx_Math\" alttext=\"E(u*v)=C(u,v)t^{(\\mathrm{g}^{\\mathrm{ms}}(u)+\\mathrm{g}^{\\mathrm{ms}}(v))/2},\" display=\"block\"><mrow><mrow><mrow><mi>E</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>u</mi><mo>*</mo><mi>v</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mi>C</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msup><mi>t</mi><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><msup><mi mathvariant=\"normal\">g</mi><mi>ms</mi></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>u</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><msup><mi mathvariant=\"normal\">g</mi><mi>ms</mi></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>v</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>/</mo><mn>2</mn></mrow></msup></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nConsider the generating relation of the quasi-shuffle product in Definition~\\ref{qs defn}, \nwhich states that $ua*vb = (u*vb)a + (ua*v)b + (u*v)[a,b]$.\nWe see that if a summand in the polynomial $ua*vb$ \nis to be a multiple of $w\\in\\{0\\}^*$, we require either $a=0$, $b=0$ or \n$\\langle[a,b],0\\rangle_{\\mathbb{R}\\langle\\mathbb{A}\\rangle}$ non-zero. \nAs the quadratic covariation of $t$ with any L\\'{e}vy process vanishes, \nall zero letters contribute to the expectation only through the first two terms in the \nquasi-shuffle generating relation above.\nIn contrast, non-zero letters $a$ and $b$ contribute only through the third term. \nWe see that each zero letter appears exactly once in any $w\\in\\{0\\}^*$ \nfor which $\\langle u*v,w\\rangle_{\\mathbb{R}\\langle\\mathbb{A}\\rangle}$ is non-zero, \nand any pair of non-zero letters $a,b$ contribute one letter together. \nIn particular, we have $E(u*v)=C(u,v) t^{(\\mathrm{g}^{\\mathrm{ms}}(u)+\\mathrm{g}^{\\mathrm{ms}}(v))/2}$, \nwhere $C(u,v)$ may equal zero. \n\nBy the independence of the driving processes, we have $[i,j]$, $[i^{(p)},j]$ and $[i^{(p)},j^{(q)}]$\nare all zero for all $i,j,p,q$, $i\\neq j$. Moreover, we have\n$[J^{i^{(p)}},J^{i^{(q)}}]_t = J^{i^{(p+q)}}_t + t\\int_{\\mathbb{R}} v^{p+q} {\\rho}^i(\\mathrm{d}v)$. \nIn particular, we have that $\\langle[i^{(p)},i^{(q)}],0\\rangle_{\\mathbb{R}\\langle\\mathbb{A}\\rangle}$ \nis non-zero for all $i>d$ and all $p,q\\geq 1$ for which $i^{(p)}$ and $i^{(q)}$ exist. \nMoreover, as $[W^i,W^i]_t=t$, we have $[i,i]=0$ for $i=1\\ldots,d$.\n\nThe expression $u*v$ is a linear combination of words, each of which arises \nfrom a choice of one of the three terms at each stage in the \ninductive quasi-shuffle generating relation.\nIndeed the $k$th letter in a given word thus obtained \nis the letter $a$, $b$ or $[a,b]$ chosen at the $k$th application of the inductive definition. \nFor this word to consist of only zeros, we must choose the first or the second term \nas long as either $a$ or $b$ is zero. When $a$ and $b$ are both non-zero, \nwe must choose the third term. From the preceding paragraph, \nthis will be a sum featuring a multiple of the zero letter provided \nboth letters are either equal to $i$, where $i=1,\\ldots,d$, \nor are $i^{(p)}$ and $i^{(q)}$ respectively for some $i>d$ and $p,q\\geq 1$. \nContinuing this procedure, we see that we will obtain a word comprising \nonly zeros if and only if the reduced words $\\mathrm{red}(u)$ and $\\mathrm{red}(v)$ are equal.\n\\qed\n\\end{proof}\n\nWe wish to compare the errors of different integration schemes across \na given time step at the algebraic level, using the inner product defined above. \nAs the flowmap corresponds to the identity in $\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)$, \nwe define the remainder endomorphism as follows.\n\n\\begin{definition}[Remainder endomorphism]\\label{remainder}\nFor any endomorphism $H\\in\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)$ \nencoding an approximation of the flowmap, we define the associated remainder endomorphism $R$ to be\n\n", "itemtype": "equation", "pos": 48719, "prevtext": "\notherwise the expectation of the product $u*v$ is zero.\n\\end{lemma}\n\n\\begin{proof}\nLet $\\langle p,w\\rangle_{\\mathbb{R}\\langle\\mathbb{A}\\rangle}$ denote the \ncoefficient of a given word $w$ in the polynomial $p$. We then have\n\n", "index": 53, "text": "\\begin{equation*}\nE(u*v)=\\sum_{w\\in\\{0\\}^*}\\langle u*v,w\\rangle_{\\mathbb{R}\\langle\\mathbb{A}\\rangle}\\frac{1}{|w|!}t^{|w|}.\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex28.m1\" class=\"ltx_Math\" alttext=\"E(u*v)=\\sum_{w\\in\\{0\\}^{*}}\\langle u*v,w\\rangle_{\\mathbb{R}\\langle\\mathbb{A}%&#10;\\rangle}\\frac{1}{|w|!}t^{|w|}.\" display=\"block\"><mrow><mrow><mrow><mi>E</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>u</mi><mo>*</mo><mi>v</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>w</mi><mo>\u2208</mo><msup><mrow><mo stretchy=\"false\">{</mo><mn>0</mn><mo stretchy=\"false\">}</mo></mrow><mo>*</mo></msup></mrow></munder><mrow><msub><mrow><mo stretchy=\"false\">\u27e8</mo><mrow><mi>u</mi><mo>*</mo><mi>v</mi></mrow><mo>,</mo><mi>w</mi><mo stretchy=\"false\">\u27e9</mo></mrow><mrow><mi>\u211d</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">\u27e8</mo><mi>\ud835\udd38</mi><mo stretchy=\"false\">\u27e9</mo></mrow></mrow></msub><mo>\u2062</mo><mfrac><mn>1</mn><mrow><mrow><mo stretchy=\"false\">|</mo><mi>w</mi><mo stretchy=\"false\">|</mo></mrow><mo lspace=\"0pt\" rspace=\"3.5pt\">!</mo></mrow></mfrac><mo>\u2062</mo><msup><mi>t</mi><mrow><mo stretchy=\"false\">|</mo><mi>w</mi><mo stretchy=\"false\">|</mo></mrow></msup></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\n\\end{definition}\n\n\\begin{example} \nA simple example is $H=\\pi_{{\\mathrm{g}}\\leq n}$ corresponding to \na stochastic Taylor expansion truncated according to a given grading `$\\mathrm{g}$'.\nIn this case $R={\\mathrm{id}}-\\pi_{{\\mathrm{g}}\\leq n}=\\pi_{{\\mathrm{g}}\\geq n+1}$. \nMore generally we might have $H=F^{-1}\\circ\\pi_{{\\mathrm{g}}\\leq n}\\circ F({\\mathrm{id}})$ so\n$R={\\mathrm{id}}-F^{-1}\\circ\\pi_{{\\mathrm{g}}\\leq n}\\circ F({\\mathrm{id}})$. \n\\end{example}\n\nFor the rest of this section we focus on numerical schemes constructed\nby truncating the stochastic Taylor expansion, first, according to mean-square\ngrading and, second, according to word length, grading.\nWe note the flowmap $\\varphi_t\\in L^2$, see Lemma~\\ref{flow lemmas}.\nLet $\\hat\\varphi_t^{\\mathrm{ms}}$ \ndenote the truncated stochastic Taylor expansion, truncated according to mean-square grading. \nWe denote the corresponding remainder by \n$R_t^{\\mathrm{ms}}\\coloneqq\\varphi_t-\\hat\\varphi_t^{\\mathrm{ms}}$\nand note $R_t^{\\mathrm{ms}}\\in L^2$, see Platen and Bruti--Liberati~\\cite{PlaBl}. \nLocally the numerical scheme is of mean-square order $n$ if \n\n", "itemtype": "equation", "pos": 51872, "prevtext": "\nConsider the generating relation of the quasi-shuffle product in Definition~\\ref{qs defn}, \nwhich states that $ua*vb = (u*vb)a + (ua*v)b + (u*v)[a,b]$.\nWe see that if a summand in the polynomial $ua*vb$ \nis to be a multiple of $w\\in\\{0\\}^*$, we require either $a=0$, $b=0$ or \n$\\langle[a,b],0\\rangle_{\\mathbb{R}\\langle\\mathbb{A}\\rangle}$ non-zero. \nAs the quadratic covariation of $t$ with any L\\'{e}vy process vanishes, \nall zero letters contribute to the expectation only through the first two terms in the \nquasi-shuffle generating relation above.\nIn contrast, non-zero letters $a$ and $b$ contribute only through the third term. \nWe see that each zero letter appears exactly once in any $w\\in\\{0\\}^*$ \nfor which $\\langle u*v,w\\rangle_{\\mathbb{R}\\langle\\mathbb{A}\\rangle}$ is non-zero, \nand any pair of non-zero letters $a,b$ contribute one letter together. \nIn particular, we have $E(u*v)=C(u,v) t^{(\\mathrm{g}^{\\mathrm{ms}}(u)+\\mathrm{g}^{\\mathrm{ms}}(v))/2}$, \nwhere $C(u,v)$ may equal zero. \n\nBy the independence of the driving processes, we have $[i,j]$, $[i^{(p)},j]$ and $[i^{(p)},j^{(q)}]$\nare all zero for all $i,j,p,q$, $i\\neq j$. Moreover, we have\n$[J^{i^{(p)}},J^{i^{(q)}}]_t = J^{i^{(p+q)}}_t + t\\int_{\\mathbb{R}} v^{p+q} {\\rho}^i(\\mathrm{d}v)$. \nIn particular, we have that $\\langle[i^{(p)},i^{(q)}],0\\rangle_{\\mathbb{R}\\langle\\mathbb{A}\\rangle}$ \nis non-zero for all $i>d$ and all $p,q\\geq 1$ for which $i^{(p)}$ and $i^{(q)}$ exist. \nMoreover, as $[W^i,W^i]_t=t$, we have $[i,i]=0$ for $i=1\\ldots,d$.\n\nThe expression $u*v$ is a linear combination of words, each of which arises \nfrom a choice of one of the three terms at each stage in the \ninductive quasi-shuffle generating relation.\nIndeed the $k$th letter in a given word thus obtained \nis the letter $a$, $b$ or $[a,b]$ chosen at the $k$th application of the inductive definition. \nFor this word to consist of only zeros, we must choose the first or the second term \nas long as either $a$ or $b$ is zero. When $a$ and $b$ are both non-zero, \nwe must choose the third term. From the preceding paragraph, \nthis will be a sum featuring a multiple of the zero letter provided \nboth letters are either equal to $i$, where $i=1,\\ldots,d$, \nor are $i^{(p)}$ and $i^{(q)}$ respectively for some $i>d$ and $p,q\\geq 1$. \nContinuing this procedure, we see that we will obtain a word comprising \nonly zeros if and only if the reduced words $\\mathrm{red}(u)$ and $\\mathrm{red}(v)$ are equal.\n\\qed\n\\end{proof}\n\nWe wish to compare the errors of different integration schemes across \na given time step at the algebraic level, using the inner product defined above. \nAs the flowmap corresponds to the identity in $\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)$, \nwe define the remainder endomorphism as follows.\n\n\\begin{definition}[Remainder endomorphism]\\label{remainder}\nFor any endomorphism $H\\in\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)$ \nencoding an approximation of the flowmap, we define the associated remainder endomorphism $R$ to be\n\n", "index": 55, "text": "\\begin{equation*}\nR\\coloneqq{\\mathrm{id}}-H.\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex29.m1\" class=\"ltx_Math\" alttext=\"R\\coloneqq{\\mathrm{id}}-H.\" display=\"block\"><mrow><mrow><mi>R</mi><mo>\u2254</mo><mrow><mi>id</mi><mo>-</mo><mi>H</mi></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nIn particular this implies, for sufficiently small $t$, that \n$\\|R_t^{\\mathrm{ms}}(y_0)\\|_{L^2}^2=(1+|y_0|^2)\\cdot\\mathcal O(t^{n+1})$ \nfor any initial data $y_0\\in\\mathbb R^N$.\nWe naturally apply the numerical scheme $\\hat\\varphi_t^{\\mathrm{ms}}$\nsuccessively over a suitably fine discretization of the global time interval\nof integration to obtain a suitably accurate numerical approximation. This \nmeans we need to determine the global order of convergence for such\na scheme. Milstein's Theorem \\cite{Mil,MilBook} provides a mechanism for \ninferring global convergence estimates from local ones in the case of \ndrift-diffusion equations. This can be extended to L\\'evy driven \nequations and is provided in Theorem~\\ref{mt conv} in \\textsection\\ref{glob}. \nWe call it the Generalized Milstein Theorem. To apply this theorem we\nrequire local expectation estimates for $R_t^{\\mathrm{ms}}(y_0)$.\nWe find that\n\n", "itemtype": "equation", "pos": 53049, "prevtext": "\n\\end{definition}\n\n\\begin{example} \nA simple example is $H=\\pi_{{\\mathrm{g}}\\leq n}$ corresponding to \na stochastic Taylor expansion truncated according to a given grading `$\\mathrm{g}$'.\nIn this case $R={\\mathrm{id}}-\\pi_{{\\mathrm{g}}\\leq n}=\\pi_{{\\mathrm{g}}\\geq n+1}$. \nMore generally we might have $H=F^{-1}\\circ\\pi_{{\\mathrm{g}}\\leq n}\\circ F({\\mathrm{id}})$ so\n$R={\\mathrm{id}}-F^{-1}\\circ\\pi_{{\\mathrm{g}}\\leq n}\\circ F({\\mathrm{id}})$. \n\\end{example}\n\nFor the rest of this section we focus on numerical schemes constructed\nby truncating the stochastic Taylor expansion, first, according to mean-square\ngrading and, second, according to word length, grading.\nWe note the flowmap $\\varphi_t\\in L^2$, see Lemma~\\ref{flow lemmas}.\nLet $\\hat\\varphi_t^{\\mathrm{ms}}$ \ndenote the truncated stochastic Taylor expansion, truncated according to mean-square grading. \nWe denote the corresponding remainder by \n$R_t^{\\mathrm{ms}}\\coloneqq\\varphi_t-\\hat\\varphi_t^{\\mathrm{ms}}$\nand note $R_t^{\\mathrm{ms}}\\in L^2$, see Platen and Bruti--Liberati~\\cite{PlaBl}. \nLocally the numerical scheme is of mean-square order $n$ if \n\n", "index": 57, "text": "\\begin{equation*}\nR_t^{\\mathrm{ms}}=\\sum_{w\\in\\pi_{{\\mathrm{g}}\\geq n+1}(\\mathbb{A}^*)}I_w(t)\\tilde V_w.\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex30.m1\" class=\"ltx_Math\" alttext=\"R_{t}^{\\mathrm{ms}}=\\sum_{w\\in\\pi_{{\\mathrm{g}}\\geq n+1}(\\mathbb{A}^{*})}I_{w}%&#10;(t)\\tilde{V}_{w}.\" display=\"block\"><mrow><mrow><msubsup><mi>R</mi><mi>t</mi><mi>ms</mi></msubsup><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>w</mi><mo>\u2208</mo><mrow><msub><mi>\u03c0</mi><mrow><mi mathvariant=\"normal\">g</mi><mo>\u2265</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udd38</mi><mo>*</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></munder><mrow><msub><mi>I</mi><mi>w</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><mi>w</mi></msub></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nHere we used that $E\\bigl(I_w(t)\\bigr)$ is only non-zero for words $w\\in\\{0\\}^*$. \nThe notation $0^k$ denotes such a word $w$ of length $k$, and $\\mathrm{g}^{\\mathrm{ms}}(0^k)=2k$. \nUsing the linear growth estimates we observe for some constant $K>0$ we have\n\n", "itemtype": "equation", "pos": 54078, "prevtext": "\nIn particular this implies, for sufficiently small $t$, that \n$\\|R_t^{\\mathrm{ms}}(y_0)\\|_{L^2}^2=(1+|y_0|^2)\\cdot\\mathcal O(t^{n+1})$ \nfor any initial data $y_0\\in\\mathbb R^N$.\nWe naturally apply the numerical scheme $\\hat\\varphi_t^{\\mathrm{ms}}$\nsuccessively over a suitably fine discretization of the global time interval\nof integration to obtain a suitably accurate numerical approximation. This \nmeans we need to determine the global order of convergence for such\na scheme. Milstein's Theorem \\cite{Mil,MilBook} provides a mechanism for \ninferring global convergence estimates from local ones in the case of \ndrift-diffusion equations. This can be extended to L\\'evy driven \nequations and is provided in Theorem~\\ref{mt conv} in \\textsection\\ref{glob}. \nWe call it the Generalized Milstein Theorem. To apply this theorem we\nrequire local expectation estimates for $R_t^{\\mathrm{ms}}(y_0)$.\nWe find that\n\n", "index": 59, "text": "\\begin{equation*}\nE\\bigl(R_t^{\\mathrm{ms}}(y_0)\\bigr)\n=\\sum_{k\\geq\\lfloor n/2\\rfloor+1}\\frac{t^{k}}{k!}\\tilde V_{0^k}(y_0).\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex31.m1\" class=\"ltx_Math\" alttext=\"E\\bigl{(}R_{t}^{\\mathrm{ms}}(y_{0})\\bigr{)}=\\sum_{k\\geq\\lfloor n/2\\rfloor+1}%&#10;\\frac{t^{k}}{k!}\\tilde{V}_{0^{k}}(y_{0}).\" display=\"block\"><mrow><mrow><mrow><mi>E</mi><mo>\u2062</mo><mrow><mo maxsize=\"120%\" minsize=\"120%\">(</mo><mrow><msubsup><mi>R</mi><mi>t</mi><mi>ms</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo maxsize=\"120%\" minsize=\"120%\">)</mo></mrow></mrow><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>k</mi><mo>\u2265</mo><mrow><mrow><mo stretchy=\"false\">\u230a</mo><mrow><mi>n</mi><mo>/</mo><mn>2</mn></mrow><mo stretchy=\"false\">\u230b</mo></mrow><mo>+</mo><mn>1</mn></mrow></mrow></munder><mrow><mfrac><msup><mi>t</mi><mi>k</mi></msup><mrow><mi>k</mi><mo lspace=\"0pt\" rspace=\"3.5pt\">!</mo></mrow></mfrac><mo>\u2062</mo><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><msup><mn>0</mn><mi>k</mi></msup></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nFor any finite $t$ the sum is convergent. In particular for small $t$ the upper bound\nis $\\mathcal O(t^{\\lfloor n/2\\rfloor+1})$. Recall from above that \n$\\|R_t^{\\mathrm{ms}}(y_0)\\|_{L^2}^2=(1+|y_0|^2)\\cdot\\mathcal O(t^{n+1})$. \nWe now refer to the Generalized Milstein Theorem~\\ref{mt conv} in \\textsection\\ref{glob}.\nMatching parameters we see that $p_1=\\lfloor n/2\\rfloor+1$ and $p_2=(n+1)/2$.\nThe theorem states that the approximation $\\hat\\varphi_t^{\\mathrm{ms}}$\nwith remainder $R_t^{\\mathrm{ms}}$ above will converge globally at rate $p_2-1/2$\nif $p_1\\geq p_2+1/2$. While this is true for when $n$ is even, it does \\emph{not} hold\nwhen $n$ is odd. This is simply due to the fact that pure deterministic terms in \nthe stochastic Taylor series remainder have a whole integer less \nroot mean-square global order of convergence compared to their local order of convergence.\nTo rectify this we can simply modify our scheme $\\hat\\varphi_t^{\\mathrm{ms}}$\nto \n\n", "itemtype": "equation", "pos": 54477, "prevtext": "\nHere we used that $E\\bigl(I_w(t)\\bigr)$ is only non-zero for words $w\\in\\{0\\}^*$. \nThe notation $0^k$ denotes such a word $w$ of length $k$, and $\\mathrm{g}^{\\mathrm{ms}}(0^k)=2k$. \nUsing the linear growth estimates we observe for some constant $K>0$ we have\n\n", "index": 61, "text": "\\begin{equation*}\n\\Bigl|E\\bigl(R_t^{\\mathrm{ms}}(y_0)\\bigr)\\Bigr|\n\\leq K\\,(1+|y_0|^2)^{1/2}\\,\\Biggl(\\sum_{k\\geq\\lfloor n/2\\rfloor+1}\\frac{t^{k}}{k!}\\Biggr).\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex32.m1\" class=\"ltx_Math\" alttext=\"\\Bigl{|}E\\bigl{(}R_{t}^{\\mathrm{ms}}(y_{0})\\bigr{)}\\Bigr{|}\\leq K\\,(1+|y_{0}|^%&#10;{2})^{1/2}\\,\\Biggl{(}\\sum_{k\\geq\\lfloor n/2\\rfloor+1}\\frac{t^{k}}{k!}\\Biggr{)}.\" display=\"block\"><mrow><mrow><mrow><mo fence=\"true\" maxsize=\"160%\" minsize=\"160%\">|</mo><mrow><mi>E</mi><mo>\u2062</mo><mrow><mo maxsize=\"120%\" minsize=\"120%\">(</mo><mrow><msubsup><mi>R</mi><mi>t</mi><mi>ms</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo maxsize=\"120%\" minsize=\"120%\">)</mo></mrow></mrow><mo fence=\"true\" maxsize=\"160%\" minsize=\"160%\">|</mo></mrow><mo>\u2264</mo><mrow><mpadded width=\"+1.7pt\"><mi>K</mi></mpadded><mo>\u2062</mo><mpadded width=\"+1.7pt\"><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>+</mo><msup><mrow><mo stretchy=\"false\">|</mo><msub><mi>y</mi><mn>0</mn></msub><mo stretchy=\"false\">|</mo></mrow><mn>2</mn></msup></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow></msup></mpadded><mo>\u2062</mo><mrow><mo maxsize=\"260%\" minsize=\"260%\">(</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>k</mi><mo>\u2265</mo><mrow><mrow><mo stretchy=\"false\">\u230a</mo><mrow><mi>n</mi><mo>/</mo><mn>2</mn></mrow><mo stretchy=\"false\">\u230b</mo></mrow><mo>+</mo><mn>1</mn></mrow></mrow></munder><mfrac><msup><mi>t</mi><mi>k</mi></msup><mrow><mi>k</mi><mo lspace=\"0pt\" rspace=\"3.5pt\">!</mo></mrow></mfrac></mrow><mo maxsize=\"260%\" minsize=\"260%\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nwhere $n^*\\coloneqq\\lfloor(n+1)/2\\rfloor$ if $n$ is odd and zero if it is even.\nThis means that the leading order deterministic term in $R_t^{\\mathrm{ms}}$\nis of the same order as previously when $n$ is even, but is of order\n$\\lfloor(n+1)/2\\rfloor+1=\\lfloor(n+3)/2\\rfloor$ when $n$ is odd. By inspection\nwe observe that $p_1\\geq p_2+1/2$ is now satisfied. The modified scheme $\\hat\\varphi_t^{\\mathrm{ms}}$\nabove has mean-square global order of convergence $n$ and the terms included\nexactly match those specified in Platen and Bruti--Liberati~\\cite[p.~290]{PlaBl}.\n\nWe now consider word length grading which we employ for our main result \nin the next section.\n\n\\begin{definition}[Word length grading]\nFor a given word $w\\in\\mathbb{A}^*$, the word length grading is denoted \n$|w|$ or $\\mathrm{g}^{\\mathrm{wl}}$, \nand defined to be the number of letters in $w$.\n\\end{definition}\n\n\\begin{remark}[Computational effort]\nThe bulk of the computation effort, when implementing accurate strong \nnumerical schemes derived from truncations of series representations of the flowmap, \nis associated with the simulation of the iterated integrals $I_w$.\nSee Lord, Malham and Wiese~\\cite{LMW} and Malham and Wiese~\\cite{MW} \nfor more details in the drift-diffusion case.\nIn particular the iterated integrals involving the most distinct \nnon-deterministic letters require the most effort.\nHence the additional computational cost required to simulate all \nthe iterated integrals $\\{I_w\\colon |w|\\leq n\\}$ as opposed to\nthe subset $\\{I(w)\\colon\\mathrm{g}^{\\mathrm{ms}}(w)\\leq n\\}$, is minimal. \n\\end{remark}\n\nOne benefit of truncating to word length as opposed to mean-square grading is \nthe following.\n\n\\begin{theorem}[Mean-square versus word length graded truncations]\\label{th:msvswo}\nConsider two approximate flowmaps arising from the truncation of the \nstochastic Taylor expansion, one using mean-square grading and the \nother using word length grading, both truncated at the same given grade $n$. \nThe $L^2$ norm of the leading order local flow remainder associated with the word length \napproximation is always less than that of the mean-square approximation.\n\\end{theorem}\n\n\\begin{proof}\nFirst, recall the definitions for the mean-square and word length gradings. \nWe observe for any word $w\\in\\mathbb A^*$ we have \n$\\mathrm{g}^{\\mathrm{ms}}(w)=2\\zeta(w)+\\xi(w)$ and $\\mathrm{g}^{\\mathrm{wl}}(w)=\\zeta(w)+\\xi(w)$.\nHence we have $\\mathrm{g}^{\\mathrm{wl}}\\leq\\mathrm{g}^{\\mathrm{ms}}$. This \nimplies that for any alphabet $\\mathbb A$ constructed from at least one deterministic \nand one non-deterministic letter, we have \n$\\pi_{\\mathrm{g}^{\\mathrm{ms}}\\leq n}\\bigl(\\mathbb A^*\\bigr)\n\\subset\\pi_{\\mathrm{g}^{\\mathrm{wl}}\\leq n}\\bigl(\\mathbb A^*\\bigr)$.\nThus correspondingly for their complements \n$\\pi_{\\mathrm{g}^{\\mathrm{wl}}\\geq n+1}\\bigl(\\mathbb A^*\\bigr)\n\\subset\\pi_{\\mathrm{g}^{\\mathrm{ms}}\\geq n+1}\\bigl(\\mathbb A^*\\bigr)$.\nSecond, let $R^{\\mathrm{ms}}$ and $R^{\\mathrm{wl}}$ denote the remainder endomorphisms\nassociated with truncating the stochastic Taylor expansion by mean-square\nand word length gradings, respectively. Hence for the inner products \n$\\langle R^{\\mathrm{ms}}, R^{\\mathrm{ms}}\\rangle$ and \n$\\langle R^{\\mathrm{wl}}, R^{\\mathrm{wl}}\\rangle$ we sum over words\nin $\\pi_{\\mathrm{g}^{\\mathrm{ms}}\\geq n+1}\\bigl(\\mathbb A^*\\bigr)$ and \n$\\pi_{\\mathrm{g}^{\\mathrm{wl}}\\geq n+1}\\bigl(\\mathbb A^*\\bigr)$, respectively.\nThe difference remainder endomorphism $\\hat R\\coloneqq R^{\\mathrm{ms}}-R^{\\mathrm{wl}}$\nis at leading order non-zero on words in \n$\\pi_{\\mathrm{g}^{\\mathrm{ms}}=n+1}\\bigl(\\mathbb A^*\\bigr)\n\\cap\\pi_{\\mathrm{g}^{\\mathrm{wl}}\\leq n}\\bigl(\\mathbb A^*\\bigr)$.\nFor any word $w$ in this set we have $2\\zeta(w)+\\xi(w)=n+1$ and $\\zeta(w)+\\xi(w)\\leq n$,\nwhich imply $\\zeta(w)>0$ and thus $\\xi(w)<n+1$. \nNow consider the inner product $\\langle R^{\\mathrm{wl}},\\hat R\\rangle$.\nAny word $u$ on which $R^{\\mathrm{wl}}$ is non-trivial at leading order has\nlength $\\zeta(u)+\\xi(u)\\geq n+1$. Any word $v$ on which $\\hat R$ is non-trivial at leading order,\nwe have just shown that $\\xi(v)<n+1$. Hence we must have $\\xi(u)\\neq \\xi(v)$ and so \n$\\mathrm{red}(u)\\neq\\mathrm{red}(v)$. We deduce that $\\langle R^{\\mathrm{wl}},\\hat R\\rangle$ is zero.\nThe result then follows from the relation \n$\\|R^{\\mathrm{ms}}\\|^2=\\|R^{\\mathrm{wl}}\\|^2+2\\langle\\hat R, R^{\\mathrm{wl}}\\rangle+\\|\\hat R\\|^2$.\nThis result holds whether we include the $0^{n^*}$ in $\\hat\\varphi_t^{\\mathrm{ms}}$ or not.\n\\qed\n\\end{proof}\n\n\n\n\\section{Antisymmetric sign reverse integrator}\nWe now present the error analysis of map-truncate-invert schemes, \nconcluding with the description of the antisymmetric sign reverse integrator \nand the main theorem concerning its efficiency. We also\npresent the direct map-truncate-invert schemes alluded to at the \nend of \\textsection3.\nWe begin by introducing the pre-remainder endomorphism associated \nto any map-truncate-invert scheme, that is the remainder terms associated \nto the truncation of the series $F^{\\star}({\\mathrm{id}})$. \nWe relate the pre-remainder and remainder of such schemes \nand use this relation to compute the inverse step of a direct map-truncate-invert scheme. \nWe follow with the introduction of the antisymmetric sign reverse integrator \nand its explicit characterization. We then prove our main theorem \non the efficiency of the antisymmetric sign reverse integrator.\n\n\\begin{definition}[Pre-remainder endomorphism]\nLet $F\\colon\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)\n\\rightarrow\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)$\nbe an invertible map and suppose $\\pi_{{\\mathrm{g}}\\leq n}$ is a projection corresponding to a truncation. \nThe pre-remainder endomorphism $Q$ associated \nto $\\pi_{{\\mathrm{g}}\\leq n}\\circ F({\\mathrm{id}})$ is defined by\n\n", "itemtype": "equation", "pos": 55608, "prevtext": "\nFor any finite $t$ the sum is convergent. In particular for small $t$ the upper bound\nis $\\mathcal O(t^{\\lfloor n/2\\rfloor+1})$. Recall from above that \n$\\|R_t^{\\mathrm{ms}}(y_0)\\|_{L^2}^2=(1+|y_0|^2)\\cdot\\mathcal O(t^{n+1})$. \nWe now refer to the Generalized Milstein Theorem~\\ref{mt conv} in \\textsection\\ref{glob}.\nMatching parameters we see that $p_1=\\lfloor n/2\\rfloor+1$ and $p_2=(n+1)/2$.\nThe theorem states that the approximation $\\hat\\varphi_t^{\\mathrm{ms}}$\nwith remainder $R_t^{\\mathrm{ms}}$ above will converge globally at rate $p_2-1/2$\nif $p_1\\geq p_2+1/2$. While this is true for when $n$ is even, it does \\emph{not} hold\nwhen $n$ is odd. This is simply due to the fact that pure deterministic terms in \nthe stochastic Taylor series remainder have a whole integer less \nroot mean-square global order of convergence compared to their local order of convergence.\nTo rectify this we can simply modify our scheme $\\hat\\varphi_t^{\\mathrm{ms}}$\nto \n\n", "index": 63, "text": "\\begin{equation*}\n\\hat\\varphi_t^{\\mathrm{ms}}\n=\\sum_{\\mathrm{g}^{\\mathrm{ms}}(w)\\leq n}I_w(t)\\tilde V_w+I_{0^{n^*}}(t)\\tilde V_{0^{n^*}},\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex33.m1\" class=\"ltx_Math\" alttext=\"\\hat{\\varphi}_{t}^{\\mathrm{ms}}=\\sum_{\\mathrm{g}^{\\mathrm{ms}}(w)\\leq n}I_{w}(%&#10;t)\\tilde{V}_{w}+I_{0^{n^{*}}}(t)\\tilde{V}_{0^{n^{*}}},\" display=\"block\"><mrow><mrow><msubsup><mover accent=\"true\"><mi>\u03c6</mi><mo stretchy=\"false\">^</mo></mover><mi>t</mi><mi>ms</mi></msubsup><mo>=</mo><mrow><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mrow><msup><mi mathvariant=\"normal\">g</mi><mi>ms</mi></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>w</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2264</mo><mi>n</mi></mrow></munder><mrow><msub><mi>I</mi><mi>w</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><mi>w</mi></msub></mrow></mrow><mo>+</mo><mrow><msub><mi>I</mi><msup><mn>0</mn><msup><mi>n</mi><mo>*</mo></msup></msup></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><msup><mn>0</mn><msup><mi>n</mi><mo>*</mo></msup></msup></msub></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": " \n\\end{definition}\n\nThis definition allows for more general maps $F$ than power series in the convolution algebra, \nwhich we require presently. The relationship between the pre-remainder and remainder \nis critical to the error analysis of map-truncate-invert schemes. \n\nHereafter we assume a grading $\\mathrm{g}$ which is preserved by \nthe quasi-shuffle product in question. By this we mean that \nfor all words $u,v\\in\\mathbb{A}^*$, the polynomial $u*v$ is homogeneous of degree \n$\\mathrm{g}(u)+\\mathrm{g}(v)$, i.e.\\/ it is a sum of words of grade \n$\\mathrm{g}(u)+\\mathrm{g}(v)$; see Ebrahimi--Fard et al. \\cite{EfLMMkW}.\nIn this case we observe that if $\\pi$ represents one of the projectors \n$\\pi_{{\\mathrm{g}}\\leq n}$, $\\pi_{{\\mathrm{g}}=n}$ or $\\pi_{{\\mathrm{g}}\\geq n}$\naccording to such a grading $\\mathrm{g}$,\nthen $\\pi\\circ {\\mathfrak{J}}^{\\star k}={\\mathfrak{J}}^{\\star k}\\circ \\pi$ \nfor any $k\\in\\mathbb N$. \n\n\\begin{remark}[Gradings preserved by quasi-shuffles]\nThe power bracket grading introduced in \nCurry \\textit{et al.\\/ } \\cite[Section~4]{CEfMW}, \ndefined on uncompensated brackets, is grading preserving for any quasi-shuffle. \nThis assigns the value 2 to the letter $0$, the value $1$ to letters $1,\\ldots,\\ell$, \nand the sum of the gradings for the quadratic covariation bracket between any two words. \nMean-square grading is preserved for drift-diffusions, however it is\nnot preserved in general for any quasi-shuffle containing discontinuous terms. \nImportantly, word length grading $\\mathrm{g}^{\\mathrm{wl}}$ is preserved when the \nquasi-shuffle product is in fact the shuffle product. This latter case will \nunderlie our eventual application below.\n\\end{remark}\n\n\\begin{lemma}[Remainder and pre-remainder relation]\\label{prerem conv lemm}\nSuppose $f(1+x)=\\sum_{k\\geq 1}c_k x^k$ is a power series with inverse \n$f^{-1}(x)=1+\\sum_{k\\geq 1}b_kx^k$, where necessarily $b_1\\equiv1/c_1$.\nLet $\\pi_{{\\mathrm{g}}\\leq n}$ be the projection according to\nthe grading preserved by the quasi-shuffle product.\nLet $R$ and $Q$ be the remainder and pre-remainder, respectively, \nassociated to the map-truncate-invert endomorphism \n$F^{-1}\\circ\\pi_{{\\mathrm{g}}\\leq n}\\circ F^{\\star}({\\mathrm{id}})$. Then we have \n\n", "itemtype": "equation", "pos": -1, "prevtext": "\nwhere $n^*\\coloneqq\\lfloor(n+1)/2\\rfloor$ if $n$ is odd and zero if it is even.\nThis means that the leading order deterministic term in $R_t^{\\mathrm{ms}}$\nis of the same order as previously when $n$ is even, but is of order\n$\\lfloor(n+1)/2\\rfloor+1=\\lfloor(n+3)/2\\rfloor$ when $n$ is odd. By inspection\nwe observe that $p_1\\geq p_2+1/2$ is now satisfied. The modified scheme $\\hat\\varphi_t^{\\mathrm{ms}}$\nabove has mean-square global order of convergence $n$ and the terms included\nexactly match those specified in Platen and Bruti--Liberati~\\cite[p.~290]{PlaBl}.\n\nWe now consider word length grading which we employ for our main result \nin the next section.\n\n\\begin{definition}[Word length grading]\nFor a given word $w\\in\\mathbb{A}^*$, the word length grading is denoted \n$|w|$ or $\\mathrm{g}^{\\mathrm{wl}}$, \nand defined to be the number of letters in $w$.\n\\end{definition}\n\n\\begin{remark}[Computational effort]\nThe bulk of the computation effort, when implementing accurate strong \nnumerical schemes derived from truncations of series representations of the flowmap, \nis associated with the simulation of the iterated integrals $I_w$.\nSee Lord, Malham and Wiese~\\cite{LMW} and Malham and Wiese~\\cite{MW} \nfor more details in the drift-diffusion case.\nIn particular the iterated integrals involving the most distinct \nnon-deterministic letters require the most effort.\nHence the additional computational cost required to simulate all \nthe iterated integrals $\\{I_w\\colon |w|\\leq n\\}$ as opposed to\nthe subset $\\{I(w)\\colon\\mathrm{g}^{\\mathrm{ms}}(w)\\leq n\\}$, is minimal. \n\\end{remark}\n\nOne benefit of truncating to word length as opposed to mean-square grading is \nthe following.\n\n\\begin{theorem}[Mean-square versus word length graded truncations]\\label{th:msvswo}\nConsider two approximate flowmaps arising from the truncation of the \nstochastic Taylor expansion, one using mean-square grading and the \nother using word length grading, both truncated at the same given grade $n$. \nThe $L^2$ norm of the leading order local flow remainder associated with the word length \napproximation is always less than that of the mean-square approximation.\n\\end{theorem}\n\n\\begin{proof}\nFirst, recall the definitions for the mean-square and word length gradings. \nWe observe for any word $w\\in\\mathbb A^*$ we have \n$\\mathrm{g}^{\\mathrm{ms}}(w)=2\\zeta(w)+\\xi(w)$ and $\\mathrm{g}^{\\mathrm{wl}}(w)=\\zeta(w)+\\xi(w)$.\nHence we have $\\mathrm{g}^{\\mathrm{wl}}\\leq\\mathrm{g}^{\\mathrm{ms}}$. This \nimplies that for any alphabet $\\mathbb A$ constructed from at least one deterministic \nand one non-deterministic letter, we have \n$\\pi_{\\mathrm{g}^{\\mathrm{ms}}\\leq n}\\bigl(\\mathbb A^*\\bigr)\n\\subset\\pi_{\\mathrm{g}^{\\mathrm{wl}}\\leq n}\\bigl(\\mathbb A^*\\bigr)$.\nThus correspondingly for their complements \n$\\pi_{\\mathrm{g}^{\\mathrm{wl}}\\geq n+1}\\bigl(\\mathbb A^*\\bigr)\n\\subset\\pi_{\\mathrm{g}^{\\mathrm{ms}}\\geq n+1}\\bigl(\\mathbb A^*\\bigr)$.\nSecond, let $R^{\\mathrm{ms}}$ and $R^{\\mathrm{wl}}$ denote the remainder endomorphisms\nassociated with truncating the stochastic Taylor expansion by mean-square\nand word length gradings, respectively. Hence for the inner products \n$\\langle R^{\\mathrm{ms}}, R^{\\mathrm{ms}}\\rangle$ and \n$\\langle R^{\\mathrm{wl}}, R^{\\mathrm{wl}}\\rangle$ we sum over words\nin $\\pi_{\\mathrm{g}^{\\mathrm{ms}}\\geq n+1}\\bigl(\\mathbb A^*\\bigr)$ and \n$\\pi_{\\mathrm{g}^{\\mathrm{wl}}\\geq n+1}\\bigl(\\mathbb A^*\\bigr)$, respectively.\nThe difference remainder endomorphism $\\hat R\\coloneqq R^{\\mathrm{ms}}-R^{\\mathrm{wl}}$\nis at leading order non-zero on words in \n$\\pi_{\\mathrm{g}^{\\mathrm{ms}}=n+1}\\bigl(\\mathbb A^*\\bigr)\n\\cap\\pi_{\\mathrm{g}^{\\mathrm{wl}}\\leq n}\\bigl(\\mathbb A^*\\bigr)$.\nFor any word $w$ in this set we have $2\\zeta(w)+\\xi(w)=n+1$ and $\\zeta(w)+\\xi(w)\\leq n$,\nwhich imply $\\zeta(w)>0$ and thus $\\xi(w)<n+1$. \nNow consider the inner product $\\langle R^{\\mathrm{wl}},\\hat R\\rangle$.\nAny word $u$ on which $R^{\\mathrm{wl}}$ is non-trivial at leading order has\nlength $\\zeta(u)+\\xi(u)\\geq n+1$. Any word $v$ on which $\\hat R$ is non-trivial at leading order,\nwe have just shown that $\\xi(v)<n+1$. Hence we must have $\\xi(u)\\neq \\xi(v)$ and so \n$\\mathrm{red}(u)\\neq\\mathrm{red}(v)$. We deduce that $\\langle R^{\\mathrm{wl}},\\hat R\\rangle$ is zero.\nThe result then follows from the relation \n$\\|R^{\\mathrm{ms}}\\|^2=\\|R^{\\mathrm{wl}}\\|^2+2\\langle\\hat R, R^{\\mathrm{wl}}\\rangle+\\|\\hat R\\|^2$.\nThis result holds whether we include the $0^{n^*}$ in $\\hat\\varphi_t^{\\mathrm{ms}}$ or not.\n\\qed\n\\end{proof}\n\n\n\n\\section{Antisymmetric sign reverse integrator}\nWe now present the error analysis of map-truncate-invert schemes, \nconcluding with the description of the antisymmetric sign reverse integrator \nand the main theorem concerning its efficiency. We also\npresent the direct map-truncate-invert schemes alluded to at the \nend of \\textsection3.\nWe begin by introducing the pre-remainder endomorphism associated \nto any map-truncate-invert scheme, that is the remainder terms associated \nto the truncation of the series $F^{\\star}({\\mathrm{id}})$. \nWe relate the pre-remainder and remainder of such schemes \nand use this relation to compute the inverse step of a direct map-truncate-invert scheme. \nWe follow with the introduction of the antisymmetric sign reverse integrator \nand its explicit characterization. We then prove our main theorem \non the efficiency of the antisymmetric sign reverse integrator.\n\n\\begin{definition}[Pre-remainder endomorphism]\nLet $F\\colon\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)\n\\rightarrow\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_*)$\nbe an invertible map and suppose $\\pi_{{\\mathrm{g}}\\leq n}$ is a projection corresponding to a truncation. \nThe pre-remainder endomorphism $Q$ associated \nto $\\pi_{{\\mathrm{g}}\\leq n}\\circ F({\\mathrm{id}})$ is defined by\n\n", "index": 65, "text": "\\begin{equation*}\nQ\\coloneqq F({\\mathrm{id}})-\\pi_{{\\mathrm{g}}\\leq n}\\circ F({\\mathrm{id}}).\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex34.m1\" class=\"ltx_Math\" alttext=\"Q\\coloneqq F({\\mathrm{id}})-\\pi_{{\\mathrm{g}}\\leq n}\\circ F({\\mathrm{id}}).\" display=\"block\"><mrow><mrow><mi>Q</mi><mo>\u2254</mo><mrow><mrow><mi>F</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>id</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mrow><msub><mi>\u03c0</mi><mrow><mi mathvariant=\"normal\">g</mi><mo>\u2264</mo><mi>n</mi></mrow></msub><mo>\u2218</mo><mi>F</mi></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>id</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\n\\end{lemma}\n\n\\begin{remark}[Higher order terms] \nThe notation `$\\mathrm{h.o.t.}$' in Lemma~\\ref{prerem conv lemm} \nis used to denote higher order terms in the following sense. Suppose our\ngoal is to apply the endomorphism $G^\\star({\\mathrm{id}})=C_1{\\mathfrak{J}}+C_2{\\mathfrak{J}}^{\\star2}+C_3{\\mathfrak{J}}^{\\star3}+\\cdots$\nto all words $w$ with $\\mathrm{g}(w)\\leq n$. \nIf we write $G^\\star({\\mathrm{id}})=C_1{\\mathfrak{J}}+\\cdots+C_n{\\mathfrak{J}}^{\\star n}+\\mathcal O(H)$,\nthis implies the endomorphism $H$ annihilates all words $w$ with $\\mathrm{g}(w)\\leq n$.\nIn this sense the term(s) in $\\mathcal O(H)$ represent higher order terms.\nFor example, suppose for a particular word $w$ we have $\\mathrm{g}(w)=n$.\nThe term ${\\mathfrak{J}}^{\\star(n+1)}$ splits $w$ into a sum of all its possible non-empty \n$(n+1)$-partitions quasi-shuffled together of the form $w_1*w_2*\\cdots*w_{n+1}$. \nSince the grading is preserved by the quasi-shuffle product, we have \n$\\mathrm{g}(w_1)+\\cdots+\\mathrm{g}(w_{n+1})=n$. However since \nthe partitions $w_i$ for all $i=1,\\ldots,n+1$ are all non-empty so that\n$\\mathrm{g}(w_i)\\geq1$, we have a contradiction. By convention\nwe suppose ${\\mathfrak{J}}^{\\star(n+1)}$ annihilates such a word $w$ and so ${\\mathfrak{J}}^{\\star(n+1)}$\nrepresents higher order term in the sense we have outlined.\n\\end{remark}\n\n\\begin{proof}\nWe set $P\\coloneqq \\pi_{{\\mathrm{g}}\\leq n}\\circ F^{\\star}({\\mathrm{id}})$. \nThen we see the pre-remainder $Q=\\pi_{{\\mathrm{g}}\\geq n+1}\\circ F^{\\star}({\\mathrm{id}})$ and \nthus also $P+Q=F^{\\star}({\\mathrm{id}})$. Third we observe that \n\n", "itemtype": "equation", "pos": 63889, "prevtext": " \n\\end{definition}\n\nThis definition allows for more general maps $F$ than power series in the convolution algebra, \nwhich we require presently. The relationship between the pre-remainder and remainder \nis critical to the error analysis of map-truncate-invert schemes. \n\nHereafter we assume a grading $\\mathrm{g}$ which is preserved by \nthe quasi-shuffle product in question. By this we mean that \nfor all words $u,v\\in\\mathbb{A}^*$, the polynomial $u*v$ is homogeneous of degree \n$\\mathrm{g}(u)+\\mathrm{g}(v)$, i.e.\\/ it is a sum of words of grade \n$\\mathrm{g}(u)+\\mathrm{g}(v)$; see Ebrahimi--Fard et al. \\cite{EfLMMkW}.\nIn this case we observe that if $\\pi$ represents one of the projectors \n$\\pi_{{\\mathrm{g}}\\leq n}$, $\\pi_{{\\mathrm{g}}=n}$ or $\\pi_{{\\mathrm{g}}\\geq n}$\naccording to such a grading $\\mathrm{g}$,\nthen $\\pi\\circ {\\mathfrak{J}}^{\\star k}={\\mathfrak{J}}^{\\star k}\\circ \\pi$ \nfor any $k\\in\\mathbb N$. \n\n\\begin{remark}[Gradings preserved by quasi-shuffles]\nThe power bracket grading introduced in \nCurry \\textit{et al.\\/ } \\cite[Section~4]{CEfMW}, \ndefined on uncompensated brackets, is grading preserving for any quasi-shuffle. \nThis assigns the value 2 to the letter $0$, the value $1$ to letters $1,\\ldots,\\ell$, \nand the sum of the gradings for the quadratic covariation bracket between any two words. \nMean-square grading is preserved for drift-diffusions, however it is\nnot preserved in general for any quasi-shuffle containing discontinuous terms. \nImportantly, word length grading $\\mathrm{g}^{\\mathrm{wl}}$ is preserved when the \nquasi-shuffle product is in fact the shuffle product. This latter case will \nunderlie our eventual application below.\n\\end{remark}\n\n\\begin{lemma}[Remainder and pre-remainder relation]\\label{prerem conv lemm}\nSuppose $f(1+x)=\\sum_{k\\geq 1}c_k x^k$ is a power series with inverse \n$f^{-1}(x)=1+\\sum_{k\\geq 1}b_kx^k$, where necessarily $b_1\\equiv1/c_1$.\nLet $\\pi_{{\\mathrm{g}}\\leq n}$ be the projection according to\nthe grading preserved by the quasi-shuffle product.\nLet $R$ and $Q$ be the remainder and pre-remainder, respectively, \nassociated to the map-truncate-invert endomorphism \n$F^{-1}\\circ\\pi_{{\\mathrm{g}}\\leq n}\\circ F^{\\star}({\\mathrm{id}})$. Then we have \n\n", "index": 67, "text": "\\begin{equation*}\nR=\\frac{1}{c_1}Q+\\mathrm{h.o.t.}.\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex35.m1\" class=\"ltx_Math\" alttext=\"R=\\frac{1}{c_{1}}Q+\\mathrm{h.o.t.}.\" display=\"block\"><mrow><mrow><mrow><mi>R</mi><mo>=</mo><mrow><mrow><mfrac><mn>1</mn><msub><mi>c</mi><mn>1</mn></msub></mfrac><mo>\u2062</mo><mi>Q</mi></mrow><mo>+</mo><mi mathvariant=\"normal\">h</mi></mrow></mrow><mo>.</mo><mi mathvariant=\"normal\">o</mi><mo>.</mo><mi mathvariant=\"normal\">t</mi></mrow><mo>.</mo><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nFourth, we have\n$P\\star Q=\\bigl(\\pi_{{\\mathrm{g}}\\leq n}\\circ F^{\\star}({\\mathrm{id}})\\bigr)\n\\star\\bigl(\\pi_{{\\mathrm{g}}\\geq n+1}\\circ F^{\\star}({\\mathrm{id}})\\bigr)$.\nSince $F^{\\star}({\\mathrm{id}})=c_1\\,{\\mathfrak{J}}+\\mathrm{h.o.t.}$ we get\n$P\\star Q=\\bigl(c_1\\,\\pi_{{\\mathrm{g}}\\leq n}\\circ {\\mathfrak{J}}\\bigr)\n\\star\\bigl(\\pi_{{\\mathrm{g}}\\geq n+1}\\circ(c_1\\,{\\mathfrak{J}}+\\cdots+c_{n+1}\\,{\\mathfrak{J}}^{\\star(n+1)})\\bigr)+\\mathrm{h.o.t.}$.\nHence we deduce that $P\\star Q$ annihilates any words of grade less than $n+2$.\nThus the term $b_2 P\\star Q$, as well as similarly $b_2\\, Q\\star P$, represent\nhigher order terms. Using that $b_1\\equiv1/c_1$ gives the result.\n\\qed\n\\end{proof}\n\nA similar calculation was used to establish efficiency of the sinhlog integrator \nin Ebrahimi--Fard et al. \\cite{EfLMMkW}. \nWe use it to compute the inverse step of a map-truncate-invert scheme as follows.\n\n\\begin{corollary}[Direct map-truncate-inverse schemes]\\label{inv corollary}\nSuppose  $f(1+x)=\\sum_{k\\geq 1}c_k x^k$ is an invertible power series\nand let $\\pi_{{\\mathrm{g}}\\leq n}$ be a truncation according to the grading preserved \nby the quasi-shuffle product. Then $F^{-1}\\circ \\pi_{{\\mathrm{g}}\\leq n}\\circ F^{\\star}({\\mathrm{id}})$,\nup to higher order terms, is given by\n\n", "itemtype": "equation", "pos": 65545, "prevtext": "\n\\end{lemma}\n\n\\begin{remark}[Higher order terms] \nThe notation `$\\mathrm{h.o.t.}$' in Lemma~\\ref{prerem conv lemm} \nis used to denote higher order terms in the following sense. Suppose our\ngoal is to apply the endomorphism $G^\\star({\\mathrm{id}})=C_1{\\mathfrak{J}}+C_2{\\mathfrak{J}}^{\\star2}+C_3{\\mathfrak{J}}^{\\star3}+\\cdots$\nto all words $w$ with $\\mathrm{g}(w)\\leq n$. \nIf we write $G^\\star({\\mathrm{id}})=C_1{\\mathfrak{J}}+\\cdots+C_n{\\mathfrak{J}}^{\\star n}+\\mathcal O(H)$,\nthis implies the endomorphism $H$ annihilates all words $w$ with $\\mathrm{g}(w)\\leq n$.\nIn this sense the term(s) in $\\mathcal O(H)$ represent higher order terms.\nFor example, suppose for a particular word $w$ we have $\\mathrm{g}(w)=n$.\nThe term ${\\mathfrak{J}}^{\\star(n+1)}$ splits $w$ into a sum of all its possible non-empty \n$(n+1)$-partitions quasi-shuffled together of the form $w_1*w_2*\\cdots*w_{n+1}$. \nSince the grading is preserved by the quasi-shuffle product, we have \n$\\mathrm{g}(w_1)+\\cdots+\\mathrm{g}(w_{n+1})=n$. However since \nthe partitions $w_i$ for all $i=1,\\ldots,n+1$ are all non-empty so that\n$\\mathrm{g}(w_i)\\geq1$, we have a contradiction. By convention\nwe suppose ${\\mathfrak{J}}^{\\star(n+1)}$ annihilates such a word $w$ and so ${\\mathfrak{J}}^{\\star(n+1)}$\nrepresents higher order term in the sense we have outlined.\n\\end{remark}\n\n\\begin{proof}\nWe set $P\\coloneqq \\pi_{{\\mathrm{g}}\\leq n}\\circ F^{\\star}({\\mathrm{id}})$. \nThen we see the pre-remainder $Q=\\pi_{{\\mathrm{g}}\\geq n+1}\\circ F^{\\star}({\\mathrm{id}})$ and \nthus also $P+Q=F^{\\star}({\\mathrm{id}})$. Third we observe that \n\n", "index": 69, "text": "\\begin{align*}\nR&=F^{-1}(P+Q)-F^{-1}(P) \\\\\n&=\\sum_{k\\geq 1} b_k\\,\\bigl((P+Q)^{\\star k}-P^{\\star k}\\bigr)\\\\ \n&=b_1\\,Q+b_2\\,(P\\star Q+Q\\star P)+\\mathrm{h.o.t.}.\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex36.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle R\" display=\"inline\"><mi>R</mi></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex36.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=F^{-1}(P+Q)-F^{-1}(P)\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mrow><msup><mi>F</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>P</mi><mo>+</mo><mi>Q</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><msup><mi>F</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>P</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex37.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\sum_{k\\geq 1}b_{k}\\,\\bigl{(}(P+Q)^{\\star k}-P^{\\star k}\\bigr{)}\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>k</mi><mo>\u2265</mo><mn>1</mn></mrow></munder></mstyle><mrow><mpadded width=\"+1.7pt\"><msub><mi>b</mi><mi>k</mi></msub></mpadded><mo>\u2062</mo><mrow><mo maxsize=\"120%\" minsize=\"120%\">(</mo><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>P</mi><mo>+</mo><mi>Q</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mi/><mo>\u22c6</mo><mi>k</mi></mrow></msup><mo>-</mo><msup><mi>P</mi><mrow><mi/><mo>\u22c6</mo><mi>k</mi></mrow></msup></mrow><mo maxsize=\"120%\" minsize=\"120%\">)</mo></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex38.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=b_{1}\\,Q+b_{2}\\,(P\\star Q+Q\\star P)+\\mathrm{h.o.t.}.\" display=\"inline\"><mrow><mrow><mrow><mi/><mo>=</mo><mrow><mrow><mpadded width=\"+1.7pt\"><msub><mi>b</mi><mn>1</mn></msub></mpadded><mo>\u2062</mo><mi>Q</mi></mrow><mo>+</mo><mrow><mpadded width=\"+1.7pt\"><msub><mi>b</mi><mn>2</mn></msub></mpadded><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mi>P</mi><mo>\u22c6</mo><mi>Q</mi></mrow><mo>+</mo><mrow><mi>Q</mi><mo>\u22c6</mo><mi>P</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mi mathvariant=\"normal\">h</mi></mrow></mrow><mo>.</mo><mi mathvariant=\"normal\">o</mi><mo>.</mo><mi mathvariant=\"normal\">t</mi></mrow><mo>.</mo><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\n\\end{corollary}\n\n\\begin{proof}\nStarting with the definition of the remainder endomorphism $R$, and then\nsubsequently using our results above, we observe\n\n", "itemtype": "equation", "pos": 66992, "prevtext": "\nFourth, we have\n$P\\star Q=\\bigl(\\pi_{{\\mathrm{g}}\\leq n}\\circ F^{\\star}({\\mathrm{id}})\\bigr)\n\\star\\bigl(\\pi_{{\\mathrm{g}}\\geq n+1}\\circ F^{\\star}({\\mathrm{id}})\\bigr)$.\nSince $F^{\\star}({\\mathrm{id}})=c_1\\,{\\mathfrak{J}}+\\mathrm{h.o.t.}$ we get\n$P\\star Q=\\bigl(c_1\\,\\pi_{{\\mathrm{g}}\\leq n}\\circ {\\mathfrak{J}}\\bigr)\n\\star\\bigl(\\pi_{{\\mathrm{g}}\\geq n+1}\\circ(c_1\\,{\\mathfrak{J}}+\\cdots+c_{n+1}\\,{\\mathfrak{J}}^{\\star(n+1)})\\bigr)+\\mathrm{h.o.t.}$.\nHence we deduce that $P\\star Q$ annihilates any words of grade less than $n+2$.\nThus the term $b_2 P\\star Q$, as well as similarly $b_2\\, Q\\star P$, represent\nhigher order terms. Using that $b_1\\equiv1/c_1$ gives the result.\n\\qed\n\\end{proof}\n\nA similar calculation was used to establish efficiency of the sinhlog integrator \nin Ebrahimi--Fard et al. \\cite{EfLMMkW}. \nWe use it to compute the inverse step of a map-truncate-invert scheme as follows.\n\n\\begin{corollary}[Direct map-truncate-inverse schemes]\\label{inv corollary}\nSuppose  $f(1+x)=\\sum_{k\\geq 1}c_k x^k$ is an invertible power series\nand let $\\pi_{{\\mathrm{g}}\\leq n}$ be a truncation according to the grading preserved \nby the quasi-shuffle product. Then $F^{-1}\\circ \\pi_{{\\mathrm{g}}\\leq n}\\circ F^{\\star}({\\mathrm{id}})$,\nup to higher order terms, is given by\n\n", "index": 71, "text": "\\begin{equation*}\n\\pi_{{\\mathrm{g}}\\leq n}+\\pi_{{\\mathrm{g}}=n+1}\\circ\\Bigl({\\mathfrak{J}}-\\frac{1}{c_1}F^\\star({\\mathrm{id}})\\Bigr).\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex39.m1\" class=\"ltx_Math\" alttext=\"\\pi_{{\\mathrm{g}}\\leq n}+\\pi_{{\\mathrm{g}}=n+1}\\circ\\Bigl{(}{\\mathfrak{J}}-%&#10;\\frac{1}{c_{1}}F^{\\star}({\\mathrm{id}})\\Bigr{)}.\" display=\"block\"><mrow><mrow><msub><mi>\u03c0</mi><mrow><mi mathvariant=\"normal\">g</mi><mo>\u2264</mo><mi>n</mi></mrow></msub><mo>+</mo><mrow><msub><mi>\u03c0</mi><mrow><mi mathvariant=\"normal\">g</mi><mo>=</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></mrow></msub><mo>\u2218</mo><mrow><mo maxsize=\"160%\" minsize=\"160%\">(</mo><mrow><mi>\ud835\udd0d</mi><mo>-</mo><mrow><mfrac><mn>1</mn><msub><mi>c</mi><mn>1</mn></msub></mfrac><mo>\u2062</mo><msup><mi>F</mi><mo>\u22c6</mo></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>id</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo maxsize=\"160%\" minsize=\"160%\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nIn the last step we used that ${\\mathfrak{J}}$ is the identity on non-empty words.\n\\qed\n\\end{proof}\n\n\\begin{remark}[Direct map-truncate-invert in practice]\\label{mti just}\nNote that using the power series representation for $F^{\\star}({\\mathrm{id}})$\nthe direct map-truncate-inverse scheme in Corollary~\\ref{inv corollary} is given by\n\n", "itemtype": "equation", "pos": 67295, "prevtext": "\n\\end{corollary}\n\n\\begin{proof}\nStarting with the definition of the remainder endomorphism $R$, and then\nsubsequently using our results above, we observe\n\n", "index": 73, "text": "\\begin{align*}\nF^{-1}\\circ \\pi_{{\\mathrm{g}}\\leq n}\\circ F^{\\star}({\\mathrm{id}})\n&={\\mathrm{id}}-R\\\\\n&=\\pi_{{\\mathrm{g}}\\leq n}+\\pi_{{\\mathrm{g}}\\geq n+1}-\\frac{1}{c_1}Q+\\mathrm{h.o.t.}\\\\\n&=\\pi_{{\\mathrm{g}}\\leq n}+\\pi_{{\\mathrm{g}}\\geq n+1}\\circ\\Bigl({\\mathrm{id}}-\\frac{1}{c_1}\\,F^{\\star}({\\mathrm{id}})\\Bigr)+\\mathrm{h.o.t.}\\\\\n&=\\pi_{{\\mathrm{g}}\\leq n}+\\pi_{{\\mathrm{g}}=n+1}\\circ\\Bigl({\\mathfrak{J}}-\\frac{1}{c_1}\\,F^{\\star}({\\mathrm{id}})\\Bigr)+\\mathrm{h.o.t.}.\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex40.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle F^{-1}\\circ\\pi_{{\\mathrm{g}}\\leq n}\\circ F^{\\star}({\\mathrm{id}})\" display=\"inline\"><mrow><mrow><msup><mi>F</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2218</mo><msub><mi>\u03c0</mi><mrow><mi mathvariant=\"normal\">g</mi><mo>\u2264</mo><mi>n</mi></mrow></msub><mo>\u2218</mo><msup><mi>F</mi><mo>\u22c6</mo></msup></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>id</mi><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex40.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle={\\mathrm{id}}-R\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mi>id</mi><mo>-</mo><mi>R</mi></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex41.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\pi_{{\\mathrm{g}}\\leq n}+\\pi_{{\\mathrm{g}}\\geq n+1}-\\frac{1}{c_{%&#10;1}}Q+\\mathrm{h.o.t.}\" display=\"inline\"><mrow><mrow><mrow><mi/><mo>=</mo><mrow><mrow><mrow><msub><mi>\u03c0</mi><mrow><mi mathvariant=\"normal\">g</mi><mo>\u2264</mo><mi>n</mi></mrow></msub><mo>+</mo><msub><mi>\u03c0</mi><mrow><mi mathvariant=\"normal\">g</mi><mo>\u2265</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></mrow></msub></mrow><mo>-</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><msub><mi>c</mi><mn>1</mn></msub></mfrac></mstyle><mo>\u2062</mo><mi>Q</mi></mrow></mrow><mo>+</mo><mi mathvariant=\"normal\">h</mi></mrow></mrow><mo>.</mo><mi mathvariant=\"normal\">o</mi><mo>.</mo><mi mathvariant=\"normal\">t</mi></mrow><mo>.</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex42.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\pi_{{\\mathrm{g}}\\leq n}+\\pi_{{\\mathrm{g}}\\geq n+1}\\circ\\Bigl{(}%&#10;{\\mathrm{id}}-\\frac{1}{c_{1}}\\,F^{\\star}({\\mathrm{id}})\\Bigr{)}+\\mathrm{h.o.t.}\" display=\"inline\"><mrow><mrow><mrow><mi/><mo>=</mo><mrow><msub><mi>\u03c0</mi><mrow><mi mathvariant=\"normal\">g</mi><mo>\u2264</mo><mi>n</mi></mrow></msub><mo>+</mo><mrow><msub><mi>\u03c0</mi><mrow><mi mathvariant=\"normal\">g</mi><mo>\u2265</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></mrow></msub><mo>\u2218</mo><mrow><mo maxsize=\"160%\" minsize=\"160%\">(</mo><mrow><mi>id</mi><mo>-</mo><mrow><mpadded width=\"+1.7pt\"><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><msub><mi>c</mi><mn>1</mn></msub></mfrac></mstyle></mpadded><mo>\u2062</mo><msup><mi>F</mi><mo>\u22c6</mo></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>id</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo maxsize=\"160%\" minsize=\"160%\">)</mo></mrow></mrow><mo>+</mo><mi mathvariant=\"normal\">h</mi></mrow></mrow><mo>.</mo><mi mathvariant=\"normal\">o</mi><mo>.</mo><mi mathvariant=\"normal\">t</mi></mrow><mo>.</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex43.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\pi_{{\\mathrm{g}}\\leq n}+\\pi_{{\\mathrm{g}}=n+1}\\circ\\Bigl{(}{%&#10;\\mathfrak{J}}-\\frac{1}{c_{1}}\\,F^{\\star}({\\mathrm{id}})\\Bigr{)}+\\mathrm{h.o.t.}.\" display=\"inline\"><mrow><mrow><mrow><mi/><mo>=</mo><mrow><msub><mi>\u03c0</mi><mrow><mi mathvariant=\"normal\">g</mi><mo>\u2264</mo><mi>n</mi></mrow></msub><mo>+</mo><mrow><msub><mi>\u03c0</mi><mrow><mi mathvariant=\"normal\">g</mi><mo>=</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></mrow></msub><mo>\u2218</mo><mrow><mo maxsize=\"160%\" minsize=\"160%\">(</mo><mrow><mi>\ud835\udd0d</mi><mo>-</mo><mrow><mpadded width=\"+1.7pt\"><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><msub><mi>c</mi><mn>1</mn></msub></mfrac></mstyle></mpadded><mo>\u2062</mo><msup><mi>F</mi><mo>\u22c6</mo></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>id</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo maxsize=\"160%\" minsize=\"160%\">)</mo></mrow></mrow><mo>+</mo><mi mathvariant=\"normal\">h</mi></mrow></mrow><mo>.</mo><mi mathvariant=\"normal\">o</mi><mo>.</mo><mi mathvariant=\"normal\">t</mi></mrow><mo>.</mo><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nWe observe in this formula the action of direct map-truncate-invert schemes.\nWe simulate the corresponding truncated stochastic Taylor scheme represented by \n$\\pi_{{\\mathrm{g}}\\leq n}$ and add the corresponding additional terms shown. \nNote the additional terms ${\\mathfrak{J}}^{\\star 2}$, ${\\mathfrak{J}}^{\\star 3}$ and so forth only \ninvolve products over lower order multiple It\\^o integrals that have already \nbeen simulated in $\\pi_{{\\mathrm{g}}\\leq n}$.\nFor instance, for a word $w$ with $\\mathrm{g}(w)=n+1$, the term ${\\mathfrak{J}}^{\\star 2}(w)$ is the \nsum of all products of It\\^o integrals of the form $I_uI_v$ with non-empty\nwords $u$ and $v$ such that $uv=w$ and using grade preservation, $\\mathrm{g}(u)+\\mathrm{g}(v)=n+1$. \nIn particular $\\mathrm{g}(u)\\leq n$ and $\\mathrm{g}(v)\\leq n$, so $I_u$ and $I_v$ are already\nincluded in $\\pi_{{\\mathrm{g}}\\leq n}$. The question arises as to whether a given \ndirect map-truncate-inverse scheme converges.\nFor the integrator we construct presently, this will be an automatic consequence of\nthe convergence of the corresponding stochastic Taylor integrator according to \nword length grading.\n\\end{remark}\n\nWe turn our attention to establishing our main result concerning \nan efficient integrator for equations driven by L\\'{e}vy processes.\nFor convenience we introduce the following bracketing notation for\nthe bracket $[\\,\\cdot\\,,\\,\\cdot\\,]$ in the quasi-shuffle product. \nFor letters $a$ we set $[a]\\coloneqq a$, while for words \n$w=a_1\\ldots a_k$ we set $[w]\\coloneqq [a_1,[a_2,\\ldots,[a_{k-1},a_k]\\ldots]]$. \nThe commutativity of the bracket means the order of the letters $a_i$\nis irrelevant and then its associativity means that all $k$-fold brackets\nare equivalent to the canonical form of left-to-right bracketing shown. \n\n\\begin{definition}[Reversal, sign reversal and quasi-shuffle antipode endomorphisms]\nWe define three endomorphisms on $\\mathbb{R}\\langle\\mathbb{A}\\rangle$ as follows. If \n$a_i\\in\\mathbb A$ for $i=1,\\ldots,n$ are letters, then we define the:\n\\begin{enumerate}\n\\item Reversal map: $|S|\\colon a_1\\ldots a_n\\mapsto a_n\\ldots a_1$;\n\\item Sign reversal map: $S\\colon a_1\\ldots a_n\\mapsto (-1)^n a_n\\ldots a_1$; and\n\\item Quasi-shuffle antipode: $\\hat S\\colon a_1\\ldots a_n\\mapsto(-1)^n\\sum [u_1]\\,[u_2]\\ldots[u_k]$,\n\\end{enumerate}\nwhere for the quasi-shuffle antipode the sum is over all possible factorizations of \n$a_n\\ldots a_1=u_1u_2\\ldots u_k$ into non-empty subwords $u_i$ for all $k=1,\\ldots,n$.\n\\end{definition}\n\n\\begin{remark}[Antipode and quasi-shuffle Hopf algebra]\nThe quasi-shuffle antipode is the quasi-shuffle convolution reciprocal\nmap of the identity, i.e.\\/ ${\\mathrm{id}}\\star\\hat S=\\hat S\\star{\\mathrm{id}}=\\nu$. Indeed, \nwith this in hand, the quasi-shuffle algebra $\\mathbb{R}\\langle\\mathbb{A}\\rangle_*$, \nwith deconcatenation $\\Delta$ as coproduct, is also a Hopf algebra. These results\nwere proved by Hoffman~\\cite{Hof}.\n\\end{remark}\n\n\\begin{remark}\nFor the shuffle algebra where the bracket $[\\,\\cdot\\,,\\,\\cdot\\,]$ is trivial, \nwe have $\\hat{S}=S$. \n\\end{remark}\n\nMalham \\& Wiese \\cite{MalWie} and Ebrahimi--Fard et al.~\\cite{EfLMMkW} considered \ndrift-diffusion equations interpreted in the Stratonovich sense---which \ncorresponds to the shuffle product case. The scheme of main interest therein\nwas the map-truncate-invert integration scheme generated from the map $f=\\mathrm{sinhlog}$.\nThe shuffle convolution power series associated to the series \n$f(1+x)=\\mathrm{sinhlog}(1+x)=x+\\frac{1}{2}\\sum_{k\\geq2} (-1)^{k-1} x^k$ \nis expressible in the form  $F^{\\scriptsize{}}(X)=\\frac{1}{2}(X-X^{\\scriptsize{}(-1)})$. \nHere ${}$ represents the convolution product corresponding to the shuffle product. \nIn the shuffle case, ${\\mathrm{id}}{} S=S{}{\\mathrm{id}}=\\nu$ and we therefore have the identity \n$\\mathrm{sinhlog}^{\\scriptsize{}}({\\mathrm{id}}) = \\frac{1}{2}({\\mathrm{id}} - S)$, \nand similarly $\\mathrm{coshlog}^{\\scriptsize{}}({\\mathrm{id}})=\\frac{1}{2}({\\mathrm{id}} + S)$. \nThe efficiency results of Malham \\& Wiese \\cite{MalWie} \nand Ebrahimi--Fard et al.~\\cite{EfLMMkW} \nfor the sinhlog integrator rely on the identity\n$\\langle\\!\\langle\\pi_{{\\mathrm{g}}=n}\\circ\\mathrm{sinhlog}^{\\scriptsize{}}({\\mathrm{id}}),\n\\pi_{{\\mathrm{g}}=n}\\circ\\mathrm{coshlog}^{\\scriptsize{}}({\\mathrm{id}})\\rangle\\!\\rangle=0$.\nHere $\\langle\\!\\langle\\,\\cdot\\,,\\,\\cdot\\,\\rangle\\!\\rangle$ is an inner product on \n$\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_{\\scriptsize{}})$ \nsimilar to $\\langle\\,\\cdot\\,,\\,\\cdot\\,\\rangle$\nbut where the underlying expectation map differs \ndue to the use of Stratonovich integrals. \nThe above result utilizes the shuffle algebra structure \nof multiple Stratonovich integrals with respect to \ncontinuous semimartingale integrators. \nTo obtain an appropriate extension of the sinhlog integrator \nto L\\'{e}vy-driven equations, we broaden our definition \nof map-truncate-invert schemes. \nIn particular, we introduce the antisymmetric sign reverse integrator \nas follows.\n\n\\begin{definition}[Antisymmetric sign reverse integrator]\nThe antisymmetric sign reverse integrator is the direct map-truncate-invert scheme \nassociated with $\\frac{1}{2}({\\mathrm{id}} - S)$, with truncation according to word length.\n\\end{definition}\n\n\\begin{remark} \nWe cannot in general give an expression for $\\frac{1}{2}({\\mathrm{id}} - S)$ as a convolution power series \nin ${\\mathfrak{J}}$ in any quasi-shuffle convolution algebra with non-trivial bracket. \nTo see this, compare the action of $S$ and a map \n$\\alpha {\\mathfrak{J}}+\\beta {\\mathfrak{J}}^{\\star 2}$ on a general word of length two. We see that\n$S(ab) = ba$ and the identity \n$(\\alpha {\\mathfrak{J}} + \\beta {\\mathfrak{J}}^{\\star 2})(ab) = (\\alpha+\\beta)ab+\\beta ba+\\beta[a,b]$.\nComparing these two expressions, we see that $-\\alpha=\\beta=1$, \nand that $[a,b]=0$ for all $a,b$. This implies that $[\\,\\cdot\\,,\\,\\cdot\\,]$ must be trivial. \n\\end{remark}\n\nThe following representation generates a practical implementation of the antisymmetric \nsign reverse integrator. In particular, it includes the inverse step. \n\n\\begin{lemma}[Direct representation of the antisymmetric sign reverse integrator]\\label{direct rep}\nThe antisymmetric sign reverse integrator is given by \n\n", "itemtype": "equation", "pos": 68112, "prevtext": "\nIn the last step we used that ${\\mathfrak{J}}$ is the identity on non-empty words.\n\\qed\n\\end{proof}\n\n\\begin{remark}[Direct map-truncate-invert in practice]\\label{mti just}\nNote that using the power series representation for $F^{\\star}({\\mathrm{id}})$\nthe direct map-truncate-inverse scheme in Corollary~\\ref{inv corollary} is given by\n\n", "index": 75, "text": "\\begin{multline*}\n\\pi_{{\\mathrm{g}}\\leq n}-\\frac{1}{c_1}\\pi_{{\\mathrm{g}}=n+1}\\circ\\bigl(c_2{\\mathfrak{J}}^{\\star 2}+c_3{\\mathfrak{J}}^{\\star 3}+\\cdots\\bigr)\\\\\n=\\pi_{{\\mathrm{g}}\\leq n}-\\frac{1}{c_1}\\bigl(c_2{\\mathfrak{J}}^{\\star 2}+\\cdots+c_{n+1}{\\mathfrak{J}}^{\\star(n+1)}\\bigr)\\circ\\pi_{{\\mathrm{g}}=n+1}.\n\\end{multline*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"p38.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\pi_{{\\mathrm{g}}\\leq n}-\\frac{1}{c_{1}}\\pi_{{\\mathrm{g}}=n+1}%&#10;\\circ\\bigl{(}c_{2}{\\mathfrak{J}}^{\\star 2}+c_{3}{\\mathfrak{J}}^{\\star 3}+%&#10;\\cdots\\bigr{)}\\\\&#10;\\displaystyle=\\pi_{{\\mathrm{g}}\\leq n}-\\frac{1}{c_{1}}\\bigl{(}c_{2}{\\mathfrak{%&#10;J}}^{\\star 2}+\\cdots+c_{n+1}{\\mathfrak{J}}^{\\star(n+1)}\\bigr{)}\\circ\\pi_{{%&#10;\\mathrm{g}}=n+1}.\" display=\"block\"><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><msub><mi>\u03c0</mi><mrow><mi mathvariant=\"normal\">g</mi><mo>\u2264</mo><mi>n</mi></mrow></msub><mo>-</mo><mrow><mrow><mfrac><mn>1</mn><msub><mi>c</mi><mn>1</mn></msub></mfrac><mo>\u2062</mo><msub><mi>\u03c0</mi><mrow><mi mathvariant=\"normal\">g</mi><mo>=</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></mrow></msub></mrow><mo>\u2218</mo><mrow><mo maxsize=\"120%\" minsize=\"120%\">(</mo><mrow><mrow><msub><mi>c</mi><mn>2</mn></msub><mo>\u2062</mo><msup><mi>\ud835\udd0d</mi><mrow><mi/><mo>\u22c6</mo><mn>2</mn></mrow></msup></mrow><mo>+</mo><mrow><msub><mi>c</mi><mn>3</mn></msub><mo>\u2062</mo><msup><mi>\ud835\udd0d</mi><mrow><mi/><mo>\u22c6</mo><mn>3</mn></mrow></msup></mrow><mo>+</mo><mi mathvariant=\"normal\">\u22ef</mi></mrow><mo maxsize=\"120%\" minsize=\"120%\">)</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mrow><mrow><mi/><mo>=</mo><mrow><msub><mi>\u03c0</mi><mrow><mi mathvariant=\"normal\">g</mi><mo>\u2264</mo><mi>n</mi></mrow></msub><mo>-</mo><mrow><mrow><mfrac><mn>1</mn><msub><mi>c</mi><mn>1</mn></msub></mfrac><mo>\u2062</mo><mrow><mo maxsize=\"120%\" minsize=\"120%\">(</mo><mrow><mrow><msub><mi>c</mi><mn>2</mn></msub><mo>\u2062</mo><msup><mi>\ud835\udd0d</mi><mrow><mi/><mo>\u22c6</mo><mn>2</mn></mrow></msup></mrow><mo>+</mo><mi mathvariant=\"normal\">\u22ef</mi><mo>+</mo><mrow><msub><mi>c</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><msup><mi>\ud835\udd0d</mi><mrow><mi/><mo>\u22c6</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></msup></mrow></mrow><mo maxsize=\"120%\" minsize=\"120%\">)</mo></mrow></mrow><mo>\u2218</mo><msub><mi>\u03c0</mi><mrow><mi mathvariant=\"normal\">g</mi><mo>=</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></mrow></msub></mrow></mrow></mrow><mo>.</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nor equivalently\n\n", "itemtype": "equation", "pos": 74665, "prevtext": "\nWe observe in this formula the action of direct map-truncate-invert schemes.\nWe simulate the corresponding truncated stochastic Taylor scheme represented by \n$\\pi_{{\\mathrm{g}}\\leq n}$ and add the corresponding additional terms shown. \nNote the additional terms ${\\mathfrak{J}}^{\\star 2}$, ${\\mathfrak{J}}^{\\star 3}$ and so forth only \ninvolve products over lower order multiple It\\^o integrals that have already \nbeen simulated in $\\pi_{{\\mathrm{g}}\\leq n}$.\nFor instance, for a word $w$ with $\\mathrm{g}(w)=n+1$, the term ${\\mathfrak{J}}^{\\star 2}(w)$ is the \nsum of all products of It\\^o integrals of the form $I_uI_v$ with non-empty\nwords $u$ and $v$ such that $uv=w$ and using grade preservation, $\\mathrm{g}(u)+\\mathrm{g}(v)=n+1$. \nIn particular $\\mathrm{g}(u)\\leq n$ and $\\mathrm{g}(v)\\leq n$, so $I_u$ and $I_v$ are already\nincluded in $\\pi_{{\\mathrm{g}}\\leq n}$. The question arises as to whether a given \ndirect map-truncate-inverse scheme converges.\nFor the integrator we construct presently, this will be an automatic consequence of\nthe convergence of the corresponding stochastic Taylor integrator according to \nword length grading.\n\\end{remark}\n\nWe turn our attention to establishing our main result concerning \nan efficient integrator for equations driven by L\\'{e}vy processes.\nFor convenience we introduce the following bracketing notation for\nthe bracket $[\\,\\cdot\\,,\\,\\cdot\\,]$ in the quasi-shuffle product. \nFor letters $a$ we set $[a]\\coloneqq a$, while for words \n$w=a_1\\ldots a_k$ we set $[w]\\coloneqq [a_1,[a_2,\\ldots,[a_{k-1},a_k]\\ldots]]$. \nThe commutativity of the bracket means the order of the letters $a_i$\nis irrelevant and then its associativity means that all $k$-fold brackets\nare equivalent to the canonical form of left-to-right bracketing shown. \n\n\\begin{definition}[Reversal, sign reversal and quasi-shuffle antipode endomorphisms]\nWe define three endomorphisms on $\\mathbb{R}\\langle\\mathbb{A}\\rangle$ as follows. If \n$a_i\\in\\mathbb A$ for $i=1,\\ldots,n$ are letters, then we define the:\n\\begin{enumerate}\n\\item Reversal map: $|S|\\colon a_1\\ldots a_n\\mapsto a_n\\ldots a_1$;\n\\item Sign reversal map: $S\\colon a_1\\ldots a_n\\mapsto (-1)^n a_n\\ldots a_1$; and\n\\item Quasi-shuffle antipode: $\\hat S\\colon a_1\\ldots a_n\\mapsto(-1)^n\\sum [u_1]\\,[u_2]\\ldots[u_k]$,\n\\end{enumerate}\nwhere for the quasi-shuffle antipode the sum is over all possible factorizations of \n$a_n\\ldots a_1=u_1u_2\\ldots u_k$ into non-empty subwords $u_i$ for all $k=1,\\ldots,n$.\n\\end{definition}\n\n\\begin{remark}[Antipode and quasi-shuffle Hopf algebra]\nThe quasi-shuffle antipode is the quasi-shuffle convolution reciprocal\nmap of the identity, i.e.\\/ ${\\mathrm{id}}\\star\\hat S=\\hat S\\star{\\mathrm{id}}=\\nu$. Indeed, \nwith this in hand, the quasi-shuffle algebra $\\mathbb{R}\\langle\\mathbb{A}\\rangle_*$, \nwith deconcatenation $\\Delta$ as coproduct, is also a Hopf algebra. These results\nwere proved by Hoffman~\\cite{Hof}.\n\\end{remark}\n\n\\begin{remark}\nFor the shuffle algebra where the bracket $[\\,\\cdot\\,,\\,\\cdot\\,]$ is trivial, \nwe have $\\hat{S}=S$. \n\\end{remark}\n\nMalham \\& Wiese \\cite{MalWie} and Ebrahimi--Fard et al.~\\cite{EfLMMkW} considered \ndrift-diffusion equations interpreted in the Stratonovich sense---which \ncorresponds to the shuffle product case. The scheme of main interest therein\nwas the map-truncate-invert integration scheme generated from the map $f=\\mathrm{sinhlog}$.\nThe shuffle convolution power series associated to the series \n$f(1+x)=\\mathrm{sinhlog}(1+x)=x+\\frac{1}{2}\\sum_{k\\geq2} (-1)^{k-1} x^k$ \nis expressible in the form  $F^{\\scriptsize{}}(X)=\\frac{1}{2}(X-X^{\\scriptsize{}(-1)})$. \nHere ${}$ represents the convolution product corresponding to the shuffle product. \nIn the shuffle case, ${\\mathrm{id}}{} S=S{}{\\mathrm{id}}=\\nu$ and we therefore have the identity \n$\\mathrm{sinhlog}^{\\scriptsize{}}({\\mathrm{id}}) = \\frac{1}{2}({\\mathrm{id}} - S)$, \nand similarly $\\mathrm{coshlog}^{\\scriptsize{}}({\\mathrm{id}})=\\frac{1}{2}({\\mathrm{id}} + S)$. \nThe efficiency results of Malham \\& Wiese \\cite{MalWie} \nand Ebrahimi--Fard et al.~\\cite{EfLMMkW} \nfor the sinhlog integrator rely on the identity\n$\\langle\\!\\langle\\pi_{{\\mathrm{g}}=n}\\circ\\mathrm{sinhlog}^{\\scriptsize{}}({\\mathrm{id}}),\n\\pi_{{\\mathrm{g}}=n}\\circ\\mathrm{coshlog}^{\\scriptsize{}}({\\mathrm{id}})\\rangle\\!\\rangle=0$.\nHere $\\langle\\!\\langle\\,\\cdot\\,,\\,\\cdot\\,\\rangle\\!\\rangle$ is an inner product on \n$\\mathrm{End}(\\mathbb{R}\\langle\\mathbb{A}\\rangle_{\\scriptsize{}})$ \nsimilar to $\\langle\\,\\cdot\\,,\\,\\cdot\\,\\rangle$\nbut where the underlying expectation map differs \ndue to the use of Stratonovich integrals. \nThe above result utilizes the shuffle algebra structure \nof multiple Stratonovich integrals with respect to \ncontinuous semimartingale integrators. \nTo obtain an appropriate extension of the sinhlog integrator \nto L\\'{e}vy-driven equations, we broaden our definition \nof map-truncate-invert schemes. \nIn particular, we introduce the antisymmetric sign reverse integrator \nas follows.\n\n\\begin{definition}[Antisymmetric sign reverse integrator]\nThe antisymmetric sign reverse integrator is the direct map-truncate-invert scheme \nassociated with $\\frac{1}{2}({\\mathrm{id}} - S)$, with truncation according to word length.\n\\end{definition}\n\n\\begin{remark} \nWe cannot in general give an expression for $\\frac{1}{2}({\\mathrm{id}} - S)$ as a convolution power series \nin ${\\mathfrak{J}}$ in any quasi-shuffle convolution algebra with non-trivial bracket. \nTo see this, compare the action of $S$ and a map \n$\\alpha {\\mathfrak{J}}+\\beta {\\mathfrak{J}}^{\\star 2}$ on a general word of length two. We see that\n$S(ab) = ba$ and the identity \n$(\\alpha {\\mathfrak{J}} + \\beta {\\mathfrak{J}}^{\\star 2})(ab) = (\\alpha+\\beta)ab+\\beta ba+\\beta[a,b]$.\nComparing these two expressions, we see that $-\\alpha=\\beta=1$, \nand that $[a,b]=0$ for all $a,b$. This implies that $[\\,\\cdot\\,,\\,\\cdot\\,]$ must be trivial. \n\\end{remark}\n\nThe following representation generates a practical implementation of the antisymmetric \nsign reverse integrator. In particular, it includes the inverse step. \n\n\\begin{lemma}[Direct representation of the antisymmetric sign reverse integrator]\\label{direct rep}\nThe antisymmetric sign reverse integrator is given by \n\n", "index": 77, "text": "\\begin{equation*}\n\\sum_{|w|\\leq n} I_w(t)\\tilde{V}_w  \n+\\sum_{|w|=n+1}I_{\\mathrm{coshlog}^{\\scriptsize{}}(w)}(t)\\tilde{V}_w,\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex44.m1\" class=\"ltx_Math\" alttext=\"\\sum_{|w|\\leq n}I_{w}(t)\\tilde{V}_{w}+\\sum_{|w|=n+1}I_{\\mathrm{coshlog}(w)}(t)%&#10;\\tilde{V}_{w},\" display=\"block\"><mrow><mrow><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mrow><mo stretchy=\"false\">|</mo><mi>w</mi><mo stretchy=\"false\">|</mo></mrow><mo>\u2264</mo><mi>n</mi></mrow></munder><mrow><msub><mi>I</mi><mi>w</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><mi>w</mi></msub></mrow></mrow><mo>+</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mrow><mo stretchy=\"false\">|</mo><mi>w</mi><mo stretchy=\"false\">|</mo></mrow><mo>=</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></mrow></munder><mrow><msub><mi>I</mi><mrow><mi>coshlog</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>w</mi><mo stretchy=\"false\">)</mo></mrow></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><mi>w</mi></msub></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\n\\end{lemma}\n\n\\begin{proof}\nThe map $\\frac{1}{2}({\\mathrm{id}}-S)$ is identified with $\\mathrm{sinhlog}^{\\scriptsize{}}({\\mathrm{id}})$. \nThe shuffle product preserves the word length grading so $\\pi_{{\\mathrm{g}}=n+1}\\circ S=S\\circ\\pi_{{\\mathrm{g}}=n+1}$\nand thus $\\pi_{{\\mathrm{g}}=n+1}\\circ\\mathrm{sinhlog}^{\\scriptsize{}}({\\mathrm{id}})=\\mathrm{sinhlog}^{\\scriptsize{}}({\\mathrm{id}})\\circ\\pi_{{\\mathrm{g}}=n+1}$.  \nHence applying Corollary~\\ref{inv corollary} with $F=\\mathrm{sinhlog}^{\\scriptsize{}}$ and\nusing that $c_1=1$ in this case and \nthe identity $\\mathrm{sinhlog}^{\\scriptsize{}}({\\mathrm{id}})+\\mathrm{coshlog}^{\\scriptsize{}}({\\mathrm{id}})={\\mathrm{id}}$, we have\n\n", "itemtype": "equation", "pos": 74822, "prevtext": "\nor equivalently\n\n", "index": 79, "text": "\\begin{equation*}\n\\sum_{|w|\\leq n} I_w(t)\\tilde{V}_w  \n+\\sum_{|w|=n+1}\\Big(I_{{\\mathrm{coshlog}^{\\star}(\\id)}(w)}(t) \n+\\tfrac12I_{(S-\\hat S)(w)}(t)\\Big)\\tilde{V}_w.\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex45.m1\" class=\"ltx_Math\" alttext=\"\\sum_{|w|\\leq n}I_{w}(t)\\tilde{V}_{w}+\\sum_{|w|=n+1}\\Big{(}I_{{\\mathrm{coshlog%&#10;}^{\\star}(\\id)}(w)}(t)+\\tfrac{1}{2}I_{(S-\\hat{S})(w)}(t)\\Big{)}\\tilde{V}_{w}.\" display=\"block\"><mrow><mrow><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mrow><mo stretchy=\"false\">|</mo><mi>w</mi><mo stretchy=\"false\">|</mo></mrow><mo>\u2264</mo><mi>n</mi></mrow></munder><mrow><msub><mi>I</mi><mi>w</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><mi>w</mi></msub></mrow></mrow><mo>+</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mrow><mo stretchy=\"false\">|</mo><mi>w</mi><mo stretchy=\"false\">|</mo></mrow><mo>=</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></mrow></munder><mrow><mrow><mo maxsize=\"160%\" minsize=\"160%\">(</mo><mrow><mrow><msub><mi>I</mi><mrow><msup><mi>coshlog</mi><mo>\u22c6</mo></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\id</mtext></merror><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>w</mi><mo stretchy=\"false\">)</mo></mrow></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mstyle displaystyle=\"false\"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle><mo>\u2062</mo><msub><mi>I</mi><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>S</mi><mo>-</mo><mover accent=\"true\"><mi>S</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>w</mi><mo stretchy=\"false\">)</mo></mrow></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo maxsize=\"160%\" minsize=\"160%\">)</mo></mrow><mo>\u2062</mo><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><mi>w</mi></msub></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nusing that $\\mathrm{coshlog}^{\\scriptsize{}}({\\mathrm{id}})=\\frac12({\\mathrm{id}}+S)$\nand ${\\mathrm{coshlog}^{\\star}({\\mathrm{id}})}=\\frac12({\\mathrm{id}}+\\hat S)$. Ignoring higher order terms, using the convolution algebra embedding\nand applying $\\mu\\otimes\\kappa$ then gives the desired result.\n\\qed\n\\end{proof}\n\n\\begin{remark}[Antisymmetric sign reverse integrator in practice]\nThe terms given by $\\bigl(\\mathrm{coshlog}^{\\star}({\\mathrm{id}})\\bigr)\\circ\\pi_{{\\mathrm{g}}=n+1}$\nand $\\frac12(S-\\hat S)\\circ\\pi_{{\\mathrm{g}}=n+1}$ correspond to polynomials\nof words of lower word length $n$ or less. For the former term this\nis straightforward following analogous arguments to those \nin Remark~\\ref{mti just}---noting that the\nprojection operator $\\pi_{{\\mathrm{g}}=n+1}$ is applied before $\\mathrm{coshlog}^{\\star}({\\mathrm{id}})$.\nFor the latter term, $(S-\\hat S)\\circ(a_1\\ldots a_{n+1})$\nconsists of a sum of terms, each of which contains at least one bracket.\nFor example one term would be $(-1)^{n+1}[a_{n+1},a_n]a_{n-1}\\ldots a_1$\nwhich is a word of length $n$, and so forth. Hence the additional\nterms $\\bigl(\\mathrm{coshlog}^{\\star}({\\mathrm{id}})\\bigr)\\circ\\pi_{{\\mathrm{g}}=n+1}$\nand $\\frac12(S-\\hat S)\\circ\\pi_{{\\mathrm{g}}=n+1}$ required for implementing the \ndirect antisymmetric sign reverse integrator consist of lower\norder It\\^o integrals we have already simulated to construct the\nstochastic Taylor integrator $\\pi_{{\\mathrm{g}}\\leq n}$.\n\\end{remark}\n\n\\begin{example}\nConsider the order one antisymmetric sign reverse approximation. \nSince $\\mathrm{coshlog}^\\star({\\mathrm{id}})=\\nu+\\frac12{\\mathfrak{J}}^{\\star2}-\\frac12{\\mathfrak{J}}^{\\star3}+\\cdots$\nand $(S-\\hat S)(a_1a_2a_3)=\\frac12\\bigl([a_3a_2]a_1+a_3[a_2a_1]+[a_3a_2a_1]\\bigr)$\nthis antisymmetric sign reverse approximation has the form\n\n", "itemtype": "equation", "pos": 75684, "prevtext": "\n\\end{lemma}\n\n\\begin{proof}\nThe map $\\frac{1}{2}({\\mathrm{id}}-S)$ is identified with $\\mathrm{sinhlog}^{\\scriptsize{}}({\\mathrm{id}})$. \nThe shuffle product preserves the word length grading so $\\pi_{{\\mathrm{g}}=n+1}\\circ S=S\\circ\\pi_{{\\mathrm{g}}=n+1}$\nand thus $\\pi_{{\\mathrm{g}}=n+1}\\circ\\mathrm{sinhlog}^{\\scriptsize{}}({\\mathrm{id}})=\\mathrm{sinhlog}^{\\scriptsize{}}({\\mathrm{id}})\\circ\\pi_{{\\mathrm{g}}=n+1}$.  \nHence applying Corollary~\\ref{inv corollary} with $F=\\mathrm{sinhlog}^{\\scriptsize{}}$ and\nusing that $c_1=1$ in this case and \nthe identity $\\mathrm{sinhlog}^{\\scriptsize{}}({\\mathrm{id}})+\\mathrm{coshlog}^{\\scriptsize{}}({\\mathrm{id}})={\\mathrm{id}}$, we have\n\n", "index": 81, "text": "\\begin{align*}\n\\bigl(\\mathrm{sinh}&\\mathrm{log}^{\\scriptsize{}}\\bigr)^{-1}\n\\circ \\pi_{{\\mathrm{g}}\\leq n}\\circ\\mathrm{sinhlog}^{\\scriptsize{}}({\\mathrm{id}})\\\\\n=&\\;\\pi_{{\\mathrm{g}}\\leq n}+\\bigl({\\mathrm{id}}-\\mathrm{sinhlog}^{\\scriptsize{}}({\\mathrm{id}})\\bigr)\\circ\\pi_{{\\mathrm{g}}=n+1}+\\mathrm{h.o.t.}\\\\\n=&\\;\\pi_{{\\mathrm{g}}\\leq n}+\\bigl(\\mathrm{coshlog}^{\\scriptsize{}}({\\mathrm{id}})\\bigr)\\circ\\pi_{{\\mathrm{g}}=n+1}+\\mathrm{h.o.t.}\\\\\n=&\\;\\pi_{{\\mathrm{g}}\\leq n}+\\bigl(\\mathrm{coshlog}^{\\star}({\\mathrm{id}})\\bigr)\\circ\\pi_{{\\mathrm{g}}=n+1}\\\\\n&\\;+\\bigl(\\mathrm{coshlog}^{\\scriptsize{}}({\\mathrm{id}})-\\mathrm{coshlog}^{\\star}({\\mathrm{id}})\\bigr)\\circ\\pi_{{\\mathrm{g}}=n+1}+\\mathrm{h.o.t.}\\\\\n=&\\;\\pi_{{\\mathrm{g}}\\leq n}+\\bigl(\\mathrm{coshlog}^{\\star}({\\mathrm{id}})\\bigr)\\circ\\pi_{{\\mathrm{g}}=n+1}\n+\\tfrac12(S-\\hat S)\\circ\\pi_{{\\mathrm{g}}=n+1}+\\mathrm{h.o.t.},\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex46.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\bigl{(}\\mathrm{sinh}\" display=\"inline\"><mrow><mo maxsize=\"120%\" minsize=\"120%\">(</mo><mi>sinh</mi></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex46.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\mathrm{log}\\bigr{)}^{-1}\\circ\\pi_{{\\mathrm{g}}\\leq n}\\circ%&#10;\\mathrm{sinhlog}({\\mathrm{id}})\" display=\"inline\"><mrow><mi>log</mi><mo maxsize=\"120%\" minsize=\"120%\">)</mo><msup><mi/><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>\u2218</mo><mi>\u03c0</mi><msub><mi/><mrow><mi mathvariant=\"normal\">g</mi><mo>\u2264</mo><mi>n</mi></mrow></msub><mo>\u2218</mo><mi>sinhlog</mi><mo stretchy=\"false\">(</mo><mi>id</mi><mo stretchy=\"false\">)</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex47.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle=\" display=\"inline\"><mo>=</mo></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex47.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\;\\pi_{{\\mathrm{g}}\\leq n}+\\bigl{(}{\\mathrm{id}}-\\mathrm{sinhlog}%&#10;({\\mathrm{id}})\\bigr{)}\\circ\\pi_{{\\mathrm{g}}=n+1}+\\mathrm{h.o.t.}\" display=\"inline\"><mrow><mrow><mrow><mrow><mi mathvariant=\"normal\">\u2004</mi><mo>\u2062</mo><msub><mi>\u03c0</mi><mrow><mi mathvariant=\"normal\">g</mi><mo>\u2264</mo><mi>n</mi></mrow></msub></mrow><mo>+</mo><mrow><mrow><mo maxsize=\"120%\" minsize=\"120%\">(</mo><mrow><mi>id</mi><mo>-</mo><mrow><mi>sinhlog</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>id</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo maxsize=\"120%\" minsize=\"120%\">)</mo></mrow><mo>\u2218</mo><msub><mi>\u03c0</mi><mrow><mi mathvariant=\"normal\">g</mi><mo>=</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></mrow></msub></mrow><mo>+</mo><mi mathvariant=\"normal\">h</mi></mrow><mo>.</mo><mi mathvariant=\"normal\">o</mi><mo>.</mo><mi mathvariant=\"normal\">t</mi></mrow><mo>.</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex48.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle=\" display=\"inline\"><mo>=</mo></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex48.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\;\\pi_{{\\mathrm{g}}\\leq n}+\\bigl{(}\\mathrm{coshlog}({\\mathrm{id}}%&#10;)\\bigr{)}\\circ\\pi_{{\\mathrm{g}}=n+1}+\\mathrm{h.o.t.}\" display=\"inline\"><mrow><mrow><mrow><mrow><mi mathvariant=\"normal\">\u2004</mi><mo>\u2062</mo><msub><mi>\u03c0</mi><mrow><mi mathvariant=\"normal\">g</mi><mo>\u2264</mo><mi>n</mi></mrow></msub></mrow><mo>+</mo><mrow><mrow><mo maxsize=\"120%\" minsize=\"120%\">(</mo><mrow><mi>coshlog</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>id</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo maxsize=\"120%\" minsize=\"120%\">)</mo></mrow><mo>\u2218</mo><msub><mi>\u03c0</mi><mrow><mi mathvariant=\"normal\">g</mi><mo>=</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></mrow></msub></mrow><mo>+</mo><mi mathvariant=\"normal\">h</mi></mrow><mo>.</mo><mi mathvariant=\"normal\">o</mi><mo>.</mo><mi mathvariant=\"normal\">t</mi></mrow><mo>.</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex49.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle=\" display=\"inline\"><mo>=</mo></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex49.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\;\\pi_{{\\mathrm{g}}\\leq n}+\\bigl{(}\\mathrm{coshlog}^{\\star}({%&#10;\\mathrm{id}})\\bigr{)}\\circ\\pi_{{\\mathrm{g}}=n+1}\" display=\"inline\"><mrow><mrow><mi mathvariant=\"normal\">\u2004</mi><mo>\u2062</mo><msub><mi>\u03c0</mi><mrow><mi mathvariant=\"normal\">g</mi><mo>\u2264</mo><mi>n</mi></mrow></msub></mrow><mo>+</mo><mrow><mrow><mo maxsize=\"120%\" minsize=\"120%\">(</mo><mrow><msup><mi>coshlog</mi><mo>\u22c6</mo></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>id</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo maxsize=\"120%\" minsize=\"120%\">)</mo></mrow><mo>\u2218</mo><msub><mi>\u03c0</mi><mrow><mi mathvariant=\"normal\">g</mi><mo>=</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></mrow></msub></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex50.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\;+\\bigl{(}\\mathrm{coshlog}({\\mathrm{id}})-\\mathrm{coshlog}^{%&#10;\\star}({\\mathrm{id}})\\bigr{)}\\circ\\pi_{{\\mathrm{g}}=n+1}+\\mathrm{h.o.t.}\" display=\"inline\"><mrow><mrow><mrow><mi mathvariant=\"normal\">\u2004</mi><mo>+</mo><mrow><mrow><mo maxsize=\"120%\" minsize=\"120%\">(</mo><mrow><mrow><mi>coshlog</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>id</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><msup><mi>coshlog</mi><mo>\u22c6</mo></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>id</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo maxsize=\"120%\" minsize=\"120%\">)</mo></mrow><mo>\u2218</mo><msub><mi>\u03c0</mi><mrow><mi mathvariant=\"normal\">g</mi><mo>=</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></mrow></msub></mrow><mo>+</mo><mi mathvariant=\"normal\">h</mi></mrow><mo>.</mo><mi mathvariant=\"normal\">o</mi><mo>.</mo><mi mathvariant=\"normal\">t</mi></mrow><mo>.</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex51.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle=\" display=\"inline\"><mo>=</mo></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex51.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\;\\pi_{{\\mathrm{g}}\\leq n}+\\bigl{(}\\mathrm{coshlog}^{\\star}({%&#10;\\mathrm{id}})\\bigr{)}\\circ\\pi_{{\\mathrm{g}}=n+1}+\\tfrac{1}{2}(S-\\hat{S})\\circ%&#10;\\pi_{{\\mathrm{g}}=n+1}+\\mathrm{h.o.t.},\" display=\"inline\"><mrow><mrow><mrow><mrow><mi mathvariant=\"normal\">\u2004</mi><mo>\u2062</mo><msub><mi>\u03c0</mi><mrow><mi mathvariant=\"normal\">g</mi><mo>\u2264</mo><mi>n</mi></mrow></msub></mrow><mo>+</mo><mrow><mrow><mo maxsize=\"120%\" minsize=\"120%\">(</mo><mrow><msup><mi>coshlog</mi><mo>\u22c6</mo></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>id</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo maxsize=\"120%\" minsize=\"120%\">)</mo></mrow><mo>\u2218</mo><msub><mi>\u03c0</mi><mrow><mi mathvariant=\"normal\">g</mi><mo>=</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></mrow></msub></mrow><mo>+</mo><mrow><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>S</mi><mo>-</mo><mover accent=\"true\"><mi>S</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2218</mo><msub><mi>\u03c0</mi><mrow><mi mathvariant=\"normal\">g</mi><mo>=</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></mrow></msub></mrow><mo>+</mo><mi mathvariant=\"normal\">h</mi></mrow><mo>.</mo><mi mathvariant=\"normal\">o</mi><mo>.</mo><mi mathvariant=\"normal\">t</mi></mrow><mo>.</mo><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\n\\end{example}\n\n\\begin{lemma}\\label{orthog lemma}\nLet $\\pi_{{\\mathrm{g}}=n}$ be the projection according to the word length grading. \nThen for any $\\mathbf{V}$ we have:\n\\begin{enumerate}\n \\item $\\langle X,Y\\rangle=\\langle|S|\\circ X,|S|\\circ Y\\rangle$; \n \\item $\\|\\pi_{{\\mathrm{g}}=n}\\circ S\\|^2=\\|\\pi_{{\\mathrm{g}}=n}\\circ{\\mathrm{id}}\\|^2$.\n\\end{enumerate}\n\\end{lemma}\n\n\\begin{proof}\nAs $E(w) = 0$ unless $w\\in\\{0\\}^*$, we have $E(w)=E\\bigl(|S|(w)\\bigr)$. \nBy Hoffman \\& Ihara~\\cite[Prop. 4.2]{HofIha}, \nthe reversal map is an automorphism for any quasi-shuffle algebra. \nHence we have \n$E\\big(|S|(u)*|S|(v)\\big)=E\\big(|S|(u*v)\\big)=E(u*v)$, giving (i).\nUsing this, for any words $u,v\\in\\mathbb A^*$ we have\n$E\\big((\\pi_{{\\mathrm{g}}=n}\\circ S)(u)*(\\pi_{{\\mathrm{g}}=n}\\circ S)(v)\\big)\n=(-1)^{2n}E\\big(|S|(\\pi_{{\\mathrm{g}}=n}\\circ u)*|S|(\\pi_{{\\mathrm{g}}=n}\\circ v)\\big)\n=E\\bigl((\\pi_{{\\mathrm{g}}=n}\\circ u)*(\\pi_{{\\mathrm{g}}=n}\\circ v)\\bigr)$, giving (ii).\n\\qed\n\\end{proof}\n\nFinally, our main result is as follows.\n\n\\begin{theorem}[Main result: Efficiency of the antisymmetric sign reverse integrator]\\label{main result}\nConsider the flowmap of a stochastic differential equation \ndriven by independent L\\'{e}vy processes with moments of all orders. \nAssume the flowmap possesses a separated stochastic Taylor expansion, \nand that the vector fields are sufficiently smooth to ensure convergence \nof the truncated stochastic Taylor integration schemes to all orders. \nThe antisymmetric sign reverse approximation at a given truncation level \n$n$ is efficient in the sense that its \nlocal leading order mean-square errors are always smaller \nthan those of the truncated stochastic Taylor scheme of the same order, \nindependent of the driving vector fields and of the initial conditions. \nIt converges with global strong mean-square order of convergence $n$. \n\\end{theorem}\n\n\\begin{proof}\nIt suffices to show the leading order remainder endomorphism \n$\\pi_{{\\mathrm{g}}=n+1}\\circ{\\mathrm{id}}$ associated with the truncated stochastic Taylor expansion \nhas greater norm than the remainder endomorphism $\\pi_{{\\mathrm{g}}=n+1}\\circ\\frac12({\\mathrm{id}}-S)$ \nassociated with the antisymmetric sign reverse integrator, independent of $\\mathbf{V}$. \nUsing Lemma~\\ref{orthog lemma} and setting $\\pi=\\pi_{{\\mathrm{g}}=n+1}$, we have\n\n", "itemtype": "equation", "pos": 78384, "prevtext": "\nusing that $\\mathrm{coshlog}^{\\scriptsize{}}({\\mathrm{id}})=\\frac12({\\mathrm{id}}+S)$\nand ${\\mathrm{coshlog}^{\\star}({\\mathrm{id}})}=\\frac12({\\mathrm{id}}+\\hat S)$. Ignoring higher order terms, using the convolution algebra embedding\nand applying $\\mu\\otimes\\kappa$ then gives the desired result.\n\\qed\n\\end{proof}\n\n\\begin{remark}[Antisymmetric sign reverse integrator in practice]\nThe terms given by $\\bigl(\\mathrm{coshlog}^{\\star}({\\mathrm{id}})\\bigr)\\circ\\pi_{{\\mathrm{g}}=n+1}$\nand $\\frac12(S-\\hat S)\\circ\\pi_{{\\mathrm{g}}=n+1}$ correspond to polynomials\nof words of lower word length $n$ or less. For the former term this\nis straightforward following analogous arguments to those \nin Remark~\\ref{mti just}---noting that the\nprojection operator $\\pi_{{\\mathrm{g}}=n+1}$ is applied before $\\mathrm{coshlog}^{\\star}({\\mathrm{id}})$.\nFor the latter term, $(S-\\hat S)\\circ(a_1\\ldots a_{n+1})$\nconsists of a sum of terms, each of which contains at least one bracket.\nFor example one term would be $(-1)^{n+1}[a_{n+1},a_n]a_{n-1}\\ldots a_1$\nwhich is a word of length $n$, and so forth. Hence the additional\nterms $\\bigl(\\mathrm{coshlog}^{\\star}({\\mathrm{id}})\\bigr)\\circ\\pi_{{\\mathrm{g}}=n+1}$\nand $\\frac12(S-\\hat S)\\circ\\pi_{{\\mathrm{g}}=n+1}$ required for implementing the \ndirect antisymmetric sign reverse integrator consist of lower\norder It\\^o integrals we have already simulated to construct the\nstochastic Taylor integrator $\\pi_{{\\mathrm{g}}\\leq n}$.\n\\end{remark}\n\n\\begin{example}\nConsider the order one antisymmetric sign reverse approximation. \nSince $\\mathrm{coshlog}^\\star({\\mathrm{id}})=\\nu+\\frac12{\\mathfrak{J}}^{\\star2}-\\frac12{\\mathfrak{J}}^{\\star3}+\\cdots$\nand $(S-\\hat S)(a_1a_2a_3)=\\frac12\\bigl([a_3a_2]a_1+a_3[a_2a_1]+[a_3a_2a_1]\\bigr)$\nthis antisymmetric sign reverse approximation has the form\n\n", "index": 83, "text": "\\begin{multline*}\n\\sum_{|w|\\leq 2} I_w \\tilde{V}_w\\\\\n~~~~~~~~~+\\!\\!\\!\\!\\sum_{w=a_1a_2a_3}\\!\\!\\!\\!\\tfrac12\\bigl(I_{a_1}I_{a_2a_3}\n+I_{a_1a_2}I_{a_3}-I_{a_1}I_{a_2}I_{a_3}+I_{[a_3a_2]a_1}+I_{a_3[a_2a_1]}+I_{[a_3a_2a_1]}\\bigr)\\tilde{V}_w.\n\\end{multline*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"p42.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\sum_{|w|\\leq 2}I_{w}\\tilde{V}_{w}\\\\&#10;\\displaystyle~{}~{}~{}~{}~{}~{}~{}~{}~{}+\\!\\!\\!\\!\\sum_{w=a_{1}a_{2}a_{3}}\\!\\!%&#10;\\!\\!\\tfrac{1}{2}\\bigl{(}I_{a_{1}}I_{a_{2}a_{3}}+I_{a_{1}a_{2}}I_{a_{3}}-I_{a_{%&#10;1}}I_{a_{2}}I_{a_{3}}+I_{[a_{3}a_{2}]a_{1}}+I_{a_{3}[a_{2}a_{1}]}+I_{[a_{3}a_{%&#10;2}a_{1}]}\\bigr{)}\\tilde{V}_{w}.\" display=\"block\"><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mrow><mo stretchy=\"false\">|</mo><mi>w</mi><mo stretchy=\"false\">|</mo></mrow><mo>\u2264</mo><mn>2</mn></mrow></munder><mrow><msub><mi>I</mi><mi>w</mi></msub><mo>\u2062</mo><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><mi>w</mi></msub></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mrow><mrow><mo lspace=\"32.2pt\" rspace=\"0pt\">+</mo><mrow><mpadded width=\"-6.8pt\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>w</mi><mo>=</mo><mrow><msub><mi>a</mi><mn>1</mn></msub><mo>\u2062</mo><msub><mi>a</mi><mn>2</mn></msub><mo>\u2062</mo><msub><mi>a</mi><mn>3</mn></msub></mrow></mrow></munder></mpadded><mrow><mstyle displaystyle=\"false\"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle><mo>\u2062</mo><mrow><mo maxsize=\"120%\" minsize=\"120%\">(</mo><mrow><mrow><mrow><mrow><msub><mi>I</mi><msub><mi>a</mi><mn>1</mn></msub></msub><mo>\u2062</mo><msub><mi>I</mi><mrow><msub><mi>a</mi><mn>2</mn></msub><mo>\u2062</mo><msub><mi>a</mi><mn>3</mn></msub></mrow></msub></mrow><mo>+</mo><mrow><msub><mi>I</mi><mrow><msub><mi>a</mi><mn>1</mn></msub><mo>\u2062</mo><msub><mi>a</mi><mn>2</mn></msub></mrow></msub><mo>\u2062</mo><msub><mi>I</mi><msub><mi>a</mi><mn>3</mn></msub></msub></mrow></mrow><mo>-</mo><mrow><msub><mi>I</mi><msub><mi>a</mi><mn>1</mn></msub></msub><mo>\u2062</mo><msub><mi>I</mi><msub><mi>a</mi><mn>2</mn></msub></msub><mo>\u2062</mo><msub><mi>I</mi><msub><mi>a</mi><mn>3</mn></msub></msub></mrow></mrow><mo>+</mo><msub><mi>I</mi><mrow><mrow><mo stretchy=\"false\">[</mo><mrow><msub><mi>a</mi><mn>3</mn></msub><mo>\u2062</mo><msub><mi>a</mi><mn>2</mn></msub></mrow><mo stretchy=\"false\">]</mo></mrow><mo>\u2062</mo><msub><mi>a</mi><mn>1</mn></msub></mrow></msub><mo>+</mo><msub><mi>I</mi><mrow><msub><mi>a</mi><mn>3</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><msub><mi>a</mi><mn>2</mn></msub><mo>\u2062</mo><msub><mi>a</mi><mn>1</mn></msub></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></msub><mo>+</mo><msub><mi>I</mi><mrow><mo stretchy=\"false\">[</mo><mrow><msub><mi>a</mi><mn>3</mn></msub><mo>\u2062</mo><msub><mi>a</mi><mn>2</mn></msub><mo>\u2062</mo><msub><mi>a</mi><mn>1</mn></msub></mrow><mo stretchy=\"false\">]</mo></mrow></msub></mrow><mo maxsize=\"120%\" minsize=\"120%\">)</mo></mrow><mo>\u2062</mo><msub><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><mi>w</mi></msub></mrow></mrow></mrow><mo>.</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nWe observe\n$\\bigl\\|\\pi_{{\\mathrm{g}}=n+1}\\circ\\tfrac12({\\mathrm{id}}-S)\\bigr\\|^2\\leq\\|\\pi_{{\\mathrm{g}}=n+1}\\circ{\\mathrm{id}}\\|^2$, giving the result.\nStrong global mean-square order of convergence $n$ for the scheme is a natural consequence.\n\\qed\n\\end{proof}\n\n\n\n\\section{Numerical simulations}\nWe present two numerical experiments demonstrating the results proved above. \nFirst, we study the linear constant coefficient drift-diffusion equation\n$\\mathrm{d}y_t=A_0y_t\\mathrm{d}t+A_1y_t\\mathrm{d}W^1_t+A_2y_t\\mathrm{d}W^2_t$, \nwhere $y_t\\in\\mathbb{R}^2$, the $W^i$ are independent \nWiener processes, the initial condition is $y_0=(1,0.5)^{\\mathrm{T}}$ \nand the coefficients are given by the matrices\n\n", "itemtype": "equation", "pos": 80965, "prevtext": "\n\\end{example}\n\n\\begin{lemma}\\label{orthog lemma}\nLet $\\pi_{{\\mathrm{g}}=n}$ be the projection according to the word length grading. \nThen for any $\\mathbf{V}$ we have:\n\\begin{enumerate}\n \\item $\\langle X,Y\\rangle=\\langle|S|\\circ X,|S|\\circ Y\\rangle$; \n \\item $\\|\\pi_{{\\mathrm{g}}=n}\\circ S\\|^2=\\|\\pi_{{\\mathrm{g}}=n}\\circ{\\mathrm{id}}\\|^2$.\n\\end{enumerate}\n\\end{lemma}\n\n\\begin{proof}\nAs $E(w) = 0$ unless $w\\in\\{0\\}^*$, we have $E(w)=E\\bigl(|S|(w)\\bigr)$. \nBy Hoffman \\& Ihara~\\cite[Prop. 4.2]{HofIha}, \nthe reversal map is an automorphism for any quasi-shuffle algebra. \nHence we have \n$E\\big(|S|(u)*|S|(v)\\big)=E\\big(|S|(u*v)\\big)=E(u*v)$, giving (i).\nUsing this, for any words $u,v\\in\\mathbb A^*$ we have\n$E\\big((\\pi_{{\\mathrm{g}}=n}\\circ S)(u)*(\\pi_{{\\mathrm{g}}=n}\\circ S)(v)\\big)\n=(-1)^{2n}E\\big(|S|(\\pi_{{\\mathrm{g}}=n}\\circ u)*|S|(\\pi_{{\\mathrm{g}}=n}\\circ v)\\big)\n=E\\bigl((\\pi_{{\\mathrm{g}}=n}\\circ u)*(\\pi_{{\\mathrm{g}}=n}\\circ v)\\bigr)$, giving (ii).\n\\qed\n\\end{proof}\n\nFinally, our main result is as follows.\n\n\\begin{theorem}[Main result: Efficiency of the antisymmetric sign reverse integrator]\\label{main result}\nConsider the flowmap of a stochastic differential equation \ndriven by independent L\\'{e}vy processes with moments of all orders. \nAssume the flowmap possesses a separated stochastic Taylor expansion, \nand that the vector fields are sufficiently smooth to ensure convergence \nof the truncated stochastic Taylor integration schemes to all orders. \nThe antisymmetric sign reverse approximation at a given truncation level \n$n$ is efficient in the sense that its \nlocal leading order mean-square errors are always smaller \nthan those of the truncated stochastic Taylor scheme of the same order, \nindependent of the driving vector fields and of the initial conditions. \nIt converges with global strong mean-square order of convergence $n$. \n\\end{theorem}\n\n\\begin{proof}\nIt suffices to show the leading order remainder endomorphism \n$\\pi_{{\\mathrm{g}}=n+1}\\circ{\\mathrm{id}}$ associated with the truncated stochastic Taylor expansion \nhas greater norm than the remainder endomorphism $\\pi_{{\\mathrm{g}}=n+1}\\circ\\frac12({\\mathrm{id}}-S)$ \nassociated with the antisymmetric sign reverse integrator, independent of $\\mathbf{V}$. \nUsing Lemma~\\ref{orthog lemma} and setting $\\pi=\\pi_{{\\mathrm{g}}=n+1}$, we have\n\n", "index": 85, "text": "\\begin{align*}\n\\|\\pi&\\circ{\\mathrm{id}}\\|^2\\\\\n&=\\Bigl\\|\\pi\\circ\\Bigl(\\tfrac12({\\mathrm{id}}-S)+\\tfrac12({\\mathrm{id}}+S)\\Bigr)\\Bigr\\|^2\\\\\n&=\\bigl\\|\\pi\\circ\\tfrac12({\\mathrm{id}}-S)\\bigr\\|^2\n+\\Bigl\\langle\\pi\\circ\\tfrac12({\\mathrm{id}}-S),\\pi\\circ\\tfrac12({\\mathrm{id}}+S)\\Bigr\\rangle\n+\\bigl\\|\\pi\\circ\\tfrac12({\\mathrm{id}}+S)\\bigr\\|^2\\\\\n&=\\bigl\\|\\pi\\circ\\tfrac12({\\mathrm{id}}-S)\\bigr\\|^2\n+\\tfrac14\\Bigl(\\|\\pi\\circ{\\mathrm{id}}\\|^2-\\|\\pi\\circ S\\|^2\\Bigr)\n+\\bigl\\|\\pi\\circ\\tfrac12({\\mathrm{id}}+S)\\bigr\\|^2\\\\\n&=\\bigl\\|\\pi\\circ\\tfrac12({\\mathrm{id}}-S)\\bigr\\|^2\n+\\bigl\\|\\pi\\circ\\tfrac12({\\mathrm{id}}+S)\\bigr\\|^2,\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex52.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\|\\pi\" display=\"inline\"><mrow><mo>\u2225</mo><mi>\u03c0</mi></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex52.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\circ{\\mathrm{id}}\\|^{2}\" display=\"inline\"><mrow><mo>\u2218</mo><mi>id</mi><msup><mo>\u2225</mo><mn>2</mn></msup></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex53.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\Bigl{\\|}\\pi\\circ\\Bigl{(}\\tfrac{1}{2}({\\mathrm{id}}-S)+\\tfrac{1}%&#10;{2}({\\mathrm{id}}+S)\\Bigr{)}\\Bigr{\\|}^{2}\" display=\"inline\"><mrow><mi/><mo>=</mo><msup><mrow><mo fence=\"true\" maxsize=\"160%\" minsize=\"160%\">\u2225</mo><mrow><mi>\u03c0</mi><mo>\u2218</mo><mrow><mo maxsize=\"160%\" minsize=\"160%\">(</mo><mrow><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>id</mi><mo>-</mo><mi>S</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>id</mi><mo>+</mo><mi>S</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo maxsize=\"160%\" minsize=\"160%\">)</mo></mrow></mrow><mo fence=\"true\" maxsize=\"160%\" minsize=\"160%\">\u2225</mo></mrow><mn>2</mn></msup></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex54.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\bigl{\\|}\\pi\\circ\\tfrac{1}{2}({\\mathrm{id}}-S)\\bigr{\\|}^{2}+%&#10;\\Bigl{\\langle}\\pi\\circ\\tfrac{1}{2}({\\mathrm{id}}-S),\\pi\\circ\\tfrac{1}{2}({%&#10;\\mathrm{id}}+S)\\Bigr{\\rangle}+\\bigl{\\|}\\pi\\circ\\tfrac{1}{2}({\\mathrm{id}}+S)%&#10;\\bigr{\\|}^{2}\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><msup><mrow><mo fence=\"true\" maxsize=\"120%\" minsize=\"120%\">\u2225</mo><mrow><mrow><mi>\u03c0</mi><mo>\u2218</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>id</mi><mo>-</mo><mi>S</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo fence=\"true\" maxsize=\"120%\" minsize=\"120%\">\u2225</mo></mrow><mn>2</mn></msup><mo>+</mo><mrow><mo maxsize=\"160%\" minsize=\"160%\">\u27e8</mo><mrow><mrow><mi>\u03c0</mi><mo>\u2218</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>id</mi><mo>-</mo><mi>S</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>,</mo><mrow><mrow><mi>\u03c0</mi><mo>\u2218</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>id</mi><mo>+</mo><mi>S</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo maxsize=\"160%\" minsize=\"160%\">\u27e9</mo></mrow><mo>+</mo><msup><mrow><mo fence=\"true\" maxsize=\"120%\" minsize=\"120%\">\u2225</mo><mrow><mrow><mi>\u03c0</mi><mo>\u2218</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>id</mi><mo>+</mo><mi>S</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo fence=\"true\" maxsize=\"120%\" minsize=\"120%\">\u2225</mo></mrow><mn>2</mn></msup></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex55.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\bigl{\\|}\\pi\\circ\\tfrac{1}{2}({\\mathrm{id}}-S)\\bigr{\\|}^{2}+%&#10;\\tfrac{1}{4}\\Bigl{(}\\|\\pi\\circ{\\mathrm{id}}\\|^{2}-\\|\\pi\\circ S\\|^{2}\\Bigr{)}+%&#10;\\bigl{\\|}\\pi\\circ\\tfrac{1}{2}({\\mathrm{id}}+S)\\bigr{\\|}^{2}\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><msup><mrow><mo fence=\"true\" maxsize=\"120%\" minsize=\"120%\">\u2225</mo><mrow><mrow><mi>\u03c0</mi><mo>\u2218</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>id</mi><mo>-</mo><mi>S</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo fence=\"true\" maxsize=\"120%\" minsize=\"120%\">\u2225</mo></mrow><mn>2</mn></msup><mo>+</mo><mrow><mfrac><mn>1</mn><mn>4</mn></mfrac><mo>\u2062</mo><mrow><mo maxsize=\"160%\" minsize=\"160%\">(</mo><mrow><msup><mrow><mo>\u2225</mo><mrow><mi>\u03c0</mi><mo>\u2218</mo><mi>id</mi></mrow><mo>\u2225</mo></mrow><mn>2</mn></msup><mo>-</mo><msup><mrow><mo>\u2225</mo><mrow><mi>\u03c0</mi><mo>\u2218</mo><mi>S</mi></mrow><mo>\u2225</mo></mrow><mn>2</mn></msup></mrow><mo maxsize=\"160%\" minsize=\"160%\">)</mo></mrow></mrow><mo>+</mo><msup><mrow><mo fence=\"true\" maxsize=\"120%\" minsize=\"120%\">\u2225</mo><mrow><mrow><mi>\u03c0</mi><mo>\u2218</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>id</mi><mo>+</mo><mi>S</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo fence=\"true\" maxsize=\"120%\" minsize=\"120%\">\u2225</mo></mrow><mn>2</mn></msup></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex56.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\bigl{\\|}\\pi\\circ\\tfrac{1}{2}({\\mathrm{id}}-S)\\bigr{\\|}^{2}+%&#10;\\bigl{\\|}\\pi\\circ\\tfrac{1}{2}({\\mathrm{id}}+S)\\bigr{\\|}^{2},\" display=\"inline\"><mrow><mrow><mi/><mo>=</mo><mrow><msup><mrow><mo fence=\"true\" maxsize=\"120%\" minsize=\"120%\">\u2225</mo><mrow><mrow><mi>\u03c0</mi><mo>\u2218</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>id</mi><mo>-</mo><mi>S</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo fence=\"true\" maxsize=\"120%\" minsize=\"120%\">\u2225</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo fence=\"true\" maxsize=\"120%\" minsize=\"120%\">\u2225</mo><mrow><mrow><mi>\u03c0</mi><mo>\u2218</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>id</mi><mo>+</mo><mi>S</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo fence=\"true\" maxsize=\"120%\" minsize=\"120%\">\u2225</mo></mrow><mn>2</mn></msup></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nWe compare the global mean-square error $E(\\sup_{0\\leq t\\leq T} |y_t - \\hat{y}_t|^2)^{1/2}$, \nestimated by sampling 10000 paths, for three different numerical approximations $\\hat{y}_t$: \n(i) the Milstein scheme, \n(ii) the order 1 word length truncated stochastic Taylor expansion, and \n(iii) the order 1 word length antisymmetric sign reverse scheme.\n\nFigure~\\ref{fig} (top panel) shows the global mean-square error of the \nnumerical approximations against the discretization grid stepsize. \nIn line with our analytical results, \nthe antisymmetric sign reverse integrator gives an improvement \nover the word length stochastic Taylor scheme, \nwhich is in turn more accurate than the Milstein scheme. \n\nWe now consider the linear constant coefficient equation\n$\\mathrm{d}y_t=A_0y_t\\mathrm{d}t+A_1y_t\\mathrm{d}W_t+A_2y_t\\mathrm{d}J_t$, \nwhere $W_t$ is a Wiener process and $J_t$ is the compound Poisson process \n$J_t=\\sum_{i=1}^{N_t} v_i$. Here $N_t$ is a standard Poisson process \nwith intensity $\\lambda$ and independent, identically distributed \nmarks $v_i\\sim\\mathcal{N}(0,\\lambda^{-1})$. \nThe initial condition is again $y_0 = (1,0.5)^{\\mathrm{T}}$. \nWe compare the same three schemes: (i) the Milstein scheme, \n(ii) the order 1 word length truncated stochastic Taylor expansion, \nand (iii) the order 1 word length antisymmetric sign reverse scheme. \nFor our simulations, we have taken $\\lambda=43.40$, and matrices\n\n", "itemtype": "equation", "pos": 82289, "prevtext": "\nWe observe\n$\\bigl\\|\\pi_{{\\mathrm{g}}=n+1}\\circ\\tfrac12({\\mathrm{id}}-S)\\bigr\\|^2\\leq\\|\\pi_{{\\mathrm{g}}=n+1}\\circ{\\mathrm{id}}\\|^2$, giving the result.\nStrong global mean-square order of convergence $n$ for the scheme is a natural consequence.\n\\qed\n\\end{proof}\n\n\n\n\\section{Numerical simulations}\nWe present two numerical experiments demonstrating the results proved above. \nFirst, we study the linear constant coefficient drift-diffusion equation\n$\\mathrm{d}y_t=A_0y_t\\mathrm{d}t+A_1y_t\\mathrm{d}W^1_t+A_2y_t\\mathrm{d}W^2_t$, \nwhere $y_t\\in\\mathbb{R}^2$, the $W^i$ are independent \nWiener processes, the initial condition is $y_0=(1,0.5)^{\\mathrm{T}}$ \nand the coefficients are given by the matrices\n\n", "index": 87, "text": "\\begin{align*}\n A_0=&\\;\\begin{pmatrix} -0.0721 & -0.2173 \\\\ -0.1719 & -0.9581 \\end{pmatrix},\\qquad\n A_1=\\begin{pmatrix} 0.0800 & 0.5769 \\\\ -0.5961 & -0.9619 \\end{pmatrix} \\\\\n & \\qquad\\mathrm{and}\\qquad\n A_2=\\begin{pmatrix} -0.9438 & 0.5520 \\\\ -0.4684 & 0.1591 \\end{pmatrix}.\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex57.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle A_{0}=\" display=\"inline\"><mrow><msub><mi>A</mi><mn>0</mn></msub><mo>=</mo><mi/></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex57.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\;\\begin{pmatrix}-0.0721&amp;-0.2173\\\\&#10;-0.1719&amp;-0.9581\\end{pmatrix},\\qquad A_{1}=\\begin{pmatrix}0.0800&amp;0.5769\\\\&#10;-0.5961&amp;-0.9619\\end{pmatrix}\" display=\"inline\"><mrow><mrow><mrow><mi mathvariant=\"normal\">\u2004</mi><mo>\u2062</mo><mrow><mo>(</mo><mtable columnspacing=\"5pt\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>0.0721</mn></mrow></mtd><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>0.2173</mn></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>0.1719</mn></mrow></mtd><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>0.9581</mn></mrow></mtd></mtr></mtable><mo>)</mo></mrow></mrow><mo rspace=\"22.5pt\">,</mo><msub><mi>A</mi><mn>1</mn></msub></mrow><mo>=</mo><mrow><mo>(</mo><mtable columnspacing=\"5pt\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mn>0.0800</mn></mtd><mtd columnalign=\"center\"><mn>0.5769</mn></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>0.5961</mn></mrow></mtd><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>0.9619</mn></mrow></mtd></mtr></mtable><mo>)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex58.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\qquad\\mathrm{and}\\qquad A_{2}=\\begin{pmatrix}-0.9438&amp;0.5520\\\\&#10;-0.4684&amp;0.1591\\end{pmatrix}.\" display=\"inline\"><mrow><mrow><mrow><mrow><mi>\u2003\u2003</mi><mo>\u2062</mo><mi>and</mi></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003\u2003</mo><msub><mi>A</mi><mn>2</mn></msub></mrow><mo>=</mo><mrow><mo>(</mo><mtable columnspacing=\"5pt\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>0.9438</mn></mrow></mtd><mtd columnalign=\"center\"><mn>0.5520</mn></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>0.4684</mn></mrow></mtd><mtd columnalign=\"center\"><mn>0.1591</mn></mtd></mtr></mtable><mo>)</mo></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nWe observe in Figure~\\ref{fig} (bottom panel) that \nthe antisymmetric sign reverse integrator is more accurate than \nthe word length stochastic Taylor integrator, \nwhich in turn is more accurate than the Milstein scheme. \n\n\\begin{figure}\n\\begin{center}\n\\includegraphics[width=4.6in]{drift_diff_stepsize_new.eps}\n\\includegraphics[width=4.6in]{cp_stepsize_new.eps}\n\\end{center}\n\\caption{For a linear drift-diffusion (top panel) and linear jump-diffusion \n(bottom panel) stochastic differential equations, we \nsee that, with word length grading, the order 1 antisymmetric sign reverse integrator \nis more accurate than the corresponding stochastic Taylor scheme, which in turn is\nmore accurate than the Milstein scheme (which is determined by mean-square grading).}\n\\label{fig}\n\\end{figure}\n\n\n\n\\section{Global convergence}\\label{glob} \nThe error estimates derived in \\textsection 4 are local estimates. \nWe require a means of obtaining global convergence from local error estimates. \nIn the case of drift-diffusion equations, such a mechanism was \nestablished by Milstein \\cite{Mil,MilBook}. In this section we present \na natural generalization of Milstein's theorem to equations driven by L\\'{e}vy processes.  \nThe proof of Milstein's theorem requires the following bounds \nand continuity results for the exact flow. The proofs are standard and \nare not reproduced here, for details see Situ \\cite[p.~76--78]{Sit}, \nFujiwara \\& Kunita \\cite[p.~84--86]{FujKun}, Applebaum \\cite[p.~332--336]{App}. \n\n\\begin{lemma}[Continuity and bounds for flows of L\\'{e}vy-driven equations]\\label{flow lemmas}\nLet $\\varphi_{s,t}$ be the flow of a L\\'{e}vy-driven equation. \nFor any $\\mathcal F_s$-measurable $x,y\\in L^2$, \nand $s<t$ in $[0,T]$, there exists a constant $K>0$ such that: \n(i) $\\|\\varphi_t(y)\\|^2_{L^2}\\leq K(1+\\|y\\|^2_{L^2})$;\n(ii) $\\|\\varphi_{s,t}(y)-y\\|^2_{L^2}\\leq K(t-s)(1+\\|y\\|_{L^2}^2)$;\n(iii) $\\|\\varphi_t(x)-\\varphi_t(y)\\|^2_{L^2}\\leq e^{Kt}\\|x-y\\|^2_{L^2}$\nand (iv) $\\|\\varphi_{s,t}(x)-\\varphi_{s,t}(y)-(x-y)\\|_{L^2}^2\\leq K(t-s)\\|x-y\\|^2_{L^2}$.\n\n\\end{lemma}\nWe now present the generalization of Milstein's theorem to L\\'{e}vy-driven equations. \nEssentially, it states that any Markovian integration scheme for which \nthe local mean-square error converges with order $p$, converges globally \nin the mean-square sense with order $p-1/2$, \nprovided the expectation of the local error is at least of order $p+1/2$. \n\n\\begin{theorem}[Generalized Milstein Theorem]\\label{mt conv}\nLet $\\hat{\\varphi}_{s,t}$ be an approximate flow defined for values $s\\leq t$ \nsuch that $s, t\\in\\{h,2h,\\ldots,T\\}$, where $h$ is the step size of the scheme. \nSuppose that the expectation of the local error of the approximation is of order $p_1$, \nand that the local mean-square error is of order $p_2$, \ni.e.\\/ for any $t<T$ there exists a constant $K$ such that\n\n", "itemtype": "equation", "pos": 83996, "prevtext": "\nWe compare the global mean-square error $E(\\sup_{0\\leq t\\leq T} |y_t - \\hat{y}_t|^2)^{1/2}$, \nestimated by sampling 10000 paths, for three different numerical approximations $\\hat{y}_t$: \n(i) the Milstein scheme, \n(ii) the order 1 word length truncated stochastic Taylor expansion, and \n(iii) the order 1 word length antisymmetric sign reverse scheme.\n\nFigure~\\ref{fig} (top panel) shows the global mean-square error of the \nnumerical approximations against the discretization grid stepsize. \nIn line with our analytical results, \nthe antisymmetric sign reverse integrator gives an improvement \nover the word length stochastic Taylor scheme, \nwhich is in turn more accurate than the Milstein scheme. \n\nWe now consider the linear constant coefficient equation\n$\\mathrm{d}y_t=A_0y_t\\mathrm{d}t+A_1y_t\\mathrm{d}W_t+A_2y_t\\mathrm{d}J_t$, \nwhere $W_t$ is a Wiener process and $J_t$ is the compound Poisson process \n$J_t=\\sum_{i=1}^{N_t} v_i$. Here $N_t$ is a standard Poisson process \nwith intensity $\\lambda$ and independent, identically distributed \nmarks $v_i\\sim\\mathcal{N}(0,\\lambda^{-1})$. \nThe initial condition is again $y_0 = (1,0.5)^{\\mathrm{T}}$. \nWe compare the same three schemes: (i) the Milstein scheme, \n(ii) the order 1 word length truncated stochastic Taylor expansion, \nand (iii) the order 1 word length antisymmetric sign reverse scheme. \nFor our simulations, we have taken $\\lambda=43.40$, and matrices\n\n", "index": 89, "text": "\\begin{align*}\n A_0=&\\;\\begin{pmatrix} -0.6841 & 0.5588 \\\\ 0.9335 & -0.0273 \\end{pmatrix}, \\qquad\n A_1=\\begin{pmatrix} 0.9530 & -0.6357 \\\\ 0.9556 & -0.3250 \\end{pmatrix} \\\\\n &\\qquad\\mathrm{and}\\qquad\n A_2=\\begin{pmatrix} -0.1763 & -0.9088 \\\\ 0.3382 & 0.8925 \\end{pmatrix}.\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex59.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle A_{0}=\" display=\"inline\"><mrow><msub><mi>A</mi><mn>0</mn></msub><mo>=</mo><mi/></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex59.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\;\\begin{pmatrix}-0.6841&amp;0.5588\\\\&#10;0.9335&amp;-0.0273\\end{pmatrix},\\qquad A_{1}=\\begin{pmatrix}0.9530&amp;-0.6357\\\\&#10;0.9556&amp;-0.3250\\end{pmatrix}\" display=\"inline\"><mrow><mrow><mrow><mi mathvariant=\"normal\">\u2004</mi><mo>\u2062</mo><mrow><mo>(</mo><mtable columnspacing=\"5pt\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>0.6841</mn></mrow></mtd><mtd columnalign=\"center\"><mn>0.5588</mn></mtd></mtr><mtr><mtd columnalign=\"center\"><mn>0.9335</mn></mtd><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>0.0273</mn></mrow></mtd></mtr></mtable><mo>)</mo></mrow></mrow><mo rspace=\"22.5pt\">,</mo><msub><mi>A</mi><mn>1</mn></msub></mrow><mo>=</mo><mrow><mo>(</mo><mtable columnspacing=\"5pt\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mn>0.9530</mn></mtd><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>0.6357</mn></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mn>0.9556</mn></mtd><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>0.3250</mn></mrow></mtd></mtr></mtable><mo>)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex60.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\qquad\\mathrm{and}\\qquad A_{2}=\\begin{pmatrix}-0.1763&amp;-0.9088\\\\&#10;0.3382&amp;0.8925\\end{pmatrix}.\" display=\"inline\"><mrow><mrow><mrow><mrow><mi>\u2003\u2003</mi><mo>\u2062</mo><mi>and</mi></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003\u2003</mo><msub><mi>A</mi><mn>2</mn></msub></mrow><mo>=</mo><mrow><mo>(</mo><mtable columnspacing=\"5pt\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>0.1763</mn></mrow></mtd><mtd columnalign=\"center\"><mrow><mo>-</mo><mn>0.9088</mn></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mn>0.3382</mn></mtd><mtd columnalign=\"center\"><mn>0.8925</mn></mtd></mtr></mtable><mo>)</mo></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04880.tex", "nexttext": "\nwhere $p_2\\geq1/2$ and $p_1\\geq p_2 + 1/2$. \nSuppose further that $\\hat{\\varphi}_{s,t}$ is independent of $\\mathcal{F}_s$ for all $s<t$. \nThen the approximation converges globally to the exact flow \nwith strong order $p_2 - 1/2$, \ni.e. there exists a constant $K$ such that for all $t\\in\\{h,2h,\\ldots,T\\}$ we have\n$\\|\\varphi_t(y_0)-\\hat{\\varphi}_t(y_0)\\|_{L^2}\\leq K(1+\\|y_0\\|_{L^2}^2)^{1/2} h^{p_2-1/2}$.\n\\end{theorem}\n\nThe proof given in Milstein~\\cite{Mil,MilBook} for equations driven \nby Wiener processes relies only on the local accuracy of the \napproximation and the continuity and growth bounds for the exact flow \ngiven in the preceding lemma. By Lemma~\\ref{flow lemmas}, these properties \nof the exact flow hold for L\\'{e}vy-driven equations, \nand hence the proof of Milstein immediately generalizes to give the above theorem. \nWe remark that the assumption that $\\hat{\\varphi}_{s,t}$ is independent of \n$\\mathcal{F}_s$ is required, as the local error estimates must hold across \neach computational interval $[s,t]$ where the expectation is taken \nwith respect to $\\mathcal{F}_s$. All the schemes we consider fulfil this property.\n\n\n\\section*{Acknowledgement}\nC.C. would like to thank Michael Tretyakov and Seva Shneer for useful comments.\n\n\n\n\\begin{thebibliography}{9}\n\n\\bibitem{Abe} Abe, E. 1980 \\textit{Hopf algebras}, Cambridge University Press.\n \n\\bibitem{App} Applebaum, D. 2004 \n\\textit{L\\'{e}vy Processes and Stochastic Calculus}, Cambridge University Press.\n  \n\\bibitem{BnMR} Barndorff--Nielsen, O., Mikosch, T., Resnick, S., ed. 2001\n\\textit{L\\'{e}vy processes: theory and applications}, Springer, New York.\n\n\\bibitem{CasGai95} Castell, F., Gaines, J., 1995 \nAn efficient approximation method for stochastic differential equations by means of the exponential Lie series,\n\\textit{Math. Comp. Simulation} \\textbf{38}, 13--19. (doi:10.1016/0378-4754(93)E0062-A)\n\n\\bibitem{CasGai96} Castell, F., Gaines, J., 1996 \nThe ordinary differential equation approach to \nasymptotically efficient schemes for solutions of stochastic differential equations,\n\\textit{Ann. Inst. H. Poincar\\'{e} Probab. Statist.} \\textbf{32}, 231--250.\n\n\\bibitem{Che} Chen, K.-T. 1968 Algebraic paths., \\textit{Journal of Algebra}, \\textbf{10}, 8--36.\n\n\\bibitem{Cla} Clark, J.M.C. 1982 \nAn efficient approximation for a class of stochastic differential equations, \nin \\textit{Advances in Filtering and Optimal Stochastic Control, Cocoyoc, Mexico, \n1982, Lecture Notes in Control and Information Sciences}, \\textbf{42}, \nBerlin etc: Springer. (doi:10.1007/BFb0004526)\n\n\\bibitem{ConTan} Cont, R., Tankov, P. 2004 \n\\textit{Financial Modelling with Jump Processes},\nChapman \\& Hall/CRC.\n\n\\bibitem{Cur} Curry, C., 2014 \n\\textit{Algebraic structures in stochastic differential equations}, \nPhD thesis, Heriot--Watt University.\n\n\\bibitem{CEfMW} Curry, C., Ebrahimi--Fard, K., Malham, S.J.A., Wiese, A. 2014\nL\\'{e}vy processes and quasi-shuffle algebras, \n\\textit{Stochastics} \\textbf{86}(4), 632--642. (doi:10.1080/17442508.2013.865131)\n\n\\bibitem{EfLMMkW} Ebrahimi--Fard, K., Lundervold, A.,  Malham, S.J.A., Munthe--Kaas, H.,\nWiese, A. 2012\nAlgebraic structure of stochastic expansions and efficient simulation,\n\\textit{Proc. R. Soc. A} \\textbf{468}, 2361--2382.\n(doi:10.1098/rspa.2012.0024)\n\n\\bibitem{EfMPW1} Ebrahimi--Fard, L., Malham, S.J.A., Patras, F., Wiese, A., 2015\nFlows and stochastic Taylor series in It\\^{o} calculus,\n\\textit{J. Phys. A.} \\textbf{48}, 495202 (17pp). (doi:10.1088/1751-8113/48/49/495202)\n\n\\bibitem{EfMPW2} Ebrahimi--Fard, L., Malham, S.J.A., Patras, F., Wiese, A., 2015 \nThe exponential Lie series for continuous semimartingales,\n\\textit{Proc. R. Soc. A} \\textbf{471}. (doi:10.1098/rspa.2015.0429)\n\n\\bibitem{EiMac} Eilenberg, S, Mac Lane, S. 1953.\nOn the groups $H(\\pi,n)$.                    \n\\textit{Annals of Mathematics} \\textbf{58}(1), 55--106.\n\n\\bibitem{FriShe} Friz, P., Shekhar, A. 2012 General Rough Integration, \nL\\'{e}vy Rough Paths and a L\\'{e}vy-Kintchine type formula, \\textit{arXiv:1212.5888}.\n\n\\bibitem{FujKun} Fujiwara,  T., Kunita, H. 1985 \nStochastic differential equations of jump type and L\\'{e}vy processes in diffeomorphisms group,\n\\textit{J. Math. Kyoto Univ.} \\textbf{25}(1), 71--106.\n\n\\bibitem{Hof} Hoffman, M.E. 2000 Quasi-shuffle products, \n\\textit{Journal of Algebraic Combinatorics} \\textbf{11}, 49--68. (doi:10.1023/A:1008791603281)\n\n\\bibitem{HofIha} Hoffman, M.E., Ihara, K. 2012 Quasi-shuffle products revisited, Preprint.\nMax-Planck-Institut f{\\\"u}r Mathematik Bonn.\n\n\\bibitem{Gai} Gaines, J. 1994 The algebra of iterated stochastic integrals,\n\\textit{Stochast. and Stochast. Rep.} \\textbf{49}, 169--179. (doi:10.1080/17442509408833918)\n\n\\bibitem{KloPla} Kloeden, P.E., Platen, E. 1999\n\\textit{Numerical Solution of Stochastic Differential Equations} \n(3rd Printing), Berlin etc: Springer.\n\n\\bibitem{KloPlaWri} Kloeden, P.E., Platen, E., Wright, I. 1992 \nThe approximation of multiple stochastic integrals,\n\\textit{Stochastic Anal. Appl.} \\textbf{10}(4), 431--441. (doi:10.1080/07362999208809281)\n\n\\bibitem{LiLiu} Li, C.W., Liu, X.Q. 1997 \nAlgebraic structure of multiple stochastic integrals \nwith respect to Brownian motions and Poisson processes,\n\\textit{Stochastics and Stoch. Reports} \\textbf{61}, 107--120.\n\n\\bibitem{LMW} Lord, G., Malham, S.J.A. \\& Wiese, A. 2008 \nEfficient strong integrators for linear stochastic systems,\n\\textit{SIAM J. Numer. Anal.\\ }\\textbf{46}(6), 2892--2919.  \n\n\\bibitem{MW} Malham, S.J.A., Wiese, A. 2008\nStochastic Lie group integrators, \\textit{SIAM J. Sci. Comput.} \n\\textbf{30}, 597--617. (doi:10.1137/060666743)\n\n\\bibitem{MalWie} Malham, S.J.A., Wiese, A. 2009\nStochastic expansions and Hopf algebras,\n\\textit{Proc. R. Soc. A} \\textbf{465}, 3729--3749.\n(doi:10.1098/rspa.2009.0203)\n\n\\bibitem{Mil} Milstein, G.N. 1987 \nA theorem on the order of convergence of mean-square approximations \nof solutions of systems of stochastic differential equations,\n\\textit{Theor. Prob. Appl.} \\textbf{32}(4), 738--741.\n\n\\bibitem{MilBook} Milstein, G.N. 1995\n\\textit{Numerical integration of stochastic differential equations},\nMathematics and Its Applications \\textbf{313}, Kluwer Academic Publishers.\n\n\\bibitem{New86} Newton, N.J. 1986 \nAn asymptotically efficient difference formula for solving stochastic differential equations, \n\\textit{Stochastics}, \\textbf{19}, 175--206 (doi:10.1080/17442508608833423)\n \n\\bibitem{New91} Newton, N.J. 1991 \nAsymptotically efficient Runge-Kutta methods for a class of It\\^{o} and Stratonovich equations, \n\\textit{SIAM J. Appl. Math.} \\textbf{51}, 542--567. (doi:10.1137/0151028)\n\n\\bibitem{Pla80} Platen, E. 1980 Approximation of It\\^{o} integral equations, In\n\\textit{Stochastic differential systems,} Volume 25 of \n\\textit{Lecture notes in Control and Inform. Sci.}, 172--176. Springer. (doi:10.1007/BFb0004008)\n\n\\bibitem{Pla82} Platen, E. 1982 A generalized Taylor formula \nfor solutions of stochastic differential equations,\n\\textit{SANKHYA A} \\textbf{44}(2), 163--172.\n\n\\bibitem{PlaBl} Platen, E., Bruti--Liberati, N. 2010 \n\\textit{Numerical Solution of Stochastic Differential Equations with Jumps in Finance.}\nBerlin etc: Springer.\n\n\\bibitem{PlaWag} Platen, E., Wagner, W. 1982 On a Taylor formula for a class of It\\^{o} processes,\n\\textit{Probab. Math. Statist.} \\textbf{3}(1), 37--51.\n\n\\bibitem{Pro} Protter, P. 2003 \n\\textit{Stochastic Integration and Differential Equations (2nd ed.)} \nBerlin, etc: Springer.\n\n\\bibitem{Rad} Radford, D.E. 1979 \nA natural ring basis for the shuffle algebra and an application to group schemes, \n\\textit{Journal of Algebra} \\textbf{58}, 432--454. (doi:10.1016/0021-8693(79)90171-6)\n\n\\bibitem{Reu} Reutenauer, C. 1993 \\textit{Free Lie Algebras}, \nLondon Mathematical Society Monographs, Clarendon Press, Oxford.\n\n\\bibitem{Sit} Situ, R. 2005 \n\\textit{Theory of Stochastic Differential Equations with Jumps and Applications:\nMathematical and Analytical Techniques with Applications to Engineering}, Springer.\n\n\\bibitem{Sch} Sch\\\"{u}tzenberger, M.-P. 1958. \nSur une propri\\'{e}t\\'{e} combinatoire des alg\\`{e}bres de \nLie libres pouvant \\^{e}tre utilis\\'{e}e dans un probl\\`{e}me de math\\'{e}matiques appliqu\\'{e}es., \n\\textit{S\\'{e}minaire P. Dubreil. Alg\\`{e}bre et th\\'{e}orie des nombres} \\textbf{12}(1), 1--23.\n\n\\bibitem{Str} Strichartz, R.S. 1987 \nThe Campbell--Baker--Hausdorff--Dynkin formula and solutions of differential equations,\n\\textit{J. Funct. Anal.} \\textbf{72}, 320--345. (doi:10.1016/0022-1236(87)90091-7) \n\n\\bibitem{Suss} Sussmann, H.J. 1986 A product expansion for the Chen series,\n\\textit{Theory and Applications of Nonlinear Control Systems}, C.I. Byrnes and\nA. Lindquist (editors), Elsevier Science Publishers B.V. (North Holland).\n\n\\end{thebibliography}\n\n\n", "itemtype": "equation", "pos": 87128, "prevtext": "\nWe observe in Figure~\\ref{fig} (bottom panel) that \nthe antisymmetric sign reverse integrator is more accurate than \nthe word length stochastic Taylor integrator, \nwhich in turn is more accurate than the Milstein scheme. \n\n\\begin{figure}\n\\begin{center}\n\\includegraphics[width=4.6in]{drift_diff_stepsize_new.eps}\n\\includegraphics[width=4.6in]{cp_stepsize_new.eps}\n\\end{center}\n\\caption{For a linear drift-diffusion (top panel) and linear jump-diffusion \n(bottom panel) stochastic differential equations, we \nsee that, with word length grading, the order 1 antisymmetric sign reverse integrator \nis more accurate than the corresponding stochastic Taylor scheme, which in turn is\nmore accurate than the Milstein scheme (which is determined by mean-square grading).}\n\\label{fig}\n\\end{figure}\n\n\n\n\\section{Global convergence}\\label{glob} \nThe error estimates derived in \\textsection 4 are local estimates. \nWe require a means of obtaining global convergence from local error estimates. \nIn the case of drift-diffusion equations, such a mechanism was \nestablished by Milstein \\cite{Mil,MilBook}. In this section we present \na natural generalization of Milstein's theorem to equations driven by L\\'{e}vy processes.  \nThe proof of Milstein's theorem requires the following bounds \nand continuity results for the exact flow. The proofs are standard and \nare not reproduced here, for details see Situ \\cite[p.~76--78]{Sit}, \nFujiwara \\& Kunita \\cite[p.~84--86]{FujKun}, Applebaum \\cite[p.~332--336]{App}. \n\n\\begin{lemma}[Continuity and bounds for flows of L\\'{e}vy-driven equations]\\label{flow lemmas}\nLet $\\varphi_{s,t}$ be the flow of a L\\'{e}vy-driven equation. \nFor any $\\mathcal F_s$-measurable $x,y\\in L^2$, \nand $s<t$ in $[0,T]$, there exists a constant $K>0$ such that: \n(i) $\\|\\varphi_t(y)\\|^2_{L^2}\\leq K(1+\\|y\\|^2_{L^2})$;\n(ii) $\\|\\varphi_{s,t}(y)-y\\|^2_{L^2}\\leq K(t-s)(1+\\|y\\|_{L^2}^2)$;\n(iii) $\\|\\varphi_t(x)-\\varphi_t(y)\\|^2_{L^2}\\leq e^{Kt}\\|x-y\\|^2_{L^2}$\nand (iv) $\\|\\varphi_{s,t}(x)-\\varphi_{s,t}(y)-(x-y)\\|_{L^2}^2\\leq K(t-s)\\|x-y\\|^2_{L^2}$.\n\n\\end{lemma}\nWe now present the generalization of Milstein's theorem to L\\'{e}vy-driven equations. \nEssentially, it states that any Markovian integration scheme for which \nthe local mean-square error converges with order $p$, converges globally \nin the mean-square sense with order $p-1/2$, \nprovided the expectation of the local error is at least of order $p+1/2$. \n\n\\begin{theorem}[Generalized Milstein Theorem]\\label{mt conv}\nLet $\\hat{\\varphi}_{s,t}$ be an approximate flow defined for values $s\\leq t$ \nsuch that $s, t\\in\\{h,2h,\\ldots,T\\}$, where $h$ is the step size of the scheme. \nSuppose that the expectation of the local error of the approximation is of order $p_1$, \nand that the local mean-square error is of order $p_2$, \ni.e.\\/ for any $t<T$ there exists a constant $K$ such that\n\n", "index": 91, "text": "\\begin{align*}\n\\Bigl|E\\bigl(\\varphi_{t,t+h}(y)-\\hat{\\varphi}_{t,t+h}(y)\\bigr)\\Bigr|&\\leq K(1+|y|^2)^{1/2}h^{p_1},\\\\\n\\|\\varphi_{t,t+h}(y)-\\hat{\\varphi}_{t,t+h}(y)\\|_{L^2}&\\leq K(1+|y|^2)^{1/2}h^{p_2},\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex61.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\Bigl{|}E\\bigl{(}\\varphi_{t,t+h}(y)-\\hat{\\varphi}_{t,t+h}(y)\\bigr%&#10;{)}\\Bigr{|}\" display=\"inline\"><mrow><mo fence=\"true\" maxsize=\"160%\" minsize=\"160%\">|</mo><mrow><mi>E</mi><mo>\u2062</mo><mrow><mo maxsize=\"120%\" minsize=\"120%\">(</mo><mrow><mrow><msub><mi>\u03c6</mi><mrow><mi>t</mi><mo>,</mo><mrow><mi>t</mi><mo>+</mo><mi>h</mi></mrow></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><msub><mover accent=\"true\"><mi>\u03c6</mi><mo stretchy=\"false\">^</mo></mover><mrow><mi>t</mi><mo>,</mo><mrow><mi>t</mi><mo>+</mo><mi>h</mi></mrow></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo maxsize=\"120%\" minsize=\"120%\">)</mo></mrow></mrow><mo fence=\"true\" maxsize=\"160%\" minsize=\"160%\">|</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex61.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\leq K(1+|y|^{2})^{1/2}h^{p_{1}},\" display=\"inline\"><mrow><mrow><mi/><mo>\u2264</mo><mrow><mi>K</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>+</mo><msup><mrow><mo stretchy=\"false\">|</mo><mi>y</mi><mo stretchy=\"false\">|</mo></mrow><mn>2</mn></msup></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow></msup><mo>\u2062</mo><msup><mi>h</mi><msub><mi>p</mi><mn>1</mn></msub></msup></mrow></mrow><mo>,</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex62.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\|\\varphi_{t,t+h}(y)-\\hat{\\varphi}_{t,t+h}(y)\\|_{L^{2}}\" display=\"inline\"><msub><mrow><mo>\u2225</mo><mrow><mrow><msub><mi>\u03c6</mi><mrow><mi>t</mi><mo>,</mo><mrow><mi>t</mi><mo>+</mo><mi>h</mi></mrow></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><msub><mover accent=\"true\"><mi>\u03c6</mi><mo stretchy=\"false\">^</mo></mover><mrow><mi>t</mi><mo>,</mo><mrow><mi>t</mi><mo>+</mo><mi>h</mi></mrow></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>\u2225</mo></mrow><msup><mi>L</mi><mn>2</mn></msup></msub></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex62.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\leq K(1+|y|^{2})^{1/2}h^{p_{2}},\" display=\"inline\"><mrow><mrow><mi/><mo>\u2264</mo><mrow><mi>K</mi><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mn>1</mn><mo>+</mo><msup><mrow><mo stretchy=\"false\">|</mo><mi>y</mi><mo stretchy=\"false\">|</mo></mrow><mn>2</mn></msup></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow></msup><mo>\u2062</mo><msup><mi>h</mi><msub><mi>p</mi><mn>2</mn></msub></msup></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}]