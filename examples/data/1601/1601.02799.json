[{"file": "1601.02799.tex", "nexttext": "\nwhere $\\lambda  \\in \\left[ {0,1} \\right)$, $\\left| {\\left. {m,n} \\right\\rangle } \\right. = {\\left| {\\left. m \\right\\rangle } \\right._A} \\otimes {\\left| {\\left. n \\right\\rangle } \\right._B}$, and ${\\left\\{ {\\left| {\\left.n\\right\\rangle}\\right.}\\right\\}_{n\\in \\mathbb{N}}}$ denotes the Fock state.\n\n\n\n\\begin{figure}[t]\n  \\includegraphics[width=3.45in]{01-fig1-1.eps}\n  \\caption{(Color online) (a) Entanglement-based (EB) scheme of CV QKD with photon subtraction. (b) Prepare-and-measure (PM) scheme of CV QKD with equivalent postselection as \\emph{virtual} photon subtraction. Het: heterodyne detection; Hom: homodyne detection; BS1(2): beams plitter; $\\gamma$: Alice's measurement result; $\\lambda$: parameter of TMSV; $Q\\left(\\gamma,\\lambda,T\\right)$: postselection filter function; $T(\\eta)$: transmittance of BS1(2); $T_C, \\varepsilon$: channel parameters.\n   }\\label{schemetic}\n\\end{figure}\n\nThe EB scheme of CV QKD with photon subtraction inside Alice is shown in Fig. \\ref{schemetic}(a). After generating the TMSV state, Alice uses a beams plitter (BS1), with transmittance $T$, to split the mode $B$ into modes $B_1$ and $B_2$, getting a tripartite state $\\rho_{AB_1B_2}$,\n\n", "itemtype": "equation", "pos": 8363, "prevtext": "\n\n\n\n\\title{ Non-Gaussian postselection and virtual photon subtraction in continuous-variable quantum key distribution }\n\n\n\\author{Zhengyu Li$^{1,2}$}\n\\author{Yichen Zhang$^3$}\n\\author{Xiangyu Wang$^3$}\n\\author{Bingjie Xu$^2$}\n\\author{Xiang Peng$^{1 \\dag }$}\n\\author{Hong Guo$^{1}$}\n\\thanks{Corresponding author: hongguo@pku.edu.cn.\n\\\\$^{\\dag}$Corresponding author: xiangpeng@pku.edu.cn.}\n\n\\affiliation{$^1$State Key Laboratory of Advanced Optical Communication Systems and Networks, Center for Computational Science and Engineering and Center for Quantum Information Technology, School of Electronics Engineering and Computer Science, Peking University, Beijing 100871, China}\n\n\\affiliation{$^2$Science and Technology on Security Communication Laboratory, Institute of Southwestern Communication, Chengdu 610041, China}\n\\affiliation{$^3$State Key Laboratory of Information Photonics and Optical Communications, Beijing University of Posts and Telecommunications, Beijing 100876, China}\n\n\\date{\\today}\n             \n\n\\begin{abstract}\n\nPhoton subtraction can enhance the performance of continuous-variable quantum key distribution (CV QKD). However, the enhancement effect will be reduced by the imperfections of practical devices, especially the limited efficiency of a single-photon detector. In this paper, we propose a \\emph{non-Gaussian} postselection method to emulate the photon substraction used in coherent-state CV QKD protocols.\nThe \\emph{virtual} photon subtraction not only can avoid the complexity and imperfections of a practical photon-subtraction operation, which extends the secure transmission distance as the ideal case does, but also can be adjusted flexibly according to the channel parameters to optimize the performance.\nFurthermore, our preliminary tests on the information reconciliation suggest that in the low signal-to-noise ratio regime, the performance of reconciliating the postselected non-Gaussian data is better than that of the Gaussian data, which implies the feasibility of implementing this method practically.\n\n\n\\end{abstract}\n\n\\pacs{03.67.Dd, 03.67.Hk}\n                             \n\n                              \n\\maketitle\n\n\n\n\n\n\\section{Introduction}\nQuantum key distribution (QKD) \\cite{RevModPhys.74.145.2002, RevModPhys.81.1301.2009} is the most applicable technology of quantum information, which can allow two users (Alice and Bob) to establish secure keys remotely through an insecure quantum channel controlled by an eavesdropper (Eve). QKD has two main branches, i.e., discrete-variable (DV) QKD\nand continuous-variable (CV) QKD \\cite{Rev.Mod.Phys.77.513.2005,Phys.Rep.448.1.2007,Rev.Mod.Phys.84.621.2012}, in which the information is carried by the quadratures ($\\hat x$ and $\\hat p$) of the light field. CV QKD protocols using Gaussian modulated coherent states \\cite{Phys.Rev.Lett.88.057902.2002,Nature.421.238.2003,Phys.Rev.Lett.93.170504.2004} not only have been proved to be unconditionally secure in theory \\cite{Phys.Rev.Lett.97.190502.2006,Phys.Rev.Lett.97.190503.2006,Phys.Rev.Lett.102.110504.2009,Phys.Rev.Lett.110.030502.2013, Phys.Rev.Lett.114.070501.2015}, but also have the advantage of being compatible with standard telecommunication technology, which leads to an expectation of better application.\nHowever, limited by the practical experimental techniques and the non-perfect reconciliation efficiency, the transmission distances of early CV QKD setups were not sufficiently long for network applications \\cite{Phys.Rev.A.76.042305.2007,New.J.Phys.11.045023.2009,Opt.Express.20.14030.2012}. Thus, research on extending the transmission distance has attracted much attention in the past few years.\n\nRecent major progress in CV QKD in experiment \\cite{Nat.Photonics.7.378.2013} was achieved with 80~km transmission distance using coherent states by taking advantage of the multidimensional reconciliation protocol \\cite{Phys.Rev.A.77.042325.2008, Phys.Rev.A.84.062317.2011} in the low signal-to-noise ratio (SNR) regime and the optimization of other experimental aspects. Besides the improvement of experimental techniques, quantum operations were also proposed to improve the performance of CV QKD, such as the noiseless linear amplification (NLA) operation \\cite{T.C.Ralph_NLA_QCMC_2009,Phys.Rev.A.86.012327.2012,Phys.Rev.A.87.062311.2013}. It can increase the transmission distance roughly by the equivalent of~$20{\\log _{10}}g$~dB losses, where $g$ is the gain of the NLA.\n \n Furthermore, to avoid the difficulty of sophisticated physical NLA operations \\cite{Nat.Photonics.4.316.2010, Phys.Rev.Lett.104.123603.2010, Phys.Rev.A.83.063801.2011, Nat.Photonics.5.52.2011}, non-deterministic \\emph{virtual} NLA via Gaussian postselection has been proposed \\cite{Phys.Rev.A.86.060302.2012,Phys.Rev.A.87.020303.2013} and experimentally implemented \\cite{Nat.Photonics.8.333.2014}.\n\n\n\n\nAlternatively, a photon-subtraction operation \\cite{Phys.Rev.A.61.032302.2000, Phys.Rev.A.71.043805.2005, Phys.Rev.A.73.042310.2006, Phys.Rev.A.86.012328.2012} is shown to be able to significantly improve the transmission distance of CV QKD protocols using two-mode squeezed vacuum (TMSV) states \\cite{Phys.Rev.A.87.012317.2013}. By exploiting the equivalence between the entanglement-based (EB) scheme and the prepare-and-measure (PM) scheme, it can also be employed in protocols using coherent states. However, the improvement will be reduced by the imperfections of devices in a practical photon-subtraction operation, especially the single-photon detector (SPD), which makes this method unfeasible (see Appendix \\ref{imperfect}).\n\n\n\nHere, we propose a \\emph{non-Gaussian} postselection method to emulate the photon subtraction used in coherent-state CV QKD protocols, which is employed right before the emission of the coherent states. One advantage of this \\emph{virtual} photon subtraction is that, it can not only remove the complex physical operations, but also emulate the ideal photon-subtraction operations. Another advantage is that the postselection can be postponed after the parameter estimation, and therefore it can be adjusted flexibly to optimize the performance.\nBesides, the postselection filter function does not need a cutoff amplitude as does the one in virtual NLA \\cite{Phys.Rev.A.86.060302.2012,Phys.Rev.A.87.020303.2013,Nat.Photonics.8.333.2014}, because it is bounded.\n\nFurthermore, our preliminary tests on the information reconciliation of the postselected non-Gaussian data suggest that the multidimensional reconciliation\nalgorithm can be directly used for the \\emph{virtual} photon-subtraction method. Especially in the low signal-to-noise ratio regime, the performance of reconciliating the postselected non-Gaussian data is even better than that of the Gaussian data, which implies the feasibility of implementing this method practically.\n\nThis paper is organized as follows: In Sec. II, we introduce some basics of the photon subtraction and propose the equivalent postselection method of the photon-subtraction operation in a coherent-state CV QKD protocol. In Sec. III, we present the performance of the \\emph{virtual} photon subtraction through numerical simulation, the optimal choice of the parameter in \\emph{virtual} photon subtraction, and the tests of information reconciliation on the postselected non-Gaussian data. In Sec. IV, we summarize the paper.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\section{Photon Subtraction and its equivalent postselection in CV QKD}\nPhoton subtraction can enhance the entanglement of the TMSV state. Various scenarios were proposed, including applying photon subtraction on one mode or both modes of the TMSV \\cite{Phys.Rev.A.73.042310.2006}, directly or after a pure lossy channel \\cite{Phys.Rev.A.82.062316.2010}.\nTo make our derivation self-contained, in this section, we first introduce the basics of photon subtraction on a TMSV state (noted as the photon-subtracted TMSV state), then propose its equivalent non-Gaussian postselection in CV QKD protocols (noted as \\emph{virtual} photon subtraction).\n\n\n\\subsection{Photon Subtraction of a TMSV State}\nThe TMSV state involves two modes $A$ and $B$. $\\{ \\hat a, {{\\hat a}^\\dag } \\}$ and $\\{ \\hat b, {\\hat b}^\\dag \\}$ denote the annihilation and creation operator of modes $A$ and $B$, respectively, where $[ {\\hat a,{{\\hat a}^\\dag }} ] = [ {\\hat b,{{\\hat b}^\\dag }} ] = 1$. A TMSV state can be expressed by\n\n", "index": 1, "text": "\\begin{equation}\n\\left| {\\left. {{\\rm{TMSV}}} \\right\\rangle } \\right.  = \\sqrt {1 - {\\lambda ^2}} \\sum\\limits_{n = 0}^\\infty  {{\\lambda ^n}\\left| {\\left. {n,n} \\right\\rangle } \\right.},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"\\left|{\\left.{{\\rm{TMSV}}}\\right\\rangle}\\right.=\\sqrt{1-{\\lambda^{2}}}\\sum%&#10;\\limits_{n=0}^{\\infty}{{\\lambda^{n}}\\left|{\\left.{n,n}\\right\\rangle}\\right.},\" display=\"block\"><mrow><mrow><mrow><mo fence=\"true\">|</mo><mi>TMSV</mi><mo>\u27e9</mo></mrow><mo>=</mo><mrow><msqrt><mrow><mn>1</mn><mo>-</mo><msup><mi>\u03bb</mi><mn>2</mn></msup></mrow></msqrt><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi mathvariant=\"normal\">\u221e</mi></munderover><mrow><msup><mi>\u03bb</mi><mi>n</mi></msup><mo>\u2062</mo><mrow><mo fence=\"true\">|</mo><mrow><mi>n</mi><mo>,</mo><mi>n</mi></mrow><mo>\u27e9</mo></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\nThen $B_1$ will be measured by a positive operator-valued measure (POVM) measurement $\\{ {{\\hat \\Pi _0},{\\hat \\Pi _1}} \\}$, and the modes $A$ and $B_2$ will be kept only when the POVM element $\\hat \\Pi _1$ clicks. The kept state $\\rho _{A{B_2}}^{{\\hat \\Pi _1}}$ is denoted as the photon-subtracted TMSV state,\n\n", "itemtype": "equation", "pos": 9743, "prevtext": "\nwhere $\\lambda  \\in \\left[ {0,1} \\right)$, $\\left| {\\left. {m,n} \\right\\rangle } \\right. = {\\left| {\\left. m \\right\\rangle } \\right._A} \\otimes {\\left| {\\left. n \\right\\rangle } \\right._B}$, and ${\\left\\{ {\\left| {\\left.n\\right\\rangle}\\right.}\\right\\}_{n\\in \\mathbb{N}}}$ denotes the Fock state.\n\n\n\n\\begin{figure}[t]\n  \\includegraphics[width=3.45in]{01-fig1-1.eps}\n  \\caption{(Color online) (a) Entanglement-based (EB) scheme of CV QKD with photon subtraction. (b) Prepare-and-measure (PM) scheme of CV QKD with equivalent postselection as \\emph{virtual} photon subtraction. Het: heterodyne detection; Hom: homodyne detection; BS1(2): beams plitter; $\\gamma$: Alice's measurement result; $\\lambda$: parameter of TMSV; $Q\\left(\\gamma,\\lambda,T\\right)$: postselection filter function; $T(\\eta)$: transmittance of BS1(2); $T_C, \\varepsilon$: channel parameters.\n   }\\label{schemetic}\n\\end{figure}\n\nThe EB scheme of CV QKD with photon subtraction inside Alice is shown in Fig. \\ref{schemetic}(a). After generating the TMSV state, Alice uses a beams plitter (BS1), with transmittance $T$, to split the mode $B$ into modes $B_1$ and $B_2$, getting a tripartite state $\\rho_{AB_1B_2}$,\n\n", "index": 3, "text": "\\begin{equation}\n{\\rho _{A{B_1}{B_2}}} = {U_{BS}}\\left[ {\\left| \\rm{TMSV} \\right\\rangle \\left\\langle \\rm{TMSV} \\right| \\otimes \\left| 0 \\right\\rangle \\left\\langle 0 \\right|} \\right]U_{BS}^\\dag.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"{\\rho_{A{B_{1}}{B_{2}}}}={U_{BS}}\\left[{\\left|\\rm{TMSV}\\right\\rangle\\left%&#10;\\langle\\rm{TMSV}\\right|\\otimes\\left|0\\right\\rangle\\left\\langle 0\\right|}\\right%&#10;]U_{BS}^{\\dagger}.\" display=\"block\"><mrow><mrow><msub><mi>\u03c1</mi><mrow><mi>A</mi><mo>\u2062</mo><msub><mi>B</mi><mn>1</mn></msub><mo>\u2062</mo><msub><mi>B</mi><mn>2</mn></msub></mrow></msub><mo>=</mo><mrow><msub><mi>U</mi><mrow><mi>B</mi><mo>\u2062</mo><mi>S</mi></mrow></msub><mo>\u2062</mo><mrow><mo>[</mo><mrow><mrow><mo fence=\"true\">|</mo><mi>TMSV</mi><mo>\u27e9</mo></mrow><mo>\u2062</mo><mrow><mo>\u27e8</mo><mi>TMSV</mi><mo fence=\"true\">|</mo><mo>\u2297</mo><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mo>\u2062</mo><mrow><mo>\u27e8</mo><mn>0</mn><mo fence=\"true\">|</mo></mrow></mrow><mo>]</mo></mrow><mo>\u2062</mo><msubsup><mi>U</mi><mrow><mi>B</mi><mo>\u2062</mo><mi>S</mi></mrow><mo>\u2020</mo></msubsup></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\nwhere ${\\rm{tr}}_{X}(\\cdot)$ is the partial trace of a multimode quantum state, and $P^{{{\\hat \\Pi }_1}} = {{\\rm{tr}}_{A{B_1}{B_2}}}( {{{\\hat \\Pi }_1}{\\rho _{A{B_1}{B_2}}}} )$ is the success probability of $\\hat\\Pi_1$ clicks.\n\n Different $\\hat \\Pi_1$ will lead to different types of photon-subtraction. A general photon subtraction operation is subtracting $k$ photons, which refers to $\\hat \\Pi_1 = |k\\rangle \\langle k|$ and can be realized by a photon number resolving (PNR) detector \\cite{Rev.Sci.Instrum.82.071101.2011}. And it is shown in \\cite{Phys.Rev.A.86.012328.2012} that the entanglement will increase as more photons are subtracted.\n The photon subtraction can also be extended to the mixture of subtracting different $k$ photons, ${{\\hat \\Pi }_1}{\\rm{ = }}\\sum\\nolimits_{k = 0}^\\infty  {{c_k}\\left| k \\right\\rangle \\left\\langle k \\right|}  $ and ${c_k} \\in \\left\\{ {0,1} \\right\\}$, among which ${{\\hat \\Pi }_{on}}{\\rm{ = }}\\sum\\nolimits_{k = 1}^\\infty  {\\left| k \\right\\rangle \\left\\langle k \\right|}  =  \\mathbb{I}- \\left| 0 \\right\\rangle \\left\\langle 0 \\right|$ corresponds to an on-off detector. See Appendix \\ref{k-photon subtraction} for more details about the above two examples.\n\n\\subsection{Virtual Photon Subtraction in CV QKD via Postselection}\nWe suppose Alice uses the photon-subtracted TMSV state as the source of a CV QKD system, and she will perform a heterodyne detection on mode $A$.\nAs shown in Fig. \\ref{schemetic}(a), the measurement result of a single-photon detector represents either keeping this state (click) or not keeping this state (no click). Alice needs to record this extra data for each TMSV, and will reveal it to Bob after Bob measures the mode $B_3$.\n\nAccording to the extemality of Gaussian quantum states \\cite{Phys.Rev.Lett.96.080502.2006,Phys.Rev.Lett.97.190502.2006,Phys.Rev.Lett.97.190503.2006}, the secret key rate of the state $\\rho_{AB_3}^{\\hat \\Pi _1}$ is no less than a Gaussian state $\\rho_{AB_3}^{G}$ which has the same covariance matrix, where $K(\\rho_{AB_3}^{\\hat \\Pi _1}) \\ge K(\\rho_{AB_3}^{G})$. Thus we will use $\\rho_{AB_3}^{G}$ to derive the secret key rate. Besides, the success probability of Alice's POVM measurement $P^{{{\\hat \\Pi }_1}}$ should also be taken into account. Thus, for the reverse reconciliation, the lower bound of the asymptotic secret key rate under collective attack is\n\n", "itemtype": "equation", "pos": 10262, "prevtext": "\nThen $B_1$ will be measured by a positive operator-valued measure (POVM) measurement $\\{ {{\\hat \\Pi _0},{\\hat \\Pi _1}} \\}$, and the modes $A$ and $B_2$ will be kept only when the POVM element $\\hat \\Pi _1$ clicks. The kept state $\\rho _{A{B_2}}^{{\\hat \\Pi _1}}$ is denoted as the photon-subtracted TMSV state,\n\n", "index": 5, "text": "\\begin{equation}\n\\rho _{A{B_2}}^{{{\\hat \\Pi }_1}} = \\frac{{{{\\rm{tr}} _{{B_1}}}( {{\\hat \\Pi _1}{\\rho _{A{B_1}{B_2}}}} )}}{{{{\\rm{tr}}_{A{B_1}{B_2}}} ( {{\\hat \\Pi _1}{\\rho _{A{B_1}{B_2}}}} )}}.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"\\rho_{A{B_{2}}}^{{{\\hat{\\Pi}}_{1}}}=\\frac{{{{\\rm{tr}}_{{B_{1}}}}({{\\hat{\\Pi}_{%&#10;1}}{\\rho_{A{B_{1}}{B_{2}}}}})}}{{{{\\rm{tr}}_{A{B_{1}}{B_{2}}}}({{\\hat{\\Pi}_{1}%&#10;}{\\rho_{A{B_{1}}{B_{2}}}}})}}.\" display=\"block\"><mrow><mrow><msubsup><mi>\u03c1</mi><mrow><mi>A</mi><mo>\u2062</mo><msub><mi>B</mi><mn>2</mn></msub></mrow><msub><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a0</mi><mo stretchy=\"false\">^</mo></mover><mn>1</mn></msub></msubsup><mo>=</mo><mfrac><mrow><msub><mi>tr</mi><msub><mi>B</mi><mn>1</mn></msub></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a0</mi><mo stretchy=\"false\">^</mo></mover><mn>1</mn></msub><mo>\u2062</mo><msub><mi>\u03c1</mi><mrow><mi>A</mi><mo>\u2062</mo><msub><mi>B</mi><mn>1</mn></msub><mo>\u2062</mo><msub><mi>B</mi><mn>2</mn></msub></mrow></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msub><mi>tr</mi><mrow><mi>A</mi><mo>\u2062</mo><msub><mi>B</mi><mn>1</mn></msub><mo>\u2062</mo><msub><mi>B</mi><mn>2</mn></msub></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a0</mi><mo stretchy=\"false\">^</mo></mover><mn>1</mn></msub><mo>\u2062</mo><msub><mi>\u03c1</mi><mrow><mi>A</mi><mo>\u2062</mo><msub><mi>B</mi><mn>1</mn></msub><mo>\u2062</mo><msub><mi>B</mi><mn>2</mn></msub></mrow></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\nwhere $\\beta$ is the reconciliation efficiency, $I^G{\\left(A:B\\right)}$ is the mutual information between Alice and Bob, $S^G\\left(E:B\\right)$ is the Holevo bound \\cite{QCQC.Nielsen.2000} of the mutual information between Bob and Eve. The calculation method of $K$ is shown in the Appendix \\ref{SKRcal}.\n\nNext, we will present the equivalent \\emph{virtual} photon subtraction via postselection according to Alice's measurement results, which will benefit the system. First, it is not necessary to accomplish the practical photon subtraction which reduces the complexity of the system. Second, it has better performance than the practical photon subtraction since one can emulate the ideal detector case.\n\nThe heterodyne detection and the POVM measurement $\\{ {{\\hat \\Pi _0},{\\hat \\Pi _1}} \\}$ are commutable since they are conducted on two different modes. Thus, Alice can perform the heterodyne detection on mode $A$ first, and then the POVM measurement on mode $B_1$. It is known that heterodyne detection on one mode of the TMSV state will project the other mode onto a coherent state; thus after BS1, the state of modes $B_1$ and $B_2$, given that Alice's heterodyne measurement results are $\\left\\{ {{x_A},{p_A}} \\right\\}$, is ${\\left| {{\\varphi ^{\\left( {{x_A},{p_A}} \\right)}}} \\right\\rangle _{{B_1}{B_2}}} = {\\left| {\\sqrt {1 - T} \\alpha } \\right\\rangle _{{B_1}}}{\\left| {\\sqrt T \\alpha } \\right\\rangle _{{B_2}}}$, where ${{\\alpha  = \\sqrt 2 \\lambda \\left( {{x_A} - i{p_A}} \\right)} \\mathord{\\left/ {\\vphantom {{\\alpha  = \\sqrt 2 \\lambda \\left( {{x_A} + i{p_A}} \\right)} 2}} \\right. \\kern-\\nulldelimiterspace} 2}$.\nThe success probability of subtracting $k$ photons, given Alice's heterodyne measurement results, will be the function of $\\left\\{ {{x_A},{p_A}} \\right\\}$,\n\n", "itemtype": "equation", "pos": 12830, "prevtext": "\nwhere ${\\rm{tr}}_{X}(\\cdot)$ is the partial trace of a multimode quantum state, and $P^{{{\\hat \\Pi }_1}} = {{\\rm{tr}}_{A{B_1}{B_2}}}( {{{\\hat \\Pi }_1}{\\rho _{A{B_1}{B_2}}}} )$ is the success probability of $\\hat\\Pi_1$ clicks.\n\n Different $\\hat \\Pi_1$ will lead to different types of photon-subtraction. A general photon subtraction operation is subtracting $k$ photons, which refers to $\\hat \\Pi_1 = |k\\rangle \\langle k|$ and can be realized by a photon number resolving (PNR) detector \\cite{Rev.Sci.Instrum.82.071101.2011}. And it is shown in \\cite{Phys.Rev.A.86.012328.2012} that the entanglement will increase as more photons are subtracted.\n The photon subtraction can also be extended to the mixture of subtracting different $k$ photons, ${{\\hat \\Pi }_1}{\\rm{ = }}\\sum\\nolimits_{k = 0}^\\infty  {{c_k}\\left| k \\right\\rangle \\left\\langle k \\right|}  $ and ${c_k} \\in \\left\\{ {0,1} \\right\\}$, among which ${{\\hat \\Pi }_{on}}{\\rm{ = }}\\sum\\nolimits_{k = 1}^\\infty  {\\left| k \\right\\rangle \\left\\langle k \\right|}  =  \\mathbb{I}- \\left| 0 \\right\\rangle \\left\\langle 0 \\right|$ corresponds to an on-off detector. See Appendix \\ref{k-photon subtraction} for more details about the above two examples.\n\n\\subsection{Virtual Photon Subtraction in CV QKD via Postselection}\nWe suppose Alice uses the photon-subtracted TMSV state as the source of a CV QKD system, and she will perform a heterodyne detection on mode $A$.\nAs shown in Fig. \\ref{schemetic}(a), the measurement result of a single-photon detector represents either keeping this state (click) or not keeping this state (no click). Alice needs to record this extra data for each TMSV, and will reveal it to Bob after Bob measures the mode $B_3$.\n\nAccording to the extemality of Gaussian quantum states \\cite{Phys.Rev.Lett.96.080502.2006,Phys.Rev.Lett.97.190502.2006,Phys.Rev.Lett.97.190503.2006}, the secret key rate of the state $\\rho_{AB_3}^{\\hat \\Pi _1}$ is no less than a Gaussian state $\\rho_{AB_3}^{G}$ which has the same covariance matrix, where $K(\\rho_{AB_3}^{\\hat \\Pi _1}) \\ge K(\\rho_{AB_3}^{G})$. Thus we will use $\\rho_{AB_3}^{G}$ to derive the secret key rate. Besides, the success probability of Alice's POVM measurement $P^{{{\\hat \\Pi }_1}}$ should also be taken into account. Thus, for the reverse reconciliation, the lower bound of the asymptotic secret key rate under collective attack is\n\n", "index": 7, "text": "\\begin{equation}\\label{SKR}\nK\\left( {\\rho _{A{B_3}}^G} \\right) = {P^{{{\\hat \\Pi }_1}}}\\left( {\\beta{I^G}\\left( {A:B} \\right) - {S^G}\\left( {E:B} \\right)} \\right),\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"K\\left({\\rho_{A{B_{3}}}^{G}}\\right)={P^{{{\\hat{\\Pi}}_{1}}}}\\left({\\beta{I^{G}}%&#10;\\left({A:B}\\right)-{S^{G}}\\left({E:B}\\right)}\\right),\" display=\"block\"><mrow><mi>K</mi><mrow><mo>(</mo><msubsup><mi>\u03c1</mi><mrow><mi>A</mi><mo>\u2062</mo><msub><mi>B</mi><mn>3</mn></msub></mrow><mi>G</mi></msubsup><mo>)</mo></mrow><mo>=</mo><msup><mi>P</mi><msub><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a0</mi><mo stretchy=\"false\">^</mo></mover><mn>1</mn></msub></msup><mrow><mo>(</mo><mi>\u03b2</mi><msup><mi>I</mi><mi>G</mi></msup><mrow><mo>(</mo><mi>A</mi><mo>:</mo><mi>B</mi><mo>)</mo></mrow><mo>-</mo><msup><mi>S</mi><mi>G</mi></msup><mrow><mo>(</mo><mi>E</mi><mo>:</mo><mi>B</mi><mo>)</mo></mrow><mo>)</mo></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\nThen the mixed state output from Alice's station will be\n\n", "itemtype": "equation", "pos": 14787, "prevtext": "\nwhere $\\beta$ is the reconciliation efficiency, $I^G{\\left(A:B\\right)}$ is the mutual information between Alice and Bob, $S^G\\left(E:B\\right)$ is the Holevo bound \\cite{QCQC.Nielsen.2000} of the mutual information between Bob and Eve. The calculation method of $K$ is shown in the Appendix \\ref{SKRcal}.\n\nNext, we will present the equivalent \\emph{virtual} photon subtraction via postselection according to Alice's measurement results, which will benefit the system. First, it is not necessary to accomplish the practical photon subtraction which reduces the complexity of the system. Second, it has better performance than the practical photon subtraction since one can emulate the ideal detector case.\n\nThe heterodyne detection and the POVM measurement $\\{ {{\\hat \\Pi _0},{\\hat \\Pi _1}} \\}$ are commutable since they are conducted on two different modes. Thus, Alice can perform the heterodyne detection on mode $A$ first, and then the POVM measurement on mode $B_1$. It is known that heterodyne detection on one mode of the TMSV state will project the other mode onto a coherent state; thus after BS1, the state of modes $B_1$ and $B_2$, given that Alice's heterodyne measurement results are $\\left\\{ {{x_A},{p_A}} \\right\\}$, is ${\\left| {{\\varphi ^{\\left( {{x_A},{p_A}} \\right)}}} \\right\\rangle _{{B_1}{B_2}}} = {\\left| {\\sqrt {1 - T} \\alpha } \\right\\rangle _{{B_1}}}{\\left| {\\sqrt T \\alpha } \\right\\rangle _{{B_2}}}$, where ${{\\alpha  = \\sqrt 2 \\lambda \\left( {{x_A} - i{p_A}} \\right)} \\mathord{\\left/ {\\vphantom {{\\alpha  = \\sqrt 2 \\lambda \\left( {{x_A} + i{p_A}} \\right)} 2}} \\right. \\kern-\\nulldelimiterspace} 2}$.\nThe success probability of subtracting $k$ photons, given Alice's heterodyne measurement results, will be the function of $\\left\\{ {{x_A},{p_A}} \\right\\}$,\n\n", "index": 9, "text": "\\begin{equation}\n\\begin{array}{*{20}{l}}\n{{P^{{{\\hat \\Pi }_1}}}\\left( {k|{x_A},{p_A}} \\right) = {{\\left| {\\left\\langle {k}\n \\mathrel{\\left | {\\vphantom {k {\\sqrt {1 - T} \\alpha }}}\n \\right. \\kern-\\nulldelimiterspace}\n {{\\sqrt {1 - T} \\alpha }} \\right\\rangle } \\right|}^2}}\\\\\n{ = \\exp \\left[ { - \\frac{{\\left( {1 - T} \\right){\\lambda ^2}}}{2}\\left( {x_A^2 + p_A^2} \\right)} \\right]{{ \\cdot {{\\left[ {\\frac{{\\left( {1 - T} \\right){\\lambda ^2}}}{2}\\left( {x_A^2 + p_A^2} \\right)} \\right]}^k}} \\mathord{\\left/\n {\\vphantom {{ \\cdot {{\\left[ {\\frac{{\\left( {1 - T} \\right){\\lambda ^2}}}{2}\\left( {x_A^2 + p_A^2} \\right)} \\right]}^k}} {k!}}} \\right.\n \\kern-\\nulldelimiterspace} {k!}}}\n\\end{array}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{*{20}{l}}{{P^{{{\\hat{\\Pi}}_{1}}}}\\left({k|{x_{A}},{p_{A}}}%&#10;\\right)={{\\left|{\\left\\langle{k}\\mathrel{\\left|{\\vphantom{k{\\sqrt{1-T}\\alpha}}%&#10;}\\right.\\kern-1.2pt}{{\\sqrt{1-T}\\alpha}}\\right\\rangle}\\right|}^{2}}}\\\\&#10;{=\\exp\\left[{-\\frac{{\\left({1-T}\\right){\\lambda^{2}}}}{2}\\left({x_{A}^{2}+p_{A%&#10;}^{2}}\\right)}\\right]{{\\cdot{{\\left[{\\frac{{\\left({1-T}\\right){\\lambda^{2}}}}{%&#10;2}\\left({x_{A}^{2}+p_{A}^{2}}\\right)}\\right]}^{k}}}\\mathord{\\left/{\\vphantom{{%&#10;\\cdot{{\\left[{\\frac{{\\left({1-T}\\right){\\lambda^{2}}}}{2}\\left({x_{A}^{2}+p_{A%&#10;}^{2}}\\right)}\\right]}^{k}}}{k!}}}\\right.\\kern-1.2pt}{k!}}}\\end{array}\" display=\"block\"><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><msup><mi>P</mi><msub><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a0</mi><mo stretchy=\"false\">^</mo></mover><mn>1</mn></msub></msup><mrow><mo>(</mo><mi>k</mi><mo stretchy=\"false\">|</mo><msub><mi>x</mi><mi>A</mi></msub><mo>,</mo><msub><mi>p</mi><mi>A</mi></msub><mo>)</mo></mrow><mo>=</mo><mo>|</mo><mrow><mo>\u27e8</mo><mi>k</mi><mo>|</mo><msqrt><mrow><mn>1</mn><mo>-</mo><mi>T</mi></mrow></msqrt><mi>\u03b1</mi><mo>\u27e9</mo></mrow><msup><mo>|</mo><mn>2</mn></msup></mrow></mtd><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/></mtr><mtr><mtd columnalign=\"left\"><mrow><mi/><mo>=</mo><mrow><mrow><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo>[</mo><mrow><mo>-</mo><mrow><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><mi>T</mi></mrow><mo>)</mo></mrow><mo>\u2062</mo><msup><mi>\u03bb</mi><mn>2</mn></msup></mrow><mn>2</mn></mfrac><mo>\u2062</mo><mrow><mo>(</mo><mrow><msubsup><mi>x</mi><mi>A</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>p</mi><mi>A</mi><mn>2</mn></msubsup></mrow><mo>)</mo></mrow></mrow></mrow><mo>]</mo></mrow></mrow><mo>\u22c5</mo><msup><mrow><mo>[</mo><mrow><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><mi>T</mi></mrow><mo>)</mo></mrow><mo>\u2062</mo><msup><mi>\u03bb</mi><mn>2</mn></msup></mrow><mn>2</mn></mfrac><mo>\u2062</mo><mrow><mo>(</mo><mrow><msubsup><mi>x</mi><mi>A</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>p</mi><mi>A</mi><mn>2</mn></msubsup></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow><mi>k</mi></msup></mrow><mo>\u2062</mo><mi mathvariant=\"normal\">/</mi><mo>\u2062</mo><mrow><mi>k</mi><mo lspace=\"0pt\" rspace=\"3.5pt\">!</mo></mrow></mrow></mrow></mtd><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/></mtr></mtable></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\nwhere ${P_{{x_A},{p_A}}} = \\frac{1}{{\\pi \\left( {V + 1} \\right)}}\\exp \\left( { - \\frac{{x_A^2 + p_A^2}}{{V + 1}}} \\right)$ is the Gaussian distribution of Alice's heterodyne measurement results, and $V = {{\\left( {1 + {\\lambda ^2}} \\right)} \\mathord{\\left/\n {\\vphantom {{\\left( {1 + {\\lambda ^2}} \\right)} {\\left( {1 - {\\lambda ^2}} \\right)}}} \\right.\n \\kern-\\nulldelimiterspace} {\\left( {1 - {\\lambda ^2}} \\right)}}$ is the variance of the TMSV state.\n\nIn the case where Alice does not use any kind of photon-subtraction operation, the output mixed state is\n\n", "itemtype": "equation", "pos": 15549, "prevtext": "\nThen the mixed state output from Alice's station will be\n\n", "index": 11, "text": "\\begin{equation}\\label{PS_EQ}\n\\rho _{{B_2}}^{\\left(k\\right)} = \\int {\\mathbf{d}{x_A}\\mathbf{d}{p_A}\\underbrace {\\frac{{{P^{{{\\hat \\Pi }_1}}}\\left( {k|{x_A},{p_A}} \\right)}}{{{P^{{{\\hat \\Pi }_1}}}\\left( k \\right)}}}_{\\scriptstyle{\\rm{weighting~function}}}{P_{{x_A},{p_A}}}\\left| {\\sqrt T \\alpha } \\right\\rangle \\left\\langle {\\sqrt T \\alpha } \\right|},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"\\rho_{{B_{2}}}^{\\left(k\\right)}=\\int{\\mathbf{d}{x_{A}}\\mathbf{d}{p_{A}}%&#10;\\underbrace{\\frac{{{P^{{{\\hat{\\Pi}}_{1}}}}\\left({k|{x_{A}},{p_{A}}}\\right)}}{{%&#10;{P^{{{\\hat{\\Pi}}_{1}}}}\\left(k\\right)}}}_{\\scriptstyle{\\rm{weighting~{}%&#10;function}}}{P_{{x_{A}},{p_{A}}}}\\left|{\\sqrt{T}\\alpha}\\right\\rangle\\left%&#10;\\langle{\\sqrt{T}\\alpha}\\right|},\" display=\"block\"><mrow><mrow><msubsup><mi>\u03c1</mi><msub><mi>B</mi><mn>2</mn></msub><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></msubsup><mo>=</mo><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mrow><mo>\ud835\udc1d</mo><msub><mi>x</mi><mi>A</mi></msub></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc1d</mo><msub><mi>p</mi><mi>A</mi></msub></mrow><mo>\u2062</mo><munder><munder accentunder=\"true\"><mfrac><mrow><msup><mi>P</mi><msub><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a0</mi><mo movablelimits=\"false\" stretchy=\"false\">^</mo></mover><mn>1</mn></msub></msup><mrow><mo movablelimits=\"false\">(</mo><mi>k</mi><mo movablelimits=\"false\" stretchy=\"false\">|</mo><msub><mi>x</mi><mi>A</mi></msub><mo movablelimits=\"false\">,</mo><msub><mi>p</mi><mi>A</mi></msub><mo movablelimits=\"false\">)</mo></mrow></mrow><mrow><msup><mi>P</mi><msub><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a0</mi><mo movablelimits=\"false\" stretchy=\"false\">^</mo></mover><mn>1</mn></msub></msup><mo movablelimits=\"false\">\u2062</mo><mrow><mo movablelimits=\"false\">(</mo><mi>k</mi><mo movablelimits=\"false\">)</mo></mrow></mrow></mfrac><mo movablelimits=\"false\">\u23df</mo></munder><mrow><mpadded width=\"+3.3pt\"><mi>weighting</mi></mpadded><mo>\u2062</mo><mi>function</mi></mrow></munder><mo>\u2062</mo><msub><mi>P</mi><mrow><msub><mi>x</mi><mi>A</mi></msub><mo>,</mo><msub><mi>p</mi><mi>A</mi></msub></mrow></msub><mo>\u2062</mo><mrow><mo fence=\"true\">|</mo><mrow><msqrt><mi>T</mi></msqrt><mo>\u2062</mo><mi>\u03b1</mi></mrow><mo>\u27e9</mo></mrow><mo>\u2062</mo><mrow><mo>\u27e8</mo><mrow><msqrt><mi>T</mi></msqrt><mo>\u2062</mo><mi>\u03b1</mi></mrow><mo fence=\"true\">|</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\nCompared with the postselected state in Eq. (\\ref{PS_EQ}), there are two differences. Firstly, there is an additional weighting function in Eq. (\\ref{PS_EQ}),\n \n", "itemtype": "equation", "pos": 16474, "prevtext": "\nwhere ${P_{{x_A},{p_A}}} = \\frac{1}{{\\pi \\left( {V + 1} \\right)}}\\exp \\left( { - \\frac{{x_A^2 + p_A^2}}{{V + 1}}} \\right)$ is the Gaussian distribution of Alice's heterodyne measurement results, and $V = {{\\left( {1 + {\\lambda ^2}} \\right)} \\mathord{\\left/\n {\\vphantom {{\\left( {1 + {\\lambda ^2}} \\right)} {\\left( {1 - {\\lambda ^2}} \\right)}}} \\right.\n \\kern-\\nulldelimiterspace} {\\left( {1 - {\\lambda ^2}} \\right)}}$ is the variance of the TMSV state.\n\nIn the case where Alice does not use any kind of photon-subtraction operation, the output mixed state is\n\n", "index": 13, "text": "\\begin{equation}\n\\rho _{{B}}^{\\left(G\\right)} = \\int {\\mathbf{d}{x_A}\\mathbf{d}{p_A}{P_{{x_A},{p_A}}}\\left| { \\alpha } \\right\\rangle \\left\\langle { \\alpha } \\right|}.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"\\rho_{{B}}^{\\left(G\\right)}=\\int{\\mathbf{d}{x_{A}}\\mathbf{d}{p_{A}}{P_{{x_{A}}%&#10;,{p_{A}}}}\\left|{\\alpha}\\right\\rangle\\left\\langle{\\alpha}\\right|}.\" display=\"block\"><mrow><mrow><msubsup><mi>\u03c1</mi><mi>B</mi><mrow><mo>(</mo><mi>G</mi><mo>)</mo></mrow></msubsup><mo>=</mo><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mrow><mo>\ud835\udc1d</mo><msub><mi>x</mi><mi>A</mi></msub></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc1d</mo><msub><mi>p</mi><mi>A</mi></msub></mrow><mo>\u2062</mo><msub><mi>P</mi><mrow><msub><mi>x</mi><mi>A</mi></msub><mo>,</mo><msub><mi>p</mi><mi>A</mi></msub></mrow></msub><mo>\u2062</mo><mrow><mo fence=\"true\">|</mo><mi>\u03b1</mi><mo>\u27e9</mo></mrow><mo>\u2062</mo><mrow><mo>\u27e8</mo><mi>\u03b1</mi><mo fence=\"true\">|</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\nwhich leads to a filter function, or acceptance probability, of each pair of $\\left\\{ {{x_A},{p_A}} \\right\\}$,\n\n", "itemtype": "equation", "pos": 16816, "prevtext": "\nCompared with the postselected state in Eq. (\\ref{PS_EQ}), there are two differences. Firstly, there is an additional weighting function in Eq. (\\ref{PS_EQ}),\n \n", "index": 15, "text": "\\begin{equation}\n W = \\frac{{{P^{{{\\hat \\Pi }_1}}}\\left( {k|{x_A},{p_A}} \\right)}}{{{P^{{{\\hat \\Pi }_1}}}\\left( k \\right)}},\\nonumber\n \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"W=\\frac{{{P^{{{\\hat{\\Pi}}_{1}}}}\\left({k|{x_{A}},{p_{A}}}\\right)}}{{{P^{{{\\hat%&#10;{\\Pi}}_{1}}}}\\left(k\\right)}},\" display=\"block\"><mrow><mrow><mi>W</mi><mo>=</mo><mfrac><mrow><msup><mi>P</mi><msub><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a0</mi><mo stretchy=\"false\">^</mo></mover><mn>1</mn></msub></msup><mrow><mo>(</mo><mi>k</mi><mo stretchy=\"false\">|</mo><msub><mi>x</mi><mi>A</mi></msub><mo>,</mo><msub><mi>p</mi><mi>A</mi></msub><mo>)</mo></mrow></mrow><mrow><msup><mi>P</mi><msub><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a0</mi><mo stretchy=\"false\">^</mo></mover><mn>1</mn></msub></msup><mo>\u2062</mo><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></mrow></mfrac></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\nSecond, the output coherent state needs to go through the BS1 with transmittance $T$, which can be emulated via generating a coherent state with a smaller mean value $\\sqrt T \\alpha$.\n\n\nThus, after exchanging Alice's heterodyne measurement and the photon-subtraction operation, we get the equivalent \\emph{virtual} photon subtraction via postselection of Alice's measurement results and scaling the mean value of output coherent state by a factor $\\sqrt T$. The postselection filter function is shown in Eq.(\\ref{Filter Function}).\n\n\nIn summary, the PM scheme of CV QKD using \\emph{virtual} photon subtraction, depicted in Fig. \\ref{schemetic}(b), is as follow:\n\n{\\emph{Step 1.}} Alice generates a coherent state  $ \\left| \\alpha  \\right\\rangle $, where $\\alpha  = \\sqrt {2T} \\lambda {\\gamma  \\mathord{\\left/\n {\\vphantom {\\gamma  2}} \\right.\n \\kern-\\nulldelimiterspace} 2}$, $\\gamma  = {x_A} + i{p_A}$, and $\\left\\{{x_A}, {p_A}\\right\\}$ are chosen randomly from a Gaussian distributed set with zero mean and variance $V_{x_A} = V_{x_B} = {{\\left( {V + 1} \\right)} \\mathord{\\left/\n {\\vphantom {{\\left( {V + 1} \\right)} 2}} \\right. \\kern-\\nulldelimiterspace} 2}$. $T$ is the transmittance of BS1 and $V$ is the variance of the equivalent TMSV. Then she sends the coherent state to Bob.\n\n{\\emph{Step 2.}} After receiving the state, Bob will perform homodyne or heterodyne detection, and the measurement results are denoted by ${x_B, p_B}$.\n\n{\\emph{Step 3.}} \\emph{Steps 1} and \\emph{2} are repeated until they collect enough data. Alice will decide which data will be accepted, and reveals the decisions to Bob. The acceptance probability for each data is $Q\\left( {\\gamma ,\\lambda ,T} \\right)$ as in Eq. (\\ref{Filter Function}). Then Alice and Bob use the accepted data to finish the postprocessing steps, including parameter estimation, information reconciliation and privacy amplification.\n\nSince Alice reveals her decision of whether or not she accepts each data after Bob's measurement, the discarded states can be seen as the decoy states,\n\nwhich are used in the former non-Gaussian protocol \\cite{Phys.Rev.A.83.042312.2011} to enhance the security.\n\nWe note that for the practical implementation, the secret key rate, given by Eq. (\\ref{SKR}), should be modified to take finite-size effects into account \\cite{Phys.Rev.A.81.062343.2010}, which indicates that the acceptance probability will influence the finite-size analysis. However, this will not affect the effectiveness of our method; therefore, we only consider the asymptotic rate here for simplicity.\n\n\\section{Performance of the protocols}\nIn this section, we first present the performance of the protocols using photon subtraction in terms of secret key rate and tolerable excess noise, through numerical simulations. Then we discuss the transmittance of Alice's BS1, and the reconciliation efficiency of the postselected non-Gaussian data.\nAs described in Sec. II B, we will use Eq.(\\ref{SKR}) as the asymptotic secret key rate. Since it only involves the Gaussian state, the covariance matrix of $\\rho_{AB_3}^{\\left(k\\right)}$ will be sufficient to get the rate, which can be gotten according to Alice's and Bob's accepted data when implementing this protocol practically. Here in the simulation we assume that the channel can be characterized by two parameters: the channel transmittance $T_C$ and excess noise $\\varepsilon$, which means if the covariance matrix of $\\rho_{AB_2}^{\\left(k\\right)}$ is\n\n", "itemtype": "equation", "pos": 17077, "prevtext": "\nwhich leads to a filter function, or acceptance probability, of each pair of $\\left\\{ {{x_A},{p_A}} \\right\\}$,\n\n", "index": 17, "text": "\\begin{equation}\n Q\\left( {\\gamma ,\\lambda ,T} \\right) = {{{P^{{{\\hat \\Pi }_1}}}\\left( k \\right)}}W= {{P^{{{\\hat \\Pi }_1}}}\\left( {k|{x_A},{p_A}} \\right)}.\\label{Filter Function}\n \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m1\" class=\"ltx_Math\" alttext=\"Q\\left({\\gamma,\\lambda,T}\\right)={{{P^{{{\\hat{\\Pi}}_{1}}}}\\left(k\\right)}}W={{%&#10;P^{{{\\hat{\\Pi}}_{1}}}}\\left({k|{x_{A}},{p_{A}}}\\right)}.\" display=\"block\"><mrow><mi>Q</mi><mrow><mo>(</mo><mi>\u03b3</mi><mo>,</mo><mi>\u03bb</mi><mo>,</mo><mi>T</mi><mo>)</mo></mrow><mo>=</mo><msup><mi>P</mi><msub><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a0</mi><mo stretchy=\"false\">^</mo></mover><mn>1</mn></msub></msup><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow><mi>W</mi><mo>=</mo><msup><mi>P</mi><msub><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a0</mi><mo stretchy=\"false\">^</mo></mover><mn>1</mn></msub></msup><mrow><mo>(</mo><mi>k</mi><mo stretchy=\"false\">|</mo><msub><mi>x</mi><mi>A</mi></msub><mo>,</mo><msub><mi>p</mi><mi>A</mi></msub><mo>)</mo></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\nwhere $\\mathbb{I} = $ diag(1,1) and $\\sigma _Z =$ diag(1,-1), then, after the channel transmission,\n\n", "itemtype": "equation", "pos": 20739, "prevtext": "\nSecond, the output coherent state needs to go through the BS1 with transmittance $T$, which can be emulated via generating a coherent state with a smaller mean value $\\sqrt T \\alpha$.\n\n\nThus, after exchanging Alice's heterodyne measurement and the photon-subtraction operation, we get the equivalent \\emph{virtual} photon subtraction via postselection of Alice's measurement results and scaling the mean value of output coherent state by a factor $\\sqrt T$. The postselection filter function is shown in Eq.(\\ref{Filter Function}).\n\n\nIn summary, the PM scheme of CV QKD using \\emph{virtual} photon subtraction, depicted in Fig. \\ref{schemetic}(b), is as follow:\n\n{\\emph{Step 1.}} Alice generates a coherent state  $ \\left| \\alpha  \\right\\rangle $, where $\\alpha  = \\sqrt {2T} \\lambda {\\gamma  \\mathord{\\left/\n {\\vphantom {\\gamma  2}} \\right.\n \\kern-\\nulldelimiterspace} 2}$, $\\gamma  = {x_A} + i{p_A}$, and $\\left\\{{x_A}, {p_A}\\right\\}$ are chosen randomly from a Gaussian distributed set with zero mean and variance $V_{x_A} = V_{x_B} = {{\\left( {V + 1} \\right)} \\mathord{\\left/\n {\\vphantom {{\\left( {V + 1} \\right)} 2}} \\right. \\kern-\\nulldelimiterspace} 2}$. $T$ is the transmittance of BS1 and $V$ is the variance of the equivalent TMSV. Then she sends the coherent state to Bob.\n\n{\\emph{Step 2.}} After receiving the state, Bob will perform homodyne or heterodyne detection, and the measurement results are denoted by ${x_B, p_B}$.\n\n{\\emph{Step 3.}} \\emph{Steps 1} and \\emph{2} are repeated until they collect enough data. Alice will decide which data will be accepted, and reveals the decisions to Bob. The acceptance probability for each data is $Q\\left( {\\gamma ,\\lambda ,T} \\right)$ as in Eq. (\\ref{Filter Function}). Then Alice and Bob use the accepted data to finish the postprocessing steps, including parameter estimation, information reconciliation and privacy amplification.\n\nSince Alice reveals her decision of whether or not she accepts each data after Bob's measurement, the discarded states can be seen as the decoy states,\n\nwhich are used in the former non-Gaussian protocol \\cite{Phys.Rev.A.83.042312.2011} to enhance the security.\n\nWe note that for the practical implementation, the secret key rate, given by Eq. (\\ref{SKR}), should be modified to take finite-size effects into account \\cite{Phys.Rev.A.81.062343.2010}, which indicates that the acceptance probability will influence the finite-size analysis. However, this will not affect the effectiveness of our method; therefore, we only consider the asymptotic rate here for simplicity.\n\n\\section{Performance of the protocols}\nIn this section, we first present the performance of the protocols using photon subtraction in terms of secret key rate and tolerable excess noise, through numerical simulations. Then we discuss the transmittance of Alice's BS1, and the reconciliation efficiency of the postselected non-Gaussian data.\nAs described in Sec. II B, we will use Eq.(\\ref{SKR}) as the asymptotic secret key rate. Since it only involves the Gaussian state, the covariance matrix of $\\rho_{AB_3}^{\\left(k\\right)}$ will be sufficient to get the rate, which can be gotten according to Alice's and Bob's accepted data when implementing this protocol practically. Here in the simulation we assume that the channel can be characterized by two parameters: the channel transmittance $T_C$ and excess noise $\\varepsilon$, which means if the covariance matrix of $\\rho_{AB_2}^{\\left(k\\right)}$ is\n\n", "index": 19, "text": "\\begin{equation}\n\\gamma _{A{B_2}}^{\\left( k \\right)} = \\left( {\\begin{array}{*{20}{c}}\n{{V_A\\mathbb{I}}}&{{\\phi _{AB}}{\\sigma _Z}}\\\\\n{{\\phi _{AB}}{\\sigma _Z}}&{{V_B\\mathbb{I}}}\n\\end{array}} \\right),\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m1\" class=\"ltx_Math\" alttext=\"\\gamma_{A{B_{2}}}^{\\left(k\\right)}=\\left({\\begin{array}[]{*{20}{c}}{{V_{A}%&#10;\\mathbb{I}}}&amp;{{\\phi_{AB}}{\\sigma_{Z}}}\\\\&#10;{{\\phi_{AB}}{\\sigma_{Z}}}&amp;{{V_{B}\\mathbb{I}}}\\end{array}}\\right),\" display=\"block\"><mrow><mrow><msubsup><mi>\u03b3</mi><mrow><mi>A</mi><mo>\u2062</mo><msub><mi>B</mi><mn>2</mn></msub></mrow><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></msubsup><mo>=</mo><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><msub><mi>V</mi><mi>A</mi></msub><mo>\u2062</mo><mi>\ud835\udd40</mi></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\u03d5</mi><mrow><mi>A</mi><mo>\u2062</mo><mi>B</mi></mrow></msub><mo>\u2062</mo><msub><mi>\u03c3</mi><mi>Z</mi></msub></mrow></mtd><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/></mtr><mtr><mtd columnalign=\"center\"><mrow><msub><mi>\u03d5</mi><mrow><mi>A</mi><mo>\u2062</mo><mi>B</mi></mrow></msub><mo>\u2062</mo><msub><mi>\u03c3</mi><mi>Z</mi></msub></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>V</mi><mi>B</mi></msub><mo>\u2062</mo><mi>\ud835\udd40</mi></mrow></mtd><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/></mtr></mtable><mo>)</mo></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\nwhere $\\chi = {{{\\left( {1 - {T_C}} \\right)} \\mathord{\\left/\n {\\vphantom {{\\left( {1 - {T_C}} \\right)} {{T_C}}}} \\right.\n \\kern-\\nulldelimiterspace} {{T_C}}}}+\\varepsilon$. The explicit form of $\\gamma_{AB_2}^{\\left(k\\right)}$ can be found in Appendix \\ref{CM of PS}. And for the rest of the paper, we assume Bob uses homodyne detection.\nWe note that Eve's optimal attack for this non-Gaussian protocol is still an open question.\n\n\\subsection{Secret Key Rate and Tolerable Excess Noise}\n\\begin{figure}[t]\n\\includegraphics[width=2.9in]{03-kPS-SKR-Topt-2in1.eps}\n\n\\caption{(Color online) (a) The maximal secret key rate at each transmission distance, when changing the transmittance $T$ of Alice's BS1. (b) The optimal $T$ for the maximal secret key rate in (a). The uppermost black solid line in (a) represents the case of original protocol. Other lines represent one-photon subtraction (blue solid line), two-photon subtraction (green dashed line), three-photon subtraction (pink dotted line), and four-photon subtraction (red dash-dotted line), respectively. The simulation parameters are as follows: the variance of TMSV state is $V = 20$, channel loss is $a = 0.2$dB/km, excess noise is $\\varepsilon = 0.01$, and reconciliation efficiency is $\\beta = 0.95$.\n}\\label{BestSKR}\n\\end{figure}\n\nFor the \\emph{virtual} $k$-photon subtraction, the transmittance $T$ of Alice's BS1 can be chosen arbitrarily from 0 to 1, which will result in the change of overall acceptance probability ${P^{{{\\hat \\Pi }_1}}}\\left( k \\right)$ and also the covariance matrix of $\\gamma _{A{B_2}}^{\\left( k \\right)}$. Thus, for each transmission distance, the secret key rate varies with different $T$, and there should exist an optimal choice of $T$ for each distance to maximize the secret key rate. Figure \\ref{BestSKR}(a) shows the maximal secret key rate at each distance for all possible $T$. And Fig. \\ref{BestSKR}(b) shows the optimal choice of $T$ for each distance, specifically, only for distances with secret key rate more than $10^{-6}$, respectively.\n\n\\begin{figure}[t]\n\\includegraphics[width=2.9in]{04-kPS-TEN-Topt-2in1.eps}\n\n\\caption{(Color online) (a) The maximal tolerable excess noise at each transmission distance, when changing the transmittance $T$ of Alice's BS1. (b) The optimal $T$ for the maximal tolerable excess noise in (a). The uppermost black solid line in (a) represents the case of original protocol. Other lines represent one-photon subtraction (blue solid line), two-photon subtraction (green dashed line), three-photon subtraction (pink dotted line), and four-photon subtraction (red dash-dotted line), respectively. The simulation parameters are $V = 20$, $a = 0.2$dB/km, $\\varepsilon = 0.01$, and $\\beta = 0.95$.\n}\\label{BestTEN}\n\\end{figure}\n\nThe black solid line in Fig. \\ref{BestSKR}(a) represents the case of the original protocol, which is outperformed by the protocols of using photon subtraction at long-distance range, especially the case of using one-photon subtraction (blue solid line). This implies one of the advantages of using photon subtraction, that is, expanding the maximal transmission distance.\nHowever, for the short-distance range, even for the optimal choice of $T$, the secret key rate is still worse than the original protocol. One reason is the limited acceptance probability, which is below 0.25 under the parameters we used here (see Fig. \\ref{psucc}).\n\nFig. \\ref{BestSKR}(a) also shows that the one-photon subtraction has the longest transmission distance compared to the other cases.\nThe main reason is that, when subtracting more photons, the non-Gaussianity is higher \\cite{Phys.Rev.A.86.012328.2012}, which means the\nGaussian state that has the same covariance matrix, $\\rho_{AB_2}^G$, is more noisy. Thus, when employing the extremality of Gaussian quantum states to do the security analysis, it gets a\nworse result. More specifically, we rewrite the covariance matrix $\\gamma _{A{B_2}}^{\\left( k \\right)}$ as follows:\n\n", "itemtype": "equation", "pos": 21053, "prevtext": "\nwhere $\\mathbb{I} = $ diag(1,1) and $\\sigma _Z =$ diag(1,-1), then, after the channel transmission,\n\n", "index": 21, "text": "\\begin{equation}\n\\gamma _{A{B_3}}^{\\left( k \\right)} = \\left( {\\begin{array}{*{20}{c}}\n{{V_A\\mathbb{I}}}&{\\sqrt {{T_C}} {\\phi _{AB}}{\\sigma _Z}}\\\\\n{\\sqrt {{T_C}} {\\phi _{AB}}{\\sigma _Z}}&{ {{T_C}\\left( {{V_B}+ \\chi } \\right) } \\mathbb{I}}\n\\end{array}} \\right),\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E10.m1\" class=\"ltx_Math\" alttext=\"\\gamma_{A{B_{3}}}^{\\left(k\\right)}=\\left({\\begin{array}[]{*{20}{c}}{{V_{A}%&#10;\\mathbb{I}}}&amp;{\\sqrt{{T_{C}}}{\\phi_{AB}}{\\sigma_{Z}}}\\\\&#10;{\\sqrt{{T_{C}}}{\\phi_{AB}}{\\sigma_{Z}}}&amp;{{{T_{C}}\\left({{V_{B}}+\\chi}\\right)}%&#10;\\mathbb{I}}\\end{array}}\\right),\" display=\"block\"><mrow><mrow><msubsup><mi>\u03b3</mi><mrow><mi>A</mi><mo>\u2062</mo><msub><mi>B</mi><mn>3</mn></msub></mrow><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></msubsup><mo>=</mo><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><msub><mi>V</mi><mi>A</mi></msub><mo>\u2062</mo><mi>\ud835\udd40</mi></mrow></mtd><mtd columnalign=\"center\"><mrow><msqrt><msub><mi>T</mi><mi>C</mi></msub></msqrt><mo>\u2062</mo><msub><mi>\u03d5</mi><mrow><mi>A</mi><mo>\u2062</mo><mi>B</mi></mrow></msub><mo>\u2062</mo><msub><mi>\u03c3</mi><mi>Z</mi></msub></mrow></mtd><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/></mtr><mtr><mtd columnalign=\"center\"><mrow><msqrt><msub><mi>T</mi><mi>C</mi></msub></msqrt><mo>\u2062</mo><msub><mi>\u03d5</mi><mrow><mi>A</mi><mo>\u2062</mo><mi>B</mi></mrow></msub><mo>\u2062</mo><msub><mi>\u03c3</mi><mi>Z</mi></msub></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>T</mi><mi>C</mi></msub><mo>\u2062</mo><mrow><mo>(</mo><mrow><msub><mi>V</mi><mi>B</mi></msub><mo>+</mo><mi>\u03c7</mi></mrow><mo>)</mo></mrow><mo>\u2062</mo><mi>\ud835\udd40</mi></mrow></mtd><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/></mtr></mtable><mo>)</mo></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\nwhere ${V_A} = 2\\tilde V - 1$, $\\chi_A = {{{\\left( {1 - {\\eta _A}} \\right)} \\mathord{\\left/\n {\\vphantom {{\\left( {1 - {\\eta _A}} \\right)} {{\\eta _A}}}} \\right.\n \\kern-\\nulldelimiterspace} {{\\eta _A}}}}$, and\n\n", "itemtype": "equation", "pos": 25297, "prevtext": "\nwhere $\\chi = {{{\\left( {1 - {T_C}} \\right)} \\mathord{\\left/\n {\\vphantom {{\\left( {1 - {T_C}} \\right)} {{T_C}}}} \\right.\n \\kern-\\nulldelimiterspace} {{T_C}}}}+\\varepsilon$. The explicit form of $\\gamma_{AB_2}^{\\left(k\\right)}$ can be found in Appendix \\ref{CM of PS}. And for the rest of the paper, we assume Bob uses homodyne detection.\nWe note that Eve's optimal attack for this non-Gaussian protocol is still an open question.\n\n\\subsection{Secret Key Rate and Tolerable Excess Noise}\n\\begin{figure}[t]\n\\includegraphics[width=2.9in]{03-kPS-SKR-Topt-2in1.eps}\n\n\\caption{(Color online) (a) The maximal secret key rate at each transmission distance, when changing the transmittance $T$ of Alice's BS1. (b) The optimal $T$ for the maximal secret key rate in (a). The uppermost black solid line in (a) represents the case of original protocol. Other lines represent one-photon subtraction (blue solid line), two-photon subtraction (green dashed line), three-photon subtraction (pink dotted line), and four-photon subtraction (red dash-dotted line), respectively. The simulation parameters are as follows: the variance of TMSV state is $V = 20$, channel loss is $a = 0.2$dB/km, excess noise is $\\varepsilon = 0.01$, and reconciliation efficiency is $\\beta = 0.95$.\n}\\label{BestSKR}\n\\end{figure}\n\nFor the \\emph{virtual} $k$-photon subtraction, the transmittance $T$ of Alice's BS1 can be chosen arbitrarily from 0 to 1, which will result in the change of overall acceptance probability ${P^{{{\\hat \\Pi }_1}}}\\left( k \\right)$ and also the covariance matrix of $\\gamma _{A{B_2}}^{\\left( k \\right)}$. Thus, for each transmission distance, the secret key rate varies with different $T$, and there should exist an optimal choice of $T$ for each distance to maximize the secret key rate. Figure \\ref{BestSKR}(a) shows the maximal secret key rate at each distance for all possible $T$. And Fig. \\ref{BestSKR}(b) shows the optimal choice of $T$ for each distance, specifically, only for distances with secret key rate more than $10^{-6}$, respectively.\n\n\\begin{figure}[t]\n\\includegraphics[width=2.9in]{04-kPS-TEN-Topt-2in1.eps}\n\n\\caption{(Color online) (a) The maximal tolerable excess noise at each transmission distance, when changing the transmittance $T$ of Alice's BS1. (b) The optimal $T$ for the maximal tolerable excess noise in (a). The uppermost black solid line in (a) represents the case of original protocol. Other lines represent one-photon subtraction (blue solid line), two-photon subtraction (green dashed line), three-photon subtraction (pink dotted line), and four-photon subtraction (red dash-dotted line), respectively. The simulation parameters are $V = 20$, $a = 0.2$dB/km, $\\varepsilon = 0.01$, and $\\beta = 0.95$.\n}\\label{BestTEN}\n\\end{figure}\n\nThe black solid line in Fig. \\ref{BestSKR}(a) represents the case of the original protocol, which is outperformed by the protocols of using photon subtraction at long-distance range, especially the case of using one-photon subtraction (blue solid line). This implies one of the advantages of using photon subtraction, that is, expanding the maximal transmission distance.\nHowever, for the short-distance range, even for the optimal choice of $T$, the secret key rate is still worse than the original protocol. One reason is the limited acceptance probability, which is below 0.25 under the parameters we used here (see Fig. \\ref{psucc}).\n\nFig. \\ref{BestSKR}(a) also shows that the one-photon subtraction has the longest transmission distance compared to the other cases.\nThe main reason is that, when subtracting more photons, the non-Gaussianity is higher \\cite{Phys.Rev.A.86.012328.2012}, which means the\nGaussian state that has the same covariance matrix, $\\rho_{AB_2}^G$, is more noisy. Thus, when employing the extremality of Gaussian quantum states to do the security analysis, it gets a\nworse result. More specifically, we rewrite the covariance matrix $\\gamma _{A{B_2}}^{\\left( k \\right)}$ as follows:\n\n", "index": 23, "text": "\\begin{equation}\n\\gamma _{A{B_2}}^{\\left( k \\right)} = \\left( {\\begin{array}{*{20}{c}}\n{{V_A\\mathbb{I}}}&{\\sqrt {{\\eta _A}\\left( {V_A^2 - 1} \\right)} {\\sigma _Z}}\\\\\n{\\sqrt {{\\eta _A}\\left( {V_A^2 - 1} \\right)} {\\sigma _Z}}&{{\\eta _A}\\left( {{V_A} + \\chi_A } \\right)\\mathbb{I}}\n\\end{array}} \\right),\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E11.m1\" class=\"ltx_Math\" alttext=\"\\gamma_{A{B_{2}}}^{\\left(k\\right)}=\\left({\\begin{array}[]{*{20}{c}}{{V_{A}%&#10;\\mathbb{I}}}&amp;{\\sqrt{{\\eta_{A}}\\left({V_{A}^{2}-1}\\right)}{\\sigma_{Z}}}\\\\&#10;{\\sqrt{{\\eta_{A}}\\left({V_{A}^{2}-1}\\right)}{\\sigma_{Z}}}&amp;{{\\eta_{A}}\\left({{V%&#10;_{A}}+\\chi_{A}}\\right)\\mathbb{I}}\\end{array}}\\right),\" display=\"block\"><mrow><mrow><msubsup><mi>\u03b3</mi><mrow><mi>A</mi><mo>\u2062</mo><msub><mi>B</mi><mn>2</mn></msub></mrow><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></msubsup><mo>=</mo><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><msub><mi>V</mi><mi>A</mi></msub><mo>\u2062</mo><mi>\ud835\udd40</mi></mrow></mtd><mtd columnalign=\"center\"><mrow><msqrt><mrow><msub><mi>\u03b7</mi><mi>A</mi></msub><mo>\u2062</mo><mrow><mo>(</mo><mrow><msubsup><mi>V</mi><mi>A</mi><mn>2</mn></msubsup><mo>-</mo><mn>1</mn></mrow><mo>)</mo></mrow></mrow></msqrt><mo>\u2062</mo><msub><mi>\u03c3</mi><mi>Z</mi></msub></mrow></mtd><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/></mtr><mtr><mtd columnalign=\"center\"><mrow><msqrt><mrow><msub><mi>\u03b7</mi><mi>A</mi></msub><mo>\u2062</mo><mrow><mo>(</mo><mrow><msubsup><mi>V</mi><mi>A</mi><mn>2</mn></msubsup><mo>-</mo><mn>1</mn></mrow><mo>)</mo></mrow></mrow></msqrt><mo>\u2062</mo><msub><mi>\u03c3</mi><mi>Z</mi></msub></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>\u03b7</mi><mi>A</mi></msub><mo>\u2062</mo><mrow><mo>(</mo><mrow><msub><mi>V</mi><mi>A</mi></msub><mo>+</mo><msub><mi>\u03c7</mi><mi>A</mi></msub></mrow><mo>)</mo></mrow><mo>\u2062</mo><mi>\ud835\udd40</mi></mrow></mtd><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/></mtr></mtable><mo>)</mo></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\nThis means, in the viewpoint of calculating the secret key rate, the $k$-photon-subtracted TMSV can be seen as a source with an extra loss on the $B_2$ mode before being emitted into the channel.\nAnd $\\eta_A$ decreases as the photon-subtraction number $k$ increases, especially when the optimal $T$ is lower for higher $k$ at long-distance range, which implies that subtracting more photons will result in more loss. Therefore, subtracting one photon shows better performance under the conditions of Fig. \\ref{BestSKR}, i.e., the initial variance of TMSV is 20.\n\nTolerable excess noise represents another aspect of a protocol.\nFigure \\ref{BestTEN}(a) shows the maximal tolerable excess noise at each distance for all possible $T$, and Fig. \\ref{BestTEN}(b) shows the optimal choice of $T$ for each distance. Similar to Fig. \\ref{BestSKR}(a), the case of original protocol (black solid line) is also outperformed by other cases at long transmission distance range, which implies another advantage of using photon subtraction that increases the maximal tolerable excess noise for distant users. It is also shown that when the channel is less noisy, for instance, $\\varepsilon  \\sim 0.005$, all four photon-subtraction operations will expand the maximal transmission distance to more than $200\\rm{km}$.\nOn the other hand, one could notice that the optimal choice of $T$ for the maximal tolerable excess noise shows a different form from the one for the maximal secret key rate. That is because the tolerable excess noise is not affected by the overall acceptance probability, while the secret key rate is.\n\n\n\\subsection{The Transmittance of Alice's Beamsplitter}\nIn \\emph{Step 1} of the PM scheme using \\emph{virtual} photon subtraction described in Sec. II, it requires Alice to know the value of $T$ in advance. For a relatively stable system and environment, Alice can use the data of the last run to approximately estimate the optimal $T$ for this run. However, when the system or environment changes rapidly, the above method may not result in a suitable estimation. In this case, one can linearly scale Alice's heterodyne measurement results first and then accomplish the postselection.\nAfter the linearly scaling, Alice's data follows a new Gaussian distribution $P{'_{{X_A},{P_A}}}$ with a different variance ${V}'$, which can be regarded as the heterodyne measurement results of a new equivalent TMSV. We assume\n $T_0$ is the estimated value according to the data of the last run, and $\\eta$ is the real optimal choice of this run. Let ${X_A} = G{x_A}$,\n${P_A} = G{p_A}$,\n and ${\\alpha _A} = {{\\sqrt 2 \\lambda '\\left( {{X_A} - i{P_A}} \\right)} \\mathord{\\left/ {\\vphantom {{\\sqrt 2 \\lambda '\\left( {{X_A} - i{P_A}} \\right)} 2}} \\right. \\kern-\\nulldelimiterspace} 2} = \\sqrt {{{{T_0}} \\mathord{\\left/\n {\\vphantom {{{T_0}} \\eta }} \\right. \\kern-\\nulldelimiterspace} \\eta }} \\cdot\\alpha  $, where $G = {{\\sqrt {{T_0}} \\lambda } \\mathord{\\left/\n {\\vphantom {{\\sqrt {{T_0}} \\lambda } {\\sqrt \\eta  \\lambda '}}} \\right.\n \\kern-\\nulldelimiterspace} {\\sqrt \\eta  \\lambda '}}$ and $\\lambda {'^2} = {{\\left( {V' - 1} \\right)} \\mathord{\\left/\n {\\vphantom {{\\left( {V' - 1} \\right)} {\\left( {V' + 1} \\right)}}} \\right.\n \\kern-\\nulldelimiterspace} {\\left( {V' + 1} \\right)}}$. Then the state Alice initially sends out can be rewritten as\n\n", "itemtype": "equation", "pos": 25819, "prevtext": "\nwhere ${V_A} = 2\\tilde V - 1$, $\\chi_A = {{{\\left( {1 - {\\eta _A}} \\right)} \\mathord{\\left/\n {\\vphantom {{\\left( {1 - {\\eta _A}} \\right)} {{\\eta _A}}}} \\right.\n \\kern-\\nulldelimiterspace} {{\\eta _A}}}}$, and\n\n", "index": 25, "text": "\\begin{equation}\n {\\eta _A} = {\\lambda ^2}T\\frac{{k + 1}}{{k + {\\lambda ^2}T}}.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E12.m1\" class=\"ltx_Math\" alttext=\"{\\eta_{A}}={\\lambda^{2}}T\\frac{{k+1}}{{k+{\\lambda^{2}}T}}.\" display=\"block\"><mrow><mrow><msub><mi>\u03b7</mi><mi>A</mi></msub><mo>=</mo><mrow><msup><mi>\u03bb</mi><mn>2</mn></msup><mo>\u2062</mo><mi>T</mi><mo>\u2062</mo><mfrac><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mrow><mi>k</mi><mo>+</mo><mrow><msup><mi>\u03bb</mi><mn>2</mn></msup><mo>\u2062</mo><mi>T</mi></mrow></mrow></mfrac></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\nwhere $P{'_{{X_A},{P_A}}} = {{{P_{{x_A},{p_A}}}} \\mathord{\\left/\n {\\vphantom {{{P_{{x_A},{p_A}}}} {{G^2}}}} \\right.\n \\kern-\\nulldelimiterspace} {{G^2}}}$, with $x_A$ and $p_A$ substituted by  ${{{X_A}} \\mathord{\\left/\n {\\vphantom {{{X_A}} G}} \\right. \\kern-\\nulldelimiterspace} G}$ and ${{{P_A}} \\mathord{\\left/\n {\\vphantom {{{P_A}} G}} \\right. \\kern-\\nulldelimiterspace} G}$,\nis the new Gaussian distribution of the scaled data. Considering the explicit form of $P{'_{{X_A},{P_A}}}$, the variance $V'$ fulfills that $V'-1 = {{{T_0}} \\mathord{\\left/ {\\vphantom {{{T_0}} \\eta }} \\right. \\kern-\\nulldelimiterspace} \\eta } \\cdot \\left( {V - 1} \\right)$.\n\nAfter this linearly scaling step, Alice could do the equivalent postselection according to the new data ${{{X_A},{P_A}}}$. By traversing all possible value of $\\eta$, one could find the optimal value of it to optimize the secret key rate at a certain distance. In this way, the key parameter of \\emph{virtual} photon subtraction, the transmittance of Alice's BS1, can be adjusted after Alice and Bob estimate the channel parameters, which makes this method more flexible.\n\n\\begin{figure}[t]\n\\includegraphics[width=3in]{05-kPS-SKR-T-TD.eps}\n\\caption{(Color online) Secret key rate vs transmission distance and transmittance $T$ of Alice's BS1. The middle black solid line represents the optimal $T$ of each distance, when the secret key rate approaches its optimal value ($R_{opt}$). The left red dash-dotted (dashed) line represents the lower bound of $T$ for each distance, when its secret key rate is 90\\% (50\\%) of its optimum at that distance. The right blue dash-dotted (dashed) line represents the upper bound of $T$ for each distance, when its secret key rate is 90\\% (50\\%) of its optimum at that distance. The simulation parameters are: $V = 20$, $a = 0.2$dB/km, $\\varepsilon = 0.01$, and $\\beta = 0.95$.\n}\\label{SKR-T-TD}\n\\end{figure}\n\n\n\n\nAnother problem about the choice of $T$ is that if the secret key rate varies significantly with $T$ around its optimal value, then we need to estimate it accurately to maintain a relatively high performance, which requires complicated implementations in a practical system. Fortunately, as shown in Fig. \\ref{SKR-T-TD}, the secret key rate varies slowly with $T$ at each distance around its optimal value (black solid line). Specifically, the secret key rate can maintain higher than 90\\% of its optimal value ($R_{opt}$), if the estimated $T$ is in the area between the left red dash-dotted line and the right blue dash-dotted line. If one only requires that the secret key rate is higher than one-half of its optimum, then the choice of $T$ is much more flexible, i.e., within the area between the left red dashed line and the right dashed line.\n\n\n\n\\subsection{Reconciliation Efficiency of non-Gaussian Data}\nIn all of the above discussions, we assume the reconciliation efficiency $\\beta$ is 0.95, which is a pretty good efficiency approached in the Gaussian case \\cite{Nat.Photonics.7.378.2013}. Therefore, another thing one may be concerned about is, for the non-Gaussian data generated by \\emph{virtual} photon subtraction, whether or not the information reconciliation still remains a relatively high efficiency as for the Gaussian data. We have carried out a preliminary test on the performance of the multidimensional reconciliation method, proposed in \\cite{Phys.Rev.A.77.042325.2008}, on both using one-photon subtraction and not using any photon-subtraction cases (non-Gaussian and Gaussian cases, respectively) with simulated data, assuming the binary input additive white Gaussian noise channel (BIAWGNC).\n\nThe two sparse check matrices used here are of two different rates: one is 0.1 and another is 0.02. For each signal-to-noise ratio (SNR), we have tested more than 40 data blocks. Each data block contains $2^{20}$ bits (1~Mbits). Therefore, the number of successfully decoded data blocks and the average iteration number when the decoding process succeeds will represent the performance of the reconciliation method.\n\nTable \\ref{NGperformance} shows our test results in which, for the 0.1 rate matrix, non-Gaussian cases show a better performance than the Gaussian cases, on both the numbers of successfully decoded blocks and the average iteration number, given the same SNR. For the 0.02 rate matrix, the non-Gaussian cases show similar numbers of successfully decoded data blocks but less average iteration numbers compared to the Gaussian cases, except the last row. In the last row, the successful decoding probability of the Gaussian case drops significantly, while the non-Gaussian case only drops a little, provided there is more average iteration.\n\n\\begin{table}[t]\n\\begin{center}\n\\begin{tabular}{lccccc}\\hline\n      & SNR     & $\\beta$& Type   & S/T & AIN  \\\\ \\hline\n$R$=0.1 & 0.1626\t& 92.02\\%& Gaussian      &\t39/40\t   &~103~ \\\\ \n\t  &\t\t    &\t     & Non-Gaussian\t &  40/40\t   & 82 \\\\ \\cline{2-6}\n\t  & 0.1613\t& 92.71\\%& Gaussian      &\t33/40\t   & 134 \\\\ \n\t  &\t        & \t     & Non-Gaussian\t &  40/40\t   & 102 \\\\ \\cline{2-6}\n\t  & 0.1600\t& 93.40\\%& Gaussian      &\t20/40\t   & 151 \\\\ \n\t  &\t\t    &\t     & Non-Gaussian\t &  34/40\t   & 130 \\\\ \\hline\n     \n$R$=0.02& 0.0301\t& 93.37\\%& Gaussian     &\t47/48\t   & 111 \\\\ \n\t  &\t\t    &\t     & Non-Gaussian\t &  47/48\t   & 101 \\\\ \\cline{2-6}\n\t  & 0.0296\t& 94.97\\%& Gaussian      &\t37/48\t   & 190 \\\\ \n\t  &\t        & \t     & Non-Gaussian\t &  37/48\t   & 174 \\\\ \\cline{2-6}\n\t  & 0.0293\t& 95.94\\%& Gaussian      &\t18/48\t   & 157 \\\\ \n\t  &\t\t    &\t     & Non-Gaussian\t &  33/48\t   & 178 \\\\ \\hline\n\\end{tabular}\\caption{Performance comparison of the multidimensional reconciliation method between Gaussian and non-Gaussian data. R: the rate of sparse check matrix; SNR: signal-to-noise ratio; $\\beta$: reconciliation efficiency; Type: the type of tested data; S/T: the number of successfully decoded data blocks/the number of total tested data blocks; AIN: average iteration number when the decoding process succeeds. }\\label{NGperformance}\n\\end{center}\n\\end{table}\t\n\nIn short, from our test, when considering a high reconciliation efficiency $\\approx0.96$, the 0.02 rate check matrix shows a relatively high successful decoding probability, i.e., more than 60\\%.\nBesides, the two sparse check matrices were initially designed for Gaussian data, not specially designed for the photon-subtraction case. Thus, this result suggests that one may directly use the multidimensional reconciliation codes for photon subtraction. If the check matrix is specially designed for the non-Gaussian data, the reconciliation efficiency may be even higher.\n\n\n\\section{Conclusion}\nIn this paper, we proposed the \\emph{virtual} photon-subtraction method in coherent-state CV QKD protocols, which can be accomplished by non-Gaussian postselection according to Alice's data. It can not only remove the complex physical operations, but also emulate the ideal operations which optimizes the performance of the CV QKD system. The main parameter, i.e., the transmittance of Alice's BS1, of this postselection method can be adjusted flexibly according to the channel parameters to optimize the secret key rate or tolerable excess noise at a certain distance. The numerical simulation shows that by choosing the optimal transmittance of Alice's BS1, the use of virtual photon subtraction will outperform the original protocol at long-distance regime.\n\nFurthermore, our preliminary tests about the information reconciliation suggest that by using the multidimensional reconciliation\nalgorithm, the performance of reconciliating the postselected non-Gaussian data is even better than that of the Gaussian data. Specifically, for each SNR, either the successfully decoded blocks are higher or the average iteration numbers are lower which saves decoding time. In our tests, the two sparse check matrices were initially designed for Gaussian data, not for the non-Gaussian case, which suggests that one can directly use the multidimensional reconciliation method here. This implies the feasibility of implementing this \\emph{virtual} photon-subtraction method practically.\n\n\\section*{Acknowledgement}\nWe would like to thank R. G. Patr\\'{o}n and F. Grosshans for the helpful discussions. This work is supported by the National Science Fund for Distinguished Young Scholars of China (Grant No. 61225003), the State Key Project of National Natural Science Foundation of China (Grant No. 61531003), National Natural Science Foundation of China (Grant No. 61501414), and the National Hi-Tech Research and Development (863) Program.\n\n\n\\appendix\n\n\\section{Influence of the imperfect single-photon detector}\\label{imperfect}\n\n\n\n\n\n\n\n\n\n\n\nThe perfect one-photon subtraction will require an ideal PNR detector. However, a practical PNR detector has imperfections, such as finite detection efficiency (DE) and dark count, which will reduce the maximal transmission distance. Because the average photon number for a TMSV state used in CV QKD is usually several tens, which means that the number of the legitimate count of a well-demonstrated PNR is much greater than the dark count, the finite detection efficiency ($\\eta_d$) is the most significant factor. It is similar for the on-off detector based on the avalanched photodiode (APD). Thus, we only consider the effect of the limited detection efficiency.\nAs depicted in Fig. \\ref{schemetic}(a), an extra beam splitter (BS2) with transmittance $1-\\eta_d$ is put in front of an ideal detector to model the practical detector's finite detection efficiency. Figure \\ref{sim1} shows how the SPD's nonunit detection efficiency will reduce the performance by numerical simulation. When the detection efficiency descends to 0.8 (green dashed line), although it still outperforms the original protocol, the maximal transmission distance decreases significantly. If the detection efficiency descends to 0.5 (pink dotted line), although it is achievable using superconducting transition-edge sensors at telecom wavelength \\cite{Rev.Sci.Instrum.82.071101.2011}, the maximal transmission distance is worse than the original protocol. And it is even worse if one uses the commercial on-off SPD with only 0.1 detection efficiency based on APD (red dash-dotted line).\n\n\\begin{figure}[t]\n\\includegraphics[width=3in]{02-PSwithLossySPD.eps}\n\\caption{(Color online) The detection efficiency of SPD will influence the performance of the scheme using photon subtraction. The lines from top to bottom are as follows: the original protocol without photon subtraction (black solid line),  with one-photon subtraction under unit DE (blue solid line), 0.8 DE (green dashed line), 0.5 DE (pink dotted line), and with on-off detector under 0.1 DE (red dash-dotted line), respectively. The simulation parameters are the variance $V = 20$, channel loss $a = 0.2$dB/km, excess noise $\\varepsilon = 0.01$, the transmittance of BS1 $T = 0.8$, and reconciliation efficiency $\\beta = 0.95$.\n}\\label{sim1}\n\\end{figure}\n\n\\section{Subtracting $k$ photons} \\label{k-photon subtraction}\nHere we use the same notation as depicted in Sec. II. After the BS1, the state is ${\\rho _{A{B_1}{B_2}}} = \\left| \\psi  \\right\\rangle \\left\\langle \\psi  \\right|$, where\n\n\n", "itemtype": "equation", "pos": 29243, "prevtext": "\nThis means, in the viewpoint of calculating the secret key rate, the $k$-photon-subtracted TMSV can be seen as a source with an extra loss on the $B_2$ mode before being emitted into the channel.\nAnd $\\eta_A$ decreases as the photon-subtraction number $k$ increases, especially when the optimal $T$ is lower for higher $k$ at long-distance range, which implies that subtracting more photons will result in more loss. Therefore, subtracting one photon shows better performance under the conditions of Fig. \\ref{BestSKR}, i.e., the initial variance of TMSV is 20.\n\nTolerable excess noise represents another aspect of a protocol.\nFigure \\ref{BestTEN}(a) shows the maximal tolerable excess noise at each distance for all possible $T$, and Fig. \\ref{BestTEN}(b) shows the optimal choice of $T$ for each distance. Similar to Fig. \\ref{BestSKR}(a), the case of original protocol (black solid line) is also outperformed by other cases at long transmission distance range, which implies another advantage of using photon subtraction that increases the maximal tolerable excess noise for distant users. It is also shown that when the channel is less noisy, for instance, $\\varepsilon  \\sim 0.005$, all four photon-subtraction operations will expand the maximal transmission distance to more than $200\\rm{km}$.\nOn the other hand, one could notice that the optimal choice of $T$ for the maximal tolerable excess noise shows a different form from the one for the maximal secret key rate. That is because the tolerable excess noise is not affected by the overall acceptance probability, while the secret key rate is.\n\n\n\\subsection{The Transmittance of Alice's Beamsplitter}\nIn \\emph{Step 1} of the PM scheme using \\emph{virtual} photon subtraction described in Sec. II, it requires Alice to know the value of $T$ in advance. For a relatively stable system and environment, Alice can use the data of the last run to approximately estimate the optimal $T$ for this run. However, when the system or environment changes rapidly, the above method may not result in a suitable estimation. In this case, one can linearly scale Alice's heterodyne measurement results first and then accomplish the postselection.\nAfter the linearly scaling, Alice's data follows a new Gaussian distribution $P{'_{{X_A},{P_A}}}$ with a different variance ${V}'$, which can be regarded as the heterodyne measurement results of a new equivalent TMSV. We assume\n $T_0$ is the estimated value according to the data of the last run, and $\\eta$ is the real optimal choice of this run. Let ${X_A} = G{x_A}$,\n${P_A} = G{p_A}$,\n and ${\\alpha _A} = {{\\sqrt 2 \\lambda '\\left( {{X_A} - i{P_A}} \\right)} \\mathord{\\left/ {\\vphantom {{\\sqrt 2 \\lambda '\\left( {{X_A} - i{P_A}} \\right)} 2}} \\right. \\kern-\\nulldelimiterspace} 2} = \\sqrt {{{{T_0}} \\mathord{\\left/\n {\\vphantom {{{T_0}} \\eta }} \\right. \\kern-\\nulldelimiterspace} \\eta }} \\cdot\\alpha  $, where $G = {{\\sqrt {{T_0}} \\lambda } \\mathord{\\left/\n {\\vphantom {{\\sqrt {{T_0}} \\lambda } {\\sqrt \\eta  \\lambda '}}} \\right.\n \\kern-\\nulldelimiterspace} {\\sqrt \\eta  \\lambda '}}$ and $\\lambda {'^2} = {{\\left( {V' - 1} \\right)} \\mathord{\\left/\n {\\vphantom {{\\left( {V' - 1} \\right)} {\\left( {V' + 1} \\right)}}} \\right.\n \\kern-\\nulldelimiterspace} {\\left( {V' + 1} \\right)}}$. Then the state Alice initially sends out can be rewritten as\n\n", "index": 27, "text": "\\begin{equation}\n\\begin{array}{l}\n\\rho _{{B_2}}^{\\left( k \\right)} = \\int {\\mathbf{d}{x_A}\\mathbf{d}{p_A} {P_{{x_A},{p_A}}}\\left| {\\sqrt {{T_0}} \\alpha } \\right\\rangle \\langle \\sqrt {{T_0}} \\alpha |} \\\\\n = \\int {\\mathbf{d}{X_A}\\mathbf{d}{P_A}  P{'_{{X_A},{P_A}}}\\left| {\\sqrt \\eta  {\\alpha _A}} \\right\\rangle \\langle \\sqrt \\eta  {\\alpha _A}|}\n\\end{array},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E13.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{l}\\rho_{{B_{2}}}^{\\left(k\\right)}=\\int{\\mathbf{d}{x_{A}}%&#10;\\mathbf{d}{p_{A}}{P_{{x_{A}},{p_{A}}}}\\left|{\\sqrt{{T_{0}}}\\alpha}\\right%&#10;\\rangle\\langle\\sqrt{{T_{0}}}\\alpha|}\\\\&#10;=\\int{\\mathbf{d}{X_{A}}\\mathbf{d}{P_{A}}P{{}^{\\prime}_{{X_{A}},{P_{A}}}}\\left|%&#10;{\\sqrt{\\eta}{\\alpha_{A}}}\\right\\rangle\\langle\\sqrt{\\eta}{\\alpha_{A}}|}\\end{%&#10;array},\" display=\"block\"><mrow><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><msubsup><mi>\u03c1</mi><msub><mi>B</mi><mn>2</mn></msub><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></msubsup><mo>=</mo><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mrow><mo>\ud835\udc1d</mo><msub><mi>x</mi><mi>A</mi></msub></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc1d</mo><msub><mi>p</mi><mi>A</mi></msub></mrow><mo>\u2062</mo><msub><mi>P</mi><mrow><msub><mi>x</mi><mi>A</mi></msub><mo>,</mo><msub><mi>p</mi><mi>A</mi></msub></mrow></msub><mo>\u2062</mo><mrow><mo fence=\"true\">|</mo><mrow><msqrt><msub><mi>T</mi><mn>0</mn></msub></msqrt><mo>\u2062</mo><mi>\u03b1</mi></mrow><mo>\u27e9</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">\u27e8</mo><mrow><msqrt><msub><mi>T</mi><mn>0</mn></msub></msqrt><mo>\u2062</mo><mi>\u03b1</mi></mrow><mo fence=\"true\" stretchy=\"false\">|</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mrow><mo>=</mo><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mi>\ud835\udc1d</mi><msub><mi>X</mi><mi>A</mi></msub><mi>\ud835\udc1d</mi><msub><mi>P</mi><mi>A</mi></msub><mi>P</mi><mmultiscripts><mo>|</mo><mprescripts/><mrow><msub><mi>X</mi><mi>A</mi></msub><mo>,</mo><msub><mi>P</mi><mi>A</mi></msub></mrow><mo>\u2032</mo></mmultiscripts><msqrt><mi>\u03b7</mi></msqrt><msub><mi>\u03b1</mi><mi>A</mi></msub><mo>\u27e9</mo><mo stretchy=\"false\">\u27e8</mo><msqrt><mi>\u03b7</mi></msqrt><msub><mi>\u03b1</mi><mi>A</mi></msub><mo stretchy=\"false\">|</mo></mrow></mtd></mtr></mtable><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\n\n\\noindent and ${C_n^l}$ is the combinatorial number.\n\nThe success probability of $\\hat \\Pi_1 = |k\\rangle \\langle k|$ clicks on mode $B_1$ is\n\n", "itemtype": "equation", "pos": 40797, "prevtext": "\nwhere $P{'_{{X_A},{P_A}}} = {{{P_{{x_A},{p_A}}}} \\mathord{\\left/\n {\\vphantom {{{P_{{x_A},{p_A}}}} {{G^2}}}} \\right.\n \\kern-\\nulldelimiterspace} {{G^2}}}$, with $x_A$ and $p_A$ substituted by  ${{{X_A}} \\mathord{\\left/\n {\\vphantom {{{X_A}} G}} \\right. \\kern-\\nulldelimiterspace} G}$ and ${{{P_A}} \\mathord{\\left/\n {\\vphantom {{{P_A}} G}} \\right. \\kern-\\nulldelimiterspace} G}$,\nis the new Gaussian distribution of the scaled data. Considering the explicit form of $P{'_{{X_A},{P_A}}}$, the variance $V'$ fulfills that $V'-1 = {{{T_0}} \\mathord{\\left/ {\\vphantom {{{T_0}} \\eta }} \\right. \\kern-\\nulldelimiterspace} \\eta } \\cdot \\left( {V - 1} \\right)$.\n\nAfter this linearly scaling step, Alice could do the equivalent postselection according to the new data ${{{X_A},{P_A}}}$. By traversing all possible value of $\\eta$, one could find the optimal value of it to optimize the secret key rate at a certain distance. In this way, the key parameter of \\emph{virtual} photon subtraction, the transmittance of Alice's BS1, can be adjusted after Alice and Bob estimate the channel parameters, which makes this method more flexible.\n\n\\begin{figure}[t]\n\\includegraphics[width=3in]{05-kPS-SKR-T-TD.eps}\n\\caption{(Color online) Secret key rate vs transmission distance and transmittance $T$ of Alice's BS1. The middle black solid line represents the optimal $T$ of each distance, when the secret key rate approaches its optimal value ($R_{opt}$). The left red dash-dotted (dashed) line represents the lower bound of $T$ for each distance, when its secret key rate is 90\\% (50\\%) of its optimum at that distance. The right blue dash-dotted (dashed) line represents the upper bound of $T$ for each distance, when its secret key rate is 90\\% (50\\%) of its optimum at that distance. The simulation parameters are: $V = 20$, $a = 0.2$dB/km, $\\varepsilon = 0.01$, and $\\beta = 0.95$.\n}\\label{SKR-T-TD}\n\\end{figure}\n\n\n\n\nAnother problem about the choice of $T$ is that if the secret key rate varies significantly with $T$ around its optimal value, then we need to estimate it accurately to maintain a relatively high performance, which requires complicated implementations in a practical system. Fortunately, as shown in Fig. \\ref{SKR-T-TD}, the secret key rate varies slowly with $T$ at each distance around its optimal value (black solid line). Specifically, the secret key rate can maintain higher than 90\\% of its optimal value ($R_{opt}$), if the estimated $T$ is in the area between the left red dash-dotted line and the right blue dash-dotted line. If one only requires that the secret key rate is higher than one-half of its optimum, then the choice of $T$ is much more flexible, i.e., within the area between the left red dashed line and the right dashed line.\n\n\n\n\\subsection{Reconciliation Efficiency of non-Gaussian Data}\nIn all of the above discussions, we assume the reconciliation efficiency $\\beta$ is 0.95, which is a pretty good efficiency approached in the Gaussian case \\cite{Nat.Photonics.7.378.2013}. Therefore, another thing one may be concerned about is, for the non-Gaussian data generated by \\emph{virtual} photon subtraction, whether or not the information reconciliation still remains a relatively high efficiency as for the Gaussian data. We have carried out a preliminary test on the performance of the multidimensional reconciliation method, proposed in \\cite{Phys.Rev.A.77.042325.2008}, on both using one-photon subtraction and not using any photon-subtraction cases (non-Gaussian and Gaussian cases, respectively) with simulated data, assuming the binary input additive white Gaussian noise channel (BIAWGNC).\n\nThe two sparse check matrices used here are of two different rates: one is 0.1 and another is 0.02. For each signal-to-noise ratio (SNR), we have tested more than 40 data blocks. Each data block contains $2^{20}$ bits (1~Mbits). Therefore, the number of successfully decoded data blocks and the average iteration number when the decoding process succeeds will represent the performance of the reconciliation method.\n\nTable \\ref{NGperformance} shows our test results in which, for the 0.1 rate matrix, non-Gaussian cases show a better performance than the Gaussian cases, on both the numbers of successfully decoded blocks and the average iteration number, given the same SNR. For the 0.02 rate matrix, the non-Gaussian cases show similar numbers of successfully decoded data blocks but less average iteration numbers compared to the Gaussian cases, except the last row. In the last row, the successful decoding probability of the Gaussian case drops significantly, while the non-Gaussian case only drops a little, provided there is more average iteration.\n\n\\begin{table}[t]\n\\begin{center}\n\\begin{tabular}{lccccc}\\hline\n      & SNR     & $\\beta$& Type   & S/T & AIN  \\\\ \\hline\n$R$=0.1 & 0.1626\t& 92.02\\%& Gaussian      &\t39/40\t   &~103~ \\\\ \n\t  &\t\t    &\t     & Non-Gaussian\t &  40/40\t   & 82 \\\\ \\cline{2-6}\n\t  & 0.1613\t& 92.71\\%& Gaussian      &\t33/40\t   & 134 \\\\ \n\t  &\t        & \t     & Non-Gaussian\t &  40/40\t   & 102 \\\\ \\cline{2-6}\n\t  & 0.1600\t& 93.40\\%& Gaussian      &\t20/40\t   & 151 \\\\ \n\t  &\t\t    &\t     & Non-Gaussian\t &  34/40\t   & 130 \\\\ \\hline\n     \n$R$=0.02& 0.0301\t& 93.37\\%& Gaussian     &\t47/48\t   & 111 \\\\ \n\t  &\t\t    &\t     & Non-Gaussian\t &  47/48\t   & 101 \\\\ \\cline{2-6}\n\t  & 0.0296\t& 94.97\\%& Gaussian      &\t37/48\t   & 190 \\\\ \n\t  &\t        & \t     & Non-Gaussian\t &  37/48\t   & 174 \\\\ \\cline{2-6}\n\t  & 0.0293\t& 95.94\\%& Gaussian      &\t18/48\t   & 157 \\\\ \n\t  &\t\t    &\t     & Non-Gaussian\t &  33/48\t   & 178 \\\\ \\hline\n\\end{tabular}\\caption{Performance comparison of the multidimensional reconciliation method between Gaussian and non-Gaussian data. R: the rate of sparse check matrix; SNR: signal-to-noise ratio; $\\beta$: reconciliation efficiency; Type: the type of tested data; S/T: the number of successfully decoded data blocks/the number of total tested data blocks; AIN: average iteration number when the decoding process succeeds. }\\label{NGperformance}\n\\end{center}\n\\end{table}\t\n\nIn short, from our test, when considering a high reconciliation efficiency $\\approx0.96$, the 0.02 rate check matrix shows a relatively high successful decoding probability, i.e., more than 60\\%.\nBesides, the two sparse check matrices were initially designed for Gaussian data, not specially designed for the photon-subtraction case. Thus, this result suggests that one may directly use the multidimensional reconciliation codes for photon subtraction. If the check matrix is specially designed for the non-Gaussian data, the reconciliation efficiency may be even higher.\n\n\n\\section{Conclusion}\nIn this paper, we proposed the \\emph{virtual} photon-subtraction method in coherent-state CV QKD protocols, which can be accomplished by non-Gaussian postselection according to Alice's data. It can not only remove the complex physical operations, but also emulate the ideal operations which optimizes the performance of the CV QKD system. The main parameter, i.e., the transmittance of Alice's BS1, of this postselection method can be adjusted flexibly according to the channel parameters to optimize the secret key rate or tolerable excess noise at a certain distance. The numerical simulation shows that by choosing the optimal transmittance of Alice's BS1, the use of virtual photon subtraction will outperform the original protocol at long-distance regime.\n\nFurthermore, our preliminary tests about the information reconciliation suggest that by using the multidimensional reconciliation\nalgorithm, the performance of reconciliating the postselected non-Gaussian data is even better than that of the Gaussian data. Specifically, for each SNR, either the successfully decoded blocks are higher or the average iteration numbers are lower which saves decoding time. In our tests, the two sparse check matrices were initially designed for Gaussian data, not for the non-Gaussian case, which suggests that one can directly use the multidimensional reconciliation method here. This implies the feasibility of implementing this \\emph{virtual} photon-subtraction method practically.\n\n\\section*{Acknowledgement}\nWe would like to thank R. G. Patr\\'{o}n and F. Grosshans for the helpful discussions. This work is supported by the National Science Fund for Distinguished Young Scholars of China (Grant No. 61225003), the State Key Project of National Natural Science Foundation of China (Grant No. 61531003), National Natural Science Foundation of China (Grant No. 61501414), and the National Hi-Tech Research and Development (863) Program.\n\n\n\\appendix\n\n\\section{Influence of the imperfect single-photon detector}\\label{imperfect}\n\n\n\n\n\n\n\n\n\n\n\nThe perfect one-photon subtraction will require an ideal PNR detector. However, a practical PNR detector has imperfections, such as finite detection efficiency (DE) and dark count, which will reduce the maximal transmission distance. Because the average photon number for a TMSV state used in CV QKD is usually several tens, which means that the number of the legitimate count of a well-demonstrated PNR is much greater than the dark count, the finite detection efficiency ($\\eta_d$) is the most significant factor. It is similar for the on-off detector based on the avalanched photodiode (APD). Thus, we only consider the effect of the limited detection efficiency.\nAs depicted in Fig. \\ref{schemetic}(a), an extra beam splitter (BS2) with transmittance $1-\\eta_d$ is put in front of an ideal detector to model the practical detector's finite detection efficiency. Figure \\ref{sim1} shows how the SPD's nonunit detection efficiency will reduce the performance by numerical simulation. When the detection efficiency descends to 0.8 (green dashed line), although it still outperforms the original protocol, the maximal transmission distance decreases significantly. If the detection efficiency descends to 0.5 (pink dotted line), although it is achievable using superconducting transition-edge sensors at telecom wavelength \\cite{Rev.Sci.Instrum.82.071101.2011}, the maximal transmission distance is worse than the original protocol. And it is even worse if one uses the commercial on-off SPD with only 0.1 detection efficiency based on APD (red dash-dotted line).\n\n\\begin{figure}[t]\n\\includegraphics[width=3in]{02-PSwithLossySPD.eps}\n\\caption{(Color online) The detection efficiency of SPD will influence the performance of the scheme using photon subtraction. The lines from top to bottom are as follows: the original protocol without photon subtraction (black solid line),  with one-photon subtraction under unit DE (blue solid line), 0.8 DE (green dashed line), 0.5 DE (pink dotted line), and with on-off detector under 0.1 DE (red dash-dotted line), respectively. The simulation parameters are the variance $V = 20$, channel loss $a = 0.2$dB/km, excess noise $\\varepsilon = 0.01$, the transmittance of BS1 $T = 0.8$, and reconciliation efficiency $\\beta = 0.95$.\n}\\label{sim1}\n\\end{figure}\n\n\\section{Subtracting $k$ photons} \\label{k-photon subtraction}\nHere we use the same notation as depicted in Sec. II. After the BS1, the state is ${\\rho _{A{B_1}{B_2}}} = \\left| \\psi  \\right\\rangle \\left\\langle \\psi  \\right|$, where\n\n\n", "index": 29, "text": "\\begin{equation}\n\\begin{array}{l}\n\\left| \\psi  \\right\\rangle  = {U_{BS}}\\left| {\\rm{TMSV}} \\right\\rangle  \\otimes \\left| 0 \\right\\rangle \\\\\n = \\sqrt {1 - {\\lambda ^2}} \\sum\\limits_{n = 0}^\\infty  {{\\lambda ^n}\\left( {{U_{BS}}\\left| {\\left. {n,0} \\right\\rangle } \\right.} \\right)}  \\otimes {\\left| n \\right\\rangle _A}\\\\\n = \\sqrt {1 - {\\lambda ^2}} \\sum\\limits_{n = 0}^\\infty  {\\sum\\limits_{l = 0}^n {{\\lambda ^n}\\sqrt {C_n^l{T^{n - l}}{{\\left( {1 - T} \\right)}^l}} } {{\\left| {n,l,n - l} \\right\\rangle }_{A{B_1}{B_2}}}}\n\\end{array}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{l}\\left|\\psi\\right\\rangle={U_{BS}}\\left|{\\rm{TMSV}}\\right%&#10;\\rangle\\otimes\\left|0\\right\\rangle\\\\&#10;=\\sqrt{1-{\\lambda^{2}}}\\sum\\limits_{n=0}^{\\infty}{{\\lambda^{n}}\\left({{U_{BS}}%&#10;\\left|{\\left.{n,0}\\right\\rangle}\\right.}\\right)}\\otimes{\\left|n\\right\\rangle_{%&#10;A}}\\\\&#10;=\\sqrt{1-{\\lambda^{2}}}\\sum\\limits_{n=0}^{\\infty}{\\sum\\limits_{l=0}^{n}{{%&#10;\\lambda^{n}}\\sqrt{C_{n}^{l}{T^{n-l}}{{\\left({1-T}\\right)}^{l}}}}{{\\left|{n,l,n%&#10;-l}\\right\\rangle}_{A{B_{1}}{B_{2}}}}}\\end{array}\" display=\"block\"><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><mrow><mo fence=\"true\">|</mo><mi>\u03c8</mi><mo>\u27e9</mo></mrow><mo>=</mo><mrow><mrow><msub><mi>U</mi><mrow><mi>B</mi><mo>\u2062</mo><mi>S</mi></mrow></msub><mo>\u2062</mo><mrow><mo fence=\"true\">|</mo><mi>TMSV</mi><mo>\u27e9</mo></mrow></mrow><mo>\u2297</mo><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mrow><mi/><mo>=</mo><mrow><msqrt><mrow><mn>1</mn><mo>-</mo><msup><mi>\u03bb</mi><mn>2</mn></msup></mrow></msqrt><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi mathvariant=\"normal\">\u221e</mi></munderover><mrow><mrow><msup><mi>\u03bb</mi><mi>n</mi></msup><mo>\u2062</mo><mrow><mo>(</mo><mrow><msub><mi>U</mi><mrow><mi>B</mi><mo>\u2062</mo><mi>S</mi></mrow></msub><mo>\u2062</mo><mrow><mo fence=\"true\">|</mo><mrow><mi>n</mi><mo>,</mo><mn>0</mn></mrow><mo>\u27e9</mo></mrow></mrow><mo>)</mo></mrow></mrow><mo>\u2297</mo><msub><mrow><mo fence=\"true\">|</mo><mi>n</mi><mo>\u27e9</mo></mrow><mi>A</mi></msub></mrow></mrow></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mrow><mi/><mo>=</mo><mrow><msqrt><mrow><mn>1</mn><mo>-</mo><msup><mi>\u03bb</mi><mn>2</mn></msup></mrow></msqrt><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi mathvariant=\"normal\">\u221e</mi></munderover><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>l</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></munderover><mrow><msup><mi>\u03bb</mi><mi>n</mi></msup><mo>\u2062</mo><msqrt><mrow><msubsup><mi>C</mi><mi>n</mi><mi>l</mi></msubsup><mo>\u2062</mo><msup><mi>T</mi><mrow><mi>n</mi><mo>-</mo><mi>l</mi></mrow></msup><mo>\u2062</mo><msup><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><mi>T</mi></mrow><mo>)</mo></mrow><mi>l</mi></msup></mrow></msqrt><mo>\u2062</mo><msub><mrow><mo fence=\"true\">|</mo><mrow><mi>n</mi><mo>,</mo><mi>l</mi><mo>,</mo><mrow><mi>n</mi><mo>-</mo><mi>l</mi></mrow></mrow><mo>\u27e9</mo></mrow><mrow><mi>A</mi><mo>\u2062</mo><msub><mi>B</mi><mn>1</mn></msub><mo>\u2062</mo><msub><mi>B</mi><mn>2</mn></msub></mrow></msub></mrow></mrow></mrow></mrow></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\nAnd its relationship with the transmittance of Alice's BS1 is shown in Fig. \\ref{psucc}.\n\n\\begin{figure}[t]\n\\includegraphics[width=3in]{06-kPS-Psucc-traverseT.eps}\n\\caption{(Color online) The success probability of subtracting $k$ photons of a TMSV with different transmittances $T$ of Alice's BS. The lines from top to bottom represent one-photon subtraction (blue solid line), two-photon subtraction (green dashed line), three-photon subtraction (pink dotted line), and four-photon subtraction (red dash-dotted line), respectively. The variance of TMSV is $V=20$, and Alice uses ideal SPD.\n}\\label{psucc}\n\\end{figure}\n\nThen the $k$-photon subtracted state is\n \n", "itemtype": "equation", "pos": 41485, "prevtext": "\n\n\\noindent and ${C_n^l}$ is the combinatorial number.\n\nThe success probability of $\\hat \\Pi_1 = |k\\rangle \\langle k|$ clicks on mode $B_1$ is\n\n", "index": 31, "text": "\\begin{equation}\n\\begin{array}{l}\n{P^{{{\\hat \\Pi }_1}}}\\left( k \\right) = t{r_{A{B_1}{B_2}}}\\left( {{{\\hat \\Pi }_1}{\\rho _{A{B_1}{B_2}}}} \\right)\\\\\n = \\left( {1 - {\\lambda ^2}} \\right)\\sum\\limits_{n = k}^\\infty  {{\\lambda ^{2n}}C_n^k{T^{n - k}}{{\\left( {1 - T} \\right)}^k}} \\\\\n = \\left( {1 - {\\lambda ^2}} \\right){\\left( {\\frac{{1 - T}}{T}} \\right)^k}\\sum\\limits_{n = k}^\\infty  {{{\\left( {{\\lambda ^2}T} \\right)}^n}C_n^k} \\\\\n{\\rm{ = }}\\frac{{1 - {\\lambda ^2}}}{{1 - T{\\lambda ^2}}}{\\left[ {\\frac{{{\\lambda ^2}\\left( {1 - T} \\right)}}{{1 - T{\\lambda ^2}}}} \\right]^k}\n\\end{array}.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E15.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{l}{P^{{{\\hat{\\Pi}}_{1}}}}\\left(k\\right)=t{r_{A{B_{1}}{B_{2}}}}%&#10;\\left({{{\\hat{\\Pi}}_{1}}{\\rho_{A{B_{1}}{B_{2}}}}}\\right)\\\\&#10;=\\left({1-{\\lambda^{2}}}\\right)\\sum\\limits_{n=k}^{\\infty}{{\\lambda^{2n}}C_{n}^%&#10;{k}{T^{n-k}}{{\\left({1-T}\\right)}^{k}}}\\\\&#10;=\\left({1-{\\lambda^{2}}}\\right){\\left({\\frac{{1-T}}{T}}\\right)^{k}}\\sum\\limits%&#10;_{n=k}^{\\infty}{{{\\left({{\\lambda^{2}}T}\\right)}^{n}}C_{n}^{k}}\\\\&#10;{\\rm{=}}\\frac{{1-{\\lambda^{2}}}}{{1-T{\\lambda^{2}}}}{\\left[{\\frac{{{\\lambda^{2%&#10;}}\\left({1-T}\\right)}}{{1-T{\\lambda^{2}}}}}\\right]^{k}}\\end{array}.\" display=\"block\"><mrow><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><mrow><msup><mi>P</mi><msub><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a0</mi><mo stretchy=\"false\">^</mo></mover><mn>1</mn></msub></msup><mo>\u2062</mo><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></mrow><mo>=</mo><mrow><mi>t</mi><mo>\u2062</mo><msub><mi>r</mi><mrow><mi>A</mi><mo>\u2062</mo><msub><mi>B</mi><mn>1</mn></msub><mo>\u2062</mo><msub><mi>B</mi><mn>2</mn></msub></mrow></msub><mo>\u2062</mo><mrow><mo>(</mo><mrow><msub><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a0</mi><mo stretchy=\"false\">^</mo></mover><mn>1</mn></msub><mo>\u2062</mo><msub><mi>\u03c1</mi><mrow><mi>A</mi><mo>\u2062</mo><msub><mi>B</mi><mn>1</mn></msub><mo>\u2062</mo><msub><mi>B</mi><mn>2</mn></msub></mrow></msub></mrow><mo>)</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mrow><mi/><mo>=</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msup><mi>\u03bb</mi><mn>2</mn></msup></mrow><mo>)</mo></mrow><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mi>k</mi></mrow><mi mathvariant=\"normal\">\u221e</mi></munderover><mrow><msup><mi>\u03bb</mi><mrow><mn>2</mn><mo>\u2062</mo><mi>n</mi></mrow></msup><mo>\u2062</mo><msubsup><mi>C</mi><mi>n</mi><mi>k</mi></msubsup><mo>\u2062</mo><msup><mi>T</mi><mrow><mi>n</mi><mo>-</mo><mi>k</mi></mrow></msup><mo>\u2062</mo><msup><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><mi>T</mi></mrow><mo>)</mo></mrow><mi>k</mi></msup></mrow></mrow></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mrow><mi/><mo>=</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msup><mi>\u03bb</mi><mn>2</mn></msup></mrow><mo>)</mo></mrow><mo>\u2062</mo><msup><mrow><mo>(</mo><mfrac><mrow><mn>1</mn><mo>-</mo><mi>T</mi></mrow><mi>T</mi></mfrac><mo>)</mo></mrow><mi>k</mi></msup><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mi>k</mi></mrow><mi mathvariant=\"normal\">\u221e</mi></munderover><mrow><msup><mrow><mo>(</mo><mrow><msup><mi>\u03bb</mi><mn>2</mn></msup><mo>\u2062</mo><mi>T</mi></mrow><mo>)</mo></mrow><mi>n</mi></msup><mo>\u2062</mo><msubsup><mi>C</mi><mi>n</mi><mi>k</mi></msubsup></mrow></mrow></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mrow><mi/><mo>=</mo><mrow><mfrac><mrow><mn>1</mn><mo>-</mo><msup><mi>\u03bb</mi><mn>2</mn></msup></mrow><mrow><mn>1</mn><mo>-</mo><mrow><mi>T</mi><mo>\u2062</mo><msup><mi>\u03bb</mi><mn>2</mn></msup></mrow></mrow></mfrac><mo>\u2062</mo><msup><mrow><mo>[</mo><mfrac><mrow><msup><mi>\u03bb</mi><mn>2</mn></msup><mo>\u2062</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><mi>T</mi></mrow><mo>)</mo></mrow></mrow><mrow><mn>1</mn><mo>-</mo><mrow><mi>T</mi><mo>\u2062</mo><msup><mi>\u03bb</mi><mn>2</mn></msup></mrow></mrow></mfrac><mo>]</mo></mrow><mi>k</mi></msup></mrow></mrow></mtd></mtr></mtable><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": " where\n \n", "itemtype": "equation", "pos": -1, "prevtext": "\nAnd its relationship with the transmittance of Alice's BS1 is shown in Fig. \\ref{psucc}.\n\n\\begin{figure}[t]\n\\includegraphics[width=3in]{06-kPS-Psucc-traverseT.eps}\n\\caption{(Color online) The success probability of subtracting $k$ photons of a TMSV with different transmittances $T$ of Alice's BS. The lines from top to bottom represent one-photon subtraction (blue solid line), two-photon subtraction (green dashed line), three-photon subtraction (pink dotted line), and four-photon subtraction (red dash-dotted line), respectively. The variance of TMSV is $V=20$, and Alice uses ideal SPD.\n}\\label{psucc}\n\\end{figure}\n\nThen the $k$-photon subtracted state is\n \n", "index": 33, "text": "$$\\rho _{A{B_2}}^{\\left(k\\right)} = \\frac{{\\left\\langle k \\right|{\\rho _{A{B_1}{B_2}}}\\left| k \\right\\rangle }}{{{P^{{{\\hat \\Pi }_1}}}\\left( k \\right)}} = \\left| {{\\zeta ^{\\left( k \\right)}}} \\right\\rangle \\left\\langle {{\\zeta ^{\\left( k \\right)}}} \\right|,$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"\\rho_{A{B_{2}}}^{\\left(k\\right)}=\\frac{{\\left\\langle k\\right|{\\rho_{A{B_{1}}{B%&#10;_{2}}}}\\left|k\\right\\rangle}}{{{P^{{{\\hat{\\Pi}}_{1}}}}\\left(k\\right)}}=\\left|{%&#10;{\\zeta^{\\left(k\\right)}}}\\right\\rangle\\left\\langle{{\\zeta^{\\left(k\\right)}}}%&#10;\\right|,\" display=\"block\"><mrow><mrow><msubsup><mi>\u03c1</mi><mrow><mi>A</mi><mo>\u2062</mo><msub><mi>B</mi><mn>2</mn></msub></mrow><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></msubsup><mo>=</mo><mfrac><mrow><mo>\u27e8</mo><mi>k</mi><mo fence=\"true\">|</mo><msub><mi>\u03c1</mi><mrow><mi>A</mi><mo>\u2062</mo><msub><mi>B</mi><mn>1</mn></msub><mo>\u2062</mo><msub><mi>B</mi><mn>2</mn></msub></mrow></msub><mo fence=\"true\">|</mo><mi>k</mi><mo>\u27e9</mo></mrow><mrow><msup><mi>P</mi><msub><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a0</mi><mo stretchy=\"false\">^</mo></mover><mn>1</mn></msub></msup><mo>\u2062</mo><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></mrow></mfrac><mo>=</mo><mrow><mrow><mo fence=\"true\">|</mo><msup><mi>\u03b6</mi><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></msup><mo>\u27e9</mo></mrow><mo>\u2062</mo><mrow><mo>\u27e8</mo><msup><mi>\u03b6</mi><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></msup><mo fence=\"true\">|</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\nand\n\n", "itemtype": "equation", "pos": 43010, "prevtext": " where\n \n", "index": 35, "text": "\\begin{equation}\n \\left| {{\\zeta ^{\\left( k \\right)}}} \\right\\rangle  = \\frac{{\\left\\langle {k}\n \\mathrel{\\left | {\\vphantom {k \\psi }}\n \\right. \\kern-\\nulldelimiterspace}\n {\\psi } \\right\\rangle }}{{\\sqrt {{P^{{{\\hat \\Pi }_1}}}\\left( k \\right)} }} = \\sum\\limits_{n = k}^\\infty  {\\sqrt {p_n^{\\left( k \\right)}} {{\\left| {n,n - k} \\right\\rangle }_{A{B_2}}}},\n \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E16.m1\" class=\"ltx_Math\" alttext=\"\\left|{{\\zeta^{\\left(k\\right)}}}\\right\\rangle=\\frac{{\\left\\langle{k}\\mathrel{%&#10;\\left|{\\vphantom{k\\psi}}\\right.\\kern-1.2pt}{\\psi}\\right\\rangle}}{{\\sqrt{{P^{{{%&#10;\\hat{\\Pi}}_{1}}}}\\left(k\\right)}}}=\\sum\\limits_{n=k}^{\\infty}{\\sqrt{p_{n}^{%&#10;\\left(k\\right)}}{{\\left|{n,n-k}\\right\\rangle}_{A{B_{2}}}}},\" display=\"block\"><mrow><mrow><mrow><mo fence=\"true\">|</mo><msup><mi>\u03b6</mi><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></msup><mo>\u27e9</mo></mrow><mo>=</mo><mfrac><mrow><mo>\u27e8</mo><mrow><mi>k</mi><mo>|</mo><mi>\u03c8</mi></mrow><mo>\u27e9</mo></mrow><msqrt><mrow><msup><mi>P</mi><msub><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a0</mi><mo stretchy=\"false\">^</mo></mover><mn>1</mn></msub></msup><mo>\u2062</mo><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></mrow></msqrt></mfrac><mo>=</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mi>k</mi></mrow><mi mathvariant=\"normal\">\u221e</mi></munderover><mrow><msqrt><msubsup><mi>p</mi><mi>n</mi><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></msubsup></msqrt><mo>\u2062</mo><msub><mrow><mo fence=\"true\">|</mo><mrow><mi>n</mi><mo>,</mo><mrow><mi>n</mi><mo>-</mo><mi>k</mi></mrow></mrow><mo>\u27e9</mo></mrow><mrow><mi>A</mi><mo>\u2062</mo><msub><mi>B</mi><mn>2</mn></msub></mrow></msub></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\n\n\nAs a comparison, for the on-off detector, the success probability is\n\n", "itemtype": "equation", "pos": 43387, "prevtext": "\nand\n\n", "index": 37, "text": "\\begin{equation}\np_n^{\\left( k \\right)} = \\frac{{{\\lambda ^{2n}}C_n^k{T^n}}}{{\\sum\\limits_{n = k}^\\infty  {{{\\left( {{\\lambda ^2}T} \\right)}^n}C_n^k} }}.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E17.m1\" class=\"ltx_Math\" alttext=\"p_{n}^{\\left(k\\right)}=\\frac{{{\\lambda^{2n}}C_{n}^{k}{T^{n}}}}{{\\sum\\limits_{n%&#10;=k}^{\\infty}{{{\\left({{\\lambda^{2}}T}\\right)}^{n}}C_{n}^{k}}}}.\" display=\"block\"><mrow><mrow><msubsup><mi>p</mi><mi>n</mi><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></msubsup><mo>=</mo><mfrac><mrow><msup><mi>\u03bb</mi><mrow><mn>2</mn><mo>\u2062</mo><mi>n</mi></mrow></msup><mo>\u2062</mo><msubsup><mi>C</mi><mi>n</mi><mi>k</mi></msubsup><mo>\u2062</mo><msup><mi>T</mi><mi>n</mi></msup></mrow><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mi>k</mi></mrow><mi mathvariant=\"normal\">\u221e</mi></munderover><mrow><msup><mrow><mo>(</mo><mrow><msup><mi>\u03bb</mi><mn>2</mn></msup><mo>\u2062</mo><mi>T</mi></mrow><mo>)</mo></mrow><mi>n</mi></msup><mo>\u2062</mo><msubsup><mi>C</mi><mi>n</mi><mi>k</mi></msubsup></mrow></mrow></mfrac></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\nThe final state is a mixed state, such that\n\n", "itemtype": "equation", "pos": 43627, "prevtext": "\n\n\nAs a comparison, for the on-off detector, the success probability is\n\n", "index": 39, "text": "\\begin{equation}\n\\begin{array}{l}\n{P^{{{\\hat \\Pi }_1}}}\\left( {on} \\right) = 1 - {P^{{{\\hat \\Pi }_1}}}\\left( {k = 0} \\right)\\\\\n = 1 - \\left( {1 - {\\lambda ^2}} \\right)\\sum\\limits_{n = 0}^\\infty  {{{\\left( {{\\lambda ^2}T} \\right)}^n}}  = \\frac{{\\left( {1 - T} \\right){\\lambda ^2}}}{{1 - {\\lambda ^2}T}}\n\\end{array}.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E18.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{l}{P^{{{\\hat{\\Pi}}_{1}}}}\\left({on}\\right)=1-{P^{{{\\hat{\\Pi}}_%&#10;{1}}}}\\left({k=0}\\right)\\\\&#10;=1-\\left({1-{\\lambda^{2}}}\\right)\\sum\\limits_{n=0}^{\\infty}{{{\\left({{\\lambda^%&#10;{2}}T}\\right)}^{n}}}=\\frac{{\\left({1-T}\\right){\\lambda^{2}}}}{{1-{\\lambda^{2}}%&#10;T}}\\end{array}.\" display=\"block\"><mrow><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><msup><mi>P</mi><msub><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a0</mi><mo stretchy=\"false\">^</mo></mover><mn>1</mn></msub></msup><mrow><mo>(</mo><mi>o</mi><mi>n</mi><mo>)</mo></mrow><mo>=</mo><mn>1</mn><mo>-</mo><msup><mi>P</mi><msub><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a0</mi><mo stretchy=\"false\">^</mo></mover><mn>1</mn></msub></msup><mrow><mo>(</mo><mi>k</mi><mo>=</mo><mn>0</mn><mo>)</mo></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mrow><mi/><mo>=</mo><mrow><mn>1</mn><mo>-</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msup><mi>\u03bb</mi><mn>2</mn></msup></mrow><mo>)</mo></mrow><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi mathvariant=\"normal\">\u221e</mi></munderover><msup><mrow><mo>(</mo><mrow><msup><mi>\u03bb</mi><mn>2</mn></msup><mo>\u2062</mo><mi>T</mi></mrow><mo>)</mo></mrow><mi>n</mi></msup></mrow></mrow></mrow><mo>=</mo><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><mi>T</mi></mrow><mo>)</mo></mrow><mo>\u2062</mo><msup><mi>\u03bb</mi><mn>2</mn></msup></mrow><mrow><mn>1</mn><mo>-</mo><mrow><msup><mi>\u03bb</mi><mn>2</mn></msup><mo>\u2062</mo><mi>T</mi></mrow></mrow></mfrac></mrow></mtd></mtr></mtable><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\n\n\n\n\\section{Calculation of the Secret Key Rate} \\label{SKRcal}\nSuppose the final state $\\rho_{AB}^G$ is a Gaussian state with covariance matrix\n\n", "itemtype": "equation", "pos": 44001, "prevtext": "\nThe final state is a mixed state, such that\n\n", "index": 41, "text": "\\begin{equation}\n\\rho _{A{B_2}}^{on - off} = \\sum\\limits_{k = 1}^\\infty  {\\frac{{{P^{{{\\hat \\Pi }_1}}}\\left( k \\right)}}{{{P^{{{\\hat \\Pi }_1}}}\\left( {on} \\right)}}} \\rho _{A{B_2}}^{\\left(k\\right)}.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E19.m1\" class=\"ltx_Math\" alttext=\"\\rho_{A{B_{2}}}^{on-off}=\\sum\\limits_{k=1}^{\\infty}{\\frac{{{P^{{{\\hat{\\Pi}}_{1%&#10;}}}}\\left(k\\right)}}{{{P^{{{\\hat{\\Pi}}_{1}}}}\\left({on}\\right)}}}\\rho_{A{B_{2}%&#10;}}^{\\left(k\\right)}.\" display=\"block\"><mrow><mrow><msubsup><mi>\u03c1</mi><mrow><mi>A</mi><mo>\u2062</mo><msub><mi>B</mi><mn>2</mn></msub></mrow><mrow><mrow><mi>o</mi><mo>\u2062</mo><mi>n</mi></mrow><mo>-</mo><mrow><mi>o</mi><mo>\u2062</mo><mi>f</mi><mo>\u2062</mo><mi>f</mi></mrow></mrow></msubsup><mo>=</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi mathvariant=\"normal\">\u221e</mi></munderover><mrow><mfrac><mrow><msup><mi>P</mi><msub><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a0</mi><mo stretchy=\"false\">^</mo></mover><mn>1</mn></msub></msup><mo>\u2062</mo><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></mrow><mrow><msup><mi>P</mi><msub><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a0</mi><mo stretchy=\"false\">^</mo></mover><mn>1</mn></msub></msup><mo>\u2062</mo><mrow><mo>(</mo><mrow><mi>o</mi><mo>\u2062</mo><mi>n</mi></mrow><mo>)</mo></mrow></mrow></mfrac><mo>\u2062</mo><msubsup><mi>\u03c1</mi><mrow><mi>A</mi><mo>\u2062</mo><msub><mi>B</mi><mn>2</mn></msub></mrow><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></msubsup></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\nwhere $\\mathbb{I}$ is diag(1,1), and $\\sigma _Z$ is diag(1,-1), and Alice always uses heterodyne detection. The secret key rate of reverse reconciliation is\n\n", "itemtype": "equation", "pos": 44359, "prevtext": "\n\n\n\n\\section{Calculation of the Secret Key Rate} \\label{SKRcal}\nSuppose the final state $\\rho_{AB}^G$ is a Gaussian state with covariance matrix\n\n", "index": 43, "text": "\\begin{equation}\n\\gamma _{A{B}}^G = \\left( {\\begin{array}{*{20}{c}}\n{{V_1}\\mathbb{I}}&{\\phi {\\sigma _Z}}\\\\\n{\\phi {\\sigma _Z}}&{{V_2}\\mathbb{I}}\n\\end{array}} \\right),\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E20.m1\" class=\"ltx_Math\" alttext=\"\\gamma_{A{B}}^{G}=\\left({\\begin{array}[]{*{20}{c}}{{V_{1}}\\mathbb{I}}&amp;{\\phi{%&#10;\\sigma_{Z}}}\\\\&#10;{\\phi{\\sigma_{Z}}}&amp;{{V_{2}}\\mathbb{I}}\\end{array}}\\right),\" display=\"block\"><mrow><mrow><msubsup><mi>\u03b3</mi><mrow><mi>A</mi><mo>\u2062</mo><mi>B</mi></mrow><mi>G</mi></msubsup><mo>=</mo><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><msub><mi>V</mi><mn>1</mn></msub><mo>\u2062</mo><mi>\ud835\udd40</mi></mrow></mtd><mtd columnalign=\"center\"><mrow><mi>\u03d5</mi><mo>\u2062</mo><msub><mi>\u03c3</mi><mi>Z</mi></msub></mrow></mtd><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/></mtr><mtr><mtd columnalign=\"center\"><mrow><mi>\u03d5</mi><mo>\u2062</mo><msub><mi>\u03c3</mi><mi>Z</mi></msub></mrow></mtd><mtd columnalign=\"center\"><mrow><msub><mi>V</mi><mn>2</mn></msub><mo>\u2062</mo><mi>\ud835\udd40</mi></mrow></mtd><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/></mtr></mtable><mo>)</mo></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\nwhere the superscript Hom means Bob using homodyne detection, and $\\beta$ is the reconciliation efficiency.\n\nTherefore,\n\n", "itemtype": "equation", "pos": 44697, "prevtext": "\nwhere $\\mathbb{I}$ is diag(1,1), and $\\sigma _Z$ is diag(1,-1), and Alice always uses heterodyne detection. The secret key rate of reverse reconciliation is\n\n", "index": 45, "text": "\\begin{equation}\n{{K^{{\\rm{Hom}}}} = \\beta {I^{{\\rm{Hom}}}}\\left( {A:{B}} \\right) - {S^{{\\rm{Hom}}}}\\left( {E:{B}} \\right)},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E21.m1\" class=\"ltx_Math\" alttext=\"{{K^{{\\rm{Hom}}}}=\\beta{I^{{\\rm{Hom}}}}\\left({A:{B}}\\right)-{S^{{\\rm{Hom}}}}%&#10;\\left({E:{B}}\\right)},\" display=\"block\"><mrow><msup><mi>K</mi><mi>Hom</mi></msup><mo>=</mo><mi>\u03b2</mi><msup><mi>I</mi><mi>Hom</mi></msup><mrow><mo>(</mo><mi>A</mi><mo>:</mo><mi>B</mi><mo>)</mo></mrow><mo>-</mo><msup><mi>S</mi><mi>Hom</mi></msup><mrow><mo>(</mo><mi>E</mi><mo>:</mo><mi>B</mi><mo>)</mo></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\nwhere ${V_A} = {{\\left( {{V_1} + 1} \\right)} \\mathord{\\left/ {\\vphantom {{\\left( {{V_1} + 1} \\right)} 2}} \\right.\n \\kern-\\nulldelimiterspace} 2}$, $V_B = V_2$, and\n\n", "itemtype": "equation", "pos": 44957, "prevtext": "\nwhere the superscript Hom means Bob using homodyne detection, and $\\beta$ is the reconciliation efficiency.\n\nTherefore,\n\n", "index": 47, "text": "\\begin{equation}\nI^{\\rm{Hom}}\\left( {A:B} \\right) = \\frac{1}{2}{\\log _2}\\frac{{{V_A}}}{{V_{A|B}^{{\\rm{Hom}}}}},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E22.m1\" class=\"ltx_Math\" alttext=\"I^{\\rm{Hom}}\\left({A:B}\\right)=\\frac{1}{2}{\\log_{2}}\\frac{{{V_{A}}}}{{V_{A|B}^%&#10;{{\\rm{Hom}}}}},\" display=\"block\"><mrow><msup><mi>I</mi><mi>Hom</mi></msup><mrow><mo>(</mo><mi>A</mi><mo>:</mo><mi>B</mi><mo>)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mi>log</mi><mn>2</mn></msub><mfrac><msub><mi>V</mi><mi>A</mi></msub><msubsup><mi>V</mi><mrow><mi>A</mi><mo stretchy=\"false\">|</mo><mi>B</mi></mrow><mi>Hom</mi></msubsup></mfrac><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\n\n\n\n\n\n\n\n\n\n\nBy assuming Eve can purify the whole system, $S\\left( {E:{B}} \\right) = S\\left( E \\right) - S\\left( {E|{B}} \\right) = S\\left( {A{B}} \\right) - S\\left( {A|{B}} \\right)$. And $S\\left(A{B}\\right)$ is a function of the symplectic eigenvalues ${\\lambda _{1,2}}$ of $\\gamma_{AB}^G$, which is\n\n", "itemtype": "equation", "pos": 45248, "prevtext": "\nwhere ${V_A} = {{\\left( {{V_1} + 1} \\right)} \\mathord{\\left/ {\\vphantom {{\\left( {{V_1} + 1} \\right)} 2}} \\right.\n \\kern-\\nulldelimiterspace} 2}$, $V_B = V_2$, and\n\n", "index": 49, "text": "\\begin{equation}\nV_{A|B}^{{\\rm{Hom}}} = {V_A} - \\frac{{{\\phi ^2}}}{{2{V_B}}} = \\frac{{{V_1} + 1}}{2} - \\frac{{{\\phi ^2}}}{{2{V_2}}}.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E23.m1\" class=\"ltx_Math\" alttext=\"V_{A|B}^{{\\rm{Hom}}}={V_{A}}-\\frac{{{\\phi^{2}}}}{{2{V_{B}}}}=\\frac{{{V_{1}}+1}%&#10;}{2}-\\frac{{{\\phi^{2}}}}{{2{V_{2}}}}.\" display=\"block\"><mrow><mrow><msubsup><mi>V</mi><mrow><mi>A</mi><mo stretchy=\"false\">|</mo><mi>B</mi></mrow><mi>Hom</mi></msubsup><mo>=</mo><mrow><msub><mi>V</mi><mi>A</mi></msub><mo>-</mo><mfrac><msup><mi>\u03d5</mi><mn>2</mn></msup><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>V</mi><mi>B</mi></msub></mrow></mfrac></mrow><mo>=</mo><mrow><mfrac><mrow><msub><mi>V</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn></mrow><mn>2</mn></mfrac><mo>-</mo><mfrac><msup><mi>\u03d5</mi><mn>2</mn></msup><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>V</mi><mn>2</mn></msub></mrow></mfrac></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\nwhere\n\n", "itemtype": "equation", "pos": 45692, "prevtext": "\n\n\n\n\n\n\n\n\n\n\nBy assuming Eve can purify the whole system, $S\\left( {E:{B}} \\right) = S\\left( E \\right) - S\\left( {E|{B}} \\right) = S\\left( {A{B}} \\right) - S\\left( {A|{B}} \\right)$. And $S\\left(A{B}\\right)$ is a function of the symplectic eigenvalues ${\\lambda _{1,2}}$ of $\\gamma_{AB}^G$, which is\n\n", "index": 51, "text": "\\begin{equation}\nS\\left( {AB} \\right) = G\\left[ {{{\\left( {{\\lambda _1} - 1} \\right)} \\mathord{\\left/\n {\\vphantom {{\\left( {{\\lambda _1} - 1} \\right)} 2}} \\right.\n \\kern-\\nulldelimiterspace} 2}} \\right] + G\\left[ {{{\\left( {{\\lambda _2} - 1} \\right)} \\mathord{\\left/\n {\\vphantom {{\\left( {{\\lambda _2} - 1} \\right)} 2}} \\right.\n \\kern-\\nulldelimiterspace} 2}} \\right],\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E24.m1\" class=\"ltx_Math\" alttext=\"S\\left({AB}\\right)=G\\left[{{{\\left({{\\lambda_{1}}-1}\\right)}\\mathord{\\left/{%&#10;\\vphantom{{\\left({{\\lambda_{1}}-1}\\right)}2}}\\right.\\kern-1.2pt}2}}\\right]+G%&#10;\\left[{{{\\left({{\\lambda_{2}}-1}\\right)}\\mathord{\\left/{\\vphantom{{\\left({{%&#10;\\lambda_{2}}-1}\\right)}2}}\\right.\\kern-1.2pt}2}}\\right],\" display=\"block\"><mrow><mrow><mrow><mi>S</mi><mo>\u2062</mo><mrow><mo>(</mo><mrow><mi>A</mi><mo>\u2062</mo><mi>B</mi></mrow><mo>)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>G</mi><mo>\u2062</mo><mrow><mo>[</mo><mrow><mrow><mo>(</mo><mrow><msub><mi>\u03bb</mi><mn>1</mn></msub><mo>-</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>\u2062</mo><mi mathvariant=\"normal\">/</mi><mo>\u2062</mo><mn>2</mn></mrow><mo>]</mo></mrow></mrow><mo>+</mo><mrow><mi>G</mi><mo>\u2062</mo><mrow><mo>[</mo><mrow><mrow><mo>(</mo><mrow><msub><mi>\u03bb</mi><mn>2</mn></msub><mo>-</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>\u2062</mo><mi mathvariant=\"normal\">/</mi><mo>\u2062</mo><mn>2</mn></mrow><mo>]</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\nand\n\n", "itemtype": "equation", "pos": 46082, "prevtext": "\nwhere\n\n", "index": 53, "text": "\\begin{equation}\nG\\left( x \\right) = \\left( {x + 1} \\right){\\log _2}\\left( {x + 1} \\right) - x{\\log _2}x,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E25.m1\" class=\"ltx_Math\" alttext=\"G\\left(x\\right)=\\left({x+1}\\right){\\log_{2}}\\left({x+1}\\right)-x{\\log_{2}}x,\" display=\"block\"><mrow><mrow><mrow><mi>G</mi><mo>\u2062</mo><mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mrow><mo>(</mo><mrow><mi>x</mi><mo>+</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>\u2062</mo><mrow><msub><mi>log</mi><mn>2</mn></msub><mo>\u2061</mo><mrow><mo>(</mo><mrow><mi>x</mi><mo>+</mo><mn>1</mn></mrow><mo>)</mo></mrow></mrow></mrow><mo>-</mo><mrow><mi>x</mi><mo>\u2062</mo><mrow><msub><mi>log</mi><mn>2</mn></msub><mo>\u2061</mo><mi>x</mi></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\nwhere we have used the notations\n\n", "itemtype": "equation", "pos": 46207, "prevtext": "\nand\n\n", "index": 55, "text": "\\begin{equation}\n\\lambda _{1,2}^2 = \\frac{1}{2}\\left[ {\\Delta  \\pm \\sqrt {{\\Delta ^2} - 4{D^2}} } \\right],\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E26.m1\" class=\"ltx_Math\" alttext=\"\\lambda_{1,2}^{2}=\\frac{1}{2}\\left[{\\Delta\\pm\\sqrt{{\\Delta^{2}}-4{D^{2}}}}%&#10;\\right],\" display=\"block\"><mrow><mrow><msubsup><mi>\u03bb</mi><mrow><mn>1</mn><mo>,</mo><mn>2</mn></mrow><mn>2</mn></msubsup><mo>=</mo><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>\u2062</mo><mrow><mo>[</mo><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u00b1</mo><msqrt><mrow><msup><mi mathvariant=\"normal\">\u0394</mi><mn>2</mn></msup><mo>-</mo><mrow><mn>4</mn><mo>\u2062</mo><msup><mi>D</mi><mn>2</mn></msup></mrow></mrow></msqrt></mrow><mo>]</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\nAnd $S^{\\rm{Hom}}\\left(A|B\\right) = G\\left[ {{{\\left( {{\\lambda _3} - 1} \\right)} \\mathord{\\left/\n {\\vphantom {{\\left( {{\\lambda _3} - 1} \\right)} 2}} \\right. \\kern-\\nulldelimiterspace} 2}} \\right]$ is a function of the symplectic eigenvalue $\\lambda_3$ of the covariance matrix $\\gamma_A^{b}$ of the $A$ mode after Bob's homodyne detection, where ${\\lambda _3} = \\sqrt {{V_1}\\left( {{V_1} - {{{\\phi ^2}} \\mathord{\\left/ {\\vphantom {{{\\phi ^2}} {{V_2}}}} \\right. \\kern-\\nulldelimiterspace} {{V_2}}}} \\right)} $. Thus, the secret key rate when Bob using homodyne detection is\n\n", "itemtype": "equation", "pos": 46362, "prevtext": "\nwhere we have used the notations\n\n", "index": 57, "text": "\\begin{equation}\n\\begin{array}{l}\n\\Delta  = V_1^2 + V_2^2 - 2{\\phi ^2},\\\\\nD = {V_1}{V_2} - {\\phi ^2}.\n\\end{array}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E27.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{l}\\Delta=V_{1}^{2}+V_{2}^{2}-2{\\phi^{2}},\\\\&#10;D={V_{1}}{V_{2}}-{\\phi^{2}}.\\end{array}\" display=\"block\"><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>=</mo><mrow><mrow><msubsup><mi>V</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>V</mi><mn>2</mn><mn>2</mn></msubsup></mrow><mo>-</mo><mrow><mn>2</mn><mo>\u2062</mo><msup><mi>\u03d5</mi><mn>2</mn></msup></mrow></mrow></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mrow><mrow><mi>D</mi><mo>=</mo><mrow><mrow><msub><mi>V</mi><mn>1</mn></msub><mo>\u2062</mo><msub><mi>V</mi><mn>2</mn></msub></mrow><mo>-</mo><msup><mi>\u03d5</mi><mn>2</mn></msup></mrow></mrow><mo>.</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\section{Covariance matrix of $k$-photon subtracted TMSV state} \\label{CM of PS}\nSuppose $\\gamma^{\\left(k\\right)}$ represents the covariance matrix of $\\rho_{AB_2}^{\\left(k\\right)}$, \n\n\n\n\nand it has the following formula,\n\n", "itemtype": "equation", "pos": 47066, "prevtext": "\nAnd $S^{\\rm{Hom}}\\left(A|B\\right) = G\\left[ {{{\\left( {{\\lambda _3} - 1} \\right)} \\mathord{\\left/\n {\\vphantom {{\\left( {{\\lambda _3} - 1} \\right)} 2}} \\right. \\kern-\\nulldelimiterspace} 2}} \\right]$ is a function of the symplectic eigenvalue $\\lambda_3$ of the covariance matrix $\\gamma_A^{b}$ of the $A$ mode after Bob's homodyne detection, where ${\\lambda _3} = \\sqrt {{V_1}\\left( {{V_1} - {{{\\phi ^2}} \\mathord{\\left/ {\\vphantom {{{\\phi ^2}} {{V_2}}}} \\right. \\kern-\\nulldelimiterspace} {{V_2}}}} \\right)} $. Thus, the secret key rate when Bob using homodyne detection is\n\n", "index": 59, "text": "\\begin{equation}\n{K^{{\\rm{Hom}}}} = {I^{{\\rm{Hom}}}}\\left( {A:B} \\right) - \\left[ {S\\left( {AB} \\right) - {S^{{\\rm{Hom}}}}\\left( {A|B} \\right)} \\right].\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E28.m1\" class=\"ltx_Math\" alttext=\"{K^{{\\rm{Hom}}}}={I^{{\\rm{Hom}}}}\\left({A:B}\\right)-\\left[{S\\left({AB}\\right)-%&#10;{S^{{\\rm{Hom}}}}\\left({A|B}\\right)}\\right].\" display=\"block\"><mrow><msup><mi>K</mi><mi>Hom</mi></msup><mo>=</mo><msup><mi>I</mi><mi>Hom</mi></msup><mrow><mo>(</mo><mi>A</mi><mo>:</mo><mi>B</mi><mo>)</mo></mrow><mo>-</mo><mrow><mo>[</mo><mi>S</mi><mrow><mo>(</mo><mi>A</mi><mi>B</mi><mo>)</mo></mrow><mo>-</mo><msup><mi>S</mi><mi>Hom</mi></msup><mrow><mo>(</mo><mi>A</mi><mo stretchy=\"false\">|</mo><mi>B</mi><mo>)</mo></mrow><mo>]</mo></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\n\nSuppose $x', p'$ are the heterodyne measurement results of mode $A$, and $x$ is the homodyne measurement result of mode $B$. Then,\n\n", "itemtype": "equation", "pos": 47475, "prevtext": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\section{Covariance matrix of $k$-photon subtracted TMSV state} \\label{CM of PS}\nSuppose $\\gamma^{\\left(k\\right)}$ represents the covariance matrix of $\\rho_{AB_2}^{\\left(k\\right)}$, \n\n\n\n\nand it has the following formula,\n\n", "index": 61, "text": "\\begin{equation}\n{\\gamma ^{\\left( k \\right)}} = \\left( {\\begin{array}{*{20}{c}}\n{\\left\\langle {\\hat x_A^2} \\right\\rangle \\mathbb{I}}&{\\left\\langle {{{\\hat x}_A}{{\\hat x}_B}} \\right\\rangle {\\sigma _Z}}\\\\\n{\\left\\langle {{{\\hat x}_A}{{\\hat x}_B}} \\right\\rangle {\\sigma _Z}}&{\\left\\langle {\\hat x_B^2} \\right\\rangle \\mathbb{I}}\n\\end{array}} \\right).\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E29.m1\" class=\"ltx_Math\" alttext=\"{\\gamma^{\\left(k\\right)}}=\\left({\\begin{array}[]{*{20}{c}}{\\left\\langle{\\hat{x%&#10;}_{A}^{2}}\\right\\rangle\\mathbb{I}}&amp;{\\left\\langle{{{\\hat{x}}_{A}}{{\\hat{x}}_{B}%&#10;}}\\right\\rangle{\\sigma_{Z}}}\\\\&#10;{\\left\\langle{{{\\hat{x}}_{A}}{{\\hat{x}}_{B}}}\\right\\rangle{\\sigma_{Z}}}&amp;{\\left%&#10;\\langle{\\hat{x}_{B}^{2}}\\right\\rangle\\mathbb{I}}\\end{array}}\\right).\" display=\"block\"><mrow><mrow><msup><mi>\u03b3</mi><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></msup><mo>=</mo><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><mrow><mo>\u27e8</mo><msubsup><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">^</mo></mover><mi>A</mi><mn>2</mn></msubsup><mo>\u27e9</mo></mrow><mo>\u2062</mo><mi>\ud835\udd40</mi></mrow></mtd><mtd columnalign=\"center\"><mrow><mrow><mo>\u27e8</mo><mrow><msub><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">^</mo></mover><mi>A</mi></msub><mo>\u2062</mo><msub><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">^</mo></mover><mi>B</mi></msub></mrow><mo>\u27e9</mo></mrow><mo>\u2062</mo><msub><mi>\u03c3</mi><mi>Z</mi></msub></mrow></mtd><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/></mtr><mtr><mtd columnalign=\"center\"><mrow><mrow><mo>\u27e8</mo><mrow><msub><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">^</mo></mover><mi>A</mi></msub><mo>\u2062</mo><msub><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">^</mo></mover><mi>B</mi></msub></mrow><mo>\u27e9</mo></mrow><mo>\u2062</mo><msub><mi>\u03c3</mi><mi>Z</mi></msub></mrow></mtd><mtd columnalign=\"center\"><mrow><mrow><mo>\u27e8</mo><msubsup><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">^</mo></mover><mi>B</mi><mn>2</mn></msubsup><mo>\u27e9</mo></mrow><mo>\u2062</mo><mi>\ud835\udd40</mi></mrow></mtd><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/><mtd/></mtr></mtable><mo>)</mo></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\nwhere\n\n", "itemtype": "equation", "pos": 47968, "prevtext": "\n\nSuppose $x', p'$ are the heterodyne measurement results of mode $A$, and $x$ is the homodyne measurement result of mode $B$. Then,\n\n", "index": 63, "text": "\\begin{equation}\n\\begin{array}{l}\n\\left\\langle {\\hat x_A^2} \\right\\rangle  = 2 \\cdot {\\int {{{x'}^2} P\\left( {x',p',x} \\right)\\mathbf{d}x'\\mathbf{d}p'\\mathbf{d}x} }  - 1,\\\\\n\\left\\langle {{{\\hat x}_A}{{\\hat x}_B}} \\right\\rangle  = \\sqrt 2 \\cdot {\\int {x'x  P\\left( {x',p',x} \\right)\\mathbf{d}x'\\mathbf{d}p'\\mathbf{d}x} } ,\\\\\n\\left\\langle {\\hat x_B^2} \\right\\rangle  = \\int {{x^2} P\\left( {x',p',x} \\right)\\mathbf{d}x'\\mathbf{d}p'\\mathbf{d}x},\n\\end{array}\\label{C2}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E30.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{l}\\left\\langle{\\hat{x}_{A}^{2}}\\right\\rangle=2\\cdot{\\int{{{x^{%&#10;\\prime}}^{2}}P\\left({x^{\\prime},p^{\\prime},x}\\right)\\mathbf{d}x^{\\prime}%&#10;\\mathbf{d}p^{\\prime}\\mathbf{d}x}}-1,\\\\&#10;\\left\\langle{{{\\hat{x}}_{A}}{{\\hat{x}}_{B}}}\\right\\rangle=\\sqrt{2}\\cdot{\\int{x%&#10;^{\\prime}xP\\left({x^{\\prime},p^{\\prime},x}\\right)\\mathbf{d}x^{\\prime}\\mathbf{d%&#10;}p^{\\prime}\\mathbf{d}x}},\\\\&#10;\\left\\langle{\\hat{x}_{B}^{2}}\\right\\rangle=\\int{{x^{2}}P\\left({x^{\\prime},p^{%&#10;\\prime},x}\\right)\\mathbf{d}x^{\\prime}\\mathbf{d}p^{\\prime}\\mathbf{d}x},\\end{array}\" display=\"block\"><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><mrow><mrow><mo>\u27e8</mo><msubsup><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">^</mo></mover><mi>A</mi><mn>2</mn></msubsup><mo>\u27e9</mo></mrow><mo>=</mo><mrow><mrow><mn>2</mn><mo>\u22c5</mo><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mmultiscripts><mi>x</mi><none/><mo>\u2032</mo><none/><mn>2</mn></mmultiscripts><mo>\u2062</mo><mi>P</mi><mo>\u2062</mo><mrow><mo>(</mo><msup><mi>x</mi><mo>\u2032</mo></msup><mo>,</mo><msup><mi>p</mi><mo>\u2032</mo></msup><mo>,</mo><mi>x</mi><mo>)</mo></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc1d</mo><msup><mi>x</mi><mo>\u2032</mo></msup></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc1d</mo><msup><mi>p</mi><mo>\u2032</mo></msup></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc1d</mo><mi>x</mi></mrow></mrow></mrow></mrow><mo>-</mo><mn>1</mn></mrow></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mrow><mrow><mrow><mo>\u27e8</mo><mrow><msub><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">^</mo></mover><mi>A</mi></msub><mo>\u2062</mo><msub><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">^</mo></mover><mi>B</mi></msub></mrow><mo>\u27e9</mo></mrow><mo>=</mo><mrow><msqrt><mn>2</mn></msqrt><mo>\u22c5</mo><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><msup><mi>x</mi><mo>\u2032</mo></msup><mo>\u2062</mo><mi>x</mi><mo>\u2062</mo><mi>P</mi><mo>\u2062</mo><mrow><mo>(</mo><msup><mi>x</mi><mo>\u2032</mo></msup><mo>,</mo><msup><mi>p</mi><mo>\u2032</mo></msup><mo>,</mo><mi>x</mi><mo>)</mo></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc1d</mo><msup><mi>x</mi><mo>\u2032</mo></msup></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc1d</mo><msup><mi>p</mi><mo>\u2032</mo></msup></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc1d</mo><mi>x</mi></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mrow><mrow><mrow><mo>\u27e8</mo><msubsup><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">^</mo></mover><mi>B</mi><mn>2</mn></msubsup><mo>\u27e9</mo></mrow><mo>=</mo><mrow><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>\u2062</mo><mi>P</mi><mo>\u2062</mo><mrow><mo>(</mo><msup><mi>x</mi><mo>\u2032</mo></msup><mo>,</mo><msup><mi>p</mi><mo>\u2032</mo></msup><mo>,</mo><mi>x</mi><mo>)</mo></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc1d</mo><msup><mi>x</mi><mo>\u2032</mo></msup></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc1d</mo><msup><mi>p</mi><mo>\u2032</mo></msup></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc1d</mo><mi>x</mi></mrow></mrow></mrow></mrow><mo>,</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\nand ${P_{x',p'}}$ is ${P_{x_A,p_A}}$ in Eq. (\\ref{PS_EQ}) in which $\\left\\{x_A,p_A\\right\\}$ are substituted by $\\left\\{x',p'\\right\\}$.\n\nAfter simplifying Eq. (\\ref{C2}) by integrating the variable $x$,\n\n", "itemtype": "equation", "pos": 48453, "prevtext": "\nwhere\n\n", "index": 65, "text": "\\begin{equation}\nP\\left( {x',p',x} \\right) = W \\cdot {P_{x',p'}} \\cdot {\\left| {\\left\\langle {x}\n \\mathrel{\\left | {\\vphantom {x {\\sqrt T \\alpha }}}\n \\right. \\kern-\\nulldelimiterspace}\n {{\\sqrt T \\alpha }} \\right\\rangle } \\right|^2},\\label{C3}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E31.m1\" class=\"ltx_Math\" alttext=\"P\\left({x^{\\prime},p^{\\prime},x}\\right)=W\\cdot{P_{x^{\\prime},p^{\\prime}}}\\cdot%&#10;{\\left|{\\left\\langle{x}\\mathrel{\\left|{\\vphantom{x{\\sqrt{T}\\alpha}}}\\right.%&#10;\\kern-1.2pt}{{\\sqrt{T}\\alpha}}\\right\\rangle}\\right|^{2}},\" display=\"block\"><mrow><mi>P</mi><mrow><mo>(</mo><msup><mi>x</mi><mo>\u2032</mo></msup><mo>,</mo><msup><mi>p</mi><mo>\u2032</mo></msup><mo>,</mo><mi>x</mi><mo>)</mo></mrow><mo>=</mo><mi>W</mi><mo>\u22c5</mo><msub><mi>P</mi><mrow><msup><mi>x</mi><mo>\u2032</mo></msup><mo>,</mo><msup><mi>p</mi><mo>\u2032</mo></msup></mrow></msub><mo>\u22c5</mo><mo>|</mo><mrow><mo>\u27e8</mo><mi>x</mi><mo>|</mo><msqrt><mi>T</mi></msqrt><mi>\u03b1</mi><mo>\u27e9</mo></mrow><msup><mo>|</mo><mn>2</mn></msup><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\nwhere  $\\tilde V = \\int {{{x'}^2} \\cdot W \\cdot {P_{x',p'}}\\mathbf{d}x'\\mathbf{d}p'}$,\n\nand further calculation shows\n\n", "itemtype": "equation", "pos": 48914, "prevtext": "\nand ${P_{x',p'}}$ is ${P_{x_A,p_A}}$ in Eq. (\\ref{PS_EQ}) in which $\\left\\{x_A,p_A\\right\\}$ are substituted by $\\left\\{x',p'\\right\\}$.\n\nAfter simplifying Eq. (\\ref{C2}) by integrating the variable $x$,\n\n", "index": 67, "text": "\\begin{equation}\n\\begin{array}{l}\n\\left\\langle {\\hat x_A^2} \\right\\rangle  = 2\\tilde V - 1,\\\\\n\\left\\langle {{{\\hat x}_A}{{\\hat x}_B}} \\right\\rangle  = 2\\sqrt {T} \\lambda \\tilde V,\\\\\n\\left\\langle {\\hat x_B^2} \\right\\rangle  = {2T}{\\lambda ^2}\\tilde V + 1,\n\\end{array}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E32.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{l}\\left\\langle{\\hat{x}_{A}^{2}}\\right\\rangle=2\\tilde{V}-1,\\\\&#10;\\left\\langle{{{\\hat{x}}_{A}}{{\\hat{x}}_{B}}}\\right\\rangle=2\\sqrt{T}\\lambda%&#10;\\tilde{V},\\\\&#10;\\left\\langle{\\hat{x}_{B}^{2}}\\right\\rangle={2T}{\\lambda^{2}}\\tilde{V}+1,\\end{array}\" display=\"block\"><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><mrow><mrow><mo>\u27e8</mo><msubsup><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">^</mo></mover><mi>A</mi><mn>2</mn></msubsup><mo>\u27e9</mo></mrow><mo>=</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover></mrow><mo>-</mo><mn>1</mn></mrow></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mrow><mrow><mrow><mo>\u27e8</mo><mrow><msub><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">^</mo></mover><mi>A</mi></msub><mo>\u2062</mo><msub><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">^</mo></mover><mi>B</mi></msub></mrow><mo>\u27e9</mo></mrow><mo>=</mo><mrow><mn>2</mn><mo>\u2062</mo><msqrt><mi>T</mi></msqrt><mo>\u2062</mo><mi>\u03bb</mi><mo>\u2062</mo><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover></mrow></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mrow><mrow><mrow><mo>\u27e8</mo><msubsup><mover accent=\"true\"><mi>x</mi><mo stretchy=\"false\">^</mo></mover><mi>B</mi><mn>2</mn></msubsup><mo>\u27e9</mo></mrow><mo>=</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>T</mi><mo>\u2062</mo><msup><mi>\u03bb</mi><mn>2</mn></msup><mo>\u2062</mo><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover></mrow><mo>+</mo><mn>1</mn></mrow></mrow><mo>,</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.02799.tex", "nexttext": "\n\n\n\\newpage \n\n\n\n\\begin{thebibliography}{99}\n\n\\bibitem{RevModPhys.74.145.2002}\nN. Gisin, G. Ribordy, W. Tittel, and H. Zbinden, Rev. Mod. Phys. \\textbf{74}, 145 (2002).\n\n\\bibitem{RevModPhys.81.1301.2009}\nV. Scarani, H. Bechmann-Pasquinucci, N. J. Cerf, M. Du\\^{s}ek, N. L\\\"{u}tkenhaus, and M. Peev, Rev. Mod. Phys.\n\\textbf{81}, 1301 (2009).\n\n\\bibitem{Rev.Mod.Phys.77.513.2005}\nS. L. Braunstein and P. van Loock, Rev. Mod. Phys. \\textbf{77}, 513 (2005).\n\n\\bibitem{Phys.Rep.448.1.2007}\nX.-B. Wang, T. Hiroshima, A. Tomita, and M. Hayashi, Phys. Rep. \\textbf{448}, 1 (2007).\n\n\\bibitem{Rev.Mod.Phys.84.621.2012}\nC. Weedbrook, S. Pirandola, R. Garc\\'{i}a-Patr\\'{o}n, N. J. Cerf, T. C. Ralph, J. H. Shapiro, and S. Lloyd, Rev. Mod.\nPhys. \\textbf{84}, 621 (2012).\n\n\\bibitem{Phys.Rev.Lett.88.057902.2002}\nF. Grosshans and P. Grangier, Phys. Rev. Lett. \\textbf{88}, 057902 (2002).\n\n\\bibitem{Nature.421.238.2003}\nF. Grosshans, G. V. Assche, J. Wenger, R. Brouri, N. J. Cerf, and P. Grangier, Nature \\textbf{421}, 238 (2003).\n\n\\bibitem{Phys.Rev.Lett.93.170504.2004}\nC. Weedbrook, A. M. Lance, W. P. Bowen, T. Symul, T. C. Ralph, and P. K. Lam, Phys. Rev. Lett. \\textbf{93}, 170504 (2004).\n\n\\bibitem{Phys.Rev.Lett.97.190502.2006}\nM. Navascu\\'{e}s, F. Grosshans, and A. Ac\\'{i}n, Phys. Rev. Lett. \\textbf{97}, 190502 (2006).\n\n\\bibitem{Phys.Rev.Lett.97.190503.2006}\nR. Garc\\'?a-Patr\\'on and N. J. Cerf, Phys. Rev. Lett. \\textbf{97}, 190503 (2006).\n\n\\bibitem{Phys.Rev.Lett.102.110504.2009}\nR. Renner and J. I. Cirac, Phys. Rev. Lett. \\textbf{102}, 110504 (2009).\n\n\\bibitem{Phys.Rev.Lett.110.030502.2013}\nA. Leverrier, R. Garc\\'?a-Patr\\'on, R. Renner, and N. J. Cerf, Phys. Rev. Lett. \\textbf{110}, 030502 (2013).\n\n\\bibitem{Phys.Rev.Lett.114.070501.2015}\nA. Leverrier, Phys. Rev. Lett. \\textbf{114}, 070501 (2015).\n\n\\bibitem{Phys.Rev.A.76.042305.2007}\nJ. Lodewyck, M. Bloch, R. Garc\\'ia-Patr\\'on, S. Fossier, E. Karpov, E. Diamanti, T. Debuisschert, N. J. Cerf, R. Tualle-Brouri, S. W. McLaughlin, et al., Phys. Rev. A \\textbf{76}, 042305 (2007).\n\n\\bibitem{New.J.Phys.11.045023.2009}\nS. Fossier, E. Diamanti, T. Debuisschert, A. Villing, R. Tualle-Brouri, and P. Grangier, New J. Phys. \\textbf{11}, 045023 (2009).\n\n\\bibitem{Opt.Express.20.14030.2012}\nP. Jouguet, S. Kunz-Jacques, T. Debuisschert, S. Fossier, E. Diamanti, R. All\\'eaume, R. Tualle-Brouri, P. Grangier, A. Leverrier, P. Pache, et al., Opt. Express \\textbf{20}, 14030 (2012).\n\n\\bibitem{Nat.Photonics.7.378.2013}\nP. Jouguet, S. Kunz-Jacques, A. Leverrier, P. Grangier, and E. Diamanti, Nat. Photon. \\textbf{7}, 378 (2013).\n\n\\bibitem{Phys.Rev.A.77.042325.2008}\nA. Leverrier, R. All\u00a8\u00a6aume, J. Boutros, G. Z\u00a8\u00a6mor, and P. Grangier, Phys. Rev. A \\textbf{77}, 042325 (2008).\n\n\\bibitem{Phys.Rev.A.84.062317.2011}\nP. Jouguet, S. Kunz-Jacques, and A. Leverrier, Phys. Rev. A \\textbf{84}, 062317 (2011).\n\n\\bibitem{T.C.Ralph_NLA_QCMC_2009}\nT. C. Ralph and A. P. Lund, in Quantum Communication Measurement and Computing Proceedings of 9th\nInternational Conference (AIP, New York 2009), pp. 155 \u00a8C 160.\n\n\\bibitem{Phys.Rev.A.86.012327.2012}\nR. Blandino, A. Leverrier, M. Barbieri, J. Etesse, P. Grangier, and R. Tualle-Brouri, Phys. Rev. A \\textbf{86}, 012327 (2012).\n\n\\bibitem{Phys.Rev.A.87.062311.2013}\nB. Xu, C. Tang, H. Chen, W. Zhang, and F. Zhu, Phys. Rev. A \\textbf{87}, 062311 (2013).\n\n\\bibitem{Nat.Photonics.4.316.2010}\nG. Y. Xiang, T. C. Ralph, A. P. Lund, N. Walk, and G. J. Pryde, Nat. Photon. \\textbf{4}, 316 (2010).\n\n\\bibitem{Phys.Rev.Lett.104.123603.2010}\nF. Ferreyrol, M. Barbieri, R. Blandino, S. Fossier, R. Tualle-Brouri, and P. Grangier, Phys. Rev. Lett. \\textbf{104}, 123603 (2010).\n\n\\bibitem{Phys.Rev.A.83.063801.2011}\nF. Ferreyrol, R. Blandino, M. Barbieri, R. Tualle-Brouri, and P. Grangier, Phys. Rev. A \\textbf{83}, 063801 (2011).\n\n\\bibitem{Nat.Photonics.5.52.2011}\nA. Zavatta, J. Fiur\u00a8\u00a2\u00a1\u00a6sek, and M. Bellini, Nat. Photon. \\textbf{5}, 52 (2011).\n\n\\bibitem{Phys.Rev.A.86.060302.2012}\nJ. Fiur\\'\u00a8\u00a2\\^sek and N. J. Cerf, Phys. Rev. A \\textbf{86}, 060302 (2012).\n\n\\bibitem{Phys.Rev.A.87.020303.2013}\nN. Walk, T. C. Ralph, T. Symul, and P. K. Lam, Phys. Rev. A \\textbf{87}, 020303 (2013).\n\n\\bibitem{Nat.Photonics.8.333.2014}\nH. M. Chrzanowski, N. Walk, S. M. Assad, J. Janousek, S. Hosseini, T. C. Ralph, T. Symul, and P. K. Lam, Nat. Photon. \\textbf{8}, 333 (2014).\n\n\\bibitem{Phys.Rev.A.61.032302.2000}\nT. Opatrn\\'y, G. Kurizki, and D.-G. Welsch, Phys. Rev. A \\textbf{61}, 032302 (2000).\n\n\\bibitem{Phys.Rev.A.71.043805.2005}\nM. S. Kim, E. Park, P. L. Knight, and H. Jeong, Phys. Rev. A \\textbf{71}, 043805 (2005).\n\n\\bibitem{Phys.Rev.A.73.042310.2006}\nA. Kitagawa, M. Takeoka, M. Sasaki, and A. Chefles, Phys. Rev. A \\textbf{73}, 042310 (2006).\n\n\\bibitem{Phys.Rev.A.86.012328.2012}\nC. Navarrete-Benlloch, R. Garc\\'?a-Patr\\'on, J. H. Shapiro, and N. J. Cerf, Phys. Rev. A \\textbf{86}, 012328 (2012).\n\n\\bibitem{Phys.Rev.A.87.012317.2013}\nP. Huang, G. He, J. Fang, and G. Zeng, Phys. Rev. A \\textbf{87}, 012317 (2013).\n\n\\bibitem{Phys.Rev.A.82.062316.2010}\nS. L. Zhang and P. van Loock, Phys. Rev. A \\textbf{82}, 062316 (2010).\n\n\\bibitem{Rev.Sci.Instrum.82.071101.2011}\nM. D. Eisaman, J. Fan, A. Migdall, and S. V. Polyakov, Rev. Sci. Instrum. \\textbf{82}, 071101 (2011).\n\n\\bibitem{Phys.Rev.Lett.96.080502.2006}\nM. M. Wolf, G. Giedke, and J. I. Cirac, Phys. Rev. Lett. \\textbf{96}, 080502 (2006).\n\n\\bibitem{QCQC.Nielsen.2000}\nM. A. Nielsen and I. L. Chuang, Quantum Computation and Quantum Communication (Cambridge University Press, Cambridge, 2000).\n\n\\bibitem{Phys.Rev.A.83.042312.2011}\nA. Leverrier and P. Grangier, Phys. Rev. A \\textbf{83}, 042312 (2011).\n\n\\bibitem{Phys.Rev.A.81.062343.2010}\nA. Leverrier, F. Grosshans, and P. Grangier, Phys. Rev. A \\textbf{81}, 062343 (2010).\n\n\n\\end{thebibliography}\n\n\n\n", "itemtype": "equation", "pos": 49314, "prevtext": "\nwhere  $\\tilde V = \\int {{{x'}^2} \\cdot W \\cdot {P_{x',p'}}\\mathbf{d}x'\\mathbf{d}p'}$,\n\nand further calculation shows\n\n", "index": 69, "text": "\\begin{equation}\n\\tilde V = \\frac{{k + 1}}{{1 - T{\\lambda ^2}}}.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E33.m1\" class=\"ltx_Math\" alttext=\"\\tilde{V}=\\frac{{k+1}}{{1-T{\\lambda^{2}}}}.\" display=\"block\"><mrow><mrow><mover accent=\"true\"><mi>V</mi><mo stretchy=\"false\">~</mo></mover><mo>=</mo><mfrac><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mrow><mn>1</mn><mo>-</mo><mrow><mi>T</mi><mo>\u2062</mo><msup><mi>\u03bb</mi><mn>2</mn></msup></mrow></mrow></mfrac></mrow><mo>.</mo></mrow></math>", "type": "latex"}]