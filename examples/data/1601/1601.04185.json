[{"file": "1601.04185.tex", "nexttext": "\n\nIn numerical micromagnetics, the dynamics of magnetization are described by the semi-discretized Landau-Lifshitz-Gilbert equation, in which the motion of magnetization is computed from the discretized effective field. It is desireable to preserve the relation~\\eqref{eq-llg} between effective field and total energy in the semi-discretized formulation~\\cite{Miltat2007} --- if~\\eqref{eq-llg} holds for the discrete system, then the total energy will decrease in the simulation, simplifying the use of energy-based criteria for the control of the simulation or the search for an equilibrium.  \n\nIn order to preserve~\\eqref{eq-llg}, the effective field has to be computed from the discretized total energy function using the corresponding discrete counterpart to the functional derivative~$\\delta E/\\delta \\mathbf M(\\mathbf r)$. For the exchange, anisotropy, and Zeeman terms this is usually straightforward, however for the demagnetizing field it is more difficult. In finite difference (FD) micromagnetics, it can be achieved by computing the total demagnetizing energy of the system using the analytical expression~\\cite{Schabes1987,Newell1993,maicus1998magnetostatic,fukushima1998volume} for the demagnetizing tensor, and then differentiating with respect to the degrees of freedom~\\cite{oommf,Miltat2007}. \nHowever, in finite element (FE) micromagnetics, the demagnetizing field is usually computed using the FEM/BEM method~\\cite{Fredkin1990,Garcia-Cervera2006} where the field is derived from the magnetostatic potential, and the energy is not computed exactly. \n\nIt is therefore desireable to be able to accurately and efficiently compute the total magnetostatic energy of a system represented by a set of polyhedral elements, with magnetization linear inside each polyhedron (as in the FE method with linear Lagrange elements). The total energy of the system is the sum of pairwise interactions between the polyhedrons and in this paper we describe how to compute this pairwise interaction. \n\nGiven two interacting magnetized polyhedrons $\\tau$  and $\\tau'$ with arbitrary magnetizations $\\mathbf M(\\mathbf r)$ and $\\mathbf M'(\\mathbf r)$, the energy $E_{\\tau\\leftrightarrow\\tau'}$ of the magnetostatic interaction between them is:\n\n", "itemtype": "equation", "pos": 1792, "prevtext": "\n\n\\title{Computation of the magnetostatic interaction between linearly magnetized polyhedrons}\n\n\\author[soton]{Dmitri Chernyshenko}\n\\author[soton]{Hans Fangohr}\n\\address[soton]{\nEngineering and the Environment,\nUniversity of Southampton, Southampton SO17 1BJ,\nUnited Kingdom\n}\n\n\\date{\\today}\n\n\n\n\\begin{abstract}\nIn this paper we present a method to accurately compute the energy of the\nmagnetostatic interaction between linearly (or uniformly, as a special case) magnetized polyhedrons. The method has applications in finite element micromagnetics, or more generally in computing the magnetostatic interaction when the magnetization is represented using the finite element method (FEM).\n \nThe magnetostatic energy is described by a six-fold integral that is singular when the interaction regions overlap, making direct numerical evaluation problematic. To resolve the singularity, we evaluate four of the six iterated integrals analytically resulting in a 2d integral over the surface of a polyhedron, which is nonsingular and can be integrated numerically. This provides a more accurate and efficient way of computing the magnetostatic energy integral compared to existing approaches.\n\nThe method was developed to facilitate the evaluation of the demagnetizing interaction between neighouring elements in finite-element micromagnetics and provides a possibility to compute the demagnetizing field using efficient fast multipole or tree code algorithms.\n\n \\end{abstract}\n\n\\maketitle\n\n\\date{\\today}\n\n\\section{Introduction}\nIn the continuum form of the Landau-Lifshitz-Gilbert equation, the effective field $\\mathbf H_\\mathrm{eff}(\\mathbf r)$ is the functional derivative of the total energy functional $E(\\mathbf M)$ with respect to the magnetization $\\mathbf M(\\mathbf r)$~\\cite{Brown1963}: \n\n", "index": 1, "text": "\\begin{gather}\n\\mathbf H(\\mathbf r) = - \\frac{1}{\\mu_0} \\frac{\\delta E}{\\delta \\mathbf M(\\mathbf r)} \\label{eq-llg} \\\\\nE = E_\\text{Zeeman} + E_\\text{demag} + E_\\text{anisotropy} + E_\\text{exchange} + \\ldots\n\\end{gather}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\mathbf{H}(\\mathbf{r})=-\\frac{1}{\\mu_{0}}\\frac{\\delta E}{\\delta%&#10;\\mathbf{M}(\\mathbf{r})}\" display=\"block\"><mrow><mrow><mi>\ud835\udc07</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo>-</mo><mrow><mfrac><mn>1</mn><msub><mi>\u03bc</mi><mn>0</mn></msub></mfrac><mo>\u2062</mo><mfrac><mrow><mi>\u03b4</mi><mo>\u2062</mo><mi>E</mi></mrow><mrow><mi>\u03b4</mi><mo>\u2062</mo><mi>\ud835\udc0c</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle E=E_{\\text{Zeeman}}+E_{\\text{demag}}+E_{\\text{anisotropy}}+E_{%&#10;\\text{exchange}}+\\ldots\" display=\"block\"><mrow><mi>E</mi><mo>=</mo><mrow><msub><mi>E</mi><mtext>Zeeman</mtext></msub><mo>+</mo><msub><mi>E</mi><mtext>demag</mtext></msub><mo>+</mo><msub><mi>E</mi><mtext>anisotropy</mtext></msub><mo>+</mo><msub><mi>E</mi><mtext>exchange</mtext></msub><mo>+</mo><mi mathvariant=\"normal\">\u2026</mi></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "\nwhere  $H'_{\\mathrm{demag}}(\\mathbf r) = - \\frac{1}{4 \\pi} \\nabla_{\\mathbf r} \\int_{\\tau'} \\mathbf M'(\\mathbf r') \\cdot \\nabla_{\\mathbf r'} (1/|\\mathbf r-\\mathbf r'|) \\, d\\mathbf r'$ is the demagnetizing (stray) field produced by the polyhedron~$\\tau'$.\n\nThe straightforward approach of numerically computing the integral~\\eqref{eq-pairwise} is problematic because it requires explicit integration over a 6-dimensional region of space; additionally, when the polyhedrons overlap or coincide, the integrand is singular and regular integration methods cannot be applied. \nMany analytical results are available for similar 3-fold integrals arising during the calculation of the field~\\cite{Wilton1984,Graglia1987,Graglia1993,Fabbri2008,Fabbri2009}. However, none of the formulas can be easily adapted to this more complex 6d case. In~\\cite{Masserey2005} a method is developed for removing the singularity in~\\eqref{eq-pairwise} that can be applied to the uniform magnetization case but does not generalize easily to the linear magnetization case. A Fourier-transform method has been devised for the computation of magnetostatic energy~\\cite{Beleggia2005,Beleggia2004}, however for the case investigated in this paper, the required 3d numerical integration in the Fourier space is still somewhat impractical. \n\nThe rest of the paper describes the proposed method for the computation of this integral. The main approach is to analytically perform 4 out of 6 iterated integrals resulting in a 2d surface integral that is nonsingular and can be evaluated numerically using standard methods. This semi-analytical approach is similar to~\\cite{Arcioni1997}; the use of notation and vector analysis in the analytical derivation is similar to the techniques in~\\cite{Fabbri2008,Fabbri2009}.  \n\n\\section{Formulation of the problem}\n\nFor the purposes of computation, an arbitrary linear vector-valued function in space $\\mathbf M(\\mathbf r)$ can be represented by a $3 \\times 4$ matrix $|| M_{ij} ||$: \n$\\mathbf M(\\mathbf r) = || M_{ij} || \\cdot (1, r_x, r_y, r_z)^T$. However, performing analytical calculations for this general case is quite inconvenient; instead we only consider vector-valued linear functions of the form $A(\\mathbf r) \\mathbf M$ where $A(\\mathbf r)$ is a scalar linear function and $\\mathbf M$ is a constant vector. For the common case of a tetrahedral element, an arbitrary linear vector-valued function $\\mathbf M(\\mathbf r)$ can be reconstructed from the vertex values $\\mathbf M_i$, $i=1\\dots 4$: \n$\\mathbf M(\\mathbf r) = \\sum_{i=1}^4 A_i(r) \\mathbf M_i $, where $A_i(r)$ are the shape functions of the tetrahedron. \n\n\nWe perform the computations for a pair of interacting linearly magnetized polyhedrons $\\tau$  and $\\tau'$ with magnetizations $A(\\mathbf r) \\mathbf M$ and $B(\\mathbf r) \\mathbf M'$, where $\\mathbf M$ and $\\mathbf M'$ are constant magnetization vectors and $A(\\mathbf r)$, $B(\\mathbf r)$ are dimensionless linear functions in space (Figure~\\ref{fig-tets}). From~\\eqref{eq-pairwise}, the energy $E_{\\tau\\leftrightarrow\\tau'}$ of the magnetostatic interaction between the polyhedrons is $E_{\\tau\\leftrightarrow\\tau'} = \\frac{\\mu_0}{4 \\pi} \\, \\mathbf M\\cdot \\mathbf N \\cdot \\mathbf M'$, where $\\mathbf N$ is the symmetric $3\\times3$ ``demagnetizing tensor'' \n\n", "itemtype": "equation", "pos": 4251, "prevtext": "\n\nIn numerical micromagnetics, the dynamics of magnetization are described by the semi-discretized Landau-Lifshitz-Gilbert equation, in which the motion of magnetization is computed from the discretized effective field. It is desireable to preserve the relation~\\eqref{eq-llg} between effective field and total energy in the semi-discretized formulation~\\cite{Miltat2007} --- if~\\eqref{eq-llg} holds for the discrete system, then the total energy will decrease in the simulation, simplifying the use of energy-based criteria for the control of the simulation or the search for an equilibrium.  \n\nIn order to preserve~\\eqref{eq-llg}, the effective field has to be computed from the discretized total energy function using the corresponding discrete counterpart to the functional derivative~$\\delta E/\\delta \\mathbf M(\\mathbf r)$. For the exchange, anisotropy, and Zeeman terms this is usually straightforward, however for the demagnetizing field it is more difficult. In finite difference (FD) micromagnetics, it can be achieved by computing the total demagnetizing energy of the system using the analytical expression~\\cite{Schabes1987,Newell1993,maicus1998magnetostatic,fukushima1998volume} for the demagnetizing tensor, and then differentiating with respect to the degrees of freedom~\\cite{oommf,Miltat2007}. \nHowever, in finite element (FE) micromagnetics, the demagnetizing field is usually computed using the FEM/BEM method~\\cite{Fredkin1990,Garcia-Cervera2006} where the field is derived from the magnetostatic potential, and the energy is not computed exactly. \n\nIt is therefore desireable to be able to accurately and efficiently compute the total magnetostatic energy of a system represented by a set of polyhedral elements, with magnetization linear inside each polyhedron (as in the FE method with linear Lagrange elements). The total energy of the system is the sum of pairwise interactions between the polyhedrons and in this paper we describe how to compute this pairwise interaction. \n\nGiven two interacting magnetized polyhedrons $\\tau$  and $\\tau'$ with arbitrary magnetizations $\\mathbf M(\\mathbf r)$ and $\\mathbf M'(\\mathbf r)$, the energy $E_{\\tau\\leftrightarrow\\tau'}$ of the magnetostatic interaction between them is:\n\n", "index": 3, "text": "\\begin{equation}\nE_{\\tau\\leftrightarrow\\tau'} = - \\mu_0 \\int_{\\tau} \\mathbf M(\\mathbf r) \\cdot \\mathbf H'_{\\mathrm{demag}}(\\mathbf r) \\, d\\mathbf r\n= \\frac{\\mu_0}{4\\pi} \\int_{\\tau} \\int_{\\tau'} \n\t\\mathbf M(\\mathbf r) \\cdot\n\t\t\\big(\\nabla_{\\mathbf r} \\nabla_{\\mathbf r'} \\frac{1}{|\\mathbf r-\\mathbf r'|}\\big) \n\t\\cdot \\mathbf M'(\\mathbf r') \n\t\\, d\\mathbf r \\, d \\mathbf r'\n\\label{eq-pairwise}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"E_{\\tau\\leftrightarrow\\tau^{\\prime}}=-\\mu_{0}\\int_{\\tau}\\mathbf{M}(\\mathbf{r})%&#10;\\cdot\\mathbf{H}^{\\prime}_{\\mathrm{demag}}(\\mathbf{r})\\,d\\mathbf{r}=\\frac{\\mu_{%&#10;0}}{4\\pi}\\int_{\\tau}\\int_{\\tau^{\\prime}}\\mathbf{M}(\\mathbf{r})\\cdot\\big{(}%&#10;\\nabla_{\\mathbf{r}}\\nabla_{\\mathbf{r}^{\\prime}}\\frac{1}{|\\mathbf{r}-\\mathbf{r}%&#10;^{\\prime}|}\\big{)}\\cdot\\mathbf{M}^{\\prime}(\\mathbf{r}^{\\prime})\\,d\\mathbf{r}\\,%&#10;d\\mathbf{r}^{\\prime}\" display=\"block\"><mrow><msub><mi>E</mi><mrow><mi>\u03c4</mi><mo>\u2194</mo><msup><mi>\u03c4</mi><mo>\u2032</mo></msup></mrow></msub><mo>=</mo><mrow><mo>-</mo><mrow><msub><mi>\u03bc</mi><mn>0</mn></msub><mo>\u2062</mo><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mi>\u03c4</mi></msub><mrow><mrow><mrow><mi>\ud835\udc0c</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u22c5</mo><msubsup><mi>\ud835\udc07</mi><mi>demag</mi><mo>\u2032</mo></msubsup></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>\ud835\udc2b</mi></mrow></mrow></mrow></mrow></mrow><mo>=</mo><mrow><mfrac><msub><mi>\u03bc</mi><mn>0</mn></msub><mrow><mn>4</mn><mo>\u2062</mo><mi>\u03c0</mi></mrow></mfrac><mo>\u2062</mo><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mi>\u03c4</mi></msub><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><msup><mi>\u03c4</mi><mo>\u2032</mo></msup></msub><mrow><mrow><mrow><mi>\ud835\udc0c</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u22c5</mo><mrow><mo maxsize=\"120%\" minsize=\"120%\">(</mo><mrow><mrow><msub><mo>\u2207</mo><mi>\ud835\udc2b</mi></msub><mo>\u2061</mo><msub><mo>\u2207</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></msub></mrow><mo>\u2061</mo><mfrac><mn>1</mn><mrow><mo stretchy=\"false\">|</mo><mrow><mi>\ud835\udc2b</mi><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow><mo stretchy=\"false\">|</mo></mrow></mfrac></mrow><mo maxsize=\"120%\" minsize=\"120%\">)</mo></mrow><mo>\u22c5</mo><msup><mi>\ud835\udc0c</mi><mo>\u2032</mo></msup></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mpadded width=\"+1.7pt\"><mi>\ud835\udc2b</mi></mpadded></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow></mrow></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "\n\n\\begin{figure} \\centering\n\\includegraphics[width=10cm]{tets.pdf}\n\\caption{The energy $E_{\\tau\\leftrightarrow\\tau'}$ of the magnetostatic interaction between  polyhedrons $\\tau$  and $\\tau'$ with magnetizations $A(\\mathbf r) \\mathbf M$ and $B(\\mathbf r) \\mathbf M'$, where $\\mathbf M$ and $\\mathbf M'$ are constant magnetization vectors and $A(\\mathbf r)$, $B(\\mathbf r)$ are dimensionless linear functions in space.}\n\\label{fig-tets} \n\\end{figure}\n\nThe goal of this paper is to compute this sixfold integral given the coordinates of the vertices of $\\tau$ and~$\\tau'$ and the coefficients of the linear functions $A(\\mathbf r)$ and $B(\\mathbf r)$. When the polyhedrons $\\tau$ and $\\tau'$  are separated, the integral can be computed numerically, however when the polyhedrons overlap or coincide, the integrand is singular and standard numerical integration is inaccurate. \n\nTo deal with this issue, we analytically reduce the double volume integral~\\eqref{eq-tettet} to a double surface integral, then evaluate the surface integral over $\\mathbf r$ analytically, and the second  surface integral integral over $\\mathbf r'$ numerically. This procedure is similar to the one employed in~\\cite{Arcioni1997} --- the four analytical steps result in a surface integral with a bounded integrand that can be integrated numerically with reasonable accuracy and efficiency.\n\nA short notice on units: the demagnetizing tensor commonly used in finite difference micromagnetics~\\cite{Newell1993} is dimensionless, however the tensor~$\\mathbf N$ computed in this paper~\\eqref{eq-tettet} has units of volume.\n\n\\section{Method}\n\nThe analytical derivation proceeds in the following three steps:\n\\begin{itemize}\n  \\item transform the double volume integral~\\eqref{eq-tettet} to a double surface integral using Gauss's theorem, removing linear factors via integration by parts \n  (Section~\\ref{sec:vol2surface}), \n  \\item express the integrand for the outer surface integral over $\\mathbf r'$ as a linear combination of primitive terms  (Section~\\ref{sec:surf2terms}), \n \n", "itemtype": "equation", "pos": 7942, "prevtext": "\nwhere  $H'_{\\mathrm{demag}}(\\mathbf r) = - \\frac{1}{4 \\pi} \\nabla_{\\mathbf r} \\int_{\\tau'} \\mathbf M'(\\mathbf r') \\cdot \\nabla_{\\mathbf r'} (1/|\\mathbf r-\\mathbf r'|) \\, d\\mathbf r'$ is the demagnetizing (stray) field produced by the polyhedron~$\\tau'$.\n\nThe straightforward approach of numerically computing the integral~\\eqref{eq-pairwise} is problematic because it requires explicit integration over a 6-dimensional region of space; additionally, when the polyhedrons overlap or coincide, the integrand is singular and regular integration methods cannot be applied. \nMany analytical results are available for similar 3-fold integrals arising during the calculation of the field~\\cite{Wilton1984,Graglia1987,Graglia1993,Fabbri2008,Fabbri2009}. However, none of the formulas can be easily adapted to this more complex 6d case. In~\\cite{Masserey2005} a method is developed for removing the singularity in~\\eqref{eq-pairwise} that can be applied to the uniform magnetization case but does not generalize easily to the linear magnetization case. A Fourier-transform method has been devised for the computation of magnetostatic energy~\\cite{Beleggia2005,Beleggia2004}, however for the case investigated in this paper, the required 3d numerical integration in the Fourier space is still somewhat impractical. \n\nThe rest of the paper describes the proposed method for the computation of this integral. The main approach is to analytically perform 4 out of 6 iterated integrals resulting in a 2d surface integral that is nonsingular and can be evaluated numerically using standard methods. This semi-analytical approach is similar to~\\cite{Arcioni1997}; the use of notation and vector analysis in the analytical derivation is similar to the techniques in~\\cite{Fabbri2008,Fabbri2009}.  \n\n\\section{Formulation of the problem}\n\nFor the purposes of computation, an arbitrary linear vector-valued function in space $\\mathbf M(\\mathbf r)$ can be represented by a $3 \\times 4$ matrix $|| M_{ij} ||$: \n$\\mathbf M(\\mathbf r) = || M_{ij} || \\cdot (1, r_x, r_y, r_z)^T$. However, performing analytical calculations for this general case is quite inconvenient; instead we only consider vector-valued linear functions of the form $A(\\mathbf r) \\mathbf M$ where $A(\\mathbf r)$ is a scalar linear function and $\\mathbf M$ is a constant vector. For the common case of a tetrahedral element, an arbitrary linear vector-valued function $\\mathbf M(\\mathbf r)$ can be reconstructed from the vertex values $\\mathbf M_i$, $i=1\\dots 4$: \n$\\mathbf M(\\mathbf r) = \\sum_{i=1}^4 A_i(r) \\mathbf M_i $, where $A_i(r)$ are the shape functions of the tetrahedron. \n\n\nWe perform the computations for a pair of interacting linearly magnetized polyhedrons $\\tau$  and $\\tau'$ with magnetizations $A(\\mathbf r) \\mathbf M$ and $B(\\mathbf r) \\mathbf M'$, where $\\mathbf M$ and $\\mathbf M'$ are constant magnetization vectors and $A(\\mathbf r)$, $B(\\mathbf r)$ are dimensionless linear functions in space (Figure~\\ref{fig-tets}). From~\\eqref{eq-pairwise}, the energy $E_{\\tau\\leftrightarrow\\tau'}$ of the magnetostatic interaction between the polyhedrons is $E_{\\tau\\leftrightarrow\\tau'} = \\frac{\\mu_0}{4 \\pi} \\, \\mathbf M\\cdot \\mathbf N \\cdot \\mathbf M'$, where $\\mathbf N$ is the symmetric $3\\times3$ ``demagnetizing tensor'' \n\n", "index": 5, "text": "\\begin{equation}\n\\mathbf N = \\mathbf N(A, B, \\tau, \\tau') = \\int_\\tau \\int_{\\tau'} A(\\mathbf r) B(\\mathbf r') \\nabla_{\\mathbf r} \\nabla_{\\mathbf r'} \\frac{1}{|\\mathbf r-\\mathbf r'|}\\, d\\mathbf r \\, d \\mathbf r'\n\\label{eq-tettet}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"\\mathbf{N}=\\mathbf{N}(A,B,\\tau,\\tau^{\\prime})=\\int_{\\tau}\\int_{\\tau^{\\prime}}A%&#10;(\\mathbf{r})B(\\mathbf{r}^{\\prime})\\nabla_{\\mathbf{r}}\\nabla_{\\mathbf{r}^{%&#10;\\prime}}\\frac{1}{|\\mathbf{r}-\\mathbf{r}^{\\prime}|}\\,d\\mathbf{r}\\,d\\mathbf{r}^{\\prime}\" display=\"block\"><mrow><mi>\ud835\udc0d</mi><mo>=</mo><mrow><mi>\ud835\udc0d</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>A</mi><mo>,</mo><mi>B</mi><mo>,</mo><mi>\u03c4</mi><mo>,</mo><msup><mi>\u03c4</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mi>\u03c4</mi></msub><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><msup><mi>\u03c4</mi><mo>\u2032</mo></msup></msub><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>B</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mrow><msub><mo>\u2207</mo><mi>\ud835\udc2b</mi></msub><mo>\u2061</mo><msub><mo>\u2207</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></msub></mrow><mo>\u2061</mo><mrow><mpadded width=\"+1.7pt\"><mfrac><mn>1</mn><mrow><mo stretchy=\"false\">|</mo><mrow><mi>\ud835\udc2b</mi><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow><mo stretchy=\"false\">|</mo></mrow></mfrac></mpadded><mo>\u2062</mo><mi>d</mi><mo>\u2062</mo><mpadded width=\"+1.7pt\"><mi>\ud835\udc2b</mi></mpadded><mo>\u2062</mo><mi>d</mi><mo>\u2062</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow></mrow></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "\n where $\\partial \\tau$ is the polygonal surface of the polyhedron $\\tau$, $\\partial \\tau - \\mathbf r'$ is the same surface shifted by $\\mathbf r'$ according to the the substitution ${\\mathbf R} = \\mathbf r - \\mathbf r'$, and $\\otimes$ denotes tensor multiplication (i.e. $\\mathbf R^{\\otimes 2}$ is a symmetric tensor of rank 2).\n   \\item analytically integrate the primitive terms $\\mathbf I_k$ over each polygonal surface, again by applying integration by parts, Stokes' theorem (for integration over a surface), and gradient theorem (for integration over a line), Section~\\ref{sec:eval-ik}.\n\\end{itemize}\n\nThe equation \\eqref{eq-surface-i} derived in step 2 (see Section~\\ref{sec:analyticalresult}) together with the corresponding analytical formulas for the primitive terms $\\mathbf I_k$ form the main result of the paper. \n\n\\subsection{Auxiliary functions}\n\nThe derivation of the analytical formulas for $\\mathbf I_k$ requires the computation of a number of auxiliary functions:\n\n\n", "itemtype": "equation", "pos": 10239, "prevtext": "\n\n\\begin{figure} \\centering\n\\includegraphics[width=10cm]{tets.pdf}\n\\caption{The energy $E_{\\tau\\leftrightarrow\\tau'}$ of the magnetostatic interaction between  polyhedrons $\\tau$  and $\\tau'$ with magnetizations $A(\\mathbf r) \\mathbf M$ and $B(\\mathbf r) \\mathbf M'$, where $\\mathbf M$ and $\\mathbf M'$ are constant magnetization vectors and $A(\\mathbf r)$, $B(\\mathbf r)$ are dimensionless linear functions in space.}\n\\label{fig-tets} \n\\end{figure}\n\nThe goal of this paper is to compute this sixfold integral given the coordinates of the vertices of $\\tau$ and~$\\tau'$ and the coefficients of the linear functions $A(\\mathbf r)$ and $B(\\mathbf r)$. When the polyhedrons $\\tau$ and $\\tau'$  are separated, the integral can be computed numerically, however when the polyhedrons overlap or coincide, the integrand is singular and standard numerical integration is inaccurate. \n\nTo deal with this issue, we analytically reduce the double volume integral~\\eqref{eq-tettet} to a double surface integral, then evaluate the surface integral over $\\mathbf r$ analytically, and the second  surface integral integral over $\\mathbf r'$ numerically. This procedure is similar to the one employed in~\\cite{Arcioni1997} --- the four analytical steps result in a surface integral with a bounded integrand that can be integrated numerically with reasonable accuracy and efficiency.\n\nA short notice on units: the demagnetizing tensor commonly used in finite difference micromagnetics~\\cite{Newell1993} is dimensionless, however the tensor~$\\mathbf N$ computed in this paper~\\eqref{eq-tettet} has units of volume.\n\n\\section{Method}\n\nThe analytical derivation proceeds in the following three steps:\n\\begin{itemize}\n  \\item transform the double volume integral~\\eqref{eq-tettet} to a double surface integral using Gauss's theorem, removing linear factors via integration by parts \n  (Section~\\ref{sec:vol2surface}), \n  \\item express the integrand for the outer surface integral over $\\mathbf r'$ as a linear combination of primitive terms  (Section~\\ref{sec:surf2terms}), \n \n", "index": 7, "text": "\\begin{align}\nI_0(\\tau; \\mathbf r') &= \\int_{\\partial\\tau - \\mathbf r'} \\frac{1}{|{\\mathbf R}|} ds \\label{eq-i0} \\\\ \n\\mathbf I_1(\\tau; \\mathbf r') &= \\int_{\\partial\\tau - \\mathbf r'} \\frac{{\\mathbf R}}{|{\\mathbf R}|} ds \\\\ \n\\mathbf I_2(\\tau; \\mathbf r') &= \\int_{\\partial\\tau - \\mathbf r'} \\frac{{\\mathbf R}^{\\otimes 2}}{|{\\mathbf R}|} \\label{eq-i2} ds\n \\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle I_{0}(\\tau;\\mathbf{r}^{\\prime})\" display=\"inline\"><mrow><msub><mi>I</mi><mn>0</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c4</mi><mo>;</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\int_{\\partial\\tau-\\mathbf{r}^{\\prime}}\\frac{1}{|{\\mathbf{R}}|}ds\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mstyle displaystyle=\"true\"><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>\u03c4</mi></mrow><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow></msub></mstyle><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mfrac></mstyle><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>s</mi></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\mathbf{I}_{1}(\\tau;\\mathbf{r}^{\\prime})\" display=\"inline\"><mrow><msub><mi>\ud835\udc08</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c4</mi><mo>;</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\int_{\\partial\\tau-\\mathbf{r}^{\\prime}}\\frac{{\\mathbf{R}}}{|{%&#10;\\mathbf{R}}|}ds\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mstyle displaystyle=\"true\"><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>\u03c4</mi></mrow><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow></msub></mstyle><mrow><mstyle displaystyle=\"true\"><mfrac><mi>\ud835\udc11</mi><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mfrac></mstyle><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>s</mi></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\mathbf{I}_{2}(\\tau;\\mathbf{r}^{\\prime})\" display=\"inline\"><mrow><msub><mi>\ud835\udc08</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c4</mi><mo>;</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\int_{\\partial\\tau-\\mathbf{r}^{\\prime}}\\frac{{\\mathbf{R}}^{%&#10;\\otimes 2}}{|{\\mathbf{R}}|}ds\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mstyle displaystyle=\"true\"><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>\u03c4</mi></mrow><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow></msub></mstyle><mrow><mstyle displaystyle=\"true\"><mfrac><msup><mi>\ud835\udc11</mi><mrow><mi/><mo>\u2297</mo><mn>2</mn></mrow></msup><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mfrac></mstyle><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>s</mi></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "\n \n The relation between the formulas for these functions is shown below (an arrow indicates that the formula at the source depends on the formula at the target):\n\n\n", "itemtype": "equation", "pos": 11589, "prevtext": "\n where $\\partial \\tau$ is the polygonal surface of the polyhedron $\\tau$, $\\partial \\tau - \\mathbf r'$ is the same surface shifted by $\\mathbf r'$ according to the the substitution ${\\mathbf R} = \\mathbf r - \\mathbf r'$, and $\\otimes$ denotes tensor multiplication (i.e. $\\mathbf R^{\\otimes 2}$ is a symmetric tensor of rank 2).\n   \\item analytically integrate the primitive terms $\\mathbf I_k$ over each polygonal surface, again by applying integration by parts, Stokes' theorem (for integration over a surface), and gradient theorem (for integration over a line), Section~\\ref{sec:eval-ik}.\n\\end{itemize}\n\nThe equation \\eqref{eq-surface-i} derived in step 2 (see Section~\\ref{sec:analyticalresult}) together with the corresponding analytical formulas for the primitive terms $\\mathbf I_k$ form the main result of the paper. \n\n\\subsection{Auxiliary functions}\n\nThe derivation of the analytical formulas for $\\mathbf I_k$ requires the computation of a number of auxiliary functions:\n\n\n", "index": 9, "text": "\\begin{align}\nJ_0(\\tau; \\mathbf r') &= \\int_{\\partial \\tau - \\mathbf r'} |{\\mathbf R}| ds \\\\ \n\\eta_0({\\mathbf R}_1, {\\mathbf R}_2) &= \\int_{{\\mathbf R}_1}^{{\\mathbf R}_2} \\frac{1}{|\\mathbf R|} dl \\\\ \n\\boldsymbol\\eta_1({\\mathbf R}_1, {\\mathbf R}_2) &= \\int_{{\\mathbf R}_1}^{{\\mathbf R}_2} \\frac{{\\mathbf R}}{|{\\mathbf R}|} dl \\\\ \n\\lambda_0({\\mathbf R}_1, {\\mathbf R}_2) &= \\int_{{\\mathbf R}_1}^{{\\mathbf R}_2} {|{\\mathbf R}|} dl \\\\ \n\\boldsymbol\\lambda_1({\\mathbf R}_1, {\\mathbf R}_2) &= \\int_{{\\mathbf R}_1}^{{\\mathbf R}_2} {\\mathbf R}{|{\\mathbf R}|} dl \\\\ \n \\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle J_{0}(\\tau;\\mathbf{r}^{\\prime})\" display=\"inline\"><mrow><msub><mi>J</mi><mn>0</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c4</mi><mo>;</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\int_{\\partial\\tau-\\mathbf{r}^{\\prime}}|{\\mathbf{R}}|ds\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mstyle displaystyle=\"true\"><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>\u03c4</mi></mrow><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow></msub></mstyle><mrow><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>s</mi></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\eta_{0}({\\mathbf{R}}_{1},{\\mathbf{R}}_{2})\" display=\"inline\"><mrow><msub><mi>\u03b7</mi><mn>0</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\int_{{\\mathbf{R}}_{1}}^{{\\mathbf{R}}_{2}}\\frac{1}{|\\mathbf{R}|}dl\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mstyle displaystyle=\"true\"><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><msub><mi>\ud835\udc11</mi><mn>2</mn></msub></msubsup></mstyle><mrow><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mfrac></mstyle><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>l</mi></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E10.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\bm{\\eta}_{1}({\\mathbf{R}}_{1},{\\mathbf{R}}_{2})\" display=\"inline\"><mrow><msub><mi>\ud835\udf3c</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E10.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\int_{{\\mathbf{R}}_{1}}^{{\\mathbf{R}}_{2}}\\frac{{\\mathbf{R}}}{|{%&#10;\\mathbf{R}}|}dl\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mstyle displaystyle=\"true\"><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><msub><mi>\ud835\udc11</mi><mn>2</mn></msub></msubsup></mstyle><mrow><mstyle displaystyle=\"true\"><mfrac><mi>\ud835\udc11</mi><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mfrac></mstyle><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>l</mi></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E11.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\lambda_{0}({\\mathbf{R}}_{1},{\\mathbf{R}}_{2})\" display=\"inline\"><mrow><msub><mi>\u03bb</mi><mn>0</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E11.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\int_{{\\mathbf{R}}_{1}}^{{\\mathbf{R}}_{2}}{|{\\mathbf{R}}|}dl\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mstyle displaystyle=\"true\"><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><msub><mi>\ud835\udc11</mi><mn>2</mn></msub></msubsup></mstyle><mrow><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>l</mi></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E12.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\bm{\\lambda}_{1}({\\mathbf{R}}_{1},{\\mathbf{R}}_{2})\" display=\"inline\"><mrow><msub><mi>\ud835\udf40</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E12.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\int_{{\\mathbf{R}}_{1}}^{{\\mathbf{R}}_{2}}{\\mathbf{R}}{|{\\mathbf%&#10;{R}}|}dl\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mstyle displaystyle=\"true\"><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><msub><mi>\ud835\udc11</mi><mn>2</mn></msub></msubsup></mstyle><mrow><mi>\ud835\udc11</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>l</mi></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": " \n\n \n\\section{Analytical derivation --- reduction to a surface integral}\n\\label{sec:vol2surface}      \n\nThe first step is the conversion of~\\eqref{eq-tettet} to a double surface integral.\nDue to the high complexity of intermediate expressions the derivation was performed using a computer algebra system; the source code is included in the supplementary information for this paper~\\cite{githubrepo}. Table~\\ref{tab-vol-surf-conversion} shows the identities used in the derivation, they are applied repeatedly in a straightforward manner to integrate the terms and simplify the result. We chose to express the vector/tensor identities using tensor notation which is compact and more suitable for computer algebra than using explicit indices (with Einstein summation). \n\nAfter repeatedly applying the identities in Table~\\ref{tab-vol-surf-conversion}, we arrive at the following formula for the demagnetizing tensor\n\n", "itemtype": "equation", "pos": -1, "prevtext": "\n \n The relation between the formulas for these functions is shown below (an arrow indicates that the formula at the source depends on the formula at the target):\n\n\n", "index": 11, "text": "\\begin{equation}\n\\label{eq:formula-relations}\n\\begin{CD}\n\\eta_0 @<<< I_0 \\\\\n@AAA @AAA \\\\  \n\\lambda_0 @<<< \\mathbf I_1 \\\\ \n@AAA @AAA \\\\  \nJ_0 @<<< \\mathbf I_2 @>>> \\boldsymbol\\lambda_1 @>>> \\boldsymbol\\eta_1 \\\\ \n\\end{CD}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14.m1\" class=\"ltx_Math\" alttext=\"\\begin{CD}\\eta_{0}@&lt;{}&lt;{}&lt;I_{0}\\\\&#10;@A{}A{}A@A{}A{}A\\\\&#10;\\lambda_{0}@&lt;{}&lt;{}&lt;\\mathbf{I}_{1}\\\\&#10;@A{}A{}A@A{}A{}A\\\\&#10;J_{0}@&lt;{}&lt;{}&lt;\\mathbf{I}_{2}@&gt;{}&gt;{}&gt;\\bm{\\lambda}_{1}@&gt;{}&gt;{}&gt;\\bm{\\eta}_{1}\\\\&#10;\\end{CD}\" display=\"block\"><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><msub><mi>\u03b7</mi><mn>0</mn></msub></mtd><mtd columnalign=\"center\"><mo>\u2190</mo></mtd><mtd columnalign=\"center\"><msub><mi>I</mi><mn>0</mn></msub></mtd></mtr><mtr><mtd columnalign=\"center\"><mo mathsize=\"160%\" stretchy=\"false\">\u2191</mo></mtd><mtd/><mtd columnalign=\"center\"><mo mathsize=\"160%\" stretchy=\"false\">\u2191</mo></mtd><mtd/><mtd/></mtr><mtr><mtd columnalign=\"center\"><msub><mi>\u03bb</mi><mn>0</mn></msub></mtd><mtd columnalign=\"center\"><mo>\u2190</mo></mtd><mtd columnalign=\"center\"><msub><mi>\ud835\udc08</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign=\"center\"><mo mathsize=\"160%\" stretchy=\"false\">\u2191</mo></mtd><mtd/><mtd columnalign=\"center\"><mo mathsize=\"160%\" stretchy=\"false\">\u2191</mo></mtd><mtd/><mtd/></mtr><mtr><mtd columnalign=\"center\"><msub><mi>J</mi><mn>0</mn></msub></mtd><mtd columnalign=\"center\"><mo>\u2190</mo></mtd><mtd columnalign=\"center\"><msub><mi>\ud835\udc08</mi><mn>2</mn></msub></mtd><mtd columnalign=\"center\"><mo>\u2192</mo></mtd><mtd columnalign=\"center\"><msub><mi>\ud835\udf40</mi><mn>1</mn></msub></mtd><mtd columnalign=\"center\"><mo>\u2192</mo></mtd><mtd columnalign=\"center\"><msub><mi>\ud835\udf3c</mi><mn>1</mn></msub></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "\nwhere ${\\mathbf n}_{{\\mathbf r}}$, ${\\mathbf n}_{{\\mathbf r}'}$ are the normal vectors to the corresponding surfaces and $\\nabla A$, $\\nabla B$ are the (constant) gradient vectors for the linear functions $A(\\mathbf r)$ and $B(\\mathbf r)$. As expected, the formula is symmetrical under replacement $A \\leftrightarrow B$, ${\\mathbf r} \\leftrightarrow {\\mathbf r}'$ and reduces to Gauss's theorem when $A(\\mathbf r)$ and $B(\\mathbf r)$ are constant.\n\nSide note: in principle, all derivations could be performed with scalars instead of tensors by computing the scalar counterpart to the integral~\\eqref{eq-tettet}\n\n", "itemtype": "equation", "pos": 13470, "prevtext": " \n\n \n\\section{Analytical derivation --- reduction to a surface integral}\n\\label{sec:vol2surface}      \n\nThe first step is the conversion of~\\eqref{eq-tettet} to a double surface integral.\nDue to the high complexity of intermediate expressions the derivation was performed using a computer algebra system; the source code is included in the supplementary information for this paper~\\cite{githubrepo}. Table~\\ref{tab-vol-surf-conversion} shows the identities used in the derivation, they are applied repeatedly in a straightforward manner to integrate the terms and simplify the result. We chose to express the vector/tensor identities using tensor notation which is compact and more suitable for computer algebra than using explicit indices (with Einstein summation). \n\nAfter repeatedly applying the identities in Table~\\ref{tab-vol-surf-conversion}, we arrive at the following formula for the demagnetizing tensor\n\n", "index": 13, "text": "\\begin{equation}\n\\begin{split}\n\\mathbf N =\n\\int_{\\partial \\tau'} \\int_{\\partial \\tau}  \\Big[\n\\frac 12 A({\\mathbf r}) ({\\mathbf n}_{{\\mathbf r}'} \\cdot ({\\mathbf r} - {\\mathbf r}')) \\, {\\mathbf n}_{\\mathbf r} \\otimes\\nabla B\n- \\frac 12 B({\\mathbf r}') ({\\mathbf n}_{{\\mathbf r}} \\cdot ({\\mathbf r} - {\\mathbf r}')) \\, {\\mathbf n}_{{\\mathbf r}'} \\otimes\\nabla A\n\\\\\n+ \\frac 16 ({\\mathbf n}_{{\\mathbf r}} \\cdot ({\\mathbf r} - {\\mathbf r}')) ({\\mathbf n}_{{\\mathbf r}'} \\cdot ({\\mathbf r} - {\\mathbf r}')) \\, \\nabla A \\otimes\\nabla B\n+ A({\\mathbf r}) B({\\mathbf r}') \\, {\\mathbf n}_{{\\mathbf r}} \\otimes {\\mathbf n}_{{\\mathbf r}'}\n\\Big]\n\\frac{1}{|{\\mathbf r} - {\\mathbf r}'|}\nds\\, ds'\n\\end{split}\n\\label{eq-surfsurf}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E15.m1\" class=\"ltx_Math\" alttext=\"\\begin{split}\\displaystyle\\mathbf{N}=\\int_{\\partial\\tau^{\\prime}}\\int_{%&#10;\\partial\\tau}\\Big{[}\\frac{1}{2}A({\\mathbf{r}})({\\mathbf{n}}_{{\\mathbf{r}}^{%&#10;\\prime}}\\cdot({\\mathbf{r}}-{\\mathbf{r}}^{\\prime}))\\,{\\mathbf{n}}_{\\mathbf{r}}%&#10;\\otimes\\nabla B-\\frac{1}{2}B({\\mathbf{r}}^{\\prime})({\\mathbf{n}}_{{\\mathbf{r}}%&#10;}\\cdot({\\mathbf{r}}-{\\mathbf{r}}^{\\prime}))\\,{\\mathbf{n}}_{{\\mathbf{r}}^{%&#10;\\prime}}\\otimes\\nabla A\\\\&#10;\\displaystyle+\\frac{1}{6}({\\mathbf{n}}_{{\\mathbf{r}}}\\cdot({\\mathbf{r}}-{%&#10;\\mathbf{r}}^{\\prime}))({\\mathbf{n}}_{{\\mathbf{r}}^{\\prime}}\\cdot({\\mathbf{r}}-%&#10;{\\mathbf{r}}^{\\prime}))\\,\\nabla A\\otimes\\nabla B+A({\\mathbf{r}})B({\\mathbf{r}}%&#10;^{\\prime})\\,{\\mathbf{n}}_{{\\mathbf{r}}}\\otimes{\\mathbf{n}}_{{\\mathbf{r}}^{%&#10;\\prime}}\\Big{]}\\frac{1}{|{\\mathbf{r}}-{\\mathbf{r}}^{\\prime}|}ds\\,ds^{\\prime}%&#10;\\end{split}\" display=\"block\"><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"right\"><mrow><mi>\ud835\udc0d</mi><mo>=</mo><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><msup><mi>\u03c4</mi><mo>\u2032</mo></msup></mrow></msub><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>\u03c4</mi></mrow></msub><mrow><mo maxsize=\"160%\" minsize=\"160%\">[</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>A</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc27</mi><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></msub><mo>\u22c5</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><msub><mi>\ud835\udc27</mi><mi>\ud835\udc2b</mi></msub><mo>\u2297</mo><mo>\u2207</mo><mi>B</mi><mo>-</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>B</mi><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc27</mi><mi>\ud835\udc2b</mi></msub><mo>\u22c5</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><msub><mi>\ud835\udc27</mi><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></msub><mo>\u2297</mo><mo>\u2207</mo><mi>A</mi></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mrow><mo>+</mo><mfrac><mn>1</mn><mn>6</mn></mfrac><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc27</mi><mi>\ud835\udc2b</mi></msub><mo>\u22c5</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc27</mi><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></msub><mo>\u22c5</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2207</mo><mi>A</mi><mo>\u2297</mo><mo>\u2207</mo><mi>B</mi><mo>+</mo><mi>A</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow><mi>B</mi><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><msub><mi>\ud835\udc27</mi><mi>\ud835\udc2b</mi></msub><mo>\u2297</mo><msub><mi>\ud835\udc27</mi><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></msub><mo maxsize=\"160%\" minsize=\"160%\">]</mo><mfrac><mn>1</mn><mrow><mo stretchy=\"false\">|</mo><mrow><mi>\ud835\udc2b</mi><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow><mo stretchy=\"false\">|</mo></mrow></mfrac><mi>d</mi><mpadded width=\"+1.7pt\"><mi>s</mi></mpadded><mi>d</mi><mi>s</mi><msup><mi/><mo>\u2032</mo></msup></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "\nWith this method the auxiliary vectors $\\mathbf m$ and $\\mathbf m'$ would have to be included in all intermediate derivations;  \nthis would remove the need to keep track of tensor indices at the cost of slightly expanded notation.\n\n\n\n\\begin{table*}[htb]\n\\centering\n\\begin{tabular}{|c|c|}\n\\hline\nGauss's theorem &\n\\marginbox{2pt}{$ \\displaystyle\n\\int_V \\nabla_{\\mathbf r} \\, \\mathbf F \\, dr = \\int_{\\partial V} {\\mathbf n} \\otimes \\mathbf F \\, dr\n$}\n\\\\\n\\hline\ngradient of a product &\n\\marginbox{2pt}{$ \\displaystyle\na \\, \\nabla_\\mathbf r \\mathbf F =\n\\nabla_\\mathbf r [a \\, \\mathbf F]\n- \\nabla a \\otimes \\mathbf F\n$}\n\\\\\n\\hline\nintegration of $\\frac{({\\mathbf r}-{\\mathbf r}')^{\\otimes k}}{|{\\mathbf r}-{\\mathbf r}'|}$ &\n\\marginbox{2pt}{$ \\displaystyle\n\\frac{({\\mathbf r}-{\\mathbf r}')^{\\otimes k}}{|{\\mathbf r}-{\\mathbf r}'|} =\n\\frac{1}{k+2} \\nabla_{\\mathbf r} \\cdot \\frac{({\\mathbf r}-{\\mathbf r}')^{\\otimes \\, k+1}}{|{\\mathbf r}-{\\mathbf r}'|}\n$}\n\\\\\n\\hline\n\\end{tabular}\n\\caption{Identities used in the conversion of the double volume integral~\\eqref{eq-tettet} to a double surface integral. Here $\\mathbf F({\\mathbf r})$ is a tensor of any rank and $a({\\mathbf r})$ is a scalar. When the gradient operator $\\nabla$ is applied to a vector or tensor, we assume that the new tensor index is added at the front (i.e. $\\nabla f_{jk} = \\partial_i f_{jk}$). Similarly, divergence applies to the first index of a tensor (i.e. $\\nabla f_{jk} = \\partial_j f_{jk}$).} \n\\label{tab-vol-surf-conversion}\n\\end{table*}\n\n\\section{Analytical result --- integrand and the primitive terms~$\\mathbf I_k$}\n\\label{sec:analyticalresult}  \n\\label{sec:surf2terms}      \n\nThe next step is to express the inner integral over~${\\mathbf r}$ in~\\eqref{eq-surfsurf} in terms of the primitive integrals~$\\mathbf I_k$~\\eqref{eq-i0}--\\eqref{eq-i2}. By using the identity $A({\\mathbf r}) = A({\\mathbf r}') - ({\\mathbf r} - {\\mathbf r}')\\cdot \\nabla A$, we get\n\n\n", "itemtype": "equation", "pos": 14808, "prevtext": "\nwhere ${\\mathbf n}_{{\\mathbf r}}$, ${\\mathbf n}_{{\\mathbf r}'}$ are the normal vectors to the corresponding surfaces and $\\nabla A$, $\\nabla B$ are the (constant) gradient vectors for the linear functions $A(\\mathbf r)$ and $B(\\mathbf r)$. As expected, the formula is symmetrical under replacement $A \\leftrightarrow B$, ${\\mathbf r} \\leftrightarrow {\\mathbf r}'$ and reduces to Gauss's theorem when $A(\\mathbf r)$ and $B(\\mathbf r)$ are constant.\n\nSide note: in principle, all derivations could be performed with scalars instead of tensors by computing the scalar counterpart to the integral~\\eqref{eq-tettet}\n\n", "index": 15, "text": "\\begin{equation}\nN(\\mathbf m, \\mathbf m') = \\mathbf m \\cdot \\mathbf N \\cdot \\mathbf m' = \\int_\\tau \\int_{\\tau'} A(\\mathbf r) B(\\mathbf r') \n(\\mathbf m \\cdot \\nabla_{\\mathbf r}) (\\mathbf m' \\cdot \\nabla_{\\mathbf r'}) \\frac{1}{|\\mathbf r-\\mathbf r'|} \\, d\\mathbf r \\, d\\mathbf r'\n \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E16.m1\" class=\"ltx_Math\" alttext=\"N(\\mathbf{m},\\mathbf{m}^{\\prime})=\\mathbf{m}\\cdot\\mathbf{N}\\cdot\\mathbf{m}^{%&#10;\\prime}=\\int_{\\tau}\\int_{\\tau^{\\prime}}A(\\mathbf{r})B(\\mathbf{r}^{\\prime})(%&#10;\\mathbf{m}\\cdot\\nabla_{\\mathbf{r}})(\\mathbf{m}^{\\prime}\\cdot\\nabla_{\\mathbf{r}%&#10;^{\\prime}})\\frac{1}{|\\mathbf{r}-\\mathbf{r}^{\\prime}|}\\,d\\mathbf{r}\\,d\\mathbf{r%&#10;}^{\\prime}\" display=\"block\"><mrow><mrow><mi>N</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc26</mi><mo>,</mo><msup><mi>\ud835\udc26</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mi>\ud835\udc26</mi><mo>\u22c5</mo><mi>\ud835\udc0d</mi><mo>\u22c5</mo><msup><mi>\ud835\udc26</mi><mo>\u2032</mo></msup></mrow><mo>=</mo><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mi>\u03c4</mi></msub><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><msup><mi>\u03c4</mi><mo>\u2032</mo></msup></msub><mrow><mi>A</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>B</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc26</mi><mo>\u22c5</mo><msub><mo>\u2207</mo><mi>\ud835\udc2b</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mi>\ud835\udc26</mi><mo>\u2032</mo></msup><mo>\u22c5</mo><msub><mo>\u2207</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mpadded width=\"+1.7pt\"><mfrac><mn>1</mn><mrow><mo stretchy=\"false\">|</mo><mrow><mi>\ud835\udc2b</mi><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow><mo stretchy=\"false\">|</mo></mrow></mfrac></mpadded><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mpadded width=\"+1.7pt\"><mi>\ud835\udc2b</mi></mpadded></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "\n\nNote that the primitive integral $\\mathbf I_k$ is a tensor of rank~$k$ and is a function of $\\mathbf r'$.\n\n\\subsection{Evaluation of $\\mathbf I_k$}\n\\label{sec:eval-ik}\n\nThe integral $I_0$ has been computed in~\\cite{Fabbri2008} (eq.~(17) for $W_f(\\mathbf r)$ in~\\cite{Fabbri2008})\n\n", "itemtype": "equation", "pos": 17028, "prevtext": "\nWith this method the auxiliary vectors $\\mathbf m$ and $\\mathbf m'$ would have to be included in all intermediate derivations;  \nthis would remove the need to keep track of tensor indices at the cost of slightly expanded notation.\n\n\n\n\\begin{table*}[htb]\n\\centering\n\\begin{tabular}{|c|c|}\n\\hline\nGauss's theorem &\n\\marginbox{2pt}{$ \\displaystyle\n\\int_V \\nabla_{\\mathbf r} \\, \\mathbf F \\, dr = \\int_{\\partial V} {\\mathbf n} \\otimes \\mathbf F \\, dr\n$}\n\\\\\n\\hline\ngradient of a product &\n\\marginbox{2pt}{$ \\displaystyle\na \\, \\nabla_\\mathbf r \\mathbf F =\n\\nabla_\\mathbf r [a \\, \\mathbf F]\n- \\nabla a \\otimes \\mathbf F\n$}\n\\\\\n\\hline\nintegration of $\\frac{({\\mathbf r}-{\\mathbf r}')^{\\otimes k}}{|{\\mathbf r}-{\\mathbf r}'|}$ &\n\\marginbox{2pt}{$ \\displaystyle\n\\frac{({\\mathbf r}-{\\mathbf r}')^{\\otimes k}}{|{\\mathbf r}-{\\mathbf r}'|} =\n\\frac{1}{k+2} \\nabla_{\\mathbf r} \\cdot \\frac{({\\mathbf r}-{\\mathbf r}')^{\\otimes \\, k+1}}{|{\\mathbf r}-{\\mathbf r}'|}\n$}\n\\\\\n\\hline\n\\end{tabular}\n\\caption{Identities used in the conversion of the double volume integral~\\eqref{eq-tettet} to a double surface integral. Here $\\mathbf F({\\mathbf r})$ is a tensor of any rank and $a({\\mathbf r})$ is a scalar. When the gradient operator $\\nabla$ is applied to a vector or tensor, we assume that the new tensor index is added at the front (i.e. $\\nabla f_{jk} = \\partial_i f_{jk}$). Similarly, divergence applies to the first index of a tensor (i.e. $\\nabla f_{jk} = \\partial_j f_{jk}$).} \n\\label{tab-vol-surf-conversion}\n\\end{table*}\n\n\\section{Analytical result --- integrand and the primitive terms~$\\mathbf I_k$}\n\\label{sec:analyticalresult}  \n\\label{sec:surf2terms}      \n\nThe next step is to express the inner integral over~${\\mathbf r}$ in~\\eqref{eq-surfsurf} in terms of the primitive integrals~$\\mathbf I_k$~\\eqref{eq-i0}--\\eqref{eq-i2}. By using the identity $A({\\mathbf r}) = A({\\mathbf r}') - ({\\mathbf r} - {\\mathbf r}')\\cdot \\nabla A$, we get\n\n\n", "index": 17, "text": "\\begin{equation}\n\\begin{split}\n\\mathbf N = \\int_{\\partial \\tau'} \\Big[\n\\frac12 A(\\mathbf r') (\\mathbf n' \\cdot \\mathbf I_1) (\\mathbf n \\otimes \\nabla B)\n+ B(\\mathbf r') (\\nabla A \\cdot \\mathbf I_1)(\\mathbf n \\otimes \\mathbf n')\n- \\frac12 B(\\mathbf r') (\\mathbf n \\cdot \\mathbf I_1) (\\nabla A \\otimes \\mathbf n') \\\\\n+ A(\\mathbf r') B(\\mathbf r') I_0 \\, \\mathbf n \\otimes \\mathbf n'\n- \\frac16 I_2(\\mathbf n, \\mathbf n') (\\nabla A \\otimes \\nabla B)\n+ \\frac12 I_2(\\nabla A, \\mathbf n') (\\mathbf n \\otimes \\nabla B)\n\\Big] ds'\n\\end{split}\n\\label{eq-surface-i}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E17.m1\" class=\"ltx_Math\" alttext=\"\\begin{split}\\displaystyle\\mathbf{N}=\\int_{\\partial\\tau^{\\prime}}\\Big{[}\\frac{%&#10;1}{2}A(\\mathbf{r}^{\\prime})(\\mathbf{n}^{\\prime}\\cdot\\mathbf{I}_{1})(\\mathbf{n}%&#10;\\otimes\\nabla B)+B(\\mathbf{r}^{\\prime})(\\nabla A\\cdot\\mathbf{I}_{1})(\\mathbf{n%&#10;}\\otimes\\mathbf{n}^{\\prime})-\\frac{1}{2}B(\\mathbf{r}^{\\prime})(\\mathbf{n}\\cdot%&#10;\\mathbf{I}_{1})(\\nabla A\\otimes\\mathbf{n}^{\\prime})\\\\&#10;\\displaystyle+A(\\mathbf{r}^{\\prime})B(\\mathbf{r}^{\\prime})I_{0}\\,\\mathbf{n}%&#10;\\otimes\\mathbf{n}^{\\prime}-\\frac{1}{6}I_{2}(\\mathbf{n},\\mathbf{n}^{\\prime})(%&#10;\\nabla A\\otimes\\nabla B)+\\frac{1}{2}I_{2}(\\nabla A,\\mathbf{n}^{\\prime})(%&#10;\\mathbf{n}\\otimes\\nabla B)\\Big{]}ds^{\\prime}\\end{split}\" display=\"block\"><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"right\"><mrow><mi>\ud835\udc0d</mi><mo>=</mo><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><msup><mi>\u03c4</mi><mo>\u2032</mo></msup></mrow></msub><mrow><mo maxsize=\"160%\" minsize=\"160%\">[</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>A</mi><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc27</mi><mo>\u2032</mo></msup><mo>\u22c5</mo><msub><mi>\ud835\udc08</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc27</mi><mo>\u2297</mo><mo>\u2207</mo><mi>B</mi><mo stretchy=\"false\">)</mo></mrow><mo>+</mo><mi>B</mi><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mrow><mo stretchy=\"false\">(</mo><mo>\u2207</mo><mi>A</mi><mo>\u22c5</mo><msub><mi>\ud835\udc08</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc27</mi><mo>\u2297</mo><msup><mi>\ud835\udc27</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo>-</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>B</mi><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc27</mi><mo>\u22c5</mo><msub><mi>\ud835\udc08</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow><mrow><mo stretchy=\"false\">(</mo><mo>\u2207</mo><mi>A</mi><mo>\u2297</mo><msup><mi>\ud835\udc27</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mrow><mo>+</mo><mi>A</mi><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mi>B</mi><mrow><mo stretchy=\"false\">(</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mpadded width=\"+1.7pt\"><msub><mi>I</mi><mn>0</mn></msub></mpadded><mi>\ud835\udc27</mi><mo>\u2297</mo><msup><mi>\ud835\udc27</mi><mo>\u2032</mo></msup><mo>-</mo><mfrac><mn>1</mn><mn>6</mn></mfrac><msub><mi>I</mi><mn>2</mn></msub><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc27</mi><mo>,</mo><msup><mi>\ud835\udc27</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mrow><mo stretchy=\"false\">(</mo><mo>\u2207</mo><mi>A</mi><mo>\u2297</mo><mo>\u2207</mo><mi>B</mi><mo stretchy=\"false\">)</mo></mrow><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mi>I</mi><mn>2</mn></msub><mrow><mo stretchy=\"false\">(</mo><mo>\u2207</mo><mi>A</mi><mo>,</mo><msup><mi>\ud835\udc27</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc27</mi><mo>\u2297</mo><mo>\u2207</mo><mi>B</mi><mo stretchy=\"false\">)</mo></mrow><mo maxsize=\"160%\" minsize=\"160%\">]</mo><mi>d</mi><mi>s</mi><msup><mi/><mo>\u2032</mo></msup></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": " \nwhere the outer sum is over the facets~$F$ of the polyhedron surface~$\\partial\\tau - \\mathbf r'$, the inner sum is over the line edges $({\\mathbf R}_1, {\\mathbf R}_2)$ of the facet, \n${\\mathbf n}$ is the facet normal, $\\mathbf u = ({\\mathbf R}_2 - {\\mathbf R}_1)$ $/|{\\mathbf R}_2-{\\mathbf R}_1|$ is the unit vector along the edge, ${\\mathbf R}_f$ is any point on the facet, and $\\Omega(F))$ is the solid angle of the facet~$F$ from the origin. \t \n\nThe integral $\\mathbf I_1$ has been computed in~\\cite{Fabbri2009} (eq.~(27) in~\\cite{Fabbri2009})\n\n", "itemtype": "equation", "pos": -1, "prevtext": "\n\nNote that the primitive integral $\\mathbf I_k$ is a tensor of rank~$k$ and is a function of $\\mathbf r'$.\n\n\\subsection{Evaluation of $\\mathbf I_k$}\n\\label{sec:eval-ik}\n\nThe integral $I_0$ has been computed in~\\cite{Fabbri2008} (eq.~(17) for $W_f(\\mathbf r)$ in~\\cite{Fabbri2008})\n\n", "index": 19, "text": "\\begin{equation}\nI_0 = \\sum_{F\\in\\partial\\tau - \\mathbf r'}\\left[ -\\sum_{({\\mathbf R}_1, {\\mathbf R}_2) \\in \\partial F} \n({\\mathbf n} \\times \\mathbf u \\cdot \\mathbf R_1) \\, \\eta_0({\\mathbf R}_1, {\\mathbf R}_2) - \n({\\mathbf n} \\cdot {\\mathbf R}_f) \\, \\Omega(F) \\right] \n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E18.m1\" class=\"ltx_Math\" alttext=\"I_{0}=\\sum_{F\\in\\partial\\tau-\\mathbf{r}^{\\prime}}\\left[-\\sum_{({\\mathbf{R}}_{1%&#10;},{\\mathbf{R}}_{2})\\in\\partial F}({\\mathbf{n}}\\times\\mathbf{u}\\cdot\\mathbf{R}_%&#10;{1})\\,\\eta_{0}({\\mathbf{R}}_{1},{\\mathbf{R}}_{2})-({\\mathbf{n}}\\cdot{\\mathbf{R%&#10;}}_{f})\\,\\Omega(F)\\right]\" display=\"block\"><mrow><msub><mi>I</mi><mn>0</mn></msub><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>F</mi><mo>\u2208</mo><mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>\u03c4</mi></mrow><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow></mrow></munder><mrow><mo>[</mo><mrow><mrow><mo>-</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2208</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>F</mi></mrow></mrow></munder><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mi>\ud835\udc27</mi><mo>\u00d7</mo><mi>\ud835\udc2e</mi></mrow><mo>\u22c5</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>\u03b7</mi><mn>0</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>-</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc27</mi><mo>\u22c5</mo><msub><mi>\ud835\udc11</mi><mi>f</mi></msub></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi mathvariant=\"normal\">\u03a9</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>F</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>]</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "\nNote that in the expression for $\\mathbf I_1$, each term of the sum over the facets references the integral~$I_0(F)$ applied only to that facet, not the whole surface. \n\nThe derivation of the formula for the integral $\\mathbf I_2$ is shown in~\\ref{sec:app_i2}\n\n", "itemtype": "equation", "pos": 18710, "prevtext": " \nwhere the outer sum is over the facets~$F$ of the polyhedron surface~$\\partial\\tau - \\mathbf r'$, the inner sum is over the line edges $({\\mathbf R}_1, {\\mathbf R}_2)$ of the facet, \n${\\mathbf n}$ is the facet normal, $\\mathbf u = ({\\mathbf R}_2 - {\\mathbf R}_1)$ $/|{\\mathbf R}_2-{\\mathbf R}_1|$ is the unit vector along the edge, ${\\mathbf R}_f$ is any point on the facet, and $\\Omega(F))$ is the solid angle of the facet~$F$ from the origin. \t \n\nThe integral $\\mathbf I_1$ has been computed in~\\cite{Fabbri2009} (eq.~(27) in~\\cite{Fabbri2009})\n\n", "index": 21, "text": "\\begin{equation}\n\\mathbf I_1 =\n\\sum_{F\\in\\partial\\tau - \\mathbf r'}\\left[ \n- \\sum_{({\\mathbf R}_1, {\\mathbf R}_2) \\in \\partial F} ({\\mathbf n} \\times \\mathbf u) \\, \\lambda_0({\\mathbf R}_1, {\\mathbf R}_2) + ({\\mathbf n} \\cdot {\\mathbf R}_f) \\, {\\mathbf n}  \\, I_0(F)\n\\right]    \n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E19.m1\" class=\"ltx_Math\" alttext=\"\\mathbf{I}_{1}=\\sum_{F\\in\\partial\\tau-\\mathbf{r}^{\\prime}}\\left[-\\sum_{({%&#10;\\mathbf{R}}_{1},{\\mathbf{R}}_{2})\\in\\partial F}({\\mathbf{n}}\\times\\mathbf{u})%&#10;\\,\\lambda_{0}({\\mathbf{R}}_{1},{\\mathbf{R}}_{2})+({\\mathbf{n}}\\cdot{\\mathbf{R}%&#10;}_{f})\\,{\\mathbf{n}}\\,I_{0}(F)\\right]\" display=\"block\"><mrow><msub><mi>\ud835\udc08</mi><mn>1</mn></msub><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>F</mi><mo>\u2208</mo><mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>\u03c4</mi></mrow><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow></mrow></munder><mrow><mo>[</mo><mrow><mrow><mo>-</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2208</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>F</mi></mrow></mrow></munder><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc27</mi><mo>\u00d7</mo><mi>\ud835\udc2e</mi></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>\u03bb</mi><mn>0</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc27</mi><mo>\u22c5</mo><msub><mi>\ud835\udc11</mi><mi>f</mi></msub></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mpadded width=\"+1.7pt\"><mi>\ud835\udc27</mi></mpadded><mo>\u2062</mo><msub><mi>I</mi><mn>0</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>F</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>]</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "\nAgain, each term of the sum over the facets references the integrals $J_0(F)$ and $\\mathbf I_1(F)$ applied only to that facet. \n\nThe auxiliary function $\\eta_0$ (used in the equations for $I_0$ and $\\lambda_1$) has been computed in~\\cite{Fabbri2008} (eq.~(18) for $w_e(\\mathbf r)$)\n\n", "itemtype": "equation", "pos": 19263, "prevtext": "\nNote that in the expression for $\\mathbf I_1$, each term of the sum over the facets references the integral~$I_0(F)$ applied only to that facet, not the whole surface. \n\nThe derivation of the formula for the integral $\\mathbf I_2$ is shown in~\\ref{sec:app_i2}\n\n", "index": 23, "text": "\\begin{equation}\n\\mathbf I_2 = \n\\sum_{F\\in\\partial\\tau - \\mathbf r'}\\left[ \n\t- \\sum_{({\\mathbf R}_1, {\\mathbf R}_2) \\in \\partial F} ({\\mathbf n} \\times \\mathbf u) \\otimes \\lambda_1({\\mathbf R}_1, {\\mathbf R}_2)  \n\t+ ({\\mathbf n}^2 - \\mathbf{Id}) \\, J_0(F)\n\t+ ({\\mathbf n} \\cdot {\\mathbf R}_f) \\, {\\mathbf n} \\otimes \\mathbf I_1(F)\n\\right]    \n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E20.m1\" class=\"ltx_Math\" alttext=\"\\mathbf{I}_{2}=\\sum_{F\\in\\partial\\tau-\\mathbf{r}^{\\prime}}\\left[-\\sum_{({%&#10;\\mathbf{R}}_{1},{\\mathbf{R}}_{2})\\in\\partial F}({\\mathbf{n}}\\times\\mathbf{u})%&#10;\\otimes\\lambda_{1}({\\mathbf{R}}_{1},{\\mathbf{R}}_{2})+({\\mathbf{n}}^{2}-%&#10;\\mathbf{Id})\\,J_{0}(F)+({\\mathbf{n}}\\cdot{\\mathbf{R}}_{f})\\,{\\mathbf{n}}%&#10;\\otimes\\mathbf{I}_{1}(F)\\right]\" display=\"block\"><mrow><msub><mi>\ud835\udc08</mi><mn>2</mn></msub><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>F</mi><mo>\u2208</mo><mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>\u03c4</mi></mrow><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow></mrow></munder><mrow><mo>[</mo><mrow><mrow><mo>-</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2208</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>F</mi></mrow></mrow></munder><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc27</mi><mo>\u00d7</mo><mi>\ud835\udc2e</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2297</mo><msub><mi>\u03bb</mi><mn>1</mn></msub></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mi>\ud835\udc27</mi><mn>2</mn></msup><mo>-</mo><mi>\ud835\udc08\ud835\udc1d</mi></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>J</mi><mn>0</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>F</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc27</mi><mo>\u22c5</mo><msub><mi>\ud835\udc11</mi><mi>f</mi></msub></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>\ud835\udc27</mi></mrow><mo>\u2297</mo><msub><mi>\ud835\udc08</mi><mn>1</mn></msub></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>F</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>]</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": " \n\nThe auxiliary function $\\lambda_0$ (used in the equations for $\\mathbf I_1$ and $J_0$) has been computed in~\\cite{Fabbri2009} (eq.~(22) for $\\lambda_e(\\mathbf r)$)\n\n", "itemtype": "equation", "pos": -1, "prevtext": "\nAgain, each term of the sum over the facets references the integrals $J_0(F)$ and $\\mathbf I_1(F)$ applied only to that facet. \n\nThe auxiliary function $\\eta_0$ (used in the equations for $I_0$ and $\\lambda_1$) has been computed in~\\cite{Fabbri2008} (eq.~(18) for $w_e(\\mathbf r)$)\n\n", "index": 25, "text": "\\begin{equation}\n\\eta_0({\\mathbf R}_1, {\\mathbf R}_2) = \\ln \\frac{|{\\mathbf R}_1| + |{\\mathbf R}_2| + |{\\mathbf R}_2 - {\\mathbf R}_1|}{|{\\mathbf R}_2| + |{\\mathbf R}_1| - |{\\mathbf R}_2 - {\\mathbf R}_1|}\n`\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E21.m1\" class=\"ltx_Math\" alttext=\"\\eta_{0}({\\mathbf{R}}_{1},{\\mathbf{R}}_{2})=\\ln\\frac{|{\\mathbf{R}}_{1}|+|{%&#10;\\mathbf{R}}_{2}|+|{\\mathbf{R}}_{2}-{\\mathbf{R}}_{1}|}{|{\\mathbf{R}}_{2}|+|{%&#10;\\mathbf{R}}_{1}|-|{\\mathbf{R}}_{2}-{\\mathbf{R}}_{1}|}`\" display=\"block\"><mrow><mrow><msub><mi>\u03b7</mi><mn>0</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mi>ln</mi><mo>\u2061</mo><mrow><mfrac><mrow><mrow><mo stretchy=\"false\">|</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo stretchy=\"false\">|</mo></mrow><mo>+</mo><mrow><mo stretchy=\"false\">|</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">|</mo></mrow><mo>+</mo><mrow><mo stretchy=\"false\">|</mo><mrow><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo>-</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub></mrow><mo stretchy=\"false\">|</mo></mrow></mrow><mrow><mrow><mrow><mo stretchy=\"false\">|</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">|</mo></mrow><mo>+</mo><mrow><mo stretchy=\"false\">|</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo stretchy=\"false\">|</mo></mrow></mrow><mo>-</mo><mrow><mo stretchy=\"false\">|</mo><mrow><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo>-</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub></mrow><mo stretchy=\"false\">|</mo></mrow></mrow></mfrac><mo>\u2062</mo><mi mathvariant=\"normal\">`</mi></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": " \n\nThe auxiliary function $J_0$ (used in the equation for $\\mathbf I_2$) has been computed in~\\cite{Fabbri2008} (eq.~(22) for $\\Lambda_f(\\mathbf r)$)\n\n", "itemtype": "equation", "pos": -1, "prevtext": " \n\nThe auxiliary function $\\lambda_0$ (used in the equations for $\\mathbf I_1$ and $J_0$) has been computed in~\\cite{Fabbri2009} (eq.~(22) for $\\lambda_e(\\mathbf r)$)\n\n", "index": 27, "text": "\\begin{equation}\n\\lambda_0({\\mathbf R}_1, {\\mathbf R}_2) = \n\\frac12 \\mathbf u ({\\mathbf R}_2|{\\mathbf R}_2| -  {\\mathbf R}_1|{\\mathbf R}_1|) + \n\\frac12 |{\\mathbf R}_1 \\times \\mathbf u|^2 \\, \\eta_0(\\mathbf R_1, \\mathbf R_2)\n \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E22.m1\" class=\"ltx_Math\" alttext=\"\\lambda_{0}({\\mathbf{R}}_{1},{\\mathbf{R}}_{2})=\\frac{1}{2}\\mathbf{u}({\\mathbf{%&#10;R}}_{2}|{\\mathbf{R}}_{2}|-{\\mathbf{R}}_{1}|{\\mathbf{R}}_{1}|)+\\frac{1}{2}|{%&#10;\\mathbf{R}}_{1}\\times\\mathbf{u}|^{2}\\,\\eta_{0}(\\mathbf{R}_{1},\\mathbf{R}_{2})\" display=\"block\"><mrow><mrow><msub><mi>\u03bb</mi><mn>0</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>\u2062</mo><mi>\ud835\udc2e</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">|</mo></mrow></mrow><mo>-</mo><mrow><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo stretchy=\"false\">|</mo></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>\u2062</mo><mpadded width=\"+1.7pt\"><msup><mrow><mo stretchy=\"false\">|</mo><mrow><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>\u00d7</mo><mi>\ud835\udc2e</mi></mrow><mo stretchy=\"false\">|</mo></mrow><mn>2</mn></msup></mpadded><mo>\u2062</mo><msub><mi>\u03b7</mi><mn>0</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "\n\nThe derivation of the formula for $\\boldsymbol\\eta_1$ (used in the equation for $\\boldsymbol\\lambda_1$) is shown in~\\ref{sec:app_eta1} \n\n", "itemtype": "equation", "pos": 20677, "prevtext": " \n\nThe auxiliary function $J_0$ (used in the equation for $\\mathbf I_2$) has been computed in~\\cite{Fabbri2008} (eq.~(22) for $\\Lambda_f(\\mathbf r)$)\n\n", "index": 29, "text": "\\begin{equation}\nJ_0 = \\sum_{F\\in\\partial\\tau - \\mathbf r'}\\left[ \n\\frac13 \\sum_{({\\mathbf R}_1, {\\mathbf R}_2) \\in \\partial F} \n\\mathbf n \\times R_1 \\cdot \\mathbf u \\, \\lambda_0({\\mathbf R}_1, {\\mathbf R}_2)\n+ \\frac13 ({\\mathbf R}_f \\cdot {\\mathbf n})^2 I_0  \n\\right]  \n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E23.m1\" class=\"ltx_Math\" alttext=\"J_{0}=\\sum_{F\\in\\partial\\tau-\\mathbf{r}^{\\prime}}\\left[\\frac{1}{3}\\sum_{({%&#10;\\mathbf{R}}_{1},{\\mathbf{R}}_{2})\\in\\partial F}\\mathbf{n}\\times R_{1}\\cdot%&#10;\\mathbf{u}\\,\\lambda_{0}({\\mathbf{R}}_{1},{\\mathbf{R}}_{2})+\\frac{1}{3}({%&#10;\\mathbf{R}}_{f}\\cdot{\\mathbf{n}})^{2}I_{0}\\right]\" display=\"block\"><mrow><msub><mi>J</mi><mn>0</mn></msub><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>F</mi><mo>\u2208</mo><mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>\u03c4</mi></mrow><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow></mrow></munder><mrow><mo>[</mo><mrow><mrow><mfrac><mn>1</mn><mn>3</mn></mfrac><mo>\u2062</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2208</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>F</mi></mrow></mrow></munder><mrow><mrow><mrow><mi>\ud835\udc27</mi><mo>\u00d7</mo><msub><mi>R</mi><mn>1</mn></msub></mrow><mo>\u22c5</mo><mpadded width=\"+1.7pt\"><mi>\ud835\udc2e</mi></mpadded></mrow><mo>\u2062</mo><msub><mi>\u03bb</mi><mn>0</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>+</mo><mrow><mfrac><mn>1</mn><mn>3</mn></mfrac><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc11</mi><mi>f</mi></msub><mo>\u22c5</mo><mi>\ud835\udc27</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup><mo>\u2062</mo><msub><mi>I</mi><mn>0</mn></msub></mrow></mrow><mo>]</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "\n\nThe derivation of the formula for $\\boldsymbol\\lambda_1$ (used in the equation for $\\mathbf I_2$) is shown in~\\ref{sec:app_lambda1} \n\n", "itemtype": "equation", "pos": 21100, "prevtext": "\n\nThe derivation of the formula for $\\boldsymbol\\eta_1$ (used in the equation for $\\boldsymbol\\lambda_1$) is shown in~\\ref{sec:app_eta1} \n\n", "index": 31, "text": "\\begin{equation}\n\\boldsymbol\\eta_1({\\mathbf R}_1, {\\mathbf R}_2) = \n \t\\mathbf u(|{\\mathbf R}_2|  - |{\\mathbf R}_1|)\n \t- \\mathbf u \\times (\\mathbf u \\times {\\mathbf R}_1) \\, \\eta_0({\\mathbf R}_1, {\\mathbf R}_2) \n \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E24.m1\" class=\"ltx_Math\" alttext=\"\\bm{\\eta}_{1}({\\mathbf{R}}_{1},{\\mathbf{R}}_{2})=\\mathbf{u}(|{\\mathbf{R}}_{2}|%&#10;-|{\\mathbf{R}}_{1}|)-\\mathbf{u}\\times(\\mathbf{u}\\times{\\mathbf{R}}_{1})\\,\\eta_%&#10;{0}({\\mathbf{R}}_{1},{\\mathbf{R}}_{2})\" display=\"block\"><mrow><mrow><msub><mi>\ud835\udf3c</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>\ud835\udc2e</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mo stretchy=\"false\">|</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">|</mo></mrow><mo>-</mo><mrow><mo stretchy=\"false\">|</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo stretchy=\"false\">|</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mrow><mi>\ud835\udc2e</mi><mo>\u00d7</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc2e</mi><mo>\u00d7</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow></mrow><mo>\u2062</mo><msub><mi>\u03b7</mi><mn>0</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "\nwith the notation $f({\\mathbf R})\\big|_{{\\mathbf R}_1}^{{\\mathbf R}_2} \\equiv f({\\mathbf R}_2) - f({\\mathbf R}_1) $.\n\n\\section{Numerical results}\n\nIn order to numerically verify the analytical results in Section~\\ref{sec:analyticalresult} we need a way to compute the energy integral~\\eqref{eq-pairwise} exactly or with sufficient precision. For a cuboid, we could do this if the magnetization was constant by using the analytical expression for the demagnetizing tensor~\\cite{Schabes1987,Newell1993,maicus1998magnetostatic,fukushima1998volume}. However, for a constant magnetization the gradient terms $\\nabla A$ and $\\nabla B$ in our analytical expressions would be zero, and for a more comprehensive test we have to cover the case of (nontrivial) linear magnetization. The authors are not aware of an analytical result that could be used as a reference in this case, instead, as a reference we used a series of finite difference micromagnetic simulations with progressively increasing mesh size until convergence was reached.\n\n\\subsection{Test problem formulation}\n\nThe test system is a magnetized cuboid with dimensions $1.7 l \\times 1.3 l \\, \\times l$, where $l$ is a arbitrary length parameter. A linear magnetization function $\\mathbf M(\\mathbf r)$ of the cuboid can be written in the general form  \n\n", "itemtype": "equation", "pos": 21461, "prevtext": "\n\nThe derivation of the formula for $\\boldsymbol\\lambda_1$ (used in the equation for $\\mathbf I_2$) is shown in~\\ref{sec:app_lambda1} \n\n", "index": 33, "text": "\\begin{equation}\n\\boldsymbol\\lambda_1({\\mathbf R}_1, {\\mathbf R}_2) =\n\\Big(\\frac12\\mathbf{Id} + \\frac16 \\mathbf u \\, (\\mathbf u \\cdot{})\\Big)\n \\Big[\n\t|{\\mathbf R}| (\\mathbf u \\cdot {\\mathbf R}) ({\\mathbf R}  - \\frac12 \\mathbf u \\, (\\mathbf u \\cdot {\\mathbf R}))  \\, \\Big|_{{\\mathbf R}_1}^{{\\mathbf R}_2}\n\t+|\\mathbf u \\times {\\mathbf R}_1|^2  (\\mathbf{Id}  - \\frac12 \\mathbf u \\, (\\mathbf u \\cdot{})) \\, \\boldsymbol\\eta_1({\\mathbf R}_1, {\\mathbf R}_2)\n \\Big]\n\\label{eq-last}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E25.m1\" class=\"ltx_Math\" alttext=\"\\bm{\\lambda}_{1}({\\mathbf{R}}_{1},{\\mathbf{R}}_{2})=\\Big{(}\\frac{1}{2}\\mathbf{%&#10;Id}+\\frac{1}{6}\\mathbf{u}\\,(\\mathbf{u}\\cdot{})\\Big{)}\\Big{[}|{\\mathbf{R}}|(%&#10;\\mathbf{u}\\cdot{\\mathbf{R}})({\\mathbf{R}}-\\frac{1}{2}\\mathbf{u}\\,(\\mathbf{u}%&#10;\\cdot{\\mathbf{R}}))\\,\\Big{|}_{{\\mathbf{R}}_{1}}^{{\\mathbf{R}}_{2}}+|\\mathbf{u}%&#10;\\times{\\mathbf{R}}_{1}|^{2}(\\mathbf{Id}-\\frac{1}{2}\\mathbf{u}\\,(\\mathbf{u}%&#10;\\cdot{}))\\,\\bm{\\eta}_{1}({\\mathbf{R}}_{1},{\\mathbf{R}}_{2})\\Big{]}\" display=\"block\"><mrow><msub><mi>\ud835\udf40</mi><mn>1</mn></msub><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow><mo>=</mo><mrow><mo maxsize=\"160%\" minsize=\"160%\">(</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>\ud835\udc08\ud835\udc1d</mi><mo>+</mo><mfrac><mn>1</mn><mn>6</mn></mfrac><mpadded width=\"+1.7pt\"><mi>\ud835\udc2e</mi></mpadded><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mo stretchy=\"false\">)</mo></mrow><mo maxsize=\"160%\" minsize=\"160%\">)</mo></mrow><mrow><mo maxsize=\"160%\" minsize=\"160%\">[</mo><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc11</mi><mo>-</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mpadded width=\"+1.7pt\"><mi>\ud835\udc2e</mi></mpadded><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">)</mo></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><msubsup><mo maxsize=\"160%\" minsize=\"160%\">|</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><msub><mi>\ud835\udc11</mi><mn>2</mn></msub></msubsup><mo>+</mo><mo stretchy=\"false\">|</mo><mi>\ud835\udc2e</mi><mo>\u00d7</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><msup><mo stretchy=\"false\">|</mo><mn>2</mn></msup><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc08\ud835\udc1d</mi><mo>-</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mpadded width=\"+1.7pt\"><mi>\ud835\udc2e</mi></mpadded><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mo stretchy=\"false\">)</mo></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><msub><mi>\ud835\udf3c</mi><mn>1</mn></msub><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow><mo maxsize=\"160%\" minsize=\"160%\">]</mo></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "\nwhere $\\mathbf L$ is a $3\\times4$ matrix. In this equation we have used the length parameter $l$ to make the units of $\\mathbf L$ uniform. \n\nThe 12 entries of the matrix $\\mathbf L$ can also be written as a column vector $\\mathbf L_\\mathrm{vec}$; we assume $\\mathbf L_\\mathrm{vec}$ is formed by stacking the columns of $\\mathbf L$ (i.e, the first 3 entries of $\\mathbf L_\\mathrm{vec}$ come from the first column of $\\mathbf L$, and so on). \n\nThe demagnetizing energy $E = E(\\mathbf L)$ of the cuboid is a quadratic function of $\\mathbf L$ which we write in the form\n\n", "itemtype": "equation", "pos": 23257, "prevtext": "\nwith the notation $f({\\mathbf R})\\big|_{{\\mathbf R}_1}^{{\\mathbf R}_2} \\equiv f({\\mathbf R}_2) - f({\\mathbf R}_1) $.\n\n\\section{Numerical results}\n\nIn order to numerically verify the analytical results in Section~\\ref{sec:analyticalresult} we need a way to compute the energy integral~\\eqref{eq-pairwise} exactly or with sufficient precision. For a cuboid, we could do this if the magnetization was constant by using the analytical expression for the demagnetizing tensor~\\cite{Schabes1987,Newell1993,maicus1998magnetostatic,fukushima1998volume}. However, for a constant magnetization the gradient terms $\\nabla A$ and $\\nabla B$ in our analytical expressions would be zero, and for a more comprehensive test we have to cover the case of (nontrivial) linear magnetization. The authors are not aware of an analytical result that could be used as a reference in this case, instead, as a reference we used a series of finite difference micromagnetic simulations with progressively increasing mesh size until convergence was reached.\n\n\\subsection{Test problem formulation}\n\nThe test system is a magnetized cuboid with dimensions $1.7 l \\times 1.3 l \\, \\times l$, where $l$ is a arbitrary length parameter. A linear magnetization function $\\mathbf M(\\mathbf r)$ of the cuboid can be written in the general form  \n\n", "index": 35, "text": "$$\\mathbf M(\\mathbf r) = \\mathbf L \\cdot\n\\begin{pmatrix}\nl\\\\r_x\\\\r_y\\\\r_z\n\\end{pmatrix}\n$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"\\mathbf{M}(\\mathbf{r})=\\mathbf{L}\\cdot\\begin{pmatrix}l\\\\&#10;r_{x}\\\\&#10;r_{y}\\\\&#10;r_{z}\\end{pmatrix}\" display=\"block\"><mrow><mrow><mi>\ud835\udc0c</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mi>\ud835\udc0b</mi><mo>\u22c5</mo><mrow><mo>(</mo><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mi>l</mi></mtd></mtr><mtr><mtd columnalign=\"center\"><msub><mi>r</mi><mi>x</mi></msub></mtd></mtr><mtr><mtd columnalign=\"center\"><msub><mi>r</mi><mi>y</mi></msub></mtd></mtr><mtr><mtd columnalign=\"center\"><msub><mi>r</mi><mi>z</mi></msub></mtd></mtr></mtable><mo>)</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "   \n\nHere, $\\mathcal{E}$ is a symmetric $12 \\times 12$ matrix; the factor $l^5$ is introduced to make $\\mathcal{E}$ dimensionless. The entries in $\\mathcal{E}$ do not depend on $l$ but only on the aspect ratio of the cuboid ($1.7 \\times 1.3 \\times 1$ in our case).  \n\nTo verify our analytical formula, we compute the entries of the matrix $\\mathcal E$ in two ways:\n\n\\begin{itemize}\n  \\item Via finite difference micromagnetic simulations with a progressively finer mesh until convergence, producing the reference matrix $\\mathcal E_\\mathrm{ref}$.\n  \\item By subdividing the cuboid into tetrahedrons and calculating pairwise interactions between the tetrahedrons using our new analytical formula~\\eqref{eq-surface-i}--\\eqref{eq-last}, producing the test matrix $\\mathcal E_\\mathrm{test}$.  \n\\end{itemize}\n\nTo estimate the error of computing $\\mathcal E_\\mathrm{test}$, we compute the relative error\n\n", "itemtype": "equation", "pos": -1, "prevtext": "\nwhere $\\mathbf L$ is a $3\\times4$ matrix. In this equation we have used the length parameter $l$ to make the units of $\\mathbf L$ uniform. \n\nThe 12 entries of the matrix $\\mathbf L$ can also be written as a column vector $\\mathbf L_\\mathrm{vec}$; we assume $\\mathbf L_\\mathrm{vec}$ is formed by stacking the columns of $\\mathbf L$ (i.e, the first 3 entries of $\\mathbf L_\\mathrm{vec}$ come from the first column of $\\mathbf L$, and so on). \n\nThe demagnetizing energy $E = E(\\mathbf L)$ of the cuboid is a quadratic function of $\\mathbf L$ which we write in the form\n\n", "index": 37, "text": "$$\nE(L) = -\\frac12 \\mu_0 l^5 \\, \\mathbf L_\\mathrm{vec} \\cdot \\mathcal{E} \\cdot \\mathbf L_\\mathrm{vec}\n$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"E(L)=-\\frac{1}{2}\\mu_{0}l^{5}\\,\\mathbf{L}_{\\mathrm{vec}}\\cdot\\mathcal{E}\\cdot%&#10;\\mathbf{L}_{\\mathrm{vec}}\" display=\"block\"><mrow><mrow><mi>E</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>L</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo>-</mo><mrow><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>\u2062</mo><msub><mi>\u03bc</mi><mn>0</mn></msub><mo>\u2062</mo><mpadded width=\"+1.7pt\"><msup><mi>l</mi><mn>5</mn></msup></mpadded><mo>\u2062</mo><msub><mi>\ud835\udc0b</mi><mi>vec</mi></msub></mrow><mo>\u22c5</mo><mi class=\"ltx_font_mathcaligraphic\">\u2130</mi><mo>\u22c5</mo><msub><mi>\ud835\udc0b</mi><mi>vec</mi></msub></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "\nusing the sum-of-squares matrix norm\n\n", "itemtype": "equation", "pos": 24916, "prevtext": "   \n\nHere, $\\mathcal{E}$ is a symmetric $12 \\times 12$ matrix; the factor $l^5$ is introduced to make $\\mathcal{E}$ dimensionless. The entries in $\\mathcal{E}$ do not depend on $l$ but only on the aspect ratio of the cuboid ($1.7 \\times 1.3 \\times 1$ in our case).  \n\nTo verify our analytical formula, we compute the entries of the matrix $\\mathcal E$ in two ways:\n\n\\begin{itemize}\n  \\item Via finite difference micromagnetic simulations with a progressively finer mesh until convergence, producing the reference matrix $\\mathcal E_\\mathrm{ref}$.\n  \\item By subdividing the cuboid into tetrahedrons and calculating pairwise interactions between the tetrahedrons using our new analytical formula~\\eqref{eq-surface-i}--\\eqref{eq-last}, producing the test matrix $\\mathcal E_\\mathrm{test}$.  \n\\end{itemize}\n\nTo estimate the error of computing $\\mathcal E_\\mathrm{test}$, we compute the relative error\n\n", "index": 39, "text": "$$\n\\eta = \\frac{||\\mathcal E_\\mathrm{test}-\\mathcal E_\\mathrm{ref}||}{||\\mathcal E_\\mathrm{ref}||}\n$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"\\eta=\\frac{||\\mathcal{E}_{\\mathrm{test}}-\\mathcal{E}_{\\mathrm{ref}}||}{||%&#10;\\mathcal{E}_{\\mathrm{ref}}||}\" display=\"block\"><mrow><mi>\u03b7</mi><mo>=</mo><mfrac><mrow><mo fence=\"true\">||</mo><mrow><msub><mi class=\"ltx_font_mathcaligraphic\">\u2130</mi><mi>test</mi></msub><mo>-</mo><msub><mi class=\"ltx_font_mathcaligraphic\">\u2130</mi><mi>ref</mi></msub></mrow><mo fence=\"true\">||</mo></mrow><mrow><mo fence=\"true\">||</mo><msub><mi class=\"ltx_font_mathcaligraphic\">\u2130</mi><mi>ref</mi></msub><mo fence=\"true\">||</mo></mrow></mfrac></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "\n\n\\subsection{Test results}\n\nThe reference matrix $\\mathcal E_\\mathrm{ref}$ was computed by performing finite diference simulations with mesh sizes $8\\times 8 \\times 8$, $16\\times 16 \\times 16$, $\\ldots$, up to $128\\times 128 \\times 128$, and computing the Richardson's extrapolation estimate using the last two steps. The estimated relative error of computing  $\\mathcal E_\\mathrm{ref}$ (compared to the unknown exact value) was $10^{-9}$. We include the computed reference matrix $\\mathcal E_\\mathrm{ref}$ in the supplementary information for this paper~\\cite{githubrepo}.\n\n\nFor the computation of the test matrix $\\mathcal E_\\mathrm{test}$ via the analytical formula~\\eqref{eq-surface-i}--\\eqref{eq-last}, we tested several numerical integration rules for the triangle: two fixed-order rules from \\cite{ecf} with orders 3 and 10 (4 and 25 points respectively), two families of symmetric rules~\\cite{Wandzurat2003,Xiao2010} with varying number of points, and also as a baseline the repeated 1d Gauss rule (i.e. by applying the 1d Gauss rule to each of the 2 dimensions of the triangle).\n\nThe results are shown in Table~\\ref{results-table}, ordered by decreasing relative error $\\eta$. In general, for a given number of points all rules displayed approximately the same order of accuracy, for example for each of the 4 rules with 25 points the relative error $\\eta$ was $\\sim 5 \\cdot 10^{-5}$, with the symmetric rule~\\cite{Wandzurat2003} showing slightly better accuracy (especially for the 175 point rule with error $4.0 \\cdot 10^{-6}$ vs $1.1 \\cdot 10^{-5}$ for the symmetric rule~\\cite{Xiao2010}). The most accurate rule considered was the repeated 1d Gauss rule with 6400 points; the number of points is clearly too high to use it in practice, but it does show excellent agreement with the reference result~$\\mathcal E_\\mathrm{ref}$ obtained from finite difference simulations.     \n\n\\begin{table}[htb]\n\\begin{tabular}{lccl}\nMethod & No. of points $n$ & Rel. error $\\eta$ & Ref \\\\\n\\hline\nFixed order k=3 &     4  &  $3.3 \\cdot 10^{-2}$ & \\cite{ecf} \\\\\nSymmetric family 2, k=5 &     7  &  $4.9 \\cdot 10^{-3}$ & \\cite{Xiao2010} \\\\\nSymmetric family 1, k=5 &     7  &  $4.9 \\cdot 10^{-3}$ & \\cite{Wandzurat2003} \\\\\nFixed order k=10 &    25  &  $5.8 \\cdot 10^{-4}$ & \\cite{ecf} \\\\\n  1d Gauss, m=5 &    25  &  $5.5 \\cdot 10^{-4}$ &  \\\\\nSymmetric family 2, k=10 &    25  &  $5.1 \\cdot 10^{-4}$ & \\cite{Xiao2010} \\\\\nSymmetric family 1, k=10 &    25  &  $4.7 \\cdot 10^{-4}$ & \\cite{Wandzurat2003} \\\\\nSymmetric family 2, k=20 &    79  &  $4.2 \\cdot 10^{-5}$ & \\cite{Xiao2010} \\\\\n 1d Gauss, m=10 &   100  &  $4.1 \\cdot 10^{-5}$ &  \\\\\nSymmetric family 1, k=20 &    85  &  $3.4 \\cdot 10^{-5}$ & \\cite{Wandzurat2003} \\\\\nSymmetric family 2, k=30 &   171  &  $1.1 \\cdot 10^{-5}$ & \\cite{Xiao2010} \\\\\nSymmetric family 1, k=30 &   175  &  $4.0 \\cdot 10^{-6}$ & \\cite{Wandzurat2003} \\\\\nSymmetric family 2, k=40 &   295  &  $1.7 \\cdot 10^{-6}$ & \\cite{Xiao2010} \\\\\n 1d Gauss, m=80 &  6400  &  $1.2 \\cdot 10^{-8}$ &  \\\\\n\\hline\n\\end{tabular}\n\\caption{Numerical integration error using the analytical formula~\\eqref{eq-surface-i}--\\eqref{eq-last} with various triangle integration rules. For the rules from \\cite{ecf,Wandzurat2003,Xiao2010}, $k$ is the order of approximation; for the repeated 1d Gauss rule, $m$ is the number of points of the 1d rule. The weights and integration points for all integration rules are included in the supplementary information for this paper~\\cite{githubrepo}. \n\n \\label{results-table}}\n\\end{table}\n\n\\section{Summary}\nWe presented a method to compute the energy of the magnetostatic interaction between linearly magnetized polyhedrons. The magnetostatic energy integral~\\eqref{eq-pairwise} is computed using a hybrid procedure where four out of six integration steps are performed analytically resulting in a nonsingular 2d integral~\\eqref{eq-surface-i} which is then computed numerically.  \n\nThe method can be used in finite element micromagnetics to compute the demagnetizing energy with a high degree of accuracy (for instance, as a reference value in comparison to fast, less accurate traditional methods such as FEM/BEM). Combined with a suitable long range approximation for the magnetostatic integral~\\eqref{eq-pairwise}, it can allow an implementation of energy-based fast multpole method (FMM) or tree-code algorithms for the computation of the demagnetizing field.      \n\nNumerical testing showed excellent agreement between the hybrid computation using the new analytical formula~\\eqref{eq-surface-i}--\\eqref{eq-last} and the reference finite difference simulation.\n\nWe thank Prof.~Ronald Cools for providing access to the Online Encyclopaedia of Cubature Formulas~\\cite{ecf,Cools2003,Cools1999,Cools1993}. We acknowledge financial support from the EPSRC Centre for Doctoral Training grant EP/G03690X/1.\n\n\n\n\n\n\n\n\n\n\n \n \n\n \\appendix\n\n \\section{Derivation of $\\mathbf I_2$}\n \\label{sec:app_i2}\n It is easy to verify that $\\nabla {\\mathbf R} |{\\mathbf R}| = \\mathbf{Id}|{\\mathbf R}| + {\\mathbf R}^{\\otimes 2}/|{\\mathbf R}|$; using eq.~\\eqref{eq:decomp} for the first index of the rank-2 tensor $\\nabla {\\mathbf R} |{\\mathbf R}|$ we get\n \n", "itemtype": "equation", "pos": 25055, "prevtext": "\nusing the sum-of-squares matrix norm\n\n", "index": 41, "text": "$$\n||\\mathcal{E}|| = \\sum_{i,j} \\varepsilon_{ij}^2 \n$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m1\" class=\"ltx_Math\" alttext=\"||\\mathcal{E}||=\\sum_{i,j}\\varepsilon_{ij}^{2}\" display=\"block\"><mrow><mrow><mo fence=\"true\">||</mo><mi class=\"ltx_font_mathcaligraphic\">\u2130</mi><mo fence=\"true\">||</mo></mrow><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></munder><msubsup><mi>\u03b5</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>j</mi></mrow><mn>2</mn></msubsup></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "\nIn the expression ${\\mathbf n} \\times ({\\mathbf n} \\times \\nabla {\\mathbf R} |{\\mathbf R}|)$ the cross product acts on the first index of the tensor $\\nabla {\\mathbf R} |{\\mathbf R}|$.\n\nAfter applying the Stokes' theorem~\\eqref{eq:stokes} and noticing that ${\\mathbf n} \\cdot {\\mathbf R}$ is constant over the facets of a polyhedron, we get the desired formula \n\n", "itemtype": "equation", "pos": 30268, "prevtext": "\n\n\\subsection{Test results}\n\nThe reference matrix $\\mathcal E_\\mathrm{ref}$ was computed by performing finite diference simulations with mesh sizes $8\\times 8 \\times 8$, $16\\times 16 \\times 16$, $\\ldots$, up to $128\\times 128 \\times 128$, and computing the Richardson's extrapolation estimate using the last two steps. The estimated relative error of computing  $\\mathcal E_\\mathrm{ref}$ (compared to the unknown exact value) was $10^{-9}$. We include the computed reference matrix $\\mathcal E_\\mathrm{ref}$ in the supplementary information for this paper~\\cite{githubrepo}.\n\n\nFor the computation of the test matrix $\\mathcal E_\\mathrm{test}$ via the analytical formula~\\eqref{eq-surface-i}--\\eqref{eq-last}, we tested several numerical integration rules for the triangle: two fixed-order rules from \\cite{ecf} with orders 3 and 10 (4 and 25 points respectively), two families of symmetric rules~\\cite{Wandzurat2003,Xiao2010} with varying number of points, and also as a baseline the repeated 1d Gauss rule (i.e. by applying the 1d Gauss rule to each of the 2 dimensions of the triangle).\n\nThe results are shown in Table~\\ref{results-table}, ordered by decreasing relative error $\\eta$. In general, for a given number of points all rules displayed approximately the same order of accuracy, for example for each of the 4 rules with 25 points the relative error $\\eta$ was $\\sim 5 \\cdot 10^{-5}$, with the symmetric rule~\\cite{Wandzurat2003} showing slightly better accuracy (especially for the 175 point rule with error $4.0 \\cdot 10^{-6}$ vs $1.1 \\cdot 10^{-5}$ for the symmetric rule~\\cite{Xiao2010}). The most accurate rule considered was the repeated 1d Gauss rule with 6400 points; the number of points is clearly too high to use it in practice, but it does show excellent agreement with the reference result~$\\mathcal E_\\mathrm{ref}$ obtained from finite difference simulations.     \n\n\\begin{table}[htb]\n\\begin{tabular}{lccl}\nMethod & No. of points $n$ & Rel. error $\\eta$ & Ref \\\\\n\\hline\nFixed order k=3 &     4  &  $3.3 \\cdot 10^{-2}$ & \\cite{ecf} \\\\\nSymmetric family 2, k=5 &     7  &  $4.9 \\cdot 10^{-3}$ & \\cite{Xiao2010} \\\\\nSymmetric family 1, k=5 &     7  &  $4.9 \\cdot 10^{-3}$ & \\cite{Wandzurat2003} \\\\\nFixed order k=10 &    25  &  $5.8 \\cdot 10^{-4}$ & \\cite{ecf} \\\\\n  1d Gauss, m=5 &    25  &  $5.5 \\cdot 10^{-4}$ &  \\\\\nSymmetric family 2, k=10 &    25  &  $5.1 \\cdot 10^{-4}$ & \\cite{Xiao2010} \\\\\nSymmetric family 1, k=10 &    25  &  $4.7 \\cdot 10^{-4}$ & \\cite{Wandzurat2003} \\\\\nSymmetric family 2, k=20 &    79  &  $4.2 \\cdot 10^{-5}$ & \\cite{Xiao2010} \\\\\n 1d Gauss, m=10 &   100  &  $4.1 \\cdot 10^{-5}$ &  \\\\\nSymmetric family 1, k=20 &    85  &  $3.4 \\cdot 10^{-5}$ & \\cite{Wandzurat2003} \\\\\nSymmetric family 2, k=30 &   171  &  $1.1 \\cdot 10^{-5}$ & \\cite{Xiao2010} \\\\\nSymmetric family 1, k=30 &   175  &  $4.0 \\cdot 10^{-6}$ & \\cite{Wandzurat2003} \\\\\nSymmetric family 2, k=40 &   295  &  $1.7 \\cdot 10^{-6}$ & \\cite{Xiao2010} \\\\\n 1d Gauss, m=80 &  6400  &  $1.2 \\cdot 10^{-8}$ &  \\\\\n\\hline\n\\end{tabular}\n\\caption{Numerical integration error using the analytical formula~\\eqref{eq-surface-i}--\\eqref{eq-last} with various triangle integration rules. For the rules from \\cite{ecf,Wandzurat2003,Xiao2010}, $k$ is the order of approximation; for the repeated 1d Gauss rule, $m$ is the number of points of the 1d rule. The weights and integration points for all integration rules are included in the supplementary information for this paper~\\cite{githubrepo}. \n\n \\label{results-table}}\n\\end{table}\n\n\\section{Summary}\nWe presented a method to compute the energy of the magnetostatic interaction between linearly magnetized polyhedrons. The magnetostatic energy integral~\\eqref{eq-pairwise} is computed using a hybrid procedure where four out of six integration steps are performed analytically resulting in a nonsingular 2d integral~\\eqref{eq-surface-i} which is then computed numerically.  \n\nThe method can be used in finite element micromagnetics to compute the demagnetizing energy with a high degree of accuracy (for instance, as a reference value in comparison to fast, less accurate traditional methods such as FEM/BEM). Combined with a suitable long range approximation for the magnetostatic integral~\\eqref{eq-pairwise}, it can allow an implementation of energy-based fast multpole method (FMM) or tree-code algorithms for the computation of the demagnetizing field.      \n\nNumerical testing showed excellent agreement between the hybrid computation using the new analytical formula~\\eqref{eq-surface-i}--\\eqref{eq-last} and the reference finite difference simulation.\n\nWe thank Prof.~Ronald Cools for providing access to the Online Encyclopaedia of Cubature Formulas~\\cite{ecf,Cools2003,Cools1999,Cools1993}. We acknowledge financial support from the EPSRC Centre for Doctoral Training grant EP/G03690X/1.\n\n\n\n\n\n\n\n\n\n\n \n \n\n \\appendix\n\n \\section{Derivation of $\\mathbf I_2$}\n \\label{sec:app_i2}\n It is easy to verify that $\\nabla {\\mathbf R} |{\\mathbf R}| = \\mathbf{Id}|{\\mathbf R}| + {\\mathbf R}^{\\otimes 2}/|{\\mathbf R}|$; using eq.~\\eqref{eq:decomp} for the first index of the rank-2 tensor $\\nabla {\\mathbf R} |{\\mathbf R}|$ we get\n \n", "index": 43, "text": "\\begin{align*}\n \\mathbf I_2(\\partial\\tau; \\mathbf r') \n&= \\int_{\\partial\\tau - \\mathbf r'} \\left[\n\t \\nabla {\\mathbf R} |{\\mathbf R}| - \\mathbf{Id} |{\\mathbf R}|\n\\right] \\,ds \\\\\n&= \\int_{\\partial\\tau - \\mathbf r'} \\left[\n\t\t-{\\mathbf n} \\times ({\\mathbf n} \\times \\nabla {\\mathbf R} |{\\mathbf R}|)\n\t\t+ {\\mathbf n} \\otimes ({\\mathbf n} \\cdot \\nabla {\\mathbf R} |{\\mathbf R}|)\n\t\t- \\mathbf{Id} |{\\mathbf R}|\n\\right] \\,ds \\\\\n&= \\int_{\\partial\\tau - \\mathbf r'} \\left[\n        -{\\mathbf n} \\times ({\\mathbf n} \\times \\nabla {\\mathbf R} |{\\mathbf R}|)\n\t\t+ ({\\mathbf n}^{\\otimes 2} - \\mathbf{Id}) |{\\mathbf R}|\n\t\t+ ({\\mathbf n} \\cdot {\\mathbf R}) \\, {\\mathbf n} \\otimes \\frac{{\\mathbf R}}{|{\\mathbf R}|}\n\\right] \\,ds\n\\end{align*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\mathbf{I}_{2}(\\partial\\tau;\\mathbf{r}^{\\prime})\" display=\"inline\"><mrow><msub><mi>\ud835\udc08</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>\u03c4</mi></mrow><mo>;</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\int_{\\partial\\tau-\\mathbf{r}^{\\prime}}\\left[\\nabla{\\mathbf{R}}|%&#10;{\\mathbf{R}}|-\\mathbf{Id}|{\\mathbf{R}}|\\right]\\,ds\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mstyle displaystyle=\"true\"><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>\u03c4</mi></mrow><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow></msub></mstyle><mrow><mrow><mo>[</mo><mrow><mo>\u2207</mo><mo>\u2061</mo><mrow><mi>\ud835\udc11</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mrow><mi>\ud835\udc11</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mrow><mo>-</mo><mi>\ud835\udc08\ud835\udc1d</mi></mrow><mo stretchy=\"false\">|</mo></mrow><mo>\u2062</mo><mi>\ud835\udc11</mi></mrow><mo stretchy=\"false\">|</mo></mrow></mrow></mrow><mo rspace=\"4.2pt\">]</mo></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>s</mi></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex6.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\int_{\\partial\\tau-\\mathbf{r}^{\\prime}}\\left[-{\\mathbf{n}}\\times%&#10;({\\mathbf{n}}\\times\\nabla{\\mathbf{R}}|{\\mathbf{R}}|)+{\\mathbf{n}}\\otimes({%&#10;\\mathbf{n}}\\cdot\\nabla{\\mathbf{R}}|{\\mathbf{R}}|)-\\mathbf{Id}|{\\mathbf{R}}|%&#10;\\right]\\,ds\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mstyle displaystyle=\"true\"><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>\u03c4</mi></mrow><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow></msub></mstyle><mrow><mrow><mo>[</mo><mrow><mrow><mrow><mo>-</mo><mrow><mi>\ud835\udc27</mi><mo>\u00d7</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc27</mi><mo>\u00d7</mo><mrow><mo>\u2207</mo><mo>\u2061</mo><mrow><mi>\ud835\udc11</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><mrow><mi>\ud835\udc27</mi><mo>\u2297</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc27</mi><mo>\u22c5</mo><mrow><mo>\u2207</mo><mo>\u2061</mo><mrow><mi>\ud835\udc11</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>-</mo><mrow><mi>\ud835\udc08\ud835\udc1d</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mrow></mrow><mo rspace=\"4.2pt\">]</mo></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>s</mi></mrow></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex7.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\int_{\\partial\\tau-\\mathbf{r}^{\\prime}}\\left[-{\\mathbf{n}}\\times%&#10;({\\mathbf{n}}\\times\\nabla{\\mathbf{R}}|{\\mathbf{R}}|)+({\\mathbf{n}}^{\\otimes 2}%&#10;-\\mathbf{Id})|{\\mathbf{R}}|+({\\mathbf{n}}\\cdot{\\mathbf{R}})\\,{\\mathbf{n}}%&#10;\\otimes\\frac{{\\mathbf{R}}}{|{\\mathbf{R}}|}\\right]\\,ds\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mstyle displaystyle=\"true\"><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>\u03c4</mi></mrow><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow></msub></mstyle><mrow><mrow><mo>[</mo><mrow><mrow><mo>-</mo><mrow><mi>\ud835\udc27</mi><mo>\u00d7</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc27</mi><mo>\u00d7</mo><mrow><mo>\u2207</mo><mo>\u2061</mo><mrow><mi>\ud835\udc11</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mi>\ud835\udc27</mi><mrow><mi/><mo>\u2297</mo><mn>2</mn></mrow></msup><mo>-</mo><mi>\ud835\udc08\ud835\udc1d</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mrow><mo>+</mo><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc27</mi><mo>\u22c5</mo><mi>\ud835\udc11</mi></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>\ud835\udc27</mi></mrow><mo>\u2297</mo><mstyle displaystyle=\"true\"><mfrac><mi>\ud835\udc11</mi><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mfrac></mstyle></mrow></mrow><mo rspace=\"4.2pt\">]</mo></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>s</mi></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "\nAgain, each term of the sum over the facets references the integrals $J_0(F)$ and $\\mathbf I_1(F)$ applied only to that facet. \n\nThe auxiliary function $\\eta_0$ (used in the equations for $I_0$ and $\\lambda_1$) has been computed in~\\cite{Fabbri2008} (eq.~(18) for $w_e(\\mathbf r)$)\n\n", "itemtype": "equation", "pos": 19263, "prevtext": "\nNote that in the expression for $\\mathbf I_1$, each term of the sum over the facets references the integral~$I_0(F)$ applied only to that facet, not the whole surface. \n\nThe derivation of the formula for the integral $\\mathbf I_2$ is shown in~\\ref{sec:app_i2}\n\n", "index": 23, "text": "\\begin{equation}\n\\mathbf I_2 = \n\\sum_{F\\in\\partial\\tau - \\mathbf r'}\\left[ \n\t- \\sum_{({\\mathbf R}_1, {\\mathbf R}_2) \\in \\partial F} ({\\mathbf n} \\times \\mathbf u) \\otimes \\lambda_1({\\mathbf R}_1, {\\mathbf R}_2)  \n\t+ ({\\mathbf n}^2 - \\mathbf{Id}) \\, J_0(F)\n\t+ ({\\mathbf n} \\cdot {\\mathbf R}_f) \\, {\\mathbf n} \\otimes \\mathbf I_1(F)\n\\right]    \n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E26.m1\" class=\"ltx_Math\" alttext=\"\\mathbf{I}_{2}=\\sum_{F\\in\\partial\\tau-\\mathbf{r}^{\\prime}}\\left[-\\sum_{({%&#10;\\mathbf{R}}_{1},{\\mathbf{R}}_{2})\\in\\partial F}({\\mathbf{n}}\\times\\mathbf{u})%&#10;\\otimes\\lambda_{1}({\\mathbf{R}}_{1},{\\mathbf{R}}_{2})+({\\mathbf{n}}^{2}-%&#10;\\mathbf{Id})\\,J_{0}(F)+({\\mathbf{n}}\\cdot{\\mathbf{R}}_{f})\\,{\\mathbf{n}}%&#10;\\otimes\\mathbf{I}_{1}(F)\\right]\" display=\"block\"><mrow><msub><mi>\ud835\udc08</mi><mn>2</mn></msub><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>F</mi><mo>\u2208</mo><mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>\u03c4</mi></mrow><mo>-</mo><msup><mi>\ud835\udc2b</mi><mo>\u2032</mo></msup></mrow></mrow></munder><mrow><mo>[</mo><mrow><mrow><mo>-</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2208</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>F</mi></mrow></mrow></munder><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc27</mi><mo>\u00d7</mo><mi>\ud835\udc2e</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2297</mo><msub><mi>\u03bb</mi><mn>1</mn></msub></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mi>\ud835\udc27</mi><mn>2</mn></msup><mo>-</mo><mi>\ud835\udc08\ud835\udc1d</mi></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>J</mi><mn>0</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>F</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc27</mi><mo>\u22c5</mo><msub><mi>\ud835\udc11</mi><mi>f</mi></msub></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>\ud835\udc27</mi></mrow><mo>\u2297</mo><msub><mi>\ud835\udc08</mi><mn>1</mn></msub></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>F</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>]</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "\n Integrating over the line $({\\mathbf R}_1, {\\mathbf R}_2)$ and using the fact that for points on the line $\\mathbf u \\times {\\mathbf R}$ = $\\mathbf u \\times {\\mathbf R}_1$ \n\n", "itemtype": "equation", "pos": 31950, "prevtext": "\n\n \\section{Derivation of $\\boldsymbol\\eta_1$}\n \\label{sec:app_eta1}\n To compute $\\eta_1({\\mathbf R}_1, {\\mathbf R}_2)$, we decompose ${\\mathbf R}/|{\\mathbf R}|$ into components parallel and orthogonal to $\\mathbf u$~(eq.~\\eqref{eq:decomp})\n \n", "index": 47, "text": "\\begin{equation}\n\\frac{{\\mathbf R}}{|{\\mathbf R}|} = \\nabla |{\\mathbf R}| = \\mathbf u (\\mathbf u \\cdot \\nabla) |{\\mathbf R}| - \\mathbf u \\times (\\mathbf u \\times \\frac{{\\mathbf R}}{|{\\mathbf R}|}) \n \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E27.m1\" class=\"ltx_Math\" alttext=\"\\frac{{\\mathbf{R}}}{|{\\mathbf{R}}|}=\\nabla|{\\mathbf{R}}|=\\mathbf{u}(\\mathbf{u}%&#10;\\cdot\\nabla)|{\\mathbf{R}}|-\\mathbf{u}\\times(\\mathbf{u}\\times\\frac{{\\mathbf{R}}%&#10;}{|{\\mathbf{R}}|})\" display=\"block\"><mrow><mfrac><mi>\ud835\udc11</mi><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mfrac><mo>=</mo><mrow><mo>\u2207</mo><mo>\u2061</mo><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>\ud835\udc2e</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mo>\u2207</mo></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mrow><mo>-</mo><mrow><mi>\ud835\udc2e</mi><mo>\u00d7</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc2e</mi><mo>\u00d7</mo><mfrac><mi>\ud835\udc11</mi><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mfrac></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "\n After applying the gradient theorem~(eq.~\\eqref{eq:gradient}) we get the desired equation  \n \n", "itemtype": "equation", "pos": 32338, "prevtext": "\n Integrating over the line $({\\mathbf R}_1, {\\mathbf R}_2)$ and using the fact that for points on the line $\\mathbf u \\times {\\mathbf R}$ = $\\mathbf u \\times {\\mathbf R}_1$ \n\n", "index": 49, "text": "\\begin{equation}\n\\eta_1({\\mathbf R}_1, {\\mathbf R}_2) = \n\\mathbf u \\int_{{\\mathbf R}_1}^{{\\mathbf R}_2} (\\mathbf u \\cdot \\nabla) |{\\mathbf R}| \\, dl \n- \\mathbf u \\times (\\mathbf u \\times {\\mathbf R}_1) \\int_{{\\mathbf R}_1}^{{\\mathbf R}_2} \\frac{1}{|{\\mathbf R}|} \\, dl \n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E28.m1\" class=\"ltx_Math\" alttext=\"\\eta_{1}({\\mathbf{R}}_{1},{\\mathbf{R}}_{2})=\\mathbf{u}\\int_{{\\mathbf{R}}_{1}}^%&#10;{{\\mathbf{R}}_{2}}(\\mathbf{u}\\cdot\\nabla)|{\\mathbf{R}}|\\,dl-\\mathbf{u}\\times(%&#10;\\mathbf{u}\\times{\\mathbf{R}}_{1})\\int_{{\\mathbf{R}}_{1}}^{{\\mathbf{R}}_{2}}%&#10;\\frac{1}{|{\\mathbf{R}}|}\\,dl\" display=\"block\"><mrow><mrow><msub><mi>\u03b7</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>\ud835\udc2e</mi><mo>\u2062</mo><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><msub><mi>\ud835\udc11</mi><mn>2</mn></msub></msubsup><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mo>\u2207</mo></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo rspace=\"4.2pt\" stretchy=\"false\">|</mo></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>l</mi></mrow></mrow></mrow></mrow><mo>-</mo><mrow><mrow><mi>\ud835\udc2e</mi><mo>\u00d7</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc2e</mi><mo>\u00d7</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2062</mo><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><msub><mi>\ud835\udc11</mi><mn>2</mn></msub></msubsup><mrow><mpadded width=\"+1.7pt\"><mfrac><mn>1</mn><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mfrac></mpadded><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>l</mi></mrow></mrow></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "\n\n \\section{Derivation of $\\boldsymbol\\lambda_1$}\n \\label{sec:app_lambda1}\nWe begin by writing the following identities that can be verified by direct differentiation\n\n", "itemtype": "equation", "pos": 32717, "prevtext": "\n After applying the gradient theorem~(eq.~\\eqref{eq:gradient}) we get the desired equation  \n \n", "index": 51, "text": "\\begin{equation}\n \\eta_1({\\mathbf R}_1, {\\mathbf R}_2) = \n \t\\mathbf u|{\\mathbf R}| \\, \\Big|_{{\\mathbf R}_1}^{{\\mathbf R}_2}\n \t- \\mathbf u \\times (\\mathbf u \\times {\\mathbf R}_1) \\, \\eta_0({\\mathbf R}_1, {\\mathbf R}_2) \n \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E29.m1\" class=\"ltx_Math\" alttext=\"\\eta_{1}({\\mathbf{R}}_{1},{\\mathbf{R}}_{2})=\\mathbf{u}|{\\mathbf{R}}|\\,\\Big{|}_%&#10;{{\\mathbf{R}}_{1}}^{{\\mathbf{R}}_{2}}-\\mathbf{u}\\times(\\mathbf{u}\\times{%&#10;\\mathbf{R}}_{1})\\,\\eta_{0}({\\mathbf{R}}_{1},{\\mathbf{R}}_{2})\" display=\"block\"><mrow><mrow><msub><mi>\u03b7</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><msubsup><mrow><mrow><mi>\ud835\udc2e</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo rspace=\"4.2pt\" stretchy=\"false\">|</mo></mrow></mrow><mo fence=\"true\" maxsize=\"160%\" minsize=\"160%\">|</mo></mrow><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><msub><mi>\ud835\udc11</mi><mn>2</mn></msub></msubsup><mo>-</mo><mrow><mrow><mi>\ud835\udc2e</mi><mo>\u00d7</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc2e</mi><mo>\u00d7</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow></mrow><mo>\u2062</mo><msub><mi>\u03b7</mi><mn>0</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "\nMultiplying the second equation by $\\mathbf u/2$ and subtracting from the first to eliminate $(\\mathbf u \\cdot {\\mathbf R}) |{\\mathbf R}|$ on the right-hand side, we get\n\n", "itemtype": "equation", "pos": 33118, "prevtext": "\n\n \\section{Derivation of $\\boldsymbol\\lambda_1$}\n \\label{sec:app_lambda1}\nWe begin by writing the following identities that can be verified by direct differentiation\n\n", "index": 53, "text": "\\begin{align}\n(\\mathbf u \\cdot \\nabla) [(\\mathbf u \\cdot {\\mathbf R}) {\\mathbf R} |{\\mathbf R}|] &=\n\t{\\mathbf R} |{\\mathbf R}| \n\t+ (\\mathbf u \\cdot {\\mathbf R}) \\mathbf u |{\\mathbf R}|\n\t+ (\\mathbf u \\cdot {\\mathbf R})^2 \\frac{{\\mathbf R}}{|{\\mathbf R}|} \\\\\n(\\mathbf u \\cdot \\nabla) [(\\mathbf u \\cdot {\\mathbf R})^2 |{\\mathbf R}|] &=\n\t2 (\\mathbf u \\cdot {\\mathbf R}) |{\\mathbf R}|\n\t+ (\\mathbf u \\cdot {\\mathbf R})^3 \\frac{1}{|{\\mathbf R}|}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E30.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle(\\mathbf{u}\\cdot\\nabla)[(\\mathbf{u}\\cdot{\\mathbf{R}}){\\mathbf{R}}%&#10;|{\\mathbf{R}}|]\" display=\"inline\"><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mo>\u2207</mo></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mi>\ud835\udc11</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>\ud835\udc11</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E30.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle={\\mathbf{R}}|{\\mathbf{R}}|+(\\mathbf{u}\\cdot{\\mathbf{R}})\\mathbf{%&#10;u}|{\\mathbf{R}}|+(\\mathbf{u}\\cdot{\\mathbf{R}})^{2}\\frac{{\\mathbf{R}}}{|{%&#10;\\mathbf{R}}|}\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mrow><mi>\ud835\udc11</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mrow><mo>+</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mi>\ud835\udc11</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>\ud835\udc2e</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mrow><mo>+</mo><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mi>\ud835\udc11</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup><mo>\u2062</mo><mstyle displaystyle=\"true\"><mfrac><mi>\ud835\udc11</mi><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mfrac></mstyle></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E31.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle(\\mathbf{u}\\cdot\\nabla)[(\\mathbf{u}\\cdot{\\mathbf{R}})^{2}|{%&#10;\\mathbf{R}}|]\" display=\"inline\"><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mo>\u2207</mo></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mi>\ud835\udc11</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E31.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=2(\\mathbf{u}\\cdot{\\mathbf{R}})|{\\mathbf{R}}|+(\\mathbf{u}\\cdot{%&#10;\\mathbf{R}})^{3}\\frac{1}{|{\\mathbf{R}}|}\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mrow><mn>2</mn><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mi>\ud835\udc11</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mrow><mo>+</mo><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mi>\ud835\udc11</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mn>3</mn></msup><mo>\u2062</mo><mstyle displaystyle=\"true\"><mfrac><mn>1</mn><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mfrac></mstyle></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "\nSolving for ${\\mathbf R} |{\\mathbf R}|$ and integrating \n\n", "itemtype": "equation", "pos": 33739, "prevtext": "\nMultiplying the second equation by $\\mathbf u/2$ and subtracting from the first to eliminate $(\\mathbf u \\cdot {\\mathbf R}) |{\\mathbf R}|$ on the right-hand side, we get\n\n", "index": 55, "text": "\\begin{equation}\n(\\mathbf u \\cdot \\nabla) [(\\mathbf u \\cdot {\\mathbf R}) {\\mathbf R} |{\\mathbf R}|] - \n\\frac{\\mathbf u}{2} (\\mathbf u \\cdot \\nabla) [\\mathbf (\\mathbf u \\cdot {\\mathbf R})^2 |{\\mathbf R}|]\n=\n{\\mathbf R} |{\\mathbf R}| + (\\mathbf u \\cdot {\\mathbf R})^2 \\frac{{\\mathbf R}}{|{\\mathbf R}|} - \\frac{\\mathbf u}{2} (\\mathbf u \\cdot {\\mathbf R})^3 \\frac{1}{|{\\mathbf R}|}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E32.m1\" class=\"ltx_Math\" alttext=\"(\\mathbf{u}\\cdot\\nabla)[(\\mathbf{u}\\cdot{\\mathbf{R}}){\\mathbf{R}}|{\\mathbf{R}}%&#10;|]-\\frac{\\mathbf{u}}{2}(\\mathbf{u}\\cdot\\nabla)[\\mathbf{(}\\mathbf{u}\\cdot{%&#10;\\mathbf{R}})^{2}|{\\mathbf{R}}|]={\\mathbf{R}}|{\\mathbf{R}}|+(\\mathbf{u}\\cdot{%&#10;\\mathbf{R}})^{2}\\frac{{\\mathbf{R}}}{|{\\mathbf{R}}|}-\\frac{\\mathbf{u}}{2}(%&#10;\\mathbf{u}\\cdot{\\mathbf{R}})^{3}\\frac{1}{|{\\mathbf{R}}|}\" display=\"block\"><mrow><mrow><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mo>\u2207</mo></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mi>\ud835\udc11</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>\ud835\udc11</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mo>-</mo><mrow><mfrac><mi>\ud835\udc2e</mi><mn>2</mn></mfrac><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mo>\u2207</mo></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mi>\ud835\udc11</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow><mo>=</mo><mrow><mrow><mrow><mi>\ud835\udc11</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mrow><mo>+</mo><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mi>\ud835\udc11</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup><mo>\u2062</mo><mfrac><mi>\ud835\udc11</mi><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mfrac></mrow></mrow><mo>-</mo><mrow><mfrac><mi>\ud835\udc2e</mi><mn>2</mn></mfrac><mo>\u2062</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mi>\ud835\udc11</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mn>3</mn></msup><mo>\u2062</mo><mfrac><mn>1</mn><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mfrac></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "\nThe first integral can be evaluated using the gradient theorem; to evaluate the second, we note that \n\n", "itemtype": "equation", "pos": 34189, "prevtext": "\nSolving for ${\\mathbf R} |{\\mathbf R}|$ and integrating \n\n", "index": 57, "text": "\\begin{equation}\n\\boldsymbol\\lambda_1({\\mathbf R}_1, {\\mathbf R}_2) = \n\t\\int_{{\\mathbf R}_1}^{{\\mathbf R}_2} (\\mathbf u \\cdot \\nabla) \\big[\n\t\t(\\mathbf u \\cdot {\\mathbf R}) ({\\mathbf R}  - \\frac{\\mathbf u}{2} (\\mathbf u \\cdot {\\mathbf R})) |{\\mathbf R}|  \n\t\\big] \\,dl\n\t- \\int_{{\\mathbf R}_1}^{{\\mathbf R}_2} (\\mathbf u \\cdot {\\mathbf R})^2 [\\mathbf{Id}  - \\frac{\\mathbf u}{2} (\\mathbf u \\cdot{})] \\frac{{\\mathbf R}}{|{\\mathbf R}|} \\,dl\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E33.m1\" class=\"ltx_Math\" alttext=\"\\bm{\\lambda}_{1}({\\mathbf{R}}_{1},{\\mathbf{R}}_{2})=\\int_{{\\mathbf{R}}_{1}}^{{%&#10;\\mathbf{R}}_{2}}(\\mathbf{u}\\cdot\\nabla)\\big{[}(\\mathbf{u}\\cdot{\\mathbf{R}})({%&#10;\\mathbf{R}}-\\frac{\\mathbf{u}}{2}(\\mathbf{u}\\cdot{\\mathbf{R}}))|{\\mathbf{R}}|%&#10;\\big{]}\\,dl-\\int_{{\\mathbf{R}}_{1}}^{{\\mathbf{R}}_{2}}(\\mathbf{u}\\cdot{\\mathbf%&#10;{R}})^{2}[\\mathbf{Id}-\\frac{\\mathbf{u}}{2}(\\mathbf{u}\\cdot{})]\\frac{{\\mathbf{R%&#10;}}}{|{\\mathbf{R}}|}\\,dl\" display=\"block\"><mrow><msub><mi>\ud835\udf40</mi><mn>1</mn></msub><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow><mo>=</mo><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><msub><mi>\ud835\udc11</mi><mn>2</mn></msub></msubsup><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mo>\u2207</mo><mo stretchy=\"false\">)</mo></mrow><mrow><mo maxsize=\"120%\" minsize=\"120%\">[</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc11</mi><mo>-</mo><mfrac><mi>\ud835\udc2e</mi><mn>2</mn></mfrac><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo><mo maxsize=\"120%\" minsize=\"120%\" rspace=\"4.2pt\">]</mo></mrow><mi>d</mi><mi>l</mi><mo>-</mo><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><msub><mi>\ud835\udc11</mi><mn>2</mn></msub></msubsup><msup><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup><mrow><mo stretchy=\"false\">[</mo><mi>\ud835\udc08\ud835\udc1d</mi><mo>-</mo><mfrac><mi>\ud835\udc2e</mi><mn>2</mn></mfrac><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">]</mo></mrow><mpadded width=\"+1.7pt\"><mfrac><mi>\ud835\udc11</mi><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow></mfrac></mpadded><mi>d</mi><mi>l</mi></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "\nAgain, the quantity $\\mathbf u \\times {\\mathbf R}$ is constant and can be moved outside of the integral, resulting in the following equation for $\\boldsymbol\\lambda_1({\\mathbf R}_1, {\\mathbf R}_2)$:\n\n", "itemtype": "equation", "pos": 34741, "prevtext": "\nThe first integral can be evaluated using the gradient theorem; to evaluate the second, we note that \n\n", "index": 59, "text": "\\begin{equation}\n(\\mathbf u \\cdot {\\mathbf R})^2 = |{\\mathbf R}|^2  - |\\mathbf u \\times {\\mathbf R}|^2\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E34.m1\" class=\"ltx_Math\" alttext=\"(\\mathbf{u}\\cdot{\\mathbf{R}})^{2}=|{\\mathbf{R}}|^{2}-|\\mathbf{u}\\times{\\mathbf%&#10;{R}}|^{2}\" display=\"block\"><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mi>\ud835\udc11</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup><mo>=</mo><mrow><msup><mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">|</mo></mrow><mn>2</mn></msup><mo>-</mo><msup><mrow><mo stretchy=\"false\">|</mo><mrow><mi>\ud835\udc2e</mi><mo>\u00d7</mo><mi>\ud835\udc11</mi></mrow><mo stretchy=\"false\">|</mo></mrow><mn>2</mn></msup></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "\nIn this equation $\\boldsymbol\\lambda_1({\\mathbf R}_1, {\\mathbf R}_2)$ appears on both sides; to solve for it we need to invert the matrix $2\\,\\mathbf{Id}  - \\frac12 \\mathbf u (\\mathbf u \\cdot{})$. It is straightforward to verify that\n$(2\\mathbf{Id}  - \\frac{\\mathbf u}{2} (\\mathbf u \\cdot{}))^{-1} = \\frac12\\mathbf{Id} + \\frac16 \\mathbf u (\\mathbf u \\cdot{})$ and therefore we obtain the desired formula\n \n", "itemtype": "equation", "pos": 35058, "prevtext": "\nAgain, the quantity $\\mathbf u \\times {\\mathbf R}$ is constant and can be moved outside of the integral, resulting in the following equation for $\\boldsymbol\\lambda_1({\\mathbf R}_1, {\\mathbf R}_2)$:\n\n", "index": 61, "text": "\\begin{equation}\n\\boldsymbol\\lambda_1 =\n\t(\\mathbf u \\cdot {\\mathbf R}) ({\\mathbf R}  - \\frac{\\mathbf u}{2} (\\mathbf u \\cdot {\\mathbf R})) |{\\mathbf R}| \\, \\Big|_{{\\mathbf R}_1}^{{\\mathbf R}_2}\n\t- [\\mathbf{Id}  - \\frac{\\mathbf u}{2} (\\mathbf u \\cdot{})] \\boldsymbol\\lambda_1 \n\t+[\\mathbf{Id}  - \\frac{\\mathbf u}{2} (\\mathbf u \\cdot{})] |\\mathbf u \\times {\\mathbf R}_1|^2 \\boldsymbol\\eta_1\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E35.m1\" class=\"ltx_Math\" alttext=\"\\bm{\\lambda}_{1}=(\\mathbf{u}\\cdot{\\mathbf{R}})({\\mathbf{R}}-\\frac{\\mathbf{u}}{%&#10;2}(\\mathbf{u}\\cdot{\\mathbf{R}}))|{\\mathbf{R}}|\\,\\Big{|}_{{\\mathbf{R}}_{1}}^{{%&#10;\\mathbf{R}}_{2}}-[\\mathbf{Id}-\\frac{\\mathbf{u}}{2}(\\mathbf{u}\\cdot{})]\\bm{%&#10;\\lambda}_{1}+[\\mathbf{Id}-\\frac{\\mathbf{u}}{2}(\\mathbf{u}\\cdot{})]|\\mathbf{u}%&#10;\\times{\\mathbf{R}}_{1}|^{2}\\bm{\\eta}_{1}\" display=\"block\"><mrow><msub><mi>\ud835\udf40</mi><mn>1</mn></msub><mo>=</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc11</mi><mo>-</mo><mfrac><mi>\ud835\udc2e</mi><mn>2</mn></mfrac><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo rspace=\"4.2pt\" stretchy=\"false\">|</mo><msubsup><mo maxsize=\"160%\" minsize=\"160%\">|</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><msub><mi>\ud835\udc11</mi><mn>2</mn></msub></msubsup><mo>-</mo><mrow><mo stretchy=\"false\">[</mo><mi>\ud835\udc08\ud835\udc1d</mi><mo>-</mo><mfrac><mi>\ud835\udc2e</mi><mn>2</mn></mfrac><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">]</mo></mrow><msub><mi>\ud835\udf40</mi><mn>1</mn></msub><mo>+</mo><mrow><mo stretchy=\"false\">[</mo><mi>\ud835\udc08\ud835\udc1d</mi><mo>-</mo><mfrac><mi>\ud835\udc2e</mi><mn>2</mn></mfrac><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">]</mo></mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc2e</mi><mo>\u00d7</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><msup><mo stretchy=\"false\">|</mo><mn>2</mn></msup><msub><mi>\ud835\udf3c</mi><mn>1</mn></msub></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "\n\n\\section{Vector calculus identities}\n\\label{sec:app_calculus}\nGradient theorem:\n\n", "itemtype": "equation", "pos": 35865, "prevtext": "\nIn this equation $\\boldsymbol\\lambda_1({\\mathbf R}_1, {\\mathbf R}_2)$ appears on both sides; to solve for it we need to invert the matrix $2\\,\\mathbf{Id}  - \\frac12 \\mathbf u (\\mathbf u \\cdot{})$. It is straightforward to verify that\n$(2\\mathbf{Id}  - \\frac{\\mathbf u}{2} (\\mathbf u \\cdot{}))^{-1} = \\frac12\\mathbf{Id} + \\frac16 \\mathbf u (\\mathbf u \\cdot{})$ and therefore we obtain the desired formula\n \n", "index": 63, "text": "\\begin{equation}\n \\boldsymbol\\lambda_1({\\mathbf R}_1, {\\mathbf R}_2) =\n\\big(\\frac12\\mathbf{Id} + \\frac16 \\mathbf u (\\mathbf u \\cdot{})\\big)\n \\Big[\n\t(\\mathbf u \\cdot {\\mathbf R}) ({\\mathbf R}  - \\frac{\\mathbf u}{2} (\\mathbf u \\cdot {\\mathbf R})) |{\\mathbf R}| \\, \\Big|_{{\\mathbf R}_1}^{{\\mathbf R}_2}\n\t+[\\mathbf{Id}  - \\frac{\\mathbf u}{2} (\\mathbf u \\cdot{})] |\\mathbf u \\times {\\mathbf R}_1|^2 \\boldsymbol\\eta_1({\\mathbf R}_1, {\\mathbf R}_2)\n \\Big]\n  \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E36.m1\" class=\"ltx_Math\" alttext=\"\\bm{\\lambda}_{1}({\\mathbf{R}}_{1},{\\mathbf{R}}_{2})=\\big{(}\\frac{1}{2}\\mathbf{%&#10;Id}+\\frac{1}{6}\\mathbf{u}(\\mathbf{u}\\cdot{})\\big{)}\\Big{[}(\\mathbf{u}\\cdot{%&#10;\\mathbf{R}})({\\mathbf{R}}-\\frac{\\mathbf{u}}{2}(\\mathbf{u}\\cdot{\\mathbf{R}}))|{%&#10;\\mathbf{R}}|\\,\\Big{|}_{{\\mathbf{R}}_{1}}^{{\\mathbf{R}}_{2}}+[\\mathbf{Id}-\\frac%&#10;{\\mathbf{u}}{2}(\\mathbf{u}\\cdot{})]|\\mathbf{u}\\times{\\mathbf{R}}_{1}|^{2}\\bm{%&#10;\\eta}_{1}({\\mathbf{R}}_{1},{\\mathbf{R}}_{2})\\Big{]}\" display=\"block\"><mrow><msub><mi>\ud835\udf40</mi><mn>1</mn></msub><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow><mo>=</mo><mrow><mo maxsize=\"120%\" minsize=\"120%\">(</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>\ud835\udc08\ud835\udc1d</mi><mo>+</mo><mfrac><mn>1</mn><mn>6</mn></mfrac><mi>\ud835\udc2e</mi><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mo stretchy=\"false\">)</mo></mrow><mo maxsize=\"120%\" minsize=\"120%\">)</mo></mrow><mrow><mo maxsize=\"160%\" minsize=\"160%\">[</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc11</mi><mo>-</mo><mfrac><mi>\ud835\udc2e</mi><mn>2</mn></mfrac><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc11</mi><mo rspace=\"4.2pt\" stretchy=\"false\">|</mo><msubsup><mo maxsize=\"160%\" minsize=\"160%\">|</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><msub><mi>\ud835\udc11</mi><mn>2</mn></msub></msubsup><mo>+</mo><mrow><mo stretchy=\"false\">[</mo><mi>\ud835\udc08\ud835\udc1d</mi><mo>-</mo><mfrac><mi>\ud835\udc2e</mi><mn>2</mn></mfrac><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">]</mo></mrow><mo stretchy=\"false\">|</mo><mi>\ud835\udc2e</mi><mo>\u00d7</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><msup><mo stretchy=\"false\">|</mo><mn>2</mn></msup><msub><mi>\ud835\udf3c</mi><mn>1</mn></msub><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow><mo maxsize=\"160%\" minsize=\"160%\">]</mo></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "\n\nDecomposition of a vector into components parallel and orthogonal to a unit vector $\\mathbf u$ with $|\\mathbf u| = 1$: \n\n", "itemtype": "equation", "pos": 36412, "prevtext": "\n\n\\section{Vector calculus identities}\n\\label{sec:app_calculus}\nGradient theorem:\n\n", "index": 65, "text": "\\begin{equation}\n\\label{eq:gradient}\n\\int_{{\\mathbf R}_1}^{{\\mathbf R}_2} (\\mathbf u \\cdot \\nabla) f({\\mathbf R}) \\, dl = f({\\mathbf R}_2) - f({\\mathbf R}_1) \n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E37.m1\" class=\"ltx_Math\" alttext=\"\\int_{{\\mathbf{R}}_{1}}^{{\\mathbf{R}}_{2}}(\\mathbf{u}\\cdot\\nabla)f({\\mathbf{R}%&#10;})\\,dl=f({\\mathbf{R}}_{2})-f({\\mathbf{R}}_{1})\" display=\"block\"><mrow><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><msub><mi>\ud835\udc11</mi><mn>2</mn></msub></msubsup><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mo>\u2207</mo></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc11</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>l</mi></mrow></mrow></mrow><mo>=</mo><mrow><mrow><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udc11</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": " \n\nStokes' theorem (alternative form):\n\n", "itemtype": "equation", "pos": -1, "prevtext": "\n\nDecomposition of a vector into components parallel and orthogonal to a unit vector $\\mathbf u$ with $|\\mathbf u| = 1$: \n\n", "index": 67, "text": "\\begin{equation}\n\\label{eq:decomp}\n\\mathbf a = \\mathbf u (\\mathbf u \\cdot \\mathbf a) - \\mathbf u \\times (\\mathbf u \\times \\mathbf a) \n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E38.m1\" class=\"ltx_Math\" alttext=\"\\mathbf{a}=\\mathbf{u}(\\mathbf{u}\\cdot\\mathbf{a})-\\mathbf{u}\\times(\\mathbf{u}%&#10;\\times\\mathbf{a})\" display=\"block\"><mrow><mi>\ud835\udc1a</mi><mo>=</mo><mrow><mrow><mi>\ud835\udc2e</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc2e</mi><mo>\u22c5</mo><mi>\ud835\udc1a</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mi>\ud835\udc2e</mi><mo>\u00d7</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\ud835\udc2e</mi><mo>\u00d7</mo><mi>\ud835\udc1a</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04185.tex", "nexttext": "\n \n\\bibliographystyle{elsarticle-num}\n\n  \n\n", "itemtype": "equation", "pos": 36894, "prevtext": " \n\nStokes' theorem (alternative form):\n\n", "index": 69, "text": "\\begin{equation}\n\\label{eq:stokes}\n\\int_S ({\\mathbf n}_s \\times ({\\mathbf n}_s \\times \\nabla)) \\, a({\\mathbf R}) \\, ds =  \\int_{\\partial S} a({\\mathbf R})\\mathbf u_l \\, dl \n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E39.m1\" class=\"ltx_Math\" alttext=\"\\int_{S}({\\mathbf{n}}_{s}\\times({\\mathbf{n}}_{s}\\times\\nabla))\\,a({\\mathbf{R}}%&#10;)\\,ds=\\int_{\\partial S}a({\\mathbf{R}})\\mathbf{u}_{l}\\,dl\" display=\"block\"><mrow><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mi>S</mi></msub><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc27</mi><mi>s</mi></msub><mo>\u00d7</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\ud835\udc27</mi><mi>s</mi></msub><mo>\u00d7</mo><mo>\u2207</mo></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>a</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc11</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>s</mi></mrow></mrow></mrow><mo>=</mo><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>S</mi></mrow></msub><mrow><mi>a</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc11</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mpadded width=\"+1.7pt\"><msub><mi>\ud835\udc2e</mi><mi>l</mi></msub></mpadded><mo>\u2062</mo><mrow><mo>\ud835\udc51</mo><mi>l</mi></mrow></mrow></mrow></mrow></math>", "type": "latex"}]