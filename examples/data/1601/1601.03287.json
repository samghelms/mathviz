[{"file": "1601.03287.tex", "nexttext": "\nwhere $\\bar{B}_0$ is a constant, ${\\cal S} = \\phi - q(r)(\\theta - \\theta_0(r))$, $q(r) $ is the safety factor and $\\theta_0(r)$ is an arbitrary function of $r$.  The tokamak is large aspect ratio ({\\em i.e.} $r/R_0 =\\epsilon\\ll 1$) and low beta $p_0(r) \\sim {\\cal O}(\\epsilon^2 \\bar{B}_0^2)$.  The {\\em transport barrier} is a narrow region of steep pressure gradient ($rp_0'\\sim {\\cal O}(p_0/\\epsilon)$) of width $\\sim\\epsilon r$ centred around a surface $r=r_p$ -- see Fig.~(\\ref{profiles}).  The equilibrium is obtained from an expansion in $\\epsilon$ (as in \\cite{GJW}).\n\\begin{figure}\n\\includegraphics[width=0.4\\textwidth]{profile_pres_q}\n\\caption{\\label{profiles}Profile of safety factor, $q$, (solid line, left hand axis) and of normalized pressure, $\\beta_{\\alpha}/a =2\\mu_0 R_0 q^2 p_0(r)/B^2_0 a$, (dashed line, right hand axis) for the internal transport barrier (where $a$ is the plasma minor radius).} \n\\end{figure} \n\nWe consider a highly elliptical flux tube with $r\\gg\\Delta r \\sim \\delta_2 \\gg \\Delta{\\cal S} \\sim \\delta_1$ whose centre originates from the field line on the flux surface labelled by $r_{0}$ and ${\\cal S} =0$. The field lines in the tube are displaced along the surface ${\\cal S} =0$ with shape given by $r = r(\\theta, r_0, t)$ where $r(t=0) = r_0$ -- see Fig.~(\\ref{tokpic}). \n\n\\begin{figure}\n\\includegraphics[width=0.4\\textwidth]{tokpic6}\n\\caption{\\label{tokpic} Elliptical (orange) flux tube with $\\Delta r \\sim \\delta_2 \\gg \\Delta{\\cal S} \\sim \\delta_1$ sliding along (blue) surface ${\\cal S} =0$ parting surrounding (black) field lines. Note the tube's displacement is larger on the large $R$ part of the flux surfaces -- the tube balloons. The magnetic shear $(s=rq'/q)$ causes the twist and narrowing of the tube on the inside. } \n\\end{figure}\n \nIn principle we could consider motion along any ${\\cal S}$ surface defined by any function $\\theta_0(r)$ -- we restrict ourselves to the choice $\\theta_0(r) = 0$.  This is the choice for the most linearly unstable motions. The tube wraps around the torus many times and we consider $r(\\theta, r_0,t)$ on the domain $-\\infty < \\theta < \\infty$. We ignore the fact that the ${\\cal S} =0$ surface intersects itself as $\\theta$ increases since we assume that the perturbations are sufficiently localised in $\\theta$ to avoid self intersection of the flux tube.  The plasma is taken to be perfectly conducting -- {\\em i.e.} the plasma is frozen to the field.  Thus the field lines must remain attached to their original surfaces and therefore $r = r(\\theta, r_0, t)\\rightarrow r_0$ as $|\\theta|\\rightarrow\\infty$. The derivation of the equation of motion here follows the treatment for a general equilibrium of a magnetically confined plasma in Appendix B of \\cite{CCHW2}.  The exact shape of the tube will not be needed but we do assume that $\\delta_1$ is sufficiently small that we can treat the field and pressure outside the tube as unperturbed.  This requires $\\delta_1^2\\ll \\delta_2^3/\\xi$ where $\\xi$ is the radial displacement of the flux tube.  \n\nWe denote the field inside the tube to be ${\\bf B}_{in} = {\\bf B}_{in}(\\theta, r_0, t)$.  The motion of the tube is assumed to be slow compared to the (sound) time to equalise pressure along the tube and thus the pressure in the tube is $p_{in}(\\theta, r_0, t) = p_0(r_0)$.  The pressure forces across the tube in the direction of ${\\mbox{\\boldmath{$\\nabla$}}}{\\cal S}$ are formally large ($\\sim p_0/\\delta_1$) and therefore the total pressure inside the tube must equal the total pressure just outside the tube. Thus:\n\\begin{eqnarray}\nB_{in}^2(\\theta, r_0, t)  = B_{0}^2(\\theta, r) + 2\\mu_0 [p_{0}(r) - p_{0}(r_0)],\n\\label{infield}\\end{eqnarray}\nwhere we have assumed that the field and pressure outside the tube are unperturbed. \nThe force, $F_\\perp$ pushing the field line along $\\cal S$ in the direction ${\\bf e}_\\perp = ({\\mbox{\\boldmath{$\\nabla$}}}{\\cal S}\\times{\\bf B}_0)/B_0$ is:\n\\begin{eqnarray}\nF_\\perp =  \\frac{1}{\\mu_0}\\left[ {\\bf B}_{in}\\cdot{\\mbox{\\boldmath{$\\nabla$}}}{\\bf B}_{in} - {\\mbox{\\boldmath{$\\nabla$}}}\\left(\\frac{B_{in}^2}{2} + \\mu_0p_{in}\\right)\\right]\\cdot{\\bf e}_\\perp  \\nonumber \\\\ \n = \\frac{1}{\\mu_0}\\left[ {\\bf B}_{in}\\cdot{\\mbox{\\boldmath{$\\nabla$}}}{\\bf B}_{in} - {\\bf B}_{0}\\cdot{\\mbox{\\boldmath{$\\nabla$}}}{\\bf B}_{0}\\right]\\cdot{\\bf e}_\\perp.\\;\\;\\;\\;\\;\\;\\;\\;\\;\n\\label{Fperp}\\end{eqnarray}\nThe second expression follows from Eq.~(\\ref{infield}) and the unperturbed equilibrium relation ${\\mbox{\\boldmath{$\\nabla$}}}\\left(B_{0}^2/2 + \\mu_0p_{0}\\right) = {\\bf B}_{0}\\cdot{\\mbox{\\boldmath{$\\nabla$}}}{\\bf B}_{0}$.  The expression in Eq.~(\\ref{Fperp}) is a generalised form of {\\em Archimedes principle} where the net force is the curvature force of the tube minus the curvature force of the tube it has displaced.  \n$F_\\perp$ can in general be expressed in terms of $r(\\theta, r_0, t)$ and its first and second derivatives with respect to $\\theta$ at constant $r_0$ -- see Appendix B of \\cite{CCHW2}. Thus the force on each field line is determined independently.  The equilibrium states of the field line satisfy $F_\\perp(r(\\theta, r_0, t))=0$.  We model the dynamics of the tube by a simple drag evolution with ${\\bf v} = v{\\bf e}_\\perp$, $F_\\perp = \\nu{\\bf v}\\cdot {{\\bf e}_\\perp}$ and $v = -R_0f\\frac{\\partial r}{\\partial t}$. The actual dynamics of the tube are clearly more complicated but the equilibrium states must, of course, satisfy $F_\\perp(r(\\theta, r_0, t))=0$.    After some algebra we obtain from Eq.~(\\ref{Fperp}) the evolution equation for each field line $(r(\\theta, r_0, t))$ in our simple large aspect ratio model:\n\\begin{eqnarray}\n\\nu' \\left(\\frac{\\partial r}{\\partial t}\\right)\\left[ 1 + (\\alpha\\sin{\\theta} - s\\theta)^2 \\right]  = F'_\\perp(r(\\theta, r_0, t))=& \\nonumber \\\\  (\\beta_{\\alpha} (r_0) - \\beta_{\\alpha} (r))\n\\left[\\cos{\\theta} + \\sin{\\theta}(s\\theta - \\alpha\\sin{\\theta})\\right]  &\n \\nonumber \\\\ + \n\\left(\\frac{\\partial}{\\partial \\theta}\\right)_{r_0}\\left(\\left[ 1 + (\\alpha\\sin{\\theta} - s\\theta)^2) \\right] \\left(\\frac{\\partial r}{\\partial \\theta}\\right)_{r_0}\\right)\n \\nonumber \\\\  - \\frac{1}{2}\n\\left(\\frac{\\partial r}{\\partial \\theta}\\right)^2_{r_0} \\left(\\frac{\\partial}{\\partial r}\\right)_{\\theta}(\\alpha\\sin{\\theta} - s\\theta)^2\n\\label{balloondrag}\\end{eqnarray}\nwhere $\\nu' = \\nu{\\mu_0}\\frac{q^2R_0^2}{B_0^2}$, $F'_\\perp = F_\\perp{\\mu_0}\\frac{qR_0^2r}{B_0^2}$, $s = rq'(r)/q(r)$ and $ \\beta_{\\alpha} (r) = 2{\\mu_0}R_0q^2p_0(r)/{\\bar B}_0^2$ and $\\alpha(r) = -d\\beta_{\\alpha} (r)/dr$.\nEq.~(\\ref{balloondrag}) is a nonlinear generalisation of the $s - \\alpha$ model of \\cite{CHT2}.  We define the ``energy'' functional, ${\\cal{E}}(r, r_0) =\\int_{-\\infty}^\\infty {\\bf B}_{in}\\cdot d{\\bf r}$ where the integral is taken along the perturbed field line.\\cite{CCHW2}  Note ${\\cal{E}}(r, r_0)$ is formally infinite but we can make it finite by subtracting the unperturbed value  $\\Delta{\\cal{E}}(r,r_0) = {\\cal{E}}(r,r_0) - {\\cal{E}}(r_0, r_0)$. Drag evolution takes the flux tube to minima of the energy $\\Delta{\\cal{E}}(r,r_0)$ -- see \\cite{CCHW2}.  The equilibrium states are stationary points of the variation of $\\Delta{\\cal{E}}(r,r_0)$ with respect to $r(\\theta, r_0, t)$ at fixed $r_0$ \\cite{CCHW2}.  The relative energy for our model is:\n\\begin{eqnarray}\n\\Delta{\\cal{E}}(r,r_0) = \\int_{-\\infty}^{\\infty}d\\theta\\left[ \\frac{1}{2}\n\\left(\\frac{\\partial r}{\\partial \\theta}\\right)^2_{r_0}\\left( 1 + (\\alpha\\sin{\\theta} - s\\theta)^2 \\right)\n\\right] - \\;\\;\\; && \\\\ \n\\int_{-\\infty}^{\\infty}d\\theta\\left[{\\cal{A}}(r,r_0)\\cos{\\theta} + {\\cal{B}}(r, r_0)\\theta\\sin{\\theta} - {\\cal{C}}(r, r_0)\\sin^2{\\theta}\\right]&& \\nonumber\n\\label{energy2}\\end{eqnarray}\nwhere the integral is at fixed $r_0$ and the energy coefficients are ${\\cal{A}}(r,r_0) = \\int_{r_0}^{r}(\\beta_{\\alpha} (r') - \\beta_{\\alpha} (r_0))dr'$, ${\\cal{B}}(r,r_0) = \\int_{r_0}^{r}(\\beta_{\\alpha} (r') - \\beta_{\\alpha} (r_0))s(r')dr'$ and ${\\cal{C}}(r,r_0) = \\frac{1}{2}(\\beta_{\\alpha} (r) - \\beta_{\\alpha} (r_0))^2$.\n\n\\section{\\label{sec:Linear} Linearly stable case} \n\n    We investigate a case where we choose profiles of $\\alpha(r)$ and $s(r)$ that yield an internal transport barrier: $\\alpha(r) = \\alpha_0 \\textup{sech}^2\\left((r-r_{\\alpha})/\\epsilon _p\\right)$, $s(r) = (s_0 + s_1)/2+\\left((s_1-s_0)/2\\right) \\tanh\\left((r-r_s)/\\epsilon _p\\right)$. Linearising Eq.~(\\ref{balloondrag}) with $r = \\xi(\\theta, r_0, t) + r_0$ with $\\xi\\alpha' , \\xi s' \\ll 1$ we obtain growing eigenmodes if the local values of $\\alpha(r_0)$ and $s(r_0)$ lie in the unstable region of the s-$\\alpha$ diagram -- see Fig.~(\\ref{salpha}) \\cite{CHT2}.  We take an initial equilibrium with no linearly unstable field lines with $\\alpha_0= 0.28$, $s_0 = 0.05$, $s_1 = 0.3$, $r_a = 0.7$, $r_s = 0.72$, $ \\epsilon_p = 0.1$.  As $r_0$ is increased the equilibrium traces out the dash-dotted line in Fig.~(\\ref{salpha}) in the direction indicated by the arrows.  Clearly no surfaces (field lines) are linearly unstable and all infinitesimal perturbations decay.  Nonetheless finite perturbations can grow.  For example in Fig.~(\\ref{evolve2}) we show the drag evolution ($r=r(\\theta, r_0, t)$ using Eq.~(\\ref{balloondrag})) of the field line $r_0 = 0.61$ with two finite initial displacements.  \n\\begin{figure}\n\n\\includegraphics[width=0.4\\textwidth]{lin_stabPAP}\n\\caption{\\label{salpha} s-$\\alpha$ diagram illustrating the linear instability boundary.  The equilibrium chosen here follows the trajectory of the dash-dotted line as $r_0$ is increased.  No surfaces are linearly unstable.} \n\\end{figure} \n\n\\begin{figure}\n\\includegraphics[width=0.4\\textwidth]{Evolve2PAP}\n\\caption{\\label{evolve2} The upper plot shows the shape of the field line at different times, $r=r(\\theta,r_0,t)$ for $r_0=0.61$. The solid lines start with the initial condition just greater than the unstable equilibrium state $r_{crit}$ and evolve upwards. The dash-dotted lines start with the initial condition just less than the unstable equilibrium state $r_{crit}$ and evolve downwards. The final state of this evolution is the unperturbed field line. The lower plot shows the time evolution of maximum value along the field line $r_{max}(t)=r(0,r_0,t)$. Again, the solid (dash-dotted) line starts with the initial condition just greater (just less) than the unstable equilibrium state $r_{crit}$.} \n\\end{figure} \nThe larger initial displacement evolves to a finite displaced stable equilibrium. The smaller initial displacement decays to the linearly stable unperturbed state $r=r_0$ (Fig.~(\\ref{evolve2})).  There are three equilibrium states of this field line that can be found by solving the equation $F'_\\perp =0$ (see Eq.~(\\ref{balloondrag})) by a simple shooting method.  These are: the linearly stable unperturbed state $r=r_0$ with relative energy $\\Delta{\\cal{E}}=0$; an unstable equilibrium state, $r=r_{crit}(\\theta,r_0)$, between the two initial conditions shown at $t=0$ in Fig.~(\\ref{evolve2}) with $\\Delta{\\cal{E}}=1.09\\times10^{-4}$ and; the stable equilibrium state, $r=r_{sat}(\\theta,r_0)$ that is the final state of the larger perturbation with $\\Delta{\\cal{E}}=-0.8\\times10^{-4}$.  Clearly the unperturbed state is meta-stable since a finite perturbation triggers evolution to a lower energy state.\n\nNot all the field lines have lower energy equilibrium states. We have examined the $F'_\\perp =0$ solutions for $0.4< r_0<0.8$. For $0.474< r_0 < 0.680$ there are three equilibrium solutions but outside this region the only equilibrium solution is the unperturbed state.  All displaced solutions are even in $\\theta$ and have their maximum displacement at $\\theta=0$ which we denote $r_{max}$.  In Fig.~(\\ref{energyplot}) we plot $\\Delta{\\cal{E}}$ for the three solutions and in Fig.~(\\ref{dbeta}) we plot both $\\Delta = (\\beta_{\\alpha} (r_0) - \\beta_{\\alpha} (r_{max})/(2\\epsilon _p \\alpha_0)$ (solid and dash-dotted lines, left-hand axis) and $r_{max}$ (dashed and dotted lines, right-hand axis).  $\\Delta$ measures the fraction of pressure profile crossed by the ballooning flux tube.  Clearly for $0.593< r_0 < 0.678$ the lowest energy state is a displaced state (the solid black line in Fig.~(\\ref{energyplot})) -- these states can be reached by giving the field line a perturbation with more than the energy of the unstable positive energy equilibrium state (the dashed line in Fig.~(\\ref{energyplot}))\n\n\\begin{figure}\n\\includegraphics[width=0.4\\textwidth]{energyPAP}\n\\caption{\\label{energyplot} . Relative energy, $\\Delta{\\cal E}$, evaluated from Eq.(\\ref{energy2}) for three equilibrium solutions, $F'_\\perp =0$, of Eq.(\\ref{balloondrag}).  The dotted line is the unperturbed energy, the dashed line is the unstable displaced equilibrium energy ($\\Delta {\\cal E}(r_{crit},r_0)$) and the solid line is the displaced stable equilibrium energy ($\\Delta {\\cal E}(r_{sat},r_0)$). The stable displaced equilibrium is the lowest energy state for $0.593< r_0 < 0.679$.} \n\\end{figure} \n\\begin{figure}\n\\includegraphics[width=0.4\\textwidth]{dbetaPAP}\n\\caption{\\label{dbeta} A measure of the ballooning displacement $\\Delta = (\\beta_{\\alpha} (r_0) - \\beta_{\\alpha} (r_{max})/(2\\epsilon _p \\alpha_0)$ for the two perturbed equilibrium states (left-hand axis).  Field lines in the displaced lower energy equilibrium can cross a substantial fraction of the pressure profile (solid line) -- for example the $r_0 = 0.61$ field line balloons across about $73\\%$ of the pressure profile. The unstable equilibrium is shown by the dash-dotted line. The $r_{max}$ for the saturated field lines is shown as the dashed line (right-hand axis) and the $r_{max}$ for the unstable equilibria are shown as the dotted line. Note that for $0.56<r_0<0.68$ the field lines ``overtake'' i.e. $r_{max}(r^1_0)> r_{max}(r^2_0)$ if $r^1_0<r^2_0$. } \n\\end{figure} \n\nFinally, we have also calculated the nonlinear states in a linearly unstable profile. For a linearly unstable fieldline there are two lower energy flux tube equilibria, one displaced outwards and one inwards.\n\n\\section{\\label{sec:Discussion} Discussion}\n\nThe drag evolution model that we have used to produce the time dependent shape of the flux tube is an approximation to the real non-linear dynamics of the flux tube. However, this model is likely to capture the key features, such as the explosive nature of the evolution which is seen in Fig.~(\\ref{evolve2})). The flux tube has been assumed to have an elliptical shape in this calculation. This is based on the shape of the mildly nonlinear flux tubes \\cite{CCHW, CA, WC} and physical intuition. Specifically the elliptical shape minimizes the stabilizing sideway motion of field lines outside the erupting flux tube.  Overtaking may alter the assumed elliptical flux tube cross section (see Fig. (\\ref{dbeta})). Further work is needed to understand the cross section shape and its evolution.\n\nThe flux tubes have been modelled with a perfectly conducting plasma. This is a reasonable assumption since the eruption is likely to take place on a fast timescale. Once the flux tubes have reached their saturated states then other, slower timescale, processes will become important. For example resistive field line reconnection is likely to occur at large $\\theta$ as it does in resistive ballooning modes \\cite{Strauss}. There is also likely to be cross field transport of heat from the tube to the surrounding plasma around $r_{max}$ given the large gradient of temperature. This would effectively connect the high pressure region to the low pressure region via a conduit (``hosepipe\") along the flux tube -- perhaps causing rapid loss of confinement locally. The balance of the dissipative processes will determine the longer timescale evolution of the flux tube and ultimately how it disconnects from or returns to, its original location.\n\nELMs may be an obvious application of the ideas in this paper. However, the $s-\\alpha$ model developed here may be too geometrically simplistic. We instead note that the explosive eruption of ballooning modes have been observed in TFTR shots with internal transport barriers \\cite{Fredrickson}. A slowly evolving $n=1$ kink mode arises first and then a toroidally localized ballooning mode (with $n\\sim 10-20$) appears. These ballooning modes may eventually disrupt the plasma. We have demonstrated with the model above that flux tubes can erupt connecting plasma inside the transport barrier to outside the transport barrier. This is likely to disrupt the transport barrier and thereby the plasma. A quantitative comparison with data is beyond the scope of this work. There is, clearly, much to understand.              \n\nThis work has received funding from the European Union's Horizon 2020 research and innovation programme, grant 633053, and from the RCUK Energy Programme [grant EP/I501045]. For further information on this paper contact PublicationsManager@ccfe.ac.uk. The views and opinions expressed herein do not necessarily reflect those of the European Commission. H.R. Wilson is a Royal Society Wolfson Research Merit Award holder. \n\n\n\n\\begin{thebibliography}{99}\n\\bibitem{ITERdis}  T.C. Hender, et. al.  Nucl.\\ Fusion, {\\bf 47}, S128 - S202(2007).\n\\bibitem{CHT} J.\\ W.\\ Connor, R.\\ J.\\ Hastie and J.\\ B.\\ Taylor, Proc.\\ R.\\ Soc.\\ London {\\bf A365}  (1979)\n\\bibitem{CTT} J.\\ W.\\ Connor, J.\\ B.\\ Taylor, and M.\\ Turner, Nucl.\\ Fusion {\\bf 24} 642(1984)\n\\bibitem{WCKS} H.\\ R.\\ Wilson, S.\\ C.\\ Cowley, A.\\ Kirk and P.\\ B.\\ Snyder { \\it Plasma Phys. Control. Fusion} {\\bf 48} A71-A84 (2006)  \n\\bibitem{kirk} A.\\ Kirk , et. al., Phys.\\ Rev.\\ Lett. {\\bf 96}  185001 (2006)\n\\bibitem{CA}S. C. Cowley and M. Artun, {\\it Physics Reports,} vol. 283, pp. 185 -- 211, 1997. \n\\bibitem{WC} H.\\ R.\\ Wilson and S.\\ C.\\ Cowley, {\\it Phys. Rev. Lett.},  vol. 92,  no. 17, 175006-1-- 175006-4, 2004.\n\\bibitem{CCHW} S.\\ C.\\ Cowley, B.\\ Cowley, S.\\ A.\\ Henneberg and H.\\ R.\\ Wilson,  Proc. R. Soc. A {\\bf 471}  20140913(2015), \n\\bibitem{CHT2} J.\\ W.\\ Connor, R.\\ J.\\ Hastie and J.\\ B.\\ Taylor, Phys.\\ Rev.\\ Lett. {\\bf 40}  396(1978)\n\\bibitem{CCHHHM} J.\\ W.\\ Connor, et. al., Phys.\\ Fluids. {\\bf 31}  577(1988)\n\\bibitem{GJW} J.\\ M.\\ Greene, J.\\ L.\\ Johnson and K.\\ E.\\ Weimer, Phys.\\ Fluids. {\\bf 14}  671 (1971)\n\\bibitem{CCHW2} S.\\ C.\\ Cowley, B.\\ Cowley, S.\\ A.\\ Henneberg and H.\\ R.\\ Wilson,  arXiv preprint arXiv:1411.7797 (2014), \n\\bibitem{Wolf} R.\\ C.\\ Wolf { \\it Plasma Phys. Control. Fusion} {\\bf 45} R1-R91 (2003)\n\\bibitem{Strauss} H.\\ R.\\ Struass { \\it Phys. Fluids } {\\bf 24} 2004 (1981)\n\\bibitem{Fredrickson} E.\\ D.\\ Fredrickson , et. al. { \\it Phys. Plasmas } {\\bf 3} 2620 (1996)\n\\end{thebibliography}\n\n\n", "itemtype": "equation", "pos": 4306, "prevtext": "\n\n\\preprint{APS/123-QED}\n\n\\title{Stability of Ballooning Flux Tubes in Tokamak Plasmas}\n\n\\author{C.~J.~Ham}\n\\email{Christopher.Ham@ccfe.ac.uk}\n\n\\author{S.~C.~Cowley}\n \\altaffiliation[Also at ]{Department of Physics, Imperial College, Prince Consort Road, London SW7 2BZ UK}\n \\author{G.~Brochard}\n \\altaffiliation[Also at ]{Department of Physics, Imperial College, Prince Consort Road, London SW7 2BZ UK}\n\\affiliation{  CCFE, Culham Science Centre, Abingdon, Oxon.  OX14 3DB, UK.}\n\n\\author{H.~R.~Wilson}\n\\affiliation{\nYork Plasma Institute, Department of Physics, University of York, Heslington, York YO10 5DD UK}\n\n\\date{\\today}\n             \n\n\\begin{abstract}\nTokamak stability to, potentially explosive, ``ballooning\" displacements of elliptical magnetic flux tubes is examined in large aspect ratio equilibrium. Above a critical pressure gradient the energy stored in the plasma may be lowered by finite (but not infinitesimal) displacements of such tubes (metastability). Above a higher pressure gradient, the linear stability boundary, such tubes are linearly and nonlinearly unstable. The flux tube displacement can be of the order of the pressure gradient scale length. Plasma transport from displaced flux tubes may result in rapid loss of confinement.\n\\end{abstract}\n\n\\pacs{Valid PACS appear here}\n                             \n\n                              \n\\maketitle\n\n\\section{\\label{sec:Intro}Introduction}\n\nFast magnetohydrodynamic (MHD) instabilities limit the pressure in magnetically confined fusion plasmas.  The limit is observed to be one of two kinds, either a {\\em soft limit} where the instability limits the pressure to a critical profile or, a {\\em hard limit} where the instability rapidly destroys confinement and releases enough stored energy to take the system well below the critical pressure profile.  Sometimes the instability terminates the discharge entirely \\cite{ITERdis}.  There are also two kinds of MHD instability: large scale {\\em kink} instabilities and small scale, field aligned {\\em ballooning} instabilities \\cite{CHT}.  It is often supposed that ballooning instabilities provide a soft limit, especially near the plasma edge \\cite{CTT}.  Some observations of the pressure profile evolution in the pedestal, a steep pressure gradient region at the edge of some tokamak discharges, are consistent with a soft ballooning limit \\cite{WCKS}.  However {\\em Edge Localised Modes} (ELMs), instabilities of the pedestal, cause an explosive eruption of multiple fine scale flux tubes and a rapid loss of edge confinement \\cite{kirk}. This suggests that ballooning instabilities can sometimes provide a hard limit to edge confinement.\n\nIn this paper we argue that without dissipation the nonlinear consequence of ballooning modes is the eruption of elliptical magnetic flux tubes.  Certainly such erupting tubes are the long time limit of the weakly nonlinear theory developed in \\cite{CA, WC}. The explosive dynamics and meta-stability of such tubes in a one dimensional line tied gravitational equilibria were studied in \\cite{CCHW}.  Here we examine the energetics and final states of erupting flux tubes in a simple large aspect ratio tokamak with nearly circular flux surfaces.  The equilibrium contains a region of steep pressure gradient, a {\\em transport barrier}, where the pressure gradient is of order the critical gradient for linear stability.  We adopt this equilibrium since it yields a simple nonlinear generalization of the $s - \\alpha$ linear ballooning model of \\cite{CHT2} and so illustrates the essential nonlinear dynamics. Nonetheless it is a reasonable model of {\\em internal transport barriers} that are seen in many tokamaks \\cite{Wolf}.  It may also have qualitative relevance to the observed filamentary eruptions in ELMs \\cite{kirk}.   \n\n\\section{\\label{sec:Eqbrm} Equilibrium and equations}\n\nWe represent the tokamak equilibrium in flux coordinates: $\\phi$ the toroidal angle, $r$ a radius like variable that is constant on a magnetic surface and $\\theta$ a poloidal angle chosen to make the field lines ``straight\" -- see \\cite{CCHHHM, GJW}.  Thus we choose $r({\\mbox{\\boldmath{$\\nabla$}}} r\\times{\\mbox{\\boldmath{$\\nabla$}}}\\theta) = R_0 {\\mbox{\\boldmath{$\\nabla$}}}\\phi$ where $R_0$ is the cylindrical radius of the magnetic axis.  Then\n\n", "index": 1, "text": "\\begin{equation}\n{\\bf B}_0  =  - {\\bar B}_0R_0\\{ f(r){\\mbox{\\boldmath{$\\nabla$}}} r\\times{\\mbox{\\boldmath{$\\nabla$}}}{\\cal S}\\},\n\\label{field}\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"{\\bf B}_{0}=-{\\bar{B}}_{0}R_{0}\\{f(r){\\mbox{\\boldmath{$\\nabla$}}}r\\times{\\mbox%&#10;{\\boldmath{$\\nabla$}}}{\\cal S}\\},\" display=\"block\"><mrow><mrow><msub><mi>\ud835\udc01</mi><mn>0</mn></msub><mo>=</mo><mrow><mo>-</mo><mrow><msub><mover accent=\"true\"><mi>B</mi><mo stretchy=\"false\">\u00af</mo></mover><mn>0</mn></msub><mo>\u2062</mo><msub><mi>R</mi><mn>0</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mrow><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo mathvariant=\"bold\">\u2207</mo><mo>\u2061</mo><mi>r</mi></mrow></mrow><mo>\u00d7</mo><mrow><mo mathvariant=\"bold\">\u2207</mo><mo>\u2061</mo><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcae</mi></mrow></mrow><mo stretchy=\"false\">}</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}]