[{"file": "1601.02191.tex", "nexttext": "\nwhere\n\n\\hspace{-1em}\\begin{tabular}{p{.3cm} p{7.9cm}}\n$c_i(\\cdot)$& real-time generation offer function for region $i$;\\\\\n$d_i$&  vector of forecasted load and renewable generation for region $i$;\\\\\n$q$&  net interchange from region $1$ to region $2$, if $q>0$; from region $2$ to region $1$, otherwise;\\\\\n$g_i$&  vector of dispatches for region $i$;\\\\\n$F_i$& vector of transmission limits for region $i$;\\\\\n$Q$& interface limit;\\\\\n$\\mathcal{G}_i$& generator constraints for region $i$;\\\\\n${S}_{ij}$&  shift factor matrix of buses in region $i$ to transmission lines in region $j$;\\\\\n${S}_{qi}$& shift factor vector of buses in region $i$ to the interface;\\\\\n$\\lambda_i$& shadow price for power balance constraint in region $i$;\\\\\n$\\mu_i$& shadow prices for transmission constraints in region $i$;\\\\\n$\\mu_{q}$& shadow price for the net interchange constraint.\n\\end{tabular}\\vspace{.2em}\n\n\n\nThe problem $(P_1)$ is a centralized formulation for determining the optimal interchange between region 1 and 2. Such an optimization problem requires a coordinator who have full access to all related information of both regions which is unsuitable in the present deregulated electricity markets. \n\nAs in \\cite{BaldickChatterjee14COR}, the centralized problem $(P_1)$ can be written in a hierarchical form of decentralized optimization as follows.\n\n", "itemtype": "equation", "pos": 11123, "prevtext": "\n\\title{Stochastic Interchange Scheduling in the Real-Time Electricity Market}\n\n\\author{Yuting Ji, Tongxin Zheng, {\\em Senior Member, IEEE}, and  Lang Tong, {\\em Fellow, IEEE}\\thanks {\\scriptsize This work is supported in part by the DoE CERTS program and the National Science Foundation under Grant CNS-1135844. Part of this work appeared in \\cite{JiTong15PESGM}.\n\nY. Ji and L. Tong are with the School of Electrical and Computer Engineering, Cornell University, Ithaca, NY 14853, USA (e-mail: yj246@cornell.edu; ltong@ece.cornell.edu).\n\nT. Zheng is with ISO New England Inc., Holyoke, MA 01040, USA (e-mail: tzheng@iso-ne.com).}}\n\\maketitle\n\n\\begin{abstract}\nThe problem of multi-area interchange scheduling in the presence of stochastic generation and load is considered.   A new interchange scheduling technique based on a two-stage stochastic minimization of overall expected operating cost is proposed.  Because directly solving the stochastic optimization is intractable, an equivalent problem that maximizes the expected social welfare is formulated. The proposed technique leverages the operator's capability of forecasting locational marginal prices (LMPs) and obtains the optimal interchange schedule without iterations among operators.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\nInter-regional interchange scheduling, multi-area economic dispatch, seams issue.\n\\end{IEEEkeywords}\n\n\\IEEEpeerreviewmaketitle\n\\section{Introduction}\\label{sec:intro}\nSince the restructuring of the electric power industry, independent system operators (ISOs) and regional transmission organizations (RTOs) have faced the seams issue characterized by  the inefficient transfer of power between neighboring regions.  Such inefficiency is caused  by incompatible market designs of independently controlled operating regions, inconsistencies of their scheduling protocols, and their different pricing models. The economic loss due to seams for the New York and New England customers is estimated at the level of \\$784 million annually \\cite{IRIS}.\n\nThere has been recent effort in addressing the seams issue by optimizing interchange flows across different regions.  In particular, a new interchange scheduling technique, referred to as Tie Optimization (TO),  is proposed in \\cite{IRIS} to minimize the overall operating cost.  The Federal Energy Regulatory Commission (FERC)\nhas recently approved the Coordinated Transaction Scheduling (CTS) that allows market participants' participation in TO.  Implementations of various versions of CTS are being carried out by several system operators in the US \\cite{ferc_app12}\\cite{ferc_app14}.\n\nOne of the main challenges in eliminating seams is the inherent delay between the interchange scheduling and the actual power delivery across regions.  This is caused by the lack of real-time information necessary for scheduling and operation constraints.   For example, the information used in CTS for interchange scheduling is 75 minutes prior to the actual power delivery. With increasing integration of renewables,  interchange scheduling needs to be cognizant of uncertainty that arises between the time of interchange scheduling and that of power transfer. \n\nThe goal of this paper is to obtain the optimal interchange schedule in the presence of system and operation uncertainty. To this end, we propose a two-stage stochastic optimization formulation aimed at minimizing the expected overall system cost.  The proposed optimization framework takes into account random fluctuations of load and renewable generations in the systems. Because directly solving the stochastic optimization is intractable, this paper presents an approach to transfer the stochastic optimization problem into an equivalent deterministic problem that maximizes the expected economic surplus. This transformation allows us to generalize the deterministic TO solution by intersecting expected demand and supply functions, therefore avoiding costly iterative computation between operators. \n\n\n\\subsection{Related Work}\nThere have been extensive studies on the seams issue. In this paper, we do not consider inefficiencies arise from market designs; we focus instead on optimizing the interchange schedule.    We highlight below approaches most relevant to the technique developed here.  For broadly related work, see \\cite{IRIS,ConejoEtal06Springer_Decomposition, ZhaoLitvinovZheng14TPS,BaldickChatterjee14COR,LiEtal15TPS,ChenThorpMount04HICSS, IlicLang12} and  references therein.\n\nMathematically, optimal interchange scheduling can be obtained from the multi-area Optimal Power Flow (OPF) problem, which is a decentralized optimization of power flow that can be solved using various decomposition techniques \\cite{ConejoEtal06Springer_Decomposition}. A general approach is based on the principle of Lagrangian Relaxation (LR) that decomposes the original problem into smaller subproblems. Some of the earliest approaches include the pioneer work of Kim and Baldick \\cite{KimBaldick97TPS} and Conejo and Aguado \\cite{ConejoAguado98TPS_MOPF} that predate the broad deregulation of the electricity market in the US.  Multi-area OPF problems that explicitly involve multiple ISOs have been widely studied \\cite{CadwaladerHarveyPopeHogan98}\\cite{ChenThorpMount04HICSS}.  In general, decentralized OPF based techniques typically require iterations between ISOs where one control center uses intermediate solutions from the other and solves its own dispatch problem.   Although the convergence of such techniques is often guaranteed under the DC-OPF formulation, the number of iterations can be large and the practical cost of communications and computations substantial.  We note that the recent marginal decomposition technique \\cite{ZhaoLitvinovZheng14TPS} is shown to converge in a finite (but unknown) number of iterations.  \n\nThe growth of renewable integration has brought new attention to uncertainty in seams. Both stochastic optimization and robust optimization approaches have been considered recently.  In particular, Ahmadi-Khatir, Conejo, and Cherkaoui formulate a two-stage stochastic market clearing model in \\cite{AhmadiConejoCherkaoui13TPS} for the multi-area energy and reserve dispatch problem.  The solution to the stochastic optimization is obtained based on scenario enumerations, which requires a prohibitively high computation effort.  In \\cite{LiEtal15TPS}, the day-ahead tie-flow scheduling is considered in the unit commitment problem under wind generation uncertainty. Specifically, a two-stage adaptive robust optimization problem is formulated with the goal of minimizing the cost of the worst-case wind scenario, and solved by the column-and-constraint generation algorithm. The present paper complements these existing results by focusing on the  real-time interchange scheduling and develop a tractable stochastic optimization technique.\n\nA pragmatic approach to the seams problem, one that has been adopted in practice and that can incorporate external market participants, is the use of proxy buses representing the interface between neighboring regions.  The technique presented here falls into this category.  Among existing prior work is the work by Chen et. al. \\cite{ChenThorpMount04HICSS} where a coordinated interchange scheduling scheme is proposed for the co-optimization of energy and ancillary services. The technique is based on (augmented) LR involving iterations among neighboring control centers.  The work closest to ours are the TO technique presented in \\cite{IRIS} and the work of Ilic and Lang \\cite{IlicLang12}.  The underlying principle of \\cite{IRIS} and \\cite{IlicLang12} is based on the economics argument of supply and demand functions, which are exchanged by the neighboring operators.   For the (scalar) net interchange, such functions can be succinctly characterized, and the exchange needs to be made only once; the need of iterations among control centers is eliminated.  Our approach is also based on the same economics argument with the innovation on incorporating system and operation uncertainty.  Note that this type of approaches do not solve the multi-area OPF problem except the special case when there is a single tie line connecting the two operating regions. \n\n \n\\section{Deterministic Interchange Scheduling}\\label{sec:iris}\n\\subsection{Proxy Bus Representation}\nIn practice, coordination between neighboring control regions and markets are typically through the use of proxy bus mechanism.  As pointed out in \\cite{Harvey03Proxy}, a proxy bus models the location at which marginal changes in generation are assumed to occur in response to changes in inter-regional transactions. The proxy bus mechanism is utilized by all of the existing LMP based markets for representing and valuing interchange power \\cite{Harvey03Proxy}. \n\nIn this paper, we consider a power system consisting of two independently operated subsystems, as illustrated in Figure \\ref{fig:sys1}.  Each operator selects a proxy bus to represent the location of import or export in the neighboring region. Specifically, as shown in Figure \\ref{fig:proxy}, the operator from region 1 assumes a withdrawal $q$ at proxy bus $p_1$ and the operator from region 2 assumes an injection with the same quantity $q$ at proxy bus $p_2$. \n\n\n\\begin{figure}\\centering\n\\includegraphics[scale=0.42]{2regsys.eps}\n\\caption{A 2-region system with an interface.}\\vspace{-1em} \\label{fig:sys1}\\end{figure}\n\\begin{figure}\\centering\\begin{psfrags}\n\\psfrag{t}[l]{\\footnotesize {$q$}}\n\\psfrag{p}[c]{\\scriptsize $p_1$}\n\\psfrag{q}[c]{\\scriptsize $p_2$}\n\\includegraphics[scale=0.42]{2regsys_proxy.eps}\n\\end{psfrags}\\caption{The single proxy bus representation.}\\vspace{-1em} \\label{fig:proxy}\\end{figure}\n\n\nThe interchange scheduling is to determine the value of the net interchange\\footnote{The net interchange between two neighboring regions is the total amount of power flowing from one operating region to another.} $q$ that minimizes the overall operating cost subject to generation and transmission constraints. Note that, except when there is a single tie line that connects  two regions,  the proxy representation is an approximation, and the optimal interchange scheduling based on the proxy representation does not provide the optimal interchange of the original system.  In general, the optimal interchange via proxy representation is strictly suboptimal when it is compared with multi-area OPF solutions.\n\n\\subsection{Optimal Interchange Scheduling}\nThe interchange scheduling problem under the proxy bus model can be formulated as minimizing the generation costs of both regions with respect to the power balance, transmission (internal and interface) and generator constraints. For simplicity, we make the following assumptions throughout the paper: (i) the system is lossless, and (ii) the cost function $c_i(\\cdot), i\\in\\{1,2\\}$, is quadratic in the form $c_i(\\cdot)=g_i^\\intercal H_i g_i +q_i g_i$ where matrix $H_i$ is positive definite. Under the single proxy bus system, the net interchange can be modeled explicitly as an additional scalar variable in the optimization problem as follows:\n\n\n", "index": 1, "text": "\\begin{equation*}\\label{problem:min_cost}\n\\setlength\\arraycolsep{2pt}\\begin{array}{r l l}\n(P_1)\\quad \\underset{q,g_1,g_2}\\min &c_1(g_1)+c_2(g_2)&\\\\\n\\text{subject to} &\\mathbf{1}^\\intercal (d_1-g_1)+ q=0, & (\\lambda_1)\\\\\n&\\mathbf{1}^\\intercal (d_2-g_2)-q=0, & (\\lambda_2)\\\\\n&S_{1}(d_1-g_1)+S_{q1} q \\leq F_1, &(\\mu_1)\\\\\n&S_{2}(d_2-g_2)-S_{q2} q \\leq F_2, &(\\mu_2)\\\\\n&q \\leq Q, & (\\mu_{q})\\\\\n&g_1\\in \\mathcal{G}_1,&\\\\\n&g_2 \\in \\mathcal{G}_2,&\n\\end{array}\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{r l l}(P_{1})\\quad\\underset{q,g_{1},g_{2}}{\\min}&amp;c_{1}(g_{1})+%&#10;c_{2}(g_{2})&amp;\\\\&#10;\\text{subject to}&amp;\\mathbf{1}^{\\intercal}(d_{1}-g_{1})+q=0,&amp;(\\lambda_{1})\\\\&#10;&amp;\\mathbf{1}^{\\intercal}(d_{2}-g_{2})-q=0,&amp;(\\lambda_{2})\\\\&#10;&amp;S_{1}(d_{1}-g_{1})+S_{q1}q\\leq F_{1},&amp;(\\mu_{1})\\\\&#10;&amp;S_{2}(d_{2}-g_{2})-S_{q2}q\\leq F_{2},&amp;(\\mu_{2})\\\\&#10;&amp;q\\leq Q,&amp;(\\mu_{q})\\\\&#10;&amp;g_{1}\\in\\mathcal{G}_{1},&amp;\\\\&#10;&amp;g_{2}\\in\\mathcal{G}_{2},&amp;\\end{array}\" display=\"block\"><mtable columnspacing=\"2.0pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"right\"><mrow><mrow><mo stretchy=\"false\">(</mo><msub><mi>P</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003</mo><munder accentunder=\"true\"><mi>min</mi><mrow><mi>q</mi><mo>,</mo><msub><mi>g</mi><mn>1</mn></msub><mo>,</mo><msub><mi>g</mi><mn>2</mn></msub></mrow></munder></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><msub><mi>c</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>g</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><msub><mi>c</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>g</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mtd><mtd/></mtr><mtr><mtd columnalign=\"right\"><mtext>subject to</mtext></mtd><mtd columnalign=\"left\"><mrow><mrow><mrow><mrow><msup><mn>\ud835\udfcf</mn><mo>\u22ba</mo></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>d</mi><mn>1</mn></msub><mo>-</mo><msub><mi>g</mi><mn>1</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mi>q</mi></mrow><mo>=</mo><mn>0</mn></mrow><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03bb</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mrow><mrow><mrow><msup><mn>\ud835\udfcf</mn><mo>\u22ba</mo></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>d</mi><mn>2</mn></msub><mo>-</mo><msub><mi>g</mi><mn>2</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mi>q</mi></mrow><mo>=</mo><mn>0</mn></mrow><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03bb</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mrow><mrow><mrow><msub><mi>S</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>d</mi><mn>1</mn></msub><mo>-</mo><msub><mi>g</mi><mn>1</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><msub><mi>S</mi><mrow><mi>q</mi><mo>\u2062</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mi>q</mi></mrow></mrow><mo>\u2264</mo><msub><mi>F</mi><mn>1</mn></msub></mrow><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03bc</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mrow><mrow><mrow><msub><mi>S</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>d</mi><mn>2</mn></msub><mo>-</mo><msub><mi>g</mi><mn>2</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><msub><mi>S</mi><mrow><mi>q</mi><mo>\u2062</mo><mn>2</mn></mrow></msub><mo>\u2062</mo><mi>q</mi></mrow></mrow><mo>\u2264</mo><msub><mi>F</mi><mn>2</mn></msub></mrow><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03bc</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mrow><mi>q</mi><mo>\u2264</mo><mi>Q</mi></mrow><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03bc</mi><mi>q</mi></msub><mo stretchy=\"false\">)</mo></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mrow><msub><mi>g</mi><mn>1</mn></msub><mo>\u2208</mo><msub><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca2</mi><mn>1</mn></msub></mrow><mo>,</mo></mrow></mtd><mtd/></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mrow><msub><mi>g</mi><mn>2</mn></msub><mo>\u2208</mo><msub><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca2</mi><mn>2</mn></msub></mrow><mo>,</mo></mrow></mtd><mtd/></mtr></mtable></math>", "type": "latex"}, {"file": "1601.02191.tex", "nexttext": "\nwhere $g^*_i(q)$, $i\\in\\{1,2\\}$, is the optimal dispatch for region $i$, given the interchange level $q$.\n\nThe regional dispatch problem for region $1$ is specified as\n\n", "itemtype": "equation", "pos": 12930, "prevtext": "\nwhere\n\n\\hspace{-1em}\\begin{tabular}{p{.3cm} p{7.9cm}}\n$c_i(\\cdot)$& real-time generation offer function for region $i$;\\\\\n$d_i$&  vector of forecasted load and renewable generation for region $i$;\\\\\n$q$&  net interchange from region $1$ to region $2$, if $q>0$; from region $2$ to region $1$, otherwise;\\\\\n$g_i$&  vector of dispatches for region $i$;\\\\\n$F_i$& vector of transmission limits for region $i$;\\\\\n$Q$& interface limit;\\\\\n$\\mathcal{G}_i$& generator constraints for region $i$;\\\\\n${S}_{ij}$&  shift factor matrix of buses in region $i$ to transmission lines in region $j$;\\\\\n${S}_{qi}$& shift factor vector of buses in region $i$ to the interface;\\\\\n$\\lambda_i$& shadow price for power balance constraint in region $i$;\\\\\n$\\mu_i$& shadow prices for transmission constraints in region $i$;\\\\\n$\\mu_{q}$& shadow price for the net interchange constraint.\n\\end{tabular}\\vspace{.2em}\n\n\n\nThe problem $(P_1)$ is a centralized formulation for determining the optimal interchange between region 1 and 2. Such an optimization problem requires a coordinator who have full access to all related information of both regions which is unsuitable in the present deregulated electricity markets. \n\nAs in \\cite{BaldickChatterjee14COR}, the centralized problem $(P_1)$ can be written in a hierarchical form of decentralized optimization as follows.\n\n", "index": 3, "text": "\\begin{equation*}\\label{problem:min_cost_m}\n\\setlength\\arraycolsep{2pt}\\begin{array}{r l l}\n(P_2)\\quad\\underset{q}\\min &c_1(g^*_1(q))+c_2(g_2^*(q))&\\\\\n\\text{subject to} &q \\leq Q, & (\\mu_{q})\n\\end{array}\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{r l l}(P_{2})\\quad\\underset{q}{\\min}&amp;c_{1}(g^{*}_{1}(q))+c_{2}%&#10;(g_{2}^{*}(q))&amp;\\\\&#10;\\text{subject to}&amp;q\\leq Q,&amp;(\\mu_{q})\\end{array}\" display=\"block\"><mtable columnspacing=\"2.0pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"right\"><mrow><mrow><mo stretchy=\"false\">(</mo><msub><mi>P</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003</mo><munder accentunder=\"true\"><mi>min</mi><mo>\ud835\udc5e</mo></munder></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><msub><mi>c</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msubsup><mi>g</mi><mn>1</mn><mo>*</mo></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>q</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><msub><mi>c</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msubsup><mi>g</mi><mn>2</mn><mo>*</mo></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>q</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mtd><mtd/></mtr><mtr><mtd columnalign=\"right\"><mtext>subject to</mtext></mtd><mtd columnalign=\"left\"><mrow><mrow><mi>q</mi><mo>\u2264</mo><mi>Q</mi></mrow><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03bc</mi><mi>q</mi></msub><mo stretchy=\"false\">)</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.02191.tex", "nexttext": "\nand for region $2$ as\n\n", "itemtype": "equation", "pos": 13318, "prevtext": "\nwhere $g^*_i(q)$, $i\\in\\{1,2\\}$, is the optimal dispatch for region $i$, given the interchange level $q$.\n\nThe regional dispatch problem for region $1$ is specified as\n\n", "index": 5, "text": "\\begin{equation*}\\label{problem:min_cost_a}\n\\setlength\\arraycolsep{2pt}\\begin{array}{r l l}\n(P_{21})\\quad \\underset{g_1\\in\\mathcal{G}_1}\\min &c_1(g_1)&\\\\\n\\text{subject to} &\\mathbf{1}^\\intercal (d_1-g_1)+q=0, & (\\lambda_1)\\\\\n&S_{1}(d_1-g_1)+S_{q1} q \\leq F_1, &(\\mu_1)\\\\\n\\end{array}\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{r l l}(P_{21})\\quad\\underset{g_{1}\\in\\mathcal{G}_{1}}{\\min}&amp;c_%&#10;{1}(g_{1})&amp;\\\\&#10;\\text{subject to}&amp;\\mathbf{1}^{\\intercal}(d_{1}-g_{1})+q=0,&amp;(\\lambda_{1})\\\\&#10;&amp;S_{1}(d_{1}-g_{1})+S_{q1}q\\leq F_{1},&amp;(\\mu_{1})\\\\&#10;\\end{array}\" display=\"block\"><mtable columnspacing=\"2.0pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"right\"><mrow><mrow><mo stretchy=\"false\">(</mo><msub><mi>P</mi><mn>21</mn></msub><mo stretchy=\"false\">)</mo></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003</mo><munder accentunder=\"true\"><mi>min</mi><mrow><msub><mi>g</mi><mn>1</mn></msub><mo>\u2208</mo><msub><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca2</mi><mn>1</mn></msub></mrow></munder></mrow></mtd><mtd columnalign=\"left\"><mrow><msub><mi>c</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>g</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd/></mtr><mtr><mtd columnalign=\"right\"><mtext>subject to</mtext></mtd><mtd columnalign=\"left\"><mrow><mrow><mrow><mrow><msup><mn>\ud835\udfcf</mn><mo>\u22ba</mo></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>d</mi><mn>1</mn></msub><mo>-</mo><msub><mi>g</mi><mn>1</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mi>q</mi></mrow><mo>=</mo><mn>0</mn></mrow><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03bb</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mrow><mrow><mrow><msub><mi>S</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>d</mi><mn>1</mn></msub><mo>-</mo><msub><mi>g</mi><mn>1</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><msub><mi>S</mi><mrow><mi>q</mi><mo>\u2062</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mi>q</mi></mrow></mrow><mo>\u2264</mo><msub><mi>F</mi><mn>1</mn></msub></mrow><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03bc</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.02191.tex", "nexttext": "\n\nNote that the optimization problem involves an outer problem $(P_2)$ to optimize the interchange level $q$, and an inner problem that is naturally decomposed into two regional problems, both parameterized by $q$. In other words, the optimizer and the associated Lagrangian multipliers for $(P_{21})$ and $(P_{22})$ are functions of $q$, \\textit{i.e.}, $g^*_i(q)$, $\\lambda^*_i(q)$, $\\mu^*_i(q)$, $i \\in \\{1, 2\\}$.  \n\n\n\\subsection{Tie Optimization}\nThe key idea of TO is to determine the interchange schedule by intersecting the demand and supply curves. By interchange demand/supply curve we mean the incremental cost of the regional dispatch at the interface, which is essentially the LMP at the proxy bus. Given the interchange level $q$, the LMP at the proxy bus for region $i\\in \\{1, 2\\}$ is defined as\n\n", "itemtype": "equation", "pos": 13639, "prevtext": "\nand for region $2$ as\n\n", "index": 7, "text": "\\begin{equation*}\\label{problem:min_cost_b}\n\\setlength\\arraycolsep{2pt}\\begin{array}{r l l}\n(P_{22})\\quad \\underset{g_2\\in\\mathcal{G}_2}\\min &c_2(g_2)&\\\\\n\\text{subject to} &\\mathbf{1}^\\intercal (d_2-g_2)- q=0, & (\\lambda_2)\\\\\n&S_{2}(d_2-g_2)-S_{q2} q \\leq F_2. &(\\mu_2)\\\\\n\\end{array}\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{r l l}(P_{22})\\quad\\underset{g_{2}\\in\\mathcal{G}_{2}}{\\min}&amp;c_%&#10;{2}(g_{2})&amp;\\\\&#10;\\text{subject to}&amp;\\mathbf{1}^{\\intercal}(d_{2}-g_{2})-q=0,&amp;(\\lambda_{2})\\\\&#10;&amp;S_{2}(d_{2}-g_{2})-S_{q2}q\\leq F_{2}.&amp;(\\mu_{2})\\\\&#10;\\end{array}\" display=\"block\"><mtable columnspacing=\"2.0pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"right\"><mrow><mrow><mo stretchy=\"false\">(</mo><msub><mi>P</mi><mn>22</mn></msub><mo stretchy=\"false\">)</mo></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003</mo><munder accentunder=\"true\"><mi>min</mi><mrow><msub><mi>g</mi><mn>2</mn></msub><mo>\u2208</mo><msub><mi class=\"ltx_font_mathcaligraphic\">\ud835\udca2</mi><mn>2</mn></msub></mrow></munder></mrow></mtd><mtd columnalign=\"left\"><mrow><msub><mi>c</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>g</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mtd><mtd/></mtr><mtr><mtd columnalign=\"right\"><mtext>subject to</mtext></mtd><mtd columnalign=\"left\"><mrow><mrow><mrow><mrow><msup><mn>\ud835\udfcf</mn><mo>\u22ba</mo></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>d</mi><mn>2</mn></msub><mo>-</mo><msub><mi>g</mi><mn>2</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mi>q</mi></mrow><mo>=</mo><mn>0</mn></mrow><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03bb</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mrow><mrow><mrow><msub><mi>S</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>d</mi><mn>2</mn></msub><mo>-</mo><msub><mi>g</mi><mn>2</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><msub><mi>S</mi><mrow><mi>q</mi><mo>\u2062</mo><mn>2</mn></mrow></msub><mo>\u2062</mo><mi>q</mi></mrow></mrow><mo>\u2264</mo><msub><mi>F</mi><mn>2</mn></msub></mrow><mo>.</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03bc</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.02191.tex", "nexttext": "\nwhere $\\lambda^*_i(q)$ and  $\\mu^*_i(q)$ are the Lagrangian multipliers associated with the optimal solution of $(P_{2i})$, for $i \\in \\{1, 2\\}$. Note that function $\\pi_i(q)$ is ISO $i$'s incremental dispatch cost at the interface at the net interchange $q$, which serves as a supply curve for the exporting ISO or a demand curve for the importing ISO. \n\n\\begin{figure}\\centering\n\\begin{psfrags}\n\\psfrag{Sa}[l]{\\scriptsize $\\pi_2(q)$}\n\\psfrag{Sb}[l]{\\scriptsize $\\pi_1(q)$}\n\\psfrag{p}[r]{\\scriptsize $\\pi^*$}\n\\psfrag{A}[c]{}\n\\psfrag{B}[c]{}\n\\psfrag{Price}[c]{\\scriptsize $\\pi$}\n\\psfrag{flow}[l]{\\scriptsize $q$}\n\\psfrag{lim}[l]{\\scriptsize $Q$}\n\\psfrag{f}[l]{\\scriptsize {${q_\\text{TO}^*}$}}\n\\includegraphics[width=.3\\textwidth]{to.eps}\n\\end{psfrags}\\caption{Illustration of TO.}\\vspace{-1em}\\label{fig:to}\\end{figure}\n\nWe use the graphical representation in \\cite{IRIS} to illustrate the basic principle of TO. As shown in Figure \\ref{fig:to}, $\\pi_i(q)$ represents the generation supply curve for region $i$, but $\\pi_2(q)$ is drawn in a descending cost order.  In this example, the direction of interface flow\\footnote{The direction of interface flow can be determined by comparing the prices at $q=0$: if $\\pi_1(0)<\\pi_2(0)$, the power flows from region 1 to 2; otherwise, the direction of interface flow is opposite. } is from region 1 to region 2; $\\pi_1(q)$ and $\\pi_2(q)$ serve as the supply and demand curve respectively. The optimal  schedule $q_\\text{TO}^*$ is set at the intersection of the two curves. Note that if this quantity exceeds the interface capacity $Q$, the schedule should be set at the maximum capacity instead. The interface transmission constraint, in this case, becomes binding and price separation happens between markets. It should also be noted that import or export transactions are settled at the {\\em real-time LMP} which is calculated at the proxy bus after the delivery.\n\nAccording to \\cite{IRIS}, the interchange schedule of TO is the optimal solution to $(P_1)$ (as well as $(P_2)$). This intuitive argument is a manifestation of a deeper connection between social welfare optimization illustrated in Figure \\ref{fig:to} and cost minimization defined by $(P_1)$.  In what follows, we will exploit this connection in the presence of uncertainty. \n\\section{A Stochastic Interchange Scheduling}\\label{sec:siris}\nSo far, we have described the interchange scheduling in a deterministic system setting. We now focus on the incorporation of random load and generation in the scheduling scheme.\n\\subsection{Stochastic Programming Formulation}\nStochastic optimization is the most common framework to model optimization problems involving uncertainty.  Consider the case that load (or stochastic generation, treated as a negative load) is random. The inter-regional interchange scheduling can be formulated as a two-stage stochastic optimization problem. The first stage involves optimizing the net interchange to minimize the expected overall cost\n\n", "itemtype": "equation", "pos": 14747, "prevtext": "\n\nNote that the optimization problem involves an outer problem $(P_2)$ to optimize the interchange level $q$, and an inner problem that is naturally decomposed into two regional problems, both parameterized by $q$. In other words, the optimizer and the associated Lagrangian multipliers for $(P_{21})$ and $(P_{22})$ are functions of $q$, \\textit{i.e.}, $g^*_i(q)$, $\\lambda^*_i(q)$, $\\mu^*_i(q)$, $i \\in \\{1, 2\\}$.  \n\n\n\\subsection{Tie Optimization}\nThe key idea of TO is to determine the interchange schedule by intersecting the demand and supply curves. By interchange demand/supply curve we mean the incremental cost of the regional dispatch at the interface, which is essentially the LMP at the proxy bus. Given the interchange level $q$, the LMP at the proxy bus for region $i\\in \\{1, 2\\}$ is defined as\n\n", "index": 9, "text": "\\begin{equation}\\label{def:pi}\n\\pi_i(q)=\\lambda^*_i(q)+{S}_{qi}^\\intercal \\mu^*_i(q),\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"\\pi_{i}(q)=\\lambda^{*}_{i}(q)+{S}_{qi}^{\\intercal}\\mu^{*}_{i}(q),\" display=\"block\"><mrow><mrow><mrow><msub><mi>\u03c0</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>q</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msubsup><mi>\u03bb</mi><mi>i</mi><mo>*</mo></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>q</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><msubsup><mi>S</mi><mrow><mi>q</mi><mo>\u2062</mo><mi>i</mi></mrow><mo>\u22ba</mo></msubsup><mo>\u2062</mo><msubsup><mi>\u03bc</mi><mi>i</mi><mo>*</mo></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>q</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02191.tex", "nexttext": "\nand the second stage solves the regional optimal dispatch problem given the interchange level $q$ and the realization of random load $d_1$ and $d_2$, which are specified as $(P_{21})$ and $(P_{22})$. Note that the optimal dispatch and the associated Lagrangian multipliers of $(P_{2i})$ are parameterized by two factors: the interchange level $q$ and the load realization $d_i$. So the LMP $\\pi_i(q, d_i)$ at the proxy bus is a function of both $q$ and $d_i$.\n\nDirectly solving this problem requires the distribution of the regional cost function $c_i(q,d_i)$ at each interchange level, and  a coordinator to determine the optimal schedule, neither of which is achievable in the present deregulated electricity markets. In general, this two-stage stochastic optimization problem is intractable, especially when the load and renewable generation forecast follows a continuous distribution. The proposed scheduling technique, on the other hand, can solve this problem without increasing the computation complexity of deterministic TO. Details are provided in the next two subsections.\n\n\\subsection{Social Welfare Optimization}\nThe main idea of solving $(P_4)$ is to exploit the connection between cost minimization and social welfare optimization under uncertainty.  With the randomness present in the second stage of $(P_4)$, it is not obvious how the two-stage optimization problem can be transformed into a corresponding form of social welfare optimization.  It turns out that the optimal solution can be obtained by solving a deterministic TO problem using the {\\em expected} demand and supply functions.  \n\n\nWe now present an optimization problem from the import-export perspective, but taking into account that both import and export regions must agree on the forward interchange quantity in the presence of future demand and supply uncertainty.  Because the interchange quantity is fixed ahead of the actual power delivery, each region may have to rely on its internal resources to compensate uncertainty in real time.  To this end, it is reasonable for the export region to maximize its {\\em expected producer surplus} and the import region to maximize its {\\em expected consumer surplus}. \n\n\\begin{figure}\\centering\n\\begin{psfrags}\n\\psfrag{Sa}[l]{\\scriptsize $\\mathbb{E}_{d_2}[\\pi_2(q,d_2)]$}\n\\psfrag{Sb}[l]{\\scriptsize $\\mathbb{E}_{d_1}[\\pi_1(q,d_1)]$}\n\\psfrag{p}[r]{\\scriptsize $\\pi^*$}\n\\psfrag{Price}[c]{\\scriptsize $\\pi$}\n\\psfrag{flow}[l]{\\scriptsize $q$}\n\\psfrag{lim}[l]{\\scriptsize $Q$}\n\\psfrag{f}[l]{\\scriptsize {${q_\\text{STO}^*}$}}\n\\psfrag{A}[l]{}\n\\psfrag{B}[r]{}\n\\psfrag{S}[l]{}\n\\psfrag{SS}[c]{\\scriptsize Producer surplus}\n\\psfrag{C}[c]{\\scriptsize Consumer surplus}\n\\includegraphics[width=.3\\textwidth]{sto.eps}\n\\end{psfrags}\\caption{Illustration of STO.}\\vspace{-1em}\\label{fig:sto}\\end{figure}\n\nWithout loss of generality, let region 1 be the exporter.  For fixed interchange $q$, let $\\pi_i(q,d_i)$ be the (random)  LMP at the proxy bus.  Then $\\mathbb{E}_{d_1}[\\pi_1(q,d_1)]$, as a function of interchange $q$,  is the expected supply curve averaged over its internal randomness.  Similarly, $\\mathbb{E}_{d_2}[\\pi_2(q,d_2)]$ is the expected demand curve averaged over the internal randomness in region 2 at the time of delivery.  \n\nAs shown in Figure \\ref{fig:sto}, the optimal interchange quantity $q_\\text{STO}^*$ that maximizes the expected social welfare (in absence of interface constraint) is simply the intersection of the expected demand and supply curves. In general, the interchange that maximizes the expected social welfare is given by\n\n\n", "itemtype": "equation", "pos": 17827, "prevtext": "\nwhere $\\lambda^*_i(q)$ and  $\\mu^*_i(q)$ are the Lagrangian multipliers associated with the optimal solution of $(P_{2i})$, for $i \\in \\{1, 2\\}$. Note that function $\\pi_i(q)$ is ISO $i$'s incremental dispatch cost at the interface at the net interchange $q$, which serves as a supply curve for the exporting ISO or a demand curve for the importing ISO. \n\n\\begin{figure}\\centering\n\\begin{psfrags}\n\\psfrag{Sa}[l]{\\scriptsize $\\pi_2(q)$}\n\\psfrag{Sb}[l]{\\scriptsize $\\pi_1(q)$}\n\\psfrag{p}[r]{\\scriptsize $\\pi^*$}\n\\psfrag{A}[c]{}\n\\psfrag{B}[c]{}\n\\psfrag{Price}[c]{\\scriptsize $\\pi$}\n\\psfrag{flow}[l]{\\scriptsize $q$}\n\\psfrag{lim}[l]{\\scriptsize $Q$}\n\\psfrag{f}[l]{\\scriptsize {${q_\\text{TO}^*}$}}\n\\includegraphics[width=.3\\textwidth]{to.eps}\n\\end{psfrags}\\caption{Illustration of TO.}\\vspace{-1em}\\label{fig:to}\\end{figure}\n\nWe use the graphical representation in \\cite{IRIS} to illustrate the basic principle of TO. As shown in Figure \\ref{fig:to}, $\\pi_i(q)$ represents the generation supply curve for region $i$, but $\\pi_2(q)$ is drawn in a descending cost order.  In this example, the direction of interface flow\\footnote{The direction of interface flow can be determined by comparing the prices at $q=0$: if $\\pi_1(0)<\\pi_2(0)$, the power flows from region 1 to 2; otherwise, the direction of interface flow is opposite. } is from region 1 to region 2; $\\pi_1(q)$ and $\\pi_2(q)$ serve as the supply and demand curve respectively. The optimal  schedule $q_\\text{TO}^*$ is set at the intersection of the two curves. Note that if this quantity exceeds the interface capacity $Q$, the schedule should be set at the maximum capacity instead. The interface transmission constraint, in this case, becomes binding and price separation happens between markets. It should also be noted that import or export transactions are settled at the {\\em real-time LMP} which is calculated at the proxy bus after the delivery.\n\nAccording to \\cite{IRIS}, the interchange schedule of TO is the optimal solution to $(P_1)$ (as well as $(P_2)$). This intuitive argument is a manifestation of a deeper connection between social welfare optimization illustrated in Figure \\ref{fig:to} and cost minimization defined by $(P_1)$.  In what follows, we will exploit this connection in the presence of uncertainty. \n\\section{A Stochastic Interchange Scheduling}\\label{sec:siris}\nSo far, we have described the interchange scheduling in a deterministic system setting. We now focus on the incorporation of random load and generation in the scheduling scheme.\n\\subsection{Stochastic Programming Formulation}\nStochastic optimization is the most common framework to model optimization problems involving uncertainty.  Consider the case that load (or stochastic generation, treated as a negative load) is random. The inter-regional interchange scheduling can be formulated as a two-stage stochastic optimization problem. The first stage involves optimizing the net interchange to minimize the expected overall cost\n\n", "index": 11, "text": "\\begin{equation*}\\label{problem:min_cost_m2}\n\\setlength\\arraycolsep{2pt}\\begin{array}{r l l}\n(P_4)\\quad\\underset{q}\\min &\\mathbb{E}_{d_1, d_2}\\left[c_1(g^*_1(q,d_1))+c_2(g_2^*(q,d_2))\\right]&\\\\\n\\text{subject to} &q \\leq Q, & (\\mu_{q})\n\\end{array}\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{r l l}(P_{4})\\quad\\underset{q}{\\min}&amp;\\mathbb{E}_{d_{1},d_{2}}%&#10;\\left[c_{1}(g^{*}_{1}(q,d_{1}))+c_{2}(g_{2}^{*}(q,d_{2}))\\right]&amp;\\\\&#10;\\text{subject to}&amp;q\\leq Q,&amp;(\\mu_{q})\\end{array}\" display=\"block\"><mtable columnspacing=\"2.0pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"right\"><mrow><mrow><mo stretchy=\"false\">(</mo><msub><mi>P</mi><mn>4</mn></msub><mo stretchy=\"false\">)</mo></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003</mo><munder accentunder=\"true\"><mi>min</mi><mo>\ud835\udc5e</mo></munder></mrow></mtd><mtd columnalign=\"left\"><mrow><msub><mi>\ud835\udd3c</mi><mrow><msub><mi>d</mi><mn>1</mn></msub><mo>,</mo><msub><mi>d</mi><mn>2</mn></msub></mrow></msub><mo>\u2062</mo><mrow><mo>[</mo><mrow><mrow><msub><mi>c</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msubsup><mi>g</mi><mn>1</mn><mo>*</mo></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>q</mi><mo>,</mo><msub><mi>d</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><msub><mi>c</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msubsup><mi>g</mi><mn>2</mn><mo>*</mo></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>q</mi><mo>,</mo><msub><mi>d</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>]</mo></mrow></mrow></mtd><mtd/></mtr><mtr><mtd columnalign=\"right\"><mtext>subject to</mtext></mtd><mtd columnalign=\"left\"><mrow><mrow><mi>q</mi><mo>\u2264</mo><mi>Q</mi></mrow><mo>,</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03bc</mi><mi>q</mi></msub><mo stretchy=\"false\">)</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.02191.tex", "nexttext": "\n\n\nTo solve $(P_5)$, each operator needs to compute, for each interchange quantity $q$,  the expected LMP at its own proxy bus.   Such a computation requires the conditional expectation of future LMP at the time of delivery.  The conditional expectation can be obtained through probabilistic LMP forecast using models for load and generation. See, for example, \\cite{JiTongThomas15ARXIV}. It is also conceivable that the conditional expectations can also be approximated via regression analysis.  Once the expected demand and supply functions are obtained, solving for the optimal interchange quantity becomes a one-dimensional search.  \n\n\\subsection{Stochastic Tie Optimization}\nIn this section, we establish formally the equivalence of $(P_4)$ and $(P_5)$ where the solution of $(P_5)$ solves the stochastic optimization problem $(P_4)$.\n\\begin{thm}\\label{thm:eqv_s}\nIf the optimal dual solutions of $(P_{21})$ and $(P_{22})$ are unique for all $q\\leq Q$,  then $(P_4)$ and $(P_5)$  are equivalent in the sense that they have the same optimizer.\n\\end{thm}\n\nTheorem \\ref{thm:eqv_s} provides a new way, we call it Stochastic Tie Optimization (STO), to solve the intractable problem $(P_4)$. This result is significant because the optimal interchange can be obtained from a deterministic optimization problem $(P_5)$ which only requires the information of the expected supply and demand curves. Since these price functions are non-confidential information, $(P_5)$ can be solved by one of the operators if the other operator shares its price curve. In this way, operators do not need to iteratively update or exchange information within the scheduling procedure. This property is in contrast to most decomposition methods where subproblems are resolved and intermediate results are exchanged in each iteration. Because one-time information exchange is sufficient for the optimal schedule, operators do not need to repeatedly solve regional OPF, which is computationally expensive for sufficiently large systems, within the scheduling procedure. Such a property significantly reduces the computation costs in real time, thereby providing the potential of higher scheduling frequency.\n\n\nNow we provide the proof of Theorem \\ref{thm:eqv_s}.\n\\begin{proof}[Proof of Theorem \\ref{thm:eqv_s}]\n We first show the differentiability of the objective functions of $(P_4)$ and $(P_5)$. This follows immediately from the well known results in multiparametric quadratic programming summarized in Lemma \\ref{lem:mqp}.\n\\begin{lem}[\\hspace{-.1em}\\cite{mpc_book}] \\label{lem:mqp}\nIf the dual problem of $(P_{2i})$, $i\\in\\{1,2\\}$, is not degenerate for all $q\\leq Q$, then \n\\begin{enumerate}\n\\item the optimizer of $(P_{2i})$ and associated vector of Lagrangian multipliers are continuous and piecewise affine (affine in each critical region), and\n\\item the optimal objective of $(P_{2i})$ is continuous, convex and piecewise quadratic (quadratic in each critical region).\n\\end{enumerate}\n\\end{lem}\n\nBy Lemma \\ref{lem:mqp}, the objective function of $(P_4)$, denoted by $J(q)$, is differentiable with derivative \n\\setlength\\arraycolsep{2pt}\\begin{eqnarray*}J'(q)&=&\\mathbb{E}_{d_1,d_2}\\left[\\frac{\\partial}{\\partial q}c_1(g_1^*(q,d_1))+\\frac{\\partial}{\\partial q}c_2(g_2^*(q,d_2))\\right]\\\\\n&=&\\mathbb{E}_{d_1}[\\pi_1(q,d_1)]-\\mathbb{E}_{d_2}[\\pi_2(q,d_2)]\n\\end{eqnarray*}\nwhere the second equality holds by the Envelope Theorem. Lemma \\ref{lem:mqp} also implies that $\\pi_1(q,d_1)$ and $\\pi_2(q,d_2)$ are continuous functions, so the objective function of $(P_5)$, denoted by $s(q)$, is differentiable with derivative\n", "itemtype": "equation", "pos": 21662, "prevtext": "\nand the second stage solves the regional optimal dispatch problem given the interchange level $q$ and the realization of random load $d_1$ and $d_2$, which are specified as $(P_{21})$ and $(P_{22})$. Note that the optimal dispatch and the associated Lagrangian multipliers of $(P_{2i})$ are parameterized by two factors: the interchange level $q$ and the load realization $d_i$. So the LMP $\\pi_i(q, d_i)$ at the proxy bus is a function of both $q$ and $d_i$.\n\nDirectly solving this problem requires the distribution of the regional cost function $c_i(q,d_i)$ at each interchange level, and  a coordinator to determine the optimal schedule, neither of which is achievable in the present deregulated electricity markets. In general, this two-stage stochastic optimization problem is intractable, especially when the load and renewable generation forecast follows a continuous distribution. The proposed scheduling technique, on the other hand, can solve this problem without increasing the computation complexity of deterministic TO. Details are provided in the next two subsections.\n\n\\subsection{Social Welfare Optimization}\nThe main idea of solving $(P_4)$ is to exploit the connection between cost minimization and social welfare optimization under uncertainty.  With the randomness present in the second stage of $(P_4)$, it is not obvious how the two-stage optimization problem can be transformed into a corresponding form of social welfare optimization.  It turns out that the optimal solution can be obtained by solving a deterministic TO problem using the {\\em expected} demand and supply functions.  \n\n\nWe now present an optimization problem from the import-export perspective, but taking into account that both import and export regions must agree on the forward interchange quantity in the presence of future demand and supply uncertainty.  Because the interchange quantity is fixed ahead of the actual power delivery, each region may have to rely on its internal resources to compensate uncertainty in real time.  To this end, it is reasonable for the export region to maximize its {\\em expected producer surplus} and the import region to maximize its {\\em expected consumer surplus}. \n\n\\begin{figure}\\centering\n\\begin{psfrags}\n\\psfrag{Sa}[l]{\\scriptsize $\\mathbb{E}_{d_2}[\\pi_2(q,d_2)]$}\n\\psfrag{Sb}[l]{\\scriptsize $\\mathbb{E}_{d_1}[\\pi_1(q,d_1)]$}\n\\psfrag{p}[r]{\\scriptsize $\\pi^*$}\n\\psfrag{Price}[c]{\\scriptsize $\\pi$}\n\\psfrag{flow}[l]{\\scriptsize $q$}\n\\psfrag{lim}[l]{\\scriptsize $Q$}\n\\psfrag{f}[l]{\\scriptsize {${q_\\text{STO}^*}$}}\n\\psfrag{A}[l]{}\n\\psfrag{B}[r]{}\n\\psfrag{S}[l]{}\n\\psfrag{SS}[c]{\\scriptsize Producer surplus}\n\\psfrag{C}[c]{\\scriptsize Consumer surplus}\n\\includegraphics[width=.3\\textwidth]{sto.eps}\n\\end{psfrags}\\caption{Illustration of STO.}\\vspace{-1em}\\label{fig:sto}\\end{figure}\n\nWithout loss of generality, let region 1 be the exporter.  For fixed interchange $q$, let $\\pi_i(q,d_i)$ be the (random)  LMP at the proxy bus.  Then $\\mathbb{E}_{d_1}[\\pi_1(q,d_1)]$, as a function of interchange $q$,  is the expected supply curve averaged over its internal randomness.  Similarly, $\\mathbb{E}_{d_2}[\\pi_2(q,d_2)]$ is the expected demand curve averaged over the internal randomness in region 2 at the time of delivery.  \n\nAs shown in Figure \\ref{fig:sto}, the optimal interchange quantity $q_\\text{STO}^*$ that maximizes the expected social welfare (in absence of interface constraint) is simply the intersection of the expected demand and supply curves. In general, the interchange that maximizes the expected social welfare is given by\n\n\n", "index": 13, "text": "\\begin{equation*}\\label{problem:max_surplus_sto}\n\\setlength\\arraycolsep{2pt}\\begin{array}{r l l}\n(P_5)\\quad\\underset{q}\\max &\\int_0^{q} \\mathbb{E}_{d_2}[\\pi_2(x, d_2)]-\\mathbb{E}_{d_1}[\\pi_1(x, d_1)]dx&\\\\\n\\text{subject to} &q \\leq Q.&(\\mu_{q})\\\\\n\\end{array}\n\\end{equation*}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex6.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{r l l}(P_{5})\\quad\\underset{q}{\\max}&amp;\\int_{0}^{q}\\mathbb{E}_{d%&#10;_{2}}[\\pi_{2}(x,d_{2})]-\\mathbb{E}_{d_{1}}[\\pi_{1}(x,d_{1})]dx&amp;\\\\&#10;\\text{subject to}&amp;q\\leq Q.&amp;(\\mu_{q})\\\\&#10;\\end{array}\" display=\"block\"><mtable columnspacing=\"2.0pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"right\"><mrow><mrow><mo stretchy=\"false\">(</mo><msub><mi>P</mi><mn>5</mn></msub><mo stretchy=\"false\">)</mo></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003</mo><munder accentunder=\"true\"><mi>max</mi><mo>\ud835\udc5e</mo></munder></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mi>q</mi></msubsup><mrow><msub><mi>\ud835\udd3c</mi><msub><mi>d</mi><mn>2</mn></msub></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><msub><mi>\u03c0</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><msub><mi>d</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow><mo>-</mo><mrow><msub><mi>\ud835\udd3c</mi><msub><mi>d</mi><mn>1</mn></msub></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><msub><mi>\u03c0</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><msub><mi>d</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">]</mo></mrow><mo>\u2062</mo><mi>d</mi><mo>\u2062</mo><mi>x</mi></mrow></mrow></mtd><mtd/></mtr><mtr><mtd columnalign=\"right\"><mtext>subject to</mtext></mtd><mtd columnalign=\"left\"><mrow><mrow><mi>q</mi><mo>\u2264</mo><mi>Q</mi></mrow><mo>.</mo></mrow></mtd><mtd columnalign=\"left\"><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03bc</mi><mi>q</mi></msub><mo stretchy=\"false\">)</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.02191.tex", "nexttext": "\n\nNow we derive the connection between the optimal solutions to $(P_4)$ and $(P_5)$ from the first order conditions. The optimal solution $q^{*}$ to $(P_4)$ and the associated Lagrangian multiplier $\\mu^{*}_{q}$ satisfy the first order condition for $(P_4)$:\n\n", "itemtype": "equation", "pos": 25531, "prevtext": "\n\n\nTo solve $(P_5)$, each operator needs to compute, for each interchange quantity $q$,  the expected LMP at its own proxy bus.   Such a computation requires the conditional expectation of future LMP at the time of delivery.  The conditional expectation can be obtained through probabilistic LMP forecast using models for load and generation. See, for example, \\cite{JiTongThomas15ARXIV}. It is also conceivable that the conditional expectations can also be approximated via regression analysis.  Once the expected demand and supply functions are obtained, solving for the optimal interchange quantity becomes a one-dimensional search.  \n\n\\subsection{Stochastic Tie Optimization}\nIn this section, we establish formally the equivalence of $(P_4)$ and $(P_5)$ where the solution of $(P_5)$ solves the stochastic optimization problem $(P_4)$.\n\\begin{thm}\\label{thm:eqv_s}\nIf the optimal dual solutions of $(P_{21})$ and $(P_{22})$ are unique for all $q\\leq Q$,  then $(P_4)$ and $(P_5)$  are equivalent in the sense that they have the same optimizer.\n\\end{thm}\n\nTheorem \\ref{thm:eqv_s} provides a new way, we call it Stochastic Tie Optimization (STO), to solve the intractable problem $(P_4)$. This result is significant because the optimal interchange can be obtained from a deterministic optimization problem $(P_5)$ which only requires the information of the expected supply and demand curves. Since these price functions are non-confidential information, $(P_5)$ can be solved by one of the operators if the other operator shares its price curve. In this way, operators do not need to iteratively update or exchange information within the scheduling procedure. This property is in contrast to most decomposition methods where subproblems are resolved and intermediate results are exchanged in each iteration. Because one-time information exchange is sufficient for the optimal schedule, operators do not need to repeatedly solve regional OPF, which is computationally expensive for sufficiently large systems, within the scheduling procedure. Such a property significantly reduces the computation costs in real time, thereby providing the potential of higher scheduling frequency.\n\n\nNow we provide the proof of Theorem \\ref{thm:eqv_s}.\n\\begin{proof}[Proof of Theorem \\ref{thm:eqv_s}]\n We first show the differentiability of the objective functions of $(P_4)$ and $(P_5)$. This follows immediately from the well known results in multiparametric quadratic programming summarized in Lemma \\ref{lem:mqp}.\n\\begin{lem}[\\hspace{-.1em}\\cite{mpc_book}] \\label{lem:mqp}\nIf the dual problem of $(P_{2i})$, $i\\in\\{1,2\\}$, is not degenerate for all $q\\leq Q$, then \n\\begin{enumerate}\n\\item the optimizer of $(P_{2i})$ and associated vector of Lagrangian multipliers are continuous and piecewise affine (affine in each critical region), and\n\\item the optimal objective of $(P_{2i})$ is continuous, convex and piecewise quadratic (quadratic in each critical region).\n\\end{enumerate}\n\\end{lem}\n\nBy Lemma \\ref{lem:mqp}, the objective function of $(P_4)$, denoted by $J(q)$, is differentiable with derivative \n\\setlength\\arraycolsep{2pt}\\begin{eqnarray*}J'(q)&=&\\mathbb{E}_{d_1,d_2}\\left[\\frac{\\partial}{\\partial q}c_1(g_1^*(q,d_1))+\\frac{\\partial}{\\partial q}c_2(g_2^*(q,d_2))\\right]\\\\\n&=&\\mathbb{E}_{d_1}[\\pi_1(q,d_1)]-\\mathbb{E}_{d_2}[\\pi_2(q,d_2)]\n\\end{eqnarray*}\nwhere the second equality holds by the Envelope Theorem. Lemma \\ref{lem:mqp} also implies that $\\pi_1(q,d_1)$ and $\\pi_2(q,d_2)$ are continuous functions, so the objective function of $(P_5)$, denoted by $s(q)$, is differentiable with derivative\n", "index": 15, "text": "\n\\[s'(q)=\\mathbb{E}_{d_1}[\\pi_1(q^\\sharp,d_1)]-\\mathbb{E}_{d_2}[\\pi_2(q^\\sharp,d_2)].\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex7.m1\" class=\"ltx_Math\" alttext=\"s^{\\prime}(q)=\\mathbb{E}_{d_{1}}[\\pi_{1}(q^{\\sharp},d_{1})]-\\mathbb{E}_{d_{2}}%&#10;[\\pi_{2}(q^{\\sharp},d_{2})].\" display=\"block\"><mrow><mrow><mrow><msup><mi>s</mi><mo>\u2032</mo></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>q</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msub><mi>\ud835\udd3c</mi><msub><mi>d</mi><mn>1</mn></msub></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><msub><mi>\u03c0</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>q</mi><mi mathvariant=\"normal\">\u266f</mi></msup><mo>,</mo><msub><mi>d</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mo>-</mo><mrow><msub><mi>\ud835\udd3c</mi><msub><mi>d</mi><mn>2</mn></msub></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><msub><mi>\u03c0</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>q</mi><mi mathvariant=\"normal\">\u266f</mi></msup><mo>,</mo><msub><mi>d</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02191.tex", "nexttext": "\nSimilarly, the optimal solution $q^\\sharp$ to $(P_5)$ and  the associated Lagrangian multiplier $\\mu^\\sharp_{q}$ satisfy the first order condition for $(P_5)$\n\n", "itemtype": "equation", "pos": 25877, "prevtext": "\n\nNow we derive the connection between the optimal solutions to $(P_4)$ and $(P_5)$ from the first order conditions. The optimal solution $q^{*}$ to $(P_4)$ and the associated Lagrangian multiplier $\\mu^{*}_{q}$ satisfy the first order condition for $(P_4)$:\n\n", "index": 17, "text": "\\begin{equation}\\label{eqn:foc}\n\\mathbb{E}_{d_1}[\\pi_1(q^{*},d_1)]-\\mathbb{E}_{d_2}[\\pi_2(q^{*},d_2)]+\\mu^{*}_{q}=0.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"\\mathbb{E}_{d_{1}}[\\pi_{1}(q^{*},d_{1})]-\\mathbb{E}_{d_{2}}[\\pi_{2}(q^{*},d_{2%&#10;})]+\\mu^{*}_{q}=0.\" display=\"block\"><mrow><mrow><mrow><mrow><mrow><msub><mi>\ud835\udd3c</mi><msub><mi>d</mi><mn>1</mn></msub></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><msub><mi>\u03c0</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>q</mi><mo>*</mo></msup><mo>,</mo><msub><mi>d</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mo>-</mo><mrow><msub><mi>\ud835\udd3c</mi><msub><mi>d</mi><mn>2</mn></msub></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><msub><mi>\u03c0</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>q</mi><mo>*</mo></msup><mo>,</mo><msub><mi>d</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow><mo>+</mo><msubsup><mi>\u03bc</mi><mi>q</mi><mo>*</mo></msubsup></mrow><mo>=</mo><mn>0</mn></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.02191.tex", "nexttext": "\nwhich is exactly the same as (\\ref{eqn:foc}).\n\nFinally, we show $q^{*}=q^\\sharp$. To prove this, we need the monotonicity of price function $\\pi_i(q)$ (with fixed $d_i$ as defined in (\\ref{def:pi})) which is summarized in the following lemma whose proof is provided in the appendix.\n\\begin{lem}\\label{lem:mono}\nIf the dual problem of $(P_{2i}), i\\in\\{1,2\\}$, has a unique optimal solution for all $q\\leq Q$,  then $\\pi_1(q)$ is monotonically increasing and $\\pi_2(q)$ is monotonically decreasing.\n\\end{lem}\n \n Below we show that in each of the following cases, either the case itself is impossible or $q^{*}=q^\\sharp$.\n\\begin{enumerate}\n  \\item $q^{*}=q^\\sharp=Q$. The statement is trivially true.\n  \\item $q^{*}<Q$ and $q^\\sharp <Q$.  In this case, the interface constraint is not binding in either problem, so we have $\\mu_{q}^{*}=\\mu_{q}^\\sharp=0$, which implies that $\\mathbb{E}_{d_1}[\\pi_1(q^{*},d_1)]=\\mathbb{E}_{d_2}[\\pi_2(q^{*},d_2)]$ and $\\mathbb{E}_{d_1}[\\pi_1(q^\\sharp,d_1)]=\\mathbb{E}_{d_2}[\\pi_2(q^\\sharp,d_2)]$. By Lemma \\ref{lem:mono} and the preservation of monotonicity under expectation operation, there is a unique solution to\n$\\mathbb{E}_{d_2}[\\pi_2(q,d_2)]-\\mathbb{E}_{d_1}[\\pi_1(q,d_1)]=0$. Therefore, $q^{*}=q^\\sharp$.\n  \\item  $q^{*}<q^\\sharp =Q$. We construct a solution of $(P_1)$ using  $q^\\sharp$ and the associated optimal functions defined in $(P_{21})$ and $(P_{22})$, \\textit{i.e.}, $q^\\sharp$, $\\mu_{q}^\\sharp$ (which is zero),  $g_1^*(q^{\\sharp})$, $g_2^*(q^{\\sharp})$,  $\\lambda_1^*(q^{\\sharp})$, $\\mu_1^*(q^{\\sharp}),\\lambda_2^*(q^{\\sharp}), \\mu_2^*(q^{\\sharp})$. Note that this solution satisfies the first order conditions for $(P_1)$, so it is optimal to $(P_1)$. However, this contradicts the uniqueness of the optimizer to $(P_1)$. Therefore, this case is impossible. \n  \\item   $q^\\sharp <q^{*}=Q$. This case is also impossible. The proof follows the logic of that in case 3).\n\\end{enumerate}\n\n To sum up, $(P_4)$ and $(P_5)$ are equivalent in the sense that they share the same optimal solution.\n\\end{proof}\n\n\n\n\\section{Stochastic CTS}\\label{sec:cts}\nIn this section, we incorporate external market participants in STO, which generalizes the CTS proposal currently in implementation.  This generalization, we call it Stochastic Coordinated Transaction Scheduling (SCTS), is simply replacing the supply and demand curves used in CTS  by their expected values. \n\nAs in CTS, market participants are allowed to submit requests to buy and sell power simultaneously on each side of the interface. Such request is called \\textit{interface bid}, which includes a price indicating the minimum expected price difference between the two regions that the participant is willing to accept, a transaction quantity and its direction. \n\nWe use a similar graphical representation of STO to illustrate the scheduling procedure of SCTS. As shown in Figure \\ref{fig:scts}, $\\mathbb{E}_{d_1}[{\\pi}_1(q,d_1)]$ is the expected supply curve of region 1, and $\\mathbb{E}_{d_2}[\\tilde{\\pi}_2(q,d_2)]$ is the adjusted curve of $\\mathbb{E}_{d_2}[\\pi_2(q,d_2)]$ by subtracting the aggregated interface bids $\\pi_\\text{bid}(q)$. The SCTS schedule is set at the intersection of $\\mathbb{E}_{d_1}[\\pi_1(q,d_1)]$ and $\\mathbb{E}_{d_2}[\\tilde{\\pi}_2(q,d_2)]$. All the interface bids to the left of $q^*_\\text{SCTS}$ are accepted and settled at the real-time LMP difference.\n\n\\begin{figure}\\centering\\begin{psfrags}\n\\psfrag{Sa}[l]{\\scriptsize $\\mathbb{E}_{d_2}[\\pi_2(q,d_2)]$}\n\\psfrag{Sa2}[l]{\\scriptsize $\\mathbb{E}_{d_2}[\\tilde{\\pi}_2(q,d_2)]$}\n\\psfrag{Sb}[l]{\\scriptsize $\\mathbb{E}_{d_1}[\\pi_1(q,d_1)]$}\n\\psfrag{p}[c]{\\scriptsize $\\pi^*$ }\n\\psfrag{f}[l]{\\scriptsize {${q^*_\\text{SCTS}}$}}\n\\psfrag{Price}[c]{\\scriptsize $\\pi$}\n\\psfrag{flow}[l]{\\scriptsize $q$}\n\\psfrag{lim}[l]{\\scriptsize $Q$}\n\\psfrag{A}[l]{}\n\\psfrag{B}[l]{}\n\\includegraphics[width=.3\\textwidth]{scts.eps}\n\\end{psfrags}\\caption{Illustration of SCTS.}\\label{fig:scts}\\vspace{-1em}\\end{figure}\n\nThe scheduling and clearing procedure described above is summarized as follows:\n\\begin{enumerate}\n  \\item  share the expected LMP functions $ \\mathbb{E}_{d_1}[\\pi_1(q,d_1)]$ and $ \\mathbb{E}_{d_2}[\\pi_2(q,d_2)]$;\n  \\item determine the direction of the interchange flow by comparing $\\mathbb{E}_{d_2}[\\pi_2(0,d_2)]$ and $\\mathbb{E}_{d_1}[\\pi_1(0,d_1)]$;\n  \\item construct the aggregated interface bid curve $\\pi_\\text{bid}(q)$ which is a stack of all interface bids with the direction determined in step 2) in an increasing order of the submitted price difference;\n  \\item calculate the optimal SCTS schedule from the following optimization problem $(P_6)$.\n\\end{enumerate}\n \n", "itemtype": "equation", "pos": 26168, "prevtext": "\nSimilarly, the optimal solution $q^\\sharp$ to $(P_5)$ and  the associated Lagrangian multiplier $\\mu^\\sharp_{q}$ satisfy the first order condition for $(P_5)$\n\n", "index": 19, "text": "\\begin{equation}\n\\mathbb{E}_{d_1}[\\pi_1(q^\\sharp,d_1)]-\\mathbb{E}_{d_2}[\\pi_2(q^\\sharp,d_2)]+\\mu^\\sharp_{q}=0,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"\\mathbb{E}_{d_{1}}[\\pi_{1}(q^{\\sharp},d_{1})]-\\mathbb{E}_{d_{2}}[\\pi_{2}(q^{%&#10;\\sharp},d_{2})]+\\mu^{\\sharp}_{q}=0,\" display=\"block\"><mrow><mrow><mrow><mrow><mrow><msub><mi>\ud835\udd3c</mi><msub><mi>d</mi><mn>1</mn></msub></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><msub><mi>\u03c0</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>q</mi><mi mathvariant=\"normal\">\u266f</mi></msup><mo>,</mo><msub><mi>d</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mo>-</mo><mrow><msub><mi>\ud835\udd3c</mi><msub><mi>d</mi><mn>2</mn></msub></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><msub><mi>\u03c0</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>q</mi><mi mathvariant=\"normal\">\u266f</mi></msup><mo>,</mo><msub><mi>d</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow><mo>+</mo><msubsup><mi>\u03bc</mi><mi>q</mi><mi mathvariant=\"normal\">\u266f</mi></msubsup></mrow><mo>=</mo><mn>0</mn></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.02191.tex", "nexttext": "\n\n\nNote that the only difference between STO and SCTS is the inclusion of interface bids. All other components are identical.  This implies that one-time information exchange is sufficient; no iteration between operators is necessary during the scheduling procedure when one operator submits its expected generation supply curve to the other who executes this scheduling and clearing procedure.\n\n\\section{Evaluation}\\label{sec:sim}\nIn this section, we compare the performance of the proposed STO with that of TO on two systems: a 6-bus system and the IEEE 118-bus system.  In particular, we focus on the two most common symptoms of seams: (i) the under-utilization of interface transmission, and (ii) the presence of counter-intuitive flows from the high cost region to the low cost region. In both examples, TO uses the certainty equivalent forecast of the stochastic generation, \\textit{i.e.}, the mean value, while STO uses the probabilistic forecast, \\textit{i.e.}, the distribution. Various scenarios are studied in these two examples.\n\n\n\\subsection{Example 1: a 2-region 6-bus system} Consider a 2-region 6-bus system as depicted in Figure \\ref{fig:6bus}. Generator incremental cost functions, capacity limits, and load levels (the default values) are presented in the figure. All lines are identical except for the maximum capacities: the tie lines (line 2-6 and line 3-4) and the internal transmission lines in region 1 have the maximum capacities of $100$ MW, and the internal lines in region 2 have the maximum capacities of $200$ MW. The system randomness comes from the wind generator at bus 1 in region 1. The entire network model (the shift factor matrix) is assumed to be known to both ISOs. By default, we chose bus 3 as the proxy bus to represent the network in region 1, and bus 6 to represent the network in region 2. The impact of the location of proxy buses will be further investigated.\n\\begin{figure}\\hspace{1em}\\begin{psfrags}\n\\psfrag{1}[c]{\\scriptsize 1}\n\\psfrag{2}[c]{\\scriptsize 2}\n\\psfrag{3}[c]{\\scriptsize 3}\n\\psfrag{4}[c]{\\scriptsize 4}\n\\psfrag{5}[c]{\\scriptsize 5}\n\\psfrag{6}[c]{\\scriptsize 6}\n\\psfrag{A}[c]{\\scriptsize Region 1}\n\\psfrag{B}[c]{\\scriptsize Region 2}\n\\psfrag{l1}[c]{\\tiny $d_2=30$}\n\\psfrag{l2}[c]{\\tiny $d_5=250$}\n\\psfrag{g1}[c]{\\tiny$\\renewcommand{\\arraystretch}{1.5}\\begin{array}{c} 0\\leq g_1\\leq 120\\\\c_1=0.01g^2_1+10g_1 \\\\ \\end{array}$}\n\\psfrag{g3}[c]{\\tiny$\\renewcommand{\\arraystretch}{1.5}\\begin{array}{c} 0\\leq g_3\\leq 200\\\\c_3=0.01g^2_3+40g_3\\\\  \\end{array}$}\n\\psfrag{g4}[c]{\\tiny$\\hspace{1em}\\renewcommand{\\arraystretch}{1.5}\\begin{array}{c} 0\\leq g_4\\leq 100\\\\c_4=0.01g^2_4+30g_4\\\\  \\end{array}$}\n\\psfrag{g6}[c]{\\tiny$\\renewcommand{\\arraystretch}{1.5}\\begin{array}{c} 0\\leq g_6\\leq 200 \\\\c_6=0.01g^2_6+45g_6\\\\ \\end{array}$}\n\\includegraphics[width=.48\\textwidth]{6bus2ties.eps}\\end{psfrags}\\caption{A 2-region 6-bus system.}\\vspace{-1em}\\label{fig:6bus}\\end{figure}\n\n\\subsubsection{A baseline}\nWe first tested a baseline with the probabilistic wind forecast distribution $\\mathcal{N}(55, 10^2)$. Two levels of load were chosen to illustrate the two symptoms of the inefficiency of TO schedule: the first load level $d_5=250$ is an example of the counter intuitive flow occurrence, and the second load level $d_5=200$ shows the case of the interface under utilization.  Results are presented in Figure \\ref{fig:curve}-\\ref{fig:pdiff} and Table \\ref{table:base}.\n\nFigure \\ref{fig:curve} shows the generation supply curves of region 1 and region 2 under TO and STO for the two examples, respectively. $\\pi_1^\\text{TO}$ is the incremental cost of region 1 to deliver the power to the proxy bus 6 using the forecasted mean $55$ of the wind production, and $\\pi_1^\\text{STO}$ is the expected incremental cost using the forecast distribution $\\mathcal{N}(55, 10^2)$. Since there is no randomness in region 2, the supply curves of region 2 for TO and STO are the same in both examples. At the interchange level of STO schedule, the expected overall system cost is minimized in both cases as shown in Figure \\ref{fig:cost}, and the expected prices at the two proxy buses converge in both cases as shown in Figure \\ref{fig:pdiff}. From Table \\ref{table:base},  the expected price difference at the level of TO schedule in the first example is $-2.13$\\$/MWh, which means that the expected price of the importing region (region 2) is lower then that of the exporting region. This implies that the interchange is scheduled from a high cost region to a low cost region, which is counter intuitive. On the other hand, in the second example, the expected price difference at the interchange level of TO schedule is $2.38$\\$/MWh, \\textit{i.e.}, the marginal price of the importing region is higher than that of the exporting region. With this price difference, increasing the interchange level can further reduce the expected overall cost, which implies the interchange capacity is under utilized. Because the interchange level of STO schedule is optimal as its design, any schedule more than this optimal level will cause the counter intuitive flow, and any schedule less than that will lead to the interface under utilization.\n\n\n\\begin{table}\\caption{Comparison of TO and STO.}\\label{table:base}\\centering\nScenario&Method&$q^*$&$\\mathbb{E}[\\text{Cost}(q^*)]$&$\\mathbb{E}[\\Delta\\pi(q^*)]$ \\\\ \\hline\n\\multirow{2}{*}{$d_5=250$}&TO&$166.5$&$6794.2$&$-2.13$\\\\ \\cline{2-5}\n&STO&$162.8$&$6790.8$&$0$\\\\ \\hline\n\\multirow{2}{*}{$d_5=200$}&TO&$147.5$&$4621.6$&$2.38$\\\\ \\cline{2-5}\n&STO&$151.4$&$4608.6$ &$0$ \\\\ \\hline\n\\end{tabular}\n\\end{table}\n\n\\begin{figure}\\centering\n\\begin{subfigure}{0.24\\textwidth}\n\\includegraphics[width=\\textwidth]{pvi250.eps}\\caption{$d_5=250$.}\n\\end{subfigure}\n\\begin{subfigure}{0.24\\textwidth}\n\\includegraphics[width=\\textwidth]{pvi200.eps}\\caption{$d_5=200$.}\n\\end{subfigure}\t\n\\caption{Generation supply curves.}\\vspace{-1em}\n\\label{fig:curve}\\end{figure}\n\n\\begin{figure}\\vspace{-1em}\\centering\n\\begin{subfigure}{0.24\\textwidth}\n\\includegraphics[width=\\textwidth]{cvi250.eps}\\caption{$d_5=250$.}\n\\end{subfigure}\n\\begin{subfigure}{0.24\\textwidth}\n\\includegraphics[width=\\textwidth]{cvi200.eps}\\caption{$d_5=200$.}\n\\end{subfigure}\n\\caption{Expected overall cost: TO is marked by the blue square and STO by the red circle.}\n\\label{fig:cost}\\end{figure}\n\n\\begin{figure}\\vspace{-1em}\\centering\t\n\\begin{subfigure}{0.24\\textwidth}\n\\includegraphics[width=\\textwidth]{dvi250.eps}\\caption{$d_5=250$.}\n\\end{subfigure}\n\\begin{subfigure}{0.24\\textwidth}\n\\includegraphics[width=\\textwidth]{dvi200.eps}\\caption{$d_5=200$.}\n\\end{subfigure}\n\\caption{Expected price difference: TO is marked by the blue square and STO by the red circle.}\n\\label{fig:pdiff}\\end{figure}\n\n\n\\subsubsection{Impact of forecast uncertainty}\nThe impact of the forecast uncertainty level was then investigated by varying the standard deviation $\\sigma$ of the probabilistic wind production forecast $w\\sim \\mathcal{N}(55, \\sigma^2)$. Loads were set at the default values given in Figure \\ref{fig:6bus}. Results are presented in Figure \\ref{fig:sigma}.\n\\begin{figure}\\centering\n\\begin{subfigure}{0.24\\textwidth}\n\\includegraphics[width=\\textwidth]{pvs.eps}\\caption{Interchange.}\n\\end{subfigure}\n\\begin{subfigure}{0.24\\textwidth}\n\\includegraphics[width=\\textwidth]{cvs.eps}\\caption{Expected overall cost.}\n\\end{subfigure}\n\\caption{Impact of the forecast uncertainty ($\\sigma$).}\\vspace{-1em}\n\\label{fig:sigma}\\end{figure}\n\nThe interchange level of TO schedule does not change with $\\sigma$ since it only uses the mean value $55$ of the wind production forecast. STO, on the other hand, captures the uncertainty level of the probabilistic forecast and adjusts the interchange schedule accordingly. The expected overall cost increases with the forecast uncertainty, which is observed in both TO and STO. When there is no uncertainty ($\\sigma=0$), the schedules of TO and STO are the same and so do their costs.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\subsection{Example 2: a 2-region 118-bus system}\nWe divided the standard IEEE 118 bus system\\footnote{All bus and branch indices are referred to \\cite{matpower}.} into two regions: region 1 includes bus 1-12 and region 2 bus 13-118. Generator incremental cost functions, capacity limits, and load levels are the default values given in MATPOWER\\cite{matpower}. We imposed the maximum capacity of $50$ MW on line 4, 6, 58 and 60. The interface transmission was not limited by default, but the impact of the interface constraint will be studied. Bus 6 and 42 were selected as the proxy buses to represent the adjacent region's network. \n\nTo introduce randomness in the system, we assumed that three wind generators, located at bus 6, 42, and 60, produce power according to a discrete distribution. Specifically, denote the wind production by $w$, and the probabilistic forecast consists of a probability mass function $p$ and two levels of wind: $w=(10,10,10)$ and $w'=(100,200,200)$. We considered three scenarios: a high wind scenario $p=(0.1,0.9)$, a medium wind scenario $p=(0.5,0.5)$, and a low wind scenario $p=(0.9,0.1)$. TO uses the mean value $(91,181,181)$, $(55,105,105)$ and $(19,29,29)$ for each respective scenario.\n\n\\subsubsection{A baseline}\\label{subsec:base118}\nIn this case, we verified the optimality of STO schedule with the presence of discrete randomness. All three wind scenarios were tested. Results are shown in Figure \\ref{fig:118case1}-\\ref{fig:118case3} and Table \\ref{table:base118}.\n\n\\begin{table}\\caption{Comparison of TO and STO.}\\label{table:base118}\\centering\nScenario&Method&$q^*$&$\\mathbb{E}[\\text{Cost}(q^*)]$&$\\mathbb{E}[\\Delta\\pi(q^*)]$ \\\\ \\hline\n\\multirow{2}{*}{$p=(0.1,0.9)$}&TO&$268.6$&$104751.6$&-0.25\\\\ \\cline{2-5}\n&STO&$263.1$&$104750.9$&0\\\\ \\hline\n\\multirow{2}{*}{$p=(0.5,0.5)$}&TO&$242.6$&$109798.1$&-0.29\\\\ \\cline{2-5}\n&STO&$236$&$109797.1$ &0 \\\\ \\hline\n\\multirow{2}{*}{$p=(0.9,0.1)$}&TO&$197$&$114806.8$&0.28\\\\ \\cline{2-5}\n&STO&$204$&$114805.8$ &0 \\\\ \\hline\n\\end{tabular}\n\\end{table}\n\n\\begin{figure}\\centering\n\\begin{subfigure}{0.24\\textwidth}\n\\includegraphics[width=\\textwidth]{pvi1.eps}\\caption{Generation supply curves.}\n\\end{subfigure}\n\\begin{subfigure}{0.24\\textwidth}\n\\includegraphics[width=\\textwidth]{cvi1.eps}\\caption{Expected overall cost.}\n\\end{subfigure}\n\\caption{High wind scenario $p=(0.1,0.9)$.}\\vspace{-1em}\n\\label{fig:118case1}\\end{figure}\n\n\\begin{figure}\\centering\n\\begin{subfigure}{0.24\\textwidth}\n\\includegraphics[width=\\textwidth]{pvi2.eps}\\caption{Generation supply curves.}\n\\end{subfigure}\n\\begin{subfigure}{0.24\\textwidth}\n\\includegraphics[width=\\textwidth]{cvi2.eps}\\caption{Expected overall cost.}\n\\end{subfigure}\n\\caption{Medium wind scenario $p=(0.5,0.5)$. }\\vspace{-1em}\n\\label{fig:118case2}\\end{figure}\n\n\\begin{figure}\\centering\n\\begin{subfigure}{0.24\\textwidth}\n\\includegraphics[width=\\textwidth]{pvi3.eps}\\caption{Generation supply curves.}\n\\end{subfigure}\n\\begin{subfigure}{0.24\\textwidth}\n\\includegraphics[width=\\textwidth]{cvi3.eps}\\caption{Expected overall cost.}\n\\end{subfigure}\n\\caption{Low wind scenario $p=(0.9,0.1)$. }\n\\label{fig:118case3}\\end{figure}\n\nSince all generation cost functions are quadratic, the price functions are continuous and piecewise affine. The performances of TO and STO schedule are similar to that in the 6-bus system example. The expected overall cost is minimized at the STO schedule in all three cases, as indicated by the red circles in Figure \\ref{fig:118case1}-\\ref{fig:118case3}, and the prices converge at the schedule of STO, as shown in Table \\ref{table:base118}. As for TO schedules, the counter intuitive flows are observed in the high wind and medium wind scenario, and the interface under utilization happens in the low wind scenario.\n\\subsubsection{Impact of interface congestion}\nTo investigate the impact of the interface congestion, we tested all three wind scenarios again under the same setting except the interface capacity which was set as $250$ MW in this case. \n\nFrom the results shown in Table \\ref{table:congestion118}, the presence of the interface constraint only influences the performances in the high wind scenario. The price separation happens in both TO and STO, because the binding interface constraint prevents the economic interface flow.\n\\begin{table}\\caption{Impact of interface congestion.}\\label{table:congestion118}\\centering\nScenario&Method&$q^*$&$\\mathbb{E}[\\text{Cost}(q^*)]$&$\\mathbb{E}[\\Delta\\pi(q^*)]$\\\\ \\hline\n\\multirow{2}{*}{$p=(0.1,0.9)$}&TO&$250$&$104754.8$&0.6\\\\ \\cline{2-5}\n&STO&$250$&$104754.8$&0.6\\\\ \\hline\n\\multirow{2}{*}{$p=(0.5,0.5)$}&TO&$242.6$&$109798.1$&-0.29\\\\ \\cline{2-5}\n&STO&$236$&$109797.1$ &0 \\\\ \\hline\n\\multirow{2}{*}{$p=(0.9,0.1)$}&TO&$197$&$114806.8$&0.28\\\\ \\cline{2-5}\n&STO&$204$&$114805.8$ &0 \\\\ \\hline\n\\end{tabular}\\end{table}\n\\subsubsection{Impact of proxy bus location}\nWe finally tested the impact of proxy bus location in the medium wind scenario, \\textit{i.e.} $p=(0.5,0.5)$. Tie line bus and internal bus (wind bus) were selected as the proxy buses. \n\\begin{table}[ht]\\caption{Impact of the proxy bus location.}\\label{table:proxy2}\\centering\n&\\multirow{2}{*}{\\parbox{.8cm}{\\centering Proxy Bus}}&\\multicolumn{2}{|c|}{$q^*$}&\\multicolumn{2}{|c|}{$\\mathbb{E}[\\text{Cost}(q^*)]$}\\\\ \\cline{3-6}\n&&TO&STO&TO&STO\\\\ \\hline\n\\multirow{2}{*}{\\parbox{.8cm}{\\centering Internal Bus}}&(1,118)&244.1&238.1&109780.5&109779.7\\\\ \\cline{2-6}\n&(6,42)&242.6&236&$109798.1$&$109797.1$\\\\  \\hline\n\\multirow{5}{*}{\\parbox{.8cm}{\\centering Tie Line Bus}}&(8,30)&253&271&109569.8&109565.3\\\\ \\cline{2-6}\n&(11,13)&78.4&126.5&110595.1&110540.4\\\\ \\cline{2-6}\n&(12,14)&28.8&-15.4&110865.5&110828.6\\\\ \\cline{2-6}\n&(12,16)&34&4.7&110847.2&110833.4\\\\ \\cline{2-6}\n&(12,117)&16.8&-23.3&110890.5&110785.7\\\\ \\hline\n\\end{tabular}\\end{table}\nFrom the results presented in Table \\ref{table:proxy2}, we observe that the interchange schedule and the associated expected cost are very sensitive to the location of the proxy bus in both TO and STO. With different selections of the proxy bus, the direction of the interchange schedule can be different, for example, (1,118) and (12, 117). Although there are several considerations that can guide the choice of proxy bus location \\cite{Harvey03Proxy}, no theoretical results show a universal selection rule. \n\n\n\\section{Conclusion}\\label{sec:con}\nThis paper presents a stochastic interchange scheduling technique that incorporates load and renewable generation uncertainties. Using the forecast of the expected LMP at the proxy bus, the proposed approach obtains the optimal interchange schedule from a deterministic optimization problem that maximizes the expected economic surplus. The essence of this technique is providing a way to reduce a two-stage stochastic optimization problem into a deterministic optimization problem with an one-dimensional decision. In addition, the proposed technique does not require any iteration between operators during the scheduling procedure. A one-time information exchange is sufficient for the optimal scheduling. \n\\appendix\n\\begin{proof}[Proof of Lemma \\ref{lem:mono}]\nDenote the Lagrangian function for $(P_{2i})$ by $\\mathcal{L}_{2i}, i\\in\\{1,2\\}$. By Lemma \\ref{lem:mqp}, $c_i(g_i^*(q))$ is convex and quadratic in each critical region, so the derivative exists. By the Envelope Theorem,\n", "itemtype": "equation", "pos": 30940, "prevtext": "\nwhich is exactly the same as (\\ref{eqn:foc}).\n\nFinally, we show $q^{*}=q^\\sharp$. To prove this, we need the monotonicity of price function $\\pi_i(q)$ (with fixed $d_i$ as defined in (\\ref{def:pi})) which is summarized in the following lemma whose proof is provided in the appendix.\n\\begin{lem}\\label{lem:mono}\nIf the dual problem of $(P_{2i}), i\\in\\{1,2\\}$, has a unique optimal solution for all $q\\leq Q$,  then $\\pi_1(q)$ is monotonically increasing and $\\pi_2(q)$ is monotonically decreasing.\n\\end{lem}\n \n Below we show that in each of the following cases, either the case itself is impossible or $q^{*}=q^\\sharp$.\n\\begin{enumerate}\n  \\item $q^{*}=q^\\sharp=Q$. The statement is trivially true.\n  \\item $q^{*}<Q$ and $q^\\sharp <Q$.  In this case, the interface constraint is not binding in either problem, so we have $\\mu_{q}^{*}=\\mu_{q}^\\sharp=0$, which implies that $\\mathbb{E}_{d_1}[\\pi_1(q^{*},d_1)]=\\mathbb{E}_{d_2}[\\pi_2(q^{*},d_2)]$ and $\\mathbb{E}_{d_1}[\\pi_1(q^\\sharp,d_1)]=\\mathbb{E}_{d_2}[\\pi_2(q^\\sharp,d_2)]$. By Lemma \\ref{lem:mono} and the preservation of monotonicity under expectation operation, there is a unique solution to\n$\\mathbb{E}_{d_2}[\\pi_2(q,d_2)]-\\mathbb{E}_{d_1}[\\pi_1(q,d_1)]=0$. Therefore, $q^{*}=q^\\sharp$.\n  \\item  $q^{*}<q^\\sharp =Q$. We construct a solution of $(P_1)$ using  $q^\\sharp$ and the associated optimal functions defined in $(P_{21})$ and $(P_{22})$, \\textit{i.e.}, $q^\\sharp$, $\\mu_{q}^\\sharp$ (which is zero),  $g_1^*(q^{\\sharp})$, $g_2^*(q^{\\sharp})$,  $\\lambda_1^*(q^{\\sharp})$, $\\mu_1^*(q^{\\sharp}),\\lambda_2^*(q^{\\sharp}), \\mu_2^*(q^{\\sharp})$. Note that this solution satisfies the first order conditions for $(P_1)$, so it is optimal to $(P_1)$. However, this contradicts the uniqueness of the optimizer to $(P_1)$. Therefore, this case is impossible. \n  \\item   $q^\\sharp <q^{*}=Q$. This case is also impossible. The proof follows the logic of that in case 3).\n\\end{enumerate}\n\n To sum up, $(P_4)$ and $(P_5)$ are equivalent in the sense that they share the same optimal solution.\n\\end{proof}\n\n\n\n\\section{Stochastic CTS}\\label{sec:cts}\nIn this section, we incorporate external market participants in STO, which generalizes the CTS proposal currently in implementation.  This generalization, we call it Stochastic Coordinated Transaction Scheduling (SCTS), is simply replacing the supply and demand curves used in CTS  by their expected values. \n\nAs in CTS, market participants are allowed to submit requests to buy and sell power simultaneously on each side of the interface. Such request is called \\textit{interface bid}, which includes a price indicating the minimum expected price difference between the two regions that the participant is willing to accept, a transaction quantity and its direction. \n\nWe use a similar graphical representation of STO to illustrate the scheduling procedure of SCTS. As shown in Figure \\ref{fig:scts}, $\\mathbb{E}_{d_1}[{\\pi}_1(q,d_1)]$ is the expected supply curve of region 1, and $\\mathbb{E}_{d_2}[\\tilde{\\pi}_2(q,d_2)]$ is the adjusted curve of $\\mathbb{E}_{d_2}[\\pi_2(q,d_2)]$ by subtracting the aggregated interface bids $\\pi_\\text{bid}(q)$. The SCTS schedule is set at the intersection of $\\mathbb{E}_{d_1}[\\pi_1(q,d_1)]$ and $\\mathbb{E}_{d_2}[\\tilde{\\pi}_2(q,d_2)]$. All the interface bids to the left of $q^*_\\text{SCTS}$ are accepted and settled at the real-time LMP difference.\n\n\\begin{figure}\\centering\\begin{psfrags}\n\\psfrag{Sa}[l]{\\scriptsize $\\mathbb{E}_{d_2}[\\pi_2(q,d_2)]$}\n\\psfrag{Sa2}[l]{\\scriptsize $\\mathbb{E}_{d_2}[\\tilde{\\pi}_2(q,d_2)]$}\n\\psfrag{Sb}[l]{\\scriptsize $\\mathbb{E}_{d_1}[\\pi_1(q,d_1)]$}\n\\psfrag{p}[c]{\\scriptsize $\\pi^*$ }\n\\psfrag{f}[l]{\\scriptsize {${q^*_\\text{SCTS}}$}}\n\\psfrag{Price}[c]{\\scriptsize $\\pi$}\n\\psfrag{flow}[l]{\\scriptsize $q$}\n\\psfrag{lim}[l]{\\scriptsize $Q$}\n\\psfrag{A}[l]{}\n\\psfrag{B}[l]{}\n\\includegraphics[width=.3\\textwidth]{scts.eps}\n\\end{psfrags}\\caption{Illustration of SCTS.}\\label{fig:scts}\\vspace{-1em}\\end{figure}\n\nThe scheduling and clearing procedure described above is summarized as follows:\n\\begin{enumerate}\n  \\item  share the expected LMP functions $ \\mathbb{E}_{d_1}[\\pi_1(q,d_1)]$ and $ \\mathbb{E}_{d_2}[\\pi_2(q,d_2)]$;\n  \\item determine the direction of the interchange flow by comparing $\\mathbb{E}_{d_2}[\\pi_2(0,d_2)]$ and $\\mathbb{E}_{d_1}[\\pi_1(0,d_1)]$;\n  \\item construct the aggregated interface bid curve $\\pi_\\text{bid}(q)$ which is a stack of all interface bids with the direction determined in step 2) in an increasing order of the submitted price difference;\n  \\item calculate the optimal SCTS schedule from the following optimization problem $(P_6)$.\n\\end{enumerate}\n \n", "index": 21, "text": "\\[\\setlength\\arraycolsep{2pt}\\begin{array}{r l}\n(P_6)\\quad\\underset{q}\\max &\\int_0^{q} \\mathbb{E}_{d_2}[\\pi_2(x, d_2)]-\\mathbb{E}_{d_1}[\\pi_1(x, d_1)]-\\pi_\\text{bid}(x)dx\\\\\n\\text{subject to} &q \\leq Q.\\\\\n\\end{array}\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex8.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{r l}(P_{6})\\quad\\underset{q}{\\max}&amp;\\int_{0}^{q}\\mathbb{E}_{d_{%&#10;2}}[\\pi_{2}(x,d_{2})]-\\mathbb{E}_{d_{1}}[\\pi_{1}(x,d_{1})]-\\pi_{\\text{bid}}(x)%&#10;dx\\\\&#10;\\text{subject to}&amp;q\\leq Q.\\\\&#10;\\end{array}\" display=\"block\"><mtable columnspacing=\"2.0pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"right\"><mrow><mrow><mo stretchy=\"false\">(</mo><msub><mi>P</mi><mn>6</mn></msub><mo stretchy=\"false\">)</mo></mrow><mo mathvariant=\"italic\" separator=\"true\">\u2003</mo><munder accentunder=\"true\"><mi>max</mi><mo>\ud835\udc5e</mo></munder></mrow></mtd><mtd columnalign=\"left\"><mrow><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mi>q</mi></msubsup><mrow><msub><mi>\ud835\udd3c</mi><msub><mi>d</mi><mn>2</mn></msub></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><msub><mi>\u03c0</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><msub><mi>d</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow></mrow><mo>-</mo><mrow><msub><mi>\ud835\udd3c</mi><msub><mi>d</mi><mn>1</mn></msub></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><msub><mi>\u03c0</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><msub><mi>d</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mo>-</mo><mrow><msub><mi>\u03c0</mi><mtext>bid</mtext></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>d</mi><mo>\u2062</mo><mi>x</mi></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"right\"><mtext>subject to</mtext></mtd><mtd columnalign=\"left\"><mrow><mrow><mi>q</mi><mo>\u2264</mo><mi>Q</mi></mrow><mo>.</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.02191.tex", "nexttext": "\n\n\n\n\nBy Lemma \\ref{lem:mqp},  $\\pi_i(q)$ is affine in each critical region, so the derivative of $\\pi_i(q)$ exists. In addition, $c_i(g_i^*(q))$ is quadratic, which implies that the second derivative of $c_i(g_i^*(q))$ (the derivative of $\\pi_i(q)$) with respect to $q$ is positive. Therefore, $\\pi_1(q)$ is monotonically increasing and $\\pi_2(q)$ is monotonically decreasing within each critical region. Lemma \\ref{lem:mqp} indicates that $\\pi_i(q)$ is continuous for all $q\\leq Q$, so the monotonicity of $\\pi_i(q)$ is preserved for all $q\\leq Q$.\n\\end{proof}\n\n\\Urlmuskip=0mu plus 1mu\\relax\n\\bibliographystyle{IEEEtran}\n{\\bibliography{reference}}\n\n", "itemtype": "equation", "pos": 46422, "prevtext": "\n\n\nNote that the only difference between STO and SCTS is the inclusion of interface bids. All other components are identical.  This implies that one-time information exchange is sufficient; no iteration between operators is necessary during the scheduling procedure when one operator submits its expected generation supply curve to the other who executes this scheduling and clearing procedure.\n\n\\section{Evaluation}\\label{sec:sim}\nIn this section, we compare the performance of the proposed STO with that of TO on two systems: a 6-bus system and the IEEE 118-bus system.  In particular, we focus on the two most common symptoms of seams: (i) the under-utilization of interface transmission, and (ii) the presence of counter-intuitive flows from the high cost region to the low cost region. In both examples, TO uses the certainty equivalent forecast of the stochastic generation, \\textit{i.e.}, the mean value, while STO uses the probabilistic forecast, \\textit{i.e.}, the distribution. Various scenarios are studied in these two examples.\n\n\n\\subsection{Example 1: a 2-region 6-bus system} Consider a 2-region 6-bus system as depicted in Figure \\ref{fig:6bus}. Generator incremental cost functions, capacity limits, and load levels (the default values) are presented in the figure. All lines are identical except for the maximum capacities: the tie lines (line 2-6 and line 3-4) and the internal transmission lines in region 1 have the maximum capacities of $100$ MW, and the internal lines in region 2 have the maximum capacities of $200$ MW. The system randomness comes from the wind generator at bus 1 in region 1. The entire network model (the shift factor matrix) is assumed to be known to both ISOs. By default, we chose bus 3 as the proxy bus to represent the network in region 1, and bus 6 to represent the network in region 2. The impact of the location of proxy buses will be further investigated.\n\\begin{figure}\\hspace{1em}\\begin{psfrags}\n\\psfrag{1}[c]{\\scriptsize 1}\n\\psfrag{2}[c]{\\scriptsize 2}\n\\psfrag{3}[c]{\\scriptsize 3}\n\\psfrag{4}[c]{\\scriptsize 4}\n\\psfrag{5}[c]{\\scriptsize 5}\n\\psfrag{6}[c]{\\scriptsize 6}\n\\psfrag{A}[c]{\\scriptsize Region 1}\n\\psfrag{B}[c]{\\scriptsize Region 2}\n\\psfrag{l1}[c]{\\tiny $d_2=30$}\n\\psfrag{l2}[c]{\\tiny $d_5=250$}\n\\psfrag{g1}[c]{\\tiny$\\renewcommand{\\arraystretch}{1.5}\\begin{array}{c} 0\\leq g_1\\leq 120\\\\c_1=0.01g^2_1+10g_1 \\\\ \\end{array}$}\n\\psfrag{g3}[c]{\\tiny$\\renewcommand{\\arraystretch}{1.5}\\begin{array}{c} 0\\leq g_3\\leq 200\\\\c_3=0.01g^2_3+40g_3\\\\  \\end{array}$}\n\\psfrag{g4}[c]{\\tiny$\\hspace{1em}\\renewcommand{\\arraystretch}{1.5}\\begin{array}{c} 0\\leq g_4\\leq 100\\\\c_4=0.01g^2_4+30g_4\\\\  \\end{array}$}\n\\psfrag{g6}[c]{\\tiny$\\renewcommand{\\arraystretch}{1.5}\\begin{array}{c} 0\\leq g_6\\leq 200 \\\\c_6=0.01g^2_6+45g_6\\\\ \\end{array}$}\n\\includegraphics[width=.48\\textwidth]{6bus2ties.eps}\\end{psfrags}\\caption{A 2-region 6-bus system.}\\vspace{-1em}\\label{fig:6bus}\\end{figure}\n\n\\subsubsection{A baseline}\nWe first tested a baseline with the probabilistic wind forecast distribution $\\mathcal{N}(55, 10^2)$. Two levels of load were chosen to illustrate the two symptoms of the inefficiency of TO schedule: the first load level $d_5=250$ is an example of the counter intuitive flow occurrence, and the second load level $d_5=200$ shows the case of the interface under utilization.  Results are presented in Figure \\ref{fig:curve}-\\ref{fig:pdiff} and Table \\ref{table:base}.\n\nFigure \\ref{fig:curve} shows the generation supply curves of region 1 and region 2 under TO and STO for the two examples, respectively. $\\pi_1^\\text{TO}$ is the incremental cost of region 1 to deliver the power to the proxy bus 6 using the forecasted mean $55$ of the wind production, and $\\pi_1^\\text{STO}$ is the expected incremental cost using the forecast distribution $\\mathcal{N}(55, 10^2)$. Since there is no randomness in region 2, the supply curves of region 2 for TO and STO are the same in both examples. At the interchange level of STO schedule, the expected overall system cost is minimized in both cases as shown in Figure \\ref{fig:cost}, and the expected prices at the two proxy buses converge in both cases as shown in Figure \\ref{fig:pdiff}. From Table \\ref{table:base},  the expected price difference at the level of TO schedule in the first example is $-2.13$\\$/MWh, which means that the expected price of the importing region (region 2) is lower then that of the exporting region. This implies that the interchange is scheduled from a high cost region to a low cost region, which is counter intuitive. On the other hand, in the second example, the expected price difference at the interchange level of TO schedule is $2.38$\\$/MWh, \\textit{i.e.}, the marginal price of the importing region is higher than that of the exporting region. With this price difference, increasing the interchange level can further reduce the expected overall cost, which implies the interchange capacity is under utilized. Because the interchange level of STO schedule is optimal as its design, any schedule more than this optimal level will cause the counter intuitive flow, and any schedule less than that will lead to the interface under utilization.\n\n\n\\begin{table}\\caption{Comparison of TO and STO.}\\label{table:base}\\centering\nScenario&Method&$q^*$&$\\mathbb{E}[\\text{Cost}(q^*)]$&$\\mathbb{E}[\\Delta\\pi(q^*)]$ \\\\ \\hline\n\\multirow{2}{*}{$d_5=250$}&TO&$166.5$&$6794.2$&$-2.13$\\\\ \\cline{2-5}\n&STO&$162.8$&$6790.8$&$0$\\\\ \\hline\n\\multirow{2}{*}{$d_5=200$}&TO&$147.5$&$4621.6$&$2.38$\\\\ \\cline{2-5}\n&STO&$151.4$&$4608.6$ &$0$ \\\\ \\hline\n\\end{tabular}\n\\end{table}\n\n\\begin{figure}\\centering\n\\begin{subfigure}{0.24\\textwidth}\n\\includegraphics[width=\\textwidth]{pvi250.eps}\\caption{$d_5=250$.}\n\\end{subfigure}\n\\begin{subfigure}{0.24\\textwidth}\n\\includegraphics[width=\\textwidth]{pvi200.eps}\\caption{$d_5=200$.}\n\\end{subfigure}\t\n\\caption{Generation supply curves.}\\vspace{-1em}\n\\label{fig:curve}\\end{figure}\n\n\\begin{figure}\\vspace{-1em}\\centering\n\\begin{subfigure}{0.24\\textwidth}\n\\includegraphics[width=\\textwidth]{cvi250.eps}\\caption{$d_5=250$.}\n\\end{subfigure}\n\\begin{subfigure}{0.24\\textwidth}\n\\includegraphics[width=\\textwidth]{cvi200.eps}\\caption{$d_5=200$.}\n\\end{subfigure}\n\\caption{Expected overall cost: TO is marked by the blue square and STO by the red circle.}\n\\label{fig:cost}\\end{figure}\n\n\\begin{figure}\\vspace{-1em}\\centering\t\n\\begin{subfigure}{0.24\\textwidth}\n\\includegraphics[width=\\textwidth]{dvi250.eps}\\caption{$d_5=250$.}\n\\end{subfigure}\n\\begin{subfigure}{0.24\\textwidth}\n\\includegraphics[width=\\textwidth]{dvi200.eps}\\caption{$d_5=200$.}\n\\end{subfigure}\n\\caption{Expected price difference: TO is marked by the blue square and STO by the red circle.}\n\\label{fig:pdiff}\\end{figure}\n\n\n\\subsubsection{Impact of forecast uncertainty}\nThe impact of the forecast uncertainty level was then investigated by varying the standard deviation $\\sigma$ of the probabilistic wind production forecast $w\\sim \\mathcal{N}(55, \\sigma^2)$. Loads were set at the default values given in Figure \\ref{fig:6bus}. Results are presented in Figure \\ref{fig:sigma}.\n\\begin{figure}\\centering\n\\begin{subfigure}{0.24\\textwidth}\n\\includegraphics[width=\\textwidth]{pvs.eps}\\caption{Interchange.}\n\\end{subfigure}\n\\begin{subfigure}{0.24\\textwidth}\n\\includegraphics[width=\\textwidth]{cvs.eps}\\caption{Expected overall cost.}\n\\end{subfigure}\n\\caption{Impact of the forecast uncertainty ($\\sigma$).}\\vspace{-1em}\n\\label{fig:sigma}\\end{figure}\n\nThe interchange level of TO schedule does not change with $\\sigma$ since it only uses the mean value $55$ of the wind production forecast. STO, on the other hand, captures the uncertainty level of the probabilistic forecast and adjusts the interchange schedule accordingly. The expected overall cost increases with the forecast uncertainty, which is observed in both TO and STO. When there is no uncertainty ($\\sigma=0$), the schedules of TO and STO are the same and so do their costs.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\subsection{Example 2: a 2-region 118-bus system}\nWe divided the standard IEEE 118 bus system\\footnote{All bus and branch indices are referred to \\cite{matpower}.} into two regions: region 1 includes bus 1-12 and region 2 bus 13-118. Generator incremental cost functions, capacity limits, and load levels are the default values given in MATPOWER\\cite{matpower}. We imposed the maximum capacity of $50$ MW on line 4, 6, 58 and 60. The interface transmission was not limited by default, but the impact of the interface constraint will be studied. Bus 6 and 42 were selected as the proxy buses to represent the adjacent region's network. \n\nTo introduce randomness in the system, we assumed that three wind generators, located at bus 6, 42, and 60, produce power according to a discrete distribution. Specifically, denote the wind production by $w$, and the probabilistic forecast consists of a probability mass function $p$ and two levels of wind: $w=(10,10,10)$ and $w'=(100,200,200)$. We considered three scenarios: a high wind scenario $p=(0.1,0.9)$, a medium wind scenario $p=(0.5,0.5)$, and a low wind scenario $p=(0.9,0.1)$. TO uses the mean value $(91,181,181)$, $(55,105,105)$ and $(19,29,29)$ for each respective scenario.\n\n\\subsubsection{A baseline}\\label{subsec:base118}\nIn this case, we verified the optimality of STO schedule with the presence of discrete randomness. All three wind scenarios were tested. Results are shown in Figure \\ref{fig:118case1}-\\ref{fig:118case3} and Table \\ref{table:base118}.\n\n\\begin{table}\\caption{Comparison of TO and STO.}\\label{table:base118}\\centering\nScenario&Method&$q^*$&$\\mathbb{E}[\\text{Cost}(q^*)]$&$\\mathbb{E}[\\Delta\\pi(q^*)]$ \\\\ \\hline\n\\multirow{2}{*}{$p=(0.1,0.9)$}&TO&$268.6$&$104751.6$&-0.25\\\\ \\cline{2-5}\n&STO&$263.1$&$104750.9$&0\\\\ \\hline\n\\multirow{2}{*}{$p=(0.5,0.5)$}&TO&$242.6$&$109798.1$&-0.29\\\\ \\cline{2-5}\n&STO&$236$&$109797.1$ &0 \\\\ \\hline\n\\multirow{2}{*}{$p=(0.9,0.1)$}&TO&$197$&$114806.8$&0.28\\\\ \\cline{2-5}\n&STO&$204$&$114805.8$ &0 \\\\ \\hline\n\\end{tabular}\n\\end{table}\n\n\\begin{figure}\\centering\n\\begin{subfigure}{0.24\\textwidth}\n\\includegraphics[width=\\textwidth]{pvi1.eps}\\caption{Generation supply curves.}\n\\end{subfigure}\n\\begin{subfigure}{0.24\\textwidth}\n\\includegraphics[width=\\textwidth]{cvi1.eps}\\caption{Expected overall cost.}\n\\end{subfigure}\n\\caption{High wind scenario $p=(0.1,0.9)$.}\\vspace{-1em}\n\\label{fig:118case1}\\end{figure}\n\n\\begin{figure}\\centering\n\\begin{subfigure}{0.24\\textwidth}\n\\includegraphics[width=\\textwidth]{pvi2.eps}\\caption{Generation supply curves.}\n\\end{subfigure}\n\\begin{subfigure}{0.24\\textwidth}\n\\includegraphics[width=\\textwidth]{cvi2.eps}\\caption{Expected overall cost.}\n\\end{subfigure}\n\\caption{Medium wind scenario $p=(0.5,0.5)$. }\\vspace{-1em}\n\\label{fig:118case2}\\end{figure}\n\n\\begin{figure}\\centering\n\\begin{subfigure}{0.24\\textwidth}\n\\includegraphics[width=\\textwidth]{pvi3.eps}\\caption{Generation supply curves.}\n\\end{subfigure}\n\\begin{subfigure}{0.24\\textwidth}\n\\includegraphics[width=\\textwidth]{cvi3.eps}\\caption{Expected overall cost.}\n\\end{subfigure}\n\\caption{Low wind scenario $p=(0.9,0.1)$. }\n\\label{fig:118case3}\\end{figure}\n\nSince all generation cost functions are quadratic, the price functions are continuous and piecewise affine. The performances of TO and STO schedule are similar to that in the 6-bus system example. The expected overall cost is minimized at the STO schedule in all three cases, as indicated by the red circles in Figure \\ref{fig:118case1}-\\ref{fig:118case3}, and the prices converge at the schedule of STO, as shown in Table \\ref{table:base118}. As for TO schedules, the counter intuitive flows are observed in the high wind and medium wind scenario, and the interface under utilization happens in the low wind scenario.\n\\subsubsection{Impact of interface congestion}\nTo investigate the impact of the interface congestion, we tested all three wind scenarios again under the same setting except the interface capacity which was set as $250$ MW in this case. \n\nFrom the results shown in Table \\ref{table:congestion118}, the presence of the interface constraint only influences the performances in the high wind scenario. The price separation happens in both TO and STO, because the binding interface constraint prevents the economic interface flow.\n\\begin{table}\\caption{Impact of interface congestion.}\\label{table:congestion118}\\centering\nScenario&Method&$q^*$&$\\mathbb{E}[\\text{Cost}(q^*)]$&$\\mathbb{E}[\\Delta\\pi(q^*)]$\\\\ \\hline\n\\multirow{2}{*}{$p=(0.1,0.9)$}&TO&$250$&$104754.8$&0.6\\\\ \\cline{2-5}\n&STO&$250$&$104754.8$&0.6\\\\ \\hline\n\\multirow{2}{*}{$p=(0.5,0.5)$}&TO&$242.6$&$109798.1$&-0.29\\\\ \\cline{2-5}\n&STO&$236$&$109797.1$ &0 \\\\ \\hline\n\\multirow{2}{*}{$p=(0.9,0.1)$}&TO&$197$&$114806.8$&0.28\\\\ \\cline{2-5}\n&STO&$204$&$114805.8$ &0 \\\\ \\hline\n\\end{tabular}\\end{table}\n\\subsubsection{Impact of proxy bus location}\nWe finally tested the impact of proxy bus location in the medium wind scenario, \\textit{i.e.} $p=(0.5,0.5)$. Tie line bus and internal bus (wind bus) were selected as the proxy buses. \n\\begin{table}[ht]\\caption{Impact of the proxy bus location.}\\label{table:proxy2}\\centering\n&\\multirow{2}{*}{\\parbox{.8cm}{\\centering Proxy Bus}}&\\multicolumn{2}{|c|}{$q^*$}&\\multicolumn{2}{|c|}{$\\mathbb{E}[\\text{Cost}(q^*)]$}\\\\ \\cline{3-6}\n&&TO&STO&TO&STO\\\\ \\hline\n\\multirow{2}{*}{\\parbox{.8cm}{\\centering Internal Bus}}&(1,118)&244.1&238.1&109780.5&109779.7\\\\ \\cline{2-6}\n&(6,42)&242.6&236&$109798.1$&$109797.1$\\\\  \\hline\n\\multirow{5}{*}{\\parbox{.8cm}{\\centering Tie Line Bus}}&(8,30)&253&271&109569.8&109565.3\\\\ \\cline{2-6}\n&(11,13)&78.4&126.5&110595.1&110540.4\\\\ \\cline{2-6}\n&(12,14)&28.8&-15.4&110865.5&110828.6\\\\ \\cline{2-6}\n&(12,16)&34&4.7&110847.2&110833.4\\\\ \\cline{2-6}\n&(12,117)&16.8&-23.3&110890.5&110785.7\\\\ \\hline\n\\end{tabular}\\end{table}\nFrom the results presented in Table \\ref{table:proxy2}, we observe that the interchange schedule and the associated expected cost are very sensitive to the location of the proxy bus in both TO and STO. With different selections of the proxy bus, the direction of the interchange schedule can be different, for example, (1,118) and (12, 117). Although there are several considerations that can guide the choice of proxy bus location \\cite{Harvey03Proxy}, no theoretical results show a universal selection rule. \n\n\n\\section{Conclusion}\\label{sec:con}\nThis paper presents a stochastic interchange scheduling technique that incorporates load and renewable generation uncertainties. Using the forecast of the expected LMP at the proxy bus, the proposed approach obtains the optimal interchange schedule from a deterministic optimization problem that maximizes the expected economic surplus. The essence of this technique is providing a way to reduce a two-stage stochastic optimization problem into a deterministic optimization problem with an one-dimensional decision. In addition, the proposed technique does not require any iteration between operators during the scheduling procedure. A one-time information exchange is sufficient for the optimal scheduling. \n\\appendix\n\\begin{proof}[Proof of Lemma \\ref{lem:mono}]\nDenote the Lagrangian function for $(P_{2i})$ by $\\mathcal{L}_{2i}, i\\in\\{1,2\\}$. By Lemma \\ref{lem:mqp}, $c_i(g_i^*(q))$ is convex and quadratic in each critical region, so the derivative exists. By the Envelope Theorem,\n", "index": 23, "text": "\n\\[\\frac{\\partial c_1(g_1^*(q))}{\\partial q}=\\frac{\\partial \\mathcal{L}_{21}}{\\partial q}=\\pi_1(q),\\frac{\\partial c_2(g_2^*(q))}{\\partial q}=\\frac{\\partial \\mathcal{L}_{22}}{\\partial q}=-\\pi_2(q).\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex9.m1\" class=\"ltx_Math\" alttext=\"\\frac{\\partial c_{1}(g_{1}^{*}(q))}{\\partial q}=\\frac{\\partial\\mathcal{L}_{21}%&#10;}{\\partial q}=\\pi_{1}(q),\\frac{\\partial c_{2}(g_{2}^{*}(q))}{\\partial q}=\\frac%&#10;{\\partial\\mathcal{L}_{22}}{\\partial q}=-\\pi_{2}(q).\" display=\"block\"><mrow><mrow><mrow><mfrac><mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><msub><mi>c</mi><mn>1</mn></msub></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msubsup><mi>g</mi><mn>1</mn><mo>*</mo></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>q</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>q</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mo>\u2202</mo><mo>\u2061</mo><msub><mi class=\"ltx_font_mathcaligraphic\">\u2112</mi><mn>21</mn></msub></mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>q</mi></mrow></mfrac><mo>=</mo><mrow><msub><mi>\u03c0</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>q</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>,</mo><mrow><mfrac><mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><msub><mi>c</mi><mn>2</mn></msub></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msubsup><mi>g</mi><mn>2</mn><mo>*</mo></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>q</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>q</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mo>\u2202</mo><mo>\u2061</mo><msub><mi class=\"ltx_font_mathcaligraphic\">\u2112</mi><mn>22</mn></msub></mrow><mrow><mo>\u2202</mo><mo>\u2061</mo><mi>q</mi></mrow></mfrac><mo>=</mo><mrow><mo>-</mo><mrow><msub><mi>\u03c0</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>q</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}]