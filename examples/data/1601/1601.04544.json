[{"file": "1601.04544.tex", "nexttext": "\nwhere $\\mathscr{\\hat H}$ is the static Hamiltonian, that describes the system itself\nand $F(t) \\hat D_\\mu$ is the coupling to a probe pulse\nvia the dipole operator\n\n", "itemtype": "equation", "pos": 9172, "prevtext": "\n\n\\title{\nTailored pump-probe transient spectroscopy with time-dependent\ndensity-functional theory: controlling absorption spectra\n}\n\n\\author{Jessica Walkenhorst}\n\\affiliation{Nano-Bio Spectroscopy Group and ETSF Scientific Development Center, Departamento de Quimica, \nUniversidad del Pa\\'is Vasco UPV/EHU, Avenida de \nTolosa 72, E-20018, San Sebasti\\'an, Spain}\\email[]{walkenho@gmail.com}\n\\author{Umberto De~Giovannini}\\email[]{umberto.degiovannini@ehu.es}\n\\affiliation{Nano-Bio Spectroscopy Group and ETSF Scientific Development Center, Departamento de Quimica, \nUniversidad del Pa\\'is Vasco UPV/EHU, Avenida de \nTolosa 72, E-20018, San Sebasti\\'an, Spain}\n\\author{Alberto Castro}\\email[]{acastro@bifi.es}\n\\affiliation{ARAID Foundation - Institute for Biocomputation\nand Physics of Complex Systems, University of Zaragoza Mariano Esquillor Go\u00cc\u0081mez s/n, 50018 Zaragoza, (Spain)}\n\\author{Angel Rubio}\\email[]{angel.rubio@mpsd.mpg.de}\n\\affiliation{Nano-Bio Spectroscopy Group and ETSF Scientific Development Center, Departamento de Quimica, \nUniversidad del Pa\\'is Vasco UPV/EHU, Avenida de \nTolosa 72, E-20018, San Sebasti\\'an, Spain}\n\\affiliation{Max Planck Institute for the Structure and Dynamics of Matter\n  Hamburg, Germany}\n\n\n\n\\begin{abstract}\nRecent advances in laser technology allow us\n  to follow electronic motion at its natural time-scale with ultra-fast time resolution,\n  leading the way towards attosecond physics experiments of extreme precision.\n  In this work, we assess the use of\n  tailored pumps in order to enhance (or reduce) some given features of the\n  probe absorption (for example, absorption in the visible range of otherwise\n  transparent samples). This type of manipulation of the system response could\n  be helpful for its full characterization, since it would allow to visualize\n  transitions that are dark when using unshaped pulses. In order to\n  investigate these possibilities, we perform first a theoretical analysis of the\n  non-equilibrium response function in this context, aided by one simple\n  numerical model of the Hydrogen atom. Then, we proceed to investigate the\n  feasibility of using time-dependent density-functional theory as a means to\n  implement, theoretically, this absorption-optimization idea, for more\n  complex atoms or molecules. \n  We conclude that the proposed idea could in principle be brought to the laboratory: tailored pump pulses \n  can excite systems into light-absorbing states. However, \n  we also highlight the severe numerical and theoretical difficulties posed by the problem: \n  large-scale non-equilibrium quantum dynamics are cumbersome, even with TDDFT, \n  and the shortcomings of state-of-the-art TDDFT functionals \n  may still be serious for these out-of-equilibrium situations.\n\\end{abstract}\n\n\\date{\\today}\n\n\\maketitle\n\n\n\\section{Introduction} \n\\label{sec:introduction}\n\nTime-resolved pump-probe experiments are powerful\ntechniques to study the dynamics of atoms and molecules: \nthe pump pulse triggers the dynamics, which is then monitored by measuring the time-dependent \nresponse of the excited system to a probe pulse. \nThe time-resolution of this technique has increased over the years, and \nnowadays, it can be used to observe the electron dynamics in real time, giving rise to the field of \nattosecond physics \\cite{krausz-2009, scrinzi-2006}.\n\nA suitable setup to observe charge-neutral excitations is the time-resolved photoabsorption or transient absorption\nspectroscopy (TAS), where the time-dependent optical absorption of the probe is measured. \nTAS can of course be used to look at longer time resolutions:\nif we look at molecular reaction on the\nscale of tens or hundreds of femtoseconds, the atomic structure will\nhave time to re-arrange. These techniques are thus mainly\nemployed in femtochemistry \\cite{book-zewail, zewail-2000} \nto observe and control modification, creation, or destruction of bonds.\nTAS has been successfully employed, for example, to watch the\nfirst photo-synthetic events in cholorophylls and\ncarotenoids \\cite{berera2009}\n(a review describing\nthe essentials of this technique can be found in\nRef.~\\cite{foggi2001}).  \nIf, on the contrary, one wants to study the electronic dynamics \\emph{only}, \ndisentangling it from the vibronic degrees of freedom,\nthen one must perform TAS with attosecond pulses \\cite{pfeifer2008}, \na possibility recently demonstrated \\cite{goulielmakis-2010, holler2011}.\n\n\nThe theoretical description of these processes, which involve non-linear\nlight-matter interaction, and the ensuing non-equilibrium electron dynamics, is\nchallenging. Time-dependent density functional theory (TDDFT) \\cite{runge-1984, book-tddft,tddft-specialissue} \nis a well-established tool\nto compute the response of a many-electron system to arbitrary perturbations.\nTraditionally, the vast majority of TDDFT applications have addressed the first-order\nresponse of the ground-state system to weak electric fields -- which\ncan provide the absorption spectrum, the optically-allowed excitation\nenergies and oscillator strengths, etc. Nevertheless, the extension of TDDFT to the \ndescription of excited state spectral properties and its ability to simulate\ntransient absorption spectroscopy (TAS) \nhas recently been demonstrated \\cite{degiovannini-2012, degiovannini-2013}.\n\nIn this work, we are not only interested in simulating attosecond\nTAS of atoms and molecules, but in studying the possibility of tailoring the\npump to control the spectra. In fact, the measurement and control of ultrafast processes are inherently intertwined:\nquantum optimal control theory (QOCT)~\\cite{Brif2010, werschnik-2007} can be viewed as the\n\\emph{inverse} of theoretical spectroscopy: rather than attempting to predict the\nreaction of a quantum system to a perturbation, it attempts to find the\nperturbation that induces a given reaction in a given quantum system. It is\nthe quantum version of the more general control theory \n\\cite{Shi1988, peirce-1988, kosloff-1989, Luenberger1969,Luenberger1979}, which was needed\ngiven the fast advances in experimental quantum \ncontrol~\\cite{Brumer1986541,Brumer1986177,shapiro-2003,Tannor1985541,Herek199415, Gaubatz1988463, \ndoi:10.1146/annurev.physchem.59.032607.093818,judson-1992,bardeen-1997,assion-1998}.\n\nThe possibility of combining QOCT with TDDFT has been established recently~\\cite{castro-2012}. Furthermore it has been\nshown, that it can be used to optimize strong-field ionization \\cite{hellgren-2013}, photo-induced dissociation\n\\cite{castro-2013} and is compatible with Ehrenfest dynamics \\cite{castro-2014}. Very recently, Krieger \\emph{et al}.\\\nused TDDFT to study the influence of laser intensity, frequency and duration on the laser-induced \ndemagnetization process in bulk materials, which takes place on time scales of $<$ 20 fs \\cite{krieger-2015}. \n\nHere, we take the first steps towards the use of this combination of TDDFT with QOCT\nto control excited state spectra of finite systems. This idea is very much related to the\nconcept of electromagnetically induced transparency \\cite{harris-1990, fleischhauer-2005}.\nControl of the absorption spectra may mean its elimination or reduction, or\nits increase.\nOur \\emph{gedanken} setup throughout this paper is the following: for a\ncertain time interval $[0,T]$ a quantum system is driven by a ``classical'' pump pulse\n$\\mathscr{E}(t)$ whose precise shape can be manipulated. After the pump has ended, the (linear) \nresponse of the system to some later perturbation is calculated. \nOur goal is to design the shape of the pump pulse in such a way, that the response \nto some later perturbation is \\emph{optimal} in some given way. \nIn particular, we demonstrate how the tailored pump pulses may be used to\ntransform a transparent atom or molecule into an excited one that absorbs in\nthe visible.\n\nThis paper is structured as follows. In Section~\\ref{sec:spec_ex}, we analyze \nthe optical linear response of a system in an excited state, looking at the location \nand the shape of the resulting spectral peaks and their time-dependence. In Section~\\ref{sec:qoct} \nwe present the theory of quantum optimal control and how it can be applied to optimize spectral \nproperties of systems in excited states. \nWe then bring these concepts into application in Section~\\ref{sec:applications}. In Section~\\ref{sec:hydrogen}\nwe illustrate the conclusions gained in Section~\\ref{sec:spec_ex} using the analyticly solvable Hydrogen atom.\nWe then proceed to demonstrate control of the excited state properties in this system. \nIn Section~\\ref{sec:tddft} we finally combine our methodology with\ntime-dependent density functional theory, \nfirst for the Helium atom, and then for the Methane molecule.\nWe conclude our work in Section~\\ref{sec:conclusions}.\n\n\n\\section{Short Review of Out-of-equilibrium (Pumped) Absorption Spectra}\\label{sec:spec_ex} \n\nIn pump-probe spectroscopy, the probe may arrive after, during, or even before\nthe pump; in this work, we consider a non-overlapping regime in which the\nprobe arrives after the pump has vanished.\nThe time evolution of a system after the end of the pump is described by the\nHamiltonian (atomic units will be used hereafter):\n\n", "index": 1, "text": "\\begin{equation}\n    \\hat H(t)=\\mathscr{\\hat H} + F(t) \\hat D_\\mu \\, ,\n    \\label{eq:hamiltonian_nonoverlapping}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"\\hat{H}(t)=\\mathscr{\\hat{H}}+F(t)\\hat{D}_{\\mu}\\,,\" display=\"block\"><mrow><mrow><mrow><mover accent=\"true\"><mi>H</mi><mo stretchy=\"false\">^</mo></mover><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mover accent=\"true\"><mi class=\"ltx_font_mathscript\">\u210b</mi><mo stretchy=\"false\">^</mo></mover><mo>+</mo><mrow><mi>F</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mpadded width=\"+1.7pt\"><msub><mover accent=\"true\"><mi>D</mi><mo stretchy=\"false\">^</mo></mover><mi>\u03bc</mi></msub></mpadded></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\nin which $N$ is the number of electrons in the system, and $\\mu=x,y,z$\ndetermines the polarization direction.\nNote, that the implementation of the coupling via the dipole operator is an approximation and could be removed \nin practical implementations since the theory handles non-dipolar fields. \nAlso note, that we work in the length gauge all over the paper.\n\nIf, at the time $t=T$, the system has been driven by the previous pump $\\mathscr{E}$ to the state\n$\\vert\\Psi\\left[\\mathscr{E}\\right](T)\\rangle$, the complete dipole-dipole response function for the perturbation at\nlater times is given by:\n\\begin{eqnarray} \\label{eq:retarded_response_function_recast}\n\\chi_{\\hat{D}_\\mu,\\hat{D}_\\nu}&&\\left[\\mathscr{E}\\right](t,t') = \\\\\n&& -i\\theta(t-t')\n\\langle\\Psi\\left[\\mathscr{E}\\right](T)\\vert\n\\left[\n\\hat{D}_{\\mu I}(t),\\hat{D}_{\\nu I}(t')\n\\right]\n\\vert\\Psi\\left[\\mathscr{E}\\right](T)\\rangle\\, ,\\nonumber   \n\\end{eqnarray}\nwhere the operators are expressed in the interaction picture.\n\nThe difference between Eq.~\\eqref{eq:retarded_response_function_recast} and\nthe equilibrium response function \\cite{book-fetter} or the response function of a system in \na many-body eigenstate is that the two times \n$t$ and $t'$ cannot be reduced to only one by making\nuse of the time-translational invariance.\nSince $\\vert\\Psi\\left[\\mathscr{E}\\right](T)\\rangle$ depends on the pump, \nthe first-order response of the system does explicitly depend on both the\npump $\\mathscr{E}$ and the probe $F$. It is given by:\n\n", "itemtype": "equation", "pos": 9464, "prevtext": "\nwhere $\\mathscr{\\hat H}$ is the static Hamiltonian, that describes the system itself\nand $F(t) \\hat D_\\mu$ is the coupling to a probe pulse\nvia the dipole operator\n\n", "index": 3, "text": "\\begin{equation}\n    \\hat D_{\\mu}=-\\sum_{i=1}^N \\hat r_{\\mu}^{(i)}\n    \\label{eq:dipole_op}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"\\hat{D}_{\\mu}=-\\sum_{i=1}^{N}\\hat{r}_{\\mu}^{(i)}\" display=\"block\"><mrow><msub><mover accent=\"true\"><mi>D</mi><mo stretchy=\"false\">^</mo></mover><mi>\u03bc</mi></msub><mo>=</mo><mrow><mo>-</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msubsup><mover accent=\"true\"><mi>r</mi><mo stretchy=\"false\">^</mo></mover><mi>\u03bc</mi><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></msubsup></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\nAn intuitive physical meaning can be gained from this equation for the\nresponse function: it is the first order of the system response, if we consider\na sudden perturbation at $t'=T+\\tau: F(t) = \\delta(t-(T+\\tau))$, where $\\tau$ denotes the \ndelay between the end of the pump and the perturbation:\n\n", "itemtype": "equation", "pos": 11069, "prevtext": "\nin which $N$ is the number of electrons in the system, and $\\mu=x,y,z$\ndetermines the polarization direction.\nNote, that the implementation of the coupling via the dipole operator is an approximation and could be removed \nin practical implementations since the theory handles non-dipolar fields. \nAlso note, that we work in the length gauge all over the paper.\n\nIf, at the time $t=T$, the system has been driven by the previous pump $\\mathscr{E}$ to the state\n$\\vert\\Psi\\left[\\mathscr{E}\\right](T)\\rangle$, the complete dipole-dipole response function for the perturbation at\nlater times is given by:\n\\begin{eqnarray} \\label{eq:retarded_response_function_recast}\n\\chi_{\\hat{D}_\\mu,\\hat{D}_\\nu}&&\\left[\\mathscr{E}\\right](t,t') = \\\\\n&& -i\\theta(t-t')\n\\langle\\Psi\\left[\\mathscr{E}\\right](T)\\vert\n\\left[\n\\hat{D}_{\\mu I}(t),\\hat{D}_{\\nu I}(t')\n\\right]\n\\vert\\Psi\\left[\\mathscr{E}\\right](T)\\rangle\\, ,\\nonumber   \n\\end{eqnarray}\nwhere the operators are expressed in the interaction picture.\n\nThe difference between Eq.~\\eqref{eq:retarded_response_function_recast} and\nthe equilibrium response function \\cite{book-fetter} or the response function of a system in \na many-body eigenstate is that the two times \n$t$ and $t'$ cannot be reduced to only one by making\nuse of the time-translational invariance.\nSince $\\vert\\Psi\\left[\\mathscr{E}\\right](T)\\rangle$ depends on the pump, \nthe first-order response of the system does explicitly depend on both the\npump $\\mathscr{E}$ and the probe $F$. It is given by:\n\n", "index": 5, "text": "\\begin{equation}\nD^{(1)}_{\\mu\\nu}\\left[\\mathscr{E}, F\\right](t) = \\int_{T}^{t}\\!{\\rm d}t' F(t')\\chi_{\\hat{D}_\\mu,\\hat{D}_\\nu}\\left[\\mathscr{E}\\right](t,t')\\,.\n    \\label{eq:dipole_response}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"D^{(1)}_{\\mu\\nu}\\left[\\mathscr{E},F\\right](t)=\\int_{T}^{t}\\!{\\rm d}t^{\\prime}F%&#10;(t^{\\prime})\\chi_{\\hat{D}_{\\mu},\\hat{D}_{\\nu}}\\left[\\mathscr{E}\\right](t,t^{%&#10;\\prime})\\,.\" display=\"block\"><mrow><mrow><mrow><msubsup><mi>D</mi><mrow><mi>\u03bc</mi><mo>\u2062</mo><mi>\u03bd</mi></mrow><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>\u2062</mo><mrow><mo>[</mo><mi class=\"ltx_font_mathscript\">\u2130</mi><mo>,</mo><mi>F</mi><mo>]</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mpadded width=\"-1.7pt\"><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mi>T</mi><mi>t</mi></msubsup></mpadded><mrow><mrow><mo>d</mo><msup><mi>t</mi><mo>\u2032</mo></msup></mrow><mo>\u2062</mo><mi>F</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>t</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mi>\u03c7</mi><mrow><msub><mover accent=\"true\"><mi>D</mi><mo stretchy=\"false\">^</mo></mover><mi>\u03bc</mi></msub><mo>,</mo><msub><mover accent=\"true\"><mi>D</mi><mo stretchy=\"false\">^</mo></mover><mi>\u03bd</mi></msub></mrow></msub><mo>\u2062</mo><mrow><mo>[</mo><mi class=\"ltx_font_mathscript\">\u2130</mi><mo>]</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo>,</mo><msup><mi>t</mi><mo>\u2032</mo></msup><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\nThis object contains all the necessary information about the interacting system to compute the absorption\nof any given probe, as long as it is weak enough for the response to be linear. In \norder to analyze it, it is useful to take the Fourier transform with respect\nto the variable $t$, and expand\nEq.~\\eqref{eq:retarded_response_function_recast} in an eigenbasis\nof the static Hamiltonian $\\mathscr{\\hat H}$ \n\n", "itemtype": "equation", "pos": 11572, "prevtext": "\nAn intuitive physical meaning can be gained from this equation for the\nresponse function: it is the first order of the system response, if we consider\na sudden perturbation at $t'=T+\\tau: F(t) = \\delta(t-(T+\\tau))$, where $\\tau$ denotes the \ndelay between the end of the pump and the perturbation:\n\n", "index": 7, "text": "\\begin{equation}\n    \\chi_{\\hat{D}_\\mu,\\hat{D}_\\nu}\\left[\\mathscr{E}\\right](t,T+\\tau) =\n    D^{(1)}_{\\mu\\nu}\n    \\left[\\mathscr{E}, \\delta_{T+\\tau}\\right](t) \\,.\n    \\label{eq:first_order_response_deltafunction}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"\\chi_{\\hat{D}_{\\mu},\\hat{D}_{\\nu}}\\left[\\mathscr{E}\\right](t,T+\\tau)=D^{(1)}_{%&#10;\\mu\\nu}\\left[\\mathscr{E},\\delta_{T+\\tau}\\right](t)\\,.\" display=\"block\"><mrow><mrow><mrow><msub><mi>\u03c7</mi><mrow><msub><mover accent=\"true\"><mi>D</mi><mo stretchy=\"false\">^</mo></mover><mi>\u03bc</mi></msub><mo>,</mo><msub><mover accent=\"true\"><mi>D</mi><mo stretchy=\"false\">^</mo></mover><mi>\u03bd</mi></msub></mrow></msub><mo>\u2062</mo><mrow><mo>[</mo><mi class=\"ltx_font_mathscript\">\u2130</mi><mo>]</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo>,</mo><mrow><mi>T</mi><mo>+</mo><mi>\u03c4</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><msubsup><mi>D</mi><mrow><mi>\u03bc</mi><mo>\u2062</mo><mi>\u03bd</mi></mrow><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>\u2062</mo><mrow><mo>[</mo><mi class=\"ltx_font_mathscript\">\u2130</mi><mo>,</mo><msub><mi>\u03b4</mi><mrow><mi>T</mi><mo>+</mo><mi>\u03c4</mi></mrow></msub><mo>]</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\nobtaining a Lehmann representation for the time-dependent non-equilibrium response function:\n\\begin{eqnarray}\\label{eq:generalized_lehmann_representation_real_operators}\n    \\chi_{\\hat{D}_\\mu, \\hat{D}_\\nu}&&\\left[\\mathscr{E}\\right](\\omega, T+\\tau) =\\\\ \n    &&\\SumInt_{jkm} d^\\mu_{jm}d^\\nu_{mk} \n       \\left\\{ \n         \\frac{\\gamma_{j}\\gamma_{k}^*e^{i\\omega_{jk}\\tau}}{\\omega+\\omega_{jm}+i\\sfrac{\\Gamma}{2}}\n        -\\frac{\\gamma_{j}^*\\gamma_{k}e^{-i\\omega_{jk}\\tau}}{\\omega-\\omega_{jm}+i\\sfrac{\\Gamma}{2}}\n            \\right\\} \\nonumber\n\\end{eqnarray}\nin terms of the exact energy differences $\\omega_{jk}=\\varepsilon_k-\\varepsilon_j$, \nthe dipole-matrix elements $d^\\mu_{jm}=\\langle\\Phi_j|\\hat D_\\mu|\\Phi_m\\rangle\\in\\mathbb{R}$\n\nand the pump-probe delay $\\tau$.\nA similar representation in the case of non-equilibrium\nspectroscopy \nhas been recently presented in a similar context~\\cite{perfetto-2015}.\n\nBy writing $\\gamma_j=|\\gamma_j|e^{i\\varphi_j}$ Eq.~\\eqref{eq:generalized_lehmann_representation_real_operators} turns into\n\n", "itemtype": "equation", "pos": 12210, "prevtext": "\nThis object contains all the necessary information about the interacting system to compute the absorption\nof any given probe, as long as it is weak enough for the response to be linear. In \norder to analyze it, it is useful to take the Fourier transform with respect\nto the variable $t$, and expand\nEq.~\\eqref{eq:retarded_response_function_recast} in an eigenbasis\nof the static Hamiltonian $\\mathscr{\\hat H}$ \n\n", "index": 9, "text": "\\begin{equation}\n    \\label{eq:wavefunction_eigenstates}\n   \\vert\\Psi\\left[\\mathscr{E}\\right](T)\\rangle = \\SumInt_{j=1}^{\\infty}\\gamma_{j} |\\Phi_j\\rangle , \\qquad \\mathscr{\\hat\n    H}|\\Phi_j\\rangle=\\varepsilon_j |\\Phi_j\\rangle \\,,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"|\\Psi\\left[\\mathscr{E}\\right](T)\\rangle=\\SumInt_{j=1}^{\\infty}\\gamma_{j}|\\Phi_%&#10;{j}\\rangle,\\qquad\\mathscr{\\hat{H}}|\\Phi_{j}\\rangle=\\varepsilon_{j}|\\Phi_{j}%&#10;\\rangle\\,,\" display=\"block\"><mrow><mrow><mrow><mrow><mo fence=\"true\" stretchy=\"false\">|</mo><mrow><mi mathvariant=\"normal\">\u03a8</mi><mo>\u2062</mo><mrow><mo>[</mo><mi class=\"ltx_font_mathscript\">\u2130</mi><mo>]</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>T</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">\u27e9</mo></mrow><mo>=</mo><mrow><msubsup><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\SumInt</mtext></merror><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi mathvariant=\"normal\">\u221e</mi></msubsup><mo>\u2062</mo><msub><mi>\u03b3</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo fence=\"true\" stretchy=\"false\">|</mo><msub><mi mathvariant=\"normal\">\u03a6</mi><mi>j</mi></msub><mo stretchy=\"false\">\u27e9</mo></mrow></mrow></mrow><mo rspace=\"22.5pt\">,</mo><mrow><mrow><mover accent=\"true\"><mi class=\"ltx_font_mathscript\">\u210b</mi><mo stretchy=\"false\">^</mo></mover><mo>\u2062</mo><mrow><mo fence=\"true\" stretchy=\"false\">|</mo><msub><mi mathvariant=\"normal\">\u03a6</mi><mi>j</mi></msub><mo stretchy=\"false\">\u27e9</mo></mrow></mrow><mo>=</mo><mrow><msub><mi>\u03b5</mi><mi>j</mi></msub><mo>\u2062</mo><mrow><mo fence=\"true\" stretchy=\"false\">|</mo><msub><mi mathvariant=\"normal\">\u03a6</mi><mi>j</mi></msub><mo rspace=\"4.2pt\" stretchy=\"false\">\u27e9</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\nwith\n\n", "itemtype": "equation", "pos": 13486, "prevtext": "\nobtaining a Lehmann representation for the time-dependent non-equilibrium response function:\n\\begin{eqnarray}\\label{eq:generalized_lehmann_representation_real_operators}\n    \\chi_{\\hat{D}_\\mu, \\hat{D}_\\nu}&&\\left[\\mathscr{E}\\right](\\omega, T+\\tau) =\\\\ \n    &&\\SumInt_{jkm} d^\\mu_{jm}d^\\nu_{mk} \n       \\left\\{ \n         \\frac{\\gamma_{j}\\gamma_{k}^*e^{i\\omega_{jk}\\tau}}{\\omega+\\omega_{jm}+i\\sfrac{\\Gamma}{2}}\n        -\\frac{\\gamma_{j}^*\\gamma_{k}e^{-i\\omega_{jk}\\tau}}{\\omega-\\omega_{jm}+i\\sfrac{\\Gamma}{2}}\n            \\right\\} \\nonumber\n\\end{eqnarray}\nin terms of the exact energy differences $\\omega_{jk}=\\varepsilon_k-\\varepsilon_j$, \nthe dipole-matrix elements $d^\\mu_{jm}=\\langle\\Phi_j|\\hat D_\\mu|\\Phi_m\\rangle\\in\\mathbb{R}$\n\nand the pump-probe delay $\\tau$.\nA similar representation in the case of non-equilibrium\nspectroscopy \nhas been recently presented in a similar context~\\cite{perfetto-2015}.\n\nBy writing $\\gamma_j=|\\gamma_j|e^{i\\varphi_j}$ Eq.~\\eqref{eq:generalized_lehmann_representation_real_operators} turns into\n\n", "index": 11, "text": "\\begin{align}\n    \\label{eq:lehmann2}\n    &\\chi_{\\hat D_\\mu, \\hat D_\\nu}\\left[\\mathscr{E}\\right](\\omega, T+\\tau) =  \\\\\n    &\\SumInt_{jkm} d^\\mu_{jm}d^\\nu_{mk} |\\gamma_j\\gamma_k|\n        \\left\\{ \n        \\frac{e^{i\\Theta_{kj}(\\tau)}}{\\omega+\\omega_{jm}+i\\sfrac{\\Gamma}{2}}\n        -\\frac{e^{-i\\Theta_{kj}(\\tau)}}{\\omega-\\omega_{jm}+i\\sfrac{\\Gamma}{2}}\n            \\right\\}\\nonumber\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\chi_{\\hat{D}_{\\mu},\\hat{D}_{\\nu}}\\left[\\mathscr{E}\\right](\\omega%&#10;,T+\\tau)=\" display=\"inline\"><mrow><mrow><msub><mi>\u03c7</mi><mrow><msub><mover accent=\"true\"><mi>D</mi><mo stretchy=\"false\">^</mo></mover><mi>\u03bc</mi></msub><mo>,</mo><msub><mover accent=\"true\"><mi>D</mi><mo stretchy=\"false\">^</mo></mover><mi>\u03bd</mi></msub></mrow></msub><mo>\u2062</mo><mrow><mo>[</mo><mi class=\"ltx_font_mathscript\">\u2130</mi><mo>]</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo>,</mo><mrow><mi>T</mi><mo>+</mo><mi>\u03c4</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mi/></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\SumInt_{jkm}d^{\\mu}_{jm}d^{\\nu}_{mk}|\\gamma_{j}\\gamma_{k}|\\left%&#10;\\{\\frac{e^{i\\Theta_{kj}(\\tau)}}{\\omega+\\omega_{jm}+i\\sfrac{\\Gamma}{2}}-\\frac{e%&#10;^{-i\\Theta_{kj}(\\tau)}}{\\omega-\\omega_{jm}+i\\sfrac{\\Gamma}{2}}\\right\\}\" display=\"inline\"><mrow><msub><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\SumInt</mtext></merror><mrow><mi>j</mi><mo>\u2062</mo><mi>k</mi><mo>\u2062</mo><mi>m</mi></mrow></msub><mo>\u2062</mo><msubsup><mi>d</mi><mrow><mi>j</mi><mo>\u2062</mo><mi>m</mi></mrow><mi>\u03bc</mi></msubsup><mo>\u2062</mo><msubsup><mi>d</mi><mrow><mi>m</mi><mo>\u2062</mo><mi>k</mi></mrow><mi>\u03bd</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mrow><msub><mi>\u03b3</mi><mi>j</mi></msub><mo>\u2062</mo><msub><mi>\u03b3</mi><mi>k</mi></msub></mrow><mo stretchy=\"false\">|</mo></mrow><mo>\u2062</mo><mrow><mo>{</mo><mrow><mstyle displaystyle=\"true\"><mfrac><msup><mi>e</mi><mrow><mi>i</mi><mo>\u2062</mo><msub><mi mathvariant=\"normal\">\u0398</mi><mrow><mi>k</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c4</mi><mo stretchy=\"false\">)</mo></mrow></mrow></msup><mrow><mi>\u03c9</mi><mo>+</mo><msub><mi>\u03c9</mi><mrow><mi>j</mi><mo>\u2062</mo><mi>m</mi></mrow></msub><mo>+</mo><mrow><mi>i</mi><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\sfrac</mtext></merror><mo>\u2062</mo><mi mathvariant=\"normal\">\u0393</mi><mo>\u2062</mo><mn>2</mn></mrow></mrow></mfrac></mstyle><mo>-</mo><mstyle displaystyle=\"true\"><mfrac><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi>i</mi><mo>\u2062</mo><msub><mi mathvariant=\"normal\">\u0398</mi><mrow><mi>k</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c4</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></msup><mrow><mrow><mi>\u03c9</mi><mo>-</mo><msub><mi>\u03c9</mi><mrow><mi>j</mi><mo>\u2062</mo><mi>m</mi></mrow></msub></mrow><mo>+</mo><mrow><mi>i</mi><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\sfrac</mtext></merror><mo>\u2062</mo><mi mathvariant=\"normal\">\u0393</mi><mo>\u2062</mo><mn>2</mn></mrow></mrow></mfrac></mstyle></mrow><mo>}</mo></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\nSince the absorption\ndepends on the imaginary part of the response function, we get from Eq.~\\eqref{eq:lehmann2}:\n\n\n", "itemtype": "equation", "pos": 13884, "prevtext": "\nwith\n\n", "index": 13, "text": "\\begin{equation}\n  \\Theta_{kj}(\\tau)=\\varphi_j-\\varphi_k-\\omega_{kj}\\tau \\, .\n  \\label{eq:theta}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"\\Theta_{kj}(\\tau)=\\varphi_{j}-\\varphi_{k}-\\omega_{kj}\\tau\\,.\" display=\"block\"><mrow><mrow><mrow><msub><mi mathvariant=\"normal\">\u0398</mi><mrow><mi>k</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c4</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><msub><mi>\u03c6</mi><mi>j</mi></msub><mo>-</mo><msub><mi>\u03c6</mi><mi>k</mi></msub><mo>-</mo><mrow><msub><mi>\u03c9</mi><mrow><mi>k</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mo>\u2062</mo><mpadded width=\"+1.7pt\"><mi>\u03c4</mi></mpadded></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\n\nwith the Rayleigh peaks\n\n", "itemtype": "equation", "pos": 14111, "prevtext": "\nSince the absorption\ndepends on the imaginary part of the response function, we get from Eq.~\\eqref{eq:lehmann2}:\n\n\n", "index": 15, "text": "\\begin{align}\\nonumber\n\n\n\n\n\n\n\n\n\\Im    \\chi_{\\hat D_\\mu, \\hat D_\\nu}\\left[\\mathscr{E}\\right](\\omega, T+\\tau) =  \n\\SumInt_{jkm} d^\\mu_{jm}d^\\nu_{mk} |\\gamma_j\\gamma_k|\n\\\\\\nonumber\n\\left \\{ \\cos (\\Theta_{kj}(\\tau))L(\\omega-\\omega_{jm}) + \\sin(\\Theta_{kj}(\\tau))R(\\omega-\\omega_{jm}) \\right. \\\\\\nonumber\n\\left.  - \\cos (\\Theta_{kj}(\\tau))L(\\omega+\\omega_{jm}) + \\sin(\\Theta_{kj}(\\tau))R(\\omega+\\omega_{jm}) \\right\\} \\\\\n\\label{eq:chi_final}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\par&#10;\\par&#10;\\par&#10;\\par&#10;\\par&#10;\\par&#10;\\par&#10;\\par&#10;\\Im\\chi_{\\hat{D}_{\\mu},%&#10;\\hat{D}_{\\nu}}\\left[\\mathscr{E}\\right](\\omega,T+\\tau)=\\SumInt_{jkm}d^{\\mu}_{jm%&#10;}d^{\\nu}_{mk}|\\gamma_{j}\\gamma_{k}|\" display=\"inline\"><mrow><mrow><mrow><mi mathvariant=\"normal\">\u2111</mi><mo>\u2061</mo><msub><mi>\u03c7</mi><mrow><msub><mover accent=\"true\"><mi>D</mi><mo stretchy=\"false\">^</mo></mover><mi>\u03bc</mi></msub><mo>,</mo><msub><mover accent=\"true\"><mi>D</mi><mo stretchy=\"false\">^</mo></mover><mi>\u03bd</mi></msub></mrow></msub></mrow><mo>\u2062</mo><mrow><mo>[</mo><mi class=\"ltx_font_mathscript\">\u2130</mi><mo>]</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo>,</mo><mrow><mi>T</mi><mo>+</mo><mi>\u03c4</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><msub><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\SumInt</mtext></merror><mrow><mi>j</mi><mo>\u2062</mo><mi>k</mi><mo>\u2062</mo><mi>m</mi></mrow></msub><mo>\u2062</mo><msubsup><mi>d</mi><mrow><mi>j</mi><mo>\u2062</mo><mi>m</mi></mrow><mi>\u03bc</mi></msubsup><mo>\u2062</mo><msubsup><mi>d</mi><mrow><mi>m</mi><mo>\u2062</mo><mi>k</mi></mrow><mi>\u03bd</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">|</mo><mrow><msub><mi>\u03b3</mi><mi>j</mi></msub><mo>\u2062</mo><msub><mi>\u03b3</mi><mi>k</mi></msub></mrow><mo stretchy=\"false\">|</mo></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\left\\{\\cos(\\Theta_{kj}(\\tau))L(\\omega-\\omega_{jm})+\\sin(\\Theta_{%&#10;kj}(\\tau))R(\\omega-\\omega_{jm})\\right.\" display=\"inline\"><mrow><mo>{</mo><mi>cos</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"normal\">\u0398</mi><mrow><mi>k</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mrow><mo stretchy=\"false\">(</mo><mi>\u03c4</mi><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">)</mo></mrow><mi>L</mi><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo>-</mo><msub><mi>\u03c9</mi><mrow><mi>j</mi><mo>\u2062</mo><mi>m</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><mo>+</mo><mi>sin</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"normal\">\u0398</mi><mrow><mi>k</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mrow><mo stretchy=\"false\">(</mo><mi>\u03c4</mi><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">)</mo></mrow><mi>R</mi><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo>-</mo><msub><mi>\u03c9</mi><mrow><mi>j</mi><mo>\u2062</mo><mi>m</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\left.-\\cos(\\Theta_{kj}(\\tau))L(\\omega+\\omega_{jm})+\\sin(\\Theta_{%&#10;kj}(\\tau))R(\\omega+\\omega_{jm})\\right\\}\" display=\"inline\"><mrow><mo>-</mo><mi>cos</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"normal\">\u0398</mi><mrow><mi>k</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mrow><mo stretchy=\"false\">(</mo><mi>\u03c4</mi><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">)</mo></mrow><mi>L</mi><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo>+</mo><msub><mi>\u03c9</mi><mrow><mi>j</mi><mo>\u2062</mo><mi>m</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><mo>+</mo><mi>sin</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"normal\">\u0398</mi><mrow><mi>k</mi><mo>\u2062</mo><mi>j</mi></mrow></msub><mrow><mo stretchy=\"false\">(</mo><mi>\u03c4</mi><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">)</mo></mrow><mi>R</mi><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo>+</mo><msub><mi>\u03c9</mi><mrow><mi>j</mi><mo>\u2062</mo><mi>m</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><mo>}</mo></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\nand the Lorentzian peaks \n\n", "itemtype": "equation", "pos": 14584, "prevtext": "\n\nwith the Rayleigh peaks\n\n", "index": 17, "text": "\\begin{equation}\n    R(\\bar\\omega)=\\frac{\\bar \\omega}{\\bar\\omega^2+\\sfrac{\\Gamma^2}{4}}\n    \\label{eq:rayleigh}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m1\" class=\"ltx_Math\" alttext=\"R(\\bar{\\omega})=\\frac{\\bar{\\omega}}{\\bar{\\omega}^{2}+\\sfrac{\\Gamma^{2}}{4}}\" display=\"block\"><mrow><mrow><mi>R</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mi>\u03c9</mi><mo stretchy=\"false\">\u00af</mo></mover><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mfrac><mover accent=\"true\"><mi>\u03c9</mi><mo stretchy=\"false\">\u00af</mo></mover><mrow><msup><mover accent=\"true\"><mi>\u03c9</mi><mo stretchy=\"false\">\u00af</mo></mover><mn>2</mn></msup><mo>+</mo><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\sfrac</mtext></merror><mo>\u2062</mo><msup><mi mathvariant=\"normal\">\u0393</mi><mn>2</mn></msup><mo>\u2062</mo><mn>4</mn></mrow></mrow></mfrac></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\nThe absorption cross section tensor is:\n\n", "itemtype": "equation", "pos": 14737, "prevtext": "\nand the Lorentzian peaks \n\n", "index": 19, "text": "\\begin{equation}\n    L(\\bar\\omega)=\\frac{\\sfrac{\\Gamma}{2}}{\\bar\\omega^2+\\sfrac{\\Gamma^2}{4}} \\, .\n    \\label{eq:lorentzian}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E10.m1\" class=\"ltx_Math\" alttext=\"L(\\bar{\\omega})=\\frac{\\sfrac{\\Gamma}{2}}{\\bar{\\omega}^{2}+\\sfrac{\\Gamma^{2}}{4%&#10;}}\\,.\" display=\"block\"><mrow><mrow><mrow><mi>L</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mi>\u03c9</mi><mo stretchy=\"false\">\u00af</mo></mover><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mpadded width=\"+1.7pt\"><mfrac><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\sfrac</mtext></merror><mo>\u2062</mo><mi mathvariant=\"normal\">\u0393</mi><mo>\u2062</mo><mn>2</mn></mrow><mrow><msup><mover accent=\"true\"><mi>\u03c9</mi><mo stretchy=\"false\">\u00af</mo></mover><mn>2</mn></msup><mo>+</mo><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\sfrac</mtext></merror><mo>\u2062</mo><msup><mi mathvariant=\"normal\">\u0393</mi><mn>2</mn></msup><mo>\u2062</mo><mn>4</mn></mrow></mrow></mfrac></mpadded></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\nand for a random sample, the absorption will be its orientational average,\ni.e.\\ the \\emph{absorption coefficient}:\n\n", "itemtype": "equation", "pos": 14917, "prevtext": "\nThe absorption cross section tensor is:\n\n", "index": 21, "text": "\\begin{equation}\n\\sigma_{\\mu, \\nu}(\\omega)=\\frac{4\\pi\\omega}{c}\\Im\\chi_{\\hat D_{\\mu}\\hat D_{\\nu}}(\\omega)\\,,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E11.m1\" class=\"ltx_Math\" alttext=\"\\sigma_{\\mu,\\nu}(\\omega)=\\frac{4\\pi\\omega}{c}\\Im\\chi_{\\hat{D}_{\\mu}\\hat{D}_{%&#10;\\nu}}(\\omega)\\,,\" display=\"block\"><mrow><mrow><mrow><msub><mi>\u03c3</mi><mrow><mi>\u03bc</mi><mo>,</mo><mi>\u03bd</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mrow><mn>4</mn><mo>\u2062</mo><mi>\u03c0</mi><mo>\u2062</mo><mi>\u03c9</mi></mrow><mi>c</mi></mfrac><mo>\u2062</mo><mrow><mi mathvariant=\"normal\">\u2111</mi><mo>\u2061</mo><msub><mi>\u03c7</mi><mrow><msub><mover accent=\"true\"><mi>D</mi><mo stretchy=\"false\">^</mo></mover><mi>\u03bc</mi></msub><mo>\u2062</mo><msub><mover accent=\"true\"><mi>D</mi><mo stretchy=\"false\">^</mo></mover><mi>\u03bd</mi></msub></mrow></msub></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\nSince we are only interested in the trace, in the following, we concentrate on the diagonal terms,\nwe will omit hereafter the orientation indexes in order to ease the notation. \n\nWe now analyze Eq.~\\eqref{eq:chi_final} in more detail. First,\nas already pointed out in\nRef.~\\cite{perfetto-2015}, in this non-overlapping\nregime the dependence of the spectrum on both the pump-pulse and the delay time enters through the modification of the\npeak amplitudes and shapes exclusively: the peak positions are intrinsic properties of the many-body system.\n\nSecond, for the analysis of the effect of the pump pulse and of the pump-probe delay\non the spectrum, we can distinguish between three cases: \n(i) the system is in its ground state,  \n(ii) the system is in an excited eigenstate,\n(iii) the system is in a non-stationary state, i.e.\\ in a linear combination of non-degenerate eigenstates.\nIn all cases we focus on the positive part of the energy range, which we\ndenote by $\\omega^+$. The following shape analysis in \nterms of Lorentzian and Rayleigh contributions is for discrete peaks only. We denote this by replacing $\\SumInt$ by $\\sum$\n(we will comment on the continuum part later on in this section).\n\nIn case (i) $\\gamma_i=\\delta_{i0}$ and $\\Im \\chi_{\\hat D, \\hat D}\\left[\\mathscr{E}\\right](\\omega^+)$\nreduces to the usual Lehmann representation for the ground state spectrum:\n\n", "itemtype": "equation", "pos": 15157, "prevtext": "\nand for a random sample, the absorption will be its orientational average,\ni.e.\\ the \\emph{absorption coefficient}:\n\n", "index": 23, "text": "\\begin{equation}\n\\label{eq:absorption-coefficient}\n  \\bar\\sigma(\\omega)=\\frac{1}{3}{\\operatorname{Tr}}\\sigma(\\omega)\\,.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E12.m1\" class=\"ltx_Math\" alttext=\"\\bar{\\sigma}(\\omega)=\\frac{1}{3}{\\operatorname{Tr}}\\sigma(\\omega)\\,.\" display=\"block\"><mrow><mrow><mrow><mover accent=\"true\"><mi>\u03c3</mi><mo stretchy=\"false\">\u00af</mo></mover><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><mn>3</mn></mfrac><mo>\u2062</mo><mrow><mo>Tr</mo><mo>\u2061</mo><mi>\u03c3</mi></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\nAll peaks are positive and have Lorentzian shape. \nIn case (ii), where $\\gamma_i=\\delta_{i \\xi}$, the system is in an excited\neigenstate  $\\Phi_\\xi$, \nand therefore in the positive energy part of the spectrum we can find both positive and negative peaks of Lorentzian shape:\n\\begin{eqnarray}\\label{eq:chi_case2}\n \\Im    \\chi_{\\hat D, \\hat D}&&\\left[\\mathscr{E}\\right](\\omega^+) =\\\\  \n&&  \\sum_{\\xi < m} |d_{\\xi m}|^2 L(\\omega^+-\\omega_{\\xi m})  \n- \\sum_{\\xi > m} |d_{\\xi m}|^2 L(\\omega^++\\omega_{\\xi m}) \\, .\\nonumber\n\\end{eqnarray}\n\nNote, that in both cases (i) and (ii), the spectrum is time-independent and has only Lorentzian contributions. This is\nthe main difference to the case (iii), for non-stationary states.\nIn this case, the spectrum can be divided into two parts, \none time-independent and one oscillatory part due to interferences between the\ninvolved states:\n\\begin{eqnarray} \\label{eq:im_partitioning}\n    \\Im \\chi_{\\hat D, \\hat D}&&\\left[\\mathscr{E}\\right](\\omega^+, T+\\tau) = \\\\\n&&        \\Im \\chi_{\\hat D, \\hat D}^{0}\\left[\\mathscr{E}\\right](\\omega^+) \n    +   \\Im \\chi_{\\hat D, \\hat D}^{\\rm INT}\\left[\\mathscr{E}\\right](\\omega^+, T+\\tau)   \\nonumber\n\\end{eqnarray}\nThe equilibrium term consists of the sum over the stationary state spectra of the eigenstates involved, scaled by their\noccupations:\n\\begin{eqnarray}\n  \\Im &&   \\chi_{\\hat D, \\hat D}^{0}\\left[\\mathscr{E}\\right](\\omega^+) =\n  \\sum_j |\\gamma_j|^2  \\times \\\\\n  && \\left\\{\n  \\sum_{j < m} |d_{j m}|^2 L(\\omega-\\omega_{j m})  \n  - \\sum_{j > m} |d_{j m}|^2 L(\\omega+\\omega_{j m}) \\right\\} \\, .\\nonumber\n    \\label{eq:chi_equi1}\n\\end{eqnarray}\nIts peaks are always of Lorentzian shape and depend neither on time nor on the initial phase difference\n$\\varphi_j-\\varphi_k$. It is influenced by the pump laser only through the occupations $|\\gamma_j|^2$. \nThe phase- and time-dependency of the spectrum enters through the interference term\n\\begin{eqnarray}\\nonumber\n &&\\Im  \\chi_{\\hat D, \\hat D}^{\\rm  INT}\\left[\\mathscr{E}\\right](\\omega, T+\\tau) =  \n\\sum_{j\\neq k; m}  d_{jm}d_{mk}  |\\gamma_j\\gamma_k| \\left \\{ \\right. \\\\\\nonumber\n&& \\cos \\Theta_{kj}(\\tau)L(\\omega-\\omega_{jm}) + \\sin\\Theta_{kj}(\\tau)R(\\omega-\\omega_{jm})  \\\\\\nonumber\n&-&\\left. \\cos \\Theta_{kj}(\\tau)L(\\omega+\\omega_{jm}) + \\sin\\Theta_{kj}(\\tau)R(\\omega+\\omega_{jm}) \\right\\} \\\\\n    \\label{eq:chi_nonequi}\n\\end{eqnarray}\nwhich in turn is governed by the phase differences $\\Theta_{kj}$, which have contributions from both the\nphase difference $\\varphi_j-\\varphi_k$ at the end of the laser and from its time evolution $\\omega_{kj}\\tau$.\n$\\Theta_{kj}$ mixes real and imaginary part of the response function and converts Lorentzian line shapes into Rayleigh line shapes and \nvice versa. This conversion happens periodically with the frequency given by the energy differences $\\omega_{kj}$\nbetween the occupied states involved. \nThe time-dependence of a spectrum is therefore a clear sign of a non-stationary\nstate. Experimentally, this periodic beating pattern was recently observed by Goulielmakis \\emph{et al}\n\\cite{goulielmakis-2010}.\nThis demonstrates, how using a pump to imprint an internal phase difference $\\varphi_j-\\varphi_k$ onto a state and\ncontrolling the delay time $\\tau$ between pump and probe laser can be used to change a spectrum, converting\nabsorption into emission peaks (and vice versa) as well as changing the overall shape of the lines.\n\nIn Section~\\ref{sec:hydrogen} we demonstrate these line shape changes using the example of an exactly solvable Hydrogen\natom. Furthermore we demonstrate, how to use a laser to control these features.\n\nNote, that in the discussion above, the lineshape analysis is valid for isolated peaks without contribution from\ncontinuum states. If coupling to continuum states is involved, an additional shaping comes from the\ndependence of the matrix elements $d_{jm}$ on the energy. This is e.g.\\ the case for Fano line-shapes which \nmay acquire a complex Fano $q$ factor~\\cite{Zielinski:2014vx}. \n\n\\section{Quantum Optimal Control of Excited State Spectra}\\label{sec:qoct}\n\nIn this work we employ Quantum Optimal Control Theory (QOCT) to optimize the\nresponse of a system in the situation described in the previous section.\nQOCT is concerned with studying the optimal Hamiltonian (in practice, a\nportion of the Hamiltonian, such as the temporal profile of the coupling of an\natom or molecule to a laser pulse) that induces a target system behaviour.\nIn the following, we present its specific application to the problem of optimizing\nresponse functions of excited states. \nWe will also show how, if the problem can be reduced to a small model, it can be solved \nanalytically.\n\nLet us consider a quantum mechanical system governed by the\nSchr{\\\"{o}}dinger equation during the time interval [0,T]:\n\\begin{subequations}\n    \\label{eq:schroedinger_control}\n\\begin{eqnarray}\n\\label{eq:schroedinger-1}\n\n\ni\\frac{\\partial \\Psi}{\\partial t} (x,t)  & = & \\hat{H}[\\mathscr{E},t] \\Psi(x,t) \\,,\n\\\\\n\\label{eq:schroedinger-2}\n\n\\Psi(x,0) & = & \\Psi_0(x)\\,,\n\\end{eqnarray}\n\\end{subequations}\nwhere $x$ is the full set of quantum coordinates, and $\\mathscr{E}$ is the\n\\emph{control} field, an external potential applied to the\nsystem (in our case, the pump pulse). \nIn order to perform optimizations the field must be discretized, \nfor example with the help of a sine Fourier basis. In our numerical simulations:\n\n", "itemtype": "equation", "pos": 16671, "prevtext": "\nSince we are only interested in the trace, in the following, we concentrate on the diagonal terms,\nwe will omit hereafter the orientation indexes in order to ease the notation. \n\nWe now analyze Eq.~\\eqref{eq:chi_final} in more detail. First,\nas already pointed out in\nRef.~\\cite{perfetto-2015}, in this non-overlapping\nregime the dependence of the spectrum on both the pump-pulse and the delay time enters through the modification of the\npeak amplitudes and shapes exclusively: the peak positions are intrinsic properties of the many-body system.\n\nSecond, for the analysis of the effect of the pump pulse and of the pump-probe delay\non the spectrum, we can distinguish between three cases: \n(i) the system is in its ground state,  \n(ii) the system is in an excited eigenstate,\n(iii) the system is in a non-stationary state, i.e.\\ in a linear combination of non-degenerate eigenstates.\nIn all cases we focus on the positive part of the energy range, which we\ndenote by $\\omega^+$. The following shape analysis in \nterms of Lorentzian and Rayleigh contributions is for discrete peaks only. We denote this by replacing $\\SumInt$ by $\\sum$\n(we will comment on the continuum part later on in this section).\n\nIn case (i) $\\gamma_i=\\delta_{i0}$ and $\\Im \\chi_{\\hat D, \\hat D}\\left[\\mathscr{E}\\right](\\omega^+)$\nreduces to the usual Lehmann representation for the ground state spectrum:\n\n", "index": 25, "text": "\\begin{equation}\n\\Im \\chi_{\\hat D, \\hat D}\\left[\\mathscr{E}\\right](\\omega^+) =  \\sum_{m} |d_{0m}|^2 L(\\omega^+-\\omega_{0m}).\n\\label{eq:chi_case1}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E13.m1\" class=\"ltx_Math\" alttext=\"\\Im\\chi_{\\hat{D},\\hat{D}}\\left[\\mathscr{E}\\right](\\omega^{+})=\\sum_{m}|d_{0m}|%&#10;^{2}L(\\omega^{+}-\\omega_{0m}).\" display=\"block\"><mrow><mrow><mrow><mrow><mi mathvariant=\"normal\">\u2111</mi><mo>\u2061</mo><msub><mi>\u03c7</mi><mrow><mover accent=\"true\"><mi>D</mi><mo stretchy=\"false\">^</mo></mover><mo>,</mo><mover accent=\"true\"><mi>D</mi><mo stretchy=\"false\">^</mo></mover></mrow></msub></mrow><mo>\u2062</mo><mrow><mo>[</mo><mi class=\"ltx_font_mathscript\">\u2130</mi><mo>]</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>\u03c9</mi><mo>+</mo></msup><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mi>m</mi></munder><mrow><msup><mrow><mo stretchy=\"false\">|</mo><msub><mi>d</mi><mrow><mn>0</mn><mo>\u2062</mo><mi>m</mi></mrow></msub><mo stretchy=\"false\">|</mo></mrow><mn>2</mn></msup><mo>\u2062</mo><mi>L</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mi>\u03c9</mi><mo>+</mo></msup><mo>-</mo><msub><mi>\u03c9</mi><mrow><mn>0</mn><mo>\u2062</mo><mi>m</mi></mrow></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\nwhere $M$ is the dimension of the optimization search space, and $\\mathbf{c}$ is\nthe set of all the parameters that determine the field: $\\mathbf{c} = c_1,\\dots,c_M$. The frequencies,\nand their maximum value or cut-off frequency, may be chosen at will. \n\nThe specification of $\\mathscr{E}$, together with an initial value\ncondition, $\\Psi(0)=\\Psi_0$ determines the full evolution of the system,\n$\\Psi[\\mathscr{E}]$, via the propagation of the Schr{\\\"{o}}dinger equation.\nThe behaviour of the system must then be measured by defining a ``target\nfunctional'' $F$, whose value is high if the system evolves according to our\ngoal, and small otherwise. In many cases, it is split into two parts,\n$F[\\Psi,\\mathscr{E}] = J_1[\\Psi] + J_2[\\mathscr{E}]$, so that $J_1$ only depends on the state of\nthe system, and $J_2$, called the ``penalty'', depends explicitly on the\ncontrol $\\mathscr{E}$. Regarding $J_1$, it may depend \non the full evolution of the system during the time interval $[0,T]$, or only\non the system state at time $T$, as it is the case in this work.\nOften, the functional is defined through the expectation value\nof an observable $\\hat{O}$:\n\n", "itemtype": "equation", "pos": 22217, "prevtext": "\nAll peaks are positive and have Lorentzian shape. \nIn case (ii), where $\\gamma_i=\\delta_{i \\xi}$, the system is in an excited\neigenstate  $\\Phi_\\xi$, \nand therefore in the positive energy part of the spectrum we can find both positive and negative peaks of Lorentzian shape:\n\\begin{eqnarray}\\label{eq:chi_case2}\n \\Im    \\chi_{\\hat D, \\hat D}&&\\left[\\mathscr{E}\\right](\\omega^+) =\\\\  \n&&  \\sum_{\\xi < m} |d_{\\xi m}|^2 L(\\omega^+-\\omega_{\\xi m})  \n- \\sum_{\\xi > m} |d_{\\xi m}|^2 L(\\omega^++\\omega_{\\xi m}) \\, .\\nonumber\n\\end{eqnarray}\n\nNote, that in both cases (i) and (ii), the spectrum is time-independent and has only Lorentzian contributions. This is\nthe main difference to the case (iii), for non-stationary states.\nIn this case, the spectrum can be divided into two parts, \none time-independent and one oscillatory part due to interferences between the\ninvolved states:\n\\begin{eqnarray} \\label{eq:im_partitioning}\n    \\Im \\chi_{\\hat D, \\hat D}&&\\left[\\mathscr{E}\\right](\\omega^+, T+\\tau) = \\\\\n&&        \\Im \\chi_{\\hat D, \\hat D}^{0}\\left[\\mathscr{E}\\right](\\omega^+) \n    +   \\Im \\chi_{\\hat D, \\hat D}^{\\rm INT}\\left[\\mathscr{E}\\right](\\omega^+, T+\\tau)   \\nonumber\n\\end{eqnarray}\nThe equilibrium term consists of the sum over the stationary state spectra of the eigenstates involved, scaled by their\noccupations:\n\\begin{eqnarray}\n  \\Im &&   \\chi_{\\hat D, \\hat D}^{0}\\left[\\mathscr{E}\\right](\\omega^+) =\n  \\sum_j |\\gamma_j|^2  \\times \\\\\n  && \\left\\{\n  \\sum_{j < m} |d_{j m}|^2 L(\\omega-\\omega_{j m})  \n  - \\sum_{j > m} |d_{j m}|^2 L(\\omega+\\omega_{j m}) \\right\\} \\, .\\nonumber\n    \\label{eq:chi_equi1}\n\\end{eqnarray}\nIts peaks are always of Lorentzian shape and depend neither on time nor on the initial phase difference\n$\\varphi_j-\\varphi_k$. It is influenced by the pump laser only through the occupations $|\\gamma_j|^2$. \nThe phase- and time-dependency of the spectrum enters through the interference term\n\\begin{eqnarray}\\nonumber\n &&\\Im  \\chi_{\\hat D, \\hat D}^{\\rm  INT}\\left[\\mathscr{E}\\right](\\omega, T+\\tau) =  \n\\sum_{j\\neq k; m}  d_{jm}d_{mk}  |\\gamma_j\\gamma_k| \\left \\{ \\right. \\\\\\nonumber\n&& \\cos \\Theta_{kj}(\\tau)L(\\omega-\\omega_{jm}) + \\sin\\Theta_{kj}(\\tau)R(\\omega-\\omega_{jm})  \\\\\\nonumber\n&-&\\left. \\cos \\Theta_{kj}(\\tau)L(\\omega+\\omega_{jm}) + \\sin\\Theta_{kj}(\\tau)R(\\omega+\\omega_{jm}) \\right\\} \\\\\n    \\label{eq:chi_nonequi}\n\\end{eqnarray}\nwhich in turn is governed by the phase differences $\\Theta_{kj}$, which have contributions from both the\nphase difference $\\varphi_j-\\varphi_k$ at the end of the laser and from its time evolution $\\omega_{kj}\\tau$.\n$\\Theta_{kj}$ mixes real and imaginary part of the response function and converts Lorentzian line shapes into Rayleigh line shapes and \nvice versa. This conversion happens periodically with the frequency given by the energy differences $\\omega_{kj}$\nbetween the occupied states involved. \nThe time-dependence of a spectrum is therefore a clear sign of a non-stationary\nstate. Experimentally, this periodic beating pattern was recently observed by Goulielmakis \\emph{et al}\n\\cite{goulielmakis-2010}.\nThis demonstrates, how using a pump to imprint an internal phase difference $\\varphi_j-\\varphi_k$ onto a state and\ncontrolling the delay time $\\tau$ between pump and probe laser can be used to change a spectrum, converting\nabsorption into emission peaks (and vice versa) as well as changing the overall shape of the lines.\n\nIn Section~\\ref{sec:hydrogen} we demonstrate these line shape changes using the example of an exactly solvable Hydrogen\natom. Furthermore we demonstrate, how to use a laser to control these features.\n\nNote, that in the discussion above, the lineshape analysis is valid for isolated peaks without contribution from\ncontinuum states. If coupling to continuum states is involved, an additional shaping comes from the\ndependence of the matrix elements $d_{jm}$ on the energy. This is e.g.\\ the case for Fano line-shapes which \nmay acquire a complex Fano $q$ factor~\\cite{Zielinski:2014vx}. \n\n\\section{Quantum Optimal Control of Excited State Spectra}\\label{sec:qoct}\n\nIn this work we employ Quantum Optimal Control Theory (QOCT) to optimize the\nresponse of a system in the situation described in the previous section.\nQOCT is concerned with studying the optimal Hamiltonian (in practice, a\nportion of the Hamiltonian, such as the temporal profile of the coupling of an\natom or molecule to a laser pulse) that induces a target system behaviour.\nIn the following, we present its specific application to the problem of optimizing\nresponse functions of excited states. \nWe will also show how, if the problem can be reduced to a small model, it can be solved \nanalytically.\n\nLet us consider a quantum mechanical system governed by the\nSchr{\\\"{o}}dinger equation during the time interval [0,T]:\n\\begin{subequations}\n    \\label{eq:schroedinger_control}\n\\begin{eqnarray}\n\\label{eq:schroedinger-1}\n\n\ni\\frac{\\partial \\Psi}{\\partial t} (x,t)  & = & \\hat{H}[\\mathscr{E},t] \\Psi(x,t) \\,,\n\\\\\n\\label{eq:schroedinger-2}\n\n\\Psi(x,0) & = & \\Psi_0(x)\\,,\n\\end{eqnarray}\n\\end{subequations}\nwhere $x$ is the full set of quantum coordinates, and $\\mathscr{E}$ is the\n\\emph{control} field, an external potential applied to the\nsystem (in our case, the pump pulse). \nIn order to perform optimizations the field must be discretized, \nfor example with the help of a sine Fourier basis. In our numerical simulations:\n\n", "index": 27, "text": "\\begin{equation}\n    \\mathscr{E}_{\\mathbf{c}}(t) = \\sum_{n=1}^M  c_n \\sin(\\omega_n t)\n    \\label{eq:controlfield}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14.m1\" class=\"ltx_Math\" alttext=\"\\mathscr{E}_{\\mathbf{c}}(t)=\\sum_{n=1}^{M}c_{n}\\sin(\\omega_{n}t)\" display=\"block\"><mrow><mrow><msub><mi class=\"ltx_font_mathscript\">\u2130</mi><mi>\ud835\udc1c</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></munderover><mrow><msub><mi>c</mi><mi>n</mi></msub><mo>\u2062</mo><mrow><mi>sin</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>\u03c9</mi><mi>n</mi></msub><mo>\u2062</mo><mi>t</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\n\nThe mathematical problem is then reduced to the problem of maximizing a\nreal-valued function $G$:\n\n", "itemtype": "equation", "pos": 23496, "prevtext": "\nwhere $M$ is the dimension of the optimization search space, and $\\mathbf{c}$ is\nthe set of all the parameters that determine the field: $\\mathbf{c} = c_1,\\dots,c_M$. The frequencies,\nand their maximum value or cut-off frequency, may be chosen at will. \n\nThe specification of $\\mathscr{E}$, together with an initial value\ncondition, $\\Psi(0)=\\Psi_0$ determines the full evolution of the system,\n$\\Psi[\\mathscr{E}]$, via the propagation of the Schr{\\\"{o}}dinger equation.\nThe behaviour of the system must then be measured by defining a ``target\nfunctional'' $F$, whose value is high if the system evolves according to our\ngoal, and small otherwise. In many cases, it is split into two parts,\n$F[\\Psi,\\mathscr{E}] = J_1[\\Psi] + J_2[\\mathscr{E}]$, so that $J_1$ only depends on the state of\nthe system, and $J_2$, called the ``penalty'', depends explicitly on the\ncontrol $\\mathscr{E}$. Regarding $J_1$, it may depend \non the full evolution of the system during the time interval $[0,T]$, or only\non the system state at time $T$, as it is the case in this work.\nOften, the functional is defined through the expectation value\nof an observable $\\hat{O}$:\n\n", "index": 29, "text": "\\begin{equation}\nJ_1^{T}[\\Psi(T)] = \\langle \\Psi(T)\\vert\\hat{O}\\vert\\Psi(T)\\rangle\\,.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E15.m1\" class=\"ltx_Math\" alttext=\"J_{1}^{T}[\\Psi(T)]=\\langle\\Psi(T)|\\hat{O}|\\Psi(T)\\rangle\\,.\" display=\"block\"><mrow><mrow><mrow><msubsup><mi>J</mi><mn>1</mn><mi>T</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mi mathvariant=\"normal\">\u03a8</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>T</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mo>=</mo><mrow><mo stretchy=\"false\">\u27e8</mo><mrow><mi mathvariant=\"normal\">\u03a8</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>T</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo fence=\"true\" stretchy=\"false\">|</mo><mover accent=\"true\"><mi>O</mi><mo stretchy=\"false\">^</mo></mover><mo fence=\"true\" stretchy=\"false\">|</mo><mrow><mi mathvariant=\"normal\">\u03a8</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>T</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">\u27e9</mo></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\nThe absorption of light is related to the average absorption coefficient \n$\\bar\\sigma[\\mathscr{E}\\mathbf{c}](E)$ [Eq.~(\\ref{eq:absorption-coefficient})]. The larger the absorption coefficient\nat a certain energy, the more light is absorbed at this energy. \nIn order to find a laser pulse to make a system, that is \ntransparent in its ground state, absorb as much light as possible, we therefore optimize the absorption coefficient \nin the visible by taking the integral of $\\bar\\sigma[\\mathscr{E}_\\mathbf{c}](E)$ \nover the respective energy range. We employed two different control targets:\n\\begin{subequations}\n\\begin{eqnarray}\n    G_{\\tau}^{A}\\left[\\mathbf{c}\\right]&=&\\int_{E_{min}}^{E_{max}}\\!\\!\\!\\!  dE \\, \\,  \\bar\\sigma_{\\tau}[\\mathscr{E}_\\mathbf{c}](E)\\,,\\\\\n    \\label{eq:epsilon_a}\n    G_{\\tau}^{B}\\left[\\mathbf{c}\\right]&=&\\int_{E_{min}}^{E_{max}}\\!\\!\\!\\! dE \\, \\, \\bar\\sigma_{\\tau}[\\mathscr{E}_\\mathbf{c}](E)\n    e^{\\left(-\\gamma\\frac{N_0-N_{T}[\\mathscr{E}]}{N_0}\\right)} \\, ,\n    \\label{eq:epsilon_b}\n\\end{eqnarray}\n    \\label{eq:def_epsilon}\n\\end{subequations}\nwhere $\\bar\\sigma_{\\tau}[\\mathscr{E}_\\mathbf{c}](E)$  [in the following we will call it just $\\bar\\sigma(E)$]\nis the average absorption coefficient \nof the system at a given time delay $\\tau$ after the pump\npulse $\\mathscr{E}(t)$, and $E_{min}$ and $E_{max}$ define the optimization\nregion - the energy range, where the absorption is optimized. In the second\ntarget function we have introduced an exponential factor that depends on\n$N_0$ and $N_{T}$, the number of electrons in the system at the\nbeginning and the end of the pump pulse, respectively. The reason to\nintroduce this factor is to avoid ionization, i.e.\\ we wish to lead the system\nto a state with the desired absorption properties, but keeping the ionization\nprobability low. Keeping the ionization low is particularly important in the TDDFT calculations, if performed with\nadiabatic functionals, since with current state-of-the-art adiabatic functionals, \nionization of the system leads to unphysical\nshifts in the position of the absorption peaks. The term $\\exp\n{\\left(-\\gamma\\frac{N_0-N_{T}[\\mathscr{E}]}{N_0}\\right)}$ therefore inflicts\na penalty, whose strength can be modulated by $\\gamma$, to pump pulses that\nproduce strong ionization. We implement ionization using absorbing boundaries and thus the\ntotal number of electrons is, in general, not conserved during time.\nIn practice, one can also combine the two target functions: one may start\noptimizations using $ G_{\\tau}^{A}$,\nand later continue with $G_{\\tau}^{B}$,\nrestarting from the previous optimum.\n\nOnce the target is defined one is left with the problem of \nchoosing an optimization algorithm to find the maximum (or\nmaxima) of $G$. Two broad families can be distinguished: gradient-free\nprocedures, which only require the computation of $G$\ngiven a control input $\\mathscr{E}$, and gradient-based procedures, that also\nrequire the computation of the gradient of $G$ with respect to $\\mathscr{E}$.\nQOCT provides an expression for the gradient that can be adapted for this\ncase (see appendix \\ref{sec:qoct_gradientbased} for details).\nThis approach, however is numerically unfeasible for the target covered in this paper.\nFor this reason, in our simulations, we employed the gradient-free Simplex-Downhill algorithm by Nelder \nand Mead~\\cite{nelder-1965}.\n\nIn principle, if the system can be reduced to a few-level model, the optimal\nfields can be found analytically. To illustrate this approach, below we briefly illustrate a \nsimple example of controlling the absorption properties of a single Hydrogen atom. \nInstead of directly optimizing $G_{\\tau}^{A,B}$\nwe here derive a laser that drives the system into a state with the wanted optical properties.\n\nLet us suppose that the situation can be approximated by a three-level Hamiltonian $\\mathscr{\\hat H}$\nwith eigenstates $|\\Phi_a\\rangle$, $|\\Phi_b\\rangle$ and $|\\Phi_c\\rangle$ and the corresponding eigenenergies $\\varepsilon_a$,\n$\\varepsilon_b$ and $\\varepsilon_c$. \nWe define the transition energies $\\omega_{ab}=\\varepsilon_b-\\varepsilon_a$, $\\omega_{bc}=\\varepsilon_c-\\varepsilon_b$ and\n$\\omega_{ac}=\\varepsilon_c-\\varepsilon_a$.\nThe dipole coupling between the states is given by $d_{ab}$ and $d_{ac}$ (both\nassumed to be real numbers), and we further consider the case where the coupling between the states \n$|\\Phi_b\\rangle$ and $|\\Phi_c\\rangle$ is dipole forbidden.\n\nThe system is pumped by a laser field composed of two carrier frequencies $\\omega_{1,2}$ of the form:\n\n", "itemtype": "equation", "pos": 23696, "prevtext": "\n\nThe mathematical problem is then reduced to the problem of maximizing a\nreal-valued function $G$:\n\n", "index": 31, "text": "\\begin{equation}\nG[\\mathbf{c}] = F[\\Psi[\\mathscr{E}_{\\mathbf{c}}],\\mathscr{E}_{\\mathbf{c}}]\\,.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E16.m1\" class=\"ltx_Math\" alttext=\"G[\\mathbf{c}]=F[\\Psi[\\mathscr{E}_{\\mathbf{c}}],\\mathscr{E}_{\\mathbf{c}}]\\,.\" display=\"block\"><mrow><mrow><mrow><mi>G</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>\ud835\udc1c</mi><mo stretchy=\"false\">]</mo></mrow></mrow><mo>=</mo><mrow><mi>F</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mi mathvariant=\"normal\">\u03a8</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><msub><mi class=\"ltx_font_mathscript\">\u2130</mi><mi>\ud835\udc1c</mi></msub><mo stretchy=\"false\">]</mo></mrow></mrow><mo>,</mo><msub><mi class=\"ltx_font_mathscript\">\u2130</mi><mi>\ud835\udc1c</mi></msub><mo rspace=\"4.2pt\" stretchy=\"false\">]</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\nwith phases $\\varphi_{1,2}$, amplitudes $\\varepsilon_{1,2}$ and envelope $\\tilde{\\varepsilon}_{1,2}(t)$ defined by\n\\begin{eqnarray}\n    \\tilde\\varepsilon_{1,2}(t) &=& \n                    2\\varepsilon_{1,2} \\sin^2\\left(\\pi\\frac{t}{T}\\right)\\,.\n\n\n\n\\end{eqnarray}\nOur goal is to find a laser pulse that drives the system from state\n$|\\Psi(t=0)\\rangle=|\\Phi_a\\rangle$ into a target state\n$|\\bar{\\Psi}\\rangle$\n\n", "itemtype": "equation", "pos": 28341, "prevtext": "\nThe absorption of light is related to the average absorption coefficient \n$\\bar\\sigma[\\mathscr{E}\\mathbf{c}](E)$ [Eq.~(\\ref{eq:absorption-coefficient})]. The larger the absorption coefficient\nat a certain energy, the more light is absorbed at this energy. \nIn order to find a laser pulse to make a system, that is \ntransparent in its ground state, absorb as much light as possible, we therefore optimize the absorption coefficient \nin the visible by taking the integral of $\\bar\\sigma[\\mathscr{E}_\\mathbf{c}](E)$ \nover the respective energy range. We employed two different control targets:\n\\begin{subequations}\n\\begin{eqnarray}\n    G_{\\tau}^{A}\\left[\\mathbf{c}\\right]&=&\\int_{E_{min}}^{E_{max}}\\!\\!\\!\\!  dE \\, \\,  \\bar\\sigma_{\\tau}[\\mathscr{E}_\\mathbf{c}](E)\\,,\\\\\n    \\label{eq:epsilon_a}\n    G_{\\tau}^{B}\\left[\\mathbf{c}\\right]&=&\\int_{E_{min}}^{E_{max}}\\!\\!\\!\\! dE \\, \\, \\bar\\sigma_{\\tau}[\\mathscr{E}_\\mathbf{c}](E)\n    e^{\\left(-\\gamma\\frac{N_0-N_{T}[\\mathscr{E}]}{N_0}\\right)} \\, ,\n    \\label{eq:epsilon_b}\n\\end{eqnarray}\n    \\label{eq:def_epsilon}\n\\end{subequations}\nwhere $\\bar\\sigma_{\\tau}[\\mathscr{E}_\\mathbf{c}](E)$  [in the following we will call it just $\\bar\\sigma(E)$]\nis the average absorption coefficient \nof the system at a given time delay $\\tau$ after the pump\npulse $\\mathscr{E}(t)$, and $E_{min}$ and $E_{max}$ define the optimization\nregion - the energy range, where the absorption is optimized. In the second\ntarget function we have introduced an exponential factor that depends on\n$N_0$ and $N_{T}$, the number of electrons in the system at the\nbeginning and the end of the pump pulse, respectively. The reason to\nintroduce this factor is to avoid ionization, i.e.\\ we wish to lead the system\nto a state with the desired absorption properties, but keeping the ionization\nprobability low. Keeping the ionization low is particularly important in the TDDFT calculations, if performed with\nadiabatic functionals, since with current state-of-the-art adiabatic functionals, \nionization of the system leads to unphysical\nshifts in the position of the absorption peaks. The term $\\exp\n{\\left(-\\gamma\\frac{N_0-N_{T}[\\mathscr{E}]}{N_0}\\right)}$ therefore inflicts\na penalty, whose strength can be modulated by $\\gamma$, to pump pulses that\nproduce strong ionization. We implement ionization using absorbing boundaries and thus the\ntotal number of electrons is, in general, not conserved during time.\nIn practice, one can also combine the two target functions: one may start\noptimizations using $ G_{\\tau}^{A}$,\nand later continue with $G_{\\tau}^{B}$,\nrestarting from the previous optimum.\n\nOnce the target is defined one is left with the problem of \nchoosing an optimization algorithm to find the maximum (or\nmaxima) of $G$. Two broad families can be distinguished: gradient-free\nprocedures, which only require the computation of $G$\ngiven a control input $\\mathscr{E}$, and gradient-based procedures, that also\nrequire the computation of the gradient of $G$ with respect to $\\mathscr{E}$.\nQOCT provides an expression for the gradient that can be adapted for this\ncase (see appendix \\ref{sec:qoct_gradientbased} for details).\nThis approach, however is numerically unfeasible for the target covered in this paper.\nFor this reason, in our simulations, we employed the gradient-free Simplex-Downhill algorithm by Nelder \nand Mead~\\cite{nelder-1965}.\n\nIn principle, if the system can be reduced to a few-level model, the optimal\nfields can be found analytically. To illustrate this approach, below we briefly illustrate a \nsimple example of controlling the absorption properties of a single Hydrogen atom. \nInstead of directly optimizing $G_{\\tau}^{A,B}$\nwe here derive a laser that drives the system into a state with the wanted optical properties.\n\nLet us suppose that the situation can be approximated by a three-level Hamiltonian $\\mathscr{\\hat H}$\nwith eigenstates $|\\Phi_a\\rangle$, $|\\Phi_b\\rangle$ and $|\\Phi_c\\rangle$ and the corresponding eigenenergies $\\varepsilon_a$,\n$\\varepsilon_b$ and $\\varepsilon_c$. \nWe define the transition energies $\\omega_{ab}=\\varepsilon_b-\\varepsilon_a$, $\\omega_{bc}=\\varepsilon_c-\\varepsilon_b$ and\n$\\omega_{ac}=\\varepsilon_c-\\varepsilon_a$.\nThe dipole coupling between the states is given by $d_{ab}$ and $d_{ac}$ (both\nassumed to be real numbers), and we further consider the case where the coupling between the states \n$|\\Phi_b\\rangle$ and $|\\Phi_c\\rangle$ is dipole forbidden.\n\nThe system is pumped by a laser field composed of two carrier frequencies $\\omega_{1,2}$ of the form:\n\n", "index": 33, "text": "\\begin{equation}\n    \\mathscr{E}(t)=\\tilde{\\varepsilon}_1(t)\\cos(\\omega_1 t+\\varphi_1) + \\tilde{\\varepsilon}_2(t)\\cos(\\omega_2 t + \\varphi_2),\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E17.m1\" class=\"ltx_Math\" alttext=\"\\mathscr{E}(t)=\\tilde{\\varepsilon}_{1}(t)\\cos(\\omega_{1}t+\\varphi_{1})+\\tilde{%&#10;\\varepsilon}_{2}(t)\\cos(\\omega_{2}t+\\varphi_{2}),\" display=\"block\"><mrow><mrow><mrow><mi class=\"ltx_font_mathscript\">\u2130</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msub><mover accent=\"true\"><mi>\u03b5</mi><mo stretchy=\"false\">~</mo></mover><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mi>cos</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><msub><mi>\u03c9</mi><mn>1</mn></msub><mo>\u2062</mo><mi>t</mi></mrow><mo>+</mo><msub><mi>\u03c6</mi><mn>1</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><mrow><msub><mover accent=\"true\"><mi>\u03b5</mi><mo stretchy=\"false\">~</mo></mover><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mi>cos</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><msub><mi>\u03c9</mi><mn>2</mn></msub><mo>\u2062</mo><mi>t</mi></mrow><mo>+</mo><msub><mi>\u03c6</mi><mn>2</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\nin a given time $T$ -- $\\alpha,\\beta,$ and $\\gamma$ are complex coefficients. \nSince the spectral properties of this state can be then easily obtained \nusing Eqs.~\\eqref{eq:im_partitioning}, \\eqref{eq:absorption-coefficient},   \nthe problem of finding a pulse giving the desired optical properties translates to \nthe one of maximizing the overlap \n$|\\langle\\Psi(T)|\\bar{\\Psi}\\rangle|^2$ while keeping the functional form of the laser fixed -- i.e.\\ changing only \n$\\omega_{1,2}$, $\\varphi_{1,2}$, and $\\varepsilon_{1,2}$.\n\nIf we choose $\\omega_{1,2}$ resonant with the transition frequencies $\\omega_{ab},\\omega_{ac}$ and\nassume they are sufficiently separated in energy we can apply the rotating wave\napproximation and obtain the laser parameters as function of $\\alpha,\\beta,\\gamma$\nas (see Appendix~\\ref{sec:analyticalcontrol} for details):\n\\begin{subequations}\n\\begin{eqnarray}\n    \\varepsilon_1 &=& \\frac{2}{T}\\frac{\\arccos(|\\alpha|)}{\\sin(\\arccos(|\\alpha|)}\\frac{|\\beta|}{d_{ab}}\n\\\\\n    \\varepsilon_2 &=& \\frac{2}{T}\\frac{\\arccos(|\\alpha|)}{\\sin(\\arccos(|\\alpha|)}\\frac{|\\gamma|}{d_{ac}}\n \\end{eqnarray}\nand\n\\begin{eqnarray}\n    \\varphi_{\\beta} &=&  \\varphi_1-\\pi+\\omega_{ba}T \\\\\n    \\varphi_{\\gamma} &=& \\varphi_2-\\pi+\\omega_{ca}T \\,.\n\\end{eqnarray}\n\\end{subequations}\nWe will come back to this example below in Sec.~\\ref{sec:hydrogen}.\n\n\\section{Applications}\\label{sec:applications}\n\nAny QOCT formulation is constructed on top of a given model for the physics of the\nprocess under study. In this paper we study and optimize the absorption spectra of atoms and molecules\nusing either analytically solvable model Hamiltonians or obtaining the spectra by using time-dependent density\nfunctional theory (TDDFT)~\\cite{ book-tddft,tddft-specialissue} -- the time-dependent counterpart of DFT~\\cite{kohn-1999}. \n\nBased on the Runge-Gross theorem~\\cite{runge-1984} TDDFT establishes a one-to-one correspondence between\nthe time-dependent density and the time-dependent external potential of a many-electron system.\nTogether with the Kohn-Sham (KS) scheme \\cite{kohn-1965} it allows us to recast the many-body time-dependent \nproblem into a simpler one where the interacting electrons are replaced by a \nfictitious set of non-interacting electrons with the same time-dependent density.\nThis system of non-interacting electrons can then be \nrepresented with a single Slater determinant formed by a set of KS orbitals \nleading to great computational simplifications.\n\nIn the following we will work with spin-compensated systems of $N$ electrons doubly occupying $N/2$ spatial orbitals.\nThe time evolution of these orbitals $\\varphi_i$ ($i=1,N/2$), is governed by the time-dependent Kohn-Sham equations \n\\begin{eqnarray}\n{\\rm i}\\frac{\\partial}{\\partial t}\\varphi_i({\\mathbf {r}},t) & = & -\\frac{1}{2}\\nabla^2 \\varphi_i({\\mathbf {r}},t)\n+ v_{\\rm KS}[n]({\\mathbf {r}},t)\\varphi_i({\\mathbf {r}},t)\\,,\n\\\\\nn({\\mathbf {r}},t) & = & 2\\sum_{i=1}^{N/2}\\vert\\varphi_i({\\mathbf {r}},t)\\vert^2\\,,\n\\end{eqnarray}\n\\label{eq:tdks}\nwhere $v_{\\rm KS}[n]({\\mathbf {r}},t)$ is the KS potential. \nIt is, in general, a functional of the density and is defined as \n\n", "itemtype": "equation", "pos": 28905, "prevtext": "\nwith phases $\\varphi_{1,2}$, amplitudes $\\varepsilon_{1,2}$ and envelope $\\tilde{\\varepsilon}_{1,2}(t)$ defined by\n\\begin{eqnarray}\n    \\tilde\\varepsilon_{1,2}(t) &=& \n                    2\\varepsilon_{1,2} \\sin^2\\left(\\pi\\frac{t}{T}\\right)\\,.\n\n\n\n\\end{eqnarray}\nOur goal is to find a laser pulse that drives the system from state\n$|\\Psi(t=0)\\rangle=|\\Phi_a\\rangle$ into a target state\n$|\\bar{\\Psi}\\rangle$\n\n", "index": 35, "text": "\\begin{equation}\n    |\\bar{\\Psi}\\rangle=\\alpha|\\Phi_a\\rangle+\\beta|\\Phi_b\\rangle+\\gamma|\\Phi_c\\rangle\n \\label{eq:hcontrol_target}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E18.m1\" class=\"ltx_Math\" alttext=\"|\\bar{\\Psi}\\rangle=\\alpha|\\Phi_{a}\\rangle+\\beta|\\Phi_{b}\\rangle+\\gamma|\\Phi_{c}\\rangle\" display=\"block\"><mrow><mrow><mo fence=\"true\" stretchy=\"false\">|</mo><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a8</mi><mo stretchy=\"false\">\u00af</mo></mover><mo stretchy=\"false\">\u27e9</mo></mrow><mo>=</mo><mrow><mrow><mi>\u03b1</mi><mo>\u2062</mo><mrow><mo fence=\"true\" stretchy=\"false\">|</mo><msub><mi mathvariant=\"normal\">\u03a6</mi><mi>a</mi></msub><mo stretchy=\"false\">\u27e9</mo></mrow></mrow><mo>+</mo><mrow><mi>\u03b2</mi><mo>\u2062</mo><mrow><mo fence=\"true\" stretchy=\"false\">|</mo><msub><mi mathvariant=\"normal\">\u03a6</mi><mi>b</mi></msub><mo stretchy=\"false\">\u27e9</mo></mrow></mrow><mo>+</mo><mrow><mi>\u03b3</mi><mo>\u2062</mo><mrow><mo fence=\"true\" stretchy=\"false\">|</mo><msub><mi mathvariant=\"normal\">\u03a6</mi><mi>c</mi></msub><mo stretchy=\"false\">\u27e9</mo></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\nwhere $v_0({\\mathbf {r}})$ represents the static (ionic) external potential, $v({\\mathbf {r}},t)=\\mathcal{E}(t)\\cdot {{\\mathbf r}}$ \nis the coupling to the time dependent electric field $\\mathcal{E}(t)$ in the dipole approximation (in the length gauge),\n$v_{\\rm H}[n]({\\mathbf {r}},t) = \\int\\!{\\rm d}^3r'\\,n({\\mathbf {r}},t)/\\vert {\\mathbf {r}}'-{\\mathbf {r}}\\vert$ is the classical electrostatic Hartree potential,\nand $v_{\\rm xc}[n]({\\mathbf {r}},t)$ is the exchange and correlation potential accounting for the many electron effects~\\cite{book-tddft,marques-2012}.\nIn our simulations the ions are clamped to their equilibrium positions.\nAll numerical calculations were performed using the octopus code\n\\cite{marques-2003}.\n\n\n\\subsection{One Electron Systems: the Hydrogen Atom}\\label{sec:hydrogen}\nIn Section~\\ref{sec:spec_ex} we have discussed how the amplitudes and shapes of\nexcited state absorption spectra\ndepend on the relative phases $\\varphi_i$ of the expansion coefficients\n$\\gamma_i$. Here, we illustrate this effect\nin a Hydrogen atom, which is initially pumped into the state  \n\n", "itemtype": "equation", "pos": 32190, "prevtext": "\nin a given time $T$ -- $\\alpha,\\beta,$ and $\\gamma$ are complex coefficients. \nSince the spectral properties of this state can be then easily obtained \nusing Eqs.~\\eqref{eq:im_partitioning}, \\eqref{eq:absorption-coefficient},   \nthe problem of finding a pulse giving the desired optical properties translates to \nthe one of maximizing the overlap \n$|\\langle\\Psi(T)|\\bar{\\Psi}\\rangle|^2$ while keeping the functional form of the laser fixed -- i.e.\\ changing only \n$\\omega_{1,2}$, $\\varphi_{1,2}$, and $\\varepsilon_{1,2}$.\n\nIf we choose $\\omega_{1,2}$ resonant with the transition frequencies $\\omega_{ab},\\omega_{ac}$ and\nassume they are sufficiently separated in energy we can apply the rotating wave\napproximation and obtain the laser parameters as function of $\\alpha,\\beta,\\gamma$\nas (see Appendix~\\ref{sec:analyticalcontrol} for details):\n\\begin{subequations}\n\\begin{eqnarray}\n    \\varepsilon_1 &=& \\frac{2}{T}\\frac{\\arccos(|\\alpha|)}{\\sin(\\arccos(|\\alpha|)}\\frac{|\\beta|}{d_{ab}}\n\\\\\n    \\varepsilon_2 &=& \\frac{2}{T}\\frac{\\arccos(|\\alpha|)}{\\sin(\\arccos(|\\alpha|)}\\frac{|\\gamma|}{d_{ac}}\n \\end{eqnarray}\nand\n\\begin{eqnarray}\n    \\varphi_{\\beta} &=&  \\varphi_1-\\pi+\\omega_{ba}T \\\\\n    \\varphi_{\\gamma} &=& \\varphi_2-\\pi+\\omega_{ca}T \\,.\n\\end{eqnarray}\n\\end{subequations}\nWe will come back to this example below in Sec.~\\ref{sec:hydrogen}.\n\n\\section{Applications}\\label{sec:applications}\n\nAny QOCT formulation is constructed on top of a given model for the physics of the\nprocess under study. In this paper we study and optimize the absorption spectra of atoms and molecules\nusing either analytically solvable model Hamiltonians or obtaining the spectra by using time-dependent density\nfunctional theory (TDDFT)~\\cite{ book-tddft,tddft-specialissue} -- the time-dependent counterpart of DFT~\\cite{kohn-1999}. \n\nBased on the Runge-Gross theorem~\\cite{runge-1984} TDDFT establishes a one-to-one correspondence between\nthe time-dependent density and the time-dependent external potential of a many-electron system.\nTogether with the Kohn-Sham (KS) scheme \\cite{kohn-1965} it allows us to recast the many-body time-dependent \nproblem into a simpler one where the interacting electrons are replaced by a \nfictitious set of non-interacting electrons with the same time-dependent density.\nThis system of non-interacting electrons can then be \nrepresented with a single Slater determinant formed by a set of KS orbitals \nleading to great computational simplifications.\n\nIn the following we will work with spin-compensated systems of $N$ electrons doubly occupying $N/2$ spatial orbitals.\nThe time evolution of these orbitals $\\varphi_i$ ($i=1,N/2$), is governed by the time-dependent Kohn-Sham equations \n\\begin{eqnarray}\n{\\rm i}\\frac{\\partial}{\\partial t}\\varphi_i({\\mathbf {r}},t) & = & -\\frac{1}{2}\\nabla^2 \\varphi_i({\\mathbf {r}},t)\n+ v_{\\rm KS}[n]({\\mathbf {r}},t)\\varphi_i({\\mathbf {r}},t)\\,,\n\\\\\nn({\\mathbf {r}},t) & = & 2\\sum_{i=1}^{N/2}\\vert\\varphi_i({\\mathbf {r}},t)\\vert^2\\,,\n\\end{eqnarray}\n\\label{eq:tdks}\nwhere $v_{\\rm KS}[n]({\\mathbf {r}},t)$ is the KS potential. \nIt is, in general, a functional of the density and is defined as \n\n", "index": 37, "text": "\\begin{equation}\nv_{\\rm KS}[n]({\\mathbf {r}},t) = v_0({\\mathbf {r}}) + v({\\mathbf {r}},t) + v_{\\rm H}[n]({\\mathbf {r}},t) + v_{\\rm xc}[n]({\\mathbf {r}},t)\\,,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E19.m1\" class=\"ltx_Math\" alttext=\"v_{\\rm KS}[n]({\\mathbf{r}},t)=v_{0}({\\mathbf{r}})+v({\\mathbf{r}},t)+v_{\\rm H}[%&#10;n]({\\mathbf{r}},t)+v_{\\rm xc}[n]({\\mathbf{r}},t)\\,,\" display=\"block\"><mrow><mrow><mrow><msub><mi>v</mi><mi>KS</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>n</mi><mo stretchy=\"false\">]</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msub><mi>v</mi><mn>0</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mi>v</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><msub><mi>v</mi><mi mathvariant=\"normal\">H</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>n</mi><mo stretchy=\"false\">]</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo>,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><msub><mi>v</mi><mi>xc</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>n</mi><mo stretchy=\"false\">]</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\ud835\udc2b</mi><mo>,</mo><mi>t</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\nLet us first vary $\\varphi$ to show the effect of the phase on the final spectrum. \nFor our pumped state the stationary part of the spectrum \nis composed of the weighted stationary state spectra coming from $|2p_z\\rangle$ and $|3p_z\\rangle$:\n\n", "itemtype": "equation", "pos": 33456, "prevtext": "\nwhere $v_0({\\mathbf {r}})$ represents the static (ionic) external potential, $v({\\mathbf {r}},t)=\\mathcal{E}(t)\\cdot {{\\mathbf r}}$ \nis the coupling to the time dependent electric field $\\mathcal{E}(t)$ in the dipole approximation (in the length gauge),\n$v_{\\rm H}[n]({\\mathbf {r}},t) = \\int\\!{\\rm d}^3r'\\,n({\\mathbf {r}},t)/\\vert {\\mathbf {r}}'-{\\mathbf {r}}\\vert$ is the classical electrostatic Hartree potential,\nand $v_{\\rm xc}[n]({\\mathbf {r}},t)$ is the exchange and correlation potential accounting for the many electron effects~\\cite{book-tddft,marques-2012}.\nIn our simulations the ions are clamped to their equilibrium positions.\nAll numerical calculations were performed using the octopus code\n\\cite{marques-2003}.\n\n\n\\subsection{One Electron Systems: the Hydrogen Atom}\\label{sec:hydrogen}\nIn Section~\\ref{sec:spec_ex} we have discussed how the amplitudes and shapes of\nexcited state absorption spectra\ndepend on the relative phases $\\varphi_i$ of the expansion coefficients\n$\\gamma_i$. Here, we illustrate this effect\nin a Hydrogen atom, which is initially pumped into the state  \n\n", "index": 39, "text": "\\begin{equation}\n    |\\bar{\\Psi}\\rangle=\\sqrt{0.4}|2p_z\\rangle + \\sqrt{0.6}e^{i\\varphi}|3p_z\\rangle\\,.\n    \\label{eq:hydrogen_target}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E20.m1\" class=\"ltx_Math\" alttext=\"|\\bar{\\Psi}\\rangle=\\sqrt{0.4}|2p_{z}\\rangle+\\sqrt{0.6}e^{i\\varphi}|3p_{z}%&#10;\\rangle\\,.\" display=\"block\"><mrow><mrow><mrow><mo fence=\"true\" stretchy=\"false\">|</mo><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a8</mi><mo stretchy=\"false\">\u00af</mo></mover><mo stretchy=\"false\">\u27e9</mo></mrow><mo>=</mo><mrow><mrow><msqrt><mn>0.4</mn></msqrt><mo>\u2062</mo><mrow><mo fence=\"true\" stretchy=\"false\">|</mo><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>p</mi><mi>z</mi></msub></mrow><mo stretchy=\"false\">\u27e9</mo></mrow></mrow><mo>+</mo><mrow><msqrt><mn>0.6</mn></msqrt><mo>\u2062</mo><msup><mi>e</mi><mrow><mi>i</mi><mo>\u2062</mo><mi>\u03c6</mi></mrow></msup><mo>\u2062</mo><mrow><mo fence=\"true\" stretchy=\"false\">|</mo><mrow><mn>3</mn><mo>\u2062</mo><msub><mi>p</mi><mi>z</mi></msub></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">\u27e9</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\nwhereas the phase-dependent interference term is\n\n", "itemtype": "equation", "pos": 33847, "prevtext": "\nLet us first vary $\\varphi$ to show the effect of the phase on the final spectrum. \nFor our pumped state the stationary part of the spectrum \nis composed of the weighted stationary state spectra coming from $|2p_z\\rangle$ and $|3p_z\\rangle$:\n\n", "index": 41, "text": "\\begin{equation}\n  \\bar\\sigma^0(\\omega)=0.4\\bar\\sigma_{2p_z}(\\omega)+0.6\\bar\\sigma_{3p_z}(\\omega)\\,,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E21.m1\" class=\"ltx_Math\" alttext=\"\\bar{\\sigma}^{0}(\\omega)=0.4\\bar{\\sigma}_{2p_{z}}(\\omega)+0.6\\bar{\\sigma}_{3p_%&#10;{z}}(\\omega)\\,,\" display=\"block\"><mrow><mrow><mrow><msup><mover accent=\"true\"><mi>\u03c3</mi><mo stretchy=\"false\">\u00af</mo></mover><mn>0</mn></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mn>0.4</mn><mo>\u2062</mo><msub><mover accent=\"true\"><mi>\u03c3</mi><mo stretchy=\"false\">\u00af</mo></mover><mrow><mn>2</mn><mo>\u2062</mo><msub><mi>p</mi><mi>z</mi></msub></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mn>0.6</mn><mo>\u2062</mo><msub><mover accent=\"true\"><mi>\u03c3</mi><mo stretchy=\"false\">\u00af</mo></mover><mrow><mn>3</mn><mo>\u2062</mo><msub><mi>p</mi><mi>z</mi></msub></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\nNote the change in the sign of the Rayleigh terms in both sums.\n\\begin{figure}[htb!]\n    \\begin{center}\n        \\includegraphics[clip, width=\\columnwidth]{H_spectra_analytic_phases-crop}\n    \\end{center}\n    \\caption{Absorption coefficient $\\bar\\sigma(\\omega)$ of the state  \n    defined in Eq.~\\eqref{eq:hydrogen_target} with $\\varphi=0$, $(1/2)\\pi$, $\\pi$ and $(3/2)\\pi$.\n    The total spectrum (black line) is the sum of two phase-independent terms $0.4\\bar\\sigma_{2p_z}$ (red shaded) \n    and $0.6\\bar\\sigma_{3p_z}$ (blue\n    shaded) coming from the excited state spectra of the respective states,\n    plus the phase-dependent interference term \n    $\\bar\\sigma^{\\mathrm{INT}}(\\omega, \\varphi)$ (green dashed line), which is responsible for the change of the\n    spectrum with the delay time.}\n    \\label{fig:H_spectrum_analytic_phases}\n\\end{figure}\n\nFig.~\\ref{fig:H_spectrum_analytic_phases} shows the different contributions and the complete spectrum for \n$\\varphi = 0$, $(1/2)\\pi$, $\\pi$ and $(3/2)\\pi$, which are the cases, where the interference term is either\npurely Lorentzian ($\\varphi=0$, $\\pi$) or purely Rayleigh ($\\varphi=1/2\\pi$, $3/2\\pi$). \nThe shaded areas\nindicate the weighted equilibrium contributions, the dotted line\nshows the interference terms, and the solid line the complete spectrum. \nThe energy range shown includes the transitions from\nn = 2 to all higher states and from n = 3 to all higher states and to n = 2. \nTransitions to the ground state lie outside of this region. \n\nAs can be learnt from Eq.~\\eqref{eq:chi_nonequi_h}, the interference terms require the existence of states\nwhich are dipole-coupled to both $2p_z$ and $3p_z$. \nThis is the case for $s$- and $d$-orbitals. This means, that e.g.\\ for Hydrogen in a linear\ncombination of the states $2s$ and $4f$, all the\ninterference terms would vanish and the spectrum would be purely the sum of the weighted equilibrium contributions.\n\nLet us take a closer look at the structure of the interference terms. \nWe start with the interference term at $\\omega_{23}=0.069$ Ha having contributions from terms with $m=2s$, $m=3s$ and $m=3d$. \nAll contributions have different prefactors with the ones coming from the 2s-state \nhaving the opposite sign compared to the ones coming from 3s and 3d states. \nFor the other peaks, the interference terms are much smaller at the \nenergies $\\omega_{3n}$ than their counterparts at \n$\\omega_{2n}$ (compare the purely blue to the purely red peaks in Fig.~\\ref{fig:H_spectrum_analytic_phases}).\nFrom Eq.~\\eqref{eq:chi_nonequi_h}, it is apparent that the amplitude of each interference term\nis the same for $\\omega_{2n}$ and $\\omega_{3n}$ with the same $n$. The difference comes purely\nfrom the factor $\\frac{4\\pi\\omega}{3c}$ -- note that the sign of the Rayleigh\ncontributions is opposite in these pairs of peaks. \nThis variation of amplitude has the following consequences for the change of \nthe overall spectrum:\n\nAt $\\omega_{3n}$ the spectrum has\npositive contributions from $\\bar\\sigma_{3p_z}$ and contributions from the interference terms, \nbut since the interference terms are much\nsmaller than $\\bar\\sigma_{3p_z}$, the spectrum changes only slightly for different $\\varphi$'s. \nThis is different for the peaks at energies $\\omega_{2n}$. \nHere, the spectrum has positive, phase-independent contributions from\n$\\bar\\sigma_{2p_z}(\\omega)$, but the contributions from the interference terms are much larger \nand dominate the spectrum leading\nto a strong dependence of the spectrum in this energy range on the phase $\\varphi$.\nFor $\\varphi=0$ and $\\varphi=\\pi$, \n$\\bar\\sigma^{\\rm INT}(\\omega, \\varphi)$ only contains Lorentzian peaks and consequently \nthe whole spectrum only contains Lorentzians. Nevertheless, $\\bar\\sigma^{\\rm INT}(\\omega, \\varphi)$ \nchanges sign between $\\varphi=0$ and $\\varphi=\\pi$, switching the sign of all\npeaks at $\\omega_{2n}$. This is a\ndemonstration of, how the manipulation of the internal phase $\\varphi$ can lead to a switch from gain (negative peaks)\nto loss (positive peaks) regime and\nvice versa. Finally, for $\\varphi=(1/2)\\pi$ and $\\varphi=(3/2)\\pi$, the interference spectrum contains purely Rayleigh\npeaks. Together with the small contributions from the stationary-state contributions, the final spectrum consists\nof slightly asymmetric Rayleigh peaks, again with different signs for $\\varphi=(1/2)\\pi$ and $\\varphi=(3/2)\\pi$. One can\ntherefore not only change peaks from emission to absorption peaks, but also manipulate their shape.\nThe phases $\\varphi$ therefore play a critical role in the spectral weights and the\npeaks of the photo-absorption spectrum. \n\nWe now look at the variation of the spectrum with time, \nassuming that an initial, yet unknown pump laser created the state of Eq.~\\eqref{eq:hydrogen_target} with $\\varphi=\\varphi_{32}=0$ at $t=T$\nand we probe the system at different delay times $\\tau$.\nFigure~\\ref{fig:Hydrogen_spectroscopy_td_spectrum} shows the corresponding time-resolved spectrum $\\bar\\sigma(\\omega, \\tau)$ \nof $|\\bar{\\Psi}\\rangle$. Since the eigenenergies of $|2p_z\\rangle$ and $|3p_z\\rangle$ are different, \nthe phase $\\Theta_{32}(\\tau)$ in Eq.~\\eqref{eq:theta}\nevolves with the frequency $\\omega_{32}$. At $\\tau=0$, $\\tau=\\frac{\\pi}{2\\omega_{32}}$, $\\tau=\\frac{\\pi}{\\omega_{32}}$\nand $\\tau=\\frac{3\\pi}{2\\omega_{32}}$, the spectra of Fig.~\\ref{fig:H_spectrum_analytic_phases} are reproduced. \nOne sees the strong changes of $\\bar\\sigma$ in the energy range of the peaks $\\omega_{2n}$, \nwhile the peaks $\\omega_{3n}$ remain almost unchanged. \nThe spectrum is periodic with $T=\\frac{2\\pi}{\\omega_{32}}\\approx$ 91~a.u..\n\n\\begin{figure}[htb!]\n     \\begin{center}\n       \\includegraphics[width=\\columnwidth]{H_td_cross_section-crop}\n     \\end{center}\n    \\caption{Time-resolved spectrum of the initial state \n    $\\sqrt{0.4} |2p_z\\rangle + \\sqrt{0.6} |3p_z\\rangle$ of Hydrogen. Because the\n    phases of the $|2p\\rangle$ and $|3p\\rangle$ states evolve with different velocities, \n    the spectral weights of each of the peaks changes with time, leading to a time-dependent \n    spectrum with a periodicity of $T = \\frac{2\\pi}{\\omega_{32}} \\approx 91 a.u.$. \n    \n    \n    }\n    \\label{fig:Hydrogen_spectroscopy_td_spectrum}\n\\end{figure}\n\n\nWe now move on to the control problem -- i.e.\\ the design of a pump pulse\ndriving the system into a state with specific optical properties.\nFor this problem, we will use the three-levels model, and the analytical\nequations of control presented in Section~\\ref{sec:qoct}.\nThe target state will again be the one defined in Eq.~\\eqref{eq:hydrogen_target} \n$|\\bar{\\Psi}\\rangle=\\sqrt{0.4}|2p_z\\rangle + \\sqrt{0.6}e^{i\\varphi}|3p_z\\rangle$\nwith a relative phase of $\\varphi=0$: $|\\bar{\\Psi}\\rangle=\\sqrt{0.4}|2p_z\\rangle + \\sqrt{0.6}|3p_z\\rangle$.\nThe three active states are then \n$|1s\\rangle$, $|2p_z\\rangle$ and $|3p_z\\rangle$. Note that since\n$|2p_z\\rangle$ and $|3p_z\\rangle$ have the same\nsymmetry, they are decoupled in the dipole approximation, and in consequence the system\nfits into the framework described in Section~\\ref{sec:qoct}. \nWe may therefore write down the shape of a control pulse,\nassuming a total pulse time of $T=3200$~a.u:\n\\begin{eqnarray}    \\label{eq:hcontrol_laser_numerical}\n    \\mathscr{E}(t) = \\frac{2\\pi}{T}  \n       && \\left(  \\frac{\\sqrt{0.4}}{d_{1s\\rightarrow 2p}}\\cos(\\omega_{1s\\rightarrow 2p}(t-T)+\\pi) \\right.  \\\\\n      +&& \\left.  \\frac{\\sqrt{0.6}}{d_{1s\\rightarrow 3p}}\\cos(\\omega_{1s\\rightarrow 3p}(t-T)+ \\pi)\\right)\n                    \\sin^2\\left(\\pi\\frac{t}{T}\\right).\\nonumber\n\\end{eqnarray}\n\nWe numerically solved the TSDE in order to check the validity of the three-level approximation. \nTo this end we discretized the equations on a spherical grid of radius $R=60$~a.u., \nspacing of $\\Delta x = 0.435$~a.u.\\ and with 20~a.u.\\ wide absorbing boundaries placed at the edges.\n\\begin{figure}[htb!]\n    \\begin{center}\n        \\includegraphics[width=\\columnwidth]{H_spectra_projections-crop}\n    \\end{center}\n    \\caption{Time-evolution of the populations of the $1s-$, $2p_z-$ and $3p_z-$ state. Dashed lines show the \n    analytic model, solid lines the numerical results. The total pump-laser (upper panel, black) has two carrier-frequencies, \n    one resonant to the transition $|\\Psi_{1s}\\rangle\\rightarrow|\\Psi_{2p}\\rangle$ (green), the other resonant to the\n    transition $|\\Psi_{1s}\\rangle\\rightarrow|\\Psi_{3p}\\rangle$ (blue). The lower panel shows the phase difference\n    $\\varphi_{3p}-\\varphi_{2p}$.}\n    \\label{fig:H_spectra_projections}\n\\end{figure}\nThe results are collected in Figure~\\ref{fig:H_spectra_projections} where we show the time-evolution of the \npopulations $|a(t)|^2$, $|b(t)|^2$ and $|c(t)|^2$ of the states \n$|1s\\rangle$, $|2p_z\\rangle$ and $|3p_z\\rangle$ respectively. The numerical values (solid lines)\nfollow closely the ones corresponding to the model\n\\eqref{eq:hcontrol_populations_td} (dashed lines) except for a small superimposed oscillatory behavior.\nA frequency analysis of the additional \noscillations shows, that they are due to the components neglected in the rotating wave approximation. The\nsmall deviation in the final populations from the analytic prediction comes from the excitation into the\n3d-states (not shown). The coupling to these orbitals was neglected in the three-level approximation.\nThis population transfer to the 3d-states nonetheless is less than 4\\% , and\nwe achieve a transfer into\nthe target wave function $|\\bar{\\Psi}\\rangle$ of 96\\%. \nFurthermore the transfer is obtained precisely with the desired relative phase $\\varphi=0$ as reported in the \nbottom panel of Figure~\\ref{fig:H_spectra_projections}.\n\n\\subsection{More Than one Electron: Results Based on TDDFT}\\label{sec:tddft}\nWe here turn to systems with more than one electron, and investigate\nthe possibility to drive the absorption of atoms and molecules into the visible using a \nlaser pulse optimized with the gradient-free optimization algorithm presented in Section~\\ref{sec:qoct}\nin combination with TDDFT.\n\n\\subsubsection{Helium}\nAs a first example we study the one-dimensional soft-Coulomb Helium atom.\nThis model is defined by the Hamiltonian:\n\n", "itemtype": "equation", "pos": 34012, "prevtext": "\nwhereas the phase-dependent interference term is\n\n", "index": 43, "text": "\\begin{align}\\nonumber\n&  \\bar\\sigma^{\\rm INT}(\\omega, \\varphi) =  0.4\\cdot 0.6\\cdot\n  \\frac{4\\pi\\omega}{3c}\\; \\Big[\n\\SumInt_{m} d_{2p,m}d_{m, 3p}\n\\\\\\nonumber\n&           \\left \\{ \\cos \\varphi L(\\omega-\\omega_{3p,m}) + \\sin\\varphi\nR(\\omega-\\omega_{3p,m}) \\right. \n\\\\\\nonumber\n&           \\left.  - \\cos\\varphi L(\\omega-\\omega_{3p,m}) + \\sin\\varphi\nR(\\omega-\\omega_{3p,m}) \\right\\} \n\\\\\\nonumber\n& +\\SumInt_{m} d_{2p,m}d_{m, 3p}\n\\\\\\nonumber \n&           \\left\\{ \\cos \\varphi L(\\omega-\\omega_{2p,m}) - \\sin \\varphi\nR(\\omega-\\omega_{2p,m}) \\right. \n\\\\\n&          \\left. -\\cos \\varphi L(\\omega-\\omega_{2p,m}) - \\sin \\varphi\nR(\\omega-\\omega_{2p,m}) \\right\\} \\Big]\n    \\label{eq:chi_nonequi_h}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\bar{\\sigma}^{\\rm INT}(\\omega,\\varphi)=0.4\\cdot 0.6\\cdot\\frac{4%&#10;\\pi\\omega}{3c}\\;\\Big{[}\\SumInt_{m}d_{2p,m}d_{m,3p}\" display=\"inline\"><mrow><msup><mover accent=\"true\"><mi>\u03c3</mi><mo stretchy=\"false\">\u00af</mo></mover><mi>INT</mi></msup><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo>,</mo><mi>\u03c6</mi><mo stretchy=\"false\">)</mo></mrow><mo>=</mo><mn>0.4</mn><mo>\u22c5</mo><mn>0.6</mn><mo>\u22c5</mo><mpadded width=\"+2.8pt\"><mstyle displaystyle=\"true\"><mfrac><mrow><mn>4</mn><mo>\u2062</mo><mi>\u03c0</mi><mo>\u2062</mo><mi>\u03c9</mi></mrow><mrow><mn>3</mn><mo>\u2062</mo><mi>c</mi></mrow></mfrac></mstyle></mpadded><mrow><mo maxsize=\"160%\" minsize=\"160%\">[</mo><msub><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\SumInt</mtext></merror><mi>m</mi></msub><msub><mi>d</mi><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>p</mi></mrow><mo>,</mo><mi>m</mi></mrow></msub><msub><mi>d</mi><mrow><mi>m</mi><mo>,</mo><mrow><mn>3</mn><mo>\u2062</mo><mi>p</mi></mrow></mrow></msub></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex6.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\left\\{\\cos\\varphi L(\\omega-\\omega_{3p,m})+\\sin\\varphi R(\\omega-%&#10;\\omega_{3p,m})\\right.\" display=\"inline\"><mrow><mo>{</mo><mi>cos</mi><mi>\u03c6</mi><mi>L</mi><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo>-</mo><msub><mi>\u03c9</mi><mrow><mrow><mn>3</mn><mo>\u2062</mo><mi>p</mi></mrow><mo>,</mo><mi>m</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><mo>+</mo><mi>sin</mi><mi>\u03c6</mi><mi>R</mi><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo>-</mo><msub><mi>\u03c9</mi><mrow><mrow><mn>3</mn><mo>\u2062</mo><mi>p</mi></mrow><mo>,</mo><mi>m</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex7.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\left.-\\cos\\varphi L(\\omega-\\omega_{3p,m})+\\sin\\varphi R(\\omega-%&#10;\\omega_{3p,m})\\right\\}\" display=\"inline\"><mrow><mo>-</mo><mi>cos</mi><mi>\u03c6</mi><mi>L</mi><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo>-</mo><msub><mi>\u03c9</mi><mrow><mrow><mn>3</mn><mo>\u2062</mo><mi>p</mi></mrow><mo>,</mo><mi>m</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><mo>+</mo><mi>sin</mi><mi>\u03c6</mi><mi>R</mi><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo>-</mo><msub><mi>\u03c9</mi><mrow><mrow><mn>3</mn><mo>\u2062</mo><mi>p</mi></mrow><mo>,</mo><mi>m</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><mo>}</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex8.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle+\\SumInt_{m}d_{2p,m}d_{m,3p}\" display=\"inline\"><mrow><mo>+</mo><mrow><msub><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\SumInt</mtext></merror><mi>m</mi></msub><mo>\u2062</mo><msub><mi>d</mi><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>p</mi></mrow><mo>,</mo><mi>m</mi></mrow></msub><mo>\u2062</mo><msub><mi>d</mi><mrow><mi>m</mi><mo>,</mo><mrow><mn>3</mn><mo>\u2062</mo><mi>p</mi></mrow></mrow></msub></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex9.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\left\\{\\cos\\varphi L(\\omega-\\omega_{2p,m})-\\sin\\varphi R(\\omega-%&#10;\\omega_{2p,m})\\right.\" display=\"inline\"><mrow><mo>{</mo><mi>cos</mi><mi>\u03c6</mi><mi>L</mi><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo>-</mo><msub><mi>\u03c9</mi><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>p</mi></mrow><mo>,</mo><mi>m</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><mo>-</mo><mi>sin</mi><mi>\u03c6</mi><mi>R</mi><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo>-</mo><msub><mi>\u03c9</mi><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>p</mi></mrow><mo>,</mo><mi>m</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E22.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\left.-\\cos\\varphi L(\\omega-\\omega_{2p,m})-\\sin\\varphi R(\\omega-%&#10;\\omega_{2p,m})\\right\\}\\Big{]}\" display=\"inline\"><mrow><mrow><mo>-</mo><mi>cos</mi><mi>\u03c6</mi><mi>L</mi><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo>-</mo><msub><mi>\u03c9</mi><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>p</mi></mrow><mo>,</mo><mi>m</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><mo>-</mo><mi>sin</mi><mi>\u03c6</mi><mi>R</mi><mrow><mo stretchy=\"false\">(</mo><mi>\u03c9</mi><mo>-</mo><msub><mi>\u03c9</mi><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>p</mi></mrow><mo>,</mo><mi>m</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><mo>}</mo></mrow><mo maxsize=\"160%\" minsize=\"160%\">]</mo></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\nwhere\n\n", "itemtype": "equation", "pos": 44853, "prevtext": "\nNote the change in the sign of the Rayleigh terms in both sums.\n\\begin{figure}[htb!]\n    \\begin{center}\n        \\includegraphics[clip, width=\\columnwidth]{H_spectra_analytic_phases-crop}\n    \\end{center}\n    \\caption{Absorption coefficient $\\bar\\sigma(\\omega)$ of the state  \n    defined in Eq.~\\eqref{eq:hydrogen_target} with $\\varphi=0$, $(1/2)\\pi$, $\\pi$ and $(3/2)\\pi$.\n    The total spectrum (black line) is the sum of two phase-independent terms $0.4\\bar\\sigma_{2p_z}$ (red shaded) \n    and $0.6\\bar\\sigma_{3p_z}$ (blue\n    shaded) coming from the excited state spectra of the respective states,\n    plus the phase-dependent interference term \n    $\\bar\\sigma^{\\mathrm{INT}}(\\omega, \\varphi)$ (green dashed line), which is responsible for the change of the\n    spectrum with the delay time.}\n    \\label{fig:H_spectrum_analytic_phases}\n\\end{figure}\n\nFig.~\\ref{fig:H_spectrum_analytic_phases} shows the different contributions and the complete spectrum for \n$\\varphi = 0$, $(1/2)\\pi$, $\\pi$ and $(3/2)\\pi$, which are the cases, where the interference term is either\npurely Lorentzian ($\\varphi=0$, $\\pi$) or purely Rayleigh ($\\varphi=1/2\\pi$, $3/2\\pi$). \nThe shaded areas\nindicate the weighted equilibrium contributions, the dotted line\nshows the interference terms, and the solid line the complete spectrum. \nThe energy range shown includes the transitions from\nn = 2 to all higher states and from n = 3 to all higher states and to n = 2. \nTransitions to the ground state lie outside of this region. \n\nAs can be learnt from Eq.~\\eqref{eq:chi_nonequi_h}, the interference terms require the existence of states\nwhich are dipole-coupled to both $2p_z$ and $3p_z$. \nThis is the case for $s$- and $d$-orbitals. This means, that e.g.\\ for Hydrogen in a linear\ncombination of the states $2s$ and $4f$, all the\ninterference terms would vanish and the spectrum would be purely the sum of the weighted equilibrium contributions.\n\nLet us take a closer look at the structure of the interference terms. \nWe start with the interference term at $\\omega_{23}=0.069$ Ha having contributions from terms with $m=2s$, $m=3s$ and $m=3d$. \nAll contributions have different prefactors with the ones coming from the 2s-state \nhaving the opposite sign compared to the ones coming from 3s and 3d states. \nFor the other peaks, the interference terms are much smaller at the \nenergies $\\omega_{3n}$ than their counterparts at \n$\\omega_{2n}$ (compare the purely blue to the purely red peaks in Fig.~\\ref{fig:H_spectrum_analytic_phases}).\nFrom Eq.~\\eqref{eq:chi_nonequi_h}, it is apparent that the amplitude of each interference term\nis the same for $\\omega_{2n}$ and $\\omega_{3n}$ with the same $n$. The difference comes purely\nfrom the factor $\\frac{4\\pi\\omega}{3c}$ -- note that the sign of the Rayleigh\ncontributions is opposite in these pairs of peaks. \nThis variation of amplitude has the following consequences for the change of \nthe overall spectrum:\n\nAt $\\omega_{3n}$ the spectrum has\npositive contributions from $\\bar\\sigma_{3p_z}$ and contributions from the interference terms, \nbut since the interference terms are much\nsmaller than $\\bar\\sigma_{3p_z}$, the spectrum changes only slightly for different $\\varphi$'s. \nThis is different for the peaks at energies $\\omega_{2n}$. \nHere, the spectrum has positive, phase-independent contributions from\n$\\bar\\sigma_{2p_z}(\\omega)$, but the contributions from the interference terms are much larger \nand dominate the spectrum leading\nto a strong dependence of the spectrum in this energy range on the phase $\\varphi$.\nFor $\\varphi=0$ and $\\varphi=\\pi$, \n$\\bar\\sigma^{\\rm INT}(\\omega, \\varphi)$ only contains Lorentzian peaks and consequently \nthe whole spectrum only contains Lorentzians. Nevertheless, $\\bar\\sigma^{\\rm INT}(\\omega, \\varphi)$ \nchanges sign between $\\varphi=0$ and $\\varphi=\\pi$, switching the sign of all\npeaks at $\\omega_{2n}$. This is a\ndemonstration of, how the manipulation of the internal phase $\\varphi$ can lead to a switch from gain (negative peaks)\nto loss (positive peaks) regime and\nvice versa. Finally, for $\\varphi=(1/2)\\pi$ and $\\varphi=(3/2)\\pi$, the interference spectrum contains purely Rayleigh\npeaks. Together with the small contributions from the stationary-state contributions, the final spectrum consists\nof slightly asymmetric Rayleigh peaks, again with different signs for $\\varphi=(1/2)\\pi$ and $\\varphi=(3/2)\\pi$. One can\ntherefore not only change peaks from emission to absorption peaks, but also manipulate their shape.\nThe phases $\\varphi$ therefore play a critical role in the spectral weights and the\npeaks of the photo-absorption spectrum. \n\nWe now look at the variation of the spectrum with time, \nassuming that an initial, yet unknown pump laser created the state of Eq.~\\eqref{eq:hydrogen_target} with $\\varphi=\\varphi_{32}=0$ at $t=T$\nand we probe the system at different delay times $\\tau$.\nFigure~\\ref{fig:Hydrogen_spectroscopy_td_spectrum} shows the corresponding time-resolved spectrum $\\bar\\sigma(\\omega, \\tau)$ \nof $|\\bar{\\Psi}\\rangle$. Since the eigenenergies of $|2p_z\\rangle$ and $|3p_z\\rangle$ are different, \nthe phase $\\Theta_{32}(\\tau)$ in Eq.~\\eqref{eq:theta}\nevolves with the frequency $\\omega_{32}$. At $\\tau=0$, $\\tau=\\frac{\\pi}{2\\omega_{32}}$, $\\tau=\\frac{\\pi}{\\omega_{32}}$\nand $\\tau=\\frac{3\\pi}{2\\omega_{32}}$, the spectra of Fig.~\\ref{fig:H_spectrum_analytic_phases} are reproduced. \nOne sees the strong changes of $\\bar\\sigma$ in the energy range of the peaks $\\omega_{2n}$, \nwhile the peaks $\\omega_{3n}$ remain almost unchanged. \nThe spectrum is periodic with $T=\\frac{2\\pi}{\\omega_{32}}\\approx$ 91~a.u..\n\n\\begin{figure}[htb!]\n     \\begin{center}\n       \\includegraphics[width=\\columnwidth]{H_td_cross_section-crop}\n     \\end{center}\n    \\caption{Time-resolved spectrum of the initial state \n    $\\sqrt{0.4} |2p_z\\rangle + \\sqrt{0.6} |3p_z\\rangle$ of Hydrogen. Because the\n    phases of the $|2p\\rangle$ and $|3p\\rangle$ states evolve with different velocities, \n    the spectral weights of each of the peaks changes with time, leading to a time-dependent \n    spectrum with a periodicity of $T = \\frac{2\\pi}{\\omega_{32}} \\approx 91 a.u.$. \n    \n    \n    }\n    \\label{fig:Hydrogen_spectroscopy_td_spectrum}\n\\end{figure}\n\n\nWe now move on to the control problem -- i.e.\\ the design of a pump pulse\ndriving the system into a state with specific optical properties.\nFor this problem, we will use the three-levels model, and the analytical\nequations of control presented in Section~\\ref{sec:qoct}.\nThe target state will again be the one defined in Eq.~\\eqref{eq:hydrogen_target} \n$|\\bar{\\Psi}\\rangle=\\sqrt{0.4}|2p_z\\rangle + \\sqrt{0.6}e^{i\\varphi}|3p_z\\rangle$\nwith a relative phase of $\\varphi=0$: $|\\bar{\\Psi}\\rangle=\\sqrt{0.4}|2p_z\\rangle + \\sqrt{0.6}|3p_z\\rangle$.\nThe three active states are then \n$|1s\\rangle$, $|2p_z\\rangle$ and $|3p_z\\rangle$. Note that since\n$|2p_z\\rangle$ and $|3p_z\\rangle$ have the same\nsymmetry, they are decoupled in the dipole approximation, and in consequence the system\nfits into the framework described in Section~\\ref{sec:qoct}. \nWe may therefore write down the shape of a control pulse,\nassuming a total pulse time of $T=3200$~a.u:\n\\begin{eqnarray}    \\label{eq:hcontrol_laser_numerical}\n    \\mathscr{E}(t) = \\frac{2\\pi}{T}  \n       && \\left(  \\frac{\\sqrt{0.4}}{d_{1s\\rightarrow 2p}}\\cos(\\omega_{1s\\rightarrow 2p}(t-T)+\\pi) \\right.  \\\\\n      +&& \\left.  \\frac{\\sqrt{0.6}}{d_{1s\\rightarrow 3p}}\\cos(\\omega_{1s\\rightarrow 3p}(t-T)+ \\pi)\\right)\n                    \\sin^2\\left(\\pi\\frac{t}{T}\\right).\\nonumber\n\\end{eqnarray}\n\nWe numerically solved the TSDE in order to check the validity of the three-level approximation. \nTo this end we discretized the equations on a spherical grid of radius $R=60$~a.u., \nspacing of $\\Delta x = 0.435$~a.u.\\ and with 20~a.u.\\ wide absorbing boundaries placed at the edges.\n\\begin{figure}[htb!]\n    \\begin{center}\n        \\includegraphics[width=\\columnwidth]{H_spectra_projections-crop}\n    \\end{center}\n    \\caption{Time-evolution of the populations of the $1s-$, $2p_z-$ and $3p_z-$ state. Dashed lines show the \n    analytic model, solid lines the numerical results. The total pump-laser (upper panel, black) has two carrier-frequencies, \n    one resonant to the transition $|\\Psi_{1s}\\rangle\\rightarrow|\\Psi_{2p}\\rangle$ (green), the other resonant to the\n    transition $|\\Psi_{1s}\\rangle\\rightarrow|\\Psi_{3p}\\rangle$ (blue). The lower panel shows the phase difference\n    $\\varphi_{3p}-\\varphi_{2p}$.}\n    \\label{fig:H_spectra_projections}\n\\end{figure}\nThe results are collected in Figure~\\ref{fig:H_spectra_projections} where we show the time-evolution of the \npopulations $|a(t)|^2$, $|b(t)|^2$ and $|c(t)|^2$ of the states \n$|1s\\rangle$, $|2p_z\\rangle$ and $|3p_z\\rangle$ respectively. The numerical values (solid lines)\nfollow closely the ones corresponding to the model\n\\eqref{eq:hcontrol_populations_td} (dashed lines) except for a small superimposed oscillatory behavior.\nA frequency analysis of the additional \noscillations shows, that they are due to the components neglected in the rotating wave approximation. The\nsmall deviation in the final populations from the analytic prediction comes from the excitation into the\n3d-states (not shown). The coupling to these orbitals was neglected in the three-level approximation.\nThis population transfer to the 3d-states nonetheless is less than 4\\% , and\nwe achieve a transfer into\nthe target wave function $|\\bar{\\Psi}\\rangle$ of 96\\%. \nFurthermore the transfer is obtained precisely with the desired relative phase $\\varphi=0$ as reported in the \nbottom panel of Figure~\\ref{fig:H_spectra_projections}.\n\n\\subsection{More Than one Electron: Results Based on TDDFT}\\label{sec:tddft}\nWe here turn to systems with more than one electron, and investigate\nthe possibility to drive the absorption of atoms and molecules into the visible using a \nlaser pulse optimized with the gradient-free optimization algorithm presented in Section~\\ref{sec:qoct}\nin combination with TDDFT.\n\n\\subsubsection{Helium}\nAs a first example we study the one-dimensional soft-Coulomb Helium atom.\nThis model is defined by the Hamiltonian:\n\n", "index": 45, "text": "\\begin{equation}\nH(t)= T + V_{\\rm ext}(t)+V_{\\rm ee}\\,,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E23.m1\" class=\"ltx_Math\" alttext=\"H(t)=T+V_{\\rm ext}(t)+V_{\\rm ee}\\,,\" display=\"block\"><mrow><mrow><mrow><mi>H</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mi>T</mi><mo>+</mo><mrow><msub><mi>V</mi><mi>ext</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mpadded width=\"+1.7pt\"><msub><mi>V</mi><mi>ee</mi></msub></mpadded></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\nis the external potential with softened Coulomb interaction \nand the dipolar coupling to the external time-dependent field $\\mathcal{E}(t)$\nThe electron-electron interaction is also described by a\nsoft-Coulomb function $V_{\\rm ee} = \\frac{1}{\\sqrt{1+(x_1-x_2)^2}}$.\nFor the optimization we solve the equations discretized on a regular grid\nof size $L=100$ a.u.\\ and spacing $\\Delta\nx=0.2$~a.u.\\ with 20~a.u.\\ absorbing boundaries at the borders of the simulation box.\nResults obtained with the optimized pulse were further converged\nin a box of size $L=200$~a.u.\\ with 70~a.u.\\ absorbing boundaries. \nTime was discretized with a time step of $\\Delta t = 0.025$~a.u.\\ \nfor a maximum propagation time of 1250~a.u.\\ during optimization and 2250~a.u.\\ for convergence.\nThe duration of the pump pulse was chosen to be $T_{\\mathcal{P}}~=~800$~a.u.\\ \nand the delay between pump and probe was set to $\\tau=50$~a.u. for all the calculations. \nFinally the target region for optimization was chosen between 0.06~a.u.\\ and 0.23~a.u.\\ ($\\approx$~200~nm and 800~nm).\nWe carried out optimizations at two different theory levels: exact (TDSE) and TDDFT \nwith the adiabatic EXX functional (TDEXX) \\cite{kummel-2003}.\n\nLet us first focus on the optimization obtained by solving the exact TDSE\nas illustrated in Figure~\\ref{fig:he}\\textcolor{blue}{(b)} where the ground state spectra \nare compared to the spectra of the systems excited by the optimized pump-pulses $\\mathscr{E}_{100}(t)$ \nobtained after 100 iterations.\nIn the exact case, the search space was constructed from two\nwave lengths $\\lambda = 800$~nm and $\\lambda = 1450$~nm and their first nine odd harmonics as shown in \nFigure~\\ref{fig:he}\\textcolor{blue}{(a)}. \nOptimization is achieved transferring population \nfrom the ground state (at $\\epsilon_0=-2.238$~a.u.) into the first excited state (at $\\epsilon_1=-1.705$) with the\nhelp of the 9th harmonic of $\\lambda=1450$~nm at\n$\\omega_{\\mathcal{P}13}=0.534$~a.u.. Due to this population transfer, \nthe peak at $\\omega_{0\\rightarrow 1}=0.533$~a.u.\\ turns from positive to negative and peaks\ncoming from the first excited state ($\\omega_{1\\rightarrow 2}=0.076$~a.u.\\ and $\\omega_{1\\rightarrow\n4}=0.159$~a.u.) arise in the excited-state spectrum, where the peak at $\\omega_{1\\rightarrow 2}$ is located in the\nvisible part of the energy range. \nAt the same time, population is transfered into the second excited\nstate ($\\epsilon_2=-1.629$ a.u.), leading to e.g.\\ the peaks at \n$\\omega_{2\\rightarrow 3}=0.062$~a.u.\\ and $\\omega_{2\\rightarrow\n5}=0.103$~a.u..\nThis interpretation is confirmed by the population analysis in Figure~\\ref{fig:he}\\textcolor{blue}{(d)}\nwhere $|\\langle\\Psi(t)|\\Phi_i\\rangle|^2$ is plotted over time.\nIn particular it is apparent that at the end of the pump only $\\approx$ 8\\% of the electrons \nremain in the ground state, whereas the rest has been transfered into higher lying states \nthus explaining the appearance of the new peaks in the spectrum.  \nTo complete the picture in Figure~\\ref{fig:he}\\textcolor{blue}{(c)} we show the\nevolution of the control function $G^A$ with the number of iterations. \nAs can be seen, $G^A$ shows a steady increase during the optimization.\n\n\\begin{figure}[htb!]\n    \\begin{center}\n        \\includegraphics[width=\\columnwidth]{He-crop}\n    \\end{center}\n    \\caption{Optimization of the absorption of one-dimensional Helium: TDSE vs.\\ TDEXX. \n    (a) Power spectrum of the initial and optimized laser pulses: \n    The green line shows the initial laser used for the TDSE; the green shaded\n    area shows the initial laser used for the TDEXX optimization (these two\n    only differ by the indicated \n    peaks at $\\omega=0.534$~a.u.\\ and $\\omega=0.549$~a.u.); the blue and red lines are\n    the optimal pulses obtained when using TDSE and TDEXX, respectively.\n    (b) Ground state (dashed line) and excited state (shaded) spectra of\n    optimized one-dimensional Helium, in blue and red for the TDSE and TDEXX\n    cases, respectively.\n    The excited state transitions of the exact calculations are indicated.\n    (c) The control function $G^A$ as a function of the number of iterations,\n    also in blue and red for the TDSE and TDEXX, respectively.\n    (d) The populations $|\\langle \\Psi(t)|\\Psi_i\\rangle|^2$ of the exact time propagation under the influence of the\n    optimized pump pulse for the (red) ground state, (green) first excited state, (blue) second excited state, (pink)\n    third excited state and (turquoise) fourth excited state.\n    \n    \n    }\n    \\label{fig:he}\n\\end{figure}\n\n\nFor the TDEXX case we adapted the search space by replacing the laser component\nat the carrier frequency $\\omega=0.534$~a.u. (in resonance with the first excitation in the TDSE case)\nby a laser component with $\\omega=0.549$~a.u., which is its TDEXX equivalent.\nIn our experience failing to meet this requirement resulted in poor optimizations.\nThe resulting optimization is shown in\nFigure~\\ref{fig:he}\\textcolor{blue}{(b)}.\nThe results follow a trend similar to the exact case. However the TDEXX optimization is\nsmaller and the $1 \\rightarrow 2$ peak present in TDSE seems to be missing. \nThe difference between TDEXX and TDSE can be tracked down \nto a known problem of the adiabatic approximation in TDDFT. \nIn particular, the lack of memory in the adiabatic \napproximation, causing a spurious time dependence of the exchange potential,\nis responsible for the poor population transfer and the excess of asymmetric peaks in \nthe spectrum~\\cite{degiovannini-2013,Fuks:2015jp}.\nThis problem is further amplified by the ionization of the system, which \nresults in an unphysical shift of the peaks to higher energies \n(compare the ground state and the excited state spectrum in Figure~\\ref{fig:he}).\nThese effects, however, strongly depend on the fraction of the total density that gets driven\nout of equilibrium and therefore become more dominant with decreasing size of the \nsystem -- with Helium being the worst case. \nIn large molecules with many electrons we expect the error to be greatly reduced\n(as has been empirically shown in studies of light induced charge transfer in organic photovoltaic\nblends \\cite{rozzi-2013, falke-2014}). \n\n\n\\begin{figure}\n    \\begin{center}\n      \\includegraphics[width=\\columnwidth]{He_td_panel}\n    \\end{center}\n    \\caption{(Top) Transient Absorption Spectrum of Helium after the excitation with a 45 cycle $\\sin^2$ laser pulse of\n    intensity $I=5.26 \\cdot 10^{11} Wcm^{-2}$ with a carrier frequency resonant to the excitation energy from the ground\n    to the first excited state for exact (a) and adiabatic EXX (b) with\n    $\\omega^{\\rm exact}=0.534$~a.u. and $\\omega^{\\rm EXX}=0.549$~a.u.. Time-evolution of\n    the absorption cross-section at selected energies $\\omega_n = 0.2$ (red), 0.4 (blue), 0.6 (purple) 0.8 (turquoise) a.u.\\ for\n    exact (c) and adiabatic EXX (d). In the exact case the curve at 0.6~a.u.\\ is offset by -0.1 for clarity.\n    In all cases, the time interval $T=2\\pi/(\\epsilon_1-\\epsilon_0)$ is shown.\n    }\n    \\label{fig:he_tddft_time_resolved}\n\\end{figure}\n\nA different perspective on the same problem can be obtained by comparing the time\nevolution of an excited state spectrum in TDSE and TDEXX as shown in Figure~\\ref{fig:he_tddft_time_resolved}.\nThe systems were excited by a 45 cycle $\\sin^2$ laser pulse resonant with the excitation energy \nfrom the ground state into the first excited state. \nAfter the pulse the systems are in a superposition of these two states and\nthe spectra should contain time-dependent interference terms, which oscillate with the period time\n$T=\\frac{2\\pi}{\\epsilon_1-\\epsilon_0}$, which is $T=11.76$~a.u.\\ for TDSE and $T=11.26$~a.u.\\ for TDEXX.\nHowever, on the scale of Figure~\\ref{fig:he_tddft_time_resolved}\\textcolor{blue}{(a)} the TDSE spectrum hardly \npresents any oscillation. Therefore, in Figure~\\ref{fig:he_tddft_time_resolved}\\textcolor{blue}{(c)} we report \ncuts at $\\omega_n$~=~0.2, 0.4, 0.6 and 0.8~a.u. From the figure it is apparent that, albeit with different phases, \neach cut presents oscillations with the expected period of $T=11.76$~a.u..\nThe TDEXX calculations, in Figure~\\ref{fig:he_tddft_time_resolved}\\textcolor{blue}{(b)} and \\textcolor{blue}{(d)},\npresent a different picture. \nFirst of all, the amplitude of the oscillations is much larger than in the exact case and, second, the \noscillations are two times faster than expected. \nWe conclude, that the TDEXX description\nseems to have a similar structure to the exact case, in the sense, that the energy difference of the involved states is\nreflected in the periodicity of the oscillations of the spectrum. \nNonetheless, there are major differences in the\nbehaviour, which is reflected in the factor of two in the periodicity. \n\n\\subsubsection{Methane Dication}\n\nFinally, we apply our scheme to a poly-atomic molecule: doubly-ionized Methane, $\\mathrm{CH}_4^{+2}$.\nThe goal here is to design a laser capable to turn this molecule, transparent \nin nature, visible. \nTo this end we used the same strategy as we did before for Helium, namely \nwe optimize the laser on a small simulation box and then converge the results with the \noptimized laser on a larger box. \nDuring the optimization routine the simulation box has a radius of $R = 15$~a.u., including 5~a.u.\\\nabsorbing boundaries while the results are converged in a box of $R = 30$~a.u.\\ with 15~a.u.\\ absorbing boundaries.\nWe discretize the TDDFT equations on a three-dimensional grid with a spacing of $\\Delta x =0.3$~a.u..\nThe reason for this box choice is the fact that the computational \ncosts of three-dimensional calculations scale with the third power of \nthe simulation box radius.\nThe maximum propagation time is 850~a.u.\\ during the optimization and 1600~a.u.\\ for convergence. In all cases, the \npump duration was 600~a.u., the time step was $\\Delta t = 0.04$~a.u.\\ and the delay was $\\tau=0$~a.u..\n\nThe optimization region was chosen as the interval between \n0.057~a.u.\\ and 0.139~a.u.~(328 and 750~nm) and \nin order to discourage the algorithm from exciting too many electrons into\nthe continuum, we used the target functional $G^B_{\\tau}$ \\eqref{eq:epsilon_b}, \nwhich includes an exponential ``penalty'' for ionization.\n\nTo obtain a good description of states close to the ionization threshold, \nwe employed the average density self-interaction corrected (ADSIC) LDA\nfunctional \\cite{legrand-2002}, which is asymptotically correct. \n\nThe inclusion of resonant frequencies in the search space is a good practice \nthat facilitates transitions between eigenstates and enables the optimization algorithm to\npopulate excited eigenstates.\nThese molecular excitation frequencies can easily be obtained from \nthe ground-state spectrum reported in Figure~\\ref{fig:ch4_2plus_gs}.\nBy populating the correct\neigenstates, the system might absorb in the visible region: consider\ntwo eigenstates with energies $\\epsilon_h$ and $\\epsilon_T$, \nthat differ by an energy in the visible: 0.057~a.u.~$\\leq \\epsilon_h-\\epsilon_T\\leq$~0.139~a.u.. \nBy exciting the system into the lower ``target'' state $\\epsilon_T$ \none might obtain transition peaks in the visible, due to the transition to the\nhigher one. \nNote, however, that this \nfact is not guaranteed since the transition might be dipole forbidden. We\ncannot rule out this possibility since our groundstate linear-response TDDFT\ncalculation does not provide this information. \n\\begin{figure}[htb!]\n    \\begin{center}\n        \\includegraphics[width=\\columnwidth]{CH4_2plus_gs-crop}\n    \\end{center}\n    \\caption{Ground state spectrum of doubly-ionized Methane CH$_4^{2+}$. Peaks are numbered for later reference (as\n    discussed in the text). The\n    shaded grey area marks the optimization range.}\n    \\label{fig:ch4_2plus_gs}\n\\end{figure}\n\nThe ground state spectrum shows, that the first possible target\nstate is $\\epsilon_3$. The energy difference between\n$\\epsilon_3=0.690$~a.u.\\ and $\\epsilon_4=0.816$~a.u.\\ is $\\omega_{3\\rightarrow 4}=0.126$~a.u.\\ \nand lies -- with 362 nm -- at the red end of the visible spectrum. \nAlso $\\epsilon_4$ provides a transition in the visible range -- into $\\epsilon_5=0.938$~a.u.\\ \nwith $\\omega_{4\\rightarrow 5}=0.122$~a.u.\\ = 373 nm. \nStarting from $\\epsilon_5$, the  states have even more than one transition in the\nvisible. We must therefore choose a frequency search space, \nthat allows the construction of a pump pulse, that excites electrons\nfrom the ground state into $\\epsilon_3$ and higher lying states either directly or by successive excitations.\n\nHere we present results for two possible search spaces.\nThe first search space includes frequencies that are either resonant \nto the ground state excitation energies $\\epsilon_n$, or to excited state excitations $\\epsilon_m-\\epsilon_n$.\nTo avoid ionization, all carrier frequencies are smaller than $\\epsilon_7=1.0$ a.u..\nThe second frequency search space was designed using the ionization potential $I_P$ \nof the system (which is equal to minus the \nenergy $\\epsilon_{H}$ of the highest occupied KS orbital $\\varphi_H$) and the energy differences $I_P-\\epsilon_n$. \nOne frequency is $I_P$ itself, while all others are resonant with \nrelaxations bringing down states at that ionization threshold\nto bound excited states ($\\epsilon_3$ to $\\epsilon_8$).\nThe idea is that the system could be excited into the ionization threshold,\nand then relax into one of the target states. \n\nThe laser frequencies, that were included in the search spaces and the corresponding resonances are summarized\nin Appendix~\\ref{sec:appendix_laserfreqs}.\n\\begin{figure}[htb!]\n  \\begin{center}\n      \\includegraphics[width=\\columnwidth]{CH4_2plus-crop}\n  \\end{center}\n    \\caption{\n    Ground state (black line) and excited state (shaded) spectra of \n    doubly-ionized Methane (CH$_4^{2+}$) \n    for two different pump pulses $\\mathscr{E}^I$ (red) and $\\mathscr{E}^{II}$ (blue). \n    The grey shaded box marks the optimization area, the blue shaded area the visible region of the\n    spectrum.\n    }\n  \\label{fig:ch4_2plus}\n\\end{figure}\n\nThe optimized spectra are shown in Figure~\\ref{fig:ch4_2plus}.\nIt can be seen that both search spaces include optimal lasers that cause the molecule to loose its transparency and \nabsorb in the visible. The achieved opacity can be quantified in terms of the control function $G^A$ \\eqref{eq:epsilon_a} \nbeing the integral over the absorption spectrum in the visible range of the spectrum. Comparing the opacity achieved \nin search space I ($G^A_I=0.017$) with the one achieved in search space II ($G^A_{II}=0.020$), we conclude that \nsearch space II is better suited for the pursued optimization. Thus, including energy levels at the ionization\nthreshold in the search space might be a useful strategy in further optimizations. \n\n\\section{Conclusions} \n\\label{sec:conclusions}\n\nIn this work, we assessed the possibility of using tailored pumps in order to\nenhance some given features of the probe absorption -- for example, the\nabsorption in the visible range of otherwise transparent samples. \nWe first detailed a theoretical analysis of the\nnon-equilibrium response function in this context, aided by one simple\nnumerical model of the Hydrogen atom. Then, we investigated the\nfeasibility of using TDDFT theory as a means to\nimplement, theoretically, this absorption-optimization idea, for more complex\natoms or molecules.\n\nThe theoretical analysis of the response function can be done by writing it in\na generalized form of the Lehmann representation, valid for systems that have\nbeen pumped out of equilibrium by a first pulse, and whose response to a probe\npulse (in our case, assumed non-overlapping with the first one) needs to be\nstudied and manipulated. The peaks of this response functions are always fixed\nto the differences in the system energies, but their strength and shape varies\ndepending on the pump shape, and on the pump-probe delay. Furthermore, the\nresponse function is a sum of a stationary part (the only one present if the\npumped state is itself a stationary state), and a time-dependent,\noscillatory term, caused by interferences between the populated eigenstates.\n\nWe then used this dependence of the non-equilibrium response with respect to the pump pulse\nshape to manipulate it by means of QOCT. We demonstrated the idea first with a\nsmall model, that could be treated analytically. This could be a viable\nalternative for larger systems, if they can be reduced to few-level\nmodels. However, for full generality we also showed how QOCT can be combined\nwith TDDFT. We showed how this avenue is tractable, but we also highlighted\nthe key numerical difficulties and theoretical challenges. For this purpose,\nwe performed first calculations on a model for the Helium atom that could be\nsolved both exactly with the TDSE equation, and with TDDFT within the\nadiabatic EXX approximation. Then we concluded with simulations of the\nmethane dication.\n\nFrom our results we conclude that the proposed idea could be brought to the\nlaboratory: tailored pump pulses can excite systems into light-absorbing states.\nTheoretically, the scalability of TDDFT could in principle permit studying\nthese processes for larger systems. However, our results have also highlighted\nthe severe numerical and theoretical difficulties posed by the problem: large-scale\nnon-equilibrium quantum dynamics are cumbersome, even with TDDFT, and moreover\nthe shortcomings of state-of-the-art TDDFT functionals may still be\nserious for these out-of-equilibrium situations. \nOur findings confirm recent investigations about the consequences of these shortcomings \nfor the use of coherent control schemes~\\cite{raghunathan-2011, raghunathan-2012}.\n\n\n\\section*{Acknowledgements} \n\nWe acknowledge financial support from the European Research Council (ERC-2010-AdG-267374), Spanish grant\n(FIS2013-46159-C3-1-P), Grupos Consolidados (IT578-13), and AFOSR Grant No. FA2386-15-1-0006 AOARD 144088,\nH2020-NMP-2014 project MOSTOPHOS, GA no. SEP-210187476 and COST Action MP1306 (EUSpec).\nComputational time was granted by BSC Red Espanola de Supercomputacion.\n\n\n\\appendix\n\n\\section{Quantum Optimal Control Equations}\\label{sec:qoct_gradientbased}\n\nFor completeness, we derive here the equations for\nthe computation of the gradient of a target functional designed to optimize\nthe response of a system.\nIn general, the equation for the gradient provided by QOCT is given by:\n\\begin{subequations}\n\\label{eq:equations_of_control}\n\n", "itemtype": "equation", "pos": 44930, "prevtext": "\nwhere\n\n", "index": 47, "text": "\\begin{equation}\nV_{\\rm ext}(t)= -\\frac{2}{\\sqrt{1+x_1^2}} - \\frac{2}{\\sqrt{1+x_2^2}} + \\mathcal{E}(t)(x_1+x_2)\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E24.m1\" class=\"ltx_Math\" alttext=\"V_{\\rm ext}(t)=-\\frac{2}{\\sqrt{1+x_{1}^{2}}}-\\frac{2}{\\sqrt{1+x_{2}^{2}}}+%&#10;\\mathcal{E}(t)(x_{1}+x_{2})\" display=\"block\"><mrow><mrow><msub><mi>V</mi><mi>ext</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mrow><mo>-</mo><mfrac><mn>2</mn><msqrt><mrow><mn>1</mn><mo>+</mo><msubsup><mi>x</mi><mn>1</mn><mn>2</mn></msubsup></mrow></msqrt></mfrac></mrow><mo>-</mo><mfrac><mn>2</mn><msqrt><mrow><mn>1</mn><mo>+</mo><msubsup><mi>x</mi><mn>2</mn><mn>2</mn></msubsup></mrow></msqrt></mfrac></mrow><mo>+</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\u2130</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>x</mi><mn>2</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\n\nNote that a new ``wave function'', $\\chi[\\mathscr{E}]$, has been introduced;\nit is given by the solution of:\n\\begin{eqnarray}\n\\label{eq:lambda-1}\ni\\frac{\\partial \\chi[\\mathscr{E}]}{\\partial t} (x,t)  & = & \\hat{H}^{\\dagger}[\\mathscr{E},t]\n\\chi[\\mathscr{E}](x,t) \n\n\\\\\n\\label{eq:lambda-2}\n\\chi[\\mathscr{E}](x,T) & = & \\frac{\\delta J_1^T}{\\delta \\Psi^*[\\mathscr{E}](x,T)} \\,.\n\\end{eqnarray}\n\\end{subequations}\nThis is similar to the original Schr{\\\"{o}}dinger equation~\\eqref{eq:schroedinger_control}, although\nthe initial condition is\ngiven at the final time $t=T$, which implies it must be propagated\n\\emph{backwards}.\nFor a detailed derivation of\nEqs.~\\eqref{eq:equations_of_control} we\nrefer the reader to Refs.~\\cite{peirce-1988, kosloff-1989, ohtsuki-2004, serban-2005}. \n\nThe computation of the gradient or functional derivative of $G$,\ntherefore, requires $\\Psi[\\mathscr{E}]$ and $\\chi[\\mathscr{E}]$, which are obtained by\nfirst propagating Eq.~\\eqref{eq:schroedinger-1} forwards, and then\nEq.~\\eqref{eq:lambda-1} backwards. The maxima of $G$ are found at the\ncritical points $\\nabla_\\mathbf{c} G[\\mathscr{E}_\\mathbf{c}] = 0$.\n\nWe may now apply these general equations for\na target functional designed to optimize\nthe response of a system after the excitation by a pump pulse. \nThis setup is consistent with the non-overlapping regime described\nin Section~\\ref{sec:spec_ex}, where the Hamiltonian that governs the system, once that the pump has passed\n($t \\ge T$) has the form \\eqref{eq:hamiltonian_nonoverlapping}.\nIf, at time $t=T$, the system has been driven to the state\n$\\vert\\Psi(T)\\rangle$, the response function for the perturbation at\nlater times is given by \\eqref{eq:retarded_response_function_recast}\nand the first-order response of the system is given by \\eqref{eq:dipole_response}.\n\nThe key point is the definition of a target: for example, let us assume, that we\nwish to enhance the\nreaction of the system at a given frequency to a sudden perturbation at \nthe end of the pump $F(t') = \\delta(t-T)$. \nAs seen in \\eqref{eq:first_order_response_deltafunction}, the time-dependent dipole-dipole \nresponse is then directly given by the response function\n$\\chi_{\\hat{D},\\hat{D}}\\left[\\mathscr{E}\\right](t,T) = D^{(1)}\\left[\\mathscr{E}, \\delta_{T}\\right](t) $\nand its Fourier transform by\n\\begin{eqnarray}\\nonumber\n\\chi_{\\hat{D},\\hat{D}}\\left[\\mathscr{E}\\right](\\omega,T) \n    &=& D^{(1)}\\left[\\mathscr{E}, \\delta_{T}\\right](\\omega) \\\\\n    &=& \\int_{T}^{\\infty}\\!\\!{\\rm d t'}\\;e^{-i\\omega t'}D^{(1)}\\left[\\mathscr{E}, \\delta_{T}\\right](t') \\, . \n    \\label{eq:response_ft}\n\\end{eqnarray}\nIt can be easily seen that the problem fits into\nthe framework discussed above, i.e.\\ the target functional is\ngiven by the expectation value of some operator:\n\n", "itemtype": "equation", "pos": 63497, "prevtext": "\nis the external potential with softened Coulomb interaction \nand the dipolar coupling to the external time-dependent field $\\mathcal{E}(t)$\nThe electron-electron interaction is also described by a\nsoft-Coulomb function $V_{\\rm ee} = \\frac{1}{\\sqrt{1+(x_1-x_2)^2}}$.\nFor the optimization we solve the equations discretized on a regular grid\nof size $L=100$ a.u.\\ and spacing $\\Delta\nx=0.2$~a.u.\\ with 20~a.u.\\ absorbing boundaries at the borders of the simulation box.\nResults obtained with the optimized pulse were further converged\nin a box of size $L=200$~a.u.\\ with 70~a.u.\\ absorbing boundaries. \nTime was discretized with a time step of $\\Delta t = 0.025$~a.u.\\ \nfor a maximum propagation time of 1250~a.u.\\ during optimization and 2250~a.u.\\ for convergence.\nThe duration of the pump pulse was chosen to be $T_{\\mathcal{P}}~=~800$~a.u.\\ \nand the delay between pump and probe was set to $\\tau=50$~a.u. for all the calculations. \nFinally the target region for optimization was chosen between 0.06~a.u.\\ and 0.23~a.u.\\ ($\\approx$~200~nm and 800~nm).\nWe carried out optimizations at two different theory levels: exact (TDSE) and TDDFT \nwith the adiabatic EXX functional (TDEXX) \\cite{kummel-2003}.\n\nLet us first focus on the optimization obtained by solving the exact TDSE\nas illustrated in Figure~\\ref{fig:he}\\textcolor{blue}{(b)} where the ground state spectra \nare compared to the spectra of the systems excited by the optimized pump-pulses $\\mathscr{E}_{100}(t)$ \nobtained after 100 iterations.\nIn the exact case, the search space was constructed from two\nwave lengths $\\lambda = 800$~nm and $\\lambda = 1450$~nm and their first nine odd harmonics as shown in \nFigure~\\ref{fig:he}\\textcolor{blue}{(a)}. \nOptimization is achieved transferring population \nfrom the ground state (at $\\epsilon_0=-2.238$~a.u.) into the first excited state (at $\\epsilon_1=-1.705$) with the\nhelp of the 9th harmonic of $\\lambda=1450$~nm at\n$\\omega_{\\mathcal{P}13}=0.534$~a.u.. Due to this population transfer, \nthe peak at $\\omega_{0\\rightarrow 1}=0.533$~a.u.\\ turns from positive to negative and peaks\ncoming from the first excited state ($\\omega_{1\\rightarrow 2}=0.076$~a.u.\\ and $\\omega_{1\\rightarrow\n4}=0.159$~a.u.) arise in the excited-state spectrum, where the peak at $\\omega_{1\\rightarrow 2}$ is located in the\nvisible part of the energy range. \nAt the same time, population is transfered into the second excited\nstate ($\\epsilon_2=-1.629$ a.u.), leading to e.g.\\ the peaks at \n$\\omega_{2\\rightarrow 3}=0.062$~a.u.\\ and $\\omega_{2\\rightarrow\n5}=0.103$~a.u..\nThis interpretation is confirmed by the population analysis in Figure~\\ref{fig:he}\\textcolor{blue}{(d)}\nwhere $|\\langle\\Psi(t)|\\Phi_i\\rangle|^2$ is plotted over time.\nIn particular it is apparent that at the end of the pump only $\\approx$ 8\\% of the electrons \nremain in the ground state, whereas the rest has been transfered into higher lying states \nthus explaining the appearance of the new peaks in the spectrum.  \nTo complete the picture in Figure~\\ref{fig:he}\\textcolor{blue}{(c)} we show the\nevolution of the control function $G^A$ with the number of iterations. \nAs can be seen, $G^A$ shows a steady increase during the optimization.\n\n\\begin{figure}[htb!]\n    \\begin{center}\n        \\includegraphics[width=\\columnwidth]{He-crop}\n    \\end{center}\n    \\caption{Optimization of the absorption of one-dimensional Helium: TDSE vs.\\ TDEXX. \n    (a) Power spectrum of the initial and optimized laser pulses: \n    The green line shows the initial laser used for the TDSE; the green shaded\n    area shows the initial laser used for the TDEXX optimization (these two\n    only differ by the indicated \n    peaks at $\\omega=0.534$~a.u.\\ and $\\omega=0.549$~a.u.); the blue and red lines are\n    the optimal pulses obtained when using TDSE and TDEXX, respectively.\n    (b) Ground state (dashed line) and excited state (shaded) spectra of\n    optimized one-dimensional Helium, in blue and red for the TDSE and TDEXX\n    cases, respectively.\n    The excited state transitions of the exact calculations are indicated.\n    (c) The control function $G^A$ as a function of the number of iterations,\n    also in blue and red for the TDSE and TDEXX, respectively.\n    (d) The populations $|\\langle \\Psi(t)|\\Psi_i\\rangle|^2$ of the exact time propagation under the influence of the\n    optimized pump pulse for the (red) ground state, (green) first excited state, (blue) second excited state, (pink)\n    third excited state and (turquoise) fourth excited state.\n    \n    \n    }\n    \\label{fig:he}\n\\end{figure}\n\n\nFor the TDEXX case we adapted the search space by replacing the laser component\nat the carrier frequency $\\omega=0.534$~a.u. (in resonance with the first excitation in the TDSE case)\nby a laser component with $\\omega=0.549$~a.u., which is its TDEXX equivalent.\nIn our experience failing to meet this requirement resulted in poor optimizations.\nThe resulting optimization is shown in\nFigure~\\ref{fig:he}\\textcolor{blue}{(b)}.\nThe results follow a trend similar to the exact case. However the TDEXX optimization is\nsmaller and the $1 \\rightarrow 2$ peak present in TDSE seems to be missing. \nThe difference between TDEXX and TDSE can be tracked down \nto a known problem of the adiabatic approximation in TDDFT. \nIn particular, the lack of memory in the adiabatic \napproximation, causing a spurious time dependence of the exchange potential,\nis responsible for the poor population transfer and the excess of asymmetric peaks in \nthe spectrum~\\cite{degiovannini-2013,Fuks:2015jp}.\nThis problem is further amplified by the ionization of the system, which \nresults in an unphysical shift of the peaks to higher energies \n(compare the ground state and the excited state spectrum in Figure~\\ref{fig:he}).\nThese effects, however, strongly depend on the fraction of the total density that gets driven\nout of equilibrium and therefore become more dominant with decreasing size of the \nsystem -- with Helium being the worst case. \nIn large molecules with many electrons we expect the error to be greatly reduced\n(as has been empirically shown in studies of light induced charge transfer in organic photovoltaic\nblends \\cite{rozzi-2013, falke-2014}). \n\n\n\\begin{figure}\n    \\begin{center}\n      \\includegraphics[width=\\columnwidth]{He_td_panel}\n    \\end{center}\n    \\caption{(Top) Transient Absorption Spectrum of Helium after the excitation with a 45 cycle $\\sin^2$ laser pulse of\n    intensity $I=5.26 \\cdot 10^{11} Wcm^{-2}$ with a carrier frequency resonant to the excitation energy from the ground\n    to the first excited state for exact (a) and adiabatic EXX (b) with\n    $\\omega^{\\rm exact}=0.534$~a.u. and $\\omega^{\\rm EXX}=0.549$~a.u.. Time-evolution of\n    the absorption cross-section at selected energies $\\omega_n = 0.2$ (red), 0.4 (blue), 0.6 (purple) 0.8 (turquoise) a.u.\\ for\n    exact (c) and adiabatic EXX (d). In the exact case the curve at 0.6~a.u.\\ is offset by -0.1 for clarity.\n    In all cases, the time interval $T=2\\pi/(\\epsilon_1-\\epsilon_0)$ is shown.\n    }\n    \\label{fig:he_tddft_time_resolved}\n\\end{figure}\n\nA different perspective on the same problem can be obtained by comparing the time\nevolution of an excited state spectrum in TDSE and TDEXX as shown in Figure~\\ref{fig:he_tddft_time_resolved}.\nThe systems were excited by a 45 cycle $\\sin^2$ laser pulse resonant with the excitation energy \nfrom the ground state into the first excited state. \nAfter the pulse the systems are in a superposition of these two states and\nthe spectra should contain time-dependent interference terms, which oscillate with the period time\n$T=\\frac{2\\pi}{\\epsilon_1-\\epsilon_0}$, which is $T=11.76$~a.u.\\ for TDSE and $T=11.26$~a.u.\\ for TDEXX.\nHowever, on the scale of Figure~\\ref{fig:he_tddft_time_resolved}\\textcolor{blue}{(a)} the TDSE spectrum hardly \npresents any oscillation. Therefore, in Figure~\\ref{fig:he_tddft_time_resolved}\\textcolor{blue}{(c)} we report \ncuts at $\\omega_n$~=~0.2, 0.4, 0.6 and 0.8~a.u. From the figure it is apparent that, albeit with different phases, \neach cut presents oscillations with the expected period of $T=11.76$~a.u..\nThe TDEXX calculations, in Figure~\\ref{fig:he_tddft_time_resolved}\\textcolor{blue}{(b)} and \\textcolor{blue}{(d)},\npresent a different picture. \nFirst of all, the amplitude of the oscillations is much larger than in the exact case and, second, the \noscillations are two times faster than expected. \nWe conclude, that the TDEXX description\nseems to have a similar structure to the exact case, in the sense, that the energy difference of the involved states is\nreflected in the periodicity of the oscillations of the spectrum. \nNonetheless, there are major differences in the\nbehaviour, which is reflected in the factor of two in the periodicity. \n\n\\subsubsection{Methane Dication}\n\nFinally, we apply our scheme to a poly-atomic molecule: doubly-ionized Methane, $\\mathrm{CH}_4^{+2}$.\nThe goal here is to design a laser capable to turn this molecule, transparent \nin nature, visible. \nTo this end we used the same strategy as we did before for Helium, namely \nwe optimize the laser on a small simulation box and then converge the results with the \noptimized laser on a larger box. \nDuring the optimization routine the simulation box has a radius of $R = 15$~a.u., including 5~a.u.\\\nabsorbing boundaries while the results are converged in a box of $R = 30$~a.u.\\ with 15~a.u.\\ absorbing boundaries.\nWe discretize the TDDFT equations on a three-dimensional grid with a spacing of $\\Delta x =0.3$~a.u..\nThe reason for this box choice is the fact that the computational \ncosts of three-dimensional calculations scale with the third power of \nthe simulation box radius.\nThe maximum propagation time is 850~a.u.\\ during the optimization and 1600~a.u.\\ for convergence. In all cases, the \npump duration was 600~a.u., the time step was $\\Delta t = 0.04$~a.u.\\ and the delay was $\\tau=0$~a.u..\n\nThe optimization region was chosen as the interval between \n0.057~a.u.\\ and 0.139~a.u.~(328 and 750~nm) and \nin order to discourage the algorithm from exciting too many electrons into\nthe continuum, we used the target functional $G^B_{\\tau}$ \\eqref{eq:epsilon_b}, \nwhich includes an exponential ``penalty'' for ionization.\n\nTo obtain a good description of states close to the ionization threshold, \nwe employed the average density self-interaction corrected (ADSIC) LDA\nfunctional \\cite{legrand-2002}, which is asymptotically correct. \n\nThe inclusion of resonant frequencies in the search space is a good practice \nthat facilitates transitions between eigenstates and enables the optimization algorithm to\npopulate excited eigenstates.\nThese molecular excitation frequencies can easily be obtained from \nthe ground-state spectrum reported in Figure~\\ref{fig:ch4_2plus_gs}.\nBy populating the correct\neigenstates, the system might absorb in the visible region: consider\ntwo eigenstates with energies $\\epsilon_h$ and $\\epsilon_T$, \nthat differ by an energy in the visible: 0.057~a.u.~$\\leq \\epsilon_h-\\epsilon_T\\leq$~0.139~a.u.. \nBy exciting the system into the lower ``target'' state $\\epsilon_T$ \none might obtain transition peaks in the visible, due to the transition to the\nhigher one. \nNote, however, that this \nfact is not guaranteed since the transition might be dipole forbidden. We\ncannot rule out this possibility since our groundstate linear-response TDDFT\ncalculation does not provide this information. \n\\begin{figure}[htb!]\n    \\begin{center}\n        \\includegraphics[width=\\columnwidth]{CH4_2plus_gs-crop}\n    \\end{center}\n    \\caption{Ground state spectrum of doubly-ionized Methane CH$_4^{2+}$. Peaks are numbered for later reference (as\n    discussed in the text). The\n    shaded grey area marks the optimization range.}\n    \\label{fig:ch4_2plus_gs}\n\\end{figure}\n\nThe ground state spectrum shows, that the first possible target\nstate is $\\epsilon_3$. The energy difference between\n$\\epsilon_3=0.690$~a.u.\\ and $\\epsilon_4=0.816$~a.u.\\ is $\\omega_{3\\rightarrow 4}=0.126$~a.u.\\ \nand lies -- with 362 nm -- at the red end of the visible spectrum. \nAlso $\\epsilon_4$ provides a transition in the visible range -- into $\\epsilon_5=0.938$~a.u.\\ \nwith $\\omega_{4\\rightarrow 5}=0.122$~a.u.\\ = 373 nm. \nStarting from $\\epsilon_5$, the  states have even more than one transition in the\nvisible. We must therefore choose a frequency search space, \nthat allows the construction of a pump pulse, that excites electrons\nfrom the ground state into $\\epsilon_3$ and higher lying states either directly or by successive excitations.\n\nHere we present results for two possible search spaces.\nThe first search space includes frequencies that are either resonant \nto the ground state excitation energies $\\epsilon_n$, or to excited state excitations $\\epsilon_m-\\epsilon_n$.\nTo avoid ionization, all carrier frequencies are smaller than $\\epsilon_7=1.0$ a.u..\nThe second frequency search space was designed using the ionization potential $I_P$ \nof the system (which is equal to minus the \nenergy $\\epsilon_{H}$ of the highest occupied KS orbital $\\varphi_H$) and the energy differences $I_P-\\epsilon_n$. \nOne frequency is $I_P$ itself, while all others are resonant with \nrelaxations bringing down states at that ionization threshold\nto bound excited states ($\\epsilon_3$ to $\\epsilon_8$).\nThe idea is that the system could be excited into the ionization threshold,\nand then relax into one of the target states. \n\nThe laser frequencies, that were included in the search spaces and the corresponding resonances are summarized\nin Appendix~\\ref{sec:appendix_laserfreqs}.\n\\begin{figure}[htb!]\n  \\begin{center}\n      \\includegraphics[width=\\columnwidth]{CH4_2plus-crop}\n  \\end{center}\n    \\caption{\n    Ground state (black line) and excited state (shaded) spectra of \n    doubly-ionized Methane (CH$_4^{2+}$) \n    for two different pump pulses $\\mathscr{E}^I$ (red) and $\\mathscr{E}^{II}$ (blue). \n    The grey shaded box marks the optimization area, the blue shaded area the visible region of the\n    spectrum.\n    }\n  \\label{fig:ch4_2plus}\n\\end{figure}\n\nThe optimized spectra are shown in Figure~\\ref{fig:ch4_2plus}.\nIt can be seen that both search spaces include optimal lasers that cause the molecule to loose its transparency and \nabsorb in the visible. The achieved opacity can be quantified in terms of the control function $G^A$ \\eqref{eq:epsilon_a} \nbeing the integral over the absorption spectrum in the visible range of the spectrum. Comparing the opacity achieved \nin search space I ($G^A_I=0.017$) with the one achieved in search space II ($G^A_{II}=0.020$), we conclude that \nsearch space II is better suited for the pursued optimization. Thus, including energy levels at the ionization\nthreshold in the search space might be a useful strategy in further optimizations. \n\n\\section{Conclusions} \n\\label{sec:conclusions}\n\nIn this work, we assessed the possibility of using tailored pumps in order to\nenhance some given features of the probe absorption -- for example, the\nabsorption in the visible range of otherwise transparent samples. \nWe first detailed a theoretical analysis of the\nnon-equilibrium response function in this context, aided by one simple\nnumerical model of the Hydrogen atom. Then, we investigated the\nfeasibility of using TDDFT theory as a means to\nimplement, theoretically, this absorption-optimization idea, for more complex\natoms or molecules.\n\nThe theoretical analysis of the response function can be done by writing it in\na generalized form of the Lehmann representation, valid for systems that have\nbeen pumped out of equilibrium by a first pulse, and whose response to a probe\npulse (in our case, assumed non-overlapping with the first one) needs to be\nstudied and manipulated. The peaks of this response functions are always fixed\nto the differences in the system energies, but their strength and shape varies\ndepending on the pump shape, and on the pump-probe delay. Furthermore, the\nresponse function is a sum of a stationary part (the only one present if the\npumped state is itself a stationary state), and a time-dependent,\noscillatory term, caused by interferences between the populated eigenstates.\n\nWe then used this dependence of the non-equilibrium response with respect to the pump pulse\nshape to manipulate it by means of QOCT. We demonstrated the idea first with a\nsmall model, that could be treated analytically. This could be a viable\nalternative for larger systems, if they can be reduced to few-level\nmodels. However, for full generality we also showed how QOCT can be combined\nwith TDDFT. We showed how this avenue is tractable, but we also highlighted\nthe key numerical difficulties and theoretical challenges. For this purpose,\nwe performed first calculations on a model for the Helium atom that could be\nsolved both exactly with the TDSE equation, and with TDDFT within the\nadiabatic EXX approximation. Then we concluded with simulations of the\nmethane dication.\n\nFrom our results we conclude that the proposed idea could be brought to the\nlaboratory: tailored pump pulses can excite systems into light-absorbing states.\nTheoretically, the scalability of TDDFT could in principle permit studying\nthese processes for larger systems. However, our results have also highlighted\nthe severe numerical and theoretical difficulties posed by the problem: large-scale\nnon-equilibrium quantum dynamics are cumbersome, even with TDDFT, and moreover\nthe shortcomings of state-of-the-art TDDFT functionals may still be\nserious for these out-of-equilibrium situations. \nOur findings confirm recent investigations about the consequences of these shortcomings \nfor the use of coherent control schemes~\\cite{raghunathan-2011, raghunathan-2012}.\n\n\n\\section*{Acknowledgements} \n\nWe acknowledge financial support from the European Research Council (ERC-2010-AdG-267374), Spanish grant\n(FIS2013-46159-C3-1-P), Grupos Consolidados (IT578-13), and AFOSR Grant No. FA2386-15-1-0006 AOARD 144088,\nH2020-NMP-2014 project MOSTOPHOS, GA no. SEP-210187476 and COST Action MP1306 (EUSpec).\nComputational time was granted by BSC Red Espanola de Supercomputacion.\n\n\n\\appendix\n\n\\section{Quantum Optimal Control Equations}\\label{sec:qoct_gradientbased}\n\nFor completeness, we derive here the equations for\nthe computation of the gradient of a target functional designed to optimize\nthe response of a system.\nIn general, the equation for the gradient provided by QOCT is given by:\n\\begin{subequations}\n\\label{eq:equations_of_control}\n\n", "index": 49, "text": "\\begin{align} \n\\nonumber\n\\nabla_\\mathbf{c}& G[\\mathbf{c}] = \\left.\\nabla_\\mathbf{c}\n  F[\\Psi,\\mathscr{E}_\\mathbf{c}]\\right|_{\\Psi = \\Psi[\\mathscr{E}_\\mathbf{c}]}  +\n\\\\ \n&  2 \\Im \\int_0^T\\!\\!\\!{\\rm d}t\\; \\langle \\chi[\\mathscr{E}_\\mathbf{c}](t)\n \\vert \\nabla_{\\mathbf{c}}\n\\hat{H}[\\mathscr{E}_\\mathbf{c},t] \\vert \\Psi[\\mathscr{E}_\\mathbf{c}](t)\\rangle\\,\n\\label{eq:qoct-gradient}\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex10.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle\\nabla_{\\mathbf{c}}\" display=\"inline\"><msub><mo>\u2207</mo><mi>\ud835\udc1c</mi></msub></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex10.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle G[\\mathbf{c}]=\\left.\\nabla_{\\mathbf{c}}F[\\Psi,\\mathscr{E}_{%&#10;\\mathbf{c}}]\\right|_{\\Psi=\\Psi[\\mathscr{E}_{\\mathbf{c}}]}+\" display=\"inline\"><mrow><mrow><mi>G</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>\ud835\udc1c</mi><mo stretchy=\"false\">]</mo></mrow></mrow><mo>=</mo><mrow><msub><mrow><mrow><mrow><msub><mo>\u2207</mo><mi>\ud835\udc1c</mi></msub><mo>\u2061</mo><mi>F</mi></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi mathvariant=\"normal\">\u03a8</mi><mo>,</mo><msub><mi class=\"ltx_font_mathscript\">\u2130</mi><mi>\ud835\udc1c</mi></msub><mo stretchy=\"false\">]</mo></mrow></mrow><mo fence=\"true\">|</mo></mrow><mrow><mi mathvariant=\"normal\">\u03a8</mi><mo>=</mo><mrow><mi mathvariant=\"normal\">\u03a8</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><msub><mi class=\"ltx_font_mathscript\">\u2130</mi><mi>\ud835\udc1c</mi></msub><mo stretchy=\"false\">]</mo></mrow></mrow></mrow></msub><mo>+</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E25.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle 2\\Im\\int_{0}^{T}\\!\\!\\!{\\rm d}t\\;\\langle\\chi[\\mathscr{E}_{\\mathbf%&#10;{c}}](t)|\\nabla_{\\mathbf{c}}\\hat{H}[\\mathscr{E}_{\\mathbf{c}},t]|\\Psi[\\mathscr{%&#10;E}_{\\mathbf{c}}](t)\\rangle\" display=\"inline\"><mrow><mn>2</mn><mo>\u2062</mo><mi mathvariant=\"normal\">\u2111</mi><mo>\u2062</mo><mrow><mpadded width=\"-5.1pt\"><mstyle displaystyle=\"true\"><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mi>T</mi></msubsup></mstyle></mpadded><mrow><mrow><mo>d</mo><mpadded width=\"+2.8pt\"><mi>t</mi></mpadded></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">\u27e8</mo><mrow><mi>\u03c7</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><msub><mi class=\"ltx_font_mathscript\">\u2130</mi><mi>\ud835\udc1c</mi></msub><mo stretchy=\"false\">]</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo fence=\"true\" stretchy=\"false\">|</mo><mrow><mrow><msub><mo>\u2207</mo><mi>\ud835\udc1c</mi></msub><mo>\u2061</mo><mover accent=\"true\"><mi>H</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><msub><mi class=\"ltx_font_mathscript\">\u2130</mi><mi>\ud835\udc1c</mi></msub><mo>,</mo><mi>t</mi><mo stretchy=\"false\">]</mo></mrow></mrow><mo fence=\"true\" stretchy=\"false\">|</mo><mrow><mi mathvariant=\"normal\">\u03a8</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><msub><mi class=\"ltx_font_mathscript\">\u2130</mi><mi>\ud835\udc1c</mi></msub><mo stretchy=\"false\">]</mo></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">\u27e9</mo></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\nThe equation for the gradient is therefore Eq.~\\eqref{eq:qoct-gradient}; \nwhich must be completed with the equation of motion for the\nco-state, Eq.~\\eqref{eq:lambda-1}, and, in particular, with its boundary\ncondition~\\eqref{eq:lambda-2} at time $t=T$: this is the only one that in fact depends on the\ndefinition of the target operator:\n\n", "itemtype": "equation", "pos": 66647, "prevtext": "\n\nNote that a new ``wave function'', $\\chi[\\mathscr{E}]$, has been introduced;\nit is given by the solution of:\n\\begin{eqnarray}\n\\label{eq:lambda-1}\ni\\frac{\\partial \\chi[\\mathscr{E}]}{\\partial t} (x,t)  & = & \\hat{H}^{\\dagger}[\\mathscr{E},t]\n\\chi[\\mathscr{E}](x,t) \n\n\\\\\n\\label{eq:lambda-2}\n\\chi[\\mathscr{E}](x,T) & = & \\frac{\\delta J_1^T}{\\delta \\Psi^*[\\mathscr{E}](x,T)} \\,.\n\\end{eqnarray}\n\\end{subequations}\nThis is similar to the original Schr{\\\"{o}}dinger equation~\\eqref{eq:schroedinger_control}, although\nthe initial condition is\ngiven at the final time $t=T$, which implies it must be propagated\n\\emph{backwards}.\nFor a detailed derivation of\nEqs.~\\eqref{eq:equations_of_control} we\nrefer the reader to Refs.~\\cite{peirce-1988, kosloff-1989, ohtsuki-2004, serban-2005}. \n\nThe computation of the gradient or functional derivative of $G$,\ntherefore, requires $\\Psi[\\mathscr{E}]$ and $\\chi[\\mathscr{E}]$, which are obtained by\nfirst propagating Eq.~\\eqref{eq:schroedinger-1} forwards, and then\nEq.~\\eqref{eq:lambda-1} backwards. The maxima of $G$ are found at the\ncritical points $\\nabla_\\mathbf{c} G[\\mathscr{E}_\\mathbf{c}] = 0$.\n\nWe may now apply these general equations for\na target functional designed to optimize\nthe response of a system after the excitation by a pump pulse. \nThis setup is consistent with the non-overlapping regime described\nin Section~\\ref{sec:spec_ex}, where the Hamiltonian that governs the system, once that the pump has passed\n($t \\ge T$) has the form \\eqref{eq:hamiltonian_nonoverlapping}.\nIf, at time $t=T$, the system has been driven to the state\n$\\vert\\Psi(T)\\rangle$, the response function for the perturbation at\nlater times is given by \\eqref{eq:retarded_response_function_recast}\nand the first-order response of the system is given by \\eqref{eq:dipole_response}.\n\nThe key point is the definition of a target: for example, let us assume, that we\nwish to enhance the\nreaction of the system at a given frequency to a sudden perturbation at \nthe end of the pump $F(t') = \\delta(t-T)$. \nAs seen in \\eqref{eq:first_order_response_deltafunction}, the time-dependent dipole-dipole \nresponse is then directly given by the response function\n$\\chi_{\\hat{D},\\hat{D}}\\left[\\mathscr{E}\\right](t,T) = D^{(1)}\\left[\\mathscr{E}, \\delta_{T}\\right](t) $\nand its Fourier transform by\n\\begin{eqnarray}\\nonumber\n\\chi_{\\hat{D},\\hat{D}}\\left[\\mathscr{E}\\right](\\omega,T) \n    &=& D^{(1)}\\left[\\mathscr{E}, \\delta_{T}\\right](\\omega) \\\\\n    &=& \\int_{T}^{\\infty}\\!\\!{\\rm d t'}\\;e^{-i\\omega t'}D^{(1)}\\left[\\mathscr{E}, \\delta_{T}\\right](t') \\, . \n    \\label{eq:response_ft}\n\\end{eqnarray}\nIt can be easily seen that the problem fits into\nthe framework discussed above, i.e.\\ the target functional is\ngiven by the expectation value of some operator:\n\n", "index": 51, "text": "\\begin{align}\n\\nonumber\n&J_1^T[\\Psi(T)] = -i\n\\\\\n&\\langle \\Psi(T)\\vert\n\\int_{T}^{\\infty}\\!\\!{\\rm d t'}\\;e^{-i\\omega\n  t' }\\left[e^{i( t'-T)\\mathscr{H}}\\hat{D}\ne^{-i(t'-T)\\mathscr{H}},\\hat{D}\\right]\n\\vert\\Psi(T)\\rangle\\, .\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex11.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle J_{1}^{T}[\\Psi(T)]=-i\" display=\"inline\"><mrow><mrow><msubsup><mi>J</mi><mn>1</mn><mi>T</mi></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mrow><mi mathvariant=\"normal\">\u03a8</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>T</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">]</mo></mrow></mrow><mo>=</mo><mrow><mo>-</mo><mi>i</mi></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E26.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\langle\\Psi(T)|\\int_{T}^{\\infty}\\!\\!{\\rm dt^{\\prime}}\\;e^{-i%&#10;\\omega t^{\\prime}}\\left[e^{i(t^{\\prime}-T)\\mathscr{H}}\\hat{D}e^{-i(t^{\\prime}-%&#10;T)\\mathscr{H}},\\hat{D}\\right]|\\Psi(T)\\rangle\\,.\" display=\"inline\"><mrow><mrow><mo stretchy=\"false\">\u27e8</mo><mrow><mi mathvariant=\"normal\">\u03a8</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>T</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo fence=\"true\" stretchy=\"false\">|</mo><mrow><mpadded width=\"-3.4pt\"><mstyle displaystyle=\"true\"><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mi>T</mi><mi mathvariant=\"normal\">\u221e</mi></msubsup></mstyle></mpadded><mrow><mpadded width=\"+2.8pt\"><msup><mi>dt</mi><mo>\u2032</mo></msup></mpadded><mo>\u2062</mo><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi>i</mi><mo>\u2062</mo><mi>\u03c9</mi><mo>\u2062</mo><msup><mi>t</mi><mo>\u2032</mo></msup></mrow></mrow></msup><mo>\u2062</mo><mrow><mo>[</mo><mrow><msup><mi>e</mi><mrow><mi>i</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mi>t</mi><mo>\u2032</mo></msup><mo>-</mo><mi>T</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi class=\"ltx_font_mathscript\">\u210b</mi></mrow></msup><mo>\u2062</mo><mover accent=\"true\"><mi>D</mi><mo stretchy=\"false\">^</mo></mover><mo>\u2062</mo><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi>i</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mi>t</mi><mo>\u2032</mo></msup><mo>-</mo><mi>T</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi class=\"ltx_font_mathscript\">\u210b</mi></mrow></mrow></msup></mrow><mo>,</mo><mover accent=\"true\"><mi>D</mi><mo stretchy=\"false\">^</mo></mover><mo>]</mo></mrow></mrow></mrow><mo fence=\"true\" stretchy=\"false\">|</mo><mrow><mi mathvariant=\"normal\">\u03a8</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>T</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">\u27e9</mo></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\nSimilar formulas can be obtained for more general definitions of the target\nfunctional in terms of the response $D^{(1)}(\\omega)$, and for more general probe\nfunctions. In all cases the computational difficulties associated to the\ncomputation of this boundary condition are similar, and are\nconsiderable. By inspecting the previous formula, it can be learnt that\nvarious time-propagations of the wave functions, forwards and backwards, are\nrequired.  These difficulties are even larger if the scheme is formulated\nwithin TDDFT -- in the previous derivation we have used the exact\nmany-electron wave functions. In consequence, we decided to employ, for this\ntype of optimizations, gradient-free algorithms, such as the Simplex-Downhill algorithm \nthat we describe in next section.\n\n\n\n\\section{Derivation of the Control Equations for Three Level\n  Systems}\\label{sec:analyticalcontrol}\n\n\nFor the three-levels model described at the end of Section~\\ref{sec:qoct},\nwe will start by considering a simpler situation in which the field envelopes\nare constant, i.e.:\n\n\n", "itemtype": "equation", "pos": 67216, "prevtext": "\nThe equation for the gradient is therefore Eq.~\\eqref{eq:qoct-gradient}; \nwhich must be completed with the equation of motion for the\nco-state, Eq.~\\eqref{eq:lambda-1}, and, in particular, with its boundary\ncondition~\\eqref{eq:lambda-2} at time $t=T$: this is the only one that in fact depends on the\ndefinition of the target operator:\n\n", "index": 53, "text": "\\begin{align}\n\\nonumber\n&\\vert\\chi(T)\\rangle = -i\n\\\\\n&\\int_{T}^{\\infty}\\!\\!{\\rm dt'}\\;e^{-i\\omega\n  t'}\\left[e^{i(t'-T)\\mathscr{H}}\\hat{D} e^{-i(t'-T)\\mathscr{H}},\\hat{D}\\right]\n\\vert\\Psi(T)\\rangle\\,.\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex12.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle|\\chi(T)\\rangle=-i\" display=\"inline\"><mrow><mrow><mo fence=\"true\" stretchy=\"false\">|</mo><mrow><mi>\u03c7</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>T</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">\u27e9</mo></mrow><mo>=</mo><mrow><mo>-</mo><mi>i</mi></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E27.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\int_{T}^{\\infty}\\!\\!{\\rm dt^{\\prime}}\\;e^{-i\\omega t^{\\prime}}%&#10;\\left[e^{i(t^{\\prime}-T)\\mathscr{H}}\\hat{D}e^{-i(t^{\\prime}-T)\\mathscr{H}},%&#10;\\hat{D}\\right]|\\Psi(T)\\rangle\\,.\" display=\"inline\"><mrow><mrow><mpadded width=\"-3.4pt\"><mstyle displaystyle=\"true\"><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mi>T</mi><mi mathvariant=\"normal\">\u221e</mi></msubsup></mstyle></mpadded><mrow><mpadded width=\"+2.8pt\"><msup><mi>dt</mi><mo>\u2032</mo></msup></mpadded><mo>\u2062</mo><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi>i</mi><mo>\u2062</mo><mi>\u03c9</mi><mo>\u2062</mo><msup><mi>t</mi><mo>\u2032</mo></msup></mrow></mrow></msup><mo>\u2062</mo><mrow><mo>[</mo><mrow><msup><mi>e</mi><mrow><mi>i</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mi>t</mi><mo>\u2032</mo></msup><mo>-</mo><mi>T</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi class=\"ltx_font_mathscript\">\u210b</mi></mrow></msup><mo>\u2062</mo><mover accent=\"true\"><mi>D</mi><mo stretchy=\"false\">^</mo></mover><mo>\u2062</mo><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi>i</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msup><mi>t</mi><mo>\u2032</mo></msup><mo>-</mo><mi>T</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi class=\"ltx_font_mathscript\">\u210b</mi></mrow></mrow></msup></mrow><mo>,</mo><mover accent=\"true\"><mi>D</mi><mo stretchy=\"false\">^</mo></mover><mo>]</mo></mrow><mo>\u2062</mo><mrow><mo fence=\"true\" stretchy=\"false\">|</mo><mrow><mi mathvariant=\"normal\">\u03a8</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>T</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">\u27e9</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\n\nIf the two carrier frequencies are sufficiently close to the transition\nfrequencies $\\omega_{ab}$ and $\\omega_{bc}$, one can apply the rotating wave\napproximation (RWA), as it is done in the theory of \nRabi oscillations. In fact, we choose the carrier frequencies to be equal to the transition energies. \nIn addition, we also assume, that the laser frequencies are sufficiently well separated in energy to apply the RWA a second time:\n\n\\begin{subequations}\n\\begin{eqnarray}\n    |\\omega_1+\\omega_2| &\\gg& 0 \\, ,  \\\\\n    |\\omega_1-\\omega_2| &\\gg& 0 \\, .\n\\end{eqnarray}\n\\end{subequations}\n\nAssuming the validity of the RWA mentioned in Section~\\ref{sec:qoct}, the \nsolution of the resulting differential equations with the initial conditions $a(0)=1$, $b(0)=c(0)=0$, \nleads to the following time-evolution of the coefficients:\n\\begin{subequations}\n    \\label{eq:rabi_solutions}\n\\begin{eqnarray}\n   a(t) &=& \\cos(\\bar\\Omega/2 t) \\, , \\\\\n   b(t) &=& \\frac{d_{ab}\\varepsilon_1e^{-i(\\varphi_1-\\pi)}}{\\sqrt{\n   (d_{ab}\\varepsilon_1)^2+(d_{ac}\\varepsilon_2)^2}}\\sin\\left(\\bar\\Omega/2 t\\right) \\, , \\\\\n   c(t) &=& \\frac{d_{ac}\\varepsilon_2e^{-i(\\varphi_2-\\pi)}}{\\sqrt{\n   (d_{ab}\\varepsilon_1)^2+(d_{ac}\\varepsilon_2)^2}}\\sin\\left(\\bar\\Omega/2 t\\right) \\, ,\n\\end{eqnarray}\n\\end{subequations}\n\nwith the Rabi-frequency\n\\begin{eqnarray}\n    \\bar\\Omega = \\sqrt{(d_{ab}\\varepsilon_1)^2+(d_{ac}\\varepsilon_2)^2} \\, .\n    \\label{eq:rabi_frequency_3level}\n\\end{eqnarray}\nNote that:\n\\begin{enumerate}\n    \\item The Rabi-frequency is the Pythagorean mean \n            of the Rabi-frequencies of the single transitions:\n            $\\bar \\Omega = \\sqrt{\\bar\\Omega_{ab}^2+\\bar\\Omega_{ac}^2}$. Consequently, it is larger \n            than each of those single frequencies.\n    \\item The maximum populations of the excited states depend only on the ratio of the Rabi-frequencies belonging to\n        the respective transitions $\\frac{|b(t)|^2}{|c(t)|^2}=\\frac{\\bar\\Omega_{ab}^2}{\\bar\\Omega_{ac}^2}$.\n    \\item The relative phases of the expansion coefficients depend on the phases of the applied lasers.\n\\end{enumerate}\n\n\nThe target state is defined in Eq.~\\eqref{eq:hcontrol_target}: the goal is to\nfind a laser pulse that drives the system from the state $|\\Psi(t=0)\\rangle=|\\Phi_a\\rangle$ into this target state\nwithin the time $T$. The evolution of the time-dependent wave function is\ngiven by:\n\n", "itemtype": "equation", "pos": 68489, "prevtext": "\nSimilar formulas can be obtained for more general definitions of the target\nfunctional in terms of the response $D^{(1)}(\\omega)$, and for more general probe\nfunctions. In all cases the computational difficulties associated to the\ncomputation of this boundary condition are similar, and are\nconsiderable. By inspecting the previous formula, it can be learnt that\nvarious time-propagations of the wave functions, forwards and backwards, are\nrequired.  These difficulties are even larger if the scheme is formulated\nwithin TDDFT -- in the previous derivation we have used the exact\nmany-electron wave functions. In consequence, we decided to employ, for this\ntype of optimizations, gradient-free algorithms, such as the Simplex-Downhill algorithm \nthat we describe in next section.\n\n\n\n\\section{Derivation of the Control Equations for Three Level\n  Systems}\\label{sec:analyticalcontrol}\n\n\nFor the three-levels model described at the end of Section~\\ref{sec:qoct},\nwe will start by considering a simpler situation in which the field envelopes\nare constant, i.e.:\n\n\n", "index": 55, "text": "\\begin{equation}\n    \\mathscr{E}(t)=\\varepsilon_1\\cos(\\omega_1 t+\\varphi_1) + \\varepsilon_2\\cos(\\omega_2 t + \\varphi_2) \\, .\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E28.m1\" class=\"ltx_Math\" alttext=\"\\mathscr{E}(t)=\\varepsilon_{1}\\cos(\\omega_{1}t+\\varphi_{1})+\\varepsilon_{2}%&#10;\\cos(\\omega_{2}t+\\varphi_{2})\\,.\" display=\"block\"><mrow><mrow><mrow><mi class=\"ltx_font_mathscript\">\u2130</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msub><mi>\u03b5</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mi>cos</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><msub><mi>\u03c9</mi><mn>1</mn></msub><mo>\u2062</mo><mi>t</mi></mrow><mo>+</mo><msub><mi>\u03c6</mi><mn>1</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>+</mo><mrow><msub><mi>\u03b5</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mi>cos</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><msub><mi>\u03c9</mi><mn>2</mn></msub><mo>\u2062</mo><mi>t</mi></mrow><mo>+</mo><msub><mi>\u03c6</mi><mn>2</mn></msub></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\n\nThe condition $\\vert\\langle\\Phi_a\\vert\\bar{\\Psi}\\rangle\\vert^2 = 1$\nleads to two sets of equations: one connecting the laser amplitudes $\\varepsilon_1$ and\n$\\varepsilon_2$ to the populations $|\\alpha|^2$, $|\\beta|^2$ and $|\\gamma|^2$\n\\begin{subequations}\n    \\label{eq:hcontrol_populations}\n\\begin{eqnarray}\n   |\\alpha| &=& \\cos(\\bar\\Omega/2 T) \\, , \\\\\n   |\\beta|  &=& \\frac{d_{ab}\\varepsilon_1}{\\sqrt{ (d_{ab}\\varepsilon_1)^2+(d_{ac}\\varepsilon_2)^2}}\\sin\\left(\\bar\\Omega/2 T\\right) \\, , \\\\\n   |\\gamma| &=& \\frac{d_{ac}\\varepsilon_2}{\\sqrt{ (d_{ab}\\varepsilon_1)^2+(d_{ac}\\varepsilon_2)^2}}\\sin\\left(\\bar\\Omega/2 T\\right) \\, , \n\\end{eqnarray}\n\\end{subequations}\nand the other one connecting the laser phases to the relative phases $\\varphi_{\\beta}$ and\n$\\varphi_{\\gamma}$ of the wave function\n\\begin{subequations}\n\\begin{eqnarray}\n    \\varphi_{\\beta} &=&  \\varphi_1-\\pi+\\omega_{ba}T \\, , \\\\\n    \\varphi_{\\gamma} &=& \\varphi_2-\\pi+\\omega_{ca}T \\, .\n\\end{eqnarray}\n\\end{subequations}\n\nSolving these sets of equations, we find the following amplitudes as one example of a control laser\n\\begin{eqnarray}\n\\varepsilon_1 & = &\n\\frac{2}{T}\\frac{\\arccos(|\\alpha|)}{\\sin(\\arccos(|\\alpha|)} \n\\frac{|\\beta|}{d_{ab}}\\, ,\n\\\\\n\\varepsilon_2 & = &\n\\frac{2}{T}\\frac{\\arccos(|\\alpha|)}{\\sin(\\arccos(|\\alpha|)} \n\\frac{|\\gamma|}{d_{ac}}\\,.\n\\end{eqnarray}\n\n\nNote, however, that the solutions are not unique: other sets\n$\\{(2n+1)\\varepsilon_1, (2n+1)\\varepsilon_2\\}$ fulfill the equations above. \nThese solutions represent lasers that lead to an\nevolution of the coefficients that covers $(n+1)$ complete Rabi cycles within\nthe time $T$.\n\nIn practice one is often interested in pulses with time-dependent envelope\nfunctions, such as the ones discussed in Section~\\ref{sec:qoct}, in which\nthe pulses have a $\\sin^2$ envelope with a period of $2T$. The problem can be\nsolved in an analogue manner; the solutions for\nthe amplitudes were already given in Section~\\ref{sec:qoct}. In this case, the\nevolution of the coefficients is given by:\n \\begin{subequations}\n     \\label{eq:hcontrol_populations_td}\n\\begin{eqnarray}\n    a(t) &=& \\cos\\left(\\frac{\\int_0^t\\tilde\\Omega(t')dt'}{2}\\right)\\, , \\\\\n    b(t) &=& \\frac{d_{ab}\\varepsilon_1e^{-i(\\varphi_1-\\pi)}}{\\sqrt{\n    (d_{ab}\\varepsilon_1)^2+(d_{ac}\\varepsilon_2)^2}}\\sin\\int_0^t\\frac{\\tilde\\Omega(t')dt'}{2}\\, ,\\\\\n    c(t) &=& \\frac{d_{ac}\\varepsilon_2e^{-i(\\varphi_2-\\pi)}}{\\sqrt{\n    (d_{ab}\\varepsilon_1)^2+(d_{ac}\\varepsilon_2)^2}}\\sin\\int_0^t\\frac{\\tilde\\Omega(t')dt'}{2}\\,,\n\\end{eqnarray}\n\\end{subequations}\nwhere the ``time-dependent Rabi-frequency'' $\\tilde\\Omega(t)$ is given by:\n \n", "itemtype": "equation", "pos": 71005, "prevtext": "\n\nIf the two carrier frequencies are sufficiently close to the transition\nfrequencies $\\omega_{ab}$ and $\\omega_{bc}$, one can apply the rotating wave\napproximation (RWA), as it is done in the theory of \nRabi oscillations. In fact, we choose the carrier frequencies to be equal to the transition energies. \nIn addition, we also assume, that the laser frequencies are sufficiently well separated in energy to apply the RWA a second time:\n\n\\begin{subequations}\n\\begin{eqnarray}\n    |\\omega_1+\\omega_2| &\\gg& 0 \\, ,  \\\\\n    |\\omega_1-\\omega_2| &\\gg& 0 \\, .\n\\end{eqnarray}\n\\end{subequations}\n\nAssuming the validity of the RWA mentioned in Section~\\ref{sec:qoct}, the \nsolution of the resulting differential equations with the initial conditions $a(0)=1$, $b(0)=c(0)=0$, \nleads to the following time-evolution of the coefficients:\n\\begin{subequations}\n    \\label{eq:rabi_solutions}\n\\begin{eqnarray}\n   a(t) &=& \\cos(\\bar\\Omega/2 t) \\, , \\\\\n   b(t) &=& \\frac{d_{ab}\\varepsilon_1e^{-i(\\varphi_1-\\pi)}}{\\sqrt{\n   (d_{ab}\\varepsilon_1)^2+(d_{ac}\\varepsilon_2)^2}}\\sin\\left(\\bar\\Omega/2 t\\right) \\, , \\\\\n   c(t) &=& \\frac{d_{ac}\\varepsilon_2e^{-i(\\varphi_2-\\pi)}}{\\sqrt{\n   (d_{ab}\\varepsilon_1)^2+(d_{ac}\\varepsilon_2)^2}}\\sin\\left(\\bar\\Omega/2 t\\right) \\, ,\n\\end{eqnarray}\n\\end{subequations}\n\nwith the Rabi-frequency\n\\begin{eqnarray}\n    \\bar\\Omega = \\sqrt{(d_{ab}\\varepsilon_1)^2+(d_{ac}\\varepsilon_2)^2} \\, .\n    \\label{eq:rabi_frequency_3level}\n\\end{eqnarray}\nNote that:\n\\begin{enumerate}\n    \\item The Rabi-frequency is the Pythagorean mean \n            of the Rabi-frequencies of the single transitions:\n            $\\bar \\Omega = \\sqrt{\\bar\\Omega_{ab}^2+\\bar\\Omega_{ac}^2}$. Consequently, it is larger \n            than each of those single frequencies.\n    \\item The maximum populations of the excited states depend only on the ratio of the Rabi-frequencies belonging to\n        the respective transitions $\\frac{|b(t)|^2}{|c(t)|^2}=\\frac{\\bar\\Omega_{ab}^2}{\\bar\\Omega_{ac}^2}$.\n    \\item The relative phases of the expansion coefficients depend on the phases of the applied lasers.\n\\end{enumerate}\n\n\nThe target state is defined in Eq.~\\eqref{eq:hcontrol_target}: the goal is to\nfind a laser pulse that drives the system from the state $|\\Psi(t=0)\\rangle=|\\Phi_a\\rangle$ into this target state\nwithin the time $T$. The evolution of the time-dependent wave function is\ngiven by:\n\n", "index": 57, "text": "\\begin{align}\\nonumber\n   |\\Psi(t)\\rangle &= \\cos(\\bar\\Omega/2 t) |\\Phi_a\\rangle \\\\\\nonumber\n   & + \\frac{d_{ab}\\varepsilon_1\\sin\\left(\\bar\\Omega/2 t\\right)}{\\sqrt{ (d_{ab}\\varepsilon_1)^2+(d_{ac}\\varepsilon_2)^2}}\n        e^{-i(\\varphi_1-\\pi+\\omega_{ba}t)}|\\Phi_b\\rangle \\\\\n   & + \\frac{d_{ac}\\varepsilon_2\\sin\\left(\\bar\\Omega/2 t\\right)}{\\sqrt{ (d_{ab}\\varepsilon_1)^2+(d_{ac}\\varepsilon_2)^2}}\n        e^{-i(\\varphi_2-\\pi+\\omega_{ca}t)}|\\Phi_c\\rangle \\, .\n\\end{align}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex13.m1\" class=\"ltx_Math\" alttext=\"\\displaystyle|\\Psi(t)\\rangle\" display=\"inline\"><mrow><mo fence=\"true\" stretchy=\"false\">|</mo><mrow><mi mathvariant=\"normal\">\u03a8</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">\u27e9</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex13.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\cos(\\bar{\\Omega}/2t)|\\Phi_{a}\\rangle\" display=\"inline\"><mrow><mi/><mo>=</mo><mrow><mrow><mi>cos</mi><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a9</mi><mo stretchy=\"false\">\u00af</mo></mover><mo>/</mo><mn>2</mn></mrow><mo>\u2062</mo><mi>t</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2062</mo><mrow><mo fence=\"true\" stretchy=\"false\">|</mo><msub><mi mathvariant=\"normal\">\u03a6</mi><mi>a</mi></msub><mo stretchy=\"false\">\u27e9</mo></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex14.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle+\\frac{d_{ab}\\varepsilon_{1}\\sin\\left(\\bar{\\Omega}/2t\\right)}{%&#10;\\sqrt{(d_{ab}\\varepsilon_{1})^{2}+(d_{ac}\\varepsilon_{2})^{2}}}e^{-i(\\varphi_{%&#10;1}-\\pi+\\omega_{ba}t)}|\\Phi_{b}\\rangle\" display=\"inline\"><mrow><mo>+</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mrow><msub><mi>d</mi><mrow><mi>a</mi><mo>\u2062</mo><mi>b</mi></mrow></msub><mo>\u2062</mo><msub><mi>\u03b5</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mi>sin</mi><mo>\u2061</mo><mrow><mo>(</mo><mrow><mrow><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a9</mi><mo stretchy=\"false\">\u00af</mo></mover><mo>/</mo><mn>2</mn></mrow><mo>\u2062</mo><mi>t</mi></mrow><mo>)</mo></mrow></mrow></mrow><msqrt><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>d</mi><mrow><mi>a</mi><mo>\u2062</mo><mi>b</mi></mrow></msub><mo>\u2062</mo><msub><mi>\u03b5</mi><mn>1</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>d</mi><mrow><mi>a</mi><mo>\u2062</mo><mi>c</mi></mrow></msub><mo>\u2062</mo><msub><mi>\u03b5</mi><mn>2</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></mrow></msqrt></mfrac></mstyle><mo>\u2062</mo><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi>i</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><msub><mi>\u03c6</mi><mn>1</mn></msub><mo>-</mo><mi>\u03c0</mi></mrow><mo>+</mo><mrow><msub><mi>\u03c9</mi><mrow><mi>b</mi><mo>\u2062</mo><mi>a</mi></mrow></msub><mo>\u2062</mo><mi>t</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></msup><mo>\u2062</mo><mrow><mo fence=\"true\" stretchy=\"false\">|</mo><msub><mi mathvariant=\"normal\">\u03a6</mi><mi>b</mi></msub><mo stretchy=\"false\">\u27e9</mo></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E29.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle+\\frac{d_{ac}\\varepsilon_{2}\\sin\\left(\\bar{\\Omega}/2t\\right)}{%&#10;\\sqrt{(d_{ab}\\varepsilon_{1})^{2}+(d_{ac}\\varepsilon_{2})^{2}}}e^{-i(\\varphi_{%&#10;2}-\\pi+\\omega_{ca}t)}|\\Phi_{c}\\rangle\\,.\" display=\"inline\"><mrow><mrow><mo>+</mo><mrow><mstyle displaystyle=\"true\"><mfrac><mrow><msub><mi>d</mi><mrow><mi>a</mi><mo>\u2062</mo><mi>c</mi></mrow></msub><mo>\u2062</mo><msub><mi>\u03b5</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mi>sin</mi><mo>\u2061</mo><mrow><mo>(</mo><mrow><mrow><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a9</mi><mo stretchy=\"false\">\u00af</mo></mover><mo>/</mo><mn>2</mn></mrow><mo>\u2062</mo><mi>t</mi></mrow><mo>)</mo></mrow></mrow></mrow><msqrt><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>d</mi><mrow><mi>a</mi><mo>\u2062</mo><mi>b</mi></mrow></msub><mo>\u2062</mo><msub><mi>\u03b5</mi><mn>1</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>d</mi><mrow><mi>a</mi><mo>\u2062</mo><mi>c</mi></mrow></msub><mo>\u2062</mo><msub><mi>\u03b5</mi><mn>2</mn></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></mrow></msqrt></mfrac></mstyle><mo>\u2062</mo><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi>i</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><msub><mi>\u03c6</mi><mn>2</mn></msub><mo>-</mo><mi>\u03c0</mi></mrow><mo>+</mo><mrow><msub><mi>\u03c9</mi><mrow><mi>c</mi><mo>\u2062</mo><mi>a</mi></mrow></msub><mo>\u2062</mo><mi>t</mi></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></msup><mo>\u2062</mo><mrow><mo fence=\"true\" stretchy=\"false\">|</mo><msub><mi mathvariant=\"normal\">\u03a6</mi><mi>c</mi></msub><mo rspace=\"4.2pt\" stretchy=\"false\">\u27e9</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\nand integrates as:\n\n", "itemtype": "equation", "pos": 74090, "prevtext": "\n\nThe condition $\\vert\\langle\\Phi_a\\vert\\bar{\\Psi}\\rangle\\vert^2 = 1$\nleads to two sets of equations: one connecting the laser amplitudes $\\varepsilon_1$ and\n$\\varepsilon_2$ to the populations $|\\alpha|^2$, $|\\beta|^2$ and $|\\gamma|^2$\n\\begin{subequations}\n    \\label{eq:hcontrol_populations}\n\\begin{eqnarray}\n   |\\alpha| &=& \\cos(\\bar\\Omega/2 T) \\, , \\\\\n   |\\beta|  &=& \\frac{d_{ab}\\varepsilon_1}{\\sqrt{ (d_{ab}\\varepsilon_1)^2+(d_{ac}\\varepsilon_2)^2}}\\sin\\left(\\bar\\Omega/2 T\\right) \\, , \\\\\n   |\\gamma| &=& \\frac{d_{ac}\\varepsilon_2}{\\sqrt{ (d_{ab}\\varepsilon_1)^2+(d_{ac}\\varepsilon_2)^2}}\\sin\\left(\\bar\\Omega/2 T\\right) \\, , \n\\end{eqnarray}\n\\end{subequations}\nand the other one connecting the laser phases to the relative phases $\\varphi_{\\beta}$ and\n$\\varphi_{\\gamma}$ of the wave function\n\\begin{subequations}\n\\begin{eqnarray}\n    \\varphi_{\\beta} &=&  \\varphi_1-\\pi+\\omega_{ba}T \\, , \\\\\n    \\varphi_{\\gamma} &=& \\varphi_2-\\pi+\\omega_{ca}T \\, .\n\\end{eqnarray}\n\\end{subequations}\n\nSolving these sets of equations, we find the following amplitudes as one example of a control laser\n\\begin{eqnarray}\n\\varepsilon_1 & = &\n\\frac{2}{T}\\frac{\\arccos(|\\alpha|)}{\\sin(\\arccos(|\\alpha|)} \n\\frac{|\\beta|}{d_{ab}}\\, ,\n\\\\\n\\varepsilon_2 & = &\n\\frac{2}{T}\\frac{\\arccos(|\\alpha|)}{\\sin(\\arccos(|\\alpha|)} \n\\frac{|\\gamma|}{d_{ac}}\\,.\n\\end{eqnarray}\n\n\nNote, however, that the solutions are not unique: other sets\n$\\{(2n+1)\\varepsilon_1, (2n+1)\\varepsilon_2\\}$ fulfill the equations above. \nThese solutions represent lasers that lead to an\nevolution of the coefficients that covers $(n+1)$ complete Rabi cycles within\nthe time $T$.\n\nIn practice one is often interested in pulses with time-dependent envelope\nfunctions, such as the ones discussed in Section~\\ref{sec:qoct}, in which\nthe pulses have a $\\sin^2$ envelope with a period of $2T$. The problem can be\nsolved in an analogue manner; the solutions for\nthe amplitudes were already given in Section~\\ref{sec:qoct}. In this case, the\nevolution of the coefficients is given by:\n \\begin{subequations}\n     \\label{eq:hcontrol_populations_td}\n\\begin{eqnarray}\n    a(t) &=& \\cos\\left(\\frac{\\int_0^t\\tilde\\Omega(t')dt'}{2}\\right)\\, , \\\\\n    b(t) &=& \\frac{d_{ab}\\varepsilon_1e^{-i(\\varphi_1-\\pi)}}{\\sqrt{\n    (d_{ab}\\varepsilon_1)^2+(d_{ac}\\varepsilon_2)^2}}\\sin\\int_0^t\\frac{\\tilde\\Omega(t')dt'}{2}\\, ,\\\\\n    c(t) &=& \\frac{d_{ac}\\varepsilon_2e^{-i(\\varphi_2-\\pi)}}{\\sqrt{\n    (d_{ab}\\varepsilon_1)^2+(d_{ac}\\varepsilon_2)^2}}\\sin\\int_0^t\\frac{\\tilde\\Omega(t')dt'}{2}\\,,\n\\end{eqnarray}\n\\end{subequations}\nwhere the ``time-dependent Rabi-frequency'' $\\tilde\\Omega(t)$ is given by:\n \n", "index": 59, "text": "\\begin{equation}\n     \\tilde\\Omega(t)=\\sqrt{(d_{ab}\\tilde\\varepsilon_1(t))^2+(d_{ac}\\tilde\\varepsilon_2(t))^2} =\n     2\\bar\\Omega\\sin^2\\left(\\pi\\frac{t}{T}\\right) \\, .\n \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E30.m1\" class=\"ltx_Math\" alttext=\"\\tilde{\\Omega}(t)=\\sqrt{(d_{ab}\\tilde{\\varepsilon}_{1}(t))^{2}+(d_{ac}\\tilde{%&#10;\\varepsilon}_{2}(t))^{2}}=2\\bar{\\Omega}\\sin^{2}\\left(\\pi\\frac{t}{T}\\right)\\,.\" display=\"block\"><mrow><mrow><mrow><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a9</mi><mo stretchy=\"false\">~</mo></mover><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><msqrt><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>d</mi><mrow><mi>a</mi><mo>\u2062</mo><mi>b</mi></mrow></msub><mo>\u2062</mo><msub><mover accent=\"true\"><mi>\u03b5</mi><mo stretchy=\"false\">~</mo></mover><mn>1</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>d</mi><mrow><mi>a</mi><mo>\u2062</mo><mi>c</mi></mrow></msub><mo>\u2062</mo><msub><mover accent=\"true\"><mi>\u03b5</mi><mo stretchy=\"false\">~</mo></mover><mn>2</mn></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mn>2</mn></msup></mrow></msqrt><mo>=</mo><mrow><mn>2</mn><mo>\u2062</mo><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a9</mi><mo stretchy=\"false\">\u00af</mo></mover><mo>\u2062</mo><mrow><msup><mi>sin</mi><mn>2</mn></msup><mo>\u2061</mo><mrow><mo>(</mo><mrow><mi>\u03c0</mi><mo>\u2062</mo><mfrac><mi>t</mi><mi>T</mi></mfrac></mrow><mo rspace=\"4.2pt\">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04544.tex", "nexttext": "\n\n\n\n\\section{Laser Frequencies Used in the Optimization of\n  Methane}\\label{sec:appendix_laserfreqs}\n\nThe laser frequencies (in a.u.) and the corresponding resonances \nof the search spaces of the optimization of CH$_4^{2+}$. The nomenclature\nfollows the one in Fig.~\\ref{fig:ch4_2plus_gs}: $\\epsilon_H$ is minus the energy of the highest occupied KS state.\n$\\omega_3^I$ is the average of $\\epsilon_1=0.337$~a.u.\\ and $\\epsilon_3-\\epsilon_1=0.353$~a.u.. \nSince the frequencies are broadened by the finite pulse duration, \n$\\omega_3^I$ covers both resonances.\n\n    \\centering\n    \\begin{tabular}{c|c|c|c|c} \n        \\multicolumn{5}{c}{Search Space I}\\\\\\hline\\hline\n        \n        $\\omega_1^I$ & $\\omega_2^I$ &$\\omega_3^I$ &$\\omega_4^I$ &$\\omega_5^I$  \\\\\n        0.122       & 0.248     & 0.345             & 0.479 & 0.601 \\\\\n        $\\epsilon_4-\\epsilon_5$     & $\\epsilon_3-\\epsilon_5$   & $\\epsilon_1$\n        / $\\epsilon_1-\\epsilon_3$      & $\\epsilon_1-\\epsilon_4$   &\n        $\\epsilon_1-\\epsilon_5$ \\\\\n        \\hline\n        $\\omega_6^I$ &$\\omega_7^I$ & $\\omega_8^I$ &$\\omega_9^I$ &$\\omega_{10}^I$ \\\\\n        0.654 & 0.690 & 0.816 & 0.938 & 1.000\\\\\n        $\\epsilon_2$    & $\\epsilon_3$ & $\\epsilon_4$ & $\\epsilon_5$ &\n        $\\epsilon_7$  \\\\\\hline\n    \\end{tabular}\n    \\begin{tabular}{c|c|c|c|c|c|c}\n        \\multicolumn{7}{c}{}\\\\%\\hline\n        \\multicolumn{7}{c}{Search Space II}\\\\\\hline\\hline\n        $\\omega^{II}_1$ & $\\omega^{II}_2$ & $\\omega^{II}_3$ & $\\omega^{II}_4$ & $\\omega^{II}_5$ & $\\omega^{II}_6$ & $\\omega^{II}_7$ \\\\\n        0.311 & 0.364 & 0.386 & 0.426 & 0.548 & 0.674 & 1.364 \\\\\n        $\\epsilon_3 - I_P$ & $\\epsilon_4-I_P$ & $\\epsilon_5-I_P$ & $\\epsilon_6-I_P$ & $\\epsilon_7-I_P$ &\n        $\\epsilon_8- I_P$ & $I_P$ \n        \\\\\\hline\n    \\end{tabular}\n\n\\clearpage\n\\bibliography{walkenhorst}\n\n\n", "itemtype": "equation", "pos": 74293, "prevtext": "\nand integrates as:\n\n", "index": 61, "text": "\\begin{equation}\n    \\int_0^t \\frac{\\tilde\\Omega(t')dt'}{2} = \\left(\\frac{1}{2}t - \\frac{T}{4\\pi}\\sin\\left(2\\pi\\frac{t}{T}\\right)\\right)\\bar\\Omega\\, .\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E31.m1\" class=\"ltx_Math\" alttext=\"\\int_{0}^{t}\\frac{\\tilde{\\Omega}(t^{\\prime})dt^{\\prime}}{2}=\\left(\\frac{1}{2}t%&#10;-\\frac{T}{4\\pi}\\sin\\left(2\\pi\\frac{t}{T}\\right)\\right)\\bar{\\Omega}\\,.\" display=\"block\"><mrow><mrow><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mn>0</mn><mi>t</mi></msubsup><mfrac><mrow><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a9</mi><mo stretchy=\"false\">~</mo></mover><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msup><mi>t</mi><mo>\u2032</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mi>d</mi><mo>\u2062</mo><msup><mi>t</mi><mo>\u2032</mo></msup></mrow><mn>2</mn></mfrac></mrow><mo>=</mo><mrow><mrow><mo>(</mo><mrow><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>\u2062</mo><mi>t</mi></mrow><mo>-</mo><mrow><mfrac><mi>T</mi><mrow><mn>4</mn><mo>\u2062</mo><mi>\u03c0</mi></mrow></mfrac><mo>\u2062</mo><mrow><mi>sin</mi><mo>\u2061</mo><mrow><mo>(</mo><mrow><mn>2</mn><mo>\u2062</mo><mi>\u03c0</mi><mo>\u2062</mo><mfrac><mi>t</mi><mi>T</mi></mfrac></mrow><mo>)</mo></mrow></mrow></mrow></mrow><mo>)</mo></mrow><mo>\u2062</mo><mpadded width=\"+1.7pt\"><mover accent=\"true\"><mi mathvariant=\"normal\">\u03a9</mi><mo stretchy=\"false\">\u00af</mo></mover></mpadded></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}]