[{"file": "1601.05317.tex", "nexttext": " \n\nwhere $\\bar{P}[f,\\Psi_N]$ is the probability to start a reversed trajectory with the final qubit state ${\\mathinner{|{{f}}\\rangle}}$ and the final calorimeter state ${\\mathinner{|{{\\Psi_N}}\\rangle}}$ of the forward trajectory. The entropy production satisfies the fluctuation theorem (see Appendix A for details):\n\n\n", "itemtype": "equation", "pos": -1, "prevtext": "\n\n\n\n\\title{Quantum jump model for a  system with a finite-size environment}\n\n\n\\author{S. Suomela}\n\\affiliation{Department of Applied Physics and COMP Centre of Excellence,\nAalto University School of Science, P.O. Box 11100, 00076 Aalto, Finland}\n\n\\author{A. Kutvonen}\n\\affiliation{Department of Applied Physics and COMP Centre of Excellence,\nAalto University School of Science, P.O. Box 11100, 00076 Aalto, Finland}\n\n\\author{T. Ala-Nissila}\n\\affiliation{Department of Applied Physics and COMP Centre of Excellence,\nAalto University School of Science, P.O. Box 11100, 00076 Aalto, Finland}\n\\affiliation{Department of Physics, P.O. Box 1843, Brown University, Providence, Rhode Island 02912-1843, U.S.A.}\n\n\n\\begin{abstract}\nMeasuring the thermodynamic properties of open quantum systems poses a major challenge. A\ncalorimetric detection has been proposed as a feasible experimental scheme to measure work \nand fluctuation relations in open quantum systems. However, the detection requires a finite size for the environment, which influences the system dynamics. This process cannot be modeled with the standard stochastic approaches. We develop a quantum jump model suitable for systems coupled to a finite-size environment. With the method we study the common fluctuation relations and prove that they are satisfied.\n\n\\end{abstract}\n\n\\date{January 13, 2015}\n\n\n\n\\maketitle\n\n\\emph{Introduction.---}\nRapid progress in the fabrication and manipulation of micro and nanoscale objects \\cite{nakamura2010nonequilibrium,kung2012irreversibility,pekola2015towards,rossnagel2015single} has made it necessary to extend the concepts of thermodynamics to small systems which by definition are not in the thermodynamic limit. \n\nIn such systems the extensive thermodynamic quantities, such as entropy, \nheat and work, are not described by their average values\nalone but due to fluctuations they obey nontrivial probability distributions. Fortunately, it has been shown that in many cases the stochastic thermodynamic variables obey fluctuation relations  \\cite{spjetp45/125,prl78/2690,Seifert2005} which often appear in the form of relations between exponential averages of the extensive variables. \n\nWhile the two-measurement protocol of thermodynamic variables, especially work,  is now well studied in closed quantum systems, there have been conceptual problems in open quantum systems\n\\cite{pre73/046129, prl102/210401, PhysRevLett.107.140404,Crooks2007, jsp148/480, pre88/032146, rmp81/1665,rmp83/771, pre89/012127, pre89/032114, PhysRevE.90.022103, 1367-2630-16-11-115001, PhysRevE.89.052128, PhysRevB.90.075421, Jarzynski2015quantum,PhysRevLett.113.140601,an2014experimental,Deffner2015, PhysRevB.91.224303,1367-2630-17-7-075018,PhysRevE.85.031110, prl111/093602,NJP15/085028,PhysRevA.88.042111, PhysRevE.89.042122, suomela2014moments,s10955-014-0991-1,liu2015calculating,PhysRevE.91.062109,Suomela2015a,PhysRevE.92.032129}. To make connection to classical stochastic thermodynamics, the quantum jump (QJ) method \\cite{prl68/580, pra45/4879, pra46/4363, OSAQO, rmp70/101} has been recently used to study thermodynamics and fluctuation theorems in open quantum systems as it tries to mimic the trajectories realized in actual experiments \n\\cite{PhysRevE.85.031110,prl111/093602, NJP15/085028,PhysRevA.88.042111,PhysRevE.89.042122,suomela2014moments,Suomela2015a,liu2015calculating,s10955-014-0991-1,PhysRevE.91.062109,PhysRevE.92.032129}. The method unravels the master equation of the reduced density matrix as stochastic trajectories with environment induced jumps between the system states. \nThe concepts of stochastic thermodynamics can be developed by associating a jump with heat exchange. However, there are several approximations that limit the generality of the QJ method. In particular, it is only applicable assuming a memoryless or an infinitely large environment, i.e. an ideal heat bath whose state\ndoes not change during the drive.\n\nEven within the QJ framework the issue of actually measuring the energy change in a driven open quantum\nsystem is nontrivial. It has been proposed by J. P. Pekola et al. \\cite{Pekola2012} that this could be done by a so-called calorimetric measurement, where the immediate environment itself measures the energy change in the system. In Fig. 1, we show a schematic of such a setup in the case where there is a driven qubit coupled to a finite-size calorimeter and an ideal heat bath. The key point in the calorimetric measurement is that in order to observe the energy changes of the system, the calorimeter must be finite, i.e., in contrast to the ideal bath it has to change its state when absorbing energy from the system \\cite{Pekola2012, gasparinetti2015fast, Suomela2015b}.\n\n\n \\begin{figure}[t]\n    \\begin{center}\n    \\includegraphics[scale=.35]{Fig1.pdf}\n    \\end{center}\n    \\caption{A schematic of the calorimetric measurement in a driven open quantum system. Here, a qubit is coupled to the calorimeter that is described by finite number of harmonic oscillators with an energy gap equivalent to that of the qubit. The qubit and the calorimeter are initially thermalized with an ideal bath of inverse temperature $\\beta$. The qubit is driven by a classical source $\\lambda(t)$. }\n    \\label{fig:syst}\n\\end{figure}\n\nThe standard QJ approach is not applicable to analysis of the calorimetric measurement setup, since the calorimeter is not ideal bath. In this letter, we develop a modified QJ model suitable for systems weakly coupled to a finite-size environment, called calorimeter from here on. In the model, a jump in the system changes both the state of the system and the state of the calorimeter. Due to the influence of the system on the calorimeter's evolution, the system evolution is no longer Markovian as the previous history of the system affects its future evolution via the state of the calorimeter. With the new method, we show that the common fluctuation relations are satisfied\nfor the system-calorimeter composite. As a concrete example, we numerically study a sinusoidally driven qubit weakly coupled to the calorimeter which comprises harmonic oscillators with an energy gap equivalent to that of the qubit. The qubit and the calorimeter are initially thermalized with an ideal bath of inverse temperature $\\beta$ as depicted in  Fig. \\ref{fig:syst}.\n\n\n\\emph{The standard quantum jump method}.---\nLet us first give a short introduction to the standard QJ method in the literature\n\\cite{prl68/580, pra45/4879, pra46/4363, OSAQO, rmp70/101}. Instead of evolving the density matrix as done in the direct master equation calculations, the quantum jump method unravels the master equation into quantum trajectories with stochastically evolving wave functions. For a single trajectory, the probability for a jump between time $t$ and $t+\\delta t $ is given by\n\n\\begin{eqnarray}\n\\delta p =  \\sum_m \\delta p_m = \\sum_m \\delta t {\\mathinner{\\langle{{\\psi(t)}}|}} \\hat C^\\dagger_m  \\hat C_m  {\\mathinner{|{{\\psi(t)}}\\rangle}}, \n\\end{eqnarray}\n\nfor $\\delta t \\rightarrow 0$, where ${\\mathinner{|{{\\psi(t)}}\\rangle}}$ is the state of the system before the jump, $\\delta p_m$ is the probability for a jump corresponding to a jump operator $\\hat C_m=\\sqrt{\\Gamma_m} \\hat A_m$. The matrix $\\hat A_m$ gives the form of the jump and $\\Gamma_m$ is the transition rate. If  a jump corresponding to $\\hat C_m$ occurs, the new  state is given by ${\\mathinner{|{{\\psi(t+\\delta)}}\\rangle}}=\\hat C_m  {\\mathinner{|{{\\psi(t)}}\\rangle}} / \\sqrt{(\\delta p_m/\\delta t)}$, where $\\delta p_m/\\delta t$ normalizes it. If no jumps occur during the time interval $[t,t+\\delta t]$, the state evolution is not given by the system Hamiltonian $\\hat H_s(t)$ alone but by the non-unitary Hamiltonian\n$\n\\hat H(t)= \\hat H_s(t)-\\frac{i \\hbar}{2} \\sum_m \\hat C^\\dagger_m  \\hat C_m,\n$\nyielding $ {\\mathinner{|{{\\psi(t+\\delta t)}}\\rangle}}= \\frac{1}{\\sqrt{1-\\delta p}} \\left(1-\\frac{i}{\\hbar} {\\hat H}(t) \\delta t \\right)  {\\mathinner{|{{\\psi(t)}}\\rangle}}$. Although the jump operator can be time-dependent, the past history of the trajectory, e.g., the number of jumps, does not affect the jump operators at all. As a consequence, the evolution of a stochastic trajectory depends only on the current state of the system ${\\mathinner{|{{\\psi(t)}}\\rangle}}$. This is a good approximation when the environment is ideal.  However, such an environment makes the calorimetric measurement infeasible as the system evolution leaves no traces to the environment.\n\n\\emph{Quantum jump method with a finite environment}.---\nWe now wish to extend the standard QJ method to the case corresponding to Fig. 1, where transitions in the system influence the state of\nthe calorimeter, both initially thermalized with an ideal heat bath.  We assume the calorimeter to be large enough such that it is \ncharacterized by a set of microstates (eigenstates) without superposition. We also assume the system-calorimeter coupling to be weak enough such that it can be neglected in the energy terms and modeled by stochastic jumps alone. We take into account only transitions that conserve the energy of the calorimeter-system composite.  \n\n\nTo be precise, instead of using jump operators that only depend on the system degrees of freedom, \nwe define new jump operators $\\hat D_m=g_m  \\hat A_m \\otimes \\hat B_m$, where $ \\hat A_m$ causes a transition between system states and $\\hat B_m$ between calorimeter microstates. The coefficient $g_m$ is proportional to the coupling strength. We define the probability for a transition in the time interval $[t,t+\\delta t] $ as\n\n\\begin{eqnarray}\n\\delta p =  \\sum_m \\delta p_m = \\sum_m \\delta t \\text{Tr}_{s+c} \\lbrace \\hat D^\\dagger_m  \\hat D_m \\hat \\sigma_s \\otimes \\hat \\sigma_c \\rbrace, \\label{eq:dp1}\n\\end{eqnarray}\n\nwhere $\\delta p_m$ is the probability for a jump corresponding to the jump operator $\\hat D_m$,  \n$\\hat \\sigma_s(t)={\\mathinner{|{{\\psi(t)}}\\rangle}} {\\mathinner{\\langle{{\\psi(t)}}|}}$ is the matrix form of the system state, and  \n$\\hat \\sigma_c(t)={\\mathinner{|{{\\Psi(t)}}\\rangle}} {\\mathinner{\\langle{{\\Psi(t)}}|}}$ is the instantaneous calorimeter microstate,\nand the trace is over both the system ($s$) and calorimeter ($c$) degrees of freedom. \n\n\nIf a jump corresponding to $\\hat D_m$ occurs, the new system and calorimeter states are given by $\\hat \\sigma_s(t+\\delta t)= {\\rm Tr}_c \\lbrace \\hat D_m  \\hat \\sigma_s \\otimes \\hat \\sigma_c \\hat D_m^\\dagger \\rbrace / \\delta p_m$ and  $\\hat \\sigma_c(t+\\delta t)= {\\rm Tr}_s \\lbrace \\hat D_m  \\hat \\sigma_s \\otimes \\hat \\sigma_c \\hat D_m^\\dagger \\rbrace/ \\delta p_m$. \n\n\n\nIf no jumps occur during the time interval $[t,t+\\delta t]$, the time evolution is given by the non-unitary Hamiltonian\n\n\\begin{eqnarray}\n\\hat H(t)= \\hat H_s(t)+ \\hat H_c-\\frac{i \\hbar}{2} \\sum_m \\hat D^\\dagger_m  \\hat D_m,\\label{eq:dp2}\n\\end{eqnarray}\n\nwhere $\\hat H_s$ and $\\hat H_c$ are the system and calorimeter Hamiltonians, respectively. The new system state \n$\\hat \\sigma_s(t+\\delta t)= {\\rm Tr}_c \\lbrace \\hat U(t+\\delta t,t) \\hat \\sigma_s \\otimes \\hat \\sigma_c \\hat U^\\dagger(t+\\delta t,t) \\rbrace / (1- \\delta p) +\\mathcal{O}(dt^2)$, where $\\hat U(t+\\delta t,t)= 1- \\frac{i}{\\hbar}  \\hat{H}(t) \\delta t$. Similarly, the new calorimeter \nstate  $\\hat \\sigma_c(t+ \\delta t)= {\\rm Tr}_s \\lbrace \\hat U(t+\\delta t,t) \\hat \\sigma_s \\otimes \\hat \\sigma_c \\hat U^\\dagger(t+\\delta t,t) \\rbrace/(1-\\delta p) +\\mathcal{O}(dt^2)$, which gives $\\hat \\sigma_c(t+ \\delta t)= \\hat \\sigma_c(t)$ as we assumed that $\\hat \\sigma_c(t)$ is in a microstate. As a consequence, it is sufficient to focus in detail only on the system dynamics, \nwhere the calorimeter's state only affects the transition rates.\n\n \\emph{Fluctuation relations}.---\nFor studying stochastic thermodynamics and the associated fluctuation relations with the method, we focus on a generic two-level system with \n$\\hat H_s = \\hbar\\omega_0 \\hat a^\\dagger \\hat a$ that is weakly driven by a classical source $V(t)=\\lambda(t)(\\hat a+ \\hat a^\\dagger)$. It is coupled to the calorimeter by $V_N(t)=\\kappa \\sum_m (\\hat{a}^\\dagger \\hat{b}_m  + \\hat{a} \\hat{b}_m^\\dagger)$, where the coupling strength $\\kappa$ is real and the operators $\\hat b_m$  depend on the exact form of the calorimeter. The calorimeter Hamiltonian is given by $\\hat H_c =\\sum_n \\epsilon_n \\hat d_n^\\dagger \\hat d_n$. For a bosonic calorimeter $\\hat d_n$ \nand $\\hat d^\\dagger_n$ are the annihilation and creation operators associated with energy $\\epsilon_n$ and the operators $\\hat b_m$ form a set of all the annihilation operators associated with energy $\\hbar \\omega_0$, i.e,  $\\sum_m \\hat b_m =\\sum_n \\hat d_n \\delta_{\\epsilon_n,\\hbar \\omega_0}$ \n\\footnote{The analytical results here are valid also for a Fermi bath. In that case, $\\hat d_n$ and $\\hat d^\\dagger_n$ are the Fermi operators and the operators $\\hat b_m$  are transitions between calorimeter states that correspond $\\hbar \\omega_0$, i.e., $\\sum_m \\hat b_m=\\sum_{n,l} \\hat d_n^\\dagger \\hat d_l \\delta_{\\epsilon_n,\\epsilon_l-\\hbar \\omega_0}$.}. After the driving protocol, both the qubit and the calorimeter states are measured.  \n\n\n \nThe total system is initially prepared such that both the qubit and the calorimeter start as a pure state given by the joint probability $P[i,\\Psi_0]$, where ${\\mathinner{|{{i}}\\rangle}}$ and ${\\mathinner{|{{\\Psi_0}}\\rangle}}$  are the initial qubit and calorimeter states, respectively. Similar to the standard perturbative treatment \\cite{Girvin2010}, we define the jump operators in the undriven basis, i.e., $\\hat D_{\\uparrow,m}=g_m  \\hat a^\\dagger \\otimes \\hat b_m$ and  $\\hat D_{\\downarrow,m} =g_m \\hat a \\otimes \\hat b_m^\\dagger$, where the coefficient $g_m \\propto \\kappa$.  Due to the energy change with the qubit, the calorimeter can jump to a different microstate such that the energy difference of the microstates corresponds to the energy change in the qubit. If the calorimeter is assumed to stay in the same microstate between the jumps, we can write the calorimeter traced jump operators\n\\footnote{The calorimeter traced jump operators are defined such that ${\\rm Tr}_s \\lbrace \\hat C_{m} \\hat \\sigma_s \\hat C^\\dagger_{m}   \\rbrace = {\\rm Tr}_{s+c} \\lbrace \\hat D_{m} \\hat \\sigma_s \\otimes \\hat \\sigma_c \\hat D^\\dagger_{m}   \\rbrace$.}  \nas $\\hat C_{\\uparrow,m}(\\Psi_k)=\\sqrt{\\Gamma_{\\uparrow,m}(\\Psi_k)} \\hat a^\\dagger$ and $\\hat C_{\\downarrow,m}(\\Psi_k)=\\sqrt{\\Gamma_{\\downarrow,m}(\\Psi_k)} \\hat a$, where the transition rates are\n\n\\begin{eqnarray}\n\\Gamma_{\\uparrow,m}(\\Psi_k)&=& |g_k|^2  {\\rm Tr}_c\\lbrace \\hat b_m \\hat \\sigma_c(\\Psi_k) \\hat b_m^\\dagger \\rbrace, \\\\\n \\Gamma_{\\downarrow,m}(\\Psi_k)&=& |g_k|^2  {\\rm Tr}_c\\lbrace \\hat b_m^\\dagger \\hat \\sigma_c(\\Psi_k) \\hat b_m \\rbrace,\n \\end{eqnarray}\n \nwith $\\hat \\sigma_c(\\Psi_k)={\\mathinner{|{{\\Psi_k}}\\rangle}}{\\mathinner{\\langle{{\\Psi_k}}|}}$. If a jump caused by $\\hat C_{\\downarrow,m}(\\Psi_k)$ occurs, the new calorimeter state is ${\\mathinner{|{{\\Psi_{k+1}}}\\rangle}}=\\hat b_m^\\dagger {\\mathinner{|{{\\Psi_k}}\\rangle}}/ || \\hat b_m^\\dagger {\\mathinner{|{{\\Psi_k}}\\rangle}}||$. The entropy production associated with a jump is defined as the logarithmic ratio of the forward and backward transition rates. Due to the symmetry $\\Gamma_{\\downarrow,m}(\\Psi_k)=\\Gamma_{\\uparrow,m}(\\Psi_{k+1})$, this entropy production is always zero and the total entropy production of a trajectory depends only on the initial and final states of the qubit  and the calorimeter, i.e., \n\n\n", "index": 1, "text": "\\begin{equation}\n\\Delta S_{T} =  \\ln \\left\\lbrace  {P[i,\\Psi_0]}/{\\bar{P}[f,\\Psi_N]}\\right\\rbrace,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"\\Delta S_{T}=\\ln\\left\\{{P[i,\\Psi_{0}]}/{\\bar{P}[f,\\Psi_{N}]}\\right\\},\" display=\"block\"><mrow><mrow><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msub><mi>S</mi><mi>T</mi></msub></mrow><mo>=</mo><mrow><mi>ln</mi><mo>\u2061</mo><mrow><mo>{</mo><mrow><mrow><mrow><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>i</mi><mo>,</mo><msub><mi mathvariant=\"normal\">\u03a8</mi><mn>0</mn></msub><mo stretchy=\"false\">]</mo></mrow></mrow><mo>/</mo><mover accent=\"true\"><mi>P</mi><mo stretchy=\"false\">\u00af</mo></mover></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>f</mi><mo>,</mo><msub><mi mathvariant=\"normal\">\u03a8</mi><mi>N</mi></msub><mo stretchy=\"false\">]</mo></mrow></mrow><mo>}</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05317.tex", "nexttext": " \n\nwhere the average is over all the forward trajectories. If the initial probability distribution of the forward trajectory follows the \ncanonical ensemble in equilibrium with the ideal heat bath, the probability distribution of the reversed trajectories can be chosen to follow a canonical ensemble with the same temperature. By defining the work $W$ associated with a single trajectory as the energy difference between the initial and final states of the qubit-calorimeter composite, Eq. \\eqref{eq:stot} gives the Jarzynski equality for work as\n\n\n", "itemtype": "equation", "pos": -1, "prevtext": " \n\nwhere $\\bar{P}[f,\\Psi_N]$ is the probability to start a reversed trajectory with the final qubit state ${\\mathinner{|{{f}}\\rangle}}$ and the final calorimeter state ${\\mathinner{|{{\\Psi_N}}\\rangle}}$ of the forward trajectory. The entropy production satisfies the fluctuation theorem (see Appendix A for details):\n\n\n", "index": 3, "text": "\\begin{equation}\n\\langle e^{-\\Delta S_{T}} \\rangle  = 1, \\label{eq:stot} \n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"\\langle e^{-\\Delta S_{T}}\\rangle=1,\" display=\"block\"><mrow><mrow><mrow><mo stretchy=\"false\">\u27e8</mo><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msub><mi>S</mi><mi>T</mi></msub></mrow></mrow></msup><mo stretchy=\"false\">\u27e9</mo></mrow><mo>=</mo><mn>1</mn></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05317.tex", "nexttext": "\nwhere $\\Delta F$ is the free-energy difference between the final and initial states. \n\nThe results above were derived assuming that the calorimeter stays in the same microstate until the next jump. However, in many systems such as in electronic devices \\cite{jsm2013/P02033,Kutvonen2015}, the relaxation rate inside the calorimeter is the fastest time scale. \nConsequently, the calorimeter does not stay in a single microstate between jumps but shifts quickly between the microstates that correspond to the same energy. We can still calculate the qubit dynamics with Eqs. \\eqref{eq:dp1} and \\eqref{eq:dp2} by using an averaged calorimeter state instead of a single calorimeter microstate. According to the microcanonical ensemble, the averaged calorimeter state \n$\n\\hat \\sigma_c(E)= (1/N(E)) \\sum_\\Psi {\\mathinner{|{{\\Psi}}\\rangle}}{\\mathinner{\\langle{{\\Psi}}|}} \\delta_{E_\\Psi,E}, \n$\nwhere the sum is over all the microstates, $N(E)$ is the number of microstates with energy $E$ and $E_\\Psi$ is the energy of microstate ${\\mathinner{|{{\\Psi}}\\rangle}}$. Let us call this state a macrostate. We assume that calorimeter reaches the macrostate instantaneously after a jump. The probability to start with the qubit state ${\\mathinner{|{{i}}\\rangle}}$ and the calorimeter macrostate of energy $E_0$ is given by $P[i,E_0]$.  Due to the energy change with the qubit, the calorimeter can jump to another macrostate. As the calorimeter reaches the macrostate immediately after a jump, we can sum over all the transition rates corresponding the same energy change. The resulting total transition rates are given by\n\n\\begin{eqnarray}\n\\Gamma_{\\downarrow}(E) = \\frac{1}{N(E)} \\sum_{m, \\Psi} \\Gamma_{\\downarrow,m}(\\Psi)  \\delta_{E_\\Psi,E}, \\label{ETR1} \\\\\n\\Gamma_{\\uparrow}(E) =  \\frac{1}{N(E)} \\sum_{m, \\Psi} \\Gamma_{\\uparrow,m}(\\Psi)  \\delta_{E_\\Psi,E}  \\label{ETR2},  \\end{eqnarray}\n\nand they satisfy the detailed balance condition \n\n", "itemtype": "equation", "pos": 16516, "prevtext": " \n\nwhere the average is over all the forward trajectories. If the initial probability distribution of the forward trajectory follows the \ncanonical ensemble in equilibrium with the ideal heat bath, the probability distribution of the reversed trajectories can be chosen to follow a canonical ensemble with the same temperature. By defining the work $W$ associated with a single trajectory as the energy difference between the initial and final states of the qubit-calorimeter composite, Eq. \\eqref{eq:stot} gives the Jarzynski equality for work as\n\n\n", "index": 5, "text": "\\begin{equation}\n\\langle e^{-\\beta W } \\rangle = e^{-\\beta \\Delta F}, \\label{eq:JE} \n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"\\langle e^{-\\beta W}\\rangle=e^{-\\beta\\Delta F},\" display=\"block\"><mrow><mrow><mrow><mo stretchy=\"false\">\u27e8</mo><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi>\u03b2</mi><mo>\u2062</mo><mi>W</mi></mrow></mrow></msup><mo stretchy=\"false\">\u27e9</mo></mrow><mo>=</mo><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi>\u03b2</mi><mo>\u2062</mo><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><mi>F</mi></mrow></mrow></msup></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05317.tex", "nexttext": "\nThe entropy production of a jump up with the calorimeter energy $E$ is given by\n\n\\begin{eqnarray}\n\\Delta s_\\uparrow(E) = -  \\ln \\left( \\frac{\\Gamma_{\\downarrow}(E-\\hbar\\omega_0) }{\\Gamma_{\\uparrow}(E )} \\right) = \\ln \\left( \\frac{N(E-\\hbar \\omega_0)}{N(E)} \\right), \\label{DBCE2}\n\\end{eqnarray}\n\nwhich gives a natural interpretation of the entropy production as the Boltzmann entropy change of the calorimeter. The entropy productions of up and down jumps are related by $\\Delta s_\\uparrow(E)=-\\Delta s_\\downarrow(E-\\hbar \\omega_0)$. The total entropy production is \nthen given by\n\n\\begin{eqnarray}\n\\Delta S_{T}=  \\ln \\left\\lbrace  {P[i,E_0]}/{\\bar{P}[f,E_N]}\\right\\rbrace+\\sum_{i=1}^N \\Delta s_{\\chi_i}{(E_{i-1})},\n\\end{eqnarray}\n\nwhere $N$ is the number of jumps, $E_i$ is the calorimeter energy after the $i^{\\rm th}$ jump,  $\\chi_i=\\uparrow/\\downarrow$ is the \ndirection of $i^{\\rm th}$ jump, and $\\bar{P}[f,E_N]$ is the probability to start a reversed trajectory with the forward trajectory's final qubit state ${\\mathinner{|{{f}}\\rangle}}$ and calorimeter energy $E_N$. As Eq. \\eqref{eq:stot} still holds,  we recover the Jarzynski equality if we start from the canonical ensemble.\n\n\n\\emph{Numerical results}.---\nTo illustrate the method, we have done numerical simulations of the coupled qubit-calorimeter composite, where the calorimeter is\ndescribed by $n$ quantum harmonic oscillators, with energy gap equivalent to that of the qubit $\\hbar \\omega_0$. \nThe harmonic oscillators can be non-interacting or interacting. In both cases, the transition rates are the \nsame and depend only on the calorimeter energy:\n\n\\begin{eqnarray}\n\\Gamma_{\\downarrow}(E) = |g|^2 (E+n\\hbar \\omega_0), \\quad\\Gamma_{\\uparrow}(E) =  |g|^2 E,\\label{ETR2} \n\\end{eqnarray}\n\nwhere we have for convenience chosen $E=0$ when all the oscillators are in the ground state.\nIn order to compare the results with different number of oscillators, we use the value $g^2=0.025 / ( n \\hbar )$ in the simulations such that the total coupling strength remains the same. We start the qubit and the calorimeter from a canonical ensemble with respect to the inverse temperature $\\beta = 1/(\\hbar \\omega_0)$. The qubit is driven sinusoidally with $\\lambda(t)=0.05\\hbar \\omega_0 \\sin (\\omega_0 t)$. The protocol consist of driving, no driving, driving, no driving parts each lasting a time interval equal of 50 driving periods.\n\n\\begin{figure}[t!]\n    \\begin{center}\n    \\includegraphics[scale=.4]{Fig2.pdf}\n    \\end{center}\n    \\caption{The difference between the populations of the qubit excited state for $n$ and infinite number of oscillators \n    $\\rho_e(t) \\equiv \\rho^n_e(t) - \\rho^\\infty_e(t)$. The data is from numerical simulations of the coupled qubit-calorimeter system. The protocol ends at time $\\tau$. The inset shows the excited state population when $n=\\infty$. The drive is discretized using $2 \\times 10^5$ time steps and the number of trajectories is $10^9$. See text for the values of the other system parameters.}\n    \\label{fig:pop}\n\\end{figure}\n\n\nFigure \\ref{fig:pop} nicely illustrates the influence of the calorimeter's size on the qubit dynamics. Due to its finite size, the calorimeter \nis driven out of equilibrium. During the drive, the effect of the calorimeter on the qubit dynamics is suppressed by the drive \nsince it is stronger than the qubit-calorimeter coupling. However, when the drive is stopped and the qubit equilibrates, the effect of the calorimeter becomes apparent. The drive causes the qubit to emit energy to the calorimeter. For a very large calorimeter (here\nthe largest $n=400$), this additional energy is very small as compared to the initial energy, which scales with size. However, for a smaller $n$ the change in the relative energy becomes more pronounced as depicted in Fig. \\ref{fig:work}(b).\n\n\n\\begin{figure}[t!]\n    \\begin{center}\n    \\includegraphics[scale=.4]{Fig3.pdf}\n    \\end{center}\n    \\caption{Influence of finite-size calorimeter on the work and energy statistics when it consists of $n$ harmonic oscillators.  (a)  The probability distribution of work in the case of $n=\\infty$, $P_\\infty(W)$.  (b) Time evolution of the average calorimeter energy for different values\n    of $n$. (c) Deviation of the probability distribution of work $\\Delta P(W) \\equiv P_n(W) - P_\\infty(W)$. \n    (d) Numerical verification of the Jarzynski equality. The error bars are the standard deviation times 1.96 and correspond to a 95 \\% confidence interval. The parameters are the same as in Fig. \\ref{fig:pop}.}\n    \\label{fig:work}\n\\end{figure}\n\n\nFor the setup, the work is obtained as the energy difference between the initial and final states of the qubit plus the heat released to the calorimeter. This yields the same result as the two-measurement protocol for the composite. As shown in Figs. \\ref{fig:work}(a) and (c), the finite size of the calorimeter causes the work distribution to deviate from the inifinite-size limit as overheating changes the transition rates.  The transition rates are strongly influenced by\nthe previous jumps for small values of $n$. This is illustrated in Fig. \\ref{fig:work}(c), where work values between $\\pm 5 \\hbar \\omega_0$ are more probable for small $n$. Independent of $n$, the work distributions were found to be consistent with the Jarzynski equality within the statistical errors, as shown in Fig. \\ref{fig:work}(d).\n\n\n\\emph{Conclusions}.---\nMeasurement and definition of work in driven open quantum systems poses an interesting theoretical and experimental challenge. \nIn the present work, we have considered the proposal of a calorimetric measurement that offers a simple and transparent way of\nmeasuring energy exchange between the system and the calorimeter. To be able to theoretically analyse a calorimetric\nsetup, we have developed a modified QJ model suitable for systems with a finite-size environment. \nWe have shown that  due to the finite size, the calorimeter is driven out of equilibrium leading to changes in the reduced system's \ndynamics and in the work statistics. These changes cannot be modelled with the standard QJ method which assumes that the\nwhole environment is an ideal heat bath. With the model, we have analytically and numerically shown that the standard fluctuation relations are still valid and remain unaltered by the finite size of the calorimeter.  This is in contrast to Ref. \\cite{jsm2013/P02033}, where the transition rates violate the detailed balance condition of Eq. \\eqref{eq:DBC2} (see Appendix B).\n\n\n\\acknowledgements\nWe wish to thank Jukka Pekola for suggesting this problem to us, and for useful discussions. We wish also to thank C. Jarzynski, P. Muratore-Ginanneschi and K. Schwieger for useful discussions and comments. This work was supported in part by the V\\\"ais\\\"al\\\"a foundation and the Academy of Finland through its Centres of Excellence Programme (2015-2017) under project number 284621. The numerical calculations were performed using computer resources of the Aalto University School of Science \"Science-IT\" project. \n\n\n\\bibliography{suomela2,localbib}\n\n\\appendix\n\\begin{widetext}\n\\section{Appendix A: Fluctuation theorem for the quantum jump model with a finite-size environment} \n\nLet us consider an open quantum system coupled to a calorimeter through dissipative channels described by jump operators $\\hat{D}_{m}=g_{m} \\hat A_m \\otimes \\hat B_{m}$, where $ \\hat A_m$ and $\\hat B_{m}$ depend on the system and calorimeter degrees of freedom, respectively, and $g_{m}$ is the coupling strength. We also assume that the jump operator follow detailed balance such that for every $\\hat D_{m}$ there is $\\hat D_{n}$ such that $\\hat A_n =\\hat A_m^\\dagger$ and $\\hat B_{n} =\\hat B_{m}^\\dagger$. Let us first study the case, where the calorimeter is in a single microstate ${\\mathinner{|{{\\Psi_k}}\\rangle}}$ and it does not change between the jumps. In this case, we can use the calorimeter traced jump operators $\\hat C_{m}=\\sqrt{\\Gamma_{m}(\\Psi_k)} \\hat{A}_m$ that are defined such that ${\\rm Tr}_{s} \\lbrace \\hat C_{m} \\hat \\sigma_s \\hat C^\\dagger_{m}   \\rbrace = {\\rm Tr}_{s+c} \\lbrace \\hat D_{m} \\hat \\sigma_s \\otimes {\\mathinner{|{{\\Psi_k}}\\rangle}} {\\mathinner{\\langle{{\\Psi_k}}|}}  \\hat D^\\dagger_{m}   \\rbrace$, where $\\hat \\sigma_s$ is the matrix form of the system state, $\\rm Tr_{s}$ denotes trace over the system degrees of freedom and $\\rm Tr_{s+c}$ denotes trace over both the system and calorimeter degrees of freedom. Due to the system-calorimeter energy change, the energy of the calorimeter evolves stochastically. The probability to traverse a single $N$-jump QJ trajectory is given by\n\\begin{eqnarray}\n&& P_{QJ}[i, f, \\Psi_0, \\Psi_N, \\{\\hat{C}_{m_k}\\}_{k=1}^N, \\{t_k\\}_{k=1}^N] \\nonumber \\\\ \n&&= P[i,\\Psi_0] \\left[ \\prod_{k=1}^N p^0(t_k,t_{k-1}) p_{m_k}(t_k)  \\right]  p^0(\\tau, t_N) P_f[f, \\Psi_N],\n\\label{Eq:PrF}\n\\end{eqnarray}\nwhere the protocol starts at time $t_0=0$ and ends at time $\\tau$, $P[i,\\Psi_0]$ is the probability to start with the system state ${\\mathinner{|{{i}}\\rangle}}$ and the calorimeter state ${\\mathinner{|{{\\Psi_0}}\\rangle}}$, $p_{m_k}(t_k)$ is the probability for a jump to occur along the $m_k$:th channel during $[t_k,t_k+\\delta t]$, and $p^0(t_{k+1},t_k)$ is the probability of no jump during the time-interval $[t_k,t_{k+1}]$ and $P_f[f, \\Psi_N]$ is the probability to measure the system state ${\\mathinner{|{{f}}\\rangle}}$ and the calorimeter state ${\\mathinner{|{{\\Psi_N}}\\rangle}}$ at the end of the protocol. As the jump probabilities can be calculated simply using the calorimeter traced jump operators, we can use the results derived for time-dependent jump operators \\cite{Suomela2015a}, yielding\n\\begin{eqnarray}\n&&P_{QJ}[i, f, \\Psi_0, \\Psi_N, \\{\\hat{C}_{m_k}\\}_{k=1}^N, \\{t_k\\}_{k=1}^N] \\nonumber  \\\\\n&&=  (\\delta t)^N P[i,\\Psi_0] \\left[\\prod_{k=1}^N \\Gamma_{m_k}(\\Psi_{k-1}) \\right] \\left\\lvert \\langle f | \\hat{U}_{\\mathrm{eff}}(\\tau,t_N) \\left[ \\prod_{k=1}^N \\hat{A}_{m_{N+1-k}}\\hat{U}_{\\mathrm{eff}}(t_{N+1-k},t_{N-k})\\right] |i \\rangle \\right\\rvert^2,\n\\label{Eq:Pr1}\n\\end{eqnarray}\n\nwhere ${\\mathinner{|{{\\Psi_k}}\\rangle}}$ is the calorimeter state after $k$:th jump and the no-jump evolution is given by\n\n", "itemtype": "equation", "pos": 18539, "prevtext": "\nwhere $\\Delta F$ is the free-energy difference between the final and initial states. \n\nThe results above were derived assuming that the calorimeter stays in the same microstate until the next jump. However, in many systems such as in electronic devices \\cite{jsm2013/P02033,Kutvonen2015}, the relaxation rate inside the calorimeter is the fastest time scale. \nConsequently, the calorimeter does not stay in a single microstate between jumps but shifts quickly between the microstates that correspond to the same energy. We can still calculate the qubit dynamics with Eqs. \\eqref{eq:dp1} and \\eqref{eq:dp2} by using an averaged calorimeter state instead of a single calorimeter microstate. According to the microcanonical ensemble, the averaged calorimeter state \n$\n\\hat \\sigma_c(E)= (1/N(E)) \\sum_\\Psi {\\mathinner{|{{\\Psi}}\\rangle}}{\\mathinner{\\langle{{\\Psi}}|}} \\delta_{E_\\Psi,E}, \n$\nwhere the sum is over all the microstates, $N(E)$ is the number of microstates with energy $E$ and $E_\\Psi$ is the energy of microstate ${\\mathinner{|{{\\Psi}}\\rangle}}$. Let us call this state a macrostate. We assume that calorimeter reaches the macrostate instantaneously after a jump. The probability to start with the qubit state ${\\mathinner{|{{i}}\\rangle}}$ and the calorimeter macrostate of energy $E_0$ is given by $P[i,E_0]$.  Due to the energy change with the qubit, the calorimeter can jump to another macrostate. As the calorimeter reaches the macrostate immediately after a jump, we can sum over all the transition rates corresponding the same energy change. The resulting total transition rates are given by\n\n\\begin{eqnarray}\n\\Gamma_{\\downarrow}(E) = \\frac{1}{N(E)} \\sum_{m, \\Psi} \\Gamma_{\\downarrow,m}(\\Psi)  \\delta_{E_\\Psi,E}, \\label{ETR1} \\\\\n\\Gamma_{\\uparrow}(E) =  \\frac{1}{N(E)} \\sum_{m, \\Psi} \\Gamma_{\\uparrow,m}(\\Psi)  \\delta_{E_\\Psi,E}  \\label{ETR2},  \\end{eqnarray}\n\nand they satisfy the detailed balance condition \n\n", "index": 7, "text": "\\begin{equation}\n{\\Gamma_{\\downarrow}(E-\\hbar\\omega_0) }/{\\Gamma_{\\uparrow}(E) }={N(E )}/{N(E-\\hbar \\omega_0)}. \\label{eq:DBC2}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"{\\Gamma_{\\downarrow}(E-\\hbar\\omega_{0})}/{\\Gamma_{\\uparrow}(E)}={N(E)}/{N(E-%&#10;\\hbar\\omega_{0})}.\" display=\"block\"><mrow><mrow><mrow><mrow><mrow><msub><mi mathvariant=\"normal\">\u0393</mi><mo>\u2193</mo></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>E</mi><mo>-</mo><mrow><mi mathvariant=\"normal\">\u210f</mi><mo>\u2062</mo><msub><mi>\u03c9</mi><mn>0</mn></msub></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow><mo>/</mo><msub><mi mathvariant=\"normal\">\u0393</mi><mo>\u2191</mo></msub></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>E</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mrow><mi>N</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>E</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>/</mo><mi>N</mi></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mi>E</mi><mo>-</mo><mrow><mi mathvariant=\"normal\">\u210f</mi><mo>\u2062</mo><msub><mi>\u03c9</mi><mn>0</mn></msub></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05317.tex", "nexttext": "\n where $\\hat{H}_s(t)$ is the system Hamiltonian and $\\mathcal{T}$ is the time-ordering operator.\n\nWe can formulate a time-reversed counterpart for the forward trajectory of Eq. \\eqref{Eq:PrF}. In the time-reversed trajectory, we measure system state ${\\mathinner{|{{f}}\\rangle}}$ and calorimeter state ${\\mathinner{|{{\\Psi_N}}\\rangle}}$ at the beginning ($\\bar{t} = 0$) and states ${\\mathinner{|{{i}}\\rangle}}$ and ${\\mathinner{|{{\\Psi_0}}\\rangle}}$ at the end ($\\bar{t}=\\tau$). In the time-reversed trajectory, all the jumps are reversed and they happen in reverse order, i.e., a jump caused by $\\hat C_{\\bar{m}_k}$ occurs at time  $\\bar{t} = t_{f}-t_{k}$, where the index $\\bar{m}_k$ is related to the forward index $m_k$ such that $\\hat A_{\\bar{m}_k}=\\hat{A}^\\dagger_{m_k}$ and $\\hat B_{\\bar{m}_k}=\\hat{B}^\\dagger_{m_k}$. By demanding that the time-reversed no-jump evolution between jumps is given by $\\hat{U}_{\\mathrm{eff}}^\\dagger(t_{i+1},t_{i})$, the probability for the reverse QJ trajectory can then be written as \n\n", "itemtype": "equation", "pos": 28867, "prevtext": "\nThe entropy production of a jump up with the calorimeter energy $E$ is given by\n\n\\begin{eqnarray}\n\\Delta s_\\uparrow(E) = -  \\ln \\left( \\frac{\\Gamma_{\\downarrow}(E-\\hbar\\omega_0) }{\\Gamma_{\\uparrow}(E )} \\right) = \\ln \\left( \\frac{N(E-\\hbar \\omega_0)}{N(E)} \\right), \\label{DBCE2}\n\\end{eqnarray}\n\nwhich gives a natural interpretation of the entropy production as the Boltzmann entropy change of the calorimeter. The entropy productions of up and down jumps are related by $\\Delta s_\\uparrow(E)=-\\Delta s_\\downarrow(E-\\hbar \\omega_0)$. The total entropy production is \nthen given by\n\n\\begin{eqnarray}\n\\Delta S_{T}=  \\ln \\left\\lbrace  {P[i,E_0]}/{\\bar{P}[f,E_N]}\\right\\rbrace+\\sum_{i=1}^N \\Delta s_{\\chi_i}{(E_{i-1})},\n\\end{eqnarray}\n\nwhere $N$ is the number of jumps, $E_i$ is the calorimeter energy after the $i^{\\rm th}$ jump,  $\\chi_i=\\uparrow/\\downarrow$ is the \ndirection of $i^{\\rm th}$ jump, and $\\bar{P}[f,E_N]$ is the probability to start a reversed trajectory with the forward trajectory's final qubit state ${\\mathinner{|{{f}}\\rangle}}$ and calorimeter energy $E_N$. As Eq. \\eqref{eq:stot} still holds,  we recover the Jarzynski equality if we start from the canonical ensemble.\n\n\n\\emph{Numerical results}.---\nTo illustrate the method, we have done numerical simulations of the coupled qubit-calorimeter composite, where the calorimeter is\ndescribed by $n$ quantum harmonic oscillators, with energy gap equivalent to that of the qubit $\\hbar \\omega_0$. \nThe harmonic oscillators can be non-interacting or interacting. In both cases, the transition rates are the \nsame and depend only on the calorimeter energy:\n\n\\begin{eqnarray}\n\\Gamma_{\\downarrow}(E) = |g|^2 (E+n\\hbar \\omega_0), \\quad\\Gamma_{\\uparrow}(E) =  |g|^2 E,\\label{ETR2} \n\\end{eqnarray}\n\nwhere we have for convenience chosen $E=0$ when all the oscillators are in the ground state.\nIn order to compare the results with different number of oscillators, we use the value $g^2=0.025 / ( n \\hbar )$ in the simulations such that the total coupling strength remains the same. We start the qubit and the calorimeter from a canonical ensemble with respect to the inverse temperature $\\beta = 1/(\\hbar \\omega_0)$. The qubit is driven sinusoidally with $\\lambda(t)=0.05\\hbar \\omega_0 \\sin (\\omega_0 t)$. The protocol consist of driving, no driving, driving, no driving parts each lasting a time interval equal of 50 driving periods.\n\n\\begin{figure}[t!]\n    \\begin{center}\n    \\includegraphics[scale=.4]{Fig2.pdf}\n    \\end{center}\n    \\caption{The difference between the populations of the qubit excited state for $n$ and infinite number of oscillators \n    $\\rho_e(t) \\equiv \\rho^n_e(t) - \\rho^\\infty_e(t)$. The data is from numerical simulations of the coupled qubit-calorimeter system. The protocol ends at time $\\tau$. The inset shows the excited state population when $n=\\infty$. The drive is discretized using $2 \\times 10^5$ time steps and the number of trajectories is $10^9$. See text for the values of the other system parameters.}\n    \\label{fig:pop}\n\\end{figure}\n\n\nFigure \\ref{fig:pop} nicely illustrates the influence of the calorimeter's size on the qubit dynamics. Due to its finite size, the calorimeter \nis driven out of equilibrium. During the drive, the effect of the calorimeter on the qubit dynamics is suppressed by the drive \nsince it is stronger than the qubit-calorimeter coupling. However, when the drive is stopped and the qubit equilibrates, the effect of the calorimeter becomes apparent. The drive causes the qubit to emit energy to the calorimeter. For a very large calorimeter (here\nthe largest $n=400$), this additional energy is very small as compared to the initial energy, which scales with size. However, for a smaller $n$ the change in the relative energy becomes more pronounced as depicted in Fig. \\ref{fig:work}(b).\n\n\n\\begin{figure}[t!]\n    \\begin{center}\n    \\includegraphics[scale=.4]{Fig3.pdf}\n    \\end{center}\n    \\caption{Influence of finite-size calorimeter on the work and energy statistics when it consists of $n$ harmonic oscillators.  (a)  The probability distribution of work in the case of $n=\\infty$, $P_\\infty(W)$.  (b) Time evolution of the average calorimeter energy for different values\n    of $n$. (c) Deviation of the probability distribution of work $\\Delta P(W) \\equiv P_n(W) - P_\\infty(W)$. \n    (d) Numerical verification of the Jarzynski equality. The error bars are the standard deviation times 1.96 and correspond to a 95 \\% confidence interval. The parameters are the same as in Fig. \\ref{fig:pop}.}\n    \\label{fig:work}\n\\end{figure}\n\n\nFor the setup, the work is obtained as the energy difference between the initial and final states of the qubit plus the heat released to the calorimeter. This yields the same result as the two-measurement protocol for the composite. As shown in Figs. \\ref{fig:work}(a) and (c), the finite size of the calorimeter causes the work distribution to deviate from the inifinite-size limit as overheating changes the transition rates.  The transition rates are strongly influenced by\nthe previous jumps for small values of $n$. This is illustrated in Fig. \\ref{fig:work}(c), where work values between $\\pm 5 \\hbar \\omega_0$ are more probable for small $n$. Independent of $n$, the work distributions were found to be consistent with the Jarzynski equality within the statistical errors, as shown in Fig. \\ref{fig:work}(d).\n\n\n\\emph{Conclusions}.---\nMeasurement and definition of work in driven open quantum systems poses an interesting theoretical and experimental challenge. \nIn the present work, we have considered the proposal of a calorimetric measurement that offers a simple and transparent way of\nmeasuring energy exchange between the system and the calorimeter. To be able to theoretically analyse a calorimetric\nsetup, we have developed a modified QJ model suitable for systems with a finite-size environment. \nWe have shown that  due to the finite size, the calorimeter is driven out of equilibrium leading to changes in the reduced system's \ndynamics and in the work statistics. These changes cannot be modelled with the standard QJ method which assumes that the\nwhole environment is an ideal heat bath. With the model, we have analytically and numerically shown that the standard fluctuation relations are still valid and remain unaltered by the finite size of the calorimeter.  This is in contrast to Ref. \\cite{jsm2013/P02033}, where the transition rates violate the detailed balance condition of Eq. \\eqref{eq:DBC2} (see Appendix B).\n\n\n\\acknowledgements\nWe wish to thank Jukka Pekola for suggesting this problem to us, and for useful discussions. We wish also to thank C. Jarzynski, P. Muratore-Ginanneschi and K. Schwieger for useful discussions and comments. This work was supported in part by the V\\\"ais\\\"al\\\"a foundation and the Academy of Finland through its Centres of Excellence Programme (2015-2017) under project number 284621. The numerical calculations were performed using computer resources of the Aalto University School of Science \"Science-IT\" project. \n\n\n\\bibliography{suomela2,localbib}\n\n\\appendix\n\\begin{widetext}\n\\section{Appendix A: Fluctuation theorem for the quantum jump model with a finite-size environment} \n\nLet us consider an open quantum system coupled to a calorimeter through dissipative channels described by jump operators $\\hat{D}_{m}=g_{m} \\hat A_m \\otimes \\hat B_{m}$, where $ \\hat A_m$ and $\\hat B_{m}$ depend on the system and calorimeter degrees of freedom, respectively, and $g_{m}$ is the coupling strength. We also assume that the jump operator follow detailed balance such that for every $\\hat D_{m}$ there is $\\hat D_{n}$ such that $\\hat A_n =\\hat A_m^\\dagger$ and $\\hat B_{n} =\\hat B_{m}^\\dagger$. Let us first study the case, where the calorimeter is in a single microstate ${\\mathinner{|{{\\Psi_k}}\\rangle}}$ and it does not change between the jumps. In this case, we can use the calorimeter traced jump operators $\\hat C_{m}=\\sqrt{\\Gamma_{m}(\\Psi_k)} \\hat{A}_m$ that are defined such that ${\\rm Tr}_{s} \\lbrace \\hat C_{m} \\hat \\sigma_s \\hat C^\\dagger_{m}   \\rbrace = {\\rm Tr}_{s+c} \\lbrace \\hat D_{m} \\hat \\sigma_s \\otimes {\\mathinner{|{{\\Psi_k}}\\rangle}} {\\mathinner{\\langle{{\\Psi_k}}|}}  \\hat D^\\dagger_{m}   \\rbrace$, where $\\hat \\sigma_s$ is the matrix form of the system state, $\\rm Tr_{s}$ denotes trace over the system degrees of freedom and $\\rm Tr_{s+c}$ denotes trace over both the system and calorimeter degrees of freedom. Due to the system-calorimeter energy change, the energy of the calorimeter evolves stochastically. The probability to traverse a single $N$-jump QJ trajectory is given by\n\\begin{eqnarray}\n&& P_{QJ}[i, f, \\Psi_0, \\Psi_N, \\{\\hat{C}_{m_k}\\}_{k=1}^N, \\{t_k\\}_{k=1}^N] \\nonumber \\\\ \n&&= P[i,\\Psi_0] \\left[ \\prod_{k=1}^N p^0(t_k,t_{k-1}) p_{m_k}(t_k)  \\right]  p^0(\\tau, t_N) P_f[f, \\Psi_N],\n\\label{Eq:PrF}\n\\end{eqnarray}\nwhere the protocol starts at time $t_0=0$ and ends at time $\\tau$, $P[i,\\Psi_0]$ is the probability to start with the system state ${\\mathinner{|{{i}}\\rangle}}$ and the calorimeter state ${\\mathinner{|{{\\Psi_0}}\\rangle}}$, $p_{m_k}(t_k)$ is the probability for a jump to occur along the $m_k$:th channel during $[t_k,t_k+\\delta t]$, and $p^0(t_{k+1},t_k)$ is the probability of no jump during the time-interval $[t_k,t_{k+1}]$ and $P_f[f, \\Psi_N]$ is the probability to measure the system state ${\\mathinner{|{{f}}\\rangle}}$ and the calorimeter state ${\\mathinner{|{{\\Psi_N}}\\rangle}}$ at the end of the protocol. As the jump probabilities can be calculated simply using the calorimeter traced jump operators, we can use the results derived for time-dependent jump operators \\cite{Suomela2015a}, yielding\n\\begin{eqnarray}\n&&P_{QJ}[i, f, \\Psi_0, \\Psi_N, \\{\\hat{C}_{m_k}\\}_{k=1}^N, \\{t_k\\}_{k=1}^N] \\nonumber  \\\\\n&&=  (\\delta t)^N P[i,\\Psi_0] \\left[\\prod_{k=1}^N \\Gamma_{m_k}(\\Psi_{k-1}) \\right] \\left\\lvert \\langle f | \\hat{U}_{\\mathrm{eff}}(\\tau,t_N) \\left[ \\prod_{k=1}^N \\hat{A}_{m_{N+1-k}}\\hat{U}_{\\mathrm{eff}}(t_{N+1-k},t_{N-k})\\right] |i \\rangle \\right\\rvert^2,\n\\label{Eq:Pr1}\n\\end{eqnarray}\n\nwhere ${\\mathinner{|{{\\Psi_k}}\\rangle}}$ is the calorimeter state after $k$:th jump and the no-jump evolution is given by\n\n", "index": 9, "text": "\\begin{equation}\n\\hat{U}_{\\mathrm{eff}}(t_{k+1},t_{k})= \\mathcal{T} \\exp \\left[ -\\frac{i}{\\hbar}\\int_{t_{k}}^{t_{k+1}} \\hat{H}_s(t)-i \\frac{\\hbar}{2} \\sum_{i} \\Gamma_i(\\Psi_k)  \\hat{A}_i^{\\dagger}\\hat{A}_i dt \\right],\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"\\hat{U}_{\\mathrm{eff}}(t_{k+1},t_{k})=\\mathcal{T}\\exp\\left[-\\frac{i}{\\hbar}%&#10;\\int_{t_{k}}^{t_{k+1}}\\hat{H}_{s}(t)-i\\frac{\\hbar}{2}\\sum_{i}\\Gamma_{i}(\\Psi_{%&#10;k})\\hat{A}_{i}^{\\dagger}\\hat{A}_{i}dt\\right],\" display=\"block\"><mrow><mrow><mrow><msub><mover accent=\"true\"><mi>U</mi><mo stretchy=\"false\">^</mo></mover><mi>eff</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>t</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mi class=\"ltx_font_mathcaligraphic\">\ud835\udcaf</mi><mo>\u2062</mo><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo>[</mo><mrow><mrow><mo>-</mo><mrow><mfrac><mi>i</mi><mi mathvariant=\"normal\">\u210f</mi></mfrac><mo>\u2062</mo><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><msub><mi>t</mi><mi>k</mi></msub><msub><mi>t</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></msubsup><mrow><msub><mover accent=\"true\"><mi>H</mi><mo stretchy=\"false\">^</mo></mover><mi>s</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow><mo>-</mo><mrow><mi>i</mi><mo>\u2062</mo><mfrac><mi mathvariant=\"normal\">\u210f</mi><mn>2</mn></mfrac><mo>\u2062</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mi>i</mi></munder><mrow><msub><mi mathvariant=\"normal\">\u0393</mi><mi>i</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"normal\">\u03a8</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msubsup><mover accent=\"true\"><mi>A</mi><mo stretchy=\"false\">^</mo></mover><mi>i</mi><mo>\u2020</mo></msubsup><mo>\u2062</mo><msub><mover accent=\"true\"><mi>A</mi><mo stretchy=\"false\">^</mo></mover><mi>i</mi></msub><mo>\u2062</mo><mi>d</mi><mo>\u2062</mo><mi>t</mi></mrow></mrow></mrow></mrow><mo>]</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05317.tex", "nexttext": "\nwhere $\\bar{P}[f,\\Psi_N]$ is the probability to start a reversed trajectory with the system state ${\\mathinner{|{{f}}\\rangle}}$ and the calorimeter state ${\\mathinner{|{{\\Psi_N}}\\rangle}}$. The ratio of the forward and reversed trajectory probabilities is of the form:\n\n", "itemtype": "equation", "pos": 30124, "prevtext": "\n where $\\hat{H}_s(t)$ is the system Hamiltonian and $\\mathcal{T}$ is the time-ordering operator.\n\nWe can formulate a time-reversed counterpart for the forward trajectory of Eq. \\eqref{Eq:PrF}. In the time-reversed trajectory, we measure system state ${\\mathinner{|{{f}}\\rangle}}$ and calorimeter state ${\\mathinner{|{{\\Psi_N}}\\rangle}}$ at the beginning ($\\bar{t} = 0$) and states ${\\mathinner{|{{i}}\\rangle}}$ and ${\\mathinner{|{{\\Psi_0}}\\rangle}}$ at the end ($\\bar{t}=\\tau$). In the time-reversed trajectory, all the jumps are reversed and they happen in reverse order, i.e., a jump caused by $\\hat C_{\\bar{m}_k}$ occurs at time  $\\bar{t} = t_{f}-t_{k}$, where the index $\\bar{m}_k$ is related to the forward index $m_k$ such that $\\hat A_{\\bar{m}_k}=\\hat{A}^\\dagger_{m_k}$ and $\\hat B_{\\bar{m}_k}=\\hat{B}^\\dagger_{m_k}$. By demanding that the time-reversed no-jump evolution between jumps is given by $\\hat{U}_{\\mathrm{eff}}^\\dagger(t_{i+1},t_{i})$, the probability for the reverse QJ trajectory can then be written as \n\n", "index": 11, "text": "\\begin{equation}\n\\begin{split}\n&\\bar{P}_{QJ}[f, i, \\Psi_N, \\Psi_0, \\{\\hat{C}_{\\bar{m}_k}\\}_{k=1}^N, \\{\\bar{t}_k\\}_{k=1}^N] \\\\\n&=  (\\delta t)^N \\bar{P}[f,\\Psi_N] \\left[ \\prod_{k=1}^N {\\Gamma}_{\\bar{m}_k}(\\Psi_{k}) \\right] \\left\\lvert  \\langle i | \\left[ \\prod_{k=1}^N \\hat{U}^\\dagger_{\\mathrm{eff}}(t_{k},t_{k-1}) \\hat{A}^\\dagger_{m_{k}}  \\right]  \\hat{U}^\\dagger_{\\mathrm{eff}}(\\tau,t_{N})| f \\rangle \\right\\rvert^2,\n\\label{Eq:Pr1}\n\\end{split}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"\\split&amp;\\bar{P}_{QJ}[f,i,\\Psi_{N},\\Psi_{0},\\{\\hat{C}_{\\bar{m}_{k}}\\}_{k=1}^{N},%&#10;\\{\\bar{t}_{k}\\}_{k=1}^{N}]\\\\&#10;&amp;=(\\delta t)^{N}\\bar{P}[f,\\Psi_{N}]\\left[\\prod_{k=1}^{N}{\\Gamma}_{\\bar{m}_{k}}%&#10;(\\Psi_{k})\\right]\\left\\lvert\\langle i|\\left[\\prod_{k=1}^{N}\\hat{U}^{\\dagger}_{%&#10;\\mathrm{eff}}(t_{k},t_{k-1})\\hat{A}^{\\dagger}_{m_{k}}\\right]\\hat{U}^{\\dagger}_%&#10;{\\mathrm{eff}}(\\tau,t_{N})|f\\rangle\\right\\rvert^{2},\" display=\"block\"><mrow><mrow><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>{split}</mtext></merror><mo>\u2062</mo><mi mathvariant=\"normal\">&amp;</mi><mo>\u2062</mo><msub><mover accent=\"true\"><mi>P</mi><mo stretchy=\"false\">\u00af</mo></mover><mrow><mi>Q</mi><mo>\u2062</mo><mi>J</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>f</mi><mo>,</mo><mi>i</mi><mo>,</mo><msub><mi mathvariant=\"normal\">\u03a8</mi><mi>N</mi></msub><mo>,</mo><msub><mi mathvariant=\"normal\">\u03a8</mi><mn>0</mn></msub><mo>,</mo><msubsup><mrow><mo stretchy=\"false\">{</mo><msub><mover accent=\"true\"><mi>C</mi><mo stretchy=\"false\">^</mo></mover><msub><mover accent=\"true\"><mi>m</mi><mo stretchy=\"false\">\u00af</mo></mover><mi>k</mi></msub></msub><mo stretchy=\"false\">}</mo></mrow><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo>,</mo><msubsup><mrow><mo stretchy=\"false\">{</mo><msub><mover accent=\"true\"><mi>t</mi><mo stretchy=\"false\">\u00af</mo></mover><mi>k</mi></msub><mo stretchy=\"false\">}</mo></mrow><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo stretchy=\"false\">]</mo></mrow><mo>\u2062</mo><mi mathvariant=\"normal\">&amp;</mi></mrow><mo>=</mo><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mi>\u03b4</mi><mo>\u2062</mo><mi>t</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mi>N</mi></msup><mo>\u2062</mo><mover accent=\"true\"><mi>P</mi><mo stretchy=\"false\">\u00af</mo></mover><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>f</mi><mo>,</mo><msub><mi mathvariant=\"normal\">\u03a8</mi><mi>N</mi></msub><mo stretchy=\"false\">]</mo></mrow><mo>\u2062</mo><mrow><mo>[</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u220f</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow><msub><mi mathvariant=\"normal\">\u0393</mi><msub><mover accent=\"true\"><mi>m</mi><mo stretchy=\"false\">\u00af</mo></mover><mi>k</mi></msub></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"normal\">\u03a8</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>]</mo></mrow><mo>\u2062</mo><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\lvert</mtext></merror><mo>\u2062</mo><mrow><mo stretchy=\"false\">\u27e8</mo><mi>i</mi><mo fence=\"true\" stretchy=\"false\">|</mo><mrow><mrow><mo>[</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u220f</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow><msubsup><mover accent=\"true\"><mi>U</mi><mo stretchy=\"false\">^</mo></mover><mi>eff</mi><mo>\u2020</mo></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mi>k</mi></msub><mo>,</mo><msub><mi>t</mi><mrow><mi>k</mi><mo>-</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msubsup><mover accent=\"true\"><mi>A</mi><mo stretchy=\"false\">^</mo></mover><msub><mi>m</mi><mi>k</mi></msub><mo>\u2020</mo></msubsup></mrow></mrow><mo>]</mo></mrow><mo>\u2062</mo><msubsup><mover accent=\"true\"><mi>U</mi><mo stretchy=\"false\">^</mo></mover><mi>eff</mi><mo>\u2020</mo></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c4</mi><mo>,</mo><msub><mi>t</mi><mi>N</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo fence=\"true\" stretchy=\"false\">|</mo><mi>f</mi><mo stretchy=\"false\">\u27e9</mo></mrow><mo>\u2062</mo><msup><merror class=\"ltx_ERROR undefined undefined\"><mtext>\\rvert</mtext></merror><mn>2</mn></msup></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.05317.tex", "nexttext": "\nWe denote this term as the total entropy production of the model. As the reversed trajectories' probabilities sum up to unity, it can be straightforwardly shown that\n\n", "itemtype": "equation", "pos": 30852, "prevtext": "\nwhere $\\bar{P}[f,\\Psi_N]$ is the probability to start a reversed trajectory with the system state ${\\mathinner{|{{f}}\\rangle}}$ and the calorimeter state ${\\mathinner{|{{\\Psi_N}}\\rangle}}$. The ratio of the forward and reversed trajectory probabilities is of the form:\n\n", "index": 13, "text": "\\begin{equation}\n\\begin{split}\n&\\Delta S_{Tot}[i, f, \\Psi_0, \\Psi_N, \\{\\hat{C}_{m_k}\\}_{k=1}^N, \\{t_k\\}_{k=1}^N] \\\\ &= \\ln \\left[ \\frac{P_{QJ}[i, f, \\Psi_0, \\Psi_N, \\{\\hat{C}_{m_k}\\}_{k=1}^N, \\{t_k\\}_{k=1}^N]}{\\bar{P}_{QJ}[f, i, \\Psi_N, \\Psi_0, \\{\\hat{C}_{\\bar{m}_k}\\}_{k=1}^N, \\{\\bar{t}_k\\}_{k=1}^N] } \\right] \\\\\n&=\\ln \\left\\lbrace  \\frac{P[i,\\Psi_0]}{\\bar{P}[f,\\Psi_N]}\\right\\rbrace+\\ln \\left[ \\prod_{k=1}^{N} \\frac{\\Gamma_{m_k}(\\Psi_{k-1})}{\\Gamma_{\\bar{m}_k}(\\Psi_{k})}  \\right].\n\\end{split}\n\\label{Eq:R}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"\\split&amp;\\Delta S_{Tot}[i,f,\\Psi_{0},\\Psi_{N},\\{\\hat{C}_{m_{k}}\\}_{k=1}^{N},\\{t_%&#10;{k}\\}_{k=1}^{N}]\\\\&#10;&amp;=\\ln\\left[\\frac{P_{QJ}[i,f,\\Psi_{0},\\Psi_{N},\\{\\hat{C}_{m_{k}}\\}_{k=1}^{N},\\{%&#10;t_{k}\\}_{k=1}^{N}]}{\\bar{P}_{QJ}[f,i,\\Psi_{N},\\Psi_{0},\\{\\hat{C}_{\\bar{m}_{k}}%&#10;\\}_{k=1}^{N},\\{\\bar{t}_{k}\\}_{k=1}^{N}]}\\right]\\\\&#10;&amp;=\\ln\\left\\{\\frac{P[i,\\Psi_{0}]}{\\bar{P}[f,\\Psi_{N}]}\\right\\}+\\ln\\left[\\prod_{%&#10;k=1}^{N}\\frac{\\Gamma_{m_{k}}(\\Psi_{k-1})}{\\Gamma_{\\bar{m}_{k}}(\\Psi_{k})}%&#10;\\right].\" display=\"block\"><mrow><mrow><mrow><merror class=\"ltx_ERROR undefined undefined\"><mtext>{split}</mtext></merror><mo>\u2062</mo><mi mathvariant=\"normal\">&amp;</mi><mo>\u2062</mo><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msub><mi>S</mi><mrow><mi>T</mi><mo>\u2062</mo><mi>o</mi><mo>\u2062</mo><mi>t</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>i</mi><mo>,</mo><mi>f</mi><mo>,</mo><msub><mi mathvariant=\"normal\">\u03a8</mi><mn>0</mn></msub><mo>,</mo><msub><mi mathvariant=\"normal\">\u03a8</mi><mi>N</mi></msub><mo>,</mo><msubsup><mrow><mo stretchy=\"false\">{</mo><msub><mover accent=\"true\"><mi>C</mi><mo stretchy=\"false\">^</mo></mover><msub><mi>m</mi><mi>k</mi></msub></msub><mo stretchy=\"false\">}</mo></mrow><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo>,</mo><msubsup><mrow><mo stretchy=\"false\">{</mo><msub><mi>t</mi><mi>k</mi></msub><mo stretchy=\"false\">}</mo></mrow><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo stretchy=\"false\">]</mo></mrow><mo>\u2062</mo><mi mathvariant=\"normal\">&amp;</mi></mrow><mo>=</mo><mrow><mrow><mi>ln</mi><mo>\u2061</mo><mrow><mo>[</mo><mfrac><mrow><msub><mi>P</mi><mrow><mi>Q</mi><mo>\u2062</mo><mi>J</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>i</mi><mo>,</mo><mi>f</mi><mo>,</mo><msub><mi mathvariant=\"normal\">\u03a8</mi><mn>0</mn></msub><mo>,</mo><msub><mi mathvariant=\"normal\">\u03a8</mi><mi>N</mi></msub><mo>,</mo><msubsup><mrow><mo stretchy=\"false\">{</mo><msub><mover accent=\"true\"><mi>C</mi><mo stretchy=\"false\">^</mo></mover><msub><mi>m</mi><mi>k</mi></msub></msub><mo stretchy=\"false\">}</mo></mrow><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo>,</mo><msubsup><mrow><mo stretchy=\"false\">{</mo><msub><mi>t</mi><mi>k</mi></msub><mo stretchy=\"false\">}</mo></mrow><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo stretchy=\"false\">]</mo></mrow></mrow><mrow><msub><mover accent=\"true\"><mi>P</mi><mo stretchy=\"false\">\u00af</mo></mover><mrow><mi>Q</mi><mo>\u2062</mo><mi>J</mi></mrow></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>f</mi><mo>,</mo><mi>i</mi><mo>,</mo><msub><mi mathvariant=\"normal\">\u03a8</mi><mi>N</mi></msub><mo>,</mo><msub><mi mathvariant=\"normal\">\u03a8</mi><mn>0</mn></msub><mo>,</mo><msubsup><mrow><mo stretchy=\"false\">{</mo><msub><mover accent=\"true\"><mi>C</mi><mo stretchy=\"false\">^</mo></mover><msub><mover accent=\"true\"><mi>m</mi><mo stretchy=\"false\">\u00af</mo></mover><mi>k</mi></msub></msub><mo stretchy=\"false\">}</mo></mrow><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo>,</mo><msubsup><mrow><mo stretchy=\"false\">{</mo><msub><mover accent=\"true\"><mi>t</mi><mo stretchy=\"false\">\u00af</mo></mover><mi>k</mi></msub><mo stretchy=\"false\">}</mo></mrow><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo stretchy=\"false\">]</mo></mrow></mrow></mfrac><mo>]</mo></mrow></mrow><mo>\u2062</mo><mi mathvariant=\"normal\">&amp;</mi></mrow><mo>=</mo><mrow><mrow><mi>ln</mi><mo>\u2061</mo><mrow><mo>{</mo><mfrac><mrow><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>i</mi><mo>,</mo><msub><mi mathvariant=\"normal\">\u03a8</mi><mn>0</mn></msub><mo stretchy=\"false\">]</mo></mrow></mrow><mrow><mover accent=\"true\"><mi>P</mi><mo stretchy=\"false\">\u00af</mo></mover><mo>\u2062</mo><mrow><mo stretchy=\"false\">[</mo><mi>f</mi><mo>,</mo><msub><mi mathvariant=\"normal\">\u03a8</mi><mi>N</mi></msub><mo stretchy=\"false\">]</mo></mrow></mrow></mfrac><mo>}</mo></mrow></mrow><mo>+</mo><mrow><mi>ln</mi><mo>\u2061</mo><mrow><mo>[</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u220f</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mfrac><mrow><msub><mi mathvariant=\"normal\">\u0393</mi><msub><mi>m</mi><mi>k</mi></msub></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"normal\">\u03a8</mi><mrow><mi>k</mi><mo>-</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><msub><mi mathvariant=\"normal\">\u0393</mi><msub><mover accent=\"true\"><mi>m</mi><mo stretchy=\"false\">\u00af</mo></mover><mi>k</mi></msub></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"normal\">\u03a8</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mrow><mo>]</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.05317.tex", "nexttext": "\nwhere the average is over all the forward trajectories.\n\nAs discussed in the main text, the transition rates satisfy the condition $\\Gamma_{\\bar{m}_k}(\\Psi_{k})=\\Gamma_{m_k}(\\Psi_{k-1})$ when the calorimeter is assumed to be in a single microstate. As a consequence, the second term of Eq. \\eqref{Eq:R} is zero and the entropy production depends only on the forward and reversed trajectory initial probability distributions. If the initial probability distribution of the forward trajectory follows canonical ensemble, the probability distribution of the reversed trajectories can be chosen to follow a canonical ensemble with the same temperature. In this case, the total entropy production becomes equivalent with the energy difference between the initial and final state of the total system. By defining the work of a single trajectory as the energy difference between the initial and final state of the total system, Eq. \\eqref{Eq:EFT} gives the Jarzynski equality.\n\nIf the relaxation rate inside the calorimeter is the fastest time scale, then the calorimeter does not stay in a single microstate between jumps but shifts quickly between the microstates  ${\\mathinner{|{{\\Psi_k}}\\rangle}}$ that correspond to the same energy. We can still derive a theorem similar to Eq. \\eqref{Eq:R} with $\\Psi_k$ denoting calorimeter energies instead of states. The transition rates are then given by Eqs. \\eqref{ETR1} and \\eqref{ETR2} of the main text.  In this case, the product of the transition rate ratio gives $N(E_0)/N(E_N)$ in Eq. \\eqref{Eq:R}, where  $E_0$ and $E_N$ are the initial and final energies of the calorimeter, respectively, and $N(E)$ denotes the number of microstates corresponding energy $E$. If both the forward and backward process start from the canonical ensemble, i.e., $ P[i,E_0]=N(E_0) e^{-\\beta ( \\hbar \\omega_i+E_0)}/{Z}$ and $\\bar{P}[f,E_N]=N(E_N) e^{-\\beta ( \\hbar \\omega_f+E_N)}/{Z^\\prime}$, we get again the Jarzynski equality with $\\Delta F = - (1/\\beta) \\ln (Z^\\prime/Z)$. Here, $\\hbar \\omega_i$ and $\\hbar \\omega_f$ denote the energies of  system states ${\\mathinner{|{{i}}\\rangle}}$ and ${\\mathinner{|{{f}}\\rangle}}$, respectively.\n\n\\section{Appendix B: Detailed balance condition for the transition rates}\n\nWhen the energy fluctuations are small in the canonical ensemble, they are often approximated by a gaussian distribution around the average energy $E_0$. If the heat capacity $C$ is constant, these energy fluctuations are often expressed as the effective temperature fluctuations $T=E/C$ in mesoscopic systems \\cite{Landau1980statistical,PhysRevLett.102.130605,jsm2013/P02033}. We will now show that the assumption of a constant heat capacity can lead to violation of the main text's Eq. \\eqref{eq:DBC2} when temperature fluctuations $T$ are used together with the standard temperature-dependent transition rates \n \\begin{eqnarray}\n\\Gamma_{\\downarrow}(\\hbar \\omega_0 ,T(E))= g/(1\\pm e^{-\\hbar \\omega_0/(k_BT)}), \\label{eq:TR1}\\\\\n\\Gamma_{\\uparrow}(\\hbar \\omega_0 ,T(E))= g/(e^{\\hbar \\omega_0/(k_BT)} \\pm 1), \\label{eq:TR2}\n\\end{eqnarray}\nwhere $g$ is the coupling strength, $\\hbar \\omega_0$ is the energy gap of the qubit, $T(E)$ is the effective temperature corresponding to the calorimeter energy $E$ and $+$ $(-)$ is used in the case bosonic (fermionic) transition rates. If a jump up occurs in the qubit, the energy of the calorimeter decreases by $\\hbar \\omega_0$ and consequently the effective temperature decreases by $\\hbar \\omega_0/C$. \n\nFor Gaussian energy fluctuations, the left-hand side of Eq. \\eqref{eq:DBC2} simplifies to\n\\begin{eqnarray}\n\\frac{N(E)}{N(E-\\hbar \\omega_0)}=e^{\\hbar \\omega_0\\left \\lbrace { \\beta +\\left[-\\hbar \\omega_0 +2(E-E_0) \\right] /(2\\sigma^2)}\\right \\rbrace}, \\label{eq:A2Ns}\n\\end{eqnarray}\nwhere $N(E)$ and $N(E-\\hbar \\omega_0)$ are the number of microstates corresponding to calorimeter energy $E$ and $E-\\hbar \\omega_0$, respectively, $\\beta$ is the inverse temperature of the ideal bath that is used to thermalized both the qubit and the calorimeter and $\\sigma^2=C k_B^{-1} \\beta^{-2} $ is the variance of the gaussian calorimeter energy distribution. However, if now the transition rates of Eqs. \\eqref{eq:TR1}-\\eqref{eq:TR2} are used, the right-hand side of Eq. \\eqref{eq:DBC2} does not agree with Eq. \\eqref{eq:A2Ns} and thus the detailed balance condition is not satisfied. This explains the apparent violations of Jarzynski equality in Ref. \\cite{jsm2013/P02033}, where similar type of transition rates were used with gaussian effective temperature fluctuations and constant heat capacity.\n\n\\end{widetext}\n\n\n", "itemtype": "equation", "pos": 31542, "prevtext": "\nWe denote this term as the total entropy production of the model. As the reversed trajectories' probabilities sum up to unity, it can be straightforwardly shown that\n\n", "index": 15, "text": "\\begin{equation}\n\\langle e^{-\\Delta S_{Tot}} \\rangle = 1, \\label{Eq:EFT}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m1\" class=\"ltx_Math\" alttext=\"\\langle e^{-\\Delta S_{Tot}}\\rangle=1,\" display=\"block\"><mrow><mrow><mrow><mo stretchy=\"false\">\u27e8</mo><msup><mi>e</mi><mrow><mo>-</mo><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>\u2062</mo><msub><mi>S</mi><mrow><mi>T</mi><mo>\u2062</mo><mi>o</mi><mo>\u2062</mo><mi>t</mi></mrow></msub></mrow></mrow></msup><mo stretchy=\"false\">\u27e9</mo></mrow><mo>=</mo><mn>1</mn></mrow><mo>,</mo></mrow></math>", "type": "latex"}]