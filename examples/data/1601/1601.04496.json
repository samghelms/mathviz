[{"file": "1601.04496.tex", "nexttext": "\nwhere $\\Omega=\\left\\{ x\\in\\mathbb{R}^{2}:\\left\\Vert x\\right\\Vert <R\\right\\} $\nwith $R>0$ the radius of the considered domain. The real part $n$\ndescribes the optical path length of the material, whereas the imaginary\npart $\\kappa$ models the material-dependent absorption. The transmission\ncoefficient $\\tau=I/I_{0}$ and the path difference $d=c_{0}(T-T_{0})$\nare available as measured data, with $I_{0}$ the initial intensity,\n$I$ the intensity at the detector, $T$ the travel time with and\n$T_{0}$ without an object in the ray path and $c_{0}$ the speed\nof light. The real part of the complex refractive index is the quotient\nof the speed of light $c_{0}$ and the propagation speed  $c_{M}$\ninside the medium, \n\n\n", "itemtype": "equation", "pos": 10941, "prevtext": "\n\n\\title{A modified algebraic reconstruction technique taking refraction into\naccount with an application in terahertz tomography}\n\n\n\\author{Jens Tepe\\thanks{Department of Mathematics, Saarland University, PO Box 15 11 50, 66041\nSaarbr\\\"ucken, Germany (jens.tepe@num.uni-sb.de)},\\; Thomas Schuster\\thanks{Department of Mathematics, Saarland University, PO Box 15 11 50, 66041\nSaarbr\\\"ucken, Germany (thomas.schuster@num.uni-sb.de), correspondent\nauthor.}\\; and Benjamin Littau\\thanks{German Plastics Center, 97076 W\\\"urzburg, Germany (b.littau@skz.de)}}\n\n\n\\date{~\\vspace{-1cm}\n}\n\n\\maketitle\n\n\\paragraph*{Key words and phrases.}\n\nterahertz tomography, nondestructive testing, algebraic reconstruction\ntechnique (ART), reflection losses, refractive index, Snell's law\n\n\n\\section*{Abstract}\n\n{\\footnotesize{}Terahertz (THz) tomography is a rather novel technique\nfor nondestructive testing that is particularly suited for the testing\nof plastics and ceramics. Previous publications showed a large variety\nof conventional algorithms adapted from computed tomography or ultrasound\ntomography which were directly applied to THz tomography. Conventional\nalgorithms neglect the specific nature of THz radiation, i.~e.~refraction\nat interfaces, reflection losses and the beam profile (Gaussian beam),\nwhich results in poor reconstructions.  The aim is the efficient\nreconstruction of the complex refractive index, since it indicates inhomogeneities\nin the material. A hybrid algorithm has been developed based on the\nalgebraic reconstruction technique (ART). ART is adapted by including\nrefraction (Snell's law) and reflection losses (Fresnel equations). Our method\nuses a priori information about the interface and layer geometry\nof the sample. This results in the ``Modified ART for THz tomography'',\nwhich reconstructs simultaneously the complex refractive index from\ntransmission coefficient and travel time measurements.}{\\footnotesize \\par}\n\n\n\\section{Introduction}\n\nTerahertz (THz) radiation has become increasingly popular for nondestructive\ntesting of plastics and ceramics in recent years. With a frequency\nrange between $100\\,\\mathrm{GHz}$ to $10\\,\\mathrm{THz}$, this radiation\nis situated between microwaves and infrared light within the electromagnetic\nspectrum. Thus, in terms of the wavelength, THz radiation shows elements\nof ray character (X-ray CT) as well as of wave character (ultrasound\ntomography). As a result,  the wave character cannot be completely\nneglected. While plastics and ceramics are almost transparent in\nthis frequency range, THz radiation cannot easily penetrate water,\nmetals and conductive materials. Because of its relatively long wave\nlength compared to X-rays, THz radiation has a limited lateral\nresolution. However, by using modulated THz radiation, information\nabout both phase and amplitude are available as measured data in contrast\nto conventional tomographic methods \\cite{Krumbholz2009}. \n\nThe inverse problem of THz tomography consists of determining dielectric\nproperties (i.~e.~refractive index $n$ and absorption coefficient\n$\\alpha$) of the material from phase and amplitude information of\nthe THz radiation, which admits finding material characteristics such\nas filler content or the detection of cracks and air cavities. For\nan overview on the relatively new field of tomographic methods using\nTHz radiation, see Wang et~al.~\\cite{Wang2004}, Guillet et~al.~\\cite{Guillet2014}\nand Ferguson \\cite{Ferguson2004,Ferguson2002}. Published results\ncan be divided into transmission or reflection tomographic methods\nbased on the available measured data. The adaption of computed tomography\nmethods \\cite{Kak1979,Natterer2001} to the THz range is widely distributed\n\\cite{Brahm2010,Ewers2009,Ferguson2002,Jewariya2013,Nguyen2006,Wang2004}.\nHere a very simplified propagation along straight lines is used with\nthe Radon transform as mathematical model. However, physical effects\nsuch as refraction, diffraction, edge effects and the Gaussian beam\nprofile have an influence on THz measurements \\cite{Brahm2014}. Some\npublications consider these effects by adaptations. In \\cite{Recur2012},\nRecur et~al.~presented a filtered backprojection and adapted iterative\nmethods (SART, OSEM) for 3D THz CT, which considers the intensity\ndistribution of THz rays (Gaussian beam). Mukherjee et~al.~only\nregard cylindric objects, but take Fresnel reflection losses and beam\nsteering losses into account, see \\cite{Mukherjee2013}. Furthermore,\nFerguson et~al.~\\cite{Ferguson2002} and Wang et~al.~\\cite{Wang2004}\nreconstruct the refractive index using measurements of the diffracted\nTHz field based on the Helmholtz equation (so-called T-ray Diffraction\nTomography, analogous to ultrasound tomography, see \\cite{Colton2000,Colton2013}). \n\nDue to the long wavelength of THz radiation compared to X-rays (for\na frequency of $f=0.1\\,\\mathrm{THz}$, the wavelength is approx. $\\lambda=3\\,\\mathrm{mm}$),\nwave phenomena need to be taken into account in the modeling of the\nmeasurement process. On the other hand, a more precise model leads\nto a computationally more intensive solution. Our task is to find\na balance between both. \n\nIn the following we present a novel, hybrid algorithm for THz tomography.\nThe algorithm is developed for a tomograph designed for medium-sized\ncompanies, which demands a short runtime. Because of that we search\nfor an efficient solution of the inverse problem by considering only\ndominating effects. \n\nThe radiation from a THz source behaves ideally as a Gaussian beam\nand can be modeled by the wave equation or, if we are only interested\nin the intensity, by the Helmholtz equation. The transverse intensity\nprofile is well approximated by Gaussian functions (see figure \\ref{fig:3D-presentation-Gaussian-Beam}).\nHowever, the solution of the Helmholtz equation is very time-consuming.\nThe wave length is significantly smaller than in the case of acoustic\nwaves, forcing a fine discretization of the domain of interest. This\nprevents an efficient solution with ultrasound tomography algorithms.\nHence, our goal is a new algorithm not based on the solution of wave\nor Helmholtz equation, but still taking into account the main physical\neffects. These are primarily transmission, refraction at interfaces,\nreflection losses and the Gaussian beam profile (see figure \\ref{fig:Helmholtz-broken-ray}).\n\\begin{figure}\n\\noindent \\hfill{}\\subfloat[3D representation of the Gaussian beam \\label{fig:3D-presentation-Gaussian-Beam} ]{\n\n\\includegraphics[width=0.45\\textwidth]{Gauss_3D}}\\hfill{}\\subfloat[Simulation of the electric field of an object consisting of polyethylene\n($\\tilde{n}=1.51+0.023i$) \\label{fig:Helmholtz-broken-ray}]{\n\n\\includegraphics[width=0.5\\textwidth]{PE_Plate_40deg_8mm}}\\hfill{}\\caption{THz radiation for $f=90\\,\\mathrm{GHz}$ propagating from bottom to\ntop as a simulation based on the Helmholtz equation \\label{fig:THz-radiation-simulation}}\n\\end{figure}\n In the following we will neglect the Gaussian beam profile for the\nsake of simplicity.\n\nThe THz tomography system used for this work provides intensity data,\nanalogous to the conventional transmission tomography, as well as\n(delayed) travel times or path differences, as in ultrasound technology.\nThe reconstruction algorithm described here uses travel time and transmission\ndata simultaneously to reconstruct the material parameters refractive\nindex and absorption coefficient. Therefore, we adapt the algebraic\nreconstruction technique (ART, see \\cite{Gordon1970}) to our physical\nconditions by taking into account refraction at the interfaces of\nthe object according to Snell's law and including the reflection losses\ngiven by the Fresnel equations. For this, we need some a priori information\non the object's interfaces. \n\nThis approach is comparable to those in ultrasound CT and ultrasound\nvector field tomography, where reconstructions from travel time measurements\nare improved by considering ray paths which take deflection of the\nray into account. In ultrasound CT, the ray paths are computed by\nsolving the eikonal equation (ray tracing) \\cite{Andersen1982,Schomberg1978,Smith1980}.\nThis approach unfortunately requires a continuously differentiable\nrefractive index and thus a smoothing of any discontinuities of the\nrefractive index at interfaces. Furthermore, it is necessary to solve\na nonlinear partial differential equation of first order. Ray tracing\nalgorithms were successfully combined with algebraic reconstruction\ntechniques (ART, SART) \\cite{Andersen1987,Andersen1991,Denis1995}.\nThese algorithms work well, if discontinuities are smaller than $10-20\\%$\nrefractive index deviation \\cite{Andersen1990,Denis1995}. In THz\ntomography, these deviations at interfaces are even higher compared\nto ultrasound tomography (about $50\\%$). Therefore, refraction at\ninterfaces can be assumed as a dominating effect in THz tomography. \n\nIn ultrasound vector field tomography, signals travel along geodesic\ncurves of a Riemannian metric, which is associated with the refractive\nindex according to Fermat's principle \\cite{Schroeder2015,Pfitzenreiter2011}.\nThe inverse problem consists of determining the refractive index from\nintegrals along geodesics curves from ultrasound time-of-flight (TOF)\nmeasurements. In both, THz tomography and ultrasound vector field\ntomography, the ray path resp.~geodesic curve depends on the unknown\nrefractive index.\n\n The algorithm presented here allows discontinuities in the refractive\nindex and includes the change of direction of the rays at interfaces\nby a direct application of Snell's law. \n\nThe paper is organized as follows. In the next section we briefly\nrecall the mathematical model for the 2D THz transmission and travel\ntime tomography. Subsequently, the notation of the a priori given\ninterfaces and a brief description of the physical model, especially\nthe Fresnel equations and Snell's law, will be discussed. In Section\n\\ref{sub:ray-path-depending-on-refraction} we derive a description\nof ray paths considering refraction. Section \\ref{sec:algorithm-development}\ndeals with the development of the new algorithm, beginning with a\nbrief revision of the conventional ART. Based on ART, we introduce\nthe modified ART for THz tomography and its implementation. Eventually,\nthe validation of the modified ART and its implementation are to be\nfound in section \\ref{sec:Numerical-experiments} using synthetic\nas well as real measured data, comparing our algorithm with the filtered\nbackprojection (FBP) and conventional ART. We conclude the paper with\na summary of the main results and an outlook for future work and potential\nimprovements.\n\n\n\\section{The mathematical model of 2D THz tomography\\label{sec:Mathematical-model}}\n\nWe consider 2D THz transmission and travel time tomography with standard\nparallel scanning geometry. The main task is the reconstruction of\nan object characterized by the complex refractive index $\\tilde{n}:\\Omega\\rightarrow\\mathbb{C}$\nwith\n\n", "index": 1, "text": "\\begin{equation}\n\\tilde{n}(x)=n(x)+i\\kappa(x),\\qquad x\\in\\Omega,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"\\tilde{n}(x)=n(x)+i\\kappa(x),\\qquad x\\in\\Omega,\" display=\"block\"><mrow><mrow><mrow><mrow><mover accent=\"true\"><mi>n</mi><mo stretchy=\"false\">~</mo></mover><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>n</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mi>i</mi><mo>\u2062</mo><mi>\u03ba</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo rspace=\"22.5pt\">,</mo><mrow><mi>x</mi><mo>\u2208</mo><mi mathvariant=\"normal\">\u03a9</mi></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nThis means the (delayed) travel time is physically related to real\npart of $\\tilde{n}$. The imaginary part \n\n\n", "itemtype": "equation", "pos": 11735, "prevtext": "\nwhere $\\Omega=\\left\\{ x\\in\\mathbb{R}^{2}:\\left\\Vert x\\right\\Vert <R\\right\\} $\nwith $R>0$ the radius of the considered domain. The real part $n$\ndescribes the optical path length of the material, whereas the imaginary\npart $\\kappa$ models the material-dependent absorption. The transmission\ncoefficient $\\tau=I/I_{0}$ and the path difference $d=c_{0}(T-T_{0})$\nare available as measured data, with $I_{0}$ the initial intensity,\n$I$ the intensity at the detector, $T$ the travel time with and\n$T_{0}$ without an object in the ray path and $c_{0}$ the speed\nof light. The real part of the complex refractive index is the quotient\nof the speed of light $c_{0}$ and the propagation speed  $c_{M}$\ninside the medium, \n\n\n", "index": 3, "text": "\\begin{equation}\nn(x)=\\frac{c_{0}}{c_{M}(x)},\\qquad x\\in\\Omega,\\,c_{M}>0.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"n(x)=\\frac{c_{0}}{c_{M}(x)},\\qquad x\\in\\Omega,\\,c_{M}&gt;0.\" display=\"block\"><mrow><mrow><mrow><mrow><mi>n</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mfrac><msub><mi>c</mi><mn>0</mn></msub><mrow><msub><mi>c</mi><mi>M</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mrow><mo rspace=\"22.5pt\">,</mo><mrow><mrow><mi>x</mi><mo>\u2208</mo><mi mathvariant=\"normal\">\u03a9</mi></mrow><mo rspace=\"4.2pt\">,</mo><mrow><msub><mi>c</mi><mi>M</mi></msub><mo>&gt;</mo><mn>0</mn></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\ndescribes the absorption of the wave by the absorption coefficient\n$\\alpha$ in $\\mathrm{cm^{-1}}$ and is connected to the transmission\ncoefficient $\\tau$. Furthermore, we assume that the complex refractive\nindex vanishes outside the reconstruction region $\\Omega$, i.~e.~$n(x)-1=0$\nand $\\kappa(x)=0$, if $x\\notin\\Omega$. Let $L$ be the propagation\npath of the THz radiation. The ratio of the transmitted intensity\n$I$ and the initial intensity $I_{0}$ is connected to the absorption\ncoefficient $\\alpha$ via \n\n\n", "itemtype": "equation", "pos": 11933, "prevtext": "\nThis means the (delayed) travel time is physically related to real\npart of $\\tilde{n}$. The imaginary part \n\n\n", "index": 5, "text": "\\begin{equation}\n\\kappa(x)=\\alpha(x)\\frac{c_{0}}{4\\pi f},\\qquad x\\in\\Omega,\\,f>0,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"\\kappa(x)=\\alpha(x)\\frac{c_{0}}{4\\pi f},\\qquad x\\in\\Omega,\\,f&gt;0,\" display=\"block\"><mrow><mrow><mrow><mrow><mi>\u03ba</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mi>\u03b1</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mfrac><msub><mi>c</mi><mn>0</mn></msub><mrow><mn>4</mn><mo>\u2062</mo><mi>\u03c0</mi><mo>\u2062</mo><mi>f</mi></mrow></mfrac></mrow></mrow><mo rspace=\"22.5pt\">,</mo><mrow><mrow><mi>x</mi><mo>\u2208</mo><mi mathvariant=\"normal\">\u03a9</mi></mrow><mo rspace=\"4.2pt\">,</mo><mrow><mi>f</mi><mo>&gt;</mo><mn>0</mn></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\naccording to Lambert-Beer's law. The path difference is given by\n\n\n", "itemtype": "equation", "pos": 12540, "prevtext": "\ndescribes the absorption of the wave by the absorption coefficient\n$\\alpha$ in $\\mathrm{cm^{-1}}$ and is connected to the transmission\ncoefficient $\\tau$. Furthermore, we assume that the complex refractive\nindex vanishes outside the reconstruction region $\\Omega$, i.~e.~$n(x)-1=0$\nand $\\kappa(x)=0$, if $x\\notin\\Omega$. Let $L$ be the propagation\npath of the THz radiation. The ratio of the transmitted intensity\n$I$ and the initial intensity $I_{0}$ is connected to the absorption\ncoefficient $\\alpha$ via \n\n\n", "index": 7, "text": "\\begin{equation}\ng_{\\mathrm{abs}}(L)=\\intop_{L}\\alpha(x)\\,\\mathrm{d}x=\\ln\\left(\\frac{I_{0}}{I}\\right)=\\ln\\left(\\frac{1}{\\tau}\\right)\\label{eq:integral-eq-CT}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"g_{\\mathrm{abs}}(L)=\\intop_{L}\\alpha(x)\\,\\mathrm{d}x=\\ln\\left(\\frac{I_{0}}{I}%&#10;\\right)=\\ln\\left(\\frac{1}{\\tau}\\right)\" display=\"block\"><mrow><mrow><msub><mi>g</mi><mi>abs</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>L</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u222b</mo><mi>L</mi></munder><mrow><mi>\u03b1</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>d</mo><mi>x</mi></mrow></mrow></mrow><mo>=</mo><mrow><mi>ln</mi><mo>\u2061</mo><mrow><mo>(</mo><mfrac><msub><mi>I</mi><mn>0</mn></msub><mi>I</mi></mfrac><mo>)</mo></mrow></mrow><mo>=</mo><mrow><mi>ln</mi><mo>\u2061</mo><mrow><mo>(</mo><mfrac><mn>1</mn><mi>\u03c4</mi></mfrac><mo>)</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nwhich follows from subtraction of the path in air with a refractive\nindex of $n_{0}=1$, see \\cite{Natterer1986}. \n\nDue to refraction at interfaces, THz rays do not necessarily propagate\nalong straight lines. The rays are rather refracted at interfaces\naccording to Snell's law. In case of a piecewise constant refractive\nindex, the propagation path is continuous and consists of piecewise\nstraight lines. We name the segments of a THz ray between two interfaces\nas ``partial ray'' $L_{l}\\subseteq L$ with $l=1,...,\\hat{K}+1$ and\n$\\hat{K}$ the number of intersected interfaces. The first partial\nray $L_{1}$ is parametrized as in X-ray CT until reaching the first\ninterface, see \\cite[p. 41-42]{Natterer2001}. Let \n\n", "itemtype": "equation", "pos": 12779, "prevtext": "\naccording to Lambert-Beer's law. The path difference is given by\n\n\n", "index": 9, "text": "\\begin{equation}\ng_{\\mathrm{ref}}(L)=\\intop_{L}\\left(n(x)-1\\right)\\,\\mathrm{d}x=d,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"g_{\\mathrm{ref}}(L)=\\intop_{L}\\left(n(x)-1\\right)\\,\\mathrm{d}x=d,\" display=\"block\"><mrow><mrow><mrow><msub><mi>g</mi><mi>ref</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>L</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u222b</mo><mi>L</mi></munder><mrow><mrow><mo>(</mo><mrow><mrow><mi>n</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mn>1</mn></mrow><mo rspace=\"4.2pt\">)</mo></mrow><mo>\u2062</mo><mrow><mo>d</mo><mi>x</mi></mrow></mrow></mrow><mo>=</mo><mi>d</mi></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nbe the parametrization of $L_{1}$ with distance\n$s\\in\\mathbb{R}$ from the origin, the angle $\\varphi\\in\\left[0,\\,2\\pi\\right)$, $\\omega(\\varphi)=\\left(\\cos\\varphi,\\sin\\varphi\\right)^{T}$\nand $\\omega^{\\bot}=(-\\sin\\varphi,\\,\\cos\\varphi)^{T}$. Using $\\Gamma$,\nthe ray is represented by\n\n\n", "itemtype": "equation", "pos": 13591, "prevtext": "\nwhich follows from subtraction of the path in air with a refractive\nindex of $n_{0}=1$, see \\cite{Natterer1986}. \n\nDue to refraction at interfaces, THz rays do not necessarily propagate\nalong straight lines. The rays are rather refracted at interfaces\naccording to Snell's law. In case of a piecewise constant refractive\nindex, the propagation path is continuous and consists of piecewise\nstraight lines. We name the segments of a THz ray between two interfaces\nas ``partial ray'' $L_{l}\\subseteq L$ with $l=1,...,\\hat{K}+1$ and\n$\\hat{K}$ the number of intersected interfaces. The first partial\nray $L_{1}$ is parametrized as in X-ray CT until reaching the first\ninterface, see \\cite[p. 41-42]{Natterer2001}. Let \n\n", "index": 11, "text": "\\begin{equation}\n\\Gamma:\\mathbb{R}\\rightarrow\\mathbb{R}^{2},\\qquad\\Gamma(t)=s\\omega(\\varphi)+t\\omega^{\\bot}(\\varphi)\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"\\Gamma:\\mathbb{R}\\rightarrow\\mathbb{R}^{2},\\qquad\\Gamma(t)=s\\omega(\\varphi)+t%&#10;\\omega^{\\bot}(\\varphi)\" display=\"block\"><mrow><mi mathvariant=\"normal\">\u0393</mi><mo>:</mo><mrow><mrow><mi>\u211d</mi><mo>\u2192</mo><msup><mi>\u211d</mi><mn>2</mn></msup></mrow><mo rspace=\"22.5pt\">,</mo><mrow><mrow><mi mathvariant=\"normal\">\u0393</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>s</mi><mo>\u2062</mo><mi>\u03c9</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c6</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mi>t</mi><mo>\u2062</mo><msup><mi>\u03c9</mi><mo>\u22a5</mo></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c6</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nwith $t_{1}^{\\mathrm{if}}\\left(\\varphi,s\\right)$ the time of the\nincidence on the first interface (so-called ``initial ray''). In\nX-ray CT, this parameter is usually set to $t_{1}^{\\mathrm{if}}=\\infty$.\nThe full ray path depending on refraction is described in section\n\\ref{sub:ray-path-depending-on-refraction}. Therefore we first need\nto take a closer look at a suitable notation of the interfaces and\nafterwards we briefly describe the relevant physical laws.\n\n\n\\subsection{Notation of interfaces}\n\nAs mentioned before, we would like to use some a priori information.\nWe postulate the knowledge of the object's interfaces, i.~e.~our\na priori information contains positions and the normals of the interfaces\nof the object. This is quite a strong assumption, but in many cases\nthe (approximate) location of some interfaces is actually known, for\nexample from CAD drawings of the examined object or preliminary testings\nwith an X-ray CT. However, the interfaces of potential defects are\nunknown. Nevertheless, the knowledge of some interfaces already leads\nto better reconstructions. \n\\begin{defn}\nAn \\emph{interface} is a regular continuously differentiable and injective\nimmersion $\\text{\\ensuremath{\\Xi}}:\\left[a,b\\right]\\rightarrow\\Omega\\subset\\mathbb{R}^{2}$,\nfulfilling $\\Xi^{'}(\\sigma)=\\frac{d\\Xi}{d\\sigma}\\neq0,\\,\\forall\\sigma\\in\\left[a,b\\right]$.\n\n\\end{defn}\nThe curve has a tangent and a normal $\\mathfrak{n}$ at every point,\nbecause the first derivative $\\Xi^{'}$ is continuous and does not\nvanish. The tangent vector of $\\Xi$ at $\\sigma_{0}\\in\\left[a,\\,b\\right]$\nis given by\n\n", "itemtype": "equation", "pos": 14006, "prevtext": "\nbe the parametrization of $L_{1}$ with distance\n$s\\in\\mathbb{R}$ from the origin, the angle $\\varphi\\in\\left[0,\\,2\\pi\\right)$, $\\omega(\\varphi)=\\left(\\cos\\varphi,\\sin\\varphi\\right)^{T}$\nand $\\omega^{\\bot}=(-\\sin\\varphi,\\,\\cos\\varphi)^{T}$. Using $\\Gamma$,\nthe ray is represented by\n\n\n", "index": 13, "text": "\\begin{equation}\nL_{1}\\left(\\varphi,s\\right)=\\left\\{ \\Gamma(t):\\,t\\in\\left[-\\infty,\\,t_{1}^{\\mathrm{if}}\\left(\\varphi,s\\right)\\right]\\right\\} \\label{eq:parametrization-L}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"L_{1}\\left(\\varphi,s\\right)=\\left\\{\\Gamma(t):\\,t\\in\\left[-\\infty,\\,t_{1}^{%&#10;\\mathrm{if}}\\left(\\varphi,s\\right)\\right]\\right\\}\" display=\"block\"><mrow><mrow><msub><mi>L</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mo>(</mo><mi>\u03c6</mi><mo>,</mo><mi>s</mi><mo>)</mo></mrow></mrow><mo>=</mo><mrow><mo>{</mo><mrow><mi mathvariant=\"normal\">\u0393</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo rspace=\"4.2pt\">:</mo><mrow><mi>t</mi><mo>\u2208</mo><mrow><mo>[</mo><mrow><mo>-</mo><mi mathvariant=\"normal\">\u221e</mi></mrow><mo rspace=\"4.2pt\">,</mo><mrow><msubsup><mi>t</mi><mn>1</mn><mi>if</mi></msubsup><mo>\u2062</mo><mrow><mo>(</mo><mi>\u03c6</mi><mo>,</mo><mi>s</mi><mo>)</mo></mrow></mrow><mo>]</mo></mrow></mrow><mo>}</mo></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nwhereby we define the normal vector \n\n\n", "itemtype": "equation", "pos": 15779, "prevtext": "\nwith $t_{1}^{\\mathrm{if}}\\left(\\varphi,s\\right)$ the time of the\nincidence on the first interface (so-called ``initial ray''). In\nX-ray CT, this parameter is usually set to $t_{1}^{\\mathrm{if}}=\\infty$.\nThe full ray path depending on refraction is described in section\n\\ref{sub:ray-path-depending-on-refraction}. Therefore we first need\nto take a closer look at a suitable notation of the interfaces and\nafterwards we briefly describe the relevant physical laws.\n\n\n\\subsection{Notation of interfaces}\n\nAs mentioned before, we would like to use some a priori information.\nWe postulate the knowledge of the object's interfaces, i.~e.~our\na priori information contains positions and the normals of the interfaces\nof the object. This is quite a strong assumption, but in many cases\nthe (approximate) location of some interfaces is actually known, for\nexample from CAD drawings of the examined object or preliminary testings\nwith an X-ray CT. However, the interfaces of potential defects are\nunknown. Nevertheless, the knowledge of some interfaces already leads\nto better reconstructions. \n\\begin{defn}\nAn \\emph{interface} is a regular continuously differentiable and injective\nimmersion $\\text{\\ensuremath{\\Xi}}:\\left[a,b\\right]\\rightarrow\\Omega\\subset\\mathbb{R}^{2}$,\nfulfilling $\\Xi^{'}(\\sigma)=\\frac{d\\Xi}{d\\sigma}\\neq0,\\,\\forall\\sigma\\in\\left[a,b\\right]$.\n\n\\end{defn}\nThe curve has a tangent and a normal $\\mathfrak{n}$ at every point,\nbecause the first derivative $\\Xi^{'}$ is continuous and does not\nvanish. The tangent vector of $\\Xi$ at $\\sigma_{0}\\in\\left[a,\\,b\\right]$\nis given by\n\n", "index": 15, "text": "\\begin{equation}\n\\Xi^{'}(\\sigma_{0})=\\left.\\frac{d\\Xi}{d\\sigma}\\right|_{\\sigma=\\sigma_{0}}=\\left(\\xi_{1}^{'}(\\sigma_{0}),\\,\\xi_{2}^{'}(\\sigma_{0})\\right)^{T},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m1\" class=\"ltx_Math\" alttext=\"\\Xi^{{}^{\\prime}}(\\sigma_{0})=\\left.\\frac{d\\Xi}{d\\sigma}\\right|_{\\sigma=\\sigma%&#10;_{0}}=\\left(\\xi_{1}^{{}^{\\prime}}(\\sigma_{0}),\\,\\xi_{2}^{{}^{\\prime}}(\\sigma_{%&#10;0})\\right)^{T},\" display=\"block\"><mrow><mrow><mrow><msup><mi mathvariant=\"normal\">\u039e</mi><msup><mi/><mo>\u2032</mo></msup></msup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c3</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><msub><mrow><mfrac><mrow><mi>d</mi><mo>\u2062</mo><mi mathvariant=\"normal\">\u039e</mi></mrow><mrow><mi>d</mi><mo>\u2062</mo><mi>\u03c3</mi></mrow></mfrac><mo fence=\"true\">|</mo></mrow><mrow><mi>\u03c3</mi><mo>=</mo><msub><mi>\u03c3</mi><mn>0</mn></msub></mrow></msub><mo>=</mo><msup><mrow><mo>(</mo><mrow><msubsup><mi>\u03be</mi><mn>1</mn><msup><mi/><mo>\u2032</mo></msup></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c3</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo rspace=\"4.2pt\">,</mo><mrow><msubsup><mi>\u03be</mi><mn>2</mn><msup><mi/><mo>\u2032</mo></msup></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c3</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>)</mo></mrow><mi>T</mi></msup></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nwhich we will need for Snell's law. Let $K\\in\\mathbb{N}$ be the number\nof known interfaces $\\Xi_{k},\\,k=1,...,\\,K$ of the object. Interfaces\nmay touch or intersect each other as we often have to deal with non-smooth\ninterfaces, e. g. rectangular objects. However, $\\Xi^{'}(\\sigma)$\nand hence the normal does not exist at corners. This case is handled\nby local smoothing. Let us assume, that\n\n", "itemtype": "equation", "pos": 15991, "prevtext": "\nwhereby we define the normal vector \n\n\n", "index": 17, "text": "\\begin{equation}\n\\mathfrak{n}(\\sigma_{0})=\\left(-\\xi_{2}^{'}(\\sigma_{0}),\\,\\xi_{1}^{'}(\\sigma_{0})\\right)^{T},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m1\" class=\"ltx_Math\" alttext=\"\\mathfrak{n}(\\sigma_{0})=\\left(-\\xi_{2}^{{}^{\\prime}}(\\sigma_{0}),\\,\\xi_{1}^{{%&#10;}^{\\prime}}(\\sigma_{0})\\right)^{T},\" display=\"block\"><mrow><mrow><mrow><mi>\ud835\udd2b</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c3</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><msup><mrow><mo>(</mo><mrow><mo>-</mo><mrow><msubsup><mi>\u03be</mi><mn>2</mn><msup><mi/><mo>\u2032</mo></msup></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c3</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo rspace=\"4.2pt\">,</mo><mrow><msubsup><mi>\u03be</mi><mn>1</mn><msup><mi/><mo>\u2032</mo></msup></msubsup><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c3</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mo>)</mo></mrow><mi>T</mi></msup></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nis the shared intersection of $\\tilde{K}\\in\\left[1,\\,K\\right]$ different\ninterfaces $\\Xi_{k_{\\iota}}$ with $k_{\\iota}\\in\\left[1,\\,K\\right],\\iota=1,...,\\,\\tilde{K}$.\nThen $\\sigma_{k_{\\iota}}:=\\Xi_{k_{\\iota}}^{-1}\\left(P\\right)\\in\\left[a_{k_{\\iota}},b_{k_{\\iota}}\\right]$\nparametrizes the point of intersection on each interface and $\\mathfrak{n}_{k_{\\iota}}(\\sigma_{k_{\\iota}})$\nare the corresponding normals for $\\iota=1,...,\\tilde{K}$. We now\ncompute the normal in $P$ by averaging\n\n", "itemtype": "equation", "pos": 16508, "prevtext": "\nwhich we will need for Snell's law. Let $K\\in\\mathbb{N}$ be the number\nof known interfaces $\\Xi_{k},\\,k=1,...,\\,K$ of the object. Interfaces\nmay touch or intersect each other as we often have to deal with non-smooth\ninterfaces, e. g. rectangular objects. However, $\\Xi^{'}(\\sigma)$\nand hence the normal does not exist at corners. This case is handled\nby local smoothing. Let us assume, that\n\n", "index": 19, "text": "\\begin{equation}\nP:=\\bigcap_{\\iota=1}^{\\tilde{K}}\\Xi_{k_{\\iota}}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E10.m1\" class=\"ltx_Math\" alttext=\"P:=\\bigcap_{\\iota=1}^{\\tilde{K}}\\Xi_{k_{\\iota}}\" display=\"block\"><mrow><mi>P</mi><mo>:=</mo><mrow><munderover><mo largeop=\"true\" mathsize=\"160%\" movablelimits=\"false\" stretchy=\"false\" symmetric=\"true\">\u22c2</mo><mrow><mi>\u03b9</mi><mo>=</mo><mn>1</mn></mrow><mover accent=\"true\"><mi>K</mi><mo stretchy=\"false\">~</mo></mover></munderover><msub><mi mathvariant=\"normal\">\u039e</mi><msub><mi>k</mi><mi>\u03b9</mi></msub></msub></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nwhich can be interpreted as a mean orientation of the interfaces containing\n$P$. This approach sets a normal for the intersection, which occurs\nby a local smoothing of the corner $P$ (see figure~\\ref{fig:Dealing-with-corners}).\nFor $\\tilde{K}=1$ the normal vector is just normalized.\n\n\\begin{figure}[H]\n\\begin{centering}\n\\includegraphics[width=0.5\\textwidth]{interface_at_corner.pdf}\n\\par\\end{centering}\n\n\\caption{Dealing with corners: the calculated normal for the discontinuity\ncorresponds to the normal of the smoothed interface at this point\\label{fig:Dealing-with-corners}}\n\\end{figure}\n\n\n\n\\subsection{Refraction and reflection losses}\n\nWe follow the idea of Mukherjee et. al, see \\cite{Mukherjee2013},\nwho consider refraction and reflection losses for cylindrical objects\nwith known refractive index for the reconstruction of the absorption\ncoefficient. We generalize this approach for general objects with\ngiven interfaces, unknown $n$ and reconstruct both refractive index\nand absorption coefficient. The propagation of electromagnetic waves\nat an interface between two different media is influenced by refraction,\nreflection, diffraction and scattering. As stated before, we want\nto neglect diffraction and scattering. Let us consider the transition\nof a ray from a medium with refractive index $n_{1}$ into a medium\nwith refractive index $n_{2}$. The change in the direction of propagation\nof the transmitted part of the THz ray can be calculated according\nto Snell's law\n\n", "itemtype": "equation", "pos": 17071, "prevtext": "\nis the shared intersection of $\\tilde{K}\\in\\left[1,\\,K\\right]$ different\ninterfaces $\\Xi_{k_{\\iota}}$ with $k_{\\iota}\\in\\left[1,\\,K\\right],\\iota=1,...,\\,\\tilde{K}$.\nThen $\\sigma_{k_{\\iota}}:=\\Xi_{k_{\\iota}}^{-1}\\left(P\\right)\\in\\left[a_{k_{\\iota}},b_{k_{\\iota}}\\right]$\nparametrizes the point of intersection on each interface and $\\mathfrak{n}_{k_{\\iota}}(\\sigma_{k_{\\iota}})$\nare the corresponding normals for $\\iota=1,...,\\tilde{K}$. We now\ncompute the normal in $P$ by averaging\n\n", "index": 21, "text": "\\begin{equation}\n\\mathfrak{n}=\\frac{\\sum_{\\iota=1}^{\\tilde{K}}\\mathfrak{n}_{k_{\\iota}}(\\sigma_{k_{\\iota}})}{\\left\\Vert \\sum_{\\iota=1}^{\\tilde{K}}\\mathfrak{n}_{k_{\\iota}}(\\sigma_{k_{\\iota}})\\right\\Vert },\\label{eq:sum-normals}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E11.m1\" class=\"ltx_Math\" alttext=\"\\mathfrak{n}=\\frac{\\sum_{\\iota=1}^{\\tilde{K}}\\mathfrak{n}_{k_{\\iota}}(\\sigma_{%&#10;k_{\\iota}})}{\\left\\|\\sum_{\\iota=1}^{\\tilde{K}}\\mathfrak{n}_{k_{\\iota}}(\\sigma_%&#10;{k_{\\iota}})\\right\\|},\" display=\"block\"><mrow><mrow><mi>\ud835\udd2b</mi><mo>=</mo><mfrac><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><mi>\u03b9</mi><mo>=</mo><mn>1</mn></mrow><mover accent=\"true\"><mi>K</mi><mo stretchy=\"false\">~</mo></mover></msubsup><mrow><msub><mi>\ud835\udd2b</mi><msub><mi>k</mi><mi>\u03b9</mi></msub></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c3</mi><msub><mi>k</mi><mi>\u03b9</mi></msub></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mrow><mo>\u2225</mo><mrow><msubsup><mo largeop=\"true\" symmetric=\"true\">\u2211</mo><mrow><mi>\u03b9</mi><mo>=</mo><mn>1</mn></mrow><mover accent=\"true\"><mi>K</mi><mo stretchy=\"false\">~</mo></mover></msubsup><mrow><msub><mi>\ud835\udd2b</mi><msub><mi>k</mi><mi>\u03b9</mi></msub></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c3</mi><msub><mi>k</mi><mi>\u03b9</mi></msub></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>\u2225</mo></mrow></mfrac></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nwith the angle of incidence $\\gamma_{1}$ and the angle of refraction\n$\\gamma_{2}$ measured from the normal $\\mathfrak{n}$ of the interface,\nsee \\cite[p. 38 ff.]{Born1970}. When rays travel from a medium with\na higher refractive index $n_{1}$ to one with a lower refractive\nindex $n_{2}$, total reflection is possible for a sufficiently large\n$\\gamma_{1}$. In this case, we have \n\n", "itemtype": "equation", "pos": 18794, "prevtext": "\nwhich can be interpreted as a mean orientation of the interfaces containing\n$P$. This approach sets a normal for the intersection, which occurs\nby a local smoothing of the corner $P$ (see figure~\\ref{fig:Dealing-with-corners}).\nFor $\\tilde{K}=1$ the normal vector is just normalized.\n\n\\begin{figure}[H]\n\\begin{centering}\n\\includegraphics[width=0.5\\textwidth]{interface_at_corner.pdf}\n\\par\\end{centering}\n\n\\caption{Dealing with corners: the calculated normal for the discontinuity\ncorresponds to the normal of the smoothed interface at this point\\label{fig:Dealing-with-corners}}\n\\end{figure}\n\n\n\n\\subsection{Refraction and reflection losses}\n\nWe follow the idea of Mukherjee et. al, see \\cite{Mukherjee2013},\nwho consider refraction and reflection losses for cylindrical objects\nwith known refractive index for the reconstruction of the absorption\ncoefficient. We generalize this approach for general objects with\ngiven interfaces, unknown $n$ and reconstruct both refractive index\nand absorption coefficient. The propagation of electromagnetic waves\nat an interface between two different media is influenced by refraction,\nreflection, diffraction and scattering. As stated before, we want\nto neglect diffraction and scattering. Let us consider the transition\nof a ray from a medium with refractive index $n_{1}$ into a medium\nwith refractive index $n_{2}$. The change in the direction of propagation\nof the transmitted part of the THz ray can be calculated according\nto Snell's law\n\n", "index": 23, "text": "\\begin{equation}\nn_{1}\\sin\\gamma_{1}=n_{2}\\sin\\gamma_{2},\\label{eq:Snell-1}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E12.m1\" class=\"ltx_Math\" alttext=\"n_{1}\\sin\\gamma_{1}=n_{2}\\sin\\gamma_{2},\" display=\"block\"><mrow><mrow><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mi>sin</mi><mo>\u2061</mo><msub><mi>\u03b3</mi><mn>1</mn></msub></mrow></mrow><mo>=</mo><mrow><msub><mi>n</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mi>sin</mi><mo>\u2061</mo><msub><mi>\u03b3</mi><mn>2</mn></msub></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nand the radiation is fully reflected.\n\\begin{figure}\n\\begin{centering}\n\\includegraphics[width=0.5\\textwidth]{Snell}\n\\par\\end{centering}\n\n\\caption{Snell's law with normal $\\mathfrak{n}$ of the interface and direction\nvectors $\\omega_{l}^{\\perp}$, $\\omega_{l+1}^{\\perp}$ and $-\\omega_{l}$\nof the incident, refracted and reflected rays, $n_{1}<n_{2}$\\label{fig:draft-Snells-law}}\n\\end{figure}\nThe fraction of the incident radiation that is reflected at the interface\ncan be described by the Fresnel equations, see \\cite[p. 38 ff.]{Born1970}.\nReflection losses depend on the polarization of the incident wave,\nthe angle of incident $\\gamma_{1}$ and refraction $\\gamma_{2}$ and\nthe refractive indices. The reflectance of a ray that is polarized\nperpendicularly to the plane of incidence is given by\n\n\n", "itemtype": "equation", "pos": 19264, "prevtext": "\nwith the angle of incidence $\\gamma_{1}$ and the angle of refraction\n$\\gamma_{2}$ measured from the normal $\\mathfrak{n}$ of the interface,\nsee \\cite[p. 38 ff.]{Born1970}. When rays travel from a medium with\na higher refractive index $n_{1}$ to one with a lower refractive\nindex $n_{2}$, total reflection is possible for a sufficiently large\n$\\gamma_{1}$. In this case, we have \n\n", "index": 25, "text": "\\begin{equation}\n\\frac{n_{1}}{n_{2}}\\sin\\gamma_{1}>1,\\qquad\\mathrm{for\\,}\\,n_{1}>n_{2}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E13.m1\" class=\"ltx_Math\" alttext=\"\\frac{n_{1}}{n_{2}}\\sin\\gamma_{1}&gt;1,\\qquad\\mathrm{for\\,}\\,n_{1}&gt;n_{2}\" display=\"block\"><mrow><mrow><mrow><mfrac><msub><mi>n</mi><mn>1</mn></msub><msub><mi>n</mi><mn>2</mn></msub></mfrac><mo>\u2062</mo><mrow><mi>sin</mi><mo>\u2061</mo><msub><mi>\u03b3</mi><mn>1</mn></msub></mrow></mrow><mo>&gt;</mo><mn>1</mn></mrow><mo rspace=\"22.5pt\">,</mo><mrow><mrow><mpadded width=\"+3.4pt\"><mi>for</mi></mpadded><mo>\u2062</mo><msub><mi>n</mi><mn>1</mn></msub></mrow><mo>&gt;</mo><msub><mi>n</mi><mn>2</mn></msub></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nwhere $E_{0}$ resp.~$E_{r}$ is the electric field amplitude of\nthe incident resp.~reflected partial ray. Analogous considerations\nexist also for parallel polarization. All other polarizations can\nbe represented by a superposition of the linearly perpendicular and\nlinearly parallel case. \n\n\n\\subsection{Ray propagation considering refraction\\label{sub:ray-path-depending-on-refraction}}\n\nThe path of a THz ray $L$ up to reaching the first interface can\nbe described by equation (\\ref{eq:parametrization-L}). The ray is\nrefracted as it transitions into the next medium and the ray direction\nhas to be recalculated according to Snell's law. We first have to\ndetermine the next intersection with an interface for each (refracted)\npartial ray $L_{l}$. The change in the direction of the ray is calculated\nin this intersection. Let the $l$-th partial ray $L_{l}$ be given\nby an angle $\\varphi_{l}$ and a distance $s_{l}$, i~.e.~$L_{l}\\left(\\varphi_{l},s_{l}\\right)=\\left\\{ \\Gamma_{l}(t)=s_{l}\\omega_{l}+t\\omega_{l}^{\\perp}:\\,t\\in\\left[t_{l-1}^{\\mathrm{if}},\\,t_{l}^{\\mathrm{if}}\\right]\\right\\} $.\nNow we calculate the intersections of $L_{l}$ with the interfaces\nand determine the parameter \n\n\n", "itemtype": "equation", "pos": 20161, "prevtext": "\nand the radiation is fully reflected.\n\\begin{figure}\n\\begin{centering}\n\\includegraphics[width=0.5\\textwidth]{Snell}\n\\par\\end{centering}\n\n\\caption{Snell's law with normal $\\mathfrak{n}$ of the interface and direction\nvectors $\\omega_{l}^{\\perp}$, $\\omega_{l+1}^{\\perp}$ and $-\\omega_{l}$\nof the incident, refracted and reflected rays, $n_{1}<n_{2}$\\label{fig:draft-Snells-law}}\n\\end{figure}\nThe fraction of the incident radiation that is reflected at the interface\ncan be described by the Fresnel equations, see \\cite[p. 38 ff.]{Born1970}.\nReflection losses depend on the polarization of the incident wave,\nthe angle of incident $\\gamma_{1}$ and refraction $\\gamma_{2}$ and\nthe refractive indices. The reflectance of a ray that is polarized\nperpendicularly to the plane of incidence is given by\n\n\n", "index": 27, "text": "\\begin{equation}\n\\rho=\\left|\\frac{E_{r}}{E_{0}}\\right|^{2}=\\left|\\frac{n_{1}\\cos\\gamma_{1}-n_{2}\\cos\\gamma_{2}}{n_{1}\\cos\\gamma_{1}+n_{2}\\cos\\gamma_{2}}\\right|^{2},\\label{eq:Fresnel}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14.m1\" class=\"ltx_Math\" alttext=\"\\rho=\\left|\\frac{E_{r}}{E_{0}}\\right|^{2}=\\left|\\frac{n_{1}\\cos\\gamma_{1}-n_{2%&#10;}\\cos\\gamma_{2}}{n_{1}\\cos\\gamma_{1}+n_{2}\\cos\\gamma_{2}}\\right|^{2},\" display=\"block\"><mrow><mrow><mi>\u03c1</mi><mo>=</mo><msup><mrow><mo>|</mo><mfrac><msub><mi>E</mi><mi>r</mi></msub><msub><mi>E</mi><mn>0</mn></msub></mfrac><mo>|</mo></mrow><mn>2</mn></msup><mo>=</mo><msup><mrow><mo>|</mo><mfrac><mrow><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mi>cos</mi><mo>\u2061</mo><msub><mi>\u03b3</mi><mn>1</mn></msub></mrow></mrow><mo>-</mo><mrow><msub><mi>n</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mi>cos</mi><mo>\u2061</mo><msub><mi>\u03b3</mi><mn>2</mn></msub></mrow></mrow></mrow><mrow><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>\u2062</mo><mrow><mi>cos</mi><mo>\u2061</mo><msub><mi>\u03b3</mi><mn>1</mn></msub></mrow></mrow><mo>+</mo><mrow><msub><mi>n</mi><mn>2</mn></msub><mo>\u2062</mo><mrow><mi>cos</mi><mo>\u2061</mo><msub><mi>\u03b3</mi><mn>2</mn></msub></mrow></mrow></mrow></mfrac><mo>|</mo></mrow><mn>2</mn></msup></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nwhich defines the nearest intersection with an interface in the direction\nof propagation with $l\\geq1$ and $t_{0}^{\\mathrm{if}}=-\\infty$.\nLet $\\Xi_{\\tilde{k}}(\\sigma),\\,\\tilde{k}\\in\\left[1,\\,K\\right],$ be\nthe nearest interface and $\\tilde{\\sigma}$ the parameter corresponding\nto $t_{l}^{\\mathrm{if}}$ in (\\ref{eq:t-of-the-next-interface}) of\nthe intersection $\\Xi_{\\tilde{k}}(\\tilde{\\sigma})=s_{l}\\omega_{l}+t_{l}^{\\mathrm{if}}\\omega_{l}^{\\perp}$.\nWe can determine the refractive indices for both sides of the interface,\nwhich we need for Snell's law, by\n\n\n", "itemtype": "equation", "pos": 21547, "prevtext": "\nwhere $E_{0}$ resp.~$E_{r}$ is the electric field amplitude of\nthe incident resp.~reflected partial ray. Analogous considerations\nexist also for parallel polarization. All other polarizations can\nbe represented by a superposition of the linearly perpendicular and\nlinearly parallel case. \n\n\n\\subsection{Ray propagation considering refraction\\label{sub:ray-path-depending-on-refraction}}\n\nThe path of a THz ray $L$ up to reaching the first interface can\nbe described by equation (\\ref{eq:parametrization-L}). The ray is\nrefracted as it transitions into the next medium and the ray direction\nhas to be recalculated according to Snell's law. We first have to\ndetermine the next intersection with an interface for each (refracted)\npartial ray $L_{l}$. The change in the direction of the ray is calculated\nin this intersection. Let the $l$-th partial ray $L_{l}$ be given\nby an angle $\\varphi_{l}$ and a distance $s_{l}$, i~.e.~$L_{l}\\left(\\varphi_{l},s_{l}\\right)=\\left\\{ \\Gamma_{l}(t)=s_{l}\\omega_{l}+t\\omega_{l}^{\\perp}:\\,t\\in\\left[t_{l-1}^{\\mathrm{if}},\\,t_{l}^{\\mathrm{if}}\\right]\\right\\} $.\nNow we calculate the intersections of $L_{l}$ with the interfaces\nand determine the parameter \n\n\n", "index": 29, "text": "\\begin{equation}\nt_{l}^{\\mathrm{if}}\\left(\\varphi_{l},s_{l}\\right)=\\underset{t}{\\min}\\left\\{ \\left(t,\\sigma\\right)\\in\\left(t_{l-1}^{\\mathrm{if}},\\infty\\right]\\times\\left[a_{k},b_{k}\\right]:\\,\\Gamma_{l}(t)=\\Xi_{k}(\\sigma),\\,k=1,...,K\\right\\} ,\\label{eq:t-of-the-next-interface}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E15.m1\" class=\"ltx_Math\" alttext=\"t_{l}^{\\mathrm{if}}\\left(\\varphi_{l},s_{l}\\right)=\\underset{t}{\\min}\\left\\{%&#10;\\left(t,\\sigma\\right)\\in\\left(t_{l-1}^{\\mathrm{if}},\\infty\\right]\\times\\left[a%&#10;_{k},b_{k}\\right]:\\,\\Gamma_{l}(t)=\\Xi_{k}(\\sigma),\\,k=1,...,K\\right\\},\" display=\"block\"><mrow><mrow><mrow><msubsup><mi>t</mi><mi>l</mi><mi>if</mi></msubsup><mo>\u2062</mo><mrow><mo>(</mo><msub><mi>\u03c6</mi><mi>l</mi></msub><mo>,</mo><msub><mi>s</mi><mi>l</mi></msub><mo>)</mo></mrow></mrow><mo>=</mo><mrow><munder accentunder=\"true\"><mi>min</mi><mo>\ud835\udc61</mo></munder><mo>\u2062</mo><mrow><mo>{</mo><mrow><mrow><mo>(</mo><mi>t</mi><mo>,</mo><mi>\u03c3</mi><mo>)</mo></mrow><mo>\u2208</mo><mrow><mrow><mo>(</mo><msubsup><mi>t</mi><mrow><mi>l</mi><mo>-</mo><mn>1</mn></mrow><mi>if</mi></msubsup><mo>,</mo><mi mathvariant=\"normal\">\u221e</mi><mo>]</mo></mrow><mo>\u00d7</mo><mrow><mo>[</mo><msub><mi>a</mi><mi>k</mi></msub><mo>,</mo><msub><mi>b</mi><mi>k</mi></msub><mo>]</mo></mrow></mrow></mrow><mo rspace=\"4.2pt\">:</mo><mrow><mrow><mrow><msub><mi mathvariant=\"normal\">\u0393</mi><mi>l</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><msub><mi mathvariant=\"normal\">\u039e</mi><mi>k</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c3</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo rspace=\"4.2pt\">,</mo><mrow><mi>k</mi><mo>=</mo><mrow><mn>1</mn><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><mi>K</mi></mrow></mrow></mrow><mo>}</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nwith the normal $\\mathfrak{n}:=\\mathfrak{n}(\\tilde{\\sigma})$ as in\n(\\ref{eq:sum-normals}) and an appropriately small $\\varepsilon>0$.\nThe angle of incidence $\\gamma_{l,1}$ between the direction vector\nof the incident ray $\\omega_{l}^{\\perp}$ and normal $\\mathfrak{n}$\n(see figure \\ref{fig:draft-Snells-law}) can be calculated by the\nscalar product in $\\mathbb{R}^{2}$\n\n\n", "itemtype": "equation", "pos": 22395, "prevtext": "\nwhich defines the nearest intersection with an interface in the direction\nof propagation with $l\\geq1$ and $t_{0}^{\\mathrm{if}}=-\\infty$.\nLet $\\Xi_{\\tilde{k}}(\\sigma),\\,\\tilde{k}\\in\\left[1,\\,K\\right],$ be\nthe nearest interface and $\\tilde{\\sigma}$ the parameter corresponding\nto $t_{l}^{\\mathrm{if}}$ in (\\ref{eq:t-of-the-next-interface}) of\nthe intersection $\\Xi_{\\tilde{k}}(\\tilde{\\sigma})=s_{l}\\omega_{l}+t_{l}^{\\mathrm{if}}\\omega_{l}^{\\perp}$.\nWe can determine the refractive indices for both sides of the interface,\nwhich we need for Snell's law, by\n\n\n", "index": 31, "text": "\\begin{equation}\n\\begin{array}{lllc}\nn_{l,1}:=n\\left(\\Xi_{\\tilde{k}}(\\tilde{\\sigma})-\\varepsilon\\mathfrak{n}\\right) & \\mathrm{\\,and\\,} & n_{l,2}:=n\\left(\\Xi_{\\tilde{k}}(\\tilde{\\sigma})+\\varepsilon\\mathfrak{n}\\right), & \\mathrm{for\\,}\\left\\langle \\omega_{l}^{\\perp},\\mathfrak{n}\\right\\rangle \\leq0\\\\\nn_{l,1}:=n\\left(\\Xi_{\\tilde{k}}(\\tilde{\\sigma})+\\varepsilon\\mathfrak{n}\\right) & \\mathrm{\\,and\\,} & n_{l,2}:=n\\left(\\Xi_{\\tilde{k}}(\\tilde{\\sigma})-\\varepsilon\\mathfrak{n}\\right), & \\mathrm{for\\,\\left\\langle \\omega_{l}^{\\perp},\\mathfrak{n}\\right\\rangle }>0\n\\end{array}\\label{eq:n-for-both-sides-of-the-if}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E16.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{lllc}n_{l,1}:=n\\left(\\Xi_{\\tilde{k}}(\\tilde{\\sigma})-%&#10;\\varepsilon\\mathfrak{n}\\right)&amp;\\mathrm{\\,and\\,}&amp;n_{l,2}:=n\\left(\\Xi_{\\tilde{k}%&#10;}(\\tilde{\\sigma})+\\varepsilon\\mathfrak{n}\\right),&amp;\\mathrm{for\\,}\\left\\langle%&#10;\\omega_{l}^{\\perp},\\mathfrak{n}\\right\\rangle\\leq 0\\\\&#10;n_{l,1}:=n\\left(\\Xi_{\\tilde{k}}(\\tilde{\\sigma})+\\varepsilon\\mathfrak{n}\\right)%&#10;&amp;\\mathrm{\\,and\\,}&amp;n_{l,2}:=n\\left(\\Xi_{\\tilde{k}}(\\tilde{\\sigma})-\\varepsilon%&#10;\\mathfrak{n}\\right),&amp;\\mathrm{for\\,\\left\\langle\\omega_{l}^{\\perp},\\mathfrak{n}%&#10;\\right\\rangle}&gt;0\\end{array}\" display=\"block\"><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><msub><mi>n</mi><mrow><mi>l</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>:=</mo><mrow><mi>n</mi><mo>\u2062</mo><mrow><mo>(</mo><mrow><mrow><msub><mi mathvariant=\"normal\">\u039e</mi><mover accent=\"true\"><mi>k</mi><mo stretchy=\"false\">~</mo></mover></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mi>\u03c3</mi><mo stretchy=\"false\">~</mo></mover><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mi>\u03b5</mi><mo>\u2062</mo><mi>\ud835\udd2b</mi></mrow></mrow><mo>)</mo></mrow></mrow></mrow></mtd><mtd columnalign=\"left\"><mpadded lspace=\"1.7pt\" width=\"+3.4pt\"><mi>and</mi></mpadded></mtd><mtd columnalign=\"left\"><mrow><mrow><msub><mi>n</mi><mrow><mi>l</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>:=</mo><mrow><mi>n</mi><mo>\u2062</mo><mrow><mo>(</mo><mrow><mrow><msub><mi mathvariant=\"normal\">\u039e</mi><mover accent=\"true\"><mi>k</mi><mo stretchy=\"false\">~</mo></mover></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mi>\u03c3</mi><mo stretchy=\"false\">~</mo></mover><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mi>\u03b5</mi><mo>\u2062</mo><mi>\ud835\udd2b</mi></mrow></mrow><mo>)</mo></mrow></mrow></mrow><mo>,</mo></mrow></mtd><mtd columnalign=\"center\"><mrow><mrow><mpadded width=\"+1.7pt\"><mi>for</mi></mpadded><mo>\u2062</mo><mrow><mo>\u27e8</mo><msubsup><mi>\u03c9</mi><mi>l</mi><mo>\u27c2</mo></msubsup><mo>,</mo><mi>\ud835\udd2b</mi><mo>\u27e9</mo></mrow></mrow><mo>\u2264</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mrow><msub><mi>n</mi><mrow><mi>l</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>:=</mo><mrow><mi>n</mi><mo>\u2062</mo><mrow><mo>(</mo><mrow><mrow><msub><mi mathvariant=\"normal\">\u039e</mi><mover accent=\"true\"><mi>k</mi><mo stretchy=\"false\">~</mo></mover></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mi>\u03c3</mi><mo stretchy=\"false\">~</mo></mover><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mi>\u03b5</mi><mo>\u2062</mo><mi>\ud835\udd2b</mi></mrow></mrow><mo>)</mo></mrow></mrow></mrow></mtd><mtd columnalign=\"left\"><mpadded lspace=\"1.7pt\" width=\"+3.4pt\"><mi>and</mi></mpadded></mtd><mtd columnalign=\"left\"><mrow><mrow><msub><mi>n</mi><mrow><mi>l</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>:=</mo><mrow><mi>n</mi><mo>\u2062</mo><mrow><mo>(</mo><mrow><mrow><msub><mi mathvariant=\"normal\">\u039e</mi><mover accent=\"true\"><mi>k</mi><mo stretchy=\"false\">~</mo></mover></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mi>\u03c3</mi><mo stretchy=\"false\">~</mo></mover><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mi>\u03b5</mi><mo>\u2062</mo><mi>\ud835\udd2b</mi></mrow></mrow><mo>)</mo></mrow></mrow></mrow><mo>,</mo></mrow></mtd><mtd columnalign=\"center\"><mrow><mrow><mpadded width=\"+1.7pt\"><mi>for</mi></mpadded><mo>\u2062</mo><mrow><mo>\u27e8</mo><msubsup><mi>\u03c9</mi><mi mathvariant=\"normal\">l</mi><mo>\u27c2</mo></msubsup><mo>,</mo><mi>\ud835\udd2b</mi><mo>\u27e9</mo></mrow></mrow><mo>&gt;</mo><mn>0</mn></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nand the angle of the refracted ray can be obtained by\n\n", "itemtype": "equation", "pos": 23384, "prevtext": "\nwith the normal $\\mathfrak{n}:=\\mathfrak{n}(\\tilde{\\sigma})$ as in\n(\\ref{eq:sum-normals}) and an appropriately small $\\varepsilon>0$.\nThe angle of incidence $\\gamma_{l,1}$ between the direction vector\nof the incident ray $\\omega_{l}^{\\perp}$ and normal $\\mathfrak{n}$\n(see figure \\ref{fig:draft-Snells-law}) can be calculated by the\nscalar product in $\\mathbb{R}^{2}$\n\n\n", "index": 33, "text": "\\begin{equation}\n\\gamma_{l,1}=\\arccos\\left|\\left\\langle \\omega_{l}^{\\perp},\\,\\mathfrak{n}\\right\\rangle \\right|\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E17.m1\" class=\"ltx_Math\" alttext=\"\\gamma_{l,1}=\\arccos\\left|\\left\\langle\\omega_{l}^{\\perp},\\,\\mathfrak{n}\\right%&#10;\\rangle\\right|\" display=\"block\"><mrow><msub><mi>\u03b3</mi><mrow><mi>l</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>=</mo><mrow><mi>arccos</mi><mo>\u2061</mo><mrow><mo>|</mo><mrow><mo>\u27e8</mo><msubsup><mi>\u03c9</mi><mi>l</mi><mo>\u27c2</mo></msubsup><mo rspace=\"4.2pt\">,</mo><mi>\ud835\udd2b</mi><mo>\u27e9</mo></mrow><mo>|</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nThe next direction vector $\\omega_{l+1}$ can be easily derived by\na rotation of $\\omega_{l}:=\\omega\\left(\\varphi_{l}\\right)$ around\nan angle $\\theta=\\pm\\left(\\gamma_{l,1}-\\gamma_{l,2}\\right)$ with\nthe rotation matrix \n\n\n", "itemtype": "equation", "pos": 23564, "prevtext": "\nand the angle of the refracted ray can be obtained by\n\n", "index": 35, "text": "\\begin{equation}\n\\gamma_{l,2}=\\left\\{ \\begin{array}{lcl}\n{\\displaystyle \\pi-\\gamma_{l,1}}, &  & \\mathrm{for\\,\\,}n_{l,1}>n_{l,2}\\wedge\\gamma_{l,1}\\geq\\arcsin\\frac{n_{l,2}}{n_{l,1}}\\mathrm{\\,\\,(total\\,reflection)},\\\\\n{\\displaystyle \\arcsin\\frac{n_{l,1}\\sin\\gamma_{l,1}}{n_{l,2}},} &  & \\mathrm{otherwise}.\n\\end{array}\\right.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E18.m1\" class=\"ltx_Math\" alttext=\"\\gamma_{l,2}=\\left\\{\\begin{array}[]{lcl}{\\displaystyle\\pi-\\gamma_{l,1}},&amp;&amp;%&#10;\\mathrm{for\\,\\,}n_{l,1}&gt;n_{l,2}\\wedge\\gamma_{l,1}\\geq\\arcsin\\frac{n_{l,2}}{n_{%&#10;l,1}}\\mathrm{\\,\\,(total\\,reflection)},\\\\&#10;{\\displaystyle\\arcsin\\frac{n_{l,1}\\sin\\gamma_{l,1}}{n_{l,2}},}&amp;&amp;\\mathrm{%&#10;otherwise}.\\end{array}\\right.\" display=\"block\"><mrow><msub><mi>\u03b3</mi><mrow><mi>l</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>=</mo><mrow><mo>{</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><mrow><mi>\u03c0</mi><mo>-</mo><msub><mi>\u03b3</mi><mrow><mi>l</mi><mo>,</mo><mn>1</mn></mrow></msub></mrow><mo>,</mo></mrow></mtd><mtd/><mtd columnalign=\"left\"><mrow><mrow><mrow><mpadded width=\"+3.4pt\"><mi>for</mi></mpadded><mo>\u2062</mo><msub><mi>n</mi><mrow><mi>l</mi><mo>,</mo><mn>1</mn></mrow></msub></mrow><mo>&gt;</mo><mrow><msub><mi>n</mi><mrow><mi>l</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>\u2227</mo><msub><mi>\u03b3</mi><mrow><mi>l</mi><mo>,</mo><mn>1</mn></mrow></msub></mrow><mo>\u2265</mo><mrow><mrow><mi>arcsin</mi><mo>\u2061</mo><mpadded width=\"+3.4pt\"><mfrac><msub><mi>n</mi><mrow><mi>l</mi><mo>,</mo><mn>2</mn></mrow></msub><msub><mi>n</mi><mrow><mi>l</mi><mo>,</mo><mn>1</mn></mrow></msub></mfrac></mpadded></mrow><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mpadded width=\"+1.7pt\"><mi>total</mi></mpadded><mo>\u2062</mo><mi>reflection</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mrow><mrow><mi>arcsin</mi><mo>\u2061</mo><mfrac><mrow><msub><mi>n</mi><mrow><mi>l</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mi>sin</mi><mo>\u2061</mo><msub><mi>\u03b3</mi><mrow><mi>l</mi><mo>,</mo><mn>1</mn></mrow></msub></mrow></mrow><msub><mi>n</mi><mrow><mi>l</mi><mo>,</mo><mn>2</mn></mrow></msub></mfrac></mrow><mo>,</mo></mrow></mtd><mtd/><mtd columnalign=\"left\"><mrow><mi>otherwise</mi><mo>.</mo></mrow></mtd></mtr></mtable><mi/></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nsee figure \\ref{fig:Snell-parametrization}.  The sign of $\\theta$\ndepends on the orientation of the normal $\\mathfrak{n}$ to the incident\nray, see (\\ref{eq:omega-l-plus-1-cases}). After applying angle sum\nidentities, the new angle $\\varphi_{l+1}$ and the unit vector $\\omega_{l+1}$\nare computed by\n\n\n", "itemtype": "equation", "pos": 24121, "prevtext": "\nThe next direction vector $\\omega_{l+1}$ can be easily derived by\na rotation of $\\omega_{l}:=\\omega\\left(\\varphi_{l}\\right)$ around\nan angle $\\theta=\\pm\\left(\\gamma_{l,1}-\\gamma_{l,2}\\right)$ with\nthe rotation matrix \n\n\n", "index": 37, "text": "\\begin{equation}\nR_{\\theta}:=\\left(\\begin{array}{cc}\n\\cos\\theta & -\\sin\\theta\\\\\n\\sin\\theta & \\cos\\theta\n\\end{array}\\right)\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E19.m1\" class=\"ltx_Math\" alttext=\"R_{\\theta}:=\\left(\\begin{array}[]{cc}\\cos\\theta&amp;-\\sin\\theta\\\\&#10;\\sin\\theta&amp;\\cos\\theta\\end{array}\\right)\" display=\"block\"><mrow><msub><mi>R</mi><mi>\u03b8</mi></msub><mo>:=</mo><mrow><mo>(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><mi>cos</mi><mo>\u2061</mo><mi>\u03b8</mi></mrow></mtd><mtd columnalign=\"center\"><mrow><mo>-</mo><mrow><mi>sin</mi><mo>\u2061</mo><mi>\u03b8</mi></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><mi>sin</mi><mo>\u2061</mo><mi>\u03b8</mi></mrow></mtd><mtd columnalign=\"center\"><mrow><mi>cos</mi><mo>\u2061</mo><mi>\u03b8</mi></mrow></mtd></mtr></mtable><mo>)</mo></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nThe next distance from the origin $s_{l+1}$ of partial ray $L_{l+1}$\nfollows directly from the intersection of the lines $\\left(0+u\\omega_{l+1}\\right)\\cap\\left(\\Xi_{\\tilde{k}}(\\tilde{\\sigma})+t\\omega_{l+1}^{\\perp}\\right)$\nwith parameters $t$ and $u$. We obtain with $\\Xi_{\\tilde{k}}(\\tilde{\\sigma}):=\\left(\\xi_{1},\\xi_{2}\\right)^{T}$ \n\n\n", "itemtype": "equation", "pos": 24558, "prevtext": "\nsee figure \\ref{fig:Snell-parametrization}.  The sign of $\\theta$\ndepends on the orientation of the normal $\\mathfrak{n}$ to the incident\nray, see (\\ref{eq:omega-l-plus-1-cases}). After applying angle sum\nidentities, the new angle $\\varphi_{l+1}$ and the unit vector $\\omega_{l+1}$\nare computed by\n\n\n", "index": 39, "text": "\\begin{equation}\n\\omega_{l+1}\\left(\\varphi_{l+1}\\right):=\\left\\{ \\begin{array}{ll}\n\\begin{array}[t]{c}\n\\overset{=:\\varphi_{l+1}}{\\omega(\\overbrace{\\begin{array}{llc}\n\\gamma_{l,1}-\\gamma_{l,2} & + & \\varphi_{l}\\end{array}}}),\\end{array} & \\mathrm{for\\,}\\left\\langle \\omega_{l}^{\\perp},\\,\\mathfrak{n}\\right\\rangle <0\\wedge\\left\\langle \\omega_{l}^{\\perp},\\,\\mathfrak{n}^{\\perp}\\right\\rangle \\leq0\\\\\n\\begin{array}{c}\n\\omega(\\begin{array}{llc}\n\\gamma_{l,1}-\\gamma_{l,2} & + & \\varphi_{l}\\end{array}),\\end{array} & \\mathrm{for\\,}\\left\\langle \\omega_{l}^{\\perp},\\,\\mathfrak{n}\\right\\rangle >0\\wedge\\left\\langle \\omega_{l}^{\\perp},\\,\\mathfrak{n}^{\\perp}\\right\\rangle \\geq0\\\\\n\\begin{array}{c}\n\\omega(\\begin{array}{llc}\n\\gamma_{l,2}-\\gamma_{l,1} & + & \\varphi_{l}\\end{array}),\\end{array} & \\mathrm{for\\,}\\left\\langle \\omega_{l}^{\\perp},\\,\\mathfrak{n}\\right\\rangle \\leq0\\wedge\\left\\langle \\omega_{l}^{\\perp},\\,\\mathfrak{n}^{\\perp}\\right\\rangle >0\\\\\n\\begin{array}[b]{c}\n\\omega(\\begin{array}[t]{llc}\n\\underset{=:\\theta}{\\underbrace{\\gamma_{l,2}-\\gamma_{l,1}}} & + & \\varphi_{l}\\end{array}),\\end{array} & \\mathrm{for\\,}\\left\\langle \\omega_{l}^{\\perp},\\,\\mathfrak{n}\\right\\rangle \\geq0\\wedge\\left\\langle \\omega_{l}^{\\perp},\\,\\mathfrak{n}^{\\perp}\\right\\rangle <0\n\\end{array}\\right..\\label{eq:omega-l-plus-1-cases}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E20.m1\" class=\"ltx_Math\" alttext=\"\\omega_{l+1}\\left(\\varphi_{l+1}\\right):=\\left\\{\\begin{array}[]{ll}\\begin{array%&#10;}[t]{c}\\overset{=:\\varphi_{l+1}}{\\omega(\\overbrace{\\begin{array}[]{llc}\\gamma_%&#10;{l,1}-\\gamma_{l,2}&amp;+&amp;\\varphi_{l}\\end{array}}}),\\end{array}&amp;\\mathrm{for\\,}\\left%&#10;\\langle\\omega_{l}^{\\perp},\\,\\mathfrak{n}\\right\\rangle&lt;0\\wedge\\left\\langle%&#10;\\omega_{l}^{\\perp},\\,\\mathfrak{n}^{\\perp}\\right\\rangle\\leq 0\\\\&#10;\\begin{array}[]{c}\\omega(\\begin{array}[]{llc}\\gamma_{l,1}-\\gamma_{l,2}&amp;+&amp;%&#10;\\varphi_{l}\\end{array}),\\end{array}&amp;\\mathrm{for\\,}\\left\\langle\\omega_{l}^{%&#10;\\perp},\\,\\mathfrak{n}\\right\\rangle&gt;0\\wedge\\left\\langle\\omega_{l}^{\\perp},\\,%&#10;\\mathfrak{n}^{\\perp}\\right\\rangle\\geq 0\\\\&#10;\\begin{array}[]{c}\\omega(\\begin{array}[]{llc}\\gamma_{l,2}-\\gamma_{l,1}&amp;+&amp;%&#10;\\varphi_{l}\\end{array}),\\end{array}&amp;\\mathrm{for\\,}\\left\\langle\\omega_{l}^{%&#10;\\perp},\\,\\mathfrak{n}\\right\\rangle\\leq 0\\wedge\\left\\langle\\omega_{l}^{\\perp},%&#10;\\,\\mathfrak{n}^{\\perp}\\right\\rangle&gt;0\\\\&#10;\\begin{array}[b]{c}\\omega(\\begin{array}[t]{llc}\\underset{=:\\theta}{\\underbrace%&#10;{\\gamma_{l,2}-\\gamma_{l,1}}}&amp;+&amp;\\varphi_{l}\\end{array}),\\end{array}&amp;\\mathrm{for%&#10;\\,}\\left\\langle\\omega_{l}^{\\perp},\\,\\mathfrak{n}\\right\\rangle\\geq 0\\wedge\\left%&#10;\\langle\\omega_{l}^{\\perp},\\,\\mathfrak{n}^{\\perp}\\right\\rangle&lt;0\\end{array}%&#10;\\right..\" display=\"block\"><mrow><mrow><mrow><msub><mi>\u03c9</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><mrow><mo>(</mo><msub><mi>\u03c6</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>)</mo></mrow></mrow><mo>:=</mo><mrow><mo>{</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mtable align=\"bottom1\" displaystyle=\"true\"><mtr><mtd columnalign=\"center\"><mrow><mover accent=\"true\"><mrow><mi>\u03c9</mi><mrow><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mtable columnspacing=\"5pt\" displaystyle=\"true\"><mtr><mtd columnalign=\"left\"><mrow><msub><mi>\u03b3</mi><mrow><mi>l</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>-</mo><msub><mi>\u03b3</mi><mrow><mi>l</mi><mo>,</mo><mn>2</mn></mrow></msub></mrow></mtd><mtd columnalign=\"left\"><mo>+</mo></mtd><mtd columnalign=\"center\"><msub><mi>\u03c6</mi><mi>l</mi></msub></mtd></mtr></mtable><mo>\u23de</mo></mover></mrow></mrow><mrow><mo>=</mo><mo>:</mo><msub><mi>\u03c6</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mover><mo stretchy=\"false\">)</mo><mo>,</mo></mrow></mtd></mtr></mtable></mtd><mtd columnalign=\"left\"><mrow><mrow><mpadded width=\"+1.7pt\"><mi>for</mi></mpadded><mo>\u2062</mo><mrow><mo>\u27e8</mo><msubsup><mi>\u03c9</mi><mi>l</mi><mo>\u27c2</mo></msubsup><mo rspace=\"4.2pt\">,</mo><mi>\ud835\udd2b</mi><mo>\u27e9</mo></mrow></mrow><mo>&lt;</mo><mrow><mn>0</mn><mo>\u2227</mo><mrow><mo>\u27e8</mo><msubsup><mi>\u03c9</mi><mi>l</mi><mo>\u27c2</mo></msubsup><mo rspace=\"4.2pt\">,</mo><msup><mi>\ud835\udd2b</mi><mo>\u27c2</mo></msup><mo>\u27e9</mo></mrow></mrow><mo>\u2264</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mtable displaystyle=\"true\"><mtr><mtd columnalign=\"center\"><mrow><mrow><mi>\u03c9</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\"><mtr><mtd columnalign=\"left\"><mrow><msub><mi>\u03b3</mi><mrow><mi>l</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>-</mo><msub><mi>\u03b3</mi><mrow><mi>l</mi><mo>,</mo><mn>2</mn></mrow></msub></mrow></mtd><mtd columnalign=\"left\"><mo>+</mo></mtd><mtd columnalign=\"center\"><msub><mi>\u03c6</mi><mi>l</mi></msub></mtd></mtr></mtable><mo stretchy=\"false\">)</mo></mrow></mrow><mo>,</mo></mrow></mtd></mtr></mtable></mtd><mtd columnalign=\"left\"><mrow><mrow><mpadded width=\"+1.7pt\"><mi>for</mi></mpadded><mo>\u2062</mo><mrow><mo>\u27e8</mo><msubsup><mi>\u03c9</mi><mi>l</mi><mo>\u27c2</mo></msubsup><mo rspace=\"4.2pt\">,</mo><mi>\ud835\udd2b</mi><mo>\u27e9</mo></mrow></mrow><mo>&gt;</mo><mrow><mn>0</mn><mo>\u2227</mo><mrow><mo>\u27e8</mo><msubsup><mi>\u03c9</mi><mi>l</mi><mo>\u27c2</mo></msubsup><mo rspace=\"4.2pt\">,</mo><msup><mi>\ud835\udd2b</mi><mo>\u27c2</mo></msup><mo>\u27e9</mo></mrow></mrow><mo>\u2265</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mtable displaystyle=\"true\"><mtr><mtd columnalign=\"center\"><mrow><mrow><mi>\u03c9</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\"><mtr><mtd columnalign=\"left\"><mrow><msub><mi>\u03b3</mi><mrow><mi>l</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>-</mo><msub><mi>\u03b3</mi><mrow><mi>l</mi><mo>,</mo><mn>1</mn></mrow></msub></mrow></mtd><mtd columnalign=\"left\"><mo>+</mo></mtd><mtd columnalign=\"center\"><msub><mi>\u03c6</mi><mi>l</mi></msub></mtd></mtr></mtable><mo stretchy=\"false\">)</mo></mrow></mrow><mo>,</mo></mrow></mtd></mtr></mtable></mtd><mtd columnalign=\"left\"><mrow><mrow><mpadded width=\"+1.7pt\"><mi>for</mi></mpadded><mo>\u2062</mo><mrow><mo>\u27e8</mo><msubsup><mi>\u03c9</mi><mi>l</mi><mo>\u27c2</mo></msubsup><mo rspace=\"4.2pt\">,</mo><mi>\ud835\udd2b</mi><mo>\u27e9</mo></mrow></mrow><mo>\u2264</mo><mrow><mn>0</mn><mo>\u2227</mo><mrow><mo>\u27e8</mo><msubsup><mi>\u03c9</mi><mi>l</mi><mo>\u27c2</mo></msubsup><mo rspace=\"4.2pt\">,</mo><msup><mi>\ud835\udd2b</mi><mo>\u27c2</mo></msup><mo>\u27e9</mo></mrow></mrow><mo>&gt;</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mtable align=\"bottom\" displaystyle=\"true\"><mtr><mtd columnalign=\"center\"><mrow><mrow><mi>\u03c9</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mtable align=\"bottom1\" columnspacing=\"5pt\" displaystyle=\"true\"><mtr><mtd columnalign=\"left\"><munder accentunder=\"true\"><munder accentunder=\"true\"><mrow><msub><mi>\u03b3</mi><mrow><mi>l</mi><mo>,</mo><mn>2</mn></mrow></msub><mo>-</mo><msub><mi>\u03b3</mi><mrow><mi>l</mi><mo>,</mo><mn>1</mn></mrow></msub></mrow><mo>\u23df</mo></munder><mrow><mo>=</mo><mo>:</mo><mi>\u03b8</mi></mrow></munder></mtd><mtd columnalign=\"left\"><mo>+</mo></mtd><mtd columnalign=\"center\"><msub><mi>\u03c6</mi><mi>l</mi></msub></mtd></mtr></mtable><mo stretchy=\"false\">)</mo></mrow></mrow><mo>,</mo></mrow></mtd></mtr></mtable></mtd><mtd columnalign=\"left\"><mrow><mrow><mpadded width=\"+1.7pt\"><mi>for</mi></mpadded><mo>\u2062</mo><mrow><mo>\u27e8</mo><msubsup><mi>\u03c9</mi><mi>l</mi><mo>\u27c2</mo></msubsup><mo rspace=\"4.2pt\">,</mo><mi>\ud835\udd2b</mi><mo>\u27e9</mo></mrow></mrow><mo>\u2265</mo><mrow><mn>0</mn><mo>\u2227</mo><mrow><mo>\u27e8</mo><msubsup><mi>\u03c9</mi><mi>l</mi><mo>\u27c2</mo></msubsup><mo rspace=\"4.2pt\">,</mo><msup><mi>\ud835\udd2b</mi><mo>\u27c2</mo></msup><mo>\u27e9</mo></mrow></mrow><mo>&lt;</mo><mn>0</mn></mrow></mtd></mtr></mtable><mi/></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nConsequently, the complete refracted ray path is given by the union\n\n", "itemtype": "equation", "pos": 26207, "prevtext": "\nThe next distance from the origin $s_{l+1}$ of partial ray $L_{l+1}$\nfollows directly from the intersection of the lines $\\left(0+u\\omega_{l+1}\\right)\\cap\\left(\\Xi_{\\tilde{k}}(\\tilde{\\sigma})+t\\omega_{l+1}^{\\perp}\\right)$\nwith parameters $t$ and $u$. We obtain with $\\Xi_{\\tilde{k}}(\\tilde{\\sigma}):=\\left(\\xi_{1},\\xi_{2}\\right)^{T}$ \n\n\n", "index": 41, "text": "\\begin{equation}\ns_{l+1}=\\left|\\left(0+u\\omega_{l+1}\\right)\\cap\\left(\\Xi_{\\tilde{k}}(\\tilde{\\sigma})+t\\omega_{l+1}^{\\perp}\\right)\\right|=\\left|\\cos\\varphi_{l+1}\\xi_{1}+\\sin\\varphi_{l+1}\\xi_{2}\\right|.\\label{eq:s-l-plus-1-calculation}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E21.m1\" class=\"ltx_Math\" alttext=\"s_{l+1}=\\left|\\left(0+u\\omega_{l+1}\\right)\\cap\\left(\\Xi_{\\tilde{k}}(\\tilde{%&#10;\\sigma})+t\\omega_{l+1}^{\\perp}\\right)\\right|=\\left|\\cos\\varphi_{l+1}\\xi_{1}+%&#10;\\sin\\varphi_{l+1}\\xi_{2}\\right|.\" display=\"block\"><mrow><mrow><msub><mi>s</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mrow><mo>|</mo><mrow><mrow><mo>(</mo><mrow><mn>0</mn><mo>+</mo><mrow><mi>u</mi><mo>\u2062</mo><msub><mi>\u03c9</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mrow><mo>)</mo></mrow><mo>\u2229</mo><mrow><mo>(</mo><mrow><mrow><msub><mi mathvariant=\"normal\">\u039e</mi><mover accent=\"true\"><mi>k</mi><mo stretchy=\"false\">~</mo></mover></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mi>\u03c3</mi><mo stretchy=\"false\">~</mo></mover><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mi>t</mi><mo>\u2062</mo><msubsup><mi>\u03c9</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow><mo>\u27c2</mo></msubsup></mrow></mrow><mo>)</mo></mrow></mrow><mo>|</mo></mrow><mo>=</mo><mrow><mo>|</mo><mrow><mrow><mi>cos</mi><mo>\u2061</mo><mrow><msub><mi>\u03c6</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><msub><mi>\u03be</mi><mn>1</mn></msub></mrow></mrow><mo>+</mo><mrow><mi>sin</mi><mo>\u2061</mo><mrow><msub><mi>\u03c6</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>\u2062</mo><msub><mi>\u03be</mi><mn>2</mn></msub></mrow></mrow></mrow><mo>|</mo></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nof all partial rays $L_{l}\\left(\\varphi_{l},s_{l}\\right)$ defined\nby (\\ref{eq:omega-l-plus-1-cases}) and (\\ref{eq:s-l-plus-1-calculation})\nwith an initial direction $\\varphi=\\varphi_{1}$ and distance $s=s_{1}$,\n$t_{0}^{\\mathrm{if}}=-\\infty$, $t_{\\tilde{K}+1}^{\\mathrm{if}}=\\infty$\nand $\\hat{K}$ the number of intersected interfaces. $\\hat{K}$ is\nunknown at the beginning and depends on the ray path.\n\\begin{figure}\n\\begin{centering}\n\\includegraphics[width=0.5\\textwidth]{Broken_Ray}\n\\par\\end{centering}\n\n\\caption{Snell's law and parametrization of a refracted THz ray \\label{fig:Snell-parametrization}}\n\\end{figure}\n\n\\begin{rem}\nPlease note that determining the ray paths depends on the refractive\nindex $n$, which is the unknown quantity in our inverse problem.\nTherefore, the actual ray paths are also unknown in the beginning\nand are approached within the reconstruction process.\\end{rem}\n\\begin{problem}\nThe inverse problem consists in determining the complex refractive\nindex \n\n", "itemtype": "equation", "pos": 26524, "prevtext": "\nConsequently, the complete refracted ray path is given by the union\n\n", "index": 43, "text": "\\begin{equation}\nL\\left(\\varphi,s\\right):=\\bigcup_{l=1}^{\\hat{K}+1}\\left\\{ \\Gamma_{l}(t):\\,t\\in\\left[t_{l-1}^{\\mathrm{if}},\\,t_{l}^{\\mathrm{if}}\\right]\\right\\} \n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E22.m1\" class=\"ltx_Math\" alttext=\"L\\left(\\varphi,s\\right):=\\bigcup_{l=1}^{\\hat{K}+1}\\left\\{\\Gamma_{l}(t):\\,t\\in%&#10;\\left[t_{l-1}^{\\mathrm{if}},\\,t_{l}^{\\mathrm{if}}\\right]\\right\\}\" display=\"block\"><mrow><mrow><mi>L</mi><mo>\u2062</mo><mrow><mo>(</mo><mi>\u03c6</mi><mo>,</mo><mi>s</mi><mo>)</mo></mrow></mrow><mo>:=</mo><mrow><munderover><mo largeop=\"true\" mathsize=\"160%\" movablelimits=\"false\" stretchy=\"false\" symmetric=\"true\">\u22c3</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mrow><mover accent=\"true\"><mi>K</mi><mo stretchy=\"false\">^</mo></mover><mo>+</mo><mn>1</mn></mrow></munderover><mrow><mo>{</mo><mrow><msub><mi mathvariant=\"normal\">\u0393</mi><mi>l</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo rspace=\"4.2pt\">:</mo><mrow><mi>t</mi><mo>\u2208</mo><mrow><mo>[</mo><msubsup><mi>t</mi><mrow><mi>l</mi><mo>-</mo><mn>1</mn></mrow><mi>if</mi></msubsup><mo rspace=\"4.2pt\">,</mo><msubsup><mi>t</mi><mi>l</mi><mi>if</mi></msubsup><mo>]</mo></mrow></mrow><mo>}</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nfrom the knowledge of the measured data $g_{\\mathrm{abs}}(\\varphi_{i},s_{j})=\\ln\\left(\\frac{1}{\\tau(\\varphi_{i},s_{j})}\\right)$\nand $g_{\\mathrm{ref}}(\\varphi_{i},s_{j})=d(\\varphi_{i},s_{j})$ of\na parallel scanning geometry with (inital) angles $\\varphi_{i}=\\frac{2\\pi(i-1)}{p}$\nfor $i=1,...,p$ and (initial) distances $s_{j}=\\frac{R}{q}j,$ for\n$j=-q,...,q$. As we do not consider straight ray paths, we usually\nhave $g_{\\mathrm{abs}}(-\\varphi,s)\\neq g_{\\mathrm{abs}}(\\varphi,s)$\nor $g_{\\mathrm{ref}}(-\\varphi,s)\\neq g_{\\mathrm{ref}}(\\varphi,s)$\nin contrast to X-ray CT. So the angles $\\varphi_{i}$ should be evenly\ndistributed over the interval $\\left[0,\\,2\\pi\\right)$. Our task is\nto find the best possible approximation of $\\tilde{n}$ satisfying\n\n", "itemtype": "equation", "pos": 27682, "prevtext": "\nof all partial rays $L_{l}\\left(\\varphi_{l},s_{l}\\right)$ defined\nby (\\ref{eq:omega-l-plus-1-cases}) and (\\ref{eq:s-l-plus-1-calculation})\nwith an initial direction $\\varphi=\\varphi_{1}$ and distance $s=s_{1}$,\n$t_{0}^{\\mathrm{if}}=-\\infty$, $t_{\\tilde{K}+1}^{\\mathrm{if}}=\\infty$\nand $\\hat{K}$ the number of intersected interfaces. $\\hat{K}$ is\nunknown at the beginning and depends on the ray path.\n\\begin{figure}\n\\begin{centering}\n\\includegraphics[width=0.5\\textwidth]{Broken_Ray}\n\\par\\end{centering}\n\n\\caption{Snell's law and parametrization of a refracted THz ray \\label{fig:Snell-parametrization}}\n\\end{figure}\n\n\\begin{rem}\nPlease note that determining the ray paths depends on the refractive\nindex $n$, which is the unknown quantity in our inverse problem.\nTherefore, the actual ray paths are also unknown in the beginning\nand are approached within the reconstruction process.\\end{rem}\n\\begin{problem}\nThe inverse problem consists in determining the complex refractive\nindex \n\n", "index": 45, "text": "\\begin{equation}\n\\tilde{n}(x)=n(x)+i\\alpha(x)\\frac{c_{0}}{4\\pi f},\\qquad x\\in\\Omega,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E23.m1\" class=\"ltx_Math\" alttext=\"\\tilde{n}(x)=n(x)+i\\alpha(x)\\frac{c_{0}}{4\\pi f},\\qquad x\\in\\Omega,\" display=\"block\"><mrow><mrow><mrow><mrow><mover accent=\"true\"><mi>n</mi><mo stretchy=\"false\">~</mo></mover><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>n</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>+</mo><mrow><mi>i</mi><mo>\u2062</mo><mi>\u03b1</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mfrac><msub><mi>c</mi><mn>0</mn></msub><mrow><mn>4</mn><mo>\u2062</mo><mi>\u03c0</mi><mo>\u2062</mo><mi>f</mi></mrow></mfrac></mrow></mrow></mrow><mo rspace=\"22.5pt\">,</mo><mrow><mi>x</mi><mo>\u2208</mo><mi mathvariant=\"normal\">\u03a9</mi></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nfor $i=1,...,p$ and $j=-q,...,q$.\n\n\\newpage{}\n\\end{problem}\n\n\\section{Algorithm development\\label{sec:algorithm-development}}\n\nIn the following, we develop a numerical algorithm for the calculation\nof the complex refractive index $\\tilde{n}(x)=n(x)+i\\alpha(x)\\frac{c_{0}}{4\\pi f}$.\nSince algorithms based on partial differential equations such as the\nwave equation are very time-consuming, an efficient reconstruction\nshall only consider dominating physical effects. Poor reconstructions,\nwhich arise from the application of conventional reconstruction algorithms\nfrom computed tomography to THz data, are often based on the missing\nconsideration of refraction and reflection losses. \n\nTherefore, we would like to modify ART for THz tomography. This is\ndone by using a priori information (i.~e.~the knowledge of interfaces)\nand considering relevant physical laws (Snell's law and reflection\nlosses according to Fresnel equations). This results in a method, \nwhich takes refraction as well\nas transmission into account and determines simultaneously the refractive index\nand the absorption coefficient from measurements of path difference\nand intensity data.\n\n\n\\subsection{ART}\n\nOur method is based on the classical ART as described in\ne. g. \\cite[pp. 128, 137 ff.]{Natterer2001}. So we first give a brief\noverview of ART. The main idea behind of this method is the application of Kaczmarz's\nmethod to Radon's integral equation. We search for the solution of\nthe system\n\n", "itemtype": "equation", "pos": 28530, "prevtext": "\nfrom the knowledge of the measured data $g_{\\mathrm{abs}}(\\varphi_{i},s_{j})=\\ln\\left(\\frac{1}{\\tau(\\varphi_{i},s_{j})}\\right)$\nand $g_{\\mathrm{ref}}(\\varphi_{i},s_{j})=d(\\varphi_{i},s_{j})$ of\na parallel scanning geometry with (inital) angles $\\varphi_{i}=\\frac{2\\pi(i-1)}{p}$\nfor $i=1,...,p$ and (initial) distances $s_{j}=\\frac{R}{q}j,$ for\n$j=-q,...,q$. As we do not consider straight ray paths, we usually\nhave $g_{\\mathrm{abs}}(-\\varphi,s)\\neq g_{\\mathrm{abs}}(\\varphi,s)$\nor $g_{\\mathrm{ref}}(-\\varphi,s)\\neq g_{\\mathrm{ref}}(\\varphi,s)$\nin contrast to X-ray CT. So the angles $\\varphi_{i}$ should be evenly\ndistributed over the interval $\\left[0,\\,2\\pi\\right)$. Our task is\nto find the best possible approximation of $\\tilde{n}$ satisfying\n\n", "index": 47, "text": "\\begin{equation}\n\\begin{array}{ccc}\n{\\displaystyle \\intop_{L(\\varphi_{i},s_{j})}\\left(n(x)-1\\right)\\,\\mathrm{d}x=g_{\\mathrm{ref}}(\\varphi_{i},s_{j})} & \\mathrm{and} & {\\displaystyle \\intop_{L(\\varphi_{i},s_{j})}\\alpha(x)\\,\\mathrm{d}x=g_{\\mathrm{abs}}(\\varphi_{i},s_{j})}\\end{array}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E24.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{ccc}{\\displaystyle\\intop_{L(\\varphi_{i},s_{j})}\\left(n(x)-1%&#10;\\right)\\,\\mathrm{d}x=g_{\\mathrm{ref}}(\\varphi_{i},s_{j})}&amp;\\mathrm{and}&amp;{%&#10;\\displaystyle\\intop_{L(\\varphi_{i},s_{j})}\\alpha(x)\\,\\mathrm{d}x=g_{\\mathrm{%&#10;abs}}(\\varphi_{i},s_{j})}\\end{array}\" display=\"block\"><mtable columnspacing=\"5pt\" displaystyle=\"true\"><mtr><mtd columnalign=\"center\"><mrow><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u222b</mo><mrow><mi>L</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c6</mi><mi>i</mi></msub><mo>,</mo><msub><mi>s</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></munder><mrow><mrow><mo>(</mo><mrow><mrow><mi>n</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mn>1</mn></mrow><mo rspace=\"4.2pt\">)</mo></mrow><mo>\u2062</mo><mrow><mo>d</mo><mi>x</mi></mrow></mrow></mrow><mo>=</mo><mrow><msub><mi>g</mi><mi>ref</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c6</mi><mi>i</mi></msub><mo>,</mo><msub><mi>s</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mtd><mtd columnalign=\"center\"><mi>and</mi></mtd><mtd columnalign=\"center\"><mrow><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u222b</mo><mrow><mi>L</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c6</mi><mi>i</mi></msub><mo>,</mo><msub><mi>s</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></munder><mrow><mi>\u03b1</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>d</mo><mi>x</mi></mrow></mrow></mrow><mo>=</mo><mrow><msub><mi>g</mi><mi>abs</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\u03c6</mi><mi>i</mi></msub><mo>,</mo><msub><mi>s</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nwhere $L^{\\nu}:=L(\\varphi_{\\nu},s_{\\nu})$ are straight lines, $f$\na function (refractive index $f=n-1$ or absorption coefficient $f=\\alpha$),\n$g^{\\nu}:=g(\\varphi_{\\nu},s_{\\nu})$ the measured data (path difference\nor intensity data) and $N=p(2q+1)$. Let \n\n", "itemtype": "equation", "pos": 30295, "prevtext": "\nfor $i=1,...,p$ and $j=-q,...,q$.\n\n\\newpage{}\n\\end{problem}\n\n\\section{Algorithm development\\label{sec:algorithm-development}}\n\nIn the following, we develop a numerical algorithm for the calculation\nof the complex refractive index $\\tilde{n}(x)=n(x)+i\\alpha(x)\\frac{c_{0}}{4\\pi f}$.\nSince algorithms based on partial differential equations such as the\nwave equation are very time-consuming, an efficient reconstruction\nshall only consider dominating physical effects. Poor reconstructions,\nwhich arise from the application of conventional reconstruction algorithms\nfrom computed tomography to THz data, are often based on the missing\nconsideration of refraction and reflection losses. \n\nTherefore, we would like to modify ART for THz tomography. This is\ndone by using a priori information (i.~e.~the knowledge of interfaces)\nand considering relevant physical laws (Snell's law and reflection\nlosses according to Fresnel equations). This results in a method, \nwhich takes refraction as well\nas transmission into account and determines simultaneously the refractive index\nand the absorption coefficient from measurements of path difference\nand intensity data.\n\n\n\\subsection{ART}\n\nOur method is based on the classical ART as described in\ne. g. \\cite[pp. 128, 137 ff.]{Natterer2001}. So we first give a brief\noverview of ART. The main idea behind of this method is the application of Kaczmarz's\nmethod to Radon's integral equation. We search for the solution of\nthe system\n\n", "index": 49, "text": "\\begin{equation}\n\\intop_{L^{\\nu}}f(x)\\,\\mathrm{d}x=g^{\\nu},\\qquad\\nu=1,...,N,\\qquad x\\in\\Omega\\label{eq:ART-eq-integrals}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E25.m1\" class=\"ltx_Math\" alttext=\"\\intop_{L^{\\nu}}f(x)\\,\\mathrm{d}x=g^{\\nu},\\qquad\\nu=1,...,N,\\qquad x\\in\\Omega\" display=\"block\"><mrow><mrow><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u222b</mo><msup><mi>L</mi><mi>\u03bd</mi></msup></munder><mrow><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>d</mo><mi>x</mi></mrow></mrow></mrow><mo>=</mo><msup><mi>g</mi><mi>\u03bd</mi></msup></mrow><mo rspace=\"22.5pt\">,</mo><mrow><mrow><mi>\u03bd</mi><mo>=</mo><mrow><mn>1</mn><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><mi>N</mi></mrow></mrow><mo rspace=\"22.5pt\">,</mo><mrow><mi>x</mi><mo>\u2208</mo><mi mathvariant=\"normal\">\u03a9</mi></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nbe a pixel discretization of the domain $\\Omega$ with pixels $S_{\\mu},\\,\\mu=1,...,M$.\nWe obtain a linear system by discretizing $f$ via \n\n\n", "itemtype": "equation", "pos": 30686, "prevtext": "\nwhere $L^{\\nu}:=L(\\varphi_{\\nu},s_{\\nu})$ are straight lines, $f$\na function (refractive index $f=n-1$ or absorption coefficient $f=\\alpha$),\n$g^{\\nu}:=g(\\varphi_{\\nu},s_{\\nu})$ the measured data (path difference\nor intensity data) and $N=p(2q+1)$. Let \n\n", "index": 51, "text": "\\begin{equation}\n\\Omega\\subset\\bigcup_{\\mu=1}^{M}S_{\\mu}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E26.m1\" class=\"ltx_Math\" alttext=\"\\Omega\\subset\\bigcup_{\\mu=1}^{M}S_{\\mu}\" display=\"block\"><mrow><mi mathvariant=\"normal\">\u03a9</mi><mo>\u2282</mo><mrow><munderover><mo largeop=\"true\" mathsize=\"160%\" movablelimits=\"false\" stretchy=\"false\" symmetric=\"true\">\u22c3</mo><mrow><mi>\u03bc</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></munderover><msub><mi>S</mi><mi>\u03bc</mi></msub></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nwith characteristic functions\n\n\n", "itemtype": "equation", "pos": 30896, "prevtext": "\nbe a pixel discretization of the domain $\\Omega$ with pixels $S_{\\mu},\\,\\mu=1,...,M$.\nWe obtain a linear system by discretizing $f$ via \n\n\n", "index": 53, "text": "\\begin{equation}\nf(x)\\approx\\tilde{f}(x)=\\sum_{\\mu=1}^{M}f_{\\mu}\\chi_{\\mu}(x),\\qquad x\\in\\Omega,\\label{eq:f-discrete}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E27.m1\" class=\"ltx_Math\" alttext=\"f(x)\\approx\\tilde{f}(x)=\\sum_{\\mu=1}^{M}f_{\\mu}\\chi_{\\mu}(x),\\qquad x\\in\\Omega,\" display=\"block\"><mrow><mrow><mrow><mrow><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>\u2248</mo><mrow><mover accent=\"true\"><mi>f</mi><mo stretchy=\"false\">~</mo></mover><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>\u03bc</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></munderover><mrow><msub><mi>f</mi><mi>\u03bc</mi></msub><mo>\u2062</mo><msub><mi>\u03c7</mi><mi>\u03bc</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></mrow><mo rspace=\"22.5pt\">,</mo><mrow><mi>x</mi><mo>\u2208</mo><mi mathvariant=\"normal\">\u03a9</mi></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nThe integral is thus approximated by \n\n", "itemtype": "equation", "pos": 31060, "prevtext": "\nwith characteristic functions\n\n\n", "index": 55, "text": "\\begin{equation}\n\\chi_{\\mu}(x)=\\left\\{ \\begin{array}{l}\n1,\\qquad\\mathrm{if\\,}x\\in S_{\\mu},\\\\\n0,\\qquad\\mathrm{otherwise}.\n\\end{array}\\right.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E28.m1\" class=\"ltx_Math\" alttext=\"\\chi_{\\mu}(x)=\\left\\{\\begin{array}[]{l}1,\\qquad\\mathrm{if\\,}x\\in S_{\\mu},\\\\&#10;0,\\qquad\\mathrm{otherwise}.\\end{array}\\right.\" display=\"block\"><mrow><mrow><msub><mi>\u03c7</mi><mi>\u03bc</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo>{</mo><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><mrow><mrow><mrow><mn>1</mn><mo rspace=\"22.5pt\">,</mo><mrow><mpadded width=\"+1.7pt\"><mi>if</mi></mpadded><mo>\u2062</mo><mi>x</mi></mrow></mrow><mo>\u2208</mo><msub><mi>S</mi><mi>\u03bc</mi></msub></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><mrow><mrow><mn>0</mn><mo rspace=\"22.5pt\">,</mo><mi>otherwise</mi></mrow><mo>.</mo></mrow></mtd></mtr></mtable><mi/></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nwith $a_{\\nu\\mu}=\\mathrm{length}\\,(L^{\\nu}\\,\\cap\\,S_{\\mu})$. Now,\nwe define $a^{\\nu}:=\\left(a_{\\nu1},...,a_{\\nu M}\\right)^{T}\\in\\mathbb{R}^{M}$\nand\\linebreak{}\n$F=(f_{1},f_{2},\\text{...},f_{M})^{T}\\in\\mathbb{R}^{M}$. Using the\nscalar product in $\\mathbb{R}^{M}$, we obtain the discrete version\nof (\\ref{eq:ART-eq-integrals}), \n\n", "itemtype": "equation", "pos": 31253, "prevtext": "\nThe integral is thus approximated by \n\n", "index": 57, "text": "\\begin{equation}\n\\intop_{L^{\\nu}}f(x)\\,\\mathrm{d}x\\approx\\sum_{\\mu=1}^{M}a_{\\nu\\mu}f_{\\mu}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E29.m1\" class=\"ltx_Math\" alttext=\"\\intop_{L^{\\nu}}f(x)\\,\\mathrm{d}x\\approx\\sum_{\\mu=1}^{M}a_{\\nu\\mu}f_{\\mu}\" display=\"block\"><mrow><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u222b</mo><msup><mi>L</mi><mi>\u03bd</mi></msup></munder><mrow><mi>f</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo rspace=\"4.2pt\" stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo>d</mo><mi>x</mi></mrow></mrow></mrow><mo>\u2248</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>\u03bc</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></munderover><mrow><msub><mi>a</mi><mrow><mi>\u03bd</mi><mo>\u2062</mo><mi>\u03bc</mi></mrow></msub><mo>\u2062</mo><msub><mi>f</mi><mi>\u03bc</mi></msub></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nWe solve this linear system by applying Kaczmarz's method to (\\ref{eq:ART-eq-discrete}).\nThe iteration then reads as\n\n\n", "itemtype": "equation", "pos": 31686, "prevtext": "\nwith $a_{\\nu\\mu}=\\mathrm{length}\\,(L^{\\nu}\\,\\cap\\,S_{\\mu})$. Now,\nwe define $a^{\\nu}:=\\left(a_{\\nu1},...,a_{\\nu M}\\right)^{T}\\in\\mathbb{R}^{M}$\nand\\linebreak{}\n$F=(f_{1},f_{2},\\text{...},f_{M})^{T}\\in\\mathbb{R}^{M}$. Using the\nscalar product in $\\mathbb{R}^{M}$, we obtain the discrete version\nof (\\ref{eq:ART-eq-integrals}), \n\n", "index": 59, "text": "\\begin{equation}\n\\left\\langle a^{\\nu},F\\right\\rangle =g^{\\nu},\\qquad\\nu=1,...,N.\\label{eq:ART-eq-discrete}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E30.m1\" class=\"ltx_Math\" alttext=\"\\left\\langle a^{\\nu},F\\right\\rangle=g^{\\nu},\\qquad\\nu=1,...,N.\" display=\"block\"><mrow><mrow><mrow><mrow><mo>\u27e8</mo><msup><mi>a</mi><mi>\u03bd</mi></msup><mo>,</mo><mi>F</mi><mo>\u27e9</mo></mrow><mo>=</mo><msup><mi>g</mi><mi>\u03bd</mi></msup></mrow><mo rspace=\"22.5pt\">,</mo><mrow><mi>\u03bd</mi><mo>=</mo><mrow><mn>1</mn><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><mi>N</mi></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nwith relaxation parameter $\\lambda\\in(0,2)$, iteration index $r=0,\\,1,\\,2,\\,\\text{...}$,\nray index $\\nu$ and an arbitrary initial value $\\tilde{F}^{0}$.\n\n\n\\subsection{Modified ART}\n\nWe modify ART taking refraction into account. This leads\nto a more sophisticated calculation of the projection matrix $A=(a_{\\nu\\mu})_{\\nu=1,...,N,\\mu=1,...,M}$.\nFurthermore, the consideration of Fresnel losses leads to a correction\nof the measured intensity data $g_{\\mathrm{abs}}$. Both linear systems\n(for path difference $d$ and transmission coefficient $\\tau$) show\na similar structure and can be solved simultaneously, using the same\nray paths for both models, by applying Kaczmarz's method to get the\ncomplex refractive index.\n\n\n\\subsubsection{Consideration of Fresnel losses}\n\nReflection losses influence the measured transmission coefficient\n$\\tau$ by reducing the intensity of the transmitted signal in addition\nto absorption losses. Neglecting reflection losses in the model will\nthus lead to a systematic error in the calculation of the absorption\ncoefficient: the resulting values for $\\alpha$ will be too high,\nas a larger absorption coefficient corresponds to smaller transmission\ncoefficients. Therefore, our approach will be a correction of the\nmeasured intensity data, so that only absorption losses are considered\nfor the reconstruction of the absorption coefficient. Mukherjee et~al.~\\cite{Mukherjee2013}\nintroduced this approach successfully for cylindric objects. We expand\nthis approach to arbitrary interfaces and an initially unknown refractive\nindex.\n\nThe reflection loss $\\rho$ of a single interface is given by equation\n(\\ref{eq:Fresnel}). For this purpose, we need the angle of incident\nand refraction, which are known from the calculation of the ray paths\naccording to Snell's law, as well as the refractive indices on both\nsides of the interface, given by (\\ref{eq:n-for-both-sides-of-the-if}).\nLet $\\hat{K}\\in\\mathbb{N}$ be the number of interfaces intersecting\nthe ray path $L$ and $\\rho_{k_{\\iota}}$ be the reflection loss at\ninterface $\\Xi_{k_{\\iota}}$ with $k_{\\iota}\\in\\left[1,\\,K\\right],\\iota=1,...,\\,\\hat{K}$.\nThe emitted intensity is reduced due to the corresponding reflection\nlosses by the factor\n\n\n", "itemtype": "equation", "pos": 31926, "prevtext": "\nWe solve this linear system by applying Kaczmarz's method to (\\ref{eq:ART-eq-discrete}).\nThe iteration then reads as\n\n\n", "index": 61, "text": "\\begin{equation}\n\\begin{array}{lll}\nF^{0} & := & \\tilde{F}^{r}\\\\\nF^{\\nu} & = & {\\displaystyle F^{\\nu-1}+\\lambda\\frac{g^{\\nu}-\\left\\langle a^{\\nu},F^{\\nu-1}\\right\\rangle }{\\left\\Vert a^{\\nu}\\right\\Vert _{2}^{2}}a^{\\nu},\\qquad\\nu=1,\\,...,\\,N}\\\\\n\\tilde{F}^{r+1} & := & F^{N}\n\\end{array}\\label{eq:ART-iteration}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E31.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{lll}F^{0}&amp;:=&amp;\\tilde{F}^{r}\\\\&#10;F^{\\nu}&amp;=&amp;{\\displaystyle F^{\\nu-1}+\\lambda\\frac{g^{\\nu}-\\left\\langle a^{\\nu},F%&#10;^{\\nu-1}\\right\\rangle}{\\left\\|a^{\\nu}\\right\\|_{2}^{2}}a^{\\nu},\\qquad\\nu=1,\\,..%&#10;.,\\,N}\\\\&#10;\\tilde{F}^{r+1}&amp;:=&amp;F^{N}\\end{array}\" display=\"block\"><mtable columnspacing=\"5pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"left\"><msup><mi>F</mi><mn>0</mn></msup></mtd><mtd columnalign=\"left\"><mo>:=</mo></mtd><mtd columnalign=\"left\"><msup><mover accent=\"true\"><mi>F</mi><mo stretchy=\"false\">~</mo></mover><mi>r</mi></msup></mtd></mtr><mtr><mtd columnalign=\"left\"><msup><mi>F</mi><mi>\u03bd</mi></msup></mtd><mtd columnalign=\"left\"><mo>=</mo></mtd><mtd columnalign=\"left\"><mrow><mrow><mrow><mrow><msup><mi>F</mi><mrow><mi>\u03bd</mi><mo>-</mo><mn>1</mn></mrow></msup><mo>+</mo><mrow><mi>\u03bb</mi><mo>\u2062</mo><mfrac><mrow><msup><mi>g</mi><mi>\u03bd</mi></msup><mo>-</mo><mrow><mo>\u27e8</mo><msup><mi>a</mi><mi>\u03bd</mi></msup><mo>,</mo><msup><mi>F</mi><mrow><mi>\u03bd</mi><mo>-</mo><mn>1</mn></mrow></msup><mo>\u27e9</mo></mrow></mrow><msubsup><mrow><mo>\u2225</mo><msup><mi>a</mi><mi>\u03bd</mi></msup><mo>\u2225</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mfrac><mo>\u2062</mo><msup><mi>a</mi><mi>\u03bd</mi></msup></mrow></mrow><mo rspace=\"22.5pt\">,</mo><mi>\u03bd</mi></mrow><mo>=</mo><mn>1</mn></mrow><mo rspace=\"4.2pt\">,</mo><mrow><mi mathvariant=\"normal\">\u2026</mi><mo rspace=\"4.2pt\">,</mo><mi>N</mi></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"left\"><msup><mover accent=\"true\"><mi>F</mi><mo stretchy=\"false\">~</mo></mover><mrow><mi>r</mi><mo>+</mo><mn>1</mn></mrow></msup></mtd><mtd columnalign=\"left\"><mo>:=</mo></mtd><mtd columnalign=\"left\"><msup><mi>F</mi><mi>N</mi></msup></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nIn addition, the intensity of the ray is reduced by absorption losses\naccording to Lambert-Beer's law\n\n", "itemtype": "equation", "pos": 34471, "prevtext": "\nwith relaxation parameter $\\lambda\\in(0,2)$, iteration index $r=0,\\,1,\\,2,\\,\\text{...}$,\nray index $\\nu$ and an arbitrary initial value $\\tilde{F}^{0}$.\n\n\n\\subsection{Modified ART}\n\nWe modify ART taking refraction into account. This leads\nto a more sophisticated calculation of the projection matrix $A=(a_{\\nu\\mu})_{\\nu=1,...,N,\\mu=1,...,M}$.\nFurthermore, the consideration of Fresnel losses leads to a correction\nof the measured intensity data $g_{\\mathrm{abs}}$. Both linear systems\n(for path difference $d$ and transmission coefficient $\\tau$) show\na similar structure and can be solved simultaneously, using the same\nray paths for both models, by applying Kaczmarz's method to get the\ncomplex refractive index.\n\n\n\\subsubsection{Consideration of Fresnel losses}\n\nReflection losses influence the measured transmission coefficient\n$\\tau$ by reducing the intensity of the transmitted signal in addition\nto absorption losses. Neglecting reflection losses in the model will\nthus lead to a systematic error in the calculation of the absorption\ncoefficient: the resulting values for $\\alpha$ will be too high,\nas a larger absorption coefficient corresponds to smaller transmission\ncoefficients. Therefore, our approach will be a correction of the\nmeasured intensity data, so that only absorption losses are considered\nfor the reconstruction of the absorption coefficient. Mukherjee et~al.~\\cite{Mukherjee2013}\nintroduced this approach successfully for cylindric objects. We expand\nthis approach to arbitrary interfaces and an initially unknown refractive\nindex.\n\nThe reflection loss $\\rho$ of a single interface is given by equation\n(\\ref{eq:Fresnel}). For this purpose, we need the angle of incident\nand refraction, which are known from the calculation of the ray paths\naccording to Snell's law, as well as the refractive indices on both\nsides of the interface, given by (\\ref{eq:n-for-both-sides-of-the-if}).\nLet $\\hat{K}\\in\\mathbb{N}$ be the number of interfaces intersecting\nthe ray path $L$ and $\\rho_{k_{\\iota}}$ be the reflection loss at\ninterface $\\Xi_{k_{\\iota}}$ with $k_{\\iota}\\in\\left[1,\\,K\\right],\\iota=1,...,\\,\\hat{K}$.\nThe emitted intensity is reduced due to the corresponding reflection\nlosses by the factor\n\n\n", "index": 63, "text": "\\begin{equation}\nC_{\\mathrm{abs}}:=\\prod_{\\iota=1}^{\\hat{K}}\\left(1-\\rho_{k_{\\iota}}\\right).\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E32.m1\" class=\"ltx_Math\" alttext=\"C_{\\mathrm{abs}}:=\\prod_{\\iota=1}^{\\hat{K}}\\left(1-\\rho_{k_{\\iota}}\\right).\" display=\"block\"><mrow><mrow><msub><mi>C</mi><mi>abs</mi></msub><mo>:=</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u220f</mo><mrow><mi>\u03b9</mi><mo>=</mo><mn>1</mn></mrow><mover accent=\"true\"><mi>K</mi><mo stretchy=\"false\">^</mo></mover></munderover><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>\u03c1</mi><msub><mi>k</mi><mi>\u03b9</mi></msub></msub></mrow><mo>)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\n As a consequence, the transmission coefficient \n\n", "itemtype": "equation", "pos": 34681, "prevtext": "\nIn addition, the intensity of the ray is reduced by absorption losses\naccording to Lambert-Beer's law\n\n", "index": 65, "text": "\\begin{equation}\na=\\exp\\left(-\\int_{L}\\alpha\\,\\mathrm{d}x\\right).\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E33.m1\" class=\"ltx_Math\" alttext=\"a=\\exp\\left(-\\int_{L}\\alpha\\,\\mathrm{d}x\\right).\" display=\"block\"><mrow><mrow><mi>a</mi><mo>=</mo><mrow><mi>exp</mi><mo>\u2061</mo><mrow><mo>(</mo><mrow><mo>-</mo><mrow><msub><mo largeop=\"true\" symmetric=\"true\">\u222b</mo><mi>L</mi></msub><mrow><mpadded width=\"+1.7pt\"><mi>\u03b1</mi></mpadded><mo>\u2062</mo><mrow><mo>d</mo><mi>x</mi></mrow></mrow></mrow></mrow><mo>)</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nis measured by the receiver. We are now able to correct the measured\ntransmission data (the right hand side of integral equation (\\ref{eq:integral-eq-CT}))\nby\n\n\n", "itemtype": "equation", "pos": 34811, "prevtext": "\n As a consequence, the transmission coefficient \n\n", "index": 67, "text": "\\begin{equation}\n\\tau=a\\prod_{\\iota=1}^{\\hat{K}}\\left(1-\\rho_{k_{\\iota}}\\right)\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E34.m1\" class=\"ltx_Math\" alttext=\"\\tau=a\\prod_{\\iota=1}^{\\hat{K}}\\left(1-\\rho_{k_{\\iota}}\\right)\" display=\"block\"><mrow><mi>\u03c4</mi><mo>=</mo><mrow><mi>a</mi><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u220f</mo><mrow><mi>\u03b9</mi><mo>=</mo><mn>1</mn></mrow><mover accent=\"true\"><mi>K</mi><mo stretchy=\"false\">^</mo></mover></munderover><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>\u03c1</mi><msub><mi>k</mi><mi>\u03b9</mi></msub></msub></mrow><mo>)</mo></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nand obtain data that depends only on the absorption coefficient $\\alpha$.\n\n\n\\subsubsection{Consideration of the refracted ray path}\n\nA matrix entry $a_{\\nu\\mu}$ represents the length of the (refracted)\nray $\\nu$ in pixel $\\mu$ as in conventional ART. In contrast to\nART, we cannot calculate all entries $a_{\\nu\\mu}$ at once as the\npath itself is influenced by the material parameters. Instead, we\nhave to determine first of all the parameter $t_{l}^{\\mathrm{if}}$\nfor partial ray $L_{l}^{\\nu}\\left(\\varphi_{l},s_{l}\\right)$ (see\nsection \\ref{sub:ray-path-depending-on-refraction}). Then, we calculate\n$a_{\\nu\\mu}$ until reaching the nearest interface, determine the\nnew angle $\\varphi_{l+1}$ according to Snell's law and the reflection\nloss $\\rho_{l}$ for the current interface $\\Xi_{\\tilde{k}}$ according\nto Fresnel equations. Afterwards, these steps can be repeated for\nthe next partial ray $L_{l+1}^{\\nu},\\,l=1,...,\\hat{K}$ and $\\nu=1,...,N$.\nA pseudo code for calculating the matrix $A$ and the reflection losses\nis given in algorithm \\ref{alg:calculating-matrix-A}.\n\\begin{algorithm}\n\\begin{algorithmic}[1]\n\\For{$\\nu=1$ to $N$}\n\t\\State{$\\rho=0, \\ t_{0}^{\\mathrm{if}}=-\\infty,\\ t_{1}^{\\mathrm{if}}=0,\\  l=1$ }\n\t\\While{$t_{l}^{\\mathrm{if}}<\\infty$}\n\t\t\\State{Calculate  $t_{l}^{\\mathrm{if}}$ by (\\ref{eq:t-of-the-next-interface})}\n\t\t\\State{Calculate $a_{\\nu\\mu}=\\mathrm{length\\,of}\\,(L_{l}^{\\nu}\\cap S_{\\mu})$ for $t\\in\\left[t_{l-1}^{\\mathrm{if}},t_{l}^{\\mathrm{if}}\\right]$}\n\t\t\\If{$t_{l}^{\\mathrm{if}}<\\infty$}\t\t\n\t\t\t\n\t\t\t\\State{Calculate partial ray $L_{l+1}^{\\nu}(\\varphi_{l+1},s_{l+1})$ by (\\ref{eq:omega-l-plus-1-cases}) and (\\ref{eq:s-l-plus-1-calculation}) }\n\t\t\t\\State{Calculate reflection losses $\\rho_{l}^{\\nu}$ at $\\Xi_{\\tilde{k}}$ by (\\ref{eq:Fresnel})}\n\t\t\t\\State{$l=l+1$}\n\t\t\t \n\t\t\\EndIf\n\t\\EndWhile\n\t\\State{$\\hat{K}^{\\nu}=l-1;$} \n\t\\State{Calculate $C_{\\mathrm{abs}}^{\\nu}=\\prod_{l=1}^{\\hat{K}^{\\nu}}\\left(1-\\rho_{l}^{\\nu}\\right)$}\n\\EndFor\n\\State{$\\tilde{g}_{\\mathrm{abs}}^{\\nu}=\\ln\\left(\\frac{C_{\\mathrm{abs}}^{\\nu}}{\\tau^{\\nu}} \\right),\\,\\nu=1,...,N $}\\\\\n\n\\Return{$A, \\tilde{g}_{\\mathrm{abs}}$}\n\n\\end{algorithmic}\n\n\\caption{Calculating matrix $A$ and the corrected $\\tilde{g}_{\\mathrm{abs}}$\\label{alg:calculating-matrix-A}}\n\\end{algorithm}\n\n\nThe reconstruction of $\\mathrm{Re}(\\tilde{n})=n$ has a direct influence\non the reconstruction of the absorption coefficient $\\alpha$, because\nthe reflection losses are calculated by using the refractive indices\nof the materials that share the interface. The remaining steps are\nidentical to ART. We can use the same matrix $A$ for the reconstruction\nof both $n-1$ and $\\alpha$ and thus the calculation of $F_{\\mathrm{ref}}^{r}$\nand $F_{\\mathrm{abs}}^{r}$ takes place in the same loop, speeding\nup the reconstruction significantly. In the worst case, the complex\nrefractive index is completely unknown and the initial guess is the\ncomplex refractive index of air, meaning $F_{\\mathrm{ref}}^{0}=F_{\\mathrm{abs}}^{0}=0$.\nIn this case it makes sense to perform consecutively several applications\nof Kaczmarz's method and use their approximations for an update of\nthe ray paths, calculating a new matrix $A$ and correction value\n$C_{\\mathrm{abs}}$ before the next iteration. This means, we calculate\nthe first approximation by conventional ART without considering the\ninterfaces and reflection losses and then the next steps follow with\nmodified ART based on this approximation. This update of ray paths\nbased on an initial guess like $F_{\\mathrm{ref}}^{0}=0$ was discussed\nbefore in \\cite{Johnson1975} and \\cite{Schomberg1978}, where it\nwas used in the context of reconstructions based on the eikonal equation. \n\n\n\\subsubsection{Numerical scheme \\label{sub:numerical-scheme} }\n\nLet $\\Psi$ be the number of applications of Kaczmarz's method. We\ncan set the number of iterations $\\psi=\\left(r_{\\mathrm{stop}}^{1},\\text{...},r_{\\mathrm{stop}}^{\\Psi}\\right)$\nand the relaxation parameters for the refractive index $\\lambda_{\\mathrm{ref}}=\\left(\\lambda_{\\mathrm{ref}}^{1},\\text{...},\\lambda_{\\mathrm{ref}}^{\\Psi}\\right)$\nand absorption coefficient $\\lambda_{\\mathrm{abs}}=\\left(\\lambda_{\\mathrm{abs}}^{1},\\text{...},\\lambda_{\\mathrm{abs}}^{\\Psi}\\right)$\nfor each iteration. An appropriate choice of $\\psi$ is important,\ndue to the well-known phenomenon of the semiconvergence of iterative\nmethods for inverse problems. The stopping indices $r_{\\mathrm{stop}}^{i},\\,i=1,\\,\\text{...},\\,\\Psi,$\nare the respective regularization parameters of the modified ART and\nhave to be chosen adequately (e.~g.~by the discrepancy principle,\nsee \\cite{Defrise1987}). The algorithm for the calculation of an\napproximation of the complex refractive index based on THz data is\nshown in algorithm \\ref{alg:modified-ART}. Altogether this leads\nto the numerical scheme for the modified algebraic reconstruction\ntechnique as outlined in figure \\ref{fig:numerical-scheme-modfied-ART}.\n\\begin{algorithm}\n\\begin{algorithmic}[1]\n\\State{Inital values $\\tilde{F}_{\\mathrm{ref}}^{0,1},\\ \\tilde{F}_{\\mathrm{abs}}^{0,1} $}\n\\For{$i=1$ to $\\Psi$}\n\t\\State{Calculate $A^{i}\\left(\\tilde{F}_{\\mathrm{ref}}^{0,i}\\right)$ and $\\tilde{g}_{\\mathrm{abs}}\\left(\\tilde{F}_{\\mathrm{ref}}^{0,i}\\right)$ by algorithm \\ref{alg:calculating-matrix-A}}\n\t\\State{$r=0$}\n\t\\While{$r\\leq r_{\\mathrm{stop}}^{i}$}\n\t\t\\State{$F_{\\mathrm{ref}}^{0}=\\tilde{F}_{\\mathrm{ref}}^{r,i},\\,F_{\\mathrm{abs}}^{0}=\\tilde{F}_{\\mathrm{abs}}^{r,i}$}\n\t\t\n\t\t\t\\For{$\\nu=1$ to $N$}\n\t\t\t\n\t\t\t\t\\State{ ${\\displaystyle F_{\\mathrm{ref}}^{\\nu}=F_{\\mathrm{ref}}^{\\nu-1}+\\lambda_{\\mathrm{ref}}^{i}\\frac{g_{\\mathrm{ref}}^{\\nu}-\\left\\langle a^{\\nu},F_{\\mathrm{ref}}^{\\nu-1}\\right\\rangle }{\\left\\Vert a^{\\nu}\\right\\Vert _{2}^{2}}a^{\\nu}}$}\n\t\t\n\t\t\t\t\\State{${\\displaystyle F_{\\mathrm{abs}}^{\\nu}=F_{\\mathrm{abs}}^{\\nu-1}+\\lambda_{\\mathrm{abs}}^{i}\\frac{\\tilde{g}_{\\mathrm{abs}}^{\\nu}-\\left\\langle a^{\\nu},F_{\\mathrm{abs}}^{\\nu-1}\\right\\rangle }{\\left\\Vert a^{\\nu}\\right\\Vert _{2}^{2}}a^{\\nu}}$}\n\t\t\n\t\t\t \n\t\t\t\\EndFor\n\t\t\t\n\t\t\\State{$\\tilde{F}_{\\mathrm{ref}}^{r+1}=F_{\\mathrm{ref}}^{N},\\,\\tilde{F}_{\\mathrm{abs}}^{r+1}=F_{\\mathrm{abs}}^{N}$}\n\t\t\\State{$r=r+1$}\n\t\t\t\t\n\t\\EndWhile\n\t\\State{$\\tilde{F}_{\\mathrm{ref}}^{0,i+1}=F_{\\mathrm{ref}}^{N},\\,\\tilde{F}_{\\mathrm{abs}}^{0,i+1}=F_{\\mathrm{abs}}^{N}$} \n\\EndFor\\\\\n\\Return{${\\displaystyle \\tilde{n}\\approx\\left(1+\\tilde{F}_{\\mathrm{ref}}^{0,\\Psi+1}\\right)+i\\left(\\tilde{F}_{\\mathrm{abs}}^{0,\\Psi+1}\\frac{c_{0}}{2\\omega}\\right)}$}\n\n\\end{algorithmic}\n\n\\caption{Modified ART for calculating $\\tilde{n}=n+i\\kappa$\\label{alg:modified-ART}}\n\\end{algorithm}\n \n\\begin{figure}[H]\n\\begin{centering}\n\\includegraphics[width=0.85\\textwidth]{Numerical_scheme}\n\\par\\end{centering}\n\n\\caption{Numerical scheme of the modified ART\\label{fig:numerical-scheme-modfied-ART}}\n\\end{figure}\n\n\n\n\n\\section{Numerical experiments and results\\label{sec:Numerical-experiments}}\n\n\nIn this section we would like to validate the modified ART using both\nsynthetic and real measured data. The results show an improvement\nof the reconstruction obtained by the proposed technique in comparison\nto conventional CT methods. The complex refractive index can be reconstructed\nin more detail and with smaller errors by applying the new algorithm. \n\nFirst of all we take a look at reconstructions with synthetic and\nnoisy data. Afterwards, we compare the results obtained by modified\nART with those resulting from FBP and conventional ART on the basis\nof real measured data. Synthetic and real measured data were both\nrecorded for $p=360$ initial angles and $141$ distances (meaning\n$q=70$). Therefore one data set consists of $N=50760$ measurements.\nFurthermore, the number of iterations $\\psi$ and the number of applications\nof  Kaczmarz's methods $\\Psi$, i.~e.~the regularization parameters,\nwere chosen without a parameter-choice method for the sake of simplicity.\nThe iterations are just terminated when further iterations show no\nsignificant improvement, but not yet divergence. \n\nAdditionally, we use the a priori information on the position of the\ninterfaces to reset the refractive index outside the object to $n-1=0$\nbefore each Kaczmarz's method.  Thus the angles of incidence and refraction\nare calculated more accurately, as the ray is broken at an actual\ndiscontinuity of the refractive index. The initial values $\\ensuremath{\\tilde{F}_{\\mathrm{ref}}^{0,1}=\\tilde{F}_{\\mathrm{abs}}^{0,1}=0}$\nare used for all reconstructions, therefore the first iteration is\nequivalent to conventional ART.\n\n\n\\subsection{Synthetic data}\n\nThe first numerical example concerns a circle with a radius of $50\\,\\mathrm{mm}$,\na refractive index of $n=1.4$ and an absorption coefficient of $\\alpha=0.05\\mathrm{\\,cm^{-1}}$\ncontaining an embedded rectangle with dimensions of $25\\,\\mathrm{mm}\\times20\\,\\mathrm{mm}$\nand $n=1.7$, $\\alpha=0.25\\,\\mathrm{cm^{-1}}$. Uniformly distributed\nnoise is added respectively to the synthetic transmission coefficient\nand path difference data, such that the obtained noisy data $g^{\\varepsilon}$\nfulfills \n\n", "itemtype": "equation", "pos": 35066, "prevtext": "\nis measured by the receiver. We are now able to correct the measured\ntransmission data (the right hand side of integral equation (\\ref{eq:integral-eq-CT}))\nby\n\n\n", "index": 69, "text": "\\begin{equation}\n\\tilde{g}_{\\mathrm{abs}}=\\ln\\left(\\frac{I_{0}}{I}\\right)=\\ln\\left(\\frac{1}{a}\\right)=\\ln\\left(\\frac{1}{\\tau}\\prod_{\\iota=1}^{\\hat{K}}\\left(1-\\rho_{k_{\\iota}}\\right)\\right)\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E35.m1\" class=\"ltx_Math\" alttext=\"\\tilde{g}_{\\mathrm{abs}}=\\ln\\left(\\frac{I_{0}}{I}\\right)=\\ln\\left(\\frac{1}{a}%&#10;\\right)=\\ln\\left(\\frac{1}{\\tau}\\prod_{\\iota=1}^{\\hat{K}}\\left(1-\\rho_{k_{\\iota%&#10;}}\\right)\\right)\" display=\"block\"><mrow><msub><mover accent=\"true\"><mi>g</mi><mo stretchy=\"false\">~</mo></mover><mi>abs</mi></msub><mo>=</mo><mrow><mi>ln</mi><mo>\u2061</mo><mrow><mo>(</mo><mfrac><msub><mi>I</mi><mn>0</mn></msub><mi>I</mi></mfrac><mo>)</mo></mrow></mrow><mo>=</mo><mrow><mi>ln</mi><mo>\u2061</mo><mrow><mo>(</mo><mfrac><mn>1</mn><mi>a</mi></mfrac><mo>)</mo></mrow></mrow><mo>=</mo><mrow><mi>ln</mi><mo>\u2061</mo><mrow><mo>(</mo><mrow><mfrac><mn>1</mn><mi>\u03c4</mi></mfrac><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u220f</mo><mrow><mi>\u03b9</mi><mo>=</mo><mn>1</mn></mrow><mover accent=\"true\"><mi>K</mi><mo stretchy=\"false\">^</mo></mover></munderover><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>\u03c1</mi><msub><mi>k</mi><mi>\u03b9</mi></msub></msub></mrow><mo>)</mo></mrow></mrow></mrow><mo>)</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nin both cases. \n\\begin{figure}[h]\n\\hfill{}\\subfloat[Refractive index $n(x),\\,x\\in\\Omega$ ]{\n\n\\includegraphics[width=0.5\\textwidth]{cylinder_embedded_rectangle_refractive_index.pdf}}\\subfloat[Absolute error]{\n\n\\includegraphics[width=0.5\\textwidth]{cylinder_embedded_rectangle_refractive_index_error}}\\hfill{}\\caption{Reconstruction of the refractive index based on synthetic data\\label{fig:rec-circle-ref}}\n\\end{figure}\nAs there is no information about $\\tilde{n}$, we perform several\napplications of Kaczmarz's method for the reconstruction as described\nin section \\ref{sub:numerical-scheme}. Here we used $\\Psi=5$ iterations\nwith the following parameters:\n\n\n", "itemtype": "equation", "pos": 44242, "prevtext": "\nand obtain data that depends only on the absorption coefficient $\\alpha$.\n\n\n\\subsubsection{Consideration of the refracted ray path}\n\nA matrix entry $a_{\\nu\\mu}$ represents the length of the (refracted)\nray $\\nu$ in pixel $\\mu$ as in conventional ART. In contrast to\nART, we cannot calculate all entries $a_{\\nu\\mu}$ at once as the\npath itself is influenced by the material parameters. Instead, we\nhave to determine first of all the parameter $t_{l}^{\\mathrm{if}}$\nfor partial ray $L_{l}^{\\nu}\\left(\\varphi_{l},s_{l}\\right)$ (see\nsection \\ref{sub:ray-path-depending-on-refraction}). Then, we calculate\n$a_{\\nu\\mu}$ until reaching the nearest interface, determine the\nnew angle $\\varphi_{l+1}$ according to Snell's law and the reflection\nloss $\\rho_{l}$ for the current interface $\\Xi_{\\tilde{k}}$ according\nto Fresnel equations. Afterwards, these steps can be repeated for\nthe next partial ray $L_{l+1}^{\\nu},\\,l=1,...,\\hat{K}$ and $\\nu=1,...,N$.\nA pseudo code for calculating the matrix $A$ and the reflection losses\nis given in algorithm \\ref{alg:calculating-matrix-A}.\n\\begin{algorithm}\n\\begin{algorithmic}[1]\n\\For{$\\nu=1$ to $N$}\n\t\\State{$\\rho=0, \\ t_{0}^{\\mathrm{if}}=-\\infty,\\ t_{1}^{\\mathrm{if}}=0,\\  l=1$ }\n\t\\While{$t_{l}^{\\mathrm{if}}<\\infty$}\n\t\t\\State{Calculate  $t_{l}^{\\mathrm{if}}$ by (\\ref{eq:t-of-the-next-interface})}\n\t\t\\State{Calculate $a_{\\nu\\mu}=\\mathrm{length\\,of}\\,(L_{l}^{\\nu}\\cap S_{\\mu})$ for $t\\in\\left[t_{l-1}^{\\mathrm{if}},t_{l}^{\\mathrm{if}}\\right]$}\n\t\t\\If{$t_{l}^{\\mathrm{if}}<\\infty$}\t\t\n\t\t\t\n\t\t\t\\State{Calculate partial ray $L_{l+1}^{\\nu}(\\varphi_{l+1},s_{l+1})$ by (\\ref{eq:omega-l-plus-1-cases}) and (\\ref{eq:s-l-plus-1-calculation}) }\n\t\t\t\\State{Calculate reflection losses $\\rho_{l}^{\\nu}$ at $\\Xi_{\\tilde{k}}$ by (\\ref{eq:Fresnel})}\n\t\t\t\\State{$l=l+1$}\n\t\t\t \n\t\t\\EndIf\n\t\\EndWhile\n\t\\State{$\\hat{K}^{\\nu}=l-1;$} \n\t\\State{Calculate $C_{\\mathrm{abs}}^{\\nu}=\\prod_{l=1}^{\\hat{K}^{\\nu}}\\left(1-\\rho_{l}^{\\nu}\\right)$}\n\\EndFor\n\\State{$\\tilde{g}_{\\mathrm{abs}}^{\\nu}=\\ln\\left(\\frac{C_{\\mathrm{abs}}^{\\nu}}{\\tau^{\\nu}} \\right),\\,\\nu=1,...,N $}\\\\\n\n\\Return{$A, \\tilde{g}_{\\mathrm{abs}}$}\n\n\\end{algorithmic}\n\n\\caption{Calculating matrix $A$ and the corrected $\\tilde{g}_{\\mathrm{abs}}$\\label{alg:calculating-matrix-A}}\n\\end{algorithm}\n\n\nThe reconstruction of $\\mathrm{Re}(\\tilde{n})=n$ has a direct influence\non the reconstruction of the absorption coefficient $\\alpha$, because\nthe reflection losses are calculated by using the refractive indices\nof the materials that share the interface. The remaining steps are\nidentical to ART. We can use the same matrix $A$ for the reconstruction\nof both $n-1$ and $\\alpha$ and thus the calculation of $F_{\\mathrm{ref}}^{r}$\nand $F_{\\mathrm{abs}}^{r}$ takes place in the same loop, speeding\nup the reconstruction significantly. In the worst case, the complex\nrefractive index is completely unknown and the initial guess is the\ncomplex refractive index of air, meaning $F_{\\mathrm{ref}}^{0}=F_{\\mathrm{abs}}^{0}=0$.\nIn this case it makes sense to perform consecutively several applications\nof Kaczmarz's method and use their approximations for an update of\nthe ray paths, calculating a new matrix $A$ and correction value\n$C_{\\mathrm{abs}}$ before the next iteration. This means, we calculate\nthe first approximation by conventional ART without considering the\ninterfaces and reflection losses and then the next steps follow with\nmodified ART based on this approximation. This update of ray paths\nbased on an initial guess like $F_{\\mathrm{ref}}^{0}=0$ was discussed\nbefore in \\cite{Johnson1975} and \\cite{Schomberg1978}, where it\nwas used in the context of reconstructions based on the eikonal equation. \n\n\n\\subsubsection{Numerical scheme \\label{sub:numerical-scheme} }\n\nLet $\\Psi$ be the number of applications of Kaczmarz's method. We\ncan set the number of iterations $\\psi=\\left(r_{\\mathrm{stop}}^{1},\\text{...},r_{\\mathrm{stop}}^{\\Psi}\\right)$\nand the relaxation parameters for the refractive index $\\lambda_{\\mathrm{ref}}=\\left(\\lambda_{\\mathrm{ref}}^{1},\\text{...},\\lambda_{\\mathrm{ref}}^{\\Psi}\\right)$\nand absorption coefficient $\\lambda_{\\mathrm{abs}}=\\left(\\lambda_{\\mathrm{abs}}^{1},\\text{...},\\lambda_{\\mathrm{abs}}^{\\Psi}\\right)$\nfor each iteration. An appropriate choice of $\\psi$ is important,\ndue to the well-known phenomenon of the semiconvergence of iterative\nmethods for inverse problems. The stopping indices $r_{\\mathrm{stop}}^{i},\\,i=1,\\,\\text{...},\\,\\Psi,$\nare the respective regularization parameters of the modified ART and\nhave to be chosen adequately (e.~g.~by the discrepancy principle,\nsee \\cite{Defrise1987}). The algorithm for the calculation of an\napproximation of the complex refractive index based on THz data is\nshown in algorithm \\ref{alg:modified-ART}. Altogether this leads\nto the numerical scheme for the modified algebraic reconstruction\ntechnique as outlined in figure \\ref{fig:numerical-scheme-modfied-ART}.\n\\begin{algorithm}\n\\begin{algorithmic}[1]\n\\State{Inital values $\\tilde{F}_{\\mathrm{ref}}^{0,1},\\ \\tilde{F}_{\\mathrm{abs}}^{0,1} $}\n\\For{$i=1$ to $\\Psi$}\n\t\\State{Calculate $A^{i}\\left(\\tilde{F}_{\\mathrm{ref}}^{0,i}\\right)$ and $\\tilde{g}_{\\mathrm{abs}}\\left(\\tilde{F}_{\\mathrm{ref}}^{0,i}\\right)$ by algorithm \\ref{alg:calculating-matrix-A}}\n\t\\State{$r=0$}\n\t\\While{$r\\leq r_{\\mathrm{stop}}^{i}$}\n\t\t\\State{$F_{\\mathrm{ref}}^{0}=\\tilde{F}_{\\mathrm{ref}}^{r,i},\\,F_{\\mathrm{abs}}^{0}=\\tilde{F}_{\\mathrm{abs}}^{r,i}$}\n\t\t\n\t\t\t\\For{$\\nu=1$ to $N$}\n\t\t\t\n\t\t\t\t\\State{ ${\\displaystyle F_{\\mathrm{ref}}^{\\nu}=F_{\\mathrm{ref}}^{\\nu-1}+\\lambda_{\\mathrm{ref}}^{i}\\frac{g_{\\mathrm{ref}}^{\\nu}-\\left\\langle a^{\\nu},F_{\\mathrm{ref}}^{\\nu-1}\\right\\rangle }{\\left\\Vert a^{\\nu}\\right\\Vert _{2}^{2}}a^{\\nu}}$}\n\t\t\n\t\t\t\t\\State{${\\displaystyle F_{\\mathrm{abs}}^{\\nu}=F_{\\mathrm{abs}}^{\\nu-1}+\\lambda_{\\mathrm{abs}}^{i}\\frac{\\tilde{g}_{\\mathrm{abs}}^{\\nu}-\\left\\langle a^{\\nu},F_{\\mathrm{abs}}^{\\nu-1}\\right\\rangle }{\\left\\Vert a^{\\nu}\\right\\Vert _{2}^{2}}a^{\\nu}}$}\n\t\t\n\t\t\t \n\t\t\t\\EndFor\n\t\t\t\n\t\t\\State{$\\tilde{F}_{\\mathrm{ref}}^{r+1}=F_{\\mathrm{ref}}^{N},\\,\\tilde{F}_{\\mathrm{abs}}^{r+1}=F_{\\mathrm{abs}}^{N}$}\n\t\t\\State{$r=r+1$}\n\t\t\t\t\n\t\\EndWhile\n\t\\State{$\\tilde{F}_{\\mathrm{ref}}^{0,i+1}=F_{\\mathrm{ref}}^{N},\\,\\tilde{F}_{\\mathrm{abs}}^{0,i+1}=F_{\\mathrm{abs}}^{N}$} \n\\EndFor\\\\\n\\Return{${\\displaystyle \\tilde{n}\\approx\\left(1+\\tilde{F}_{\\mathrm{ref}}^{0,\\Psi+1}\\right)+i\\left(\\tilde{F}_{\\mathrm{abs}}^{0,\\Psi+1}\\frac{c_{0}}{2\\omega}\\right)}$}\n\n\\end{algorithmic}\n\n\\caption{Modified ART for calculating $\\tilde{n}=n+i\\kappa$\\label{alg:modified-ART}}\n\\end{algorithm}\n \n\\begin{figure}[H]\n\\begin{centering}\n\\includegraphics[width=0.85\\textwidth]{Numerical_scheme}\n\\par\\end{centering}\n\n\\caption{Numerical scheme of the modified ART\\label{fig:numerical-scheme-modfied-ART}}\n\\end{figure}\n\n\n\n\n\\section{Numerical experiments and results\\label{sec:Numerical-experiments}}\n\n\nIn this section we would like to validate the modified ART using both\nsynthetic and real measured data. The results show an improvement\nof the reconstruction obtained by the proposed technique in comparison\nto conventional CT methods. The complex refractive index can be reconstructed\nin more detail and with smaller errors by applying the new algorithm. \n\nFirst of all we take a look at reconstructions with synthetic and\nnoisy data. Afterwards, we compare the results obtained by modified\nART with those resulting from FBP and conventional ART on the basis\nof real measured data. Synthetic and real measured data were both\nrecorded for $p=360$ initial angles and $141$ distances (meaning\n$q=70$). Therefore one data set consists of $N=50760$ measurements.\nFurthermore, the number of iterations $\\psi$ and the number of applications\nof  Kaczmarz's methods $\\Psi$, i.~e.~the regularization parameters,\nwere chosen without a parameter-choice method for the sake of simplicity.\nThe iterations are just terminated when further iterations show no\nsignificant improvement, but not yet divergence. \n\nAdditionally, we use the a priori information on the position of the\ninterfaces to reset the refractive index outside the object to $n-1=0$\nbefore each Kaczmarz's method.  Thus the angles of incidence and refraction\nare calculated more accurately, as the ray is broken at an actual\ndiscontinuity of the refractive index. The initial values $\\ensuremath{\\tilde{F}_{\\mathrm{ref}}^{0,1}=\\tilde{F}_{\\mathrm{abs}}^{0,1}=0}$\nare used for all reconstructions, therefore the first iteration is\nequivalent to conventional ART.\n\n\n\\subsection{Synthetic data}\n\nThe first numerical example concerns a circle with a radius of $50\\,\\mathrm{mm}$,\na refractive index of $n=1.4$ and an absorption coefficient of $\\alpha=0.05\\mathrm{\\,cm^{-1}}$\ncontaining an embedded rectangle with dimensions of $25\\,\\mathrm{mm}\\times20\\,\\mathrm{mm}$\nand $n=1.7$, $\\alpha=0.25\\,\\mathrm{cm^{-1}}$. Uniformly distributed\nnoise is added respectively to the synthetic transmission coefficient\nand path difference data, such that the obtained noisy data $g^{\\varepsilon}$\nfulfills \n\n", "index": 71, "text": "\\begin{equation}\n\\left\\Vert g-g^{\\varepsilon}\\right\\Vert _{2}/\\left\\Vert g\\right\\Vert _{2}\\leq0.05\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E36.m1\" class=\"ltx_Math\" alttext=\"\\left\\|g-g^{\\varepsilon}\\right\\|_{2}/\\left\\|g\\right\\|_{2}\\leq 0.05\" display=\"block\"><mrow><mrow><msub><mrow><mo>\u2225</mo><mrow><mi>g</mi><mo>-</mo><msup><mi>g</mi><mi>\u03b5</mi></msup></mrow><mo>\u2225</mo></mrow><mn>2</mn></msub><mo>/</mo><msub><mrow><mo>\u2225</mo><mi>g</mi><mo>\u2225</mo></mrow><mn>2</mn></msub></mrow><mo>\u2264</mo><mn>0.05</mn></mrow></math>", "type": "latex"}, {"file": "1601.04496.tex", "nexttext": "\nWe perform only a reconstruction of the absorption coefficient $\\alpha$\nin last iteration ($\\lambda_{\\mathrm{ref}}^{5}=0$). This approach\nis reasonable in so far as we use the approximation of the previous\niteration step of the refractive index $n$ for calculating the reflection\nlosses for the reconstruction of $\\alpha$. Therefore, we can expect\nan improvement of $\\alpha$ in an additional iteration step. \n\\begin{figure}[h]\n\\hfill{}\\subfloat[Absorption coefficient $\\alpha(x),\\,x\\in\\Omega$ ]{\n\n\\includegraphics[width=0.5\\textwidth]{cylinder_embedded_rectangle_abs_coeff}}\\subfloat[Absolute error]{\n\n\\includegraphics[width=0.5\\textwidth]{cylinder_embedded_rectangle_abs_coeff_error}}\\hfill{}\\caption{Reconstruction of the absorption coefficient based on synthetic data\\label{fig:rec-circle-abs}}\n\\end{figure}\nFigures \\ref{fig:rec-circle-ref} and \\ref{fig:rec-circle-abs} show\nthe reconstructions of the refractive index and the absorption coefficient\nwith the modified ART. The results are good in spite of the\nlarge jump discontinuities of the refractive index. The\nabsolute error is small in large parts of the object (see figures\non the right), whereas the the biggest local errors appear near the\ninterfaces and corners. Hereby, the prerequisite is ensured that modified\nART provides correct results with synthetic data. As we now have to\ndeal with ray paths that can be arbitrary refracted at interfaces,\nit is possible that some pixels are less frequently intersected by\nthe ray paths than others, which causes additional artifacts. \n\n\n\\subsection{Comparison with conventional reconstruction methods using real data}\n\nThe next step is to compare modified ART with conventional ART and\nFBP based on real measured data. In this context, we first give a\nbrief description of the used THz tomograph and then move on to the\nreconstructions. \n\n\n\\subsubsection{THz tomography system}\n\nThe measured data were acquired at \\emph{SKZ}\\footnote{~The German Plastics Center in W\\\"urzburg, \\href{http://www.skz.de/}{http://www.skz.de/}}.\nA THz tomography system was designed, which works on the basis of\nthe FMCW (Frequency Modulated Continuous Wave) principle. Here the\nfrequency of the THz signal is a sawtooth wave in the range of $70$\nto $110\\,\\mathrm{GHz}$ and allows measurements of intensity and phase.\nThe latter results in the delayed travel time or path difference data.\nDispersion can be neglected in this operating frequency range and\nthe complex refractive index can be assumed to be constant \\cite{Lamb1996,Piesiewicz2007}.\nThus the transmission coefficient and the path difference are averaged\nover this frequency band. The optical system consists of two lenses\nfor each receiver and transmitter and is similar to the architecture\nof a Kepler telescope. The Gaussian beam is focused on the object\nwith a beam waist of about $8\\,\\mathrm{mm}$. \n\\begin{rem}\nThe generation of synthetic data always provides suitable values $g_{\\mathrm{abs}}$\nand $g_{\\mathrm{ref}}$, regardless of how strong the rays are refracted.\nHowever, the THz system uses just one emitter and one detector, and\nin the case of strong refraction the transmitted ray may miss the\ndetector, resulting in a transmission coefficient of $\\tau=0$. Better\nresults can often be achieved by sorting out measured data of rays\nwith $\\tau\\leq\\varepsilon_{\\mathrm{miss}}$ and $\\varepsilon_{\\mathrm{miss}}$\nsufficiently small, meaning neglecting them completely for the iterations.\nIt must be taken into account that this case also occurs for strong\nabsorbers and then leads to a distortion of the reconstruction results. \n\\end{rem}\n\n\\subsubsection{Block with multiple refractive indices}\n\nThe next step is to validate our modified ART with a more complex\nobject and real measured data. Furthermore, we would like to compare\nthe filtered backprojection, conventional ART and modified ART. For\nthis purpose a test object consisting of different plastic blocks\nwith different refractive indices that where glued together forming\na block was scanned. Figure \\ref{fig:ref-ind-and-prop-of-block} shows\nthe measures and the refractive indices of the object.\n\\begin{figure}[h]\n\\centering{}\\includegraphics[width=0.45\\textwidth]{AgglutinatedBlock}\\caption{Refractive indices and proportions (in $\\mathrm{mm}$) of the glued-together\nblock \\label{fig:ref-ind-and-prop-of-block}}\n\\end{figure}\nThe conventional ART no longer achieves significant improvements after\n15 iterations with $\\lambda_{\\mathrm{ref}}=0.005$. The results of\nmodified ART are obtained with $\\psi=\\left(3,\\,3,\\,5,\\,12\\right)$\nand $\\lambda_{\\mathrm{ref}}=\\left(0.005,\\,0.01,\\,0.0075,\\,0.003\\right)$.\nTHz rays resulting in transmission coefficients with $\\tau\\leq0.05$\nare ignored in both algebraic methods. Furthermore, we used the filtered\nbackprojection with the Shepp-Logan filter and $\\varepsilon_{\\mathrm{miss}}=0$.\nThe application of FBP to THz data leads to a very bad reconstruction\n(see figure \\ref{fig:FBP-rec-5-block}) with very high values of $n$\nat the outer interfaces. The shape of the object is completely lost\nand cannot be reconstructed.\n\\begin{figure}[h]\n\\hfill{}\n\n\\subfloat[Refractive index $n(x),\\,x\\in\\Omega$ ]{\n\n\\includegraphics[width=0.5\\textwidth]{AggBlock_FBP_refractive_index}}\\subfloat[Absolute error]{\n\n\\includegraphics[width=0.5\\textwidth]{AggBlock_FBP_refractive_index_error}}\\hfill{}\\caption{Filtered backprojection: reconstruction of the refractive index with\nreal measured data \\label{fig:FBP-rec-5-block}}\n\\end{figure}\n The reconstruction of the conventional ART is slightly better (see\nfigure \\ref{fig:ART-rec-5-block}). But the outer shape of the object\nalso appears too curved and the reconstruction of the refractive index\nproduces very high values especially around the interfaces.\n\\begin{figure}[H]\n\\hfill{}\\subfloat[Refractive index $n(x),\\,x\\in\\Omega$ ]{\n\n\\includegraphics[width=0.5\\textwidth]{AggBlock_ART_refractive_index}}\\subfloat[Absolute error]{\n\n\\includegraphics[width=0.5\\textwidth]{AggBlock_ART_refractive_index_error}}\\hfill{}\\caption{ART: reconstruction of the refractive index with real measured data\n\\label{fig:ART-rec-5-block}}\n\\end{figure}\n Conversely, the reconstruction with the modified ART is much better,\nsee figure \\ref{fig:Modified-ART-rec-5-block}, and good results can\nalso be achieved for more complex objects. The modified ART outperforms\nthe conventional methods FBP and ART, especially around corners, regarding\nshape and size of the refractive index. This is also evident from\nthe comparison of the three methods regarding the absolute error (see\nrespective figures on the right-hand side). \n\\begin{figure}[H]\n\\hfill{}\\subfloat[Refractive index $n(x),\\,x\\in\\Omega$ ]{\n\n\\includegraphics[width=0.5\\textwidth]{AggBlock_THz_ART_refractive_index}}\\subfloat[Absolute error]{\n\n\\includegraphics[width=0.5\\textwidth]{AggBlock_THz_ART_refractive_index_error}}\\hfill{}\\caption{Modified ART: reconstruction of the refractive index with real measured\ndata\\label{fig:Modified-ART-rec-5-block}}\n\\end{figure}\n The absolute error of the modified ART is almost everywhere smaller.\nThe biggest deviations appear again at the corners and interfaces.\nConsequently, our modified ART can reconstruct more complex objects\nwith smaller errors and in more detail, while the individual blocks\nare hardly detectable with ART. The differentiation of the various\nplastics is difficult with modified ART as well, because the values\nof the refractive indices are close to each other. But we can clearly\ndistinguish between polyamide (middle top, with the highest refractive\nindex) and polyethylene (right bottom, with the lowest refractive\nindex). Finally, the reconstructions with modified ART are clearly\nsuperior to those of FBP and ART, showing that refraction and reflection\nlosses play an important role in THz tomography.\n\n\n\\section{Conclusion and future work}\n\nIn this paper, we have presented a new, efficient reconstruction algorithm\nfor THz tomography and have validated it with the help of synthetic\nand real measured data. Our modified ART takes refraction and reflection\nlosses into account and reconstructs the complex refractive index\nbased on path difference and transmission coefficient measurements.\nTherefore we use a refracted ray path according to Snell's law. Furthermore,\nmodified ART is a hybrid algorithm exploiting two different tomographic\nprinciples (travel time and transmission tomography) and the respective\ndata simultaneously.\n\nNumerical experiments show that the reconstruction of material parameters\nand interfaces provide more accurate results than conventional CT\nalgorithms like ART. We have already pointed out in the introduction\nthat finding a balance between an efficient reconstruction and a detailed\nmodeling is important. Hence, the modified ART considers only the\nmain physical effects like refraction, absorption and reflection losses.\nThe advantage of this approach is that we can avoid the expensive\nsolution of partial differential equations like wave equation or Helmholtz\nequation. As we neglect further physical effects in our modeling,\nour proposed method has the following limitations: Since we do not\nconsider diffraction effects, objects containing small, non-absorbing\ndefects that lead to strong diffraction are poorly reconstructed.\nAlthough the first results are promising, the reconstruction algorithm\nfor THz tomography can be improved by the following approach: An important\nproperty of THz radiation is the propagation according to Gaussian\noptics. At this point, we neglect this physical property, suggesting\nthe consideration of the Gaussian beam profile as a promising next\nstep. Taking into account the Gaussian beam profile, we might also\nconsider cases in which only a part of the transmitted beam hits the\nreceiver and thus improve the reconstruction of the absorption coefficient.\n\nTo reduce the time required for reconstruction by parallelization,\nusing the simultaneous algebraic reconstruction technique (SART, \\cite{Andersen1984})\nor more general block algebraic iterative methods (see e. g. \\cite{Soerensen2014})\nis conceivable. Since the modifications to conventional ART concern\nonly the matrix $A$ and the data $g_{\\mathrm{abs}}$, the iteration\nof e. g. SART is directly applicable, too.\n\n\n\\section*{Acknowledgments}\nThis project was funded by The German Federation of Industrial Research Associations\n(AiF) under 457 ZN which is gratefully acknowledged by the authors.\n\n\n\\bibliographystyle{siam}\n\\bibliography{gIPE_THz_ART}\n\n\n", "itemtype": "equation", "pos": 45014, "prevtext": "\nin both cases. \n\\begin{figure}[h]\n\\hfill{}\\subfloat[Refractive index $n(x),\\,x\\in\\Omega$ ]{\n\n\\includegraphics[width=0.5\\textwidth]{cylinder_embedded_rectangle_refractive_index.pdf}}\\subfloat[Absolute error]{\n\n\\includegraphics[width=0.5\\textwidth]{cylinder_embedded_rectangle_refractive_index_error}}\\hfill{}\\caption{Reconstruction of the refractive index based on synthetic data\\label{fig:rec-circle-ref}}\n\\end{figure}\nAs there is no information about $\\tilde{n}$, we perform several\napplications of Kaczmarz's method for the reconstruction as described\nin section \\ref{sub:numerical-scheme}. Here we used $\\Psi=5$ iterations\nwith the following parameters:\n\n\n", "index": 73, "text": "\\begin{equation}\n\\begin{array}{c}\n\\psi=\\left(3,\\,3,\\,5,\\,7,\\,5\\right)\\\\\n\\lambda_{\\mathrm{ref}}=\\left(0.01,\\,0.01,\\,0.006,\\,0.002,\\,0\\right)\\\\\n\\lambda_{\\mathrm{abs}}=\\left(0.002,\\,0.004,\\,0.004,\\,0.004,\\,0.003\\right)\n\\end{array}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E37.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{c}\\psi=\\left(3,\\,3,\\,5,\\,7,\\,5\\right)\\\\&#10;\\lambda_{\\mathrm{ref}}=\\left(0.01,\\,0.01,\\,0.006,\\,0.002,\\,0\\right)\\\\&#10;\\lambda_{\\mathrm{abs}}=\\left(0.002,\\,0.004,\\,0.004,\\,0.004,\\,0.003\\right)\\end{array}\" display=\"block\"><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><mi>\u03c8</mi><mo>=</mo><mrow><mo>(</mo><mn>3</mn><mo>,</mo><mn>\u20093</mn><mo>,</mo><mn>\u20095</mn><mo>,</mo><mn>\u20097</mn><mo>,</mo><mn>\u20095</mn><mo>)</mo></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><msub><mi>\u03bb</mi><mi>ref</mi></msub><mo>=</mo><mrow><mo>(</mo><mn>0.01</mn><mo>,</mo><mn>\u20090.01</mn><mo>,</mo><mn>\u20090.006</mn><mo>,</mo><mn>\u20090.002</mn><mo>,</mo><mn>\u20090</mn><mo>)</mo></mrow></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><msub><mi>\u03bb</mi><mi>abs</mi></msub><mo>=</mo><mrow><mo>(</mo><mn>0.002</mn><mo>,</mo><mn>\u20090.004</mn><mo>,</mo><mn>\u20090.004</mn><mo>,</mo><mn>\u20090.004</mn><mo>,</mo><mn>\u20090.003</mn><mo>)</mo></mrow></mrow></mtd></mtr></mtable></math>", "type": "latex"}]