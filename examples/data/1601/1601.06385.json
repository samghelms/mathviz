[{"file": "1601.06385.tex", "nexttext": "\nwhere $\\mbox{$\\left| {} \\right\\rangle$}_k$ represents Alice's ancillary qubits, $\\hat{n}_k$ is the photon number operator acting on $\\mbox{$\\left| {\\Psi} \\right\\rangle$}_B$, and $\\mbox{$\\left| {\\Psi} \\right\\rangle$}_B$ is the encoding state which will be sent to Bob via a quantum channel. Alice's bit $s_k$ can be viewed as the output of $Z$ basis measurement $\\{\\mbox{$\\left| {0} \\right\\rangle$}\\mbox{$\\left\\langle {0} \\right|$},\\mbox{$\\left| {1} \\right\\rangle$}\\mbox{$\\left\\langle {1} \\right|$}\\}$ on ancilla $\\mbox{$\\left| {k} \\right\\rangle$}$.\nNext, Alice sends the quantum state to Bob. Bob splits the input to two paths, applies a random delay $r$ to one of the paths, obtains $i$, $j=i+r$, $s_i \\oplus s_j$ through detectors' outcomes and announces $i$ and $j$ to Alice. On receiving $i$ and $j$, Alice performs a controlled-NOT gate to her ancilla $\\mbox{$\\left| {} \\right\\rangle$}_i$ and $\\mbox{$\\left| {} \\right\\rangle$}_j$, in which $\\mbox{$\\left| {} \\right\\rangle$}_i$ is the control qubit while $\\mbox{$\\left| {} \\right\\rangle$}_j$ is the target. Then Alice can measure $\\mbox{$\\left| {} \\right\\rangle$}_j$ with the $Z$ basis to obtain her sifted key bit $s_i\\oplus s_j$.\n\n\\begin{figure}[hbt]\n\\centering\n\\includegraphics[width=7cm]{illus.eps}\n\\caption{(a) Original RRDPS \\cite{sasaki2014practical}. Alice sends a pulse train to Bob, who splits the pulse train into two paths, adds a delay $r$ to\none of the paths, measures the interference to obtain $s_i\\oplus s_j$, $i$, $j$, and publicly announces $i$, $j$.\n(b) Untrusted measurement variant. Instead of performing the operations himself, Bob gives an untrusted measurement device, Fred, the pulse train along with a random $r$, and Fred outputs $s_i\\oplus s_j$, $i$, $j=i+r$. One possible implementation of Fred could be exactly the same as the corresponding part of the original RRDPS.}\n\\label{fig:illus}\n\\end{figure}\n\nWhen the measurement is untrusted, as shown in Fig.~\\ref{fig:illus}(b), Alice prepares the same state and sends it to Bob. After receiving the incoming state, Bob inputs a random delay value $r$ to his untrusted device, obtains $i, j$ $(j-i = r)$, and an estimated value of $s_i\\oplus s_j$. The rest procedures are the same, where Bob publicly announces $i,j$ and Alice performs the controlled-NOT gate accordingly. Here untrusted means that Bob's device is an unknown quantum measurement device, called Fred, which could be manufactured by the adversary Eve. We assume here that Fred cannot actively disclose any information outside of Bob's environment bypassing Bob (e.g. by sending light signals). This assumption in particular eliminates the possibility of Fred telling Eve, who is outside, the measurement result $s_i\\oplus s_j$ because Bob never announces it.\n\n{\\it Proposed attack 1.}\nBefore describing the first attack, we settle down some useful notations. For a function $f(n)$, $\\Theta(f(n))$ stands for a function $g(n)$ which satisfies $c_1f(n)\\le g(n)\\le c_2f(n)$ for some constants $c_1,c_2$ independent of $n$, while $\\omega(f(n))$ stands for a function $g(n)$ which satisfies $g(n)>cf(n)$ for any constant $c$.\n\nThe key idea of the attack is that Eve and Fred can cooperate to announce the $(i,j)$ pair. This is fundamentally different from the original RRDPS. To see the difference, examine the following example. Suppose the range of $i,j$ is $\\{1,2,3,4\\}$. In the original RRDPS, Eve chooses $i$. Then Bob chooses a random $j\\not =i$ and thus has three choices of $j$. However, when Bob's measurement device is held by another adversary Fred who cooperates with Eve, the adversaries could restrict the $(i,j)$ pair output to $(1,2),(1,4),(2,4)$. For any $i$ that can be announced, $j$ only has two choices and thus not uniformly random anymore.\n\nThe setting of the attack is as follows. The pulse train contains $n$ pulses and Alice sends a pulse train containing $(n-1)/2$ photons. Note that according to the state preparation of RRDPS, each photon is in the state\n\n", "itemtype": "equation", "pos": 4999, "prevtext": "\n\n\n\\title{Trustworthiness of measurement devices in round-robin differential-phase-shift quantum key distribution}\n\\author{Zhu Cao}\n\\address{Center for Quantum Information, Institute for Interdisciplinary Information Sciences, Tsinghua University, Beijing, China}\n\\author{Zhen-Qiang Yin}\n\\email{yinzq@ustc.edu.cn}\n\\address{Key Laboratory of Quantum Information, University of Science and Technology of China, Hefei 230026, China\\\\\nand Synergetic Innovation Center of Quantum Information $\\&$ Quantum Physics, University of Science and Technology of China,\\\\\nHefei, Anhui 230026, China}\n\\author{Zheng-Fu Han}\n\\affiliation{Key Laboratory of Quantum Information, University of Science and Technology of China, Hefei 230026, China\\\\\nand Synergetic Innovation Center of Quantum Information $\\&$ Quantum Physics, University of Science and Technology of China,\\\\\nHefei, Anhui 230026, China}\n\n\n\n\n\\begin{abstract}\nRound-robin differential-phase-shift quantum key distribution (RRDPS QKD) has been proposed to raise the noise tolerability of the channel. However, in practice, the measurement device in RRDPS QKD may be imperfect. Here, we show that, with these imperfections, the security of RRDPS may be damaged, by proposing two attacks for RRDPS systems with uncharacterized measurement devices. One is valid even for a system with unit total efficiency, while the other is valid even when a single photon state is sent. To prevent these attacks, either security arguments need to be fundamentally revised or further practical assumptions on the measurement device should be put.\n\\end{abstract}\n\n\\maketitle\n\n{\\it Introduction.} Quantum key distribution (QKD) enables an information-theoretic secure way of sharing a key between two distant parties Alice and Bob \\cite{Bennett:BB84:1984,Ekert:QKD:1991}. In QKD, Alice sends quantum signals to Bob who measures to obtain raw keys. Due to disturbance in the channel or eavesdropping, the raw keys might not be identical or secure. So Alice and Bob perform error correction and privacy amplification to recover secure identical keys. In traditional QKDs, both error correction and privacy amplification costs are estimated from the error rates in the channel, which leads to an upper bound on the allowable error rate. For example, the error rate threshold for the celebrated BB84 QKD protocol is $25\\%$ \\cite{Bennett:BB84:1984}.\n\nRecently, a QKD protocol, called round-robin differential-phase-shift (RRDPS) QKD \\cite{sasaki2014practical} is proposed. This scheme and its passive equivalent scheme \\cite{PRL114.180502}, were proven to be secure even under highly noisy channels, essentially removing the bound on the error rate. This desired property is achieved as they manage to directly compute the privacy amplification cost characterized by the phase error $e_{ph}$ without estimating the disturbance in the channel.\n\nHowever, practical implementations of the RRDPS schemes \\cite{PRL114.180502,RRDPSexp1,RRDPSexp2,RRDPSexp3} may be imperfect. For example, in the security proof of the RRDPS schemes \\cite{sasaki2014practical,PRL114.180502}, Bob's measurement device is assumed to be a well-defined projective measurement acting on incoming single photon states. However, this assumption may be spoiled in practice because current detectors can malfunction under bright pulse illumination \\cite{RRDPSexp1}. As another example, the beam splitter in the measurement device is assumed to have a transmission-reflection ratio of one half. However, in practice the transmission-reflection ratio of the beam splitter varies with different wavelengths and can thus be manipulated by adjusting the wavelength \\cite{PhysRevA.84.062308}.\n\nIn this work, we show that these imperfections in the measurement device may call the security of RRDPS into question.\nThis is not obvious because the key security argument of RRDPS protocol, is that Alice's key is completely determined by the density matrix of her prepared state and Bob's $r$ is chosen by himself instead of the measurement device. These are not changed when the measurement device is imperfect. To model the imperfections, we consider the worst case scenario that Bob's measurement device is untrusted, and then propose two attacks to break the security.  One must impose that Bob's untrusted measurement device cannot communicate the measured keys with the adversary Eve outside Bob's environment, because otherwise no secure keys can be established. This can be done by, e.g., putting a shield around Bob's workstation.\n\nIn the following, we will first describe the untrusted measurement scenario in detail, and then describe our two attacks. Finally, we conclude with a few interesting open questions.\n\n{\\it Untrusted measurement RRDPS.}\nIn the original RRDPS protocol, as shown in Fig.~\\ref{fig:illus}(a), Alice's preparation of random bits sequence $s_1,\\cdots, s_L$ and corresponding $L$-pulse state can be regarded as the following\noperations equivalently. Alice firstly prepares the quantum state\n\n", "index": 1, "text": "\\begin{equation}\n\\mbox{$\\left| {\\Psi} \\right\\rangle$}_1= \\frac{1}{2^{L/2}} \\prod\\limits_{k=1}^L ( \\mbox{$\\left| {0} \\right\\rangle$}_k + (-1)^{\\hat{n}_k}\\mbox{$\\left| {1} \\right\\rangle$}_k  )\\mbox{$\\left| {\\Psi} \\right\\rangle$}_B,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"\\mbox{$\\left|{\\Psi}\\right\\rangle$}_{1}=\\frac{1}{2^{L/2}}\\prod\\limits_{k=1}^{L}%&#10;(\\mbox{$\\left|{0}\\right\\rangle$}_{k}+(-1)^{\\hat{n}_{k}}\\mbox{$\\left|{1}\\right%&#10;\\rangle$}_{k})\\mbox{$\\left|{\\Psi}\\right\\rangle$}_{B},\" display=\"block\"><mrow><mrow><msub><mrow><mo fence=\"true\">|</mo><mi mathvariant=\"normal\">\u03a8</mi><mo>\u27e9</mo></mrow><mn>1</mn></msub><mo>=</mo><mrow><mfrac><mn>1</mn><msup><mn>2</mn><mrow><mi>L</mi><mo>/</mo><mn>2</mn></mrow></msup></mfrac><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u220f</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>L</mi></munderover><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mi>k</mi></msub><mo>+</mo><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><msub><mover accent=\"true\"><mi>n</mi><mo stretchy=\"false\">^</mo></mover><mi>k</mi></msub></msup><mo>\u2062</mo><msub><mrow><mo fence=\"true\">|</mo><mn>1</mn><mo>\u27e9</mo></mrow><mi>k</mi></msub></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><msub><mrow><mo fence=\"true\">|</mo><mi mathvariant=\"normal\">\u03a8</mi><mo>\u27e9</mo></mrow><mi>B</mi></msub></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.06385.tex", "nexttext": "\nEve first splits these $(n-1)/2$ photons and performs a passive interference with each photon. Then Eve obtains the relative phases of $(n-1)/2$ random pairs of $(i,j)$, with details in Appendix \\ref{app:passive}.\n\nA critical property of the relative phase is its transitivity. This can be easily shown as follows. If  both $s_i\\oplus s_j$ and $s_j \\oplus s_k$ are known, then\n\n", "itemtype": "equation", "pos": 9218, "prevtext": "\nwhere $\\mbox{$\\left| {} \\right\\rangle$}_k$ represents Alice's ancillary qubits, $\\hat{n}_k$ is the photon number operator acting on $\\mbox{$\\left| {\\Psi} \\right\\rangle$}_B$, and $\\mbox{$\\left| {\\Psi} \\right\\rangle$}_B$ is the encoding state which will be sent to Bob via a quantum channel. Alice's bit $s_k$ can be viewed as the output of $Z$ basis measurement $\\{\\mbox{$\\left| {0} \\right\\rangle$}\\mbox{$\\left\\langle {0} \\right|$},\\mbox{$\\left| {1} \\right\\rangle$}\\mbox{$\\left\\langle {1} \\right|$}\\}$ on ancilla $\\mbox{$\\left| {k} \\right\\rangle$}$.\nNext, Alice sends the quantum state to Bob. Bob splits the input to two paths, applies a random delay $r$ to one of the paths, obtains $i$, $j=i+r$, $s_i \\oplus s_j$ through detectors' outcomes and announces $i$ and $j$ to Alice. On receiving $i$ and $j$, Alice performs a controlled-NOT gate to her ancilla $\\mbox{$\\left| {} \\right\\rangle$}_i$ and $\\mbox{$\\left| {} \\right\\rangle$}_j$, in which $\\mbox{$\\left| {} \\right\\rangle$}_i$ is the control qubit while $\\mbox{$\\left| {} \\right\\rangle$}_j$ is the target. Then Alice can measure $\\mbox{$\\left| {} \\right\\rangle$}_j$ with the $Z$ basis to obtain her sifted key bit $s_i\\oplus s_j$.\n\n\\begin{figure}[hbt]\n\\centering\n\\includegraphics[width=7cm]{illus.eps}\n\\caption{(a) Original RRDPS \\cite{sasaki2014practical}. Alice sends a pulse train to Bob, who splits the pulse train into two paths, adds a delay $r$ to\none of the paths, measures the interference to obtain $s_i\\oplus s_j$, $i$, $j$, and publicly announces $i$, $j$.\n(b) Untrusted measurement variant. Instead of performing the operations himself, Bob gives an untrusted measurement device, Fred, the pulse train along with a random $r$, and Fred outputs $s_i\\oplus s_j$, $i$, $j=i+r$. One possible implementation of Fred could be exactly the same as the corresponding part of the original RRDPS.}\n\\label{fig:illus}\n\\end{figure}\n\nWhen the measurement is untrusted, as shown in Fig.~\\ref{fig:illus}(b), Alice prepares the same state and sends it to Bob. After receiving the incoming state, Bob inputs a random delay value $r$ to his untrusted device, obtains $i, j$ $(j-i = r)$, and an estimated value of $s_i\\oplus s_j$. The rest procedures are the same, where Bob publicly announces $i,j$ and Alice performs the controlled-NOT gate accordingly. Here untrusted means that Bob's device is an unknown quantum measurement device, called Fred, which could be manufactured by the adversary Eve. We assume here that Fred cannot actively disclose any information outside of Bob's environment bypassing Bob (e.g. by sending light signals). This assumption in particular eliminates the possibility of Fred telling Eve, who is outside, the measurement result $s_i\\oplus s_j$ because Bob never announces it.\n\n{\\it Proposed attack 1.}\nBefore describing the first attack, we settle down some useful notations. For a function $f(n)$, $\\Theta(f(n))$ stands for a function $g(n)$ which satisfies $c_1f(n)\\le g(n)\\le c_2f(n)$ for some constants $c_1,c_2$ independent of $n$, while $\\omega(f(n))$ stands for a function $g(n)$ which satisfies $g(n)>cf(n)$ for any constant $c$.\n\nThe key idea of the attack is that Eve and Fred can cooperate to announce the $(i,j)$ pair. This is fundamentally different from the original RRDPS. To see the difference, examine the following example. Suppose the range of $i,j$ is $\\{1,2,3,4\\}$. In the original RRDPS, Eve chooses $i$. Then Bob chooses a random $j\\not =i$ and thus has three choices of $j$. However, when Bob's measurement device is held by another adversary Fred who cooperates with Eve, the adversaries could restrict the $(i,j)$ pair output to $(1,2),(1,4),(2,4)$. For any $i$ that can be announced, $j$ only has two choices and thus not uniformly random anymore.\n\nThe setting of the attack is as follows. The pulse train contains $n$ pulses and Alice sends a pulse train containing $(n-1)/2$ photons. Note that according to the state preparation of RRDPS, each photon is in the state\n\n", "index": 3, "text": "\\begin{equation}\n\\mbox{$\\left| {\\psi} \\right\\rangle$}= \\frac{1}{\\sqrt n}\\sum\\limits_{i=1}^n (-1)^{s_i}\\mbox{$\\left| {i} \\right\\rangle$}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"\\mbox{$\\left|{\\psi}\\right\\rangle$}=\\frac{1}{\\sqrt{n}}\\sum\\limits_{i=1}^{n}(-1)%&#10;^{s_{i}}\\mbox{$\\left|{i}\\right\\rangle$}\" display=\"block\"><mrow><mrow><mo fence=\"true\">|</mo><mi>\u03c8</mi><mo>\u27e9</mo></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><msqrt><mi>n</mi></msqrt></mfrac><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><msub><mi>s</mi><mi>i</mi></msub></msup><mo>\u2062</mo><mrow><mo fence=\"true\">|</mo><mi>i</mi><mo>\u27e9</mo></mrow></mrow></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.06385.tex", "nexttext": "\nis also known. For ease of presentation, we construct a graph with $n$ nodes corresponding to the $n$ pulses in the pulse train. If Eve detects the relative phase of $(i,j)$, add an edge between node $i$ and $j$. Then by the aforementioned property, if node $i$ and node $k$ can be connected by a path of nodes, their relative phase is known. Furthermore, by a well-known random graph result \\cite{erdos}, since each edge appears with probability\n\n", "itemtype": "equation", "pos": 9746, "prevtext": "\nEve first splits these $(n-1)/2$ photons and performs a passive interference with each photon. Then Eve obtains the relative phases of $(n-1)/2$ random pairs of $(i,j)$, with details in Appendix \\ref{app:passive}.\n\nA critical property of the relative phase is its transitivity. This can be easily shown as follows. If  both $s_i\\oplus s_j$ and $s_j \\oplus s_k$ are known, then\n\n", "index": 5, "text": "\\begin{equation}\ns_i \\oplus s_k= (s_i\\oplus s_j)\\oplus (s_j \\oplus s_k)\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"s_{i}\\oplus s_{k}=(s_{i}\\oplus s_{j})\\oplus(s_{j}\\oplus s_{k})\" display=\"block\"><mrow><mrow><msub><mi>s</mi><mi>i</mi></msub><mo>\u2295</mo><msub><mi>s</mi><mi>k</mi></msub></mrow><mo>=</mo><mrow><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>s</mi><mi>i</mi></msub><mo>\u2295</mo><msub><mi>s</mi><mi>j</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2295</mo><mrow><mo stretchy=\"false\">(</mo><mrow><msub><mi>s</mi><mi>j</mi></msub><mo>\u2295</mo><msub><mi>s</mi><mi>k</mi></msub></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.06385.tex", "nexttext": "\nthere exists a connected component of size $\\Theta (n^{2/3})$. Thus the relative phases between the $\\Theta (n^{2/3})$ nodes in this connected component are all known by Eve. For a moderate size of $n=1000$, simulations show that with $p=1/40$ edge probability, there exists a connected component of size at least 200 at a $99\\%$ confidence level.\n\nEve proceeds to send the corresponding indices of these $m=\\Theta (n^{2/3})$ nodes and their phases to Fred. Denote the indices as $a_1,\\dots, a_m$. By calculations of the probability in Appendix \\ref{app:prob}, we show that with probability approaching 1, $\\{|a_i-a_j|, 1\\le i,j\\le n\\}$ will contain almost all numbers in the set $\\{1,\\cdots,n-1\\}$.\nFor a moderate size $m=200$ and $n=1000$, simulations show that at a $99\\%$ confidence level, at least $95\\%$ of elements in $\\{1,\\cdots,n-1\\}$ appear as differences of $a_i$.\nThus when Bob inputs a delay $r$ to Fred, he could announce a corresponding pair $a_i,a_j$ such that\n\n", "itemtype": "equation", "pos": 10280, "prevtext": "\nis also known. For ease of presentation, we construct a graph with $n$ nodes corresponding to the $n$ pulses in the pulse train. If Eve detects the relative phase of $(i,j)$, add an edge between node $i$ and $j$. Then by the aforementioned property, if node $i$ and node $k$ can be connected by a path of nodes, their relative phase is known. Furthermore, by a well-known random graph result \\cite{erdos}, since each edge appears with probability\n\n", "index": 7, "text": "\\begin{equation}\np=\\frac{\\frac{n-1}{2}}{\\binom{n}{2}}=\\frac{1}{n}.\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"p=\\frac{\\frac{n-1}{2}}{\\binom{n}{2}}=\\frac{1}{n}.\" display=\"block\"><mrow><mrow><mi>p</mi><mo>=</mo><mfrac><mfrac><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow><mn>2</mn></mfrac><mrow><mo>(</mo><mfrac linethickness=\"0pt\"><mi>n</mi><mn>2</mn></mfrac><mo>)</mo></mrow></mfrac><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.06385.tex", "nexttext": "\nand also outputs $s_{a_i}\\oplus s_{a_j}$ to Bob. However, since $a_i,a_j$ are publicly announced, Eve, who is outside Bob's environment, can also recover $s_{a_i}\\oplus s_{a_j}$ perfectly without causing any disturbance.\n\nFinally, we note that, if some delay $r$ is absent, Fred could announce loss when Bob inputs this $r$. So in the asymptotic limit, the existence of a majority of delays from $\\{1,\\cdots,n-1\\}$ could already guarantee Fred to output with almost unit probability.\n\nNow we turn to the implications of this attack. Let us examine the phase error formula for RRDPS protocol. In the original work \\cite{sasaki2014practical}, the phase error formula is $e_{ph}=n_{ph}/(L-1)$, where $L$ is the number of pulses in the pulse train and $n_{ph}$ is the number of photons that Alice sends. We plug in $n_{ph}=(n-1)/2$ and $L=n$ and get $e_{ph}=1/2$. This means that there are no secure keys and does not contradict with the fact that Eve has obtained all the information that Alice and Bob share.\n\nHowever, the phase error in the original paper is not tight. Indeed, the phase error is later improved \\cite{PRL114.180502, arXiv1505} and is given by $e_{ph}=[1-(1-2/L)^{n_{ph}}]/2$. The improvement relies on the fact that when Eve chooses $i$ and Bob chooses a random $j\\not =i$ for multiple photons, an phase error happens only with an odd number of photons. By plugging in $n_{ph}=(n-1)/2$ and $L=n$, we have $e_{ph}=(1-1/e)/2$ when $n$ is large. This implies that secure keys can be generated and a contradiction occurs. This shows that in the untrusted measurement setting, with even unit efficiency, careful study of the phase error is needed since the model is no longer equivalent to the original RRDPS protocol. Through the proposed attack, Eve can learn key bits without introducing any additional error rates. In the following, we propose another attack, in which Eve can learn key bits with the help of additional error rates when total loss is larger than 3dB.\n\n{\\it Proposed attack 2.} In the second attack, Eve and Fred will obtain Alice's key bit with certainty, but introduce $50\\%$ bit error rate and $50\\%$ channel loss between Alice and Bob.\n\nConsider Alice prepares the following single photon encoding state\n\n", "itemtype": "equation", "pos": 11339, "prevtext": "\nthere exists a connected component of size $\\Theta (n^{2/3})$. Thus the relative phases between the $\\Theta (n^{2/3})$ nodes in this connected component are all known by Eve. For a moderate size of $n=1000$, simulations show that with $p=1/40$ edge probability, there exists a connected component of size at least 200 at a $99\\%$ confidence level.\n\nEve proceeds to send the corresponding indices of these $m=\\Theta (n^{2/3})$ nodes and their phases to Fred. Denote the indices as $a_1,\\dots, a_m$. By calculations of the probability in Appendix \\ref{app:prob}, we show that with probability approaching 1, $\\{|a_i-a_j|, 1\\le i,j\\le n\\}$ will contain almost all numbers in the set $\\{1,\\cdots,n-1\\}$.\nFor a moderate size $m=200$ and $n=1000$, simulations show that at a $99\\%$ confidence level, at least $95\\%$ of elements in $\\{1,\\cdots,n-1\\}$ appear as differences of $a_i$.\nThus when Bob inputs a delay $r$ to Fred, he could announce a corresponding pair $a_i,a_j$ such that\n\n", "index": 9, "text": "\\begin{equation}\n|a_i-a_j|=r,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"|a_{i}-a_{j}|=r,\" display=\"block\"><mrow><mrow><mrow><mo stretchy=\"false\">|</mo><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>-</mo><msub><mi>a</mi><mi>j</mi></msub></mrow><mo stretchy=\"false\">|</mo></mrow><mo>=</mo><mi>r</mi></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.06385.tex", "nexttext": "\nThen Eve launches an attack in the following way:\n\n\n", "itemtype": "equation", "pos": 13623, "prevtext": "\nand also outputs $s_{a_i}\\oplus s_{a_j}$ to Bob. However, since $a_i,a_j$ are publicly announced, Eve, who is outside Bob's environment, can also recover $s_{a_i}\\oplus s_{a_j}$ perfectly without causing any disturbance.\n\nFinally, we note that, if some delay $r$ is absent, Fred could announce loss when Bob inputs this $r$. So in the asymptotic limit, the existence of a majority of delays from $\\{1,\\cdots,n-1\\}$ could already guarantee Fred to output with almost unit probability.\n\nNow we turn to the implications of this attack. Let us examine the phase error formula for RRDPS protocol. In the original work \\cite{sasaki2014practical}, the phase error formula is $e_{ph}=n_{ph}/(L-1)$, where $L$ is the number of pulses in the pulse train and $n_{ph}$ is the number of photons that Alice sends. We plug in $n_{ph}=(n-1)/2$ and $L=n$ and get $e_{ph}=1/2$. This means that there are no secure keys and does not contradict with the fact that Eve has obtained all the information that Alice and Bob share.\n\nHowever, the phase error in the original paper is not tight. Indeed, the phase error is later improved \\cite{PRL114.180502, arXiv1505} and is given by $e_{ph}=[1-(1-2/L)^{n_{ph}}]/2$. The improvement relies on the fact that when Eve chooses $i$ and Bob chooses a random $j\\not =i$ for multiple photons, an phase error happens only with an odd number of photons. By plugging in $n_{ph}=(n-1)/2$ and $L=n$, we have $e_{ph}=(1-1/e)/2$ when $n$ is large. This implies that secure keys can be generated and a contradiction occurs. This shows that in the untrusted measurement setting, with even unit efficiency, careful study of the phase error is needed since the model is no longer equivalent to the original RRDPS protocol. Through the proposed attack, Eve can learn key bits without introducing any additional error rates. In the following, we propose another attack, in which Eve can learn key bits with the help of additional error rates when total loss is larger than 3dB.\n\n{\\it Proposed attack 2.} In the second attack, Eve and Fred will obtain Alice's key bit with certainty, but introduce $50\\%$ bit error rate and $50\\%$ channel loss between Alice and Bob.\n\nConsider Alice prepares the following single photon encoding state\n\n", "index": 11, "text": "\\begin{equation}\n\\label{Psi_1}\n\\begin{split}\n\\mbox{$\\left| {\\Psi} \\right\\rangle$}_1=\\frac{1}{\\sqrt{L}}&(e^{i\\alpha_1}\\mbox{$\\left| {1} \\right\\rangle$}_1\\mbox{$\\left| {0} \\right\\rangle$}_2\\mbox{$\\left| {0} \\right\\rangle$}_3\\cdots\\mbox{$\\left| {0} \\right\\rangle$}_L\\\\\n&+e^{i\\alpha_2}\\mbox{$\\left| {0} \\right\\rangle$}_1\\mbox{$\\left| {1} \\right\\rangle$}_2\\mbox{$\\left| {0} \\right\\rangle$}_3\\cdots\\mbox{$\\left| {0} \\right\\rangle$}_L\\\\\n&+e^{i\\alpha_3}\\mbox{$\\left| {0} \\right\\rangle$}_1\\mbox{$\\left| {0} \\right\\rangle$}_2\\mbox{$\\left| {1} \\right\\rangle$}_3\\cdots\\mbox{$\\left| {0} \\right\\rangle$}_L\\\\\n&+...\\\\\n&+e^{i\\alpha_L}\\mbox{$\\left| {0} \\right\\rangle$}_1\\mbox{$\\left| {0} \\right\\rangle$}_2\\mbox{$\\left| {0} \\right\\rangle$}_3\\cdots\\mbox{$\\left| {1} \\right\\rangle$}_L).\n\\end{split}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"\\begin{split}\\displaystyle\\mbox{$\\left|{\\Psi}\\right\\rangle$}_{1}=\\frac{1}{%&#10;\\sqrt{L}}&amp;\\displaystyle(e^{i\\alpha_{1}}\\mbox{$\\left|{1}\\right\\rangle$}_{1}%&#10;\\mbox{$\\left|{0}\\right\\rangle$}_{2}\\mbox{$\\left|{0}\\right\\rangle$}_{3}\\cdots%&#10;\\mbox{$\\left|{0}\\right\\rangle$}_{L}\\\\&#10;&amp;\\displaystyle+e^{i\\alpha_{2}}\\mbox{$\\left|{0}\\right\\rangle$}_{1}\\mbox{$\\left|%&#10;{1}\\right\\rangle$}_{2}\\mbox{$\\left|{0}\\right\\rangle$}_{3}\\cdots\\mbox{$\\left|{0%&#10;}\\right\\rangle$}_{L}\\\\&#10;&amp;\\displaystyle+e^{i\\alpha_{3}}\\mbox{$\\left|{0}\\right\\rangle$}_{1}\\mbox{$\\left|%&#10;{0}\\right\\rangle$}_{2}\\mbox{$\\left|{1}\\right\\rangle$}_{3}\\cdots\\mbox{$\\left|{0%&#10;}\\right\\rangle$}_{L}\\\\&#10;&amp;\\displaystyle+...\\\\&#10;&amp;\\displaystyle+e^{i\\alpha_{L}}\\mbox{$\\left|{0}\\right\\rangle$}_{1}\\mbox{$\\left|%&#10;{0}\\right\\rangle$}_{2}\\mbox{$\\left|{0}\\right\\rangle$}_{3}\\cdots\\mbox{$\\left|{1%&#10;}\\right\\rangle$}_{L}).\\end{split}\" display=\"block\"><mtable columnspacing=\"0pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"right\"><mrow><msub><mrow><mo fence=\"true\">|</mo><mi mathvariant=\"normal\">\u03a8</mi><mo>\u27e9</mo></mrow><mn>1</mn></msub><mo>=</mo><mfrac><mn>1</mn><msqrt><mi>L</mi></msqrt></mfrac></mrow></mtd><mtd columnalign=\"left\"><mrow><mo stretchy=\"false\">(</mo><msup><mi>e</mi><mrow><mi>i</mi><mo>\u2062</mo><msub><mi>\u03b1</mi><mn>1</mn></msub></mrow></msup><msub><mrow><mo fence=\"true\">|</mo><mn>1</mn><mo>\u27e9</mo></mrow><mn>1</mn></msub><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mn>2</mn></msub><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mn>3</mn></msub><mi mathvariant=\"normal\">\u22ef</mi><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mi>L</mi></msub></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mo>+</mo><mrow><msup><mi>e</mi><mrow><mi>i</mi><mo>\u2062</mo><msub><mi>\u03b1</mi><mn>2</mn></msub></mrow></msup><mo>\u2062</mo><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mn>1</mn></msub><mo>\u2062</mo><msub><mrow><mo fence=\"true\">|</mo><mn>1</mn><mo>\u27e9</mo></mrow><mn>2</mn></msub><mo>\u2062</mo><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mn>3</mn></msub><mo>\u2062</mo><mi mathvariant=\"normal\">\u22ef</mi><mo>\u2062</mo><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mi>L</mi></msub></mrow></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mo>+</mo><mrow><msup><mi>e</mi><mrow><mi>i</mi><mo>\u2062</mo><msub><mi>\u03b1</mi><mn>3</mn></msub></mrow></msup><mo>\u2062</mo><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mn>1</mn></msub><mo>\u2062</mo><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mn>2</mn></msub><mo>\u2062</mo><msub><mrow><mo fence=\"true\">|</mo><mn>1</mn><mo>\u27e9</mo></mrow><mn>3</mn></msub><mo>\u2062</mo><mi mathvariant=\"normal\">\u22ef</mi><mo>\u2062</mo><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mi>L</mi></msub></mrow></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mo>+</mo><mi mathvariant=\"normal\">\u2026</mi></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mo>+</mo><msup><mi>e</mi><mrow><mi>i</mi><mo>\u2062</mo><msub><mi>\u03b1</mi><mi>L</mi></msub></mrow></msup><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mn>1</mn></msub><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mn>2</mn></msub><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mn>3</mn></msub><mi mathvariant=\"normal\">\u22ef</mi><msub><mrow><mo fence=\"true\">|</mo><mn>1</mn><mo>\u27e9</mo></mrow><mi>L</mi></msub><mo stretchy=\"false\">)</mo><mo>.</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.06385.tex", "nexttext": "\nwhere, $\\mbox{$\\left| {n} \\right\\rangle$}_E$ is the ancilla of Eve and $_E\\mbox{$\\left\\langle {n} \\right|$}m\\rangle_E=\\delta_{mn}$. Eve sends this ancilla $E$ to Bob's device (Fred) and retains Alice's encoding state $|\\rangle_1|\\rangle_2...|\\rangle_L$ in her quantum memory.\nFred simply measures $E$ according to Bob's input $r$. For example, if $r=1$, Fred measures $E$ with the basis $(\\mbox{$\\left| {1} \\right\\rangle$}_E\\pm \\mbox{$\\left| {2} \\right\\rangle$}_E, \\mbox{$\\left| {2} \\right\\rangle$}_E\\pm \\mbox{$\\left| {3} \\right\\rangle$}_E,...)$, which is the same as the $r$-delay interference and will output a pair of $i$ and $j$ definitely. If Fred obtains $\\mbox{$\\left| {i} \\right\\rangle$}_E+ \\mbox{$\\left| {j} \\right\\rangle$}_E$, Fred will inform Bob the $i$, $j$, and a random key bit. If Fred obtains $\\mbox{$\\left| {i} \\right\\rangle$}_E- \\mbox{$\\left| {j} \\right\\rangle$}_E$, Fred will inform Bob that there is no click in this run. For instance, Fred observes $(\\mbox{$\\left| {1} \\right\\rangle$}_E+ \\mbox{$\\left| {2} \\right\\rangle$}_E)$ in this run, then Alice's encoding state becomes\n\n\n", "itemtype": "equation", "pos": 14467, "prevtext": "\nThen Eve launches an attack in the following way:\n\n\n", "index": 13, "text": "\\begin{equation}\n\\label{Psi_2}\n\\begin{split}\n\\mbox{$\\left| {\\Psi} \\right\\rangle$}_2=\\frac{1}{\\sqrt{L}}&(e^{i\\alpha_1}\\mbox{$\\left| {1} \\right\\rangle$}_1\\mbox{$\\left| {0} \\right\\rangle$}_2\\mbox{$\\left| {0} \\right\\rangle$}_3\\cdots\\mbox{$\\left| {0} \\right\\rangle$}_L\\mbox{$\\left| {1} \\right\\rangle$}_E\\\\\n&+e^{i\\alpha_2}\\mbox{$\\left| {0} \\right\\rangle$}_1\\mbox{$\\left| {1} \\right\\rangle$}_2\\mbox{$\\left| {0} \\right\\rangle$}_3\\cdots\\mbox{$\\left| {0} \\right\\rangle$}_L\\mbox{$\\left| {2} \\right\\rangle$}_E\\\\\n&+e^{i\\alpha_3}\\mbox{$\\left| {0} \\right\\rangle$}_1\\mbox{$\\left| {0} \\right\\rangle$}_2\\mbox{$\\left| {1} \\right\\rangle$}_3\\cdots\\mbox{$\\left| {0} \\right\\rangle$}_L\\mbox{$\\left| {3} \\right\\rangle$}_E\\\\\n&+...\\\\\n&+e^{i\\alpha_L}\\mbox{$\\left| {0} \\right\\rangle$}_1\\mbox{$\\left| {0} \\right\\rangle$}_2\\mbox{$\\left| {0} \\right\\rangle$}_3\\cdots\\mbox{$\\left| {1} \\right\\rangle$}_L\\mbox{$\\left| {L} \\right\\rangle$}_E),\n\\end{split}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"\\begin{split}\\displaystyle\\mbox{$\\left|{\\Psi}\\right\\rangle$}_{2}=\\frac{1}{%&#10;\\sqrt{L}}&amp;\\displaystyle(e^{i\\alpha_{1}}\\mbox{$\\left|{1}\\right\\rangle$}_{1}%&#10;\\mbox{$\\left|{0}\\right\\rangle$}_{2}\\mbox{$\\left|{0}\\right\\rangle$}_{3}\\cdots%&#10;\\mbox{$\\left|{0}\\right\\rangle$}_{L}\\mbox{$\\left|{1}\\right\\rangle$}_{E}\\\\&#10;&amp;\\displaystyle+e^{i\\alpha_{2}}\\mbox{$\\left|{0}\\right\\rangle$}_{1}\\mbox{$\\left|%&#10;{1}\\right\\rangle$}_{2}\\mbox{$\\left|{0}\\right\\rangle$}_{3}\\cdots\\mbox{$\\left|{0%&#10;}\\right\\rangle$}_{L}\\mbox{$\\left|{2}\\right\\rangle$}_{E}\\\\&#10;&amp;\\displaystyle+e^{i\\alpha_{3}}\\mbox{$\\left|{0}\\right\\rangle$}_{1}\\mbox{$\\left|%&#10;{0}\\right\\rangle$}_{2}\\mbox{$\\left|{1}\\right\\rangle$}_{3}\\cdots\\mbox{$\\left|{0%&#10;}\\right\\rangle$}_{L}\\mbox{$\\left|{3}\\right\\rangle$}_{E}\\\\&#10;&amp;\\displaystyle+...\\\\&#10;&amp;\\displaystyle+e^{i\\alpha_{L}}\\mbox{$\\left|{0}\\right\\rangle$}_{1}\\mbox{$\\left|%&#10;{0}\\right\\rangle$}_{2}\\mbox{$\\left|{0}\\right\\rangle$}_{3}\\cdots\\mbox{$\\left|{1%&#10;}\\right\\rangle$}_{L}\\mbox{$\\left|{L}\\right\\rangle$}_{E}),\\end{split}\" display=\"block\"><mtable columnspacing=\"0pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"right\"><mrow><msub><mrow><mo fence=\"true\">|</mo><mi mathvariant=\"normal\">\u03a8</mi><mo>\u27e9</mo></mrow><mn>2</mn></msub><mo>=</mo><mfrac><mn>1</mn><msqrt><mi>L</mi></msqrt></mfrac></mrow></mtd><mtd columnalign=\"left\"><mrow><mo stretchy=\"false\">(</mo><msup><mi>e</mi><mrow><mi>i</mi><mo>\u2062</mo><msub><mi>\u03b1</mi><mn>1</mn></msub></mrow></msup><msub><mrow><mo fence=\"true\">|</mo><mn>1</mn><mo>\u27e9</mo></mrow><mn>1</mn></msub><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mn>2</mn></msub><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mn>3</mn></msub><mi mathvariant=\"normal\">\u22ef</mi><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mi>L</mi></msub><msub><mrow><mo fence=\"true\">|</mo><mn>1</mn><mo>\u27e9</mo></mrow><mi>E</mi></msub></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mo>+</mo><mrow><msup><mi>e</mi><mrow><mi>i</mi><mo>\u2062</mo><msub><mi>\u03b1</mi><mn>2</mn></msub></mrow></msup><mo>\u2062</mo><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mn>1</mn></msub><mo>\u2062</mo><msub><mrow><mo fence=\"true\">|</mo><mn>1</mn><mo>\u27e9</mo></mrow><mn>2</mn></msub><mo>\u2062</mo><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mn>3</mn></msub><mo>\u2062</mo><mi mathvariant=\"normal\">\u22ef</mi><mo>\u2062</mo><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mi>L</mi></msub><mo>\u2062</mo><msub><mrow><mo fence=\"true\">|</mo><mn>2</mn><mo>\u27e9</mo></mrow><mi>E</mi></msub></mrow></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mo>+</mo><mrow><msup><mi>e</mi><mrow><mi>i</mi><mo>\u2062</mo><msub><mi>\u03b1</mi><mn>3</mn></msub></mrow></msup><mo>\u2062</mo><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mn>1</mn></msub><mo>\u2062</mo><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mn>2</mn></msub><mo>\u2062</mo><msub><mrow><mo fence=\"true\">|</mo><mn>1</mn><mo>\u27e9</mo></mrow><mn>3</mn></msub><mo>\u2062</mo><mi mathvariant=\"normal\">\u22ef</mi><mo>\u2062</mo><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mi>L</mi></msub><mo>\u2062</mo><msub><mrow><mo fence=\"true\">|</mo><mn>3</mn><mo>\u27e9</mo></mrow><mi>E</mi></msub></mrow></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mo>+</mo><mi mathvariant=\"normal\">\u2026</mi></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mo>+</mo><msup><mi>e</mi><mrow><mi>i</mi><mo>\u2062</mo><msub><mi>\u03b1</mi><mi>L</mi></msub></mrow></msup><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mn>1</mn></msub><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mn>2</mn></msub><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mn>3</mn></msub><mi mathvariant=\"normal\">\u22ef</mi><msub><mrow><mo fence=\"true\">|</mo><mn>1</mn><mo>\u27e9</mo></mrow><mi>L</mi></msub><msub><mrow><mo fence=\"true\">|</mo><mi>L</mi><mo>\u27e9</mo></mrow><mi>E</mi></msub><mo stretchy=\"false\">)</mo><mo>,</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.06385.tex", "nexttext": "\nSince this state is retained by Eve, she can learn Alice's sifted key bit $\\alpha_1\\oplus \\alpha_2$ easily. Though this attack introduces high error rate, it implies that the security of RRDPS in the untrusted measurement scenario will depend on the error rate, which is completely different from original RRDPS protocol. Hence, one may conjecture that Eve's information on key bits depends on the error rate in the untrusted measurement setting, while the original RRDPS protocol features that monitoring signal disturbance is not necessary for placing a bound on Eve's information.\n\nThe error rate $50\\%$ can be reduced by mixing performing and not performing this attack together with probability $1/2$ each. Then the error rate drops to $25\\%$, while the same feature, channel-dependent phase error, still holds.\nHence, when Bob's device is untrusted, the RRDPS protocol is not secure and monitoring signal disturbance would be necessary. This finding may shed lights on the future security proof of RRDPS in untrusted measurement scenario.\n\n{\\it Discussion.} In summary, we have shown that the security of RRDPS protocol can be damaged when the measurement device is not perfect and consequently does not satisfy the assumptions of the protocol. We prove this by giving two concrete attacks for RRDPS with completely untrusted measurement device. In addition to showing a warning sign for the trustworthiness of the measurement device, our work raises two interesting questions:\n\nThe first question is how to prove the security of RRDPS with untrusted measurement.\nOur result shows that in the untrusted measurement setting, the security analysis is significantly different from the original RRDPS, and thus calls for more scrutiny in the analysis of the untrusted measurement setting. We show in Appendix \\ref{app:security} that it can be proven to be secure in the perfect case where there is no error and no loss.\n We therefore conjecture that it could also be made secure under a general lossy and erroneous channel when one correctly characterizes the information leakage. But the security proof may require transforming the experiment setup to a completely different intermediate model.\n\nThe second question is motivated by the fact that our untrusted measurement assumption may not be satisfied by a current-technology-hackable measurement device. Hence, it is interesting to see how our attacks can be modified and implemented on a current experimental RRDPS setup.\n\nThe authors would like to thank X. Ma for enlightening discussions. This work was supported by the National Basic Research Program of China (Grants No. 2011CBA00200 and No. 2011CB921200), National Natural Science Foundation of China (Grants No. 61475148) and the 1000 Youth Fellowship program in China.\n\n\\appendix\n\\section{Passive interference}\n\\label{app:passive}\nIn the passive interference, Eve prepares a superposed state with plain phases,\n\n", "itemtype": "equation", "pos": 16498, "prevtext": "\nwhere, $\\mbox{$\\left| {n} \\right\\rangle$}_E$ is the ancilla of Eve and $_E\\mbox{$\\left\\langle {n} \\right|$}m\\rangle_E=\\delta_{mn}$. Eve sends this ancilla $E$ to Bob's device (Fred) and retains Alice's encoding state $|\\rangle_1|\\rangle_2...|\\rangle_L$ in her quantum memory.\nFred simply measures $E$ according to Bob's input $r$. For example, if $r=1$, Fred measures $E$ with the basis $(\\mbox{$\\left| {1} \\right\\rangle$}_E\\pm \\mbox{$\\left| {2} \\right\\rangle$}_E, \\mbox{$\\left| {2} \\right\\rangle$}_E\\pm \\mbox{$\\left| {3} \\right\\rangle$}_E,...)$, which is the same as the $r$-delay interference and will output a pair of $i$ and $j$ definitely. If Fred obtains $\\mbox{$\\left| {i} \\right\\rangle$}_E+ \\mbox{$\\left| {j} \\right\\rangle$}_E$, Fred will inform Bob the $i$, $j$, and a random key bit. If Fred obtains $\\mbox{$\\left| {i} \\right\\rangle$}_E- \\mbox{$\\left| {j} \\right\\rangle$}_E$, Fred will inform Bob that there is no click in this run. For instance, Fred observes $(\\mbox{$\\left| {1} \\right\\rangle$}_E+ \\mbox{$\\left| {2} \\right\\rangle$}_E)$ in this run, then Alice's encoding state becomes\n\n\n", "index": 15, "text": "\\begin{equation}\n\\label{Psi_3}\n\\begin{split}\n\\mbox{$\\left| {\\Psi} \\right\\rangle$}_3=\\frac{1}{\\sqrt{2}}&(e^{i\\alpha_1}\\mbox{$\\left| {1} \\right\\rangle$}_1\\mbox{$\\left| {0} \\right\\rangle$}_2\\mbox{$\\left| {0} \\right\\rangle$}_3\\mbox{$\\left| {0} \\right\\rangle$}_L\\\\\n&+e^{i\\alpha_2}\\mbox{$\\left| {0} \\right\\rangle$}_1\\mbox{$\\left| {1} \\right\\rangle$}_2\\mbox{$\\left| {0} \\right\\rangle$}_3\\mbox{$\\left| {0} \\right\\rangle$}_L).\n\\end{split}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m1\" class=\"ltx_Math\" alttext=\"\\begin{split}\\displaystyle\\mbox{$\\left|{\\Psi}\\right\\rangle$}_{3}=\\frac{1}{%&#10;\\sqrt{2}}&amp;\\displaystyle(e^{i\\alpha_{1}}\\mbox{$\\left|{1}\\right\\rangle$}_{1}%&#10;\\mbox{$\\left|{0}\\right\\rangle$}_{2}\\mbox{$\\left|{0}\\right\\rangle$}_{3}\\mbox{$%&#10;\\left|{0}\\right\\rangle$}_{L}\\\\&#10;&amp;\\displaystyle+e^{i\\alpha_{2}}\\mbox{$\\left|{0}\\right\\rangle$}_{1}\\mbox{$\\left|%&#10;{1}\\right\\rangle$}_{2}\\mbox{$\\left|{0}\\right\\rangle$}_{3}\\mbox{$\\left|{0}%&#10;\\right\\rangle$}_{L}).\\end{split}\" display=\"block\"><mtable columnspacing=\"0pt\" displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"right\"><mrow><msub><mrow><mo fence=\"true\">|</mo><mi mathvariant=\"normal\">\u03a8</mi><mo>\u27e9</mo></mrow><mn>3</mn></msub><mo>=</mo><mfrac><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac></mrow></mtd><mtd columnalign=\"left\"><mrow><mo stretchy=\"false\">(</mo><msup><mi>e</mi><mrow><mi>i</mi><mo>\u2062</mo><msub><mi>\u03b1</mi><mn>1</mn></msub></mrow></msup><msub><mrow><mo fence=\"true\">|</mo><mn>1</mn><mo>\u27e9</mo></mrow><mn>1</mn></msub><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mn>2</mn></msub><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mn>3</mn></msub><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mi>L</mi></msub></mrow></mtd></mtr><mtr><mtd/><mtd columnalign=\"left\"><mrow><mo>+</mo><msup><mi>e</mi><mrow><mi>i</mi><mo>\u2062</mo><msub><mi>\u03b1</mi><mn>2</mn></msub></mrow></msup><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mn>1</mn></msub><msub><mrow><mo fence=\"true\">|</mo><mn>1</mn><mo>\u27e9</mo></mrow><mn>2</mn></msub><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mn>3</mn></msub><msub><mrow><mo fence=\"true\">|</mo><mn>0</mn><mo>\u27e9</mo></mrow><mi>L</mi></msub><mo stretchy=\"false\">)</mo><mo>.</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.06385.tex", "nexttext": "\nand interferes with Alice's photon with a beam splitter which results in a mixture of\nthe two click events \\cite{PRL114.180502},\n\n", "itemtype": "equation", "pos": 19868, "prevtext": "\nSince this state is retained by Eve, she can learn Alice's sifted key bit $\\alpha_1\\oplus \\alpha_2$ easily. Though this attack introduces high error rate, it implies that the security of RRDPS in the untrusted measurement scenario will depend on the error rate, which is completely different from original RRDPS protocol. Hence, one may conjecture that Eve's information on key bits depends on the error rate in the untrusted measurement setting, while the original RRDPS protocol features that monitoring signal disturbance is not necessary for placing a bound on Eve's information.\n\nThe error rate $50\\%$ can be reduced by mixing performing and not performing this attack together with probability $1/2$ each. Then the error rate drops to $25\\%$, while the same feature, channel-dependent phase error, still holds.\nHence, when Bob's device is untrusted, the RRDPS protocol is not secure and monitoring signal disturbance would be necessary. This finding may shed lights on the future security proof of RRDPS in untrusted measurement scenario.\n\n{\\it Discussion.} In summary, we have shown that the security of RRDPS protocol can be damaged when the measurement device is not perfect and consequently does not satisfy the assumptions of the protocol. We prove this by giving two concrete attacks for RRDPS with completely untrusted measurement device. In addition to showing a warning sign for the trustworthiness of the measurement device, our work raises two interesting questions:\n\nThe first question is how to prove the security of RRDPS with untrusted measurement.\nOur result shows that in the untrusted measurement setting, the security analysis is significantly different from the original RRDPS, and thus calls for more scrutiny in the analysis of the untrusted measurement setting. We show in Appendix \\ref{app:security} that it can be proven to be secure in the perfect case where there is no error and no loss.\n We therefore conjecture that it could also be made secure under a general lossy and erroneous channel when one correctly characterizes the information leakage. But the security proof may require transforming the experiment setup to a completely different intermediate model.\n\nThe second question is motivated by the fact that our untrusted measurement assumption may not be satisfied by a current-technology-hackable measurement device. Hence, it is interesting to see how our attacks can be modified and implemented on a current experimental RRDPS setup.\n\nThe authors would like to thank X. Ma for enlightening discussions. This work was supported by the National Basic Research Program of China (Grants No. 2011CBA00200 and No. 2011CB921200), National Natural Science Foundation of China (Grants No. 61475148) and the 1000 Youth Fellowship program in China.\n\n\\appendix\n\\section{Passive interference}\n\\label{app:passive}\nIn the passive interference, Eve prepares a superposed state with plain phases,\n\n", "index": 17, "text": "\\begin{equation}\n\\mbox{$\\left| {\\psi_0} \\right\\rangle$}=\\frac{1}{\\sqrt n}\\sum\\limits_{i=1}^n \\mbox{$\\left| {i} \\right\\rangle$},\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E9.m1\" class=\"ltx_Math\" alttext=\"\\mbox{$\\left|{\\psi_{0}}\\right\\rangle$}=\\frac{1}{\\sqrt{n}}\\sum\\limits_{i=1}^{n}%&#10;\\mbox{$\\left|{i}\\right\\rangle$},\" display=\"block\"><mrow><mrow><mrow><mo fence=\"true\">|</mo><msub><mi>\u03c8</mi><mn>0</mn></msub><mo>\u27e9</mo></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><msqrt><mi>n</mi></msqrt></mfrac><mo>\u2062</mo><mrow><munderover><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo fence=\"true\">|</mo><mi>i</mi><mo>\u27e9</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.06385.tex", "nexttext": "\nwhere $c_i$ denotes the first detector clicks at the $i$-th time and $d_j$ denotes the second detector clicks at the $j$-th time. Thus by examining whether the two clicks are from the same detector or from different detectors, Eve can determine the value of $s_i\\oplus s_j$ for a random pair $(i,j)$.\n\n\\section{Equidistribution of differences}\n\\label{app:prob}\nIn this section, we will prove a technical result which is involved in the attack analysis,\nnamely\n\n", "itemtype": "equation", "pos": 20140, "prevtext": "\nand interferes with Alice's photon with a beam splitter which results in a mixture of\nthe two click events \\cite{PRL114.180502},\n\n", "index": 19, "text": "\\begin{equation}\n[1+(-1)^{s_i+s_j}] c_i c_j,\\quad [1-(-1)^{s_i+s_j}] c_i d_j\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E10.m1\" class=\"ltx_Math\" alttext=\"[1+(-1)^{s_{i}+s_{j}}]c_{i}c_{j},\\quad[1-(-1)^{s_{i}+s_{j}}]c_{i}d_{j}\" display=\"block\"><mrow><mrow><mrow><mo stretchy=\"false\">[</mo><mrow><mn>1</mn><mo>+</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>s</mi><mi>i</mi></msub><mo>+</mo><msub><mi>s</mi><mi>j</mi></msub></mrow></msup></mrow><mo stretchy=\"false\">]</mo></mrow><mo>\u2062</mo><msub><mi>c</mi><mi>i</mi></msub><mo>\u2062</mo><msub><mi>c</mi><mi>j</mi></msub></mrow><mo rspace=\"12.5pt\">,</mo><mrow><mrow><mo stretchy=\"false\">[</mo><mrow><mn>1</mn><mo>-</mo><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>s</mi><mi>i</mi></msub><mo>+</mo><msub><mi>s</mi><mi>j</mi></msub></mrow></msup></mrow><mo stretchy=\"false\">]</mo></mrow><mo>\u2062</mo><msub><mi>c</mi><mi>i</mi></msub><mo>\u2062</mo><msub><mi>d</mi><mi>j</mi></msub></mrow></mrow></math>", "type": "latex"}, {"file": "1601.06385.tex", "nexttext": "\nwhere $m=\\Theta (n^{2/3})$ and $a_1,\\cdots, a_m$ are chosen at random from $\\{1,\\dots, n\\}$.\nActually we will prove a stronger result which replaces $m=\\Theta (n^{2/3})$ by $m=\\omega (\\sqrt{n})$. It is stronger because if the conclusion holds for a specific $m$, it naturally also holds for bigger $m$.\nThe conclusion is intuitively true because $\\omega (\\sqrt{n})$ numbers have more than\n\n", "itemtype": "equation", "pos": 20692, "prevtext": "\nwhere $c_i$ denotes the first detector clicks at the $i$-th time and $d_j$ denotes the second detector clicks at the $j$-th time. Thus by examining whether the two clicks are from the same detector or from different detectors, Eve can determine the value of $s_i\\oplus s_j$ for a random pair $(i,j)$.\n\n\\section{Equidistribution of differences}\n\\label{app:prob}\nIn this section, we will prove a technical result which is involved in the attack analysis,\nnamely\n\n", "index": 21, "text": "\\begin{equation}\n\\lim_{n\\to \\infty} \\mathbb{E}\\left[ \\frac{\\#\\{|a_i-a_j|,1\\le i,j\\le m\\}}{n}\\right]=1,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E11.m1\" class=\"ltx_Math\" alttext=\"\\lim_{n\\to\\infty}\\mathbb{E}\\left[\\frac{\\#\\{|a_{i}-a_{j}|,1\\leq i,j\\leq m\\}}{n}%&#10;\\right]=1,\" display=\"block\"><mrow><mrow><mrow><munder><mo movablelimits=\"false\">lim</mo><mrow><mi>n</mi><mo>\u2192</mo><mi mathvariant=\"normal\">\u221e</mi></mrow></munder><mo>\u2061</mo><mrow><mi>\ud835\udd3c</mi><mo>\u2062</mo><mrow><mo>[</mo><mfrac><mrow><mi mathvariant=\"normal\">#</mi><mrow><mo stretchy=\"false\">{</mo><mo stretchy=\"false\">|</mo><msub><mi>a</mi><mi>i</mi></msub><mo>-</mo><msub><mi>a</mi><mi>j</mi></msub><mo stretchy=\"false\">|</mo><mo>,</mo><mn>1</mn><mo>\u2264</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>\u2264</mo><mi>m</mi><mo stretchy=\"false\">}</mo></mrow></mrow><mi>n</mi></mfrac><mo>]</mo></mrow></mrow></mrow><mo>=</mo><mn>1</mn></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.06385.tex", "nexttext": "\ndifferences and these differences have sufficient randomness in $\\{0,\\dots, n-1\\}$.\n\nNow let us start the proof. First fix a constant $\\epsilon>0$. Let $A=\\{a_i:i<m/2\\} \\cap \\{1,\\cdots, \\epsilon n\\}$. In expectation, $A$ contains $\\epsilon m/2=\\omega(n)$ elements. By concentration, we have $ |A| \\ge \\sqrt{n}$ with high probability.\n\nNow suppose that $|A| \\ge \\sqrt{n}$ holds, i.e., there are $\\sqrt{n}$ distinct values in  $\\{1,\\cdots, \\epsilon n\\}$ for the first $m/2$ elements. Then for the last $m/2$ elements, they are independent and each element has probability $\\sqrt{n}/n$ to be distance $d$ away from some element in $A$ for any $d\\in [1,n-\\epsilon n]$. Thus the probability that none of the last $m/2$ elements are distance $d$ from some element in $A$ is $ (1-1/\\sqrt{n})^{m/2}$, which vanishes as $n$ goes to infinity.\n\nSo, using linearity of expectation for all $d\\in [1,n-\\epsilon n]$, we have\n\n", "itemtype": "equation", "pos": 21199, "prevtext": "\nwhere $m=\\Theta (n^{2/3})$ and $a_1,\\cdots, a_m$ are chosen at random from $\\{1,\\dots, n\\}$.\nActually we will prove a stronger result which replaces $m=\\Theta (n^{2/3})$ by $m=\\omega (\\sqrt{n})$. It is stronger because if the conclusion holds for a specific $m$, it naturally also holds for bigger $m$.\nThe conclusion is intuitively true because $\\omega (\\sqrt{n})$ numbers have more than\n\n", "index": 23, "text": "\\begin{equation}\n\\binom{2\\sqrt{n}}{2}>n\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E12.m1\" class=\"ltx_Math\" alttext=\"\\binom{2\\sqrt{n}}{2}&gt;n\" display=\"block\"><mrow><mrow><mo>(</mo><mfrac linethickness=\"0pt\"><mrow><mn>2</mn><mo>\u2062</mo><msqrt><mi>n</mi></msqrt></mrow><mn>2</mn></mfrac><mo>)</mo></mrow><mo>&gt;</mo><mi>n</mi></mrow></math>", "type": "latex"}, {"file": "1601.06385.tex", "nexttext": "\nfor any $\\epsilon >0$. Since $\\epsilon$ can be arbitrarily small, our result holds and the proof is complete.\n\n{\\it Remark.} Note that $m=\\omega(\\sqrt{n})$ is actually tight. One cannot hope to improve the bound to $m=\\Omega(\\sqrt{n})$. The reason is as follows. Suppose there is some constant $c$ such that $m=c \\sqrt{n}$, then in $[1,n/c^3]$ and $[n-n/c^3,n]$, about $2\\sqrt{n}/c^2$ numbers are selected. Then differences in $[n-n/c^3,n]$ will appear for about $n/c^4$ times. Thus when $n\\to \\infty$, the upper bound on the expectation value of the number of differences dividing $n$ is $1- 1/c^3+1/c^4$, not 1.\n\n\\section{Security for the perfect case}\n\\label{app:security}\n\n\nFor simplicity, we consider the case that $L=3$ in this proof, since this proof can cover larger $L$ cases easily. And only collective attack is considered here. Alice's encoding state can be written as $\\mbox{$\\left| {\\Psi} \\right\\rangle$}=(-1)^{k_1}\\mbox{$\\left| {1} \\right\\rangle$}+(-1)^{k_2}\\mbox{$\\left| {2} \\right\\rangle$}+(-1)^{k_3}\\mbox{$\\left| {3} \\right\\rangle$}$.  Besides no loss and error, we also assume that for the events that Fred outputs $i$, $j$, Alice finds that $k_l(l\\neq i,j)$ have equal 0s and 1s conditioned on $(k_i,k_j)=(a,b)$ for all $a,b\\in\\{0,1\\}$.\n\nThe general collective attack model is that Eve applies a unitary transformation $U_E$ to the traveling photon and her ancilla $\\mbox{$\\left| {E} \\right\\rangle$}$. Note that after Eve's operation $U_E$, the incoming photon will be transformed to an unknown and arbitrary information carrier, labeled as $\\mbox{$\\left| {F} \\right\\rangle$}$, sent to Fred. Then depends on Bob's input $r$, Fred uses unitary transformation $U^{(r)}_F$ acting $\\mbox{$\\left| {F} \\right\\rangle$}$ to generate $\\mbox{$\\left| {i} \\right\\rangle$}+(-1)^{{k_i}\\oplus k_i}\\mbox{$\\left| {j} \\right\\rangle$}$ to Bob. When Fred generates $\\mbox{$\\left| {1} \\right\\rangle$}\\pm\\mbox{$\\left| {2} \\right\\rangle$}$, the density matrix of $\\mbox{$\\left| {E} \\right\\rangle$}$ is given by\n\n", "itemtype": "equation", "pos": 22164, "prevtext": "\ndifferences and these differences have sufficient randomness in $\\{0,\\dots, n-1\\}$.\n\nNow let us start the proof. First fix a constant $\\epsilon>0$. Let $A=\\{a_i:i<m/2\\} \\cap \\{1,\\cdots, \\epsilon n\\}$. In expectation, $A$ contains $\\epsilon m/2=\\omega(n)$ elements. By concentration, we have $ |A| \\ge \\sqrt{n}$ with high probability.\n\nNow suppose that $|A| \\ge \\sqrt{n}$ holds, i.e., there are $\\sqrt{n}$ distinct values in  $\\{1,\\cdots, \\epsilon n\\}$ for the first $m/2$ elements. Then for the last $m/2$ elements, they are independent and each element has probability $\\sqrt{n}/n$ to be distance $d$ away from some element in $A$ for any $d\\in [1,n-\\epsilon n]$. Thus the probability that none of the last $m/2$ elements are distance $d$ from some element in $A$ is $ (1-1/\\sqrt{n})^{m/2}$, which vanishes as $n$ goes to infinity.\n\nSo, using linearity of expectation for all $d\\in [1,n-\\epsilon n]$, we have\n\n", "index": 25, "text": "\\begin{equation}\n\\lim_{n\\to \\infty} \\mathbb{E}\\left[ \\frac{\\#\\{|a_i-a_j|,1\\le i,j\\le m\\}}{n}\\right]\\ge 1-\\epsilon,\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E13.m1\" class=\"ltx_Math\" alttext=\"\\lim_{n\\to\\infty}\\mathbb{E}\\left[\\frac{\\#\\{|a_{i}-a_{j}|,1\\leq i,j\\leq m\\}}{n}%&#10;\\right]\\geq 1-\\epsilon,\" display=\"block\"><mrow><mrow><mrow><munder><mo movablelimits=\"false\">lim</mo><mrow><mi>n</mi><mo>\u2192</mo><mi mathvariant=\"normal\">\u221e</mi></mrow></munder><mo>\u2061</mo><mrow><mi>\ud835\udd3c</mi><mo>\u2062</mo><mrow><mo>[</mo><mfrac><mrow><mi mathvariant=\"normal\">#</mi><mrow><mo stretchy=\"false\">{</mo><mo stretchy=\"false\">|</mo><msub><mi>a</mi><mi>i</mi></msub><mo>-</mo><msub><mi>a</mi><mi>j</mi></msub><mo stretchy=\"false\">|</mo><mo>,</mo><mn>1</mn><mo>\u2264</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>\u2264</mo><mi>m</mi><mo stretchy=\"false\">}</mo></mrow></mrow><mi>n</mi></mfrac><mo>]</mo></mrow></mrow></mrow><mo>\u2265</mo><mrow><mn>1</mn><mo>-</mo><mi>\u03f5</mi></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.06385.tex", "nexttext": "\nwhere, $P\\{\\mbox{$\\left| {x} \\right\\rangle$}\\}=\\mbox{$\\left| {x} \\right\\rangle$}\\mbox{$\\left\\langle {x} \\right|$}$. From \\eqref{attack1}, to analyze Eve's ancilla $\\mbox{$\\left| {E} \\right\\rangle$}$, Alice's encoding state is equivalent to a mixture of components $P\\{(-1)^{k_1}\\mbox{$\\left| {1} \\right\\rangle$}+(-1)^{k_2}\\mbox{$\\left| {2} \\right\\rangle$}\\}$ and $P\\{\\mbox{$\\left| {3} \\right\\rangle$}\\}$. Evidently, in perfect case, the events that Fred outputs $1$ and $2$ can only correspond to that Alice emits $(-1)^{k_1}\\mbox{$\\left| {1} \\right\\rangle$}+(-1)^{k_2}\\mbox{$\\left| {2} \\right\\rangle$}$. Furthermore, in perfect case, Fred's operation $U^{(1)}_F$ generates $(-1)^{k_1}\\mbox{$\\left| {1} \\right\\rangle$}+(-1)^{k_2}\\mbox{$\\left| {2} \\right\\rangle$}$ without error, which means\n\n", "itemtype": "equation", "pos": 24302, "prevtext": "\nfor any $\\epsilon >0$. Since $\\epsilon$ can be arbitrarily small, our result holds and the proof is complete.\n\n{\\it Remark.} Note that $m=\\omega(\\sqrt{n})$ is actually tight. One cannot hope to improve the bound to $m=\\Omega(\\sqrt{n})$. The reason is as follows. Suppose there is some constant $c$ such that $m=c \\sqrt{n}$, then in $[1,n/c^3]$ and $[n-n/c^3,n]$, about $2\\sqrt{n}/c^2$ numbers are selected. Then differences in $[n-n/c^3,n]$ will appear for about $n/c^4$ times. Thus when $n\\to \\infty$, the upper bound on the expectation value of the number of differences dividing $n$ is $1- 1/c^3+1/c^4$, not 1.\n\n\\section{Security for the perfect case}\n\\label{app:security}\n\n\nFor simplicity, we consider the case that $L=3$ in this proof, since this proof can cover larger $L$ cases easily. And only collective attack is considered here. Alice's encoding state can be written as $\\mbox{$\\left| {\\Psi} \\right\\rangle$}=(-1)^{k_1}\\mbox{$\\left| {1} \\right\\rangle$}+(-1)^{k_2}\\mbox{$\\left| {2} \\right\\rangle$}+(-1)^{k_3}\\mbox{$\\left| {3} \\right\\rangle$}$.  Besides no loss and error, we also assume that for the events that Fred outputs $i$, $j$, Alice finds that $k_l(l\\neq i,j)$ have equal 0s and 1s conditioned on $(k_i,k_j)=(a,b)$ for all $a,b\\in\\{0,1\\}$.\n\nThe general collective attack model is that Eve applies a unitary transformation $U_E$ to the traveling photon and her ancilla $\\mbox{$\\left| {E} \\right\\rangle$}$. Note that after Eve's operation $U_E$, the incoming photon will be transformed to an unknown and arbitrary information carrier, labeled as $\\mbox{$\\left| {F} \\right\\rangle$}$, sent to Fred. Then depends on Bob's input $r$, Fred uses unitary transformation $U^{(r)}_F$ acting $\\mbox{$\\left| {F} \\right\\rangle$}$ to generate $\\mbox{$\\left| {i} \\right\\rangle$}+(-1)^{{k_i}\\oplus k_i}\\mbox{$\\left| {j} \\right\\rangle$}$ to Bob. When Fred generates $\\mbox{$\\left| {1} \\right\\rangle$}\\pm\\mbox{$\\left| {2} \\right\\rangle$}$, the density matrix of $\\mbox{$\\left| {E} \\right\\rangle$}$ is given by\n\n", "index": 27, "text": "\\begin{equation}\n\\begin{aligned}\n\\label{attack1}\n\\rho_E&=\\sum_{k_3}tr[\n(\\mbox{$\\left| {1} \\right\\rangle$}\\mbox{$\\left\\langle {1} \\right|$}+\\mbox{$\\left| {2} \\right\\rangle$}\\mbox{$\\left\\langle {2} \\right|$})\\\\\n&P\\{U_E((-1)^{k_1}\\mbox{$\\left| {1} \\right\\rangle$}+(-1)^{k_2}\\mbox{$\\left| {2} \\right\\rangle$}+(-1)^{k_3}\\mbox{$\\left| {3} \\right\\rangle$})\\\\\n&\\mbox{$\\left| {E} \\right\\rangle$}\\mbox{$\\left| {F} \\right\\rangle$}\\}]\\\\\n&=tr[\n(\\mbox{$\\left| {1} \\right\\rangle$}\\mbox{$\\left\\langle {1} \\right|$}+\\mbox{$\\left| {2} \\right\\rangle$}\\mbox{$\\left\\langle {2} \\right|$})\\\\\n&P\\{U_E((-1)^{k_1}\\mbox{$\\left| {1} \\right\\rangle$}+(-1)^{k_2}\\mbox{$\\left| {2} \\right\\rangle$})\\mbox{$\\left| {E} \\right\\rangle$}\\mbox{$\\left| {F} \\right\\rangle$}\\}\\\\\n&+P\\{U_E\\mbox{$\\left| {3} \\right\\rangle$}\\mbox{$\\left| {E} \\right\\rangle$}\\mbox{$\\left| {F} \\right\\rangle$}\\}],\n\\end{aligned}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14X.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\rho_{E}\" display=\"inline\"><msub><mi>\u03c1</mi><mi>E</mi></msub></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14X.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle=\\sum_{k_{3}}tr[(\\mbox{$\\left|{1}\\right\\rangle$}\\mbox{$\\left%&#10;\\langle{1}\\right|$}+\\mbox{$\\left|{2}\\right\\rangle$}\\mbox{$\\left\\langle{2}%&#10;\\right|$})\" display=\"inline\"><mrow><mo>=</mo><mstyle displaystyle=\"true\"><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><msub><mi>k</mi><mn>3</mn></msub></munder></mstyle><mi>t</mi><mi>r</mi><mrow><mo stretchy=\"false\">[</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mo fence=\"true\">|</mo><mn>1</mn><mo>\u27e9</mo></mrow><mrow><mo>\u27e8</mo><mn>1</mn><mo fence=\"true\">|</mo></mrow></mrow><mo>+</mo><mrow><mrow><mo fence=\"true\">|</mo><mn>2</mn><mo>\u27e9</mo></mrow><mrow><mo>\u27e8</mo><mn>2</mn><mo fence=\"true\">|</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14Xa.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle P\\{U_{E}((-1)^{k_{1}}\\mbox{$\\left|{1}\\right\\rangle$}+(-1)^{k_{2}%&#10;}\\mbox{$\\left|{2}\\right\\rangle$}+(-1)^{k_{3}}\\mbox{$\\left|{3}\\right\\rangle$})\" display=\"inline\"><mrow><mi>P</mi><mrow><mo stretchy=\"false\">{</mo><msub><mi>U</mi><mi>E</mi></msub><mrow><mo stretchy=\"false\">(</mo><msup><mrow><mo stretchy=\"false\">(</mo><mo>-</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><msub><mi>k</mi><mn>1</mn></msub></msup><mrow><mo fence=\"true\">|</mo><mn>1</mn><mo>\u27e9</mo></mrow><mo>+</mo><msup><mrow><mo stretchy=\"false\">(</mo><mo>-</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><msub><mi>k</mi><mn>2</mn></msub></msup><mrow><mo fence=\"true\">|</mo><mn>2</mn><mo>\u27e9</mo></mrow><mo>+</mo><msup><mrow><mo stretchy=\"false\">(</mo><mo>-</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><msub><mi>k</mi><mn>3</mn></msub></msup><mrow><mo fence=\"true\">|</mo><mn>3</mn><mo>\u27e9</mo></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14Xb.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle\\mbox{$\\left|{E}\\right\\rangle$}\\mbox{$\\left|{F}\\right\\rangle$}\\}]\" display=\"inline\"><mrow><mrow><mrow><mrow><mo fence=\"true\">|</mo><mi>E</mi><mo>\u27e9</mo></mrow><mrow><mo fence=\"true\">|</mo><mi>F</mi><mo>\u27e9</mo></mrow></mrow><mo stretchy=\"false\">}</mo></mrow><mo stretchy=\"false\">]</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14Xc.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle=tr[(\\mbox{$\\left|{1}\\right\\rangle$}\\mbox{$\\left\\langle{1}\\right|%&#10;$}+\\mbox{$\\left|{2}\\right\\rangle$}\\mbox{$\\left\\langle{2}\\right|$})\" display=\"inline\"><mrow><mo>=</mo><mi>t</mi><mi>r</mi><mrow><mo stretchy=\"false\">[</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mo fence=\"true\">|</mo><mn>1</mn><mo>\u27e9</mo></mrow><mrow><mo>\u27e8</mo><mn>1</mn><mo fence=\"true\">|</mo></mrow></mrow><mo>+</mo><mrow><mrow><mo fence=\"true\">|</mo><mn>2</mn><mo>\u27e9</mo></mrow><mrow><mo>\u27e8</mo><mn>2</mn><mo fence=\"true\">|</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14Xd.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle P\\{U_{E}((-1)^{k_{1}}\\mbox{$\\left|{1}\\right\\rangle$}+(-1)^{k_{2}%&#10;}\\mbox{$\\left|{2}\\right\\rangle$})\\mbox{$\\left|{E}\\right\\rangle$}\\mbox{$\\left|{%&#10;F}\\right\\rangle$}\\}\" display=\"inline\"><mrow><mi>P</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">{</mo><mrow><msub><mi>U</mi><mi>E</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><msub><mi>k</mi><mn>1</mn></msub></msup><mo>\u2062</mo><mrow><mo fence=\"true\">|</mo><mn>1</mn><mo>\u27e9</mo></mrow></mrow><mo>+</mo><mrow><msup><mrow><mo stretchy=\"false\">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy=\"false\">)</mo></mrow><msub><mi>k</mi><mn>2</mn></msub></msup><mo>\u2062</mo><mrow><mo fence=\"true\">|</mo><mn>2</mn><mo>\u27e9</mo></mrow></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mrow><mo fence=\"true\">|</mo><mi>E</mi><mo>\u27e9</mo></mrow><mrow><mo fence=\"true\">|</mo><mi>F</mi><mo>\u27e9</mo></mrow></mrow></mrow><mo stretchy=\"false\">}</mo></mrow></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E14Xe.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle+P\\{U_{E}\\mbox{$\\left|{3}\\right\\rangle$}\\mbox{$\\left|{E}\\right%&#10;\\rangle$}\\mbox{$\\left|{F}\\right\\rangle$}\\}],\" display=\"inline\"><mrow><mo>+</mo><mi>P</mi><mrow><mo stretchy=\"false\">{</mo><msub><mi>U</mi><mi>E</mi></msub><mrow><mrow><mo fence=\"true\">|</mo><mn>3</mn><mo>\u27e9</mo></mrow><mrow><mo fence=\"true\">|</mo><mi>E</mi><mo>\u27e9</mo></mrow><mrow><mo fence=\"true\">|</mo><mi>F</mi><mo>\u27e9</mo></mrow></mrow><mo stretchy=\"false\">}</mo></mrow><mo stretchy=\"false\">]</mo><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.06385.tex", "nexttext": "\nand\n\n", "itemtype": "equation", "pos": 25970, "prevtext": "\nwhere, $P\\{\\mbox{$\\left| {x} \\right\\rangle$}\\}=\\mbox{$\\left| {x} \\right\\rangle$}\\mbox{$\\left\\langle {x} \\right|$}$. From \\eqref{attack1}, to analyze Eve's ancilla $\\mbox{$\\left| {E} \\right\\rangle$}$, Alice's encoding state is equivalent to a mixture of components $P\\{(-1)^{k_1}\\mbox{$\\left| {1} \\right\\rangle$}+(-1)^{k_2}\\mbox{$\\left| {2} \\right\\rangle$}\\}$ and $P\\{\\mbox{$\\left| {3} \\right\\rangle$}\\}$. Evidently, in perfect case, the events that Fred outputs $1$ and $2$ can only correspond to that Alice emits $(-1)^{k_1}\\mbox{$\\left| {1} \\right\\rangle$}+(-1)^{k_2}\\mbox{$\\left| {2} \\right\\rangle$}$. Furthermore, in perfect case, Fred's operation $U^{(1)}_F$ generates $(-1)^{k_1}\\mbox{$\\left| {1} \\right\\rangle$}+(-1)^{k_2}\\mbox{$\\left| {2} \\right\\rangle$}$ without error, which means\n\n", "index": 29, "text": "\\begin{equation}\n\\begin{aligned}\n\\label{eve1}\n&U_E( \\mbox{$\\left| {1} \\right\\rangle$}+ \\mbox{$\\left| {2} \\right\\rangle$} )\\mbox{$\\left| {E} \\right\\rangle$}=\\mbox{$\\left| {F_{12+}} \\right\\rangle$}\\mbox{$\\left| {E_{12+}} \\right\\rangle$},\\\\\n&U_E( \\mbox{$\\left| {1} \\right\\rangle$}- \\mbox{$\\left| {2} \\right\\rangle$} )\\mbox{$\\left| {E} \\right\\rangle$}=\\mbox{$\\left| {F_{12-}} \\right\\rangle$}\\mbox{$\\left| {E_{12-}} \\right\\rangle$},\n\\end{aligned}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E15X.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle U_{E}(\\mbox{$\\left|{1}\\right\\rangle$}+\\mbox{$\\left|{2}\\right%&#10;\\rangle$})\\mbox{$\\left|{E}\\right\\rangle$}=\\mbox{$\\left|{F_{12+}}\\right\\rangle$%&#10;}\\mbox{$\\left|{E_{12+}}\\right\\rangle$},\" display=\"inline\"><mrow><mrow><mrow><msub><mi>U</mi><mi>E</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mo fence=\"true\">|</mo><mn>1</mn><mo>\u27e9</mo></mrow><mo>+</mo><mrow><mo fence=\"true\">|</mo><mn>2</mn><mo>\u27e9</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo fence=\"true\">|</mo><mi>E</mi><mo>\u27e9</mo></mrow></mrow><mo>=</mo><mrow><mrow><mo fence=\"true\">|</mo><msub><mi>F</mi><mrow><mn>12</mn><mo>+</mo></mrow></msub><mo>\u27e9</mo></mrow><mrow><mo fence=\"true\">|</mo><msub><mi>E</mi><mrow><mn>12</mn><mo>+</mo></mrow></msub><mo>\u27e9</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E15Xa.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle U_{E}(\\mbox{$\\left|{1}\\right\\rangle$}-\\mbox{$\\left|{2}\\right%&#10;\\rangle$})\\mbox{$\\left|{E}\\right\\rangle$}=\\mbox{$\\left|{F_{12-}}\\right\\rangle$%&#10;}\\mbox{$\\left|{E_{12-}}\\right\\rangle$},\" display=\"inline\"><mrow><mrow><mrow><msub><mi>U</mi><mi>E</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mo fence=\"true\">|</mo><mn>1</mn><mo>\u27e9</mo></mrow><mo>-</mo><mrow><mo fence=\"true\">|</mo><mn>2</mn><mo>\u27e9</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo fence=\"true\">|</mo><mi>E</mi><mo>\u27e9</mo></mrow></mrow><mo>=</mo><mrow><mrow><mo fence=\"true\">|</mo><msub><mi>F</mi><mrow><mn>12</mn><mo>-</mo></mrow></msub><mo>\u27e9</mo></mrow><mrow><mo fence=\"true\">|</mo><msub><mi>E</mi><mrow><mn>12</mn><mo>-</mo></mrow></msub><mo>\u27e9</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.06385.tex", "nexttext": "\nOn the other hand, when $r=2$, and Fred outputs $1$ and $3$, we have\n\n", "itemtype": "equation", "pos": 26431, "prevtext": "\nand\n\n", "index": 31, "text": "\\begin{equation}\n\\begin{aligned}\n\\label{fred1}\n&U^{(1)}_F\\mbox{$\\left| {F_{12+}} \\right\\rangle$}=\\mbox{$\\left| {1} \\right\\rangle$}+ \\mbox{$\\left| {2} \\right\\rangle$},\\\\\n&U^{(1)}_F\\mbox{$\\left| {F_{12-}} \\right\\rangle$}=\\mbox{$\\left| {1} \\right\\rangle$}- \\mbox{$\\left| {2} \\right\\rangle$}.\n\\end{aligned}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E16X.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle U^{(1)}_{F}\\mbox{$\\left|{F_{12+}}\\right\\rangle$}=\\mbox{$\\left|{1%&#10;}\\right\\rangle$}+\\mbox{$\\left|{2}\\right\\rangle$},\" display=\"inline\"><mrow><mrow><mrow><msubsup><mi>U</mi><mi>F</mi><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>\u2062</mo><mrow><mo fence=\"true\">|</mo><msub><mi>F</mi><mrow><mn>12</mn><mo>+</mo></mrow></msub><mo>\u27e9</mo></mrow></mrow><mo>=</mo><mrow><mrow><mo fence=\"true\">|</mo><mn>1</mn><mo>\u27e9</mo></mrow><mo>+</mo><mrow><mo fence=\"true\">|</mo><mn>2</mn><mo>\u27e9</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E16Xa.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle U^{(1)}_{F}\\mbox{$\\left|{F_{12-}}\\right\\rangle$}=\\mbox{$\\left|{1%&#10;}\\right\\rangle$}-\\mbox{$\\left|{2}\\right\\rangle$}.\" display=\"inline\"><mrow><mrow><mrow><msubsup><mi>U</mi><mi>F</mi><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>\u2062</mo><mrow><mo fence=\"true\">|</mo><msub><mi>F</mi><mrow><mn>12</mn><mo>-</mo></mrow></msub><mo>\u27e9</mo></mrow></mrow><mo>=</mo><mrow><mrow><mo fence=\"true\">|</mo><mn>1</mn><mo>\u27e9</mo></mrow><mo>-</mo><mrow><mo fence=\"true\">|</mo><mn>2</mn><mo>\u27e9</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.06385.tex", "nexttext": "\nand\n\n", "itemtype": "equation", "pos": 26818, "prevtext": "\nOn the other hand, when $r=2$, and Fred outputs $1$ and $3$, we have\n\n", "index": 33, "text": "\\begin{equation}\n\\begin{aligned}\n\\label{eve2}\n&U_E( \\mbox{$\\left| {1} \\right\\rangle$}+ \\mbox{$\\left| {3} \\right\\rangle$} )\\mbox{$\\left| {E} \\right\\rangle$}=\\mbox{$\\left| {F_{13+}} \\right\\rangle$}\\mbox{$\\left| {E_{13+}} \\right\\rangle$},\\\\\n&U_E( \\mbox{$\\left| {1} \\right\\rangle$}- \\mbox{$\\left| {3} \\right\\rangle$} )\\mbox{$\\left| {E} \\right\\rangle$}=\\mbox{$\\left| {F_{13-}} \\right\\rangle$}\\mbox{$\\left| {E_{13-}} \\right\\rangle$},\n\\end{aligned}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E17X.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle U_{E}(\\mbox{$\\left|{1}\\right\\rangle$}+\\mbox{$\\left|{3}\\right%&#10;\\rangle$})\\mbox{$\\left|{E}\\right\\rangle$}=\\mbox{$\\left|{F_{13+}}\\right\\rangle$%&#10;}\\mbox{$\\left|{E_{13+}}\\right\\rangle$},\" display=\"inline\"><mrow><mrow><mrow><msub><mi>U</mi><mi>E</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mo fence=\"true\">|</mo><mn>1</mn><mo>\u27e9</mo></mrow><mo>+</mo><mrow><mo fence=\"true\">|</mo><mn>3</mn><mo>\u27e9</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo fence=\"true\">|</mo><mi>E</mi><mo>\u27e9</mo></mrow></mrow><mo>=</mo><mrow><mrow><mo fence=\"true\">|</mo><msub><mi>F</mi><mrow><mn>13</mn><mo>+</mo></mrow></msub><mo>\u27e9</mo></mrow><mrow><mo fence=\"true\">|</mo><msub><mi>E</mi><mrow><mn>13</mn><mo>+</mo></mrow></msub><mo>\u27e9</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E17Xa.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle U_{E}(\\mbox{$\\left|{1}\\right\\rangle$}-\\mbox{$\\left|{3}\\right%&#10;\\rangle$})\\mbox{$\\left|{E}\\right\\rangle$}=\\mbox{$\\left|{F_{13-}}\\right\\rangle$%&#10;}\\mbox{$\\left|{E_{13-}}\\right\\rangle$},\" display=\"inline\"><mrow><mrow><mrow><msub><mi>U</mi><mi>E</mi></msub><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mrow><mrow><mo fence=\"true\">|</mo><mn>1</mn><mo>\u27e9</mo></mrow><mo>-</mo><mrow><mo fence=\"true\">|</mo><mn>3</mn><mo>\u27e9</mo></mrow></mrow><mo stretchy=\"false\">)</mo></mrow><mo>\u2062</mo><mrow><mo fence=\"true\">|</mo><mi>E</mi><mo>\u27e9</mo></mrow></mrow><mo>=</mo><mrow><mrow><mo fence=\"true\">|</mo><msub><mi>F</mi><mrow><mn>13</mn><mo>-</mo></mrow></msub><mo>\u27e9</mo></mrow><mrow><mo fence=\"true\">|</mo><msub><mi>E</mi><mrow><mn>13</mn><mo>-</mo></mrow></msub><mo>\u27e9</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>", "type": "latex"}, {"file": "1601.06385.tex", "nexttext": "\nSince unitary transformation $U_E$, $U^{(1)}_F$, and $U^{(2)}_F$ must preserve inner product, it's easy to find the\nmodule of the product of $ \\mbox{$\\left| {E_{13+}} \\right\\rangle$}$ and  $\\mbox{$\\left| {E_{13-}} \\right\\rangle$}$ must be 1, which implies that  $ \\mbox{$\\left| {E_{13+}} \\right\\rangle$}$ and  $\\mbox{$\\left| {E_{13-}} \\right\\rangle$}$ can only differ by a phase. Hence, Eve can not obtain any information on $k_1\\oplus k_3$ through her ancilla $\\mbox{$\\left| {E} \\right\\rangle$}$. Similarly, we can prove that Eve cannot learn $k_1\\oplus k_2$ and $k_2\\oplus k_3$.\n\n\\bibliographystyle{apsrev4-1}\n\n\n\\bibliography{Bibliattack}\n\n\n\n", "itemtype": "equation", "pos": 27279, "prevtext": "\nand\n\n", "index": 35, "text": "\\begin{equation}\n\\begin{aligned}\n\\label{fred2}\n&U^{(2)}_F\\mbox{$\\left| {F_{13+}} \\right\\rangle$}=\\mbox{$\\left| {1} \\right\\rangle$}+ \\mbox{$\\left| {3} \\right\\rangle$},\\\\\n&U^{(2)}_F\\mbox{$\\left| {F_{13-}} \\right\\rangle$}=\\mbox{$\\left| {1} \\right\\rangle$}- \\mbox{$\\left| {3} \\right\\rangle$}.\n\\end{aligned}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E18X.m3\" class=\"ltx_Math\" alttext=\"\\displaystyle U^{(2)}_{F}\\mbox{$\\left|{F_{13+}}\\right\\rangle$}=\\mbox{$\\left|{1%&#10;}\\right\\rangle$}+\\mbox{$\\left|{3}\\right\\rangle$},\" display=\"inline\"><mrow><mrow><mrow><msubsup><mi>U</mi><mi>F</mi><mrow><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>\u2062</mo><mrow><mo fence=\"true\">|</mo><msub><mi>F</mi><mrow><mn>13</mn><mo>+</mo></mrow></msub><mo>\u27e9</mo></mrow></mrow><mo>=</mo><mrow><mrow><mo fence=\"true\">|</mo><mn>1</mn><mo>\u27e9</mo></mrow><mo>+</mo><mrow><mo fence=\"true\">|</mo><mn>3</mn><mo>\u27e9</mo></mrow></mrow></mrow><mo>,</mo></mrow></math>\n<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E18Xa.m2\" class=\"ltx_Math\" alttext=\"\\displaystyle U^{(2)}_{F}\\mbox{$\\left|{F_{13-}}\\right\\rangle$}=\\mbox{$\\left|{1%&#10;}\\right\\rangle$}-\\mbox{$\\left|{3}\\right\\rangle$}.\" display=\"inline\"><mrow><mrow><mrow><msubsup><mi>U</mi><mi>F</mi><mrow><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>\u2062</mo><mrow><mo fence=\"true\">|</mo><msub><mi>F</mi><mrow><mn>13</mn><mo>-</mo></mrow></msub><mo>\u27e9</mo></mrow></mrow><mo>=</mo><mrow><mrow><mo fence=\"true\">|</mo><mn>1</mn><mo>\u27e9</mo></mrow><mo>-</mo><mrow><mo fence=\"true\">|</mo><mn>3</mn><mo>\u27e9</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}]