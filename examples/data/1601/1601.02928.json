[{"file": "1601.02928.tex", "nexttext": "\nwhere P, WDP, DWSF, and SF are respectively Permutations, Weighted Dyck Paths, Decreasing Weighted Subexcedent\nFunctions, and Subexcedent Functions which are all recalled or defined below. \nIn Section~\\ref{sectionPermToDyckPath} we shall describe the bijections\n$\\psi_{FV}$ and $\\psi$ which are natural bijections to obtain objects on which the statistics ${\\operatorname{GC}}$ and ${\\rm tot}$\nare naturally defined. The object obtained is a pair consisting in a Catalan \nobject and a weight. In Section~\\ref{sectionSFToDyckPath}\nwe begin by constructing a Catalan object associated with a weight from {subexcedent function} s\nthrough $\\phi_1$ and then\ndescribe $\\phi_2$, a Catalan bijection between decreasing {subexcedent function} s and Dyck paths.\nIn Section~\\ref{sectionFinal} we prove the \nglobal result and give some properties associated with the global bijection.\n\n\\section{Notations and background}\n\\subsection{Permutations, compositions, and {subexcedent function} s}\n\nLet us first fix our notations concerning permutations.\n\nA {\\it recoil} of a permutation $\\sigma$ is a value\n$i$ such that $i+1$ is on the left of $i$.\nThe recoil set of $\\sigma$ is the set of the values of recoils.\nA 31-2 pattern of $\\sigma$ is a pair $(i,j)$ such that $j > i+1$ \nand $\\sigma_{i+1} < \\sigma_j < \\sigma_i$. We denote by ${\\rm tot}(\\sigma)$\nthe number of 31-2 patterns of $\\sigma$. For example, ${\\rm tot}(528713649) = 5$.\n\nA \\emph{composition} of an integer $n$ is a sequence\n$I=(i_1,\\dots,i_r)$ of positive integers of sum $n$. \nIn this case we write $I \\models n$.  The integer $r$ is called\nthe \\emph{length} of the composition.\nThe \\emph{descent set} of $I$ is\n${\\operatorname{Des}}(I) = \\{ i_1,\\ i_1+i_2, \\ldots , i_1+\\dots+i_{r-1}\\}$.\nThe \\emph{recoil composition} ${\\operatorname{Rec}}(\\sigma)$ of a permutation\n$\\sigma\\in{\\mathfrak S}_n$ is the composition of $n$ whose descent set is the\nrecoil set of $\\sigma$. \n\nThe {\\it major index} ${\\rm maj}(I)$ of a composition is\nthe sum of the values in the descent set of $I$.\n\nThe \\emph{Genocchi descent set}~\\cite{HNTT} of a\npermutation $\\sigma\\in{\\mathfrak S}_n$ is the set of values immediately followed by a\nsmaller value (it is sometimes called descent top).\nThe \\emph{Genocchi composition of descents}\n(or G-compos\\-ition, for short) ${\\operatorname{GC}}(\\sigma)$ of a permutation is the integer\ncomposition $I$ of $n$ whose descent set is $\\{d-1~|~d\\in{\\operatorname{GDes}}(\\sigma)\\}$. For example,\nwith $\\sigma = 528713649$, we have ${\\operatorname{GDes}} = \\{5,6,7,8\\}$ and ${\\operatorname{GC}}(\\sigma) = (4,1,1,1,2)$.\n\nA \\emph{{subexcedent function}} of size $n$ is a word $u$ of size $n$ on the alphabet of \nnonnegative integers such that for each\n$i \\in \\{ 1, \\ldots, n\\}$ we have $u_i \\leq n-i$. We denote by\n$ {\\mathfrak{SF}}_n$ the set of {subexcedent function} s of size~$n$.\nThey are enumerated by\n$n!$ and in bijection with permutations through the Lehmer code. \nThe \\emph{statistic $LC$} is defined on a {{subexcedent function}} $u$ as follows.\n\\begin{itemize}\n\\item Set $S=\\emptyset$ and read $u$ from right to left.\nAt each step, if the entry $k$ is strictly greater than the size of $S$, add\nthe $(k-|S|)$-th element of the sequence $[1,n]$ not considering the\nelements of $S$.\n\n\\item The set $S$ is the descent set of a composition $C$, and\n${\\operatorname{LC}}(\\sigma)$ is the mirror image $\\overline{C}$ of  $C$.\n\\end{itemize}\nThis definition corresponds to the definition of ${\\operatorname{LC}}$ in~\\cite{NTW} after \napplying the Lehmer code on the inverse of the permutation.\n\nFor example, with $u= 315503200$,\n$S$ is $\\emptyset$ at first, then the set $\\{2\\}$ (third step), then \n$\\{2,3\\}$ (fourth step), then $\\{2,3,5\\}$ (sixth step), then \n$\\{2,3,4,5\\}$ (seventh step).\nHence $C$ is $(2,1,1,1,4)$, so that ${\\operatorname{LC}}(u)=(4,1,1,1,2)$.\n\nFrom the same bijection between permutations and {{subexcedent function}}s, \nwe define the \\emph{number of inversions} of a {{subexcedent function}} as the sum\nof its values. We also define \\emph{the descent set} of a {{subexcedent function}} as\n\n", "itemtype": "equation", "pos": 3724, "prevtext": "\n\n\\begin{abstract}\n We prove a conjecture of J.-C. Novelli,\n J.-Y. Thibon, and L. K. Williams (2010) about an equivalence of two triples of statistics on permutations. To prove\nthis conjecture, we construct a bijection through different combinatorial objects, starting with a Catalan based object\nrelated to the PASEP.\n\\end{abstract}\n\n\\keywords{Bijections, statistics, permutations, Catalan objects}\n\n\\maketitle\n\n\\section{Introduction}\n\nThe algebra of noncommutative symmetric functions {\\bf Sym}~\\cite{NCSF1} has been studied in\nalgebraic combinatorics during the past twenty years. It contains many purely \ncombinatorics problems as, for example, the explicit description of the relations\nbetween different bases through their transition matrices. In this paper we shall\nbe interested in the basis introduced\nby Tevlin in~\\cite{Tev}, the so-called monomial basis of {\\bf Sym}, for which the transition\nmatrices ${{\\mathfrak} M}^{(n)}$ with the ribbon basis have been described in~\\cite{HNTT}.\n\nThe authors proved that\n${{\\mathfrak} M}^{(n)}_{I,J}$ is equal to the number of permutations satisfying ${\\operatorname{GC}}(\\sigma) = I$\nand ${\\operatorname{Rec}}(\\sigma) = J$ where ${\\operatorname{GC}}$ and ${\\operatorname{Rec}}$ are two statistics that will be recalled later. Some\nproperties of this basis correspond to combinatorial properties of the PASEP\n(Partially ASymmetric Exclusion Process) which is a physical model in which particles\nhop back and forth (and in and out) of a one-dimensional lattice which is studied\nthrough the combinatorial object of permutation\ntableaux~\\cite{CW}.\nMore precisely, in the study of the basis of Tevlin, the sum of the coefficients of the rows\nof the transition matrices corresponds to the number of permutation tableaux of given shapes.\n\nIn the PASEP context there exists a natural $q$-statistic on the permutation tableaux\nthat becomes the number of 31-2 patterns on permutations (denoted by ${\\rm tot}$) thanks to a \nwell-known bijection. This statistic allows to define a\n$q$-analog of the basis of Tevlin as the functions whose transition matrices ${{\\mathfrak} M}^{(n)}(q)$ with\nthe ribbon basis are such that ${{\\mathfrak} M}^{(n)}_{I,J}(q)$ is the sum of the $q^{{\\rm tot}(\\sigma)}$\nfor all $\\sigma$ satisfying ${\\operatorname{GC}}(\\sigma) = I$ and ${\\operatorname{Rec}}(\\sigma) = J$.\n\nIn~\\cite{NTW}, the authors studied those matrices in an algebraic way. However,\nthe statistics ${\\operatorname{GC}}$ and ${\\rm tot}$ on permutations were not appropriate for an\nalgebraic study. So the authors of~\\cite{NTW} built suitable matrices $\\widetilde{{{\\mathfrak} M}}^{(n)}(q)$\nfor their algebraic purpose through other statistics on permutations also recalled later.\n$\\widetilde{{{\\mathfrak} M}}^{(n)}_{I,J}(q)$ is the sum of the $q^{\\alpha(\\sigma)}$ for all $\\sigma$ satisfying\n${\\operatorname{LC}}(\\sigma) = I$ and ${\\operatorname{Rec}}(\\sigma) = J$. They conjectured that their matrices where the same\nas the ${{\\mathfrak} M}^{(n)}(q)$, or equivalently that the triples of statistics $({\\operatorname{GC}}, {\\operatorname{Rec}}, {\\rm tot})$\nand $({\\operatorname{LC}}, {\\operatorname{Rec}}, \\alpha)$ are equidistributed.\n\nThe aim of this paper is to prove this conjecture bijectively. As the triple of \nstatistics $({\\operatorname{LC}}, {\\operatorname{Rec}}, \\alpha)$ has a natural description on {subexcedent function} s and in order to gain\nin readability, we construct a bijection from permutations to {subexcedent function} s sending the \ntriple of statistics $({\\operatorname{GC}}, {\\operatorname{Rec}}, {\\rm tot})$ to $({\\operatorname{LC}}, {\\operatorname{DC}}, \\alpha)$.\nThe bijection is described as a succession of bijections through different\ncombinatorial objects:\n\n", "index": 1, "text": "\\begin{equation}\n \\label{eqSchemaBijs}\n \\text{P} \\overset{\\psi_{FV}}{\\longleftrightarrow} \\text{WDP} \\overset{\\psi}{\\longleftrightarrow} \\text{WDP} \n \\overset{\\phi_{2}}{\\longleftrightarrow} \\text{DWSF} \\overset{\\phi_{1}}{\\longleftrightarrow} \\text{SF}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E1.m1\" class=\"ltx_Math\" alttext=\"\\text{P}\\overset{\\psi_{FV}}{\\longleftrightarrow}\\text{WDP}\\overset{\\psi}{%&#10;\\longleftrightarrow}\\text{WDP}\\overset{\\phi_{2}}{\\longleftrightarrow}\\text{%&#10;DWSF}\\overset{\\phi_{1}}{\\longleftrightarrow}\\text{SF}\" display=\"block\"><mrow><mtext>P</mtext><mo>\u2062</mo><mover accent=\"true\"><mo>\u27f7</mo><msub><mi>\u03c8</mi><mrow><mi>F</mi><mo>\u2062</mo><mi>V</mi></mrow></msub></mover><mo>\u2062</mo><mtext>WDP</mtext><mo>\u2062</mo><mover accent=\"true\"><mo>\u27f7</mo><mo>\ud835\udf13</mo></mover><mo>\u2062</mo><mtext>WDP</mtext><mo>\u2062</mo><mover accent=\"true\"><mo>\u27f7</mo><msub><mi>\u03d5</mi><mn>2</mn></msub></mover><mo>\u2062</mo><mtext>DWSF</mtext><mo>\u2062</mo><mover accent=\"true\"><mo>\u27f7</mo><msub><mi>\u03d5</mi><mn>1</mn></msub></mover><mo>\u2062</mo><mtext>SF</mtext></mrow></math>", "type": "latex"}, {"file": "1601.02928.tex", "nexttext": "\nand the \\emph{descent composition} of $u$ (denoted by ${\\operatorname{DC}}(u)$) as the composition \nof size $n$ whose descent set is ${\\operatorname{Des}}(u)$. One can check that ${\\operatorname{DC}}(315503200) = (1,3,2,1,2)$.\n\n\\subsection{The Fran\\c con-Viennot bijection}\n\nThe Fran\\c con-Viennot bijection, first described in~\\cite{FV}, is a bijection\nbetween permutations and Laguerre histories. We shall describe a bijection between permutations\nand weighted Dyck paths (defined below) that can be obtained from \nthe version of Corteel of the\nFran\\c con-Viennot bijection described in~\\cite{Cor} through a simple bijection between colored Motzkin paths\nand Dyck paths.\n\n\\begin{definition}\n A weighted Dyck path of size $n$ is a Dyck path with $n$ up and $n$ down\n steps\n and a word $w$ of size $n$ called \n the weight. for all $i$, the weight satisfies $w_i \\leq (h_i-1)/2$ where \n $h_i$ is the height of the Dyck path between the  $(2i-1)$-th and \n $2i$-th steps.\n\\end{definition}\n\nFigure~\\ref{figHist} shows an example of a weighted Dyck path. We denote by $D_i$ the \n$i$-th step of the Dyck path. For a better readability we\ngrouped the steps two by two between vertical dashed lines and only wrote strictly\npositive $w_i$ above steps $D_{2i-1}$ and\n$D_{2i}$. In this representation, $h_i$ is exactly the height of the\npoint between steps $D_{2i-1}$ and $D_{2i}$.\n\n\\begin{figure}[h!t]\n\\begin{center}\n\\begin{tikzpicture}[scale=0.5]\n  \\draw[dotted, thick, color=gray!60] (0, 0) grid (18, 6);\n  \\draw[rounded corners=1, color=black, line width=1] (0, 0) -- (1, 1) -- \n  (2, 2) -- (3, 3) -- (4, 4) -- (5, 5) -- (6, 4) -- (7, 5) -- (8, 6) -- (9, 5) \n  -- (10, 4) -- (11, 3) -- (12, 2) -- (13, 1) -- (14, 2) -- (15, 1) -- (16, 0) \n  -- (17, 1) -- (18, 0);\n\n  \\draw[dotted, very thick] (2, 0) -- (2, 6);\n  \\draw[dotted, very thick] (4, 0) -- (4, 6);\n  \\draw[dotted, very thick] (6, 0) -- (6, 6);\n  \\draw[dotted, very thick] (8, 0) -- (8, 6);\n  \\draw[dotted, very thick] (10, 0) -- (10, 6);\n  \\draw[dotted, very thick] (12, 0) -- (12, 6);\n  \\draw[dotted, very thick] (14, 0) -- (14, 6);\n  \\draw[dotted, very thick] (16, 0) -- (16, 6);\n  \n  \\node (pond1) at (5, 5.5) {2};\n  \\node (pond2) at (7, 5.5) {2};\n  \\node (pond2) at (11, 3.5) {1};\n\\end{tikzpicture}\n\\caption{A weighted Dyck path of size 9.}\n\\label{figHist}\n\\end{center}\n\\end{figure}\n\nIt is difficult to directly show that the weighted Dyck paths are enumerated by $n!$ but\nthe Fran\\c con-Viennot bijection $\\psi_{FV}$ proves that it is the case for Laguerre histories\nso we obtain\nthe result for weighted Dyck paths with the bijection described below.\n\nIn the following algorithm, we compare each value of a permutation $\\sigma$ with its two neighbors.\nWe use the convention $\\sigma_0 = 0$ and $\\sigma_{n+1} = n+1$.\n\n\\begin{algorithm}[Fran\\c con-Viennot]\n\\label{algoFV}\n Let $\\sigma \\in {\\mathfrak S}_n$, $j \\in \\{1, \\ldots, n\\}$ and $k = \\sigma_j$, then in\n the Dyck path of $\\psi_{FV}(\\sigma)$ we have\n \\begin{itemize}\n  \\item $D_{2k-1} = D_{2k} = /$  if $\\sigma_j$ is a \\emph{valley}, {\\emph{i.e.}}, $\\sigma_{j-1} > \\sigma_j < \\sigma_{j+1}$,\n  \\item $D_{2k-1} = D_{2k} = \\backslash$ if $\\sigma_j$ is a \\emph{peak},  {\\emph{i.e.}}, $\\sigma_{j-1} < \\sigma_j > \\sigma_{j+1}$,\n  \\item $D_{2k-1}D_{2k} = /\\backslash$  if $\\sigma_j$ is a \\emph{double rise}, {\\emph{i.e.}}, $\\sigma_{j-1} < \\sigma_j < \\sigma_{j+1}$,\n  \\item $D_{2k-1}D_{2k} = \\backslash/$ if $\\sigma_j$ is a \\emph{double descent}, {\\emph{i.e.}}, $\\sigma_{j-1} > \\sigma_j > \\sigma_{j+1}$.\n \\end{itemize}\n The weight is constructed as follows: $w_k$ is equal to the number of 31-2 \n patterns where $k$ represents the~$2$.\n\\end{algorithm}\n\nFor example, if we consider $\\sigma = 528713649$, its image by $\\psi_{FV}$ is \nthe weighted Dyck path of Figure~\\ref{figHist}. One can check that the values\n$1$, $2$, and $4$ are peaks for $\\sigma$, the values 5, 6, and 8 are valleys, and so on.\nThe 31-2 patterns are 52-3, 71-3, 52-4, 71-4, and 71-6 so that the weight is indeed\n$(0,0,2,2,0,1,0,0,0)$.\n\nLet us also describe the reverse algorithm constructing a permutation from a\nweighted Dyck path $(D, w)$.\n\n\\begin{algorithm}\n\\label{algoInverseFV}\nThe permutation $\\sigma$ is built iteratively by\n\\begin{itemize}\n \\item Initialization: $\\sigma = \\circ$;\n \\item At the $k$-th step of the algorithm, replace\n the $(w_k+1)$-th $ \\circ$ of $\\sigma$ by: \n \\begin{itemize}\n  \\item $\\circ k \\circ$ if $D_{2k-1} = D_{2k} = /$,\n  \\item $k \\circ$ if $D_{2k-1}D_{2k} = /\\backslash$,\n  \\item $\\circ k$ if $D_{2k-1}D_{2k} = \\backslash/$,\n  \\item $ k$ if $D_{2k-1} = D_{2k} = \\backslash$;\n \\end{itemize}\n \\item The final permutation is obtained by removing the last $\\circ$.\n\\end{itemize}\n\\end{algorithm}\n\nFor the weighted Dyck path of Figure~\\ref{figHist}, the previous\nalgorithm gives us:\n\n", "itemtype": "equation", "pos": 8063, "prevtext": "\nwhere P, WDP, DWSF, and SF are respectively Permutations, Weighted Dyck Paths, Decreasing Weighted Subexcedent\nFunctions, and Subexcedent Functions which are all recalled or defined below. \nIn Section~\\ref{sectionPermToDyckPath} we shall describe the bijections\n$\\psi_{FV}$ and $\\psi$ which are natural bijections to obtain objects on which the statistics ${\\operatorname{GC}}$ and ${\\rm tot}$\nare naturally defined. The object obtained is a pair consisting in a Catalan \nobject and a weight. In Section~\\ref{sectionSFToDyckPath}\nwe begin by constructing a Catalan object associated with a weight from {subexcedent function} s\nthrough $\\phi_1$ and then\ndescribe $\\phi_2$, a Catalan bijection between decreasing {subexcedent function} s and Dyck paths.\nIn Section~\\ref{sectionFinal} we prove the \nglobal result and give some properties associated with the global bijection.\n\n\\section{Notations and background}\n\\subsection{Permutations, compositions, and {subexcedent function} s}\n\nLet us first fix our notations concerning permutations.\n\nA {\\it recoil} of a permutation $\\sigma$ is a value\n$i$ such that $i+1$ is on the left of $i$.\nThe recoil set of $\\sigma$ is the set of the values of recoils.\nA 31-2 pattern of $\\sigma$ is a pair $(i,j)$ such that $j > i+1$ \nand $\\sigma_{i+1} < \\sigma_j < \\sigma_i$. We denote by ${\\rm tot}(\\sigma)$\nthe number of 31-2 patterns of $\\sigma$. For example, ${\\rm tot}(528713649) = 5$.\n\nA \\emph{composition} of an integer $n$ is a sequence\n$I=(i_1,\\dots,i_r)$ of positive integers of sum $n$. \nIn this case we write $I \\models n$.  The integer $r$ is called\nthe \\emph{length} of the composition.\nThe \\emph{descent set} of $I$ is\n${\\operatorname{Des}}(I) = \\{ i_1,\\ i_1+i_2, \\ldots , i_1+\\dots+i_{r-1}\\}$.\nThe \\emph{recoil composition} ${\\operatorname{Rec}}(\\sigma)$ of a permutation\n$\\sigma\\in{\\mathfrak S}_n$ is the composition of $n$ whose descent set is the\nrecoil set of $\\sigma$. \n\nThe {\\it major index} ${\\rm maj}(I)$ of a composition is\nthe sum of the values in the descent set of $I$.\n\nThe \\emph{Genocchi descent set}~\\cite{HNTT} of a\npermutation $\\sigma\\in{\\mathfrak S}_n$ is the set of values immediately followed by a\nsmaller value (it is sometimes called descent top).\nThe \\emph{Genocchi composition of descents}\n(or G-compos\\-ition, for short) ${\\operatorname{GC}}(\\sigma)$ of a permutation is the integer\ncomposition $I$ of $n$ whose descent set is $\\{d-1~|~d\\in{\\operatorname{GDes}}(\\sigma)\\}$. For example,\nwith $\\sigma = 528713649$, we have ${\\operatorname{GDes}} = \\{5,6,7,8\\}$ and ${\\operatorname{GC}}(\\sigma) = (4,1,1,1,2)$.\n\nA \\emph{{subexcedent function}} of size $n$ is a word $u$ of size $n$ on the alphabet of \nnonnegative integers such that for each\n$i \\in \\{ 1, \\ldots, n\\}$ we have $u_i \\leq n-i$. We denote by\n$ {\\mathfrak{SF}}_n$ the set of {subexcedent function} s of size~$n$.\nThey are enumerated by\n$n!$ and in bijection with permutations through the Lehmer code. \nThe \\emph{statistic $LC$} is defined on a {{subexcedent function}} $u$ as follows.\n\\begin{itemize}\n\\item Set $S=\\emptyset$ and read $u$ from right to left.\nAt each step, if the entry $k$ is strictly greater than the size of $S$, add\nthe $(k-|S|)$-th element of the sequence $[1,n]$ not considering the\nelements of $S$.\n\n\\item The set $S$ is the descent set of a composition $C$, and\n${\\operatorname{LC}}(\\sigma)$ is the mirror image $\\overline{C}$ of  $C$.\n\\end{itemize}\nThis definition corresponds to the definition of ${\\operatorname{LC}}$ in~\\cite{NTW} after \napplying the Lehmer code on the inverse of the permutation.\n\nFor example, with $u= 315503200$,\n$S$ is $\\emptyset$ at first, then the set $\\{2\\}$ (third step), then \n$\\{2,3\\}$ (fourth step), then $\\{2,3,5\\}$ (sixth step), then \n$\\{2,3,4,5\\}$ (seventh step).\nHence $C$ is $(2,1,1,1,4)$, so that ${\\operatorname{LC}}(u)=(4,1,1,1,2)$.\n\nFrom the same bijection between permutations and {{subexcedent function}}s, \nwe define the \\emph{number of inversions} of a {{subexcedent function}} as the sum\nof its values. We also define \\emph{the descent set} of a {{subexcedent function}} as\n\n", "index": 3, "text": "\\begin{equation}\n {\\operatorname{Des}}(u) = \\{  i\\in \\{1, \\ldots, n-1\\} ~|~ u_i > u_{i+1}\\}\n\\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E2.m1\" class=\"ltx_Math\" alttext=\"{\\operatorname{Des}}(u)=\\{i\\in\\{1,\\ldots,n-1\\}~{}|~{}u_{i}&gt;u_{i+1}\\}\" display=\"block\"><mrow><mrow><mo>Des</mo><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>u</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mi>i</mi><mo>\u2208</mo><mrow><mo stretchy=\"false\">{</mo><mn>1</mn><mo>,</mo><mi mathvariant=\"normal\">\u2026</mi><mo>,</mo><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow><mo rspace=\"5.8pt\" stretchy=\"false\">}</mo></mrow></mrow><mo rspace=\"5.8pt\" stretchy=\"false\">|</mo><mrow><msub><mi>u</mi><mi>i</mi></msub><mo>&gt;</mo><msub><mi>u</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mo stretchy=\"false\">}</mo></mrow></mrow></math>", "type": "latex"}, {"file": "1601.02928.tex", "nexttext": "\n\n\n\\section{Permutations to weighted Dyck paths}\n\\label{sectionPermToDyckPath}\n\nLet us describe what happens to the three statistics on permutations\nthrough the Fran\\c con-Viennot bijection. \n\n\\subsection{The statistics through the Fran\\c con-Viennot bijection}\n\n\\begin{definition}\n Let $(D,w)$ be a weighted Dyck path of size $n$.\n \\begin{itemize}\n  \\item The \\emph{total weight} of $(D,w)$ (noted ${\\rm tw}(D,w)$) is the sum of the values of $w$.\n  \\item The \\emph{descent set} of $(D,w)$ is \n  \n", "itemtype": "equation", "pos": 12955, "prevtext": "\nand the \\emph{descent composition} of $u$ (denoted by ${\\operatorname{DC}}(u)$) as the composition \nof size $n$ whose descent set is ${\\operatorname{Des}}(u)$. One can check that ${\\operatorname{DC}}(315503200) = (1,3,2,1,2)$.\n\n\\subsection{The Fran\\c con-Viennot bijection}\n\nThe Fran\\c con-Viennot bijection, first described in~\\cite{FV}, is a bijection\nbetween permutations and Laguerre histories. We shall describe a bijection between permutations\nand weighted Dyck paths (defined below) that can be obtained from \nthe version of Corteel of the\nFran\\c con-Viennot bijection described in~\\cite{Cor} through a simple bijection between colored Motzkin paths\nand Dyck paths.\n\n\\begin{definition}\n A weighted Dyck path of size $n$ is a Dyck path with $n$ up and $n$ down\n steps\n and a word $w$ of size $n$ called \n the weight. for all $i$, the weight satisfies $w_i \\leq (h_i-1)/2$ where \n $h_i$ is the height of the Dyck path between the  $(2i-1)$-th and \n $2i$-th steps.\n\\end{definition}\n\nFigure~\\ref{figHist} shows an example of a weighted Dyck path. We denote by $D_i$ the \n$i$-th step of the Dyck path. For a better readability we\ngrouped the steps two by two between vertical dashed lines and only wrote strictly\npositive $w_i$ above steps $D_{2i-1}$ and\n$D_{2i}$. In this representation, $h_i$ is exactly the height of the\npoint between steps $D_{2i-1}$ and $D_{2i}$.\n\n\\begin{figure}[h!t]\n\\begin{center}\n\\begin{tikzpicture}[scale=0.5]\n  \\draw[dotted, thick, color=gray!60] (0, 0) grid (18, 6);\n  \\draw[rounded corners=1, color=black, line width=1] (0, 0) -- (1, 1) -- \n  (2, 2) -- (3, 3) -- (4, 4) -- (5, 5) -- (6, 4) -- (7, 5) -- (8, 6) -- (9, 5) \n  -- (10, 4) -- (11, 3) -- (12, 2) -- (13, 1) -- (14, 2) -- (15, 1) -- (16, 0) \n  -- (17, 1) -- (18, 0);\n\n  \\draw[dotted, very thick] (2, 0) -- (2, 6);\n  \\draw[dotted, very thick] (4, 0) -- (4, 6);\n  \\draw[dotted, very thick] (6, 0) -- (6, 6);\n  \\draw[dotted, very thick] (8, 0) -- (8, 6);\n  \\draw[dotted, very thick] (10, 0) -- (10, 6);\n  \\draw[dotted, very thick] (12, 0) -- (12, 6);\n  \\draw[dotted, very thick] (14, 0) -- (14, 6);\n  \\draw[dotted, very thick] (16, 0) -- (16, 6);\n  \n  \\node (pond1) at (5, 5.5) {2};\n  \\node (pond2) at (7, 5.5) {2};\n  \\node (pond2) at (11, 3.5) {1};\n\\end{tikzpicture}\n\\caption{A weighted Dyck path of size 9.}\n\\label{figHist}\n\\end{center}\n\\end{figure}\n\nIt is difficult to directly show that the weighted Dyck paths are enumerated by $n!$ but\nthe Fran\\c con-Viennot bijection $\\psi_{FV}$ proves that it is the case for Laguerre histories\nso we obtain\nthe result for weighted Dyck paths with the bijection described below.\n\nIn the following algorithm, we compare each value of a permutation $\\sigma$ with its two neighbors.\nWe use the convention $\\sigma_0 = 0$ and $\\sigma_{n+1} = n+1$.\n\n\\begin{algorithm}[Fran\\c con-Viennot]\n\\label{algoFV}\n Let $\\sigma \\in {\\mathfrak S}_n$, $j \\in \\{1, \\ldots, n\\}$ and $k = \\sigma_j$, then in\n the Dyck path of $\\psi_{FV}(\\sigma)$ we have\n \\begin{itemize}\n  \\item $D_{2k-1} = D_{2k} = /$  if $\\sigma_j$ is a \\emph{valley}, {\\emph{i.e.}}, $\\sigma_{j-1} > \\sigma_j < \\sigma_{j+1}$,\n  \\item $D_{2k-1} = D_{2k} = \\backslash$ if $\\sigma_j$ is a \\emph{peak},  {\\emph{i.e.}}, $\\sigma_{j-1} < \\sigma_j > \\sigma_{j+1}$,\n  \\item $D_{2k-1}D_{2k} = /\\backslash$  if $\\sigma_j$ is a \\emph{double rise}, {\\emph{i.e.}}, $\\sigma_{j-1} < \\sigma_j < \\sigma_{j+1}$,\n  \\item $D_{2k-1}D_{2k} = \\backslash/$ if $\\sigma_j$ is a \\emph{double descent}, {\\emph{i.e.}}, $\\sigma_{j-1} > \\sigma_j > \\sigma_{j+1}$.\n \\end{itemize}\n The weight is constructed as follows: $w_k$ is equal to the number of 31-2 \n patterns where $k$ represents the~$2$.\n\\end{algorithm}\n\nFor example, if we consider $\\sigma = 528713649$, its image by $\\psi_{FV}$ is \nthe weighted Dyck path of Figure~\\ref{figHist}. One can check that the values\n$1$, $2$, and $4$ are peaks for $\\sigma$, the values 5, 6, and 8 are valleys, and so on.\nThe 31-2 patterns are 52-3, 71-3, 52-4, 71-4, and 71-6 so that the weight is indeed\n$(0,0,2,2,0,1,0,0,0)$.\n\nLet us also describe the reverse algorithm constructing a permutation from a\nweighted Dyck path $(D, w)$.\n\n\\begin{algorithm}\n\\label{algoInverseFV}\nThe permutation $\\sigma$ is built iteratively by\n\\begin{itemize}\n \\item Initialization: $\\sigma = \\circ$;\n \\item At the $k$-th step of the algorithm, replace\n the $(w_k+1)$-th $ \\circ$ of $\\sigma$ by: \n \\begin{itemize}\n  \\item $\\circ k \\circ$ if $D_{2k-1} = D_{2k} = /$,\n  \\item $k \\circ$ if $D_{2k-1}D_{2k} = /\\backslash$,\n  \\item $\\circ k$ if $D_{2k-1}D_{2k} = \\backslash/$,\n  \\item $ k$ if $D_{2k-1} = D_{2k} = \\backslash$;\n \\end{itemize}\n \\item The final permutation is obtained by removing the last $\\circ$.\n\\end{itemize}\n\\end{algorithm}\n\nFor the weighted Dyck path of Figure~\\ref{figHist}, the previous\nalgorithm gives us:\n\n", "index": 5, "text": "$$\n\\begin{array}{c}\n \\sigma = \\circ ~\\to~ \\circ 1 \\circ ~\\to~  \\circ 2 \\circ 1 \\circ ~\\to~\n \\circ 2 \\circ 13 \\circ ~\\to~ \\circ2\\circ13\\circ4\\circ\n \\to~ 52\\circ13\\circ4\\circ \\vspace{0.2cm} \\\\\n ~\\to~  52 \\circ 13642 \\circ\n ~\\to~\n 52 \\circ 713642 \\circ ~\\to~ 528713642 \\circ ~\\to~ 528713649\\circ ~\\to~ 528713649.\n\\end{array}\n$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"\\begin{array}[]{c}\\sigma=\\circ~{}\\to~{}\\circ 1\\circ~{}\\to~{}\\circ 2\\circ 1%&#10;\\circ~{}\\to~{}\\circ 2\\circ 13\\circ~{}\\to~{}\\circ 2\\circ 13\\circ 4\\circ\\to~{}52%&#10;\\circ 13\\circ 4\\circ\\\\&#10;~{}\\to~{}52\\circ 13642\\circ~{}\\to~{}52\\circ 713642\\circ~{}\\to~{}528713642\\circ%&#10;~{}\\to~{}528713649\\circ~{}\\to~{}528713649.\\end{array}\" display=\"block\"><mtable displaystyle=\"true\" rowspacing=\"0pt\"><mtr><mtd columnalign=\"center\"><mrow><mi>\u03c3</mi><mo>=</mo><mo rspace=\"5.8pt\">\u2218</mo><mo rspace=\"5.8pt\">\u2192</mo><mo>\u2218</mo><mn>1</mn><mo rspace=\"5.8pt\">\u2218</mo><mo rspace=\"5.8pt\">\u2192</mo><mo>\u2218</mo><mn>2</mn><mo>\u2218</mo><mn>1</mn><mo rspace=\"5.8pt\">\u2218</mo><mo rspace=\"5.8pt\">\u2192</mo><mo>\u2218</mo><mn>2</mn><mo>\u2218</mo><mn>13</mn><mo rspace=\"5.8pt\">\u2218</mo><mo rspace=\"5.8pt\">\u2192</mo><mo>\u2218</mo><mn>2</mn><mo>\u2218</mo><mn>13</mn><mo>\u2218</mo><mn>4</mn><mo>\u2218</mo><mo rspace=\"5.8pt\">\u2192</mo><mn>52</mn><mo>\u2218</mo><mn>13</mn><mo>\u2218</mo><mn>4</mn><mo>\u2218</mo></mrow></mtd></mtr><mtr><mtd columnalign=\"center\"><mrow><mo lspace=\"5.8pt\" rspace=\"5.8pt\">\u2192</mo><mn>52</mn><mo>\u2218</mo><mn>13642</mn><mo rspace=\"5.8pt\">\u2218</mo><mo rspace=\"5.8pt\">\u2192</mo><mn>52</mn><mo>\u2218</mo><mn>713642</mn><mo rspace=\"5.8pt\">\u2218</mo><mo rspace=\"5.8pt\">\u2192</mo><mn>528713642</mn><mo rspace=\"5.8pt\">\u2218</mo><mo rspace=\"5.8pt\">\u2192</mo><mn>528713649</mn><mo rspace=\"5.8pt\">\u2218</mo><mo rspace=\"5.8pt\">\u2192</mo><mn>528713649</mn><mo>.</mo></mrow></mtd></mtr></mtable></math>", "type": "latex"}, {"file": "1601.02928.tex", "nexttext": "\n  and the \\emph{descent composition} ${\\operatorname{DC}}(D,w)$ is the composition of $n$ whose descent set is ${\\operatorname{Des}}(D,w)$.\n  \\item The \\emph{Genocchi descent set} of $(D,w)$ is \n  \n", "itemtype": "equation", "pos": 13776, "prevtext": "\n\n\n\\section{Permutations to weighted Dyck paths}\n\\label{sectionPermToDyckPath}\n\nLet us describe what happens to the three statistics on permutations\nthrough the Fran\\c con-Viennot bijection. \n\n\\subsection{The statistics through the Fran\\c con-Viennot bijection}\n\n\\begin{definition}\n Let $(D,w)$ be a weighted Dyck path of size $n$.\n \\begin{itemize}\n  \\item The \\emph{total weight} of $(D,w)$ (noted ${\\rm tw}(D,w)$) is the sum of the values of $w$.\n  \\item The \\emph{descent set} of $(D,w)$ is \n  \n", "index": 7, "text": "\\begin{equation}\n   {\\operatorname{Des}}(D,w) = \\{i~|~w_i > w_{i+1}\\} \\cup \\{ i~|~w_i = w_{i+1}, D_{2i} = / \\}\n  \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E3.m1\" class=\"ltx_Math\" alttext=\"{\\operatorname{Des}}(D,w)=\\{i~{}|~{}w_{i}&gt;w_{i+1}\\}\\cup\\{i~{}|~{}w_{i}=w_{i+1}%&#10;,D_{2i}=/\\}\" display=\"block\"><mrow><mrow><mo>Des</mo><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>D</mi><mo>,</mo><mi>w</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mo stretchy=\"false\">{</mo><mrow><mpadded width=\"+3.3pt\"><mi>i</mi></mpadded><mo>\u2062</mo><mrow><mo fence=\"true\" rspace=\"5.8pt\" stretchy=\"false\">|</mo><msub><mi>w</mi><mi>i</mi></msub><mo>&gt;</mo></mrow><mo>\u2062</mo><msub><mi>w</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mo stretchy=\"false\">}</mo></mrow><mo>\u222a</mo><mrow><mo stretchy=\"false\">{</mo><mpadded width=\"+3.3pt\"><mi>i</mi></mpadded><mo rspace=\"5.8pt\" stretchy=\"false\">|</mo><mrow><mrow><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><msub><mi>w</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mo>,</mo><mrow><msub><mi>D</mi><mrow><mn>2</mn><mo>\u2062</mo><mi>i</mi></mrow></msub><mo>=</mo><mo>/</mo></mrow></mrow><mo stretchy=\"false\">}</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.02928.tex", "nexttext": "\n  then, as for permutations, the \\emph{Genocchi composition of descent} of $(D,w)$ (noted ${\\operatorname{GC}}(D,w)$) is the\n  composition of $n$ whose descent set is $\\{d-1~|~d \\in {\\operatorname{GDes}}(D,w)\\}$.\n \\end{itemize}\n\\end{definition}\n\nOn the weighted Dyck path $(D,w)$ of Figure~\\ref{figHist} we have ${\\rm tw}(D,w) = 5$. The positions $i$ such that\n$D_{2i-1} = \\backslash$ are ${\\operatorname{GDes}}(D,w) = \\{5, 6, 7, 8\\}$ so that ${\\operatorname{GC}}(D,w) = (4,1,1,1,2)$ and one can check that\n${\\operatorname{DC}}(D,w) = (1,3,2,1,2)$.\n\n\n\\begin{lemma}\n\\label{lemmaStatsFV}\n Let $\\sigma$ be a permutation of size $n$ and $(D,w) = \\psi_{FV}(\\sigma)$. We have the following properties:\n \\begin{itemize}\n  \\item ${\\rm tw}(D,w) = {\\rm tot}(\\sigma)$;\n  \\item ${\\operatorname{GC}}(D,w) = {\\operatorname{GC}}(\\sigma)$;\n  \\item ${\\operatorname{DC}}(D,w) = {\\operatorname{Rec}}(\\sigma)$.\n \\end{itemize}\n\\end{lemma}\n\n\\begin{proof}\n The first two assertions come directly from our description of $\\psi_{FV}$. To prove the \n last one, it is easier to work with $\\psi_{FV}^{-1}$ constructing a permutation $\\sigma$\n from a weighted Dyck path $(D, w)$, see Algorithm~\\ref{algoInverseFV}.\n Let $k \\in \\{1, \\ldots, n-1\\}$. If $w_k < w_{k+1}$, then $k$\n is to the left of $k+1$ in $\\sigma$ so it is not a recoil for $\\sigma$. Using the same idea,\n if $w_k < w_{k+1}$ then $k$ is a recoil for $\\sigma$. Now, when $w_k = w_{k+1}$,\n we have a recoil in $k$ if and only if there is a new $\\circ$ on the left of $k$ when we place \n it in $\\sigma$ which happens if and only if $D_{2k} = /$.\n\\end{proof}\n\nWe now have a representation of the triple of statistics on the weighted Dyck paths but the definition of ${\\operatorname{GC}}$\non those objects is not very natural because we need to consider the composition on a modified set. To simplify\nthe second part of the construction, we transform the Dyck paths to obtain a more suitable \nstatistic.\n\n\\subsection{An involution on Dyck paths}\n\n\\begin{definition}\n Let $D$ be a Dyck path of size $2n$. The Dyck path $\\psi(D)$ is obtained by\n sending every pair of steps $/\\backslash$ or\n $\\backslash/$ at positions $2i$, $2i+1$ to one another.\n\\end{definition}\n\nWe extend this definition to weighted Dyck paths by carrying the weight.\nNote that it is an involution. An example is given in Figure~\\ref{figPsi}\nwhere we apply $\\psi$ to the weighted Dyck path of Figure~\\ref{figHist}.\n\n\\begin{figure}[h!t]\n\\begin{center}\n\\begin{tikzpicture}[scale=0.5]\n \\begin{scope}[scale=0.7]\n  \\draw[dotted, thick, color=gray!60] (0, 0) grid (18, 6);\n  \\draw[rounded corners=1, color=black, line width=1] (0, 0) -- (1, 1) -- \n  (2, 2) -- (3, 3) -- (4, 4) -- (5, 5) -- (6, 4) -- (7, 5) -- (8, 6) -- (9, 5) \n  -- (10, 4) -- (11, 3) -- (12, 2) -- (13, 1) -- (14, 2) -- (15, 1) -- (16, 0) \n  -- (17, 1) -- (18, 0);\n\n  \\draw[dotted, very thick] (2, 0) -- (2, 6);\n  \\draw[dotted, very thick] (4, 0) -- (4, 6);\n  \\draw[dotted, very thick] (6, 0) -- (6, 6);\n  \\draw[dotted, very thick] (8, 0) -- (8, 6);\n  \\draw[dotted, very thick] (10, 0) -- (10, 6);\n  \\draw[dotted, very thick] (12, 0) -- (12, 6);\n  \\draw[dotted, very thick] (14, 0) -- (14, 6);\n  \\draw[dotted, very thick] (16, 0) -- (16, 6);\n  \n  \\node (pond1) at (5, 5.5) {2};\n  \\node (pond2) at (7, 5.5) {2};\n  \\node (pond2) at (11, 3.5) {1};\n \\end{scope}\n \n \\begin{scope}[xshift=12cm, yshift=8.1cm]\n \\draw (1.5, -6) -- (2.5, -6) node[midway, below]{$\\psi$};\n \\draw (1.7, -5.8) -- (1.5, -6) -- (1.7, -6.2);\n \\draw (2.3, -5.8) -- (2.5, -6) -- (2.3, -6.2);\n \\end{scope}\n\n \\begin{scope}[scale=0.7, xshift=22cm]\n  \\draw[dotted, thick, color=gray!60] (0, 0) grid (18, 6);\n  \\draw[rounded corners=1, color=black, line width=1] (0, 0) -- (1, 1) -- \n  (2, 2) -- (3, 3) -- (4, 4) -- (5, 5) -- (6, 6) -- (7, 5) -- (8, 4) -- (9, 5) \n  -- (10, 4) -- (11, 3) -- (12, 2) -- (13, 1) -- (14, 0) -- (15, 1) -- (16, 2) \n  -- (17, 1) -- (18, 0);\n\n  \\draw[dotted, very thick] (2, 0) -- (2, 6);\n  \\draw[dotted, very thick] (4, 0) -- (4, 6);\n  \\draw[dotted, very thick] (6, 0) -- (6, 6);\n  \\draw[dotted, very thick] (8, 0) -- (8, 6);\n  \\draw[dotted, very thick] (10, 0) -- (10, 6);\n  \\draw[dotted, very thick] (12, 0) -- (12, 6);\n  \\draw[dotted, very thick] (14, 0) -- (14, 6);\n  \\draw[dotted, very thick] (16, 0) -- (16, 6);\n  \n  \\node (pond1) at (5, 5.5) {2};\n  \\node (pond2) at (7, 5.5) {2};\n  \\node (pond2) at (11, 3.5) {1};\n \\end{scope}\n\\end{tikzpicture}\n\\caption{An example of $\\psi$.}\n\\label{figPsi}\n\\end{center}\n\\end{figure}\n\nLet us introduce the new statistics on weighted Dyck paths corresponding to \n${\\operatorname{DC}}$ and ${\\operatorname{GC}}$ after applying $\\psi$.\n\n\\begin{definition}\n Let us define ${\\operatorname{GC}}^0$ and ${\\operatorname{DC}}^0$ which are close to ${\\operatorname{GC}}$ \n and ${\\operatorname{DC}}$.\n \\begin{itemize}\n  \\item The \\emph{Genocchi descent set of type 0} of a weighted Dyck path\n  of size $n$ is \n  \n", "itemtype": "equation", "pos": 14101, "prevtext": "\n  and the \\emph{descent composition} ${\\operatorname{DC}}(D,w)$ is the composition of $n$ whose descent set is ${\\operatorname{Des}}(D,w)$.\n  \\item The \\emph{Genocchi descent set} of $(D,w)$ is \n  \n", "index": 9, "text": "\\begin{equation}\n   {\\operatorname{GDes}}(D,w) = \\{ i \\in [2, n]~|~D_{2i-1} = \\backslash\\}\n  \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E4.m1\" class=\"ltx_Math\" alttext=\"{\\operatorname{GDes}}(D,w)=\\{i\\in[2,n]~{}|~{}D_{2i-1}=\\backslash\\}\" display=\"block\"><mrow><mrow><mo>GDes</mo><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>D</mi><mo>,</mo><mi>w</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mi>i</mi><mo>\u2208</mo><mrow><mo stretchy=\"false\">[</mo><mn>2</mn><mo>,</mo><mi>n</mi><mo rspace=\"5.8pt\" stretchy=\"false\">]</mo></mrow></mrow><mo rspace=\"5.8pt\" stretchy=\"false\">|</mo><mrow><msub><mi>D</mi><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>i</mi></mrow><mo>-</mo><mn>1</mn></mrow></msub><mo>=</mo><mo>\\</mo></mrow><mo stretchy=\"false\">}</mo></mrow></mrow></math>", "type": "latex"}, {"file": "1601.02928.tex", "nexttext": "\n  and \n  the \\emph{Genocchi composition of descent of type 0} as the composition of \n  $n$ whose descent set is ${\\operatorname{GDes}}^0(D,w)$.\n  \\item The \\emph{descent set of type 0} of $(D,w)$ is \n  \n", "itemtype": "equation", "pos": 19102, "prevtext": "\n  then, as for permutations, the \\emph{Genocchi composition of descent} of $(D,w)$ (noted ${\\operatorname{GC}}(D,w)$) is the\n  composition of $n$ whose descent set is $\\{d-1~|~d \\in {\\operatorname{GDes}}(D,w)\\}$.\n \\end{itemize}\n\\end{definition}\n\nOn the weighted Dyck path $(D,w)$ of Figure~\\ref{figHist} we have ${\\rm tw}(D,w) = 5$. The positions $i$ such that\n$D_{2i-1} = \\backslash$ are ${\\operatorname{GDes}}(D,w) = \\{5, 6, 7, 8\\}$ so that ${\\operatorname{GC}}(D,w) = (4,1,1,1,2)$ and one can check that\n${\\operatorname{DC}}(D,w) = (1,3,2,1,2)$.\n\n\n\\begin{lemma}\n\\label{lemmaStatsFV}\n Let $\\sigma$ be a permutation of size $n$ and $(D,w) = \\psi_{FV}(\\sigma)$. We have the following properties:\n \\begin{itemize}\n  \\item ${\\rm tw}(D,w) = {\\rm tot}(\\sigma)$;\n  \\item ${\\operatorname{GC}}(D,w) = {\\operatorname{GC}}(\\sigma)$;\n  \\item ${\\operatorname{DC}}(D,w) = {\\operatorname{Rec}}(\\sigma)$.\n \\end{itemize}\n\\end{lemma}\n\n\\begin{proof}\n The first two assertions come directly from our description of $\\psi_{FV}$. To prove the \n last one, it is easier to work with $\\psi_{FV}^{-1}$ constructing a permutation $\\sigma$\n from a weighted Dyck path $(D, w)$, see Algorithm~\\ref{algoInverseFV}.\n Let $k \\in \\{1, \\ldots, n-1\\}$. If $w_k < w_{k+1}$, then $k$\n is to the left of $k+1$ in $\\sigma$ so it is not a recoil for $\\sigma$. Using the same idea,\n if $w_k < w_{k+1}$ then $k$ is a recoil for $\\sigma$. Now, when $w_k = w_{k+1}$,\n we have a recoil in $k$ if and only if there is a new $\\circ$ on the left of $k$ when we place \n it in $\\sigma$ which happens if and only if $D_{2k} = /$.\n\\end{proof}\n\nWe now have a representation of the triple of statistics on the weighted Dyck paths but the definition of ${\\operatorname{GC}}$\non those objects is not very natural because we need to consider the composition on a modified set. To simplify\nthe second part of the construction, we transform the Dyck paths to obtain a more suitable \nstatistic.\n\n\\subsection{An involution on Dyck paths}\n\n\\begin{definition}\n Let $D$ be a Dyck path of size $2n$. The Dyck path $\\psi(D)$ is obtained by\n sending every pair of steps $/\\backslash$ or\n $\\backslash/$ at positions $2i$, $2i+1$ to one another.\n\\end{definition}\n\nWe extend this definition to weighted Dyck paths by carrying the weight.\nNote that it is an involution. An example is given in Figure~\\ref{figPsi}\nwhere we apply $\\psi$ to the weighted Dyck path of Figure~\\ref{figHist}.\n\n\\begin{figure}[h!t]\n\\begin{center}\n\\begin{tikzpicture}[scale=0.5]\n \\begin{scope}[scale=0.7]\n  \\draw[dotted, thick, color=gray!60] (0, 0) grid (18, 6);\n  \\draw[rounded corners=1, color=black, line width=1] (0, 0) -- (1, 1) -- \n  (2, 2) -- (3, 3) -- (4, 4) -- (5, 5) -- (6, 4) -- (7, 5) -- (8, 6) -- (9, 5) \n  -- (10, 4) -- (11, 3) -- (12, 2) -- (13, 1) -- (14, 2) -- (15, 1) -- (16, 0) \n  -- (17, 1) -- (18, 0);\n\n  \\draw[dotted, very thick] (2, 0) -- (2, 6);\n  \\draw[dotted, very thick] (4, 0) -- (4, 6);\n  \\draw[dotted, very thick] (6, 0) -- (6, 6);\n  \\draw[dotted, very thick] (8, 0) -- (8, 6);\n  \\draw[dotted, very thick] (10, 0) -- (10, 6);\n  \\draw[dotted, very thick] (12, 0) -- (12, 6);\n  \\draw[dotted, very thick] (14, 0) -- (14, 6);\n  \\draw[dotted, very thick] (16, 0) -- (16, 6);\n  \n  \\node (pond1) at (5, 5.5) {2};\n  \\node (pond2) at (7, 5.5) {2};\n  \\node (pond2) at (11, 3.5) {1};\n \\end{scope}\n \n \\begin{scope}[xshift=12cm, yshift=8.1cm]\n \\draw (1.5, -6) -- (2.5, -6) node[midway, below]{$\\psi$};\n \\draw (1.7, -5.8) -- (1.5, -6) -- (1.7, -6.2);\n \\draw (2.3, -5.8) -- (2.5, -6) -- (2.3, -6.2);\n \\end{scope}\n\n \\begin{scope}[scale=0.7, xshift=22cm]\n  \\draw[dotted, thick, color=gray!60] (0, 0) grid (18, 6);\n  \\draw[rounded corners=1, color=black, line width=1] (0, 0) -- (1, 1) -- \n  (2, 2) -- (3, 3) -- (4, 4) -- (5, 5) -- (6, 6) -- (7, 5) -- (8, 4) -- (9, 5) \n  -- (10, 4) -- (11, 3) -- (12, 2) -- (13, 1) -- (14, 0) -- (15, 1) -- (16, 2) \n  -- (17, 1) -- (18, 0);\n\n  \\draw[dotted, very thick] (2, 0) -- (2, 6);\n  \\draw[dotted, very thick] (4, 0) -- (4, 6);\n  \\draw[dotted, very thick] (6, 0) -- (6, 6);\n  \\draw[dotted, very thick] (8, 0) -- (8, 6);\n  \\draw[dotted, very thick] (10, 0) -- (10, 6);\n  \\draw[dotted, very thick] (12, 0) -- (12, 6);\n  \\draw[dotted, very thick] (14, 0) -- (14, 6);\n  \\draw[dotted, very thick] (16, 0) -- (16, 6);\n  \n  \\node (pond1) at (5, 5.5) {2};\n  \\node (pond2) at (7, 5.5) {2};\n  \\node (pond2) at (11, 3.5) {1};\n \\end{scope}\n\\end{tikzpicture}\n\\caption{An example of $\\psi$.}\n\\label{figPsi}\n\\end{center}\n\\end{figure}\n\nLet us introduce the new statistics on weighted Dyck paths corresponding to \n${\\operatorname{DC}}$ and ${\\operatorname{GC}}$ after applying $\\psi$.\n\n\\begin{definition}\n Let us define ${\\operatorname{GC}}^0$ and ${\\operatorname{DC}}^0$ which are close to ${\\operatorname{GC}}$ \n and ${\\operatorname{DC}}$.\n \\begin{itemize}\n  \\item The \\emph{Genocchi descent set of type 0} of a weighted Dyck path\n  of size $n$ is \n  \n", "index": 11, "text": "\\begin{equation}\n   {\\operatorname{GDes}}^0(D,w) = \\{ i \\in [1, n-1]~|~D_{2i} = \\backslash\\}\n  \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E5.m1\" class=\"ltx_Math\" alttext=\"{\\operatorname{GDes}}^{0}(D,w)=\\{i\\in[1,n-1]~{}|~{}D_{2i}=\\backslash\\}\" display=\"block\"><mrow><mrow><msup><mo>GDes</mo><mn>0</mn></msup><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>D</mi><mo>,</mo><mi>w</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mi>i</mi><mo>\u2208</mo><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo>,</mo><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow><mo rspace=\"5.8pt\" stretchy=\"false\">]</mo></mrow></mrow><mo rspace=\"5.8pt\" stretchy=\"false\">|</mo><mrow><msub><mi>D</mi><mrow><mn>2</mn><mo>\u2062</mo><mi>i</mi></mrow></msub><mo>=</mo><mo>\\</mo></mrow><mo stretchy=\"false\">}</mo></mrow></mrow></math>", "type": "latex"}, {"file": "1601.02928.tex", "nexttext": "\n  and the \\emph{descent composition of type 0} (noted ${\\operatorname{DC}}^0(D,w)$) is the composition of\n  $n$ whose descent set is ${\\operatorname{Des}}^0(D,w)$.\n \\end{itemize}\n\\end{definition}\n\n\\begin{lemma}\n\\label{lemmaStatsInvol}\n Let $(D,w)$ be a weighted Dyck path, then\n \\begin{itemize}\n  \\item ${\\rm tw}(\\psi(D,w)) = {\\rm tw}(D,w)$;\n  \\item ${\\operatorname{GC}}^0(\\psi(D,w))= {\\operatorname{GC}}(D,w)$;\n  \\item ${\\operatorname{DC}}^0(\\psi(D,w)) = {\\operatorname{DC}}(D,w)$.\n \\end{itemize}\n\\end{lemma}\n\n\\begin{proof}\n As $\\psi$ does not change the weight of the Dyck path, the \n total weight is carried. For the other two statistics, one\n proves the claim by studying different cases depending on which\n steps are at positions $2i$ and $2i+1$.\n\\end{proof}\n\n\\section{Subexcedent functions to weighted Dyck paths}\n\\label{sectionSFToDyckPath}\nThe aim of this section is to build a bijection from {subexcedent function} s to\nweighted Dyck paths sending the triple \n$({\\operatorname{LC}}, {\\operatorname{DC}}, {\\rm inv}-{\\rm maj}(\\overline{{\\operatorname{LC}}}))$ on \n$({\\operatorname{GC}}^0, {\\operatorname{DC}}^0, {\\rm tw})$ where the statistic ${\\rm inv}-{\\rm maj}(\\overline{{\\operatorname{LC}}})$\ncorresponds to the statistic $\\alpha$ in the introduction. To do this, we construct a bijection\nfrom {subexcedent function} s to an intermediate object: \\emph{decreasing weighted {subexcedent function} s}\nwhich are represented by a Catalan object and a weight, and then construct a \nCatalan bijection between decreasing {subexcedent function} s and Dyck paths.\n\n\\subsection{Subexcedent functions to decreasing weighted {subexcedent function} s}\n\n\\begin{definition}\n\\label{defDecreasingLehmer}\n Let us define a \\emph{decreasing {{subexcedent function}}} of size $n$ and a \\emph{weight} for it.\n \\begin{itemize}\n  \\item A {{subexcedent function}} $u$ of size $n$ is \\emph{decreasing} if the word obtained by removing all \n  its zeroes is a strictly decreasing word.\n  \\item A \\emph{weight} of a decreasing {{subexcedent function}} is a word $w$ of size $n$ such \n  that for all $k \\in \\{1, \\ldots, n\\}$, $w_k$ is smaller than or equal to\n  the number of $i < k$ such that $0 < u_i < n-k$ ({\\emph{i.e.}}, the number of \n  positive values on the left of $k$ that could be at position $k$).\n \\end{itemize}\n\\end{definition}\n\nFor example, the {{subexcedent function}} $u = 540300200$ is decreasing. For the associated weight, we can \ndefine a maximum weight as the weight for which each value is maximum. The maximum weight\nof~$u$ is $012221000$ so the weight $002201000$ is acceptable whereas $000002000$\nis not.\n\nWe say that a value of a {{subexcedent function}} is weighted if the corresponding weight is nonzero.\n\n\\begin{remark}\n The decreasing {subexcedent function} s are indeed Catalan objects since one can build a bijection with nondecreasing \n parking functions, the\n nondecreasing words whose $i$-th value is smaller than or equal to $i$ and whose first value is\n equal to one. First, reverse the {{subexcedent function}}, add one to all values and then replace the $1$ values\n except the first one by their left neighboring value.\n\\end{remark}\n\n\\subsubsection{Description of the bijection $\\phi_1$ between {subexcedent function} s and decreasing weighted {subexcedent function} s}\n\nOur bijection $\\phi_1$ can be described as an algorithm sorting a {{subexcedent function}} by\nmoving successively the greatest value to its left.\n\n\\begin{algorithm}\n\\label{algoPhi1}\n Let $u$ be a {{subexcedent function}} of size $n$. Set weight $w$ to $0^n$.\n \\begin{itemize}\n  \\item Step 1: define the \\emph{pivot} as the greatest value in $u$ such that one of its\n  occurrences has\n  smaller or equal nonzero values to its left. If the pivot is not defined, the \n  algorithm stops. Otherwise, let $k$ be the position of the rightmost \n  occurrence of the pivot in $u$.\n  \\item Step 2: among the values smaller than or equal to the pivot on its left,\n  let $i$ be the position of the rightmost occurrence of the greatest one. Modify the \n  {{subexcedent function}} by decrementing $u_i$ and then swapping $u_i$ with \n  $u_k$. Modify the weight by incrementing $w_k$. Go back to Step 1.\n \\end{itemize}\n\\end{algorithm}\n\nLet us give an example with $u = 315503200$. Our algorithm follows the steps:\n\\begin{itemize}\n \\item $u = 315503200$, $P = 000000000$, then  $pivot = 5$, $k = 4$ and $i = 3$;\n \\item $u = 31{\\bf \\textcolor{red}{54}}03200$, $P = 000{\\bf \\textcolor{red}{1}}00000$, then $pivot = 5$, $k = 3$ and $i = 1$;\n \\item $u = {\\bf \\textcolor{red}{5}}1{\\bf \\textcolor{red}{2}}403200$, $P = 00{\\bf \\textcolor{red}{1}}100000$, then $pivot = 4$, $k = 4$ and $i = 3$;\n \\item $u = 51{\\bf \\textcolor{red}{41}}03200$, $P = 001{\\bf \\textcolor{red}{2}}00000$, then $pivot = 4$, $k = 3$ and $i = 2$;\n \\item $u = 5{\\bf \\textcolor{red}{40}}103200$, $P = 00{\\bf \\textcolor{red}{2}}200000$, then $pivot = 3$, $k = 6$ and $i = 4$;\n \\item $u = 540{\\bf \\textcolor{red}{3}}0{\\bf \\textcolor{red}{0}}200$, $P = 00220{\\bf \\textcolor{red}{1}}000$ and the algorithm stops.\n\\end{itemize}\nAt the end, $\\phi_1(315503200) = (540300200, 002201000)$.\n\n\\begin{proposition}\n The map $\\phi_1$ is well-defined from {subexcedent function} s to decreasing \n {subexcedent function} s.\n\\end{proposition}\n\n\\begin{proof}\n It is clear that $\\phi_1$ is well-defined for every {{subexcedent function}} $u$ and that\n the algorithm stops (for each pivot we have at most $n-1-pivot$ swaps).\n \n The result is decreasing in the sense of\n Definition~\\ref{defDecreasingLehmer} because the algorithm sorts the {subexcedent function}.\n \n To prove that the result is a decreasing weighted {subexcedent function}, we need to \n prove that the weight respects the constraints of \n Definition~\\ref{defDecreasingLehmer}. Each value at position $j$ in the weight was \n increased at\n most once per pivot that ended on its left which makes even fewer values than the \n number of values on the left of $j$ at the\n end of the algorithm. Moreover, it was increased only if the pivot was at position \n $j$, which is possible only if the pivot is smaller than or equal to $n-j$. Finally \n $w$ respects the constraints of the definition.\n\\end{proof}\n\n\\begin{lemma}\n\\label{lemmaBij2And2}\n Consider Step 2 in Algorithm~\\ref{algoPhi1}. After the exchange, we can find which values were\n swapped. \n \n The position of the pivot is the rightmost position such that there exists a strictly smaller\n weighted value to its right, {\\emph{i.e.}}, the rightmost position $i$ such that there exists $k > i$ with $w_k >0$\n and $u_i > u_k$.\n \n The pivot swapped with the nearest weighted value to its right.\n\\end{lemma}\n\n\\begin{proof}\n We start by proving the second part of the lemma.\n We prove by induction on each different\n pivot that, with the notations of Algorithm~\\ref{algoPhi1},\n for all $i <j <k$, we have $w_j=0$. For the first pivot there is no\n problem as there is no weighted value to its left.\n \n Assume the property is true when we change the value of the pivot. The \n weighted values are necessarily greater than or equal to the values on their\n left (up to the position where the previous pivot ended) so the new pivot\n must swap with all these weighted values. This ends the proof of this part of the lemma.\n\n We also prove the other part of the lemma by induction. After the first exchange, the property is \n necessarily satisfied because of Step 2 of the algorithm. Assume that the property is true\n just after the exchange and for all the previous\n exchanges. There are two possibilities.\n \\begin{itemize}\n  \\item If the $pivot$ is not the same as in the previous Step 2, there is no weighted\n  values to its right since it is the greatest value after the previous pivot and it begins\n  at the starting position of the previous pivot or to its right. As there is no weighted values\n  to its right, after its exchange, the pivot is the first greater value on the left of the \n  rightmost weighted value.\n  \\item If the $pivot$ stays the same, the property also holds since after the exchange, with the notations\n  of Algorithm~\\ref{algoPhi1}, $u_k$ is smaller than or equal to each weighted value to its right since \n  the pivot swapped with all these weighted values. Moreover, each value between $u_i$ and $u_k$ is smaller than or equal to \n  $u_k$.\n  \\end{itemize}\n Those cases prove that the property is true after each exchange.\n\\end{proof}\n\nThe previous lemma shows that the map $\\phi_1$ is injective \nby proving that we can find the previous pivot and with which value it swapped\nat each step. We shall admit for now that decreasing weighted {subexcedent function} s are enumerated\nby $n!$ (which will be proved in the next section) which proves the following\nproposition:\n\n\\begin{proposition}\n\\label{propPhi1Bij}\n The map $\\phi_1$ is a bijection.\n\\end{proposition}\n\nNote that the reciprocal map comes straightforward from Lemma~\\ref{lemmaBij2And2}.\n\n\\subsubsection{The statistics through $\\phi_1$}\n\nLet us first define the new statistics on the decreasing weighted {subexcedent function} s.\n\n\\begin{definition}\n Let $(u,w)$ be a {{subexcedent function}} of size $n$.\n \\begin{itemize}\n  \\item The \\emph{number of inversions} ${\\rm inv}(u,w)$ is the sum of the values of $u$\n  and $w$.\n  \\item The \\emph{descent set} of $(u,w)$ is \n  \n", "itemtype": "equation", "pos": 19414, "prevtext": "\n  and \n  the \\emph{Genocchi composition of descent of type 0} as the composition of \n  $n$ whose descent set is ${\\operatorname{GDes}}^0(D,w)$.\n  \\item The \\emph{descent set of type 0} of $(D,w)$ is \n  \n", "index": 13, "text": "\\begin{equation}\n   {\\operatorname{Des}}^0(D,w) = \\{i~|~w_i > w_{i+1}\\} \\cup \\{ i~|~w_i = w_{i+1}, D_{2i+1} = / \\}\n  \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E6.m1\" class=\"ltx_Math\" alttext=\"{\\operatorname{Des}}^{0}(D,w)=\\{i~{}|~{}w_{i}&gt;w_{i+1}\\}\\cup\\{i~{}|~{}w_{i}=w_{%&#10;i+1},D_{2i+1}=/\\}\" display=\"block\"><mrow><mrow><msup><mo>Des</mo><mn>0</mn></msup><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>D</mi><mo>,</mo><mi>w</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mo stretchy=\"false\">{</mo><mrow><mpadded width=\"+3.3pt\"><mi>i</mi></mpadded><mo>\u2062</mo><mrow><mo fence=\"true\" rspace=\"5.8pt\" stretchy=\"false\">|</mo><msub><mi>w</mi><mi>i</mi></msub><mo>&gt;</mo></mrow><mo>\u2062</mo><msub><mi>w</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mo stretchy=\"false\">}</mo></mrow><mo>\u222a</mo><mrow><mo stretchy=\"false\">{</mo><mpadded width=\"+3.3pt\"><mi>i</mi></mpadded><mo rspace=\"5.8pt\" stretchy=\"false\">|</mo><mrow><mrow><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><msub><mi>w</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mo>,</mo><mrow><msub><mi>D</mi><mrow><mrow><mn>2</mn><mo>\u2062</mo><mi>i</mi></mrow><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mo>/</mo></mrow></mrow><mo stretchy=\"false\">}</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.02928.tex", "nexttext": "\n  and its \\emph{descent composition} ${\\operatorname{DC}}(u,w)$ is the composition of $n$ whose descent \n  set is $Des(u, w)$.\n  \\item The \\emph{statistic ${\\operatorname{LC}}$} on $(u,w)$ is the composition ${\\operatorname{LC}}(u)$.\n \\end{itemize}\n\\end{definition}\n\n\\begin{remark}\n\\label{remarkDecreasingLehmer}\n We shall make some remarks on the previous definitions.\n \\begin{enumerate}\n  \\item The previous definitions are still correct if the weighted {{subexcedent function}}\n  is not decreasing.\n  Moreover, if we associate a null weight with a {subexcedent function}, those\n  definitions give the same statistics than the usual ones on {subexcedent function} s.\n  \\item Note that on a decreasing {subexcedent function}, the mirror composition of the\n  statistic ${\\operatorname{LC}}$ exactly corresponds to the composition whose descent set is the set\n  of values of $u$. By defining the \\emph{total weight} statistic on the\n  decreasing weighted {{subexcedent function}} as the sum of the values of its weight, we\n  have directly ${\\rm tw}(u,w) = {\\rm inv}(u,w) - {\\rm maj}(\\overline{{\\operatorname{LC}}(u,w)})$.\n \\end{enumerate}\n\\end{remark}\n\n\\begin{lemma}\n\\label{lemmaStatsPhi1}\n Let $u$ be a {subexcedent function}, then:\n \\begin{itemize}\n  \\item ${\\rm tw}(\\phi_1(u)) = {\\rm inv}(u) - {\\rm maj}(\\overline{{\\operatorname{LC}}(u)})$;\n  \\item ${\\operatorname{DC}}(\\phi_1(u)) = {\\operatorname{DC}}(u)$;\n  \\item ${\\operatorname{LC}}(\\phi_1(u)) = {\\operatorname{LC}}(u)$.\n \\end{itemize}\n\\end{lemma}\n\nTo prove the last point of this lemma we shall consider the exchanges of\nAlgorithm~\\ref{algoPhi1} as a succession of elementary exchanges\ndescribed by the following algorithm where $i$ and $k$ come from the notations\nof Algorithm~\\ref{algoPhi1}.\n\n\\begin{algorithm}\n\\label{algoElementaryExchange}\n Set $j_1$ equal to $i$ and $j_2$\n equal to $k$.\n \\begin{itemize}\n  \\item Step 1: If $j_1 = k-1$, go to step 2. Increment $u_{j_1+1}$\n  and then swap $u_{j_1}$ and $u_{j_1+1}$. Set $j_1=j_1+1$ and \n  redo Step 1.\n  \\item Step 2: If $j_2 = i$, the algorithm stops. Decrement $u_{j_2-1}$ and\n  then swap $u_{j_2}$ and $u_{j_2-1}$. Set $j_2 = j_2 - 1$ and\n  redo Step 2.\n \\end{itemize}\n\\end{algorithm}\n\nFor example, if at some point of Algorithm~\\ref{algoPhi1}, we have $u=\\ldots4106\\ldots$\nand we have to exchange 6 with 4, the exchanges of Algorithm~\\ref{algoElementaryExchange}\nwould be:\n\\begin{itemize}\n \\item we begin with Step 1:\n \\begin{itemize}\n  \\item $u=\\ldots{\\bf \\textcolor{red}{24}}06\\ldots$;\n  \\item $u=\\ldots2{\\bf \\textcolor{red}{14}}6\\ldots$;\n \\end{itemize}\n \\item and then apply Step 2:\n \\begin{itemize}\n  \\item $u=\\ldots21{\\bf \\textcolor{red}{63}}\\ldots$;\n  \\item $u=\\ldots2{\\bf \\textcolor{red}{60}}3\\ldots$;\n  \\item $u=\\ldots{\\bf \\textcolor{red}{61}}03\\ldots$\n \\end{itemize}\n\\end{itemize}\n\n\n\\begin{proof}[of Lemma \\ref{lemmaStatsPhi1}]\n The proof of this lemma is based on the first point of Remark~\\ref{remarkDecreasingLehmer}\n and works by proving that the statistics ${\\rm inv}$, ${\\operatorname{DC}}$ and ${\\operatorname{LC}}$ do not change at\n each exchange of Algorithm~\\ref{algoPhi1}.\n \n The ${\\rm inv}$ statistic\n is not modified since each decrementation of a value of $u$ is balanced by\n a incrementation of a value of $w$.\n\nIn order to prove that the descent set of a weighted {{subexcedent function}} does not\nchange when we are doing an exchange of Algorithm~\\ref{algoPhi1}, we have\nto study different cases depending on whether there is a descent at positions\n$i-1$, $i$, $k-1$, and $k$ or not. Let $(u^{(1)},w^{(1)})$ be the weighted {{subexcedent function}}\nbefore the exchange and $(u^{(2)}, w^{(2)})$ the one after. For positions $k$\nand $i-1$, one proves that $(u^{(1)},w^{(1)})$ has a descent in those positions\nif and only if it is the case for $(u^{(2)}, w^{(2)})$. For the other positions\none has to pay attention whether $i = k-1$ or not to prove the same property for\nboth weighted {subexcedent function} s.\n\nTo prove that the statistic ${\\operatorname{LC}}$ does not change at each step we\nprove that it is also true after each elementary exchange of Algorithm~\\ref{algoElementaryExchange}.\nNote that in both steps of the algorithm, the {subexcedent function} s before and after\nthe exchange are two {subexcedent function} s $u^{(1)}$\nand $u^{(2)}$ which differ only at positions $j$ and $j+1$. Moreover, if\n$u^{(1)} = \\ldots ab\\ldots$ with $a>b$, $u^{(2)} = \\ldots b+1a\\ldots$,\nso we just have to prove that two such {subexcedent function} s satisfy\n${\\operatorname{LC}}(u^{(1)}) = {\\operatorname{LC}}(u^{(2)})$. To prove this property, one studies\ndifferent cases depending on whether $a$ and $b$ add a value or not \nduring the computation of ${\\operatorname{LC}}(u^{(1)})$.\n\\end{proof}\n\n\n\\subsection{Decreasing weighted {subexcedent function} s to weighted Dyck paths}\n\nLet us now describe the final bijection between decreasing weighted {subexcedent function} s \nand weighted Dyck paths. To describe it we construct a Dyck path from a \ndecreasing {{subexcedent function}} and carry the weight. Then we show that it sends \nthe triple of statistics of the decreasing weighted\n{subexcedent function} s to the triple of statistics of the weighted Dyck paths.\n\n\\subsubsection{Description of the bijection $\\phi_2$ between decreasing weighted {subexcedent function} s and weighted Dyck paths}\n\nThe map $\\phi_2$ on a decreasing weighted {{subexcedent function}} of size~$n$ is constructed by\ncarrying the weight and constructing the Dyck path $D$ from the decreasing {{subexcedent function}} $u$\nas follows.\n\\vspace{0.3cm}\n\\begin{algorithm}\n\\label{algoPhi2}\n Set $D_1 := /$ and $D_{2n} := \\backslash$. \n Then, for each $i$ in $\\{1, \\ldots, n-1\\}$,\n \\begin{itemize}\n  \\item set $D_{2i} := \\backslash$ if $n-i$\n  is a value in $u$ and $D_{2i} := /$ otherwise;\n  \\item set $D_{2i+1} := \\backslash$ if\n  $u_i = 0$ and $D_{2i+1} := /$ otherwise.\n \\end{itemize}\n\\end{algorithm}\n\nAn example is given Figure~\\ref{figPhi2}. The positions of\nthe zeroes in the {{subexcedent function}} are $\\{3,5,6,8,9\\}$ which correspond to the positions\n$i$ such that $D_{2i+1} = \\backslash$. The values correspond to $n-i$ where $i$\nare the positions where $D_{2i} = \\backslash$.\n\n\\begin{figure}[h!t]\n\\begin{center}\n\\begin{tikzpicture}[scale=0.5]\n \\begin{scope}[yshift=2.1cm]\n \\node (eq) at (0,0) {$\\phi_2(540300200, 002201000) = $};\n \\end{scope}\n\n \\begin{scope}[scale=0.7, xshift=6.6cm]\n  \\draw[dotted, thick, color=gray!60] (0, 0) grid (18, 6);\n  \\draw[rounded corners=1, color=black, line width=1] (0, 0) -- (1, 1) -- \n  (2, 2) -- (3, 3) -- (4, 4) -- (5, 5) -- (6, 6) -- (7, 5) -- (8, 4) -- (9, 5) \n  -- (10, 4) -- (11, 3) -- (12, 2) -- (13, 1) -- (14, 0) -- (15, 1) -- (16, 2) \n  -- (17, 1) -- (18, 0);\n\n  \\draw[dotted, very thick] (2, 0) -- (2, 6);\n  \\draw[dotted, very thick] (4, 0) -- (4, 6);\n  \\draw[dotted, very thick] (6, 0) -- (6, 6);\n  \\draw[dotted, very thick] (8, 0) -- (8, 6);\n  \\draw[dotted, very thick] (10, 0) -- (10, 6);\n  \\draw[dotted, very thick] (12, 0) -- (12, 6);\n  \\draw[dotted, very thick] (14, 0) -- (14, 6);\n  \\draw[dotted, very thick] (16, 0) -- (16, 6);\n  \n  \\node (pond1) at (5, 5.5) {2};\n  \\node (pond2) at (7, 5.5) {2};\n  \\node (pond2) at (11, 3.5) {1};\n \\end{scope}\n\\end{tikzpicture}\n\\caption{An example of $\\phi_2$.}\n\\label{figPhi2}\n\\end{center}\n\\end{figure}\n\n\\begin{lemma}\n\\label{lemmaDefPhi2}\n In the path $D$ constructed in Algorithm~\\ref{algoPhi2}, let $h_i$ be the \n height between $D_{2i-1}$ and $D_{2i}$. Then, for all $i$, we have $(h_i-1)/2$ equal\n to the number of values smaller than or equal to $n-i$ in $u$ to the left of $i$.\n\\end{lemma}\n\n\\begin{proof}\n We prove this lemma by induction. For $i=1$, we have $(h_1-1)/2 = 0$ and the \n property holds. Assume the property for a given $i$. To see that \n the property holds for $i+1$, one proves it by studying different cases depending\n on whether $u_{i+1}$ is equal to zero or not and $n-i-1$ is in $u$ or not. \n\\end{proof}\n\n\\begin{proposition}\n The map $\\phi_2$ is well-defined from decreasing weighted {subexcedent function} s to weighted\n Dyck paths and is a bijection.\n\\end{proposition}\n\n\\begin{proof}\n The image of a decreasing weighted {{subexcedent function}} is a path. Lemma~\\ref{lemmaDefPhi2}\n proves that the height of the path is always nonnegative and that $h_n = 1$.\n As $D_{2n} = \\backslash$, the path is a Dyck path. Lemma~\\ref{lemmaDefPhi2}\n also gives us that the constraints on the weight of a decreasing weighted {{subexcedent function}}\n correspond to the constraints of its image.\n \n As the constraints for the weights correspond exactly from one object to the \n other, we only need to prove that $\\phi_2$ is a bijection from\n decreasing {subexcedent function} s to Dyck paths to prove that $\\phi_2$ is a bijection on the\n weighted objects.\n \n As decreasing {subexcedent function} s and Dyck paths are both enumerated by the Catalan numbers,\n we only need\n to prove that this map is injective. The only way to have\n the same image from two decreasing {subexcedent function} s is that the nonzero values and their positions \n are fixed, but as the {subexcedent function} s are decreasing, there is no choice in\n the order of those values.\n\\end{proof}\n\nNote that by proving that $\\phi_2$ is a bijection we proved that decreasing \nweighted {subexcedent function} s are enumerated by $n!$ so it finishes the proof of \nProposition~\\ref{propPhi1Bij}.\n\n\\subsubsection{The statistics through $\\phi_2$}\n\n\\begin{lemma}\n\\label{lemmaStatsPhi2}\n Let $(u,w)$ be a decreasing weighted {{subexcedent function}}. We have\n \\begin{itemize}\n  \\item ${\\rm tw}(u,w) = {\\rm tw}(\\phi_2(u,w))$;\n  \\item ${\\operatorname{LC}}(u,w) = {\\operatorname{GC}}^0(\\phi_2(u,w))$;\n  \\item ${\\operatorname{DC}}(u,w) = {\\operatorname{DC}}(\\phi_2(u,w))$.\n \\end{itemize}\n\\end{lemma}\n\n\\begin{proof}\n As the weight is carried, we have ${\\rm tw}(u,w) = {\\rm tw}(\\phi_2(u,w))$. For the \n descent set, as the weight is carried and the positions of the zeroes in $u$\n correspond to the $\\backslash$ steps at odd positions in $D$, we also have \n ${\\operatorname{DC}}(u,w) = {\\operatorname{DC}}(\\phi_2(u,w))$. Moreover, ${\\operatorname{LC}}(u,w)$ is the mirror composition\n of the composition whose descent set is the nonzero values in $u$ and \n ${\\operatorname{GC}}^0(D,w)$ is related to the $\\backslash$ steps at even positions in $D$, so that we also\n have ${\\operatorname{LC}}(u,w) = {\\operatorname{GC}}^0(\\phi_2(u,w))$.\n\\end{proof}\n\\vspace{-0.1cm}\n\n\\section{Final result}\n\\label{sectionFinal}\n\n\\begin{theorem}\n Let $I$ and $J$ be two compositions of $n$, we have\n \n", "itemtype": "equation", "pos": 28822, "prevtext": "\n  and the \\emph{descent composition of type 0} (noted ${\\operatorname{DC}}^0(D,w)$) is the composition of\n  $n$ whose descent set is ${\\operatorname{Des}}^0(D,w)$.\n \\end{itemize}\n\\end{definition}\n\n\\begin{lemma}\n\\label{lemmaStatsInvol}\n Let $(D,w)$ be a weighted Dyck path, then\n \\begin{itemize}\n  \\item ${\\rm tw}(\\psi(D,w)) = {\\rm tw}(D,w)$;\n  \\item ${\\operatorname{GC}}^0(\\psi(D,w))= {\\operatorname{GC}}(D,w)$;\n  \\item ${\\operatorname{DC}}^0(\\psi(D,w)) = {\\operatorname{DC}}(D,w)$.\n \\end{itemize}\n\\end{lemma}\n\n\\begin{proof}\n As $\\psi$ does not change the weight of the Dyck path, the \n total weight is carried. For the other two statistics, one\n proves the claim by studying different cases depending on which\n steps are at positions $2i$ and $2i+1$.\n\\end{proof}\n\n\\section{Subexcedent functions to weighted Dyck paths}\n\\label{sectionSFToDyckPath}\nThe aim of this section is to build a bijection from {subexcedent function} s to\nweighted Dyck paths sending the triple \n$({\\operatorname{LC}}, {\\operatorname{DC}}, {\\rm inv}-{\\rm maj}(\\overline{{\\operatorname{LC}}}))$ on \n$({\\operatorname{GC}}^0, {\\operatorname{DC}}^0, {\\rm tw})$ where the statistic ${\\rm inv}-{\\rm maj}(\\overline{{\\operatorname{LC}}})$\ncorresponds to the statistic $\\alpha$ in the introduction. To do this, we construct a bijection\nfrom {subexcedent function} s to an intermediate object: \\emph{decreasing weighted {subexcedent function} s}\nwhich are represented by a Catalan object and a weight, and then construct a \nCatalan bijection between decreasing {subexcedent function} s and Dyck paths.\n\n\\subsection{Subexcedent functions to decreasing weighted {subexcedent function} s}\n\n\\begin{definition}\n\\label{defDecreasingLehmer}\n Let us define a \\emph{decreasing {{subexcedent function}}} of size $n$ and a \\emph{weight} for it.\n \\begin{itemize}\n  \\item A {{subexcedent function}} $u$ of size $n$ is \\emph{decreasing} if the word obtained by removing all \n  its zeroes is a strictly decreasing word.\n  \\item A \\emph{weight} of a decreasing {{subexcedent function}} is a word $w$ of size $n$ such \n  that for all $k \\in \\{1, \\ldots, n\\}$, $w_k$ is smaller than or equal to\n  the number of $i < k$ such that $0 < u_i < n-k$ ({\\emph{i.e.}}, the number of \n  positive values on the left of $k$ that could be at position $k$).\n \\end{itemize}\n\\end{definition}\n\nFor example, the {{subexcedent function}} $u = 540300200$ is decreasing. For the associated weight, we can \ndefine a maximum weight as the weight for which each value is maximum. The maximum weight\nof~$u$ is $012221000$ so the weight $002201000$ is acceptable whereas $000002000$\nis not.\n\nWe say that a value of a {{subexcedent function}} is weighted if the corresponding weight is nonzero.\n\n\\begin{remark}\n The decreasing {subexcedent function} s are indeed Catalan objects since one can build a bijection with nondecreasing \n parking functions, the\n nondecreasing words whose $i$-th value is smaller than or equal to $i$ and whose first value is\n equal to one. First, reverse the {{subexcedent function}}, add one to all values and then replace the $1$ values\n except the first one by their left neighboring value.\n\\end{remark}\n\n\\subsubsection{Description of the bijection $\\phi_1$ between {subexcedent function} s and decreasing weighted {subexcedent function} s}\n\nOur bijection $\\phi_1$ can be described as an algorithm sorting a {{subexcedent function}} by\nmoving successively the greatest value to its left.\n\n\\begin{algorithm}\n\\label{algoPhi1}\n Let $u$ be a {{subexcedent function}} of size $n$. Set weight $w$ to $0^n$.\n \\begin{itemize}\n  \\item Step 1: define the \\emph{pivot} as the greatest value in $u$ such that one of its\n  occurrences has\n  smaller or equal nonzero values to its left. If the pivot is not defined, the \n  algorithm stops. Otherwise, let $k$ be the position of the rightmost \n  occurrence of the pivot in $u$.\n  \\item Step 2: among the values smaller than or equal to the pivot on its left,\n  let $i$ be the position of the rightmost occurrence of the greatest one. Modify the \n  {{subexcedent function}} by decrementing $u_i$ and then swapping $u_i$ with \n  $u_k$. Modify the weight by incrementing $w_k$. Go back to Step 1.\n \\end{itemize}\n\\end{algorithm}\n\nLet us give an example with $u = 315503200$. Our algorithm follows the steps:\n\\begin{itemize}\n \\item $u = 315503200$, $P = 000000000$, then  $pivot = 5$, $k = 4$ and $i = 3$;\n \\item $u = 31{\\bf \\textcolor{red}{54}}03200$, $P = 000{\\bf \\textcolor{red}{1}}00000$, then $pivot = 5$, $k = 3$ and $i = 1$;\n \\item $u = {\\bf \\textcolor{red}{5}}1{\\bf \\textcolor{red}{2}}403200$, $P = 00{\\bf \\textcolor{red}{1}}100000$, then $pivot = 4$, $k = 4$ and $i = 3$;\n \\item $u = 51{\\bf \\textcolor{red}{41}}03200$, $P = 001{\\bf \\textcolor{red}{2}}00000$, then $pivot = 4$, $k = 3$ and $i = 2$;\n \\item $u = 5{\\bf \\textcolor{red}{40}}103200$, $P = 00{\\bf \\textcolor{red}{2}}200000$, then $pivot = 3$, $k = 6$ and $i = 4$;\n \\item $u = 540{\\bf \\textcolor{red}{3}}0{\\bf \\textcolor{red}{0}}200$, $P = 00220{\\bf \\textcolor{red}{1}}000$ and the algorithm stops.\n\\end{itemize}\nAt the end, $\\phi_1(315503200) = (540300200, 002201000)$.\n\n\\begin{proposition}\n The map $\\phi_1$ is well-defined from {subexcedent function} s to decreasing \n {subexcedent function} s.\n\\end{proposition}\n\n\\begin{proof}\n It is clear that $\\phi_1$ is well-defined for every {{subexcedent function}} $u$ and that\n the algorithm stops (for each pivot we have at most $n-1-pivot$ swaps).\n \n The result is decreasing in the sense of\n Definition~\\ref{defDecreasingLehmer} because the algorithm sorts the {subexcedent function}.\n \n To prove that the result is a decreasing weighted {subexcedent function}, we need to \n prove that the weight respects the constraints of \n Definition~\\ref{defDecreasingLehmer}. Each value at position $j$ in the weight was \n increased at\n most once per pivot that ended on its left which makes even fewer values than the \n number of values on the left of $j$ at the\n end of the algorithm. Moreover, it was increased only if the pivot was at position \n $j$, which is possible only if the pivot is smaller than or equal to $n-j$. Finally \n $w$ respects the constraints of the definition.\n\\end{proof}\n\n\\begin{lemma}\n\\label{lemmaBij2And2}\n Consider Step 2 in Algorithm~\\ref{algoPhi1}. After the exchange, we can find which values were\n swapped. \n \n The position of the pivot is the rightmost position such that there exists a strictly smaller\n weighted value to its right, {\\emph{i.e.}}, the rightmost position $i$ such that there exists $k > i$ with $w_k >0$\n and $u_i > u_k$.\n \n The pivot swapped with the nearest weighted value to its right.\n\\end{lemma}\n\n\\begin{proof}\n We start by proving the second part of the lemma.\n We prove by induction on each different\n pivot that, with the notations of Algorithm~\\ref{algoPhi1},\n for all $i <j <k$, we have $w_j=0$. For the first pivot there is no\n problem as there is no weighted value to its left.\n \n Assume the property is true when we change the value of the pivot. The \n weighted values are necessarily greater than or equal to the values on their\n left (up to the position where the previous pivot ended) so the new pivot\n must swap with all these weighted values. This ends the proof of this part of the lemma.\n\n We also prove the other part of the lemma by induction. After the first exchange, the property is \n necessarily satisfied because of Step 2 of the algorithm. Assume that the property is true\n just after the exchange and for all the previous\n exchanges. There are two possibilities.\n \\begin{itemize}\n  \\item If the $pivot$ is not the same as in the previous Step 2, there is no weighted\n  values to its right since it is the greatest value after the previous pivot and it begins\n  at the starting position of the previous pivot or to its right. As there is no weighted values\n  to its right, after its exchange, the pivot is the first greater value on the left of the \n  rightmost weighted value.\n  \\item If the $pivot$ stays the same, the property also holds since after the exchange, with the notations\n  of Algorithm~\\ref{algoPhi1}, $u_k$ is smaller than or equal to each weighted value to its right since \n  the pivot swapped with all these weighted values. Moreover, each value between $u_i$ and $u_k$ is smaller than or equal to \n  $u_k$.\n  \\end{itemize}\n Those cases prove that the property is true after each exchange.\n\\end{proof}\n\nThe previous lemma shows that the map $\\phi_1$ is injective \nby proving that we can find the previous pivot and with which value it swapped\nat each step. We shall admit for now that decreasing weighted {subexcedent function} s are enumerated\nby $n!$ (which will be proved in the next section) which proves the following\nproposition:\n\n\\begin{proposition}\n\\label{propPhi1Bij}\n The map $\\phi_1$ is a bijection.\n\\end{proposition}\n\nNote that the reciprocal map comes straightforward from Lemma~\\ref{lemmaBij2And2}.\n\n\\subsubsection{The statistics through $\\phi_1$}\n\nLet us first define the new statistics on the decreasing weighted {subexcedent function} s.\n\n\\begin{definition}\n Let $(u,w)$ be a {{subexcedent function}} of size $n$.\n \\begin{itemize}\n  \\item The \\emph{number of inversions} ${\\rm inv}(u,w)$ is the sum of the values of $u$\n  and $w$.\n  \\item The \\emph{descent set} of $(u,w)$ is \n  \n", "index": 15, "text": "\\begin{equation}\n   {\\operatorname{Des}}(u,w) = \\{i~|~w_i > w_{i+1} \\} \\cup \\{i~|~w_i = w_{i+1}, u_i > u_{i+1} \\}\n  \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E7.m1\" class=\"ltx_Math\" alttext=\"{\\operatorname{Des}}(u,w)=\\{i~{}|~{}w_{i}&gt;w_{i+1}\\}\\cup\\{i~{}|~{}w_{i}=w_{i+1}%&#10;,u_{i}&gt;u_{i+1}\\}\" display=\"block\"><mrow><mrow><mo>Des</mo><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>u</mi><mo>,</mo><mi>w</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mo stretchy=\"false\">{</mo><mrow><mpadded width=\"+3.3pt\"><mi>i</mi></mpadded><mo>\u2062</mo><mrow><mo fence=\"true\" rspace=\"5.8pt\" stretchy=\"false\">|</mo><msub><mi>w</mi><mi>i</mi></msub><mo>&gt;</mo></mrow><mo>\u2062</mo><msub><mi>w</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mo stretchy=\"false\">}</mo></mrow><mo>\u222a</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mpadded width=\"+3.3pt\"><mi>i</mi></mpadded><mo>\u2062</mo><mrow><mo fence=\"true\" rspace=\"5.8pt\" stretchy=\"false\">|</mo><mrow><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><mrow><msub><mi>w</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>u</mi><mi>i</mi></msub></mrow></mrow><mo>&gt;</mo></mrow><mo>\u2062</mo><msub><mi>u</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mo stretchy=\"false\">}</mo></mrow></mrow></mrow></math>", "type": "latex"}, {"file": "1601.02928.tex", "nexttext": "\n\\end{theorem}\n\\vspace{-0.1cm}\n\\begin{proof}\n To prove this theorem we apply successively the bijections defined in the \n previous sections to construct a permutation from a {{subexcedent function}} and we conclude\n by applying Lemmas~\\ref{lemmaStatsPhi1}, \\ref{lemmaStatsPhi2}, \n \\ref{lemmaStatsInvol}, and \\ref{lemmaStatsFV} to prove the statistics\n correspondence.\n\\end{proof}\n\n\\begin{remark}\n This theorem proves Conjecture 6.2 of~\\cite{NTW}. The other\n conjectures are directly obtained from this one.\n\\end{remark}\n\n\n\\begin{proposition}\n Define the \\emph{left to right maximums} of a permutation\n as the values with only smaller values to their left. In addition\n to carry the recoil composition of a permutation, the global bijection\n on permutations carries also the left to right maximums.\n\\end{proposition}\n\nOne proves this proposition by studying the statistic of left to right maximums\nthrough the bijections.\n\n\n\n\n\n\n\n\\footnotesize\n\n\\begin{thebibliography}{aa}\n\n\\bibitem{Cor}{\\sc S. Corteel}, {\\it Crossings and alignments of permutations}, \nAdv. in App. Math. {\\bf 38(2)} (2007), 149--163.\n\n\\bibitem{CW}{\\sc S. Corteel} and {\\sc L. Williams},\n{\\it Tableaux combinatorics for the asymmetric exclusion process},\nAdv. Appl. Math. {\\bf 39} (2007), 293--310.\n\n\\bibitem{FV}{\\sc J. Fran\\c con} and {\\sc X. G. Viennot}, {\\it Permutations selon leurs pics, creux, doubles\nmont\\'ees et double descentes, nombres d'Euler et nombres de Genocchi},\nDisc. Math. {\\bf 28(1)} (1979), 21--35.\n\n\\bibitem{NCSF1}{\\sc I. M. Gelfand, D. Krob, A. Lascoux, B. Leclerc,\nV.~S. Retakh}, and {\\sc J.-Y. Thibon},\n{\\it Noncommutative symmetric functions},\nAdv. in Math. {\\bf 112} (1995), 218--348.\n\n\\bibitem{HNTT}{\\sc  F. Hivert, J.-C. Novelli, L. Tevlin}  and {\\sc J.-Y.\nThibon}, {\\it Permutation statistics related to a class of noncommutative\nsymmetric functions and generalizations of the Genocchi numbers},\nSel. math., New ser. {\\bf 15} (2009), 105--119.\n\n\\bibitem{NTW} {\\sc J.-C. Novelli, J.-Y. Thibon} and {\\sc L. Williams},\n{\\it Combinatorial Hopf Algebras, Noncommutative Hall-Littlewood Functions,\nAnd Permutation tableaux},\nAdv. Math. {\\bf 224} (2010) 1311--1348.\n\n\\bibitem{Tev} {\\sc L. Tevlin},\n{\\it Noncommutative monomial symmetric functions},\nProc. FPSAC'07, Tianjin, China.\n\n\\end{thebibliography}\n\n\n\n", "itemtype": "equation", "pos": 39506, "prevtext": "\n  and its \\emph{descent composition} ${\\operatorname{DC}}(u,w)$ is the composition of $n$ whose descent \n  set is $Des(u, w)$.\n  \\item The \\emph{statistic ${\\operatorname{LC}}$} on $(u,w)$ is the composition ${\\operatorname{LC}}(u)$.\n \\end{itemize}\n\\end{definition}\n\n\\begin{remark}\n\\label{remarkDecreasingLehmer}\n We shall make some remarks on the previous definitions.\n \\begin{enumerate}\n  \\item The previous definitions are still correct if the weighted {{subexcedent function}}\n  is not decreasing.\n  Moreover, if we associate a null weight with a {subexcedent function}, those\n  definitions give the same statistics than the usual ones on {subexcedent function} s.\n  \\item Note that on a decreasing {subexcedent function}, the mirror composition of the\n  statistic ${\\operatorname{LC}}$ exactly corresponds to the composition whose descent set is the set\n  of values of $u$. By defining the \\emph{total weight} statistic on the\n  decreasing weighted {{subexcedent function}} as the sum of the values of its weight, we\n  have directly ${\\rm tw}(u,w) = {\\rm inv}(u,w) - {\\rm maj}(\\overline{{\\operatorname{LC}}(u,w)})$.\n \\end{enumerate}\n\\end{remark}\n\n\\begin{lemma}\n\\label{lemmaStatsPhi1}\n Let $u$ be a {subexcedent function}, then:\n \\begin{itemize}\n  \\item ${\\rm tw}(\\phi_1(u)) = {\\rm inv}(u) - {\\rm maj}(\\overline{{\\operatorname{LC}}(u)})$;\n  \\item ${\\operatorname{DC}}(\\phi_1(u)) = {\\operatorname{DC}}(u)$;\n  \\item ${\\operatorname{LC}}(\\phi_1(u)) = {\\operatorname{LC}}(u)$.\n \\end{itemize}\n\\end{lemma}\n\nTo prove the last point of this lemma we shall consider the exchanges of\nAlgorithm~\\ref{algoPhi1} as a succession of elementary exchanges\ndescribed by the following algorithm where $i$ and $k$ come from the notations\nof Algorithm~\\ref{algoPhi1}.\n\n\\begin{algorithm}\n\\label{algoElementaryExchange}\n Set $j_1$ equal to $i$ and $j_2$\n equal to $k$.\n \\begin{itemize}\n  \\item Step 1: If $j_1 = k-1$, go to step 2. Increment $u_{j_1+1}$\n  and then swap $u_{j_1}$ and $u_{j_1+1}$. Set $j_1=j_1+1$ and \n  redo Step 1.\n  \\item Step 2: If $j_2 = i$, the algorithm stops. Decrement $u_{j_2-1}$ and\n  then swap $u_{j_2}$ and $u_{j_2-1}$. Set $j_2 = j_2 - 1$ and\n  redo Step 2.\n \\end{itemize}\n\\end{algorithm}\n\nFor example, if at some point of Algorithm~\\ref{algoPhi1}, we have $u=\\ldots4106\\ldots$\nand we have to exchange 6 with 4, the exchanges of Algorithm~\\ref{algoElementaryExchange}\nwould be:\n\\begin{itemize}\n \\item we begin with Step 1:\n \\begin{itemize}\n  \\item $u=\\ldots{\\bf \\textcolor{red}{24}}06\\ldots$;\n  \\item $u=\\ldots2{\\bf \\textcolor{red}{14}}6\\ldots$;\n \\end{itemize}\n \\item and then apply Step 2:\n \\begin{itemize}\n  \\item $u=\\ldots21{\\bf \\textcolor{red}{63}}\\ldots$;\n  \\item $u=\\ldots2{\\bf \\textcolor{red}{60}}3\\ldots$;\n  \\item $u=\\ldots{\\bf \\textcolor{red}{61}}03\\ldots$\n \\end{itemize}\n\\end{itemize}\n\n\n\\begin{proof}[of Lemma \\ref{lemmaStatsPhi1}]\n The proof of this lemma is based on the first point of Remark~\\ref{remarkDecreasingLehmer}\n and works by proving that the statistics ${\\rm inv}$, ${\\operatorname{DC}}$ and ${\\operatorname{LC}}$ do not change at\n each exchange of Algorithm~\\ref{algoPhi1}.\n \n The ${\\rm inv}$ statistic\n is not modified since each decrementation of a value of $u$ is balanced by\n a incrementation of a value of $w$.\n\nIn order to prove that the descent set of a weighted {{subexcedent function}} does not\nchange when we are doing an exchange of Algorithm~\\ref{algoPhi1}, we have\nto study different cases depending on whether there is a descent at positions\n$i-1$, $i$, $k-1$, and $k$ or not. Let $(u^{(1)},w^{(1)})$ be the weighted {{subexcedent function}}\nbefore the exchange and $(u^{(2)}, w^{(2)})$ the one after. For positions $k$\nand $i-1$, one proves that $(u^{(1)},w^{(1)})$ has a descent in those positions\nif and only if it is the case for $(u^{(2)}, w^{(2)})$. For the other positions\none has to pay attention whether $i = k-1$ or not to prove the same property for\nboth weighted {subexcedent function} s.\n\nTo prove that the statistic ${\\operatorname{LC}}$ does not change at each step we\nprove that it is also true after each elementary exchange of Algorithm~\\ref{algoElementaryExchange}.\nNote that in both steps of the algorithm, the {subexcedent function} s before and after\nthe exchange are two {subexcedent function} s $u^{(1)}$\nand $u^{(2)}$ which differ only at positions $j$ and $j+1$. Moreover, if\n$u^{(1)} = \\ldots ab\\ldots$ with $a>b$, $u^{(2)} = \\ldots b+1a\\ldots$,\nso we just have to prove that two such {subexcedent function} s satisfy\n${\\operatorname{LC}}(u^{(1)}) = {\\operatorname{LC}}(u^{(2)})$. To prove this property, one studies\ndifferent cases depending on whether $a$ and $b$ add a value or not \nduring the computation of ${\\operatorname{LC}}(u^{(1)})$.\n\\end{proof}\n\n\n\\subsection{Decreasing weighted {subexcedent function} s to weighted Dyck paths}\n\nLet us now describe the final bijection between decreasing weighted {subexcedent function} s \nand weighted Dyck paths. To describe it we construct a Dyck path from a \ndecreasing {{subexcedent function}} and carry the weight. Then we show that it sends \nthe triple of statistics of the decreasing weighted\n{subexcedent function} s to the triple of statistics of the weighted Dyck paths.\n\n\\subsubsection{Description of the bijection $\\phi_2$ between decreasing weighted {subexcedent function} s and weighted Dyck paths}\n\nThe map $\\phi_2$ on a decreasing weighted {{subexcedent function}} of size~$n$ is constructed by\ncarrying the weight and constructing the Dyck path $D$ from the decreasing {{subexcedent function}} $u$\nas follows.\n\\vspace{0.3cm}\n\\begin{algorithm}\n\\label{algoPhi2}\n Set $D_1 := /$ and $D_{2n} := \\backslash$. \n Then, for each $i$ in $\\{1, \\ldots, n-1\\}$,\n \\begin{itemize}\n  \\item set $D_{2i} := \\backslash$ if $n-i$\n  is a value in $u$ and $D_{2i} := /$ otherwise;\n  \\item set $D_{2i+1} := \\backslash$ if\n  $u_i = 0$ and $D_{2i+1} := /$ otherwise.\n \\end{itemize}\n\\end{algorithm}\n\nAn example is given Figure~\\ref{figPhi2}. The positions of\nthe zeroes in the {{subexcedent function}} are $\\{3,5,6,8,9\\}$ which correspond to the positions\n$i$ such that $D_{2i+1} = \\backslash$. The values correspond to $n-i$ where $i$\nare the positions where $D_{2i} = \\backslash$.\n\n\\begin{figure}[h!t]\n\\begin{center}\n\\begin{tikzpicture}[scale=0.5]\n \\begin{scope}[yshift=2.1cm]\n \\node (eq) at (0,0) {$\\phi_2(540300200, 002201000) = $};\n \\end{scope}\n\n \\begin{scope}[scale=0.7, xshift=6.6cm]\n  \\draw[dotted, thick, color=gray!60] (0, 0) grid (18, 6);\n  \\draw[rounded corners=1, color=black, line width=1] (0, 0) -- (1, 1) -- \n  (2, 2) -- (3, 3) -- (4, 4) -- (5, 5) -- (6, 6) -- (7, 5) -- (8, 4) -- (9, 5) \n  -- (10, 4) -- (11, 3) -- (12, 2) -- (13, 1) -- (14, 0) -- (15, 1) -- (16, 2) \n  -- (17, 1) -- (18, 0);\n\n  \\draw[dotted, very thick] (2, 0) -- (2, 6);\n  \\draw[dotted, very thick] (4, 0) -- (4, 6);\n  \\draw[dotted, very thick] (6, 0) -- (6, 6);\n  \\draw[dotted, very thick] (8, 0) -- (8, 6);\n  \\draw[dotted, very thick] (10, 0) -- (10, 6);\n  \\draw[dotted, very thick] (12, 0) -- (12, 6);\n  \\draw[dotted, very thick] (14, 0) -- (14, 6);\n  \\draw[dotted, very thick] (16, 0) -- (16, 6);\n  \n  \\node (pond1) at (5, 5.5) {2};\n  \\node (pond2) at (7, 5.5) {2};\n  \\node (pond2) at (11, 3.5) {1};\n \\end{scope}\n\\end{tikzpicture}\n\\caption{An example of $\\phi_2$.}\n\\label{figPhi2}\n\\end{center}\n\\end{figure}\n\n\\begin{lemma}\n\\label{lemmaDefPhi2}\n In the path $D$ constructed in Algorithm~\\ref{algoPhi2}, let $h_i$ be the \n height between $D_{2i-1}$ and $D_{2i}$. Then, for all $i$, we have $(h_i-1)/2$ equal\n to the number of values smaller than or equal to $n-i$ in $u$ to the left of $i$.\n\\end{lemma}\n\n\\begin{proof}\n We prove this lemma by induction. For $i=1$, we have $(h_1-1)/2 = 0$ and the \n property holds. Assume the property for a given $i$. To see that \n the property holds for $i+1$, one proves it by studying different cases depending\n on whether $u_{i+1}$ is equal to zero or not and $n-i-1$ is in $u$ or not. \n\\end{proof}\n\n\\begin{proposition}\n The map $\\phi_2$ is well-defined from decreasing weighted {subexcedent function} s to weighted\n Dyck paths and is a bijection.\n\\end{proposition}\n\n\\begin{proof}\n The image of a decreasing weighted {{subexcedent function}} is a path. Lemma~\\ref{lemmaDefPhi2}\n proves that the height of the path is always nonnegative and that $h_n = 1$.\n As $D_{2n} = \\backslash$, the path is a Dyck path. Lemma~\\ref{lemmaDefPhi2}\n also gives us that the constraints on the weight of a decreasing weighted {{subexcedent function}}\n correspond to the constraints of its image.\n \n As the constraints for the weights correspond exactly from one object to the \n other, we only need to prove that $\\phi_2$ is a bijection from\n decreasing {subexcedent function} s to Dyck paths to prove that $\\phi_2$ is a bijection on the\n weighted objects.\n \n As decreasing {subexcedent function} s and Dyck paths are both enumerated by the Catalan numbers,\n we only need\n to prove that this map is injective. The only way to have\n the same image from two decreasing {subexcedent function} s is that the nonzero values and their positions \n are fixed, but as the {subexcedent function} s are decreasing, there is no choice in\n the order of those values.\n\\end{proof}\n\nNote that by proving that $\\phi_2$ is a bijection we proved that decreasing \nweighted {subexcedent function} s are enumerated by $n!$ so it finishes the proof of \nProposition~\\ref{propPhi1Bij}.\n\n\\subsubsection{The statistics through $\\phi_2$}\n\n\\begin{lemma}\n\\label{lemmaStatsPhi2}\n Let $(u,w)$ be a decreasing weighted {{subexcedent function}}. We have\n \\begin{itemize}\n  \\item ${\\rm tw}(u,w) = {\\rm tw}(\\phi_2(u,w))$;\n  \\item ${\\operatorname{LC}}(u,w) = {\\operatorname{GC}}^0(\\phi_2(u,w))$;\n  \\item ${\\operatorname{DC}}(u,w) = {\\operatorname{DC}}(\\phi_2(u,w))$.\n \\end{itemize}\n\\end{lemma}\n\n\\begin{proof}\n As the weight is carried, we have ${\\rm tw}(u,w) = {\\rm tw}(\\phi_2(u,w))$. For the \n descent set, as the weight is carried and the positions of the zeroes in $u$\n correspond to the $\\backslash$ steps at odd positions in $D$, we also have \n ${\\operatorname{DC}}(u,w) = {\\operatorname{DC}}(\\phi_2(u,w))$. Moreover, ${\\operatorname{LC}}(u,w)$ is the mirror composition\n of the composition whose descent set is the nonzero values in $u$ and \n ${\\operatorname{GC}}^0(D,w)$ is related to the $\\backslash$ steps at even positions in $D$, so that we also\n have ${\\operatorname{LC}}(u,w) = {\\operatorname{GC}}^0(\\phi_2(u,w))$.\n\\end{proof}\n\\vspace{-0.1cm}\n\n\\section{Final result}\n\\label{sectionFinal}\n\n\\begin{theorem}\n Let $I$ and $J$ be two compositions of $n$, we have\n \n", "index": 17, "text": "\\begin{equation}\n  \\sum_{\\substack{u \\in {\\mathfrak{SF}}_n \\\\ {\\operatorname{DC}}(u) = I \\\\ {\\operatorname{LC}}(u) = J}} q^{{\\rm inv}(u)- {\\rm maj}(\\overline{J})} =\n  \\sum_{\\substack{\\sigma \\in {\\mathfrak S}_n \\\\ {\\operatorname{Rec}}(\\sigma) = I \\\\ {\\operatorname{GC}}(\\sigma) = J}} q^{{\\rm tot}(\\sigma)}.\n \\end{equation}\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.E8.m1\" class=\"ltx_Math\" alttext=\"\\sum_{\\begin{subarray}{c}u\\in{\\mathfrak{SF}}_{n}\\\\&#10;{\\operatorname{DC}}(u)=I\\\\&#10;{\\operatorname{LC}}(u)=J\\end{subarray}}q^{{\\rm inv}(u)-{\\rm maj}(\\overline{J})%&#10;}=\\sum_{\\begin{subarray}{c}\\sigma\\in{\\mathfrak{S}}_{n}\\\\&#10;{\\operatorname{Rec}}(\\sigma)=I\\\\&#10;{\\operatorname{GC}}(\\sigma)=J\\end{subarray}}q^{{\\rm tot}(\\sigma)}.\" display=\"block\"><mrow><mrow><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mtable class=\"ltx_align_c\" rowspacing=\"0.0pt\"><mtr><mtd><mrow><mi>u</mi><mo>\u2208</mo><mrow><mi>\ud835\udd16</mi><mo>\u2062</mo><msub><mi>\ud835\udd09</mi><mi>n</mi></msub></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mo>DC</mo><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>u</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mi>I</mi></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mo>LC</mo><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>u</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mi>J</mi></mrow></mtd></mtr></mtable></munder><msup><mi>q</mi><mrow><mrow><mi>inv</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>u</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>-</mo><mrow><mi>maj</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mi>J</mi><mo>\u00af</mo></mover><mo stretchy=\"false\">)</mo></mrow></mrow></mrow></msup></mrow><mo>=</mo><mrow><munder><mo largeop=\"true\" movablelimits=\"false\" symmetric=\"true\">\u2211</mo><mtable class=\"ltx_align_c\" rowspacing=\"0.0pt\"><mtr><mtd><mrow><mi>\u03c3</mi><mo>\u2208</mo><msub><mi>\ud835\udd16</mi><mi>n</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mo>Rec</mo><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c3</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mi>I</mi></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mo>GC</mo><mo>\u2061</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c3</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mi>J</mi></mrow></mtd></mtr></mtable></munder><msup><mi>q</mi><mrow><mi>tot</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>\u03c3</mi><mo stretchy=\"false\">)</mo></mrow></mrow></msup></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}]