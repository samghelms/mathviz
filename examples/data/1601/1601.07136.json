[{"file": "1601.07136.tex", "nexttext": "\n\\end{lemma}\n\n\\begin{lemma}[{\\cite[Lemma 3]{heitmann93}}]\n\\label{avoidance}\nLet $(T,{\\mathfrak{m}})$ be a local ring and let $D\\subset T$.  Suppose $C\\subset{\\operatorname{Spec}} T$ and ${\\mathfrak{a}}$ is an ideal of $T$ such that ${\\mathfrak{a}}\\not\\subseteq{\\mathfrak{p}}$ for all ${\\mathfrak{p}}\\in C$.  If $|C\\times D|<|T/{\\mathfrak{m}}|$, then \n", "itemtype": "equation", "pos": 12507, "prevtext": "\n\\title{Controlling the Dimensions of Formal Fibers of a Unique Factorization Domain at the Height One Prime Ideals \\thanks{The authors thank the National Science Foundation for their support of this research via grant DMS-1347804.} \\thanks{Sarah M. Fleming and Nina Pande thank the Clare Boothe Luce Foundation for support of their research.}}\n\\author{Sarah M. Fleming, Lena Ji, S. Loepp, Peter M. McDonald, Nina Pande, and David Schwein}\n\n\\maketitle\n\n\\begin{abstract}\nLet $T$ be a complete local (Noetherian) equidimensional ring with maximal ideal ${\\mathfrak{m}}$ such that the Krull dimension of $T$ is at least two and the depth of $T$ is at least two.  Suppose that no integer of $T$ is a zerodivisor and that $|T|=|T/{\\mathfrak{m}}|$.  Let $d$ and $t$ be integers such that $1\\leq d \\leq  \\dim T-1$, $0 \\leq t \\leq \\dim T - 1$, and $d - 1 \\leq t$.  Assume that, for every ${\\mathfrak{p}}\\in{\\operatorname{Ass}} T$, ${\\operatorname{ht}}{\\mathfrak{p}}\\leq d-1$ and that if $z$ is a regular element of $T$ and $Q \\in {\\operatorname{Ass}}(T/zT)$, then ${\\operatorname{ht}} Q \\leq d$.  \n\nWe construct a local unique factorization domain $A$ such that the completion of $A$ is $T$ and such that the dimension of the formal fiber ring at every height one prime ideal of $A$ is $d - 1$ and the dimension of the formal fiber ring of $A$ at $(0)$ is $t$.\n\n\\end{abstract}\n\n\\section{Introduction}\n\nLet $A$ be a local (Noetherian) ring and let $T$ be the completion of $A$ with respect to its maximal ideal.  One fruitful way to study the relationship between $A$ and $T$ is to examine the relationship between ${\\operatorname{Spec}} A$ and ${\\operatorname{Spec}} T$, which we can do by looking at the formal fibers of $A$ at its prime ideals.  We define the formal fiber ring of $A$ at ${\\mathfrak{p}}\\in{\\operatorname{Spec}} A$ as $T\\otimes_A\\kappa({\\mathfrak{p}})$, and we define the formal fiber of $A$ at ${\\mathfrak{p}}$ as ${\\operatorname{Spec}}(T\\otimes_A\\kappa({\\mathfrak{p}}))$ where $\\kappa({\\mathfrak{p}})$ is the residue field $A_{{\\mathfrak{p}}}/{\\mathfrak{p}} A_{{\\mathfrak{p}}}$. There is a one-to-one correspondence between elements of the formal fiber of $A$ at ${\\mathfrak{p}}$ and the elements of the inverse image of ${\\mathfrak{p}}$ under the mapping $\\varphi : {\\operatorname{Spec}} T\\rightarrow{\\operatorname{Spec}} A$ defined by $\\varphi({\\mathfrak{q}})={\\mathfrak{q}}\\cap A$.  Because of this correspondence, the formal fibers of $A$ encode information about the relationship between the prime ideals of $T$ and the prime ideals of $A$.  Note that, since $T$ is a faithfully flat extension of $A$, the map $\\varphi$ is surjective.  Using Matsumura's notation in~\\cite{matsumura88}, we denote the Krull dimension of the formal fiber ring of $A$ at the prime ideal ${\\mathfrak{p}}$ by $\\alpha(A,{\\mathfrak{p}})$.  The supremum of $\\alpha(A,{\\mathfrak{p}})$ over all prime ideals ${\\mathfrak{p}}$ of $A$ is denoted by $\\alpha(A)$.  When $A$ is an integral domain, we refer to the formal fiber ring of $A$ at the prime ideal $(0)$ as the generic formal fiber ring, and the formal fiber of $A$ at $(0)$ as the generic formal fiber.\n\nMatsumura proved in~\\cite{matsumura88} that, given two elements ${\\mathfrak{p}},{\\mathfrak{p}}'\\in{\\operatorname{Spec}} A$, if ${\\mathfrak{p}}\\subseteq{\\mathfrak{p}}'$, then $\\alpha(A,{\\mathfrak{p}})\\geq\\alpha(A,{\\mathfrak{p}}')$.  Additionally, he proved that, given a ring of positive dimension $n$, the maximum possible value of $\\alpha(A)$ is $n-1$.  Furthermore, if $A$ is a ring of essentially finite type over a field, Matsumura showed that $\\alpha(A) = n - 1$ and that $\\alpha(A,{\\mathfrak{p}})=n-1-{\\operatorname{ht}}{\\mathfrak{p}}$.  In other words, for rings of essentially finite type over a field, the dimensions of the formal fiber rings are completely understood.  However, for a general ring, not much is known about how the inequality $\\alpha(A,{\\mathfrak{p}})\\geq\\alpha(A,{\\mathfrak{p}}')$ behaves when varying the heights of ${\\mathfrak{p}}$ and ${\\mathfrak{p}}'$.  We are interested specifically in what happens when $A$ is an integral domain, ${\\mathfrak{p}}=(0)$, and ${\\mathfrak{p}}'$ is a height one prime ideal of $A$.  In particular, Heinzer, Rotthaus, and Sally informally posed the following question:\n\n\\begin{question}\nLet A be an excellent local ring with $\\alpha(A)>0$, and let $\\Delta$ be the set $\\{{\\mathfrak{p}}\\in{\\operatorname{Spec}} A\\mid{\\operatorname{ht}}{\\mathfrak{p}}=1\\text{ and }\\alpha(A,{\\mathfrak{p}}) = \\alpha(A)\\}$.\nIs $\\Delta$ a finite set?\n\\end{question}\n\n\\noindent We first note that if $A$ is a Noetherian integral domain, then $\\alpha{(A)} = \\alpha(A,(0))$.  Given Matsumura's results, one might expect that, for an integral domain $A$, the dimension of the formal fiber ring of $A$ at ``most\" height one prime ideals is strictly less than the dimension of the formal fiber ring of $A$ at the zero ideal.  In other words, one might expect that the set $\\Delta$ is ``small,\" so the above question is a very natural one to ask.\n\nIn~\\cite{boocher10}, Adam Boocher, Michael Daub, and S. Loepp showed that the set $\\Delta$ need not be finite by constructing an excellent local unique factorization domain $A$ for which $\\Delta$ is countably infinite.  However, the UFD that they construct has uncountably many height one prime ideals, so the set $\\Delta$ for their ring is ``small\" in the sense that it does not contain ``most\" of the height one prime ideals of $A$.  Based on this result, one might think it unlikely that there exists a ring such that $\\Delta$ is an uncountable set and even less likely that a ring exists such that $\\Delta$ contains {\\em all} of its height one prime ideals.  In this paper, we construct a non-excellent unique factorization domain $A$ for which this property holds; that is, every height one prime ideal of $A$ is in $\\Delta$.  In fact, we generalize the result so that if $d$ and $t$ are integers such that $1 \\leq d \\leq \\dim T - 1$, $0 \\leq t \\leq \\dim T - 1$, and $d - 1 \\leq t$, then our $A$ satisfies the property that every height one prime ideal ${\\mathfrak{p}}$ of $A$ has a formal fiber ring of dimension $d - 1$ and the generic formal fiber ring of $A$ has dimension $t$.  In other words, we show that the relationship between the dimensions of the formal fiber rings of a ring at its height one prime ideals and the dimension of the generic formal fiber ring of the ring is restricted only by the inequality given by Matsumura.  That is, if ${\\mathfrak{p}}$ is a height one prime ideal of a ring $A$, then $\\alpha (A,{\\mathfrak{p}}) \\leq \\alpha (A,(0))$, but\nfor any nonnegative integer less than or equal to the dimension of the generic formal fiber ring,\nthere exists a ring such that the dimension of the formal fiber rings at each height one prime ideals is equal to this integer.\n\nOur main result is given by Theorem~\\ref{bigthm}.  Let $T$ be a complete local equidimensional ring with maximal ideal ${\\mathfrak{m}}$, and suppose that the Krull dimension of $T$ is at least two.  Also suppose that $|T|=|T/{\\mathfrak{m}}|$, no integer is a zerodivisor in $T$, and $T$ has depth greater than one. Let $d$ and $t$ be integers with $1\\leq d\\leq\\dim T-1$, $0 \\leq t \\leq \\dim T - 1$, and $d - 1 \\leq t$.  Suppose that ${\\operatorname{ht}}{\\mathfrak{p}}\\leq d-1$ for every ${\\mathfrak{p}}\\in{\\operatorname{Ass}} T$ and that if $z$ is a regular element of $T$ and $Q \\in {\\operatorname{Ass}}(T/zT)$, then ${\\operatorname{ht}} Q \\leq d$.  We show that there exists a local unique factorization domain $A$ whose completion is $T$ such that $\\alpha(A,(0))=t$ and, for every ${\\mathfrak{p}}\\in{\\operatorname{Spec}} A$ with ${\\operatorname{ht}}{\\mathfrak{p}}=1$, $\\alpha(A,{\\mathfrak{p}})= d - 1$.  \nThat is to say, with relatively weak conditions on $T$, we can find a local UFD $A$ where the dimensions of the formal fiber rings of $A$ at all height one prime ideals are equal.  Moreover, we can control the dimension of the generic formal fiber ring of $A$, and the dimension of the formal fiber rings of $A$ at its height one prime ideals can be any nonnegative integer less than or equal to the dimension of the generic formal fiber ring of $A$.\nIn particular, if we set $d - 1 = t$, then we can find a UFD $A$ such that $\\Delta$ is the set of {\\em all} height one prime ideals of $A$, which, in our case, will be an uncountable set.  Furthermore, in this case, we have the ability to set the dimension of the formal fiber rings at our height one prime ideals and the generic formal fiber ring to be any integer value between $0$ and $\\dim T-2$.\n\nIn ~\\cite{heitmann93}, Heitmann found necessary and sufficient conditions for a complete local ring to be the completion of a unique factorization domain.  For our ring $A$ to exist, then, our ring $T$ must satisfy those conditions.  In particular, this means that $T$ must have depth greater than one and satisfy the condition that no integer of $T$ is a zerodivisor.  We impose the additional condition that $\\dim T\\geq2$ to avoid any trivial examples. The remaining conditions we put on $T$ are relatively weak.  We base our construction on the one employed by Heitmann in~\\cite{heitmann93}, modifying and adding lemmas so that we can control the dimensions of the formal fiber rings of $A$ at $(0)$ and at the height one prime ideals.  \n\nWe employ Lemma~\\ref{comp}, which gives necessary and sufficient conditions for a quasi-local subring of a complete local ring $T$ to be Noetherian and have completion $T$.  In particular, if $T$ is a complete local ring with maximal ideal ${\\mathfrak{m}}$ and $A$ is a quasi-local subring of $T$ with maximal ideal ${\\mathfrak{m}} \\cap A$, then $A$ is Noetherian and has completion isomorphic to $T$ if the map $A\\rightarrow T\\slash{\\mathfrak{m}}^2$ is onto and every finitely generated ideal ${\\mathfrak{a}}$ of $A$ is closed; that is, ${\\mathfrak{a}} T\\cap A={\\mathfrak{a}}$.  To ensure that our subring $A$ satisfies these conditions and has the desired formal fibers, we construct a strictly ascending chain of subrings of $T$ starting with a localization of the prime subring of $T$.  We then adjoin elements in of $T$ in succession to make the above map onto, to close up finitely generated ideals, and to manipulate the dimensions of the formal fiber rings.  We argue that the union of the subrings in this chain is our desired local UFD $A$.\n\nIn this paper, all rings are commutative with unity.  We define a quasi-local ring as any ring with exactly one maximal ideal and a local ring as a quasi-local Noetherian ring.  We use $(T,{\\mathfrak{m}})$ to refer to a local ring $T$ with maximal ideal ${\\mathfrak{m}}$ and ${\\operatorname{Spec}}_k T$ to refer to the set of prime ideals of $T$ of height $k$.  $\\widehat{T}$ will denote the completion of $T$ in the ${\\mathfrak{m}}$-adic topology.\n\n\\section{Preliminaries}\n\nBefore we begin our construction, we present, without proof, several lemmas which we use throughout the construction.  The following lemma will be used to show that the completion of $A$ is indeed $T$.\n\n\\begin{lemma}[{\\cite[Proposition 1]{heitmann94}}]\n\\label{comp}\nIf $(A,{\\mathfrak{m}}\\cap A)$ is a quasi-local subring of a complete local ring $(T,{\\mathfrak{m}})$, $A\\rightarrow T\\slash{\\mathfrak{m}}^2$ is onto and ${\\mathfrak{a}} T\\cap A={\\mathfrak{a}}$ for every finitely generated ideal ${\\mathfrak{a}}$ of $A$, then $A$ is Noetherian and the natural homomorphism $\\widehat{A}\\rightarrow T$ is an isomorphism.\n\\end{lemma}\n\nWe use the following lemma to find prime ideals of $T$ of height $d$ to include in the formal fibers at the height one prime ideals of $A$.\n\n\\begin{lemma}[{\\cite[Lemma 2.3]{charters04}}]\n\\label{modcard}\nLet $(T,{\\mathfrak{m}})$ be a complete local ring of dimension at least one.  Let ${\\mathfrak{p}}$ be a nonmaximal prime ideal of $T$.  Then $|T/{\\mathfrak{p}}|=|T|\\geq 2^{\\aleph_0}$.\n\\end{lemma}\n\nThroughout our construction, we adjoin elements of $T$ to our intermediate subrings.  The following two lemmas ensure that we can adjoin the necessary elements of $T$ while also preserving the desired properties of our subrings.\n\n\\begin{lemma}[{\\cite[Lemma 2]{heitmann93}}]\n\\label{countavoidance}\nLet $(T,{\\mathfrak{m}})$ be a complete local ring and let $D\\subset T$.  Suppose $C\\subset{\\operatorname{Spec}} T$ such that ${\\mathfrak{m}}\\not\\in C$, and suppose ${\\mathfrak{a}}$ is an ideal of $T$ such that ${\\mathfrak{a}}\\not\\subseteq{\\mathfrak{p}}$ for all ${\\mathfrak{p}}\\in C$.  If $C$ and $D$ are countable, then\n", "index": 1, "text": "\n\\[\n{\\mathfrak{a}}\\nsubseteq\\bigcup\\{t+{\\mathfrak{p}}\\mid t\\in D, {\\mathfrak{p}}\\in C\\}.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex1.m1\" class=\"ltx_Math\" alttext=\"{\\mathfrak{a}}\\nsubseteq\\bigcup\\{t+{\\mathfrak{p}}\\mid t\\in D,{\\mathfrak{p}}\\in&#10;C\\}.\" display=\"block\"><mrow><mrow><mi>\ud835\udd1e</mi><mo>\u2288</mo><mrow><mo largeop=\"true\" mathsize=\"160%\" movablelimits=\"false\" stretchy=\"false\" symmetric=\"true\">\u22c3</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mi>t</mi><mo>+</mo><mi>\ud835\udd2d</mi></mrow><mo>\u2223</mo><mrow><mrow><mi>t</mi><mo>\u2208</mo><mi>D</mi></mrow><mo>,</mo><mrow><mi>\ud835\udd2d</mi><mo>\u2208</mo><mi>C</mi></mrow></mrow><mo stretchy=\"false\">}</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.07136.tex", "nexttext": "\n\\end{lemma}\n\n\\begin{lemma}[{\\cite[Lemma 3]{heitmann93}}]\n\\label{avoidance}\nLet $(T,{\\mathfrak{m}})$ be a local ring and let $D\\subset T$.  Suppose $C\\subset{\\operatorname{Spec}} T$ and ${\\mathfrak{a}}$ is an ideal of $T$ such that ${\\mathfrak{a}}\\not\\subseteq{\\mathfrak{p}}$ for all ${\\mathfrak{p}}\\in C$.  If $|C\\times D|<|T/{\\mathfrak{m}}|$, then \n", "itemtype": "equation", "pos": 12507, "prevtext": "\n\\title{Controlling the Dimensions of Formal Fibers of a Unique Factorization Domain at the Height One Prime Ideals \\thanks{The authors thank the National Science Foundation for their support of this research via grant DMS-1347804.} \\thanks{Sarah M. Fleming and Nina Pande thank the Clare Boothe Luce Foundation for support of their research.}}\n\\author{Sarah M. Fleming, Lena Ji, S. Loepp, Peter M. McDonald, Nina Pande, and David Schwein}\n\n\\maketitle\n\n\\begin{abstract}\nLet $T$ be a complete local (Noetherian) equidimensional ring with maximal ideal ${\\mathfrak{m}}$ such that the Krull dimension of $T$ is at least two and the depth of $T$ is at least two.  Suppose that no integer of $T$ is a zerodivisor and that $|T|=|T/{\\mathfrak{m}}|$.  Let $d$ and $t$ be integers such that $1\\leq d \\leq  \\dim T-1$, $0 \\leq t \\leq \\dim T - 1$, and $d - 1 \\leq t$.  Assume that, for every ${\\mathfrak{p}}\\in{\\operatorname{Ass}} T$, ${\\operatorname{ht}}{\\mathfrak{p}}\\leq d-1$ and that if $z$ is a regular element of $T$ and $Q \\in {\\operatorname{Ass}}(T/zT)$, then ${\\operatorname{ht}} Q \\leq d$.  \n\nWe construct a local unique factorization domain $A$ such that the completion of $A$ is $T$ and such that the dimension of the formal fiber ring at every height one prime ideal of $A$ is $d - 1$ and the dimension of the formal fiber ring of $A$ at $(0)$ is $t$.\n\n\\end{abstract}\n\n\\section{Introduction}\n\nLet $A$ be a local (Noetherian) ring and let $T$ be the completion of $A$ with respect to its maximal ideal.  One fruitful way to study the relationship between $A$ and $T$ is to examine the relationship between ${\\operatorname{Spec}} A$ and ${\\operatorname{Spec}} T$, which we can do by looking at the formal fibers of $A$ at its prime ideals.  We define the formal fiber ring of $A$ at ${\\mathfrak{p}}\\in{\\operatorname{Spec}} A$ as $T\\otimes_A\\kappa({\\mathfrak{p}})$, and we define the formal fiber of $A$ at ${\\mathfrak{p}}$ as ${\\operatorname{Spec}}(T\\otimes_A\\kappa({\\mathfrak{p}}))$ where $\\kappa({\\mathfrak{p}})$ is the residue field $A_{{\\mathfrak{p}}}/{\\mathfrak{p}} A_{{\\mathfrak{p}}}$. There is a one-to-one correspondence between elements of the formal fiber of $A$ at ${\\mathfrak{p}}$ and the elements of the inverse image of ${\\mathfrak{p}}$ under the mapping $\\varphi : {\\operatorname{Spec}} T\\rightarrow{\\operatorname{Spec}} A$ defined by $\\varphi({\\mathfrak{q}})={\\mathfrak{q}}\\cap A$.  Because of this correspondence, the formal fibers of $A$ encode information about the relationship between the prime ideals of $T$ and the prime ideals of $A$.  Note that, since $T$ is a faithfully flat extension of $A$, the map $\\varphi$ is surjective.  Using Matsumura's notation in~\\cite{matsumura88}, we denote the Krull dimension of the formal fiber ring of $A$ at the prime ideal ${\\mathfrak{p}}$ by $\\alpha(A,{\\mathfrak{p}})$.  The supremum of $\\alpha(A,{\\mathfrak{p}})$ over all prime ideals ${\\mathfrak{p}}$ of $A$ is denoted by $\\alpha(A)$.  When $A$ is an integral domain, we refer to the formal fiber ring of $A$ at the prime ideal $(0)$ as the generic formal fiber ring, and the formal fiber of $A$ at $(0)$ as the generic formal fiber.\n\nMatsumura proved in~\\cite{matsumura88} that, given two elements ${\\mathfrak{p}},{\\mathfrak{p}}'\\in{\\operatorname{Spec}} A$, if ${\\mathfrak{p}}\\subseteq{\\mathfrak{p}}'$, then $\\alpha(A,{\\mathfrak{p}})\\geq\\alpha(A,{\\mathfrak{p}}')$.  Additionally, he proved that, given a ring of positive dimension $n$, the maximum possible value of $\\alpha(A)$ is $n-1$.  Furthermore, if $A$ is a ring of essentially finite type over a field, Matsumura showed that $\\alpha(A) = n - 1$ and that $\\alpha(A,{\\mathfrak{p}})=n-1-{\\operatorname{ht}}{\\mathfrak{p}}$.  In other words, for rings of essentially finite type over a field, the dimensions of the formal fiber rings are completely understood.  However, for a general ring, not much is known about how the inequality $\\alpha(A,{\\mathfrak{p}})\\geq\\alpha(A,{\\mathfrak{p}}')$ behaves when varying the heights of ${\\mathfrak{p}}$ and ${\\mathfrak{p}}'$.  We are interested specifically in what happens when $A$ is an integral domain, ${\\mathfrak{p}}=(0)$, and ${\\mathfrak{p}}'$ is a height one prime ideal of $A$.  In particular, Heinzer, Rotthaus, and Sally informally posed the following question:\n\n\\begin{question}\nLet A be an excellent local ring with $\\alpha(A)>0$, and let $\\Delta$ be the set $\\{{\\mathfrak{p}}\\in{\\operatorname{Spec}} A\\mid{\\operatorname{ht}}{\\mathfrak{p}}=1\\text{ and }\\alpha(A,{\\mathfrak{p}}) = \\alpha(A)\\}$.\nIs $\\Delta$ a finite set?\n\\end{question}\n\n\\noindent We first note that if $A$ is a Noetherian integral domain, then $\\alpha{(A)} = \\alpha(A,(0))$.  Given Matsumura's results, one might expect that, for an integral domain $A$, the dimension of the formal fiber ring of $A$ at ``most\" height one prime ideals is strictly less than the dimension of the formal fiber ring of $A$ at the zero ideal.  In other words, one might expect that the set $\\Delta$ is ``small,\" so the above question is a very natural one to ask.\n\nIn~\\cite{boocher10}, Adam Boocher, Michael Daub, and S. Loepp showed that the set $\\Delta$ need not be finite by constructing an excellent local unique factorization domain $A$ for which $\\Delta$ is countably infinite.  However, the UFD that they construct has uncountably many height one prime ideals, so the set $\\Delta$ for their ring is ``small\" in the sense that it does not contain ``most\" of the height one prime ideals of $A$.  Based on this result, one might think it unlikely that there exists a ring such that $\\Delta$ is an uncountable set and even less likely that a ring exists such that $\\Delta$ contains {\\em all} of its height one prime ideals.  In this paper, we construct a non-excellent unique factorization domain $A$ for which this property holds; that is, every height one prime ideal of $A$ is in $\\Delta$.  In fact, we generalize the result so that if $d$ and $t$ are integers such that $1 \\leq d \\leq \\dim T - 1$, $0 \\leq t \\leq \\dim T - 1$, and $d - 1 \\leq t$, then our $A$ satisfies the property that every height one prime ideal ${\\mathfrak{p}}$ of $A$ has a formal fiber ring of dimension $d - 1$ and the generic formal fiber ring of $A$ has dimension $t$.  In other words, we show that the relationship between the dimensions of the formal fiber rings of a ring at its height one prime ideals and the dimension of the generic formal fiber ring of the ring is restricted only by the inequality given by Matsumura.  That is, if ${\\mathfrak{p}}$ is a height one prime ideal of a ring $A$, then $\\alpha (A,{\\mathfrak{p}}) \\leq \\alpha (A,(0))$, but\nfor any nonnegative integer less than or equal to the dimension of the generic formal fiber ring,\nthere exists a ring such that the dimension of the formal fiber rings at each height one prime ideals is equal to this integer.\n\nOur main result is given by Theorem~\\ref{bigthm}.  Let $T$ be a complete local equidimensional ring with maximal ideal ${\\mathfrak{m}}$, and suppose that the Krull dimension of $T$ is at least two.  Also suppose that $|T|=|T/{\\mathfrak{m}}|$, no integer is a zerodivisor in $T$, and $T$ has depth greater than one. Let $d$ and $t$ be integers with $1\\leq d\\leq\\dim T-1$, $0 \\leq t \\leq \\dim T - 1$, and $d - 1 \\leq t$.  Suppose that ${\\operatorname{ht}}{\\mathfrak{p}}\\leq d-1$ for every ${\\mathfrak{p}}\\in{\\operatorname{Ass}} T$ and that if $z$ is a regular element of $T$ and $Q \\in {\\operatorname{Ass}}(T/zT)$, then ${\\operatorname{ht}} Q \\leq d$.  We show that there exists a local unique factorization domain $A$ whose completion is $T$ such that $\\alpha(A,(0))=t$ and, for every ${\\mathfrak{p}}\\in{\\operatorname{Spec}} A$ with ${\\operatorname{ht}}{\\mathfrak{p}}=1$, $\\alpha(A,{\\mathfrak{p}})= d - 1$.  \nThat is to say, with relatively weak conditions on $T$, we can find a local UFD $A$ where the dimensions of the formal fiber rings of $A$ at all height one prime ideals are equal.  Moreover, we can control the dimension of the generic formal fiber ring of $A$, and the dimension of the formal fiber rings of $A$ at its height one prime ideals can be any nonnegative integer less than or equal to the dimension of the generic formal fiber ring of $A$.\nIn particular, if we set $d - 1 = t$, then we can find a UFD $A$ such that $\\Delta$ is the set of {\\em all} height one prime ideals of $A$, which, in our case, will be an uncountable set.  Furthermore, in this case, we have the ability to set the dimension of the formal fiber rings at our height one prime ideals and the generic formal fiber ring to be any integer value between $0$ and $\\dim T-2$.\n\nIn ~\\cite{heitmann93}, Heitmann found necessary and sufficient conditions for a complete local ring to be the completion of a unique factorization domain.  For our ring $A$ to exist, then, our ring $T$ must satisfy those conditions.  In particular, this means that $T$ must have depth greater than one and satisfy the condition that no integer of $T$ is a zerodivisor.  We impose the additional condition that $\\dim T\\geq2$ to avoid any trivial examples. The remaining conditions we put on $T$ are relatively weak.  We base our construction on the one employed by Heitmann in~\\cite{heitmann93}, modifying and adding lemmas so that we can control the dimensions of the formal fiber rings of $A$ at $(0)$ and at the height one prime ideals.  \n\nWe employ Lemma~\\ref{comp}, which gives necessary and sufficient conditions for a quasi-local subring of a complete local ring $T$ to be Noetherian and have completion $T$.  In particular, if $T$ is a complete local ring with maximal ideal ${\\mathfrak{m}}$ and $A$ is a quasi-local subring of $T$ with maximal ideal ${\\mathfrak{m}} \\cap A$, then $A$ is Noetherian and has completion isomorphic to $T$ if the map $A\\rightarrow T\\slash{\\mathfrak{m}}^2$ is onto and every finitely generated ideal ${\\mathfrak{a}}$ of $A$ is closed; that is, ${\\mathfrak{a}} T\\cap A={\\mathfrak{a}}$.  To ensure that our subring $A$ satisfies these conditions and has the desired formal fibers, we construct a strictly ascending chain of subrings of $T$ starting with a localization of the prime subring of $T$.  We then adjoin elements in of $T$ in succession to make the above map onto, to close up finitely generated ideals, and to manipulate the dimensions of the formal fiber rings.  We argue that the union of the subrings in this chain is our desired local UFD $A$.\n\nIn this paper, all rings are commutative with unity.  We define a quasi-local ring as any ring with exactly one maximal ideal and a local ring as a quasi-local Noetherian ring.  We use $(T,{\\mathfrak{m}})$ to refer to a local ring $T$ with maximal ideal ${\\mathfrak{m}}$ and ${\\operatorname{Spec}}_k T$ to refer to the set of prime ideals of $T$ of height $k$.  $\\widehat{T}$ will denote the completion of $T$ in the ${\\mathfrak{m}}$-adic topology.\n\n\\section{Preliminaries}\n\nBefore we begin our construction, we present, without proof, several lemmas which we use throughout the construction.  The following lemma will be used to show that the completion of $A$ is indeed $T$.\n\n\\begin{lemma}[{\\cite[Proposition 1]{heitmann94}}]\n\\label{comp}\nIf $(A,{\\mathfrak{m}}\\cap A)$ is a quasi-local subring of a complete local ring $(T,{\\mathfrak{m}})$, $A\\rightarrow T\\slash{\\mathfrak{m}}^2$ is onto and ${\\mathfrak{a}} T\\cap A={\\mathfrak{a}}$ for every finitely generated ideal ${\\mathfrak{a}}$ of $A$, then $A$ is Noetherian and the natural homomorphism $\\widehat{A}\\rightarrow T$ is an isomorphism.\n\\end{lemma}\n\nWe use the following lemma to find prime ideals of $T$ of height $d$ to include in the formal fibers at the height one prime ideals of $A$.\n\n\\begin{lemma}[{\\cite[Lemma 2.3]{charters04}}]\n\\label{modcard}\nLet $(T,{\\mathfrak{m}})$ be a complete local ring of dimension at least one.  Let ${\\mathfrak{p}}$ be a nonmaximal prime ideal of $T$.  Then $|T/{\\mathfrak{p}}|=|T|\\geq 2^{\\aleph_0}$.\n\\end{lemma}\n\nThroughout our construction, we adjoin elements of $T$ to our intermediate subrings.  The following two lemmas ensure that we can adjoin the necessary elements of $T$ while also preserving the desired properties of our subrings.\n\n\\begin{lemma}[{\\cite[Lemma 2]{heitmann93}}]\n\\label{countavoidance}\nLet $(T,{\\mathfrak{m}})$ be a complete local ring and let $D\\subset T$.  Suppose $C\\subset{\\operatorname{Spec}} T$ such that ${\\mathfrak{m}}\\not\\in C$, and suppose ${\\mathfrak{a}}$ is an ideal of $T$ such that ${\\mathfrak{a}}\\not\\subseteq{\\mathfrak{p}}$ for all ${\\mathfrak{p}}\\in C$.  If $C$ and $D$ are countable, then\n", "index": 1, "text": "\n\\[\n{\\mathfrak{a}}\\nsubseteq\\bigcup\\{t+{\\mathfrak{p}}\\mid t\\in D, {\\mathfrak{p}}\\in C\\}.\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex2.m1\" class=\"ltx_Math\" alttext=\"{\\mathfrak{a}}\\nsubseteq\\bigcup\\{t+{\\mathfrak{p}}\\mid t\\in D,{\\mathfrak{p}}\\in&#10;C\\}.\" display=\"block\"><mrow><mrow><mi>\ud835\udd1e</mi><mo>\u2288</mo><mrow><mo largeop=\"true\" mathsize=\"160%\" movablelimits=\"false\" stretchy=\"false\" symmetric=\"true\">\u22c3</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mi>t</mi><mo>+</mo><mi>\ud835\udd2d</mi></mrow><mo>\u2223</mo><mrow><mrow><mi>t</mi><mo>\u2208</mo><mi>D</mi></mrow><mo>,</mo><mrow><mi>\ud835\udd2d</mi><mo>\u2208</mo><mi>C</mi></mrow></mrow><mo stretchy=\"false\">}</mo></mrow></mrow></mrow><mo>.</mo></mrow></math>", "type": "latex"}, {"file": "1601.07136.tex", "nexttext": "\n\n\\noindent well-ordered using $\\mathscr{B}$ as the index set.  Then $\\Omega$ is the diagonal of $\\Omega_1\\times\\Omega_2$. Let 0 designate the first element of $\\Omega$.  Now, $\\Omega$ satisfies the hypothesis of Lemma~\\ref{union}, and we now recursively define a family of rings $\\{R_{\\beta}\\mid\\beta\\in\\Omega\\}$ which also satisfies the hypotheses of Lemma~\\ref{union}.  As in the proof of Theorem 8 in~\\cite{heitmann93}, let $R_0$ be the appropriate localization of the prime subring of $T$: either $\\mathbb{Q}$, $\\mathbb{Z}_{p}$, or $\\mathbb{Z}_{(p)}$ where $p$ is a prime integer.  It is not difficult to verify that $R_0$ is an $N$-subring.  Now, $R_0$ is either dimension $0$ or $1$.  If it is dimension $0$, define ${\\mathcal} Q_{R_0}$ to be the empty set, and if it is dimension $1$, define ${\\mathcal} Q_{R_0}$ to be any height $d$ prime ideal of $T$ that contains a minimal associated prime ideal of $pT$.   Then $R_0$ is a $Z_d$-subring of $T$ with distinguished set ${\\mathcal} Q_{R_0}$.  We will use the shorthand $\\beta=({\\mathfrak{q}}_{\\beta},t_{\\beta})$ for an element of $\\Omega$.  Then, whenever $\\beta=\\omega+1$ is a successor ordinal, we let $R_{\\beta}$ be an $A_+$-extension of $R_{\\omega}$ chosen in accordance with Lemma~\\ref{closeideals} so that ${\\mathfrak{q}}_{\\omega}\\cap R_{\\beta}\\neq(0)$, $t_{\\omega}\\in{\\operatorname{Image}}(R_{\\beta}\\rightarrow T/{\\mathfrak{m}}^2)$, and ${\\mathfrak{a}} T \\cap R_{\\beta} = {\\mathfrak{a}}$ for every finitely generated ideal ${\\mathfrak{a}}$ of $R_{\\beta}$.  Note that in this case (where $t = d - 1$) we do not need to use the $P$ given in Lemma \\ref{closeideals}.  If $\\beta$ is a limit ordinal, choose $R_{\\beta}=\\bigcup_{\\gamma<\\beta}R_{\\gamma}$.  We claim $A=\\bigcup_{\\beta \\in \\Omega} R_{\\beta}$ is the desired example.\n\nBy construction, $A\\rightarrow T/{\\mathfrak{m}}^2$ is onto.  Now let ${\\mathfrak{a}} = (a_1,\\ldots ,a_n)$ be a finitely generated ideal of $A$, and let $x \\in {\\mathfrak{a}} T \\cap A$. Then there is a $\\beta \\in \\Omega$ such that $\\beta$ is a successor ordinal and $x, a_1, \\ldots , a_n \\in R_{\\beta}$, so $x \\in (a_1, \\ldots ,a_n)T \\cap R_{\\beta} = (a_1, \\ldots ,a_n)R_{\\beta} \\subseteq {\\mathfrak{a}}$.  It follows that ${\\mathfrak{a}} T\\cap A={\\mathfrak{a}}$ for all finitely generated ideals of $A$.  Then by Lemma~\\ref{comp}, $\\widehat{A}= T$ and $A$ is Noetherian. By Lemma~\\ref{union}, except for the cardinality condition, $A$ satisfies all the conditions of  being a $Z_d$-subring of $T$ with some distinguished set, which implies that for any ${\\mathfrak{p}}\\in{\\operatorname{Spec}}_1A$, $\\alpha(A,{\\mathfrak{p}})\\geq d-1$. Now let ${\\mathfrak{q}}\\in{\\operatorname{Spec}}_dT$.  Then by our construction there is some $R_{\\beta}$ such that ${\\mathfrak{q}}\\cap R_{\\beta}\\neq(0)$, and so ${\\mathfrak{q}}\\cap A\\neq(0)$.  Thus $\\alpha(A,(0))\\leq d-1$.  Then, by Theorem 1 of~\\cite{matsumura88}, $d-1\\geq\\alpha(A,(0))\\geq\\alpha(A,{\\mathfrak{p}})\\geq d-1.$  Thus, for every ${\\mathfrak{p}}\\in{\\operatorname{Spec}}_1A$, $\\alpha(A,{\\mathfrak{p}})=\\alpha(A,(0))=d-1$.\n\nNow we consider the case $t \\neq d - 1$.  In this case, we adjust the construction described above.  We first find a prime ideal $P$ of $T$ such that ht$P = t$ and $P \\cap R_0 = (0)$.  If $R_0 = \\mathbb{Q}$ or $R_0 = \\mathbb{Z}_p$, then all nonzero elements of $R_0$ are units of $T$, and so we can choose $P$ to be any prime ideal of $T$ with height $t$.   If $R_0 = \\mathbb{Z}_{(p)}$ and $t = 0$, then choose $P$ to be any minimal prime ideal of $T$.  Since $p$ is not a zerodivisor of $T$, we have $P \\cap R_0 = (0)$.  If $R_0 = \\mathbb{Z}_{(p)}$, and $t > 0$ then note that $p$ is contained in finitely many height one prime ideals of $T$, and so there is a height one prime ideal $P_1$ such that $P_1 \\cap R_0 = (0)$.  Now the element $p + P_1$ in $T/P_1$ is contained in finitely many height one prime ideals of $T/P_1$, and so there is a height one prime ideal $\\bar{P}_2$ of $T/P_1$ such that $p + P_1 \\not\\in \\bar{P}_2$.  As $T$ is universally catenary and equidimensional, there is a height two prime ideal $P_2$ of $T$ such that $R_0 \\cap P_2 = (0)$.  Continue in this way to find a height $t$ prime ideal $P$ of $T$ such that $P \\cap R_0 = (0)$.\n\nNow suppose $t = d = \\dim T - 1$.  Then use the same construction described for the $t = d - 1$ case with the following adjustments.  Let $\\Omega_1 = {\\operatorname{Spec}}_d T - \\{P\\}$ where $P$ is the height $t$ prime ideal of $T$ chosen in the above paragraph.  Then, in the construction, whenever $\\beta=\\omega+1$ is a successor ordinal, let $R_{\\beta}$ be an $A_+$-extension of $R_{\\omega}$ chosen in accordance with Lemma~\\ref{closeideals} so that ${\\mathfrak{q}}_{\\omega}\\cap R_{\\beta}\\neq(0)$, $P \\cap R_{\\beta} = (0)$, $t_{\\omega}\\in{\\operatorname{Image}}(R_{\\beta}\\rightarrow T/{\\mathfrak{m}}^2)$, and ${\\mathfrak{a}} T \\cap R_{\\beta} = {\\mathfrak{a}} R_{\\beta}$ for every finitely generated ideal ${\\mathfrak{a}}$ of $R_{\\omega}$.  Then, using this adjusted construction, we get a UFD $A$ such that $\\widehat{A} = T$, $P \\cap A = (0)$, and for every ${\\mathfrak{p}} \\in {\\operatorname{Spec}}_1 A$, there is a height $d = \\dim T - 1$ prime ideal of $T$ whose intersection with $A$ is ${\\mathfrak{p}}$.  It follows that $\\alpha(A,(0)) = t$ and $\\alpha(A,{\\mathfrak{p}}) = d - 1$ for all ${\\mathfrak{p}} \\in {\\operatorname{Spec}}_1 A$.\n\nFinally, consider all other cases.  That is, suppose either $t > d$ or $t = d$ with $t < \\dim T - 1$.  Then use the same construction described for the $t = d - 1$ case with the following adjustments.  Let\n\n", "itemtype": "equation", "pos": 52290, "prevtext": "\n\\end{lemma}\n\n\\section{The Construction}\n\nHere we describe the construction of our local UFD $A$.  We begin with the definition of a $Z_d$-subring of $T$.  If we can maintain $Z_d$-subrings throughout the construction, then the formal fiber rings of $A$ will be of the desired dimension.\n\n\\begin{definition}\\label{zsub} \nLet $(T,{\\mathfrak{m}})$ be a complete local ring, let $d$ be an integer such that $1\\leq d\\leq \\dim T-1$, and let $(R,{\\mathfrak{m}}\\cap R)$ be a quasi-local unique factorization domain contained in $T$ satisfying the following:\n\\begin{description}\n\\item{(i)} $|R|\\leq\\sup(\\aleph_0,|T/{\\mathfrak{m}}|)$ with equality only if $T/{\\mathfrak{m}}$ is countable,\n\\item{(ii)} ${\\mathfrak{q}}\\cap R=(0)$ for all ${\\mathfrak{q}}\\in{\\operatorname{Ass}} T$,\n\\item{(iii)} if $t\\in T$ is regular and ${\\mathfrak{q}}\\in{\\operatorname{Ass}}(T/tT)$, then ${\\operatorname{ht}}({\\mathfrak{q}}\\cap R)\\leq 1$, and\n\\item{(iv)} there exists a set ${\\mathcal}{Q}_R \\subset {\\operatorname{Spec}}_d T$ such that the map $f: {\\mathcal}{Q}_R \\longrightarrow {\\operatorname{Spec}}_1 R$ given by $f({\\mathfrak{q}}) = {\\mathfrak{q}} \\cap R$ is a bijection.\n\n\\end{description}\n\\noindent Then $R$ is called a \\emph{$Z_d$-subring of $T$ with distinguished set ${\\mathcal}{Q}_R$}.  \n\n Note that if $(R, {\\mathfrak{m}}\\cap R)$ satisfies conditions (i)-(iii) but not necessarily (iv), $R$ is an \\emph{$N$-subring of $T$}, as defined in~\\cite{heitmann93}.\n\\end{definition}\n\n\\begin{definition} If $R\\subseteq S$ are $Z_d$-subrings of $T$ with distinguished sets ${\\mathcal}{Q}_R$ and ${\\mathcal}{Q}_S$, we say that $S$ is an \\emph{$A_+$-extension of $R$} if:\n\\begin{description}\n\\item{(i)} prime elements of $R$ are prime in $S$,\n\\item{(ii)} $|S|\\leq\\sup(\\aleph_0,|R|)$, and \n\\item{(iii)} ${\\mathcal}{Q}_R\\subseteq{\\mathcal}{Q}_S$.\n\\end{description}\n\\noindent If $R\\subseteq S$ are $N$-subrings of $T$ satisfying conditions (i) and (ii) but not necessarily (iii), then $S$ is an \\emph{$A$-extension of $R$}, as defined in~\\cite{heitmann93}.\n\\end{definition}\n\n\nIn order to simplify the statements of many of our subsequent lemmas, we will refer to the following assumption.\n\n\\begin{assumption} \\label{assume}\n$(T,{\\mathfrak{m}})$ is a complete local equidimensional ring with $2\\leq\\dim T$, $d$ is an integer such that\n$1\\leq d\\leq\\dim T-1$, and $(R,{\\mathfrak{m}}\\cap R)$ is a $Z_d$-subring of~$T$ with distinguished set ${\\mathcal}{Q}_R$.\n\\end{assumption}\n\nThe next lemma is used to adjoin a coset representative of an element of $T/{\\mathfrak{m}}^2$ to our subring $R$.  Applying this lemma infinitely often will allow us to ensure that the map $A\\rightarrow T/{\\mathfrak{m}}^2$ is onto so that we can employ Lemma \\ref{comp}.\n\n\\begin{lemma}\\label{cosets}\nUnder Assumption~\\ref{assume}, let $t\\in T$ and suppose ${\\operatorname{depth}} T>1$.  Let $P$  be a nonmaximal prime ideal of $T$ such that $P \\cap R = (0)$.  Then there exists an $A_+$-extension $S$ of $R$ such that $t+{\\mathfrak{m}}^2\\in{\\operatorname{Image}}(S\\rightarrow T/{\\mathfrak{m}}^2)$ and $P \\cap S = (0)$.\n\\end{lemma}\n\\begin{proof}\nNote that this lemma is similar to Lemma 5 of~\\cite{heitmann93}. Let $C=\\{{\\mathfrak{p}}\\in{\\operatorname{Spec}} T\\mid{\\mathfrak{p}}\\in{\\operatorname{Ass}}(T/rT)\\text{ with }0\\neq r\\in R\\}\\cup{\\operatorname{Ass}} T\\cup\\mathcal{Q}_R \\cup \\{P\\}$.  Since ${\\operatorname{depth}} T > 1$, we have that ${\\mathfrak{m}} \\not\\in C$, so ${\\mathfrak{m}}^2\\not\\subset {\\mathfrak{p}}$ for every ${\\mathfrak{p}}\\in C$.  For ${\\mathfrak{p}} \\in C$, let $D_{({\\mathfrak{p}})}$ be a set of coset representatives of the cosets $u + {\\mathfrak{p}} \\in T/{\\mathfrak{p}}$ that make $u + t + {\\mathfrak{p}}$ algebraic over $R/{\\mathfrak{p}} \\cap R$.  Define $D = \\bigcup_{{\\mathfrak{p}} \\in C} D_{({\\mathfrak{p}})}$.  Using Lemma~\\ref{countavoidance} if $R$ is countable and Lemma~\\ref{avoidance} otherwise, we choose $x\\in{\\mathfrak{m}}^2$ such that $(x+t)+{\\mathfrak{p}}$ is transcendental over $R/({\\mathfrak{p}} \\cap R)$ for every ${\\mathfrak{p}}\\in C$.  Define $S=R[x+t]_{{\\mathfrak{m}}\\cap R[x+t]}$; we claim that $S$ is our desired $Z_d$-subring with distinguished set ${\\mathcal}{Q}_S$, where we will define ${\\mathcal}{Q}_S$ later.  \n\n\nWe first show that ${\\mathfrak{p}}\\cap S=({\\mathfrak{p}}\\cap R)S$ for any ${\\mathfrak{p}}\\in C$. Elements of ${\\mathfrak{p}}\\cap S$ are of the form $uf$, where $u\\in S^{\\times}$ is a unit and $f\\in R[x+t]$. Since $u$ is a unit, we have that $f\\in{\\mathfrak{p}}$. Treating $f$ as a polynomial in $x+t$ over $R$, each of its coefficients must be in ${\\mathfrak{p}} \\cap R$ since $x+t+{\\mathfrak{p}}$ is transcendental over $R\\slash{\\mathfrak{p}}\\cap R$. Thus, $f\\in({\\mathfrak{p}}\\cap R)R[x+t]$, and so $uf\\in({\\mathfrak{p}}\\cap R)S$. This gives us that ${\\mathfrak{p}}\\cap S\\subseteq({\\mathfrak{p}}\\cap R)S$, and the opposite containment is clear, so we have equality. \n\n\nClearly, $|S|=\\operatorname{sup}(\\aleph_0,|R|)$ as we are simply adjoining a transcendental element and localizing, and so $S$ satisfies condition (i) of $Z_d$-subrings and condition (ii) of $A_+$-extensions.  Now let ${\\mathfrak{q}}\\in{\\operatorname{Ass}} T$; then ${\\mathfrak{q}}\\cap S=({\\mathfrak{q}}\\cap R)S=(0)$, and so condition (ii) of $Z_d$-subrings is satisfied.  By the same argument, $S \\cap P = (0)$.\n\nNow, let ${\\mathfrak{p}}\\in{\\operatorname{Ass}} (T/rT)$ for some regular $r\\in T$.  First suppose ${\\mathfrak{p}}\\cap R=(0)$. Then, in $S_{{\\mathfrak{p}}\\cap S}=R[x+t]_{{\\mathfrak{p}}\\cap R[x+t]}$, all nonzero elements of $R$ are units, and so $S_{{\\mathfrak{p}}\\cap S}$ is isomorphic to $k[X]$ with additional elements inverted, where $k$ is a field and $X$ is an indeterminate.  It follows that $\\dim S_{{\\mathfrak{p}}\\cap S}\\leq 1$ and we have ${\\operatorname{ht}}({\\mathfrak{p}}\\cap S)\\leq 1$. Now suppose ${\\mathfrak{p}}\\cap R=aR$ for some $a\\in R$.  We know ${\\mathfrak{p}}\\in{\\operatorname{Ass}}(T/rT)$ if and only if ${\\mathfrak{p}} T_{{\\mathfrak{p}}}\\in{\\operatorname{Ass}}(T_{{\\mathfrak{p}}}/rT_{{\\mathfrak{p}}})$ (Theorem 6.2 of~\\cite{matsumura86}), and so ${\\mathfrak{p}} T_{{\\mathfrak{p}}}$ consists of zerodivisors of $T_{{\\mathfrak{p}}}/rT_{{\\mathfrak{p}}}$. Then $T_{{\\mathfrak{p}}}/rT_{{\\mathfrak{p}}}$ consists only of zerodivisors and units and hence has depth zero, and since $a\\in T$ is regular, $T_{{\\mathfrak{p}}}/aT_{{\\mathfrak{p}}}$ must also have depth zero.  Then ${\\mathfrak{p}} T_{{\\mathfrak{p}}}$ consists only of zerodivisors of $T_{{\\mathfrak{p}}}/aT_{{\\mathfrak{p}}}$, and so ${\\mathfrak{p}} T_{{\\mathfrak{p}}}\\in{\\operatorname{Ass}}(T_{{\\mathfrak{p}}}/aT_{{\\mathfrak{p}}})$, and we have that ${\\mathfrak{p}}\\in{\\operatorname{Ass}}(T/aT)$.  Therefore, ${\\mathfrak{p}}\\in C$, so we have that ${\\mathfrak{p}}\\cap S=({\\mathfrak{p}}\\cap R)S=aS$. Since $R$ is a UFD and $x + t$ is transcendental over $R$, $R[x+t]$ is a UFD as well, and furthermore, any localization of a UFD is a UFD, so $S=R[x+t]_{{\\mathfrak{m}}\\cap R[x+t]}$ is a UFD.  Therefore, since $aS$ is a principal ideal of $S$, ${\\operatorname{ht}}({\\mathfrak{p}}\\cap S)\\leq 1$ and $S$ satisfies condition (iii) of $Z_d$-subrings.\n\nNote that, since $x + t$ is transcendental over $R$, prime elements of $R$ are prime in $S$.  Finally, we define the distinguished set ${\\mathcal}{Q}_S$ for $S$.  We first show that there is a one-to-one correspondence between height one prime ideals of $R$ and height one prime ideals $pS$ of $S$ such that $pS \\cap R \\neq (0)$ given by $pR \\mapsto pS$.\n\n\n\nIf $pS$ is a height one prime ideal of $S$ such that $pS \\cap R \\neq (0)$, then there is an element $s \\in S$ such that $ps \\in R$.  Factoring $ps$ into primes in $R$, we get $ps = q_1\\cdots q_n$ where $q_i$ are prime elements in $R$.  Since prime elements in $R$ are prime in $S$, we have that $q_1\\cdots q_n$ is a prime factorization of $ps$ in $S$.  It follows that $p = q_iu$ for some $i$ where $u$ is a unit in $S$.  Hence, $pS = (q_iu)S = q_iS$, so for every height one prime ideal $pS$ of $S$ with $pS \\cap R \\neq (0)$, there is a prime element $q$ of $R$ such that $pS = qS$, and it follows that our map is onto.  Now suppose that $p$ and $q$ are prime elements of $R$ such that $pS = qS$.  Then, letting $P' \\in {\\operatorname{Ass}}(T/pT)$, we have that $pS \\cap R \\subseteq P' \\cap R = pR$.  Clearly, $pR \\subseteq pS \\cap R.$  This gives us that $pR = pS \\cap R = qS \\cap R = qR$, showing that our map is one-to-one.  Let ${\\mathfrak{q}}_p\\in{\\mathcal}{Q}_R$, where $p$ is a prime element of $R$ satisfying ${\\mathfrak{q}}_p\\cap R=pR$. Then ${\\mathfrak{q}}_p\\cap S=({\\mathfrak{q}}_p\\cap R)S=pS$.  Hence, the map from ${\\mathcal}{Q}_R$ to the set of height one prime ideals $pS$ of $S$ satisfying $pS \\cap R \\neq (0)$ given by ${\\mathfrak{q}}_p \\mapsto {\\mathfrak{q}}_p \\cap S = pS$ is a bijection.\n\n\n\n\nNow let $p$ be a nonzero prime element of $S$ such that $pS \\cap R = (0)$.\nWe claim that there is ${\\mathfrak{q}}_p\\in{\\operatorname{Spec}}_d T$ such that ${\\mathfrak{q}}_p\\cap S=pS$, and we\nshow this by induction on $d$.  If $d = 1$, let ${\\mathfrak{q}}_p$ be a minimal prime ideal of $pT$.\nIn the case $d=2$, let ${\\mathfrak{p}} \\in {\\operatorname{Spec}} T$ be a minimal prime ideal of $pT$, and consider the embedding\n$S/{\\mathfrak{p}} \\cap S\\hookrightarrow T/{\\mathfrak{p}}$.\nSince $T/{\\mathfrak{p}} $ is a Noetherian integral domain, each nonzero element of $S/{\\mathfrak{p}} \\cap S$ is contained in\nfinitely many height one prime ideals of $T/{\\mathfrak{p}} $,\nand since, by Lemma~\\ref{modcard}, $|S/{\\mathfrak{p}} \\cap S|<|T|=|T/{\\mathfrak{p}}  |$,\nthere must be some $\\overline{{\\mathfrak{q}}}\\in{\\operatorname{Spec}}_1(T/{\\mathfrak{p}} )$ whose intersection with $S/{\\mathfrak{p}} \\cap S$ is zero.  Lifting to $T$ and using the fact that $T$ is equidimensional and catenary, we have a height two prime ideal ${\\mathfrak{q}}$ of $T$ containing ${\\mathfrak{p}}$\nsuch that ${\\mathfrak{q}}\\cap S\\subseteq{\\mathfrak{p}}\\cap S$.\nBy condition (iii) of $Z_d$-subrings, ${\\mathfrak{p}}\\cap S=pS$\nand so ${\\mathfrak{q}}\\cap S=pS$.\nNow let $2<d<\\dim T$, and suppose that ${\\mathfrak{q}}'\\in{\\operatorname{Spec}}_{d-1} T$\nsatisfies ${\\mathfrak{q}}'\\cap S=pS$.\nApplying the above argument to the injection $S/{\\mathfrak{q}}'\\cap S=S/pS\\hookrightarrow T/{\\mathfrak{q}}'$\nwe can find some ${\\mathfrak{q}}_p\\in{\\operatorname{Spec}}_d T$ containing $p$ and\nsatisfying ${\\mathfrak{q}}_p\\cap S\\subseteq {\\mathfrak{q}}' \\cap S$,\nand so ${\\mathfrak{q}}_p\\cap S=pS$ and the induction is complete.  Now for every height one prime ideal $pS$ of $S$ such that $pS \\cap R = (0)$, choose one ${\\mathfrak{q}} \\in {\\operatorname{Spec}}_d T$ such that ${\\mathfrak{q}} \\cap S = pS$.\nWe define ${\\mathcal} Q_S$ to be the union of the set of these prime ideals and ${\\mathcal} Q_R$.\nThen $S$ is our desired $A_+$-extension of $R$.\n\\end{proof}\n\n\\begin{lemma}\\label{h4}\nUnder Assumption~\\ref{assume}, let ${\\mathfrak{a}}$ be a finitely generated ideal of $R$, and let $c\\in{\\mathfrak{a}} T\\cap R$.  Let $P$  be a nonmaximal prime ideal of $T$ such that $P \\cap R = (0)$.  Then there exists an $A_+$-extension $S$ of $R$ such that $c\\in{\\mathfrak{a}} S$ and $P \\cap S = (0)$.\n\\end{lemma}\n\\begin{proof}\nNote that this lemma is similar to Lemma 4 in~\\cite{heitmann93} with the change that, instead of $R$ and $S$ being merely $N$-subrings, $R$ and $S$ are $Z_d$-subrings of $T$ with distinguished sets ${\\mathcal}{Q}_R$ and ${\\mathcal}{Q}_S$ satisfying ${\\mathcal} Q_R\\subseteq{\\mathcal} Q_S$.  Therefore, most of the proof follows the proof of Lemma 4 in~\\cite{heitmann93}, and we need only show that condition (iv) of Definition~\\ref{zsub} holds for the $S$ we construct, that we can choose ${\\mathcal} Q_S$ so that ${\\mathcal} Q_R\\subseteq{\\mathcal} Q_S$, and that $P \\cap S = (0)$.  We will proceed by inducting on the number of generators of ${\\mathfrak{a}}$.  Let ${\\mathfrak{a}}=(a_1, \\ldots ,a_n)R$.\n\nIt is shown in the proof of Lemma 4 of~\\cite{heitmann93} that, without loss of generality, we may assume that ${\\mathfrak{a}}$ is not contained in a height one prime ideal of $R$, and so we will assume this for the rest of our proof.  If $n = 1$ this implies that ${\\mathfrak{a}} = R$, so $S=R$ is the desired $A_+$-extension of $R$.\n\n\n\nAs in the proof of Lemma~\\ref{cosets}, we define $C=\\{{\\mathfrak{p}}\\in{\\operatorname{Spec}} T\\mid{\\mathfrak{p}}\\in{\\operatorname{Ass}}(T/rT)\\text{ with }0\\neq r\\in R\\}\\cup{\\operatorname{Ass}} T\\cup{\\mathcal}{Q}_R \\cap \\{P\\}$.\n\nNow, we consider the case $n=2$. \nThen $c=a_1t_1+a_2t_2$ for some $t_1,t_2\\in T$, and\nso $c=(t_1+a_2t)a_1+(t_2-a_1t)a_2$ for any $t\\in T$. \nFollowing the proof of Lemma 4 in~\\cite{heitmann93},\nlet $x_1=t_1+a_2t$ and $x_2=t_2-a_1t$ for some $t$ to be carefully chosen later.\nWe claim that if ${\\mathfrak{p}}\\in C$, then at most one of $a_1$ or $a_2$ is contained in ${\\mathfrak{p}}$.\nThis is clear if ${\\mathfrak{p}}\\cap R=(0)$, and if ${\\operatorname{ht}}({\\mathfrak{p}}\\cap R)=1$,\nthen ${\\mathfrak{p}}\\cap R=pR$ for some prime element $p\\in R$.\nIf $a_1$ and $a_2$ are both in ${\\mathfrak{p}}$ then ${\\mathfrak{a}} \\subset {\\mathfrak{p}}\\cap R=pR$,\ncontradicting that ${\\mathfrak{a}}$ is not contained in a height one prime ideal of $R$.  So we can assume that no ${\\mathfrak{p}}\\in C$ contains both $a_1$ and $a_2$.\n\n\n\n\n\nDefine $\\mathring{R}=R[a_2^{-1},x_1]\\cap R[a_1^{-1},x_2]$ and $S=\\mathring{R}_{{\\mathfrak{m}}\\cap\\mathring{R}}$.\n\n\n\nIf ${\\mathfrak{p}}\\in C$, then $|R/{\\mathfrak{p}}\\cap R|\\leq|R|$ and so its algebraic closure in $T/{\\mathfrak{p}}$ has cardinality at most $|R|$ if $R$ is infinite and will be countable if $R$ is finite.  Now let ${\\mathfrak{p}} \\in C$ and suppose $a_2 \\notin {\\mathfrak{p}}$.  Then each choice of $t$ modulo ${\\mathfrak{p}}$ gives a different $x_1$ modulo ${\\mathfrak{p}}$, and so for all but $\\max(\\aleph_0,|R|)$ choices of $t$ modulo ${\\mathfrak{p}}$, the element $x_1 + {\\mathfrak{p}}$ of $T/{\\mathfrak{p}}$ will be transcendental over $R/{\\mathfrak{p}}\\cap R$.\nFor each ${\\mathfrak{p}}\\in C$ with $a_2\\not\\in{\\mathfrak{p}}$,\nlet $D^1_{{\\mathfrak{p}}}\\subset T$ be a full set of coset representatives for those choices of $t$\nsuch that $x_1+{\\mathfrak{p}}$ is algebraic over $R/{\\mathfrak{p}}\\cap R$.\nSimilarly, for each ${\\mathfrak{p}}\\in C$ that does not contain $a_1$\nlet $D^2_{{\\mathfrak{p}}}$ be a full set of coset representatives\nfor the elements $t$ that make $x_2+{\\mathfrak{p}}$ algebraic over $R/{\\mathfrak{p}}\\cap R$,\nand define $D=\\bigcup\\{D^1_{{\\mathfrak{p}}}\\cup D^2_{{\\mathfrak{p}}}\\mid{\\mathfrak{p}}\\in C\\}$.\nThen $|C\\times D|\\leq \\max(\\aleph_0,|R|)$ and so using Lemma~\\ref{countavoidance}\nif $R$ is countable and Lemma~\\ref{avoidance} otherwise, we can choose $t$ so that, for ${\\mathfrak{p}} \\in C$, we have \n$x_1+{\\mathfrak{p}}$ is transcendental over $R/{\\mathfrak{p}} \\cap R$ if $a_2 \\not\\in {\\mathfrak{p}}$ and $x_2+{\\mathfrak{p}}$ is transcendental over $R/{\\mathfrak{p}}\\cap R$ if $a_1 \\not\\in {\\mathfrak{p}}$.  It is shown in Lemma 4 of~\\cite{heitmann93} that for such a choice of $t$, $S$ is an N-subring and prime elements in $R$ are prime in $S$.\n\nSuppose $f \\in P \\cap \\mathring{R}$.  Then $f \\in R[a_1^{-1},x_2]$, and so there is a positive integer $r$ such that $a_1^rf \\in R[x_2]$.  By the way $t$ was chosen, $x_2 + P$ is transcendental over $R/R \\cap P$ and so the coefficients of $a_1^rf$ are in $R \\cap P = (0)$.  As $a_1$ is not a zerodivisor, we have that the coefficients of $f$ are all $0$.  It follows that $P \\cap \\mathring{R} = (0)$ and so we have $P \\cap S = (0)$.\n\n\n\n\n\nNow suppose ${\\mathfrak{q}} \\in {\\mathcal} Q_R$.  If $a_1 \\notin {\\mathfrak{q}}$ then, by the way $t$ was chosen, $x_2 +{\\mathfrak{q}}$ is transcendental over $R/{\\mathfrak{q}}\\cap R$.  Let $f \\in {\\mathfrak{q}} \\cap \\mathring{R}$.\nViewing $f$ as an element of $R[x_2,a_1^{-1}]$, for sufficiently large $k$ we have that\n$(a_1)^k f \\in R[x_2]$.  It follows that the coefficients of $(a_1)^k f$ are in ${\\mathfrak{q}} \\cap R = pR$ for some prime element $p$ of $R$.  Hence we have $f \\in pR[x_2,a_1^{-1}]$.  Similarly, if $a_2 \\not\\in {\\mathfrak{q}}$, then $f \\in pR[x_1,a_2^{-1}]$.  If $a_2 \\in {\\mathfrak{q}}$ then $a_2 \\in R \\cap {\\mathfrak{q}} = pR$, and so $p$ is a unit in $R[x_1,a_2^{-1}]$ and we have $pR[x_1,a_2^{-1}] = R[x_1,a_2^{-1}]$.  In any case, $f \\in pR[x_2,a_1^{-1}] \\cap p R[x_1,a_2^{-1}] = p\\mathring{R}$, and it follows that ${\\mathfrak{q}} \\cap \\mathring{R} = p\\mathring{R}$ and so ${\\mathfrak{q}} \\cap S = pS$.  We will define ${\\mathcal} Q_S$ to contain ${\\mathcal} Q_R$; then each height one prime ideal of $S$ generated by a prime element of $R$ will have a corresponding element in ${\\mathcal} Q_S$.\n\n\nFor every height one prime ideal of $S$ whose intersection with $R$ is the zero ideal, we use the same procedure as in Lemma~\\ref{cosets}\nto choose an appropriate corresponding ${\\mathfrak{q}}_p \\in {\\operatorname{Spec}}_d T$.\nWe define ${\\mathcal} Q_S$ to be the union of the set of these prime ideals of $T$ with ${\\mathcal} Q_R$.\nThen $S$ is our desired $A_+$-extension of $R$ and the $n=2$ case is shown.\n\n\n\nFor $n>2$, we construct an $A_+$-extension $R''$ of $R$ with $R\\subseteq R''\\subset T$, $P \\cap R'' = (0)$, and such that there exists $c^*\\in R''$ and an $(n-1)$ generated ideal ${\\mathfrak{b}}$ of $R''$ with $c^*\\in{\\mathfrak{b}} T$.  By induction, there exists an $A_+$-extension $S$ of $R''$ such that $c^* \\in {\\mathfrak{b}} S$ and $P \\cap S = (0)$.  We then show that $c \\in {\\mathfrak{a}} S$, which will complete the proof. \n\nLet ${\\mathfrak{a}}=(a_1, \\ldots ,a_n)R$ and let ${\\mathfrak{b}}=(a_1,\\ldots,a_{n-1})R$.\nWe first assume that ${\\mathfrak{b}}$ is not contained in a height one prime ideal of $R$.\nSince $c\\in{\\mathfrak{a}} T\\cap R$ we can write $c=\\sum a_it_i$ where $t_i\\in T$.\nWe define $\\tilde{t}=t_n+\\sum_{i=1}^{n-1}a_iu_i$ where $u_i\\in T$ will be chosen later, \nand we define $c^*=c-\\tilde{t}a_n$.  Note that $c^* \\in {\\mathfrak{b}} T$ as desired.  Now we work to define $R''$ so that it is an $A_+$-extension of $R$, $c^* \\in R''$, and $P \\cap R'' = (0)$.\nSince we are assuming that ${\\mathfrak{b}}$ is not contained in a height one prime ideal of $R$, we cannot have a ${\\mathfrak{p}} \\in C$ that contains all of $a_1, a_2, \\ldots , a_{n - 1}$.  Now, as in the $n = 2$ case, choose $u_1 \\in T$ so that $t_n + a_1u_1$ is transcendental over $R/ {\\mathfrak{p}} \\cap R$ for all ${\\mathfrak{p}} \\in C$ satisfying $a_1 \\not\\in {\\mathfrak{p}}$.\n\n\n\n\n\n\n\nWe then repeat the process and choose $u_2$ so that\n$t_n+a_1u_1+a_2u_2$ is transcendental over $R/{\\mathfrak{p}}\\cap R$ whenever ${\\mathfrak{p}}\\in C$ and $a_2\\not\\in{\\mathfrak{p}}$.\nNow if $a_2\\in{\\mathfrak{p}}$ and $a_1\\not\\in{\\mathfrak{p}}$, then $a_2u_2\\in{\\mathfrak{p}}$\nand $t_n+a_1u_1+a_2u_2+{\\mathfrak{p}}$ is transcendental over $R/{\\mathfrak{p}}\\cap R$, and\nso transcendental elements will remain transcendental as additional terms are added.\nContinuing the process until all $u_i$ have been chosen,\n we obtain $\\tilde{t}$ so that $\\tilde{t} + {\\mathfrak{p}}$ is transcendental over $R/{\\mathfrak{p}} \\cap R$ for all ${\\mathfrak{p}} \\in C$.\nWe then define $R''=R[\\tilde{t}]_{{\\mathfrak{m}}\\cap R[\\tilde{t}]}$, and we note that $c^* \\in R''$.  As in the $n = 2$ case, we have that $P \\cap R'' = (0)$.\nFollowing the proof of Lemma~\\ref{cosets},\n$R''$ can be shown to be an $A_+$-extension of $R$.  By induction, there exists an $A_+$-extension $S$ of $R''$ such that $c^* \\in {\\mathfrak{b}} S$ and $P \\cap S = (0)$.  Since $c = c^* + \\tilde{t} a_n$, we have that $c \\in {\\mathfrak{a}} S$ as desired.\n\nNow suppose that ${\\mathfrak{b}}$ is contained in a height one prime ideal of $R$.\nBy factoring out common divisors \nwe obtain an element $r\\in R$ and an ideal ${\\mathfrak{b}}^* = (z_1, \\ldots, z_{n - 1})$ of $R$\nsuch that ${\\mathfrak{b}}=r{\\mathfrak{b}}^*$, $a_i = rz_i$ for all $i = 1,2, \\ldots, n-1$, and ${\\mathfrak{b}}^*$ is not contained in a height one prime ideal of $R$.  Define $w = \\sum_{i = 1}^{n - 1} t_iz_i$.  Then $c = rw + t_na_n$.  We now use the $n = 2$ case with ${\\mathfrak{a}} = (r,a_n)$ to find an $A_+$-extension $R'''$ of $R$ such that $P \\cap R''' = (0)$ and $c = v_1a_n + v_2r$ with $v_1$ and $v_2$ in $R'''$.  Note that ${\\mathfrak{b}}^*R'''$ is not contained in a height one prime ideal of $R'''$, so we can use the previous case with ${\\mathfrak{b}} = {\\mathfrak{b}} ^*R'''$, ${\\mathfrak{a}} = (z_1, z_2, \\ldots ,z_{n - 1},a_n)R'''$ and $c = v_2$ to get our $A_+$-extension $R''$ of $R$, and our element $c^* \\in {\\mathfrak{b}}^* T$.  By induction, we get $S$.  We need only show that $c \\in {\\mathfrak{a}} S$.  In our case, $v_2 = w - \\tilde{t}a_n$, and so $v_2 \\in {\\mathfrak{b}}^* S + a_nS$, and so we have $v_2r \\in {\\mathfrak{b}} S + ra_nS$.  It follows that $c = v_1a_n + v_2r \\in {\\mathfrak{a}} S$ as desired.\n\n\n\n\n\n\n\n\n\\end{proof}\n\n\n\n\nRecall that, at the end of our construction, we want $\\alpha(A,(0))= t$ and $\\alpha(A,pA) = d - 1$ for all prime elements $p$ of $A$.  We will construct $A$ to be a UFD and to satisfy condition (iv) of $Z_d$-subrings, and so $\\alpha(A,pA)\\geq d-1$ for all prime elements $p$ of $A$.  For the case where $d - 1 = t$, we will construct $A$ so that $\\alpha (A,(0)) \\leq d - 1$.  In order to ensure this, we simply need $A$ to contain a nonzero element of every height $d$ prime ideal of $T$.  The following lemma allows us to adjoin nonzero elements of the height $d$ prime ideals of $T$ to $A$. Then, by Matsumura's inequality, we have $\\alpha(A,(0)) \\geq \\alpha(A,pA)$ for all prime elements $p$ of $A$, and so we get that $d - 1 \\geq \\alpha(A,(0)) \\geq \\alpha(A,pA) \\geq d - 1$ and we can conclude that $\\alpha(A,(0))=\\alpha(A,pA) = d - 1$ as desired.  For the case $d - 1 \\neq t$, we construct $A$ so that there is a prime ideal $P$ of $T$ of height $t$ such that $P \\cap A = (0)$, so that $\\alpha(A,(0)) \\geq t$.  In addition, if ${\\mathfrak{q}}$ is a prime ideal of $T$ whose height is greater than $d$ and ${\\mathfrak{q}} \\not\\subseteq P$, we use Lemma \\ref{diffheights} to construct $A$ so that ht$({\\mathfrak{q}} \\cap A) > 1$.  This ensures that $\\alpha(A,(0)) \\leq t$ and that, if ${\\mathfrak{p}}$ is a height one prime ideal of $A$, then $\\alpha(A,{\\mathfrak{p}}) \\leq d - 1$.\n\n\n\\begin{lemma}\\label{dropgeneric}\nUnder Assumption~\\ref{assume}, let $(T,{\\mathfrak{m}})$ be such that, for all ${\\mathfrak{p}}\\in{\\operatorname{Ass}} T$, ${\\operatorname{ht}}{\\mathfrak{p}}\\leq d-1$, and suppose that $T$ satisfies the condition that if $z$ is a regular element of $T$ and $Q \\in {\\operatorname{Ass}}(T/zT)$, then ${\\operatorname{ht}} Q \\leq d$.  Let $P$  be a nonmaximal prime ideal of $T$ such that $P \\cap R = (0)$, and let ${\\mathfrak{q}} \\in {\\operatorname{Spec}}_r T$ with $d \\leq r \\leq \\dim T$ and such that ${\\mathfrak{q}} \\not\\subseteq P$, and ${\\mathfrak{q}}\\cap R=(0)$.  Then there exists an $A_+$-extension $S$ of $R$ such that  $S \\cap P = (0)$ and ${\\mathfrak{q}}\\cap S\\neq (0)$.\n\\end{lemma}\n\\begin{proof}\nLet $C$ be the same set detailed in the proof of Lemma~\\ref{cosets}.  Our hypotheses give that ${\\mathfrak{q}} \\not\\subseteq {\\mathfrak{p}}$ for all ${\\mathfrak{p}} \\in C$.  Using Lemma~\\ref{countavoidance} or Lemma~\\ref{avoidance}, choose $x\\in{\\mathfrak{q}}$ such that $x+{\\mathfrak{p}}$ is transcendental over $R/{\\mathfrak{p}}\\cap R$ for every ${\\mathfrak{p}}\\in C$.  We let $S=R[x]_{{\\mathfrak{m}}\\cap R[x]}$.  As in the proof of Lemma~\\ref{cosets}, $S$ will be our desired $A_+$-extension of $R$.\n\\end{proof}\n\nThe following lemma allows us to control the formal fibers at height one prime ideals.  We want to make sure that there are no prime ideals of $T$ with height greater than $d$ in the formal fiber of a height one prime ideal of our final ring.  We do this in the following lemma by adjoining elements of prime ideals of $T$ of height greater than $d$.\n\n\n\\begin{lemma}\\label{diffheights}\nUnder Assumption~\\ref{assume}, let $(T,{\\mathfrak{m}})$ be such that, for all ${\\mathfrak{p}}\\in{\\operatorname{Ass}} T$, ${\\operatorname{ht}}{\\mathfrak{p}}\\leq d-1$, and suppose that $T$ satisfies the condition that if $z$ is a regular element of $T$ and $Q \\in {\\operatorname{Ass}}(T/zT)$, then ${\\operatorname{ht}} Q \\leq d$.  Let $P$  be a nonmaximal prime ideal of $T$ such that $P \\cap R = (0)$.  Let ${\\mathfrak{q}}\\in{\\operatorname{Spec}}_{r} T$ with $d + 1 \\leq r \\leq \\dim T$, ${\\mathfrak{q}} \\not\\subseteq P$, and ${\\operatorname{ht}}({\\mathfrak{q}} \\cap R) \\leq 1$.  Then there exists an $A_+$-extension $S$ of $R$ such that $P \\cap S = (0)$ and ${\\operatorname{ht}}({\\mathfrak{q}} \\cap S) > 1$. \n\\end{lemma}\n\\begin{proof}\n\n\n\n\nFirst suppose ${\\mathfrak{q}}\\cap R=(0)$. Then use Lemma~\\ref{dropgeneric} to find an $A_+$-extension $S_0$ such that ${\\mathfrak{q}}\\cap S_0\\neq(0)$ and $P \\cap S_0 = (0)$.  Now, ${\\operatorname{ht}}({\\mathfrak{q}}\\cap S_0)\\geq 1$.  If ${\\operatorname{ht}}({\\mathfrak{q}}\\cap S_0)>1$, then $S = S_0$ and we are done.  So consider the case where ${\\operatorname{ht}}({\\mathfrak{q}}\\cap S_0)=1$.  Then, since $S_0$ is a UFD, ${\\mathfrak{q}}\\cap S_0=pS_0$ for some prime element $p\\in S_0$.  Let ${\\mathfrak{q}}_p$ be the element of ${\\mathcal}{Q}_{S_0}$ corresponding to $pS_0$.  Now we let $C=\\{{\\mathfrak{p}}\\in{\\operatorname{Spec}} T\\mid{\\mathfrak{p}}\\in{\\operatorname{Ass}}(T/rT)\\text{ with } 0\\neq r\\in S_0\\}\\cup{\\operatorname{Ass}} T\\cup{\\mathcal}{Q}_{S_0}\\cup \\{P\\}$ and, as before, adjoin some element $x\\in{\\mathfrak{q}}$ such that $x+{\\mathfrak{p}}$ is transcendental over $S_0/{\\mathfrak{p}}\\cap S_0$ for every ${\\mathfrak{p}}\\in C$.  We let $S=S_0[x]_{{\\mathfrak{m}}\\cap S_0[x]}$.  Then $S$ is an $A_+$-extension of $S_0$, which is an $A_+$-extension of $R$, and so $S$ is an $A_+$-extension of $R$.  Since $P \\in C$, we have $P \\cap S = (0)$.  Note that $pS \\subseteq {\\mathfrak{q}} \\cap S$ and that $pS$ is a height one prime ideal of $S$.  Clearly, $x \\in {\\mathfrak{q}} \\cap S$.  If $x \\in pS$ then $x \\in {\\mathfrak{q}}_p$, contradicting that $x+{\\mathfrak{q}}_p$ is transcendental over $S_0/{\\mathfrak{q}}_p\\cap S_0$.  It follows that $pS$ is strictly contained in ${\\mathfrak{q}} \\cap S$ and so ht$({\\mathfrak{q}} \\cap S) > 1$.\n\n\\end{proof}\n\n\\begin{lemma} \\label{doubleext}\nUnder Assumption~\\ref{assume}, let $(T,{\\mathfrak{m}})$ be such that ${\\operatorname{depth}} T > 1$ and, for all ${\\mathfrak{p}}\\in{\\operatorname{Ass}} T$, ${\\operatorname{ht}}{\\mathfrak{p}}\\leq d-1$, and suppose that $T$ satisfies the condition that if $z$ is a regular element of $T$ and $Q \\in {\\operatorname{Ass}}(T/zT)$, then ${\\operatorname{ht}} Q \\leq d$. Let $P$  be a nonmaximal prime ideal of $T$ such that $P \\cap R = (0)$, and let $t\\in T$.  If ${\\mathfrak{q}}\\in{\\operatorname{Spec}}_dT$ with ${\\mathfrak{q}} \\not\\subseteq P$, then there exists an $A_+$-extension S of R such that $t+{\\mathfrak{m}}^2\\in{\\operatorname{Image}}(S\\rightarrow T/{\\mathfrak{m}}^2)$, $P \\cap S = (0)$, and ${\\mathfrak{q}}\\cap S\\neq (0)$.  If ${\\mathfrak{q}}\\in{\\operatorname{Spec}}_{r}T$ with $d + 1 \\leq r \\leq \\dim T$, and ${\\mathfrak{q}} \\not\\subseteq P$, then there exists an $A_+$-extension S of R such that $t+{\\mathfrak{m}}^2\\in{\\operatorname{Image}}(S\\rightarrow T/{\\mathfrak{m}}^2)$, $P \\cap S = (0)$, and ht$({\\mathfrak{q}}\\cap S) > 1$.\n\\end{lemma}\n\\begin{proof}\nIf ${\\mathfrak{q}} \\in {\\operatorname{Spec}}_dT$, use Lemma~\\ref{cosets} to find an $A_+$-extension $R'$ of $R$ such that $t+{\\mathfrak{m}}^2\\in{\\operatorname{Image}}(R'\\rightarrow T/{\\mathfrak{m}}^2)$ and $P \\cap R' = (0)$.  If ${\\mathfrak{q}}\\cap R'\\neq(0)$, then $S = R'$ and we are done. If ${\\mathfrak{q}}\\cap R'=(0)$, then we use Lemma~\\ref{dropgeneric} to find an $A_+$-extension $S$ of $R'$ such that ${\\mathfrak{q}}\\cap S\\neq(0)$ and $P \\cap S = (0)$.\n\nIf ${\\mathfrak{q}}\\in{\\operatorname{Spec}}_{r}T$, where $d + 1 \\leq r \\leq \\dim T$ then, as before, first use Lemma~\\ref{cosets} to find an $A_+$-extension $R'$ of $R$ such that $t+{\\mathfrak{m}}^2\\in{\\operatorname{Image}}(R'\\rightarrow T/{\\mathfrak{m}}^2)$ and $P \\cap R' = (0)$.  If ht$({\\mathfrak{q}}\\cap R') > 1$, then $S = R'$ and we are done.  If ht$({\\mathfrak{q}}\\cap R') \\leq 1$ then use Lemma \\ref{diffheights} to find an $A_+$-extension of $R'$ such that $P \\cap S = (0)$ and ht$({\\mathfrak{q}} \\cap S) > 1$.\n\n\\end{proof}\n\nFor the proof of our main theorem, we apply Lemmas~\\ref{h4} and \\ref{doubleext} infinitely often.  The following result, adapted from Lemma 6 of~\\cite{heitmann93}, will allow us to do so.\n\n\\begin{lemma} \n\\label{union}\nLet $(T,{\\mathfrak{m}})$ be a complete local ring and $R_0$ a $Z_d$-subring of $T$ with distinguished set ${\\mathcal}{Q}_{R_0}$.  Let $P$ be a nonmaximal ideal of $T$ such that $P \\cap R_0 = (0)$.  Let $\\Omega$ be a well-ordered set with least element $0$ and assume either $\\Omega$ is countable or, for all $\\beta\\in\\Omega, |\\{\\gamma\\in\\Omega \\mid\\gamma<\\beta\\}|<|T/{\\mathfrak{m}}|$.  Suppose $\\{R_{\\beta}\\mid \\beta\\in\\Omega\\}$ is an ascending collection of rings such that $R_{\\alpha} \\cap P = (0)$ for every $\\alpha \\in \\Omega$ and such that, if $\\beta$ is a limit ordinal, then $R_{\\beta}=\\bigcup_{\\gamma<\\beta}R_{\\gamma}$,\nwith ${\\mathcal} Q_{R_{\\beta}}$ defined as $\\bigcup_{\\gamma<\\beta}Q_{R_{\\gamma}}$, \nwhile if $\\beta=\\gamma+1$ is a successor ordinal then $R_{\\beta}$ is an $A_+$-extension of $R_{\\gamma}$.\n\nThen $S=\\bigcup_{\\beta \\in \\Omega}  R_{\\beta}$ satisfies all the conditions to be a $Z_d$-subring of $T$ with distinguished set ${\\mathcal} Q_{S} = \\bigcup_{\\beta \\in \\Omega} Q_{R_{\\beta}} $except the cardinality condition. Instead, $|S|\\leq\\sup(\\aleph_0, |R_0|,|\\Omega|)$.  Furthermore, $P \\cap S = (0)$, elements which are prime in some $R_{\\beta}$ remain prime in $S$, and ${\\mathcal} Q_{R_0} \\subseteq {\\mathcal} Q_S$.\n\\end{lemma}\n\n\\begin{proof}  First note that, since $R_{\\alpha} \\cap P = (0)$ for every $\\alpha \\in \\Omega$, it is clear that $S \\cap P = (0)$.  We now follow the proof of Lemma 6 in~\\cite{heitmann93}, adding in additional steps where necessary.  Define $\\Omega' =  \\Omega \\cup \\{\\delta\\}$ and declare that $\\delta > \\alpha$ for all $\\alpha \\in \\Omega$.  Now define $R_{\\delta} = S$.\nWe will show that, for all $\\alpha \\in \\Omega'$, $R_{\\alpha}$ is a $Z_d$-subring of $T$ with some distinguished set ${\\mathcal}{Q}_{R_{\\alpha}}$ except for possibly condition (i) and that $|R_{\\alpha}| \\leq \\sup(\\aleph_0,|R_0|, |\\{\\beta \\in \\Omega \\, | \\, \\beta < \\alpha\\}|)$.  Furthermore, we will show that, for $\\beta < \\alpha$, we have ${\\mathcal} Q_{R_{\\beta}} \\subseteq {\\mathcal} Q_{R_{\\alpha}}$ and prime elements of $R_{\\beta}$ remain prime in $R_{\\alpha}$.  We proceed with transfinite induction, the base case being trivial.\n\nAssume that $\\alpha \\in \\Omega'$ and that the inductive hypotheses hold for every $\\beta < \\alpha$.  In the proof of Lemma 6 in~\\cite{heitmann93}, it is shown that $R_{\\alpha}$ satisfies the conditions for being a $Z_d$-subring of $T$ except for conditions (i) and (iv), that the cardinality condition given in the preceding paragraph holds, and that, if $\\beta < \\alpha$, every prime element of $R_{\\beta}$ is prime in $R_{\\alpha}$.  \n\nIf $\\alpha = \\gamma + 1$ is a successor ordinal, then $R_{\\alpha}$ is an $A_+$-extension of $R_{\\gamma}$, and so $R_{\\alpha}$ satisfies condition (iv) of Definition~\\ref{zsub} and ${\\mathcal} Q_{R_{\\gamma}} \\subseteq {\\mathcal} Q _{R_{\\alpha}}$.  \n\nIf $\\alpha$ is a limit ordinal, then $R_{\\alpha} = \\bigcup_{\\gamma<\\alpha}R_{\\gamma}$, and we have ${\\mathcal} Q_{R_{\\alpha}} = \\bigcup_{\\gamma<\\alpha} {\\mathcal} Q_{R_{\\gamma}}$.  By definition,\n${\\mathcal} Q_{R_{\\gamma}} \\subseteq {\\mathcal} Q _{R_{\\alpha}}$ for all $\\gamma < \\alpha$.  We have left to show that ${\\mathcal}{Q}_{R_{\\alpha}}$ is a distinguished set for $R_{\\alpha}$.  Let ${\\mathfrak{q}}_p \\in {\\mathcal}{Q}_{R_{\\alpha}}$.  Then ${\\mathfrak{q}}_p \\in {\\mathcal}{Q}_{R_{\\gamma}}$ for some $\\gamma < \\alpha$.  Therefore, ${\\mathfrak{q}}_p \\cap R_{\\gamma} = pR_{\\gamma}$ for some prime element $p$ of $R_{\\gamma}$.  We will show that ${\\mathfrak{q}}_p \\cap R_{\\alpha} = pR_{\\alpha}$.  Clearly, $pR_{\\alpha} \\subseteq {\\mathfrak{q}}_p \\cap R_{\\alpha}$.  If $x \\in R_{\\alpha} \\cap {\\mathfrak{q}}_p$, then $x \\in R_{\\beta}$ for some $\\beta < \\alpha$.  Define $\\lambda = \\max\\{\\beta,\\gamma\\}$.  Then $p,x \\in R_{\\lambda}$ and ${\\mathfrak{q}}_p \\in {\\mathcal}{Q}_{R_{\\lambda}}$.  It follows that ${\\mathfrak{q}}_p \\cap R_{\\lambda} = pR_{\\lambda}$, so $x \\in {\\mathfrak{q}}_p \\cap R_{\\lambda} = pR_{\\lambda} \\subseteq pR_{\\alpha}$, and we have that ${\\mathfrak{q}}_p \\cap R_{\\alpha} = pR_{\\alpha}$ as desired.  It is not difficult to show that if ${\\mathfrak{q}}_p, {\\mathfrak{q}}_p' \\in {\\mathcal}{Q}_{R_{\\alpha}}$ with ${\\mathfrak{q}}_p \\cap R_{\\alpha} = {\\mathfrak{q}}_p' \\cap R_{\\alpha}$ then ${\\mathfrak{q}}_p = {\\mathfrak{q}}_p'$, and that if ${\\mathfrak{p}} = pR_{\\alpha}$ is a height one prime ideal of $R_{\\alpha}$, then there is a ${\\mathfrak{q}}_p \\in {\\mathcal}{Q}_{R_{\\alpha}}$ such that ${\\mathfrak{q}}_p \\cap R_{\\alpha} = {\\mathfrak{p}}$.  Hence ${\\mathcal}{Q}_{R_{\\alpha}}$ is a distinguished set for $R_{\\alpha}$.\n\nBy induction, then, we have that $S$ satisfies all of the desired properties.\n\n\\end{proof}\n\n\\begin{lemma}\\label{closeideals}\nUnder Assumption~\\ref{assume}, let $(T,{\\mathfrak{m}})$ be such that ${\\operatorname{depth}} T > 1$ and, for all ${\\mathfrak{p}}\\in{\\operatorname{Ass}} T$, ${\\operatorname{ht}}{\\mathfrak{p}}\\leq d-1$, and suppose that $T$ satisfies the condition that if $z$ is a regular element of $T$ and $Q \\in {\\operatorname{Ass}}(T/zT)$, then ${\\operatorname{ht}} Q \\leq d$.  Let $P$  be a nonmaximal prime ideal of $T$ such that $P \\cap R = (0)$ and let $t+{\\mathfrak{m}}^2\\in T/{\\mathfrak{m}}^2$.  If ${\\mathfrak{q}}\\in{\\operatorname{Spec}}_d T$ with ${\\mathfrak{q}} \\not\\subseteq P$, then there exists an $A_+$-extension $S$ of $R$ such that $t+{\\mathfrak{m}}^2\\in{\\operatorname{Image}}(S\\rightarrow T/{\\mathfrak{m}}^2)$, ${\\mathfrak{q}}\\cap S\\neq(0)$, $P \\cap S = (0)$, and for every finitely generated ideal ${\\mathfrak{a}}$ of $S$, ${\\mathfrak{a}} T\\cap S={\\mathfrak{a}}$.  If ${\\mathfrak{q}}\\in{\\operatorname{Spec}}_{r} T$ with $d + 1 \\leq r \\leq \\dim T$ and ${\\mathfrak{q}} \\not\\subseteq P$, then there exists an $A_+$-extension $S$ of $R$ such that $t+{\\mathfrak{m}}^2\\in{\\operatorname{Image}}(S\\rightarrow T/{\\mathfrak{m}}^2)$, ht$({\\mathfrak{q}}\\cap S) > 1$, $P \\cap S = (0)$, and for every finitely generated ideal ${\\mathfrak{a}}$ of $S$, ${\\mathfrak{a}} T\\cap S={\\mathfrak{a}}$.\n\\end{lemma}\n\\begin{proof}\nIf ${\\mathfrak{q}} \\in{\\operatorname{Spec}}_d T$, employ Lemma~\\ref{doubleext} to obtain an $A_+$-extension $R_0$ of $R$ such that $t+{\\mathfrak{m}}^2\\in{\\operatorname{Image}}(R_0\\rightarrow T/{\\mathfrak{m}}^2)$, $P \\cap R_0 = (0)$, and ${\\mathfrak{q}}\\cap R_0\\neq(0)$. \nIf ${\\mathfrak{q}} \\in{\\operatorname{Spec}}_{r} T$ with $d + 1 \\leq r \\leq \\dim T$, employ Lemma~\\ref{doubleext} to obtain an $A_+$-extension $R_0$ of $R$ such that $t+{\\mathfrak{m}}^2\\in{\\operatorname{Image}}(R_0\\rightarrow T/{\\mathfrak{m}}^2)$, $P \\cap R_0 = (0)$, and ht$({\\mathfrak{q}}\\cap R_0) > 1$.  Let $\\Omega=\\{({\\mathfrak{a}},c)\\mid{\\mathfrak{a}}$ finitely generated ideal of $R_0 \\text{ and }c\\in {\\mathfrak{a}} T\\cap R_0\\}$. Then $|\\Omega|=|R_0|$ and so either $\\Omega$ is countable or $|\\Omega|<|T/{\\mathfrak{m}}|$. Well-order $\\Omega$, letting 0 designate its initial  element, in such a way that $\\Omega$ does not have a maximal element; then it clearly satisfies the hypothesis of Lemma~\\ref{union}.  We will recursively define an increasing chain of rings with one ring for every element of $\\Omega$.  We begin with $R_0$. If $\\beta=\\gamma+1$ is a successor ordinal and $\\gamma=({\\mathfrak{a}},c)$, then we choose $R_{\\beta}$ to be an $A_+$-extension of $R_{\\gamma}$ given by Lemma~\\ref{h4} such that $c\\in{\\mathfrak{a}} R_{\\beta}$ and $P \\cap R_{\\beta} = (0)$. If $\\beta$ is a limit ordinal, define $R_{\\beta}=\\bigcup_{\\gamma<\\beta}R_{\\gamma}$ and ${\\mathcal} Q_{R_{\\beta}} = \\bigcup_{\\gamma<\\beta}{\\mathcal} Q_{R_{\\gamma}}$. Set $R_1=\\bigcup R_{\\beta}$.  By Lemma~\\ref{union}, we see that $R_1$ is an $A_+$-extension of $R_0$ and $P \\cap R_1 = (0)$.  Also if ${\\mathfrak{a}}$ is any finitely generated ideal of $R_0$ and $c\\in {\\mathfrak{a}} T\\cap R_0$, then $({\\mathfrak{a}},c)=\\gamma$ for some $\\gamma \\in \\Omega$.  Then for some $\\beta>\\gamma$, $c\\in{\\mathfrak{a}} R_{\\beta}\\subseteq {\\mathfrak{a}} R_1$.  Thus ${\\mathfrak{a}} T\\cap R_0\\subseteq{\\mathfrak{a}} R_1$.\n\nWe repeat the process to obtain an $A_+$-extension $R_2$ of $R_1$ such that $P \\cap R_2 = (0)$ and ${\\mathfrak{a}} T\\cap R_1\\subseteq{\\mathfrak{a}} R_2$ for every finitely generated ideal ${\\mathfrak{a}}$ of $R_1$.  Continue recursively to obtain an ascending chain $R_0\\subseteq R_1\\subseteq \\cdots$ such that $P \\cap R_n = (0)$ and ${\\mathfrak{a}} T\\cap R_n\\subset{\\mathfrak{a}} R_{n+1}$ for every finitely generated ideal ${\\mathfrak{a}}$ of $R_n$.  Then by Lemma~\\ref{union}, $S=\\bigcup R_i$ with ${\\mathcal} Q_{S} = \\bigcup {\\mathcal} Q_{R_{i}}$ is an $A_+$-extension of $R_0$, and so also of $R$, and $P \\cap S = (0)$.  Further, if ${\\mathfrak{a}}$ is a finitely generated ideal of $S$, then some $R_n$ contains a generating set $\\{a_1, \\ldots ,a_k\\}$ for ${\\mathfrak{a}}$.  If $c\\in{\\mathfrak{a}} T\\cap S$, then $c\\in R_m$ for some $m\\geq n$, so $c\\in(a_1,\\ldots ,a_k)T\\cap R_m   \\subseteq (a_1, \\ldots ,a_k)R_{m+1}\\subseteq {\\mathfrak{a}}$. Thus ${\\mathfrak{a}} T\\cap S={\\mathfrak{a}}$.  To see that ht$({\\mathfrak{q}}\\cap R_0) > 1$ implies ht$({\\mathfrak{q}}\\cap S) > 1$, let $(0) \\subset pR_0 \\subset {\\mathfrak{q}} \\cap R_0$ be a strictly increasing chain of prime ideals of $R_0$, and let $x \\in {\\mathfrak{q}} \\cap R_0$ with $x \\not\\in pR_0$.  As prime elements in $R_0$ are prime in $S$, the prime factorization of $x$ in $R_0$ is the prime factorization of $x$ in $S$ and so $x \\not\\in pS$ and we have $(0) \\subset pS \\subset {\\mathfrak{q}} \\cap S$ is a strictly increasing chain of prime ideals of $S$.\n\\end{proof}\n\n\n\n\n\n\n\n\\section{The Main Theorem and Corollaries}\n\n\\begin{theorem}\\label{bigthm}\n  Let $(T,{\\mathfrak{m}})$ be a complete local equidimensional ring such that $\\dim T\\geq 2$ and ${\\operatorname{depth}} T>1$.  Suppose that no integer of $T$ is a zerodivisor in $T$ and $|T|=|T/{\\mathfrak{m}}|$.  Let $d$ and $t$ be integers such that $1 \\leq d \\leq \\dim T - 1$, $0 \\leq t \\leq \\dim T - 1$, and $d - 1 \\leq t$.  Assume that, for every ${\\mathfrak{p}} \\in {\\operatorname{Ass}} T$, ht ${\\mathfrak{p}} \\leq d - 1$ and that if $z$ is a regular element of $T$ and $Q \\in {\\operatorname{Ass}} (T/zT)$, then ht $Q \\leq d$.  Then there exists a local UFD A such that $\\widehat{A} = T$, $\\alpha(A,(0)) = t$, and, if ${\\mathfrak{p}} \\in {\\operatorname{Spec}}_1A$, then $\\alpha(A,{\\mathfrak{p}}) = d - 1$.\n\n\\end{theorem}\n\\begin{proof}\nFirst assume $t = d - 1$.  Let $\\Omega_1={\\operatorname{Spec}}_d T$, well-ordered so that each element of $\\Omega_1$ has fewer than $|\\Omega_1|$ predecessors.  \nLet $\\Omega_2=T/{\\mathfrak{m}}^2$, well-ordered so that each element of $\\Omega_2$ has fewer than $|\\Omega_2|$ predecessors.  Because $|\\Omega_1|=|\\Omega_2|$ and we are ordering both sets so that each element of $\\Omega_i$ has fewer than $|\\Omega_i|$ predecessors, we can use $\\mathscr{B}$ as the index set for both of the $\\Omega_i$'s.  Let \n\n", "index": 5, "text": "\n\\[\n\\Omega=\\{({\\mathfrak{q}}_a,t_a)\\mid {\\mathfrak{q}}_a\\in\\Omega_1,t_a\\in\\Omega_2,\\text{ where }a\\in\\mathscr{B}\\}\n\\]\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex3.m1\" class=\"ltx_Math\" alttext=\"\\Omega=\\{({\\mathfrak{q}}_{a},t_{a})\\mid{\\mathfrak{q}}_{a}\\in\\Omega_{1},t_{a}%&#10;\\in\\Omega_{2},\\text{ where }a\\in\\mathscr{B}\\}\" display=\"block\"><mrow><mi mathvariant=\"normal\">\u03a9</mi><mo>=</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mo stretchy=\"false\">(</mo><msub><mi>\ud835\udd2e</mi><mi>a</mi></msub><mo>,</mo><msub><mi>t</mi><mi>a</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>\u2223</mo><mrow><mrow><msub><mi>\ud835\udd2e</mi><mi>a</mi></msub><mo>\u2208</mo><msub><mi mathvariant=\"normal\">\u03a9</mi><mn>1</mn></msub></mrow><mo>,</mo><mrow><mrow><msub><mi>t</mi><mi>a</mi></msub><mo>\u2208</mo><msub><mi mathvariant=\"normal\">\u03a9</mi><mn>2</mn></msub></mrow><mo>,</mo><mrow><mrow><mtext>\u00a0where\u00a0</mtext><mo>\u2062</mo><mi>a</mi></mrow><mo>\u2208</mo><mi class=\"ltx_font_mathscript\">\u212c</mi></mrow></mrow></mrow><mo stretchy=\"false\">}</mo></mrow></mrow></math>", "type": "latex"}, {"file": "1601.07136.tex", "nexttext": "\nwhere $P$ is the height $t$ prime ideal of $T$ chosen previously.  Then, in the construction, whenever $\\beta=\\omega+1$ is a successor ordinal, let $R_{\\beta}$ be an $A_+$-extension of $R_{\\omega}$ chosen in accordance with Lemma~\\ref{closeideals} so that ht$({\\mathfrak{q}}_{\\omega}\\cap R_{\\beta}) > 1$, $P \\cap R_{\\beta} = (0)$, $t_{\\omega}\\in{\\operatorname{Image}}(R_{\\beta}\\rightarrow T/{\\mathfrak{m}}^2)$, and ${\\mathfrak{a}} T \\cap R_{\\beta} = {\\mathfrak{a}} R_{\\beta}$ for every finitely generated ideal ${\\mathfrak{a}}$ of $R_{\\beta}$.  Then, using this adjusted construction, we get a UFD $A$ such that $\\widehat{A} = T$, $P \\cap A = (0)$, and for every ${\\mathfrak{p}} \\in {\\operatorname{Spec}}_1 A$, there is a height $d$ prime ideal of $T$ whose intersection with $A$ is ${\\mathfrak{p}}$.  Moreover, if ${\\mathfrak{q}} \\in {\\operatorname{Spec}}_r T$ with $d + 1 \\leq r \\leq \\dim T$ and ${\\mathfrak{q}} \\not\\subseteq P$, then ht$({\\mathfrak{q}} \\cap A) > 1$.  It follows that $\\alpha(A,(0)) = t$ and $\\alpha(A,{\\mathfrak{p}}) = d - 1$ for all ${\\mathfrak{p}} \\in {\\operatorname{Spec}}_1 A$.\n\\end{proof}\n\n\n\n\n\n\n\n\n\n\\begin{corollary}\\label{equal}\nLet $(T,{\\mathfrak{m}})$ be a complete local equidimensional ring such that $\\dim T\\geq 2$, no integer is a zerodivisor in $T$, ${\\operatorname{depth}} T>1$, and $|T|=|T/{\\mathfrak{m}}|$. Let $d$ be an integer such that $1\\leq d\\leq\\dim T-1$ and assume that, for every ${\\mathfrak{p}}\\in{\\operatorname{Ass}} T$, ${\\operatorname{ht}}{\\mathfrak{p}}\\leq d-1$ and that if $z$ is a regular element of $T$ and $Q \\in {\\operatorname{Ass}}(T/zT)$, then ${\\operatorname{ht}} Q \\leq d$. Then there exists a local unique factorization domain $A$ such that $\\widehat{A}= T$ and for every $pA\\in{\\operatorname{Spec}}_1A$, $\\alpha(A,pA)=\\alpha(A,(0))=d-1$.\n\\end{corollary}\n\nNote that Corollary \\ref{equal} answers the Question stated in the introduction posed by Heinzer, Rotthaus, and Sally in the nonexcellent case.  In particular, it shows that there are nonexcellent local integral domains where the dimension of the generic formal fiber ring is positive and where the set\n\n\n", "itemtype": "equation", "pos": 57976, "prevtext": "\n\n\\noindent well-ordered using $\\mathscr{B}$ as the index set.  Then $\\Omega$ is the diagonal of $\\Omega_1\\times\\Omega_2$. Let 0 designate the first element of $\\Omega$.  Now, $\\Omega$ satisfies the hypothesis of Lemma~\\ref{union}, and we now recursively define a family of rings $\\{R_{\\beta}\\mid\\beta\\in\\Omega\\}$ which also satisfies the hypotheses of Lemma~\\ref{union}.  As in the proof of Theorem 8 in~\\cite{heitmann93}, let $R_0$ be the appropriate localization of the prime subring of $T$: either $\\mathbb{Q}$, $\\mathbb{Z}_{p}$, or $\\mathbb{Z}_{(p)}$ where $p$ is a prime integer.  It is not difficult to verify that $R_0$ is an $N$-subring.  Now, $R_0$ is either dimension $0$ or $1$.  If it is dimension $0$, define ${\\mathcal} Q_{R_0}$ to be the empty set, and if it is dimension $1$, define ${\\mathcal} Q_{R_0}$ to be any height $d$ prime ideal of $T$ that contains a minimal associated prime ideal of $pT$.   Then $R_0$ is a $Z_d$-subring of $T$ with distinguished set ${\\mathcal} Q_{R_0}$.  We will use the shorthand $\\beta=({\\mathfrak{q}}_{\\beta},t_{\\beta})$ for an element of $\\Omega$.  Then, whenever $\\beta=\\omega+1$ is a successor ordinal, we let $R_{\\beta}$ be an $A_+$-extension of $R_{\\omega}$ chosen in accordance with Lemma~\\ref{closeideals} so that ${\\mathfrak{q}}_{\\omega}\\cap R_{\\beta}\\neq(0)$, $t_{\\omega}\\in{\\operatorname{Image}}(R_{\\beta}\\rightarrow T/{\\mathfrak{m}}^2)$, and ${\\mathfrak{a}} T \\cap R_{\\beta} = {\\mathfrak{a}}$ for every finitely generated ideal ${\\mathfrak{a}}$ of $R_{\\beta}$.  Note that in this case (where $t = d - 1$) we do not need to use the $P$ given in Lemma \\ref{closeideals}.  If $\\beta$ is a limit ordinal, choose $R_{\\beta}=\\bigcup_{\\gamma<\\beta}R_{\\gamma}$.  We claim $A=\\bigcup_{\\beta \\in \\Omega} R_{\\beta}$ is the desired example.\n\nBy construction, $A\\rightarrow T/{\\mathfrak{m}}^2$ is onto.  Now let ${\\mathfrak{a}} = (a_1,\\ldots ,a_n)$ be a finitely generated ideal of $A$, and let $x \\in {\\mathfrak{a}} T \\cap A$. Then there is a $\\beta \\in \\Omega$ such that $\\beta$ is a successor ordinal and $x, a_1, \\ldots , a_n \\in R_{\\beta}$, so $x \\in (a_1, \\ldots ,a_n)T \\cap R_{\\beta} = (a_1, \\ldots ,a_n)R_{\\beta} \\subseteq {\\mathfrak{a}}$.  It follows that ${\\mathfrak{a}} T\\cap A={\\mathfrak{a}}$ for all finitely generated ideals of $A$.  Then by Lemma~\\ref{comp}, $\\widehat{A}= T$ and $A$ is Noetherian. By Lemma~\\ref{union}, except for the cardinality condition, $A$ satisfies all the conditions of  being a $Z_d$-subring of $T$ with some distinguished set, which implies that for any ${\\mathfrak{p}}\\in{\\operatorname{Spec}}_1A$, $\\alpha(A,{\\mathfrak{p}})\\geq d-1$. Now let ${\\mathfrak{q}}\\in{\\operatorname{Spec}}_dT$.  Then by our construction there is some $R_{\\beta}$ such that ${\\mathfrak{q}}\\cap R_{\\beta}\\neq(0)$, and so ${\\mathfrak{q}}\\cap A\\neq(0)$.  Thus $\\alpha(A,(0))\\leq d-1$.  Then, by Theorem 1 of~\\cite{matsumura88}, $d-1\\geq\\alpha(A,(0))\\geq\\alpha(A,{\\mathfrak{p}})\\geq d-1.$  Thus, for every ${\\mathfrak{p}}\\in{\\operatorname{Spec}}_1A$, $\\alpha(A,{\\mathfrak{p}})=\\alpha(A,(0))=d-1$.\n\nNow we consider the case $t \\neq d - 1$.  In this case, we adjust the construction described above.  We first find a prime ideal $P$ of $T$ such that ht$P = t$ and $P \\cap R_0 = (0)$.  If $R_0 = \\mathbb{Q}$ or $R_0 = \\mathbb{Z}_p$, then all nonzero elements of $R_0$ are units of $T$, and so we can choose $P$ to be any prime ideal of $T$ with height $t$.   If $R_0 = \\mathbb{Z}_{(p)}$ and $t = 0$, then choose $P$ to be any minimal prime ideal of $T$.  Since $p$ is not a zerodivisor of $T$, we have $P \\cap R_0 = (0)$.  If $R_0 = \\mathbb{Z}_{(p)}$, and $t > 0$ then note that $p$ is contained in finitely many height one prime ideals of $T$, and so there is a height one prime ideal $P_1$ such that $P_1 \\cap R_0 = (0)$.  Now the element $p + P_1$ in $T/P_1$ is contained in finitely many height one prime ideals of $T/P_1$, and so there is a height one prime ideal $\\bar{P}_2$ of $T/P_1$ such that $p + P_1 \\not\\in \\bar{P}_2$.  As $T$ is universally catenary and equidimensional, there is a height two prime ideal $P_2$ of $T$ such that $R_0 \\cap P_2 = (0)$.  Continue in this way to find a height $t$ prime ideal $P$ of $T$ such that $P \\cap R_0 = (0)$.\n\nNow suppose $t = d = \\dim T - 1$.  Then use the same construction described for the $t = d - 1$ case with the following adjustments.  Let $\\Omega_1 = {\\operatorname{Spec}}_d T - \\{P\\}$ where $P$ is the height $t$ prime ideal of $T$ chosen in the above paragraph.  Then, in the construction, whenever $\\beta=\\omega+1$ is a successor ordinal, let $R_{\\beta}$ be an $A_+$-extension of $R_{\\omega}$ chosen in accordance with Lemma~\\ref{closeideals} so that ${\\mathfrak{q}}_{\\omega}\\cap R_{\\beta}\\neq(0)$, $P \\cap R_{\\beta} = (0)$, $t_{\\omega}\\in{\\operatorname{Image}}(R_{\\beta}\\rightarrow T/{\\mathfrak{m}}^2)$, and ${\\mathfrak{a}} T \\cap R_{\\beta} = {\\mathfrak{a}} R_{\\beta}$ for every finitely generated ideal ${\\mathfrak{a}}$ of $R_{\\omega}$.  Then, using this adjusted construction, we get a UFD $A$ such that $\\widehat{A} = T$, $P \\cap A = (0)$, and for every ${\\mathfrak{p}} \\in {\\operatorname{Spec}}_1 A$, there is a height $d = \\dim T - 1$ prime ideal of $T$ whose intersection with $A$ is ${\\mathfrak{p}}$.  It follows that $\\alpha(A,(0)) = t$ and $\\alpha(A,{\\mathfrak{p}}) = d - 1$ for all ${\\mathfrak{p}} \\in {\\operatorname{Spec}}_1 A$.\n\nFinally, consider all other cases.  That is, suppose either $t > d$ or $t = d$ with $t < \\dim T - 1$.  Then use the same construction described for the $t = d - 1$ case with the following adjustments.  Let\n\n", "index": 7, "text": "$$\\Omega_1 = \\{ {\\mathfrak{q}} \\in {\\operatorname{Spec}}_r T \\, | \\, d + 1 \\leq r \\leq \\dim T \\mbox{ and } {\\mathfrak{q}} \\not\\subseteq P  \\}$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex4.m1\" class=\"ltx_Math\" alttext=\"\\Omega_{1}=\\{{\\mathfrak{q}}\\in{\\operatorname{Spec}}_{r}T\\,|\\,d+1\\leq r\\leq\\dim&#10;T%&#10;\\mbox{ and }{\\mathfrak{q}}\\not\\subseteq P\\}\" display=\"block\"><mrow><msub><mi mathvariant=\"normal\">\u03a9</mi><mn>1</mn></msub><mo>=</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mi>\ud835\udd2e</mi><mo>\u2208</mo><mrow><msub><mo>Spec</mo><mi>r</mi></msub><mo>\u2061</mo><mpadded width=\"+1.7pt\"><mi>T</mi></mpadded></mrow></mrow><mo rspace=\"4.2pt\" stretchy=\"false\">|</mo><mrow><mrow><mi>d</mi><mo>+</mo><mn>1</mn></mrow><mo>\u2264</mo><mi>r</mi><mo>\u2264</mo><mrow><mo>dim</mo><mo>\u2061</mo><mrow><mi>T</mi><mo>\u2062</mo><mtext>\u00a0and\u00a0</mtext><mo>\u2062</mo><mi>\ud835\udd2e</mi></mrow></mrow><mo>\u2288</mo><mi>P</mi></mrow><mo stretchy=\"false\">}</mo></mrow></mrow></math>", "type": "latex"}, {"file": "1601.07136.tex", "nexttext": "\n\n\n\\noindent is equal to the set of all of the height one prime ideals of the integral domain.\n\n\\begin{example}\nLet $T=\\mathbb{C}[[x_1, \\ldots ,x_n]]$.  Then, for any $1\\leq d\\leq n-1$, $0 \\leq t \\leq n - 1$ and $d - 1 \\leq t$, we can find a local unique factorization domain $A$ such that $\\widehat{A}= T$, $\\alpha(A,(0))= t$, and $\\alpha(A,pA)=d-1$ for every $pA\\in{\\operatorname{Spec}}_1 A$.  Note that this will also hold true if we replace $\\mathbb{C}$ with any uncountable field.\n\\end{example}\n\n\\begin{example}\nLet $T=\\mathbb{C}[[x,y,z,w]]/(xy-zw)$.  Then there exists a local unique factorization domain $A$ such that $\\widehat{A}= T$ and $\\alpha(A,pA)=\\alpha(A,(0))=2$ for every $pA\\in{\\operatorname{Spec}}_1 A$.\n\\end{example}\n\n\\begin{example}\nLet $T=\\mathbb{C}[[v,w,x,y,z]]/(vx-w^2, xz - y^2)$.  Then there exists a local unique factorization domain $A$ such that $\\widehat{A}= T$, $\\alpha(A,(0))=2$, and $\\alpha(A,pA) = 0$ for every $pA\\in{\\operatorname{Spec}}_1 A$.\n\\end{example}\n\n\\bibliography{references}\n\n\n", "itemtype": "equation", "pos": 60238, "prevtext": "\nwhere $P$ is the height $t$ prime ideal of $T$ chosen previously.  Then, in the construction, whenever $\\beta=\\omega+1$ is a successor ordinal, let $R_{\\beta}$ be an $A_+$-extension of $R_{\\omega}$ chosen in accordance with Lemma~\\ref{closeideals} so that ht$({\\mathfrak{q}}_{\\omega}\\cap R_{\\beta}) > 1$, $P \\cap R_{\\beta} = (0)$, $t_{\\omega}\\in{\\operatorname{Image}}(R_{\\beta}\\rightarrow T/{\\mathfrak{m}}^2)$, and ${\\mathfrak{a}} T \\cap R_{\\beta} = {\\mathfrak{a}} R_{\\beta}$ for every finitely generated ideal ${\\mathfrak{a}}$ of $R_{\\beta}$.  Then, using this adjusted construction, we get a UFD $A$ such that $\\widehat{A} = T$, $P \\cap A = (0)$, and for every ${\\mathfrak{p}} \\in {\\operatorname{Spec}}_1 A$, there is a height $d$ prime ideal of $T$ whose intersection with $A$ is ${\\mathfrak{p}}$.  Moreover, if ${\\mathfrak{q}} \\in {\\operatorname{Spec}}_r T$ with $d + 1 \\leq r \\leq \\dim T$ and ${\\mathfrak{q}} \\not\\subseteq P$, then ht$({\\mathfrak{q}} \\cap A) > 1$.  It follows that $\\alpha(A,(0)) = t$ and $\\alpha(A,{\\mathfrak{p}}) = d - 1$ for all ${\\mathfrak{p}} \\in {\\operatorname{Spec}}_1 A$.\n\\end{proof}\n\n\n\n\n\n\n\n\n\n\\begin{corollary}\\label{equal}\nLet $(T,{\\mathfrak{m}})$ be a complete local equidimensional ring such that $\\dim T\\geq 2$, no integer is a zerodivisor in $T$, ${\\operatorname{depth}} T>1$, and $|T|=|T/{\\mathfrak{m}}|$. Let $d$ be an integer such that $1\\leq d\\leq\\dim T-1$ and assume that, for every ${\\mathfrak{p}}\\in{\\operatorname{Ass}} T$, ${\\operatorname{ht}}{\\mathfrak{p}}\\leq d-1$ and that if $z$ is a regular element of $T$ and $Q \\in {\\operatorname{Ass}}(T/zT)$, then ${\\operatorname{ht}} Q \\leq d$. Then there exists a local unique factorization domain $A$ such that $\\widehat{A}= T$ and for every $pA\\in{\\operatorname{Spec}}_1A$, $\\alpha(A,pA)=\\alpha(A,(0))=d-1$.\n\\end{corollary}\n\nNote that Corollary \\ref{equal} answers the Question stated in the introduction posed by Heinzer, Rotthaus, and Sally in the nonexcellent case.  In particular, it shows that there are nonexcellent local integral domains where the dimension of the generic formal fiber ring is positive and where the set\n\n\n", "index": 9, "text": "$$\\Delta = \\{{\\mathfrak{p}}\\in{\\operatorname{Spec}} A\\mid{\\operatorname{ht}}{\\mathfrak{p}}=1\\text{ and }\\alpha(A,{\\mathfrak{p}}) = \\alpha(A)\\}$$\n", "mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" id=\"S0.Ex5.m1\" class=\"ltx_Math\" alttext=\"\\Delta=\\{{\\mathfrak{p}}\\in{\\operatorname{Spec}}A\\mid{\\operatorname{ht}}{%&#10;\\mathfrak{p}}=1\\text{ and }\\alpha(A,{\\mathfrak{p}})=\\alpha(A)\\}\" display=\"block\"><mrow><mi mathvariant=\"normal\">\u0394</mi><mo>=</mo><mrow><mo stretchy=\"false\">{</mo><mrow><mi>\ud835\udd2d</mi><mo>\u2208</mo><mrow><mo>Spec</mo><mo>\u2061</mo><mi>A</mi></mrow></mrow><mo>\u2223</mo><mrow><mrow><mo>ht</mo><mo>\u2061</mo><mi>\ud835\udd2d</mi></mrow><mo>=</mo><mrow><mn>1</mn><mo>\u2062</mo><mtext>\u00a0and\u00a0</mtext><mo>\u2062</mo><mi>\u03b1</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>A</mi><mo>,</mo><mi>\ud835\udd2d</mi><mo stretchy=\"false\">)</mo></mrow></mrow><mo>=</mo><mrow><mi>\u03b1</mi><mo>\u2062</mo><mrow><mo stretchy=\"false\">(</mo><mi>A</mi><mo stretchy=\"false\">)</mo></mrow></mrow></mrow><mo stretchy=\"false\">}</mo></mrow></mrow></math>", "type": "latex"}]